<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.2"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">75769</article-id><article-id pub-id-type="doi">10.7554/eLife.75769</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Waveform detection by deep learning reveals multi-area spindles that are selectively modulated by memory load</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-240088"><name><surname>Mofrad</surname><given-names>Maryam H</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0094-6694</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-240089"><name><surname>Gilmore</surname><given-names>Greydon</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-57197"><name><surname>Koller</surname><given-names>Dominik</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7449-9516</contrib-id><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-240090"><name><surname>Mirsattari</surname><given-names>Seyed M</given-names></name><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="aff" rid="aff7">7</xref><xref ref-type="aff" rid="aff8">8</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-240091"><name><surname>Burneo</surname><given-names>Jorge G</given-names></name><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="aff" rid="aff9">9</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-240092"><name><surname>Steven</surname><given-names>David A</given-names></name><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="aff" rid="aff9">9</xref><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-160397"><name><surname>Khan</surname><given-names>Ali R</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0760-8647</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff7">7</xref><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-240093"><name><surname>Suller Marti</surname><given-names>Ana</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-173940"><name><surname>Muller</surname><given-names>Lyle</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-5165-9890</contrib-id><email>lmuller2@uwo.ca</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund5"/><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02grkyz14</institution-id><institution>Department of Mathematics, Western University</institution></institution-wrap><addr-line><named-content content-type="city">London</named-content></addr-line><country>Canada</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02grkyz14</institution-id><institution>Brain and Mind Institute, Western University</institution></institution-wrap><addr-line><named-content content-type="city">London</named-content></addr-line><country>Canada</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02grkyz14</institution-id><institution>Department of Biomedical Engineering, Western University</institution></institution-wrap><addr-line><named-content content-type="city">London</named-content></addr-line><country>Canada</country></aff><aff id="aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03wd9za21</institution-id><institution>Advanced Concepts Team, European Space Agency</institution></institution-wrap><addr-line><named-content content-type="city">Noordwijk</named-content></addr-line><country>Netherlands</country></aff><aff id="aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02grkyz14</institution-id><institution>Department of Clinical Neurological Sciences, Schulich School of Medicine and Dentistry, Western University</institution></institution-wrap><addr-line><named-content content-type="city">London</named-content></addr-line><country>Canada</country></aff><aff id="aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02grkyz14</institution-id><institution>Department of Medical Imaging, Schulich School of Medicine and Dentistry, Western University</institution></institution-wrap><addr-line><named-content content-type="city">London</named-content></addr-line><country>Canada</country></aff><aff id="aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02grkyz14</institution-id><institution>Department of Medical Biophysics, Schulich School of Medicine and Dentistry, Western University</institution></institution-wrap><addr-line><named-content content-type="city">London</named-content></addr-line><country>Canada</country></aff><aff id="aff8"><label>8</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02grkyz14</institution-id><institution>Department of Psychology, Western University</institution></institution-wrap><addr-line><named-content content-type="city">London</named-content></addr-line><country>Canada</country></aff><aff id="aff9"><label>9</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02grkyz14</institution-id><institution>Department of Epidemiology and Biostatistics, Schulich School of Medicine and Dentistry, Western University</institution></institution-wrap><addr-line><named-content content-type="city">London</named-content></addr-line><country>Canada</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Ba</surname><given-names>Demba</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03vek6s52</institution-id><institution>Harvard University</institution></institution-wrap><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Behrens</surname><given-names>Timothy E</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/052gg0110</institution-id><institution>University of Oxford</institution></institution-wrap><country>United Kingdom</country></aff></contrib></contrib-group><pub-date publication-format="electronic" date-type="publication"><day>29</day><month>06</month><year>2022</year></pub-date><pub-date pub-type="collection"><year>2022</year></pub-date><volume>11</volume><elocation-id>e75769</elocation-id><history><date date-type="received" iso-8601-date="2021-11-23"><day>23</day><month>11</month><year>2021</year></date><date date-type="accepted" iso-8601-date="2022-05-27"><day>27</day><month>05</month><year>2022</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at bioRxiv.</event-desc><date date-type="preprint" iso-8601-date="2021-05-17"><day>17</day><month>05</month><year>2021</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2021.05.14.444188"/></event></pub-history><permissions><copyright-statement>© 2022, Mofrad et al</copyright-statement><copyright-year>2022</copyright-year><copyright-holder>Mofrad et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-75769-v1.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-75769-figures-v1.pdf"/><abstract><p>Sleep is generally considered to be a state of large-scale synchrony across thalamus and neocortex; however, recent work has challenged this idea by reporting isolated sleep rhythms such as slow oscillations and spindles. What is the spatial scale of sleep rhythms? To answer this question, we adapted deep learning algorithms initially developed for detecting earthquakes and gravitational waves in high-noise settings for analysis of neural recordings in sleep. We then studied sleep spindles in non-human primate electrocorticography (ECoG), human electroencephalogram (EEG), and clinical intracranial electroencephalogram (iEEG) recordings in the human. Within each recording type, we find widespread spindles occur much more frequently than previously reported. We then analyzed the spatiotemporal patterns of these large-scale, multi-area spindles and, in the EEG recordings, how spindle patterns change following a visual memory task. Our results reveal a potential role for widespread, multi-area spindles in consolidation of memories in networks widely distributed across primate cortex.</p></abstract><abstract abstract-type="executive-summary"><title>eLife digest</title><p>The brain processes memories as we sleep, generating rhythms of electrical activity called ‘sleep spindles’. Sleep spindles were long thought to be a state where the entire brain was fully synchronized by this rhythm. This was based on EEG recordings, short for electroencephalogram, a technique that uses electrodes on the scalp to measure electrical activity in the outermost layer of the brain, the cortex. But more recent intracranial recordings of people undergoing brain surgery have challenged this idea and suggested that sleep spindles may not be a state of global brain synchronization, but rather localised to specific areas.</p><p>Mofrad et al. sought to clarify the extent to which spindles co-occur at multiple sites in the brain, which could shed light on how networks of neurons coordinate memory storage during sleep. To analyse highly variable brain wave recordings, Mofrad et al. adapted deep learning algorithms initially developed for detecting earthquakes and gravitational waves. The resulting algorithm, designed to more sensitively detect spindles amongst other brain activity, was then applied to a range of sleep recordings from humans and macaque monkeys.</p><p>The analyses revealed that widespread and complex patterns of spindle rhythms, spanning multiple areas in the cortex of the brain, actually appear much more frequently than previously thought. This finding was consistent across all the recordings analysed, even recordings under the skull, which provide the clearest window into brain circuits. Further analyses found that these multi-area spindles occurred more often in sleep after people had completed tasks that required holding many visual scenes in memory, as opposed to control conditions with fewer visual scenes.</p><p>In summary, Mofrad et al. show that neuroscientists had previously not appreciated the complex and dynamic patterns in this sleep rhythm. These patterns in sleep spindles may be able to adapt based on the demands needed for memory storage, and this will be the subject of future work. Moreover, the findings support the idea that sleep spindles help coordinate the consolidation of memories in brain circuits that stretch across the cortex. Understanding this mechanism may provide insights into how memory falters in aging and sleep-related diseases, such as Alzheimer’s disease. Lastly, the algorithm developed by Mofrad et al. stands to be a useful tool for analysing other rhythmic waveforms in noisy recordings.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>memory</kwd><kwd>sleep spindles</kwd><kwd>memory consolidation</kwd><kwd>deep learning</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd><kwd>Rhesus macaque</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100010785</institution-id><institution>Canada First Research Excellence Fund</institution></institution-wrap></funding-source><award-id>BrainsCAN at Western University</award-id><principal-award-recipient><name><surname>Muller</surname><given-names>Lyle</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>NeuroNex Grant No. 2015276</award-id><principal-award-recipient><name><surname>Muller</surname><given-names>Lyle</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000020</institution-id><institution>Fields Institute for Research in Mathematical Sciences</institution></institution-wrap></funding-source><award-id>Postdoctoral Fellowship</award-id><principal-award-recipient><name><surname>Mofrad</surname><given-names>Maryam H</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100013020</institution-id><institution>Compute Canada</institution></institution-wrap></funding-source><award-id>Resource Allocation Competitions (RAC)</award-id><principal-award-recipient><name><surname>Muller</surname><given-names>Lyle</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100005683</institution-id><institution>Kyoto University</institution></institution-wrap></funding-source><award-id>SPIRITS 2020</award-id><principal-award-recipient><name><surname>Muller</surname><given-names>Lyle</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A new computational approach for detecting sleep waveforms reveals that the 11–15 Hz sleep 'spindle', a neural rhythm implicated in memory consolidation, co-occurs widely across cortex much more often than previously thought.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Consolidation of long-term memories requires precise coordination of pre- and postsynaptic spikes across neocortex. New memories are transferred from hippocampus to neocortex for long-term storage (<xref ref-type="bibr" rid="bib47">McClelland et al., 1995</xref>; <xref ref-type="bibr" rid="bib66">Rasch and Born, 2007</xref>), where interconnections within a sparse, distributed neuron group are strengthened until their activity becomes hippocampus-independent (<xref ref-type="bibr" rid="bib30">Frankland and Bontempi, 2005</xref>). Computational studies have identified neural oscillations as a potential mechanism to regulate synaptic plasticity (<xref ref-type="bibr" rid="bib45">Masquelier et al., 2009</xref>; <xref ref-type="bibr" rid="bib75">Song et al., 2000</xref>) and create precise spike timing (<xref ref-type="bibr" rid="bib10">Cassenaer and Laurent, 2007</xref>; <xref ref-type="bibr" rid="bib53">Muller et al., 2011</xref>). Further, experiments have shown that the sleep ‘spindle’ oscillation influences spiking activity (<xref ref-type="bibr" rid="bib14">Contreras and Steriade, 1995</xref>; <xref ref-type="bibr" rid="bib35">Kandel and Buzsáki, 1997</xref>; <xref ref-type="bibr" rid="bib63">Peyrache et al., 2011</xref>) and causally contributes to sleep-dependent consolidation of long-term memory (<xref ref-type="bibr" rid="bib48">Mednick et al., 2013</xref>). It remains unclear, however, precisely how this rhythm can coordinate activity across areas in neocortex for synaptic plasticity and long-term storage to occur.</p><p>While early recordings in anesthetized animals (<xref ref-type="bibr" rid="bib2">Andersen et al., 1967</xref>; <xref ref-type="bibr" rid="bib15">Contreras et al., 1996</xref>) and human electroencephalogram (EEG) (<xref ref-type="bibr" rid="bib1">Achermann and Borbély, 1998</xref>) indicated that sleep spindles generally occur across a wide area in cortex, creating a state of large-scale synchrony (<xref ref-type="bibr" rid="bib73">Sejnowski and Destexhe, 2000</xref>; <xref ref-type="bibr" rid="bib76">Steriade, 2003</xref>), recent work in intracranial recordings from human clinical patients has challenged this idea by reporting isolated, ‘local’ sleep spindles (<xref ref-type="bibr" rid="bib3">Andrillon et al., 2011</xref>; <xref ref-type="bibr" rid="bib61">Nir et al., 2011</xref>; <xref ref-type="bibr" rid="bib64">Piantoni et al., 2017</xref>; <xref ref-type="bibr" rid="bib55">Muller et al., 2016</xref>; <xref ref-type="bibr" rid="bib70">Sarasso et al., 2014</xref>, but see <xref ref-type="bibr" rid="bib31">Frauscher et al., 2015</xref>). Because spindles are intrinsically related to sleep-dependent consolidation of long-term memory (<xref ref-type="bibr" rid="bib13">Clemens et al., 2005</xref>; <xref ref-type="bibr" rid="bib33">Gais et al., 2002</xref>; <xref ref-type="bibr" rid="bib48">Mednick et al., 2013</xref>), this difference in reported spatial extent of the spindle raises an important question for the organization of engrams established through sleep-dependent memory consolidation. Recent evidence using <italic>cFos</italic> mapping in animal models suggests these engrams are distributed widely across brain areas (<xref ref-type="bibr" rid="bib38">Kitamura et al., 2017</xref>; <xref ref-type="bibr" rid="bib69">Roy et al., 2019</xref> <ext-link ext-link-type="uri" xlink:href="https://paperpile.com/c/tokfLR/t0g6+Pphz">n.d.)</ext-link>, which is consistent with previous imaging evidence in the human (<xref ref-type="bibr" rid="bib9">Brodt and Gais, 2021</xref>; <xref ref-type="bibr" rid="bib82">Wheeler et al., 2000</xref>). Taking these points together, we reasoned that widespread, multi-area spindles may occur more often than previously reported in primate and human cortex. If this were the case, these widespread spindles could provide the mechanism needed to link populations distributed widely across the cortex for sleep-dependent memory consolidation.</p><p>One potential mechanism is provided by previous work on spindles in intracranial electrocorticography (ECoG) recordings in human clinical patients, where these oscillations were found to be organized into a wave rotating across the cortex (see Video 1 in <xref ref-type="bibr" rid="bib55">Muller et al., 2016</xref>). Based on their speed of propagation (2–5 m/s), which matches the axonal conduction speeds of long-range white matter fibers in cortex, it was identified that this rotating wave organization could precisely align spikes across areas separated by long distances in cortex to create the conditions necessary for both synaptic strengthening and weakening to occur. With this previously identified mechanism in mind, we thus hypothesized that widespread, multi-area spindles might be a critical missing link in understanding how networks widely distributed across cortex are modulated during sleep.</p><p>Reliably detecting individual spindles in noisy sleep recordings, however, is challenging. Spindle oscillation amplitudes differ across regions in cortex (<xref ref-type="bibr" rid="bib31">Frauscher et al., 2015</xref>). Furthermore, oscillation amplitudes may differ significantly across recording sites simply due to variation in electrode properties (<xref ref-type="bibr" rid="bib36">Kappenman and Luck, 2010</xref>; <xref ref-type="bibr" rid="bib59">Nelson and Pouget, 2010</xref>). For these reasons, we reasoned that bandpass filtering followed by an amplitude threshold (AT), which is a technique common across methods for spindle detection (<xref ref-type="bibr" rid="bib81">Warby et al., 2014</xref>), may only detect the largest-amplitude events, potentially leading to an underestimation of spatial extent. To address this question, we adapted deep learning algorithms initially developed for detecting earthquakes (<xref ref-type="bibr" rid="bib62">Perol et al., 2018</xref>) and gravitational waves (<xref ref-type="bibr" rid="bib34">George and Huerta, 2018</xref>) in high-noise settings to analysis of neural recordings in sleep. These convolutional neural networks (CNNs) are relatively general to the type of noise in each recording, provided there is enough training data and a set of high-quality marked events. Because obtaining many high-quality marked spindle events is itself difficult, however, as sleep recordings are in general manually scored by experts (a process that is both expensive and subjective), we introduce here a careful, two-step computational approach. First, we use a signal-to-noise ratio (SNR) algorithm (<xref ref-type="bibr" rid="bib55">Muller et al., 2016</xref>) to generate a set of high-quality marked spindles for training the CNN. The SNR algorithm, which is closely related to the constant false alarm rate (CFAR) method used in radar (<xref ref-type="bibr" rid="bib68">Richards, 2005</xref>), detects many ‘true’ spindles while minimizing false detections. This property makes the SNR algorithm an excellent method for generating a high-quality training dataset and, in addition, for providing a second check on results from the CNN model on the subset of spindles detected by this more conservative approach. We then use the trained CNN to detect a comprehensive set of spindles in sleep recordings. To test this approach, we studied sleep spindles in macaque non-human primate (NHP) ECoG, human electroencephalogram (EEG), and, finally, clinical intracranial electroencephalogram (iEEG) recordings, which provide a window into the circuits of the human brain at one of the highest spatial resolutions possible (<xref ref-type="bibr" rid="bib40">Lachaux et al., 2012</xref>; <xref ref-type="bibr" rid="bib52">Mukamel and Fried, 2012</xref>). This two-step approach results in a subject-specific model, adapted to the noise encountered in each recording type and the specific sleep waveforms in each individual, that can more sensitively detect a range of clearly formed large- and small-amplitude spindles in the sleep recordings. Finally, at each point in the analysis, we also return to the subset of spindles detected by the SNR algorithm to validate results obtained from the CNN.</p><p>Our approach reveals that the spatial extent of spindles, defined here in terms of co-occurrence across electrode sites within the same 500 ms detection window, is widely distributed over a broad range of cortex. In particular, multi-area spindles are much more frequent than previously estimated by AT approaches, which tend to select only the highest-amplitude spindles and could miss events that transiently fall below threshold. Importantly, while we apply our approach to very different datasets (ECoG, EEG, and iEEG) in this work, the comparisons we make are always between the spatial extent of spindles detected by our CNN approach and AT methods within an individual recording type. These results provide strong evidence that widespread, multi-area spindles may have been underestimated in previous work. This finding, which clearly emerges consistently across all recording types, is not affected by differences in spatial sampling of different electrode types, as we always restrict comparisons within a single type of electrode. In human sleep EEG after low- (L-VM) and high-load visual memory (H-VM) tasks, our method also detects an increase in regional and multi-area spindles uniquely following an H-VM task. Finally, we note that spindle co-occurrence does not imply zero-lag synchrony across recording sites, with all sites reaching positive (or negative) peaks in potential at the same point in time. Further spatiotemporal analysis of the sleep EEG recording reveals that the multi-area spindles are organized into rotating waves that are also modulated by the memory task. Taken together, these results reveal a sophisticated spatiotemporal organization of sleep spindles in the primate brain, both in co-occurrence and in phase organization, that has previously gone unappreciated. These results thus provide substantial insight into the spatiotemporal organization of sleep spindles in the primate brain, during normal sleep and also following memory tasks.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>Sleep recordings from both human and NHP were obtained from electrodes ranging from traditional scalp EEG to invasive intracranial EEG electrodes (<xref ref-type="fig" rid="fig1">Figure 1a</xref>). We trained subject-specific CNN models over high-quality training datasets generated by the SNR algorithm. The SNR algorithm robustly detects spindles ranging from high to lower amplitudes (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>), providing a good training set for the CNN. To verify the quality of spindles detected by our CNN model (<xref ref-type="fig" rid="fig1">Figure 1c</xref>), we first computed average power spectral densities (PSDs) over spindle and non-spindle windows. The average PSD of detected spindle events shows an increase in the 11–15 Hz spindle frequency range (red lines, <xref ref-type="fig" rid="fig1">Figure 1b</xref>), while non-spindle events do not show a corresponding increase (black lines, <xref ref-type="fig" rid="fig1">Figure 1b</xref>). Spindles detected by the CNN are well formed, consistent with standard morphology (<xref ref-type="bibr" rid="bib41">Loomis et al., 1935</xref>; <xref ref-type="bibr" rid="bib60">Newton Harvey et al., 1937</xref>; <xref ref-type="bibr" rid="bib74">Silber et al., 2007</xref>; <xref ref-type="fig" rid="fig1">Figure 1d</xref>), and in agreement with previously observed durations (average ± SEM: 0.69±0.004 s, NHP ECoG; 0.87±0.006 s, EEG; 0.77±0.009 s, iEEG) (<xref ref-type="bibr" rid="bib28">Fernandez and Lüthi, 2020</xref>; <xref ref-type="bibr" rid="bib78">Takeuchi et al., 2016</xref>; <xref ref-type="bibr" rid="bib81">Warby et al., 2014</xref>). To further validate spindles detected by the CNN, we designed a time-shifted averaging approach for application to recordings with only a 1 Hz highpass filter applied (thus excluding any potential effects from lowpass filtering). To do this, we collected signals from detected spindles, filtered at a 1 Hz highpass, time-aligned the events to the largest positive value within the detected window (corresponding to a positive oscillation peak), and then computed the average across aligned events. With this approach, the average over detected spindles exhibited clear 11–15 Hz oscillatory structure (black line, <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>), while no oscillatory structure is observed when averaging over time-matched randomly selected non-spindle activity (dashed red line, <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>). This result demonstrates that spindles detected by the CNN exhibit the correct structure even in a mostly raw, unprocessed signal with no lowpass filtering applied, while non-spindle activities only exhibit a peak due to the alignment to the central peak in the window, with a decay consistent with the autocorrelation time present in the 1 Hz filtered signal. We then compared the average number of spindles per minute (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3a</xref>) and the distribution of peak Fourier amplitudes in the 9–18 Hz band for spindle events detected by the CNN and AT approach (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3b</xref>). In the intracranial recordings (ECoG and iEEG), AT detects a subset of spindles that are significantly higher amplitude than those detected by the CNN (p&lt;0.02, NHP ECoG recordings; p&lt;1 × 10<sup>–12</sup>; iEEG recordings, one-sided Wilcoxon signed-rank test; n.s. in EEG), consistent with the expectation that AT will preferentially select the largest amplitude events. The CNN, however, detects a broader set of spindles and can find well-formed spindles that are both large and small in amplitude (<xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>). This improved resolution allows us to study the spatial extent of spindles in an approximately amplitude-invariant manner. Furthermore, to understand more generally the performance of the CNN and AT approaches under different types of noise and in the presence of artifacts, we conducted a detailed simulation study using surrogate data with systematically varying noise characteristics or rate of artifacts (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref> and <xref ref-type="fig" rid="fig1s5">Figure 1—figure supplements 5</xref> and <xref ref-type="fig" rid="fig1s6">6</xref>). Finally, we used the pattern of activation of the feature map and gradient map to study the underlying mechanism by which the trained CNN detects sleep spindle oscillations (<xref ref-type="fig" rid="fig1s7">Figure 1—figure supplements 7</xref> and <xref ref-type="fig" rid="fig1s8">8</xref>) and we evaluated the choice of architecture tailored with respect to the duration of rhythmic activity (<xref ref-type="fig" rid="fig1s9">Figure 1—figure supplement 9</xref>).</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Electrophysiology, architecture of the convolutional neural network (CNN) model, and detected spindles.</title><p>(<bold>a</bold>) Electrode placement of multichannel electrocorticography (ECoG) recordings of two macaques (top), high-density scalp electroencephalogram (EEG) used for recordings after low- and high-load visual memory tasks (middle), and example intracranial electroencephalogram (iEEG) contacts in a human clinical patient (bottom). (<bold>b</bold>) Average power spectral density estimate for spindle windows detected by the CNN model (red) and matched non-spindle windows (black), illustrating the nearly 10 dB increase within the 11–15 Hz spindle band in non-human primate (NHP) ECoG recordings (top), human EEG recordings (middle), and human iEEG recordings (bottom). Power at line noise frequency omitted for clarity. (<bold>c</bold>) The architecture of the CNN model developed for spindle detection. (<bold>d</bold>) Examples of detected spindles by the CNN model (red) in NHP ECoG recordings (top), human EEG recordings (middle), and human iEEG recordings (bottom).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-75769-fig1-v1.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Signal-to-noise ratio (SNR) and amplitude-thresholding (AT) sensitivity to the amplitude (surrogate data – simulated spindles).</title><p>(<bold>a</bold>) Power spectral density of the surrogate data. (<bold>b</bold>) An example of a spindle detected by both SNR approach (top) and AT approach (bottom). The red line is the instantaneous amplitude of the signal, the green line is the AT, and the blue signal represents windows of time in which spindles were detected. (<bold>c</bold>) High-amplitude noise. The SNR approach was still successful in detecting the spindle with higher-amplitude noise (top) as opposed to the AT algorithm (bottom). (<bold>d</bold>) Low-amplitude spindle. Similar to the high-amplitude noise, the SNR approach detected the spindle activity (top) while the AT algorithm (bottom) failed to detect any activity.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-75769-fig1-figsupp1-v1.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 2.</label><caption><title>Average time-shifted spindles detected by the convolutional neural network (CNN) model.</title><p>Examples of average signals computed over spindle windows detected by the CNN models (solid black lines) versus a subset of randomly matched non-spindle windows (dashed red lines) in non-human primate (NHP) electrocorticography (ECoG) recordings (left), human electroencephalogram (EEG) recordings (middle), and intracranial electroencephalogram (iEEG) recordings (right). The average over detected spindle windows exhibits clear 11–15 Hz oscillatory structure, while no oscillatory structure is present in the average over matched non-spindle windows. The heatmaps in the background are the individual time-shifted spindle events, which demonstrate the presence of this structure in individual instances.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-75769-fig1-figsupp2-v1.tif"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 3.</label><caption><title>Average single-electrode spindle frequency and amplitude distribution of convolutional neural network (CNN) model versus amplitude-thresholding (AT) algorithm.</title><p>(<bold>a</bold>) Plotted are the average number of single-electrode spindles per minute over activities detected by the CNN and AT (average ± SEM; n = 1644 for CNN, n = 1387 for AT, non-human primate [NHP] electrocorticography [ECoG]; n = 1951 for CNN, n = 1943 for AT, electroencephalogram [EEG]; n = 3759 for CNN, n = 3356 for AT, intracranial electroencephalogram [iEEG]). The CNN tends to detect on average 4–5 spindles per minute (close to the maximum reported in the literature, cf. <xref ref-type="bibr" rid="bib29">Fogel et al., 2007</xref>; <xref ref-type="bibr" rid="bib33">Gais et al., 2002</xref>; <xref ref-type="bibr" rid="bib65">Purcell et al., 2017</xref>) as opposed to the AT which resulted in 2–3 spindles per minute except in the NHP ECoG recording. The number of single-electrode spindles per minute was only significantly different between EEG and iEEG recordings in the CNN (p&gt;0.05, NHP ECoG recordings versus EEG recording, p&gt;0.16, NHP ECoG recordings versus iEEG recording; p&lt;1 × 10<sup>–4</sup>; iEEG recordings versus EEG recordings, Wilcoxon signed-rank test). Moreover, in the ECoG recording, in one of the subjects, amplitude distribution varies significantly across the array so using a fixed amplitude over the entire array does not work properly. (<bold>b</bold>) Plotted is the scatter diagram of the square root of power spectral density (PSD) maximum over detected spindle events during each session by CNN and AT. The CNN approach is able to detect some lower amplitude (but still clearly formed) spindles; therefore, as expected, this result is reflected in the fact that the set of spindles detected by the AT approach in iEEG and ECoG has clearly higher amplitude than those detected by the CNN. Furthermore, specific examples of this can be observed in <xref ref-type="fig" rid="fig1">Figure 1c</xref>, EEG recording (first and second spindles were not detected by AT), and <xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>, which provides examples where the CNN detects clear spindles but the AT does not.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-75769-fig1-figsupp3-v1.tif"/></fig><fig id="fig1s4" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 4.</label><caption><title>Performance of convolutional neural network (CNN) model versus amplitude-thresholding (AT) algorithm.</title><p>(<bold>a</bold>) An example of co-occurring spindles detected by the CNN model in 12 sites. The red line is the signal envelope, the green line is the AT, and the blue line represents windows of time in which spindles were detected by the CNN model. The AT algorithm, which only detects spindle activities with amplitude above a predefined AT for at least a duration of 0.5 s (<xref ref-type="bibr" rid="bib61">Nir et al., 2011</xref>) (yellow line), was not successful in detecting the majority of spindles in this example. Specifically, the AT algorithm fails to detect clearly formed spindles (detected by the CNN model) whose amplitudes temporarily drop below threshold (<bold>b</bold>) or have low amplitude (<bold>c</bold>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-75769-fig1-figsupp4-v1.tif"/></fig><fig id="fig1s5" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 5.</label><caption><title>A spindle with varying types of noise detected by the two-step model (surrogate data – simulated spindles).</title><p>Examples of a spindle with different types of noise detected by the convolutional neural network (CNN) models trained over the detected activities by the signal-to-noise ratio (SNR) approach. The spindle activity contains (<bold>a</bold>) white noise with constant power spectrum, (<bold>b</bold>) white noise and noise with <inline-formula><mml:math id="inf1"><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>f</mml:mi></mml:msqrt></mml:math></inline-formula> power spectrum, (<bold>c</bold>) white noise and pink noise with <inline-formula><mml:math id="inf2"><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>f</mml:mi></mml:math></inline-formula> power spectrum, and (<bold>d</bold>) white noise and Brownian noise with <inline-formula><mml:math id="inf3"><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> power spectrum.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-75769-fig1-figsupp5-v1.tif"/></fig><fig id="fig1s6" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 6.</label><caption><title>Performance of convolutional neural network (CNN) approach and amplitude-thresholding (AT) with increasing rate of noise artifacts.</title><p>(<bold>a</bold>) The first columns are examples of simulated artifacts (gray) versus the original artifacts (black) used for the simulation and the second columns represent their corresponding power spectral density (PSD). (<bold>b</bold>) Plotted is the performance of CNN and AT as a function of the number of artifacts per minute. The CNN model tends to detect almost all spindles (blue dots) while the AT sensitivity (red dots) drops almost linearly as the number of artifacts per minute increases. The specificity of both CNN and AT approaches is above 99%.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-75769-fig1-figsupp6-v1.tif"/></fig><fig id="fig1s7" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 7.</label><caption><title>Feature map.</title><p>Plotted are examples of features highlighted by the convolutional neural network (CNN) model. The top three signals are non-spindles and the bottom three signals are different realizations of a spindle event. These feature maps visualize CNN filters applied onto input signals. They show the that original signal is being modified to maximize the activation of the CNN model and can accurately detect the maximum amplitude within each cycle. Interestingly, in the bottom four signals with oscillations, the maximum amplitude within each cycle is detected by the CNN layers. These highlighted maxima are then used by the CNN model to classify the input signal. The values are scaled independently to range between 0 and 1 for the sake of visualization.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-75769-fig1-figsupp7-v1.tif"/></fig><fig id="fig1s8" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 8.</label><caption><title>Gradient attribution map.</title><p>Plotted are the gradient map of the convolutional neural network (CNN) model with respect to the simulated signals. The top three signals are non-spindles and the bottom three signals are different realizations of spindle events (same examples as <xref ref-type="fig" rid="fig1s7">Figure 1—figure supplement 7</xref>). These gradient maps represent the area of the simulated signal that are of importance in the CNN model in terms of classification. In the “half spindle” signal (fifth from top), only the half containing the spindle oscillation is of importance in learning to distinguish spindles from non-spindle events. In the signal with spindles of different amplitude (fourth from top), the spindle with the highest amplitude is relatively more important than the other half of the signal.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-75769-fig1-figsupp8-v1.tif"/></fig><fig id="fig1s9" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 9.</label><caption><title>Impact of filter size on the convolutional neural network (CNN) model performance.</title><p>Plotted is the average sensitivity of CNN model computed over 10 simulated recordings as a function of the multiplier used to increase the filter size for all convolutional layers. Error bars is SEM. The result demonstrates gradual decrease in spindle detection as we increase the filter size from the current setting (red line). The specificity of the CNN model stays above 98%.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-75769-fig1-figsupp9-v1.tif"/></fig><fig id="fig1s10" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 10.</label><caption><title>Power spectral density (PSD) comparison.</title><p>Examples of average PSD estimate over spindle windows detected by the convolutional neural network (CNN) model (blue), the signal-to-noise ratio (SNR) approach (red), the amplitude-thresholding (AT) algorithm (yellow) and matched non-spindle windows (purple) in intracranial electroencephalogram (iEEG) recordings. The CNN and SNR PSDs exhibit a nearly 10 dB increase within the 11–15 Hz spindle band compared to matched non-spindle windows, while the AT PSD exhibits higher power outside of the frequency of interest in addition to spindle band. Power at line noise frequency omitted for clarity.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-75769-fig1-figsupp10-v1.tif"/></fig><fig id="fig1s11" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 11.</label><caption><title>Impact of signal-to-noise ratio (SNR) threshold on the convolutional neural network (CNN) model.</title><p>Plotted is the change in the average time-shifted spindle detected by CNN models trained over a wide range of SNR thresholds (5 to –10 dB, dark to light gray) in the non-human primate (NHP) electrocorticography (ECoG) recordings. Clearly detected spindle activity decreases with the SNR threshold, demonstrating that the CNN result breaks down when the model is trained on lower-quality examples. The red line represents the average computed at 0 dB threshold (which represents parity between power in the spindle passband and the rest of the signal spectrum), below which the average detected spindle activities start to drift away from the expected 11–15 Hz oscillatory structure.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-75769-fig1-figsupp11-v1.tif"/></fig><fig id="fig1s12" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 12.</label><caption><title>Non-spindle activities detected by the amplitude-thresholding (AT) algorithm.</title><p>Sleep recordings are subjected to artifacts, such as line noise, electrical noise, and movement artifacts that introduce signal distortion. These artifacts can result in false spindle activity detection in the AT approach. For example, the sharp artifact when filtered at 11–15 Hz in the AT approach appears as an oscillation which does not exist in the original recording (top row), or the AT approach might detect non-spindle activities resulting from broken channels (bottom left) or not clearly formed spindles (bottom right).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-75769-fig1-figsupp12-v1.tif"/></fig></fig-group><p>What is the spatial extent of spindle oscillations across cortex? To answer this question, we studied the distribution of spindle co-occurrence across electrodes in the sleep recordings. We defined three classes of spindles based on co-occurrence across recording sites: local (1–2 sites), regional (3–10 sites), and multi-area (more than 10 sites). We noted that our CNN approach detected many spindles with electrode sites distributed widely across the cortex (<xref ref-type="fig" rid="fig2">Figure 2a</xref>). By taking into account the unique cortical regions sampled by electrodes in each individual (9 on average, ranging from 7 to 12 cortical regions, <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>), we verified that these were indeed multi-area spindle events (<xref ref-type="fig" rid="fig2">Figure 2b</xref>) that happen on average across 60% of recorded cortical regions. Considering the different spatial sampling across subjects, we also confirmed a significant increase (ranging from 40% to 70%) in cortical region participation at the subject level in multi-area spindles with respect to the local spindles (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1a</xref>). We then compared spindles detected by the CNN and AT approaches. To do this, we first computed the ratio of spindles detected by the CNN and AT for all classes. This comparison revealed that multi-area spindles were systematically detected approximately 1.5 (ECoG) to 10 (iEEG) times more often with the CNN than with the AT (<xref ref-type="fig" rid="fig2">Figure 2c</xref> and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1b</xref>). Across all recordings, the increase in the multi-area spindles detected by the CNN was significantly greater than in the local spindles (p&lt;1 × 10<sup>–3</sup>, NHP ECoG recordings; p&lt;1 × 10<sup>–5</sup>, EEG recordings; p&lt;0.02, iEEG recordings, one-sided Wilcoxon signed-rank test; similar results for the local-regional comparison, p&lt;0.02, EEG recordings; p&lt;0.01, iEEG recordings, one-sided Wilcoxon signed-rank test, n.s. in NHP ECoG). Importantly, iEEG has the highest spatial resolution across the recording types studied here (<xref ref-type="bibr" rid="bib52">Mukamel and Fried, 2012</xref>) and also exhibits the largest increase in multi-area spindles detected by the CNN versus the AT. It is important to note, as well, that in the ECoG dataset the CNN approach detects fewer local and regional spindles than the AT (<xref ref-type="fig" rid="fig2">Figure 2c</xref>). This effect was primarily due to estimated threshold varying widely across electrodes in one subject, which in turn caused more detections of local and regional spindles in the AT. Next, we computed spindle participation at the level of cortical lobes (frontal, temporal, parietal, occipital) and cortical systems (executive, limbic, visual, auditory, somatosensory) and detected a significant increase in multi-lobe and multi-system spindles across all recordings (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). Taken together, these results demonstrate that spindles appear much more widespread across cortex when detected using our approximately amplitude-invariant deep learning approach.</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Distribution of the extent of spindles detected by convolutional neural network (CNN) and amplitude-thresholding (AT) approaches.</title><p>(<bold>a</bold>) An example of a widespread, multi-area spindle with electrode sites distributed widely across the cortex. Filled gray circles indicate electrode contacts in gray matter. (<bold>b</bold>) Plotted is the percentage of unique recorded cortical regions with spindles detected by the CNN in the local versus multi-area case across all subjects in the intracranial electroencephalogram (iEEG) recordings (average ± SEM; n = 389445 for local, n = 28407 for multi-area; p &lt; 1 × 10<sup>-10</sup>, iEEG recordings, local versus multi-area, one-sided Wilcoxon signed-rank test). Results were similar at the level of individual subjects (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1a</xref>). (<bold>c</bold>) Plotted are the ratios of spindles detected by the CNN and AT in non-human primate (NHP) electrocorticography (ECoG) recordings (left, n = 13), human electroencephalogram (EEG) recordings (middle, n = 32), and iEEG recordings (right, n = 89) in local (1–2 sites), regional (3–10 sites), and multi-area (more than 10 sites) spindle classes (average ± SEM in all cases; p &gt; 0.1, NHP ECoG recordings; p &lt; 0.02, EEG recordings; p &lt; 0.01, iEEG recordings, local versus regional comparison, one-sided Wilcoxon signed-rank test; p &lt; 1 x 10<sup>-3</sup>, NHP ECoG recordings; p &lt; 1 x 10<sup>-5</sup>, EEG recordings; p &lt; 0.02, iEEG recordings, local versus multi-area comparison, one-sided Wilcoxon signed-rank test). Across recordings, the increase in regional and multi-area spindles detected by the CNN is significantly larger than for the local spindles (except local versus regional in the NHP ECoG).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-75769-fig2-v1.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Extent of spindles detected by convolutional neural network (CNN) and amplitude-thresholding (AT) approaches.</title><p>(<bold>a</bold>) Plotted is the percentage of unique recorded cortical regions with spindles detected by the CNN in the local versus multi-area case for each subject in the intracranial electroencephalogram (iEEG) recordings (average ± SEM; n = 93643 for local, n = 2676 for multi-area, p &lt; 1 × 10<sup>-10</sup>, subject A, one-sided Wilcoxon signed-rank test; n = 44998 for local, n = 3184 for multi-area, p &lt; 1 × 10<sup>-10</sup>, subject B, one-sided Wilcoxon signed-rank test; n = 107633 for local, n = 6457 multi-area, p &lt; 1 × 10<sup>-10</sup>, subject C, one-sided Wilcoxon signed-rank test; n = 76685 for local, n = 60 for multi-area, p &lt; 1 × 10<sup>-10</sup>, subject D, one-sided Wilcoxon signed-rank test; n = 66486 for local, n = 16030 for multi-area, p &lt; 1 × 10<sup>-10</sup>, subject E, one-sided Wilcoxon signed-rank test). At the individual level, subject A has 27 gray matter electrodes in 9 recorded cortical regions, subject B has 60 gray matter electrodes in 12 recorded cortical regions, subject C has 54 gray matter electrodes in 11 recorded cortical regions, subject D has 26 gray matter electrodes in 7 recorded cortical regions, and lastly subject E has 54 gray matter electrodes in 8 recorded cortical regions. (<bold>b</bold>) Plotted is the scatter diagram of the ratio of average number of detected spindles by the CNN and AT in non-human primate (NHP) electrocorticography (ECoG) recordings (left), human electroencephalogram (EEG) recordings (middle), and iEEG recordings (right) grouped into local (1–2 sites), regional (3–10 sites), and multi-area (more than 10 sites) spindle classes. Each blue dot represents the ratio of the number of spindles per minute in one sleep recording. For iEEG multi-area recordings, some sessions are not visible within the vertical bounds of the plot because no multi-area spindles were found by the AT approach (leading to division by zero, <italic>N</italic>=4), and some sessions had very high ratios due to very few multi-area spindles detected by the AT approach (<italic>N</italic>=22).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-75769-fig2-figsupp1-v1.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Extent of spindles detected by convolutional neural network (CNN) and amplitude-thresholding (AT) approaches across cortical lobes and systems.</title><p>Plotted are the ratios of spindles detected in single- versus multi-lobes (left) and single- versus multi-system (right) by the CNN and AT across all subjects in the intracranial electroencephalogram (iEEG) recordings (average ± SEM; n = 87, p &lt; 1 x 10<sup>-3</sup>, single- versus multi-lobe, one-sided Wilcoxon signed-rank test; n = 87, p &lt; 1 x 10<sup>-7</sup>, single- versus multi-system, one-sided Wilcoxon signed-rank test). A significant increase in widely distributed spindles across lobes and systems is observed in the spindles detected by the CNN model.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-75769-fig2-figsupp2-v1.tif"/></fig></fig-group><p>The organization of spindles across the cortex is thus neither fully local nor fully global: the co-occurrence patterns of this sleep rhythm contain a mixture of local and widespread events. If this is the case, how can pre-sleep memory engagement impact this distribution? To answer this question, we further studied the human EEG dataset, which had the unique feature of testing sleep after tasks with varying memory loads. Briefly, before nap EEG recordings, subjects completed a task in which five novel outdoor scenes (H-VM) or two novel outdoor scenes (L-VM) were required to be held in working memory for 6 s (<xref ref-type="fig" rid="fig3">Figure 3a</xref>). After the delay period, subjects were then presented with a subsequent visual scene and asked whether it belonged to the previously presented set. In each case (H-VM and L-VM), trials were balanced so that the same total number of visual scenes was presented before sleep. An increase in spindle density after memory tasks and its relationship with memory consolidation is well established (<xref ref-type="bibr" rid="bib13">Clemens et al., 2005</xref>; <xref ref-type="bibr" rid="bib19">Dang-Vu et al., 2008</xref>; <xref ref-type="bibr" rid="bib33">Gais et al., 2002</xref>; <xref ref-type="bibr" rid="bib72">Schabus et al., 2007</xref>; <xref ref-type="bibr" rid="bib71">Schabus et al., 2004</xref>); however, the effect of memory tasks on co-occurrence remains unknown. Considering the potential circuit mechanism for spindles to link activity in neuron groups distributed across multiple areas in cortex through long-range excitatory connections (<xref ref-type="bibr" rid="bib55">Muller et al., 2016</xref>), we then hypothesized that sleep following H-VM tasks would exhibit more multi-area spindles and a larger spatial extent. To test this hypothesis, we first confirmed that amplitudes of detected spindles did not differ across L-VM and H-VM conditions (p&gt;0.77, Wilcoxon signed-rank test). We then defined a ‘multi-electrode’ spindle rate, which considers spindles occurring simultaneously on several electrodes as a single event. Importantly, this multi-electrode spindle rate is distinct from the ‘single-electrode’ spindle rate computed previously, where spindles occurring simultaneously across multiple electrodes are not recognized as the same event. We next computed the multi-electrode rate for local, regional, and multi-area spindles after L-VM and H-VM tasks. Both regional and multi-area spindles appeared more often after H-VM than L-VM (p&lt;0.038, regional spindles; p&lt;0.026, multi-area spindles; one-sided paired-sample Wilcoxon signed-rank test; average ± SEM multi-electrode rates 0.77±0.10 [0.79±0.11], 0.82±0.09 [0.99±0.13], and 0.38±0.02 [0.62±0.08] for local, regional, and multi-area spindles, respectively, in L-VM [H-VM in square brackets]) as detected by the CNN model, consistent with our hypothesis (<xref ref-type="fig" rid="fig3">Figure 3b</xref>), while local spindles did not appear more frequently (p&gt;0.34, same test). Similarly, the largest increases following H-VM versus L-VM were observed in the subset of multi-area spindles detected by the more-conservative SNR approach (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1a</xref>); however, no increase in multi-area spindles was observed with the AT algorithm (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1b</xref>). The CNN model and SNR approach thus provide clearly converging evidence that an increase in distributed spindles appears following H-VM tasks, a change that is not detected by the AT approach. These results not only validate the performance of the CNN approach in contrast to amplitude-based approaches, but also clearly demonstrate that this approach is able to find qualitatively new results providing insight into the process of human memory consolidation. Lastly, we divided EEG electrodes based on their cortical lobe (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2a</xref>) and studied the change in density of spindles in frontal, occipital, and parietal lobes in low and high visual memory conditions. To do this, in each cortical lobe, we computed the percentage of electrode sites with spindles within the detected windows by the CNN model. Interestingly, we observed a significant increase in the electrode participation during spindles in H-VM versus L-VM across cortical lobes, with the largest increase in the occipital lobe and lowest in the frontal lobe (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2b</xref>).</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Impact of visual memory load on multi-electrode sleep spindle occurrence.</title><p>(<bold>a</bold>) Schematic representation of low- and high-load visual memory tasks. (<bold>b</bold>) Multi-electrode spindle rate (average number of spindles detected per minute across the array) in high versus low visual memory condition. Spindles are grouped into local (left), regional (middle), and multi-area (right) classes as detected by the convolutional neural network (CNN) model. A significant increase in the number of spindles among subjects can be observed in multi-area and regional spindles as opposed to local spindles (p&gt;0.34, local spindles; p&lt;0.038, regional spindles; p&lt;0.02, multi-area spindles; one-sided paired-sample Wilcoxon signed-rank test).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-75769-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Low- and high-load visual memory task and its impact on sleep spindle occurrence – signal-to-noise ratio (SNR) and amplitude-thresholding (AT).</title><p>(<bold>a</bold>) Average number of spindles detected per minute in high versus low visual memory conditions by the SNR. The SNR algorithm detected a significant increase in the number of local and multi-area spindles across subjects (p&lt;0.04, local spindles; p&gt;0.07, regional spindles; p&lt;0.03, multi-area spindles; one-sided paired-sample Wilcoxon signed-rank test), with the largest increases for multi-area spindles. (<bold>b</bold>) Average number of spindles detected per minute in high versus low visual memory condition by the AT. In contrast to the CNN, AT was not able to detect any significant increase in the number of distributed spindles among subjects across all spindles classes (p&gt;0.42, local spindles; p&gt;0.24, regional spindles; p&gt;0.18, multi-area spindles; one-sided paired-sample Wilcoxon signed-rank test).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-75769-fig3-figsupp1-v1.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Cortical lobe participation.</title><p>(<bold>a</bold>) Electrode layout based on cortical lobes. (<bold>b</bold>) Average percentage of electrode sites with spindle during detected activities by the convolutional neural network (CNN) model in high versus low visual memory condition in occipital, parietal, and frontal lobes. There are significant increases in the electrode participation during spindles in the high versus low visual memory condition across cortical lobes (average ± SEM; n = 58124 for L-VM, n = 70973 for H-VM, p &lt; 1 x 10<sup>-10</sup> , occipital lobe, one-sided Wilcoxon signed-rank test; n = 58124 for L-VM, n = 70973 for H-VM, p &lt; 1 x 10<sup>-10</sup>, parietal lobe, one-sided Wilcoxon signed-rank test; n = 58124 for L-VM, n = 70973 for H-VM, p &lt; 1 x 10<sup>-9</sup>, frontal lobe, one-sided Wilcoxon signed-rank test). Interestingly, the largest increase belongs to the occipital lobe and the lowest to the frontal lobe.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-75769-fig3-figsupp2-v1.tif"/></fig></fig-group><p>We then studied the spindles detected by our CNN approach in the EEG dataset further, by applying techniques previously developed to study the spatiotemporal organization of spindles across electrodes during individual oscillation cycles (<xref ref-type="bibr" rid="bib55">Muller et al., 2016</xref>; <xref ref-type="bibr" rid="bib54">Muller et al., 2014</xref>). We first computed the average organization into rotating waves traveling from temporal, to parietal, and on to frontal lobe (denoted ‘TPF waves’) and waves rotating in the opposite direction (first temporal, then frontal, and then parietal lobe, denoted ‘TFP waves’), over all spindle events in H-VM and L-VM conditions. We observed a significant shift toward TFP waves in the H-VM versus L-VM condition (p&gt;0.50, TPF direction; p&lt;0.003, TFP direction; one-sided paired-sample Wilcoxon signed-rank test) (<xref ref-type="fig" rid="fig4">Figure 4a</xref>). This increase in TFP waves under conditions of high memory load disappears when we restrict the analysis to local spindles (<xref ref-type="fig" rid="fig4">Figure 4b</xref>), consistent with the idea that these TFP waves may be related to multi-area spindles (p&gt;0.42, TPF direction; p&gt;0.63, TFP direction; one-sided paired-sample Wilcoxon signed-rank test). We then repeated the analysis over all electrodes during multi-area spindles and again observed a significant shift in the average TFP rotating waves (p&gt;0.40, TPF direction; p&lt;0.007, TFP direction; one-sided paired-sample Wilcoxon signed-rank test) (<xref ref-type="fig" rid="fig4">Figure 4c</xref> and <xref ref-type="video" rid="video1">Video 1</xref>). These results demonstrate that multi-area spindles detected by the CNN model exhibit a clear rotating wave pattern which increases in the TFP direction under conditions of high memory load.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Impact of visual memory load on rotating waves.</title><p>(<bold>a</bold>) Average TPF (gray) and TFP (red) rotation directions computed over all spindle activities detected by the convolutional neural network (CNN) model in high versus low visual memory condition. A significant increase in the TFP direction was observed as opposed to the TPF direction in the high visual memory conditions (one-sided paired-sample Wilcoxon signed-rank test). An outlier point (low-load visual memory [L-VM], high-load visual memory [H-VM]): (0.48,0.51) in the TFP direction was omitted for the sake of visualization. (<bold>b</bold>) Average TPF rotation direction (gray) and TFP rotation direction (red) computed over just local spindles. No significant increase was observed in both directions (one-sided paired-sample Wilcoxon signed-rank test). (<bold>c</bold>) Finally, average TPF rotation direction (gray) and TFP rotation direction (red) computed over all electrodes during multi-area spindles. The increase in TFP directions became significant in high visual memory conditions in multi-area spindles (one-sided paired-sample Wilcoxon signed-rank test) which verifies that the increase is driven by the multi-area spindles. An outlier point (L-VM, H-VM): (0.51,0.56) in the TPF direction was omitted for the sake of visualization.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-75769-fig4-v1.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Average rotation direction (surrogate data – simulated rotating waves).</title><p>(<bold>a</bold>) Average degree of rotational direction (<xref ref-type="disp-formula" rid="equ2 equ3">Equations 2 and 3)</xref> computed over simulated rotating spindles (black) with TPF direction (compre with <xref ref-type="video" rid="video3">Video 3</xref>) and shuffled spindles with no rotating direction (blue). As expected, the average positive direction (TPF) is close to 1 and the negative direction (TFP) is low, similar to the shuffled version in both directions. (<bold>b</bold>) Average degree of rotational direction computed over simulated rotating spindles (black) with TFP direction (compare with <xref ref-type="video" rid="video3">Video 3</xref>) and non-rotating spindles (blue). Similarly, the average negative direction is high for rotating spindles and the positive direction is low and close to the shuffled version.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-75769-fig4-figsupp1-v1.tif"/></fig></fig-group><media mimetype="video" mime-subtype="mp4" id="video1" xlink:href="elife-75769-video1.mp4"><label>Video 1.</label><caption><title>Rotating waves in multi-area spindles.</title><p>An example of a rotating wave in TFP direction during a multi-area spindle detected by the convolutional neural network (CNN) model in the electroencephalogram (EEG) recording. Z-score of bandpass filtered (here 9–18 Hz) signals are plotted in falsecolor in a lateral view of the scalp EEG (where frontal, temporal, and parietal lobes are, respectively, located on the right-hand side, the bottom center and top center).</p></caption></media></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>These results may tie the increase in multi-area spindles to the neural circuit mechanism that we have previously identified could play a role in consolidating memories across distributed networks in cortex through synaptic plasticity (<xref ref-type="bibr" rid="bib55">Muller et al., 2016</xref>). Synaptic plasticity occurs through spike time-dependent plasticity (STDP) (<xref ref-type="bibr" rid="bib7">Bi and Poo, 1998</xref>; <xref ref-type="bibr" rid="bib44">Markram et al., 1997</xref>), for which presynaptic vesicle release and postsynaptic spiking must occur with a precision of a few milliseconds (<xref ref-type="bibr" rid="bib42">Magee and Johnston, 1997</xref>). While it has become increasingly clear that sleep spindles play an active and causal role in sleep-dependent memory consolidation (<xref ref-type="bibr" rid="bib4">Aton et al., 2014</xref>; <xref ref-type="bibr" rid="bib13">Clemens et al., 2005</xref>; <xref ref-type="bibr" rid="bib27">Eschenko et al., 2006</xref>; <xref ref-type="bibr" rid="bib33">Gais et al., 2002</xref>; <xref ref-type="bibr" rid="bib48">Mednick et al., 2013</xref>; <xref ref-type="bibr" rid="bib67">Rasch and Born, 2013</xref>), it remains unclear how these oscillations coordinate activity across areas to shape neocortical assemblies distributed over long distances (<xref ref-type="bibr" rid="bib39">Klinzing et al., 2019</xref>). In previous work, we studied the spatiotemporal dynamics of the sleep spindle oscillation in intracranial ECoG recordings from human clinical patients, and we found that – instead of being synchronized with zero delay throughout the cortex – sleep spindles are often organized into rotating waves traveling across the cortex in a preferred direction (<xref ref-type="bibr" rid="bib55">Muller et al., 2016</xref>). Because these waves travel at the same speed as axonal conduction across long-range white matter fiber networks in cortex, the offsets of activity across areas could precisely align spikes across areas to create the conditions necessary for bi-directional synaptic plasticity (<xref ref-type="fig" rid="fig5">Figure 5</xref>) – either for creating strong links between assemblies distributed widely across cortex or for downscaling connections to maintain synaptic homeostasis (<xref ref-type="bibr" rid="bib17">Crunelli et al., 2018</xref>; <xref ref-type="bibr" rid="bib39">Klinzing et al., 2019</xref>; <xref ref-type="bibr" rid="bib79">Tononi and Cirelli, 2014</xref>). Importantly, previous theoretical work has identified the relative phase of sending and receiving populations as an important factor in determining the balance toward potentiation or depotentiation by STDP during these rhythms (<xref ref-type="bibr" rid="bib53">Muller et al., 2011</xref>) and future computational analyses could study these offsets in detail. At the circuit level, thalamocortical circuits may set the rhythm for spindle oscillations in cortex (<xref ref-type="bibr" rid="bib12">Clascá et al., 2012</xref>; <xref ref-type="bibr" rid="bib25">Destexhe and Sejnowski, 2001</xref>), which are then shaped into waves by long-range corticocortical connections (and their axonal time delays). Understanding the network mechanism for this interplay between thalamocortical and corticocortical connections is thus an important subject for future computational analyses and network models.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Rotating waves during multi-area sleep spindles provide a mechanism for linking local neuronal populations distributed across cortex.</title><p>(Left) Spindles that appear across multiple areas are often organized into rotating waves in human cortex. (Right) Phase offsets between cortical regions emerging during rotating waves correspond to axonal conduction delays of white matter fibers and can provide a mechanism to align spikes between cell populations distributed widely across cortex.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-75769-fig5-v1.tif"/></fig><p>This mechanism places the spatial extent of spindles across cortex, and how this extent changes under different memory conditions, as a critical point in understanding the neural process of sleep-dependent memory consolidation. The spatial extent of spindles we reported in this work provides a potential mechanism by which long-range excitatory connections between distant populations in cortex could be strengthened during memory consolidation in sleep. Based on this mechanism, we then hypothesized that large, multi-area spindles may exhibit an increase following H-VM tasks. Consistent with this additional hypothesis, both the CNN and SNR methods detect an increase in multi-area spindles and rotating waves uniquely following H-VM tasks. This increase in multi-area spindles was further associated with an increase in waves traveling in the temporal → frontal → parietal (TFP) direction. Interestingly, these TFP waves are opposite to the dominant rotation direction observed in previous work (<xref ref-type="bibr" rid="bib55">Muller et al., 2016</xref>), potentially reflecting increased top-down influence from higher cortical areas following the high-load memory condition. These present results clearly indicate that different memory conditions can modulate the extent and spatiotemporal organization of sleep spindles across cortex; however, future analyses of intracranial recordings at very high spatial and temporal resolution during memory tasks will be needed to fully understand the spatiotemporal dynamics reported here and their connection to the process of sleep-dependent memory consolidation.</p><p>Previous work has found that spindles can occur broadly across the cortex with low measures of synchrony in EEG and magnetoencephalography (<xref ref-type="bibr" rid="bib22">Dehghani et al., 2011a</xref>; <xref ref-type="bibr" rid="bib23">Dehghani et al., 2011b</xref>, <xref ref-type="bibr" rid="bib21">Dehghani et al., 2010</xref>), and also in iEEG recordings (<xref ref-type="bibr" rid="bib31">Frauscher et al., 2015</xref>). The results reported in our work may provide insight into the underlying mechanism for these previous findings: because traveling waves introduce systematic phase offsets across sites, traveling waves during multi-area spindles can account for increases in spindle power across broad regions of cortex that also show low synchrony (as measured, for example, by correlation between electrode sites in <xref ref-type="bibr" rid="bib31">Frauscher et al., 2015</xref>). The results reported in this work highlight the importance of distinguishing between the extent of spindle occurrence (as with detecting individual spindle events in this work) and measures of synchrony. Further comparisons focusing on spatiotemporal dynamics and spindle synchrony, for example with simultaneous EEG and iEEG recordings, will be important for future work.</p><p>Taken together, these results provide considerable and convergent evidence from both human and NHP sleep that (1) the spatial extent of sleep spindles was previously underestimated by AT approaches (which tend to select only the highest-amplitude events) (<xref ref-type="fig" rid="fig2">Figure 2</xref>), (2) this spatial extent can be modulated by the specific memory conditions prior to sleep (<xref ref-type="fig" rid="fig3">Figure 3</xref>), and (3) increased spatial extent in sleep spindles following H-VM tasks is also associated with rotating waves traveling in a specific direction across cortex (<xref ref-type="fig" rid="fig4">Figure 4</xref>). To analyze these sleep recordings, we adapted newly developed deep learning approaches for detecting rhythmic events in high-noise data (<xref ref-type="bibr" rid="bib34">George and Huerta, 2018</xref>; <xref ref-type="bibr" rid="bib62">Perol et al., 2018</xref>). The detection process involves two steps: first, we use a simple algorithm (here, the SNR approach) to detect a subset of high-quality examples that can be used for training the CNN, and second, we use the CNN to detect events throughout the recording. The fact that this two-step training approach works well on recordings with very different electrode types and spatial sampling (ranging from scalp EEG to invasive intracranial depth electrodes, <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3a</xref>) demonstrates promise of this computational tool for analysis of other rhythmic waveforms that may be of interest in high-noise biological recordings.</p><p>We believe this two-step approach represents a methodological advance, coupling a constrained initial detection step with a CNN model that can detect a comprehensive set of events in noisy neural recordings. Our toolbox for this two-step training protocol is available online (<ext-link ext-link-type="uri" xlink:href="http://github.com/mullerlab/spindlecnn">http://github.com/mullerlab/spindlecnn</ext-link>), with detailed documentation for applications to new neural rhythms and general timeseries data across biology. We believe this technique can provide a first step in addressing an important methodological consideration in analysis of sleep: how can we make population-level statements about a set of neural events detected algorithmically in the absence of a ground truth, without relying on arbitrarily defined thresholds? This technique could be useful throughout biology where questions such as this arise. At the same time, however, we must emphasize that, while the CNN provided a robust method to sensitively detect a comprehensive set of spindles in the sleep recordings studied here, care must be taken both to understand the mechanisms underlying the selections by deep learning algorithms in each case and to validate results on well-constructed controls. Importantly, future work to expand these methods to new sleep phenomena or other biological rhythms should carefully consider the control analyses developed here (e.g., <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplements 2</xref> and <xref ref-type="fig" rid="fig1s10">10</xref>), along with the analyses developed to understand the features selected by the convolutional model after training (<xref ref-type="fig" rid="fig1s7">Figure 1—figure supplements 7</xref> and <xref ref-type="fig" rid="fig1s8">8</xref>) and the choice of CNN architecture (<xref ref-type="fig" rid="fig1s9">Figure 1—figure supplement 9</xref>). In particular, the control analyses using the subset of spindles detected by the SNR algorithm represents a useful strategy to validate findings from the CNN, as the SNR method is both highly interpretable and has well-controllable statistical performance (as inspired from the constant false alarm rate technique in radar). We thus believe that this set of methods can inspire future well-controlled studies utilizing open-access data that are increasingly available for computational analysis of neural dynamics in intracranial recordings (<xref ref-type="bibr" rid="bib8">Boran et al., 2020</xref>; <xref ref-type="bibr" rid="bib32">Frauscher et al., 2018</xref>; <xref ref-type="bibr" rid="bib58">Nejedly et al., 2020</xref>; <xref ref-type="bibr" rid="bib77">Stolk et al., 2018</xref>; <xref ref-type="bibr" rid="bib80">von Ellenrieder et al., 2020</xref>).</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Recordings</title><p>We studied performance of the CNN model across three sleep datasets that include full recordings annotated as sleep without excluding REM states obtained from electrodes ranging from traditional scalp EEG to invasive intracranial depth electrodes. These datasets represent recordings from very different electrode types, which vary widely in resolution and SNR. Training the CNN model in the same way over these very different recordings demonstrates the generality of the framework developed here; further, these results also represent a cross-species comparison of sleep-rhythm dynamics in NHP and human neocortex.</p><p>The first dataset contains ECoG recording from most of the lateral cortex in two macaques during natural sleeping conditions (<xref ref-type="bibr" rid="bib83">Yanagawa et al., 2013</xref>). Recordings were obtained from 128 electrodes in both monkeys and sampled at 1 kHz by a Cerebus data acquisition system (Blackrock Microsystems, Salt Lake City, UT). Sleep state was determined by the degree of spatial synchronization in slow wave oscillations and a significant increase in delta power was reported in sleep condition versus waking activity (<xref ref-type="bibr" rid="bib11">Chauvette et al., 2011</xref>; <xref ref-type="bibr" rid="bib18">Dang-Vu et al., 2005</xref>; <xref ref-type="bibr" rid="bib24">Destexhe et al., 1999</xref>; <xref ref-type="bibr" rid="bib56">Murphy et al., 2009</xref>). This dataset was recorded and distributed by Laboratory for Adaptive Intelligence, BSI, RIKEN, and was made freely available at <ext-link ext-link-type="uri" xlink:href="http://neurotycho.org/anesthesia-and-sleep-task">http://neurotycho.org/anesthesia-and-sleep-task</ext-link>.</p><p>The second dataset contains high-density scalp EEG recording from 20 healthy participants (<xref ref-type="bibr" rid="bib49">Mei et al., 2018</xref>). Each participant participated in two separate sessions and completed an H-VM and L-VM task. The recordings were obtained during naps following the visual memory tasks from a 64-electrode EEG skull cap and sampled at 1 kHz. Sleep state was manually assessed by an expert for stage 2 NREM sleep. Ultimately, sleep recordings that did not reach stage 2 sleep or were too noisy were excluded from the study. Under these criteria, four subjects were excluded (subjects 12, 20, 26, and 27). In addition, the recordings were common average referenced to remove large artifacts with potentially non-neural origin. These recordings were made freely available at the Open Science Framework through the link <ext-link ext-link-type="uri" xlink:href="https://osf.io/chav7">https://osf.io/chav7</ext-link>.</p><p>The last dataset contains iEEG recordings from five epileptic patients in the Epilepsy Monitoring Unit (EMU) at London Health Sciences Centre (LHSC). Patients were implanted using depth electrodes for the sole purpose of surgical evaluation. Informed consent was collected from the patients in accordance with local Research Ethics Board (REB) guidelines. Each patient was implanted with 9–15 iEEG electrodes located across the cortex with up to 10 contacts in gray or white matter. The iEEG signals were recorded continuously for a duration of 7–14 days for the purpose of seizure localization. We used clinically annotated sleep onsets and studied half an hour recording starting from the beginning of the sleep/nap cycles in electrode contacts located within gray matter.</p></sec><sec id="s4-2"><title>SNR measure for sleep spindle detection</title><p>To specify a subset of spindles required to train our CNN model, we implemented a modified version of SNR algorithm (<xref ref-type="bibr" rid="bib55">Muller et al., 2016</xref>). This algorithm, which is inspired by the adaptive, CFAR technique in radar, was used to detect narrow-band rhythmic activities. We measure the ratio of power within the frequency band of interest (here, 9–18 Hz) to power in the rest of the spectrum (1–100 Hz bandpass, with band-stop at 9–18 Hz) at each electrode. The SNR measure is computed over a sliding window of time (500 ms) and produces an estimate of how power in the frequency band of interest compares to total power in the recording, taking into account the noise on individual electrodes. We then used the SNR algorithm to produce high-quality training samples for the CNN model. To do this, we reduced the probability of false positives by setting the threshold to the 99th percentile of the SNR distribution, thus detecting only the activity patterns that have the highest unique power concentration in the spindle frequency range. We additionally required the SNR algorithm to only include activities with a duration between 0.5 and 3 s, consistent with the duration of sleep spindles. The detected windows are then used for training the CNN model.</p><p>To additionally verify performance of the SNR algorithm, we implemented this approach over 1 s recordings of a 90 by 90 array of local field potentials (LFPs) generated by a spiking network model of cortical activity in the awake state (<xref ref-type="bibr" rid="bib20">Davis et al., 2021</xref>), which does not contain the thalamic reticular loops and thalamocortical projections needed to generate sleep spindles. This model, composed of several million neurons with biologically realistic synaptic connectivity (and several thousand synapses per cell), creates realistic ongoing activity patterns consistent with the well-studied asynchronous-irregular state, corresponding to activity in the cortex of awake animals (<xref ref-type="bibr" rid="bib26">Destexhe, 2009</xref>). In addition, this model utilizes a recently developed LFP proxy (<xref ref-type="bibr" rid="bib46">Mazzoni et al., 2015</xref>), allowing us to analyze a population signal using our spindle detection algorithm. SNR values calculated from these data were uniformly below 0 dB, confirming the robustness of our approach in uniquely detecting spindle frequency activity through a known ground truth dataset.</p></sec><sec id="s4-3"><title>CNN for sleep spindle detection</title><p>We developed a CNN to detect spindles during sleep. The model is motivated by the successful implementation of convolutional networks for waveform detection with earthquakes and gravitational waves in high-noise settings (<xref ref-type="bibr" rid="bib34">George and Huerta, 2018</xref>; <xref ref-type="bibr" rid="bib62">Perol et al., 2018</xref>). If trained properly, it has the ability to detect clearly formed spindles ranging from low to high amplitudes (<xref ref-type="fig" rid="fig1">Figure 1d</xref>) and provides a great opportunity to study the spatial and temporal analysis of spindle activities across the cortex. We implemented an architecture similar to the one proposed by <xref ref-type="bibr" rid="bib34">George and Huerta, 2018</xref>, with small modifications to the input and convolutional layers to take into account the basic features of the spindle rhythm in cortex (e.g. average duration). The CNN architecture is also slightly tailored to different sampling rates in each recording modality. As in previous work, the convolutional layer is designed to start by extracting local features, gradually extracting longer-timescale features by decreasing the feature space. Using this strategy, the CNN model can efficiently learn to detect the specific waveform characteristics of the sleep spindle in different types of recordings.</p><p>We verified model quality using ECoG recordings by minimizing the difference between predicted and training labels marked by the SNR approach. In addition, we verified that the proposed CNN model is not sensitive to the slight change in the number of layers (e.g. 4, 5, and 6 convolutional layers) and hyperparameters such as learning rate, maximum number of epochs used for training, and pooling parameters by conducting a comprehensive sensitivity analysis (<xref ref-type="supplementary-material" rid="supp3">Supplementary file 3</xref>). To perform this sensitivity analysis, for each CNN architecture, we made a grid search over the potential range of hyperparameters, measuring the similarity of model output by Cronbach’s alpha. Similarity across hyperparameters within 10–50% of those used in our analysis was greater than 0.96, indicating high reproducibility under moderate parameter variability. We selected one of the best architectures and a combination of hyperparameters that we tested in the grid search (<xref ref-type="fig" rid="fig1">Figure 1c</xref>). We then used the same architecture and hyperparameters across all subjects and recording datasets. We trained a separate CNN model for each subject on a portion of the available recording and then applied the trained model to detect spindles across the entire recording. Our CNN model is a one-dimensional (1D) model (applied always independently to individual electrodes in the recording) with five convolutional layers (with 32, 64, 128, 192, and 256 filters) and four fully connected layers (with sizes 128, 64, 32, and 2). Each convolutional layer is followed by a maxpool and rectified linear unit layers, and the output of the fifth convolutional layer is gradually flattened into 2D vectors using the fully connected layers followed by rectified linear unit layers. Our classifier has an additional softmax layer at the end which returns the probability of a spindle in addition to the predicted label.</p><p>We trained a separate CNN model for each subject over a subset of spindle and non-spindle windows selected from the sleep recordings. To deal with the classification problem of a highly imbalanced training set, we randomly selected a subset of non-spindle windows (up to twice the number of spindles) and then trained the model over the new dataset. In our training process, we noticed that a subset of approximately 1500 windows of spindle and non-spindles can provide enough data for training the CNN model. After training the CNN model, we implemented the model over the entire sleep recording. The CNN model takes a sliding window of sleep recording (500 ms which is bandpass filtered at 1–100 Hz after removal of line noise and harmonics) as an input and predicts its label (spindle or non-spindle). The sliding window starts at the beginning of the recording and moves 100 ms in each step. To find the start and end time of a spindle, we first combined all overlapping spindle windows. We then included neighbor windows if there is any spindle within 100 ms of the combined windows to account for potentially mislabeled windows. The start of a spindle is finally set to the beginning of the first window, and the end of the spindle is set to the end of the last window. To study the spatial extent of spindles, we then classify detected events as local (1–2 recording sites), regional (3–10 sites), or multi-area (more than 10 sites) in each window. We note that classifying events in this way allows correctly characterizing an event that starts as a local spindle and then evolves to a multi-area event, by counting the times where the event was local separately from the times where the event was distributed across many sites.</p></sec><sec id="s4-4"><title>PSD estimate</title><p>To verify performance of the CNN, SNR, and AT approaches, we compared PSD estimates of spindle and non-spindle activities (Welch’s method; <xref ref-type="fig" rid="fig1">Figure 1b</xref>, <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplements 3b</xref> and <xref ref-type="fig" rid="fig1s10">10</xref>). In both cases, we first removed line noise artifacts. We then computed PSD over windows of 0.5 s with no overlap and average spectra over detected events. Matched non-spindle PSDs were estimated over a large number of randomly selected non-spindle windows. The increase in the power during the natural frequency range of sleep (~9–18 Hz) in spindle versus non-spindles activities demonstrates the ability of both the CNN model and SNR algorithm to correctly identify spindle activities.</p></sec><sec id="s4-5"><title>Time-shifted averaging control</title><p>As an additional control analysis, we computed averages over detected spindles, with activity shifted to centrally align the largest oscillation peak in the detected time window. To compute this average, we first needed to correct for the time offset between different spindles. To do this, we shifted detected spindles to the largest positive value within the detected window, corresponding to the positive potential of an individual spindle oscillation cycle, and then took the average over all time-shifted windows. The average of time-shifted signals is computed over spindle windows detected by the CNN approach, as well as matched randomly selected non-spindle windows. Importantly, while the time-shifted average clearly exhibits 11–15 Hz oscillatory structure when computed over spindle events detected by the CNN, this need not be the case, as demonstrated by application of the same approach to matched non-spindle events (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>). The peaks observed in the center of the signal averaged over non-spindle windows are due to the alignment procedure. Naturally, this peak exhibited a decay consistent with the autocorrelation time present in the signal; importantly, however, it shows no oscillatory structure consistent with spindle activity in the non-spindle windows. This result demonstrates that our CNN model can correctly distinguish between spindle and non-spindle events.</p><p>We also systematically studied the sensitivity of the CNN model as a function of the SNR threshold used for building the training set. To do this, we computed the time-shifted average over spindle events detected by the CNN model at different levels of the SNR threshold (<xref ref-type="fig" rid="fig1s11">Figure 1—figure supplement 11</xref>). Clear, well-formed 11–15 Hz oscillatory structure is observed in the time-shifted averages above 0 dB threshold, verifying the quality of detected spindles by the corresponding CNN models. However, the 11–15 Hz oscillatory structure starts to disappear below 0 dB because an SNR threshold below 0 dB introduces errors into the training sets by mislabeling noise signals as spindles. On the other hand, similar oscillatory shapes of time-shifted average above 0 dB confirms the ability of the CNN model to perform robustly while trained over different sets of clearly formed spindles.</p></sec><sec id="s4-6"><title>Comparison with AT approach</title><p>The AT approach has been used extensively in the literature to automatically detect spindles during sleep (<xref ref-type="bibr" rid="bib33">Gais et al., 2002</xref>; <xref ref-type="bibr" rid="bib61">Nir et al., 2011</xref>). In this approach, a spindle is detected when the amplitude of the bandpass signal stays above a threshold for a limited period of time (e.g. at least 500 ms; cf. Figure S5 in <xref ref-type="bibr" rid="bib61">Nir et al., 2011</xref>). To implement this approach, we first bandpass filter the signal at the frequency of 11–15 Hz and then compute the signal envelope using Hilbert transformation over a sliding window of 0.5 s. The sliding window starts at the beginning of the recording and moves 100 ms in each step. The start and end time of each spindle is computed similarly as with the CNN model, where we combine overlapping spindle windows and neighbor windows within 100 ms. A spindle is detected whenever the signal envelope stays above the predetermined threshold for at most 3 s.</p><p>To determine the most appropriate threshold for comparison to the CNN and SNR approaches, we first computed the distribution of electrode-level RMS amplitude that results in approximately 2 spindles per minute and then set the overall threshold to its average across all electrodes. The overall threshold is computed independently for each subject to account for the differences across subjects as well as across different electrodes. The quality and extent of detected spindles by the AT approach was then compared with the CNN and SNR (<xref ref-type="fig" rid="fig2">Figure 2c</xref>, <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplements 1</xref> and <xref ref-type="fig" rid="fig1s3">3</xref>, 4, 10, and 12, <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplements 1</xref> and <xref ref-type="fig" rid="fig2s2">2</xref>, and <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). The CNN model has a relatively amplitude-invariant nature in comparison with the AT approach, which is highly sensitive to a predefined cutoff AT. The AT approaches may only select spindles with the largest-amplitude events, or could miss ones that temporarily dip below the threshold, while our approach has the ability to find well-formed spindles that are both large and small in amplitude (cf. first and third EEG spindles of <xref ref-type="fig" rid="fig1">Figure 1d</xref> which were not detected by AT and <xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>). Consistent with our expectation, the AT approach detects spindles of higher amplitude than the CNN approach (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3b</xref>) with the exception of the EEG dataset, where lower SNR may obscure this effect.</p></sec><sec id="s4-7"><title>Simulated data control – signal amplitude</title><p>We simulated 60 min of recording containing on average 3 spindles per minute. The spindles were simulated using<disp-formula id="equ1">,<label>(1)</label><mml:math id="m1"><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mi>A</mml:mi><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>(</mml:mo><mml:mi>ω</mml:mi><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf4"><mml:mi>A</mml:mi></mml:math></inline-formula> is the oscillation amplitude, <inline-formula><mml:math id="inf5"><mml:mi>ω</mml:mi></mml:math></inline-formula> is the oscillation angular frequency,<inline-formula><mml:math id="inf6"><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mo>[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:math></inline-formula> is sample number, <inline-formula><mml:math id="inf7"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is the initial polar angle. Oscillation amplitude (<inline-formula><mml:math id="inf8"><mml:mi>A</mml:mi></mml:math></inline-formula>) was set to a constant value, and the oscillation angular frequency (<inline-formula><mml:math id="inf9"><mml:mi>ω</mml:mi></mml:math></inline-formula>) and initial polar angle (<inline-formula><mml:math id="inf10"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>) were randomly selected from, respectively, 11–15 Hz spindle frequency range and <inline-formula><mml:math id="inf11"><mml:mo>[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>]</mml:mo></mml:math></inline-formula>. We also added two types of noise to the signal including white noise with constant power spectrum, and Brownian noise with <inline-formula><mml:math id="inf12"><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> power spectrum.</p><p>We utilized these surrogate data, which have a clear PSD peak in the spindle frequency range (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1a</xref>), to study how sensitive the SNR approach is to the change in spindle and noise amplitude as opposed to the AT techniques. We first applied the SNR algorithm and AT approach to the simulated signal to detect spindle activities. For the SNR approach, we used either the 99th percentile of the SNR distribution, or 0 dB if greater (which represents parity between power in the spindle passband and the rest of the signal spectrum) as the threshold. For the AT approach, we used three standard deviations of instantaneous amplitude. We then repeated the entire analysis once after we doubled the noise amplitude, and once after dividing the spindle amplitude in half. <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1b</xref> contains an example of spindle activity detected by both approaches in the original signal. Interestingly, in the higher-noise setting, as well as with lower-amplitude spindles, the SNR approach was still able to detect the spindle activity while the AT approach failed to detect the spindles (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1c and d</xref>). These results demonstrate the superior and robust performance of the SNR algorithm in face of changes in signal and noise amplitude.</p></sec><sec id="s4-8"><title>Simulated data control – varying noise</title><p>We simulated 30 min recording of a 10 by 10 array of electrodes containing on average 2 spindles per minute. The spindles were simulated using <xref ref-type="disp-formula" rid="equ1">Equation 1</xref> where oscillation amplitude (<inline-formula><mml:math id="inf13"><mml:mi>A</mml:mi></mml:math></inline-formula>) was set such that it follows the standard spindle waning and waxing pattern, and the oscillation angular frequency (<inline-formula><mml:math id="inf14"><mml:mi>ω</mml:mi></mml:math></inline-formula>) and initial polar angle (<inline-formula><mml:math id="inf15"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>) were randomly selected from 11 to 15 Hz spindle frequency range and <inline-formula><mml:math id="inf16"><mml:mo>[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>]</mml:mo></mml:math></inline-formula>, respectively.</p><p>We added different types of noise to the signal to verify that the CNN model is relatively general to the type of noise, provided there is enough training data and high-quality marked events. To do this, we chose noise with different type of power spectrum including (1) white noise with constant power spectrum; (2) noise with <inline-formula><mml:math id="inf17"><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>f</mml:mi></mml:msqrt></mml:math></inline-formula> power spectrum; (3) pink noise with <inline-formula><mml:math id="inf18"><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>f</mml:mi></mml:math></inline-formula> power spectrum; and lastly (4) Brownian noise with <inline-formula><mml:math id="inf19"><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> power spectrum. We also studied change in the performance of the CNN and AT approaches under biological forms of noise such as REM theta oscillation and non-biological artifacts. We simulated theta oscillations with similar characteristics to the spindle oscillation with angular frequency (<inline-formula><mml:math id="inf20"><mml:mi>ω</mml:mi></mml:math></inline-formula>) and duration randomly selected from 4 to 8 Hz and 400–1000 ms. For non-biological artifacts, we first randomly chose a subset of artifacts detected as spindles by the AT approach in the iEEG recording. We then used the fast Fourier transform (FFT) to convert these artifacts into frequency domain. We next used the signal amplitude and randomly selected phases from <inline-formula><mml:math id="inf21"><mml:mo>[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>]</mml:mo></mml:math></inline-formula>, to generate a new set of artifacts and used the inverse FFT to convert the signal back to time domain. We visually inspected the simulated artifacts and verified the signals by comparing the PSD of the simulated artifacts with the original artifacts (<xref ref-type="fig" rid="fig1s6">Figure 1—figure supplement 6a</xref>).</p><p>For each type of noise, we first used the SNR algorithm to generate a subset of high-quality spindles for training the CNN model. After training the CNN model, we implemented the CNN model and AT approach to detect spindle activities. Lastly, we compared the detected activity by CNN, SNR, and AT with the actual spindles (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>). In all cases, the CNN was able to efficiently learn to detect the specific waveform characteristics distinguishing the sleep spindle rhythm in these recordings (e.g. <xref ref-type="fig" rid="fig1s5">Figure 1—figure supplement 5</xref>) showing that we can expect this approach to generalize well across recordings with different types of noise.</p><p>Moreover, we further studied the effect of artifacts on performance of the CNN and AT approach by systematically increasing the number of artifacts per minute in the surrogate data. In particular, the AT approach seems to be very sensitive to recording artifacts. The CNN model performs robustly in face of increases in the number of artifacts, while the performance of the AT gradually decreases as the number of artifacts per minute increases (<xref ref-type="fig" rid="fig1s6">Figure 1—figure supplement 6b</xref>). This result further verifies that our approach is not sensitive to different types of artifact in the recording as opposed to the AT approach.</p></sec><sec id="s4-9"><title>Rotating wave direction</title><p>To estimate the degree of rotational activity in the multi-area spindles, we compute<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo><mml:mi> </mml:mi><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>x</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>θ</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi> </mml:mi></mml:mrow></mml:mfenced><mml:mo>;</mml:mo></mml:math></disp-formula><disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mi>x</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>θ</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfenced><mml:mo>;</mml:mo></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf22"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> and <inline-formula><mml:math id="inf23"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> are, respectively, positive and negative rotation direction at time <inline-formula><mml:math id="inf24"><mml:mi>t</mml:mi><mml:mo>,</mml:mo></mml:math></inline-formula><inline-formula><mml:math id="inf25"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> is the phase angle of <inline-formula><mml:math id="inf26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> electrode at time <inline-formula><mml:math id="inf27"><mml:mi>t</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf28"><mml:mi>N</mml:mi></mml:math></inline-formula> is the total number of electrodes, and <inline-formula><mml:math id="inf29"><mml:mi>θ</mml:mi></mml:math></inline-formula> is the electrodes’ polar angle with respect to the sagittal plane along the midline of the brain. This metric allows us to quantify the strength of the rotational pattern of activity in TPF and TFP on the array of electrodes during spindle activity (<xref ref-type="fig" rid="fig4">Figure 4</xref>). The proposed metrics are validated using simulated data (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref> and <xref ref-type="video" rid="video2">Videos 2</xref> and <xref ref-type="video" rid="video3">3</xref>) in the following section.</p><media mimetype="video" mime-subtype="mp4" id="video2" xlink:href="elife-75769-video2.mp4"><label>Video 2.</label><caption><title>Simulated TPF waves are well detected by our computational approach.</title><p>An example of surrogate data, with simulated rotating spindles in the TPF direction. Z-score of bandpass filtered (here 9–18 Hz) signals are plotted in falsecolor in a lateral view of the scalp electroencephalogram (EEG) (where frontal, temporal, and parietal lobes are, respectively, located on the right-hand side, the bottom center and top center).</p></caption></media><media mimetype="video" mime-subtype="mp4" id="video3" xlink:href="elife-75769-video3.mp4"><label>Video 3.</label><caption><title>Simulated TFP waves are well detected by our computational approach.</title><p>An example surrogate data, with simulated rotating spindles in the TFP direction.</p></caption></media></sec><sec id="s4-10"><title>Simulated data control – rotating wave</title><p>We simulated multi-area spindles with rotational wave organization across the 10–20 system of EEG recordings. We simulated rotating waves using<disp-formula id="equ4">,<label>(4)</label><mml:math id="m4"><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mi>A</mml:mi><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>(</mml:mo><mml:mi>ω</mml:mi><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>γ</mml:mi><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>σ</mml:mi><mml:mi>η</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf30"><mml:mi>A</mml:mi></mml:math></inline-formula> is the oscillation amplitude, <inline-formula><mml:math id="inf31"><mml:mi>ω</mml:mi></mml:math></inline-formula> is the oscillation angular frequency, <inline-formula><mml:math id="inf32"><mml:mi>γ</mml:mi></mml:math></inline-formula> is the polar wavenumber, <inline-formula><mml:math id="inf33"><mml:mi>θ</mml:mi></mml:math></inline-formula> is the polar angle with respect to the wave center, <inline-formula><mml:math id="inf34"><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mo>[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:math></inline-formula> is sample number, and <inline-formula><mml:math id="inf35"><mml:mi>η</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> is a real-valued Gaussian white noise term (compare with Equation 12 in <xref ref-type="bibr" rid="bib55">Muller et al., 2016</xref>). Oscillation amplitude (<inline-formula><mml:math id="inf36"><mml:mi>A</mml:mi></mml:math></inline-formula>) and polar wave number (<inline-formula><mml:math id="inf37"><mml:mi>γ</mml:mi></mml:math></inline-formula>) were set to unity, without loss of generality, and oscillation angular frequency, <inline-formula><mml:math id="inf38"><mml:mi>ω</mml:mi></mml:math></inline-formula>, is selected randomly from 11 to 15 Hz spindle frequency range, and lastly, the noise term <inline-formula><mml:math id="inf39"><mml:mi>σ</mml:mi><mml:mi>η</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> was set to zero for the sake of simplicity. We set <inline-formula><mml:math id="inf40"><mml:mi>θ</mml:mi></mml:math></inline-formula> with respect to the polar angle of electrodes in the 10–20 system and the sagittal plane along the midline of the brain (compare with <xref ref-type="video" rid="video2">Videos 2</xref> and <xref ref-type="video" rid="video3">3</xref>). As expected, the average positive direction estimated over 1000 simulated multi-area spindles was almost 0.9, while the average over the negative direction was almost 0.1, which is close to the case with no synchronized activity (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1a</xref>, <xref ref-type="video" rid="video2">Video 2</xref>). We verified the direction by reversing the traveling wave in our simulation and achieving the opposite result (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1b</xref>, <xref ref-type="video" rid="video3">Video 3</xref>). The simulation results confirm the accuracy of our measure for estimating rotational direction in multi-area spindles.</p></sec><sec id="s4-11"><title>CNN visualization and interpretation</title><p>To better understand how the CNN model detects spindle oscillation, we studied the filter and saliency maps of the CNN models. To do this, we first simulate six spindle/non-spindle signals (500 ms), including (1) white noise and spindle; (2) white noise and ‘half spindle’ signal; (3) white noise and combination of two spindles of different amplitude; (4) white noise and theta oscillation; (5) pure white noise; and (6) white noise and Brownian noise. We then visualized the filters and saliency maps across these simulated signals as an input to a CNN model trained on the EEG dataset.</p><p>To better visualize the filters, we plotted the output features of the CNN layers. The feature maps visualize CNN filters applied into input signals. In <xref ref-type="fig" rid="fig1s7">Figure 1—figure supplement 7</xref>, we plot an example feature map from the last convolutional layer of the CNN model across the six simulated signals. This feature map can accurately detect the maximum amplitude within each cycle using the maximum activation of the CNN model across all oscillations. Interestingly, we observe a relatively similar pattern of activation across the remaining filters, indicating that the timing and relative height of the maximum amplitudes represent the type of activity pattern in the input signal (spindle versus non-spindle). Using these features, the CNN model can learn to reliably detect the specific waveform characteristics of the sleep spindle in different types of recordings.</p><p>In addition, we studied gradient attribution maps to identify part of the signal that are most important for classification in the CNN model. To do this, we plot the gradient of the predicted spindle/non-spindle class with respect to simulated signals (<xref ref-type="fig" rid="fig1s8">Figure 1—figure supplement 8</xref>). The area of the signal with the highest modulation in amplitude has the greatest impact on the classification. For example, in the ‘half spindle’ signal, only the half of the signal containing the spindle oscillation is of importance in the classification. In the signal with spindles of different amplitude, the spindle with the highest amplitude is relatively more important than the other half of the signal. The pattern of activations and gradient map across the simulated signals provides insights into the underlying mechanism by which the CNN model efficiently distinguishes between different types of oscillation.</p></sec><sec id="s4-12"><title>CNN choice of architecture and hyperparameter setting</title><p>The CNN architecture should be tailored with respect to the duration of rhythmic activity, type of oscillation, and sampling rates of recording modality. The duration of the rhythmic activity and sampling rate determine the length of the sliding window for the CNN model. For example, in our NHP EEG recording with the sampling rate of 1000 Hz, the sliding window is set to 0.5 s which is the minimum duration of spindle activities observed during sleep and contains 500 data points. We next specify the filter size with respect to the length of the sliding window and types of rhythmic activity. The CNN layer is designed to start by extracting local features, gradually extracting longer-timescale features by decreasing the feature space. Filter sizes covering approximately one oscillation cycle (70–120 ms) are effective in detecting spindle activity. To understand this further, we simulate 10 recordings with 2 spindles per minute and add different types of noise and artifacts (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>). Using these surrogate recordings for which we have the exact timing of spindles, we demonstrate that longer filter size is ineffective at detecting spindles. Specifically, we gradually increase the filter size (<xref ref-type="fig" rid="fig1s9">Figure 1—figure supplement 9</xref>) and compute the performance of the CNN model. As expected, the CNN performance drops as we increase the filter size, verifying this mechanism. This result further validates the generality of the CNN approach for detecting neural rhythms, while also getting at the mechanism. We believe that a similar mechanism can be implemented for specifying the filter size for other neural and biological rhythms. The current CNN architecture works perfectly with slight changes in the sliding window (duration and sampling rate) and type of oscillation, but it requires modification otherwise.</p></sec><sec id="s4-13"><title>Electrode localization</title><p>For the purpose of electrode localization in the iEEG recordings, we developed an image processing pipeline which involves electrode contact localization, brain tissue segmentation, and atlas fitting. Semi-automatic contact localization was performed in 3D Slicer using the SEEG Assistant (SEEGA) module (<xref ref-type="bibr" rid="bib57">Narizzano et al., 2017</xref>). The entry and target points of each electrode were manually defined on the post-operative CT image. The entry/target labels were provided to the SEEGA algorithm, which automatically segmented the electrode contacts. To obtain brain location information for each contact, brain tissue segmentation and atlas fitting was carried out. To enable the use of anatomical priors during tissue segmentation, the pre-operative T1w MRI was non-linearly registered to the MNI152 2009c Nonlinear Symmetric template (<ext-link ext-link-type="uri" xlink:href="https://www.bic.mni.mcgill.ca/ServicesAtlases/ICBM152NLin2009">https://www.bic.mni.mcgill.ca/ServicesAtlases/ICBM152NLin2009</ext-link>) using NiftyReg (<xref ref-type="bibr" rid="bib50">Modat et al., 2010</xref>). An anatomical mask was generated by applying the inverse transform to the T1w image using the antsApplyTransforms algorithm from Advanced Normalization Tools 2.2.0 (ANTS; <ext-link ext-link-type="uri" xlink:href="http://stnava.github.io/ANTs">http://stnava.github.io/ANTs</ext-link>; <xref ref-type="bibr" rid="bib16">Cook, 2022</xref>). Segmentation of gray matter, white matter, and cerebrospinal fluid was performed using the Atropos algorithm from ANTS (<xref ref-type="bibr" rid="bib6">Avants et al., 2011b</xref>), which implements <italic>k</italic>-means classification (<italic>k</italic>=3). The resulting posteriors were merged into a 4D volume using the fslmerge algorithm from FMRIB Software Library v6.0 (FSL; <ext-link ext-link-type="uri" xlink:href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki">https://fsl.fmrib.ox.ac.uk/fsl/fslwiki</ext-link>). The CerebrA atlas (<xref ref-type="bibr" rid="bib43">Manera et al., 2020</xref>) was used to obtain anatomical labels for each electrode contact. Normalization to template space (MNI152NLin2009cAsym) was performed using the non-linear SyN (<xref ref-type="bibr" rid="bib5">Avants et al., 2011a</xref>) symmetric diffeomorphic image registration algorithm from ANTS, using both the brain masks of the pre-operative T1w and template space. Using the inverse of the non-linear transform, the CerebraA atlas labels were warped to the pre-operative T1w MRI space. The atlas labels were then dilated using the fslmaths algorithm from FSL. The final T1w brain tissue/atlas segmentation was mapped to the contacts to provide location information for each contact (tissue probability and brain anatomical region). This custom processing pipeline has been made available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/akhanf/clinical-atlasreg">https://github.com/akhanf/clinical-atlasreg</ext-link>; <xref ref-type="bibr" rid="bib37">Khan, 2020</xref>).</p></sec><sec id="s4-14"><title>Code availability</title><p>Our custom MATLAB (MathWorks) implementations of all computational analyses, along with the analysis scripts used for this study are available as an open-access release on GitHub (<ext-link ext-link-type="uri" xlink:href="http://github.com/mullerlab/spindlecnn">https://github.com/mullerlab/spindlecnn</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:d9186d52390c989ef9b18d001322f86c25e8b9e0;origin=https://github.com/mullerlab/spindlecnn;visit=swh:1:snp:2d53ecd0e4425e29a2b014b43f9e55cdd4d1e65c;anchor=swh:1:rev:0c503d103e4a0cf041e43903a896bb25b0c66b9b">swh:1:rev:0c503d103e4a0cf041e43903a896bb25b0c66b9b</ext-link>, <xref ref-type="bibr" rid="bib51">Mofrad, 2022</xref>).</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Formal analysis, Methodology, Software, Validation, Visualization, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Data curation, Formal analysis, Resources, Software, Validation, Visualization, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Methodology, Visualization, Writing - review and editing</p></fn><fn fn-type="con" id="con4"><p>Data curation, Investigation, Resources, Supervision, Validation, Writing - review and editing</p></fn><fn fn-type="con" id="con5"><p>Data curation, Investigation, Resources, Supervision, Validation, Writing - review and editing</p></fn><fn fn-type="con" id="con6"><p>Data curation, Investigation, Resources, Supervision, Validation, Writing - review and editing</p></fn><fn fn-type="con" id="con7"><p>Data curation, Formal analysis, Methodology, Resources, Software, Supervision, Validation, Writing - review and editing</p></fn><fn fn-type="con" id="con8"><p>Data curation, Formal analysis, Methodology, Resources, Software, Supervision, Validation, Writing - review and editing</p></fn><fn fn-type="con" id="con9"><p>Conceptualization, Formal analysis, Funding acquisition, Investigation, Methodology, Resources, Software, Supervision, Validation, Writing - original draft, Writing - review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>We analyze a clinical dataset of intracranial electroencephalography (iEEG) recordings from 5 epileptic patients in the Epilepsy Monitoring Unit (EMU) at London Health Sciences Centre (LHSC). Patients were implanted using depth electrodes for the sole purpose of surgical evaluation. Informed consent and consent to publish were collected from the patients in accordance with local Research Ethics Board (REB) guidelines (Western University HSREB #106516 and Lawson REB #114420).</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Performance of the convolutional neural network (CNN) model and amplitude-thresholding (AT) approach under different types of noise.</title><p>Examples of CNN and AT implementation using surrogate data with systematically varying noise properties. The CNN models were able to detect the majority of spindles (sensitivity above 97%) subject to different types of noise as opposed to the AT which achieved lower performance (specificity around 72–87%). The CNN model was trained over a subset of high-quality spindles (about 36–41%) detected by the signal-to-noise ratio (SNR) approach using the 99th percentile threshold of the SNR distribution. The high sensitivity and specificity verifies the superior performance of CNN to detect the specific waveform characteristics distinguishing the sleep spindle rhythm in the recordings with significantly varying types of noise.</p></caption><media xlink:href="elife-75769-supp1-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="supp2"><label>Supplementary file 2.</label><caption><title>Distribution of gray matter contacts in the cortical regions of all subjects in the intracranial electroencephalogram (iEEG) recordings.</title></caption><media xlink:href="elife-75769-supp2-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="supp3"><label>Supplementary file 3.</label><caption><title>Convolutional neural network (CNN) hyperparameter sensitivity analysis.</title><p>Values reported are the average Cronbach’s alpha computed over different combinations of CNN hyperparameters which measure the similarity of the outputs (the average alpha computed over the randomly shuffled outputs are approximately 0.005 for each combination). Parameter values in bold are used in the current version of the CNN model.</p></caption><media xlink:href="elife-75769-supp3-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="transrepform"><label>Transparent reporting form</label><media xlink:href="elife-75769-transrepform1-v1.pdf" mimetype="application" mime-subtype="pdf"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>Source data for non human primate electrocorticographic (ECoG) recording and human EEG recordings were made freely available through following links: <ext-link ext-link-type="uri" xlink:href="http://neurotycho.org/sleep-task">http://neurotycho.org/sleep-task</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://osf.io/chav7">https://osf.io/chav7</ext-link>. Our custom MATLAB (MathWorks) implementations of all computational analyses, along with the analysis scripts used for this study will be made available as an open-access release on GitHub (<ext-link ext-link-type="uri" xlink:href="http://github.com/mullerlab/spindlecnn">http://github.com/mullerlab/spindlecnn</ext-link>, copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:d9186d52390c989ef9b18d001322f86c25e8b9e0;origin=https://github.com/mullerlab/spindlecnn;visit=swh:1:snp:2d53ecd0e4425e29a2b014b43f9e55cdd4d1e65c;anchor=swh:1:rev:0c503d103e4a0cf041e43903a896bb25b0c66b9b">swh:1:rev:0c503d103e4a0cf041e43903a896bb25b0c66b9b</ext-link>).</p></sec><ack id="ack"><title>Acknowledgements</title><p>The authors would like to thank the entire team of clinical neurologists and neurosurgeons at London Health Sciences Centre (LHSC, London, Ontario) for their collaboration in this work. The authors would also like to thank the clinical patients for their participation in the research. The authors additionally thank Ingrid Johnsrude, Julio Martinez-Trujillo, and Laura Batterink for helpful comments and discussions on this manuscript. This work was supported by the Canadian Institute for Health Research and NSF (NeuroNex Grant No. 2015276) and BrainsCAN at Western University through the Canada First Research Excellence Fund (CFREF).</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Achermann</surname><given-names>P</given-names></name><name><surname>Borbély</surname><given-names>AA</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Coherence analysis of the human sleep electroencephalogram</article-title><source>Neuroscience</source><volume>85</volume><fpage>1195</fpage><lpage>1208</lpage><pub-id pub-id-type="doi">10.1016/s0306-4522(97)00692-1</pub-id><pub-id pub-id-type="pmid">9681957</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Andersen</surname><given-names>P</given-names></name><name><surname>Andersson</surname><given-names>SA</given-names></name><name><surname>Lomo</surname><given-names>T</given-names></name></person-group><year iso-8601-date="1967">1967</year><article-title>Nature of thalamo-cortical relations during spontaneous barbiturate spindle activity</article-title><source>The Journal of Physiology</source><volume>192</volume><fpage>283</fpage><lpage>307</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.1967.sp008300</pub-id><pub-id pub-id-type="pmid">4292908</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Andrillon</surname><given-names>T</given-names></name><name><surname>Nir</surname><given-names>Y</given-names></name><name><surname>Staba</surname><given-names>RJ</given-names></name><name><surname>Ferrarelli</surname><given-names>F</given-names></name><name><surname>Cirelli</surname><given-names>C</given-names></name><name><surname>Tononi</surname><given-names>G</given-names></name><name><surname>Fried</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Sleep spindles in humans: insights from intracranial EEG and unit recordings</article-title><source>The Journal of Neuroscience</source><volume>31</volume><fpage>17821</fpage><lpage>17834</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2604-11.2011</pub-id><pub-id pub-id-type="pmid">22159098</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aton</surname><given-names>SJ</given-names></name><name><surname>Suresh</surname><given-names>A</given-names></name><name><surname>Broussard</surname><given-names>C</given-names></name><name><surname>Frank</surname><given-names>MG</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Sleep promotes cortical response potentiation following visual experience</article-title><source>Sleep</source><volume>37</volume><fpage>1163</fpage><lpage>1170</lpage><pub-id pub-id-type="doi">10.5665/sleep.3830</pub-id><pub-id pub-id-type="pmid">25061244</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Avants</surname><given-names>BB</given-names></name><name><surname>Tustison</surname><given-names>NJ</given-names></name><name><surname>Song</surname><given-names>G</given-names></name><name><surname>Cook</surname><given-names>PA</given-names></name><name><surname>Klein</surname><given-names>A</given-names></name><name><surname>Gee</surname><given-names>JC</given-names></name></person-group><year iso-8601-date="2011">2011a</year><article-title>A reproducible evaluation of ANTs similarity metric performance in brain image registration</article-title><source>NeuroImage</source><volume>54</volume><fpage>2033</fpage><lpage>2044</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2010.09.025</pub-id><pub-id pub-id-type="pmid">20851191</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Avants</surname><given-names>BB</given-names></name><name><surname>Tustison</surname><given-names>NJ</given-names></name><name><surname>Wu</surname><given-names>J</given-names></name><name><surname>Cook</surname><given-names>PA</given-names></name><name><surname>Gee</surname><given-names>JC</given-names></name></person-group><year iso-8601-date="2011">2011b</year><article-title>An open source multivariate framework for n-tissue segmentation with evaluation on public data</article-title><source>Neuroinformatics</source><volume>9</volume><fpage>381</fpage><lpage>400</lpage><pub-id pub-id-type="doi">10.1007/s12021-011-9109-y</pub-id><pub-id pub-id-type="pmid">21373993</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bi</surname><given-names>GQ</given-names></name><name><surname>Poo</surname><given-names>MM</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Synaptic modifications in cultured hippocampal neurons: dependence on spike timing, synaptic strength, and postsynaptic cell type</article-title><source>The Journal of Neuroscience</source><volume>18</volume><fpage>10464</fpage><lpage>10472</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.18-24-10464.1998</pub-id><pub-id pub-id-type="pmid">9852584</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boran</surname><given-names>E</given-names></name><name><surname>Fedele</surname><given-names>T</given-names></name><name><surname>Steiner</surname><given-names>A</given-names></name><name><surname>Hilfiker</surname><given-names>P</given-names></name><name><surname>Stieglitz</surname><given-names>L</given-names></name><name><surname>Grunwald</surname><given-names>T</given-names></name><name><surname>Sarnthein</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Dataset of human medial temporal lobe neurons, scalp and intracranial EEG during a verbal working memory task</article-title><source>Scientific Data</source><volume>7</volume><elocation-id>e30</elocation-id><pub-id pub-id-type="doi">10.1038/s41597-020-0364-3</pub-id><pub-id pub-id-type="pmid">31964868</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brodt</surname><given-names>S</given-names></name><name><surname>Gais</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Memory Engrams in the Neocortex</article-title><source>The Neuroscientist</source><volume>27</volume><fpage>427</fpage><lpage>444</lpage><pub-id pub-id-type="doi">10.1177/1073858420941528</pub-id><pub-id pub-id-type="pmid">32713292</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cassenaer</surname><given-names>S</given-names></name><name><surname>Laurent</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Hebbian STDP in mushroom bodies facilitates the synchronous flow of olfactory information in locusts</article-title><source>Nature</source><volume>448</volume><fpage>709</fpage><lpage>713</lpage><pub-id pub-id-type="doi">10.1038/nature05973</pub-id><pub-id pub-id-type="pmid">17581587</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chauvette</surname><given-names>S</given-names></name><name><surname>Crochet</surname><given-names>S</given-names></name><name><surname>Volgushev</surname><given-names>M</given-names></name><name><surname>Timofeev</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Properties of slow oscillation during slow-wave sleep and anesthesia in cats</article-title><source>The Journal of Neuroscience</source><volume>31</volume><fpage>14998</fpage><lpage>15008</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2339-11.2011</pub-id><pub-id pub-id-type="pmid">22016533</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clascá</surname><given-names>F</given-names></name><name><surname>Rubio-Garrido</surname><given-names>P</given-names></name><name><surname>Jabaudon</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Unveiling the diversity of thalamocortical neuron subtypes</article-title><source>The European Journal of Neuroscience</source><volume>35</volume><fpage>1524</fpage><lpage>1532</lpage><pub-id pub-id-type="doi">10.1111/j.1460-9568.2012.08033.x</pub-id><pub-id pub-id-type="pmid">22606998</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clemens</surname><given-names>Z</given-names></name><name><surname>Fabó</surname><given-names>D</given-names></name><name><surname>Halász</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Overnight verbal memory retention correlates with the number of sleep spindles</article-title><source>Neuroscience</source><volume>132</volume><fpage>529</fpage><lpage>535</lpage><pub-id pub-id-type="doi">10.1016/j.neuroscience.2005.01.011</pub-id><pub-id pub-id-type="pmid">15802203</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Contreras</surname><given-names>D</given-names></name><name><surname>Steriade</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Cellular basis of EEG slow rhythms: a study of dynamic corticothalamic relationships</article-title><source>The Journal of Neuroscience</source><volume>15</volume><fpage>604</fpage><lpage>622</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.15-01-00604.1995</pub-id><pub-id pub-id-type="pmid">7823167</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Contreras</surname><given-names>D</given-names></name><name><surname>Destexhe</surname><given-names>A</given-names></name><name><surname>Sejnowski</surname><given-names>TJ</given-names></name><name><surname>Steriade</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Control of spatiotemporal coherence of a thalamic oscillation by corticothalamic feedback</article-title><source>Science (New York, N.Y.)</source><volume>274</volume><fpage>771</fpage><lpage>774</lpage><pub-id pub-id-type="doi">10.1126/science.274.5288.771</pub-id><pub-id pub-id-type="pmid">8864114</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Cook</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>ANTsX/ANTs</data-title><version designator="swh:1:rev:aacdc61e35a5ea4a4f93f6ac6b04f71d091d6b6d">swh:1:rev:aacdc61e35a5ea4a4f93f6ac6b04f71d091d6b6d</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/ANTsX/ANTs">https://github.com/ANTsX/ANTs</ext-link></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crunelli</surname><given-names>V</given-names></name><name><surname>Lőrincz</surname><given-names>ML</given-names></name><name><surname>Connelly</surname><given-names>WM</given-names></name><name><surname>David</surname><given-names>F</given-names></name><name><surname>Hughes</surname><given-names>SW</given-names></name><name><surname>Lambert</surname><given-names>RC</given-names></name><name><surname>Leresche</surname><given-names>N</given-names></name><name><surname>Errington</surname><given-names>AC</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Dual function of thalamic low-vigilance state oscillations: rhythm-regulation and plasticity</article-title><source>Nature Reviews. Neuroscience</source><volume>19</volume><fpage>107</fpage><lpage>118</lpage><pub-id pub-id-type="doi">10.1038/nrn.2017.151</pub-id><pub-id pub-id-type="pmid">29321683</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dang-Vu</surname><given-names>TT</given-names></name><name><surname>Desseilles</surname><given-names>M</given-names></name><name><surname>Laureys</surname><given-names>S</given-names></name><name><surname>Degueldre</surname><given-names>C</given-names></name><name><surname>Perrin</surname><given-names>F</given-names></name><name><surname>Phillips</surname><given-names>C</given-names></name><name><surname>Maquet</surname><given-names>P</given-names></name><name><surname>Peigneux</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Cerebral correlates of delta waves during non-REM sleep revisited</article-title><source>NeuroImage</source><volume>28</volume><fpage>14</fpage><lpage>21</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2005.05.028</pub-id><pub-id pub-id-type="pmid">15979343</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dang-Vu</surname><given-names>TT</given-names></name><name><surname>Schabus</surname><given-names>M</given-names></name><name><surname>Desseilles</surname><given-names>M</given-names></name><name><surname>Albouy</surname><given-names>G</given-names></name><name><surname>Boly</surname><given-names>M</given-names></name><name><surname>Darsaud</surname><given-names>A</given-names></name><name><surname>Gais</surname><given-names>S</given-names></name><name><surname>Rauchs</surname><given-names>G</given-names></name><name><surname>Sterpenich</surname><given-names>V</given-names></name><name><surname>Vandewalle</surname><given-names>G</given-names></name><name><surname>Carrier</surname><given-names>J</given-names></name><name><surname>Moonen</surname><given-names>G</given-names></name><name><surname>Balteau</surname><given-names>E</given-names></name><name><surname>Degueldre</surname><given-names>C</given-names></name><name><surname>Luxen</surname><given-names>A</given-names></name><name><surname>Phillips</surname><given-names>C</given-names></name><name><surname>Maquet</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Spontaneous neural activity during human slow wave sleep</article-title><source>PNAS</source><volume>105</volume><fpage>15160</fpage><lpage>15165</lpage><pub-id pub-id-type="doi">10.1073/pnas.0801819105</pub-id><pub-id pub-id-type="pmid">18815373</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davis</surname><given-names>ZW</given-names></name><name><surname>Benigno</surname><given-names>GB</given-names></name><name><surname>Fletterman</surname><given-names>C</given-names></name><name><surname>Desbordes</surname><given-names>T</given-names></name><name><surname>Steward</surname><given-names>C</given-names></name><name><surname>Sejnowski</surname><given-names>TJ</given-names></name><name><surname>H Reynolds</surname><given-names>J</given-names></name><name><surname>Muller</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Spontaneous traveling waves naturally emerge from horizontal fiber time delays and travel through locally asynchronous-irregular states</article-title><source>Nature Communications</source><volume>12</volume><elocation-id>6057</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-021-26175-1</pub-id><pub-id pub-id-type="pmid">34663796</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dehghani</surname><given-names>N</given-names></name><name><surname>Cash</surname><given-names>SS</given-names></name><name><surname>Rossetti</surname><given-names>AO</given-names></name><name><surname>Chen</surname><given-names>CC</given-names></name><name><surname>Halgren</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Magnetoencephalography demonstrates multiple asynchronous generators during human sleep spindles</article-title><source>Journal of Neurophysiology</source><volume>104</volume><fpage>179</fpage><lpage>188</lpage><pub-id pub-id-type="doi">10.1152/jn.00198.2010</pub-id><pub-id pub-id-type="pmid">20427615</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dehghani</surname><given-names>N</given-names></name><name><surname>Cash</surname><given-names>SS</given-names></name><name><surname>Halgren</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2011">2011a</year><article-title>Topographical frequency dynamics within EEG and MEG sleep spindles</article-title><source>Clinical Neurophysiology</source><volume>122</volume><fpage>229</fpage><lpage>235</lpage><pub-id pub-id-type="doi">10.1016/j.clinph.2010.06.018</pub-id><pub-id pub-id-type="pmid">20637689</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dehghani</surname><given-names>N</given-names></name><name><surname>Cash</surname><given-names>SS</given-names></name><name><surname>Halgren</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2011">2011b</year><article-title>Emergence of synchronous EEG spindles from asynchronous MEG spindles</article-title><source>Human Brain Mapping</source><volume>32</volume><fpage>2217</fpage><lpage>2227</lpage><pub-id pub-id-type="doi">10.1002/hbm.21183</pub-id><pub-id pub-id-type="pmid">21337472</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Destexhe</surname><given-names>A</given-names></name><name><surname>Contreras</surname><given-names>D</given-names></name><name><surname>Steriade</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Spatiotemporal analysis of local field potentials and unit discharges in cat cerebral cortex during natural wake and sleep states</article-title><source>The Journal of Neuroscience</source><volume>19</volume><fpage>4595</fpage><lpage>4608</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.19-11-04595.1999</pub-id><pub-id pub-id-type="pmid">10341257</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Destexhe</surname><given-names>A</given-names></name><name><surname>Sejnowski</surname><given-names>TJ</given-names></name></person-group><year iso-8601-date="2001">2001</year><source>Thalamocortical Assemblies</source><publisher-loc>Oxford, UK</publisher-loc><publisher-name>OUP</publisher-name></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Destexhe</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Self-sustained asynchronous irregular states and Up-Down states in thalamic, cortical and thalamocortical networks of nonlinear integrate-and-fire neurons</article-title><source>Journal of Computational Neuroscience</source><volume>27</volume><fpage>493</fpage><lpage>506</lpage><pub-id pub-id-type="doi">10.1007/s10827-009-0164-4</pub-id><pub-id pub-id-type="pmid">19499317</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eschenko</surname><given-names>O</given-names></name><name><surname>Mölle</surname><given-names>M</given-names></name><name><surname>Born</surname><given-names>J</given-names></name><name><surname>Sara</surname><given-names>SJ</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Elevated sleep spindle density after learning or after retrieval in rats</article-title><source>The Journal of Neuroscience</source><volume>26</volume><fpage>12914</fpage><lpage>12920</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3175-06.2006</pub-id><pub-id pub-id-type="pmid">17167082</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fernandez</surname><given-names>LMJ</given-names></name><name><surname>Lüthi</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Sleep Spindles: Mechanisms and Functions</article-title><source>Physiological Reviews</source><volume>100</volume><fpage>805</fpage><lpage>868</lpage><pub-id pub-id-type="doi">10.1152/physrev.00042.2018</pub-id><pub-id pub-id-type="pmid">31804897</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fogel</surname><given-names>SM</given-names></name><name><surname>Nader</surname><given-names>R</given-names></name><name><surname>Cote</surname><given-names>KA</given-names></name><name><surname>Smith</surname><given-names>CT</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Sleep spindles and learning potential</article-title><source>Behavioral Neuroscience</source><volume>121</volume><fpage>1</fpage><lpage>10</lpage><pub-id pub-id-type="doi">10.1037/0735-7044.121.1.1</pub-id><pub-id pub-id-type="pmid">17324046</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frankland</surname><given-names>PW</given-names></name><name><surname>Bontempi</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>The organization of recent and remote memories</article-title><source>Nature Reviews. Neuroscience</source><volume>6</volume><fpage>119</fpage><lpage>130</lpage><pub-id pub-id-type="doi">10.1038/nrn1607</pub-id><pub-id pub-id-type="pmid">15685217</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frauscher</surname><given-names>B</given-names></name><name><surname>von Ellenrieder</surname><given-names>N</given-names></name><name><surname>Dubeau</surname><given-names>F</given-names></name><name><surname>Gotman</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Scalp spindles are associated with widespread intracranial activity with unexpectedly low synchrony</article-title><source>NeuroImage</source><volume>105</volume><fpage>1</fpage><lpage>12</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2014.10.048</pub-id><pub-id pub-id-type="pmid">25450108</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frauscher</surname><given-names>B</given-names></name><name><surname>von Ellenrieder</surname><given-names>N</given-names></name><name><surname>Zelmann</surname><given-names>R</given-names></name><name><surname>Doležalová</surname><given-names>I</given-names></name><name><surname>Minotti</surname><given-names>L</given-names></name><name><surname>Olivier</surname><given-names>A</given-names></name><name><surname>Hall</surname><given-names>J</given-names></name><name><surname>Hoffmann</surname><given-names>D</given-names></name><name><surname>Nguyen</surname><given-names>DK</given-names></name><name><surname>Kahane</surname><given-names>P</given-names></name><name><surname>Dubeau</surname><given-names>F</given-names></name><name><surname>Gotman</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Atlas of the normal intracranial electroencephalogram: neurophysiological awake activity in different cortical areas</article-title><source>Brain</source><volume>141</volume><fpage>1130</fpage><lpage>1144</lpage><pub-id pub-id-type="doi">10.1093/brain/awy035</pub-id><pub-id pub-id-type="pmid">29506200</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gais</surname><given-names>S</given-names></name><name><surname>Mölle</surname><given-names>M</given-names></name><name><surname>Helms</surname><given-names>K</given-names></name><name><surname>Born</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Learning-dependent increases in sleep spindle density</article-title><source>The Journal of Neuroscience</source><volume>22</volume><fpage>6830</fpage><lpage>6834</lpage><pub-id pub-id-type="pmid">12151563</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>George</surname><given-names>D</given-names></name><name><surname>Huerta</surname><given-names>EA</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Deep Learning for real-time gravitational wave detection and parameter estimation: Results with Advanced LIGO data</article-title><source>Physics Letters B</source><volume>778</volume><fpage>64</fpage><lpage>70</lpage><pub-id pub-id-type="doi">10.1016/j.physletb.2017.12.053</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kandel</surname><given-names>A</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Cellular-synaptic generation of sleep spindles, spike-and-wave discharges, and evoked thalamocortical responses in the neocortex of the rat</article-title><source>The Journal of Neuroscience</source><volume>17</volume><fpage>6783</fpage><lpage>6797</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.17-17-06783.1997</pub-id><pub-id pub-id-type="pmid">9254689</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kappenman</surname><given-names>ES</given-names></name><name><surname>Luck</surname><given-names>SJ</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>The effects of electrode impedance on data quality and statistical significance in ERP recordings</article-title><source>Psychophysiology</source><volume>47</volume><fpage>888</fpage><lpage>904</lpage><pub-id pub-id-type="doi">10.1111/j.1469-8986.2010.01009.x</pub-id><pub-id pub-id-type="pmid">20374541</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Khan</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>clinical-atlasreg</data-title><version designator="swh:1:rev:f3c61fcab18b0697c01a00552571264de8550f71">swh:1:rev:f3c61fcab18b0697c01a00552571264de8550f71</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/akhanf/clinical-atlasreg">https://github.com/akhanf/clinical-atlasreg</ext-link></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kitamura</surname><given-names>T</given-names></name><name><surname>Ogawa</surname><given-names>SK</given-names></name><name><surname>Roy</surname><given-names>DS</given-names></name><name><surname>Okuyama</surname><given-names>T</given-names></name><name><surname>Morrissey</surname><given-names>MD</given-names></name><name><surname>Smith</surname><given-names>LM</given-names></name><name><surname>Redondo</surname><given-names>RL</given-names></name><name><surname>Tonegawa</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Engrams and circuits crucial for systems consolidation of a memory</article-title><source>Science (New York, N.Y.)</source><volume>356</volume><fpage>73</fpage><lpage>78</lpage><pub-id pub-id-type="doi">10.1126/science.aam6808</pub-id><pub-id pub-id-type="pmid">28386011</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klinzing</surname><given-names>JG</given-names></name><name><surname>Niethard</surname><given-names>N</given-names></name><name><surname>Born</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Mechanisms of systems memory consolidation during sleep</article-title><source>Nature Neuroscience</source><volume>22</volume><fpage>1598</fpage><lpage>1610</lpage><pub-id pub-id-type="doi">10.1038/s41593-019-0467-3</pub-id><pub-id pub-id-type="pmid">31451802</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lachaux</surname><given-names>JP</given-names></name><name><surname>Axmacher</surname><given-names>N</given-names></name><name><surname>Mormann</surname><given-names>F</given-names></name><name><surname>Halgren</surname><given-names>E</given-names></name><name><surname>Crone</surname><given-names>NE</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>High-frequency neural activity and human cognition: past, present and possible future of intracranial EEG research</article-title><source>Progress in Neurobiology</source><volume>98</volume><fpage>279</fpage><lpage>301</lpage><pub-id pub-id-type="doi">10.1016/j.pneurobio.2012.06.008</pub-id><pub-id pub-id-type="pmid">22750156</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Loomis</surname><given-names>AL</given-names></name><name><surname>Harvey</surname><given-names>EN</given-names></name><name><surname>Hobart</surname><given-names>G</given-names></name></person-group><year iso-8601-date="1935">1935</year><article-title>POTENTIAL RHYTHMS OF THE CEREBRAL CORTEX DURING SLEEP</article-title><source>Science (New York, N.Y.)</source><volume>81</volume><fpage>597</fpage><lpage>598</lpage><pub-id pub-id-type="doi">10.1126/science.81.2111.597</pub-id><pub-id pub-id-type="pmid">17739875</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Magee</surname><given-names>JC</given-names></name><name><surname>Johnston</surname><given-names>D</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>A synaptically controlled, associative signal for Hebbian plasticity in hippocampal neurons</article-title><source>Science (New York, N.Y.)</source><volume>275</volume><fpage>209</fpage><lpage>213</lpage><pub-id pub-id-type="doi">10.1126/science.275.5297.209</pub-id><pub-id pub-id-type="pmid">8985013</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Manera</surname><given-names>AL</given-names></name><name><surname>Dadar</surname><given-names>M</given-names></name><name><surname>Fonov</surname><given-names>V</given-names></name><name><surname>Collins</surname><given-names>DL</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>CerebrA, registration and manual label correction of Mindboggle-101 atlas for MNI-ICBM152 template</article-title><source>Scientific Data</source><volume>7</volume><elocation-id>e237</elocation-id><pub-id pub-id-type="doi">10.1038/s41597-020-0557-9</pub-id><pub-id pub-id-type="pmid">32669554</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Markram</surname><given-names>H</given-names></name><name><surname>Lübke</surname><given-names>J</given-names></name><name><surname>Frotscher</surname><given-names>M</given-names></name><name><surname>Sakmann</surname><given-names>B</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Regulation of synaptic efficacy by coincidence of postsynaptic APs and EPSPs</article-title><source>Science (New York, N.Y.)</source><volume>275</volume><fpage>213</fpage><lpage>215</lpage><pub-id pub-id-type="doi">10.1126/science.275.5297.213</pub-id><pub-id pub-id-type="pmid">8985014</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Masquelier</surname><given-names>T</given-names></name><name><surname>Hugues</surname><given-names>E</given-names></name><name><surname>Deco</surname><given-names>G</given-names></name><name><surname>Thorpe</surname><given-names>SJ</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Oscillations, phase-of-firing coding, and spike timing-dependent plasticity: an efficient learning scheme</article-title><source>The Journal of Neuroscience</source><volume>29</volume><fpage>13484</fpage><lpage>13493</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2207-09.2009</pub-id><pub-id pub-id-type="pmid">19864561</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mazzoni</surname><given-names>A</given-names></name><name><surname>Lindén</surname><given-names>H</given-names></name><name><surname>Cuntz</surname><given-names>H</given-names></name><name><surname>Lansner</surname><given-names>A</given-names></name><name><surname>Panzeri</surname><given-names>S</given-names></name><name><surname>Einevoll</surname><given-names>GT</given-names></name><name><surname>Roth</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Computing the Local Field Potential (LFP) from Integrate-and-Fire Network Models</article-title><source>PLOS Computational Biology</source><volume>11</volume><elocation-id>e1004584</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004584</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McClelland</surname><given-names>JL</given-names></name><name><surname>McNaughton</surname><given-names>BL</given-names></name><name><surname>O’Reilly</surname><given-names>RC</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Why there are complementary learning systems in the hippocampus and neocortex: insights from the successes and failures of connectionist models of learning and memory</article-title><source>Psychological Review</source><volume>102</volume><fpage>419</fpage><lpage>457</lpage><pub-id pub-id-type="doi">10.1037/0033-295X.102.3.419</pub-id><pub-id pub-id-type="pmid">7624455</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mednick</surname><given-names>SC</given-names></name><name><surname>McDevitt</surname><given-names>EA</given-names></name><name><surname>Walsh</surname><given-names>JK</given-names></name><name><surname>Wamsley</surname><given-names>E</given-names></name><name><surname>Paulus</surname><given-names>M</given-names></name><name><surname>Kanady</surname><given-names>JC</given-names></name><name><surname>Drummond</surname><given-names>SPA</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The critical role of sleep spindles in hippocampal-dependent memory: a pharmacology study</article-title><source>The Journal of Neuroscience</source><volume>33</volume><fpage>4494</fpage><lpage>4504</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3127-12.2013</pub-id><pub-id pub-id-type="pmid">23467365</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mei</surname><given-names>N</given-names></name><name><surname>Grossberg</surname><given-names>MD</given-names></name><name><surname>Ng</surname><given-names>K</given-names></name><name><surname>Navarro</surname><given-names>KT</given-names></name><name><surname>Ellmore</surname><given-names>TM</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A high-density scalp EEG dataset acquired during brief naps after A visual working memory task</article-title><source>Data in Brief</source><volume>18</volume><fpage>1513</fpage><lpage>1519</lpage><pub-id pub-id-type="doi">10.1016/j.dib.2018.04.073</pub-id><pub-id pub-id-type="pmid">29904654</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Modat</surname><given-names>M</given-names></name><name><surname>Ridgway</surname><given-names>GR</given-names></name><name><surname>Taylor</surname><given-names>ZA</given-names></name><name><surname>Lehmann</surname><given-names>M</given-names></name><name><surname>Barnes</surname><given-names>J</given-names></name><name><surname>Hawkes</surname><given-names>DJ</given-names></name><name><surname>Fox</surname><given-names>NC</given-names></name><name><surname>Ourselin</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Fast free-form deformation using graphics processing units</article-title><source>Computer Methods and Programs in Biomedicine</source><volume>98</volume><fpage>278</fpage><lpage>284</lpage><pub-id pub-id-type="doi">10.1016/j.cmpb.2009.09.002</pub-id><pub-id pub-id-type="pmid">19818524</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Mofrad</surname><given-names>MH</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>CNNSpindleDetection</data-title><version designator="swh:1:rev:0c503d103e4a0cf041e43903a896bb25b0c66b9b">swh:1:rev:0c503d103e4a0cf041e43903a896bb25b0c66b9b</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:d9186d52390c989ef9b18d001322f86c25e8b9e0;origin=https://github.com/mullerlab/spindlecnn;visit=swh:1:snp:2d53ecd0e4425e29a2b014b43f9e55cdd4d1e65c;anchor=swh:1:rev:0c503d103e4a0cf041e43903a896bb25b0c66b9b">https://archive.softwareheritage.org/swh:1:dir:d9186d52390c989ef9b18d001322f86c25e8b9e0;origin=https://github.com/mullerlab/spindlecnn;visit=swh:1:snp:2d53ecd0e4425e29a2b014b43f9e55cdd4d1e65c;anchor=swh:1:rev:0c503d103e4a0cf041e43903a896bb25b0c66b9b</ext-link></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mukamel</surname><given-names>R</given-names></name><name><surname>Fried</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Human intracranial recordings and cognitive neuroscience</article-title><source>Annual Review of Psychology</source><volume>63</volume><fpage>511</fpage><lpage>537</lpage><pub-id pub-id-type="doi">10.1146/annurev-psych-120709-145401</pub-id><pub-id pub-id-type="pmid">21943170</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muller</surname><given-names>L</given-names></name><name><surname>Brette</surname><given-names>R</given-names></name><name><surname>Gutkin</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Spike-timing dependent plasticity and feed-forward input oscillations produce precise and invariant spike phase-locking</article-title><source>Frontiers in Computational Neuroscience</source><volume>5</volume><elocation-id>45</elocation-id><pub-id pub-id-type="doi">10.3389/fncom.2011.00045</pub-id><pub-id pub-id-type="pmid">22110429</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muller</surname><given-names>L</given-names></name><name><surname>Reynaud</surname><given-names>A</given-names></name><name><surname>Chavane</surname><given-names>F</given-names></name><name><surname>Destexhe</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The stimulus-evoked population response in visual cortex of awake monkey is a propagating wave</article-title><source>Nature Communications</source><volume>5</volume><elocation-id>3675</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms4675</pub-id><pub-id pub-id-type="pmid">24770473</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muller</surname><given-names>L</given-names></name><name><surname>Piantoni</surname><given-names>G</given-names></name><name><surname>Koller</surname><given-names>D</given-names></name><name><surname>Cash</surname><given-names>SS</given-names></name><name><surname>Halgren</surname><given-names>E</given-names></name><name><surname>Sejnowski</surname><given-names>TJ</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Rotating waves during human sleep spindles organize global patterns of activity that repeat precisely through the night</article-title><source>eLife</source><volume>5</volume><elocation-id>e17267</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.17267</pub-id><pub-id pub-id-type="pmid">27855061</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murphy</surname><given-names>M</given-names></name><name><surname>Riedner</surname><given-names>BA</given-names></name><name><surname>Huber</surname><given-names>R</given-names></name><name><surname>Massimini</surname><given-names>M</given-names></name><name><surname>Ferrarelli</surname><given-names>F</given-names></name><name><surname>Tononi</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Source modeling sleep slow waves</article-title><source>PNAS</source><volume>106</volume><fpage>1608</fpage><lpage>1613</lpage><pub-id pub-id-type="doi">10.1073/pnas.0807933106</pub-id><pub-id pub-id-type="pmid">19164756</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Narizzano</surname><given-names>M</given-names></name><name><surname>Arnulfo</surname><given-names>G</given-names></name><name><surname>Ricci</surname><given-names>S</given-names></name><name><surname>Toselli</surname><given-names>B</given-names></name><name><surname>Tisdall</surname><given-names>M</given-names></name><name><surname>Canessa</surname><given-names>A</given-names></name><name><surname>Fato</surname><given-names>MM</given-names></name><name><surname>Cardinale</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>SEEG assistant: a 3DSlicer extension to support epilepsy surgery</article-title><source>BMC Bioinformatics</source><volume>18</volume><elocation-id>124</elocation-id><pub-id pub-id-type="doi">10.1186/s12859-017-1545-8</pub-id><pub-id pub-id-type="pmid">28231759</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nejedly</surname><given-names>P</given-names></name><name><surname>Kremen</surname><given-names>V</given-names></name><name><surname>Sladky</surname><given-names>V</given-names></name><name><surname>Cimbalnik</surname><given-names>J</given-names></name><name><surname>Klimes</surname><given-names>P</given-names></name><name><surname>Plesinger</surname><given-names>F</given-names></name><name><surname>Mivalt</surname><given-names>F</given-names></name><name><surname>Travnicek</surname><given-names>V</given-names></name><name><surname>Viscor</surname><given-names>I</given-names></name><name><surname>Pail</surname><given-names>M</given-names></name><name><surname>Halamek</surname><given-names>J</given-names></name><name><surname>Brinkmann</surname><given-names>BH</given-names></name><name><surname>Brazdil</surname><given-names>M</given-names></name><name><surname>Jurak</surname><given-names>P</given-names></name><name><surname>Worrell</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Multicenter intracranial EEG dataset for classification of graphoelements and artifactual signals</article-title><source>Scientific Data</source><volume>7</volume><elocation-id>e179</elocation-id><pub-id pub-id-type="doi">10.1038/s41597-020-0532-5</pub-id><pub-id pub-id-type="pmid">32546753</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nelson</surname><given-names>MJ</given-names></name><name><surname>Pouget</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Do electrode properties create a problem in interpreting local field potential recordings?</article-title><source>Journal of Neurophysiology</source><volume>103</volume><fpage>2315</fpage><lpage>2317</lpage><pub-id pub-id-type="doi">10.1152/jn.00157.2010</pub-id><pub-id pub-id-type="pmid">20220081</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Newton Harvey</surname><given-names>E</given-names></name><name><surname>Loomis</surname><given-names>AL</given-names></name><name><surname>Hobart</surname><given-names>GA</given-names></name></person-group><year iso-8601-date="1937">1937</year><article-title>Cerebral States during Sleep as Studied by Human Brain Potentials</article-title><source>The Scientific Monthly</source><volume>45</volume><fpage>127</fpage><lpage>144</lpage><pub-id pub-id-type="doi">10.1037/h0057431</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nir</surname><given-names>Y</given-names></name><name><surname>Staba</surname><given-names>RJ</given-names></name><name><surname>Andrillon</surname><given-names>T</given-names></name><name><surname>Vyazovskiy</surname><given-names>VV</given-names></name><name><surname>Cirelli</surname><given-names>C</given-names></name><name><surname>Fried</surname><given-names>I</given-names></name><name><surname>Tononi</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Regional slow waves and spindles in human sleep</article-title><source>Neuron</source><volume>70</volume><fpage>153</fpage><lpage>169</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2011.02.043</pub-id><pub-id pub-id-type="pmid">21482364</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Perol</surname><given-names>T</given-names></name><name><surname>Gharbi</surname><given-names>M</given-names></name><name><surname>Denolle</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Convolutional neural network for earthquake detection and location</article-title><source>Science Advances</source><volume>4</volume><elocation-id>e1700578</elocation-id><pub-id pub-id-type="doi">10.1126/sciadv.1700578</pub-id><pub-id pub-id-type="pmid">29487899</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peyrache</surname><given-names>A</given-names></name><name><surname>Battaglia</surname><given-names>FP</given-names></name><name><surname>Destexhe</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Inhibition recruitment in prefrontal cortex during sleep spindles and gating of hippocampal inputs</article-title><source>PNAS</source><volume>108</volume><fpage>17207</fpage><lpage>17212</lpage><pub-id pub-id-type="doi">10.1073/pnas.1103612108</pub-id><pub-id pub-id-type="pmid">21949372</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Piantoni</surname><given-names>G</given-names></name><name><surname>Halgren</surname><given-names>E</given-names></name><name><surname>Cash</surname><given-names>SS</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Spatiotemporal characteristics of sleep spindles depend on cortical location</article-title><source>NeuroImage</source><volume>146</volume><fpage>236</fpage><lpage>245</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2016.11.010</pub-id><pub-id pub-id-type="pmid">27840241</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Purcell</surname><given-names>SM</given-names></name><name><surname>Manoach</surname><given-names>DS</given-names></name><name><surname>Demanuele</surname><given-names>C</given-names></name><name><surname>Cade</surname><given-names>BE</given-names></name><name><surname>Mariani</surname><given-names>S</given-names></name><name><surname>Cox</surname><given-names>R</given-names></name><name><surname>Panagiotaropoulou</surname><given-names>G</given-names></name><name><surname>Saxena</surname><given-names>R</given-names></name><name><surname>Pan</surname><given-names>JQ</given-names></name><name><surname>Smoller</surname><given-names>JW</given-names></name><name><surname>Redline</surname><given-names>S</given-names></name><name><surname>Stickgold</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Characterizing sleep spindles in 11,630 individuals from the National Sleep Research Resource</article-title><source>Nature Communications</source><volume>8</volume><elocation-id>15930</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms15930</pub-id><pub-id pub-id-type="pmid">28649997</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rasch</surname><given-names>B</given-names></name><name><surname>Born</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Maintaining memories by reactivation</article-title><source>Current Opinion in Neurobiology</source><volume>17</volume><fpage>698</fpage><lpage>703</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2007.11.007</pub-id><pub-id pub-id-type="pmid">18222688</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rasch</surname><given-names>B</given-names></name><name><surname>Born</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>About sleep’s role in memory</article-title><source>Physiological Reviews</source><volume>93</volume><fpage>681</fpage><lpage>766</lpage><pub-id pub-id-type="doi">10.1152/physrev.00032.2012</pub-id><pub-id pub-id-type="pmid">23589831</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Richards</surname><given-names>MA.</given-names></name></person-group><year iso-8601-date="2005">2005</year><source>Fundamentals of radar signal processing</source><publisher-name>Tata McGraw-Hill Education</publisher-name></element-citation></ref><ref id="bib69"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Roy</surname><given-names>DS</given-names></name><name><surname>Park</surname><given-names>YG</given-names></name><name><surname>Ogawa</surname><given-names>SK</given-names></name><name><surname>Cho</surname><given-names>JH</given-names></name><name><surname>Choi</surname><given-names>H</given-names></name><name><surname>Kamensky</surname><given-names>L</given-names></name><name><surname>Martin</surname><given-names>J</given-names></name><name><surname>Chung</surname><given-names>K</given-names></name><name><surname>Tonegawa</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Brain-Wide Mapping of Contextual Fear Memory Engram Ensembles Supports the Dispersed Engram Complex Hypothesis</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/668483</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sarasso</surname><given-names>S</given-names></name><name><surname>Proserpio</surname><given-names>P</given-names></name><name><surname>Pigorini</surname><given-names>A</given-names></name><name><surname>Moroni</surname><given-names>F</given-names></name><name><surname>Ferrara</surname><given-names>M</given-names></name><name><surname>De Gennaro</surname><given-names>L</given-names></name><name><surname>De Carli</surname><given-names>F</given-names></name><name><surname>Lo Russo</surname><given-names>G</given-names></name><name><surname>Massimini</surname><given-names>M</given-names></name><name><surname>Nobili</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Hippocampal sleep spindles preceding neocortical sleep onset in humans</article-title><source>NeuroImage</source><volume>86</volume><fpage>425</fpage><lpage>432</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2013.10.031</pub-id><pub-id pub-id-type="pmid">24176868</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schabus</surname><given-names>M</given-names></name><name><surname>Gruber</surname><given-names>G</given-names></name><name><surname>Parapatics</surname><given-names>S</given-names></name><name><surname>Sauter</surname><given-names>C</given-names></name><name><surname>Klösch</surname><given-names>G</given-names></name><name><surname>Anderer</surname><given-names>P</given-names></name><name><surname>Klimesch</surname><given-names>W</given-names></name><name><surname>Saletu</surname><given-names>B</given-names></name><name><surname>Zeitlhofer</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Sleep spindles and their significance for declarative memory consolidation</article-title><source>Sleep</source><volume>27</volume><fpage>1479</fpage><lpage>1485</lpage><pub-id pub-id-type="doi">10.1093/sleep/27.7.1479</pub-id><pub-id pub-id-type="pmid">15683137</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schabus</surname><given-names>M</given-names></name><name><surname>Dang-Vu</surname><given-names>TT</given-names></name><name><surname>Albouy</surname><given-names>G</given-names></name><name><surname>Balteau</surname><given-names>E</given-names></name><name><surname>Boly</surname><given-names>M</given-names></name><name><surname>Carrier</surname><given-names>J</given-names></name><name><surname>Darsaud</surname><given-names>A</given-names></name><name><surname>Degueldre</surname><given-names>C</given-names></name><name><surname>Desseilles</surname><given-names>M</given-names></name><name><surname>Gais</surname><given-names>S</given-names></name><name><surname>Phillips</surname><given-names>C</given-names></name><name><surname>Rauchs</surname><given-names>G</given-names></name><name><surname>Schnakers</surname><given-names>C</given-names></name><name><surname>Sterpenich</surname><given-names>V</given-names></name><name><surname>Vandewalle</surname><given-names>G</given-names></name><name><surname>Luxen</surname><given-names>A</given-names></name><name><surname>Maquet</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Hemodynamic cerebral correlates of sleep spindles during human non-rapid eye movement sleep</article-title><source>PNAS</source><volume>104</volume><fpage>13164</fpage><lpage>13169</lpage><pub-id pub-id-type="doi">10.1073/pnas.0703084104</pub-id><pub-id pub-id-type="pmid">17670944</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sejnowski</surname><given-names>TJ</given-names></name><name><surname>Destexhe</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Why do we sleep?</article-title><source>Brain Research</source><volume>886</volume><fpage>208</fpage><lpage>223</lpage><pub-id pub-id-type="doi">10.1016/s0006-8993(00)03007-9</pub-id><pub-id pub-id-type="pmid">11119697</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Silber</surname><given-names>MH</given-names></name><name><surname>Ancoli-Israel</surname><given-names>S</given-names></name><name><surname>Bonnet</surname><given-names>MH</given-names></name><name><surname>Chokroverty</surname><given-names>S</given-names></name><name><surname>Grigg-Damberger</surname><given-names>MM</given-names></name><name><surname>Hirshkowitz</surname><given-names>M</given-names></name><name><surname>Kapen</surname><given-names>S</given-names></name><name><surname>Keenan</surname><given-names>SA</given-names></name><name><surname>Kryger</surname><given-names>MH</given-names></name><name><surname>Penzel</surname><given-names>T</given-names></name><name><surname>Pressman</surname><given-names>MR</given-names></name><name><surname>Iber</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>The visual scoring of sleep in adults</article-title><source>Journal of Clinical Sleep Medicine</source><volume>3</volume><fpage>121</fpage><lpage>131</lpage><pub-id pub-id-type="pmid">17557422</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>S</given-names></name><name><surname>Miller</surname><given-names>KD</given-names></name><name><surname>Abbott</surname><given-names>LF</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Competitive Hebbian learning through spike-timing-dependent synaptic plasticity</article-title><source>Nature Neuroscience</source><volume>3</volume><fpage>919</fpage><lpage>926</lpage><pub-id pub-id-type="doi">10.1038/78829</pub-id><pub-id pub-id-type="pmid">10966623</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steriade</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>The corticothalamic system in sleep</article-title><source>Frontiers in Bioscience</source><volume>8</volume><fpage>d878</fpage><lpage>d899</lpage><pub-id pub-id-type="doi">10.2741/1043</pub-id><pub-id pub-id-type="pmid">12700074</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stolk</surname><given-names>A</given-names></name><name><surname>Griffin</surname><given-names>S</given-names></name><name><surname>van der Meij</surname><given-names>R</given-names></name><name><surname>Dewar</surname><given-names>C</given-names></name><name><surname>Saez</surname><given-names>I</given-names></name><name><surname>Lin</surname><given-names>JJ</given-names></name><name><surname>Piantoni</surname><given-names>G</given-names></name><name><surname>Schoffelen</surname><given-names>J-M</given-names></name><name><surname>Knight</surname><given-names>RT</given-names></name><name><surname>Oostenveld</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Integrated analysis of anatomical and electrophysiological human intracranial data</article-title><source>Nature Protocols</source><volume>13</volume><fpage>1699</fpage><lpage>1723</lpage><pub-id pub-id-type="doi">10.1038/s41596-018-0009-6</pub-id><pub-id pub-id-type="pmid">29988107</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Takeuchi</surname><given-names>S</given-names></name><name><surname>Murai</surname><given-names>R</given-names></name><name><surname>Shimazu</surname><given-names>H</given-names></name><name><surname>Isomura</surname><given-names>Y</given-names></name><name><surname>Mima</surname><given-names>T</given-names></name><name><surname>Tsujimoto</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Spatiotemporal Organization and Cross-Frequency Coupling of Sleep Spindles in Primate Cerebral Cortex</article-title><source>Sleep</source><volume>39</volume><fpage>1719</fpage><lpage>1735</lpage><pub-id pub-id-type="doi">10.5665/sleep.6100</pub-id><pub-id pub-id-type="pmid">27397568</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tononi</surname><given-names>G</given-names></name><name><surname>Cirelli</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Sleep and the price of plasticity: from synaptic and cellular homeostasis to memory consolidation and integration</article-title><source>Neuron</source><volume>81</volume><fpage>12</fpage><lpage>34</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.12.025</pub-id><pub-id pub-id-type="pmid">24411729</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>von Ellenrieder</surname><given-names>N</given-names></name><name><surname>Gotman</surname><given-names>J</given-names></name><name><surname>Zelmann</surname><given-names>R</given-names></name><name><surname>Rogers</surname><given-names>C</given-names></name><name><surname>Nguyen</surname><given-names>DK</given-names></name><name><surname>Kahane</surname><given-names>P</given-names></name><name><surname>Dubeau</surname><given-names>F</given-names></name><name><surname>Frauscher</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>How the Human Brain Sleeps: Direct Cortical Recordings of Normal Brain Activity</article-title><source>Annals of Neurology</source><volume>87</volume><fpage>289</fpage><lpage>301</lpage><pub-id pub-id-type="doi">10.1002/ana.25651</pub-id><pub-id pub-id-type="pmid">31777112</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Warby</surname><given-names>SC</given-names></name><name><surname>Wendt</surname><given-names>SL</given-names></name><name><surname>Welinder</surname><given-names>P</given-names></name><name><surname>Munk</surname><given-names>EGS</given-names></name><name><surname>Carrillo</surname><given-names>O</given-names></name><name><surname>Sorensen</surname><given-names>HBD</given-names></name><name><surname>Jennum</surname><given-names>P</given-names></name><name><surname>Peppard</surname><given-names>PE</given-names></name><name><surname>Perona</surname><given-names>P</given-names></name><name><surname>Mignot</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Sleep-spindle detection: crowdsourcing and evaluating performance of experts, non-experts and automated methods</article-title><source>Nature Methods</source><volume>11</volume><fpage>385</fpage><lpage>392</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2855</pub-id><pub-id pub-id-type="pmid">24562424</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wheeler</surname><given-names>ME</given-names></name><name><surname>Petersen</surname><given-names>SE</given-names></name><name><surname>Buckner</surname><given-names>RL</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Memory’s echo: vivid remembering reactivates sensory-specific cortex</article-title><source>PNAS</source><volume>97</volume><fpage>11125</fpage><lpage>11129</lpage><pub-id pub-id-type="doi">10.1073/pnas.97.20.11125</pub-id><pub-id pub-id-type="pmid">11005879</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yanagawa</surname><given-names>T</given-names></name><name><surname>Chao</surname><given-names>ZC</given-names></name><name><surname>Hasegawa</surname><given-names>N</given-names></name><name><surname>Fujii</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Large-scale information flow in conscious and unconscious states: an ECoG study in monkeys</article-title><source>PLOS ONE</source><volume>8</volume><elocation-id>e80845</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0080845</pub-id><pub-id pub-id-type="pmid">24260491</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.75769.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Ba</surname><given-names>Demba</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03vek6s52</institution-id><institution>Harvard University</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group></front-stub><body><p>This article provides compelling evidence that deep convolutional networks can detect repeating patterns in biological data better than existing methods, in the presence of noise, biological or otherwise. In analyses of data acquired from the brains of primates using various modalities, the authors show that spindles in cortex have a wider spatial distribution that previously thought. Applications of the proposed approach in other settings may lead to novel findings about the distribution of transient oscillatory patterns in the brain.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.75769.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Ba</surname><given-names>Demba</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03vek6s52</institution-id><institution>Harvard University</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Varela</surname><given-names>Carmen</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05p8w6387</institution-id><institution>Florida Atlantic University</institution></institution-wrap><country>United States</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Ba</surname><given-names>Demba</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03vek6s52</institution-id><institution>Harvard University</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>[Editors’ note: the authors submitted for reconsideration following the decision after peer review. What follows is the decision letter after the first round of review.]</p><p>Thank you for submitting the paper &quot;Waveform detection by deep learning reveals multi-area spindles that are selectively modulated by memory load&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 2 peer reviewers, and the evaluation has been overseen by a Reviewing Editor and a Senior Editor. The following individuals involved in review of your submission have agreed to reveal their identity: Carmen Varela (Reviewer #1).</p><p>Comments to the Authors:</p><p>We are sorry to say that, after consultation with the reviewers, we have decided that this work will not be considered further for publication by <italic>eLife</italic>.</p><p>Overall, as a group, the reviewers found the application of CNNs to the detection of spindles novel and interesting. More generally, the reviewers thought that a method to detect rhythmic behavior from noisy data could have an important impact on neuroscience research. At the same time, the reviewer expressed some reservations, and felt that the manuscript requires additional work to assess the utility of the CNNs as an addition to sleep biologists' toolkits. Should the authors decide to submit a revised version of the manuscript, we will do our best to have it assessed by the reviewing editor and the reviewers who provided the comments below.</p><p>The following represent three main critiques/suggestions from the reviews.</p><p>1. The reviewers found the comparisons to existing methods for spindle detection too simplistic and lacking. More specifically, the authors compare their method mainly to the AT method. The reviewers found the lack of details of the authors' implementation of the AT method, and the lack of thorough comparison to spindle-detection algorithms more sophisticated than the AT method, such as the SNR method, surprising. The reviewers suggest that the authors describe their implementation of the AT method in more detail (e.g. threshold selection etc…). The reviewers also suggest that the authors perform thorough comparisons of the CNN to methods/algorithms more sophisticated than the AT method, both in simulations and on the data used in the manuscript. Evidence that the CNN detects substantially more spindles than these methods would motivate its adoption by biologists.</p><p>2. The reviewers felt that the analyses do not support the authors' interpretations and their claims of new scientific findings. First, differences in spatial sampling of neural activity by EEG, EcOG and iEEG, together with the fact that volume conduction may contribute to synchronous activity, limits the interpretation of the authors result. Second, a line of work by Dehghani, Cash, Halgren and colleagues investigating the spatial extent of spindles suggest a lack of synchrony: e.g. (1) doi: 10.1152/jn.00198.2010, (2) doi: 10.1002/hbm.21183, (3) doi: 10.1016/j.clinph.2010.06.018. The reviewers suggest that the authors temper their claims significantly, and put them in the context of the above literature.</p><p>3. The reviewers thought the manuscript could benefit from an expanded discussion of the motivation for utilizing the CNN for spindle detection, in particular of how, if at all, they tailored the architecture to the spindle-detection setting. The description of the architecture (layers etc…) provided in the manuscript seems to mirror the description of that developed for gravitational wave detection. More generally, the reviewers thought that a discussion of how to tailor the architecture to the detection of brain rhythms other than spindles would benefit the neuroscience community. For instance, variables such as the length of the rhythmic pattern of interest ought to impact architectural choices.</p><p>4. The reviewing editor asks that, where applicable, the authors modify the manuscript to address the comments from the detailed reviews shared below.</p><p><italic>Reviewer #1:</italic></p><p>Mofrad et al. trained a convolutional neural network (CNN) to improve the detection of multi-area spindles and study their regulation by working memory load. They used the CNN algorithm on three different sleep datasets (scalp EEG from humans that had performed a working memory task, intracranial human EEG, and ECoG recorded from macaques). They find that their CNN method identifies more regional and multi-area sleep spindles compared to an amplitude-based spindle detection method. Importantly, they found that the rate of occurrence of regional and multi-site spindles was higher in the sleep after human subjects performed a high-load visual working memory task, compared to after the subjects performed a low-load visual working memory task.</p><p>The results from this study advance the methods used to detect sleep events. As discussed by the authors, most algorithms to detect sleep oscillations in EEG and LFP data are based on amplitude thresholds; this approach is inadequate when studying regional and global spindles, in which the amplitude may not always remain above threshold in all recording sites. The authors overcome this limitation with a ML approach that detects significantly higher numbers of regional and multi-site spindles. The results presented here demonstrate how ML detection algorithms can offer novel insights on the function of spindles; similar approaches could be helpful with other sleep oscillations. Specifically, the results presented by Mofrad et al. suggest that, compared to amplitude-based detection methods, CNNs improve the detection of spindles that occur temporally correlated across cortical regions. In addition, the authors used the CNN spindle detection method on human sleep data after subjects performed a working memory task. The results are consistent with the hypothesis that cross-regional spindle synchronization is regulated by working memory load prior to sleep, providing insight into how specific cognitive processes influence sleep spindles.</p><p>An additional strength of this study is the demonstration that the CNN method yields similar results in ECoG, EEG, and iEEG, and in data from macaques and from humans, suggesting that the detection method is applicable across species and across electrophysiological recording methods.</p><p>A few points should be considered when interpreting the results. The definition of local, regional, and multi-site spindles used in this manuscript is based on the absolute number of electrode sites in which a spindle was detected. Since the ECoG, EEG, and iEEG have different spatial sampling, the definition could overestimate regional and multi-site spindles in iEEG recordings, particularly in the subjects that had large number of electrode contacts in one brain region. This could contribute to the much higher ratio of global spindles observed in the iEEG data compared to ECoG and EEG. Nonetheless, the analyses that support a correlation between widespread spindles and memory load were based on 64-channel scalp EEG and are not expected to be biased by differences in electrode spatial sampling.</p><p>Lastly, the results are interpreted in the context of the systems memory consolidation hypothesis, which proposes that new memories become integrated into neocortical networks in a process that is facilitated by sleep oscillations. The results from the sleep EEG analyses after subjects performed a low- or high- load visual working memory task are indeed consistent with the idea that multi-site spindles contribute to the consolidation of memories formed before the subjects went to sleep. Likewise, the results are also consistent with the synaptic homeostasis hypothesis, which states that sleep oscillations are important in scaling synaptic plasticity of networks that may have been particularly active during wakefulness. The results of this study are therefore congruent with the possibility of multi-site spindles coordinating the homeostatic regulation of synaptic strength across multiple cortical regions in relation to the cognitive load experienced by the subjects during wakefulness prior to sleep.</p><p>Recommendations for the authors</p><p>The work presented in this manuscript is highly relevant to advance the methods used to detect sleep oscillations, and to understand the functional significance of sleep spindle coordination across cortical areas. The manuscript text and figures are clear and well-organized. Below are suggestions that may help further improve the quality of this work.</p><p>The distinction of three spindle types (local, regional, multi-area) based on the co-occurrence across recording sites should be discussed with regard to the different spatial sampling of EEG, ECoG and, specially, iEEG electrodes. For example, spindles detected in multiple recording sites in subjects such as B and C which have multiple contacts in one brain region (Suppl. Table 1), might be incorrectly labelled as regional or multi-area. Although sampling biases are not expected to affect the results regarding memory, it will be helpful for readers to explain how these potential biases were addressed in the analyses of iEEG data. Could the much higher ratio of multi-area spindles in iEEG data (Figure 2c, right panel) be explained by electrode sampling bias? Along the same lines, it may be more appropriate to refer to 'multi-area' spindles as 'multi-site' spindles if they do not necessarily imply occurrence in distinct cortical areas.</p><p>It would also be helpful to expand the justification for the choice of CNN algorithms; the text refers to their previous use detecting earthquakes or gravitational waves but is not immediately clear why noise in these applications would be similar to noise in sleep signals.</p><p>Line 35: remove 'stage 2': the references provided are mostly from rodents, in which separate NREM sleep stages are less defined; and spindles are not necessarily exclusive of N2 even in humans.</p><p>Lines 61,62: Long-range connections are one potential link to temporarily coordinate spindles across cortical areas. Another important set of connections that could coordinate spindles are the thalamocortical projections, mainly those thalamic pathways with widespread projections to superficial layers of cortex (references such as Clasca et al., 2012, Eur J Neurosci 35(10):1524-32. doi: 10.1111/j.1460-9568.2012.08033.x.).</p><p>Lines 102-103: please specify how descriptive statistics are reported; are the values reported in parenthesis the mean and standard deviations? Clarify in the methods section how duration was calculated. The methods state that 'The CNN model takes a window of sleep recording (500 ms which is bandpass…)' (Line 303), is that a 500ms moving window? With what step size? What determines the start and end of a spindle in the CNN and AT methods?</p><p>Line 161: include p value for local spindles (as done in the figure legend).</p><p>Given the unique dataset and methods, and the focus of this work on the locality and globality of spindles, the authors may want to report on potential changes in the density of local spindles specifically over visual and frontal cortical areas. Is it possible that increases in local spindle density are not significant when all regions are considered together but may be significant in certain regions engaged by the visual working memory task? In that sense, it is interesting that the SNR approach detects a (smaller) increase in local spindles with high memory load (Supp. Figure 4a). A more precise analysis of local spindles over relevant cortical areas will not diminish the author's main result on multi-area spindles, but it will provide additional cues on the role of spindle spatial synchronization in sleep and will enhance the value of this interesting work.</p><p>Lines 241-242 say that 'the quality of sleep was studied by the degree of spatial synchronization'; it will be helpful to clarify this statement because if the degree of spatial synchronization was used to select the sleep data used for this work, the dataset may include more synchronized activity compared to other datasets. This does not nullify the results, but clarification will be important to ensure replicability. Likewise, the methods used for sleep detection should be described in more detail, was sleep detected in the same way in all datasets?</p><p>Line 250: only visual inspection was used to detect stage 2 in the EEG data? clarify if only NREM sleep was used in all datasets used for analysis? (same for the iEEG recordings)</p><p>Not clear what is added by the paragraph between Lines 283-288 unless more details are provided. If the model simulates spiking activity in the awake state, is this helpful as a ground truth control for sleep LFP? What type of spiking model? What network architecture?</p><p>Paragraph starting in line 290. Was the CNN model trained and optimized for each dataset?</p><p>Lines 296-297: 'best' based on what?</p><p>Line 350 states that the overall threshold for the AT method was based on the average root mean squared. Was the AT approach developed and applied independently for each data set (EEG, ECoG, iEEG)? It is not clear from the text if the different signal amplitudes in the datasets were considered for AT detection (were the data and RMS normalized?).</p><p>Figure Supp. 5: correct typo in the figure legends (spindle)</p><p><italic>Reviewer #2:</italic></p><p>The primary goal of this paper is to provide evidence that sleep rhythms are more spatially extended than previously known, using a deep learning convolutional neural network (CNN) model specifically designed to characterized rhythmic activity that has not previously been applied to sleep data.</p><p>Strengths</p><p>1. The authors establish that the CNN method proposed can detect spatially extended sleep rhythms and that difference occur when measuring spindles after a low vs high load memory tasks in multiple data sets.</p><p>2. The CNN method presented may provide a powerful technique to characterize a range of brain rhythms and difference across tasks or patient populations.</p><p>3. The results and figures are clearly presented.</p><p>4. The methods are sound, with the exception that more detail on the method and how it uniquely accounts for rhythmic activity is warranted and should be discussed in the Results section of the paper, rather than in the methods.</p><p>Weaknesses</p><p>1. The results of the paper do not establish that this CNN method is better than prior methods at detecting spatially extend sleep rhythms, or that the methods is better able to distinguish sleep spindles after a low vs high load memory task. As such, while a new method for detecting spindles is clearly presented, there do not appear to be any new scientific findings in this paper. The authors compare the CNN with only the AT methods for the main result of the paper (Figure 3, Supplementary Figure 3), and not the SNR method. Why not compare directly to the SNR also to see if CNN is actually better? The SNR method is used to generate the data set that the CNN is trained on, as such is it possible for the CNN to do better? Would the AT method be able to pick up more multi-area spindles with a lower threshold?</p><p>The CNN and SNR methods are directly compared only for the low vs high memory load task in Supplementary Figure 4. A visual comparison of the low vs high memory load results from the CNN (Figure 3c) and SNR methods (Supplementary Figure 4 top) suggests that the SNR method is equally able to distinguish these conditions. Overall, the advantage of the CNN is not clear.</p><p>2. There are several high-level strong claims in the paper that are not directly investigated or supported by the evidence in this paper. For example, &quot;These results thus provide specific neural mechanisms by which memories can be stored in distributed neocortical networks during sleep&quot;. &quot;Taken together, these results provide substantial evidence of a specific role for spindles in linking neuron groups distributed widely across cortex during memory consolidation&quot;. &quot;The key missing piece is to understand how spindles can guide specific long-range excitatory connections to strengthen during sleep-dependent memory consolidation. We hypothesized that widespread, multi-area spindles might provide this mechansism&quot;. At best, the results in this paper provide supportive evidence that spindles could do these things by they do not investigate or establish causality in any way.</p><p>3. It is stated that in the ECoG and iEEG data, the AT method detected a subset of spindles that are significantly higher-amplitude than those detected by the CNN methods, using a one-sided Wilcoxon sign rank test. Does this mean that CNN does not detect some of the high amplitude spindles? Is this advantageous? There is something confusing about the way this is stated. A Figure of the distribution in number and amplitude of spindles detected with the 3 methods (CCN, AT, SRN) would be useful.</p><p>4. The 3 different recording methods sample activity across different spatial scales, and depth electrodes (iEEG) are sampling vastly different areas (i.e. deeper sources) than ECoG and EEG. As such, it is difficult to relate findings related to &quot;simultaneous spindle detection&quot; in local, regional, multi-area electrodes across these three different measures. A primary concern is that the finding that there are more multi-area spindles (e.g. Figure 2b for iEEG – similar results for EEG and ECoG are not quantified) could be due to volume spread of the spindle source. Is there a way to rule this out? There are ways to minimize the influence of volume conduction with EEG and ECoG source analysis, however, to my knowledge, these methods currently don't exist for iEEG.</p><p>Recommendations for the authors:</p><p>In Figure 1d, there appear to be other spindle in each of these example traces. Were these not picked up by the algorithm, or simple not highlighted in red? Clarification would be helpful.</p><p>Why are the randomly sampled red dashed line in Supplementary Figure 1 not flat? Is the 1Hz filter somehow biasing the amplitude at the center?</p><p>It would be helpful to see the results shown in Figure 2b for iEEG for ECoG and EEG data as well.</p><p>There is are claims about SNR and CNN being independent of spindle amplitude. Clarification of how the SNR power calculations are independent of amplitude would be useful.</p><p>The methods state &quot;We first tested CNN models with different architectures and selected one of the best architectures across sleep recording data sets&quot;. What does &quot;one of the best&quot; mean? Quantification would be helpful. Overall, clarification of advantages of this CNN method in identifying rhythmic activity, other than training on rhythmic activity (?), would be helpful.</p><p>[Editors’ note: further revisions were suggested prior to acceptance, as described below.]</p><p>Thank you for resubmitting your work entitled &quot;Waveform detection by deep learning reveals multi-area spindles that are selectively modulated by memory load&quot; for further consideration by <italic>eLife</italic>. Your revised article has been evaluated by Timothy Behrens (Senior Editor) and a Reviewing Editor.</p><p>The manuscript has been improved but there are some remaining issues that need to be addressed, as outlined below:</p><p>We thank the authors for carefully considering the feedback they received during the first round of reviews, and for performing additional analyses and modifying their manuscript with the feedback in mind. We also thank the authors for patiently waiting for these reviews. The reviewers found the new version of the manuscript a substantial improvement compared to the first submission. The reviewers feel that additional changes and clarifications can put the authors' contribution in its proper context, and broaden the reach of their contribution in the community. The reviewers think the authors ought to</p><p>1. Make their comparisons of the CNN and AT methods in the presence of noise more realistic than currently. Experimentalists would care, for instance, about robustness of the CNN, compared to the AT method, to biological forms of noise (e.g. confounding oscillations such as a brief period of REM theta synched across channels, does the CNN offer an advantage to the AT in that case?). Moreover, the authors seem to have made the comparisons with a fixed noise level/SNR (not to confuse with the 'SNR' method). Does the choice of noise amount have a biological basis? The authors will find text in the reviews unpacking this comment</p><p>2. Clarify apparent inconsistencies in certain statistics reported (e.g. spindle rates), as well as conduct statistical tests for some of their data more appropriate than ones currently used. The authors will find text in the reviews unpacking this comment</p><p>3. Tone down claims of generality of the CNN, and provide clear explanations for what makes the choice of architecture suitable to the current application to spindle detection. The reviewing editor finds this the most important piece of feedback from the reviews. As written, the reviewing editor feels that the manuscript may promote a culture of using deep learning in neuroscience without understanding how deep learning works. The authors have a unique opportunity of not only presenting an application of deep learning that leads to new scientific findings/hypotheses but also of doing so in a manner that promotes a culture of looking inside the black box and trying to understand it. The authors will find text in the reviews unpacking this comment</p><p><italic>Reviewer #1:</italic></p><p>The manuscript has improved substantially and many of my concerns have been addressed. The deep-learning spindle detection method is more fully reported and the new controls with simulated data (varying noise and amplitude) are an improved approach to compare the CNN and AT methods (Figure S1, new Supplementary Table 1). The new analyses investigating the rotating spindle waves provide a framework for understanding the differences with prior reports of low synchrony.</p><p>However, there are several important concerns that should be addressed.</p><p>The new comparisons between CNN and AT models using surrogate data with systematically varied noise are useful. However, what was the rationale to compare the specific types of noise presented in Supplementary Table 1? Both the CNN and the AT have similar sensitivities and specificities for all noises, which may suggest that the different noise conditions do not constitute substantially different challenges for the detectors (also suggested by the example in Supplementary Figure 1, in which the spindle has a high signal to noise ratio with all types of noise). I think the readers will be more convinced of the value of the CNN method it can offer an advantage under a 'noise' condition in which the traditional AT methods are likely to struggle. For example, a more interesting source of noise may be the presence of non-spindle oscillations due to brief state changes (e.g., REM or α), or noise artifacts (e.g., examples in Supplementary Figure 12). The sensitivity of traditional methods is likely to go down in examples like these, how does the CNN compare?</p><p>Line 92: &quot;co-occurrence&quot;; please clarify the time window or time overlap used to determine co-occurrence. Did any amount of time overlap between spindles count as co-occurrence? Likewise, in Line 150: &quot;simultaneously detected spindles&quot;, line 151: &quot;based on co-occurrence&quot;. I think it's worth emphasizing in this paragraph that 'co-occurrence' and 'simultaneous' detection do not imply 0-lag synchrony (as discussed in the 'rotating waves' sections).</p><p>Lines 102 and 104: &quot;low and high visual memory task&quot; should be &quot;low and high-load…&quot; (also in the Figure 3 legend, and in lines 261-262, 263: 'high-load' visual memory tasks).</p><p>There are some inconsistencies in the reported rates (spindles/min) across analyses and figures: Suppl. Figure 4a indicates average spindles/min around 4-5/min in all data types, including EEG data used in the visual memory task. However, the average from the distributions shown in Figure 3b seems much lower, even when combining all spindles across each memory condition, e.g. for the H-VM is about 1/min in local and regional and about 0.5/min for multi-area. In other words, could you clarify how the averages of the distributions in Figure 3b add up to 4 spindles/min in Figure 4a? In addition, in Figure 3b, within the low-VM condition the rate of multi-area spindles is substantially lower (&lt; 0.5/min) than local and regional (about 1/min on average); and within high-VM the rate also appears much lower (&lt;1/min) for multi-area compared to the distributions for local and regional spindles (up to ~2/min). The text indicates p-values for what seems to be a comparison of relative rates (between H-VM and L-VM), which is interesting but is this result due to a significantly lower multi-area spindle rate with low memory? Based on the figure it looks like multi-area spindles occur at lower rates regardless of memory load? It will be helpful to provide statistical comparisons of spindle rates (among all spindle types) within each condition (L-VM, H-VM) so that the relative changes with memory can be interpreted in the context of the absolute spindle rates in each memory condition. Based on the distributions it seems that non-parametric tests would be more appropriate than t-tests.</p><p>Suppl. Figure 4: missing (a),(b) labels. Supplementary Figure 4a is not described in the text?</p><p>Line 725: 12? sites</p><p>Line 154: it'd be useful to reference the Supplementary Table 2 (with the list of the cortical regions).</p><p>Lines 170, 171: I believe the verb should be in past tense.</p><p>Line 179: The interpretations regarding the association between the visual memory load and subsequent sleep spindles is limited to memory consolidation processes. However, memory performance after sleep was not studied in this work, therefore &quot;the impact on memory consolidation&quot; cannot directly be assessed. Sentences such as these (lines 179-180): &quot;If this is the case, what is the impact of the distribution on sleep-dependent memory consolidation? To answer this question…&quot; could be rephrased to state the key question that the data can address. Other sentences in the manuscript are more accurate and valuable in this respect, e.g., Lines 289-290 &quot;(2) this spatial extent can be modulated by the specific memory conditions prior to sleep (Figure 3)&quot;. Indeed, memory consolidation is one of several mechanisms that determine how wakefulness influences sleep oscillations. The authors correctly cover literature on the association between memory and spindles &quot;An increase in spindle density after memory tasks and its relationship with memory consolidation is well established (Clemens et al., 2005; Dang-Vu et al., 2008; Gais et al., 2002; Schabus et al., 2007, 2004)&quot;, but the impact of the authors' findings would be enhanced by discussing other hypotheses in the sleep field that are also consistent with the presented results; for example, the high-load working memory condition may increase firing rates and entrain downscaling processes during subsequent sleep (Tononi and Cirelli, 2014; Crunelli et al., 2018; Klinzing et al.,2019).</p><p>Paragraph starting 215: is this only with the EEG data?</p><p>Figure 4a: missing (a),(b) labels for the plots. Indicate the x,y value of the removed outlier point in parenthesis (in 'a' and 'c') since it's not in the plot but still used in quantifications.</p><p>Line 552: &quot;We simulated 60-minutes recording containing&quot; should it be &quot;60-minutes of recording…&quot;?</p><p><italic>Reviewer #2:</italic></p><p>The authors suggest that the lack of algorithms for reliably identifying spindles in neural recordings has led to the under reporting/underestimation of the spatial extent to which spindles occur in the brain. The authors propose an approach based on CNNs that they claim can detect spindles more reliably than existing ones, lead to new insights as to how cross-region spindles may contribute to the integration of 'information' across brain areas.</p><p>Strengths</p><p>1. The applicability of the proposed methods to neural data from multiple modalities, i.e. EEG, EcOG and iEEG.</p><p>2. The framework the authors lay out for constructing high-quality data sets to train the CNNs.</p><p>3. The combination of computational methods and new suggested insights into how spindles can facilitate the integration of 'information' across brain areas.</p><p>Weaknesses</p><p>1. The authors could improve the explanations as to why the CNN seems to do better than legacy methods such as the AT. The explanation surrounding the CNN's ability to detect spindles of different amplitudes does not seem satisfactory enough.</p><p>2. The authors claim the applicability of the CNN to data from different modalities, and its generality, as a strength. Given the black-box nature of CNNs, and the lack of an attempt in the manuscript to explain the CNN, its success/failure modes, which aspects of the data it focuses on to detect spindles (e.g. saliency maps), these claims do not feel justified to the reviewer and may contribute to the proliferation of black-box CNNs in neuroscience</p><p>Recommendations for the authors:</p><p>The reviewing editor found the manuscript a much improved version of the initial submission.</p><p>1. The reviewing editor found that the analyses currently in the manuscript do not support the authors' claims of generality of the CNN (e.g. lines 376-377), and that the language surrounding these claims may contribute to supporting an already-widespread tendency to utilize black-box neural networks for analyzing neural data.</p><p>a) One feedback from the first round of reviews had to do with the lack of details surrounding the CNN. The reviewing editor appreciates the authors' attempt to improve this. The authors seem to want to emphasize the generality of the architecture. Such claims of generality do not give insight to the reader on how to pick an architecture for detecting oscillatory patterns in a different context (e.g. ripples). The success of the architecture for gravitational wave detection, its use in the current manuscript, do not give license to use it w/o changes in any application.</p><p>A practitioner would appreciate guidance on architecture design. Given the length of pattern of interest and a sampling rate, a user would want to know how to pick filter sizes. For instance, for a patter of length 0.5 seconds, a 256 Hz sampling rate, the effective filter (explained below) associated with an architecture ought to have size on order of 100 samples (0.5*256 = 128 samples), not 10 or 1000. The reviewing editor thinks this manuscript could have a much stronger impact if the authors took such questions into considerations. Have authors visualized the filters they learn? Have they considered generating saliency maps to determine which parts of inputs the network focuses on to detect spindles? At present, the emphasis on the generality of the CNN, w/o considerations for what about the authors' specific context makes the choice of architecture suitable (other than the fact that it works for gravitational-way detection) feels a bit disappointing.</p><p>More details on guidance on how to design architecture/why current architecture works: For any conv net, the choice of filter size at each layers, together with number of layers relates to size of features one would like to detect. Each layer a conv. Composition of conv equals a conv with a filter size roughly proportional to the sum of filter sizes at each layers. 7x7 filters not uncommon in image proc. Cascading 3-4 such layers (ignoring nonlinearities) gives a filter with an effective 30x30 size.</p><p>Concrete suggestions: (a) adding text to the manuscript explaining what what about the authors' specific context makes the choice of architecture suitable (other than the fact that it works for gravitational-way detection), (b) visualizing filters learned by the architecture, (c) consider generating saliency maps.</p><p>(b) The reviewing editor feels that the authors can improve the section detailing the training of the CNN. The editor suggests the authors consider using a table to summarize different aspects (number of layers, filter sizes etc….). The editor also suggests that, very early on, the authors mention the subject-dependence of the training.</p><p>2. Misc questions</p><p>(a) In supplementary figure 4b, the scatter plot for EEG (green) suggests a similar max PSD for the CNN and AT. I would expect a similar rate of spindle detection. Supplementary figure 4a suggests otherwise. Can the authors explain?</p><p>(b) In Figure 2c, EcOG the fact that the CNN detects fewer local and regional spindles per minute than the AT method requires explanation. Does this figure refer to correctly detected spindles? Should the editor interpret the lower ratio as the AT method having more false alarms than the CNN?</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.75769.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p>[Editors’ note: the authors resubmitted a revised version of the paper for consideration. What follows is the authors’ response to the first round of review.]</p><disp-quote content-type="editor-comment"><p>Overall, as a group, the reviewers found the application of CNNs to the detection of spindles novel and interesting. More generally, the reviewers thought that a method to detect rhythmic behavior from noisy data could have an important impact on neuroscience research. At the same time, the reviewer expressed some reservations, and felt that the manuscript requires additional work to assess the utility of the CNNs as an addition to sleep biologists' toolkits. Should the authors decide to submit a revised version of the manuscript, we will do our best to have it assessed by the reviewing editor and the reviewers who provided the comments below.</p></disp-quote><p>We would like to thank the Editor and both Referees for their thoughtful consideration of the merits and advances in our manuscript. We appreciate that both Referees recognized the novelty and importance of the scientific results; however, they also provided important critiques and comparisons to strengthen this work. We have taken their comments to heart, and in the revised manuscript, we have worked to address them in full.</p><p>In summary, we have worked to more fully document the deep-learning waveform detection method we introduce in this work, including more detailed comparisons to previous methods. We have added a new section with simulations using surrogate data and systematically varying noise to demonstrate that our deep learning approach is robust to different types of noise on the recording electrode (new Figure S1). These results indicate that our CNN approach can achieve a very high performance when trained under varying noise and recording conditions (new Table S2). In addition, in our revised manuscript we have gone back to the data from the visual memory task and discovered a novel finding: rotating spindle waves significantly increase following high-load visual memory tasks (new Figure 4 and Video S1). These new results specifically tie the increase in multi-area spindles we reported in the original submission to a neural circuit mechanism for rotating waves in consolidating memories across distributed networks in cortex (see Figure 2, Muller et al., eLife 5, 2016).</p><p>We are very grateful to the Editor and Referees for the points raised in the first round of review, and we believe our work to address them has substantially strengthened the manuscript.</p><disp-quote content-type="editor-comment"><p>The following represent three main critiques/suggestions from the reviews.</p><p>1. The reviewers found the comparisons to existing methods for spindle detection too simplistic and lacking. More specifically, the authors compare their method mainly to the AT method. The reviewers found the lack of details of the authors' implementation of the AT method, and the lack of thorough comparison to spindle-detection algorithms more sophisticated than the AT method, such as the SNR method, surprising. The reviewers suggest that the authors describe their implementation of the AT method in more detail (e.g. threshold selection etc…). The reviewers also suggest that the authors perform thorough comparisons of the CNN to methods/algorithms more sophisticated than the AT method, both in simulations and on the data used in the manuscript. Evidence that the CNN detects substantially more spindles than these methods would motivate its adoption by biologists.</p></disp-quote><p>We appreciate the opportunity to discuss this point. In this work, we focused on the standard implementation of the amplitude-thresholding approach implemented by Mölle et al. (<italic>J Neurosci</italic> 22, 2002). As detailed in a comprehensive analysis by Warby et al. (<italic>Nature Methods</italic> 11, 2014), who performed an exhaustive comparison of six commonly utilized sleep spindle detection algorithms (Bódizs et al., <italic>J Neurosci. Methods</italic> 178, 2009; Ferrarelli et al., <italic>AM. J Psychiatry</italic> 164, 2007; Mölle et al., <italic>J Neurosci</italic> 22, 2002; Martin et al., <italic>Neurobiol. Aging</italic> 34, 2013; Wamsley et al., <italic>Biol. Psychiatry</italic> 71, 2012; Wendt et al., <italic>IEEE Eng. Med. Biol. Soc.</italic> 2012, 2012), these approaches are methodologically similar, relying on bandpass filtering (or wavelets) followed by a thresholding procedure. In this work, we aimed to focus on the signal processing principle common to these approaches: across choices of specific frequency filtering and thresholding procedures, problems can arise from (1) intrusion from signals outside the frequency band of interest (due to bandpass filtering, cf. Figure S12) and (2) missing clearly formed spindle waveforms that fall under the defined threshold. For this reason, we believe that our manuscript presents not only the most pertinent comparison between our CNN approach and the AT method, but also identifies the underlying reason for the new results uncovered by our algorithm. With this in mind, we have clarified in our revised manuscript the general signal processing framework underlying this work: when identifying spindles based on their amplitude characteristics, rather than on waveform characteristics (as with our deep learning approach), the limitations on detecting events in high-noise situations will be general across methods.</p><p>We also appreciate the opportunity to clarify our two-step approach for training the CNN algorithm to detect spindles. Importantly, we introduced the SNR algorithm in a previous manuscript (Muller et al., eLife <bold>5</bold>, 2016) as a conservative approach to detect spindles while maintaining a low false-positive rate. This method, which is based on the constant false-alarm rate (CFAR) method in radar (Levanon, N., Wiley, New York, 1988; Minkler, G. and Minkler, J., Magellan, 1990), detects many “true” spindles while minimizing false detections; however, its aim is not to detect all spindles. For this reason, while the SNR approach is excellent for generating a high-quality training dataset and for providing a second check on results from the CNN model, we know that it cannot provide a comprehensive detection method approaching all of the spindles in a recording. In the initial submission, we thus introduced the CNN approach, which detects many more well-formed and high-quality spindles than the AT approach (Figures 2, S3, and S10) and used the CNN approach to reveal multi-area spindles that are selectively modulated by memory load (Figure 3).</p><p>We apologize that the implementation of the AT was not clear in the original manuscript. In the revised version, we provide details of implementation including steps taken to compute amplitude using signal envelope over a sliding window of time, setting the threshold based on the existing work in the literature (approximately 2 spindles per minute), and specifying spindle start and end time from the amplitude crossings. We also note that the CNN and AT approach were implemented in as similar a manner as possible to facilitate comparison.</p><p>Our revised manuscript provides specific evidence that the CNN detects substantially more spindles than AT. On a set of surrogate data generated to test the robustness of the CNN to different types of noise, the CNN model was able to detect at least 98% of spindle activities, with a specificity above 99%. In contrast, even though the surrogate data does not have any artifact such as line noise, electrical noise, and movement artifacts to introduce signal distortion, the AT achieved lower performance (specificity around 84%-87%). The difference between these methods is even more pronounced in the actual recording, where our comparison reveals that multi-area spindles systematically occur 1.5 (ECoG) to 10 (iEEG) times more often with the CNN than with the AT. Taking these results together, we believe we have provided substantial evidence that the CNN model we have introduced can accurately detect spindles across a range of sleep recording types and provide better performance than the commonly used AT technique.</p><p>We appreciate the Referees bringing up these three important points, which we have addressed in our revised manuscript: (1) explaining more clearly how our method compares to other approaches for sleep spindle detection, such as the SNR approach (lines 110-117), (2) clarifying our implementation of the AT approach (Methods – Comparison with amplitude threshold approach), and (3) providing specific evidence that the CNN detects spindles more effectively than the AT approach using surrogate data (Lines 82-86 in the main text, new supplementary section “Methods – Simulated data control – varying noise” and new Figure S1 and Table S1).</p><p>We hope these additions fully address the Referees’ concerns.</p><disp-quote content-type="editor-comment"><p>2. The reviewers felt that the analyses do not support the authors' interpretations and their claims of new scientific findings. First, differences in spatial sampling of neural activity by EEG, EcOG and iEEG, together with the fact that volume conduction may contribute to synchronous activity, limits the interpretation of the authors result. Second, a line of work by Dehghani, Cash, Halgren and colleagues investigating the spatial extent of spindles suggest a lack of synchrony: e.g. (1) doi: 10.1152/jn.00198.2010, (2) doi: 10.1002/hbm.21183, (3) doi: 10.1016/j.clinph.2010.06.018. The reviewers suggest that the authors temper their claims significantly, and put them in the context of the above literature.</p></disp-quote><p>We thank the Referees for bringing up these important points, which we have considered very seriously in the process of revision. In our revised manuscript, we have added a new analysis of the spatiotemporal structure in the sleep spindles we detect. In addition to providing novel insight into the lack of synchrony in sleep spindles, this analysis addresses the technical questions raised in this point.</p><p>To explain in more detail, we have now added an analysis of spatiotemporal dynamics in the sleep spindles, extending methods developed in our previous work (Muller et al., eLife 5, 2016). For this analysis, we focused on the EEG dataset, with the aim of comparing spatiotemporal dynamics following low- and high-load visual memory tasks. While EEG certainly has reduced spatial resolution compared with the intracranial ECoG and iEEG also studied here, we find that we can robustly detect rotating waves recorded at the scalp (new Figure 4 and Video S1). These waves travel within approximately the same speed as detected in our previous work, which is consistent with the axonal conduction speed of long-range fibers in cortex. Importantly, the observation of clear rotating waves in the scalp EEG directly addresses concerns about volume conduction in the multi-area spindles observed here: the spindles we analyze exhibit tens of milliseconds of offset during individual cycles, and this offset is inconsistent with the effect of volume conduction, which must necessarily be instantaneous. For this reason, it would be difficult for volume conduction effects to be a major confound for our present results on multi-area spindles.</p><p>These points open up to a broader and important discussion on synchrony in spindles. We have previously collaborated closely with Dehghani, Cash, and Halgren, and we appreciate the opportunity to discuss the results from analysis of MEG and EEG, which found that correlation measures across sites during spindles was low. Recent work from Birgit Frauscher’s lab studying iEEG depth electrodes has also found similar results (Frauscher et al., <italic>NeuroImage</italic> 105, 2015), notably showing that sites across cortex exhibit broad increases in 11-15 Hz power during spindles detected at the scalp, but exhibit low correlation across electrode sites. In fact, because traveling waves introduce systematic phase offsets across sites, our work can provide an underlying mechanism for these results, accounting for the broad increases of spindle power across cortex (due to multi-area spindles) with low measures of synchrony (due to phase offsets introduced by the traveling wave). Further, with this in mind, it is critical to distinguish measures of synchrony (as in the work of Dehghani, Cash, and Halgren) from the extent of spindle occurrence (as addressed in our work). We have added citations and additional discussion in the main text to highlight and address these points (lines 273-284).</p><p>Going further, we can ask about the functional role of these waves. In our previous work, we introduced a specific circuit mechanism for how rotating waves during spindles could facilitate building connections between distributed networks in cortex (cf. Figure 2 in Muller et al., eLife 5, 2016). This mechanism addresses an important point about the connection between sleep spindles and circuit plasticity: if cortical spindles were perfectly synchronized, spikes emitted during one cycle of the spindle oscillation would arrive at their post-synaptic targets with the time delay due to axonal conduction (tens of milliseconds in cortex) (<xref ref-type="fig" rid="sa2fig1">Author response image 1A</xref>, left), leading always to a pairing within the window for long-term depression (LTD) that would progressively weaken long-range connections (<xref ref-type="fig" rid="sa2fig1">Author response image 1A</xref>, right). If, however, spindles are self-organized into large-scale wave-like activity patterns, with phase speeds matching those of the underlying fiber networks and stereotyped, precisely repeating trajectories (<xref ref-type="fig" rid="sa2fig1">Author response image 1B</xref>, left), then excitatory postsynaptic potentials (EPSPs) caused by spikes traveling along pyramidal axons to distant regions in the cortex could align with the local burst of population activity (<xref ref-type="fig" rid="sa2fig1">Author response image 1B</xref>, right), creating the conditions necessary for both synaptic strengthening and weakening to occur.</p><fig id="sa2fig1" position="float"><label>Author response image 1.</label><caption><title>Schematic of spindles and axonal delays.</title><p>(A) Spikes emitted from region A will arrive at B with a temporal delay of 20 milliseconds (left). If spindle oscillations were perfectly synchronized across the cortex, EPSPs from region A would occur after the spikes in region B, within the window for long-term depression (right). (B) In contrast, if spindles are spatiotemporally organized with stereotyped trajectories (left), then EPSPs from region A would align with population spiking in region B, allowing for synaptic strengthening to occur. Adapted from Muller et al., <italic>eLife</italic> 5, 2016.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-75769-sa2-fig1-v1.tif"/></fig><p>This mechanism for building distributed circuits in cortex opens the possibility that pairings between specific sites during spindles, mediated by spatiotemporal organization into traveling waves, can be modulated by memory load. In our revised manuscript, we have compared rotating waves following low and high visual memory tasks in the EEG dataset. Surprisingly, we find that rotating waves in the <italic>temporal -&gt; frontal -&gt; parietal (TFP)</italic> direction are significantly increased during high visual memory tasks (new Figure 4). This result, that rotating waves dynamically change under different memory conditions, provides an additional corroboration that our results are independent of confounds from volume conduction, as the only difference between the two EEG recordings from the same individual and recording setup was memory load. Further, these new results provide intriguing evidence that spatiotemporal dynamics in spindles may adapt to specific memory content during sleep-dependent consolidation. In this case, the significant increase in TFP waves may implicate a set of top-down circuits implicated by the specific memory task; in upcoming work, we aim to understand more fully how the spatiotemporal structure of sleep rhythms changes with memory content during sleep.</p><p>We hope that these additional details address concerns about the connection between the observations on sleep spindles in the present manuscript and mechanisms of human memory consolidation. We have added additional details and discussion on this point in the main text (lines 62-71 and 215-271).</p><p>Finally, while we consider several very different recording modalities in this work, it is important to emphasize that we do not draw comparisons across different electrode types. For example, we do not compare the rate of multi-area spindles in ECoG with those in iEEG. Rather, we focus on the result which clearly comes out consistently from our analysis: AT-type techniques systematically underestimate the number of multi-area spindles across all types of recordings. The main result of our paper, which is that the CNN model reveals multi-area spindles occur much more often than previously thought, is thus not affected by differences in spatial sampling of the electrodes (Figure 2c and S6b). We apologize that the explanation was not clear in the original manuscript and we have added additional clarification on this point (lines 95-102 and 296-300). We hope these additional clarifications fully address the Referees’ concerns on this point.</p><disp-quote content-type="editor-comment"><p>3. The reviewers thought the manuscript could benefit from an expanded discussion of the motivation for utilizing the CNN for spindle detection, in particular of how, if at all, they tailored the architecture to the spindle-detection setting. The description of the architecture (layers etc…) provided in the manuscript seems to mirror the description of that developed for gravitational wave detection. More generally, the reviewers thought that a discussion of how to tailor the architecture to the detection of brain rhythms other than spindles would benefit the neuroscience community. For instance, variables such as the length of the rhythmic pattern of interest ought to impact architectural choices.</p></disp-quote><p>We thank the Editor and Referees for bringing up this important point. Our work indeed is motivated by the utilization of CNN models in high-noise settings for waveform detection such as earthquakes (Perol et al., 2018) and gravitational waves (George and Huerta, 2018). A range of CNN architectures was proposed in these studies, with 1D to 2D channels as input layers, and convolutional layers ranging from 3 to 8 convolutional layers. We implement an architecture similar to the one proposed by George and Huerta (2018) with small modifications to the input and convolutional layers to take into account the basic features of the spindle rhythm in cortex (e.g. average duration). The CNN architecture is also slightly tailored to different sampling rates in each recording modality. As in previous work, the convolutional layer is designed to start by extracting local features, gradually extracting longer-timescale features by decreasing the feature space. Using this strategy, the CNN model can efficiently learn to detect the specific waveform characteristics of the sleep spindle in different types of recordings. In addition, we verified that the proposed CNN model is not sensitive to the slight change in the number of layers (e.g. 4, 5, and 6 convolutional layers) and hyperparameters such as learning rate, maximum number of epochs used for training, and pooling parameters. Details of these analyses are added in lines 445-466 and 475-488 in the revised manuscript.</p><p>We do agree that our two-step combination of the SNR algorithm (which generates a high-quality training dataset) and CNN model (which detects a more complete set of clear, well-formed spindles ranging from large- to small-amplitude events) can be applied more generally to detect brain rhythms other than spindles. We appreciate the Editor and Referees highlighting this potential contribution of our work, and we have added this point to the concluding paragraphs of the revised manuscript (lines 292-300).</p><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>Mofrad et al. trained a convolutional neural network (CNN) to improve the detection of multi-area spindles and study their regulation by working memory load. They used the CNN algorithm on three different sleep datasets (scalp EEG from humans that had performed a working memory task, intracranial human EEG, and ECoG recorded from macaques). They find that their CNN method identifies more regional and multi-area sleep spindles compared to an amplitude-based spindle detection method. Importantly, they found that the rate of occurrence of regional and multi-site spindles was higher in the sleep after human subjects performed a high-load visual working memory task, compared to after the subjects performed a low-load visual working memory task.</p><p>The results from this study advance the methods used to detect sleep events. As discussed by the authors, most algorithms to detect sleep oscillations in EEG and LFP data are based on amplitude thresholds; this approach is inadequate when studying regional and global spindles, in which the amplitude may not always remain above threshold in all recording sites. The authors overcome this limitation with a ML approach that detects significantly higher numbers of regional and multi-site spindles. The results presented here demonstrate how ML detection algorithms can offer novel insights on the function of spindles; similar approaches could be helpful with other sleep oscillations. Specifically, the results presented by Mofrad et al. suggest that, compared to amplitude-based detection methods, CNNs improve the detection of spindles that occur temporally correlated across cortical regions. In addition, the authors used the CNN spindle detection method on human sleep data after subjects performed a working memory task. The results are consistent with the hypothesis that cross-regional spindle synchronization is regulated by working memory load prior to sleep, providing insight into how specific cognitive processes influence sleep spindles.</p><p>An additional strength of this study is the demonstration that the CNN method yields similar results in ECoG, EEG, and iEEG, and in data from macaques and from humans, suggesting that the detection method is applicable across species and across electrophysiological recording methods.</p><p>A few points should be considered when interpreting the results. The definition of local, regional, and multi-site spindles used in this manuscript is based on the absolute number of electrode sites in which a spindle was detected. Since the ECoG, EEG, and iEEG have different spatial sampling, the definition could overestimate regional and multi-site spindles in iEEG recordings, particularly in the subjects that had large number of electrode contacts in one brain region. This could contribute to the much higher ratio of global spindles observed in the iEEG data compared to ECoG and EEG. Nonetheless, the analyses that support a correlation between widespread spindles and memory load were based on 64-channel scalp EEG and are not expected to be biased by differences in electrode spatial sampling.</p><p>Lastly, the results are interpreted in the context of the systems memory consolidation hypothesis, which proposes that new memories become integrated into neocortical networks in a process that is facilitated by sleep oscillations. The results from the sleep EEG analyses after subjects performed a low- or high- load visual working memory task are indeed consistent with the idea that multi-site spindles contribute to the consolidation of memories formed before the subjects went to sleep. Likewise, the results are also consistent with the synaptic homeostasis hypothesis, which states that sleep oscillations are important in scaling synaptic plasticity of networks that may have been particularly active during wakefulness. The results of this study are therefore congruent with the possibility of multi-site spindles coordinating the homeostatic regulation of synaptic strength across multiple cortical regions in relation to the cognitive load experienced by the subjects during wakefulness prior to sleep.</p></disp-quote><p>We thank the Reviewer for the thoughtful and thorough review, and for highlighting the novelty and importance of the scientific results presented in this work. In our revised manuscript, we have included additional details in order to more clearly document the methods and results presented here. In particular, we have addressed concerns about the difference in spatial sampling across the recordings, added new analysis of the spatiotemporal structure in the sleep spindles we detect, and provided a clear explanation of the connection between our observations on sleep spindles in the present manuscript and mechanisms of human memory consolidation. We hope this additional information and analysis have expanded and substantially strengthened the manuscript.</p><disp-quote content-type="editor-comment"><p>Recommendations for the authors</p><p>The work presented in this manuscript is highly relevant to advance the methods used to detect sleep oscillations, and to understand the functional significance of sleep spindle coordination across cortical areas. The manuscript text and figures are clear and well-organized. Below are suggestions that may help further improve the quality of this work.</p></disp-quote><p>We thank the Reviewer for the positive comments on our submission, including highlighting the importance of developing an accurate, automatic sleep spindle detection algorithm. We also appreciate their helpful comments to improve the paper. In this revised manuscript, we have introduced updates to address all comments in full.</p><disp-quote content-type="editor-comment"><p>The distinction of three spindle types (local, regional, multi-area) based on the co-occurrence across recording sites should be discussed with regard to the different spatial sampling of EEG, ECoG and, specially, iEEG electrodes. For example, spindles detected in multiple recording sites in subjects such as B and C which have multiple contacts in one brain region (Suppl. Table 1), might be incorrectly labelled as regional or multi-area. Although sampling biases are not expected to affect the results regarding memory, it will be helpful for readers to explain how these potential biases were addressed in the analyses of iEEG data. Could the much higher ratio of multi-area spindles in iEEG data (Figure 2c, right panel) be explained by electrode sampling bias? Along the same lines, it may be more appropriate to refer to 'multi-area' spindles as 'multi-site' spindles if they do not necessarily imply occurrence in distinct cortical areas.</p></disp-quote><p>We appreciate the opportunity to discuss this important point. While we consider several very different recording modalities in this work, it is important to emphasize that we do not draw comparisons across different electrode types. For example, we do not compare the rate of multi-area spindles in ECoG with those in iEEG. Rather, we focus on the result which clearly comes out consistently from our analysis: AT-type techniques systematically underestimate the number of multi-area spindles across all types of recordings. The main result of our paper, which is that the CNN model reveals multi-area spindles occur much more often than previously thought, is thus not affected by differences in spatial sampling of the electrodes (Figure 2c and S6b). We apologize that the explanation was not clear in the original manuscript and we have added additional clarification on this point on lines 95-102 and 296-300 in the main text.</p><p>In our original submission, we took the multi-area point very seriously, and by identifying the cortical regions for each iEEG contact, we quantified the number of unique cortical regions participating in each spindle (Figure 2b). This analysis demonstrated that spindles classified as “multi-site” by our CNN algorithm do in fact occur across multiple cortical areas (60% of recorded regions, bar plot, Figure 2b), corroborating the “multi-area” designation in our analysis. In our revised manuscript, we have realized the importance of this critical point, and we have introduced updates to highlight it more clearly in the main text (lines 153-159 and 320-321).</p><p>In addition, we have expanded on this analysis with new supplementary figures to further support this point. Our new Figure S6a demonstrates that the increase in the percentage of parcellated cortical regions participating in a spindle is significant at the individual level in all five iEEG subjects analyzed in this work. Our new Figure S7 shows these increases remain significant if we consider spindle participation at the level of cortical lobes (frontal, temporal, parietal, occipital) and at the level of cortical systems (executive, limbic, visual, auditory, somatosensory). Both of these analyses provide further evidence to support that spindles detected by the CNN model are distributed widely across multiple brain areas, lobes, and systems, providing insight into the role spindles play in memory consolidation. Finally, at all points results from the CNN model are compared with the AT approach, which tends to detect only local spindles, consistent with our proposition that thresholding-type algorithms may over-emphasize local events (lines 170-173).</p><disp-quote content-type="editor-comment"><p>It would also be helpful to expand the justification for the choice of CNN algorithms; the text refers to their previous use detecting earthquakes or gravitational waves but is not immediately clear why noise in these applications would be similar to noise in sleep signals.</p></disp-quote><p>We thank the reviewer for raising this point, which we have addressed in the main text. Previous works on detecting earthquakes and gravitational waves have demonstrated the potential and efficacy of CNN models for waveform detection in very high-noise settings. Importantly, these methods are relatively general to the type of noise in each recording, provided there is enough training data and high-quality marked events. In this case, the CNN can efficiently learn to detect the specific waveform characteristics distinguishing the sleep spindle rhythm in these recordings. We have added additional clarification on this point on lines 82-86 in the main text.</p><p>In addition, to add further support to this point, we have added a new supplementary figure and table in the revised manuscript. By training the CNN model on surrogate data with systematically varying noise properties, we demonstrate that this approach is robust to different types of noise on the recording electrode (Methods – Simulated data control – varying noise and new Table S1 and Figure S1), showing that we can expect this approach to generalize well across recordings with different types of noise. This analysis further supports our validations in the original submission, where we showed that detected spindles exhibit a clear power increase in the expected range (Figure 1b), detected spindles are well-formed in individual examples (Figure 1d), and averaging across detected spindles without bandpass filtering still results in the expected waveform (Figure S3). These additional analyses provide further evidence that the AT has lower detection power even in the surrogate data with no artifact such as line noise, electrical noise, and movement artifacts that can introduce signal distortion in experimentally recorded signals.</p><p>Taking these results together, we believe we have provided substantial evidence that the CNN model we have introduced can accurately detect spindles across a range of sleep recording types. We have included text to more clearly highlight the utility and potential applications of this resource in future work (lines 296-300).</p><disp-quote content-type="editor-comment"><p>Line 35: remove 'stage 2': the references provided are mostly from rodents, in which separate NREM sleep stages are less defined; and spindles are not necessarily exclusive of N2 even in humans.</p></disp-quote><p>Thank you for raising this point. We have removed stage 2 (line 39) in the revised manuscript.</p><disp-quote content-type="editor-comment"><p>Lines 61,62: Long-range connections are one potential link to temporarily coordinate spindles across cortical areas. Another important set of connections that could coordinate spindles are the thalamocortical projections, mainly those thalamic pathways with widespread projections to superficial layers of cortex (references such as Clasca et al., 2012, Eur J Neurosci 35(10):1524-32. doi: 10.1111/j.1460-9568.2012.08033.x.).</p></disp-quote><p>We thank the Referee for bringing this important point to our attention. We have added the thalamocortical connections as a potential pathway for coordination of spindles in the revised manuscript (lines 246-254).</p><disp-quote content-type="editor-comment"><p>Lines 102-103: please specify how descriptive statistics are reported; are the values reported in parenthesis the mean and standard deviations? Clarify in the methods section how duration was calculated.</p></disp-quote><p>We thank the Reviewer for this and apologize that it was not clear in the original submission: the descriptive statistics here are average ± SEM (line 124). We have added detailed explanations to clarify the calculation of spindle duration in the supplementary section “Methods Convolutional neural network (CNN) for sleep spindle detection” (lines 480-488). We have also clarified the calculation of spindle duration, which is included in our response to the next comment.</p><disp-quote content-type="editor-comment"><p>The methods state that 'The CNN model takes a window of sleep recording (500 ms which is bandpass…)' (Line 303), is that a 500ms moving window? With what step size? What determines the start and end of a spindle in the CNN and AT methods?</p></disp-quote><p>Thank you for bringing up this important point. We have added a detailed explanation of the entire process in the supplementary section “Methods – Convolutional neural network (CNN) for sleep spindle detection” (lines 480-488) and “Methods – Comparison with amplitude-threshold approach” (lines 531-537).</p><p>Briefly, the CNN model takes a sliding window of sleep recording (500 ms, signal bandpassed 1-100 Hz) as an input and determines its label (spindle or non-spindle). The sliding window starts at the beginning of the recording and moves 100 ms in each step. To find the start and end time of a spindle, we first combined all overlapping spindle windows. We then included neighbor windows if there is any spindle within 100 ms of the combined windows to account for potentially mislabeled windows. The start of a spindle is finally set to the beginning of the first window, and the end of the spindle is set to the end of the last window.</p><p>To create a clear comparison, we implement precisely the same procedure for the AT approach. To do this, we compute the signal envelope over a sliding window of 500 ms with 100 ms step size. We then compare signal envelope for each window to the AT threshold. Finally, we combine windows as with the CNN approach to get the start and end time of each spindle.</p><disp-quote content-type="editor-comment"><p>Line 161: include p value for local spindles (as done in the figure legend).</p></disp-quote><p>We appreciate this suggestion, and we have added the local spindle p-value to the main text</p><p>(lines 198-199).</p><disp-quote content-type="editor-comment"><p>Given the unique dataset and methods, and the focus of this work on the locality and globality of spindles, the authors may want to report on potential changes in the density of local spindles specifically over visual and frontal cortical areas. Is it possible that increases in local spindle density are not significant when all regions are considered together but may be significant in certain regions engaged by the visual working memory task? In that sense, it is interesting that the SNR approach detects a (smaller) increase in local spindles with high memory load (Supp. Figure 4a). A more precise analysis of local spindles over relevant cortical areas will not diminish the author's main result on multi-area spindles, but it will provide additional cues on the role of spindle spatial synchronization in sleep and will enhance the value of this interesting work.</p></disp-quote><p>We thank the Referee for suggesting this new analysis which provides additional insight on the role of spatial synchronization of spindles during sleep. Following this suggestion, we studied the change in density of spindles in frontal, occipital and parietal lobes (new Figure S9) in low and high visual memory conditions. To do this, in each cortical lobe, we computed the percentage of electrode sites with spindles within the detected windows by the CNN model. Interestingly, we observe a significant increase in the percentage of electrode sites in high versus low visual memory conditions across all cortical lobes. On average the occipital lobe with more than 20% electrode-site participation has the highest and the frontal lobe with about 10% has the lowest participation (lines 207-213).</p><disp-quote content-type="editor-comment"><p>Lines 241-242 say that 'the quality of sleep was studied by the degree of spatial synchronization'; it will be helpful to clarify this statement because if the degree of spatial synchronization was used to select the sleep data used for this work, the dataset may include more synchronized activity compared to other datasets. This does not nullify the results, but clarification will be important to ensure replicability. Likewise, the methods used for sleep detection should be described in more detail, was sleep detected in the same way in all datasets?</p><p>Line 250: only visual inspection was used to detect stage 2 in the EEG data? clarify if only NREM sleep was used in all datasets used for analysis? (same for the iEEG recordings)</p></disp-quote><p>We thank the Referee for noting this important point on selecting sleep epochs in the recordings. In our analysis, we studied the full recordings annotated as sleep without excluding REM states. As mentioned in the Methods section, sleep state was assessed in the recordings using a method best adapted to each recording type. For example, in the EEG recordings, sleep state was manually annotated by an expert for stage 2 NREM sleep. In the iEEG recordings, sleep annotations were provided by hospital staff who observed times when a patient was sleeping and noted in their chart. Finally, in the ECoG dataset, NHP subjects were placed in a quiet and dark room with eyes covered for up to 90 minutes. The sleep state in this case was determined using the degree of spatial synchronization and power increase in the 1-4 Hz δ frequency band.</p><p>We appreciate the Reviewer’s comment on this point, and in developing this analysis, we carefully considered the differences in determining sleep state across the datasets analyzed here. Because in the ECoG data spatial synchronization was only assessed in the 1-4 Hz frequency band, which is known to be consistently more synchronized during sleep (Destexhe et al., <italic>J Neurosci</italic> 19, 1999; Dang-Vu et al., <italic>Neuroimage</italic> 28 2005; Chauvette et al., <italic>J Neurosci</italic> 31 2011; Murphy et al., <italic>PNAS</italic> 106.5 2009), we believe that these datasets are not more synchronized than other sleep recordings. Further, we find consistent results across the datasets we analyzed, which varied in the way they detected the sleep state. With this in mind, we believe our analysis provides considerable evidence to indicate that this potential concern does not affect our results.</p><p>We fully agree that more details would be helpful to document the recordings, and we appreciate the Reviewer’s suggestion along these lines. In our revised manuscript, we have included several updates to the supplementary section “Methods – Recordings” to detail the behavioral and electrophysiological aspects of these datasets (lines 372-373, 383-386 and 393-394). We hope this additional information also addresses the Reviewer’s more general point about reproducibility, which is an important commitment in our work.</p><disp-quote content-type="editor-comment"><p>Not clear what is added by the paragraph between Lines 283-288 unless more details are provided. If the model simulates spiking activity in the awake state, is this helpful as a ground truth control for sleep LFP? What type of spiking model? What network architecture?</p></disp-quote><p>We thank the Reviewer for noting that more details are necessary to clarify the spiking network control simulation. With this analysis, we sought to provide additional evidence that our approach can robustly detect sleep rhythms while also – importantly – providing no detections when sleep-like rhythms are not present. To do this, we used data produced by a spiking neural network model we have currently developed to study the spontaneous background activity of awake cortical circuits (Davis, Benigno, et al., <italic>Nature Communications</italic>, 2021 [link]). This model, composed of several million neurons with biologically realistic synaptic connectivity (several thousand synapses per cell), creates realistic ongoing activity patterns consistent with the well-studied asynchronous-irregular state. In addition, we have incorporated a recently developed LFP proxy (Mazzoni et al., <italic>PLoS Comput Biol</italic>, 2015) in the model, allowing us to analyze a population signal using our spindle detection algorithm. Starting with the first step in this process, we first apply the SNR algorithm to detect well-formed spindles for training data. As expected, however, the SNR approach does not detect any spindles in the simulated data.</p><p>Because the simulation lacks the mechanisms for generating large-scale thalamocortical and corticocortical rhythms, this provides a ground-truth test that our approach does not detect spurious spindles in neural population signals. The results from this analysis provide additional confirmation, in a setting where we know rhythms such as spindles do not exist, that our approach is not only robust to various types of noise but also sensitive to spindle rhythms embedded in population signals. We have added additional details about this model in the supplementary section “Methods – Signal-to-noise ratio (SNR) measure for sleep spindle detection” (lines 430-435).</p><disp-quote content-type="editor-comment"><p>Paragraph starting in line 290. Was the CNN model trained and optimized for each dataset?</p><p>Lines 296-297: 'best' based on what?</p></disp-quote><p>This is an excellent point, and we thank the Reviewer for bringing this up. In the revised manuscript, we have included additional details on the process of training and optimization of the CNN model. We implement an architecture similar to the one proposed by George and Huerta (2018) with small modifications to the input and convolutional layers to take into account the basic features of the spindle rhythm in cortex (e.g. average duration). The CNN architecture is also slightly tailored to different sampling rates in each recording modality. As in previous work, the convolutional layer is designed to start by extracting local features, gradually extracting longer-timescale features by decreasing the feature space and increasing channels. Using this strategy, the CNN model can efficiently learn to detect the specific waveform characteristics distinguishing the sleep spindle rhythm in different types of recordings. In addition, we verified that the proposed CNN model is not sensitive to the slight change in the number of layers (e.g. 4, 5, and 6 convolutional layers) and hyperparameters such as learning rate, maximum number of epochs used for training, and pooling parameters using similarity measure across the predicted values. To perform this sensitivity analysis, for each CNN architecture, we made a grid search over the potential range of hyperparameters, measuring the similarity of model output by Cronbach's α. Similarity across hyperparameters within 10-50% of those used in our analysis was greater than 0.99, indicating high reproducibility under moderate parameter variability. We then used the same architecture and hyperparameters across all subjects and recording datasets. We trained a separate CNN model for each subject on a portion of the available recording and then applied the trained model to detect spindles across the entire recording.</p><p>We thank the Reviewer for pointing out the importance of including more details on this point. We have added additional material in lines 445-466 and 475-488 of the revised manuscript to clarify the optimization, parameter tuning, training, and implementation of the CNN.</p><disp-quote content-type="editor-comment"><p>Line 350 states that the overall threshold for the AT method was based on the average root mean squared. Was the AT approach developed and applied independently for each data set (EEG, ECoG, iEEG)? It is not clear from the text if the different signal amplitudes in the datasets were considered for AT detection (were the data and RMS normalized?).</p></disp-quote><p>This is an important point for the clarity of the manuscript, and we appreciate the Reviewer for bringing this up. As with the CNN model, we applied the AT algorithm independently for each subject to account for the difference across subjects and recordings. We have updated the Methods on line 541-543 to clarify this point.</p><disp-quote content-type="editor-comment"><p>Figure Supp. 5: correct typo in the figure legends (spindle)</p></disp-quote><p>Thanks for catching this typo. We have corrected the error in the revised manuscript (Figure S10).</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>The primary goal of this paper is to provide evidence that sleep rhythms are more spatially extended than previously known, using a deep learning convolutional neural network (CNN) model specifically designed to characterized rhythmic activity that has not previously been applied to sleep data.</p><p>Strengths</p><p>1. The authors establish that the CNN method proposed can detect spatially extended sleep rhythms and that difference occur when measuring spindles after a low vs high load memory tasks in multiple data sets.</p><p>2. The CNN method presented may provide a powerful technique to characterize a range of brain rhythms and difference across tasks or patient populations.</p><p>3. The results and figures are clearly presented.</p><p>4. The methods are sound, with the exception that more detail on the method and how it uniquely accounts for rhythmic activity is warranted and should be discussed in the Results section of the paper, rather than in the methods.</p></disp-quote><p>We thank the Reviewer for these positive comments on the methods and results presented in this work. In our revised manuscript, we have included additional detail in order to more clearly document the methods in this work. In particular, we have added more specific characterization of how the CNN model specifically and accurately detects sleep spindle activity in the main text and supplement (lines 82-86, and 95-102 and, Figure S1 and Table S1).</p><disp-quote content-type="editor-comment"><p>Weaknesses</p><p>1. The results of the paper do not establish that this CNN method is better than prior methods at detecting spatially extend sleep rhythms, or that the methods is better able to distinguish sleep spindles after a low vs high load memory task. As such, while a new method for detecting spindles is clearly presented, there do not appear to be any new scientific findings in this paper.</p></disp-quote><p>We appreciate the Referee's point, which we considered carefully in preparing our revised submission. The main focus of our work is to compare our CNN approach to standard amplitude-thresholding approaches. The hypothesis underlying this comparison is that amplitude-based approaches, in general, will miss many spindles that exhibit transient dips in power, or those that are very clearly formed but small in amplitude (see Figure S5). While the simplest implementation of this algorithm (Mölle et al., <italic>J Neurosci</italic> 22, 2002) can be improved by imposing additional conditions on the AT procedure (e.g. Hagler et al., <italic>J Neurosci</italic> 38, 2018 and Warby et al., <italic>Nature Methods</italic> 11, 2014), it remains difficult to cover all cases by successively adding additional conditions. Training a CNN model to detect spindles, however, has the advantage of developing these conditions automatically, without requiring hand-tuning by the analyst.</p><p>We thank the reviewer for bringing up this point about clearly comparing the CNN method to prior approaches, and we have now highlighted this more clearly in the revised manuscript. In addition, in the original submission we directly compared the changes in sleep spindles following high- versus low-load visual memory tasks (Figure 3b and S8b), and we found that the CNN was able to detect a significant increase, while the amplitude-thresholding approach found no change. We believe this result clearly demonstrates the potential for our CNN approach to find new scientific results in analyses of sleep rhythms, and we have now highlighted this more clearly in the revised text.</p><p>Finally, in our revised manuscript, we have now gone back to the recordings from the visual memory task and discovered a novel finding about spatiotemporal dynamics during multi-area spindles: rotating spindle waves significantly increase following high-load visual memory tasks, which we had previously observed to be associated with increased multi-area spindles (new Figure 4 and Video S1). These new results specifically tie the increase in multi-area spindles we reported in the original submission to a neural circuit mechanism for rotating waves in consolidating memories across distributed networks in cortex (see Figure 2, Muller et al., eLife 5, 2016). We have highlighted these new results in our responses to the main critiques, and also revised the manuscript to reflect these points (lines 62-71, 104-107 and 215-271 and new Figure 5).</p><p>In summary, we hope that these additions clearly and sufficiently address the Referee’s original concerns about our manuscript. We believe that the new computational approach presented in this work is clearly more effective at detecting multi-area spindles, which are not observed using the previous approach, and at finding new scientific results, such as the selective increase in multi-area spindles and rotating waves following challenging memory tasks.</p><disp-quote content-type="editor-comment"><p>The authors compare the CNN with only the AT methods for the main result of the paper (Figure 3, Supplementary Figure 3), and not the SNR method. Why not compare directly to the SNR also to see if CNN is actually better? The SNR method is used to generate the data set that the CNN is trained on, as such is it possible for the CNN to do better? Would the AT method be able to pick up more multi-area spindles with a lower threshold?</p></disp-quote><p>We thank the Reviewer for bringing up this important point. We introduced the SNR algorithm ourselves in a previous manuscript (Muller et al., eLife 5, 2016) as a conservative approach to detect spindles while maintaining a low false-positive rate. This method, which is based on the constant false-alarm rate (CFAR) method in radar (Levanon, N., John Wiley and Sons, New York, 1988; Minkler, G. and Minkler, J., Magellan, Baltimore, 1990), detects many “true” spindles while minimizing false detections; however, its aim is not to detect all spindles. For this reason, while the SNR approach is excellent for generating a high-quality training dataset (as used here for the CNN model, Figure 1) and for providing a second check on results from the CNN model (as in Figure S10), we know that it cannot provide a comprehensive detection method approaching detection of all spindles in a recording. For this reason, we have adapted the deep learning waveform detection approaches to create the method we introduce in this work. The advantage of the CNN approach we introduce is that it can detect many more spindles at high quality.</p><p>Unfortunately, because of potential artifacts associated with the AT approach, decreasing the amplitude threshold in that method will not only detect more spindles, but also more mis-classified activity patterns (i.e. false positive detections). For example, we can start with an amplitude threshold that produces 2 spindle detections per minute (Gaïs et al., J Neurosci, 2002) and then reduce this threshold by half. In <xref ref-type="fig" rid="sa2fig2">Author response image 2</xref>, we provide several examples of clearly non-spindle activity detected using this reduced threshold.</p><fig id="sa2fig2" position="float"><label>Author response image 2.</label><caption><title>Impact of AT threshold on spindle quality.</title><p>(a) Plotted are the average time-shifted over spindle detected by the AT algorithm using 2 spindles per minute threshold (black line), additional spindles detected by the AT algorithm after decreasing the threshold to its half (blue line), and lastly a subset of randomly matched non-spindle windows (red line).</p><p>As expected by decreasing the threshold, the average over detected spindle activities starts to drift away from the expected 11-15 Hz oscillatory structure. (b) Examples of non-spindle activity (blue line) detected by the AT approach when we decrease the threshold producing 2 spindles per minute (solid green line) by half (dashed green line). The red line is the signal envelope.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-75769-sa2-fig2-v1.tif"/></fig><p>In contrast to reducing the threshold in the AT approach, however, our CNN method is able to detect high-quality spindles that co-occur across the cortex much more often than previously thought. In our original submission, we validate this approach through analyzing the power spectrum of detected events (Figure 1b), through a time-aligned averaging approach (Supplementary Figure S3), and finally through comparison to the subset of spindles detected by the AT approach (Figure S5). At the same time, we appreciate that we may not have made the importance and impact of the CNN and SNR approaches clear in the original submission. In our revised submission, we have added additional text clarifying the SNR algorithm we have introduced previously, its use for generating a high-quality training dataset for the CNN (lines 110-117 and 292-300 in the main text), and its use in validating the results from the CNN. We appreciate that these points may not have been clear in the original submission, and we hope these new additions fully address the Referee’s concerns.</p><disp-quote content-type="editor-comment"><p>The CNN and SNR methods are directly compared only for the low vs high memory load task in Supplementary Figure 4. A visual comparison of the low vs high memory load results from the CNN (Figure 3c) and SNR methods (Supplementary Figure 4 top) suggests that the SNR method is equally able to distinguish these conditions. Overall, the advantage of the CNN is not clear.</p></disp-quote><p>We thank the Referee for raising this important point, which may not have been clear in the original manuscript. As detailed in the previous response, the main disadvantage of the SNR approach is that it is overly conservative: it will exclude too many spindles at the expense of keeping false positives low. Thus, while the SNR approach is useful for quickly identifying a set of spindles with low false-positive rate, it is not adequate for studying the full population of spindles or for answering questions about changes in distribution in general.</p><p>At the same time, however, the fact that the subset of spindles detected by the SNR approach exhibits the same increase under high versus low visual memory load as observed by the CNN approach provides an important corroboration of this result. These two approaches provide clearly converging evidence that distributed spindles appear following high visual memory tasks, a change that is not detected by the AT approach. For this reason, we believe that we have not only validated the performance of the CNN approach in contrast to amplitude-based approaches, but also clearly demonstrated that this approach is able to find qualitatively new results providing insight into the process of human memory consolidation.</p><p>We again thank the Referee for raising this point, which we have tried to clarify in the main text (lines 202-207). We believe that this additional explanation more clearly introduces the advantages of the CNN approach and addresses the Referee’s point in full.</p><disp-quote content-type="editor-comment"><p>2. There are several high-level strong claims in the paper that are not directly investigated or supported by the evidence in this paper. For example, &quot;These results thus provide specific neural mechanisms by which memories can be stored in distributed neocortical networks during sleep&quot;. &quot;Taken together, these results provide substantial evidence of a specific role for spindles in linking neuron groups distributed widely across cortex during memory consolidation&quot;. &quot;The key missing piece is to understand how spindles can guide specific long-range excitatory connections to strengthen during sleep-dependent memory consolidation. We hypothesized that widespread, multi-area spindles might provide this mechansism&quot;. At best, the results in this paper provide supportive evidence that spindles could do these things by they do not investigate or establish causality in any way.</p></disp-quote><p>We thank the Referee for raising this point, with which we fully agree, and we apologize for any ambiguity in the original submission. This manuscript was originally meant as a follow up to a previous article (Muller et al., <italic>eLife</italic> 5, 2016), in which we reported that spindles were often organized as waves rotating across the cortex. In the previous manuscript (and in additional modeling work), we studied the phase speed distributions of the traveling spindle waves, which fell in the range of 2-5 m/s. As these speeds fall uniquely within the conduction velocity of the long-range fibers in cortex, we proceeded to study the long-range fibers as a potential propagation substrate and introduced a neural circuit mechanism for how these waves can enable the consolidation of memories across sets of neurons distributed widely across cortex.</p><p>We appreciate the Referee’s point and again apologize that this important connection was not clear in the original manuscript. We have taken the Referee’s concern to heart, and in the revised manuscript, we have connected our analysis of multi-area spindles to our previous results on spindle traveling waves (new Figure 4). We specifically have gone back to the data from the visual memory task and discovered a novel finding: rotating spindle waves significantly increase following high visual memory tasks, which we had previously observed to be associated with increased multi-area spindles. These new results specifically tie the increase in multi-area spindles we initially reported in the original submission to a neural circuit mechanism for rotating waves in consolidating memories across distributed networks in cortex (see Figure 2, Muller et al., <italic>eLife</italic> 5, 2016). We added new analysis in line 215-271 in the main text and the details of the computation in the new sections, “Methods – Rotating wave direction” and “Methods – Simulated data control – rotating wave”, in the supplement.</p><disp-quote content-type="editor-comment"><p>3. It is stated that in the ECoG and iEEG data, the AT method detected a subset of spindles that are significantly higher-amplitude than those detected by the CNN methods, using a one-sided Wilcoxon sign rank test. Does this mean that CNN does not detect some of the high amplitude spindles? Is this advantageous? There is something confusing about the way this is stated. A Figure of the distribution in number and amplitude of spindles detected with the 3 methods (CCN, AT, SRN) would be useful.</p></disp-quote><p>We appreciate this point, and in the revised submission we have this in the text to make the point more clear. While the AT approach detects only the highest amplitude spindles in the dataset (new Figure S4a), the CNN approach is able to detect some lower amplitude (but still clearly formed) spindles in addition. Thus, as expected, this result is reflected in the fact that the set of spindles detected by the AT approach (which preferentially detects the highest-amplitude events) has higher average amplitude than those detected by the CNN (which detects a broader set of spindles). Specific examples of this can be observed in the EEG recordings in Figure 1c, where the first and second spindles were not detected by AT and in Figure S5, which provides examples where the CNN detects clear spindles but the AT does not.</p><p>Moreover, to address the Referee's concern regarding the number of spindles, we perform a new analysis, in which we computed the number of spindles per minute for each session across all recordings. Interestingly, the CNN model tends to detect on average 4-5 spindles per minute (almost twice of what was reported in the literature) as opposed to the AT which resulted in 2-3 spindles per minute except in the NHP ECoG recording (new Figure S4b). The result further demonstrates that if trained properly, the CNN model has the ability to detect hidden spindles that are being unnoticed and provides a great opportunity to study the spatial and temporal analysis of spindle activities across the cortex.</p><p>We thank the Referee again for raising this important point, which we have attempted to clarify in the revised submission. We have specifically focused on clarifying why spindles detected with the AT method are expected to have higher amplitude overall (lines 138-147) and how the CNN method, which detects spindles missed by the AT approach, improves our understanding of sleep spindles and changes following visual memory tasks (lines 202-207 and 286-292). We believe these additional points fully address the Referee’s concern on this point.</p><disp-quote content-type="editor-comment"><p>4. The 3 different recording methods sample activity across different spatial scales, and depth electrodes (iEEG) are sampling vastly different areas (i.e. deeper sources) than ECoG and EEG. As such, it is difficult to relate findings related to &quot;simultaneous spindle detection&quot; in local, regional, multi-area electrodes across these three different measures. A primary concern is that the finding that there are more multi-area spindles (e.g. Figure 2b for iEEG – similar results for EEG and ECoG are not quantified) could be due to volume spread of the spindle source. Is there a way to rule this out? There are ways to minimize the influence of volume conduction with EEG and ECoG source analysis, however, to my knowledge, these methods currently don't exist for iEEG.</p></disp-quote><p>We thank the Referee for raising this critical point. We agree that it is important to carefully consider the differences in spatial sampling by the ECoG, EEG, and iEEG electrodes studied in this work. For this specific point, it is important to note that iEEG depth electrodes record cortical activity with the highest spatial resolution possible of intracranial recording techniques (Mukamel and Fried, <italic>Ann Rev Psych</italic> 63, 2012), while also quickly becoming standard in the field of neurosurgery because of their increased safety and improved patient outcomes compared to subdural grid arrays (Tandon et al., <italic>JAMA Neurol</italic> 76, 2019). Because iEEG electrodes have the highest spatial resolution of the recording techniques considered here, with ECoG (Dubey and Ray, <italic>J Neurosci</italic> 39, 2019) and EEG (Babiloni et al., <italic>Clin Neurophysiol</italic> 112, 2001) representing increasingly lower spatial resolution, it would be difficult for the higher number of multi-area spindles observed in iEEG to result from increased volume spread of the spindle source, as the influence of volume conduction is minimized in this recording technique. Rather, if increased volume spread were the underlying cause for this finding, we would expect the pattern to be the opposite, with more multi-area spindles in the EEG data (where volume conduction effects are highest). We thank the Referee for raising this important point, which we have clarified in the revised text (lines 167-169).</p><disp-quote content-type="editor-comment"><p>Recommendations for the authors:</p><p>In Figure 1d, there appear to be other spindle in each of these example traces. Were these not picked up by the algorithm, or simple not highlighted in red? Clarification would be helpful.</p></disp-quote><p>We thank the Referee for pointing this out and apologize for any confusion. In the original figure, we only highlighted the spindles in the central window (at the middle of the plot). In the revised Figure 1d (line 304), we have now highlighted all detected spindles, in order to demonstrate more clearly the events detected by our CNN approach.</p><disp-quote content-type="editor-comment"><p>Why are the randomly sampled red dashed line in Supplementary Figure 1 not flat? Is the 1Hz filter somehow biasing the amplitude at the center?</p></disp-quote><p>We thank the Referee for bringing this point up. In Figure S3, we verify that spindles detected by the CNN approach exhibit high-quality waveforms and rule out potential artifacts from bandpass filtering. To do this, we took each signal highpassed at 1 Hz, re-aligned to the largest oscillation peak in the time window, and then averaged across detected events. With this procedure, the average across detected spindles exhibits clear 11-15 Hz oscillations, even without bandpass filtering. This calculation thus provides strong evidence that the CNN approach detects high-quality spindle events.</p><p>We then repeated this calculation on a matched number of randomly selected non-spindle windows, which are those plotted as red dashed lines in Figure S3. Because we align signals to the central peak in the window, we expect there to be a positive peak at this point. Naturally, this peak will exhibit a decay consistent with the autocorrelation time present in the 1 Hz filtered signal. Importantly, however, this control condition exhibits no 11-15 Hz oscillations (i.e. additional peaks beyond the central one), demonstrating that the CNN method correctly identifies non-spindle windows, as well.</p><p>We again thank the Referee for raising this point. In the revised submission, we have included a few sentences clarifying this point in the main text (lines 136-138) and in the supplementary section “Methods – Time-shifted averaging control” (lines 509-514).</p><disp-quote content-type="editor-comment"><p>It would be helpful to see the results shown in Figure 2b for iEEG for ECoG and EEG data as well.</p></disp-quote><p>This is an important point, and we appreciate the Referee bringing this up. For the analysis in Figure 2b, we developed an atlas-based computational approach to placements of iEEG electrodes in collaboration with a neuroimaging laboratory. This approach included white and gray matter segmentation, registration, and cortical segmentation of iEEG electrodes. Unfortunately, we could not perform similar parcellation in EEG and ECoG recordings but we were able to further confirm that multi-area spindles are in fact distributed widely across the brain in the EEG dataset. To do this, we studied cortical lobe participation (new Figure S9) and using electrode coordinates we analyzed the change in rotational pattern of multi-area spindles (new Figure 4) in the EEG.</p><disp-quote content-type="editor-comment"><p>There is are claims about SNR and CNN being independent of spindle amplitude. Clarification of how the SNR power calculations are independent of amplitude would be useful.</p></disp-quote><p>Thank you for bringing up this concern. We introduced the SNR algorithm in a previous manuscript (Muller et al., <italic>eLife</italic> 5, 2016) as a conservative approach to detect spindles while maintaining a low false-positive rate. This method is based on the constant false-alarm rate (CFAR) method in radar (Levanon, N., <italic>Wiley</italic>, New York, 1988; Minkler, G. and Minkler, J., <italic>Magellan</italic>, 1990) which is used for narrow-band rhythmic activity detection in a high-noise situation with the goal of reducing false-positive detection. The CFAR is an adaptive process for target detection which adjusts the detection threshold accordingly (Weinberg, Graham Victor, <italic>IET Radar, Sonar and Navigation</italic> 7.2, 2013) to account for the change in the noise power/amplitude. Inspired by this technique, the SNR algorithm detects spindle activities by measuring the ratio of power within the frequency band of interest (here, 9-18 Hz) to power in the rest of the spectrum (1-100 Hz bandpass, with band-stop at 9-18 Hz) which make this technique approximately amplitude-invariant. While conducting our analysis, we observed a lot of examples which verified our claim of SNR being approximately amplitude invariant. An example is presented in Figure 1d in the main manuscript. In this example, the spindles detected in the EEG recording contain high and low amplitude spindles. All of these spindles were detected by both the CNN model and SNR approach, while the AT approach fails to detect the first (low-amplitude activity) and last spindles (temporary drop in amplitude) (<xref ref-type="fig" rid="sa2fig3">Author response image 3</xref>) (Lines 549-550).</p><fig id="sa2fig3" position="float"><label>Author response image 3.</label><caption><title>AT sensitivity to amplitude.</title><p>The AT algorithm fails to detect clearly formed spindles detected by the CNN model in Figure 1d EEG recording because of low amplitude or temporary drop of amplitude below the threshold.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-75769-sa2-fig3-v1.tif"/></fig><p>To further validate this claim, we performed this new analysis in which we used surrogate data with generated signals containing spindles and additive noise (of several types, including white and brownian noise). We then utilized the surrogate data to study how sensitive the SNR approach is to the change in spindle and noise amplitude as opposed to the AT techniques (lines 552-575). We first implemented both approaches on the surrogate data and detected spindle activities. We then repeated the entire analysis, once after doubling the noise amplitude and once after dividing the spindle amplitude in half. Lastly, using an example spindle detected by both approaches in the original setting, we showed how robust the SNR algorithm is in face of change in the signal/noise amplitude (new Figure S2). We added the details of the computation in Lines 110-117 and the new supplementary section, “Methods – Simulated data control signal amplitude”.</p><disp-quote content-type="editor-comment"><p>The methods state &quot;We first tested CNN models with different architectures and selected one of the best architectures across sleep recording data sets&quot;. What does &quot;one of the best&quot; mean? Quantification would be helpful. Overall, clarification of advantages of this CNN method in identifying rhythmic activity, other than training on rhythmic activity (?), would be helpful.</p></disp-quote><p>We thank the Referee for pointing this out and apologize that the explanation was not clear in the original manuscript. Starting from the model architectures developed in previous work, we implement an architecture similar to the one proposed by (George and Huerta, 2018) with small modifications to the input and convolutional layers to take into account the basic features of the spindle rhythm in cortex (e.g. average duration). The CNN architecture is also slightly tailored to different sampling rates in each recording modality. We verified model quality using ECoG recordings by minimizing the difference between predicted and training labels marked by the SNR approach. In addition, we confirmed that the proposed CNN model is not sensitive to the slight change in the number of layers (e.g. 4, 5, and 6 convolutional layers) and hyperparameters such as learning rate, maximum number of epochs used for training, and pooling parameters using similarity measure across the predicted values. To perform this sensitivity analysis, for each CNN architecture, we made a grid search over the potential range of hyperparameters, measuring the similarity of model output by Cronbach's α. Similarity across hyperparameters within 10-50% of those used in our analysis was greater than 0.99, indicating high reproducibility under moderate parameter variability. We then used the same architecture and hyperparameters across all subjects and recording datasets. We trained a separate CNN model for each subject on a portion of the available recording and then applied the trained model to detect spindles across the entire recording (Lines 445-466).</p><p>The main advantage of our CNN method is its ability to identify spindles based on waveform characteristics, rather than their amplitude or power (which causes limitations on detecting low-amplitude events in high-noise situations) (Figure 1 and S4). Furthermore, the CNN method can be generalized well across recordings with different types of noise, provided there is enough training data and high-quality marked events. Previous works on detecting earthquakes and gravitational waves have demonstrated the potential and efficacy of CNN models for waveform detection in very high-noise settings. We further validate this claim by training the CNN model on surrogate data with systematically varying noise properties. We demonstrate that this approach is robust to different types of noise on the recording electrode (new Table S1 and Figure S1). Taking these points together, we believe that our two-step combination of the SNR algorithm (which generates a high-quality training dataset) and CNN model (which detects a more complete set ranging from clearly formed large- to small-amplitude activities) can be applied more generally to detect brain rhythms.</p><p>We thank the Reviewer for pointing out the importance of including more details on this point. We have added additional material in lines 82-86 and 292-302 in the main text and the supplementary section, “Methods – Convolutional neural network (CNN) for sleep spindle detection”, and “Methods – Simulated data control – varying noise” of the revised manuscript to clarify the optimization, parameter tuning, training, and implementation of the CNN.</p><p>[Editors’ note: what follows is the authors’ response to the second round of review.]</p><disp-quote content-type="editor-comment"><p>We thank the authors for carefully considering the feedback they received during the first round of reviews, and for performing additional analyses and modifying their manuscript with the feedback in mind. We also thank the authors for patiently waiting for these reviews. The reviewers found the new version of the manuscript a substantial improvement compared to the first submission. The reviewers feel that additional changes and clarifications can put the authors' contribution in its proper context, and broaden the reach of their contribution in the community. The reviewers think the authors ought to</p></disp-quote><p>We would like to thank the Editor and the Referee again for their valuable and thoughtful comments, which have substantially strengthened this paper. We appreciate that both the Editor and Reviewers find the revised manuscript to be substantially improved. In this new revision, we have performed additional analyses and provided more details on our approach. We hope the additional material provided further strengthens our manuscript and addresses all remaining critiques and comments in full.</p><disp-quote content-type="editor-comment"><p>1. Make their comparisons of the CNN and AT methods in the presence of noise more realistic than currently. Experimentalists would care, for instance, about robustness of the CNN, compared to the AT method, to biological forms of noise (e.g. confounding oscillations such as a brief period of REM theta synched across channels, does the CNN offer an advantage to the AT in that case?). Moreover, the authors seem to have made the comparisons with a fixed noise level/SNR (not to confuse with the 'SNR' method). Does the choice of noise amount have a biological basis? The authors will find text in the reviews unpacking this comment</p></disp-quote><p>We thank the Editor and Reviewers for raising this important point and suggesting a new analysis to provide additional evidence on the advantages of using the CNN model than the traditional AT approach. The logic behind the noise sensitivity analysis was indeed to demonstrate improved performance of the CNN model under different noise types and magnitudes. Following the Editor and Reviewer's suggestion, we studied the change in the performance of the CNN and AT approaches under biological forms of noise, such as theta oscillations, and non-biological artifacts, such as line noise, electrical noise, and movement artifacts. On the new set of surrogate data containing simulated theta oscillations as confounds, the CNN model was able to detect at least 97% of spindle activities, with a specificity above 99%, while the AT achieved lower performance (specificity around 72%). In particular, the AT approach seems to be very sensitive to recording artifacts. Our new analysis demonstrates the CNN model performs robustly in face of increases in the number of artifacts, while the performance of the AT substantially decreases as the number of artifacts per minute increases(new Figure 1—figure supplement 6). These new analyses further confirm that the CNN approach introduced here can accurately detect spindles across a range of sleep recording types and provide better performance than the commonly used AT technique.</p><p>We appreciate the Editor and Reviewers raising this important point, which we have addressed in our revised manuscript by providing additional evidence that the CNN detects spindles more effectively than the AT approach using surrogate data (lines 166-170 in the main text, updated supplementary section “Simulated data control – varying noise” and new Figure 1—figure supplement 6 and updated File S1). We hope these additions fully address the Referees’ concerns.</p><disp-quote content-type="editor-comment"><p>2. Clarify apparent inconsistencies in certain statistics reported (e.g. spindle rates), as well as conduct statistical tests for some of their data more appropriate than ones currently used. The authors will find text in the reviews unpacking this comment</p></disp-quote><p>These are important points for the clarity of the manuscript, and we appreciate the Editor and Reviewers bringing them up. We apologize that the descriptions were not clear in the original manuscript. The key terminological distinction, which has not been clearly established in the literature, is between spindle rates reported at the single-electrode level (as in Gais et al., <italic>J Neurosci</italic>, 2002) and at the level of multiple electrodes, where spindles occurring simultaneously across multiple electrodes can be recognized as the same event. To clarify this distinction, we now define a “single-electrode spindle rate” (Figure 1—figure supplement 3) and compare this both to previous work (Gais et al. 2002, Fogel, S. M., et al. 2007 and Purcell, S. M., et al. 2017) and the “multi-electrode rate” (Figure 3b) computed over the entire array of electrodes. Because the multi-electrode spindle rate considers spindles occurring simultaneously on multiple electrodes as a single event and divides these events into one of three groups (local, regional, or multi-area), this measure will generally be lower than the single-electrode rate. We have now added a specific discussion in the manuscript on this point, along with further details, to clearly distinguish between these two measures and to highlight the results of our comparison (lines 225-230).</p><p>Furthermore, to provide additional insight on the increase in multi-area spindles following high-load visual memory tasks, we compare multi-electrode spindle rates between high- and low- load visual memory conditions. Comparing multi-electrode spindle rates demonstrates that, though multi-area spindles are indeed more rare events involving coordination across multiple brain areas, these events uniquely display a rather substantial and significant modulation across pre-sleep memory engagement (lines 231-234). We also note that our analyses earlier in this work indicate that the EEG datasets may contain fewer multi-area spindles (due to their decreased signal-to-noise ratio) than the iEEG (lines 612-615). Future work involving pre-sleep memory tasks during iEEG may have an opportunity to resolve even larger changes in these sleep events recorded at very high spatial and temporal resolution (lines 329-331).</p><p>Lastly, we appreciate the suggestion to use a non-parametric test by the Editor and Reviewer to assess statistical significance. While we initially took care in applying the t-test to these data, for example by verifying normality of the difference between paired observations with a Kolmogorov-Smirnov test before implementing the paired-sample t-test, we agree that a non-parametric test may be more suitable in this case. Following the Editor and Reviewer's suggestion, we switched to the paired-sample Wilcoxon signed-rank test to evaluate the statistical significance between low- and high-load conditions, with results unchanged from before (Figure 3b, Figure 3—figure supplement 1 and lines 231-232). To maintain consistency throughout the manuscript, we have now updated the statistical tests for analyzing rotating waves (Figure 4) to the paired-sample Wilcoxon signed-rank, with similar results as previously (lines 260-261, 263-264 and 266-267).</p><disp-quote content-type="editor-comment"><p>3. Tone down claims of generality of the CNN, and provide clear explanations for what makes the choice of architecture suitable to the current application to spindle detection. The reviewing editor finds this the most important piece of feedback from the reviews. As written, the reviewing editor feels that the manuscript may promote a culture of using deep learning in neuroscience without understanding how deep learning works. The authors have a unique opportunity of not only presenting an application of deep learning that leads to new scientific findings/hypotheses but also of doing so in a manner that promotes a culture of looking inside the black box and trying to understand it. The authors will find text in the reviews unpacking this comment</p></disp-quote><p>We appreciate the Reviewing Editor raising this important general point. Our goal in introducing the CNN technique is to provide a flexible and robust method to identify sleep spindles in noisy electrophysiological recordings, a problem where solutions have often relied on data manually scored by neurologists (expensive and subjective) or on amplitude-based automated techniques that miss many spindle events (as demonstrated here). Our goal with this technique, however, is by no means to encourage blind application of deep learning to this problem; rather, for each main result in the analysis we have utilized our two-step approach to create a validated and well-controlled process. To be specific, throughout the manuscript we (1) use the CNN method to detect a comprehensive set of spindles in the recordings and (2) validate the result obtained on the CNN-detected spindles on the subset of events detected by the more-conservative SNR method. In this way, in addition to providing a useful method to train the CNN on high-quality events that do not require manual detection (lines 133-135), we believe this two-step process represents a methodological advance that can make the most of the benefits of the deep learning approach (flexible waveform detection in difficult, high-noise settings) while also providing systematic validation of results obtained by the CNN on a high-quality subset (lines 86-96 and 103-105). In this way, we believe this work points towards a more general idea for application of deep learning techniques for neural data, allowing us to answer an important question in the sleep field: how do we make population-level statements about a set of neural events detected under uncertainty, without relying on arbitrary thresholds?</p><p>With this in mind, we certainly agree with the Reviewing Editor that application without understanding is a concern when introducing deep learning methods for neural data. This concern motivated our considerations throughout this work, and it is a concern that should remain central for applications of deep learning approaches in neuroscience. To this end, we have added a section in the manuscript specifically addressing this concern and highlighting the ways in which our two-step approach provides a flexible and rigorous solution to detecting specific neural events in electrophysiological recordings (lines 349-357). We have also added additional analyses to understand the choice of CNN architecture and hyperparameters, and features most important for spindle detection by the CNN model, including the filters and saliency maps for the trained CNN (new Figure 1—figure supplement 7 and 8), filter size of convolutional layers (new Figure 1—figure supplement 9), along with new supplementary sections “CNN choice of architecture and hyperparameter setting” and “CNN Visualization and interpretation” and additional text to discuss this point (lines 170-173). Finally, we have also added a section in the text carefully noting potential caveats in applications of deep learning for analysis of neural recordings and emphasizing the importance of well-controlled and interpretable analyses in this and future work (lines 357-372).</p><p>We believe that highlighting the necessity for well-controlled analyses and interpretability of these algorithms can address the concern on the motivation for deep learning in neuroscience. We believe it is possible to integrate deep learning methods into tightly controlled analysis workflows for electrophysiological and neuroimaging data, but agree that without proper controls, potential caveats of these methods would remain unaddressed. We hope the additional text and analyses fully address the concern of the Reviewing Editor here.</p><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>The manuscript has improved substantially and many of my concerns have been addressed. The deep-learning spindle detection method is more fully reported and the new controls with simulated data (varying noise and amplitude) are an improved approach to compare the CNN and AT methods (Figure S1, new Supplementary Table 1). The new analyses investigating the rotating spindle waves provide a framework for understanding the differences with prior reports of low synchrony.</p></disp-quote><p>We thank the Reviewer for the thoughtful comments and concerns and appreciate acknowledging our work to address them in the first round of revision. We take your new comments to heart and have worked to address them all in this new revision.</p><disp-quote content-type="editor-comment"><p>However, there are several important concerns that should be addressed.</p><p>The new comparisons between CNN and AT models using surrogate data with systematically varied noise are useful. However, what was the rationale to compare the specific types of noise presented in Supplementary Table 1? Both the CNN and the AT have similar sensitivities and specificities for all noises, which may suggest that the different noise conditions do not constitute substantially different challenges for the detectors (also suggested by the example in Supplementary Figure 1, in which the spindle has a high signal to noise ratio with all types of noise). I think the readers will be more convinced of the value of the CNN method it can offer an advantage under a 'noise' condition in which the traditional AT methods are likely to struggle. For example, a more interesting source of noise may be the presence of non-spindle oscillations due to brief state changes (e.g., REM or α), or noise artifacts (e.g., examples in Supplementary Figure 12). The sensitivity of traditional methods is likely to go down in examples like these, how does the CNN compare?</p></disp-quote><p>We thank the Reviewer for raising this important point and suggesting a new analysis to provide additional evidence on the advantages of using the CNN model than the traditional AT approach. The logic behind this analysis was indeed to demonstrate improved performance of the CNN model under different noise types and magnitudes. Following this suggestion, we studied the change in the performance of the CNN and AT approaches under biological forms of noise, such as theta oscillations, and non-biological artifacts, such as line noise, electrical noise, and movement artifacts. We simulated theta oscillation using the approach proposed in the previous revision. We used Equation 1 in the paper with the oscillation angular frequency randomly selected from the 4-8 Hz frequency range to simulate theta (lines 652-656). To simulate non-biological artifacts, we first randomly chose a subset of artifacts detected as spindles by the AT approach in the iEEG recording. We then used the Fast Fourier Transform (FFT) to convert these artifacts into frequency domain. We next used the signal amplitude and randomly selected phases from [0, 2π], to generate a new set of artifacts and used the Inverse FFT to convert the signal back to time domain (lines 656-662). We visually inspected the simulated artifacts and verified the signals by comparing the PSD of the simulated artifacts with the original artifacts (new Figure 1—figure supplement 6a). We finally ran the CNN model and AT over both simulated datasets. Similar to previous cases, CNN model tends to have a higher performance than AT approach. However, the performance of AT drops significantly once we added noise artifact (Updated File S1).</p><p>We then studied the effect of artifacts on performance of the CNN and AT approach by systematically increasing the number of artifacts per minute in the surrogate data. In particular, the AT approach seems to be very sensitive to recording artifacts. The CNN model performs robustly in face of increases in the number of artifacts, while the performance of the AT gradually decreases as the number of artifacts per minute increases (new Figure 1—figure supplement 6b). This result further verifies that our approach is not sensitive to different types of artifact in the recording, as opposed to the AT approach (lines 672-678).</p><p>Taking these results together, we believe that, in contrast to the AT approach, which tends to be sensitive to recording artifacts, the CNN model performs robustly across a diverse range of artifacts and noise. These new analyses further confirm that the CNN approach introduced here can accurately detect spindles across a range of sleep recording types and provide better performance than the commonly used AT technique. We have added new figures (Figure 1—figure supplement 6) and analysis in supplementary section “Simulated data control varying noise” and lines 166-170 in the revised manuscript to further demonstrate that our deep learning approach is robust to different types of noise on the recording electrode.</p><disp-quote content-type="editor-comment"><p>Line 92: &quot;co-occurrence&quot;; please clarify the time window or time overlap used to determine co-occurrence. Did any amount of time overlap between spindles count as co-occurrence? Likewise, in Line 150: &quot;simultaneously detected spindles&quot;, line 151: &quot;based on co-occurrence&quot;. I think it's worth emphasizing in this paragraph that 'co-occurrence' and 'simultaneous' detection do not imply 0-lag synchrony (as discussed in the 'rotating waves' sections).</p></disp-quote><p>We thank the Reviewer for raising this point, and we appreciate this opportunity to make this point clear. Indeed, the two concepts of co-occurrence and zero-lag synchrony are distinct features of spindle events that are often not clearly distinguished in the literature. Here, by “co-occurrence” we indicate spindles that are detected simultaneously in different electrodes in the same 500-ms detection window. As mentioned by the Reviewer, this does not necessarily indicate the spindles also exhibit zero-lag synchrony, and we indeed find in our phase analyses that spindles systematically exhibit phase offsets across electrodes. In the revised submission, we have included a few sentences clarifying this point in the main text (lines 107, 119-121, 123-125 and 176).</p><disp-quote content-type="editor-comment"><p>Lines 102 and 104: &quot;low and high visual memory task&quot; should be &quot;low and high-load…&quot; (also in the Figure 3 legend, and in lines 261-262, 263: 'high-load' visual memory tasks).</p></disp-quote><p>Thank you for pointing this out. We have updated the revised manuscript accordingly.</p><disp-quote content-type="editor-comment"><p>There are some inconsistencies in the reported rates (spindles/min) across analyses and figures: Suppl. Figure 4a indicates average spindles/min around 4-5/min in all data types, including EEG data used in the visual memory task. However, the average from the distributions shown in Figure 3b seems much lower, even when combining all spindles across each memory condition, e.g. for the H-VM is about 1/min in local and regional and about 0.5/min for multi-area. In other words, could you clarify how the averages of the distributions in Figure 3b add up to 4 spindles/min in Figure 4a?</p></disp-quote><p>These are important points for the clarity of the manuscript, and we appreciate the Reviewer bringing them up. We apologize that the descriptions were not clear in the original manuscript. As noted for Main Critique 2, the key distinction here is between spindle rates reported at the single-electrode level (as in Gais et al., <italic>J Neurosci</italic>, 2002) and at the level of multiple electrodes, where spindles occurring simultaneously across multiple electrodes can be recognized as the same event. To clarify this distinction, we now define an “single-electrode spindle rate” (Figure 1—figure supplement 3) and compare this both to previous work (Gais et al. 2002, Fogel, S. M., et al. 2007 and Purcell, S. M., et al. 2017) and the multi-electrode spindle rate (Figure 3b) computed over the entire array of electrodes. Because the multi-electrode spindle rate considers spindles occurring simultaneously on multiple electrodes as a single event and divides these events into one of three groups (local, regional, or multi-area), this measure will generally be lower than the single-electrode rate. We have now added a specific discussion in the manuscript on this point, along with further details, to clearly distinguish between these two measures and to highlight the results of our comparison (lines 225-230).</p><disp-quote content-type="editor-comment"><p>In addition, in Figure 3b, within the low-VM condition the rate of multi-area spindles is substantially lower (&lt; 0.5/min) than local and regional (about 1/min on average); and within high-VM the rate also appears much lower (&lt;1/min) for multi-area compared to the distributions for local and regional spindles (up to ~2/min). The text indicates p-values for what seems to be a comparison of relative rates (between H-VM and L-VM), which is interesting but is this result due to a significantly lower multi-area spindle rate with low memory? Based on the figure it looks like multi-area spindles occur at lower rates regardless of memory load? It will be helpful to provide statistical comparisons of spindle rates (among all spindle types) within each condition (L-VM, H-VM) so that the relative changes with memory can be interpreted in the context of the absolute spindle rates in each memory condition. Based on the distributions it seems that non-parametric tests would be more appropriate than t-tests.</p></disp-quote><p>We thank the Reviewer for bringing up these important points, which we believe are an opportunity to provide additional insight on the increase in multi-area spindles following high-load visual memory tasks. Importantly, we note that our comparison was always between the absolute rate of spindles in the L-VM and H-VM conditions. For example, the detection rate of multi-area spindles in the L-VM condition is 0.38 ± 0.02 detections/minute (average across subjects ± SEM). In H-VM, however, this rate increases to 0.62 ± 0.08 detections/minute, almost a doubling of the rate. By contrast, the rate of local spindles in the L-VM condition is 0.77 ± 0.10 detections/minute, with a similar rate of 0.79 ± 0.11 detections/minute in H-VM. This comparison of absolute multi-electrode spindle rates demonstrates that, though multi-area spindles are indeed more rare events, involving coordination across multiple brain areas, these events uniquely display a significant and rather substantial modulation across pre-sleep memory engagement. We appreciate the opportunity to clarify this point, as the comparison here was not sufficiently clear in the previous version. We do note that the rates estimated in this work include partially overlapping windows; however, because our comparison in this work is focused on the difference between L-VM and H-VM, this does not bear relevance to the differences reported here (as verified in additional subsequent analyses with varying window offset). Finally, we also note that our analyses earlier in this work indicate that the EEG datasets may contain fewer multi-area spindles (due to their decreased signal-to-noise ratio) than the iEEG (lines 612-615). Future work involving pre-sleep memory tasks during iEEG may have an opportunity to resolve even larger changes in these sleep events recorded at very high spatial and temporal resolution (lines 329-331). We again thank the reviewer for pointing out the importance of stating the absolute spindle rates, which we have now included in lines 232-234 and 544-549 of the text.</p><p>We also appreciate the suggestion to use a non-parametric test by the Reviewer to assess statistical significance. While we initially took care in applying the t-test to these data, for example by verifying normality of the difference between paired observations with a Kolmogorov-Smirnov test before implementing the paired-sample t-test, we agree that a non-parametric test may be more suitable in this case. Following the Reviewer's suggestion, we switched to the paired-sample Wilcoxon signed-rank test to evaluate the statistical significance between low- and high-load conditions, with results unchanged from before (Figure 3b, Figure 3—figure supplement 1 and lines 231-232). To maintain consistency throughout the manuscript, we have now updated the statistical tests for analyzing rotating waves (Figure 4) to the paired-sample Wilcoxon signed-rank, with similar results as previously (lines 260-261, 263-264 and 266-267).</p><disp-quote content-type="editor-comment"><p>Suppl. Figure 4: missing (a),(b) labels.</p></disp-quote><p>Thanks for catching the missing labels. We have added the labels in the revised manuscript.</p><disp-quote content-type="editor-comment"><p>Supplementary Figure 4a is not described in the text?</p></disp-quote><p>We thank the Reviewer for noting this point and apologize that this figure (Supplementary Figure 4a, now updated to Figure 1—figure supplement 3a) was not described in the manuscript. We have added a reference and detailed description for Figure 1—figure supplement 3a in the main text (lines 156-157 and 345-346)</p><disp-quote content-type="editor-comment"><p>Line 725: 12? sites</p></disp-quote><p>Thanks for catching this typo. We have corrected the error in the revised manuscript (Figure 1—figure supplement 4<bold>)</bold>.</p><disp-quote content-type="editor-comment"><p>Line 154: it'd be useful to reference the Supplementary Table 2 (with the list of the cortical regions).</p></disp-quote><p>We appreciate this suggestion, and we have added a reference to File S2 (previously called Table S2) in the revised manuscript (line 181).</p><disp-quote content-type="editor-comment"><p>Lines 170, 171: I believe the verb should be in past tense.</p></disp-quote><p>We apologize for the inconsistent verb tenses. We have corrected the verb tenses throughout the revised manuscript.</p><disp-quote content-type="editor-comment"><p>Line 179: The interpretations regarding the association between the visual memory load and subsequent sleep spindles is limited to memory consolidation processes. However, memory performance after sleep was not studied in this work, therefore &quot;the impact on memory consolidation&quot; cannot directly be assessed. Sentences such as these (lines 179-180): &quot;If this is the case, what is the impact of the distribution on sleep-dependent memory consolidation? To answer this question…&quot; could be rephrased to state the key question that the data can address. Other sentences in the manuscript are more accurate and valuable in this respect, e.g., Lines 289-290 &quot;(2) this spatial extent can be modulated by the specific memory conditions prior to sleep (Figure 3)&quot;. Indeed, memory consolidation is one of several mechanisms that determine how wakefulness influences sleep oscillations. The authors correctly cover literature on the association between memory and spindles &quot;An increase in spindle density after memory tasks and its relationship with memory consolidation is well established (Clemens et al., 2005; Dang-Vu et al., 2008; Gais et al., 2002; Schabus et al., 2007, 2004)&quot;, but the impact of the authors' findings would be enhanced by discussing other hypotheses in the sleep field that are also consistent with the presented results; for example, the high-load working memory condition may increase firing rates and entrain downscaling processes during subsequent sleep (Tononi and Cirelli, 2014; Crunelli et al., 2018; Klinzing et al.,2019).</p></disp-quote><p>We thank the Reviewer for bringing up this important point. In our revised manuscript, we have updated the language to more carefully focus on the impact of pre-sleep memory tasks on the distribution of spindles in cortex (lines 72, 209 and 273-275). We also appreciate the Reviewer’s point that these results could be consistent with the process of synaptic downscaling. We have included a more detailed treatment of this point in the Discussion (lines 289-295), along with specific suggestions for how future work could address these hypotheses by studying sleep recordings (lines 317-318). We again thank the Reviewer for this suggestion and hope the additions to the manuscript fully address this point.</p><disp-quote content-type="editor-comment"><p>Paragraph starting 215: is this only with the EEG data?</p></disp-quote><p>Yes, this analysis is only performed on the EEG data which had the unique feature of testing sleep after tasks with varying memory loads. In this analysis, we are focusing on the comparison of spatiotemporal dynamics in low-load and high-load memory tasks. We have now noted this more clearly in the revised text (lines 121 and 253).</p><disp-quote content-type="editor-comment"><p>Figure 4a: missing (a),(b) labels for the plots. Indicate the x,y value of the removed outlier point in parenthesis (in 'a' and 'c') since it's not in the plot but still used in quantifications.</p></disp-quote><p>Thanks for catching the missing labels and the suggestion. We have added the outliers and labels in the revised manuscript (Figure 4a, b and c).</p><disp-quote content-type="editor-comment"><p>Line 552: &quot;We simulated 60-minutes recording containing&quot; should it be &quot;60-minutes of recording…&quot;?</p></disp-quote><p>Thanks for catching this typo. We have corrected it in the revised manuscript (line 617).</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>The authors suggest that the lack of algorithms for reliably identifying spindles in neural recordings has led to the under reporting/underestimation of the spatial extent to which spindles occur in the brain. The authors propose an approach based on CNNs that they claim can detect spindles more reliably than existing ones, lead to new insights as to how cross-region spindles may contribute to the integration of 'information' across brain areas.</p><p>Strengths</p><p>1. The applicability of the proposed methods to neural data from multiple modalities, i.e. EEG, EcOG and iEEG.</p><p>2. The framework the authors lay out for constructing high-quality data sets to train the CNNs.</p><p>3. The combination of computational methods and new suggested insights into how spindles can facilitate the integration of 'information' across brain areas.</p></disp-quote><p>We thank the Reviewer for highlighting the novelty and strength of our submission and appreciate the opportunity to discuss these points.</p><disp-quote content-type="editor-comment"><p>Weaknesses</p><p>1. The authors could improve the explanations as to why the CNN seems to do better than legacy methods such as the AT. The explanation surrounding the CNN's ability to detect spindles of different amplitudes does not seem satisfactory enough.</p></disp-quote><p>We appreciate the opportunity to further discuss these important points. One of the main advantages of the CNN model is its ability to detect clearly-formed spindles ranging from lower to high amplitudes. Thus, while AT approaches tend to detect only the highest-amplitude spindle events (as in Figure 1—figure supplement 4), the CNN detects a broader set of spindles. The second advantage of the CNN model is its ability to generalize well across recordings with different types of noise, provided there is sufficient training data and high-quality marked events. The results from our previous analysis indicate that our CNN approach can achieve a very high performance when trained under varying noise and recording conditions (Figure 1—figure supplement 5 and File S2). In this revision, we also study change in the performance of the CNN and AT approaches under biological forms of noise such as the REM theta oscillation and non-biological artifacts. Under these conditions, the CNN approach clearly outperforms the AT, due in large part to the linear decrease of AT performance with increase in the frequency of artifacts (lines 672-678, and Figure 1—figure supplement 6b). Taking these results together, we believe the evidence in this work demonstrates the CNN model detects a broader range of spindles and performs robustly across a diverse range of artifacts and noise as opposed to the AT approach. We have added additional explanation in lines 166-170 and supplementary section “Simulated data control – varying noise” in the revised manuscript to fully address the Referee’s concern on this point.</p><disp-quote content-type="editor-comment"><p>2. The authors claim the applicability of the CNN to data from different modalities, and its generality, as a strength. Given the black-box nature of CNNs, and the lack of an attempt in the manuscript to explain the CNN, its success/failure modes, which aspects of the data it focuses on to detect spindles (e.g. saliency maps), these claims do not feel justified to the reviewer and may contribute to the proliferation of black-box CNNs in neuroscience</p></disp-quote><p>We thank the Referee for bringing up this important point, which we have considered very seriously in the process of revision. Our goal in introducing the CNN technique is to provide a flexible and robust method to identify sleep spindles in noisy electrophysiological recordings, a problem where solutions have often relied on data manually scored by neurologists (expensive and subjective) or on amplitude-based automated techniques that miss many spindle events (as demonstrated here). Our goal with this technique, however, is by no means to encourage blind application of deep learning to this problem; rather, for each main result in the analysis we have utilized our two-step approach to create a validated and well-controlled process.</p><p>With this in mind, we certainly agree with the Reviewer that application without understanding is a concern when introducing deep learning methods for neural data. This concern motivated our considerations throughout this work, and it is a concern that should remain central for applications of deep learning approaches in neuroscience. To this end, we have added a section in the manuscript specifically addressing this concern and highlighting the ways in which our two-step approach provides a flexible and rigorous solution to detecting specific neural events in electrophysiological recordings (lines 349-372). We have also added additional analyses to understand the choice of CNN architecture and hyperparameters, and features most important for spindle detection by the CNN model, including the filters and saliency maps for the trained CNN (new Figure 1—figure supplement 7 and 8), filter size of convolutional layers (new Figure 1—figure supplement 9), along with new supplementary sections “CNN choice of architecture and hyperparameter setting” and “CNN Visualization and interpretation” and additional text to discuss this point (lines 170-173).</p><p>We believe that highlighting the necessity for well-controlled analyses and interpretability of these algorithms can address the Reviewer’s concern on the motivation for deep learning in neuroscience. We believe it is possible to integrate deep learning methods into tightly controlled analysis workflows for electrophysiological and neuroimaging data, but agree that without proper controls, potential caveats of these methods would remain unaddressed. We hope the additional text and analyses fully address the concern of the Referee here.</p><disp-quote content-type="editor-comment"><p>Recommendations for the authors:</p><p>The reviewing editor found the manuscript a much improved version of the initial submission.</p><p>1. The reviewing editor found that the analyses currently in the manuscript do not support the authors' claims of generality of the CNN (e.g. lines 376-377), and that the language surrounding these claims may contribute to supporting an already-widespread tendency to utilize black-box neural networks for analyzing neural data.</p><p>a) One feedback from the first round of reviews had to do with the lack of details surrounding the CNN. The reviewing editor appreciates the authors' attempt to improve this. The authors seem to want to emphasize the generality of the architecture. Such claims of generality do not give insight to the reader on how to pick an architecture for detecting oscillatory patterns in a different context (e.g. ripples). The success of the architecture for gravitational wave detection, its use in the current manuscript, do not give license to use it w/o changes in any application.</p><p>A practitioner would appreciate guidance on architecture design. Given the length of pattern of interest and a sampling rate, a user would want to know how to pick filter sizes. For instance, for a patter of length 0.5 seconds, a 256 Hz sampling rate, the effective filter (explained below) associated with an architecture ought to have size on order of 100 samples (0.5*256 = 128 samples), not 10 or 1000. The reviewing editor thinks this manuscript could have a much stronger impact if the authors took such questions into considerations. Have authors visualized the filters they learn? Have they considered generating saliency maps to determine which parts of inputs the network focuses on to detect spindles? At present, the emphasis on the generality of the CNN, w/o considerations for what about the authors' specific context makes the choice of architecture suitable (other than the fact that it works for gravitational-way detection) feels a bit disappointing.</p><p>More details on guidance on how to design architecture/why current architecture works: For any conv net, the choice of filter size at each layers, together with number of layers relates to size of features one would like to detect. Each layer a conv. Composition of conv equals a conv with a filter size roughly proportional to the sum of filter sizes at each layers. 7x7 filters not uncommon in image proc. Cascading 3-4 such layers (ignoring nonlinearities) gives a filter with an effective 30x30 size.</p><p>Concrete suggestions: (a) adding text to the manuscript explaining what what about the authors' specific context makes the choice of architecture suitable (other than the fact that it works for gravitational-way detection),</p></disp-quote><p>We thank the Reviewer for noting that more details are necessary to clarify the choice of CNN architecture and we apologize that our explanation was not clear in the previous revision. The CNN architecture should be tailored with respect to the duration of rhythmic activity, type of oscillation and sampling rates of recording modality. The duration of the rhythmic activity and sampling rate determine the length of the sliding window for the CNN model. For example, in our NHP EEG recording with the sampling rate of 1000 Hz, the sliding window is set to 0.5 sec which is the minimum duration of spindle activities observed during sleep and contains 500 data points. We then specify the filter size with respect to the length of the sliding window and types of rhythmic activity. The CNN layer is designed to start by extracting local features, gradually extracting longer-timescale features by decreasing the feature space. Filter sizes covering up to approximately one oscillation cycle (70-120 msec) are effective in detecting spindle activity. To understand this further, we simulate 10 recordings with 2 spindles per minute and add different types of noise including the theta oscillation and artifact. Using these surrogate recordings for which we have the exact timing of spindles, we demonstrate that longer filter size is ineffective at detecting spindles. Specifically, we gradually increase the filter size (new Figure 1—figure supplement 9) and compute the performance of the CNN model. As expected, the CNN performance drops as we increase the filter size, in accordance with this underlying mechanism. This result further validates the generality of the CNN approach for detecting neural rhythms, while also getting at the mechanism. We believe that a similar mechanism can be implemented for specifying the filter size for other neural and biological rhythms. The current CNN architecture works well with slight changes in the sliding window (duration and sampling rate) and type of oscillation, but it requires modification otherwise.</p><p>We have added a new supplementary section “CNN choice of architecture and hyperparameter setting” and figure (Figure 1—figure supplement 9) to explain the underlying mechanism of setting filter size in the CNN model. We hope these additional clarifications fully address the Referees’ concerns on this point. We are also providing a guideline on how to set the parameters of the CNN model in our toolbox for different detection settings. The first GitHub version of the toolbox is attached for reference.</p><disp-quote content-type="editor-comment"><p>b) visualizing filters learned by the architecture, c) consider generating saliency maps.</p></disp-quote><p>We thank the Reviewer for these suggestions. To understand this point further, we studied the filter and saliency maps of the CNN models. To do this, we first simulate six spindle/non-spindle signals and visualize the feature and gradient maps corresponding to these input signals. The feature map can accurately detect the maximum amplitude within each cycle using the maximum activation of the CNN model across all oscillations (new Figure 1—figure supplement 7). Using these features, which specify the timing and relative height of the detected maximum amplitudes, the CNN model can learn to reliably detect the specific waveform characteristics of the sleep spindle in different types of recordings. In addition, we studied gradient attribution maps to identify part of the signal that are most important for classification in the CNN model (new Figure 1—figure supplement 8). The area of the signal with the highest modulation in amplitude has the greatest impact on the classification. The pattern of activations and gradient map across the simulated signals provides insights into the underlying mechanism by which the CNN model efficiently distinguishes between different types of oscillation. We thank the Reviewer for pointing out the importance of including more details on how the CNN model works. We have added a few sentences in the main text (lines 170-173), a new supplementary section, “CNN Visualization and interpretation” and figures (Figure 1—figure supplement 7 and 8) in the revised manuscript.</p><disp-quote content-type="editor-comment"><p>b) The reviewing editor feels that the authors can improve the section detailing the training of the CNN. The editor suggests the authors consider using a table to summarize different aspects (number of layers, filter sizes etc….). The editor also suggests that, very early on, the authors mention the subject-dependence of the training.</p></disp-quote><p>We appreciate the Reviewer’s comment on the training aspect of the CNN model. As requested in the previous round of revision, we made a grid search over the potential range of hyperparameters and measured the detection similarity using Cronbach's α. New File S3 contains the details of our sensitivity analysis in the updated manuscript. We also performed further analysis on the choice of CNN architecture and filter size in the new supplementary section, “CNN choice of architecture and hyperparameter setting”. The result from our sensitivity analysis confirms that the proposed CNN architecture has high reproducibility under moderate parameter variability.</p><p>Finally, following the Reviewer’s suggestion, we added a few sentences early on in the main manuscript (lines 100-104 and 132-133) explaining that the CNN model is subject-dependent. We appreciate your comments to improve the paper and we have added additional clarification in the revised manuscripts to answer your concerns.</p><disp-quote content-type="editor-comment"><p>2. Misc questions</p><p>a) In supplementary figure 4b, the scatter plot for EEG (green) suggests a similar max PSD for the CNN and AT. I would expect a similar rate of spindle detection. Supplementary figure 4a suggests otherwise. Can the authors explain?</p></disp-quote><p>We thank the Reviewer for noting this point. While the AT approach consistently detects spindles of higher amplitude than the CNN in the iEEG and ECoG recordings, this effect is indeed not observed in the EEG recordings. We believe this may be due to lower overall signal-to-noise ratio in the EEG; however, it is difficult to determine the precise cause underlying this change in these two datasets. We have noted this point in the text and suggested possible analyses in simultaneous EEG-iEEG recordings (which are often taken by our clinical colleagues at LHSC) for future work (lines 317-318 and 612-615).</p><disp-quote content-type="editor-comment"><p>b) In Figure 2c, EcOG the fact that the CNN detects fewer local and regional spindles per minute than the AT method requires explanation. Does this figure refer to correctly detected spindles? Should the editor interpret the lower ratio as the AT method having more false alarms than the CNN?</p></disp-quote><p>We thank the Reviewer for noting this point. For one subject in the ECoG recordings analyzed here, the distribution of signal amplitudes in the 11-15 Hz frequency band varies so widely that a fixed threshold in the AT technique no longer distinguishes well between spindle and non-spindle activity at all electrodes. The variation in amplitude across electrodes results in incorrect detections in electrodes with lower amplitudes and missed detections in electrodes with higher amplitudes. For this reason, the AT technique in this subject caused more detections of local and regional spindles. Importantly, this point further demonstrates the potential problems with the AT approach, where artifacts or recording noise can significantly affect results on spindle distribution or occurrence. We appreciate the Reviewer’s comment and have now updated the manuscript to explain this point (lines 196-199).</p></body></sub-article></article>