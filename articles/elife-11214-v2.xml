<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">11214</article-id><article-id pub-id-type="doi">10.7554/eLife.11214</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Developmental Biology and Stem Cells</subject></subj-group></article-categories><title-group><article-title>A versatile pipeline for the multi-scale digital reconstruction and quantitative analysis of 3D tissue architecture</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-41847"><name><surname>Morales-Navarrete</surname><given-names>Hernán</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9578-2556</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-41848"><name><surname>Segovia-Miranda</surname><given-names>Fabián</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-41849"><name><surname>Klukowski</surname><given-names>Piotr</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-41850"><name><surname>Meyer</surname><given-names>Kirstin</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="par-1"/><xref ref-type="other" rid="par-3"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-41851"><name><surname>Nonaka</surname><given-names>Hidenori</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-41852"><name><surname>Marsico</surname><given-names>Giovanni</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-41853"><name><surname>Chernykh</surname><given-names>Mikhail</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="par-2"/><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-41854"><name><surname>Kalaidzidis</surname><given-names>Alexander</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="par-2"/><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-12882"><name><surname>Zerial</surname><given-names>Marino</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="other" rid="par-2"/><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-13234"><name><surname>Kalaidzidis</surname><given-names>Yannis</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="corresp" rid="cor2">*</xref><xref ref-type="other" rid="par-2"/><xref ref-type="fn" rid="con10"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>Max Planck Institute of Molecular Cell Biology and Genetics</institution>, <addr-line><named-content content-type="city">Dresden</named-content></addr-line>, <country>Germany</country></aff><aff id="aff2"><label>2</label><institution>Rohto Pharmaceutical</institution>, <addr-line><named-content content-type="city">Tokyo</named-content></addr-line>, <country>Japan</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Faculty of Bioengineering and Bioinformatics</institution>, <institution>Moscow State University</institution>, <addr-line><named-content content-type="city">Moscow</named-content></addr-line>, <country>Russia</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Watt</surname><given-names>Fiona M</given-names></name><role>Reviewing editor</role><aff id="aff4"><institution>King's College London</institution>, <country>United Kingdom</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><email>zerial@mpi-cbg.de</email> (MZ);</corresp><corresp id="cor2"><email>kalaidzi@mpi-cbg.de</email> (YK)</corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>17</day><month>12</month><year>2015</year></pub-date><pub-date pub-type="collection"><year>2015</year></pub-date><volume>4</volume><elocation-id>e11214</elocation-id><history><date date-type="received"><day>28</day><month>08</month><year>2015</year></date><date date-type="accepted"><day>08</day><month>12</month><year>2015</year></date></history><permissions><copyright-statement>© 2015, Morales-Navarrete et al</copyright-statement><copyright-year>2015</copyright-year><copyright-holder>Morales-Navarrete et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-11214-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.11214.001</object-id><p>A prerequisite for the systems biology analysis of tissues is an accurate digital three-dimensional reconstruction of tissue structure based on images of markers covering multiple scales. Here, we designed a flexible pipeline for the multi-scale reconstruction and quantitative morphological analysis of tissue architecture from microscopy images. Our pipeline includes newly developed algorithms that address specific challenges of thick dense tissue reconstruction. Our implementation allows for a flexible workflow, scalable to high-throughput analysis and applicable to various mammalian tissues. We applied it to the analysis of liver tissue and extracted quantitative parameters of sinusoids, bile canaliculi and cell shapes, recognizing different liver cell types with high accuracy. Using our platform, we uncovered an unexpected zonation pattern of hepatocytes with different size, nuclei and DNA content, thus revealing new features of liver tissue organization. The pipeline also proved effective to analyse lung and kidney tissue, demonstrating its generality and robustness.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.001">http://dx.doi.org/10.7554/eLife.11214.001</ext-link></p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.11214.002</object-id><title>eLife digest</title><p>Understanding how individual cells interact to form tissues in animals and plants is a key problem in cell and developmental biology. To be able to answer this question researchers need to use microscopy to observe the cells in a tissue, extract structural information from the images, and then generate three-dimensional digital models of the tissue. However, the software solutions that are currently available are limited, and reconstructing three-dimensional tissue from microscopy images remains problematic.</p><p>To meet this challenge, Morales-Navarrete et al. extended the free software platform called MotionTracking, which had been used previously for two-dimensional work. The software now combines a series of new and established algorithms for analysing fluorescence microscopy images that make it possible to identify the different structures that make up a tissue and then create and analyse a three-dimensional model.</p><p>Morales-Navarrete et al. used the software to analyse liver tissue from mice. The resulting model revealed that liver cells called hepatocytes are arranged in particular zones within the tissue according to their size and DNA content. The software was also applied successfully to analyse lung and kidney tissue, which demonstrates that the approach can be used to create three-dimensional models of a variety of tissues.</p><p>Morales-Navarrete et al.’s approach can rapidly generate accurate models of larger tissues than were previously possible. Therefore, it provides researchers with a powerful tool to analyse the different features of tissues. This tool will be useful for many areas of research: from understanding of how cells form tissues, to diagnosing diseases based on the changes to features in particular tissues.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.002">http://dx.doi.org/10.7554/eLife.11214.002</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author Keywords</title><kwd>3D tissue geometrical model</kwd><kwd>image analysis</kwd><kwd>computational biology</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research Organism</title><kwd>Mouse</kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002347</institution-id><institution>Bundesministerium für Bildung und Forschung</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Klukowski</surname><given-names>Piotr</given-names></name><name><surname>Meyer</surname><given-names>Kirstin</given-names></name><name><surname>Nonaka</surname><given-names>Hidenori</given-names></name><name><surname>Marsico</surname><given-names>Giovanni</given-names></name></principal-award-recipient></award-group><award-group id="par-2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004189</institution-id><institution>Max-Planck-Gesellschaft</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Chernykh</surname><given-names>Mikhail</given-names></name><name><surname>Kalaidzidis</surname><given-names>Alexander</given-names></name><name><surname>Zerial</surname><given-names>Marino</given-names></name><name><surname>Kalaidzidis</surname><given-names>Yannis</given-names></name></principal-award-recipient></award-group><award-group id="par-3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001659</institution-id><institution>Deutsche Forschungsgemeinschaft</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Meyer</surname><given-names>Kirstin</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.5</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>MotionTracking is freely available software that can generate multi-scale geometrical models of mammalian tissue and perform quantitative analysis of tissue architecture.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>A major challenge for the understanding of mammalian tissue structure and function is the ability to monitor cellular processes across different levels of complexity, from the subcellular to the tissue scale (<xref ref-type="bibr" rid="bib63">Megason and Fraser, 2007</xref>). This information can then be used to develop quantitative functional models that describe and predict the system behaviour under perturbed conditions (<xref ref-type="bibr" rid="bib46">Hunter et al., 2008</xref>; <xref ref-type="bibr" rid="bib85">Smith et al., 2011</xref>; <xref ref-type="bibr" rid="bib28">Fonseca et al., 2011</xref>; <xref ref-type="bibr" rid="bib83">Sbalzarini, 2013</xref>). The development of such multi-scale models requires first a geometrical model of the tissue, that is, an accurate three-dimensional (3D) digital representation of the cells in the tissue as well as their critical subcellular components (<xref ref-type="bibr" rid="bib77">Peng et al., 2010</xref>; <xref ref-type="bibr" rid="bib9">Boehm et al., 2010</xref>; <xref ref-type="bibr" rid="bib61">Mayer et al., 2012</xref>). This can be constructed from high-resolution microscopy images with multiple fluorescent markers, either fusion proteins or components detected by antibody staining. Since organelles can be as small as ~0.1 µm in size, the geometrical model has also to cover a wide range of scales spanning over three orders of magnitude. However, substantial limitations persist with respect to availability of markers, volume of tissue to reconstruct, scale of measurements, computational methods to perform the analysis and sample throughput. Although a few existing platforms provide standard tools for 3D segmentation and methods to process 2D surface layers of cells [ImageJ/Fiji (<xref ref-type="bibr" rid="bib36">Girish and Vijayalakshmi, 2004</xref>; <xref ref-type="bibr" rid="bib19">Collins, 2007</xref>), ICY (<xref ref-type="bibr" rid="bib20">de Chaumont et al., 2012</xref>) and MorphoGraphX (<xref ref-type="bibr" rid="bib5">Barbier de Reuille et al., 2015</xref>)], the challenges posed by dense and thick tissue specimens require the development of new algorithms. Therefore, there is a demand for a platform that can provide the required set of methods for the reconstruction of multi-scale digital 3D geometrical models of mammalian tissues from confocal microscopy images.</p><p>The number of fluorescent markers that can be used simultaneously is limited to 4–5, making the reconstruction of tissue models a challenging problem. For a meaningful model, it is necessary to properly identify the different cell types within the tissue but also to detect subcellular and extracellular structures, for example, nuclei, plasma membrane or cell cortex, extracellular matrix (ECM) and cell polarity. Automated morphological cell recognition is a possible way to reconstruct dense tissue with limited number of markers.</p><p>Geometrical digital models of tissues also require 3D information over large volumes. Validated fluorescent protein chimeras are not always available, especially in the appropriate combination of fluorescence emission spectral profiles. On the other hand, in dense tissues immunostaining is inhomogeneous due to restricted antibody penetration. The development of protocols that render tissues optically transparent and permeable to macromolecules without significantly compromising their general structure enables the imaging of relatively thick specimens (<xref ref-type="bibr" rid="bib17">Chung and Deisseroth, 2013</xref>; <xref ref-type="bibr" rid="bib49">Ke et al., 2013</xref>). However, in the case of a densely packed tissue, for example, liver, homogeneous staining is still limited to a thickness of ~100 µm. Therefore, obtaining high-resolution data from large volumes of tissue (typically from 0.1 mm to a few centimetres) requires sectioning the sample into serial 100-µm-thick slices that are stained and imaged separately. Furthermore, the cutting process introduces artefacts, such as bending, uneven section surfaces and partial damage of tissue, that require corrections during tissue model reconstruction. Unfortunately, the publicly available generic image processing software is unable to deal with such problems.</p><p>In this study, we addressed these challenges by developing a set of new algorithms as well as implementing established ones in an adjustable pipeline implemented in stand-alone freely available software (<ext-link ext-link-type="uri" xlink:href="http://motiontracking.mpi-cbg.de">http://motiontracking.mpi-cbg.de</ext-link>). As proof of principle, we tested the pipeline on the reconstruction of a geometrical model of liver tissue. We chose this particular tissue due to its utmost importance for basic research, medicine and pharmacology. In order to test the accuracy of the pipeline, we created a benchmark for the evaluation of dense tissue reconstruction algorithms comprising a set of realistic 3D images generated from the digital model of liver tissue. Furthermore, we applied the platform to the analysis of lung and kidney tissue, demonstrating its generality and robustness.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>Despite its importance and a long history of histological studies, only a few geometrical models of liver tissue have been published (<xref ref-type="bibr" rid="bib41">Hardman et al., 2007</xref>; <xref ref-type="bibr" rid="bib44">Hoehme et al., 2010</xref>; <xref ref-type="bibr" rid="bib39">Hammad et al., 2014</xref>). The liver is composed of functional units, the lobules. In each lobule, bile canaliculi and sinusoidal endothelial cells form two 3D networks between the portal vein (PV) and the central vein (CV). The bile canalicular (BC) network is formed by hepatocytes and transports the bile, whereas the sinusoidal endothelial network transports the blood. The liver tissue has a number of remarkable features. One is the zonation of metabolic functions due to the fact that the hepatocytes located in the vicinity of the PV do not have the same metabolic activities as the hepatocytes located near the CV (<xref ref-type="bibr" rid="bib51">Kuntz and Kuntz, 2006</xref>). Second, hepatocytes are remarkably heterogeneous in terms of number of nuclei (mono- and bi-nucleated) and ploidy (<xref ref-type="bibr" rid="bib60">Martin et al., 2002</xref>; <xref ref-type="bibr" rid="bib38">Guidotti et al., 2003</xref>; <xref ref-type="bibr" rid="bib26">Faggioli et al., 2011</xref>). Third, the lobules contain two additional important cell types, stellate and Kupffer cells (<xref ref-type="bibr" rid="bib4">Baratta et al., 2009</xref>).</p><p>To analyse the 3D organization of liver tissue, we established a workflow for confocal imaging of mouse liver specimens and developed an adjustable pipeline of new and established image analysis algorithms to process the images and build digital models of the tissue (<xref ref-type="fig" rid="fig1">Figure 1</xref> and <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). First, we established a protocol for the preparation of tissue specimens for single- and double-photon confocal microscopy at different resolutions. To cover multiple scales from subcellular organelles to tissue spanning over three orders of magnitude, we used a 3D multi-resolution tissue image acquisition approach (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). This consisted of imaging a tissue sample at low resolution (1 μm × 1 μm × 1 μm per voxel) and zooming on the parts of interest at high resolution (0.3 μm × 0.3 μm × 0.3 μm per voxel). Second, the multi-scale reconstruction of tissue architecture was obtained following the pipeline of <xref ref-type="fig" rid="fig1">Figure 1B</xref> and <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>. Briefly, (1) images were filtered using a novel Bayesian de-noising algorithm; (2) individual low-resolution images of each physical section were assembled in 3D mosaics; (3) tissue deformations caused by sample preparation were corrected; (4) large vessels were segmented; (5) the 3D mosaics of sections were combined in a full-scale low-resolution model; (6) high-resolution images were registered into the low-resolution one; (7) sinusoidal and BC networks as well as nuclei were segmented and, finally, (8) the different cell types were identified, classified and segmented. We used the geometrical model to provide a detailed and accurate quantitative description of liver tissue geometry, including the complexity of the sinusoidal and BC networks, hepatocyte size distribution, stellate and Kupffer cells distribution in the tissue. Additionally, our platform comprises a set of methods for the proper statistical analysis of different morphometric parameters of the tissue as well as their spatial variability (<xref ref-type="fig" rid="fig1">Figure 1C</xref>).<fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.11214.003</object-id><label>Figure 1.</label><caption><title>Schematic representation of the proposed pipeline.</title><p>(<bold>A</bold>) 3D multi-resolution image acquisition: example of arrays of 2D images of liver tissue acquired at different resolutions. Low- (1 μm × 1 μm × 1 μm per voxel) and high- (0.3 μm × 0.3 μm × 0.3 μm per voxel) resolution images on the left and right sides, respectively. (<bold>B</bold>) Multi-scale reconstruction of tissue architecture: on the left, reconstruction of a liver lobule showing tissue-level information, i.e., the localization and relative orientation of key structures such as the portal vein (PV) (orange) and central vein (CV) (light blue). The high-resolution images registered into the low-resolution one are shown in white. On the middle, a cellular-level reconstruction of liver showing the main components forming the tissue, i.e., bile canalicular (BC) network (green), sinusoidal network (magenta) and cells (random colours). The reconstruction corresponds to one of the high-resolution cubes (white) registered on the liver lobule reconstruction (left side). On the right, reconstruction of a single hepatocyte showing subcellular-level information, i.e., apical (green), basal (magenta) and lateral (grey) contacts. (<bold>C</bold>) Quantitative analysis of the tissue architecture: example of the statistical analysis performed over a morphometric tissue parameter (hepatocyte volume) using the information extracted from the multi-scale reconstruction. On the left, hepatocyte volume distribution over the sample (traditional statistics). On the right, spatial variability (spatial statistics) of the same parameter within the liver lobule. Our workflow allows not only to perform traditional statistical analysis of different morphometric parameters but also to perform spatial characterizations of them. The graphs were generated from the analysis of one high-resolution cube of the multi-scale reconstruction (the one shown in middle of panel B). Boundary cells were excluded from the analysis.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.003">http://dx.doi.org/10.7554/eLife.11214.003</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11214-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.11214.004</object-id><label>Figure 1—figure supplement 1.</label><caption><title>Workflow for the multi-scale reconstruction of tissue architecture from multi-resolution confocal microscopy images.</title><p>The necessary methods for each step (implemented in our software) are listed. They include newly developed ones (N) as well as standard image analysis algorithms (S) and modified versions of them (M).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.004">http://dx.doi.org/10.7554/eLife.11214.004</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11214-fig1-figsupp1-v2.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.11214.005</object-id><label>Figure 1—figure supplement 2.</label><caption><title>Probabilistic image de-noising algorithm for 3D images.</title><p>Single 2D plane of a high-resolution image stained with phalloidin for actin (cell borders) and Flk1 for sinusoids (<bold>A, D</bold>) before and (<bold>B, E</bold>) after applying our probabilistic image de-noising algorithm. The outlier-tolerant estimation of the background was done using a 10-pixel window. (<bold>C, F</bold>) Phalloidin/Flk1 intensity values of pixels along the horizontal yellow line for both, the original and the de-noised images. Our probabilistic image de-noising algorithm efficiently reduces the noise while preserving the edges present in the image even in the presence of high diffusive background. (<bold>G</bold>) Mean variance for each intensity level (<bold>I</bold>). The experimental data are represented by the red dots, the error bar represents SEM and the theoretical curve (straight line) is represented by the solid black line. (<bold>H</bold>) Prediction of the background intensity using linear fitting by least-squares method (solid black line) and the outlier-tolerant algorithm (solid red line) for a set of sequential intensities in z-direction (blue dots). The dots represent the intensity values of the voxels along the vertical yellow line at the original image on the left [stained with CD13 for bile canalicular (BC) network].</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.005">http://dx.doi.org/10.7554/eLife.11214.005</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11214-fig1-figsupp2-v2.tif"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.11214.006</object-id><label>Figure 1—figure supplement 3.</label><caption><title>Optimal parameter selection.</title><p>(<bold>A</bold>) The mask defining the objects vicinity in the case of bile canalicular (BC) network (yellow) is shown in red and was created by applying an inflation of two voxels (~0.5 µm) to the original objects. (<bold>B</bold>) Selection of the best parameters for the ‘pure denoise’ method. We used as fixed parameter the number of cycles (10, the maximum possible). ‘Number of frames’ = 11 (the maximum available in the plug-in) shows the best results, i.e., minimum global mean square error (MSE) as well as MSE in the vicinity of the objects. (<bold>C</bold>) Selection of the best parameters for the ‘edge preserving de-noising and smoothing’ method. We used as fixed parameter the number of cycles (100). ‘Smoothing level’ = 70 corresponds the point before the MSE in the vicinity of the objects starts increasing while the global MSE remains low.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.006">http://dx.doi.org/10.7554/eLife.11214.006</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11214-fig1-figsupp3-v2.tif"/></fig><fig id="fig1s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.11214.007</object-id><label>Figure 1—figure supplement 4.</label><caption><title>Comparison of our 3D image de-noising algorithm (BFBD) with standard methods in the field.</title><p>Panel (<bold>A</bold>) shows single 2D plane projections of an artificial high-resolution image of bile canalicular (BC) network (2:1 signal-to-noise ratio) before adding Poisson noise (ground truth) and the result of the application of our de-noising algorithm (BFBD) as well as a median filter, a Gauss low-pass filter and an anisotropic diffusion. (<bold>B</bold>) The resulting images were analysed in terms of the global mean square error (MSE) and coefficient of correlation (CoC). (<bold>C</bold>) The same metrics were evaluated only on the vicinity of the BC. Our method shows considerably better noise reduction (low global MSE and high global CoC) than the other methods, except the Gauss low-pass filter. However, the Gauss low-pass filter shows a high MSE and low CoC in the vicinity of the objects (in comparison with our method), suggesting a blurring of the object edges. The bars show the average values over three samples and the error bars correspond to standard deviations. A median filter (smooth window 3 ×3 ×3 voxels), a Gauss low-pass filter (s = 1 voxels) and an anisotropic diffusion (<inline-formula><mml:math id="inf1"><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mi>D</mml:mi><mml:mrow><mml:mn>1</mml:mn> <mml:mo/><mml:mi>α</mml:mi><mml:mo>|</mml:mo><mml:mo>∇</mml:mo><mml:mi>I</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:mo>∆</mml:mo><mml:mi>I</mml:mi></mml:math></inline-formula>), where D = 0.05, α = 2, number iterations= 100, were applied.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.007">http://dx.doi.org/10.7554/eLife.11214.007</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11214-fig1-figsupp4-v2.tif"/></fig><fig id="fig1s5" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.11214.008</object-id><label>Figure 1—figure supplement 5.</label><caption><title>Comparison of our 3D image de-noising algorithm (BFBD) with ‘pure denoise’ (PD) (<xref ref-type="bibr" rid="bib57">Luisier et al., 2010</xref>) and ‘edge preserving de-noising and smoothing’ (EPDS) (<xref ref-type="bibr" rid="bib6">Beck and Teboulle, 2009</xref>).</title><p>Panel (<bold>A</bold>) shows single 2D plane projections of an artificial image of bile canalicular (BC) network (2:1 signal-to-noise ratio) after applying our de-noising algorithm as well as PD and EPDS. (<bold>B</bold>) The resulting images were analysed in terms of the global mean square error (MSE) and coefficient of correlation (CoC). (<bold>C</bold>) The same metrics evaluated only on the vicinity of the BC. Our method shows a better reduction of the noise (low global MSE and high global CoC) than the other methods. Additionally, it shows a relatively low MSE and high CoC in the vicinity of the objects. Panel (<bold>D</bold>) shows that global MSE increases with the depth of the sample for PD and EPDS, whereas it is more stable in our method. In the graph, each curve represents one independent sample. (<bold>E</bold>) Execution time of the algorithms in an Intel(R) Xeon(R) CPU E5-2620 @ 2.00 GHz. EPDS and BFBD are ~ 20 times faster than PD. The bars show the average values over three samples and the error bars correspond to standard deviations. PD and FPDS were performed using the optimal parameters shown in <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>. For the BFBD, we use a window of five pixels and a threshold = 1.25.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.008">http://dx.doi.org/10.7554/eLife.11214.008</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11214-fig1-figsupp5-v2.tif"/></fig></fig-group></p><sec id="s2-1"><title>Sample preparation and multi-resolution tissue imaging</title><p>Mouse livers were fixed by trans-cardial perfusion instead of the conventional immersion fixation (<xref ref-type="bibr" rid="bib15">Burton et al., 1987</xref>) to minimize the time lag between the termination of blood flow and fixation (<xref ref-type="bibr" rid="bib33">Gage et al., 2012</xref>). This proved to be absolutely essential to preserve the tissue architecture and the epitopes for immunostaining. Serial sections of fixed tissues were prepared at a thickness of 100 µm to maximize antibody penetration and limit laser light scattering. Liver sections were stained to visualize key subcellular and tissue structures, namely nuclei (DAPI), the apical surfaces of hepatocytes (CD13), the sinusoidal endothelial cells (Flk1) or ECM (Laminin and Fibronectin) and the cell cortex (F-actin stained by phalloidin). We tested various reagents and protocols to clear the liver tissue, such as glycerol and <ext-link ext-link-type="uri" xlink:href="http://www.sigmaaldrich.com/catalog/product/sigma/88559">2,2′thiodiethanol </ext-link>(TDE), and found that SeeDB (<xref ref-type="bibr" rid="bib49">Ke et al., 2013</xref>) yielded the best results. Stained sections were imaged sequentially (generating Z-stacks) by one- and two-photon laser scanning confocal microscopy to maximize the number of fluorescent channels available. The same section was imaged twice, at low and high magnification, using 25×/0.8 and 63×/1.3 objectives, respectively. The first covers a large volume to reconstruct the whole lobule and the latter focuses on a small area to reconstruct the tissue at high resolution. The registration of 3D high-resolution images within low-resolution ones provides tissue-scale context information that is essential for the interpretation of the data at the cellular and subcellular level.</p></sec><sec id="s2-2"><title>Bayesian foreground/background discrimination (BFBD) de-noising</title><p>A major problem for the image analysis of thick tissue sections is the low signal-to-noise ratio deep into the tissue, especially for stainings that yield high and diffuse background (e.g. actin staining with phalloidin throughout the cytoplasm). To address this problem, we developed a new Bayesian de-noising algorithm that first makes a probabilistic estimation of the background and separates it from the foreground (see ‘Methods’). Subsequently, the estimated background and foreground signals are independently smoothed and summed to generate a new de-noised image (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>). We applied BFBD de-noising to both low- and high-resolution images. BFBD de-noising provides better results than the standard ones in the field, such as median filtering, Gauss low-pass filtering and anisotropic diffusion (<xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>), but also outperforms (by quality and computational performance) other algorithms, known to be more elaborate, such as the ‘Pure Denoise’ (<xref ref-type="bibr" rid="bib57">Luisier et al., 2010</xref>) and ‘edge preserving de-noising and smoothing’ (<xref ref-type="bibr" rid="bib6">Beck and Teboulle, 2009</xref>) (see ‘Methods’) (<xref ref-type="fig" rid="fig1s5">Figure 1—figure supplement 5</xref>).</p></sec><sec id="s2-3"><title>Reconstruction of multi-scale tissue images</title><p>The tissue was imaged at low- and high-resolution for the multi-scale reconstruction. The reconstruction was performed in three steps: (1) images of physical sections were assembled as mosaics of low-resolution images, (2) all mosaics were corrected for physical distortions and combined in a single 3D image (image stitching) and (3) the high-resolution images were registered into the low-resolution one.</p><p>In more detail, the partially overlapping (~10% overlap) low-resolution images of each physical section were combined in 3D mosaics (<xref ref-type="fig" rid="fig2">Figure 2A</xref> and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A</xref>) using the normalized cross-correlation (NCC) approach (see ‘Methods’). NCC was chosen because it allows finding accurate shifts given a coarse initial match between 3D images (<xref ref-type="bibr" rid="bib25">Emmenlauer et al., 2009</xref>; <xref ref-type="bibr" rid="bib77">Peng et al., 2010</xref>; <xref ref-type="bibr" rid="bib11">Bria and Iannello, 2012</xref>). Then, the 3D image mosaics were combined into a single 3D image. The mechanical distortion and tissue damage produced by sectioning are such (as illustrated in <xref ref-type="fig" rid="fig2">Figure 2B</xref> and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1C</xref>) that even advanced and well-established methods for image stitching (<xref ref-type="bibr" rid="bib79">Preibisch et al., 2009</xref>; <xref ref-type="bibr" rid="bib82">Saalfeld et al., 2012</xref>; <xref ref-type="bibr" rid="bib42">Hayworth et al., 2015</xref>) fail due to the lack of texture correlations between adjacent sections. To address this problem, we developed a Bayesian algorithm for stitching images of bended and partially damaged soft tissue sections. The algorithm first corrects section bending and then uses the empty space at the interior of large structures (e.g. vessels) within adjacent sections to register and stitch them.<fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.11214.009</object-id><label>Figure 2.</label><caption><title>Reconstruction of a multi-scale lobule image.</title><p>(<bold>A</bold>) Schematic representing a single serial section obtained from a grid of M × N partially overlapping 3D images (tiles). The cross-correlation between two neighbouring tiles in the grid provides a local metric, which describes the value of their relative shifts. The reconstruction of each section was performed by maximizing the sum correlations of each tile to all adjacent tiles (see ‘Methods’ for details). (<bold>B, C</bold>) Correction of tissue deformations (introduced during the sample preparation process) using a surface detection algorithm and β-spline transformation. (<bold>B</bold>) Output of the surface detection algorithm. The proposed Bayesian approach uses prior information about expected bending of the section, its thickness and measurement error (see ‘Methods’ for details) to determine the volume of the image belonging to the tissue and to the out-of-field region. (<bold>C</bold>) The tissue section after correcting its bending by using quadratic β-splines. (<bold>D</bold>) Tissue section before (left) and after (right) the correction of the mechanical distortions and the tissue damage. (<bold>E</bold>) Full lobule-level reconstruction established by the alignment of six low-resolution sections (1 μm × 1 μm × 1 μm per voxel) and the interpolation of blood vessels. Two high-resolution images (0.3 μm × 0.3 μm × 0.3 μm per voxel) were registered in the low-resolution reconstruction and are shown in grey (see <xref ref-type="other" rid="media1">Video 1</xref>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.009">http://dx.doi.org/10.7554/eLife.11214.009</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11214-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.11214.010</object-id><label>Figure 2—figure supplement 1.</label><caption><title>Reconstruction of multi-scale tissue images.</title><p><italic>Tissue section reconstruction</italic>: (<bold>A</bold>) Schematic representation of an M × N grid of partially overlapping 3D images. The regions in light blue and light red represent the overlapping areas between neighbouring images. The colour-coded maps show the cross-correlation matrixes between neighbouring images. (<bold>B</bold>) Reconstructed tissue section from 4×4 a grid of low-resolution images. The pattern of DAPI staining (nuclei) at the intersection of two neighbouring images is shown. <italic>Correction mechanical distortion and tissue damage on serial sections:</italic> (<bold>C</bold>) x–z section of the image of a tissue section showing the main obstacles for the tissue surface detection: unstained volume of blood vessels (C') and blurring (C''). Probabilities (<bold>D</bold>) <inline-formula><mml:math id="inf2"><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>, (<bold>E</bold>) <inline-formula><mml:math id="inf3"><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> and (<bold>F</bold>) <inline-formula><mml:math id="inf4"><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> calculated from the maximum entropy segmentation (red), model equations (blue) and manual solution (green). All distributions in the figure were averaged over all tissue sections in the benchmark. (<bold>G</bold>) Comparison of manual and automated surfaces calculated for two tissue sections from P16 (upper) and adult (lower) mice datasets. (<bold>H</bold>) Accuracy of surface detection. Plot presenting the mean absolute deviation calculated between manually and automatically detected surfaces for 33 different tissue sections in 4 data sets. Since tissue section segmentation is ambiguous, the control experiment was conducted by segmenting the same tissue sections manually three times.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.010">http://dx.doi.org/10.7554/eLife.11214.010</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11214-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.11214.011</object-id><label>Figure 2—figure supplement 2.</label><caption><title>Reconstruction of multi-scale tissue images.</title><p><italic>Tissue-level network segmentation</italic>: (<bold>A</bold>) Reconstructed image of a tissue section. Large vessels appear as empty space in the image. (<bold>B</bold>) Spatial distribution of the local maximum entropy threshold value. (<bold>C</bold>) Segmentation of large vessel in a single tissue section. <italic>Registration of high-resolution images into low-resolution ones</italic>: Representative region of a 2D plane of (<bold>D</bold>) a low-resolution (yellow) and (<bold>E</bold>) a high-resolution (red) image stained with Flk1 for sinusoids. (<bold>F</bold>) Superimposed images after the registration.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.011">http://dx.doi.org/10.7554/eLife.11214.011</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11214-fig2-figsupp2-v2.tif"/></fig></fig-group></p><p>A prerequisite for the correction of section bending is the detection of its upper and lower surfaces (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). The high degree of image axial blurring in thick samples (<xref ref-type="bibr" rid="bib68">Nasse and Woehl, 2010</xref>) and the presence of large vessels pose problems for the detection of surfaces (see <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1C</xref>). The algorithm reconstructed the probability distribution of the surface excursion (deviation from the mean position over the neighbourhood) and then used it to predict the localization of each point at the surface (see ‘Methods’). The surface predicted by the algorithm closely matched the surface detected manually (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1G</xref>). Then, the bending correction was performed by standard β-spline transformation (<xref ref-type="fig" rid="fig2">Figure 2C,D</xref>).</p><p>Next, the individual sections were combined. Since approximately one cell layer is removed upon sectioning, direct matching of two adjacent sections is impossible. Therefore, we first segmented the large vessels and then aligned the sections by matching them (<xref ref-type="fig" rid="fig2">Figure 2D</xref>). The vessels were segmented by using the local maximum entropy (LME) approach (<xref ref-type="bibr" rid="bib12">Brink, 1996</xref>) (see ‘Methods’). Subsequently, the segmented vessels were classified (marked as PV or CV) revealing the precise arrangement of lobule-level structures. Finally, we interpolated these vessels within the gaps caused by tissue removal by tri-linear intensity approximation.</p><p>Following the assembly of the low-resolution model, we registered the high-resolution images within it using rigid body transformation. To accelerate the search for registration parameters, we built a hierarchy of binned images and performed registration sequentially from the coarsest to the finest one (see ‘Methods’). This method was used for the reconstruction of a liver tissue model from six serial sections, each imaged as a 3 × 3 mosaic grid with 10% overlap and resolution of 1 μm × 1 μm × 1 μm per voxel. Then, two sections, each imaged as a 2 × 2 mosaic grid at high-resolution (0.3 μm × 0.3 μm × 0.3 μm per voxel) were registered within the low-resolution model. The reconstruction covers about 1300 μm × 1300 μm × 600 μm of the tissue and is presented in <xref ref-type="fig" rid="fig2">Figure 2E</xref> and <xref ref-type="other" rid="media1">Video 1</xref>.<media content-type="glencoe play-in-place height-250 width-310" id="media1" mime-subtype="mp4" mimetype="video" xlink:href="elife-11214-media1.mp4"><object-id pub-id-type="doi">10.7554/eLife.11214.012</object-id><label>Video 1.</label><caption><title>3D image visualization of a multi-resolution geometrical model of liver tissue.</title><p>A set of six low-resolution (1.0 μm × 1.0 μm × 2.0 μm per voxel) and two high-resolution tissue sections (0.3 μm × 0.3 μm × 0.3 μm per voxel) were used. Central veins are shown in light blue, portal veins in orange and high-resolution cubes in grey.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.012">http://dx.doi.org/10.7554/eLife.11214.012</ext-link></p></caption></media></p></sec><sec id="s2-4"><title>3D image segmentation and active mesh tuning for the accurate reconstruction of tubular networks (sinusoids and BC) and nuclei</title><p>The next step was to reconstruct the tubular structures present in the tissue, that is, sinusoidal and BC networks. One of the most popular tools for image segmentation is global thresholding (<xref ref-type="bibr" rid="bib74">Pal and Pal, 1993</xref>). In particular, the maximum entropy approach has been widely applied to image reconstruction problems, including the segmentation of fluorescent microscopy images (<xref ref-type="bibr" rid="bib21">Dima et al., 2011</xref>; <xref ref-type="bibr" rid="bib76">Pecot et al., 2012</xref>). However, since 3D confocal images are usually heterogeneous in intensity due to staining unevenness and light scattering in the tissue (<xref ref-type="bibr" rid="bib52">Lee and Bajcsy, 2006</xref>), global thresholding approaches may produce segmentation artefacts. In contrast, local thresholding allows adjusting the segmentation threshold to the spatial variability. We applied the LME method to find segmentation thresholds in the de-noised images. For this, we split the 3D image into a set of cubes and calculated the maximum entropy segmentation threshold (<xref ref-type="bibr" rid="bib12">Brink, 1996</xref>) within each cube. The threshold values were tri-linearly interpolated to the entire 3D image.</p><p>However, this segmentation approach produced two major artefacts. The objects were moderately swollen and contained holes resulting from local uneven staining. We used standard approaches to close the holes by morphological operations (opening/closing), which unfortunately led to even higher overestimation of the diameter of thin structures, such as sinusoids and BC. To correct this, we extended the segmentation algorithm by including the following steps. We generated a triangulation mesh of the segmented surfaces by the cube marching algorithm (<xref ref-type="bibr" rid="bib56">Lorensen and Cline, 1987</xref>) (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). Then, we tuned the active mesh so that the triangle mesh vertexes aligned to the maximum gradient of fluorescence intensity in the original image (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). Finally, we generated a representation of the skeletonized image via a 3D graph describing the geometrical and topological features of the BC and sinusoidal networks. The reconstruction of sinusoidal and BC networks are shown in <xref ref-type="fig" rid="fig3">Figure 3B,C</xref>, respectively.<fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.11214.013</object-id><label>Figure 3.</label><caption><title>Reconstruction of tubular structures, nuclei and cells.</title><p>(<bold>A</bold>) A single 2D image section is shown with the contours of the sinusoidal network reconstruction overlaid on the de-noised image. The contours of the initial mesh are drawn in yellow, and the ones of the tuned mesh are drawn in cyan. (<bold>B–E</bold>) 3D representation of the different structures segmented in a sample of liver tissue: sinusoids (<bold>B</bold>), BC (<bold>C</bold>), nuclei (<bold>D</bold>) and cells (<bold>E</bold>). All the reconstructed structures are shown together in (<bold>F</bold>). The reconstructed triangle meshes are drawn inside the inner box and the raw images are outside. In the case of tubular networks (i.e. sinusoids and BC), the central lines of the structures are shown together with the raw images.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.013">http://dx.doi.org/10.7554/eLife.11214.013</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11214-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.11214.014</object-id><label>Figure 3—figure supplement 1.</label><caption><title>Nuclei splitting.</title><p>(<bold>A</bold>) 3D visualization of a confocal image of closely packed nuclei (DAPI). (<bold>B</bold>) Objects resulting from the initial segmentation and reconstruction: triangle meshes of the artificially merged structures. The approximation of different structures (<bold>C</bold>) by (<bold>D</bold>) one or (<bold>E</bold>) two overlapping ellipsoids is shown. <italic>Prediction of multi-nuclear structures</italic>: (<bold>F</bold>) distribution of the <bold><italic>In</italic>(<italic>MSE</italic>)</bold> values obtained from the nuclei approximation by one and double ellipsoids. The distribution was fitted by a sum of two Gaussian distributions. The fitting curve is shown in blue (solid line) and the components in magenta and red (dash lines). (<bold>G</bold>) Calculated threshold that discriminates between bi/mono-nuclear and multi-nuclear structures. The graphs were obtained from the analysis of a sample of liver tissue, which covers the entire central vein (CV)-portal vein (PV) axis. <italic>Multi-nuclei splitting</italic>: (<bold>H</bold>) original confocal image where the nuclei seeds were detected (<bold>I</bold>) and expanded to the real nuclei shape (<bold>J</bold>). (<bold>K</bold>) The performance of the splitting algorithm was evaluated in both synthetic and real 3D images. The synthetic image consisted of 150 nuclei, which included single nuclei, double- and triple-nucleated structures. The individual nuclei had a radius between 5 and 7 µm. The multi-nucleated structures were generated with different degrees of overlap. A global background of 10% of the intensity of the nuclei was added to the whole image, then it was blurred using a Gaussian filter and finally salt and paper noise was added. The real image corresponds to an adult mouse tissue sample of 2.3 ×10<sup>–3</sup> mm<sup>3</sup> volume. The initial segmentation yielded 281 structures, which were analysed (the nuclei touching the borders of the sample were excluded from the analysis). The performance was evaluated in terms of true positive (TP), false positive (FP), true negative (TN) and false negative (FN) values. TP = correctly split, FP = over-splitting, TN = correctly not split, FN = under-splitting. Precision (PR) = TP/(TP FP), sensitivity (SN) = TP/(TP FN), specificity (SP) = TN/ (TN FP), F-score = 2 × (PR × SN)/(PR SN) and accuracy (AC) = (TP TN)/(TP TN FP FN).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.014">http://dx.doi.org/10.7554/eLife.11214.014</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11214-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.11214.015</object-id><label>Figure 3—figure supplement 2.</label><caption><title>Cell classification.</title><p>(<bold>A</bold>) Example of an image used to generate the training set for the classifier. The different types of nuclei forming in liver tissue where manually classified using the specific markers, that is, Flk1 (magenta) for sinusoidal endothelial cells (SECs), the macrophage antibody F/4/80 (yellow) for Kupffer cells and the intermediate filament Desmin (green) for stellate cells. The training set was extracted from three samples covering the entire central-portal vein axis. (<bold>B</bold>) Selection of the set of parameters for the linear discriminant analysis (LDA). The 74 calculated parameters were sorted by the Fisher score and the top five ranked parameters with the largest Fisher scores are shown. The classifier accuracy in dependency of the number of parameters used for the classification is plotted. The set of parameters that yielded the highest accuracy of the classifier was chosen. (<bold>C</bold>) Features dependency obtained in the Bayesian network classifier. The Bayesian network structure learning from the experimental data revealed that 15 parameters were relevant for the nuclei classification. The five parameters with the highest mutual information to the nuclei type are shown in inset.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.015">http://dx.doi.org/10.7554/eLife.11214.015</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11214-fig3-figsupp2-v2.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.11214.016</object-id><label>Figure 3—figure supplement 3.</label><caption><title>Cell classification accuracy.</title><p>Confusion matrixes obtained with the (<bold>A</bold>) linear discriminant analysis and (<bold>B</bold>) the Bayesian network classifier. The instances (e.g. nuclei) in each predicted class are represented in the columns of the matrix, while the instances in an actual class (manually identified) are represented in the rows. 3D representation of the different nuclei types identified in a representative sample of liver tissue: (<bold>C</bold>) hepatocytes, (<bold>D</bold>) sinusoidal endothelial cells (SECs), (<bold>E</bold>) stellate and (<bold>F</bold>) Kupffer cells.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.016">http://dx.doi.org/10.7554/eLife.11214.016</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11214-fig3-figsupp3-v2.tif"/></fig><fig id="fig3s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.11214.017</object-id><label>Figure 3—figure supplement 4.</label><caption><title>Reconstruction of tubular structures, nuclei and cells.</title><p>Single 2D image planes are shown with contours of (<bold>A</bold>) sinusoidal and (<bold>B</bold>) and bile canalicular (BC) networks, (<bold>C</bold>) nuclei and (<bold>D</bold>) cells reconstructions overlaid on raw data. Insets show zoomed areas of the image.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.017">http://dx.doi.org/10.7554/eLife.11214.017</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11214-fig3-figsupp4-v2.tif"/></fig><fig id="fig3s5" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.11214.018</object-id><label>Figure 3—figure supplement 5.</label><caption><title>Generation of realistic 3D images of liver tissue.</title><p>(<bold>A</bold>) Generation of images with uneven staining. The image of the idealized structure (homogeneous tubes) created for the bile canalicular (BC) network is shown in the top left image. The initial coarse grained sampling (6 × 6 ×6 binning) of intensities is shown in the top-right image. The fine sampling (unbinned image) of intensities is shown in the bottom-right image and final result in the bottom-left one. (<bold>B</bold>) 3D representation and 2D projections of a model image of BC with uneven staining. (<bold>C</bold>) Characteristic point spread function (PSF) of a confocal microscope. (<bold>D</bold>) 3D representation and 2D projections of a model image of BC convolved with the PSF. (<bold>E</bold>) Mean variance of each intensity level for different depth (z-direction) levels of a confocal image. (<bold>F</bold>) Linear increase of the intensity scaling factor (alpha) with the sample depth for different channels. The error bars represent the standard deviation between three samples. (<bold>G</bold>) 3D representation and 2D projections of a final model image of BC after adding spatially variable Poisson noise.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.018">http://dx.doi.org/10.7554/eLife.11214.018</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11214-fig3-figsupp5-v2.tif"/></fig><fig id="fig3s6" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.11214.019</object-id><label>Figure 3—figure supplement 6.</label><caption><title>Benchmark of images to evaluate 3D reconstructions of dense tissue.</title><p>Example of a realistic 3D image of liver tissue. 3D representation and 2D projections (xy and xz) of a high-resolution image created for bile canalicular (BC) (<bold>A</bold>) and sinusoidal (<bold>B</bold>) networks as well as nuclei (<bold>C</bold>) and cell borders (<bold>D</bold>). The images size is 256 ×256 ×256 voxels with a resolution of 0.3 μm × 0.3 μm × 0.3 μm per voxel. The image shown corresponds to a 2:1 signal-to-noise ratio.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.019">http://dx.doi.org/10.7554/eLife.11214.019</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11214-fig3-figsupp6-v2.tif"/></fig><fig id="fig3s7" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.11214.020</object-id><label>Figure 3—figure supplement 7.</label><caption><title>Model validation: Evaluation of the accuracy of our pipeline for the 3D reconstruction of dense tissue.</title><p>The reconstructions of the different structures forming the tissue were evaluated in terms of true positive (TP), false positive (FP), true negative (TN) and false negative (FN) values extracted from the comparison of the reconstructed image and the ground truth (image without distortions). The precision (PR) and sensitivity (SN) are defined as TP/ (TP FP) and TP/ (TP FN), respectively. F-score is given 2 × (PR × SN)/ (PR SN). The tests were performed in three sets of images (three images per set) with different signal-to-noise ratio (10:1, 4:1, 2:1). (<bold>A–C</bold>) and (<bold>D–F</bold>) The results for the bile canalicular (BC) and sinusoidal networks, respectively. (<bold>G–I</bold>) and (<bold>J–L</bold>) The ones for nuclei and cells, respectively. Whereas in the case of BC, sinusoids and nuclei, the error bar corresponds to standard deviations of the values between three images, for the cells the error bar corresponds to the standard deviation of the values over all the cells in the samples (32 cells). Only the cells that were not in contact with the boundary of the image were analysed. (<bold>M–N</bold>) The mean values for the radius of BC and sinusoidal networks. (<bold>O</bold>) The mean error in the estimation of the cell volume. The error was calculated as <inline-formula><mml:math id="inf5"><mml:mn>100</mml:mn><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:math></inline-formula>, where <italic>V<sub>s </sub></italic>and <italic>V<sub>gt</sub> </italic>are the volumes of the reconstructed and ground truth cells, respectively.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.020">http://dx.doi.org/10.7554/eLife.11214.020</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11214-fig3-figsupp7-v2.tif"/></fig></fig-group></p><p>Nuclei were reconstructed similar to the tubular structures. However, as shown in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1A,B</xref>, closely packed nuclei are optically not well-resolved in 3D confocal images, resulting in artificially merged structures. Since 30–60% (depending on the animal strain and age) of hepatocytes in adult liver are bi-nucleated, artificial nuclei merging compromises the tissue analysis. To address this problem, we used a probabilistic algorithm for double- and multi-nuclei splitting (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). Briefly, the algorithm first discriminated between mono-, double and multi-nuclear structures by learning the misfit distribution of triangulation mesh and nuclei approximation by single and double ellipsoids (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1A–G</xref>). Then, the seed points for the multi-nuclear structures were detected using the Laplacian-of-Gaussian (LoG) scale-space maximum intensity projection (<xref ref-type="bibr" rid="bib86">Stegmaier et al., 2014</xref>) and, finally, the real nuclear shapes were found using an active mesh expansion starting from the nuclei seeds (see ‘Methods’ for details). Tested in both synthetic and real 3D images, the algorithm proved capable of splitting clustered nuclei with different degrees of overlap (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1K</xref>) with an accuracy of over 90%. Although this approach is based on active triangulation mesh, it achieved similar accuracy values to other recently published voxel-based methods for nuclei segmentation (<xref ref-type="bibr" rid="bib2">Amat et al., 2014</xref>; <xref ref-type="bibr" rid="bib16">Chittajallu et al., 2015</xref>).</p></sec><sec id="s2-5"><title>Cell classification and reconstruction</title><p>Generating geometrical models of tissues requires the proper recognition of different cell types. A previous automated classification system discriminated hepatocytes from non-parenchymal cells in 2D human liver images with a 97.8% accuracy (<xref ref-type="bibr" rid="bib71">O'Gorman et al., 1985</xref>). However, the automatic classification of non-parenchymal cells in 3D liver tissue is more challenging. Given their importance in physiology and disease (<xref ref-type="bibr" rid="bib10">Bouwens et al., 1992</xref>; <xref ref-type="bibr" rid="bib50">Kmiec, 2001</xref>; <xref ref-type="bibr" rid="bib58">Malik et al., 2002</xref>) and the limitation on the number of fluorescent markers that can be simultaneously imaged, we designed an algorithm to automatically classify different cell types in the tissue based on nuclear morphological features. We chose two deterministic supervised classifiers, linear discriminant analysis (LDA) and Bayesian network classifier (BNC). LDA, also known as Fisher LDA (<xref ref-type="bibr" rid="bib27">Fisher, 1936</xref>), is a fundamental and widely used technique to classify data into several mutually exclusive groups (<xref ref-type="bibr" rid="bib23">Duda et al., 2001</xref>). It has been successfully applied for nuclei discrimination in microscopy images (<xref ref-type="bibr" rid="bib45">Huisman et al., 2007</xref>; <xref ref-type="bibr" rid="bib54">Lin et al., 2007</xref>). On the other hand, BNCs are more recently developed classifiers which not only show good performance but also allow for probabilistic classification. In addition, BNCs reveal the hierarchy of parameters used for the classification (<xref ref-type="bibr" rid="bib31">Friedman et al., 1997</xref>), which may provide insights into underlying biological processes.</p><p>As input for the classifiers, we manually built a training set of 2301 nuclei using specific cellular markers (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2A</xref>) and computed for each nucleus a profile of 74 parameters (<xref ref-type="table" rid="tbl1">Table 1</xref>) describing nuclei morphology, texture and localization relative to sinusoids and cell borders (density of actin in vicinity of nuclei) (see ‘Methods’). For the LDA, the parameters were ranked using Fisher score (<xref ref-type="bibr" rid="bib23">Duda et al., 2001</xref>), and the most relevant ones were selected based on the classification accuracy (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2B</xref> and ‘Methods’). Independently, the most relevant parameters were selected on the basis of Bayesian network structure reconstruction (<xref ref-type="bibr" rid="bib32">Friedman et al., 1999</xref>) (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2C</xref>).<table-wrap id="tbl1" position="float"><object-id pub-id-type="doi">10.7554/eLife.11214.021</object-id><label>Table 1.</label><caption><p>List of the 74 parameters calculated for the nuclei classification.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.021">http://dx.doi.org/10.7554/eLife.11214.021</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th>Parameter</th><th>F-score</th><th>Parameter</th><th>F-score</th></tr></thead><tbody><tr><td>FLK1 surface intensity 1 vx</td><td>4.802</td><td>Mean radius</td><td>0.920</td></tr><tr><td>FLK1 surface intensity 0 vx</td><td>4.737</td><td>FLK1 KURT</td><td>0.915</td></tr><tr><td>FLK1 mean</td><td>4.674</td><td>MB Frac Dim</td><td>0.904</td></tr><tr><td>FLK1 surface intensity 2 vx</td><td>4.570</td><td>Log Lac2</td><td>0.885</td></tr><tr><td>FLK1 surface intensity 3 vx</td><td>4.100</td><td>HF2</td><td>0.833</td></tr><tr><td>Phallo surface intensity 2 vx</td><td>3.477</td><td>HF13</td><td>0.825</td></tr><tr><td>FLK1 surface intensity 4 vx</td><td>3.453</td><td>HF3</td><td>0.817</td></tr><tr><td>Phallo surface intensity 1 vx</td><td>3.430</td><td>Phallo surface intensity 9 vx</td><td>0.787</td></tr><tr><td>FLK1 SKEW</td><td>3.351</td><td>Surface area</td><td>0.768</td></tr><tr><td>Phallo surface intensity 3 vx</td><td>3.253</td><td>Log lac 3</td><td>0.718</td></tr><tr><td>Phallo surface intensity 0 vx</td><td>3.236</td><td>Radius variance</td><td>0.669</td></tr><tr><td>Norm lac 3</td><td>2.930</td><td>Volume</td><td>0.668</td></tr><tr><td>Norm lac 2</td><td>2.913</td><td>BC Frac Dim</td><td>0.649</td></tr><tr><td>FLK1 surface intensity 5 vx</td><td>2.857</td><td>Log lac 4</td><td>0.612</td></tr><tr><td>Norm lac 4</td><td>2.847</td><td>Phallo surface intensity 10 vx</td><td>0.554</td></tr><tr><td>Phallo surface intensity 4 vx</td><td>2.838</td><td>Log lac 5</td><td>0.536</td></tr><tr><td>Norm lac 5</td><td>2.753</td><td>Sphericity</td><td>0.423</td></tr><tr><td>Phallo surface intensity 5 vx</td><td>2.347</td><td>HF7</td><td>0.408</td></tr><tr><td>FLK1 surface intensity 6 vx</td><td>2.310</td><td>Shape index</td><td>0.402</td></tr><tr><td>HF9</td><td>2.141</td><td>Lacunarity 1</td><td>0.381</td></tr><tr><td>FLK1 surface intensity 7 vx</td><td>1.893</td><td>b/c</td><td>0.342</td></tr><tr><td>Phallo surface intensity 6 vx</td><td>1.868</td><td>Lacunarity 2</td><td>0.333</td></tr><tr><td>HF5</td><td>1.575</td><td>Lacunarity 3</td><td>0.309</td></tr><tr><td>HF8</td><td>1.554</td><td>Lacunarity 4</td><td>0.295</td></tr><tr><td>FLK1 surface intensity 8 vx</td><td>1.552</td><td>HF4</td><td>0.287</td></tr><tr><td>HF11</td><td>1.471</td><td>Lacunarity 5</td><td>0.285</td></tr><tr><td>Phallo surface intensity 7 vx</td><td>1.444</td><td>HF12</td><td>0.153</td></tr><tr><td>a/c</td><td>1.406</td><td>DAPI Sd</td><td>0.123</td></tr><tr><td>Log lac 1</td><td>1.287</td><td>DAPI gradient surface</td><td>0.094</td></tr><tr><td>FLK1 surface intensity 9 vx</td><td>1.265</td><td>Log norm lac 2</td><td>0.087</td></tr><tr><td>HF6</td><td>1.158</td><td>CVM</td><td>0.076</td></tr><tr><td>Phallo surface intensity 8 vx</td><td>1.084</td><td>Log norm lac 3</td><td>0.062</td></tr><tr><td>FLK1 surface intensity 10 vx</td><td>1.018</td><td>Log norm lac 4</td><td>0.045</td></tr><tr><td>HF1</td><td>0.978</td><td>DAPI SKEW</td><td>0.035</td></tr><tr><td>FLK1 Sd</td><td>0.942</td><td>Log norm lac 5</td><td>0.033</td></tr><tr><td>HF10</td><td>0.939</td><td>DAPI mean</td><td>0.029</td></tr><tr><td>a/b</td><td>0.937</td><td>DAPI KURT</td><td>0.022</td></tr></tbody></table><table-wrap-foot><fn id="tblfn1"><p>Note: The parameters are sorted based on their Fisher score, which is a measure of the discriminative power of the parameter.</p></fn></table-wrap-foot></table-wrap></p><p>The performance of the classifiers was measured using the leave-one-out cross-validation method on the training set. Both classifiers recognized hepatocytes with ~100% accuracy, thus further improving the previous performance (<xref ref-type="bibr" rid="bib71">O'Gorman et al., 1985</xref>). The overall cell-type classification yielded 95.4% and 92.6% accuracy for the LDA and BNC, respectively. Although discriminating non-parenchymal cells is difficult even for a person skilled in the art, our algorithms achieved accuracy higher than 90%. The predictive performance of the classifiers is shown in <xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3A,B</xref>. As expected, the first largest population of cells corresponds to hepatocytes (44.6% ± 2.7%, mean ± SEM) followed by sinusoidal endothelial cells (29.8% ± 2.5%). Surprisingly, we found important quantitative differences for Kupffer and stellate cells. The percentage of Kupffer cells (8.7% ± 0.7%) was lower than that of stellate cells (11.2% ± 1.0%), against previous estimates on 2D images (<xref ref-type="bibr" rid="bib4">Baratta et al., 2009</xref>). The percentage of other cells was 5.7% ± 0.8%. A 3D visualization of the localization of the nuclei of the different cell types is shown in <xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3C–F</xref>.</p><p>Finally, cells were segmented by expansion of the active mesh from the nuclei to the cell surface. The expansion was either limited to the cell cortex (i.e. the maximum density of actin) or to contacts with neighbouring cells or tubular structures (<xref ref-type="fig" rid="fig3">Figure 3E</xref>). The active mesh expansion was parameterized by inner pressure and mesh rigidity. However, this algorithm over-segmented bi-nucleated cells into two cells with a single nucleus. Therefore, we used phalloidin intensity and nucleus-to-nucleus distance to recognize over segmented multinuclear cells and merge them. A manual check of segmentation of 2559 cells revealed only ~2% error for hepatocyte segmentation that is a further improvement of the state-of-the-art achievements by voxel-based segmentation methods (<xref ref-type="bibr" rid="bib67">Mosaliganti et al., 2012</xref>). The results of the segmentation of all imaged cellular and subcellular structures in the liver tissue (i.e. cells, nuclei, sinusoidal and BC networks) are presented in <xref ref-type="fig" rid="fig3">Figure 3E</xref>, <xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4</xref>, and <xref ref-type="other" rid="media2">Videos 2</xref> and <xref ref-type="other" rid="media3">3</xref>.<media content-type="glencoe play-in-place height-250 width-310" id="media2" mime-subtype="mp4" mimetype="video" xlink:href="elife-11214-media2.mp4"><object-id pub-id-type="doi">10.7554/eLife.11214.022</object-id><label>Video 2.</label><caption><title>Reconstruction of all imaged structures in a high-resolution image.</title><p>A 2x2 stitched (~ 400 μm × 400 μm × 100 μm) high-resolution image (0.3 μm × 0.3 μm × 0.3 μm per voxel) was used. First, the reconstruction of the large vessels, that is, central vein (CV) (cyan), portal vein (PV) (orange) and bile duct (green) are shown. Then, raw images and the corresponding reconstructed objects of the different structures are shown sequentially: sinusoids (magenta), BC (green), nuclei (random colours) and cells (random colours). Additionally, central lines are shown for the tubular structures. Finally, all segmented structures are shown. This video provides a complete over view of the reconstructed objects in a typical high-resolution image.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.022">http://dx.doi.org/10.7554/eLife.11214.022</ext-link></p></caption></media><media content-type="glencoe play-in-place height-250 width-310" id="media3" mime-subtype="mp4" mimetype="video" xlink:href="elife-11214-media3.mp4"><object-id pub-id-type="doi">10.7554/eLife.11214.023</object-id><label>Video 3.</label><caption><title>Detailed reconstruction of all imaged structures in a high-resolution image.</title><p>In order to highlight the details of the reconstruction of small structures [e.g. nuclei, bile canalicular (BC) network, etc.], a video of a small, cropped (~125 μm × 125 μm × 75 μm) high-resolution image (3 μm × 0.3 μm × 0.3 μm per voxel) was generated. Similarly to <xref ref-type="other" rid="media2">Video 2</xref>, the raw image and the corresponding reconstructed structures of sinusoids (magenta), BC (green), nuclei (random colours) and cells (random colours) are shown sequentially.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.023">http://dx.doi.org/10.7554/eLife.11214.023</ext-link></p></caption></media></p></sec><sec id="s2-6"><title>Model validation</title><p>To evaluate the performance of the pipeline for the reconstruction of dense tissues, we generated a benchmark comprising a set of realistic 3D images of liver tissue. Each synthetic image consisted of four channels for the main structures forming the tissue, that is, cell nuclei, cell borders, sinusoidal and BC networks. We first generated 3D models of liver tissue based on experimental data (see ‘Methods’). The benchmark models had levels of complexity similar to that of the real tissue (<xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5</xref>,<xref ref-type="fig" rid="fig3s6">6</xref>). Second, we imposed uneven staining to the models in order to resemble the experimental data. Third, the artificial microscopy images were simulated by convolving the models according to the 3D confocal microscope point spread function (PSF) (<xref ref-type="bibr" rid="bib69">Nasse et al., 2007</xref>; <xref ref-type="bibr" rid="bib68">Nasse and Woehl, 2010</xref>) and adding z-dependent Poisson noise. The resulting benchmark image statistics were similar to those from the images acquired in our experimental setup (see ‘Methods’) (<xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5</xref>). Given their general usefulness for testing image analysis software, the benchmark images and models are provided as supplementary material (<xref ref-type="supplementary-material" rid="SD1-data">Supplementary file 1</xref>, <xref ref-type="bibr" rid="bib65">Morales-Navarrete et al., 2016</xref>). Finally, we applied our 3D tissue reconstruction pipeline to the benchmark images and quantified the accuracy of the reconstructed models using the precision-sensitivity framework (<xref ref-type="bibr" rid="bib78">Powers, 2011</xref>). The overall quality was expressed as F-score, the harmonic mean between precision and sensitivity. The benchmark tests were performed in three sets of images with different signal-to-noise ratio (10:1, 4:1, 2:1). For tubular structures, we achieved average (over the different noise level sets) F-scores of 0.90 ± 0.04 and 0.73 ± 0.06 for sinusoidal and BC networks, respectively. In the case of the nuclei and cell segmentation, we found average F-scores 0.91 ± 0.03 and 0.92 ± 0.03, respectively. The detailed quantifications are shown in <xref ref-type="fig" rid="fig3s7">Figure 3—figure supplement 7A–L</xref>. Additionally, we measured morphometric parameters of the reconstructed structures such as the average radius of the tubular structures (BC and sinusoidal networks) and cell volumes. We obtained values of 2.72 ± 0.13 µm (ground truth value = 3.0 µm) and 0.58 ± 0.05 µm (ground truth value = 0.5 µm) for sinusoidal and BC networks, respectively (<xref ref-type="fig" rid="fig3s7">Figure 3—figure supplement 7M,N</xref>). The average error for cell volume estimation was found to be 5.17% ± 1.97% (<xref ref-type="fig" rid="fig3s7">Figure 3—figure supplement 7O</xref>). The benchmark experiments showed high accuracy for the reconstruction of the ‘ground truth’ models of all the morphologically different structures forming the liver tissue (<xref ref-type="fig" rid="fig3s7">Figure 3—figure supplement 7</xref>).</p></sec><sec id="s2-7"><title>New insights into liver tissue organization from the geometrical model</title><p>Next, we applied our software to quantitatively analyse the geometric features of liver tissue from three adult mice. Geometric features have important implications, for example, for the development of models of fluid exchange between blood and hepatocytes (<xref ref-type="bibr" rid="bib89">Wisse et al., 1985</xref>). A critical parameter for blood flux models is the radius of sinusoids. We measured a radius of 4.0 ± 1.1 μm, a value close to quantifications by electron microscopy (EM) analysis (<xref ref-type="bibr" rid="bib89">Wisse et al., 1985</xref>; <xref ref-type="bibr" rid="bib72">Oda et al., 2003</xref>; <xref ref-type="bibr" rid="bib62">McCuskey, 2008</xref>). In the sinusoidal networks, we determined the angles between two branching arms to be 111.6° ± 12.37° (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1B</xref>), against previous estimates (<xref ref-type="bibr" rid="bib39">Hammad et al., 2014</xref>). Moreover, the values for the BC network are similar to the sinusoidal network (110.36° ± 9.85°, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1B</xref>). Additionally, we provided new geometric information such as the cardinality of the branching nodes (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1C</xref>).</p><p>Recent studies on the morphometric parameters of the liver tissue (<xref ref-type="bibr" rid="bib39">Hammad et al., 2014</xref>; <xref ref-type="bibr" rid="bib30">Friebel et al., 2015</xref>) provided either average values or limited data measurements of the hepatocytes volume, omitting information on their heterogeneity. We could not only perform accurate measurements of hepatocytes volumes and poly-nucleation, but also correlate them with polyploidy and spatial localization within the tissue. Interestingly, we found a multi-modal distribution of hepatocyte volumes (<xref ref-type="fig" rid="fig4">Figure 4A</xref>) in line with measurements on isolated hepatocytes (<xref ref-type="bibr" rid="bib60">Martin et al., 2002</xref>). A trivial explanation is that it reflects the presence of mono- and bi-nucleated hepatocytes. However, we found that this was not the case. The distribution of volumes of both mono- and bi-nucleated hepatocytes can be independently described by a mixture of two populations with mean volumes 3126 ± 1302 µm<sup>3</sup> (~14% of cells) and 5313 ± 1175 µm<sup>3</sup> (~10% of cells), and 5678 ± 1176 µm<sup>3</sup> (~45% of cells) and 10606 ± 1532 µm<sup>3</sup> (~30% of cells), respectively (<xref ref-type="fig" rid="fig4">Figure 4B,C</xref>). Hence, surprisingly, although the bi-nucleated hepatocytes are assumed to be larger than the mono-nucleated, we found that a population of mono-nucleated hepatocytes can have a volume that does not differ from that of bi-nucleated hepatocytes (<xref ref-type="fig" rid="fig4">Figure 4A–C</xref>).<fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.11214.024</object-id><label>Figure 4.</label><caption><title>Distribution of hepatocyte volumes and DAPI integral intensity per cell for all hepatocytes (<bold>A, B</bold>) and separated by number of nuclei (<bold>B, C</bold> and <bold>E, F</bold>).</title><p>Whereas experimental data are shown by dots, the log-normal components fitted to data are shown by solid lines. (<bold>A</bold>) Cell volume distribution of all hepatocytes. (<bold>B, C</bold>) Cell volume distribution obtained for mono and bi-nucleated hepatocytes, respectively. (<bold>D</bold>) Distribution of DAPI integral intensity (proportional to the content of DNA) of all hepatocytes. (<bold>E, F</bold>) Distributions of DAPI integral intensity obtained for mono and bi-nucleated hepatocytes, respectively. The analysis was performed on 2559 hepatocytes (excluding boundary cells) from three adult mice.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.024">http://dx.doi.org/10.7554/eLife.11214.024</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11214-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.11214.025</object-id><label>Figure 4—figure supplement 1.</label><caption><title>Morphometric features of the sinusoidal and bile canalicular (BC) networks.</title><p>(<bold>A</bold>) Radius distribution of the sinusoidal capillary network. (<bold>B</bold>) Distributions of the angles between branches of BC and sinusoidal networks. (<bold>C</bold>) Cardinality of branching nodes of BC and sinusoidal networks. The data shown here correspond to a representative sample of adult mouse liver.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.025">http://dx.doi.org/10.7554/eLife.11214.025</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11214-fig4-figsupp1-v2.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.11214.026</object-id><label>Figure 4—figure supplement 2.</label><caption><title>(<bold>A, B</bold>) DAPI integral intensity normalization.</title><p>Distribution of DAPI integral intensity per nucleus calculated for each sample (<bold>A</bold>) before and (<bold>B</bold>) after normalization. We found scaling (stretching) factors 1.19 and 0.93 for the second and third samples, respectively. (<bold>C, D</bold>) DNA content in bi-nuclear hepatocytes. DAPI integral intensity per nucleus was calculated for each nucleus of the cells. (<bold>C</bold>) The distribution of the ratio between DAPI integral intensity of the two nuclei in each cell. It follows a normal distribution with mean value 1.0 ± 0.21 (mean ± SD). (<bold>D</bold>) The dependency between DAPI integral intensity of the two nuclei in bi-nuclear cells. They show a linear dependency (R<sup>2</sup> = 0.945433) with a slope of 0.995, showing that both nuclei have the same DNA content in bi-nuclear hepatocytes. (<bold>E, F</bold>) Scatter plot of the volume versus DAPI integral intensity of (<bold>E</bold>) mono-nuclear and (<bold>F</bold>) bi-nuclear hepatocytes. The results of the hierarchical clustering of (<bold>E</bold>) mono-nuclear and (<bold>F</bold>) bi-nuclear hepatocytes are shown. Four (2n, 4n, 8n, 16n) and three (2×2n, 2×4n, 2×8n) populations were found for mono-nuclear and bi-nuclear hepatocytes, respectively. The classification was performed using volume and DAPI integral intensity per cell. We used an agglomerative hierarchical cluster algorithm and tested several distances for the dissimilarity calculation and different methods for the clustering. We found that the standardized Euclidean distance with the Ward method yielded the best results.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.026">http://dx.doi.org/10.7554/eLife.11214.026</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11214-fig4-figsupp2-v2.tif"/></fig></fig-group></p><p>Having found such a peculiar size distribution of bi-nucleated hepatocytes, we measured the total content of DNA per nucleus in every cell sub-population as the integral intensity of DAPI (<xref ref-type="bibr" rid="bib18">Coleman et al., 1981</xref>; <xref ref-type="bibr" rid="bib91">Xing and Lawrence, 1991</xref>; <xref ref-type="bibr" rid="bib22">Dmitrieva et al., 2011</xref>; <xref ref-type="bibr" rid="bib93">Zhao and Darzynkiewicz, 2013</xref>) (see ‘Methods’). The resulting distribution (<xref ref-type="fig" rid="fig4">Figure 4D</xref>) shows three well-separated peaks. These presumably correspond to the 2n (diploid nuclei), 4n and 8n (polyploid nuclei) DNA content previously reported (<xref ref-type="bibr" rid="bib38">Guidotti et al., 2003</xref>; <xref ref-type="bibr" rid="bib60">Martin et al., 2002</xref>) (note that this analysis does not resolve the aneuploidy of specific chromosomes (<xref ref-type="bibr" rid="bib26">Faggioli et al., 2011</xref>)).</p><p>Next, we asked how the nuclei are distributed between the mono- and bi-nucleated cell populations. Interestingly, in the small bi-nucleated hepatocytes (volume &lt; 8000 µm<sup>3</sup>) both nuclei had 2n DNA content, whereas in the large hepatocytes (volume &gt; 8000 µm<sup>3</sup>) both had 4n DNA content. Almost no bi-nuclear hepatocytes (&lt;1.0%) with different amount of DNA per nucleus (e.g. one nucleus with 2n and one with 4n) were observed (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2C,D</xref>). These results suggest that the hepatocyte volume does not depend on the number of nuclei but rather on their polyploidy, in agreement with previous reports (<xref ref-type="bibr" rid="bib64">Miyaoka and Miyajima, 2013</xref>). Therefore, we classified hepatocytes with respect to number of nuclei, volume and DNA content using a hierarchical cluster algorithm. We identified seven populations, namely 2n, 4n, 8n, 16n for mono-nuclear and 2×2n, 2×4n, 2×8n for bi-nuclear hepatocytes (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2E,F</xref>). Four populations (mono-nucleated 2n and 4n, and bi-nucleated 2×2n and 2×4n) were major, representing around 97% of all hepatocytes.</p><p>The reports on the spatial distribution of polyploid hepatocytes are controversial (<xref ref-type="bibr" rid="bib35">Gentric and Desdouets, 2014</xref>). Whereas some suggest that periportal hepatocytes show a lower polyploidy than the perivenous ones (<xref ref-type="bibr" rid="bib34">Gandillet et al., 2003</xref>; <xref ref-type="bibr" rid="bib3">Asahina et al., 2006</xref>), others suggest that both regions have similar polyploid compositions (<xref ref-type="bibr" rid="bib59">Margall-Ducos et al., 2007</xref>; <xref ref-type="bibr" rid="bib75">Pandit et al., 2012</xref>). These discrepancies prompted us to analyse the spatial distribution of mono- and bi-nucleated hepatocytes within the lobule. We particularly analysed the largest populations of hepatocytes, 2n, 4n, 2×2n and 2×4n. Strikingly, we found a pronounced zonation in their localization. Whereas the 2n mono-nucleated were enriched in the PC and PV regions, mono-nucleated 4n showed a homogeneous distribution between PV and PC regions (<xref ref-type="fig" rid="fig5">Figure 5</xref>). The 2×2n bi-nucleated hepatocytes have a similar pattern as the 2n mono-nucleated (highly enriched in the CV and PV regions), but the density of 2×4n bi-nucleated was lower in those regions and increased in the middle region (<xref ref-type="fig" rid="fig5">Figure 5</xref>). As far as we know, this is the first time that polyploidy and poly-nuclearity are found to be zonated and follow a specific pattern. These findings have important implications for both the structural organization of liver tissue and its proliferating and metabolic activities.<fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.11214.027</object-id><label>Figure 5.</label><caption><title>Relative density of different sub-populations of hepatocytes as function of central vein (CV)-portal vein (PV) axis coordinate.</title><p>(<bold>A, C, E, G</bold>) Relative density of 2n mono-nucleated, 2x×2n bi-nucleated, 4n mono-nucleated, 2x×4n bi-nucleated hepatocytes, respectively. (<bold>B, D, F, H</bold>) 3D visualization of the corresponding sub-populations of hepatocytes. The analysis was performed on 2559 hepatocytes (excluding boundary cells) from three adult mice. The CV-PV axis is determined by the coordinate χ, which describes the position of a point relative to the closest CV and PV. <inline-formula><mml:math id="inf6"><mml:mi>χ</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn><mml:mo>×</mml:mo><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>-</mml:mo><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mi>D</mml:mi></mml:mfrac> <mml:mo/><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>, where <italic>d<sub>cv</sub> </italic>and <italic>d<sub>pv</sub> </italic>are the distances to the closest CV and PV respectively, and <italic>D</italic> is the CV-PV distance. χ takes values between 0 and 100, where 0 and 100 represents a localization at the CV and PV surfaces, respectively.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.027">http://dx.doi.org/10.7554/eLife.11214.027</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11214-fig5-v2.tif"/></fig></p></sec><sec id="s2-8"><title>Application of the pipeline to lung and kidney tissue</title><p>To test the general applicability of the pipeline as well as the robustness of our algorithms, we applied it to two morphologically distinct tissues, lung and kidney. Lung and kidney sections were stained for nuclei (DAPI) and the cell cortex (F-actin by phalloidin). Kidney samples were additionally stained for the apical (CD13) and basal (fibronectin and laminin) cell surface. The pipeline allowed us to generate geometrical reconstructions of the tissues (<xref ref-type="fig" rid="fig6">Figure 6</xref> and <xref ref-type="other" rid="media4">Videos 4</xref> and <xref ref-type="other" rid="media5">5</xref>, respectively) without fine-tuning of the parameters. As proof of principle, we extracted some statistics of the most relevant structures from each tissue. Structural information from both relatively large structures like alveoli in lung or glomerulus in kidney, and smaller ones like cells and nuclei were extracted from the geometrical models. <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>,<xref ref-type="fig" rid="fig6s2">2</xref> show the statistical distributions of some interesting tissue features, such as cell volume and elongation, number of neighbouring cells, etc. Information about the spatial organization of the alveolar cells (i.e. their localization relative to the alveoli) in the lung was extracted as well.<fig-group><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.11214.028</object-id><label>Figure 6.</label><caption><title>Reconstruction of geometrical models of lung and kidney tissues.</title><p>3D representation of the different structures segmented in each tissue: (<bold>A, C</bold>) nuclei and (<bold>B, D</bold>) cells in the lung and kidney tissues, respectively. The triangle meshes are drawn inside the inner box and the raw images outside.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.028">http://dx.doi.org/10.7554/eLife.11214.028</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11214-fig6-v2.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.11214.029</object-id><label>Figure 6—figure supplement 1.</label><caption><title>Morphometric features of lung tissue.</title><p>Distributions of (<bold>A</bold>) volume, (<bold>B</bold>) elongation and (<bold>C</bold>) number of neighbouring cells for the lung cells. (<bold>D</bold>) Distribution of the cell position (centre of the cell) relative to the closest alveoli.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.029">http://dx.doi.org/10.7554/eLife.11214.029</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11214-fig6-figsupp1-v2.tif"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.11214.030</object-id><label>Figure 6—figure supplement 2.</label><caption><title>Morphometric features of kidney tissue.</title><p>(<bold>A</bold>) and (<bold>B</bold>) The size and volume distribution of the two cell types identified in the kidney tissue, proximal and distal tubular structures. It was observed that the two cell populations have different characteristic sizes, proximal cells were found to be larger than distal ones. (<bold>C</bold>) and (<bold>D</bold>) The distribution for the cells elongation and the number of neighbouring cells, respectively.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.030">http://dx.doi.org/10.7554/eLife.11214.030</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11214-fig6-figsupp2-v2.tif"/></fig></fig-group><media content-type="glencoe play-in-place height-250 width-310" id="media4" mime-subtype="mp4" mimetype="video" xlink:href="elife-11214-media4.mp4"><object-id pub-id-type="doi">10.7554/eLife.11214.031</object-id><label>Video 4.</label><caption><title>3D reconstruction of lung tissue.</title><p>Nuclei and cells reconstructed from a high-resolution image (∼220 μm × 220 μm × 80 μm). First, the raw images of the cell cortex (F-actin by phalloidin) and nuclei (DAPI) staining are displayed. Then, the reconstruction of the nuclei (random colours) and the cells (random colours) are shown.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.031">http://dx.doi.org/10.7554/eLife.11214.031</ext-link></p></caption></media><media content-type="glencoe play-in-place height-250 width-310" id="media5" mime-subtype="mp4" mimetype="video" xlink:href="elife-11214-media5.mp4"><object-id pub-id-type="doi">10.7554/eLife.11214.032</object-id><label>Video 5.</label><caption><title>3D reconstruction of kidney tissue.</title><p>Nuclei and cells reconstructed from a high-resolution image (∼220 μm × 220 μm × 80 μm). First, the raw images of the cell cortex (F-actin by phalloidin) and nuclei (DAPI) staining are displayed. Then, the reconstruction of the nuclei (random colours) and the cells (random colours) are shown.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.032">http://dx.doi.org/10.7554/eLife.11214.032</ext-link></p></caption></media></p><p>For example, in the lung, we found that the alveolar cells constitute around 19% of the volume, consistent with previous measurements (<xref ref-type="bibr" rid="bib47">Irvin and Bates, 2003</xref>). In the kidney, we found that proximal tubule cells have larger volumes than distal tubule cells (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>), also in agreement with previous studies (<xref ref-type="bibr" rid="bib70">Nyengaard et al., 1993</xref>; <xref ref-type="bibr" rid="bib80">Rasch and Dørup, 1997</xref>). Altogether, the new data show that our pipeline is versatile and able to reconstruct geometrical models of tissues with fairly different architectures.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We developed a versatile pipeline that combines new algorithms with established ones aimed to reconstruct geometrical models of dense tissues from confocal microscopy images acquired at different levels of resolution. Our pipeline is implemented in a freely available platform designed to address unmet computational needs. Despite many efforts, the reconstruction of digital geometrical models of tissues suffers from critical bottlenecks such as lack of automation, limited accuracy and low throughput analysis (<xref ref-type="bibr" rid="bib77">Peng et al., 2010</xref>). The platform developed here overcomes such bottlenecks in that it (1) achieves high accuracy of geometric reconstruction, (2) can process large volumes of imaged tissue, for example, a full liver lobule, (3) increases the image analysis performance to such an extent that the model reconstruction time is shorter than the biological experimental time and compatible with middle-throughput (this is achieved by combining the computational efficiency of C++ with the CPU/GPU multi-threading capabilities), (4) can be run on a regular PC and (5) provides a flexible tool for constructing image processing pipelines that are tuneable for specific tissue and imaging conditions. For the automatic recognition of different cell types, we included morphological classifiers into the software. The user-friendly pipeline assembly mechanism allows adjusting the platform for specific tissue analysis demands. The newly developed algorithms both increase the quality of the results (e.g. 3D image de-noising, LME method, active mesh tuning, cell classification) and deal with problems for which there appears currently to be no real good solutions available (e.g. correction of tissue deformation and combination of individual sections in the case of partial tissue removal) (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). Our platform is implemented as stand-alone free to download software (<ext-link ext-link-type="uri" xlink:href="http://motiontracking.mpi-cbg.de">http://motiontracking.mpi-cbg.de</ext-link>). Furthermore, we created a benchmark of realistic images (with the underlying ground truth model) for the evaluation of 3D segmentation algorithms in biological images (<xref ref-type="supplementary-material" rid="SD1-data">Supplementary file 1</xref>, <xref ref-type="bibr" rid="bib65">Morales-Navarrete et al., 2016</xref>).</p><p>To test its efficacy, we applied it towards the generation of a multi-resolution geometrical model of liver tissue. The resulting model was used to extract quantitative measurements of various features of liver tissue organization, such as radius, branching angles and cardinality of the sinusoidal and BC networks, and to recognize different cell types based on their morphological parameters. Our analysis revealed an unexpected zonation pattern of hepatocytes with different size, nuclei and DNA content within the liver lobule. Furthermore, we extended the analysis to two additional tissues, lung and kidney, demonstrating the general applicability and robustness of our platform.</p><p>In building our pipeline, we spent considerable effort to improve the accuracy of the measurements of cell and tissue parameters and preserve their contextual information. The new algorithms allow correcting major defects originating from tissue sectioning, improve the segmentation of cellular, subcellular and tissue-level structures, and extract morphological features and distributions in space. A major limiting factor in the development of a comprehensive geometrical model is the trade-off between imaging large volumes of samples to gain a view of the overall tissue architecture and imaging at high-resolution to achieve an accurate description of the structures at the limit of resolution of the light microscope, for example, the apical surface of hepatocytes forming the BC network. We solved this problem by imaging the tissue at low-resolution and registering within it the parts of tissue (the PV-PC area in the case of the liver lobule) imaged at high resolution. In this way, the measured morphological features (e.g. BC) and parameters (e.g. cell size) are embedded in their proper context of tissue architecture. For example, the hepatocyte volume is a parameter that has little value as average without considering the distribution of parameter values in the lobule (<xref ref-type="fig" rid="fig5">Figure 5</xref>). In general, the diversity of geometric features of the cells within the liver lobule could provide new insights into the regulation of metabolic zonation (see below).</p><p>Our nuclei reconstruction approach achieved accuracy higher than 90%. As shown in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1K</xref>, the major source of errors is over-segmented nuclei. Additional steps to improve nuclei reconstruction, such as the region-merging algorithm (<xref ref-type="bibr" rid="bib16">Chittajallu et al., 2015</xref>) to correct for over-segmentation, could reduce such errors. Even though our cell segmentation method proved able to identify and reconstruct cells with high accuracy, in a few cases (~2%), binuclear cells were mistaken for two separate cells due to weak staining of the cell cortex. Therefore, implementation of additional methods for enhancing the staining of the cell surface, such as the anisotropic plate diffusion filters (<xref ref-type="bibr" rid="bib66">Mosaliganti et al., 2010</xref>; <xref ref-type="bibr" rid="bib67">2012</xref>), could help reduce further the over-segmentation of multi-nuclear cells.</p><p>The active mesh tuning allowed improving the accuracy of segmentation of the BC and sinusoidal networks. This is important since the accuracy of a geometrical model is indispensable for the development of predictive models of tissue function. For example, a model of blood flow through the sinusoidal network and exchange with hepatocytes via the space of Disse (<xref ref-type="bibr" rid="bib73">Ohtani and Ohtani, 2008</xref>; <xref ref-type="bibr" rid="bib89">Wisse et al., 1985</xref>) critically depends on the estimation of the sinusoid diameter. An overestimation of the sinusoidal tube radius would have major consequences for the predictions of blood cells flow through the sinusoidal network. Our geometrical model yielded a diameter of the sinusoidal-walled tube equal to the typical size of erythrocytes and lymphocytes. Therefore, it supports the model of active exchange of blood serum and lymph in the space of Disse, whereby blood flux propels cells through the sinusoids causing waves of capillary walls deformation (<xref ref-type="bibr" rid="bib62">McCuskey, 2008</xref>; <xref ref-type="bibr" rid="bib89">Wisse et al., 1985</xref>). The active mesh tuning algorithm yielded a distribution of the radius of sinusoid capillaries with a mean value that was 20% lower (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1A</xref>) than previously estimated by similar approaches (<xref ref-type="bibr" rid="bib39">Hammad et al., 2014</xref>; <xref ref-type="bibr" rid="bib44">Hoehme et al., 2010</xref>), but in line with the values reported by EM (<xref ref-type="bibr" rid="bib89">Wisse et al., 1985</xref>). The reconstruction also revealed a large difference with the previously reported angles between two arms of branching sinusoids (112° vs. 32°, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1B</xref>). Moreover, the geometrical model provides correct values for other sinusoidal network parameters such as number of intersection nodes per mm<sup>3</sup> (8.3 × 10<sup>4</sup> ± 1.9 × 10<sup>4</sup>) and network length per mm<sup>3</sup> (3.1 × 10<sup>6</sup> ± 0.3 × 10<sup>6</sup> µm), which appear to have been overestimated in a recent report (<xref ref-type="bibr" rid="bib39">Hammad et al., 2014</xref>) (see ‘Methods’). The discrepancy between our geometrical model and others (<xref ref-type="bibr" rid="bib44">Hoehme et al., 2010</xref>; <xref ref-type="bibr" rid="bib39">Hammad et al., 2014</xref>) could be due to differences in image processing and/or experimental procedures (tissue fixation, image acquisition, etc.). One possible explanation for this discrepancy is that our platform applies the active mesh approach to the segmentation of structures on different scales (from the apical surface of hepatocytes forming the BC to cells) and this may yield a more precise geometrical reconstruction in comparison with voxel-based methods (<xref ref-type="fig" rid="fig3">Figure 3A</xref>).</p><p>For the marker-less cell-type recognition, we compared two approaches, the classical LDA and the more recent BNC, applied to nuclei morphology. The accuracy of both approaches was comparable, reaching higher than 99% efficiency for hepatocyte recognition and about 92–95% for all cell types. The latter value is highly significant since the distinction between stellate and sinusoid endothelial cells in the absence of specific markers is challenging even for a skilled person. The analysis of parameters that were mostly informative for cell type discrimination yielded some unexpected results. Although nuclear size and roundness were traditionally considered a priori as the most relevant parameters to discriminate hepatocytes from non-parenchymal cells (<xref ref-type="bibr" rid="bib4">Baratta et al., 2009</xref>; <xref ref-type="bibr" rid="bib71">O'Gorman et al., 1985</xref>), we found that they are less informative than the parameters related to nuclear texture (e.g. moments of lacunarity). The analysis of parameters relevant for cell classification can shed light on the differences in cell morphology that are difficult to grasp by the naked eye. The accurate active mesh-based cell shape estimation led to well-separated peaks of cell volume distribution (<xref ref-type="fig" rid="fig4">Figure 4A–C</xref>), which failed to be discriminated by approximation through Voronoi tessellation (<xref ref-type="bibr" rid="bib8">Bock et al., 2010</xref>) (data not shown).</p><p>The analysis of liver tissue using our software platform revealed some unexpected biological findings. It is well established that hepatocytes are heterogeneous in size, number of nuclei (mono and bi-nucleated cells) and DNA content (polyploidy). However, we observed that these features are not randomly distributed but follow a specific zonation pattern within the liver lobule. Surprisingly, the mono-nucleated 2n and bi-nucleated 2×2n hepatocytes were enriched in the CV and PV regions, whereas bi-nucleated 2×4n were more frequent in the middle region. This particular distribution suggests that polyploidy is spatially regulated and follows a gradient between CV and PV. Zonation of metabolic activities in the liver is well known, but zonation of mono- and bi-nucleated cells and total DNA content (polyploidy) remains controversial. The spatial distribution of hepatocytes according to their ploidy in the CV-PV axes correlates with the metabolic zonation. This correlation suggests a possible role of polyploidy in regulating hepatocyte functions in the liver lobule. Interestingly, two unique populations of cells with stem cell-like properties and the capacity to repopulate the liver have been recently identified (<xref ref-type="bibr" rid="bib81">Ray, 2015</xref>; <xref ref-type="bibr" rid="bib88">Wang et al., 2015</xref>; <xref ref-type="bibr" rid="bib29">Font-Burgada et al., 2015</xref>). One population located close to the CV, which has been implicated in homeostatic hepatocyte renewal (<xref ref-type="bibr" rid="bib88">Wang et al., 2015</xref>), coincides with the mono-nucleated 2n cells we identified. The other population of hepatocytes located near the PV, which was found to repopulate the liver after injury (<xref ref-type="bibr" rid="bib29">Font-Burgada et al., 2015</xref>), could correspond to the low ploidy cells (2n and 2×2n) we observed. These results inspire future studies aimed at exploring the mechanisms underlying regulation of mono- versus bi-nuclearity and polyploidy in the context of liver tissue structure, function and regeneration (<xref ref-type="bibr" rid="bib92">Zaret, 2015</xref>; <xref ref-type="bibr" rid="bib81">Ray, 2015</xref>). In this context, the accurate digital geometrical model of tissue is a valuable resource.</p><p>Geometrical models provide the means of extracting structural information as a precondition for the development of functional models of tissues. They can be a tool for acquiring accurate quantitative measurements of morphological features and, as such, have the potential of uncovering the fundamental rules underlying tissue organization. In addition, the measurement of specific parameters, such as BC and sinusoid diameters, network cardinality, cell volume and shape, etc., can serve as diagnostic markers of early stages of tissue dysfunction/repairing, thus providing new tools for clinical research and drug development.</p></sec><sec id="s4" sec-type="methods"><title>Methods</title><sec id="s4-1"><title>Mice and ethics statement</title><p>Six- to nine-week-old C57BL/6JOlaHsd mice were purchased from Charles River Laboratory. All animal studies were conducted in accordance with German animal welfare legislation and in strict pathogen-free conditions in the animal facility of the Max Planck Institute of Molecular Cell Biology and Genetics, Dresden, Germany. Protocols were approved by the Institutional Animal Welfare Officer (Tierschutzbeauftragter) and all necessary licenses were obtained from the regional Ethical Commission for Animal Experimentation of Dresden, Germany (Tierversuchskommission, Landesdirektion Dresden) (license number: AZ 24-9168.24-9/2012-1, AZ 24-9168.11-9/2012-3).</p></sec><sec id="s4-2"><title>BFBD algorithm for de-noising images of fluorescent microscopy</title><p>We took advantage of the fact that point-spread-function of confocal microscopes is strongly elongated in z-axis and developed a new de-noising algorithm based on the linear approximation of the image background intensity in the z-direction. Since confocal microscopy images are photon-limited and therefore obey Poisson statistics, we first found the parameters <italic>α</italic> and <italic>β</italic> that convert the photon counts (<italic>N</italic>) into the intensity (<italic>I</italic>) units, such that:<disp-formula id="equ1"><mml:math id="m1"><mml:mfenced close="&gt;" open="&lt;"><mml:mi mathvariant="normal">I</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mfenced close="&gt;" open="&lt;"><mml:mi mathvariant="normal">N</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mi>β</mml:mi></mml:math></disp-formula></p><p>where the operator <inline-formula><mml:math id="inf7"><mml:mfenced close="&gt;" open="&lt;"><mml:mo>.</mml:mo></mml:mfenced></mml:math></inline-formula> represents the average, <italic>α</italic> is the conversion coefficient from number of photons to intensity values and <italic>β </italic>is the offset of the microscope digitization system (dark current).</p><p>For this, we calculated the variance of the intensities between sequential optical z-sections for each X–Y pixel and binned them according to the pixel intensities. Then, the mean variance was calculated within each bin and, as a result, the dependency of mean variance upon the intensities was found (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2G</xref>). This dependency was found to be linear, as expected for a Poisson noise model:<disp-formula id="equ2"><mml:math id="m2"><mml:mi mathvariant="normal">V</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="normal">I</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mfenced close="&gt;" open="&lt;"><mml:mi mathvariant="normal">N</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mo>(</mml:mo><mml:mfenced close="&gt;" open="&lt;"><mml:mi mathvariant="normal">I</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:mi>β</mml:mi><mml:mo>)</mml:mo></mml:math></disp-formula></p><p>where <italic>V</italic>(<italic>I</italic>) is the variance for each intensity level <inline-formula><mml:math id="inf8"><mml:mfenced close="&gt;" open="&lt;"><mml:mi mathvariant="normal">I</mml:mi></mml:mfenced></mml:math></inline-formula>.</p><p>Moreover, when thick 3D tissue samples are imaged, it is required to use different laser intensity and microscope gain. This results in an increase of the intensity scaling factor <italic>α</italic> with the image depth. Therefore, we calculated the Poisson noise model for different image depths (z-direction) and then, we used <italic>α</italic> and <italic>β</italic> to estimate the variance for every pixel.</p><p>After that, we estimated the background intensity of every pixel. Briefly, for each pixel a set of sequential intensities in z-direction was extracted (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2H</xref>, left). Then, the intensities were fitted by a straight line using the outlier-tolerant algorithm described in (<xref ref-type="bibr" rid="bib84">Sivia, 1996</xref>) (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2H</xref>, right). The prediction of the straight line was considered as the background intensity, and the difference between the measured intensity and background was considered as candidate foreground intensity. The candidate foreground intensities below a defined threshold (expressed in variance units) were excluded. Finally, the background was added to the foreground to form the de-noised image.</p><p>To evaluate the performance of our algorithm, we applied it to a set of three artificial images of BC from our benchmark (2:1 signal-to-noise ratio). Additionally, we applied other methods such as median filtering, Gauss low-pass filtering and anisotropic diffusion, ‘pure denoise’ (PD) (<xref ref-type="bibr" rid="bib57">Luisier et al., 2010</xref>) and ‘edge preserving de-noising and smoothing’ (EPDS) (<xref ref-type="bibr" rid="bib6">Beck and Teboulle, 2009</xref>) for comparison. The performance of each method was quantitatively evaluated using the metrics mean square error (MSE) and coefficient of correlation (CoC), defined as follows:<disp-formula id="equ3"><mml:math id="m3"><mml:mi>MSE</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mo>∈</mml:mo><mml:mi>Ω</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:msup><mml:mo>)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>Ω</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:math></disp-formula><disp-formula id="equ4"><mml:math id="m4"><mml:mi>CoC</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mfenced close="&gt;" open="&lt;"><mml:mi mathvariant="normal">I</mml:mi></mml:mfenced><mml:mo>)</mml:mo><mml:mo>·</mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>-</mml:mo><mml:mfenced close="&gt;" open="&lt;"><mml:msup><mml:mi mathvariant="normal">I</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mfenced><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mfenced close="&gt;" open="&lt;"><mml:mi mathvariant="normal">I</mml:mi></mml:mfenced><mml:msup><mml:mo>)</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>·</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>-</mml:mo><mml:mfenced close="&gt;" open="&lt;"><mml:msup><mml:mi mathvariant="normal">I</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mfenced><mml:msup><mml:mo>)</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mo>)</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p>where Ω is the region of interest in the image, <italic>I<sub>i</sub></italic> and <inline-formula><mml:math id="inf9"><mml:msubsup><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula> are the intensities at voxel <italic>i</italic> of the de-noised and noise-free (ground truth) images respectively, <inline-formula><mml:math id="inf10"><mml:mfenced close="&gt;" open="&lt;"><mml:mi mathvariant="normal">I</mml:mi></mml:mfenced></mml:math></inline-formula> and <inline-formula><mml:math id="inf11"><mml:mfenced close="&gt;" open="&lt;"><mml:msup><mml:mi mathvariant="normal">I</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mfenced></mml:math></inline-formula> are the mean intensities of the de-noised and noise-free images, respectively. We calculated the MSE and CoC over the whole images (global) as well as in the vicinity of the objects (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3A</xref>). For PD and EPDS, we selected the best parameters for their performance before the comparison (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3B,C</xref>). The results of our quantifications are shown in <xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>–<xref ref-type="fig" rid="fig1s5">5</xref>.</p></sec><sec id="s4-3"><title>Methods for the reconstruction of 3D multi-scale images</title><sec id="s4-3-1"><title>Reconstruction of physical sections</title><p>To image large and complex tissue structures such as the liver lobule, we generated a grid of partially overlapping low-resolution 3D images (stacks) for each individual tissue section. We applied an image mosaicking procedure to merge the stacks into a single 3D image of the section (<xref ref-type="fig" rid="fig2">Figure 2A</xref> and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A</xref>). Our merging procedure adopts a standard approach to maximize the sum of cross-correlations calculated for pairs of neighbouring tiles in the grid. The input data set for the reconstruction of physical sections was composed of N-by-M grids of partially overlapping 3D images (Z-stacks) (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A</xref>). It is assumed that an approximation of their overlapping area is known and that transitional image registration is sufficient for reconstruction purposes.</p><p>Let <inline-formula><mml:math id="inf12"><mml:mo>(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> be a pair of neighbour images located within the grid (0 ≤ <italic>x </italic>&lt; <italic>N</italic>, 0 ≤ <italic>y </italic>&lt; <italic>M</italic>, 0 ≤ <italic>x</italic>′ &lt; <italic>N</italic>, 0 ≤ <italic>y</italic>′ &lt; <italic>M</italic>, |<italic>x</italic> − <italic>x′</italic>| = 1 ⋎ |<italic>y</italic> − <italic>y′</italic>| = 1), and <italic>C<sub>x,y,x′,y′</sub></italic>(<italic>i,j,k</italic>) the cross-correlation of their overlapping areas. The quality of their local alignment for a given shift (<italic>i,j,k</italic>) is measured by the corresponding value of the cross-correlation <italic>C<sub>x,y,x′,y′</sub></italic>(<italic>i,j,k</italic>). The goal of the reconstruction is to find a set of shifts (<italic>i,j,k</italic>) (one for each image) that maximizes the global metric:<disp-formula id="equ5"><mml:math id="m5"><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:msub><mml:mo>∑</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>'</mml:mo><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mfenced><mml:mrow><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced><mml:mrow><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>∈</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mfenced><mml:mi>λy</mml:mi><mml:mo>'</mml:mo><mml:mo>∈</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>'</mml:mo><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>j</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></disp-formula></p><p>To solve this maximization problem, we used the optimization technique proposed in (<xref ref-type="bibr" rid="bib37">Griffiths et al., 1999</xref>), which allowed finding the appropriate shifts with high accuracy (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1B</xref>). All input 3D images were shifted according to the optimization results and registered using the multi-band blending approach (<xref ref-type="bibr" rid="bib14">Burt and Adelson, 1983</xref>; <xref ref-type="bibr" rid="bib13">Brown and Lowe, 2003</xref>).</p></sec><sec id="s4-3-2"><title>Bayesian algorithm for the detection of the surface of tissue sections</title><p>Most publicly available 3D image stitching methods were developed for EM data, where the samples are first embedded in resin or deep-frozen, which makes them solid and prevents partial removal of tissue by cutting. Therefore, they are based on local correlation of the images (<xref ref-type="bibr" rid="bib82">Saalfeld et al., 2012</xref>; <xref ref-type="bibr" rid="bib42">Hayworth et al., 2015</xref>). In the case of soft tissues, the removal of tissue upon cutting is much more significant, leading to a lack of texture correlations between two adjacent sections. The sample preparation process introduces several mechanical artefacts to the imaged sample, including uneven thickness of the section and tissue bending. When large vessels are aligned along the section surface, it becomes difficult to determine whether the empty space corresponds to the interior of the vessel or section damages or bending, which constitutes a major obstacle in their segmentation (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1C</xref>). To address this issue, we propose a surface detection method, which uses prior distributions of expected section shape to find the border between the volume of the image of the sample (including blood vessels) and the out-of-field region.</p><p>Our approach is based on Bayesian statistics. According to the Bayes theorem:<disp-formula id="equ6"><mml:math id="m6"><mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p>Using the chain rule to obtain the joint probability distribution <inline-formula><mml:math id="inf13"><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>, we got:<disp-formula id="equ7"><mml:math id="m7"><mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>≈</mml:mo><mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:math></disp-formula></p><p>The empirical analysis of several tissue sections with manually specified surfaces allowed us to estimate the probabilities <inline-formula><mml:math id="inf14"><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mo> </mml:mo><mml:mi>and</mml:mi><mml:mo> </mml:mo><mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> :<disp-formula id="equ8"><mml:math id="m8"><mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="normal">π</mml:mi><mml:mi>s</mml:mi><mml:mfenced><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mfenced><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mi>s</mml:mi></mml:mfrac></mml:mstyle></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="normal">π</mml:mi><mml:mi>s</mml:mi><mml:mfenced><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mfenced><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mfrac></mml:mstyle></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:math></disp-formula><disp-formula id="equ9"><mml:math id="m9"><mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo mathvariant="italic">,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mn>2</mml:mn><mml:mi>πσ</mml:mi></mml:msqrt></mml:mfrac><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mfenced><mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo mathvariant="italic">,</mml:mo><mml:mi>x</mml:mi><mml:mo mathvariant="italic">,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo mathvariant="italic">-</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo mathvariant="italic">,</mml:mo><mml:mi>x</mml:mi><mml:mo mathvariant="italic">,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo>)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mfenced></mml:math></disp-formula><disp-formula id="equ10"><mml:math id="m10"><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>ε</mml:mi><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mo>[</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>]</mml:mo></mml:mrow></mml:munder><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mo> </mml:mo><mml:mi>ε</mml:mi><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:mo>[</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>]</mml:mo></mml:mrow></mml:munder><mml:mi>λ</mml:mi><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mi>λ</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>ε</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>+</mml:mo><mml:mi>ε</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>)</mml:mo></mml:math></disp-formula></p><p>Where <italic>s</italic> is a parameter that specifies how close the real surface is to the measured one, σ describes the variability of the section thickness, λ specifies the smoothness of the real surface and (<italic>x,y</italic>) are the coordinates of the real surface nodes.</p><p>By analysing our benchmark data set, we found that the median absolute deviation (<italic>t<sub>MAD</sub></italic>) of the section thickness |<italic>y<sub>m2 -−</sub> y<sub>m1</sub></italic>| constituted a good approximation for the parameters <italic>s </italic>and σ. The parameter λ was found by the maximum likelihood estimation of the empirical distribution measured from the maximum entropy segmentation. Then, the final posterior probability for surface detection has the following form: <disp-formula id="equ11"><mml:math id="m11"><mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mspace linebreak="newline"/><mml:mo>≈</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mn>1</mml:mn><mml:mstyle displaystyle="true"><mml:mfrac><mml:mi mathvariant="normal">π</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mfenced><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo> <mml:mo/><mml:msup><mml:mfenced><mml:mfrac><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mi mathvariant="normal">π</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mfrac></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfenced></mml:mstyle></mml:mfrac><mml:mfrac><mml:mn>1</mml:mn><mml:mstyle displaystyle="true"><mml:mfrac><mml:mi mathvariant="normal">π</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mfenced><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo> <mml:mo/><mml:msup><mml:mfenced><mml:mfrac><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mi mathvariant="normal">π</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mfrac></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfenced></mml:mstyle></mml:mfrac></mml:math></disp-formula><disp-formula id="equ12"><mml:math id="m12"><mml:mo>×</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msqrt><mml:mn>2</mml:mn><mml:mi mathvariant="normal">π</mml:mi></mml:msqrt><mml:mstyle displaystyle="true"><mml:mfrac><mml:mi mathvariant="normal">π</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mstyle><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mfenced><mml:mfrac><mml:msup><mml:mfenced><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mfenced><mml:mstyle displaystyle="true"><mml:mfrac><mml:mi mathvariant="normal">π</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mfenced></mml:math></disp-formula><disp-formula id="equ13"><mml:math id="m13"><mml:mo>×</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>ε</mml:mi><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mo>[</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>]</mml:mo></mml:mrow></mml:munder><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>ε</mml:mi><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:mo>[</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>]</mml:mo></mml:mrow></mml:munder><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>ε</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>+</mml:mo><mml:mi>ε</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>)</mml:mo></mml:math></disp-formula></p><p>To check whether the surface energy model of this equation can be applied to different images, we created a benchmark data set composed of 10 section images with manually segmented surfaces. The model distributions <inline-formula><mml:math id="inf15"><mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mo> </mml:mo><mml:mi>and</mml:mi><mml:mo> </mml:mo><mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> closely matched with the corresponding empirical distributions calculated from the manual detection (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1D–F</xref>).</p><p>The proposed model was used for the automated surface detection by minimizing the posterior <inline-formula><mml:math id="inf16"><mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> probability . This minimization was performed using iterative conditional modes. The surfaces calculated by the maximum entropy approach were used as initial guess. To evaluate the quality of the automatically detected surfaces, we created a benchmark data set composed of 30 sections collected from three tissue samples. The average displacement between the manual and the automatic segmentation was 4.53 ± 1.12 voxels (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1G,H</xref>).</p></sec><sec id="s4-3-3"><title>Segmentation of tissue-level networks</title><p>The goal of the segmentation of tissue-level networks is to identify the volume of a sample, which is occupied by large vessels such as CV, PV, hepatic artery or bile ducts. These structures appear in the images as empty volume (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2A</xref>); therefore, their segmentation is possible without using a specific staining.</p><p>The direct application of thresholding methods like maximum entropy (<xref ref-type="bibr" rid="bib48">Kapur et al., 1985</xref>) is troublesome due to several obstacles that arise from sample preparation artefacts. First, mechanical distortions such as uneven cutting of the section or tissue bending during imaging are introduced in the imaged sample. Since large vessels are not stained, it is impossible to distinguish them from out-of-field region using only the voxels intensities. Second, image intensities vary spatially within the sample due to uneven staining. In consequence, a global threshold underestimates the size of vessels in the bright regions of the image and overestimates it in the dark ones. To address these problems,we introduced two pre-processing steps. At first, we used the detected surfaces of the section to discriminate the parts of the image belonging to the sample from the ones in the out-of-field region. Subsequently, the 3D images (excluding the out-of-field region) were split into regular grids of overlapping sub-regions and the maximum entropy threshold was calculated for each of them. After that, the threshold values were interpolated over the entire image using tri-linear interpolation (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2B</xref>). Finally, the vessels were segmented using the calculated threshold values (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2C</xref>).</p></sec><sec id="s4-3-4"><title>Multi-resolution image positioning</title><p>Multi-resolution image positioning involves the rigid-body registration of a high-resolution 3D image (moving image) within the reconstructed low-resolution image of a section (fixed image). Since individual images have sizes up to 500 Mpx, we performed the image registration in the scaled-space using a stepwise approach.</p><p>We built a three-level scale pyramid using the original images and their copies scaled by factors of 0.50 and 0.25. The last level of the pyramid was used to find an initial approximation for the rigid-body registration, which was performed by rotating the moving image with respect to the fixed image. The rotation (r) with the highest value of cross-correlation was used as initial guess for further alignment.</p><p>Then, a registration based on polar transformations (<xref ref-type="bibr" rid="bib90">Wolberg and Zokai, 2000</xref>) was performed. First, the relative shift between two images was found by the peak of their NCC, the images were shifted accordingly and its overlapping part was cropped. Second, the cropped images were transformed to polar coordinates (where a shift is equivalent to a rotation in the Cartesian coordinate system) and their NCC was calculated. The updated angle r was extracted from the peak of the cross-correlation of the transformed image. Note that the initial estimation of r (±15°) found in the initial step is required for the convergence of the polar registration. The polar registration procedure was repeated subsequently using the images stored in the second and first level of scale pyramid, which results in the increase of the registration accuracy and computational time in each iteration of the algorithm. Also, 2–3 iterations were sufficient to achieve full convergence and register images with subcellular accuracy (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2D–F</xref>).</p></sec></sec><sec id="s4-4"><title>Methods for 3D image segmentation</title><sec id="s4-4-1"><title>Nuclei splitting algorithm</title><p>In order to split artificially clustered structures, either the volumetric data from the segmented image or the triangle meshes of the reconstructed objects can be used (<xref ref-type="bibr" rid="bib7">Bilgin et al., 2013</xref>). We used the information of the triangle meshes in a probabilistic algorithm, which first learns from the error distribution for the nuclei approximation by single and double ellipsoids. Based on the extracted statistics, the algorithm identifies and splits multi-nuclear structures. Further, we will refer to both the mono-, bi- and multi-nucleated structures as 3D objects.</p><p>First, all 3D objects were approximated by single and double overlapping ellipsoids. The first model corresponds to the minimum volume ellipsoid (MVE) that encloses the vertexes of the triangle mesh (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1D</xref>). For the second model, the triangle mesh was symmetrically split in two subsets and each subset was approximated by an MVE (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1E</xref>). Both models were evaluated on the data (vertexes) by using mean square error (MSE):<disp-formula id="equ14"><mml:math id="m14"><mml:mi>MSE</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mo>-</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:munderover><mml:mo>(</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi mathvariant="normal">c</mml:mi><mml:msup><mml:mo>)</mml:mo><mml:mi mathvariant="normal">T</mml:mi></mml:msup><mml:mi mathvariant="normal">E</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi mathvariant="normal">c</mml:mi><mml:mo>)</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo>)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:math></disp-formula></p><p>where <italic>n</italic> is the number of vertexes, <italic>p<sub>i</sub></italic> is the coordinates vector of the vertex <italic>i, c</italic> is the centre of the ellipsoid and <italic>E </italic>is the matrix describing the orientation and dimensions of the ellipsoid. The model with the lowest MSE was selected as the best model for the 3D object.</p><p>Second, the error distribution (from the best models) resulting from the first step was analysed as follows: the natural logarithm of each MSE value was computed and the resulting histogram was fitted with a sum of two Gaussian distributions (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1F</xref>). The two distributions were split by a threshold value, which was chosen such that it corresponded to the upper limit of the 95% confidence interval of the first component (the one with lowest mean value) (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1G</xref>). The objects whose <italic>In</italic>(<italic>MSE</italic>) is smaller than the threshold corresponds either to one nucleus or two overlapping nuclei, and the rest corresponds to multi-nuclear structures. The 3D objects recognized as two overlapping ellipsoids were reconstructed using the models as boundaries to split the initially segmented images.</p><p>The multi-nuclear objects were split following two steps: first, the nuclei seeds were detected as proposed in (<xref ref-type="bibr" rid="bib86">Stegmaier et al., 2014</xref>) and then the real shape of the nuclei was found by an active mesh expansion from the seeds. The nuclei seeds were extracted from the Laplacian of Gaussian scale-space maximum intensity projection (LoGMP) image (<xref ref-type="bibr" rid="bib86">Stegmaier et al., 2014</xref>):<disp-formula id="equ15"><mml:math id="m15"><mml:mi>LoGMP</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="normal">x</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>min</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>max</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mi>max</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>min</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mi mathvariant="normal">σ</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>max</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mi>LoG</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="normal">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">σ</mml:mi><mml:mo>)</mml:mo></mml:math></disp-formula></p><p>where LoG(x,σ) represents the Laplacian of Gaussian filtered image found using a standard deviation σ. Considering that the radius (r) of the objects to be detected is given by r=√2σ (<xref ref-type="bibr" rid="bib1">Al-Kofahi et al., 2010</xref>), σ<sub>min</sub> and σ<sub>max</sub> are determined by a priori knowledge of the typical size of the nuclei we want to detect. Each local maximum in the LoGMP image corresponds to a nuclei seed. Then, we used an active mesh expansion from the seeds to the real shape of the nuclei. The expansion was either limited to the nuclei border (regions of maximum intensity at the complement image of the LoGMP) or to the contact with neighbouring nuclei (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1H –J</xref>).</p></sec></sec><sec id="s4-5"><title>Methods for cell classification</title><sec id="s4-5-1"><title>Feature extraction</title><p>For each nucleus, a profile of 74 parameters was calculated (<xref ref-type="table" rid="tbl1">Table 1</xref>). We used the information of the triangle mesh of the reconstructed nucleus as well as the information of the DAPI, Flk1 and phalloidin channels. All channel intensities were normalized using histogram equalization before the parameter extraction. The parameters include:</p><list list-type="bullet"><list-item><p>Nuclear geometrical properties: volume (<italic>V</italic>), surface area (<italic>A</italic>), all possible ratios between the lengths of the semi-principal axis (<italic>a,b,c</italic>) of the MVE, sphericity (<inline-formula><mml:math id="inf17"><mml:mi>ε</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mn mathvariant="italic">6</mml:mn><mml:mi>V</mml:mi><mml:msup><mml:mo>)</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mi>A</mml:mi></mml:mfrac></mml:math></inline-formula>), mean and variance values of nucleus radius, shape index (<xref ref-type="bibr" rid="bib53">Levitt et al., 2004</xref>) and curvature variation measure (<xref ref-type="bibr" rid="bib87">Sukumar et al., 2005</xref>).</p></list-item><list-item><p>DAPI and Flk1 intensity-based features:mean, standard deviation, skewness and kurtosis values of the intensity inside the nucleus.</p></list-item><list-item><p>Haralick texture features (<xref ref-type="bibr" rid="bib40">Haralick et al., 1973</xref>): The intensity of DAPI inside the nucleus was used. Thirteen statistical features were extracted from the normalized grey-level co-occurrence matrix, which was calculated from 65 independent co-occurrence matrices (considering all possible 13 directions in 3D and 5 different distances from 1 to 5 pixels). All co-occurrence matrices were calculated using 256 grey levels.</p></list-item><list-item><p>Box-counting (BC) (<xref ref-type="bibr" rid="bib55">Lopes and Betrouni, 2009</xref>) and Minkowski–Bouligand (MB) (<xref ref-type="bibr" rid="bib24">Einstein et al., 1998</xref>) fractal dimensions: in both cases, the intensity of DAPI inside the nucleus was used. Integer values from 1 to 5 pixels were used as box length and radius values for the respective calculations. For theBC, the gliding box method was applied.</p></list-item><list-item><p>Mean-weighted lacunarity (<xref ref-type="bibr" rid="bib24">Einstein et al., 1998</xref>): it was calculated for the intensity of DAPI inside the nucleus using box lengths from 1 to 5 (lacunarity1, lacunarity2, etc.). Additionally, the values of the normalized lacunarity (NormLac2 = lacunarity2/ lacunarity1, etc.), and the natural logarithms of lacunarity (LogLac1, LogLac2, etc.), and normalized lacunarity (LogNormLac2, etc.) were extracted.</p></list-item><list-item><p>DAPI mean surface intensity gradient: The surface gradient of DAPI signal was calculated at the centre of each triangle of the mesh. The mean value was calculated using a weighted average (using the area of the triangles as weights).</p></list-item><list-item><p>Phalloidin and Flk1 intensity at different distances of the nucleus surface: the mean signal intensity (phalloidin or Flk1) at different distance (0 to 10 voxels) from the triangle mesh was calculated.</p></list-item></list></sec><sec id="s4-5-2"><title>Feature selection for the LDA</title><p>In order to get the most relevant parameter for the LDA classifier, we used the Fisher score and one-leave-out cross-validation as measure of the classifier accuracy. Firstly, the Fisher scores (<italic>F<sub>i</sub></italic>) was calculated for each parameter <italic>i</italic> as follows:<disp-formula id="equ16"><mml:math id="m16"><mml:msub><mml:mi mathvariant="normal">F</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msup><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msup><mml:msup><mml:mo>)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mi mathvariant="normal">k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msubsup><mml:msup><mml:mo>)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p>where <italic>m</italic> is the number of classes, <italic>n<sub>k</sub></italic> is the size of the kth class <inline-formula><mml:math id="inf18"><mml:msubsup><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msubsup><mml:mo> </mml:mo><mml:mi>and</mml:mi><mml:mo> </mml:mo><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msubsup></mml:math></inline-formula> are the mean values and the standard deviation of the parameter <italic>i</italic> for the kth class <italic>u<sup>i</sup></italic> is the mean value of the parameter <italic>i</italic> over the whole sample.</p><p>The parameters were sorted based on <italic>F<sub>i</sub></italic> (<xref ref-type="table" rid="tbl1">Table 1</xref>) and systematically added to the classification while the accuracy of the algorithm was calculated, i.e., the first parameter from the sorted vector was taken, the classification was performed and the accuracy was calculated, then the second parameter was added and the process was repeated. <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2B</xref> shows how the classifier accuracy depends on the number of parameters used in the classification. For further analysis, only the set of parameters that yielded the highest accuracy was used.</p><p>The LDA was performed in three independent steps. Each corresponds to a two-class classification. First, hepatocytes were classified from other nuclei, then SECs were classified from the remaining nuclei and, finally, the rest of the nuclei were classified either into Kupffer or stellate cells.</p></sec><sec id="s4-5-3"><title>Cell classification by Bayesian network</title><p>The training set was presented as a vector of 75 parameters. The first one corresponded to the cell type and the following 74 were the measured nucleus features. Each parameter was discretized into 5 bins with equal population. Then, we calculated the mutual information <italic>MI </italic>between every parameter and the cell type parameter as<disp-formula id="equ17"><mml:math id="m17"><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mo mathvariant="italic">,</mml:mo><mml:mi>Y</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo mathvariant="italic">,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo mathvariant="italic">,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mfenced><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo mathvariant="italic">(</mml:mo><mml:mi>x</mml:mi><mml:mo mathvariant="italic">,</mml:mo><mml:mi>y</mml:mi><mml:mo mathvariant="italic">)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo mathvariant="italic">(</mml:mo><mml:mi>x</mml:mi><mml:mo mathvariant="italic">)</mml:mo><mml:mi>P</mml:mi><mml:mo mathvariant="italic">(</mml:mo><mml:mi>y</mml:mi><mml:mo mathvariant="italic">)</mml:mo></mml:mrow></mml:mfrac></mml:mfenced></mml:math></disp-formula></p><p>where <italic>X</italic> and <italic>Y</italic> denote sets of parameters, <italic>x</italic> and <italic>y</italic> denote instances of parameters. The probabilities were calculated from the training set as<disp-formula id="equ18"><mml:math id="m18"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>+</mml:mo> <mml:mo/><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>x</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>+</mml:mo> <mml:mo/><mml:mi>r</mml:mi></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p>where <italic>n<sub>x </sub></italic>denotes the number of instances in the bin <italic>x </italic>and <italic>r</italic> is the number of bins (in our case <italic>r</italic> = 5 for all parameters but the first one). Then the parameters were sorted in descent order according to the mutual information. The structure of Bayesian network was learned from the training data by the K2 algorithm (<xref ref-type="bibr" rid="bib43">Heckerman et al., 1995</xref>) (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2C</xref>). For each nucleus, the probability for each cell type was calculated. The type with the highest probability was taken as classification output.</p></sec></sec><sec id="s4-6"><title>Validation of the resulting model</title><sec id="s4-6-1"><title>Benchmark for the evaluation of 3D reconstructions of dense tissue</title><p>We generated a set of artificial images of liver tissue that can be used for developing and evaluating methods for the reconstruction of geometrical models of dense tissue. The benchmark consists of a set of realistic 3D high-resolution images (0.3 μm × 0.3 μm × 0.3 μm per voxel) of normal liver tissue. To generate artificial images that emulate the complexity of the real tissue images as well as exhibit meaningful biological characteristics, we extracted data from real images to produce idealized ground truth images of the main structures forming the tissue, that is, nuclei, sinusoids, BC and cell borders. Then, distortions coming from different sources such as uneven staining, optical distortion due to the PSF of the confocal microscope and spatially variation of Poisson noise were added to the idealized ground truth images (<xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5</xref>).</p><p>The ground truth images were generated as follows: (1) the initial outlines were extracted from three real 3D images: central lines of the tubular networks (e.g. BC and sinusoids), position of the nuclei centres and cell borders; (2) idealized structures were built on top of the outlines: solid tubes with a constant radius of ~0.5 µm for the BC networks, hollow tubes with constant internal (~2.5 µm) and external (~3.0 µm) radius for the sinusoidal networks, solid spheres with radius between ~3.5 and ~5.5 µm for the nuclei and solid border of ~0.5 µm width for the cells.</p><p>Next, the uneven staining was simulated by applying random intensities at different scale levels. Briefly, first a 6 × 6 × 6 binning was applied to a black image and an intensity value extracted from a log-normal distribution with mean 1000 a.u. and standard deviation 0.5 was assigned to each binned voxel. Next, the image was unbinned and the new intensity values of each pixel were extracted from a log-normal distribution with mean equal to the original value and standard deviation 0.2. Finally, the uneven stained image was obtained by applying a mask (ground truth) to the generated one. Additionally, a homogeneous background (10:1, 4:1 and 2:1 signal-to-noise ratios) was added to the images (<xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5A,B</xref>).</p><p>In thick samples far from the coverslip, the acquired images are highly distorted by the illumination PSF, leading to an asymmetric smearing of the image in z-direction (<xref ref-type="bibr" rid="bib69">Nasse et al., 2007</xref>; <xref ref-type="bibr" rid="bib68">Nasse and Woehl, 2010</xref>). We convolved the uneven stained images with realist PSFs (<xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5C,D</xref>). The PSFs were generated using different excitations wavelengths for each structure: 568, 647, 780 and 488 nm for BC, sinusoids, nuclei and cell borders, respectively. Finally, we added Poisson noise with different scaling factors according to the models extracted from the real data (<xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5E–G</xref>). An example of the resulting images is shown in <xref ref-type="fig" rid="fig3s6">Figure 3—figure supplement 6</xref>.</p></sec><sec id="s4-6-2"><title>Internal consistency of the data extracted from sinusoidal network reconstruction</title><p>In order to check the internal consistency of the morphometric features that we extracted from the reconstructed sinusoidal networks, we independently calculated the fraction of volume of the sinusoids (V<sub>S</sub>), the length of the sinusoidal network per volume unit (L<sub>S</sub>) and the average radius of the network (r<sub>s</sub>). Then, we estimated the fraction of volume of sinusoids (V<sub>C</sub>) using L<sub>S </sub>and r<sub>s</sub>, and approximating the tubular network by a cylindrical network. We found that V<sub>c</sub>⁄V<sub>s</sub> = 0.99 ± 0.09, showing the internal consistency of our data. When applying the same calculation to the data reported in (<xref ref-type="bibr" rid="bib39">Hammad et al., 2014</xref>), we found V<sub>c</sub>⁄V<sub>s</sub> = 2.55, which suggests an over-estimation of the network parameters (e.g. number of intersection nodes per mm<sup>3</sup>, network length per mm<sup>3</sup>); see <xref ref-type="table" rid="tbl2">Table 2</xref>.<table-wrap id="tbl2" position="float"><object-id pub-id-type="doi">10.7554/eLife.11214.033</object-id><label>Table 2.</label><caption><p>Internal consistency of the sinusoidal network data.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.033">http://dx.doi.org/10.7554/eLife.11214.033</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th>Sample</th><th>V<sub>s</sub></th><th>L<sub>s</sub>/(mm/mm<sup>3</sup>)</th><th>r<sub>s</sub>/(mm × 10<sup>3</sup>)</th><th> V<sub>c</sub> ∼ π × r<sub>s</sub><sup>2</sup> × L<sub>s</sub> </th><th>V<sub>c</sub>/V<sub>s</sub></th></tr></thead><tbody><tr><td>1</td><td>0.16</td><td>2853.4</td><td>4.05</td><td>0.15</td><td>0.92</td></tr><tr><td>2</td><td>0.14</td><td>2976.4</td><td>3.75</td><td>0.13</td><td>0.95</td></tr><tr><td>3</td><td>0.20</td><td>3505.8</td><td>4.50</td><td>0.22</td><td>1.09</td></tr><tr><td><xref ref-type="bibr" rid="bib39">Hammad et al., 2014</xref></td><td>0.15</td><td>5400.0</td><td>4.80</td><td>0.39</td><td>2.55</td></tr></tbody></table><table-wrap-foot><fn id="tblfn2"><p>Notes: The fraction of volume of the sinusoids (V<sub>s</sub>), the length of the sinusoidal network per volume unit (L<sub>s</sub>) and the average radius of the network (r<sub>s</sub>) were measured independently for each sample. A theoretical approximation of the fraction of volume of the sinusoids (V<sub>c</sub>), considering it consists of ideal cylinders, was calculated (Vc ∼ π × rs<sup>2</sup> × Ls). Then, the ratio between the measured and the calculated fractions of volume (V<sub>c</sub>/V<sub>s</sub>) was calculated. Values close to 1.0 reflect auto consistency on the data. We performed the same calculation with the data reported in <xref ref-type="bibr" rid="bib39">Hammad et al. (2014)</xref>.</p></fn></table-wrap-foot></table-wrap></p></sec></sec><sec id="s4-7"><title>Quantitative analysis of liver tissue architecture</title><sec id="s4-7-1"><title>DAPI integral intensity calculation</title><p>For each nucleus, the total content of DNA was calculated as the integral intensity of the original DAPI image inside the corresponding 3D triangle mesh. Since calculation was performed for three independent samples, the integral intensity per nucleus was normalized to the intensity of first one. Briefly, the distribution of DAPI integral intensity per nucleus was independently calculated for each sample (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>). Then, each distribution was aligned (stretched) to the reference one (the first one in our case) by minimizing the functional:<disp-formula id="equ19"><mml:math id="m19"><mml:msub><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi mathvariant="normal">i</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:msup><mml:mi mathvariant="normal">f</mml:mi><mml:mn>0</mml:mn></mml:msup><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>)</mml:mo><mml:msup><mml:mo>)</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi mathvariant="normal">i</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:msup><mml:mi mathvariant="normal">f</mml:mi><mml:mn>0</mml:mn></mml:msup><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>)</mml:mo><mml:mo>·</mml:mo><mml:msup><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">j</mml:mi></mml:msup><mml:mo>(</mml:mo><mml:mi mathvariant="normal">s</mml:mi><mml:mo>·</mml:mo><mml:msubsup><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi mathvariant="normal">i</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:msup><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">j</mml:mi></mml:msup><mml:mo>(</mml:mo><mml:mi mathvariant="normal">s</mml:mi><mml:mo>*</mml:mo><mml:msubsup><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>)</mml:mo><mml:msup><mml:mo>)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p>where ∑<sub>i</sub> is the sum over the bins of the distributions, <inline-formula><mml:math id="inf19"><mml:msup><mml:mi mathvariant="normal">f</mml:mi><mml:mn>0</mml:mn></mml:msup><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>)</mml:mo></mml:math></inline-formula> is the height of the i bin of the reference curve, <inline-formula><mml:math id="inf20"><mml:msup><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">j</mml:mi></mml:msup><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">j</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:math></inline-formula> is the height of the i bin of the <italic>j</italic> curve to be aligned and s is the scaling (stretching) factor.</p><p>We found scaling factors 1.19 and 0.93 for the second and third samples respectively. Finally, the DAPI integral intensity of each nucleus was recalculated using the corresponding scaling factor.</p></sec></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>The authors acknowledge I. Sbalzarini, P. Tomancak and F. Jug (MPI-CBG) for comments on the manuscript. They also thank W. John and A. Muench-Wuttke from the Biomedical Services Facility for mouse care. Thanks also to J. Peychl for the management of the Light Microscopy Facility. This work was financially supported by the Virtual Liver initiative (<ext-link ext-link-type="uri" xlink:href="http://www.virtual-liver.de">http://www.virtual-liver.de</ext-link>), funded by the German Federal Ministry of Research and Education (BMBF), the Max Planck Society (MPG) and the DFG.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>The authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>HM-N, Developed the set of algorithms and statistics for cell classification, Developed the set of algorithms to create synthetic images, developed the network analysis statistics, Implemented the new and existing algorithms into a single platform, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con2"><p>FS-M, Acquisition of data, Analysis and interpretation of data</p></fn><fn fn-type="con" id="con3"><p>PK, Developed the algorithm for the section surface detection, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con4"><p>KM, Acquisition of data, Analysis and interpretation of data</p></fn><fn fn-type="con" id="con5"><p>HN, Acquisition of data, Analysis and interpretation of data</p></fn><fn fn-type="con" id="con6"><p>GM, Implemented the new and existing algorithms into a single platform, Analysis and interpretation of data</p></fn><fn fn-type="con" id="con7"><p>MC, Implemented the new and existing algorithms into a single platform, Analysis and interpretation of data</p></fn><fn fn-type="con" id="con8"><p>AK, Transferred CPU implementation of the algorithms to GPU, Analysis and interpretation of data</p></fn><fn fn-type="con" id="con9"><p>MZ, Acquisition of data, Analysis and interpretation of data</p></fn><fn fn-type="con" id="con10"><p>YK, Conceived and directed the project, developed the de-noising algorithm, supervise the implemented the new and existing algorithms into a single platform, Conception and design, Acquisition of data, Drafting or revising the article</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>Animal experimentation: All animal studies were conducted in accordance with German animal welfare legislation and in strict pathogen-free conditions in the animal facility of the Max Planck Institute of Molecular Cell Biology and Genetics, Dresden, Germany. Protocols were approved by the Institutional Animal Welfare Officer (Tierschutzbeauftragter) and all necessary licenses were obtained from the regional Ethical Commission for Animal Experimentation of Dresden, Germany (Tierversuchskommission, Landesdirektion Dresden)(License number: AZ 24-9168.24-9/2012-1, AZ 24-9168.11-9/2012-3).</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="SD1-data"><object-id pub-id-type="doi">10.7554/eLife.11214.034</object-id><label>Supplementary file 1.</label><caption><title>3D ‘ground truth’ voxelated model of liver tissue (0.3 μm × 0.3 μm × 0.3 μm per voxel).</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.034">http://dx.doi.org/10.7554/eLife.11214.034</ext-link></p></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-11214-supp1-v2.zip"/></supplementary-material><sec id="s7" sec-type="datasets"><title>Major datasets</title><p>The following datasets were generated:</p><p><related-object content-type="generated-dataset" id="dataro1" source-id="http://dx.doi.org/10.5061/dryad.m67r6" source-id-type="uri"><collab>Morales-Navarrete H</collab>, <collab>Segovia-Miranda F</collab>, <collab>Klukowski P</collab>, <collab>Meyer K</collab>, <collab>Nonaka H</collab>, <collab>Marsico G</collab>, <collab>Chernykh M</collab>, <collab>Kalaidzidis A</collab>, <collab>Zerial M</collab>, <collab>Kalaidzidis Y</collab><x>,</x> <year>2016</year><x>,</x><source>A versatile pipeline for the multi-scale digital reconstruction and quantitative analysis of 3D tissue architecture</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5061/dryad.m67r6">http://dx.doi.org/10.5061/dryad.m67r6</ext-link><x>,</x> <comment>Available at Dryad Digital Repository under a CC0 Public Domain Dedication</comment></related-object></p></sec></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Al-Kofahi</surname><given-names>Y</given-names></name><name><surname>Lassoued</surname><given-names>W</given-names></name><name><surname>Lee</surname><given-names>W</given-names></name><name><surname>Roysam</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Improved automatic detection and segmentation of cell nuclei in histopathology images</article-title><source>IEEE Transactions on Bio-Medical Engineering</source><volume>57</volume><fpage>841</fpage><lpage>852</lpage><pub-id pub-id-type="doi">10.1109/TBME.2009.2035102</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amat</surname><given-names>F</given-names></name><name><surname>Lemon</surname><given-names>W</given-names></name><name><surname>Mossing</surname><given-names>DP</given-names></name><name><surname>McDole</surname><given-names>K</given-names></name><name><surname>Wan</surname><given-names>Y</given-names></name><name><surname>Branson</surname><given-names>K</given-names></name><name><surname>Myers</surname><given-names>EW</given-names></name><name><surname>Keller</surname><given-names>PJ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Fast, accurate reconstruction of cell lineages from large-scale fluorescence microscopy data</article-title><source>Nature Methods</source><volume>11</volume><fpage>951</fpage><lpage>958</lpage><pub-id pub-id-type="doi">10.1038/nmeth.3036</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Asahina</surname><given-names>K</given-names></name><name><surname>Shiokawa</surname><given-names>M</given-names></name><name><surname>Ueki</surname><given-names>T</given-names></name><name><surname>Yamasaki</surname><given-names>C</given-names></name><name><surname>Aratani</surname><given-names>A</given-names></name><name><surname>Tateno</surname><given-names>C</given-names></name><name><surname>Yoshizato</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Multiplicative mononuclear small hepatocytes in adult rat liver: their isolation as a homogeneous population and localization to periportal zone</article-title><source>Biochemical and Biophysical Research Communications</source><volume>342</volume><fpage>1160</fpage><lpage>1167</lpage><pub-id pub-id-type="doi">10.1016/j.bbrc.2006.02.076</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baratta</surname><given-names>JL</given-names></name><name><surname>Ngo</surname><given-names>A</given-names></name><name><surname>Lopez</surname><given-names>B</given-names></name><name><surname>Kasabwalla</surname><given-names>N</given-names></name><name><surname>Longmuir</surname><given-names>KJ</given-names></name><name><surname>Robertson</surname><given-names>RT</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Cellular organization of normal mouse liver: a histological, quantitative immunocytochemical, and fine structural analysis</article-title><source>Histochemistry and Cell Biology</source><volume>131</volume><fpage>713</fpage><lpage>726</lpage><pub-id pub-id-type="doi">10.1007/s00418-009-0577-1</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barbier de Reuille</surname><given-names>P</given-names></name><name><surname>Routier-Kierzkowska</surname><given-names>AL</given-names></name><name><surname>Kierzkowski</surname><given-names>D</given-names></name><name><surname>Bassel</surname><given-names>GW</given-names></name><name><surname>Schüpbach</surname><given-names>T</given-names></name><name><surname>Tauriello</surname><given-names>G</given-names></name><name><surname>Bajpai</surname><given-names>N</given-names></name><name><surname>Strauss</surname><given-names>S</given-names></name><name><surname>Weber</surname><given-names>A</given-names></name><name><surname>Kiss</surname><given-names>A</given-names></name><name><surname>Burian</surname><given-names>A</given-names></name><name><surname>Hofhuis</surname><given-names>H</given-names></name><name><surname>Sapala</surname><given-names>A</given-names></name><name><surname>Lipowczan</surname><given-names>M</given-names></name><name><surname>Heimlicher</surname><given-names>MB</given-names></name><name><surname>Robinson</surname><given-names>S</given-names></name><name><surname>Bayer</surname><given-names>EM</given-names></name><name><surname>Basler</surname><given-names>K</given-names></name><name><surname>Koumoutsakos</surname><given-names>P</given-names></name><name><surname>Roeder</surname><given-names>AH</given-names></name><name><surname>Aegerter-Wilmsen</surname><given-names>T</given-names></name><name><surname>Nakayama</surname><given-names>N</given-names></name><name><surname>Tsiantis</surname><given-names>M</given-names></name><name><surname>Hay</surname><given-names>A</given-names></name><name><surname>Kwiatkowska</surname><given-names>D</given-names></name><name><surname>Xenarios</surname><given-names>I</given-names></name><name><surname>Kuhlemeier</surname><given-names>C</given-names></name><name><surname>Smith</surname><given-names>RS</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>MorphoGraphX: a platform for quantifying morphogenesis in 4D</article-title><source>eLife</source><volume>4</volume><pub-id pub-id-type="doi">10.7554/eLife.05864</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beck</surname><given-names>A</given-names></name><name><surname>Teboulle</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Fast gradient-based algorithms for constrained total variation image denoising and deblurring problems</article-title><source>IEEE Transactions on Image Processing : A Publication of the IEEE Signal Processing Society</source><volume>18</volume><fpage>2419</fpage><lpage>2434</lpage><pub-id pub-id-type="doi">10.1109/TIP.2009.2028250</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bilgin</surname><given-names>CC</given-names></name><name><surname>Kim</surname><given-names>S</given-names></name><name><surname>Leung</surname><given-names>E</given-names></name><name><surname>Chang</surname><given-names>H</given-names></name><name><surname>Parvin</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Integrated profiling of three dimensional cell culture models and 3D microscopy</article-title><source>Bioinformatics</source><volume>29</volume><fpage>3087</fpage><lpage>3093</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btt535</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bock</surname><given-names>M</given-names></name><name><surname>Tyagi</surname><given-names>AK</given-names></name><name><surname>Kreft</surname><given-names>JU</given-names></name><name><surname>Alt</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Generalized voronoi tessellation as a model of two-dimensional cell tissue dynamics</article-title><source>Bulletin of Mathematical Biology</source><volume>72</volume><fpage>1696</fpage><lpage>1731</lpage><pub-id pub-id-type="doi">10.1007/s11538-009-9498-3</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boehm</surname><given-names>B</given-names></name><name><surname>Westerberg</surname><given-names>H</given-names></name><name><surname>Lesnicar-Pucko</surname><given-names>G</given-names></name><name><surname>Raja</surname><given-names>S</given-names></name><name><surname>Rautschka</surname><given-names>M</given-names></name><name><surname>Cotterell</surname><given-names>J</given-names></name><name><surname>Swoger</surname><given-names>J</given-names></name><name><surname>Sharpe</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>The role of spatially controlled cell proliferation in limb bud morphogenesis</article-title><source>PLoS Biology</source><volume>8</volume><elocation-id>e1000420</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1000420</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bouwens</surname><given-names>L</given-names></name><name><surname>De Bleser</surname><given-names>P</given-names></name><name><surname>Vanderkerken</surname><given-names>K</given-names></name><name><surname>Geerts</surname><given-names>B</given-names></name><name><surname>Wisse</surname><given-names>E</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Liver cell heterogeneity: functions of non-parenchymal cells</article-title><source>Enzyme</source><volume>46</volume><fpage>155</fpage><lpage>168</lpage></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bria</surname><given-names>A</given-names></name><name><surname>Iannello</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>TeraStitcher - a tool for fast automatic 3D-stitching of teravoxel-sized microscopy images</article-title><source>BMC Bioinformatics</source><volume>13</volume><pub-id pub-id-type="doi">10.1186/1471-2105-13-316</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brink</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Using spatial information as an aid to maximum entropy image threshold selection</article-title><source>Pattern Recognition Letters</source><volume>17</volume><fpage>29</fpage><lpage>36</lpage><pub-id pub-id-type="doi">10.1016/0167-8655(95)00096-8</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname><given-names>M</given-names></name><name><surname>Lowe</surname><given-names>DG</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Recognising panoramas</article-title><source>Ninth Ieee International Conference on Computer Vision, Vols I and Ii</source><fpage>1218</fpage><lpage>1225</lpage></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burt</surname><given-names>PJ</given-names></name><name><surname>Adelson</surname><given-names>EH</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>A multiresolution spline with application to image mosaics</article-title><source>ACM Transactions on Graphics</source><volume>2</volume><fpage>217</fpage><lpage>236</lpage><pub-id pub-id-type="doi">10.1145/245.247</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burton</surname><given-names>GJ</given-names></name><name><surname>Ingram</surname><given-names>SC</given-names></name><name><surname>Palmer</surname><given-names>ME</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>The influence of mode of fixation on morphometrical data derived from terminal villi in the human placenta at term: a comparison of immersion and perfusion fixation</article-title><source>Placenta</source><volume>8</volume><fpage>37</fpage><lpage>51</lpage><pub-id pub-id-type="doi">10.1016/0143-4004(87)90038-5</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chittajallu</surname><given-names>DR</given-names></name><name><surname>Florian</surname><given-names>S</given-names></name><name><surname>Kohler</surname><given-names>RH</given-names></name><name><surname>Iwamoto</surname><given-names>Y</given-names></name><name><surname>Orth</surname><given-names>JD</given-names></name><name><surname>Weissleder</surname><given-names>R</given-names></name><name><surname>Danuser</surname><given-names>G</given-names></name><name><surname>Mitchison</surname><given-names>TJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>In vivo cell-cycle profiling in xenograft tumors by quantitative intravital microscopy</article-title><source>Nature Methods</source><volume>12</volume><fpage>577</fpage><lpage>585</lpage><pub-id pub-id-type="doi">10.1038/nmeth.3363</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chung</surname><given-names>K</given-names></name><name><surname>Deisseroth</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>CLARITY for mapping the nervous system</article-title><source>Nature Methods</source><volume>10</volume><fpage>508</fpage><lpage>513</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2481</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Coleman</surname><given-names>AW</given-names></name><name><surname>Maguire</surname><given-names>MJ</given-names></name><name><surname>Coleman</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="1981">1981</year><article-title>Mithramycin- and 4'-6-diamidino-2-phenylindole (dAPI)-DNA staining for fluorescence microspectrophotometric measurement of DNA in nuclei, plastids, and virus particles</article-title><source>Journal of Histochemistry &amp; Cytochemistry</source><volume>29</volume><fpage>959</fpage><lpage>968</lpage><pub-id pub-id-type="doi">10.1177/29.8.6168681</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Collins</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>ImageJ for microscopy</article-title><source>BioTechniques</source><volume>43</volume><fpage>S25</fpage><lpage>S30</lpage><pub-id pub-id-type="doi">10.2144/000112517</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Chaumont</surname><given-names>F</given-names></name><name><surname>Dallongeville</surname><given-names>S</given-names></name><name><surname>Chenouard</surname><given-names>N</given-names></name><name><surname>Hervé</surname><given-names>N</given-names></name><name><surname>Pop</surname><given-names>S</given-names></name><name><surname>Provoost</surname><given-names>T</given-names></name><name><surname>Meas-Yedid</surname><given-names>V</given-names></name><name><surname>Pankajakshan</surname><given-names>P</given-names></name><name><surname>Lecomte</surname><given-names>T</given-names></name><name><surname>Le Montagner</surname><given-names>Y</given-names></name><name><surname>Lagache</surname><given-names>T</given-names></name><name><surname>Dufour</surname><given-names>A</given-names></name><name><surname>Olivo-Marin</surname><given-names>JC</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Icy: an open bioimage informatics platform for extended reproducible research</article-title><source>Nature Methods</source><volume>9</volume><fpage>690</fpage><lpage>696</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2075</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dima</surname><given-names>AA</given-names></name><name><surname>Elliott</surname><given-names>JT</given-names></name><name><surname>Filliben</surname><given-names>JJ</given-names></name><name><surname>Halter</surname><given-names>M</given-names></name><name><surname>Peskin</surname><given-names>A</given-names></name><name><surname>Bernal</surname><given-names>J</given-names></name><name><surname>Kociolek</surname><given-names>M</given-names></name><name><surname>Brady</surname><given-names>MC</given-names></name><name><surname>Tang</surname><given-names>HC</given-names></name><name><surname>Plant</surname><given-names>AL</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Comparison of segmentation algorithms for fluorescence microscopy images of cells</article-title><source>Cytometry Part A</source><volume>79A</volume><fpage>545</fpage><lpage>559</lpage><pub-id pub-id-type="doi">10.1002/cyto.a.21079</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dmitrieva</surname><given-names>NI</given-names></name><name><surname>Cui</surname><given-names>K</given-names></name><name><surname>Kitchaev</surname><given-names>DA</given-names></name><name><surname>Zhao</surname><given-names>K</given-names></name><name><surname>Burg</surname><given-names>MB</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>DNA double-strand breaks induced by high NaCl occur predominantly in gene deserts</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>108</volume><fpage>20796</fpage><lpage>20801</lpage><pub-id pub-id-type="doi">10.1073/pnas.1114677108</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Duda</surname><given-names>R</given-names></name><name><surname>Hart</surname><given-names>P</given-names></name><name><surname>Stork</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2001">2001</year><source>Pattern Classification</source><publisher-loc>New York</publisher-loc><publisher-name>John Wiley &amp; Sons</publisher-name></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Einstein</surname><given-names>AJ</given-names></name><name><surname>Wu</surname><given-names>H-S</given-names></name><name><surname>Sanchez</surname><given-names>M</given-names></name><name><surname>Gil</surname><given-names>J</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Fractal characterization of chromatin appearance for diagnosis in breast cytology</article-title><source>The Journal of Pathology</source><volume>185</volume><fpage>366</fpage><lpage>381</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1096-9896(199808)185:4&lt;366::AID-PATH122&gt;3.0.CO;2-C</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Emmenlauer</surname><given-names>M</given-names></name><name><surname>Ronneberger</surname><given-names>O</given-names></name><name><surname>Ponti</surname><given-names>A</given-names></name><name><surname>Schwarb</surname><given-names>P</given-names></name><name><surname>Griffa</surname><given-names>A</given-names></name><name><surname>Filippi</surname><given-names>A</given-names></name><name><surname>Nitschke</surname><given-names>R</given-names></name><name><surname>Driever</surname><given-names>W</given-names></name><name><surname>Burkhardt</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>XuvTools: free, fast and reliable stitching of large 3D datasets</article-title><source>Journal of Microscopy</source><volume>233</volume><fpage>42</fpage><lpage>60</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2818.2008.03094.x</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Faggioli</surname><given-names>F</given-names></name><name><surname>Vezzoni</surname><given-names>P</given-names></name><name><surname>Montagna</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Single-cell analysis of ploidy and centrosomes underscores the peculiarity of normal hepatocytes</article-title><source>PloS One</source><volume>6</volume><elocation-id>e26080</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0026080</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fisher</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="1936">1936</year><article-title>The use of multiple measurements in taxonomic problems</article-title><source>Annals of Eugenics</source><volume>7</volume><fpage>179</fpage><lpage>188</lpage><pub-id pub-id-type="doi">10.1111/j.1469-1809.1936.tb02137.x</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fonseca</surname><given-names>CG</given-names></name><name><surname>Backhaus</surname><given-names>M</given-names></name><name><surname>Bluemke</surname><given-names>DA</given-names></name><name><surname>Britten</surname><given-names>RD</given-names></name><name><surname>Chung</surname><given-names>JD</given-names></name><name><surname>Cowan</surname><given-names>BR</given-names></name><name><surname>Dinov</surname><given-names>ID</given-names></name><name><surname>Finn</surname><given-names>JP</given-names></name><name><surname>Hunter</surname><given-names>PJ</given-names></name><name><surname>Kadish</surname><given-names>AH</given-names></name><name><surname>Lee</surname><given-names>DC</given-names></name><name><surname>Lima</surname><given-names>JA</given-names></name><name><surname>Medrano-Gracia</surname><given-names>P</given-names></name><name><surname>Shivkumar</surname><given-names>K</given-names></name><name><surname>Suinesiaputra</surname><given-names>A</given-names></name><name><surname>Tao</surname><given-names>W</given-names></name><name><surname>Young</surname><given-names>AA</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The cardiac atlas project--an imaging database for computational modeling and statistical atlases of the heart</article-title><source>Bioinformatics</source><volume>27</volume><fpage>2288</fpage><lpage>2295</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btr360</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Font-Burgada</surname><given-names>J</given-names></name><name><surname>Shalapour</surname><given-names>S</given-names></name><name><surname>Ramaswamy</surname><given-names>S</given-names></name><name><surname>Hsueh</surname><given-names>B</given-names></name><name><surname>Rossell</surname><given-names>D</given-names></name><name><surname>Umemura</surname><given-names>A</given-names></name><name><surname>Taniguchi</surname><given-names>K</given-names></name><name><surname>Nakagawa</surname><given-names>H</given-names></name><name><surname>Valasek</surname><given-names>MA</given-names></name><name><surname>Ye</surname><given-names>L</given-names></name><name><surname>Kopp</surname><given-names>JL</given-names></name><name><surname>Sander</surname><given-names>M</given-names></name><name><surname>Carter</surname><given-names>H</given-names></name><name><surname>Deisseroth</surname><given-names>K</given-names></name><name><surname>Verma</surname><given-names>IM</given-names></name><name><surname>Karin</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Hybrid periportal hepatocytes regenerate the injured liver without giving rise to cancer</article-title><source>Cell</source><volume>162</volume><fpage>766</fpage><lpage>779</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.07.026</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friebel</surname><given-names>A</given-names></name><name><surname>Neitsch</surname><given-names>J</given-names></name><name><surname>Johann</surname><given-names>T</given-names></name><name><surname>Hammad</surname><given-names>S</given-names></name><name><surname>Hengstler</surname><given-names>JG</given-names></name><name><surname>Drasdo</surname><given-names>D</given-names></name><name><surname>Hoehme</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>TiQuant: software for tissue analysis, quantification and surface reconstruction</article-title><source>Bioinformatics</source><volume>31</volume><pub-id pub-id-type="doi">10.1093/bioinformatics/btv346</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friedman</surname><given-names>N</given-names></name><name><surname>Geiger</surname><given-names>D</given-names></name><name><surname>Goldszmidt</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Bayesian network classifiers</article-title><source>Machine Learning</source><volume>29</volume><fpage>131</fpage><lpage>163</lpage><pub-id pub-id-type="doi">10.1023/A:1007465528199</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friedman</surname><given-names>N</given-names></name><name><surname>Nachman</surname><given-names>I</given-names></name><name><surname>Peer</surname><given-names>D</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Learning bayesian network structure from massive datasets: the &quot;sparse candidate&quot; algorithm</article-title><source>Uncertainty in Artificial Intelligence, Proceedings</source><fpage>206</fpage><lpage>215</lpage></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gage</surname><given-names>GJ</given-names></name><name><surname>Kipke</surname><given-names>DR</given-names></name><name><surname>Shain</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Whole animal perfusion fixation for rodents</article-title><source>Journal of Visualized Experiments</source><pub-id pub-id-type="doi">10.3791/3564</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gandillet</surname><given-names>A</given-names></name><name><surname>Alexandre</surname><given-names>E</given-names></name><name><surname>Holl</surname><given-names>V</given-names></name><name><surname>Royer</surname><given-names>C</given-names></name><name><surname>Bischoff</surname><given-names>P</given-names></name><name><surname>Cinqualbre</surname><given-names>J</given-names></name><name><surname>Wolf</surname><given-names>P</given-names></name><name><surname>Jaeck</surname><given-names>D</given-names></name><name><surname>Richert</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Hepatocyte ploidy in normal young rat</article-title><source>Comparative Biochemistry and Physiology. Part A, Molecular &amp; Integrative Physiology</source><volume>134</volume><fpage>665</fpage><lpage>673</lpage></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gentric</surname><given-names>G</given-names></name><name><surname>Desdouets</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Polyploidization in liver tissue</article-title><source>The American Journal of Pathology</source><volume>184</volume><fpage>322</fpage><lpage>331</lpage><pub-id pub-id-type="doi">10.1016/j.ajpath.2013.06.035</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Girish</surname><given-names>V</given-names></name><name><surname>Vijayalakshmi</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Affordable image analysis using NIH Image/ImageJ</article-title><source>Indian Journal of Cancer</source><volume>41</volume></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Griffiths</surname><given-names>TR</given-names></name><name><surname>Nerukh</surname><given-names>DA</given-names></name><name><surname>Eremenko</surname><given-names>SA</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>The application of theoretical models of complex shape to the fitting of experimental spectra having closely overlapping bands</article-title><source>Physical Chemistry Chemical Physics</source><volume>1</volume><fpage>3199</fpage><lpage>3208</lpage><pub-id pub-id-type="doi">10.1039/a902569c</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guidotti</surname><given-names>JE</given-names></name><name><surname>Brégerie</surname><given-names>O</given-names></name><name><surname>Robert</surname><given-names>A</given-names></name><name><surname>Debey</surname><given-names>P</given-names></name><name><surname>Brechot</surname><given-names>C</given-names></name><name><surname>Desdouets</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Liver cell polyploidization: a pivotal role for binuclear hepatocytes</article-title><source>The Journal of Biological Chemistry</source><volume>278</volume><fpage>19095</fpage><lpage>19101</lpage><pub-id pub-id-type="doi">10.1074/jbc.M300982200</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hammad</surname><given-names>S</given-names></name><name><surname>Hoehme</surname><given-names>S</given-names></name><name><surname>Friebel</surname><given-names>A</given-names></name><name><surname>von Recklinghausen</surname><given-names>I</given-names></name><name><surname>Othman</surname><given-names>A</given-names></name><name><surname>Begher-Tibbe</surname><given-names>B</given-names></name><name><surname>Reif</surname><given-names>R</given-names></name><name><surname>Godoy</surname><given-names>P</given-names></name><name><surname>Johann</surname><given-names>T</given-names></name><name><surname>Vartak</surname><given-names>A</given-names></name><name><surname>Golka</surname><given-names>K</given-names></name><name><surname>Bucur</surname><given-names>PO</given-names></name><name><surname>Vibert</surname><given-names>E</given-names></name><name><surname>Marchan</surname><given-names>R</given-names></name><name><surname>Christ</surname><given-names>B</given-names></name><name><surname>Dooley</surname><given-names>S</given-names></name><name><surname>Meyer</surname><given-names>C</given-names></name><name><surname>Ilkavets</surname><given-names>I</given-names></name><name><surname>Dahmen</surname><given-names>U</given-names></name><name><surname>Dirsch</surname><given-names>O</given-names></name><name><surname>Böttger</surname><given-names>J</given-names></name><name><surname>Gebhardt</surname><given-names>R</given-names></name><name><surname>Drasdo</surname><given-names>D</given-names></name><name><surname>Hengstler</surname><given-names>JG</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Protocols for staining of bile canalicular and sinusoidal networks of human, mouse and pig livers, three-dimensional reconstruction and quantification of tissue microarchitecture by image processing and analysis</article-title><source>Archives of Toxicology</source><volume>88</volume><fpage>1161</fpage><lpage>1183</lpage><pub-id pub-id-type="doi">10.1007/s00204-014-1243-5</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haralick</surname><given-names>RM</given-names></name><name><surname>Shanmugam</surname><given-names>K</given-names></name><name><surname>Dinstein</surname><given-names>Its'Hak</given-names></name></person-group><year iso-8601-date="1973">1973</year><article-title>Textural features for image classification</article-title><source>IEEE Transactions on Systems, Man, and Cybernetics</source><volume>3</volume><fpage>610</fpage><lpage>621</lpage><pub-id pub-id-type="doi">10.1109/TSMC.1973.4309314</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hardman</surname><given-names>RC</given-names></name><name><surname>Volz</surname><given-names>DC</given-names></name><name><surname>Kullman</surname><given-names>SW</given-names></name><name><surname>Hinton</surname><given-names>DE</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>An in vivo look at vertebrate liver architecture: three-dimensional reconstructions from medaka (oryzias latipes)</article-title><source>Anatomical Record</source><volume>290</volume><fpage>770</fpage><lpage>782</lpage><pub-id pub-id-type="doi">10.1002/ar.20524</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hayworth</surname><given-names>KJ</given-names></name><name><surname>Xu</surname><given-names>CS</given-names></name><name><surname>Lu</surname><given-names>Z</given-names></name><name><surname>Knott</surname><given-names>GW</given-names></name><name><surname>Fetter</surname><given-names>RD</given-names></name><name><surname>Tapia</surname><given-names>JC</given-names></name><name><surname>Lichtman</surname><given-names>JW</given-names></name><name><surname>Hess</surname><given-names>HF</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Ultrastructurally smooth thick partitioning and volume stitching for large-scale connectomics</article-title><source>Nature Methods</source><volume>12</volume><pub-id pub-id-type="doi">10.1038/nmeth.3292</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heckerman</surname><given-names>D</given-names></name><name><surname>Geiger</surname><given-names>D</given-names></name><name><surname>Chickering</surname><given-names>DM</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Learning bayesian networks: the combination of knowledge and statistical data</article-title><source>Machine Learning</source><volume>20</volume><fpage>197</fpage><lpage>243</lpage><pub-id pub-id-type="doi">10.1007/BF00994016</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hoehme</surname><given-names>S</given-names></name><name><surname>Brulport</surname><given-names>M</given-names></name><name><surname>Bauer</surname><given-names>A</given-names></name><name><surname>Bedawy</surname><given-names>E</given-names></name><name><surname>Schormann</surname><given-names>W</given-names></name><name><surname>Hermes</surname><given-names>M</given-names></name><name><surname>Puppe</surname><given-names>V</given-names></name><name><surname>Gebhardt</surname><given-names>R</given-names></name><name><surname>Zellmer</surname><given-names>S</given-names></name><name><surname>Schwarz</surname><given-names>M</given-names></name><name><surname>Bockamp</surname><given-names>E</given-names></name><name><surname>Timmel</surname><given-names>T</given-names></name><name><surname>Hengstler</surname><given-names>JG</given-names></name><name><surname>Drasdo</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Prediction and validation of cell alignment along microvessels as order principle to restore tissue architecture in liver regeneration</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>107</volume><fpage>10371</fpage><lpage>10376</lpage><pub-id pub-id-type="doi">10.1073/pnas.0909374107</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huisman</surname><given-names>A</given-names></name><name><surname>Ploeger</surname><given-names>LS</given-names></name><name><surname>Dullens</surname><given-names>HF</given-names></name><name><surname>Jonges</surname><given-names>TN</given-names></name><name><surname>Belien</surname><given-names>JA</given-names></name><name><surname>Meijer</surname><given-names>GA</given-names></name><name><surname>Poulin</surname><given-names>N</given-names></name><name><surname>Grizzle</surname><given-names>WE</given-names></name><name><surname>van Diest</surname><given-names>PJ</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Discrimination between benign and malignant prostate tissue using chromatin texture analysis in 3-d by confocal laser scanning microscopy</article-title><source>The Prostate</source><volume>67</volume><fpage>248</fpage><lpage>254</lpage><pub-id pub-id-type="doi">10.1002/pros.20507</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hunter</surname><given-names>PJ</given-names></name><name><surname>Crampin</surname><given-names>EJ</given-names></name><name><surname>Nielsen</surname><given-names>PM</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Bioinformatics, multiscale modeling and the IUPS physiome project</article-title><source>Briefings in Bioinformatics</source><volume>9</volume><fpage>333</fpage><lpage>343</lpage><pub-id pub-id-type="doi">10.1093/bib/bbn024</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Irvin</surname><given-names>CG</given-names></name><name><surname>Bates</surname><given-names>JH</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Measuring the lung function in the mouse: the challenge of size</article-title><source>Respiratory Research</source><volume>4</volume></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kapur</surname><given-names>JN</given-names></name><name><surname>Sahoo</surname><given-names>PK</given-names></name><name><surname>Wong</surname><given-names>AKC</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>A new method for gray-level picture thresholding using the entropy of the histogram</article-title><source>Computer Vision, Graphics, and Image Processing</source><volume>29</volume><fpage>273</fpage><lpage>285</lpage><pub-id pub-id-type="doi">10.1016/0734-189X(85)90125-2</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ke</surname><given-names>MT</given-names></name><name><surname>Fujimoto</surname><given-names>S</given-names></name><name><surname>Imai</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>SeeDB: a simple and morphology-preserving optical clearing agent for neuronal circuit reconstruction</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>1154</fpage><lpage>1161</lpage><pub-id pub-id-type="doi">10.1038/nn.3447</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kmieć</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Cooperation of liver cells in health and disease</article-title><source>Advances in Anatomy, Embryology and Cell Biology</source><volume>161</volume><fpage>1</fpage><lpage>151</lpage><pub-id pub-id-type="doi">10.1007/978-3-642-56553-3</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Kuntz</surname><given-names>E</given-names></name><name><surname>Kuntz</surname><given-names>H-D</given-names></name></person-group><year iso-8601-date="2006">2006</year><source>Hepatology Principles and Practice History - Morphology - Biochemistry - Diagnostics Clinic - Therapy</source><publisher-loc>Berlin</publisher-loc><publisher-name>Springer Medizin Verlag Heidelberg</publisher-name></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>SC</given-names></name><name><surname>Bajcsy</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Intensity correction of fluorescent confocal laser scanning microscope images by mean-weight filtering</article-title><source>Journal of Microscopy</source><volume>221</volume><fpage>122</fpage><lpage>136</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2818.2006.01546.x</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levitt</surname><given-names>JJ</given-names></name><name><surname>Westin</surname><given-names>C-F</given-names></name><name><surname>Nestor</surname><given-names>PG</given-names></name><name><surname>Estepar</surname><given-names>RSJ</given-names></name><name><surname>Dickey</surname><given-names>CC</given-names></name><name><surname>Voglmaier</surname><given-names>MM</given-names></name><name><surname>Seidman</surname><given-names>LJ</given-names></name><name><surname>Kikinis</surname><given-names>R</given-names></name><name><surname>Jolesz</surname><given-names>FA</given-names></name><name><surname>McCarley</surname><given-names>RW</given-names></name><name><surname>Shenton</surname><given-names>ME</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Shape of caudate nucleus and its cognitive correlates in neuroleptic-naive schizotypal personality disorder</article-title><source>Biological Psychiatry</source><volume>55</volume><fpage>177</fpage><lpage>184</lpage><pub-id pub-id-type="doi">10.1016/j.biopsych.2003.08.005</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>G</given-names></name><name><surname>Chawla</surname><given-names>MK</given-names></name><name><surname>Olson</surname><given-names>K</given-names></name><name><surname>Barnes</surname><given-names>CA</given-names></name><name><surname>Guzowski</surname><given-names>JF</given-names></name><name><surname>Bjornsson</surname><given-names>C</given-names></name><name><surname>Shain</surname><given-names>W</given-names></name><name><surname>Roysam</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>A multi-model approach to simultaneous segmentation and classification of heterogeneous populations of cell nuclei in 3D confocal microscope images</article-title><source>Cytometry. Part a : The Journal of the International Society for Analytical Cytology</source><volume>71</volume><fpage>724</fpage><lpage>736</lpage><pub-id pub-id-type="doi">10.1002/cyto.a.20430</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lopes</surname><given-names>R</given-names></name><name><surname>Betrouni</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Fractal and multifractal analysis: a review</article-title><source>Medical Image Analysis</source><volume>13</volume><fpage>634</fpage><lpage>649</lpage><pub-id pub-id-type="doi">10.1016/j.media.2009.05.003</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lorensen</surname><given-names>WE</given-names></name><name><surname>Cline</surname><given-names>HE</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Marching cubes: a high resolution 3D surface construction algorithm</article-title><source>ACM SIGGRAPH Computer Graphics</source><volume>21</volume><fpage>163</fpage><lpage>169</lpage><pub-id pub-id-type="doi">10.1145/37402.37422</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luisier</surname><given-names>F</given-names></name><name><surname>Vonesch</surname><given-names>C</given-names></name><name><surname>Blu</surname><given-names>T</given-names></name><name><surname>Unser</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Fast interscale wavelet denoising of poisson-corrupted images</article-title><source>Signal Processing</source><volume>90</volume><fpage>415</fpage><lpage>427</lpage><pub-id pub-id-type="doi">10.1016/j.sigpro.2009.07.009</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Malik</surname><given-names>R</given-names></name><name><surname>Selden</surname><given-names>C</given-names></name><name><surname>Hodgson</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>The role of non-parenchymal cells in liver growth</article-title><source>Seminars in Cell &amp; Developmental Biology</source><volume>13</volume><fpage>425</fpage><lpage>431</lpage><pub-id pub-id-type="doi">10.1016/S1084952102001301</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Margall-Ducos</surname><given-names>G</given-names></name><name><surname>Celton-Morizur</surname><given-names>S</given-names></name><name><surname>Couton</surname><given-names>D</given-names></name><name><surname>Brégerie</surname><given-names>O</given-names></name><name><surname>Desdouets</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Liver tetraploidization is controlled by a new process of incomplete cytokinesis</article-title><source>Journal of Cell Science</source><volume>120</volume><fpage>3633</fpage><lpage>3639</lpage><pub-id pub-id-type="doi">10.1242/jcs.016907</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martin</surname><given-names>NC</given-names></name><name><surname>McCullough</surname><given-names>CT</given-names></name><name><surname>Bush</surname><given-names>PG</given-names></name><name><surname>Sharp</surname><given-names>L</given-names></name><name><surname>Hall</surname><given-names>AC</given-names></name><name><surname>Harrison</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Functional analysis of mouse hepatocytes differing in DNA content: volume, receptor expression, and effect of IFNgamma</article-title><source>Journal of Cellular Physiology</source><volume>191</volume><fpage>138</fpage><lpage>144</lpage><pub-id pub-id-type="doi">10.1002/jcp.10057</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mayer</surname><given-names>J</given-names></name><name><surname>Swoger</surname><given-names>J</given-names></name><name><surname>Ozga</surname><given-names>AJ</given-names></name><name><surname>Stein</surname><given-names>JV</given-names></name><name><surname>Sharpe</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Quantitative measurements in 3-dimensional datasets of mouse lymph nodes resolve organ-wide functional dependencies</article-title><source>Computational and Mathematical Methods in Medicine</source><volume>2012</volume><fpage>1</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1155/2012/128431</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McCuskey</surname><given-names>RS</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>The hepatic microvascular system in health and its response to toxicants</article-title><source>Anatomical Record</source><volume>291</volume><fpage>661</fpage><lpage>671</lpage><pub-id pub-id-type="doi">10.1002/ar.20663</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Megason</surname><given-names>SG</given-names></name><name><surname>Fraser</surname><given-names>SE</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Imaging in systems biology</article-title><source>Cell</source><volume>130</volume><fpage>784</fpage><lpage>795</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2007.08.031</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miyaoka</surname><given-names>Y</given-names></name><name><surname>Miyajima</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>To divide or not to divide: revisiting liver regeneration</article-title><source>Cell Division</source><volume>8</volume><pub-id pub-id-type="doi">10.1186/1747-1028-8-8</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="data"><person-group person-group-type="author"><name><surname>Morales-Navarrete</surname><given-names>H</given-names></name><name><surname>Segovia-Miranda</surname><given-names>F</given-names></name><name><surname>Klukowski</surname><given-names>P</given-names></name><name><surname>Meyer</surname><given-names>K</given-names></name><name><surname>Nonaka</surname><given-names>H</given-names></name><name><surname>Marsico</surname><given-names>G</given-names></name><name><surname>Chernykh</surname><given-names>M</given-names></name><name><surname>Kalaidzidis</surname><given-names>A</given-names></name><name><surname>Zerial</surname><given-names>M</given-names></name><name><surname>Kalaidzidis</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2016">2016</year><data-title>Data from: a versatile pipeline for the multi-scale digital reconstruction and quantitative analysis of 3D tissue architecture</data-title><source>Dryad Digital Repository</source><pub-id pub-id-type="doi">10.5061/dryad.m67r6</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mosaliganti</surname><given-names>K</given-names></name><name><surname>Janoos</surname><given-names>F</given-names></name><name><surname>Gelas</surname><given-names>F</given-names></name><name><surname>Noche</surname><given-names>F</given-names></name><name><surname>Obholzer</surname><given-names>F</given-names></name><name><surname>Machiraju</surname><given-names>F</given-names></name><name><surname>Megason</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Anisotropic plate diffusion filtering for detection of cell membranes in 3d microscopy images</article-title><source>2010 7th Ieee International Symposium on Biomedical Imaging: From Nano to Macro</source><fpage>588</fpage><lpage>591</lpage></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mosaliganti</surname><given-names>KR</given-names></name><name><surname>Noche</surname><given-names>RR</given-names></name><name><surname>Xiong</surname><given-names>F</given-names></name><name><surname>Swinburne</surname><given-names>IA</given-names></name><name><surname>Megason</surname><given-names>SG</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>ACME: automated cell morphology extractor for comprehensive reconstruction of cell membranes</article-title><source>PLoS Computational Biology</source><volume>8</volume><elocation-id>e1002780</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002780</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nasse</surname><given-names>MJ</given-names></name><name><surname>Woehl</surname><given-names>JC</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Realistic modeling of the illumination point spread function in confocal scanning optical microscopy</article-title><source>Journal of the Optical Society of America A</source><volume>27</volume><fpage>295</fpage><lpage>302</lpage><pub-id pub-id-type="doi">10.1364/JOSAA.27.000295</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nasse</surname><given-names>MJ</given-names></name><name><surname>Woehl</surname><given-names>JC</given-names></name><name><surname>Huant</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>High-resolution mapping of the three-dimensional point spread function in the near-focus region of a confocal microscope</article-title><source>Applied Physics Letters</source><volume>90</volume><fpage>031106</fpage><pub-id pub-id-type="doi">10.1063/1.2431764</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nyengaard</surname><given-names>JR</given-names></name><name><surname>Flyvbjerg</surname><given-names>A</given-names></name><name><surname>Rasch</surname><given-names>R</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>The impact of renal growth, regression and regrowth in experimental diabetes mellitus on number and size of proximal and distal tubular cells in the rat kidney</article-title><source>Diabetologia</source><volume>36</volume><fpage>1126</fpage><lpage>1131</lpage><pub-id pub-id-type="doi">10.1007/BF00401056</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Gorman</surname><given-names>L</given-names></name><name><surname>Sanderson</surname><given-names>AC</given-names></name><name><surname>Preston</surname><given-names>K</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>A system for automated liver tissue image analysis: methods and results</article-title><source>IEEE Transactions on Bio-Medical Engineering</source><volume>32</volume><fpage>696</fpage><lpage>706</lpage><pub-id pub-id-type="doi">10.1109/TBME.1985.325587</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oda</surname><given-names>M</given-names></name><name><surname>Yokomori</surname><given-names>H</given-names></name><name><surname>Han</surname><given-names>JY</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Regulatory mechanisms of hepatic microcirculation</article-title><source>Clinical Hemorheology and Microcirculation</source><volume>29</volume><fpage>167</fpage><lpage>182</lpage></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ohtani</surname><given-names>O</given-names></name><name><surname>Ohtani</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Lymph circulation in the liver</article-title><source>Anatomical Record (Hoboken, N.J. : 2007)</source><volume>291</volume><fpage>643</fpage><lpage>652</lpage><pub-id pub-id-type="doi">10.1002/ar.20681</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pal</surname><given-names>NR</given-names></name><name><surname>Pal</surname><given-names>SK</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>A review on image segmentation techniques</article-title><source>Pattern Recognition</source><volume>26</volume><fpage>1277</fpage><lpage>1294</lpage><pub-id pub-id-type="doi">10.1016/0031-3203(93)90135-J</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pandit</surname><given-names>SK</given-names></name><name><surname>Westendorp</surname><given-names>B</given-names></name><name><surname>Nantasanti</surname><given-names>S</given-names></name><name><surname>van Liere</surname><given-names>E</given-names></name><name><surname>Tooten</surname><given-names>PC</given-names></name><name><surname>Cornelissen</surname><given-names>PW</given-names></name><name><surname>Toussaint</surname><given-names>MJ</given-names></name><name><surname>Lamers</surname><given-names>WH</given-names></name><name><surname>de Bruin</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>E2F8 is essential for polyploidization in mammalian cells</article-title><source>Nature Cell Biology</source><volume>14</volume><fpage>1181</fpage><lpage>1191</lpage><pub-id pub-id-type="doi">10.1038/ncb2585</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pecot</surname><given-names>T</given-names></name><name><surname>Singh</surname><given-names>S</given-names></name><name><surname>Caserta</surname><given-names>E</given-names></name><name><surname>Huang</surname><given-names>K</given-names></name><name><surname>Machiraju</surname><given-names>R</given-names></name><name><surname>Leone</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Non parametric cell nuclei segmentation based on a tracking over depth from 3d fluorescence confocal images</article-title><source>9th Ieee International Symposium on Biomedical Imaging (Isbi)</source><fpage>170</fpage><lpage>173</lpage></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peng</surname><given-names>H</given-names></name><name><surname>Ruan</surname><given-names>Z</given-names></name><name><surname>Long</surname><given-names>F</given-names></name><name><surname>Simpson</surname><given-names>JH</given-names></name><name><surname>Myers</surname><given-names>EW</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>V3D enables real-time 3D visualization and quantitative analysis of large-scale biological image data sets</article-title><source>Nature Biotechnology</source><volume>28</volume><fpage>348</fpage><lpage>353</lpage><pub-id pub-id-type="doi">10.1038/nbt.1612</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Powers</surname><given-names>DMW</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Evaluation: from precision, recall and f-factor to roc, informedne, markedness &amp; correlation</article-title><source>Journal of Machine Learning Technologies</source><volume>2</volume><fpage>37</fpage></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Preibisch</surname><given-names>S</given-names></name><name><surname>Saalfeld</surname><given-names>S</given-names></name><name><surname>Tomancak</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Globally optimal stitching of tiled 3D microscopic image acquisitions</article-title><source>Bioinformatics</source><volume>25</volume><fpage>1463</fpage><lpage>1465</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btp184</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rasch</surname><given-names>R</given-names></name><name><surname>Dørup</surname><given-names>J</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Quantitative morphology of the rat kidney during diabetes mellitus and insulin treatment</article-title><source>Diabetologia</source><volume>40</volume><fpage>802</fpage><lpage>809</lpage><pub-id pub-id-type="doi">10.1007/s001250050752</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ray</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Developmental biology: on the origin of liver regeneration</article-title><source>Nature Reviews Gastroenterology &amp; Hepatology</source><volume>12</volume><fpage>549</fpage><pub-id pub-id-type="doi">10.1038/nrgastro.2015.147</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saalfeld</surname><given-names>S</given-names></name><name><surname>Fetter</surname><given-names>R</given-names></name><name><surname>Cardona</surname><given-names>A</given-names></name><name><surname>Tomancak</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Elastic volume reconstruction from series of ultra-thin microscopy sections</article-title><source>Nature Methods</source><volume>9</volume><fpage>717</fpage><lpage>720</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2072</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sbalzarini</surname><given-names>IF</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Modeling and simulation of biological systems from image data</article-title><source>BioEssays : News and Reviews in Molecular, Cellular and Developmental Biology</source><volume>35</volume><fpage>482</fpage><lpage>490</lpage><pub-id pub-id-type="doi">10.1002/bies.201200051</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Sivia</surname><given-names>DS</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Dealing with duff data </article-title><conf-name><italic>MAXENT96 - Proceedings of the Maximum Entropy Conference</italic></conf-name></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>N</given-names></name><name><surname>Waters</surname><given-names>S</given-names></name><name><surname>Hunter</surname><given-names>P</given-names></name><name><surname>Clayton</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The cardiac physiome: foundations and future prospects for mathematical modelling of the heart</article-title><source>Progress in Biophysics and Molecular Biology</source><volume>104</volume><fpage>1</fpage><pub-id pub-id-type="doi">10.1016/j.pbiomolbio.2010.12.006</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stegmaier</surname><given-names>J</given-names></name><name><surname>Otte</surname><given-names>JC</given-names></name><name><surname>Kobitski</surname><given-names>A</given-names></name><name><surname>Bartschat</surname><given-names>A</given-names></name><name><surname>Garcia</surname><given-names>A</given-names></name><name><surname>Nienhaus</surname><given-names>GU</given-names></name><name><surname>Strähle</surname><given-names>U</given-names></name><name><surname>Mikut</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Fast segmentation of stained nuclei in terabyte-scale, time resolved 3D microscopy image stacks</article-title><source>PloS One</source><volume>9</volume><elocation-id>e90036</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0090036</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sukumar</surname><given-names>SR</given-names></name><name><surname>Page</surname><given-names>DL</given-names></name><name><surname>Gribok</surname><given-names>AV</given-names></name><name><surname>Koschan</surname><given-names>AF</given-names></name><name><surname>Abidi</surname><given-names>MA</given-names></name><name><surname>Gorsich</surname><given-names>DJ</given-names></name><name><surname>Gerhart</surname><given-names>GR</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Surface shape description of 3D data from under vehicle inspection robot</article-title><source>Unmanned Ground Vehicle Technology Vii</source><volume>5804</volume><fpage>621</fpage><lpage>629</lpage></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>B</given-names></name><name><surname>Zhao</surname><given-names>L</given-names></name><name><surname>Fish</surname><given-names>M</given-names></name><name><surname>Logan</surname><given-names>CY</given-names></name><name><surname>Nusse</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Self-renewing diploid Axin2(+) cells fuel homeostatic renewal of the liver</article-title><source>Nature</source><volume>524</volume><fpage>180</fpage><lpage>185</lpage><pub-id pub-id-type="doi">10.1038/nature14863</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wisse</surname><given-names>E</given-names></name><name><surname>De Zanger</surname><given-names>RB</given-names></name><name><surname>Charels</surname><given-names>K</given-names></name><name><surname>Van Der Smissen</surname><given-names>P</given-names></name><name><surname>McCuskey</surname><given-names>RS</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>The liver sieve: considerations concerning the structure and function of endothelial fenestrae, the sinusoidal wall and the space of disse</article-title><source>Hepatology</source><volume>5</volume><fpage>683</fpage><lpage>692</lpage><pub-id pub-id-type="doi">10.1002/hep.1840050427</pub-id></element-citation></ref><ref id="bib90"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolberg</surname><given-names>G</given-names></name><name><surname>Zokai</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Robust image registration using log-polar transform</article-title><source>International Conference on Image Processing, Vol 1, Proceedings</source><fpage>493</fpage><lpage>496</lpage></element-citation></ref><ref id="bib91"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xing</surname><given-names>YG</given-names></name><name><surname>Lawrence</surname><given-names>JB</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>Preservation of specific RNA distribution within the chromatin-depleted nuclear substructure demonstrated by in situ hybridization coupled with biochemical fractionation</article-title><source>The Journal of Cell Biology</source><volume>112</volume><fpage>1055</fpage><lpage>1063</lpage><pub-id pub-id-type="doi">10.1083/jcb.112.6.1055</pub-id></element-citation></ref><ref id="bib92"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zaret</surname><given-names>KS</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Regenerative biology: maintaining liver mass</article-title><source>Nature</source><volume>524</volume><fpage>165</fpage><lpage>166</lpage><pub-id pub-id-type="doi">10.1038/nature15201</pub-id></element-citation></ref><ref id="bib93"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>H</given-names></name><name><surname>Darzynkiewicz</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Biomarkers of cell senescence assessed by imaging cytometry</article-title><source>Methods in Molecular Biology</source><volume>965</volume><fpage>83</fpage><lpage>92</lpage><pub-id pub-id-type="doi">10.1007/978-1-62703-239-1_5</pub-id></element-citation></ref></ref-list></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.11214.038</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Watt</surname><given-names>Fiona M</given-names></name><role>Reviewing editor</role><aff id="aff5"><institution>King's College London</institution>, <country>United Kingdom</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your work entitled &quot;A versatile pipeline for the multi-scale digital reconstruction and quantitative analysis of 3D tissue architecture&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by two peer reviewers, and the evaluation has been overseen by Fiona Watt as the Senior Editor. One of the two reviewers has agreed to reveal his identity: Gaudenz Danuser.</p><p>The reviewers have discussed the reviews with one another and the editor has drafted this decision to help you prepare a revised submission.</p><p>The reviewers were very positive about your manuscript and would like to see it published in <italic>eLife</italic>. While the complexity of the synthetic data is appreciably lower than the experimental data, these simulations challenge the image analysis pipeline in a relevant way. Using these simulations as a test set for such algorithms is going to be helpful. We would even suggest that you make the code and parameter files available that generate these volumes for other labs to generate systematic other test data sets.</p><p>One concern we have is that the manuscript should be re-written to make it easier to follow. The main text should describe in broad strokes the necessary image analysis steps to a fairly naive audience. Currently, there is a large fluctuation in the level of detail – sometimes, unnecessary information is highlighted in the main text, whereas other, important, concepts are left out. The authors should then discuss the strengths and source of failures of the chosen approaches. For a resource article the failures are as interesting as the successes.</p><p>The authors should also avoid claims of exclusivity as much as possible. Individually, none of the image processing steps is out of the ordinary. The authors' achievement is to combine all the steps together into a working system. That said, the authors have failed to cite recent papers that address some of the same aspects. For example, it would be interesting to compare the recent work on nucleus segmentation with work published by Philip Keller's lab or Gaudenz Danuser's lab, and discuss Sean Megason's work on cell segmentation in 3D.</p><p>A second area of concern is the comparison of the new methods to other liver tissue reconstructions. The authors claim that substantial differences between the present and cited work originate in the advances of the image analysis algorithms. However, is this really the case? Could this not be due to differences in the tissue fixation or image acquisition? Some of the cited references are fairly recent. This might offer an excellent opportunity to apply the new image analysis pipeline to data that has been analyzed by other means. Such validation would be necessary to support the statement that 'in comparison with most recent previous reports, our model therefore provides a more precise estimation of the geometrical characteristics of sinusoidal and BC networks.'</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.11214.039</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p><italic>The reviewers were very positive about your manuscript and would like to see it published in eLife. While the complexity of the synthetic data is appreciably lower than the experimental data, these simulations challenge the image analysis pipeline in a relevant way. Using these simulations as a test set for such algorithms is going to be helpful. We would even suggest that you make the code and parameter files available that generate these volumes for other labs to generate systematic other test data sets.</italic></p><p>We thank the reviewers for this suggestion and included all necessary functions and scripts (scripts_image_generation.zip) for the generation of synthetic images as part of the MotionTracking (MT) software.</p><p><italic>One concern we have is that the manuscript should be re-written to make it easier to follow. The main text should describe in broad strokes the necessary image analysis steps to a fairly naive audience. Currently, there is a large fluctuation in the level of detail – sometimes, unnecessary information is highlighted in the main text, whereas other, important, concepts are left out. The authors should then discuss the strengths and source of failures of the chosen approaches. For a resource article the failures are as interesting as the successes.</italic></p><p>We modified the text and especially re-wrote the Results section to make it clearer and easier to follow. We added descriptions of general concepts as well as justifications for the use of the specific features of our pipeline. Specific technical details were moved to the Methods section.</p><p><italic>The authors should also avoid claims of exclusivity as much as possible. Individually, none of the image processing steps is out of the ordinary. The authors' achievement is to combine all the steps together into a working system. That said, the authors have failed to cite recent papers that address some of the same aspects. For example, it would be interesting to compare the recent work on nucleus segmentation with work published by Philip Keller's lab or Gaudenz Danuser's lab, and discuss Sean Megason's work on cell segmentation in 3D.</italic></p><p>We modified the text to avoid misunderstandings about claims of exclusivity. We now cite the published work, compare the results with ours and discuss recent work on nucleus and cell segmentation (Results, end of the subsection “3D image segmentation and active mesh tuning for the accurate reconstruction of tubular networks (sinusoids and BC) and nuclei”; Discussion, fourth paragraph; and Results, subsection “Cell classification and reconstruction”, last paragraph).</p><p><italic>A second area of concern is the comparison of the new methods to other liver tissue reconstructions. The authors claim that substantial differences between the present and cited work originate in the advances of the image analysis algorithms. However, is this really the case? Could this not be due to differences in the tissue fixation or image acquisition? Some of the cited references are fairly recent. This might offer an excellent opportunity to apply the new image analysis pipeline to data that has been analyzed by other means. Such validation would be necessary to support the statement that 'in comparison with most recent previous reports, our model therefore provides a more precise estimation of the geometrical characteristics of sinusoidal and BC networks.'</italic></p><p>We agree with the reviewers that the differences between our results and others on liver reconstruction could be due to not only differences in the image processing but also sample preparation and image acquisition. We moved this comparison from the Results section to the Discussion section (fifth paragraph) and expanded it. We applied our pipeline to a publicly available dataset (TiQuant: <ext-link ext-link-type="uri" xlink:href="http://ms.izbi.uni-leipzig.de/index.php/software">http://ms.izbi.uni-leipzig.de/index.php/software</ext-link>) (Hammad et al., 2014, Friebel et al., 2015). As shown in the <xref ref-type="fig" rid="fig7">Author response image 1</xref>, our pipeline produces qualitatively more accurate segmentations than previous studies by others. In particular, our radius estimation for the sinusoidal network is closer to the values reported from EM data.<fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.11214.035</object-id><label>Author response image 1.</label><caption><title>Comparison of our pipeline with TiQuant (Hammad et al., 2014, Friebel et al., 2015) applied on the reconstruction of liver tissue.</title><p>Our image analysis pipeline (MT) was applied on the dataset provided as a test for TiQuant ( <ext-link ext-link-type="uri" xlink:href="http://ms.izbi.unileipzig.de/index.php/software">http://ms.izbi.uni-leipzig.de/index.php/software</ext-link>). Panel (<bold>A</bold>) shows single 2D plane sections of a liver tissue image stained for sinusoids (magenta), whereas the segmentation generated by TiQuant (provided within the dataset) is shown as a partially transparent (green) image overlapping with the original one. Our reconstructions are shown as object contours (magenta lines). Panel (<bold>B</bold>) shows the radius distributions of the sinusoidal network extracted from reconstructions provided by TiQuant (red) and generated by the MT pipeline (blue). The estimated value of the radius is expressed in voxels since no information about the voxel size is provided. Each histogram was fit by a Gaussian distribution (with mean 14.08 and 11.00, for TiQuant and MT, respectively). The dots correspond to the extracted data and the solid lines to the corresponding fits. Our active mesh tuning approach yielded radius estimation for the sinusoidal network ~20% smaller than the voxel-based methods of TiQuant. These results are in line with the ones obtained from our experimental data.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11214.035">http://dx.doi.org/10.7554/eLife.11214.035</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11214-resp-fig1-v2.tif"/></fig></p></body></sub-article></article>