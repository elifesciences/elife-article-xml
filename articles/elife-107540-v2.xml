<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN"  "JATS-archivearticle1-3-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">107540</article-id><article-id pub-id-type="doi">10.7554/eLife.107540</article-id><article-id pub-id-type="doi" specific-use="version">10.7554/eLife.107540.3</article-id><article-version article-version-type="publication-state">version of record</article-version><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Longitudinal tracking of neuronal activity from the same cells in the developing brain using Track2p</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><name><surname>Majnik</surname><given-names>Jure</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0009-0005-6296-3659</contrib-id><email>jure.majnik@inserm.fr</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Mantez</surname><given-names>Manon</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0009-0000-6376-9704</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Zangila</surname><given-names>Sofia</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0009-0002-4378-2797</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Bugeon</surname><given-names>Stéphane</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Guignard</surname><given-names>Léo</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-3686-1385</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" equal-contrib="yes"><name><surname>Platel</surname><given-names>Jean-Claude</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-5542-3076</contrib-id><email>jean-claude.platel@inserm.fr</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" equal-contrib="yes"><name><surname>Cossart</surname><given-names>Rosa</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2111-6638</contrib-id><email>rosa.cossart@inserm.fr</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="fn1">‡</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund4"/><xref ref-type="other" rid="fund5"/><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/035xkbk20</institution-id><institution>Aix-Marseille Université, Inserm, INMED, Turing Center for Living Systems</institution></institution-wrap><addr-line><named-content content-type="city">Marseille</named-content></addr-line><country>France</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/035xkbk20</institution-id><institution>Aix-Marseille Université, CNRS, IBDM, UMR7288, Turing Centre for Living Systems</institution></institution-wrap><addr-line><named-content content-type="city">Marseille</named-content></addr-line><country>France</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Petreanu</surname><given-names>Leopoldo</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03g001n57</institution-id><institution>Champalimaud Center for the Unknown</institution></institution-wrap><country>Portugal</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Huguenard</surname><given-names>John R</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00f54p054</institution-id><institution>Stanford University School of Medicine</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn><fn fn-type="other" id="fn1"><label>‡</label><p>Lead contact</p></fn></author-notes><pub-date publication-format="electronic" date-type="publication"><day>10</day><month>12</month><year>2025</year></pub-date><volume>14</volume><elocation-id>RP107540</elocation-id><history><date date-type="sent-for-review" iso-8601-date="2025-05-13"><day>13</day><month>05</month><year>2025</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint.</event-desc><date date-type="preprint" iso-8601-date="2025-03-01"><day>01</day><month>03</month><year>2025</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2025.02.26.640367"/></event><event><event-desc>This manuscript was published as a reviewed preprint.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2025-07-09"><day>09</day><month>07</month><year>2025</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.107540.1"/></event><event><event-desc>The reviewed preprint was revised.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2025-10-27"><day>27</day><month>10</month><year>2025</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.107540.2"/></event></pub-history><permissions><copyright-statement>© 2025, Majnik et al</copyright-statement><copyright-year>2025</copyright-year><copyright-holder>Majnik et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-107540-v2.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-107540-figures-v2.pdf"/><related-article related-article-type="commentary" ext-link-type="doi" xlink:href="10.7554/eLife.109627" id="ra1"/><abstract><p>Understanding cortical circuit development requires tracking neuronal activity across days in the growing brain. While in vivo calcium imaging now enables such longitudinal studies, automated tools for reliably tracking large populations of neurons across sessions remain limited. Here, we present a novel cell tracking method based on sequential image registration, validated on calcium imaging data from the barrel cortex of mouse pups over 1 postnatal week. Our approach enables robust long-term analysis of several hundreds of individual neurons, allowing quantification of neuronal dynamics and representational stability over time. Using this method, we identified a key developmental transition in neuronal activity statistics, marking the emergence of arousal state modulation. Beyond this key finding, our method provides an essential tool for tracking developmental trajectories of individual neurons, which could help identify potential deviations associated with neurodevelopmental disorders.</p></abstract><abstract abstract-type="plain-language-summary"><title>eLife digest</title><p>In the weeks and months after birth, the brain experiences rapid growth and restructuring through carefully timed developmental sequences. These processes rely heavily on coordinated neuronal activity for the brain to develop healthily.</p><p>Understanding these processes requires recording neural activity from the same cells across different stages of development. However, this has proven technically challenging because both the anatomy and cellular organization of the brain change dramatically during early life.</p><p>Two-photon calcium imaging, which uses fluorescent markers to visualize neuronal activity in living animals, has emerged as a powerful method for studying neural circuits. In adult animals, automated techniques can track large neuronal populations across days. However, the rapid brain growth and morphological changes during development make it difficult to track neurons during this stage. Recording from the same developing neurons would provide a more dynamic view of healthy brain maturation and reveal how it diverges in neurodevelopmental conditions.</p><p>Majnik et al. investigated whether it was possible to automatically and reliably track the same neurons across consecutive days during early postnatal development of mice. They developed Track2p, an open-source algorithm that can track developing neurons across days using a two-step procedure. It first corrects for brain growth using image registration and then matches neurons across days using this growth-corrected alignment.</p><p>Applying Track2p to calcium imaging data from the mouse barrel cortex during the second postnatal week, Majnik et al. found that the algorithm robustly tracked hundreds of neurons despite substantial brain growth. Benchmarking against manually tracked neurons confirmed high accuracy. Analysis of the tracked population’s activity properties revealed an increase in overall activity rates and a decrease in firing synchrony. Moreover, around postnatal day 11, neuronal activity patterns shifted from highly synchronized and spatially organized population events to more decorrelated, behavior-dependent firing.</p><p>Majnik et al. demonstrate that Track2p overcomes key technical barriers and reveal new principles of early postnatal brain maturation. The tool enables longitudinal analysis of neural circuits, allowing researchers to measure how individual neurons develop over time. Tracking cells across days will be particularly useful for understanding how genetic mutations or environmental factors influence developmental trajectories. Beyond development, Track2p can also examine long-term properties of adult circuits, such as learning or representational stability. Ultimately, applying Track2p to disease models may identify early circuit-level biomarkers of neurodevelopmental disorders.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>cell tracking</kwd><kwd>calcium imaging</kwd><kwd>development</kwd><kwd>neocortex</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Mouse</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0472cxd90</institution-id><institution>European Research Council</institution></institution-wrap></funding-source><award-id>951330</award-id><principal-award-recipient><name><surname>Cossart</surname><given-names>Rosa</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02p3abx23</institution-id><institution>Fondation Bettencourt Schueller</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Cossart</surname><given-names>Rosa</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01d4wwv56</institution-id><institution>Fondation Roger de Spoelberch</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Cossart</surname><given-names>Rosa</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00rbzpz17</institution-id><institution>Agence Nationale de la Recherche</institution></institution-wrap></funding-source><award-id>ANR-16-CONV000X / ANR-17-EURE-0029</award-id><principal-award-recipient><name><surname>Cossart</surname><given-names>Rosa</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="ror">https://ror.org/035xkbk20</institution-id><institution>Aix-Marseille Université</institution></institution-wrap></funding-source><award-id>A*MIDEX (AMX-19-IET-004)</award-id><principal-award-recipient><name><surname>Cossart</surname><given-names>Rosa</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A novel algorithm allowed for the continuous tracking of neurons throughout early postnatal development, revealing a transition in neural firing statistics coinciding with the onset of behaviour-dependent activity.</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>publishing-route</meta-name><meta-value>prc</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Early postnatal development in rodents is a period of intense circuit wiring and remodelling at several scales through various major processes that include neuronal growth, synaptogenesis, apoptosis, migration, rise of intracortical connectivity, functional maturation of inhibitory synapses, and the disappearance of transient connectivity schemes (<xref ref-type="bibr" rid="bib12">Cossart and Garel, 2022</xref>; <xref ref-type="bibr" rid="bib39">Molnár et al., 2020</xref>; <xref ref-type="bibr" rid="bib5">Blankenship and Feller, 2010</xref>; <xref ref-type="bibr" rid="bib47">Reh et al., 2020</xref>). Critical periods for various sensory systems open and close during this time, further highlighting the profound reshaping of cortical networks (<xref ref-type="bibr" rid="bib47">Reh et al., 2020</xref>). This developmental period of remodelling is crucial for establishing the functional architecture of the mature cortex. Most importantly, all of these developmental processes are activity-dependent, with collective dynamics playing a critical role in the proper integration of neurons into functional networks (<xref ref-type="bibr" rid="bib67">Wu et al., 2024</xref>). These network dynamics sequentially unfold while relying on different mechanisms and circuits for their generation (<xref ref-type="bibr" rid="bib12">Cossart and Garel, 2022</xref>; <xref ref-type="bibr" rid="bib67">Wu et al., 2024</xref>). The emergence of functional brain circuits during development is therefore a precisely timed choreography, the timing of which is inherently tied to the age of the organism under study.</p><p>However, developmental age lacks precision due to significant variations in physical characteristics and growth patterns, even among offspring from the same genetic lineage (<xref ref-type="fig" rid="fig1">Figure 1</xref>). Hence, longitudinal imaging from the same animal across days is the optimal solution to better capture the evolution of circuit dynamics during development. Additionally, developmental variability extends beyond the organism level, becoming even more pronounced at the single neuron level (<xref ref-type="fig" rid="fig1">Figure 1</xref>). While population-level descriptions of cortical circuit development are crucial, individual neurons exhibit unique developmental trajectories rooted in their specific origin, birth timing, and cellular identity (<xref ref-type="bibr" rid="bib12">Cossart and Garel, 2022</xref>). In addition, the singular dynamics of sparse individual neurons can matter, as demonstrated for the rare hub cells (<xref ref-type="bibr" rid="bib7">Bollmann et al., 2023</xref>; <xref ref-type="bibr" rid="bib65">Wang et al., 2024</xref>). Thus, in order to fully understand the circuit basis of cortical development in health and disease, it is crucial to track neuronal activity at both population and individual cell levels in the growing brain of the same animal. This hurdle spans both experimental methodology and data analysis.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Tracking developmental trajectories at the organismal and cellular level.</title><p>Postnatal development in mammals is not a strictly stereotyped process (left) but rather shows variability across individual organisms, as well as across individual cells of the same organism (right). Performing an acute experiment (dashed grey line) only provides a single snapshot of the developmental trajectory of an individual organism (or cell). Alternatively, a longitudinal experiment (grey arrow) allows tracking the properties of the same individual (or cell) throughout development, which is especially important in the case of variability in developmental trajectories (right).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-107540-fig1-v2.tif"/></fig><p>Significant progress has been made over the recent years to develop innovative solutions to meet this challenge on the experimental side, using two-photon calcium imaging. Technical improvements included modified head plates and specialised surgical and care protocols (<xref ref-type="bibr" rid="bib7">Bollmann et al., 2023</xref>; <xref ref-type="bibr" rid="bib8">Che and De Marco García, 2021</xref>; <xref ref-type="bibr" rid="bib18">Duan et al., 2020</xref>; <xref ref-type="bibr" rid="bib66">Wong et al., 2018</xref>; <xref ref-type="bibr" rid="bib23">He et al., 2018</xref>; <xref ref-type="bibr" rid="bib36">Modol et al., 2020</xref>). Still, in many cases, different neurons from the same mouse were recorded at different ages, or the tracking of individual cells could only be achieved through visual inspection and manual annotation of relatively sparse, often genetically subscribed neuronal populations expressing a calcium fluorescent reporter. The gold standard for developmental circuit analysis would be automated tracking of densely labelled neuronal populations, enabling efficient longitudinal monitoring while eliminating the burden of manual cell tracking. An algorithm capable of accurate automatic tracking of the same neurons across multiple days of brain development is thus essential.</p><p>Methods for tracking the activity of large populations of cells across days have been successfully developed and deployed in the adult brain (<xref ref-type="bibr" rid="bib63">van Beest et al., 2025</xref>; <xref ref-type="bibr" rid="bib27">Lee et al., 2020</xref>; <xref ref-type="bibr" rid="bib68">Ziv et al., 2013</xref>; <xref ref-type="bibr" rid="bib25">Johnston et al., 2022</xref>). In adult circuits, cell tracking is indeed relatively straightforward due to their structural stability, with minimal tissue growth, negligible morphological changes, and constant numbers of neurons. In contrast, the first weeks of mouse neocortical development are characterised by rapid and critical developmental changes spanning several scales from synapses to single neurons and networks. These include extensive brain growth (<xref ref-type="bibr" rid="bib30">Lyck et al., 2007</xref>; <xref ref-type="bibr" rid="bib57">Thompson et al., 2014</xref>), substantial morphological changes (<xref ref-type="bibr" rid="bib40">Nakazawa et al., 2018</xref>), as well as changes to cell numbers due to programmed cell death (<xref ref-type="bibr" rid="bib66">Wong et al., 2018</xref>). This makes tracking the same cells across sessions substantially more difficult during development compared to the adult brain.</p><p>To overcome the technical limitations detailed above, we developed an experimental protocol using chronic calcium imaging in mice and a novel cell tracking algorithm (Track2p), specifically tailored to development. This allowed us to track the activity of large, densely labelled, populations of neurons during early postnatal development, which has not been possible before. The algorithm overcomes the challenges of cell tracking during brain growth by applying sequential registration and cell matching steps, using the spatial overlap of cells on adjacent recordings as a matching criterion. Track2p is freely available as an open-source package with an interactive graphical user interface (GUI), enabling researchers to analyse longitudinal calcium imaging data from both developing and mature circuits.</p><p>Applying the algorithm to a dataset recorded during the second postnatal week in mouse barrel cortex, a critical period for the formation of topographic maps in that region, yielded hundreds of identified neurons tracked across all days. Assessing the quality of the algorithm by benchmarking it on a newly generated ground truth dataset showed high tracking performance (<xref ref-type="bibr" rid="bib50">Sheintuch et al., 2017</xref>). Leveraging ground truth benchmarking, we demonstrate that explicitly accounting for developmental processes, such as brain growth, is critical for accurately tracking cells during postnatal development. Our work thus shows that chronic calcium imaging and cell tracking using Track2p can be used to monitor the changing physiological properties of large populations of matched neurons during early cortical development. We demonstrate that the statistics of activity patterns in the tracked population display two periods of stability, with a critical transition point around postnatal day 11 (P11), marking the emergence of a stable behavioural state representation.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Cell tracking using image registration and overlap-based matching</title><p>Tracking neuronal activity across multiple days presents unique challenges due to the dynamic nature of brain development. We developed a novel tracking algorithm, called Track2p. As in other tracking algorithms for calcium imaging data (<xref ref-type="bibr" rid="bib63">van Beest et al., 2025</xref>; <xref ref-type="bibr" rid="bib25">Johnston et al., 2022</xref>; <xref ref-type="bibr" rid="bib60">Tolu et al., 2010</xref>), the final goal of Track2p is to follow individual cells across sessions allowing the user to compare their functional properties in downstream analyses. To achieve this goal, the algorithm takes as input a set of preprocessed recordings, each consisting of a set of regions of interest (ROIs, i.e. putative neurons detected based on activity, see Methods) and their respective calcium fluorescence traces, as well as a mean image of the field of view (FOV). Briefly, the algorithm aims to match ROIs in any given pair of consecutive sessions based on their spatial overlap, assuming that the more the two overlap in anatomical space, the more likely they correspond to the same neuron. Due to developmental processes such as brain growth and other experimental factors, it is necessary to account for day-to-day changes that occur between the two recordings before computing spatial overlaps. This is achieved by performing affine image registration on the mean FOV images between consecutive days.</p><p>We apply the registration and spatial matching iteratively, starting with the first pair of sessions (s<sub>0</sub> and s<sub>1</sub>) as follows (<xref ref-type="fig" rid="fig2">Figure 2A</xref>).</p><p>Firstly, we estimate the spatial transformation between s<sub>0</sub> and s<sub>1</sub> using affine image registration (<xref ref-type="bibr" rid="bib42">Ntatsis et al., 2023</xref>) (i.e. allowing shifting, rotation, scaling, and shearing, see <xref ref-type="fig" rid="fig2">Figure 2B</xref>, the transformation is denoted as T). We employ affine transformation, since it can account for both rigid transformations (rotations and translations arising from minor mismatches in FOV alignment across experiments) and scaling and shearing (mostly due to brain growth). The changes across the two consecutive recordings are approximated as the transformation registering the mean FOV from session s<sub>1</sub> (green in <xref ref-type="fig" rid="fig2">Figure 2B</xref>) to the mean FOV of s<sub>0</sub> serving as reference (red in <xref ref-type="fig" rid="fig2">Figure 2B</xref>).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>The Track2p pipeline for tracking cells across recordings.</title><p>(<bold>A</bold>) Schematic overview of the Track2p algorithm and the graphical user interface (GUI) capabilities. Dashed squares represent optional steps in the pipeline. (<bold>B</bold>) The transformation (<bold>T</bold>) between 2 consecutive days is computed by registering the mean field of view (FOV) images. Top: An overlay of the reference (red, s<sub>0</sub>) and the moving (green, s<sub>1</sub>) images before registration. Bottom: Same two images after registration. Scale bar: 50 μm. (<bold>C</bold>) Applying the transform to regions of interest (ROIs) from Suite2p segmentation. The ROI colour code is the same as in B, the intersection of the ROIs is shown in yellow. Top: Overlap before T. Bottom: Overlap after T. Note: Only a few example ROIs are displayed for explanation purposes. (<bold>D</bold>) Cell matching using linear sum assignment. ROIs are the same as C with indexes for the two recordings added for illustrative purposes. Cells from one recording are matched to cells from another, maximising the sum of the intersection over union (IoU) across all matches. (<bold>E</bold>) Filtering putative false and true matches by thresholding the IoU distribution. Top: The distribution of IoU values for matched ROI pairs shows a bimodal distribution, which is used to reject putative false positive matches. Bottom: Final result of the cell linking for a pair of recordings. (<bold>F</bold>) Top: In the case of tracking across more than two imaging sessions, the steps from B to D are repeated sequentially to link the cells across all days. Bottom: Example matches for five cells (rows) successfully tracked across 5 consecutive days (columns). Note: The figures shown are for illustrative purposes only; see <xref ref-type="fig" rid="fig3">Figure 3</xref> for application to real data.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-107540-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Overview of the graphical user interface for interactive visualisation and curation of tracked cells.</title><p>(<bold>A</bold>) The menu bar allows the users to run the Track2p algorithm (under ‘Run’), import the results of a previous run (under ‘File’), or to visualise population activity (under ‘Visualisation’; opens the raster window in F). (<bold>B</bold>) The interface displays the mean image for each day of the recording (the channel can be chosen by the user), with regions of interest (ROIs) of the cells tracked across all days overlaid. This plot allows the user to select which cell to visualise across days. This visualisation corresponds to <xref ref-type="fig" rid="fig3">Figure 3D</xref>. (<bold>C</bold>) Once a cell is selected, this section provides a high-magnification image of the field of view (FOV) for all days. Underneath each high-magnification image, the Suite2p index on that day (<bold>i</bold>) and the Suite2p cell probability (<bold>p</bold>) are displayed. This visualisation corresponds to <xref ref-type="fig" rid="fig2">Figure 2E</xref>. (<bold>D</bold>) The activity traces are presented in order from the first (top) to the last (bottom) session of the tracking. (The type of traces can be chosen by the user.) (<bold>E</bold>) Curation bar on the bottom of the window allows browsing all tracked cells to perform the manual curation. If a track is considered faulty during the manual inspection, its state can be set to zero (by clicking on the cross). (The ‘Apply curation’ is used to update the FOV visualisations by colouring all contours of tracks assigned as bad in white.) (<bold>F</bold>) Raster visualisation window allows the users to visualise the time series of the whole population and sort the rasters to show population-level features and their stability across days.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-107540-fig2-figsupp1-v2.tif"/></fig></fig-group><p>Secondly, the computed transformation is applied to the ROIs from session s<sub>1</sub> (green in <xref ref-type="fig" rid="fig2">Figure 2C</xref>) to align them to ROIs from session s<sub>0</sub> (red in <xref ref-type="fig" rid="fig2">Figure 2C</xref>). The amount of spatial overlap after registration (yellow in <xref ref-type="fig" rid="fig2">Figure 2C</xref>, bottom) can indicate the accuracy of the estimated transformation between the 2 days. Assuming that the transformation is accurately estimated, ROIs corresponding to the same cells display substantial spatial overlap, with some ROIs from one recording also potentially overlapping poorly, if not at all, with any ROI from another.</p><p>Thirdly, once the ROIs are aligned, the algorithm proceeds with the matching (<xref ref-type="fig" rid="fig2">Figure 2D</xref>). This is done by computing a spatial similarity metric (intersection over union [IoU]) between each ROI from session s<sub>0</sub> and each transformed ROI from session s<sub>1</sub>. Matches are then assigned in a globally optimal way by maximising the sum of IoU values across all matches using a linear sum assignment algorithm (<xref ref-type="bibr" rid="bib13">Crouse, 2016</xref>).</p><p>Finally, since two consecutive sessions contain different sets of detected cells (see * in <xref ref-type="fig" rid="fig2">Figure 2D</xref>, bottom) and since ROIs can overlap even if the signal does not come from the same cells (see + in <xref ref-type="fig" rid="fig2">Figure 2D</xref>, bottom), we perform an additional filtering step on the assigned matches. Assuming that the IoU values for putative true and putative false matches come from different distributions, we would expect a bimodal distribution of IoU values across all assigned matches (see histogram in <xref ref-type="fig" rid="fig2">Figure 2E</xref>). To reject the putative false positives, we compute a threshold based on automatic thresholding methods (Otsu’s method; <xref ref-type="bibr" rid="bib62">Ulman et al., 2017</xref>). This ensures that assigned matches with low spatial similarity are rejected (see + in <xref ref-type="fig" rid="fig2">Figure 2D and E</xref>) while the matches with high similarity are accepted (see x in <xref ref-type="fig" rid="fig2">Figure 2D and E</xref>). This yields the final matching for the first pair of consecutive imaging sessions (s<sub>0</sub> and s<sub>1</sub>). In the case of more than two recordings, this tracking procedure is then iteratively applied for all consecutive pairs of sessions (s<sub>0</sub> to s<sub>1</sub>, s<sub>1</sub> to s<sub>2</sub> … s<sub>N-1</sub> to s<sub>N</sub>, and so on), with tracks being extended sequentially from s<sub>0</sub> to s<sub>N</sub> based on the identified matches, and terminated if a match was not identified at any particular session (<xref ref-type="fig" rid="fig2">Figure 2F</xref>).</p><p>We provide an open-source implementation of the algorithm, combined with a user-friendly GUI, allowing non-specialist users to run the algorithm and interact with its outputs (see <xref ref-type="fig" rid="fig2">Figure 2A</xref> top, <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>, and Appendix 1). Both the algorithm and the GUI come with a simple installation procedure and extensive documentation to facilitate the ease of use and accessibility of Track2p.</p></sec><sec id="s2-2"><title>Tracking neurons across days in the early postnatal neocortex</title><p>In order to validate our method on experimental data, we next applied Track2p to a longitudinal dataset consisting of daily recordings of the same 720×720 μm<sup>2</sup> FOV throughout the second postnatal week of mouse barrel cortex development (P8 to P14, n=7 imaging sessions from one mouse; for more details, see Methods and (<xref ref-type="video" rid="video1">Video 1</xref>)) In addition to the calcium indicator (GCaMP8m), we virally expressed a sparse anatomical marker (tdTomato) targeting GABAergic neurons using conditional expression in GAD67-Cre mice (<xref ref-type="bibr" rid="bib44">Pachitariu et al., 2017</xref>). This dual-labelling strategy facilitated reliable FOV identification across sessions and provided an anatomical reference for Track2p’s initial cross-session registration and tracking (<xref ref-type="fig" rid="fig3">Figure 3</xref>, for comparison with tracking based on GCaMP8m registration, see the ‘Benchmarking on manually tracked cells’ section). Before running Track2p, each recording was preprocessed using Suite2p (<xref ref-type="bibr" rid="bib43">Otsu, 1979</xref>) for active cell detection (segmentation) and calcium fluorescence trace extraction (see Methods). The outputs of Suite2p (ROIs, traces, and FOV images) were then used as inputs to the Track2p algorithm.</p><media mimetype="video" mime-subtype="mp4" xlink:href="elife-107540-video1.mp4" id="video1"><label>Video 1.</label><caption><title>Example of videography and two-photon calcium imaging data acquired throughout the second postnatal week.</title><p>Note the substantial growth of the mouse, the development of the whisker pad, and opening of the eyes, and the loss of synchrony and spatial organisation in the calcium imaging data. For visualisation purposes, the videos were manually aligned using Fiji.</p></caption></media><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Track2p tracks hundreds of cells throughout the second postnatal week of development in the mouse neocortex despite substantial brain growth.</title><p>(<bold>A</bold>) Top left and right: Mean images of the ‘anatomical’ channel (tdTomato in GABAergic cells) for the first two imaging days (postnatal day 8 [P8] and P9). Scale bar: 100 μm. Bottom left: Overlay of the two images after registration (pseudocoloured as red and green, respectively). Bottom middle: Overlay of the regions of interest (ROIs) after registration (same colour code for P8 and P9). Bottom right: Distribution of intersection over union (IoU) values for matched pairs showing the automatic threshold (grey dashed line). (<bold>B</bold>) Same as A but for the last two imaging days (P13 and P14). (<bold>C</bold>) Nine representative examples of matches visualised in the mean ‘functional’ channel (signal from pan-neuronal GCaMP8m expression) on the first and last days of recording (P8 and P14). The blue dot indicates the centroid of the ROI. (<bold>D</bold>) Overlay of all ROIs successfully tracked across all days (N=728) on the mean ‘functional’ channel image of the first (P8, left) and last (P14, right) imaging days. Each tracked ROI is shown in the same colour across the plots. Note the expansion of the field of view (FOV) at P14 compared to P8. Scale bar: 100 μm. (<bold>E</bold>) Graph plotting the proportion (y-axis) and absolute number (grey text) of cells successfully tracked from the first day of imaging onwards. (<bold>F</bold>) Brain growth quantified as the relative increase in pairwise distances between tracked cells normalised to the first day. Grey dots represent the mean for each recording. Note: For visualisations in panels A, B, C, and D across all days, see <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-107540-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Track2p outputs across all days for the example mouse.</title><p>(<bold>A</bold>) Top: Mean field of view (FOV) of the sparse anatomical marker (tdTomato) expressed in GABAergic neurons for all days. Middle: Overlay of two neighbouring days before registration. Red: reference image, green: moving image. Bottom: Overlay after registration. (<bold>B</bold>) Histogram of intersection over union (IoU) values for all assigned region of interest (ROI) matches in each pair of subsequent recordings. Statistical threshold for filtering matches is shown with a dashed line. (<bold>C</bold>) Overlay of all ROIs successfully tracked across all days on the mean FOV image of the GCaMP8m channel for all imaging days. Each tracked ROI is shown with the same contour colour across all days.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-107540-fig3-figsupp1-v2.tif"/></fig></fig-group><p>The Track2p algorithm appeared to successfully register the mean FOV for each successive pair of imaging sessions (based on visual inspection of Track2p outputs; for the first and last pairs, see <xref ref-type="fig" rid="fig3">Figure 3A and B</xref>, bottom left; for the equivalent of <xref ref-type="fig" rid="fig3">Figure 3</xref> across all days, see <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1A</xref>). Registering the ROIs for each pair of consecutive recordings showed a great degree of overlap for the majority of ROIs (yellow area in <xref ref-type="fig" rid="fig3">Figure 3A and B</xref>, bottom). We did, however, observe several ROIs that were only present in one session from the pair, likely due to differences in cell detection and developmental factors such as growth, silencing, or cell death. When matching ROIs across sessions using spatial overlap (IoU), we would expect these ROIs to show significantly lower IoU values compared to the cells that were present in both sessions. Indeed, the IoU distribution of assigned matches revealed a bimodal distribution for each pair of imaging sessions, allowing us to use classical histogram thresholding methods (<xref ref-type="bibr" rid="bib62">Ulman et al., 2017</xref>) to clearly separate the distributions of putative true and false matches (<xref ref-type="fig" rid="fig3">Figure 3A and B</xref>, bottom right, <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1B</xref>). Propagating the putative matches yielded a total of 728 ROIs that were tracked across all days in this example mouse (out of 1988 ROIs detected in the first recording, <xref ref-type="fig" rid="fig3">Figure 3E</xref>). We used the subset of cells successfully tracked across all days for all our future analyses.</p><p>Plotting ROIs overlaid on top of the mean image of the GCaMP8m imaging channel (<xref ref-type="fig" rid="fig3">Figure 3D</xref> for contours on whole FOV, C for magnified example matches) and visually inspecting the matches using the Track2p GUI indicated excellent tracking with Track2p. These visualisations also revealed the substantial growth of the neocortex during the course of the experiment (FOV area covered by ROIs at P8 compared to P14 in <xref ref-type="fig" rid="fig3">Figure 3D</xref>), with some cells growing out of the FOV (see top and left in <xref ref-type="fig" rid="fig3">Figure 3D</xref>) and the pairwise distances between matched ROIs increasing by approximately 15% (<xref ref-type="fig" rid="fig3">Figure 3F</xref>).</p><p>Applying Track2p on an example longitudinal imaging dataset thus demonstrated that it can successfully track activity from a large number of putatively matched neurons throughout early postnatal development in mice, as confirmed by visual inspection. To assess the tracking performance in a more quantitative and objective way, we next benchmarked Track2p’s performance on manually generated ground truth for our specific experimental setting.</p></sec><sec id="s2-3"><title>Benchmarking on manually tracked cells</title><p>In order to benchmark Track2p, expert annotators manually tracked cells across sessions (similarly as in the Cell Tracking Challenge; <xref ref-type="bibr" rid="bib50">Sheintuch et al., 2017</xref>; <xref ref-type="bibr" rid="bib49">Rochefort et al., 2009</xref>). Benchmarking was performed based on a dataset from three mouse pups imaged under the same experimental conditions as described in the previous section (including the dataset shown in <xref ref-type="fig" rid="fig3">Figure 3</xref>). For each experiment, we chose 64 homogeneously distributed ROIs detected on the first day and tracked them based on visual inspection across consecutive sessions (for more details, see Methods and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). This left us with, on average, 20 neurons per experiment that we were able to manually track across all days (‘GT’ in <xref ref-type="fig" rid="fig4">Figure 4</xref>). We then proceeded to compare these to cell tracks identified by Track2p. For the purposes of evaluation, we used a fully automatic tracking procedure (without manual curation and with default Track2p parameters).</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Evaluation of tracking performance on a manually tracked ground truth dataset during the second postnatal week of development in the mouse neocortex.</title><p>(<bold>A</bold>) A schematic representation of possible cases when comparing ground truth tracks (GT, solid lines) with those reconstructed by Track2p (T2P, dashed lines). The CT metric favours perfect matches (top row) and penalises all types of mismatches (bottom four rows). (<bold>B</bold>) Graph showing the CT score for all three GT datasets across evaluated conditions. Mean CT scores of 0.93, 0.91, 0.22, and 0.00 for ‘Anatomical’, ‘Functional’, ‘Rigid’, and ‘CellReg’, respectively. Blue denotes the example mouse illustrated in <xref ref-type="fig" rid="fig3">Figure 3</xref>. (<bold>C</bold>) Proportion of fully correctly reconstructed GT traces for increasing time spans starting from postnatal day 8 (P8) for the baseline (‘Anatomical’) condition. (<bold>D, E, and F</bold>) Same as C but for the ‘Functional’, ‘Rigid’, and ‘CellReg’ conditions, respectively.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-107540-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Generating a ground truth dataset for Track2p evaluation.</title><p>(<bold>A</bold>) Overlay of regions of interest (ROIs) selected for manual tracking on top of the mean image of the GCaMP8m channel on the first day of the recording for all three datasets used in the evaluation. Blue crosses indicate an 8×8 grid of equidistant points used to select ROIs for manual tracking. Contours denote the closest ROI to each point in the grid, with the number denoting the index of this ROI in the first dataset. Green ROIs denote ROIs that were manually tracked across all days, orange shows those that could not be manually tracked in at least one of the sessions. Note that green cells show a relatively homogenous distribution across the field of view (FOV). (<bold>B</bold>) Example showing the manual tracking procedure. Left: An ROI chosen for manual tracking (index 141, green circle) visualised in the Suite2p graphical user interface (GUI) on the first day of recording (postnatal day 8 [P8]). Right: The same ROI identified manually on the next day (purple circle). Surrounding contours denote other surrounding ROIs detected on that imaging day.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-107540-fig4-figsupp1-v2.tif"/></fig></fig-group><p>Different metrics exist for evaluating cell tracking. Since we are aiming to track cells across all days, a robust cell tracking metric should reward perfect track matches with ground truth while imposing penalties for missed or incorrectly identified tracks. For this reason, we used a biologically inspired ‘complete tracks’ quality metric, which corresponds to the F1 score for completely reconstructed full tracks (we refer to this value as ‘CT’ according to <xref ref-type="bibr" rid="bib50">Sheintuch et al., 2017</xref>; <xref ref-type="bibr" rid="bib49">Rochefort et al., 2009</xref>). A CT score of 1 would correspond to perfect tracking, while a CT score of 0 would correspond to no matches or a large proportion of wrong matches (see <xref ref-type="fig" rid="fig4">Figure 4A</xref> and Methods for more details). Additionally, to assess tracking performance over time, we quantified the proportion of reconstructed ground truth tracks over progressively longer time intervals (first 2 days, first 3 days, etc. ‘Prop. correct’ in <xref ref-type="fig" rid="fig4">Figure 4C–F</xref>, see Methods). This allowed us to understand how tracking accuracy depends on the number of successive sessions, as well as at which time points the algorithm might fail to successfully track cells.</p><p>Track2p was evaluated under three different scenarios and compared to the performance of a widely used algorithm developed for longitudinal tracking in the adult brain (CellReg; <xref ref-type="bibr" rid="bib60">Tolu et al., 2010</xref>, see Methods). The initial evaluation was done using day-to-day registration based on a sparse anatomical marker (as in <xref ref-type="fig" rid="fig3">Figure 3</xref>). Calculating the CT score in this condition showed remarkably high tracking performance for all datasets (see ‘Anatomical’ in <xref ref-type="fig" rid="fig4">Figure 4B</xref>, mean CT = 0.93). To test whether a sparse marker was strictly necessary for successful tracking, we next ran the algorithm using the mean image of the GCaMP8m channel as a comparison. Interestingly, this evaluation showed a similar performance (see ‘Functional’ in <xref ref-type="fig" rid="fig4">Figure 4B</xref>, mean CT = 0.91), indicating that dense calcium indicator labelling alone can provide comparable tracking performance, eliminating the requirement for sparse anatomical labelling.</p><p>To show the importance of a method tailored to the growing brain, we next compared the baseline tracking performance with two alternative conditions: firstly, by using Track2p without explicitly accounting for day-to-day growth, performing a rigid instead of affine registration of consecutive recordings; and secondly, by comparing Track2p to CellReg tracking (<xref ref-type="bibr" rid="bib60">Tolu et al., 2010</xref>). In both scenarios, tracking performance significantly deteriorated compared to our baseline method (see ‘Rigid’ and ‘CellReg’ in <xref ref-type="fig" rid="fig4">Figure 4B</xref>, mean CT = 0.22 and CT = 0, respectively). Interestingly, however, these methods still managed to correctly reconstruct a portion of tracks across shorter age spans in certain cases (<xref ref-type="fig" rid="fig4">Figure 4E and F</xref>), with the performance dropping significantly for longer tracks in comparison to the baseline condition (<xref ref-type="fig" rid="fig4">Figure 4C and D</xref>).</p><p>These comparisons demonstrate Track2p’s robust cell tracking performance in the developing brain, maintaining high accuracy over extended periods of development. However, tracking performance certainly depends on the type of experimental data (age, model system, brain area, imaging parameters, FOV alignment, etc.), hence, we also provide additional resources and documentation (<ext-link ext-link-type="uri" xlink:href="https://track2p.github.io/home.html">https://track2p.github.io/home.html</ext-link>), allowing users to benchmark Track2p tracking for their particular use case.</p></sec><sec id="s2-4"><title>Development of firing statistics from hundreds of tracked neurons across postnatal development</title><p>Having validated the performance of cell tracking, we next analysed the development of functional properties of the tracked population of neurons across the second postnatal week of mouse barrel cortex development. For this, we used a full dataset of six mice imaged daily for a minimum of 6 consecutive days within the second postnatal week (P7 to P14, see <xref ref-type="fig" rid="fig5">Figure 5B</xref> for summary; we used this dataset for all subsequent analyses). On average, 526 (±190 std) neurons per mouse were successfully tracked across all days using Track2p, corresponding to 33% (±11% std) of the neurons detected on the first day for each mouse. Based on the high tracking performance on ground truth (see <xref ref-type="fig" rid="fig4">Figure 4</xref>), we conclude that this drop is due to a failure in detection rather than tracking. During the course of the experiment, the weight of a mouse increased on average by 55% (±18% std), with the pairwise distance between neurons increasing on average by 15% (±7% std) (<xref ref-type="fig" rid="fig5">Figure 5C</xref>, <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2F</xref>). Weight was found to vary significantly across mice, as early as the first experimental day, and to correlate with brain growth (r=0.92, <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2F</xref>). Our robust tracking capability provides a comprehensive view of the evolution of neuronal dynamics within single mice, while also allowing us to take into account the heterogeneity of the developmental timelines across mice.</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Evolution of neuronal activity statistics from hundreds of tracked neurons during the second postnatal week of mouse development.</title><p>(<bold>A</bold>) Raster plots showing the activity of all 728 tracked neurons as a function of time for the example mouse at postnatal day 8 (P8) (top) and P14 (bottom). Each row in the raster corresponds to the trace of a single cell with the sorting determined by their Rastermap embedding computed at P14. Grey traces underneath the raster show a metric of global motion of the mouse computed from videography (see Methods). (<bold>B</bold>) Overview of the dataset, indicating the imaging days for each mouse (left), the total number of cells successfully tracked across all recording days (N cells, right); * indicates mice used in the evaluation of the algorithm (<xref ref-type="fig" rid="fig3">Figure 3</xref>); blue denotes the example mouse. % cells: N cells as a proportion of all cells detected on the first day. (<bold>C</bold>) Graphs plotting mouse weight (left) and the mean pairwise distance between tracked neurons (right; normalised to P9 corresponding to the earliest common day across all mice) as a function of imaging days t. (<bold>D</bold>) Graphs plotting the distribution of calcium fluorescence event rates in all tracked neurons from the example mouse as a function of age (left), the mean value across days for all mice (middle), and a statistical comparison between the early (≤P11) and late (&gt;P11) epochs (right). Example mouse is shown in blue; same in E, F, and G. *: Mann-Whitney U test, p=7.6 × 10<sup>–6</sup>. For standard deviation, see <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1G</xref>. (<bold>E</bold>) Same as D but for pairwise correlations. *: Mann-Whitney U test, p=1.8 × 10<sup>–6</sup>. For standard deviation, see <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1H</xref>. (<bold>F</bold>) Graphs plotting pairwise correlations as a function of anatomical distance for all pairs of tracked neurons across all ages in the example mouse (left), the estimated pairwise correlation of neighbouring neurons as a function of age for all mice (middle), and a statistical comparison across the two epochs (right). *: Mann-Whitney U test, p=2.7 × 10<sup>–7</sup>. (<bold>G</bold>) Cumulative distribution plot of the explained variance as a function of the number of principal components (PCs) for the example mouse across ages (left), number of PCs accounting for 90% of the variance as a function of age for all mice (right), and a statistical comparison across the two epochs (right). *: Mann-Whitney U test, p=4.0 × 10<sup>–6</sup>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-107540-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Activity of tracked cells across all days for the example mouse.</title><p>(<bold>A</bold>) Raster plots and simultaneously recorded mouse movements (blue traces) for all tracked neurons on each subsequent day from postnatal day 8 (P8) (top) to P14 (bottom) for the example mouse (related to <xref ref-type="fig" rid="fig4">Figure 4A</xref>). (<bold>B</bold>) Representative example dF/F traces of individual tracked neurons, with the trace of each neuron displayed in the same colour across days. Neurons were chosen in equal increments along the rows of the corresponding raster plots in A.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-107540-fig5-figsupp1-v2.tif"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 2.</label><caption><title>Development of neuronal activity statistics in the tracked population of neurons for the full dataset.</title><p>(<bold>A</bold>) Distributions of calcium event rates (related to <xref ref-type="fig" rid="fig5">Figure 5D</xref>). (<bold>B</bold>) Distributions of pairwise correlations (related to <xref ref-type="fig" rid="fig5">Figure 5E</xref>). (<bold>C</bold>) Pairwise correlations as a function of distance (related to <xref ref-type="fig" rid="fig5">Figure 5F</xref>). (<bold>D</bold>) Cumulative proportion of total variance explained by principal component analysis (PCA) (related to <xref ref-type="fig" rid="fig5">Figure 5G</xref>). (<bold>E</bold>) Relationship between the initial weight of each mouse and its brain growth estimated as the slope of the line of pairwise cell distances (<xref ref-type="fig" rid="fig5">Figure 5C</xref>). (<bold>F</bold>) Statistical comparison of mouse weight (left) and normalised mean distance between cells (right) between the two developmental epochs (related to <xref ref-type="fig" rid="fig5">Figure 5C</xref>). (<bold>G</bold>) Standard deviation of the calcium fluorescence event rates population of tracked neurons across days for all mice (left) and a statistical comparison between the early and late epochs (right) (related to <xref ref-type="fig" rid="fig5">Figure 5D</xref>). (<bold>H</bold>) Same as G but for pairwise correlations (related to <xref ref-type="fig" rid="fig5">Figure 5E</xref>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-107540-fig5-figsupp2-v2.tif"/></fig></fig-group><p>The early postnatal period of cortical development studied here is characterised by the transition from synchronous calcium events recruiting many neurons to progressively more decorrelated population dynamics (<xref ref-type="bibr" rid="bib21">Golshani et al., 2009</xref>; <xref ref-type="bibr" rid="bib35">Mizuseki and Buzsáki, 2013</xref>). In order to visualise these global changes in our dataset of longitudinally imaged mice, we first plotted raster plots of calcium fluorescence traces as a function of time for all tracked neurons on each imaging day in our example mouse (<xref ref-type="fig" rid="fig5">Figure 5A</xref> for P8 and P14, all days in <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1A</xref>). Visual inspection of these raster plots clearly indicates the disappearance of recurring periods of highly synchronous activity from around P11 onwards, as well as a global increase in single-neuron activity rates. Accordingly, quantifying calcium event rates as a function of age indicated a gradual increase in the mean and a widening of the distribution with age (<xref ref-type="fig" rid="fig5">Figure 5D</xref>, <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2A and G</xref>, all statistical comparisons were done between an ‘early’ [≤P11] and ‘late’ [&gt;P11] set of recordings). This evolution also signalled the transition towards long-tailed firing rate distributions, which are ubiquitous in adult brain circuits (<xref ref-type="bibr" rid="bib3">Avitan and Stringer, 2022</xref>).</p><p>Next, we analysed the distributions of pairwise correlations between activity traces from all longitudinally tracked neurons as a function of mouse age (<xref ref-type="fig" rid="fig5">Figure 5D</xref>, <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2B and H</xref>). Consistent with the disappearance of highly synchronous network events observed in the raster plots, we found a significant decrease in mean pairwise correlations, indicating a progressive decorrelation of neuronal activity (<xref ref-type="fig" rid="fig5">Figure 5E</xref>). The spatial distribution of pairwise correlations also evolved across days from highly correlated locally to more broadly distributed (<xref ref-type="fig" rid="fig5">Figure 5F</xref>), suggesting the gradual breakdown of spatially clustered cell assemblies (<xref ref-type="bibr" rid="bib67">Wu et al., 2024</xref>).</p><p>We finally turned to characterising the dominant population patterns of neural activity using principal component analysis (PCA). Interestingly, we observed an increase in the number of components required to explain a fixed amount of variance in the neural data across days, suggesting a developmental increase in dimensionality (<xref ref-type="fig" rid="fig5">Figure 5G</xref>), consistent with the statistics of spontaneous activity described in the adult brain (<xref ref-type="bibr" rid="bib53">Stringer et al., 2019a</xref>). Notably, the plots of summary statistics for our entire dataset indicated a clear outlier, consistent across all quantifications (<xref ref-type="fig" rid="fig5">Figure 5D, E, F, and G</xref>). This outlier mouse displayed a similar but delayed developmental trajectory, compared to the other mice. Interestingly, it also showed the lowest initial weight and a less pronounced growth in weight and cortical size (<xref ref-type="fig" rid="fig5">Figure 5C</xref>), likely indicating a lower maturation stage at the onset of the experiments, although the contribution of other experimental factors cannot be excluded given the invasiveness of imaging surgery.</p><p>To fully leverage our longitudinal approach, we next turned to comparing the functional properties of the same neurons across development, which is only possible when tracking cells across days.</p></sec><sec id="s2-5"><title>A marked reorganisation of the functional network structure during the second postnatal week</title><p>We first examined the stability of the correlation structure, which we will refer to as ‘functional connectivity’ (FC). Two alternative possibilities could be envisaged (see <xref ref-type="fig" rid="fig6">Figure 6A</xref>): (i) FC could be conserved across days, meaning that a highly connected pair on a given day would remain highly connected on the next (<xref ref-type="fig" rid="fig6">Figure 6A</xref>, left); (ii) FC could reorganise, losing the structure from the previous day (<xref ref-type="fig" rid="fig6">Figure 6A</xref>, right). In the first case, the FC values for all pairs would remain similar across the 2 days (<xref ref-type="fig" rid="fig6">Figure 6A</xref>, bottom left), whereas in the second case, they would be different (<xref ref-type="fig" rid="fig6">Figure 6A</xref>, bottom right). To discriminate between the two cases, we defined an ‘FC similarity’ score for any pair of imaging days with matched neurons for a given mouse (Pearson correlation (r) across all neuron pairs, see <xref ref-type="fig" rid="fig6">Figure 6A</xref>, bottom). Such an FC similarity metric encapsulates a variety of possible sources of network changes, from local or long-range connectivity, intrinsic excitability to neuromodulation.</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Transition between two stable functional network structures during the second postnatal week of barrel cortex development.</title><p>(<bold>A</bold>) Schematic explanation of the framework to compare functional connectivity (FC) across days; grey nodes represent neurons, strength of a functional connection is denoted by the opacity of the blue edge between two nodes. For a network of four neurons and a given connectivity C<sub>d</sub> (16 connections, top), we can imagine that the connectivity on the next day (C<sub>d+1</sub>) could be ‘conserved’ (middle left) or it could be ‘reorganised’ (middle right). A scatter plot comparing all 16 functional connections between C<sub>d</sub> and C<sub>d+1</sub> would indicate a high correlation in the ‘conserved’ case (bottom left) and low correlation in the reorganised case (bottom right). We refer to this correlation as ‘FC similarity’. (<bold>B</bold>) Scatter plots of FC for three different pairs of recording days: a pair of early sessions (postnatal day 8 [P8] to P9, top left), an early and a late session (P8 to P14, top middle), and a pair of late sessions (P13 to P14, top right). Within-session FC similarity (bottom scatter plots), i.e., comparing the first and second half of an imaging session at early (P8<sub>1/2</sub> to P8<sub>2/2</sub>, bottom left) and late ages (P14<sub>1/2</sub> to P14<sub>2/2</sub>, bottom right). For visualisation purposes, a random subset of 200 pairs is displayed; Linear fit and r (Pearson correlation or ‘FC similarity’) are computed on all pairs; symbols next to r values indicate the same values in panels C and D. (<bold>C</bold>) FC similarity between P8 and all other days for the example mouse (left). Sigmoid fit: solid grey line; inflection point (‘transition age’, see Methods): dotted grey vertical line; linear portion of the sigmoid (‘transition time’, see Methods: two dashed grey vertical lines). Transition age (middle) and transition time (right) as a function of initial weight at P7 are plotted for all mice. (<bold>D</bold>) FC similarity matrix (left) for all pairs of recording days (off diagonal), with within-session FC similarity on the diagonal for the example mouse (left) and average FC similarity across all mice for the same period (right). (<bold>E</bold>) Box plots comparing within-day (left) or across-day (right) FC similarity for early (≤P11) and late (&gt;P11) developmental epochs pooled across all mice. *: statistically significant; ns: not statistically significant (Kruskal-Wallis test: p=3.6 × 10<sup>–22</sup>; post hoc Mann-Whitney U tests with Bonferroni correction, ‘early within’ to ‘late within’: p=3.3 × 10<sup>–3</sup>, ‘early to early’ to ‘late to late’: p=n. s., ‘early to early’ to ‘early to late’: p=1.7 × 10<sup>–12</sup>, ‘late to late’ to ‘early to late’: p=4.2 × 10<sup>–5</sup>, for all possible comparisons, see <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1K</xref>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-107540-fig6-v2.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Stability of neural activity statistics for all mice in the dataset.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-107540-fig6-figsupp1-v2.tif"/></fig></fig-group><p>Quantifying FC similarity across two early sessions for an example animal (P8 to P9, <xref ref-type="fig" rid="fig6">Figure 6B</xref>, top left) indicated remarkable stability, almost identical to the FC similarity within a given imaging day session which we took as a reference (computed as FC similarity between the first and second half of a same day recording, <xref ref-type="fig" rid="fig6">Figure 6B</xref>, bottom left). Conversely, when comparing across more distant developmental ages, we noticed that a large part of the correlation structure was lost, resulting in lower FC similarity (P8 to P14, <xref ref-type="fig" rid="fig6">Figure 6B</xref>, top middle). Interestingly, FC similarity between a pair of later developmental sessions was again comparable to within-session similarity (P13 to P14 and P14 within, <xref ref-type="fig" rid="fig6">Figure 6B</xref>, right), indicating that the functional network structure was stable, but different from that of earlier ages. Of note, within-session stability was consistently lower later than earlier. Quantifying calcium event rate similarity across days indicated a similar pattern (see <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1F–J</xref>).</p><p>To investigate this further, we proceeded to compute the FC similarity for all possible combinations of sessions in all mice. Interestingly, we observed a sigmoid-like decay of FC similarity when taking P8 as a reference (<xref ref-type="fig" rid="fig6">Figure 6C</xref>). Plotting the full FC similarity matrix for all possible combinations of sessions also indicated two stable FC regimes with seemingly two blocks along the diagonal (<xref ref-type="fig" rid="fig6">Figure 6D</xref>, left for example, <xref ref-type="fig" rid="fig6">Figure 6D</xref> right for average, and <xref ref-type="fig" rid="fig6">Figure 6E</xref> for statistical comparison). Interestingly, the sharpness of the transition in FC varied across mice (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1C</xref>) and could in part be explained by the weight of the mouse at the onset of the experiment (<xref ref-type="fig" rid="fig6">Figure 6C</xref>, linear part of sigmoid fit). Such variation across mice could reflect either inherent individual differences in developmental processes or experimental factors, where mice with a lower initial weight may have experienced delayed development due to higher sensitivity to the imaging procedure.</p><p>Altogether, our analyses indicate that the second postnatal week marks a transition between two stable functional network structures in the barrel cortex of developing mice. Additionally, this shows how tracking cells during development opens new analysis possibilities using self-referencing between neurons, providing new insights into how the developmental choreography unfolds in the same population of neurons across days.</p></sec><sec id="s2-6"><title>Developmental emergence of stable behavioural state modulation</title><p>As a first attempt to investigate the mechanisms underlying this network transition, we examined neural activity in relation to behavioural state. The second postnatal week marks the emergence of active sensation, suggesting that changes in arousal state modulation might drive this network reorganisation. In the adult cortex, arousal strongly shapes both global firing rates and neural correlations (<xref ref-type="bibr" rid="bib4">Benisty et al., 2024</xref>; <xref ref-type="bibr" rid="bib41">Niell and Stryker, 2010</xref>; <xref ref-type="bibr" rid="bib19">Gentet et al., 2010</xref>; <xref ref-type="bibr" rid="bib55">Stringer et al., 2025</xref>), making it a promising candidate for orchestrating the developmental shift we observed.</p><p>To this aim, we sorted the neurons based on the similarity of their activity patterns, using Rastermap (<xref ref-type="bibr" rid="bib29">Lütcke et al., 2013</xref>), and examined the relationship between neuronal activity and behavioural states. We assessed behavioural state indirectly using the videos capturing spontaneous mouse movement and quantifying them using a ‘motion energy’ metric (as in <xref ref-type="bibr" rid="bib4">Benisty et al., 2024</xref>, for more details, see Methods). Interestingly, this sorting revealed a subpopulation of neurons that were highly correlated with the animal’s motion at later, but not earlier, developmental stages (<xref ref-type="fig" rid="fig5">Figure 5A</xref>, see <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1A</xref> for all days). We first quantified this relationship by computing the temporal correlation between the first principal component of neuronal activity and the animal’s motion. Interestingly, this correlation showed a steep increase after P11 for most mice (<xref ref-type="fig" rid="fig7">Figure 7D</xref>). This suggested that global fluctuations in neural activity are more strongly modulated by active movement at later than earlier developmental stages.</p><fig-group><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Regression analysis to study the development and stability of neural representations.</title><p>(<bold>A</bold>) Left: A decoding model is fitted on each day to predict a behavioural variable (y, mouse motion) from the simultaneously recorded calcium imaging data (X, activity raster). Right: The model is then tested on the same day (using cross-validation) to assess the encoding of the variable on that given day. (<bold>B</bold>) Overlay of animal’s motion (grey) and the predicted signal from neural activity (green) fit on the same day for example early (postnatal day 8 [P8], top) and late recordings (P14, bottom). Symbols indicate the corresponding R<sup>2</sup> values in panels C and G. Only the first 5 min of the recording are shown for visualisation purposes; for full traces of all recordings, see <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>. (<bold>C</bold>) Graphs indicating R<sup>2</sup> values for same-day cross-validated decoding performance as a function of mouse age. Green indicates the example mouse (also in D). (<bold>D</bold>) Graph plotting the correlation between the animal’s motion and the first principal component signal across days (left) and a statistical comparison of the early (≤P11) and late (&gt;P11) epochs (right). *: Mann-Whitney U test, p=1.2 × 10<sup>–3</sup>. (<bold>E</bold>) Left: Same as in A, an individual model is fitted on each day. Right: To assess the stability of the representation, each model is tested across different days, which is only possible when tracking neurons across sessions. (<bold>F</bold>) Same as B but for examples of cross-day decoding early to early (P9 to P8), late to late (P13 to P14), and early to late (P8 to P14). Symbols indicate the corresponding R<sup>2</sup> values in panel G. (<bold>G</bold>) Full prediction performance matrix showing R<sup>2</sup> values for all combinations of fit and test datasets (rows and columns, respectively) for the example mouse (left) and average across all mice for the same period (right). Diagonal entries correspond to same-day decoding, off-diagonal entries to cross-day recording. (<bold>H</bold>) Box plots comparing R<sup>2</sup> values for same-day (left) or across-day (right) decoding for early (≤P11) and late (&gt;P11) developmental epochs pooled across all mice. *: Statistically significant; ns: not statistically significant (Kruskal-Wallis test: p=4.5 × 10<sup>–10</sup>; post hoc Mann-Whitney U tests with Bonferroni correction, ‘early within’ to ‘late within’: p=1.6 × 10<sup>–3</sup>, ‘early to early’ to ‘late to late’: p=6.5 × 10<sup>–6</sup>, ‘early to early’ to ‘early to late’: p=ns, ‘late to late’ to ‘early to late’: p=2.4 × 10<sup>–5</sup>; for all possible comparisons, see <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1I</xref>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-107540-fig7-v2.tif"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 1.</label><caption><title>Relationship between spontaneous behaviour and neural activity for all mice in the dataset.</title><p>(<bold>A</bold>) Cross-validated same-day prediction for all recording days in the example mouse (related to <xref ref-type="fig" rid="fig6">Figure 6B and C</xref>). (<bold>B</bold>) Prediction of a decoder fit on postnatal day 14 (P14) across all days (related to <xref ref-type="fig" rid="fig6">Figure 6F and G</xref>). (<bold>C</bold>) Prediction of a decoder fit on P8 across all days (related to <xref ref-type="fig" rid="fig6">Figure 6F and G</xref>). (<bold>D</bold>) Example dF/F trace of a highly predictive neuron for a model fit at P14. Notice that the activity closely corresponds to the movement trace also on two earlier days (P12 and P13). (<bold>E</bold>) Full matrices of R<sup>2</sup> values for all combinations of train and test recordings in each mouse. Example mouse (*). (<bold>F</bold>) Mean R<sup>2</sup> matrix averaged across all mice in the dataset. (<bold>G</bold>) Box plots of the distribution of individual R<sup>2</sup> values in different conditions pooled across mice (same as <xref ref-type="fig" rid="fig5">Figure 5E</xref>). (<bold>H</bold>) Statistical significance of pairwise comparisons of data from G. (<bold>I</bold>) p-Values for all statistical comparisons of decoder performance for all comparisons (related to D and E in this figure and <xref ref-type="fig" rid="fig7">Figure 7H</xref>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-107540-fig7-figsupp1-v2.tif"/></fig></fig-group><p>Finally, we asked whether behavioural state could be decoded from population activity dynamics using regression analysis. Despite substantial variability, the same-day decoding performance increased with development (<xref ref-type="fig" rid="fig7">Figure 7A–C</xref>). Since we tracked the same neurons across days, we could also probe the stability of this representation across days, by fitting a model on 1 day and testing it on all other days (cross-day decoding, <xref ref-type="fig" rid="fig7">Figure 7E–H</xref>, <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1B and C</xref>; <xref ref-type="bibr" rid="bib68">Ziv et al., 2013</xref>; <xref ref-type="bibr" rid="bib29">Lütcke et al., 2013</xref>). Interestingly, this analysis showed that, once developed, this representation was indeed stable, allowing for accurate cross-day decoding, with the same neurons showing either consistently positive or negative modulation across days (see <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1D</xref> for the activity traces of an example cell with a high weight for decoding).</p><p>Hence, by combining Track2p longitudinal cell tracking with decoding approaches, one can systematically map the emergence and stability of cortical representations in the developing brain.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Here, we described Track2P, a cell tracking algorithm that can be used to follow the changing dynamics of hundreds of matched neurons from daily calcium imaging recordings in the growing brain of living mouse pups. At the core of the method lies sequential affine registration followed by cell matching for each subsequent pair of recordings, which leads to a better tracking performance during development when using Track2p compared to other methods. Using this benchmarked approach, we observed a sharp developmental transition from highly synchronised activity to multidimensional, behaviour state-dependent neural dynamics. Beyond this key finding, our method opens a much-needed tool for investigating the developmental functional trajectories of individual neurons during early postnatal brain development, and their deviations caused by genetic mutations or environmental perturbations.</p><p>Developing and benchmarking Track2p showed that it is able to track large populations of neurons despite substantial brain growth and other developmental changes through extended periods of time during development. We suggest this is mostly due to affine transform being a good approximation of the growth processes that occur between 2 consecutive days of imaging, with the cell matching step allowing to account for slight non-linearities in tissue growth day-by-day. Currently available methods typically register all imaging FOVs to a single reference, which we believe results in the accumulation of non-linearities, making registration more difficult and resulting in poorer tracking performance.</p><p>From a practical perspective, Track2p reduces manual cell tracking time by transforming a tedious process of manual annotation into a fast and automated procedure. Indeed, considering the time needed for manually tracking all cells in our dataset, we estimate that it would require approximately 5 person-days (120 hr) of work per subject under our experimental conditions, highlighting the necessity of automatic tracking in large-scale calcium imaging recordings. To aid future research, we provide Track2p fully open-source, with substantial documentation and an accompanying GUI facilitating the use of the algorithm by users without previous coding knowledge.</p><p>Besides developing the algorithm, we also showcase analysis techniques that can be used to gain unique insights from longitudinal calcium recordings, drawing inspiration from previous research studying plasticity, learning, and representational drift in the adult brain (<xref ref-type="bibr" rid="bib68">Ziv et al., 2013</xref>; <xref ref-type="bibr" rid="bib17">Driscoll et al., 2017</xref>; <xref ref-type="bibr" rid="bib11">Colonnese, 2014</xref>). We specifically highlight: (1) quantifications of functional statistics of the tracked population across days (<xref ref-type="fig" rid="fig4">Figure 4</xref>); (2) correlation analyses to compare these across days (<xref ref-type="fig" rid="fig5">Figure 5</xref>); (3) regression analyses to study the emergence and stability of neural representations across recording days (<xref ref-type="fig" rid="fig6">Figure 6</xref>).</p><p>Last, we would like to emphasise that this analytical advancement is grounded on optimised experimental procedures to image daily cortical dynamics through a glass window mounted on the developing pup head. Previous studies had described adaptations of the surgical procedure or head fixation to developing pups (<xref ref-type="bibr" rid="bib8">Che and De Marco García, 2021</xref>); however, by measuring the increase in pairwise distance between tracked neurons as a function of age per animal, we now provide a quantitative metric to estimate the invasiveness of the procedure. Interestingly, we observed a growth rate that closely matched ex vivo quantifications (<xref ref-type="bibr" rid="bib57">Thompson et al., 2014</xref>), indicating a minimal impact of our experimental preparation on anatomical brain growth, also confirmed by mouse weight measurements. While we observed a slightly slower weight gain in imaged pups compared to their littermates, further investigation is needed to definitively assess whether repetitive daily imaging might influence cognitive developmental trajectories, e.g., through maternal separation.</p><p>Applying these techniques in our dataset during early postnatal development, we observed a significant and fast change in the nature of neuronal dynamics and state modulation in the barrel cortex, centred on P11, that manifests in several ways: (1) an increase in activity rates; (2) a decrease in pairwise correlations; (3) a shift from locally clustered to widely distributed correlations; (4) an increase in the dimensionality of spontaneous activity; (5) a remapping of the functional pairwise correlation structure; and (6) the emergence of a stable representation of spontaneous active movement.</p><p>If the first three changes had already been described previously in different cortical areas (<xref ref-type="bibr" rid="bib67">Wu et al., 2024</xref>; <xref ref-type="bibr" rid="bib21">Golshani et al., 2009</xref>; <xref ref-type="bibr" rid="bib35">Mizuseki and Buzsáki, 2013</xref>; <xref ref-type="bibr" rid="bib53">Stringer et al., 2019a</xref>; <xref ref-type="bibr" rid="bib10">Colonnese et al., 2010</xref>; <xref ref-type="bibr" rid="bib14">Dard et al., 2022</xref>; <xref ref-type="bibr" rid="bib37">Mòdol et al., 2024</xref>; <xref ref-type="bibr" rid="bib48">Rio‐Bermudez and Blumberg, 2021</xref>), the last two could not be observed without the dense longitudinal tracking of the same neurons across several days in the growing brain permitted by Track2P. This multifaceted transition likely reflects several concurrent developmental processes, including changes in sleep architecture and neuromodulatory tone (<xref ref-type="bibr" rid="bib14">Dard et al., 2022</xref>; <xref ref-type="bibr" rid="bib1">Ahmad et al., 2024</xref>; <xref ref-type="bibr" rid="bib32">Marques-Smith et al., 2016</xref>; <xref ref-type="bibr" rid="bib2">Anastasiades et al., 2016</xref>), maturation and rewiring of local inhibitory circuits (<xref ref-type="bibr" rid="bib7">Bollmann et al., 2023</xref>; <xref ref-type="bibr" rid="bib36">Modol et al., 2020</xref>; <xref ref-type="bibr" rid="bib10">Colonnese et al., 2010</xref>; <xref ref-type="bibr" rid="bib48">Rio‐Bermudez and Blumberg, 2021</xref>; <xref ref-type="bibr" rid="bib61">Tuncdemir et al., 2016</xref>; <xref ref-type="bibr" rid="bib9">Chini et al., 2022</xref>; <xref ref-type="bibr" rid="bib22">Gribizis et al., 2019</xref>; <xref ref-type="bibr" rid="bib34">Minlebaev et al., 2011</xref>) or disengagement from peripheral sensory inputs (<xref ref-type="bibr" rid="bib14">Dard et al., 2022</xref>; <xref ref-type="bibr" rid="bib52">Shen and Colonnese, 2016</xref>). This postnatal spurt is correlated with sparsification, disappearance of the spindle-burst oscillations, and increase in dimensionality of the representations (<xref ref-type="bibr" rid="bib21">Golshani et al., 2009</xref>; <xref ref-type="bibr" rid="bib35">Mizuseki and Buzsáki, 2013</xref>; <xref ref-type="bibr" rid="bib53">Stringer et al., 2019a</xref>; <xref ref-type="bibr" rid="bib10">Colonnese et al., 2010</xref>; <xref ref-type="bibr" rid="bib14">Dard et al., 2022</xref>; <xref ref-type="bibr" rid="bib33">Micheva and Beaulieu, 1996</xref>; <xref ref-type="bibr" rid="bib28">Luhmann and Khazipov, 2018</xref>; <xref ref-type="bibr" rid="bib6">Blumberg et al., 2022</xref>; <xref ref-type="bibr" rid="bib58">Tiriac et al., 2014</xref>). Such drastic and fast changes are accompanied by significant behavioural changes, maybe the most salient ones being the change in the nature and duration of sleep, as well as the start of active exploration (<xref ref-type="bibr" rid="bib59">Tiriac and Blumberg, 2016</xref>). The start of behavioural state modulation and dimensionality increase could reflect the same phenomenon by which spontaneous motor behaviour, including facial movements, drives multidimensional brainwide activity in the adult visual cortex (<xref ref-type="bibr" rid="bib4">Benisty et al., 2024</xref>). This representation is present and stable from P11 onwards, as revealed using our decoding approach. The early absence of representation of spontaneous motor behaviour is in agreement with the previously reported lack of reafferent brain activity in response to self-generated wake movement until P11 (<xref ref-type="bibr" rid="bib16">Dooley and Blumberg, 2018</xref>; <xref ref-type="bibr" rid="bib26">Khazipov et al., 2004</xref>; <xref ref-type="bibr" rid="bib24">Inacio et al., 2023</xref>). Thus, although we did not explicitly distinguish here between sleep and wake-generated movements, it is likely that the ‘motion energy’ metric combined with the decoding mostly took into account wake behaviour, given the long periods of motor activity observed. Hence, we cannot exclude that twitching activity occurring during active sleep could contribute to an earlier representation of spontaneous motion, as reported previously (<xref ref-type="bibr" rid="bib15">Domínguez et al., 2021</xref>). More refined behavioural analysis, particularly of sleep-wake transitions and twitches, could provide additional insights.</p><p>Therefore, the mid-second postnatal week marks a transition between two stable FC structures, indicating that globally, early and late functional connectivities differ. However, singular developmental trajectories cannot be excluded. Future studies could examine whether different cell types transition at different times or different paces, e.g., depending on their time of birth (<xref ref-type="bibr" rid="bib12">Cossart and Garel, 2022</xref>), or whether unique neurons, such as hub cells, could maintain exceptional and stable FC (<xref ref-type="bibr" rid="bib7">Bollmann et al., 2023</xref>). One population of particular interest for tracking is the neurons that contribute the most to behavioural prediction. Indeed, these could form a distinct population of movement-correlated neurons embedded in specific wiring schemes, as recently demonstrated (<xref ref-type="bibr" rid="bib56">Tasnim et al., 2024</xref>).</p><p>This developmental transition centred around P11, which corresponds roughly to birth in human brain development, spans a period between 1 and 4 days, depending on the initial weight of the imaged pup. This transition may not yet be the last step before a mature adult-like network but instead represent a transient state (<xref ref-type="bibr" rid="bib46">Ratsifandrihamanana et al., 2023</xref>) preceding the emergence of mature activity patterns. Its timing, correlated with animal weight, suggests it may represent a conserved developmental milestone. Hence, comparative studies across brain regions and species, including potential parallels in human development, would be valuable.</p><p>We believe that combining Track2p tracking and the analysis methods described here provides a template for future investigations of more complex developmental phenomena, such as the emergence of sensory representations and cognitive functions. Also, longitudinal imaging uniquely enables investigation of activity-dependent development, including how early activity patterns predict later functional properties and assembly formation of the same cells. Indeed, there is nothing precluding further studies to continue tracking the activity of the same cells until adulthood. Additionally, this approach opens possibilities for targeted manipulation studies to examine how early perturbations affect subsequent circuit development. The ability to track the same cells throughout early postnatal development should thus open doors to entirely new classes of experiments not possible before, providing deeper mechanistic insights into developmental principles and pathologies. This is even more important considering that alterations of developmental trajectories at early postnatal time points are starting to be pointed out as the roots for many developmental disorders (<xref ref-type="bibr" rid="bib67">Wu et al., 2024</xref>; <xref ref-type="bibr" rid="bib54">Stringer et al., 2019b</xref>).</p><sec id="s3-1"><title>Resource availability</title><p>All code is available at the Track2p repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/juremaj/track2p">https://github.com/juremaj/track2p</ext-link> (copy archived at <xref ref-type="bibr" rid="bib31">Mantez and Majnik, 2025</xref>) with more extensive documentation and demos available at: <ext-link ext-link-type="uri" xlink:href="https://track2p.github.io/home.html">https://track2p.github.io/home.html</ext-link>. The data, including preprocessed neural data for the tracked cells, behavioural data, and ground truth data for cell tracking, are available at: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/records/17091226">https://zenodo.org/records/17091226</ext-link>.</p></sec></sec><sec id="s4" sec-type="methods"><title>Methods</title><sec id="s4-1"><title>Data acquisition</title><sec id="s4-1-1"><title>Animals</title><p>All experimental procedures were approved by the French ethics committee (Ministère de l'Enseignement Supérieur, de la Recherche et de l’Innovation [MESRI]; Comité d’éthique CEEA-014; APAFiS # 30716-2021032215171216 v8) and conducted in agreement with the European Council Directive 86/609/EEC. GAD67-Cre mice were kindly donated by Dr. Hannah Monyer (Heidelberg University). Mice were bred and stored in an animal facility with room temperature (RT) and relative humidity maintained at 22 ± 1°C and 50 ± 20%, respectively. Mice were provided ad libitum access to water and food. A total of six mice were used in the study, all heterozygous GAD67-Cre transgenics.</p></sec><sec id="s4-1-2"><title>Virus injections</title><p>We performed viral injections at P0 as previously described (<xref ref-type="bibr" rid="bib42">Ntatsis et al., 2023</xref>). Briefly, we prepared a solution of AAV-hSyn-GCaMP8m and AAV-FLEX-tdTomato (2:1 volumetric ratio, 10<sup>12</sup> genome copies per millilitre; Addgene) with a small volume (10:1) of 0.05% trypan blue (T8154 Sigma) to verify the success of the injection. We then briefly anaesthetised the mouse on ice and injected 2 μL of the solution in the right lateral ventricle using a glass micropipette. Pups were left to recover on a heating pad at 37°C before being returned to the dam.</p></sec><sec id="s4-1-3"><title>Cranial window surgery</title><p>All procedures were performed as in <xref ref-type="bibr" rid="bib7">Bollmann et al., 2023</xref>. Surgeries were performed at P7 for all mice. Briefly, betadine and lidocaine cream were applied topically, covering the area of the intended incision. Isoflurane was used for induction of global anaesthesia and maintained via a nose cone throughout the procedure. A heating pad was used to maintain body temperature. After skin removal, a head plate (4 mm inner diameter, Luigs and Neumann) was fixed to the part of the skull covering the barrel cortex using glue (SuperGlue3) and Super Bond (DSM Dentaire). A craniotomy was performed within the head plate opening before finally applying a thin layer of Kwik-Sil (WPI) to the surface of the dura and covering it with a glass cover slip (3 mm, Warner Instruments). The cover slip was last fixed to the headplate and the skull again using glue and Super Bond. Mice were left to recover on a heating pad at 37°C for at least 1 hr before returning them to the home cage.</p></sec><sec id="s4-1-4"><title>Chronic two-photon calcium imaging</title><p>Longitudinal two-photon calcium imaging was performed for each mouse for at least 6 consecutive days (see <xref ref-type="fig" rid="fig5">Figure 5</xref> for details). Imaging was performed using a Bruker (Ultima 2P) microscope with a Coherent Mai-Tai excitation laser (950 nm excitation light) and a 16× Nikon objective (NA 0.8). Before detection, emitted light was split into two optical paths, each associated with a filter (red and green, 580–620 and 500–550 nm, respectively), allowing us to simultaneously record the GCaMP8m and the tdTomato signal. The acquisition was performed using the Prairie View software. All recordings were performed in layer 2/3 (depth between 100 and 200 µm from the pial surface) with a 720×720 µm<sup>2</sup> FOV and 512×512 pixel resolution. Imaging rate was 30 Hz (resonant scanner) and each session lasted 20 min. All experiments were performed in the dark, under sensory-minimised conditions, with mice being free to spontaneously run on a non-motorised treadmill (Luigs and Neumann). To facilitate alignment and cell tracking, we kept the alignment of the head mount with respect to the microscope fixed across all sessions for the same mouse. To record from the same region across days, we manually aligned the imaging plane in x, y, and z to best match the reference images of the red channel (tdTomato) from all previous recording days. During the course of each recording, pups were kept warm by a heating element mounted to the imaging setup. After each imaging session, the pups were returned to their home cage with the dam and their littermates.</p></sec><sec id="s4-1-5"><title>Videography</title><p>All videography was performed using a Basler camera (Basler ACE2 1920), with an infrared LED light source (ThorLabs 850 nm) pointed at the mouse. Videos were recorded at 30 Hz, with the microscope acquisition acting as a trigger for camera frame acquisition, also allowing for simple synchronisation across the two modalities. All acquisition was done using custom Python scripts using the PyPylon wrapper for the Basler camera software (Pylon Camera Software Suite, <ext-link ext-link-type="uri" xlink:href="https://github.com/basler/pypylon">https://github.com/basler/pypylon</ext-link>; <xref ref-type="bibr" rid="bib38">Möller et al., 2025</xref>).</p></sec><sec id="s4-1-6"><title>Processing of calcium imaging data</title><p>Calcium imaging data was preprocessed using the Suite2p pipeline, sequentially performing motion correction, ROI detection, signal extraction, and spike deconvolution (<xref ref-type="bibr" rid="bib43">Otsu, 1979</xref>) for each recording separately. Suite2p additionally provides a cell classification feature, providing a probability of a classifier categorising an ROI as being a true cell. We considered all ROIs above the default threshold of 0.5 as true cells. We used baseline-corrected fluorescence traces as our dF/F (using the default Suite2p parameters) for all subsequent analyses. To facilitate the use of Track2p with other preprocessing pipelines, we implemented a data loader that takes as input three simple NumPy arrays corresponding to ROIs, FOV, and traces (for more information, see <ext-link ext-link-type="uri" xlink:href="https://track2p.github.io/run_inputs_and_parameters">https://track2p.github.io/run_inputs_and_parameters</ext-link>).</p></sec><sec id="s4-1-7"><title>Preprocessing videography</title><p>We used the global movements of the mouse as a proxy of its arousal state. Similarly to <xref ref-type="bibr" rid="bib13">Crouse, 2016</xref>, we quantified these by looking at the pixel-wise difference of consecutive frames in the videography recording. Namely, we first took each two consecutive frames and computed their pixel-wise difference. We then squared all individual pixel-wise values and summed across pixels. This yielded a scalar value quantifying the motion of the mouse at each time point, which was used for all subsequent analyses.</p></sec></sec><sec id="s4-2"><title>Cell tracking</title><sec id="s4-2-1"><title>Image and ROI registration</title><p>As explained in the main text, Track2p aligns the ROIs based on mean FOV image registration. The implementation allows the user to choose which channel to use for computing the transformation (‘anatomical’ or ‘functional’ channel), as well as which types of transformation to estimate (rigid or affine). Unless otherwise stated, we used the ‘anatomical’ (tdTomato in GAD67-Cre expressing cells) channel with affine transformation (referred to as the ‘baseline’ condition). For the purposes of evaluation, we additionally ran tracking using the functional channel with affine registration (‘functional’ in <xref ref-type="fig" rid="fig4">Figure 4</xref>) and using the anatomical channel with rigid registration (‘rigid’ in <xref ref-type="fig" rid="fig4">Figure 4</xref>). Once registering the images, we applied the same transform to all ROIs from the subsequent session that were considered as cells (see main text). All Track2p image registration is done using the itk-elastix toolbox (<xref ref-type="bibr" rid="bib64">Varoquaux et al., 2017</xref>).</p></sec><sec id="s4-2-2"><title>Cell matching</title><p>Cell matching was done in a way to maximise the sum of the IoU across all matches of ROIs between two sessions. For this reason, we defined a cost matrix M with entries corresponding to:<disp-formula id="equ1"><alternatives><mml:math id="m1"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>I</mml:mi><mml:mi>o</mml:mi><mml:mi>U</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>`</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><tex-math id="t1">\begin{document}$$\displaystyle M_{i,j}=1- IoU\left (r_{sk,i},r^{'}_{s_{k+1},j}\right)$$\end{document}</tex-math></alternatives></disp-formula></p><p>where r<sub>s_k, i</sub> is the ith ROI in session s<sub>k</sub> and r’<sub>s_(k+1), j</sub> is the jth ROI in the subsequent session s<sub>k+1</sub> after registering it to the coordinate system of s<sub>k</sub>. Assigning matches between the two sets of ROIs in this way corresponds to a linear sum assignment problem, with the goal to find a matrix X that yields the optimal assignment cost:<disp-formula id="equ2"><alternatives><mml:math id="m2"><mml:munder><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math><tex-math id="t2">\begin{document}$$\displaystyle  \underset{X}{min}\sum _{i=1}^{m_{s}}\sum _{j=1}^{m_{s}+1}M_{i,j}X_{i,j}$$\end{document}</tex-math></alternatives></disp-formula></p><p>where X<sub>i,j</sub> equals 1 if and only if ROI r<sub>s,i</sub> is assigned to r<sub>s+1,i</sub> and 0 otherwise. Additionally, since the number of ROIs is not necessarily the same across two sessions, M and X are not necessarily square. In this case, if there are more rows than columns, then not every row needs to be assigned to a column, and vice versa. We solve this problem by using the algorithm described in <xref ref-type="bibr" rid="bib20">Glaser et al., 2020</xref>, and implemented in SciPy.</p><p>Additionally, some of the matches can be putative false positives. To avoid this issue, we use an approach similar to the one described in <xref ref-type="bibr" rid="bib60">Tolu et al., 2010</xref>, using a statistical threshold to filter matches based on their IoU distribution. To do this, we use the Skimage implementation of Otsu’s method applied to the IoU histogram (<xref ref-type="bibr" rid="bib62">Ulman et al., 2017</xref>).</p></sec><sec id="s4-2-3"><title>Generating a ground truth dataset</title><p>Since manually tracking all cells would require prohibitive amounts of time (see Discussion), we decided to generate sparse manual annotations, only tracking a subset of all cells from the first recording day onwards. To do this, we took the first recording (s<sub>0</sub>), and we defined a grid of 8×8 (64) equidistant points over the FOV and, for each point, identified the closest ROI in terms of Euclidean distance from the median pixel of the ROI (see <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1A</xref>). We then manually tracked these 64 ROIs across subsequent days. The manual tracking was done using the Suite2p GUI, by visualising the FOV and masks from two recordings side by side and choosing the matching ROI from the subsequent recording or terminating the track if we could not find a match (see <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1B</xref>). Only neurons that were detected and tracked across all sessions were taken into account and referred to as our ground truth dataset (‘GT’ in <xref ref-type="fig" rid="fig4">Figure 4</xref>). When comparing the GT to Track2p tracks, we only considered Track2p tracks that originated from one of the 64 ROIs chosen for evaluation initially. All manual tracking was performed blind to the Track2p outputs.</p></sec><sec id="s4-2-4"><title>Tracking evaluation metrics</title><p>For the evaluation of Track2p under different conditions and comparison to CellReg, we used the ‘Complete tracks’ metric (<xref ref-type="bibr" rid="bib50">Sheintuch et al., 2017</xref>; <xref ref-type="bibr" rid="bib49">Rochefort et al., 2009</xref>, <xref ref-type="fig" rid="fig3">Figure 3B</xref>), defined as:<disp-formula id="equ3"><alternatives><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>C</mml:mi><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>⋅</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t3">\begin{document}$$\displaystyle CT=\frac{2\cdot T_{rc}}{T_{c}+T}$$\end{document}</tex-math></alternatives></disp-formula></p><p>where T<sub>rc</sub> is the number of perfectly reconstructed tracks, T<sub>c</sub> is the number of total tracks identified by Track2p for the 64 s<sub>0</sub> ROIs chosen for manual tracking, and T<sub>gt</sub> is the number of total tracks in the ground truth dataset (from the same 64 s<sub>0</sub> ROIs). In the case of perfect tracking, CT will be equal to 1 (where all computed tracks are equivalent to the ground truth tracks [T<sub>rc</sub> = T<sub>c</sub> = T<sub>gt</sub>]). Conversely, in the case of failed tracking, the value of CT will be close to 0 (e.g. when there is a poor match between ground truth and reconstructed tracks [T<sub>rc</sub>≈0] or when there are many falsely reconstructed tracks not present in the ground truth [T<sub>c</sub> &gt;&gt;T<sub>gt</sub>]). The CT metric is mathematically equivalent to an F1 score where true positives are defined as perfectly reconstructed tracks (<xref ref-type="fig" rid="fig4">Figure 4A</xref>, row 1), false negatives as tracks from GT without a match in Track2p (<xref ref-type="fig" rid="fig4">Figure 4A</xref>, row 2) and false positives as tracks from Track2p without a match in GT (<xref ref-type="fig" rid="fig4">Figure 4A</xref>, rows 3, 4, and 5).</p><p>In the final step of evaluation, we looked at when the algorithms from the original evaluation failed in their tracking of the ground truth neurons. For this, we used a metric of the proportion of correctly reconstructed tracks for an increasingly longer number of sessions (s) (referred to as ‘Prop. correct’ in <xref ref-type="fig" rid="fig4">Figure 4C–F</xref>):<disp-formula id="equ4"><alternatives><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:mfrac></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t4">\begin{document}$$\displaystyle T_{rc}\left (s\right)=\frac{T_{rc}\left (s\right)}{T}$$\end{document}</tex-math></alternatives></disp-formula></p><p>where T<sub>gt</sub> is equivalent as above and T<sub>rc</sub>(s) is equivalent as T<sub>rc</sub> but for full tracks up to session s. Since in this case we kept the GT consistent with the initial evaluation, including only the neurons identified across all days, this metric is agnostic to possible false positives at shorter time epochs.</p><p>To facilitate evaluation by individual users under different experimental conditions, we provide a helper script (Jupyter notebook) aiding the whole evaluation process by both defining a grid of cells to manually track (see previous section), as well as to compute the tracking quality metrics once the ground truth dataset is completed.</p></sec><sec id="s4-2-5"><title>CellReg tracking</title><p>To compare Track2p with CellReg, we ran the MATLAB implementation of CellReg tracking (<ext-link ext-link-type="uri" xlink:href="https://github.com/zivlab/CellReg">https://github.com/zivlab/CellReg</ext-link>; <xref ref-type="bibr" rid="bib51">Sheintuch, 2024</xref>) according to the provided user manual. We first attempted tracking using the default rigid registration, which yielded an error, terminating the algorithm and indicating that subsequent sessions do not resemble the reference session and suggesting to use non-rigid registration. We then re-launched the algorithm with non-rigid registration and used those results to evaluate the tracking the same way as for Track2p (see Results). Notably, even when running CellReg using non-rigid registration, we noticed that the algorithm did not find any tracks spanning all days (T<sub>rc</sub> = 0), which explains the CT score of 0 for all day evaluation.</p></sec></sec><sec id="s4-3"><title>Functional properties of tracked neurons</title><sec id="s4-3-1"><title>Calcium event rates</title><p>To quantify the calcium event rate statistics, we used SciPy’s peak detection algorithm (Python). For this, we first denoised the traces slightly by averaging using a bin size of 10 frames and then proceeded to detect any peaks with a height and prominence of at least one standard deviation. We then calculated the rate as the number of peaks per minute within the recording. When quantifying the stability of the rates across days, we computed the Pearson correlation coefficient across all neurons for each possible combination of sessions recorded from the same mouse.</p></sec><sec id="s4-3-2"><title>Pairwise correlations and PCA</title><p>We quantified pairwise correlations by computing the Pearson correlation between the full traces of all pairs of simultaneously recorded neurons within each session. To quantify the spatial properties of pairwise correlations, we additionally calculated the Euclidean distance between ROI centroids for each corresponding pair of neurons. When plotting the pairwise correlations as a function of pairwise distance, we averaged in bins of 30 µm. The correlation of neighbouring neurons was estimated as the intercept of an exponential fit to the full data.</p><p>When comparing the stability of the correlation structure across days, we refer to this as ‘FC stability’, which we calculate as the Pearson correlation between all pairs of original correlation matrices for a given mouse. When fitting a sigmoid using the first day as the reference, we fix the upper limit of the sigmoid to within-day FC stability for that day and leave the other parameters free. We calculate the inflection point (‘transition age’) and the linear portion (‘transition time’) of the sigmoid using the extrema of the first and fourth derivatives, respectively.</p><p>For PCA, we used the scikit-learn implementation (<xref ref-type="bibr" rid="bib45">Pedregosa et al., 2012</xref>, Python).</p></sec><sec id="s4-3-3"><title>Decoding</title><p>All decoding was done using linear regression with ridge regularisation (ridge regression) to avoid overfitting given the large number of neurons. Ridge regression optimises the weights (β) that minimise the following loss function:<disp-formula id="equ5"><alternatives><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi class="mathcal" mathvariant="script">L</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi><mml:msubsup><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mi mathvariant="bold-italic">β</mml:mi><mml:msubsup><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t5">\begin{document}$$\displaystyle \mathcal{L}(\boldsymbol{\beta}) = \|\mathbf{y} - \mathbf{X}\boldsymbol{\beta}\|_2^2 + \lambda \|\boldsymbol{\beta}\|_2^2$$\end{document}</tex-math></alternatives></disp-formula></p><p>where in our case y is behavioural data, X is neural data, and λ is a regularisation parameter. To choose the optimal λ and to reliably estimate the model performance on same-day decoding, we used nested cross-validation (see for example <xref ref-type="bibr" rid="bib64">Varoquaux et al., 2017</xref>; <xref ref-type="bibr" rid="bib20">Glaser et al., 2020</xref>), ensuring data efficiency and a splitting between training, validation, and test data. Briefly, a grid search for the optimal λ is performed by using the training set to fit models with different λ values and choosing the value corresponding to the model with the best performance on the held-out validation set (model selection). This model is then evaluated on the test data that was used neither in model fitting nor in the hyperparameter optimisation (model evaluation). To ensure data efficiency, nested cross-validation repeats this procedure for all possible splits of the data, with an outer cross-validation loop used for model evaluation and an inner loop for model selection. We used fivefold splits for both the inner and outer loops; splits were done on consecutive 2 min blocks of the recording. For cross-day decoding, we fit a new model with the optimal lambda for that given day and evaluated it on all other days. For all decoding analysis, we slightly denoised the dF/F, as well as the behaviour traces by averaging in bins of 10 consecutive timestamps. All models were implemented and fitted using PyTorch (Python).</p></sec></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Investigation, Methodology, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Software, Writing – original draft</p></fn><fn fn-type="con" id="con3"><p>Investigation, Methodology</p></fn><fn fn-type="con" id="con4"><p>Methodology</p></fn><fn fn-type="con" id="con5"><p>Methodology, Writing – original draft</p></fn><fn fn-type="con" id="con6"><p>Conceptualization, Supervision, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con7"><p>Conceptualization, Supervision, Funding acquisition, Writing – original draft, Writing – review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>All experimental procedures were approved by the French ethics committee (Ministère de l’Enseignement supérieur, de la Recherche et de l’Innovation (MESRI); Comité d’éthique CEEA-014; APAFiS # 30716-2021032215171216 v8) and conducted in agreement with the European Council Directive 86/609/EEC. GAD67-Cre mice were kindly donated by Dr. Hannah Monyer (Heidelberg University). Mice were bred and stored in an animal facility with room temperature (RT) and relative humidity maintained at 22 ± 1°C and 50 ± 20%, respectively. Mice were provided ad libitum access to water and food. A total of 6 mice were used in the study, all heterozygous GAD67-Cre transgenics.</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-107540-mdarchecklist1-v2.docx" mimetype="application" mime-subtype="docx"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>All code is available at the Track2p repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/juremaj/track2p">https://github.com/juremaj/track2p</ext-link> (copy archived at <xref ref-type="bibr" rid="bib31">Mantez and Majnik, 2025</xref>) with more extensive documentation and demos available at: <ext-link ext-link-type="uri" xlink:href="https://track2p.github.io/home.html">https://track2p.github.io/home.html</ext-link>. The data including pre-processed neural data for the tracked cells, behavioural data and ground truth data for cell tracking are available at: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.17091226">https://doi.org/10.5281/zenodo.17091226</ext-link>.</p><p>The following dataset was generated:</p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset1"><person-group person-group-type="author"><name><surname>Majnik</surname><given-names>J</given-names></name><name><surname>Mantez</surname><given-names>M</given-names></name><name><surname>Zangila</surname><given-names>S</given-names></name><name><surname>Bugeon</surname><given-names>S</given-names></name><name><surname>Guignard</surname><given-names>L</given-names></name><name><surname>Platel</surname><given-names>JC</given-names></name><name><surname>Cossart</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2025">2025</year><data-title>Longitudinal tracking of neuronal activity from the same cells in the developing brain using Track2p</data-title><source>Zenodo</source><pub-id pub-id-type="doi">10.5281/zenodo.17091226</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>We thank all the members of the Cossart lab for helpful discussions and constructive feedback. We thank Drs. Lorenzo Fontolan and Michel Picardo for critical feedback on the manuscript. We thank INMED’s animal facility and PBMC technological platform for excellent technical support. This work was supported by the European Research Council under the European Union’s Horizon 2020 research and innovation programme (grant agreement no. 951330), by the Fondation Bettencourt Schueller and the Fondation Roger de Spoelberch; RC is supported by CNRS. J-CP is supported by INSERM. The project leading to this publication has received funding from the French government under the 'France 2030' investment plan managed by the French National Research Agency (reference: ANR-16-CONV000X/ANR-17-EURE-0029) and from Excellence Initiative of Aix-Marseille University – A*MIDEX (AMX-19-IET-004).</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahmad</surname><given-names>M</given-names></name><name><surname>Kim</surname><given-names>J</given-names></name><name><surname>Dwyer</surname><given-names>B</given-names></name><name><surname>Sokoloff</surname><given-names>G</given-names></name><name><surname>Blumberg</surname><given-names>MS</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Coincident development and synchronization of sleep-dependent delta in the cortex and medulla</article-title><source>Current Biology</source><volume>34</volume><fpage>2570</fpage><lpage>2579</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2024.04.064</pub-id><pub-id pub-id-type="pmid">38772363</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anastasiades</surname><given-names>PG</given-names></name><name><surname>Marques-Smith</surname><given-names>A</given-names></name><name><surname>Lyngholm</surname><given-names>D</given-names></name><name><surname>Lickiss</surname><given-names>T</given-names></name><name><surname>Raffiq</surname><given-names>S</given-names></name><name><surname>Kätzel</surname><given-names>D</given-names></name><name><surname>Miesenböck</surname><given-names>G</given-names></name><name><surname>Butt</surname><given-names>SJB</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>GABAergic interneurons form transient layer-specific circuits in early postnatal neocortex</article-title><source>Nature Communications</source><volume>7</volume><elocation-id>10584</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms10584</pub-id><pub-id pub-id-type="pmid">26843463</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Avitan</surname><given-names>L</given-names></name><name><surname>Stringer</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Not so spontaneous: Multi-dimensional representations of behaviors and context in sensory areas</article-title><source>Neuron</source><volume>110</volume><fpage>3064</fpage><lpage>3075</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2022.06.019</pub-id><pub-id pub-id-type="pmid">35863344</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benisty</surname><given-names>H</given-names></name><name><surname>Barson</surname><given-names>D</given-names></name><name><surname>Moberly</surname><given-names>AH</given-names></name><name><surname>Lohani</surname><given-names>S</given-names></name><name><surname>Tang</surname><given-names>L</given-names></name><name><surname>Coifman</surname><given-names>RR</given-names></name><name><surname>Crair</surname><given-names>MC</given-names></name><name><surname>Mishne</surname><given-names>G</given-names></name><name><surname>Cardin</surname><given-names>JA</given-names></name><name><surname>Higley</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Rapid fluctuations in functional connectivity of cortical networks encode spontaneous behavior</article-title><source>Nature Neuroscience</source><volume>27</volume><fpage>148</fpage><lpage>158</lpage><pub-id pub-id-type="doi">10.1038/s41593-023-01498-y</pub-id><pub-id pub-id-type="pmid">38036743</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blankenship</surname><given-names>AG</given-names></name><name><surname>Feller</surname><given-names>MB</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Mechanisms underlying spontaneous patterned activity in developing neural circuits</article-title><source>Nature Reviews. Neuroscience</source><volume>11</volume><fpage>18</fpage><lpage>29</lpage><pub-id pub-id-type="doi">10.1038/nrn2759</pub-id><pub-id pub-id-type="pmid">19953103</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blumberg</surname><given-names>MS</given-names></name><name><surname>Dooley</surname><given-names>JC</given-names></name><name><surname>Tiriac</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Sleep, plasticity, and sensory neurodevelopment</article-title><source>Neuron</source><volume>110</volume><fpage>3230</fpage><lpage>3242</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2022.08.005</pub-id><pub-id pub-id-type="pmid">36084653</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bollmann</surname><given-names>Y</given-names></name><name><surname>Modol</surname><given-names>L</given-names></name><name><surname>Tressard</surname><given-names>T</given-names></name><name><surname>Vorobyev</surname><given-names>A</given-names></name><name><surname>Dard</surname><given-names>R</given-names></name><name><surname>Brustlein</surname><given-names>S</given-names></name><name><surname>Sims</surname><given-names>R</given-names></name><name><surname>Bendifallah</surname><given-names>I</given-names></name><name><surname>Leprince</surname><given-names>E</given-names></name><name><surname>de Sars</surname><given-names>V</given-names></name><name><surname>Ronzitti</surname><given-names>E</given-names></name><name><surname>Baude</surname><given-names>A</given-names></name><name><surname>Adesnik</surname><given-names>H</given-names></name><name><surname>Picardo</surname><given-names>MA</given-names></name><name><surname>Platel</surname><given-names>J-C</given-names></name><name><surname>Emiliani</surname><given-names>V</given-names></name><name><surname>Angulo-Garcia</surname><given-names>D</given-names></name><name><surname>Cossart</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Prominent in vivo influence of single interneurons in the developing barrel cortex</article-title><source>Nature Neuroscience</source><volume>26</volume><fpage>1555</fpage><lpage>1565</lpage><pub-id pub-id-type="doi">10.1038/s41593-023-01405-5</pub-id><pub-id pub-id-type="pmid">37653166</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Che</surname><given-names>A</given-names></name><name><surname>De Marco García</surname><given-names>NV</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>An <italic>in vivo</italic> calcium imaging approach for the identification of cell-type specific patterns in the developing cortex</article-title><source>Frontiers in Neural Circuits</source><volume>15</volume><elocation-id>747724</elocation-id><pub-id pub-id-type="doi">10.3389/fncir.2021.747724</pub-id><pub-id pub-id-type="pmid">34690708</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chini</surname><given-names>M</given-names></name><name><surname>Pfeffer</surname><given-names>T</given-names></name><name><surname>Hanganu-Opatz</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>An increase of inhibition drives the developmental decorrelation of neural activity</article-title><source>eLife</source><volume>11</volume><elocation-id>e78811</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.78811</pub-id><pub-id pub-id-type="pmid">35975980</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Colonnese</surname><given-names>MT</given-names></name><name><surname>Kaminska</surname><given-names>A</given-names></name><name><surname>Minlebaev</surname><given-names>M</given-names></name><name><surname>Milh</surname><given-names>M</given-names></name><name><surname>Bloem</surname><given-names>B</given-names></name><name><surname>Lescure</surname><given-names>S</given-names></name><name><surname>Moriette</surname><given-names>G</given-names></name><name><surname>Chiron</surname><given-names>C</given-names></name><name><surname>Ben-Ari</surname><given-names>Y</given-names></name><name><surname>Khazipov</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>A conserved switch in sensory processing prepares developing neocortex for vision</article-title><source>Neuron</source><volume>67</volume><fpage>480</fpage><lpage>498</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2010.07.015</pub-id><pub-id pub-id-type="pmid">20696384</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Colonnese</surname><given-names>MT</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Rapid developmental emergence of stable depolarization during wakefulness by inhibitory balancing of cortical network excitability</article-title><source>The Journal of Neuroscience</source><volume>34</volume><fpage>5477</fpage><lpage>5485</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3659-13.2014</pub-id><pub-id pub-id-type="pmid">24741038</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cossart</surname><given-names>R</given-names></name><name><surname>Garel</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Step by step: cells with multiple functions in cortical circuit assembly</article-title><source>Nature Reviews. Neuroscience</source><volume>23</volume><fpage>395</fpage><lpage>410</lpage><pub-id pub-id-type="doi">10.1038/s41583-022-00585-6</pub-id><pub-id pub-id-type="pmid">35422526</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crouse</surname><given-names>DF</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>On implementing 2D rectangular assignment algorithms</article-title><source>IEEE Transactions on Aerospace and Electronic Systems</source><volume>52</volume><fpage>1679</fpage><lpage>1696</lpage><pub-id pub-id-type="doi">10.1109/TAES.2016.140952</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dard</surname><given-names>RF</given-names></name><name><surname>Leprince</surname><given-names>E</given-names></name><name><surname>Denis</surname><given-names>J</given-names></name><name><surname>Rao Balappa</surname><given-names>S</given-names></name><name><surname>Suchkov</surname><given-names>D</given-names></name><name><surname>Boyce</surname><given-names>R</given-names></name><name><surname>Lopez</surname><given-names>C</given-names></name><name><surname>Giorgi-Kurz</surname><given-names>M</given-names></name><name><surname>Szwagier</surname><given-names>T</given-names></name><name><surname>Dumont</surname><given-names>T</given-names></name><name><surname>Rouault</surname><given-names>H</given-names></name><name><surname>Minlebaev</surname><given-names>M</given-names></name><name><surname>Baude</surname><given-names>A</given-names></name><name><surname>Cossart</surname><given-names>R</given-names></name><name><surname>Picardo</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>The rapid developmental rise of somatic inhibition disengages hippocampal dynamics from self-motion</article-title><source>eLife</source><volume>11</volume><elocation-id>e78116</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.78116</pub-id><pub-id pub-id-type="pmid">35856497</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Domínguez</surname><given-names>S</given-names></name><name><surname>Ma</surname><given-names>L</given-names></name><name><surname>Yu</surname><given-names>H</given-names></name><name><surname>Pouchelon</surname><given-names>G</given-names></name><name><surname>Mayer</surname><given-names>C</given-names></name><name><surname>Spyropoulos</surname><given-names>GD</given-names></name><name><surname>Cea</surname><given-names>C</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name><name><surname>Fishell</surname><given-names>G</given-names></name><name><surname>Khodagholy</surname><given-names>D</given-names></name><name><surname>Gelinas</surname><given-names>JN</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>A transient postnatal quiescent period precedes emergence of mature cortical dynamics</article-title><source>eLife</source><volume>10</volume><elocation-id>e69011</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.69011</pub-id><pub-id pub-id-type="pmid">34296997</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dooley</surname><given-names>JC</given-names></name><name><surname>Blumberg</surname><given-names>MS</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Developmental “awakening” of primary motor cortex to the sensory consequences of movement</article-title><source>eLife</source><volume>7</volume><elocation-id>e41841</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.41841</pub-id><pub-id pub-id-type="pmid">30574868</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Driscoll</surname><given-names>LN</given-names></name><name><surname>Pettit</surname><given-names>NL</given-names></name><name><surname>Minderer</surname><given-names>M</given-names></name><name><surname>Chettih</surname><given-names>SN</given-names></name><name><surname>Harvey</surname><given-names>CD</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Dynamic reorganization of neuronal activity patterns in parietal cortex</article-title><source>Cell</source><volume>170</volume><fpage>986</fpage><lpage>999</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2017.07.021</pub-id><pub-id pub-id-type="pmid">28823559</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duan</surname><given-names>ZRS</given-names></name><name><surname>Che</surname><given-names>A</given-names></name><name><surname>Chu</surname><given-names>P</given-names></name><name><surname>Modol</surname><given-names>L</given-names></name><name><surname>Bollmann</surname><given-names>Y</given-names></name><name><surname>Babij</surname><given-names>R</given-names></name><name><surname>Fetcho</surname><given-names>RN</given-names></name><name><surname>Otsuka</surname><given-names>T</given-names></name><name><surname>Fuccillo</surname><given-names>MV</given-names></name><name><surname>Liston</surname><given-names>C</given-names></name><name><surname>Pisapia</surname><given-names>DJ</given-names></name><name><surname>Cossart</surname><given-names>R</given-names></name><name><surname>De Marco García</surname><given-names>NV</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>GABAergic restriction of network dynamics regulates interneuron survival in the developing cortex</article-title><source>Neuron</source><volume>105</volume><fpage>75</fpage><lpage>92</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2019.10.008</pub-id><pub-id pub-id-type="pmid">31780329</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gentet</surname><given-names>LJ</given-names></name><name><surname>Avermann</surname><given-names>M</given-names></name><name><surname>Matyas</surname><given-names>F</given-names></name><name><surname>Staiger</surname><given-names>JF</given-names></name><name><surname>Petersen</surname><given-names>CCH</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Membrane potential dynamics of GABAergic neurons in the barrel cortex of behaving mice</article-title><source>Neuron</source><volume>65</volume><fpage>422</fpage><lpage>435</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2010.01.006</pub-id><pub-id pub-id-type="pmid">20159454</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Glaser</surname><given-names>JI</given-names></name><name><surname>Benjamin</surname><given-names>AS</given-names></name><name><surname>Chowdhury</surname><given-names>RH</given-names></name><name><surname>Perich</surname><given-names>MG</given-names></name><name><surname>Miller</surname><given-names>LE</given-names></name><name><surname>Kording</surname><given-names>KP</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Machine learning for neural decoding</article-title><source>eNeuro</source><volume>7</volume><elocation-id>ENEURO.0506-19.2020</elocation-id><pub-id pub-id-type="doi">10.1523/ENEURO.0506-19.2020</pub-id><pub-id pub-id-type="pmid">32737181</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Golshani</surname><given-names>P</given-names></name><name><surname>Gonçalves</surname><given-names>JT</given-names></name><name><surname>Khoshkhoo</surname><given-names>S</given-names></name><name><surname>Mostany</surname><given-names>R</given-names></name><name><surname>Smirnakis</surname><given-names>S</given-names></name><name><surname>Portera-Cailliau</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Internally mediated developmental desynchronization of neocortical network activity</article-title><source>The Journal of Neuroscience</source><volume>29</volume><fpage>10890</fpage><lpage>10899</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2012-09.2009</pub-id><pub-id pub-id-type="pmid">19726647</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gribizis</surname><given-names>A</given-names></name><name><surname>Ge</surname><given-names>X</given-names></name><name><surname>Daigle</surname><given-names>TL</given-names></name><name><surname>Ackman</surname><given-names>JB</given-names></name><name><surname>Zeng</surname><given-names>H</given-names></name><name><surname>Lee</surname><given-names>D</given-names></name><name><surname>Crair</surname><given-names>MC</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Visual cortex gains independence from peripheral drive before eye opening</article-title><source>Neuron</source><volume>104</volume><fpage>711</fpage><lpage>723</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2019.08.015</pub-id><pub-id pub-id-type="pmid">31561919</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>He</surname><given-names>CX</given-names></name><name><surname>Arroyo</surname><given-names>ED</given-names></name><name><surname>Cantu</surname><given-names>DA</given-names></name><name><surname>Goel</surname><given-names>A</given-names></name><name><surname>Portera-Cailliau</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A Versatile method for viral transfection of calcium indicators in the neonatal mouse brain</article-title><source>Frontiers in Neural Circuits</source><volume>12</volume><elocation-id>56</elocation-id><pub-id pub-id-type="doi">10.3389/fncir.2018.00056</pub-id><pub-id pub-id-type="pmid">30083093</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Inacio</surname><given-names>AR</given-names></name><name><surname>Lam</surname><given-names>KC</given-names></name><name><surname>Zhao</surname><given-names>Y</given-names></name><name><surname>Pereira</surname><given-names>F</given-names></name><name><surname>Gerfen</surname><given-names>CR</given-names></name><name><surname>Lee</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Distinct brain-wide presynaptic networks underlie the functional identity of individual cortical neurons</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2023.05.25.542329</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnston</surname><given-names>KG</given-names></name><name><surname>Grieco</surname><given-names>SF</given-names></name><name><surname>Zhang</surname><given-names>H</given-names></name><name><surname>Jin</surname><given-names>S</given-names></name><name><surname>Xu</surname><given-names>X</given-names></name><name><surname>Nie</surname><given-names>Q</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Tracking longitudinal population dynamics of single neuronal calcium signal using SCOUT</article-title><source>Cell Reports Methods</source><volume>2</volume><elocation-id>100207</elocation-id><pub-id pub-id-type="doi">10.1016/j.crmeth.2022.100207</pub-id><pub-id pub-id-type="pmid">35637911</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khazipov</surname><given-names>R</given-names></name><name><surname>Sirota</surname><given-names>A</given-names></name><name><surname>Leinekugel</surname><given-names>X</given-names></name><name><surname>Holmes</surname><given-names>GL</given-names></name><name><surname>Ben-Ari</surname><given-names>Y</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Early motor activity drives spindle bursts in the developing somatosensory cortex</article-title><source>Nature</source><volume>432</volume><fpage>758</fpage><lpage>761</lpage><pub-id pub-id-type="doi">10.1038/nature03132</pub-id><pub-id pub-id-type="pmid">15592414</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>JS</given-names></name><name><surname>Briguglio</surname><given-names>JJ</given-names></name><name><surname>Cohen</surname><given-names>JD</given-names></name><name><surname>Romani</surname><given-names>S</given-names></name><name><surname>Lee</surname><given-names>AK</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>The statistical structure of the hippocampal code for space as a function of time, context, and value</article-title><source>Cell</source><volume>183</volume><fpage>620</fpage><lpage>635</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2020.09.024</pub-id><pub-id pub-id-type="pmid">33035454</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luhmann</surname><given-names>HJ</given-names></name><name><surname>Khazipov</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Neuronal activity patterns in the developing barrel cortex</article-title><source>Neuroscience</source><volume>368</volume><fpage>256</fpage><lpage>267</lpage><pub-id pub-id-type="doi">10.1016/j.neuroscience.2017.05.025</pub-id><pub-id pub-id-type="pmid">28528963</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lütcke</surname><given-names>H</given-names></name><name><surname>Margolis</surname><given-names>DJ</given-names></name><name><surname>Helmchen</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Steady or changing? Long-term monitoring of neuronal population activity</article-title><source>Trends in Neurosciences</source><volume>36</volume><fpage>375</fpage><lpage>384</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2013.03.008</pub-id><pub-id pub-id-type="pmid">23608298</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lyck</surname><given-names>L</given-names></name><name><surname>Krøigård</surname><given-names>T</given-names></name><name><surname>Finsen</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Unbiased cell quantification reveals a continued increase in the number of neocortical neurones during early post-natal development in mice</article-title><source>The European Journal of Neuroscience</source><volume>26</volume><fpage>1749</fpage><lpage>1764</lpage><pub-id pub-id-type="doi">10.1111/j.1460-9568.2007.05763.x</pub-id><pub-id pub-id-type="pmid">17897392</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Mantez</surname><given-names>M</given-names></name><name><surname>Majnik</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2025">2025</year><data-title>Track2p</data-title><version designator="swh:1:rev:028962acb20d809b50db05e90c7bda88d1898824">swh:1:rev:028962acb20d809b50db05e90c7bda88d1898824</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:1eb765869bddc3d3b97811a19673e8e889881464;origin=https://github.com/juremaj/track2p;visit=swh:1:snp:8c86ebb8c1d22ff8ecfecac032949b23ee13574f;anchor=swh:1:rev:028962acb20d809b50db05e90c7bda88d1898824">https://archive.softwareheritage.org/swh:1:dir:1eb765869bddc3d3b97811a19673e8e889881464;origin=https://github.com/juremaj/track2p;visit=swh:1:snp:8c86ebb8c1d22ff8ecfecac032949b23ee13574f;anchor=swh:1:rev:028962acb20d809b50db05e90c7bda88d1898824</ext-link></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marques-Smith</surname><given-names>A</given-names></name><name><surname>Lyngholm</surname><given-names>D</given-names></name><name><surname>Kaufmann</surname><given-names>AK</given-names></name><name><surname>Stacey</surname><given-names>JA</given-names></name><name><surname>Hoerder-Suabedissen</surname><given-names>A</given-names></name><name><surname>Becker</surname><given-names>EBE</given-names></name><name><surname>Wilson</surname><given-names>MC</given-names></name><name><surname>Molnár</surname><given-names>Z</given-names></name><name><surname>Butt</surname><given-names>SJB</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>A transient translaminar GABAergic interneuron circuit connects thalamocortical recipient layers in neonatal somatosensory cortex</article-title><source>Neuron</source><volume>89</volume><fpage>536</fpage><lpage>549</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.01.015</pub-id><pub-id pub-id-type="pmid">26844833</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Micheva</surname><given-names>KD</given-names></name><name><surname>Beaulieu</surname><given-names>C</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Quantitative aspects of synaptogenesis in the rat barrel field cortex with special reference to GABA circuitry</article-title><source>The Journal of Comparative Neurology</source><volume>373</volume><fpage>340</fpage><lpage>354</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1096-9861(19960923)373:3&lt;340::AID-CNE3&gt;3.0.CO;2-2</pub-id><pub-id pub-id-type="pmid">8889932</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Minlebaev</surname><given-names>M</given-names></name><name><surname>Colonnese</surname><given-names>M</given-names></name><name><surname>Tsintsadze</surname><given-names>T</given-names></name><name><surname>Sirota</surname><given-names>A</given-names></name><name><surname>Khazipov</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Early γ oscillations synchronize developing thalamus and cortex</article-title><source>Science</source><volume>334</volume><fpage>226</fpage><lpage>229</lpage><pub-id pub-id-type="doi">10.1126/science.1210574</pub-id><pub-id pub-id-type="pmid">21998388</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mizuseki</surname><given-names>K</given-names></name><name><surname>Buzsáki</surname><given-names>GP</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Preconfigured, skewed distribution of firing rates in the hippocampus and entorhinal cortex</article-title><source>Cell Reports</source><volume>4</volume><fpage>1010</fpage><lpage>1021</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2013.07.039</pub-id><pub-id pub-id-type="pmid">23994479</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Modol</surname><given-names>L</given-names></name><name><surname>Bollmann</surname><given-names>Y</given-names></name><name><surname>Tressard</surname><given-names>T</given-names></name><name><surname>Baude</surname><given-names>A</given-names></name><name><surname>Che</surname><given-names>A</given-names></name><name><surname>Duan</surname><given-names>ZRS</given-names></name><name><surname>Babij</surname><given-names>R</given-names></name><name><surname>De Marco García</surname><given-names>NV</given-names></name><name><surname>Cossart</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Assemblies of perisomatic GABAergic neurons in the developing barrel cortex</article-title><source>Neuron</source><volume>105</volume><fpage>93</fpage><lpage>105</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2019.10.007</pub-id><pub-id pub-id-type="pmid">31780328</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mòdol</surname><given-names>L</given-names></name><name><surname>Moissidis</surname><given-names>M</given-names></name><name><surname>Selten</surname><given-names>M</given-names></name><name><surname>Oozeer</surname><given-names>F</given-names></name><name><surname>Marín</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Somatostatin interneurons control the timing of developmental desynchronization in cortical networks</article-title><source>Neuron</source><volume>112</volume><fpage>2015</fpage><lpage>2030</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2024.03.014</pub-id><pub-id pub-id-type="pmid">38599213</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Möller</surname><given-names>T</given-names></name><name><surname>Rennfanz</surname><given-names>B</given-names></name><name><surname>Matano</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2025">2025</year><data-title>Pypylon</data-title><version designator="5f325fa">5f325fa</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://github.com/basler/pypylon">https://github.com/basler/pypylon</ext-link></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Molnár</surname><given-names>Z</given-names></name><name><surname>Luhmann</surname><given-names>HJ</given-names></name><name><surname>Kanold</surname><given-names>PO</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Transient cortical circuits match spontaneous and sensory-driven activity during development</article-title><source>Science</source><volume>370</volume><elocation-id>eabb2153</elocation-id><pub-id pub-id-type="doi">10.1126/science.abb2153</pub-id><pub-id pub-id-type="pmid">33060328</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nakazawa</surname><given-names>S</given-names></name><name><surname>Mizuno</surname><given-names>H</given-names></name><name><surname>Iwasato</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Differential dynamics of cortical neuron dendritic trees revealed by long-term in vivo imaging in neonates</article-title><source>Nature Communications</source><volume>9</volume><elocation-id>3106</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-05563-0</pub-id><pub-id pub-id-type="pmid">30082783</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Niell</surname><given-names>CM</given-names></name><name><surname>Stryker</surname><given-names>MP</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Modulation of visual responses by behavioral state in mouse visual cortex</article-title><source>Neuron</source><volume>65</volume><fpage>472</fpage><lpage>479</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2010.01.033</pub-id><pub-id pub-id-type="pmid">20188652</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Ntatsis</surname><given-names>K</given-names></name><name><surname>Dekker</surname><given-names>N</given-names></name><name><surname>van der Valk</surname><given-names>V</given-names></name><name><surname>Birdsong</surname><given-names>T</given-names></name><name><surname>Zukić</surname><given-names>D</given-names></name><name><surname>Klein</surname><given-names>S</given-names></name><name><surname>Staring</surname><given-names>M</given-names></name><name><surname>McCormick</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>itk-elastix: Medical image registration in Python</article-title><conf-name>Python in Science Conference</conf-name><pub-id pub-id-type="doi">10.25080/gerudo-f2bc6f59-00d</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Otsu</surname><given-names>N</given-names></name></person-group><year iso-8601-date="1979">1979</year><article-title>A threshold selection method from gray-level histograms</article-title><source>IEEE Transactions on Systems, Man, and Cybernetics</source><volume>9</volume><fpage>62</fpage><lpage>66</lpage><pub-id pub-id-type="doi">10.1109/TSMC.1979.4310076</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Pachitariu</surname><given-names>M</given-names></name><name><surname>Stringer</surname><given-names>C</given-names></name><name><surname>Dipoppa</surname><given-names>M</given-names></name><name><surname>Schröder</surname><given-names>S</given-names></name><name><surname>Rossi</surname><given-names>LF</given-names></name><name><surname>Dalgleish</surname><given-names>H</given-names></name><name><surname>Carandini</surname><given-names>M</given-names></name><name><surname>Harris</surname><given-names>KD</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Suite2p: Beyond 10,000 Neurons with Standard Two-Photon Microscopy</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/061507</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Pedregosa</surname><given-names>F</given-names></name><name><surname>Varoquaux</surname><given-names>G</given-names></name><name><surname>Gramfort</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Scikit-learn machine learning in python</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1201.0490">https://arxiv.org/abs/1201.0490</ext-link></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ratsifandrihamanana</surname><given-names>MR</given-names></name><name><surname>Dard</surname><given-names>RF</given-names></name><name><surname>Denis</surname><given-names>J</given-names></name><name><surname>Cossart</surname><given-names>R</given-names></name><name><surname>Picardo</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Protocol to image and analyze hippocampal network dynamics in non-anesthetized mouse pups</article-title><source>STAR Protocols</source><volume>4</volume><elocation-id>102760</elocation-id><pub-id pub-id-type="doi">10.1016/j.xpro.2023.102760</pub-id><pub-id pub-id-type="pmid">38041819</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reh</surname><given-names>RK</given-names></name><name><surname>Dias</surname><given-names>BG</given-names></name><name><surname>Nelson</surname><given-names>CA</given-names><suffix>III</suffix></name><name><surname>Kaufer</surname><given-names>D</given-names></name><name><surname>Werker</surname><given-names>JF</given-names></name><name><surname>Kolb</surname><given-names>B</given-names></name><name><surname>Levine</surname><given-names>JD</given-names></name><name><surname>Hensch</surname><given-names>TK</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Critical period regulation across multiple timescales</article-title><source>PNAS</source><volume>117</volume><fpage>23242</fpage><lpage>23251</lpage><pub-id pub-id-type="doi">10.1073/pnas.1820836117</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rio‐Bermudez</surname><given-names>CD</given-names></name><name><surname>Blumberg</surname><given-names>MS</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Sleep as a window on the sensorimotor foundations of the developing hippocampus</article-title><source>Hippocampus</source><volume>65</volume><fpage>21</fpage><lpage>37</lpage><pub-id pub-id-type="doi">10.1002/hipo.23334.42</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rochefort</surname><given-names>NL</given-names></name><name><surname>Garaschuk</surname><given-names>O</given-names></name><name><surname>Milos</surname><given-names>RI</given-names></name><name><surname>Narushima</surname><given-names>M</given-names></name><name><surname>Marandi</surname><given-names>N</given-names></name><name><surname>Pichler</surname><given-names>B</given-names></name><name><surname>Kovalchuk</surname><given-names>Y</given-names></name><name><surname>Konnerth</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Sparsification of neuronal activity in the visual cortex at eye-opening</article-title><source>PNAS</source><volume>106</volume><fpage>15049</fpage><lpage>15054</lpage><pub-id pub-id-type="doi">10.1073/pnas.0907660106</pub-id><pub-id pub-id-type="pmid">19706480</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sheintuch</surname><given-names>L</given-names></name><name><surname>Rubin</surname><given-names>A</given-names></name><name><surname>Brande-Eilat</surname><given-names>N</given-names></name><name><surname>Geva</surname><given-names>N</given-names></name><name><surname>Sadeh</surname><given-names>N</given-names></name><name><surname>Pinchasof</surname><given-names>O</given-names></name><name><surname>Ziv</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Tracking the same neurons across multiple days in Ca2+ imaging data</article-title><source>Cell Reports</source><volume>21</volume><fpage>1102</fpage><lpage>1115</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2017.10.013</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Sheintuch</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>CellReg</data-title><version designator="5cce2b2">5cce2b2</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/zivlab/CellReg">https://github.com/zivlab/CellReg</ext-link></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shen</surname><given-names>J</given-names></name><name><surname>Colonnese</surname><given-names>MT</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Development of activity in the mouse visual cortex</article-title><source>The Journal of Neuroscience</source><volume>36</volume><fpage>12259</fpage><lpage>12275</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1903-16.2016</pub-id><pub-id pub-id-type="pmid">27903733</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stringer</surname><given-names>C</given-names></name><name><surname>Pachitariu</surname><given-names>M</given-names></name><name><surname>Steinmetz</surname><given-names>N</given-names></name><name><surname>Carandini</surname><given-names>M</given-names></name><name><surname>Harris</surname><given-names>KD</given-names></name></person-group><year iso-8601-date="2019">2019a</year><article-title>High-dimensional geometry of population responses in visual cortex</article-title><source>Nature</source><volume>571</volume><fpage>361</fpage><lpage>365</lpage><pub-id pub-id-type="doi">10.1038/s41586-019-1346-5</pub-id><pub-id pub-id-type="pmid">31243367</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stringer</surname><given-names>C</given-names></name><name><surname>Pachitariu</surname><given-names>M</given-names></name><name><surname>Steinmetz</surname><given-names>N</given-names></name><name><surname>Reddy</surname><given-names>CB</given-names></name><name><surname>Carandini</surname><given-names>M</given-names></name><name><surname>Harris</surname><given-names>KD</given-names></name></person-group><year iso-8601-date="2019">2019b</year><article-title>Spontaneous behaviors drive multidimensional, brainwide activity</article-title><source>Science</source><volume>364</volume><elocation-id>255</elocation-id><pub-id pub-id-type="doi">10.1126/science.aav7893</pub-id><pub-id pub-id-type="pmid">31000656</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stringer</surname><given-names>C</given-names></name><name><surname>Zhong</surname><given-names>L</given-names></name><name><surname>Syeda</surname><given-names>A</given-names></name><name><surname>Du</surname><given-names>F</given-names></name><name><surname>Kesa</surname><given-names>M</given-names></name><name><surname>Pachitariu</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2025">2025</year><article-title>Rastermap: a discovery method for neural population recordings</article-title><source>Nature Neuroscience</source><volume>28</volume><fpage>201</fpage><lpage>212</lpage><pub-id pub-id-type="doi">10.1038/s41593-024-01783-4</pub-id><pub-id pub-id-type="pmid">39414974</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tasnim</surname><given-names>A</given-names></name><name><surname>Alkislar</surname><given-names>I</given-names></name><name><surname>Hakim</surname><given-names>R</given-names></name><name><surname>Turecek</surname><given-names>J</given-names></name><name><surname>Abdelaziz</surname><given-names>A</given-names></name><name><surname>Orefice</surname><given-names>LL</given-names></name><name><surname>Ginty</surname><given-names>DD</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>The developmental timing of spinal touch processing alterations predicts behavioral changes in genetic mouse models of autism spectrum disorders</article-title><source>Nature Neuroscience</source><volume>27</volume><fpage>484</fpage><lpage>496</lpage><pub-id pub-id-type="doi">10.1038/s41593-023-01552-9</pub-id><pub-id pub-id-type="pmid">38233682</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thompson</surname><given-names>CL</given-names></name><name><surname>Ng</surname><given-names>L</given-names></name><name><surname>Menon</surname><given-names>V</given-names></name><name><surname>Martinez</surname><given-names>S</given-names></name><name><surname>Lee</surname><given-names>C-K</given-names></name><name><surname>Glattfelder</surname><given-names>K</given-names></name><name><surname>Sunkin</surname><given-names>SM</given-names></name><name><surname>Henry</surname><given-names>A</given-names></name><name><surname>Lau</surname><given-names>C</given-names></name><name><surname>Dang</surname><given-names>C</given-names></name><name><surname>Garcia-Lopez</surname><given-names>R</given-names></name><name><surname>Martinez-Ferre</surname><given-names>A</given-names></name><name><surname>Pombero</surname><given-names>A</given-names></name><name><surname>Rubenstein</surname><given-names>JLR</given-names></name><name><surname>Wakeman</surname><given-names>WB</given-names></name><name><surname>Hohmann</surname><given-names>J</given-names></name><name><surname>Dee</surname><given-names>N</given-names></name><name><surname>Sodt</surname><given-names>AJ</given-names></name><name><surname>Young</surname><given-names>R</given-names></name><name><surname>Smith</surname><given-names>K</given-names></name><name><surname>Nguyen</surname><given-names>T-N</given-names></name><name><surname>Kidney</surname><given-names>J</given-names></name><name><surname>Kuan</surname><given-names>L</given-names></name><name><surname>Jeromin</surname><given-names>A</given-names></name><name><surname>Kaykas</surname><given-names>A</given-names></name><name><surname>Miller</surname><given-names>J</given-names></name><name><surname>Page</surname><given-names>D</given-names></name><name><surname>Orta</surname><given-names>G</given-names></name><name><surname>Bernard</surname><given-names>A</given-names></name><name><surname>Riley</surname><given-names>Z</given-names></name><name><surname>Smith</surname><given-names>S</given-names></name><name><surname>Wohnoutka</surname><given-names>P</given-names></name><name><surname>Hawrylycz</surname><given-names>MJ</given-names></name><name><surname>Puelles</surname><given-names>L</given-names></name><name><surname>Jones</surname><given-names>AR</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A high-resolution spatiotemporal atlas of gene expression of the developing mouse brain</article-title><source>Neuron</source><volume>83</volume><fpage>309</fpage><lpage>323</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.05.033</pub-id><pub-id pub-id-type="pmid">24952961</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tiriac</surname><given-names>A</given-names></name><name><surname>Del Rio-Bermudez</surname><given-names>C</given-names></name><name><surname>Blumberg</surname><given-names>MS</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Self-generated movements with “unexpected” sensory consequences</article-title><source>Current Biology</source><volume>24</volume><fpage>2136</fpage><lpage>2141</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2014.07.053</pub-id><pub-id pub-id-type="pmid">25131675</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tiriac</surname><given-names>A</given-names></name><name><surname>Blumberg</surname><given-names>MS</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Gating of reafference in the external cuneate nucleus during self-generated movements in wake but not sleep</article-title><source>eLife</source><volume>5</volume><elocation-id>e18749</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.18749</pub-id><pub-id pub-id-type="pmid">27487470</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tolu</surname><given-names>S</given-names></name><name><surname>Avale</surname><given-names>ME</given-names></name><name><surname>Nakatani</surname><given-names>H</given-names></name><name><surname>Pons</surname><given-names>S</given-names></name><name><surname>Parnaudeau</surname><given-names>S</given-names></name><name><surname>Tronche</surname><given-names>F</given-names></name><name><surname>Vogt</surname><given-names>A</given-names></name><name><surname>Monyer</surname><given-names>H</given-names></name><name><surname>Vogel</surname><given-names>R</given-names></name><name><surname>de Chaumont</surname><given-names>F</given-names></name><name><surname>Olivo-Marin</surname><given-names>J-C</given-names></name><name><surname>Changeux</surname><given-names>J-P</given-names></name><name><surname>Maskos</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>A versatile system for the neuronal subtype specific expression of lentiviral vectors</article-title><source>FASEB Journal</source><volume>24</volume><fpage>723</fpage><lpage>730</lpage><pub-id pub-id-type="doi">10.1096/fj.09-139790</pub-id><pub-id pub-id-type="pmid">19858094</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tuncdemir</surname><given-names>SN</given-names></name><name><surname>Wamsley</surname><given-names>B</given-names></name><name><surname>Stam</surname><given-names>FJ</given-names></name><name><surname>Osakada</surname><given-names>F</given-names></name><name><surname>Goulding</surname><given-names>M</given-names></name><name><surname>Callaway</surname><given-names>EM</given-names></name><name><surname>Rudy</surname><given-names>B</given-names></name><name><surname>Fishell</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Early somatostatin interneuron connectivity mediates the maturation of deep layer cortical circuits</article-title><source>Neuron</source><volume>89</volume><fpage>521</fpage><lpage>535</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2015.11.020</pub-id><pub-id pub-id-type="pmid">26844832</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ulman</surname><given-names>V</given-names></name><name><surname>Maška</surname><given-names>M</given-names></name><name><surname>Magnusson</surname><given-names>KEG</given-names></name><name><surname>Ronneberger</surname><given-names>O</given-names></name><name><surname>Haubold</surname><given-names>C</given-names></name><name><surname>Harder</surname><given-names>N</given-names></name><name><surname>Matula</surname><given-names>P</given-names></name><name><surname>Matula</surname><given-names>P</given-names></name><name><surname>Svoboda</surname><given-names>D</given-names></name><name><surname>Radojevic</surname><given-names>M</given-names></name><name><surname>Smal</surname><given-names>I</given-names></name><name><surname>Rohr</surname><given-names>K</given-names></name><name><surname>Jaldén</surname><given-names>J</given-names></name><name><surname>Blau</surname><given-names>HM</given-names></name><name><surname>Dzyubachyk</surname><given-names>O</given-names></name><name><surname>Lelieveldt</surname><given-names>B</given-names></name><name><surname>Xiao</surname><given-names>P</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Cho</surname><given-names>S-Y</given-names></name><name><surname>Dufour</surname><given-names>AC</given-names></name><name><surname>Olivo-Marin</surname><given-names>J-C</given-names></name><name><surname>Reyes-Aldasoro</surname><given-names>CC</given-names></name><name><surname>Solis-Lemus</surname><given-names>JA</given-names></name><name><surname>Bensch</surname><given-names>R</given-names></name><name><surname>Brox</surname><given-names>T</given-names></name><name><surname>Stegmaier</surname><given-names>J</given-names></name><name><surname>Mikut</surname><given-names>R</given-names></name><name><surname>Wolf</surname><given-names>S</given-names></name><name><surname>Hamprecht</surname><given-names>FA</given-names></name><name><surname>Esteves</surname><given-names>T</given-names></name><name><surname>Quelhas</surname><given-names>P</given-names></name><name><surname>Demirel</surname><given-names>Ö</given-names></name><name><surname>Malmström</surname><given-names>L</given-names></name><name><surname>Jug</surname><given-names>F</given-names></name><name><surname>Tomancak</surname><given-names>P</given-names></name><name><surname>Meijering</surname><given-names>E</given-names></name><name><surname>Muñoz-Barrutia</surname><given-names>A</given-names></name><name><surname>Kozubek</surname><given-names>M</given-names></name><name><surname>Ortiz-de-Solorzano</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>An objective comparison of cell-tracking algorithms</article-title><source>Nature Methods</source><volume>14</volume><fpage>1141</fpage><lpage>1152</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4473</pub-id><pub-id pub-id-type="pmid">29083403</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Beest</surname><given-names>EH</given-names></name><name><surname>Bimbard</surname><given-names>C</given-names></name><name><surname>Fabre</surname><given-names>JMJ</given-names></name><name><surname>Dodgson</surname><given-names>SW</given-names></name><name><surname>Takács</surname><given-names>F</given-names></name><name><surname>Coen</surname><given-names>P</given-names></name><name><surname>Lebedeva</surname><given-names>A</given-names></name><name><surname>Harris</surname><given-names>KD</given-names></name><name><surname>Carandini</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2025">2025</year><article-title>Tracking neurons across days with high-density probes</article-title><source>Nature Methods</source><volume>22</volume><fpage>778</fpage><lpage>787</lpage><pub-id pub-id-type="doi">10.1038/s41592-024-02440-1</pub-id><pub-id pub-id-type="pmid">39333269</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Varoquaux</surname><given-names>G</given-names></name><name><surname>Raamana</surname><given-names>PR</given-names></name><name><surname>Engemann</surname><given-names>DA</given-names></name><name><surname>Hoyos-Idrobo</surname><given-names>A</given-names></name><name><surname>Schwartz</surname><given-names>Y</given-names></name><name><surname>Thirion</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Assessing and tuning brain decoders: Cross-validation, caveats, and guidelines</article-title><source>NeuroImage</source><volume>145</volume><fpage>166</fpage><lpage>179</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2016.10.038</pub-id><pub-id pub-id-type="pmid">27989847</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>DC</given-names></name><name><surname>Santos-Valencia</surname><given-names>F</given-names></name><name><surname>Song</surname><given-names>JH</given-names></name><name><surname>Franks</surname><given-names>KM</given-names></name><name><surname>Luo</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Embryonically active piriform cortex neurons promote intracortical recurrent connectivity during development</article-title><source>Neuron</source><volume>112</volume><fpage>2938</fpage><lpage>2954</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2024.06.007</pub-id><pub-id pub-id-type="pmid">38964330</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wong</surname><given-names>FK</given-names></name><name><surname>Bercsenyi</surname><given-names>K</given-names></name><name><surname>Sreenivasan</surname><given-names>V</given-names></name><name><surname>Portalés</surname><given-names>A</given-names></name><name><surname>Fernández-Otero</surname><given-names>M</given-names></name><name><surname>Marín</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Pyramidal cell regulation of interneuron survival sculpts cortical networks</article-title><source>Nature</source><volume>557</volume><fpage>668</fpage><lpage>673</lpage><pub-id pub-id-type="doi">10.1038/s41586-018-0139-6</pub-id><pub-id pub-id-type="pmid">29849154</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>MW</given-names></name><name><surname>Kourdougli</surname><given-names>N</given-names></name><name><surname>Portera-Cailliau</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Network state transitions during cortical development</article-title><source>Nature Reviews. Neuroscience</source><volume>25</volume><fpage>535</fpage><lpage>552</lpage><pub-id pub-id-type="doi">10.1038/s41583-024-00824-y</pub-id><pub-id pub-id-type="pmid">38783147</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ziv</surname><given-names>Y</given-names></name><name><surname>Burns</surname><given-names>LD</given-names></name><name><surname>Cocker</surname><given-names>ED</given-names></name><name><surname>Hamel</surname><given-names>EO</given-names></name><name><surname>Ghosh</surname><given-names>KK</given-names></name><name><surname>Kitch</surname><given-names>LJ</given-names></name><name><surname>El Gamal</surname><given-names>A</given-names></name><name><surname>Schnitzer</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Long-term dynamics of CA1 hippocampal place codes</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>264</fpage><lpage>266</lpage><pub-id pub-id-type="doi">10.1038/nn.3329</pub-id><pub-id pub-id-type="pmid">23396101</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec sec-type="appendix" id="s8"><title>Interactive visualisation and curation using the Track2p GUI</title><p>To facilitate ease of use and to visually evaluate and curate the quality of Track2p tracking, we’ve designed an intuitive GUI that makes it easy for users to launch the Track2p algorithm and interact with the outputs. Track2p GUI allows the users to perform cell tracking, as well as generate some preliminary visualisations of cell activity without requiring any programming skills on behalf of the user (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A</xref>). Additionally, we’ve made the algorithm and the GUI easy to install via pip, and provide plenty of documentation on the project’s website: <ext-link ext-link-type="uri" xlink:href="https://track2p.github.io/home.html">https://track2p.github.io/home.html</ext-link>.</p><p>Track2p provides several data visualisation functionalities. Firstly, while running the algorithm, a set of figures is generated that can be used to monitor the progress at each consecutive step, as well as to provide a visual overview of tracking quality, e.g., based on a visual assessment of registration quality, IoU histograms, or zoomed-in images of example tracked cells. The GUI itself provides an interactive view of the FOV overlaid with ROIs tracked across all days (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1B</xref>, similar to <xref ref-type="fig" rid="fig3">Figure 3D</xref>). The user can then select a cell from this window that is then displayed in a zoomed-in view across all days (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1B</xref>, similar to <xref ref-type="fig" rid="fig3">Figure 3C</xref>). The visualised cell can be selected interactively by selecting it from contours displayed over the whole FOV. Based on these visualisations, users can also assess the tracking performance and, if necessary, manually curate the results by manually identifying cases of incorrect tracking (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1E</xref>). Under conditions shown in this paper, manual curation should not be strictly necessary (see <xref ref-type="fig" rid="fig4">Figure 4</xref> for evaluation without manual curation); however, this will depend greatly on the particularities of the dataset used.</p><p>Additionally, the GUI also provides activity visualisation, plotting the activity time series of the selected ROI for each recording (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1C</xref>, similar to <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1B</xref>), while also offering the visualisation of the activity of the whole population across all days by generating raster plots of neuronal activity (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1F</xref>, similar to <xref ref-type="fig" rid="fig5">Figure 5A</xref>, <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1A</xref>). These visualisations can allow the user to visually inspect changes to activity statistics at the single-cell level, as well as changes to population-level phenomena such as synchronisation (assemblies) and sequences at the level of all tracked neurons. Raster sorting capabilities can also give a visual insight into the stability of these phenomena across recordings. Currently, the user can choose between PCA or t-SNE (t-distributed stochastic neighbour embedding) techniques to re-sort the rows of the raster based on dimensionality reduction. These methods aim to sort cells with similar fluorescence traces in adjacent rows of the raster plot, visualising co-varying activity patterns at the population level. Additionally, the user can choose between individual sorting and sorting that is preserved across days. Individual sorting better shows these population phenomena for each specific day; however, in this case, the correspondence between the cells across days is lost due to independent sorting. On the other hand, across-day sorting allows the user to focus on 1 day to visualise the stability of these population phenomena and see if they are preserved across other days, since the sorting of the neurons remains consistent across sessions.</p></sec></app></app-group></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.107540.3.sa0</article-id><title-group><article-title>eLife Assessment</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Petreanu</surname><given-names>Leopoldo</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution>Champalimaud Center for the Unknown</institution><country>Portugal</country></aff></contrib></contrib-group><kwd-group kwd-group-type="evidence-strength"><kwd>Compelling</kwd></kwd-group><kwd-group kwd-group-type="claim-importance"><kwd>Fundamental</kwd></kwd-group></front-stub><body><p>This <bold>fundamental</bold> study presents a new method for longitudinally tracking cells in two-photon imaging data that addresses the specific challenges of imaging neurons in the developing cortex. It provides <bold>compelling</bold> evidence demonstrating reliable longitudinal identification of neurons across the second postnatal week in mice. The study should be of interest to development neuroscientists engaged in population-level recordings using two-photon imaging.</p></body></sub-article><sub-article article-type="referee-report" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.107540.3.sa1</article-id><title-group><article-title>Reviewer #1 (Public review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>This manuscript presents a compelling and innovative approach that combines Track2p neuronal tracking with advanced analytical methods to investigate early postnatal brain development. The work provides a powerful framework for exploring complex developmental processes such as the emergence of sensory representations, cognitive functions, and activity-dependent circuit formation. By enabling the tracking of the same neurons over extended developmental periods, this methodology sets the stage for mechanistic insights that were previously inaccessible.</p><p>Strengths:</p><p>(1) Innovative Methodology:</p><p>The integration of Track2p with longitudinal calcium imaging offers a unique capability to follow individual neurons across critical developmental windows.</p><p>(2) High Conceptual Impact:</p><p>The manuscript outlines a clear path for using this approach to study foundational developmental questions, such as how early neuronal activity shapes later functional properties and network assembly.</p><p>(3) Future Experimental Potential:</p><p>The authors convincingly argue for the feasibility of extending this tracking into adulthood and combining it with targeted manipulations, which could significantly advance our understanding of causality in developmental processes.</p><p>(4) Broad Applicability:</p><p>The proposed framework can be adapted to a wide range of experimental designs and questions, making it a valuable resource for the field.</p><p>Weaknesses:</p><p>None major. The manuscript is conceptually strong and methodologically sound. Future studies will need to address potential technical limitations of long-term tracking, but this does not detract from the current work's significance and clarity of vision</p><p>Comments on revisions:</p><p>I have no further requests. I think this is an excellent manuscript</p></body></sub-article><sub-article article-type="referee-report" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.107540.3.sa2</article-id><title-group><article-title>Reviewer #2 (Public review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>The manuscript by Majnik and colleagues introduces &quot;Track2p&quot;, a new tool designed to track neurons across imaging sessions of two-photon calcium imaging in developing mice. The method addresses the challenge of tracking cells in the growing brain of developing mice. The authors showed that &quot;Track2p&quot; successfully tracks hundreds of neurons in the barrel cortex across multiple days during the second postnatal week. This enabled identification of the emergence of behavioral state modulation and desynchronization of spontaneous network activity around postnatal day 11.</p><p>Strengths</p><p>The authors have satisfactorily addressed the majority of our questions and comments, and the revisions substantially improve the manuscript. The expansion of Track2p to accept general NumPy array inputs makes the tool more accessible to researchers using different analysis pipelines. While the absence of benchmarking standards remains a limitation across the field, the release of the ground-truth dataset is an important step forward that will allow other researchers to evaluate and compare algorithms.</p><p>Minor point</p><p>(1) The authors tested the robustness of the algorithm across non-consecutive days. As expected, performance drops significantly under these conditions. We agree that this limitation reflects biological constraints due to brain growth rather than shortcomings of the algorithm itself. This is relevant for researchers planning to use Track2p for longitudinal imaging or benchmarking new algorithms, and we recommend including some of this information in the Supplementary Information along with a brief discussion.</p><p>Comments on revisions:</p><p>We acknowledge the extended documentation for using Track2p and converting between Suite2p outputs and NumPy arrays. This addition is of great utility. We would also suggest further expanding the documentation for the NumPy array implementation, as we ran into some errors when testing this feature using NumPy arrays generated from deltaF traces, TIFF FOVs, and Cellpose masks.</p></body></sub-article><sub-article article-type="referee-report" id="sa3"><front-stub><article-id pub-id-type="doi">10.7554/eLife.107540.3.sa3</article-id><title-group><article-title>Reviewer #3 (Public review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>In this manuscript Majnik et al. developed a computational algorithm to track individual developing interneurons in the rodent cortex at postnatal stages. Considerable development in cortical networks takes place during the first postnatal weeks, however, tools to study them longitudinally at a single cell level are scarce. This paper provides a valuable approach to study both single cell dynamics across days and state-drive network changes. The authors used Gad67Cre mice together with virally introduced TdTom to track interneurons based on their anatomical location in the FOV and AAVSynGCaMP8m to follow their activity across the second postnatal week, a period during which the cortex is known to undergo marked decorrelation in spontaneous activity. Using Track2P, the authors show feasibility to track populations of neurons in the same mice capturing with their analysis previously described developmental decorrelation and uncovering stable representations of neuronal activity, coincident with the onset of spontaneous active movement. The quality of the imaging data is compelling, and the computational analysis is thorough, providing a widely applicable tool for the analysis of emerging neuronal activity in the cortex. Below are some points for the authors to consider.</p><p>Major points</p><p>The authors use a viral approach to label cortical interneurons. It is unclear how Track2P will perform in dense networks of excitatory cells using GCaMP transgenic mice.</p><p>The authors used 20 neurons to generate a ground truth data set. The rational for this sample size is unclear. Figure 1 indicates capability to track ~728 neurons. A larger ground truth data set will increase the robustness of the conclusions.</p><p>It is unclear how movement was scored in the analysis shown in Fig 5A. Was the time that the mouse spent moving scored after visual inspection of the videos? Were whisker and muscle twitches scored as movement or was movement quantified as amount of time in which the treadmill was displaced?</p><p>The rational for binning the data analysis in early P11 is unclear. As the authors acknowledged, it is likely that the decoder captured active states from P11 onwards. Because active whisking begins around P14, it is unlikely to drive this change in network dynamics at P11. Does pupil dilation in the pups change during locomotor and resting states? Does the arousal state of the pups abruptly change at P11?</p><p>Comments on revisions:</p><p>The authors have addressed carefully all my comments. This is an interesting paper.</p></body></sub-article><sub-article article-type="author-comment" id="sa4"><front-stub><article-id pub-id-type="doi">10.7554/eLife.107540.3.sa4</article-id><title-group><article-title>Author response</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Majnik</surname><given-names>Jure</given-names></name><role specific-use="author">Author</role><aff><institution>Aix Marseille Univ, INSERM, INMED U1249</institution><addr-line><named-content content-type="city">Marseille</named-content></addr-line><country>France</country></aff></contrib><contrib contrib-type="author"><name><surname>Mantez</surname><given-names>Manon</given-names></name><role specific-use="author">Author</role><aff><institution>Aix Marseille Univ, INSERM, INMED U1249</institution><addr-line><named-content content-type="city">Marseille</named-content></addr-line><country>France</country></aff></contrib><contrib contrib-type="author"><name><surname>Zangila</surname><given-names>Sofia</given-names></name><role specific-use="author">Author</role><aff><institution>Aix Marseille Univ, INSERM, INMED U1249</institution><addr-line><named-content content-type="city">Marseille</named-content></addr-line><country>France</country></aff></contrib><contrib contrib-type="author"><name><surname>Bugeon</surname><given-names>Stéphane</given-names></name><role specific-use="author">Author</role><aff><institution>Aix Marseille Univ, INSERM, INMED U1249</institution><addr-line><named-content content-type="city">Marseille</named-content></addr-line><country>France</country></aff></contrib><contrib contrib-type="author"><name><surname>Guignard</surname><given-names>Léo</given-names></name><role specific-use="author">Author</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02me5cy06</institution-id><institution>Institut de Biologie du Développement Marseille</institution></institution-wrap><addr-line><named-content content-type="city">Marseille</named-content></addr-line><country>France</country></aff></contrib><contrib contrib-type="author"><name><surname>Platel</surname><given-names>Jean-Claude</given-names></name><role specific-use="author">Author</role><aff><institution>nstitut de Neurobiologie de la Méditerranée</institution><addr-line><named-content content-type="city">Marseille</named-content></addr-line><country>France</country></aff></contrib><contrib contrib-type="author"><name><surname>Cossart</surname><given-names>Rosa</given-names></name><role specific-use="author">Author</role><aff><institution>Aix Marseille Univ, INSERM, INMED U1249</institution><addr-line><named-content content-type="city">Marseille</named-content></addr-line><country>France</country></aff></contrib></contrib-group></front-stub><body><p>The following is the authors’ response to the original reviews.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #1 (Public review):</bold></p></disp-quote><p>We thank the reviewer for very enthusiastic and supportive comments on our manuscript.</p><disp-quote content-type="editor-comment"><p>Summary:</p><p>This manuscript presents a compelling and innovative approach that combines Track2p neuronal tracking with advanced analytical methods to investigate early postnatal brain development. The work provides a powerful framework for exploring complex developmental processes such as the emergence of sensory representations, cognitive functions, and activity-dependent circuit formation. By enabling the tracking of the same neurons over extended developmental periods, this methodology sets the stage for mechanistic insights that were previously inaccessible.</p><p>Strengths:</p><p>(1) Innovative Methodology:</p><p>The integration of Track2p with longitudinal calcium imaging offers a unique capability to follow individual neurons across critical developmental windows.</p><p>(2) High Conceptual Impact:</p><p>The manuscript outlines a clear path for using this approach to study foundational developmental questions, such as how early neuronal activity shapes later functional properties and network assembly.</p><p>(3) Future Experimental Potential:</p><p>The authors convincingly argue for the feasibility of extending this tracking into adulthood and combining it with targeted manipulations, which could significantly advance our understanding of causality in developmental processes.</p><p>(4) Broad Applicability:</p><p>The proposed framework can be adapted to a wide range of experimental designs and questions, making it a valuable resource for the field.</p><p>Weaknesses:</p><p>No major weaknesses were identified by this reviewer. The manuscript is conceptually strong and methodologically sound. Future studies will need to address potential technical limitations of long-term tracking, but this does not detract from the current work's significance and clarity of vision.</p><p><bold>Reviewer #2 (Public review):</bold></p><p>Summary:</p><p>The manuscript by Majnik and colleagues introduces &quot;Track2p&quot;, a new tool designed to track neurons across imaging sessions of two-photon calcium imaging in developing mice. The method addresses the challenge of tracking cells in the growing brain of developing mice. The authors showed that &quot;Track2p&quot; successfully tracks hundreds of neurons in the barrel cortex across multiple days during the second postnatal week. This enabled the identification of the emergence of behavioral state modulation and desynchronization of spontaneous network activity around postnatal day 11.</p><p>Strengths:</p><p>The manuscript is well written, and the analysis pipeline is clearly described. Moreover, the dataset used for validation is of high quality, considering the technical challenges associated with longitudinal two-photon recordings in mouse pups. The authors provide a convincing comparison of both manual annotation and &quot;CellReg&quot; to demonstrate the tracking performance of &quot;Track2p&quot;. Applying this tracking algorithm, Majnik and colleagues characterized hallmark developmental changes in spontaneous network activity, highlighting the impact of longitudinal imaging approaches in developmental neuroscience. Additionally, the code is available on GitHub, along with helpful documentation, which will facilitate accessibility and usability by other researchers.</p><p>Weaknesses:</p><p>(1) The main critique of the &quot;Track2p&quot; package is that, in its current implementation, it is dependent on the outputs of &quot;Suite2p&quot;. This limits adoption by researchers who use alternative pipelines or custom code. One potential solution would be to generalize the accepted inputs beyond the fixed format of &quot;Suite2p&quot;, for instance, by accepting NumPy arrays (e.g., ROIs, deltaF/F traces, images, etc.) from files generated by other software. Otherwise, the tool may remain more of a useful add-on to &quot;Suite2p&quot; (see <ext-link ext-link-type="uri" xlink:href="https://github.com/MouseLand/suite2p/issues/933">https://github.com/MouseLand/suite2p/issues/933</ext-link>) rather than a fully standalone tool.</p></disp-quote><p>We thank the reviewer for this excellent suggestion.</p><p>We have now implemented this feature, where Track2p is now compatible with ‘raw’ NumPy arrays for the three types of inputs. For more information, please check the updated documentation: <ext-link ext-link-type="uri" xlink:href="https://track2p.github.io/run_inputs_and_parameters.html#raw-npy-arrays">https://track2p.github.io/run_inputs_and_parameters.html#raw-npy-arrays</ext-link>. We have also tested this feature using a custom segmentation and trace extraction pipeline using Cellpose for segmentation.</p><disp-quote content-type="editor-comment"><p>(2) Further benchmarking would strengthen the validation of &quot;Track2p&quot;, particularly against &quot;CaIMaN&quot; (Giovannucci et al., eLife, 2019), which is widely used in the field and implements a distinct registration approach.</p></disp-quote><p>This reviewer suggested further benchmarking of Track2P. Ideally, we would want to benchmark Track2p against the current state-of-the-art method. However, the field currently lacks consensus on which algorithm performs best, with multiple methods available including CaIMaN, SCOUT (Johnston et al. 2022), ROICaT (Nguyen et al. 2023), ROIMatchPub (recommended by Suite2p documentation and recently used by Hasegawa et al. 2024), and custom pipelines such as those described by Sun et al. 2025. The absence of systematic benchmarking studies—particularly for custom tracking pipelines—makes it impossible to identify the current state-of-the-art for comparison with Track2p. While comparing Track2p against all available methods would provide comprehensive evaluation, such an analysis falls beyond the scope of this paper.</p><p>We selected CellReg for our primary comparison because it has been validated under similar experimental conditions—specifically, 2-photon calcium imaging in developing hippocampus between P17-P25 (Wang et al. 2024)—making it the most relevant benchmark for our developmental neocortex dataset.</p><p>That said, to support further benchmarking in mouse neocortex (P8-P14), we will publicly release our ground truth tracking dataset.</p><disp-quote content-type="editor-comment"><p>(3) The authors might also consider evaluating performance using non-consecutive recordings (e.g., alternate days or only three time points across the week) to demonstrate utility in other experimental designs.</p></disp-quote><p>Thank you for your suggestion. We have performed a similar analysis prior to submission, but we decided against including it in the final manuscript, to keep the evaluation brief and to not confuse the reader with too many different evaluation methods. We have included the results inAuthor response images 1 and 2 below.</p><p>To evaluate performance in experimental designs with larger time spans between recordings (&gt;1 day) we performed additional evaluation of tracking from P8 to each of the consecutive days while omitting the intermediate days (e. g. P8 to P9, P8 to P10 … P8 to P14). The performance for the three mice from the manuscript is shown below:</p><fig id="sa4fig1" position="float"><label>Author response image 1.</label><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-107540-sa4-fig1-v2.tif"/></fig><p>As expected with increasing time difference between the two recordings the performance drops significantly (dropping to effectively zero for 2 out of 3 mice). This could also explain why CellReg struggles to track cells across all days, since it takes P8 as a reference and attempts to register all consecutive days to that time point before matching, instead of performing registration and matching in consecutive pairs of recordings (P8-P9, P9-P10 … P13-P14) as we do.</p><p>Finally for one of the three mice we also performed an additional test where we asked how adding an additional recording day might rescue the P8-P14 tracking performance. This corresponds to the comment from the reviewer, answering the question if we can only perform three days of recording which additional day would give the best tracking performance.</p><fig id="sa4fig2" position="float"><label>Author response image 2.</label><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-107540-sa4-fig2-v2.tif"/></fig><p>As can be seen from the plot, adding the P10 or P11 recording shows the most significant improvement to the tracking performance, however the performance is still significantly lower than when including all days (see Fig. 4). This test suggests that including a day that is slightly skewed to earlier ages might improve the performance more than simply choosing the middle day between the two extremes. This would also be consistent with the qualitative observation that the FOV seems to show more drastic day-to-day changes at earlier ages in our recording conditions.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #3 (Public review):</bold></p><p>Summary:</p><p>In this manuscript, Majnik et al. developed a computational algorithm to track individual developing interneurons in the rodent cortex at postnatal stages. Considerable development in cortical networks takes place during the first postnatal weeks; however, tools to study them longitudinally at a single-cell level are scarce. This paper provides a valuable approach to study both single-cell dynamics across days and state-driven network changes. The authors used Gad67Cre mice together with virally introduced TdTom to track interneurons based on their anatomical location in the FOV and AAVSynGCaMP8m to follow their activity across the second postnatal week, a period during which the cortex is known to undergo marked decorrelation in spontaneous activity. Using Track2P, the authors show the feasibility of tracking populations of neurons in the same mice, capturing with their analysis previously described developmental decorrelation and uncovering stable representations of neuronal activity, coincident with the onset of spontaneous active movement. The quality of the imaging data is compelling, and the computational analysis is thorough, providing a widely applicable tool for the analysis of emerging neuronal activity in the cortex. Below are some points for the authors to consider.</p></disp-quote><p>We thank the reviewer for a constructive and positive evaluation of our MS.</p><disp-quote content-type="editor-comment"><p>Major points:</p><p>(1) The authors used 20 neurons to generate a ground truth dataset. The rationale for this sample size is unclear. Figure 1 indicates the capability to track ~728 neurons. A larger ground truth data set will increase the robustness of the conclusions.</p></disp-quote><p>We think this was a misunderstanding of our ground truth dataset analysis which included 192 and not 20 neurons. Indeed, as explained in the methods section, since manually tracking all cells would require prohibitive amounts of time, we decided to generate sparse manual annotations, only tracking a subset of all cells from the first recording day onwards. To do this, we took the first recording (s0), and we defined a grid 64 equidistant points over the FOV and, for each point, identified the closest ROI in terms of euclidean distance from the median pixel of the ROI (see Fig. S3A). We then manually tracked these 64 ROIs across subsequent days. Only neurons that were detected and tracked across all sessions were taken into account and referred to as our ground truth dataset (‘GT’ in Fig. 4). This was done for 3 mice, hence 3X64 neurons and not 20 were used to generate our GT dataset.</p><disp-quote content-type="editor-comment"><p>(2) It is unclear how movement was scored in the analysis shown in Figure 5A. Was the time that the mouse spent moving scored after visual inspection of the videos? Were whisker and muscle twitches scored as movement, or was movement quantified as the amount of time during which the treadmill was displaced?</p></disp-quote><p>Movement was scored using a ‘motion energy’ metric as in Stringer et al. 2019 (V1) or Inácio et al. 2025 (S1). This metric takes each two consecutive frames of the videography recordings and computes the difference between them by summing up the square of pixelwise differences between the two images. We made the appropriate changes in the manuscript to further clarify this in the main text and methods in order to avoid confusion.</p><p>Since this metric quantifies global movements, it is inherently biased to whole-body movements causing more significant changes in pixel values around the whole FOV of the camera. Slight twitches of a single limb, or the whisker pad would thus contribute much less to this metric, since these are usually slight displacements in a small region of the camera FOV. Additionally, comparing neural activity across all time points (using correlation or R<sup>2</sup>) also favours movements that last longer (such as wake movements / prolonged periods of high arousal) since each time point is treated equally.</p><p>As we suggested in the discussion, in further analysis it would be interesting to look at the link between twitches and neural activity, but this would likely require extensive manual scoring. We could then treat movements not as continuous across all time-points, but instead using event-based analysis for example peri-movement time histograms for different types of movements at different ages, which is however outside of the scope of this study.</p><disp-quote content-type="editor-comment"><p>(3) The rationale for binning the data analysis in early P11 is unclear. As the authors acknowledged, it is likely that the decoder captured active states from P11 onwards. Because active whisking begins around P14, it is unlikely to drive this change in network dynamics at P11. Does pupil dilation in the pups change during locomotor and resting states? Does the arousal state of the pups abruptly change at P11?</p></disp-quote><p>We agree that P11 does not match any change in mouse behavior that we have been able to capture. However, arousal state in mice does change around postnatal day 11. This period marks a transition from immature, fragmented states to more organized and regulated sleep-wake patterns, along with increasing influence from neuromodulatory and sensory systems. All of these changes have been recently reviewed in Wu et al. 2024 (see also Martini et al. 2021). In addition, in the developing somatosensory system, before postnatal day 11 (P11), wake-related movements (reafference) are actively gated and blocked by the external cuneate nucleus (ECN, Tiriac et al. 2016 and all excellent recent work from the Blumberg lab). This gating prevents sensory feedback from wake movements from reaching the cortex, ensuring that only sleep-related twitches drive neural responses. However, around P11, this gating mechanism abruptly lifts, enabling sensory signals from wake movements to influence cortical processing—signaling a dramatic developmental shift from Wu et al. 2024</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #1 (Recommendations for the authors):</bold></p><p>This manuscript represents a significant advancement in the field of developmental neuroscience, offering a powerful and elegant framework for longitudinal cellular tracking using the Track2p method combined with robust analytical approaches. The authors convincingly demonstrate that this integrated methodology provides an invaluable template for investigating complex developmental processes, including the emergence of sensory representations and higher cognitive functions.</p><p>A major strength of this work is its emphasis on the power of longitudinal imaging to illuminate activity-dependent development. By tracking the same neurons over time, the authors open up new possibilities to uncover how early activity patterns shape later functional outcomes and the organization of neuronal assemblies-insights that would be inaccessible using conventional cross-sectional designs.</p><p>Importantly, the manuscript highlights the potential for this approach to be extended even further, enabling continuous tracking into adulthood and thus offering an unprecedented window into long-term developmental trajectories. The authors also underscore the exciting opportunity to incorporate targeted perturbation experiments, allowing researchers to causally link early circuit dynamics to later outcomes.</p><p>Given the increasing recognition that early postnatal alterations can underlie the etiology of various neurodevelopmental disorders, this work is especially timely. The methods and perspectives presented here are poised to catalyze a new generation of developmental studies that can reveal mechanistic underpinnings of both typical and atypical brain development.</p><p>In summary, this is a technically impressive and conceptually forward-looking study that sets the stage for transformative advances in developmental neuroscience.</p></disp-quote><p>Thank you for the thoughtful feedback—it's greatly appreciated!</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #2 (Recommendations for the authors):</bold></p><p>Minor points:</p><p>(1) Figure 1. Consider merging or moving to Supplemental, as its rationale is well described in the text.</p></disp-quote><p>We would like to retain the current figure as we believe it provides an effective visual illustration of our rationale that will capture readers' attention and could serve as a valuable reference for others seeking to justify longitudinal tracking of the developing brain. We hope the reviewer will understand our decision.</p><disp-quote content-type="editor-comment"><p>(2) Some axis labels and panels are difficult to read due to small font sizes (e.g. smaller panels in Figures 5-7).</p></disp-quote><p>Modified, thanks</p><disp-quote content-type="editor-comment"><p>(3) Supplementary Figures. The order of appearance in the main text is occasionally inconsistent.</p></disp-quote><p>This was modified, thanks</p><disp-quote content-type="editor-comment"><p>(4) Line 132. Add a reference to the registration toolbox used (elastix). A brief description of the affine transformation would also be helpful, either here or in the Methods section (p. 27).</p></disp-quote><p>We have added reference to Ntatsis et al. 2023 and described affine transformation in the main text (lines 133-135):</p><p>Firstly, we estimate the spatial transformation between s0 and s1 using affine image registration (i.e. allowing shifting, rotation, scaling and shearing, see Fig. 2B, the transformation is denoted as T).</p><disp-quote content-type="editor-comment"><p>(5) Lines 147-151. If this method is adapted from another work, please cite the source.</p></disp-quote><p>Computing the intersection over union of two ROIs for tracking is a widely established and intuitive method used across numerous studies, representing standard practice rather than requiring specific citation. We have however included the reference to the paper describing the algorithm we use to solve the linear sum assignment problem used for matching neurons across a pair of consecutive days (Crouse 2016).</p><disp-quote content-type="editor-comment"><p>(6) Line 218. &quot;classical&quot; or automatic?</p></disp-quote><p>We meant “classical” in the sense of widely used.</p><disp-quote content-type="editor-comment"><p>(7) Lines 220-231. Did the authors find significant variability of successfully tracked neurons across mice? While the data for successfully tracked cells is reported (Figure 5B), the proportions are not. Could differences in neuron dropout across days and mice affect the analysis of neuronal activity statistics?</p></disp-quote><p>We thank the reviewer for raising this important point. We computed the fraction of successfully tracked cells in our dataset and found substantial variability:</p><p>Cells detected on day 0: [607, 1849, 2190, 1988, 1316, 2138]</p><p>Proportion successfully tracked: [0.47, 0.20, 0.36, 0.37, 0.41, 0.19]</p><p>Notably, the number of cells detected on the first day varies considerably (607–2138 cells). There appears to be a trend whereby datasets with fewer initially detected cells show higher tracking success rates, potentially because only highly active cells are identified in these cases.</p><p>To draw more definitive conclusions about the proportion of active cells and tracking dropout rates, we would require activity-independent cell detection methods (such as Cellpose applied to isosbestic 830 nm fluorescence, or ideally a pan-neuronal marker in a separate channel, e.g., tdTomato). We have incorporated the tracking success proportions into the revised manuscript.</p><disp-quote content-type="editor-comment"><p>(8) Line 260. Please briefly explain, here or in the Methods, the rationale for using data from only 3 mice (rather than all 6) for evaluating tracking performance.</p></disp-quote><p>We used three mice for this analysis due to the labor-intensive nature of manually annotating 64 ROIs across several days. Given the time constraints of this manual process, we determined that three subjects would provide adequate data to reliably assess tracking performance.</p><disp-quote content-type="editor-comment"><p>(9) Line 277. Consider clarifying or rephrasing the phrase &quot;across progressively shorter time intervals&quot;? Do you mean across consecutive days?</p></disp-quote><p>This has been rephrased as follows:</p><p>Additionally, to assess tracking performance over time, we quantified the proportion of reconstructed ground truth tracks over progressively longer time intervals (first two days, first three days etc. ‘Prop. correct’ in Fig. 4C-F, see Methods). This allowed us to understand how tracking accuracy depends on the number of successive sessions, as well as at which time points the algorithm might fail to successfully track cells.</p><disp-quote content-type="editor-comment"><p>(10) Line 306. &quot;we also provide additional resources and documentation&quot;. Please add a reference or link.</p></disp-quote><p>Done, thanks</p><p>Track2p</p><disp-quote content-type="editor-comment"><p>(11) Lines 342-344. Specify that the raster plots refer to one example mouse, not the entire sample.</p></disp-quote><p>Done, thanks.</p><disp-quote content-type="editor-comment"><p>(12) Lines 996-1002. Please confirm whether only successfully tracked neurons were used to compute the Pearson correlations between all pairs.</p></disp-quote><p>Yes of course, this only applies to tracked neurons as it is impossible to compute this for non-tracked pairs.</p><disp-quote content-type="editor-comment"><p>(13) Line 1003. Add a reference to scikit-learn.</p></disp-quote><p>Reference was added to:</p><p>Pedregosa, F., Varoquaux, G., Gramfort, A., Michel, V., Thirion, B., Grisel, O., Blondel, M., Prettenhofer, P., Weiss, R., Dubourg, V., Vanderplas, J., Passos, A., Cournapeau, D., Brucher, M., Perrot, M., &amp; Duchesnay, E. (2011). Scikit-learn: Machine Learning in Python. Journal of Machine Learning Research, 12, 2825–2830.</p><disp-quote content-type="editor-comment"><p>(14) Typos.Correct spacing between numeric values and units.</p></disp-quote><p>We did not find many typos regarding spacing between the numerical value and the unit symbol (degrees and percent should not be spaced right?).</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #3 (Recommendations for the authors):</bold></p><p>The font size in many of the figures is too small. For example, it is difficult to follow individual ROIs in Figure S3.</p></disp-quote><p>Figure font size has been increased, thanks. In Figure S3 there might have been a misunderstanding, since the three FOV images do not correspond to the FOV of the same mouse across three days but rather to the first recording for each of the three mice used in evaluation (the ROIs can thus not be followed across images since they correspond to a different mouse). To avoid confusion we have labelled each of the FOV images with the corresponding mouse identifier (same as in Fig. 4 and 5).</p></body></sub-article></article>