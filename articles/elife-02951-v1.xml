<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">02951</article-id><article-id pub-id-type="doi">10.7554/eLife.02951</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>A suppression hierarchy among competing motor programs drives sequential grooming in <italic>Drosophila</italic></article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-11053"><name><surname>Seeds</surname><given-names>Andrew M</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-12724"><name><surname>Ravbar</surname><given-names>Primoz</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-12725"><name><surname>Chung</surname><given-names>Phuong</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-12726"><name><surname>Hampel</surname><given-names>Stefanie</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" deceased="yes" id="author-12727"><name><surname>Midgley</surname><given-names>Frank M</given-names><suffix>Jr</suffix></name><xref ref-type="aff" rid="aff1"/><xref ref-type="fn" rid="fn1">†</xref><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-3240"><name><surname>Mensh</surname><given-names>Brett D</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-9096"><name><surname>Simpson</surname><given-names>Julie H</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="corresp" rid="cor2">*</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><institution>Janelia Farm Research Campus, Howard Hughes Medical Institute</institution>, <addr-line><named-content content-type="city">Ashburn</named-content></addr-line>, <country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Reviewing editor</role><aff><institution>Emory University</institution>, <country>United States</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><label>*</label>For correspondence: <email>seeds.andrew@gmail.com</email> (AMS);</corresp><corresp id="cor2"><label>*</label>For correspondence: <email>simpsonj@janelia.hhmi.org</email> (JHS)</corresp><fn fn-type="deceased" id="fn1"><label>†</label><p>Deceased</p></fn></author-notes><pub-date date-type="pub" publication-format="electronic"><day>19</day><month>08</month><year>2014</year></pub-date><pub-date pub-type="collection"><year>2014</year></pub-date><volume>3</volume><elocation-id>e02951</elocation-id><history><date date-type="received"><day>29</day><month>03</month><year>2014</year></date><date date-type="accepted"><day>12</day><month>07</month><year>2014</year></date></history><permissions><copyright-statement>© 2014, Seeds et al</copyright-statement><copyright-year>2014</copyright-year><copyright-holder>Seeds et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-02951-v1.pdf"/><related-article ext-link-type="doi" related-article-type="commentary" xlink:href="10.7554/eLife.04040"/><abstract><object-id pub-id-type="doi">10.7554/eLife.02951.001</object-id><p>Motor sequences are formed through the serial execution of different movements, but how nervous systems implement this process remains largely unknown. We determined the organizational principles governing how dirty fruit flies groom their bodies with sequential movements. Using genetically targeted activation of neural subsets, we drove distinct motor programs that clean individual body parts. This enabled competition experiments revealing that the motor programs are organized into a suppression hierarchy; motor programs that occur first suppress those that occur later. Cleaning one body part reduces the sensory drive to its motor program, which relieves suppression of the next movement, allowing the grooming sequence to progress down the hierarchy. A model featuring independently evoked cleaning movements activated in parallel, but selected serially through hierarchical suppression, was successful in reproducing the grooming sequence. This provides the first example of an innate motor sequence implemented by the prevailing model for generating human action sequences.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.02951.001">http://dx.doi.org/10.7554/eLife.02951.001</ext-link></p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.02951.002</object-id><title>eLife digest</title><p>Anyone who has ever lived with a cat is familiar with its grooming behavior. This innate behavior follows a particular sequence as the cat methodically cleans its body parts one-by-one. Many animals also have grooming habits, even insects such as fruit flies. The fact that grooming sequences are seen across such different species suggests that this behavior is important for survival. Nevertheless, how the brain organizes grooming sequences, or other behaviors that involve a sequence of tasks, is not well understood.</p><p>Fruit flies make a good model for studying grooming behavior for a couple of reasons. First, they are fastidious cleaners. When coated with dust they will faithfully carry out a series of cleaning tasks to clean each body part. Second, there are many genetic tools and techniques that researchers can use to manipulate the fruit flies' behaviors. One technique allows specific brain cells to be targeted and activated to trigger particular behaviors.</p><p>Seeds et al. used these sophisticated techniques, computer modeling, and behavioral observations to uncover how the brains of fruit flies orchestrate a grooming sequence. Dust-covered flies follow a predictable sequence of cleaning tasks: beginning by using their front legs to clean their eyes, they then clean their antennae and head. This likely helps to protect their sensory organs. Next, they move on to the abdomen, possibly to ensure that dust doesn't interfere with their ability to breathe. Wings and thorax follow last. Periodically, the flies stop to rub their legs together to remove any accumulated dust before resuming the cleaning sequence.</p><p>Seeds et al. activated different sets of brain cells one-by-one to see if they could trigger a particular grooming task and found that individual cleaning tasks could be triggered, in the absence of dust, by stimulating a specific group of brain cells. This suggests each cleaning task is a discrete behavior controlled by a subset of cells. Then Seeds et al. tried to stimulate more than one cleaning behavior at a time; they discovered that wing-cleaning suppressed thorax-cleaning, abdomen-cleaning suppressed both of these, and head-cleaning suppressed all the others. This suggests that a ‘hierarchy’ exists in the brain that exactly matches the sequence that flies normally follow as they clean their body parts.</p><p>By learning more about how the brain coordinates grooming sequences, the findings of Seeds et al. may also provide insights into other behaviors that involve a sequence of tasks, such as nest building in animals or typing in humans. Following on from this work, one of the next challenges will be to see if such behaviors also use a ‘suppression hierarchy’ to ensure that individual tasks are carried out in the right order.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.02951.002">http://dx.doi.org/10.7554/eLife.02951.002</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author keywords</title><kwd>serial behavior</kwd><kwd>grooming sequence</kwd><kwd>action selection</kwd><kwd>behavioral choice</kwd><kwd>competitive queuing</kwd><kwd>competing motor programs</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>D. melanogaster</italic></kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000011</institution-id><institution>Howard Hughes Medical Institute</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Simpson</surname><given-names>Julie H</given-names></name></principal-award-recipient></award-group><funding-statement>The funder had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Gaining genetic control over neural modules that drive the grooming of each <italic>Drosophila</italic> body part reveals how mechanisms for selecting among competing behavioral choices are used to generate sequences of actions.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Animals engage in a variety of complex serial behaviors that are essential for survival, such as nest building, communication, courtship, and prey capture. Serial behaviors can be subdivided into distinct motor actions that are mutually exclusive and often proceed in a given sequence (<xref ref-type="bibr" rid="bib15">Gallistel, 1980</xref>; <xref ref-type="bibr" rid="bib1">Adams, 1984</xref>). While our understanding of how motor actions are produced expands (<xref ref-type="bibr" rid="bib33">Marder et al., 2005</xref>; <xref ref-type="bibr" rid="bib4">Bizzi and Cheung, 2008</xref>; <xref ref-type="bibr" rid="bib16">Grillner and Jessell, 2009</xref>; <xref ref-type="bibr" rid="bib10">Costa, 2011</xref>), less is known about the rules that govern how nervous systems assemble individual actions into coordinated sequential behaviors.</p><p>There are two main hypotheses about mechanisms that drive the sequential progression of actions during serial behavior. One hypothesis suggests that each action in a series triggers performance of the next action (<xref ref-type="bibr" rid="bib21">James, 1890</xref>; <xref ref-type="bibr" rid="bib1">Adams, 1984</xref>). This is one of the earliest views of motor sequencing and is thought to underlie some sequential behaviors, such as bird song (<xref ref-type="bibr" rid="bib31">Long et al., 2010</xref>). An alternative hypothesis proposes that the premotor units of all actions in a sequence are activated or readied in parallel and then sequentially selected through winner-take-all competition (<xref ref-type="bibr" rid="bib30">Lashley, 1951</xref>; <xref ref-type="bibr" rid="bib19">Houghton and Hartley, 1995</xref>; <xref ref-type="bibr" rid="bib7">Bullock, 2004</xref>). This model was originally proposed based on human psychology experiments demonstrating a parallel representation of letter typing acts prior to the typing of a word. Electrophysiological evidence in primates is consistent with this parallel model of serial behavior (<xref ref-type="bibr" rid="bib2">Averbeck et al., 2002</xref>; <xref ref-type="bibr" rid="bib34">Mushiake et al., 2006</xref>). However, it has been difficult to causatively confirm the model and determine its underlying action selection mechanisms.</p><p>One strategy for testing how serial behavior is executed is to first identify the individual motor actions that make up the behavior and to then use neural control over each action to investigate how its manipulation affects the progression of the other actions in the series. Independent control of each action in a sequence is challenging to achieve in most systems. However, recent tool development in <italic>Drosophila melanogaster</italic> permits subdivisions of behavior to be identified and manipulated in freely moving flies by expressing neural activators in subsets of neurons in the brain. This approach has revealed that acute neural activation can trigger specific behaviors and subcomponents of behaviors, such as abdominal bending and courtship song (two subcomponents of the courtship sequence) (<xref ref-type="bibr" rid="bib8">Clyne and Miesenböck, 2008</xref>; <xref ref-type="bibr" rid="bib45">von Philipsborn et al., 2011</xref>; <xref ref-type="bibr" rid="bib14">Flood et al., 2013</xref>). While these tools have invigorated interest in identifying the neurons that drive behavior, they also enable experiments to probe the organization of serial behavior through specific control of individual motor actions.</p><p>Here, we study the organizational principles underlying the neural control of serial action selection in an innate behavior common to most limbed animals—grooming (<xref ref-type="bibr" rid="bib41">Sachs, 1988</xref>). Grooming consists of discrete cleaning movements that occur in predictable sequences; however, the mechanisms that govern transitions between the movements are not known (<xref ref-type="bibr" rid="bib43">Szebenyi, 1969</xref>; <xref ref-type="bibr" rid="bib13">Fentress and Stilwell, 1973</xref>; <xref ref-type="bibr" rid="bib12">Dawkins and Dawkins, 1976</xref>; <xref ref-type="bibr" rid="bib41">Sachs, 1988</xref>). Local mechanical stimulation of a body part causes fruit flies to perform precisely targeted cleaning sweeps with their front or hind legs towards that body part (<xref ref-type="bibr" rid="bib44">Vandervorst and Ghysen, 1980</xref>; <xref ref-type="bibr" rid="bib9">Corfas and Dudai, 1989</xref>). In contrast, when they are completely coated in dust, flies coordinate a repertoire of cleaning movements to groom their whole bodies (<xref ref-type="fig" rid="fig1">Figure 1A</xref>; <xref ref-type="bibr" rid="bib3">Bentley, 1975</xref>; <xref ref-type="bibr" rid="bib38">Phillis et al., 1993</xref>). We reasoned that we could exploit the behavior of such dust-coated flies to determine how different grooming actions are prioritized and ordered when they are stimulated at the same time. We show that dust on the body elicits different independently evoked cleaning motor programs for five body parts that progress in series. By genetically targeting different neural subsets, we gain experimental control over each cleaning motor program to demonstrate that they are organized into a suppression hierarchy. We next generate an empirically derived computational model that demonstrates how a suppression hierarchy can mediate the sequential selection of the cleaning motor programs. This work reveals how the organization of <italic>Drosophila</italic> grooming is well described by a parallel model of serial behavior.<fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.02951.003</object-id><label>Figure 1.</label><caption><title>Wild-type flies clean different areas of the body sequentially.</title><p>(<bold>A</bold>) Diagram of body parts cleaned by front leg (red hues) or hind leg (green hues) movements. (<bold>B</bold>–<bold>D</bold>) Dust distribution measurements of the bodies of flies that were coated in yellow dust and allowed to groom. (<bold>B</bold>) Body parts were imaged (dusted samples) and aligned to clean reference images in order to determine the fraction of dust left on each part. (<bold>C</bold>) Average spatial distribution of dust 0 min after dusting and after flies groomed for 35 min. The number of flies contributing to each heat map is displayed. (<bold>D</bold>) Dust removal across a 35-min time course. Masks define regions for counting the yellow pixels (dust) remaining on each sample. Each time point (normalized to 0-min samples) is plotted as the fraction of dust left in the defined regions and shown as the mean ± SEM; n ≥ 26 flies. Figure panel is compiled from data shown in <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>. (<bold>E</bold>) Representative ethogram of the five most common cleaning movements performed by an individual fly after dusting (manually scored from video recordings). All head cleaning movements are binned because eye and antennal cleaning are not easily distinguishable in the dusted state using our analysis methods (labeled whole head). (<bold>F</bold>) Latency to the first bout of head, abdomen, or wing cleaning after dusting for each of six flies annotated. (<bold>G</bold>) Transitions among different body cleaning movements, standing, and walking (across a 25-min time course, n = 6 flies). The radii of the nodes are proportional to the log of the average fraction of total cleaning bouts for each movement. Average total bouts for each movement are shown. Arrow widths represent the transition probabilities between the movements (displaying transition probabilities ≥0.05).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.02951.003">http://dx.doi.org/10.7554/eLife.02951.003</ext-link></p></caption><graphic xlink:href="elife-02951-fig1-v1"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.02951.004</object-id><label>Figure 1—figure supplement 1.</label><caption><title>Grooming apparatus for dusting, recording, and observing flies.</title><p>(<bold>A</bold>) Mesh-covered chambers allow free dust to exit while preventing flies from escaping. Connector side shown with some wells closed using slider gates. (<bold>B</bold>) Sliders gate the chambers for transferring flies and preventing escape. (<bold>C</bold>) View of a single grooming chamber with the gate partially open. (<bold>D</bold>) The connector side fits standard multiwell plates for fly dusting (not shown), clear viewing plugs for recording videos (<bold>D</bold>), and an adaptor for transferring flies between chambers (not shown). (<bold>D</bold>) Image from a video recording of a dusted fly used to score cleaning movements. (<bold>E</bold> and <bold>F</bold>) Shows the aluminum version of the apparatus for rapid cooling of flies. This version was used for the experiment shown in <xref ref-type="fig" rid="fig3">Figure 3C</xref>. All displayed grooming chambers are 15.6 mm in diameter.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.02951.004">http://dx.doi.org/10.7554/eLife.02951.004</ext-link></p></caption><graphic xlink:href="elife-02951-fig1-figsupp1-v1"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.02951.005</object-id><label>Figure 1—figure supplement 2.</label><caption><title>Strategies for quantifying dust on the body surface.</title><p>(<bold>A</bold>) Examples of dusted flies that were allowed to groom for 1 min before their heads were dissected and imaged (showing 6 of 31 total images for this time point). (<bold>B</bold>) Each image was manually warped to a standard head (shown in <xref ref-type="fig" rid="fig1">Figure 1B</xref>), the dust-positive yellow pixels were isolated and converted to grayscale, and all dust pixels were set to 255 intensity values (8 bit). The numbers of white pixels in each image were counted in different regions specified by masks shown in <xref ref-type="fig" rid="fig1">Figure 1D</xref>. (<bold>C</bold>) Average projections were generated from the stack of 31 images. (<bold>D</bold>) A grayscale color map was produced using the average projection intensity values.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.02951.005">http://dx.doi.org/10.7554/eLife.02951.005</ext-link></p></caption><graphic xlink:href="elife-02951-fig1-figsupp2-v1"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.02951.006</object-id><label>Figure 1—figure supplement 3.</label><caption><title>Wild-type flies remove dust from body parts at different rates.</title><p>Data shown here is compiled and plotted in <xref ref-type="fig" rid="fig1">Figure 1D</xref>. (<bold>A</bold>) Average dust patterns of the body parts of Canton S flies at different time points after dusting. Masks used for defining regions of the body parts for counting dust pixels are shown on top. (<bold>B</bold>) Distribution plots of quantified dust pattern data. Each point on the plots represents the number of yellow pixels from the body part sample images. The mean is shown as a red line, 1.96 SEN (95% confidence interval) is in red, 1 SD is blue. (<bold>C</bold>) Curve fit summary of each body part. Curves were fit to either sigmoidal or exponential equations. Values represent the time it took for flies to clean fifty percent of each body part.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.02951.006">http://dx.doi.org/10.7554/eLife.02951.006</ext-link></p></caption><graphic xlink:href="elife-02951-fig1-figsupp3-v1"/></fig><fig id="fig1s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.02951.007</object-id><label>Figure 1—figure supplement 4.</label><caption><title>Sequential cleaning of the head, abdomen, and wings requires dust.</title><p>(<bold>A</bold> and <bold>B</bold>) Cleaning movement ethograms of individual Canton S flies in response to being shaken without (<bold>A</bold>) and with (<bold>B</bold>) dust (n = 6 flies for each condition). (<bold>C</bold>) Table of the time to the first appearance of different cleaning movements for both undusted and dusted flies. Head cleaning movements are all binned because of the difficulty distinguishing between eye and antennal cleaning when flies were dusted (labeled whole head).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.02951.007">http://dx.doi.org/10.7554/eLife.02951.007</ext-link></p></caption><graphic xlink:href="elife-02951-fig1-figsupp4-v1"/></fig><fig id="fig1s5" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.02951.008</object-id><label>Figure 1—figure supplement 5.</label><caption><title>Transitions among cleaning movements of dusted wild-type flies.</title><p>Canton S flies were shaken with dust. (<bold>A</bold> and <bold>B</bold>) The number of first order transitions between movements (<bold>A</bold>) and the transition probabilities are shown (<bold>B</bold>). Data were collected from 25 min of manually scored video (n = 6 flies for each treatment). Movements were binned into whole head, abdomen, wing, and leg rubbing.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.02951.008">http://dx.doi.org/10.7554/eLife.02951.008</ext-link></p></caption><graphic xlink:href="elife-02951-fig1-figsupp5-v1"/></fig><fig id="fig1s6" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.02951.009</object-id><label>Figure 1—figure supplement 6.</label><caption><title>Transitions among cleaning movements performed by dusted wild-type flies over a time course.</title><p>Diagrams are generated from manually scored video in 5-min bins, over a 25-min time course (n = 6 flies). The radii of the nodes are proportional to the log of the average fraction of total cleaning bouts for each movement per time bin. Average total bouts for each movement are shown. Arrow widths represent the transition probabilities between the movements (displaying transition probabilities ≥0.05).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.02951.009">http://dx.doi.org/10.7554/eLife.02951.009</ext-link></p></caption><graphic xlink:href="elife-02951-fig1-figsupp6-v1"/></fig></fig-group></p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Dust-induced grooming is a sequential behavior</title><p>We tested whether flies would prioritize cleaning of specific body parts when they were completely dirty. This was achieved by coating flies in dust, paired with measurements of changing dust distributions on the body surface (<xref ref-type="fig" rid="fig1">Figure 1B,C</xref>, <xref ref-type="fig" rid="fig1s1 fig1s2">Figure 1—figure supplements 1 and 2</xref>) and manual annotation of their cleaning movements (<xref ref-type="fig" rid="fig1">Figure 1E</xref>; <xref ref-type="other" rid="video1">Video 1</xref>). In response to dust on their bodies, flies groomed with a predictable progression of targeted cleaning movements (<xref ref-type="fig" rid="fig1">Figure 1D–F</xref>, <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>, <xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4B,C</xref>). This progression required dust, as undusted flies did not groom in a sequential progression (<xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4A,C</xref>). Dusted flies rapidly cleaned their eyes and then focused on the antennae, demonstrating that they sequentially clean specific regions on the head (<xref ref-type="fig" rid="fig1">Figure 1D</xref>). They next cleaned their posterior body parts in the order from abdomen to wings to thorax. The grooming progression occurred as a sequence in which the probabilities of cleaning different regions of the body gradually changed through time. That is, the progression was not absolutely unidirectional as flies returned to cleaning earlier body parts even though they had already started cleaning later body parts (referred to as return cleaning) (<xref ref-type="fig" rid="fig1">Figure 1E</xref>, <xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4B</xref>, example ethograms). As the flies progressed through the grooming sequence, each bout of body part cleaning featured cyclic transitions between sweeps of the targeted region and rubbing of the legs against each other (<xref ref-type="fig" rid="fig1">Figure 1G</xref>, <xref ref-type="fig" rid="fig1s5">Figure 1—figure supplement 5</xref>; <xref ref-type="other" rid="video1">Video 1</xref>). These cyclic bouts of leg rubbing likely occurred when the legs accumulated sufficient dust from sweeping the body, which was then rubbed towards the distal leg parts and removed. Grooming of the entire body did not necessarily proceed as a continuous process. Flies often paused to walk around and then resumed cleaning where they left off or transitioned to other body parts (<xref ref-type="fig" rid="fig1">Figure 1G</xref>). Thus, flies groom by gradually cleaning different body parts in bouts that are characterized by cyclic transitions between body cleaning sweeps and leg rubbing (shown as a series of transition diagrams in <xref ref-type="fig" rid="fig1s6">Figure 1—figure supplement 6</xref>). The priority order for cleaning the different body parts is: eyes &gt; antennae &gt; abdomen &gt; wings &gt; thorax.<media content-type="glencoe play-in-place height-250 width-310" id="video1" mime-subtype="mov" mimetype="video" xlink:href="elife-02951-media1-v1.mov"><object-id pub-id-type="doi">10.7554/eLife.02951.010</object-id><label>Video 1.</label><caption><title>Cleaning movements of a wild-type fly after being coated in dust.</title><p>This video is related to <xref ref-type="fig" rid="fig1">Figure 1</xref>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.02951.010">http://dx.doi.org/10.7554/eLife.02951.010</ext-link></p></caption></media></p></sec><sec id="s2-2"><title>Grooming behavior is modular</title><p>The modularity of grooming is evident from observations that individual cleaning movements can be evoked by locally applied stimuli (<xref ref-type="bibr" rid="bib44">Vandervorst and Ghysen, 1980</xref>; <xref ref-type="bibr" rid="bib9">Corfas and Dudai, 1989</xref>). This led us to ask whether grooming movements are modular enough to be activated independently in the brain. We expressed the temperature-sensitive cation channel dTrpA1 (<italic>UAS-dTrpA1</italic>) (<xref ref-type="bibr" rid="bib17">Hamada et al., 2008</xref>) in different enhancer-driven GAL4 expression patterns in the nervous system (<xref ref-type="bibr" rid="bib22">Jenett et al., 2012</xref>) and screened for grooming phenotypes (see ‘Materials and methods’ for details). Using this method to activate neurons targeted by different GAL4 lines, we discovered that grooming movements could indeed be independently activated in the absence of dust. We identified different GAL4 lines that caused exclusive cleaning of each body part, including the head, abdomen, wings, and legs (<xref ref-type="fig" rid="fig2">Figure 2</xref>, <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>, <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>; see <xref ref-type="other" rid="video2">Video 2</xref>, <xref ref-type="other" rid="video3">Video 3</xref>, <xref ref-type="other" rid="video4">Video 4</xref>, <xref ref-type="other" rid="video5">Video 5</xref>, <xref ref-type="other" rid="video6">Video 6</xref>, <xref ref-type="other" rid="video7">Video 7</xref>, <xref ref-type="other" rid="video8">Video 8</xref>, and <xref ref-type="other" rid="video9">Video 9</xref> for representative videos and more detail regarding the behavioral phenotypes). Some lines we identified drove cleaning of different body subparts such as the antennae, in agreement with our observations that flies precisely target cleaning of different regions of the head (<xref ref-type="fig" rid="fig2">Figure 2</xref>, R26B12). Although these lines were sufficient for driving highly specific cleaning movements, we did not find evidence that blocking the activity of their targeted neurons could disrupt dust-induced grooming (tested using the neural inhibitors <italic>UAS-Shibire</italic><sup><italic>ts1</italic></sup> or <italic>UAS-TNT</italic>, data not shown). This suggests that the targeted neurons are sufficient but not necessary for driving their respective cleaning movements. All lines tested could activate continuous cleaning of their corresponding body parts for long periods of time (at least 25 min). Thus, grooming can be decomposed into specific motor programs (hereafter referred to as cleaning modules) that can be independently activated by subsets of neurons. Experimental induction of these cleaning modules via GAL4-expressed dTrpA1 allowed us to directly test how they are sequentially executed during the progression of grooming.<fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.02951.011</object-id><label>Figure 2.</label><caption><title>Activation of <italic>UAS-dTrpA1</italic> in different GAL4 lines is sufficient to activate discrete cleaning movements in the absence of dust.</title><p>Cleaning movement activation phenotypes driven by 12 GAL4 lines expressing <italic>UAS-dTrpA1</italic>. Flies (including controls) were warmed to 30°C to activate the targeted neurons while their cleaning movements were recorded and manually scored (n = 10 flies/GAL4 line; 130 flies total). Ethograms of the scored behaviors are displayed by compressing all mutually exclusive events to a single line per fly. Colors below the movement names correspond to those on the ethograms. White space in each ethogram represents the time flies spent walking or standing in place. The GAL4 lines are grouped into four cleaning movement categories: head, abdomen, thorax and/or wings, and legs. The grid displays increases and decreases from control flies in the fraction of time each line spent performing different cleaning movements. Grid heat map represents the p-values for the comparisons of the different GAL4 lines and control flies (Kruskal–Wallis followed by Mann–Whitney U pairwise tests and Bonferroni correction). Note: R71C07 displays significant increases in both abdominal cleaning and leg rubbing. Although this line is shown in the abdominal cleaning category, it could also be included with leg rubbing. Lines labeled in red are used in experiments shown in <xref ref-type="fig" rid="fig3">Figure 3</xref> and <xref ref-type="fig" rid="fig5">Figure 5</xref>. See <xref ref-type="other" rid="video2">Video 2</xref>, <xref ref-type="other" rid="video3">Video 3</xref>, <xref ref-type="other" rid="video4">Video 4</xref>, <xref ref-type="other" rid="video5">Video 5</xref>, <xref ref-type="other" rid="video6">Video 6</xref>, <xref ref-type="other" rid="video7">Video 7</xref>, <xref ref-type="other" rid="video8">Video 8</xref>, and <xref ref-type="other" rid="video9">Video 9</xref> for representative videos and more description of the activation phenotypes of these lines.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.02951.011">http://dx.doi.org/10.7554/eLife.02951.011</ext-link></p></caption><graphic xlink:href="elife-02951-fig2-v1"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.02951.012</object-id><label>Figure 2—figure supplement 1.</label><caption><title>GAL4 lines expressing <italic>UAS-dTrpA1</italic> have different activated cleaning phenotypes at high temperature.</title><p>GAL4 lines expressing <italic>UAS-dTrpA1</italic> were recorded when the heated plate reached 21°C, 30°C, and then back to 21°C for 2 min. Their cleaning movements were manually scored (10 flies/GAL4 line; 130 flies total). Ethograms of the scored behaviors are displayed as described in <xref ref-type="fig" rid="fig2">Figure 2</xref>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.02951.012">http://dx.doi.org/10.7554/eLife.02951.012</ext-link></p></caption><graphic xlink:href="elife-02951-fig2-figsupp1-v1"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.02951.013</object-id><label>Figure 2—figure supplement 2.</label><caption><title>Anatomy of GAL4 lines used to activate distinct cleaning movements.</title><p>Expression patterns of the brains and ventral nerve cords of GAL4 lines expressing a green fluorescent protein reporter (20x<italic>UAS-mCD8::GFP</italic> (JFRC7)). Maximum projections of confocal images are shown. The neuropile is visualized using an anti-bruchpilot antibody (magenta). White scale bars, 100 μm. <italic>UAS-dTrpA1</italic>-activation phenotypes are listed with the name of each GAL4 line.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.02951.013">http://dx.doi.org/10.7554/eLife.02951.013</ext-link></p></caption><graphic xlink:href="elife-02951-fig2-figsupp2-v1"/></fig></fig-group><media content-type="glencoe play-in-place height-250 width-310" id="video2" mime-subtype="mov" mimetype="video" xlink:href="elife-02951-media2-v1.mov"><object-id pub-id-type="doi">10.7554/eLife.02951.014</object-id><label>Video 2.</label><caption><title>Activated eye and head cleaning (R23A07-GAL4 / UAS-dTrpA1).</title><p>This video is related to <xref ref-type="fig" rid="fig2">Figure 2</xref>. Activated at 30°C. Displayed minor walking defect that was unrelated to the cleaning phenotype.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.02951.014">http://dx.doi.org/10.7554/eLife.02951.014</ext-link></p></caption></media><media content-type="glencoe play-in-place height-250 width-310" id="video3" mime-subtype="mov" mimetype="video" xlink:href="elife-02951-media3-v1.mov"><object-id pub-id-type="doi">10.7554/eLife.02951.015</object-id><label>Video 3.</label><caption><title>Activated whole head cleaning (R40F04-GAL4/UAS-dTrpA1).</title><p>This video is related to <xref ref-type="fig" rid="fig2">Figure 2</xref>. Activated at 30°C. No other overt phenotypes were observed.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.02951.015">http://dx.doi.org/10.7554/eLife.02951.015</ext-link></p></caption></media><media content-type="glencoe play-in-place height-250 width-310" id="video4" mime-subtype="mov" mimetype="video" xlink:href="elife-02951-media4-v1.mov"><object-id pub-id-type="doi">10.7554/eLife.02951.016</object-id><label>Video 4.</label><caption><title>Activated antennal cleaning (R26B12-GAL4/UAS-dTrpA1).</title><p>This video is related to <xref ref-type="fig" rid="fig2">Figure 2</xref>. Activated at 30°C. No other overt phenotypes were observed.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.02951.016">http://dx.doi.org/10.7554/eLife.02951.016</ext-link></p></caption></media><media content-type="glencoe play-in-place height-250 width-310" id="video5" mime-subtype="mov" mimetype="video" xlink:href="elife-02951-media5-v1.mov"><object-id pub-id-type="doi">10.7554/eLife.02951.017</object-id><label>Video 5.</label><caption><title>Activated abdominal cleaning (R24B03-GAL4/UAS-dTrpA1).</title><p>This video is related to <xref ref-type="fig" rid="fig2">Figure 2</xref>. Activated at 30°C. No other overt phenotypes were observed.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.02951.017">http://dx.doi.org/10.7554/eLife.02951.017</ext-link></p></caption></media><media content-type="glencoe play-in-place height-250 width-310" id="video6" mime-subtype="mov" mimetype="video" xlink:href="elife-02951-media6-v1.mov"><object-id pub-id-type="doi">10.7554/eLife.02951.018</object-id><label>Video 6.</label><caption><title>Activated wing cleaning (R53A06-GAL4/UAS-dTrpA1).</title><p>This video is related to <xref ref-type="fig" rid="fig2">Figure 2</xref>. Activated at 30°C. No other overt phenotypes were observed.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.02951.018">http://dx.doi.org/10.7554/eLife.02951.018</ext-link></p></caption></media><media content-type="glencoe play-in-place height-250 width-310" id="video7" mime-subtype="mov" mimetype="video" xlink:href="elife-02951-media7-v1.mov"><object-id pub-id-type="doi">10.7554/eLife.02951.019</object-id><label>Video 7.</label><caption><title>Activated posterior body cleaning (R45G01-GAL4/UAS-dTrpA1).</title><p>This video is related to <xref ref-type="fig" rid="fig2">Figure 2</xref>. Activated at 30°C. No other overt phenotypes were observed.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.02951.019">http://dx.doi.org/10.7554/eLife.02951.019</ext-link></p></caption></media><media content-type="glencoe play-in-place height-250 width-310" id="video8" mime-subtype="mov" mimetype="video" xlink:href="elife-02951-media8-v1.mov"><object-id pub-id-type="doi">10.7554/eLife.02951.020</object-id><label>Video 8.</label><caption><title>Activated leg rubbing (R17F11-GAL4/UAS-dTrpA1).</title><p>This video is related to <xref ref-type="fig" rid="fig2">Figure 2</xref>. Activated at 30°C. No other overt phenotypes were observed.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.02951.020">http://dx.doi.org/10.7554/eLife.02951.020</ext-link></p></caption></media><media content-type="glencoe play-in-place height-250 width-310" id="video9" mime-subtype="mov" mimetype="video" xlink:href="elife-02951-media9-v1.mov"><object-id pub-id-type="doi">10.7554/eLife.02951.021</object-id><label>Video 9.</label><caption><title>Control for activation experiment (Control/UAS-dTrpA1).</title><p>This video is related to <xref ref-type="fig" rid="fig2">Figure 2</xref>. Activated at 30°C. No phenotypes were observed.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.02951.021">http://dx.doi.org/10.7554/eLife.02951.021</ext-link></p></caption></media></p></sec><sec id="s2-3"><title>Hierarchical suppression mediates the selection of cleaning movements</title><p>We postulated that coating flies with dust leads to the simultaneous stimulation of all the cleaning modules, but because of body mechanical constraints, these competing modules are mutually exclusive and therefore must be performed one at a time. Such temporal conflicts between competing behaviors can be resolved if the performance of one behavior suppresses the others, such that only one is selected at a time (<xref ref-type="bibr" rid="bib11">Davis, 1979</xref>; <xref ref-type="bibr" rid="bib39">Redgrave et al., 1999</xref>; <xref ref-type="bibr" rid="bib28">Kupfermann and Weiss, 2001</xref>; <xref ref-type="bibr" rid="bib26">Kristan, 2008</xref>). Building on this concept, we hypothesized that asymmetries in intermodular suppression could underlie biases in the preferred order of execution. Specifically, we hypothesized that a suppression hierarchy between cleaning modules could mediate fly grooming priorities. In this schema, the ability of the cleaning modules to suppress each other forms a hierarchy in which modules ‘higher’ in the hierarchy are able to suppress ‘lower’ modules, but not vice-versa. For this hypothesis to account for the fly grooming progression, the order of suppression within the hierarchy would have to match the order of the normal grooming sequence, as schematized (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). Thus, in a completely dusted fly, the most hierarchically superior module is able to suppress all the other competing modules, the second highest module can suppress all but the first one, and so on.<fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.02951.022</object-id><label>Figure 3.</label><caption><title>Hierarchical suppression and dust stimulus drive cleaning movement selection.</title><p>Cleaning of specific body parts was artificially activated while flies were dusted to stimulate competition between their cleaning movements. Flies were pre-warmed at 30°C such that the dTrpA1-induced cleaning module was active at the time of dusting. After grooming for 25 min, flies were anesthetized and their dust patterns were measured. (<bold>A</bold>) Grid showing the expected suppression pattern if the hierarchical suppression hypothesis is true. Modules are arranged on the grid in the order that they occur in the normal grooming sequence. (<bold>B</bold>) The observed suppression hierarchy. For each line, the normalized fraction of dust remaining on different regions of the flies is mapped onto the corresponding grid locations (n ≥ 26 per body part, ‘Materials and methods’). The module activated by each GAL4 line is listed above the line name. Data used to generate the grid is shown in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>. (<bold>C</bold>) Cleaning movements performed when a GAL4/dTrpA1-activated module is shut off. Arrows from <bold>B</bold> to each row in <bold>C</bold> show the GAL4 line and corresponding dust distribution that was tested. The grid displays increases from control flies in the frequencies of different cleaning movements performed in the first 3 minutes after shutting off dTrpA1 (n = 10 flies per line). Grid heat map represents the p-values for the comparisons of the different GAL4 lines and control flies (Kruskal–Wallis followed by Mann–Whitney U pairwise tests and Bonferroni correction). Movements were manually scored. All head cleaning movements are binned and displayed as whole head, because eye and antennal cleaning are not easily distinguishable in the dusted state. Control and experimental flies performed few thoracic cleaning bouts and are therefore not shown.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.02951.022">http://dx.doi.org/10.7554/eLife.02951.022</ext-link></p></caption><graphic xlink:href="elife-02951-fig3-v1"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.02951.023</object-id><label>Figure 3—figure supplement 1.</label><caption><title>Dust patterns resulting from coating flies in dust and artificially activating specific cleaning movements.</title><p>(<bold>A</bold>) Dust patterns of <italic>UAS-dTrpA1</italic>-activated cleaning lines 25 min after dusting (described in <xref ref-type="fig" rid="fig3">Figure 3</xref>). Average dust patterns are displayed as previously described in <xref ref-type="fig" rid="fig1">Figure 1B</xref>. (<bold>B</bold>) Distribution plots of quantified dust pattern data. Each point on the plots represents the number of yellow pixels from the body part sample images. The mean is shown as a red line, 1.96 SEM (95% confidence interval) is in red, 1 SD is blue. <italic>UAS-dTrpA1</italic>-activation phenotypes are listed with the name of each GAL4 line. Control flies show remaining dust levels when no module activated. Data shown here is compiled and plotted in <xref ref-type="fig" rid="fig3">Figure 3B</xref>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.02951.023">http://dx.doi.org/10.7554/eLife.02951.023</ext-link></p></caption><graphic xlink:href="elife-02951-fig3-figsupp1-v1"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.02951.024</object-id><label>Figure 3—figure supplement 2.</label><caption><title>Behaviors of flies that were coated in dust while specific cleaning movements were artificially activated.</title><p>Flies were pre-warmed at 30°C such that the dTrpA1-activated cleaning movement was being performed at the time of dusting. They were shaken with or without dust and allowed to groom while their cleaning movements were recorded for behavioral analysis. (<bold>A</bold>) Representative manually annotated ethograms of GAL4 lines expressing dTrpA1 that were shaken with and without dust. The most common mutually exclusive movements performed by individual flies are displayed. R53A06 and R45G01 were not scored beyond 15 min because they had already progressed through the cleaning sequence. (<bold>B</bold>–<bold>E</bold>) Most head cleaning bouts occur at the beginning of grooming both in wild-type flies and when other cleaning movements are artificially activated. Number of cleaning movements for each major body part in 100 s intervals after flies were shaken without or with dust (plotted as the mean ± SEM; n = 5). Different lines displayed are: control (<bold>B</bold>), R40F04-GAL4/<italic>UAS-dTrpA1</italic> (head cleaning) (<bold>C</bold>), R24B03-GAL4/<italic>UAS-dTrpA1</italic> (abdominal cleaning) (<bold>D</bold>), R53A06-GAL4/<italic>UAS-dTrpA1</italic> (wing cleaning) (<bold>E</bold>). Artificially activated movements are displayed as lines with filled circles at each time interval. Dust stimulated cleaning movements (not artificially activated) are shown as lines with no filled circles. All head cleaning movements are combined (labeled whole head). Friedman tests show a statistical difference between points in each head cleaning curve with dusted flies. This demonstrates that the numbers of head cleaning bouts at the beginning of grooming are higher than those at the end of the time course (p values for each line shown as undusted, dusted). Control (p = 0.817, p = 0.0004), R40F04 (p = 0.147, p = 0.00008), R24B03 (p = 0.3038, p = 0.0038), R53A06 (p = 0.0599, p = 0.0027). Other GAL4 lines showed similar results to these examples.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.02951.024">http://dx.doi.org/10.7554/eLife.02951.024</ext-link></p></caption><graphic xlink:href="elife-02951-fig3-figsupp2-v1"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.02951.025</object-id><label>Figure 3—figure supplement 3.</label><caption><title>Triggering of cleaning movements is dust dependent.</title><p>This experiment was designed to test between two possible mechanisms for the sequential induction of cleaning movements. One possibility is that activation of a preceding cleaning movement and its subsequent deactivation triggers the next movement. Alternatively, the next movement is completely determined by the distribution of dust on the body. (<bold>A</bold> and <bold>B</bold>) Cleaning movements performed during the first 3 min after the flies were cooled. GAL4 lines expressing <italic>UAS-dTrpA1</italic> were shaken without (<bold>A</bold>) or with (<bold>B</bold>) dust and treated as described in the results. Movements were recorded and manually scored (n = 10 flies per line per treatment). Ethograms of the scored behaviors are displayed by compressing all mutually exclusive events to a single line for each fly. <italic>UAS-dTrpA1</italic>-activation phenotypes are listed with the name of each GAL4 line. (<bold>C</bold> and <bold>D</bold>) Bar graphs of the frequencies of different movements in the first 3 min after flies were cooled that were undusted (<bold>C</bold>) or dusted (<bold>D</bold>) (plotted as the mean ± SEM; n = 10). Head cleaning sub movements are all binned because they are not easily distinguishable from one another when flies are dusted (labeled whole head). Asterisks show samples that were significantly different from control from a Kruskal–Wallis test followed by Mann–Whitney U pairwise tests and Bonferroni correction (p &lt; 0.05). Note that R23A07 and R40F04 showed increases in posterior cleaning movements that were not dust dependent. However, these movements were not increased to the same frequencies as those observed when the flies were dusted and cooled. Data shown in <bold>D</bold> is compiled and displayed in <xref ref-type="fig" rid="fig3">Figure 3C</xref>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.02951.025">http://dx.doi.org/10.7554/eLife.02951.025</ext-link></p></caption><graphic xlink:href="elife-02951-fig3-figsupp3-v1"/></fig></fig-group></p><p>Our GAL4 lines allowed us to test this hierarchical suppression hypothesis by artificially driving cleaning of specific body parts while simultaneously dusting the flies to induce competing cleaning movements. For this experiment, we selected lines that could induce a particular cleaning module and lacked additional phenotypes that might confound our grooming-specific interpretations (<xref ref-type="fig" rid="fig2">Figure 2</xref>, lines labeled in red, <xref ref-type="other" rid="video2">Video 2</xref>, <xref ref-type="other" rid="video3">Video 3</xref>, <xref ref-type="other" rid="video4">Video 4</xref>, <xref ref-type="other" rid="video5">Video 5</xref>, <xref ref-type="other" rid="video6">Video 6</xref>, <xref ref-type="other" rid="video7">Video 7</xref>, <xref ref-type="other" rid="video8">Video 8</xref>, and <xref ref-type="other" rid="video9">Video 9</xref>). <xref ref-type="fig" rid="fig3">Figure 3B</xref> illustrates the outcome of these experiments, which matched the prediction of the hierarchical suppression hypothesis (compare <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1A</xref> to <xref ref-type="fig" rid="fig3">Figure 3B</xref>). For example, when a fly carrying a GAL4 driver that activates abdominal cleaning (R24B03) was stimulated in the presence of whole-body dust, it first cleaned the head, then abdomen (just as wild-type flies do), but then persisted in cleaning its abdomen instead of proceeding to its wings and thorax (<xref ref-type="fig" rid="fig3">Figure 3B</xref>, <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2A,D</xref>, see R24B03). This demonstrates that abdominal cleaning is below head cleaning but above wing and thoracic cleaning in the suppression hierarchy. In contrast, flies carrying GAL4 drivers that activate head cleaning (R23A07, R40F04, R26B12) failed to remove dust from their posterior body, consistent with the hypothesis that the behavior would suppress posterior cleaning modules (<xref ref-type="fig" rid="fig3">Figure 3B</xref>, <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). GAL4 lines that activated abdominal (R24B03), wing (R53A06), or all posterior cleaning modules (R45G01) showed little impairment in removing dust from their heads (<xref ref-type="fig" rid="fig3">Figure 3B</xref>, <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>, see R24B03, R53A06, and R45G01). Like wild-type flies, these GAL4 lines cleaned their heads at the onset of dusting, indicating that the normal progression of cleaning was preserved up to the point where it was blocked (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2A,D,E</xref>, see R24B03, R53A06, and R45G01). This demonstrates that the ‘endogenously’ produced (dust stimulated) head-cleaning module suppressed strong, artificially activated abdominal, wing, and thoracic cleaning. The fact that head cleaning suppresses other movements through both artificial and endogenous activation argues against the possibility that suppression was an artifact of dTrpA1 activation. These results support our hypothesis that the cleaning modules are competing for output via an intermodular suppression that favors those that are hierarchically superior. The full suppression hierarchy of cleaning modules is: eyes &gt; antennae &gt; abdomen &gt; wings &gt; thorax, which mirrors the serial order of grooming observed in dusted flies.</p></sec><sec id="s2-4"><title>Sequential activation and termination of cleaning movements is mediated by dust on each body part</title><p>Although the priority order of cleaning module execution can be attributed to a suppression hierarchy, the sequential progression of grooming requires the termination of the hierarchically superior cleaning module followed by selection of the next module. One possible explanation for the observed progression is that each module sequentially triggers the next module in the series, analogous to an activation chain (<xref ref-type="bibr" rid="bib21">James, 1890</xref>; <xref ref-type="bibr" rid="bib1">Adams, 1984</xref>). We tested this possibility using the GAL4 lines to elicit different cleaning modules in the absence of dust to see if activation of one cleaning module would stimulate execution of the next module. We found that activation and subsequent acute deactivation of neurons that controlled a given cleaning module did not directly elicit the next module in the grooming sequence (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3A,C</xref>). This indicated that an activation chain among the cleaning modules is not sufficient to direct the progression of grooming. This conclusion is supported by observations that cleaning movements are only directed to the body part that is stimulated and not to other parts (<xref ref-type="bibr" rid="bib44">Vandervorst and Ghysen, 1980</xref>; <xref ref-type="bibr" rid="bib9">Corfas and Dudai, 1989</xref>; <xref ref-type="bibr" rid="bib24">Kays et al., 2014</xref>)</p><p>An alternative way by which grooming could progress is through a combination of the acute sensory cues provided by dust and the intrinsic suppression hierarchy among the cleaning modules. To test this hypothesis, we took advantage of the fact that artificial activation of specific cleaning modules blocks grooming of subordinate body parts (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). Thus, if the cleaning modules are evoked by dust on specific body parts, then flies released from artificial activation should initiate cleaning of the next dirty body part in the hierarchy. We tested this prediction by rapidly cooling the dusted GAL4/<italic>UAS-dTrpA1</italic> flies shown in <xref ref-type="fig" rid="fig3">Figure 3B</xref> to a temperature at which dTrpA1 is inactive, and then observing the first cleaning movements performed. In effect, flies were returned to a normal behavioral state but with different distributions of dust on their bodies (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3A,C</xref>). Indeed, flies resumed cleaning the body part downstream of where the sequence had been blocked (<xref ref-type="fig" rid="fig3">Figure 3C</xref>, <xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3B,D</xref>). For example, flies with clean heads and abdomens, but dirty wings and thoraces, focused on cleaning their wings (<xref ref-type="fig" rid="fig3">Figure 3C</xref>, line R24B03). Thus, cleaning progresses to the next dirty and hierarchically superior part.</p></sec><sec id="s2-5"><title>A parallel model of serial behavior can explain sequential grooming</title><p>We found that hierarchical suppression can mediate the selection of one among many simultaneously stimulated cleaning modules that are in competition for output. Between the proposed models describing how nervous systems execute serial actions, hierarchical suppression through competition is a core feature of parallel response models rather than activation chain models (<xref ref-type="bibr" rid="bib19">Houghton and Hartley, 1995</xref>; <xref ref-type="bibr" rid="bib7">Bullock, 2004</xref>). The general schema for this motor-control strategy for grooming is shown in <xref ref-type="fig" rid="fig4">Figure 4A</xref> and consists of three layers: a sensory layer, a hierarchical layer, and a winner-take-all layer. The sensory layer consists of parallel sensory inputs that each independently activate a specific cleaning module. The hierarchical layer establishes differences in the activation levels between the cleaning modules (described in detail below). The winner-take-all layer then selects the module with the highest activation level by suppressing execution of the other modules. Once a module is selected, the reduced sensory drive that results from cleaning dust from the relevant body part gradually lowers its activation level, thereby allowing cleaning to proceed to whichever module has the next highest activation level (In <xref ref-type="fig" rid="fig4">Figure 4A</xref><bold>,</bold> the removal of dust by a module is represented with blunt arrows from the winner-take-all layer to the dust). Grooming proceeds from the module with the highest activation level to that with the lowest until dust is removed from all of the body parts. This organization leads to the emergence of sequential cleaning of body parts.<fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.02951.026</object-id><label>Figure 4.</label><caption><title>Model of hierarchical suppression results in the sequential progression of grooming.</title><p>(<bold>A</bold>) The dust induced grooming sequence requires three layers: (1) the sensory layer detects dust and independently activates each cleaning module. This is shown as parallel excitatory arrows from each yellow dust cartoon to activate specific cleaning modules. (2) The hierarchical layer determines each module's level of activation when its respective body part is coated in dust. Circle fill levels show theoretical differences in the relative activation levels of the modules. (3) The winner-take-all layer selects the cleaning module that is most active and suppresses all competing responses (‘W’ in this layer shows that the eye cleaning module is selected first). Theoretical all-to-all inhibitory connections in this layer are depicted as a gray box for simplicity. Blunt arrows from the winner-take-all layer to the yellow dust depict that the winning module reduces its own sensory input by cleaning off the dust and consequently becoming less active. The cleaning continues until the activation level of the module is no longer maximal, at which point the transition of cleaning to the new maximally active module occurs. Multiple iterations of this process result in a sequential progression. (<bold>B</bold>–<bold>D</bold>) Computational model simulates possible implementations of the hierarchical layer in establishing the most active modules. Modifications to the hierarchical layer and sensory inputs are depicted in each diagram. In this simulation, the competition is between five different cleaning modules. The ethograms show typical results of the simulation, where each row corresponds to the output of a module. (<bold>B</bold>) Equal sensitivities to dust and no inhibitory connections. (<bold>C</bold>) Modules with varying sensory gain in response to dust: modules with higher sensory gain (depicted with thicker arrows) have higher activation levels in response to the same dust amount. Fill levels represent the relative activity levels of the modules at the first iteration of the simulation. (<bold>D</bold>) Unidirectional lateral inhibitory connections between the modules. For simplicity of illustration, only the nearest-neighbor inhibitory connections are shown; in the computational implementation, each module inhibits all the subordinate modules in the hierarchy (e.g., 2 inhibits 3, 4, and 5). (<bold>E</bold>) Constitutive activation of a single cleaning module. Simulated by setting the amount of dust on a particular body part to completely dirty after each round of cleaning (depicted with the red arrow). (<bold>F</bold>) Constitutive activation of a single cleaning module in the presence of dust on all body parts.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.02951.026">http://dx.doi.org/10.7554/eLife.02951.026</ext-link></p></caption><graphic xlink:href="elife-02951-fig4-v1"/></fig></p><p>The general strategy of hierarchical suppression can be implemented using two related schemata. We simulated both possible implementations with a computational model to test if they were sufficient to explain the progression of grooming that we observed. The winner-take-all layer is the same for both implementations. Winner-take-all neural networks can be modeled using all-to-all inhibitory connections between the different units; however, conceptually, they simply select the most active unit and inhibit the rest (<xref ref-type="bibr" rid="bib19">Houghton and Hartley, 1995</xref>). In the model presented here, we selected the cleaning module with the highest activation level by using a maximum function (‘Materials and Methods’). The only difference between the two implementations of the model is how the activation level of each cleaning module is set in the hierarchical layer. If no differences are set in the relative activation levels between modules, the result is unordered grooming, with equal probability of the modules occurring (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). Alternatively, the sensitivity to dust (sensory gain) across the modules can be varied, such that their activation levels are proportional to the amount of dust on each body part, weighted by their sensitivity to the dust stimulus (gain of response to the dust stimulus). With this schema, modules with the highest sensory gain had a higher probability of being selected than those with lower gains, reproducing the observed sequence of grooming behavior (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). We see a similar result when the differences in the activation levels of the competing modules arise from unidirectional (asymmetric) lateral inhibitory connections (<xref ref-type="fig" rid="fig4">Figure 4D</xref>). Thus, both simulations produce the sequential selection of cleaning modules observed in grooming behavior. This demonstrates that hierarchical suppression can be established through either variable sensory gain or direct unidirectional inhibition, in conjunction with winner-take-all selection of the module with the highest activation level.</p><p>The model of hierarchical suppression also replicates the returns to previous cleaning modules that we observed with dusted flies (<xref ref-type="fig" rid="fig1">Figure 1E</xref>). Based on the computational model, this occurs when the cleaning modules have relatively similar activation levels. For example, when no hierarchical differences are set among the modules (i.e., <xref ref-type="fig" rid="fig4">Figure 4B</xref>), they are all activated to nearly the same level in response to dust, and their selection is dependent only on slight differences in dust levels on their corresponding body parts. Once selected, a cleaning module reduces dust on its body part, causing its activation level to drop below that of the next cleaning module. That next module is then selected and cleans the associated body part until its own activation level falls below that of another module, and so on. Thus, incremental amounts of dust are removed from body parts while frequent switching occurs among the different modules (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). In the case where a hierarchy is set among the cleaning modules (i.e., <xref ref-type="fig" rid="fig4">Figure 4C–D</xref>), the selection of those that are most hierarchically superior is initially very probable because their activation levels are relatively high in response to the starting amount of dust. As dust is removed, however, these levels among the modules become more similar. This equalization of activation levels through dust removal results in return cleaning by the modules, and the simulations shown in <xref ref-type="fig" rid="fig4">Figure 4C,D</xref> come to more closely resemble that of <xref ref-type="fig" rid="fig4">Figure 4B</xref> as cleaning progresses. Such return cleaning is also seen in wild-type grooming flies, and can thus be explained by our parallel model (<xref ref-type="fig" rid="fig1">Figure 1E</xref>).</p><p>In addition to simulating the grooming progression, the model recapitulates two other important features of our experimental data. First, it can mimic the constitutive cleaning phenotypes of GAL4 lines expressing dTrpA1 in the absence of dust. Constitutive activation was implemented by setting a particular body part to be fully dusted regardless of the amount of cleaning done (as if the sensory neurons were constantly active). This resulted in the continual cleaning of a particular body part without triggering any other cleaning modules (<xref ref-type="fig" rid="fig4">Figure 4E</xref>). Second, the model recapitulates the hierarchical suppression that we observed in our competition experiments (shown in <xref ref-type="fig" rid="fig3">Figure 3A</xref>). Adding dust to all body parts in the presence of the constitutive activation of a module and unidirectional inhibitory connections simulated hierarchical suppression. This leads to sequential cleaning by the hierarchically superior modules, whereas cleaning by the inferior modules was absent, despite the presence of dust (<xref ref-type="fig" rid="fig4">Figure 4F</xref>). Thus, we find close agreement between the experimental results and the model of grooming behavior, both in the progression of cleaning modules down the hierarchical levels and in the ability of modules higher in the hierarchy to suppress the modules below.</p></sec><sec id="s2-6"><title>Hierarchical suppression mediates cyclic transitions between body cleaning and leg rubbing</title><p>Our model explains how the sequential selection of cleaning modules occurs, but could it also explain the frequent alternations between cleaning the body parts and leg rubbing that occur throughout the grooming progression? These alternations are an important and prominent feature in normal grooming behavior for efficient dust removal (<xref ref-type="fig" rid="fig1">Figure 1E,G</xref>, <xref ref-type="fig" rid="fig5">Figure 5A</xref>). In order to simulate the alternations, we considered leg rubbing to be a member of the same suppression hierarchy with the other cleaning modules and ran the model simulation based on two premises (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). First, leg rubbing occurs at all stages of grooming. Therefore, it would necessarily be among the most hierarchically superior of the cleaning modules to be able to suppress cleaning by the others. Second, dust accumulates on the legs while they clean the body parts. This accumulation of dust increases the activation level to the point where leg rubbing is active and the body cleaning modules are subsequently suppressed. The removal of dust from the legs through leg rubbing then reduces suppression on the body cleaning modules and allows cleaning of the corresponding body parts to resume. This cyclic accumulation and removal of dust from the legs during body cleaning could account for the high transition probabilities between the leg and body modules. When we simulated leg rubbing in the model, the sequential progression of body cleaning modules down the hierarchy was preserved (<xref ref-type="fig" rid="fig5">Figure 5C</xref>). The simulation also produced the cyclic alternations between cleaning of a body part and leg rubbing that we observed in our empirically obtained ethograms of wild-type flies (<xref ref-type="fig" rid="fig5">Figure 5C,D</xref>). We conclude that hierarchical relationships among the cleaning modules mediate not only their sequential execution, but also the cyclic transition dynamics between body cleaning and leg rubbing.<fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.02951.027</object-id><label>Figure 5.</label><caption><title>Hierarchical suppression mediates the cyclic transitions between cleaning modules.</title><p>Leg rubbing was simulated in the grooming model based on two features. (1) The legs accumulate dust as they remove it from the body parts. Leg rubbing is subsequently executed to remove that dust. (2) The sensory gain on the legs was set high relative to the other cleaning modules such that they are the most active and selected in the winner-take-all layer when they were sufficiently dirty. (<bold>A</bold>) Ethogram example of a wild-type fly grooming for comparison to the simulation. (<bold>B</bold>) Model of the leg rubbing and body part cleaning cycle (head cleaning example shown). Leg rubbing is hierarchically associated with the body-cleaning modules (similar to the associations among the cleaning modules described in <xref ref-type="fig" rid="fig4">Figure 4</xref>). The only difference between leg rubbing and the other modules is the accumulation of dust on the legs during body part cleaning. This is depicted by a forked connection that removes dust from the head (blunt arrow) and transfers it to the legs (arrow to the leg rubbing module). (<bold>C</bold>) Simulation of grooming with leg rubbing and four body-cleaning modules (result is typical). (<bold>D</bold>) Typical examples of cyclic switching between body cleaning and leg rubbing. The ethogram on the left displays a wild-type fly cleaning its head and the one on the right shows a simulated head-cleaning bout (each example is from early time points in <bold>A</bold> or <bold>C</bold> respectively). (<bold>E</bold>) Average spatial distribution of dust on each body part that remains when flies were coated in dust while leg rubbing was activated (25 min after dusting). V = ventral, D = dorsal.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.02951.027">http://dx.doi.org/10.7554/eLife.02951.027</ext-link></p></caption><graphic xlink:href="elife-02951-fig5-v1"/></fig></p><p>Our model predicts that leg rubbing is among the most hierarchically superior of the cleaning modules. Therefore, if leg rubbing is constitutively activated, it should suppress cleaning of the other body parts in a competition experiment where flies are coated in dust. We tested this prediction by using a GAL4 line that drove strong leg rubbing of both the front and hind legs (<xref ref-type="fig" rid="fig2">Figure 2</xref>, R17F11). When these flies were coated in dust, they were unable to completely clean their bodies, indicating that the body cleaning modules were suppressed (<xref ref-type="fig" rid="fig5">Figure 5E</xref>, <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1B</xref>). This supports the prediction that leg rubbing is part of a grooming suppression hierarchy. However, cleaning of some body parts were suppressed more than others, suggesting that leg rubbing is not the most superiorly positioned module in the suppressive hierarchy. For example, activated leg rubbing did not suppress eye cleaning. This suggests that eye cleaning is at the top of the grooming hierarchy. Additionally, leg rubbing only weakly suppressed cleaning of the abdomen. Given that abdominal cleaning is the most hierarchically superior of the cleaning modules performed by the hind legs, this may suggest that hind leg rubbing and abdominal cleaning are more equal in their positions in the hierarchy. These results indicate that our model can explain the main observed features of the grooming progression, including the sequential cleaning of body parts and the frequent alternations between leg rubbing and body part cleaning.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><sec id="s3-1"><title>Hierarchical suppression and its relationship to behavioral choice</title><p>Hierarchical associations among different available behavioral options allow for those behaviors with the highest value for a given circumstance to be selected while all others are suppressed. These concepts are often referred to as behavioral choice, action selection, motor program selection, or decision making (<xref ref-type="bibr" rid="bib11">Davis, 1979</xref>; <xref ref-type="bibr" rid="bib39">Redgrave et al., 1999</xref>; <xref ref-type="bibr" rid="bib28">Kupfermann and Weiss, 2001</xref>; <xref ref-type="bibr" rid="bib26">Kristan, 2008</xref>). For example, mollusks will suppress mating in order to feed (<xref ref-type="bibr" rid="bib11">Davis, 1979</xref>). This suggests that food is rarer than potential mates, and thus feeding has a higher value than mating. We find that a suppression hierarchy mediates the selection of competing cleaning movements that cannot be executed at the same time. The existence of this hierarchy suggests that inherent values are placed on cleaning the different body parts and selecting one over others represents a ‘best’ choice. Eye cleaning is executed first in response to dust and is the most hierarchically superior cleaning module. This suggests a high value for flies to keep their eyes clear of debris. Because clean legs are necessary for cleaning each body part, their position near the top of the hierarchy is necessary for efficient debris removal. The antennae may have high value to flies because of the number of different sensory modalities that they house (e.g., audition, olfaction, gravity sensing, wind detection) (<xref ref-type="bibr" rid="bib29">Laissue and Vosshall, 2008</xref>; <xref ref-type="bibr" rid="bib23">Kamikouchi et al., 2009</xref>; <xref ref-type="bibr" rid="bib47">Yorozu et al., 2009</xref>; <xref ref-type="bibr" rid="bib5">Böröczky et al., 2013</xref>; <xref ref-type="bibr" rid="bib46">Wilson, 2013</xref>). Keeping the abdomen clear of debris is likely critical for respiration as it contains numerous spiracles (<xref ref-type="bibr" rid="bib38">Phillis et al., 1993</xref>; <xref ref-type="bibr" rid="bib18">Heymann and Lehmann, 2006</xref>). Because of these different values on behavioral motor programs, animals have evolved mechanisms for selecting the most favorable option and suppressing others.</p><p>A significant finding of this work is the experimental demonstration that hierarchical suppression among many behaviors leads to the emergence of a sequence. Although much attention has focused on the role of hierarchical suppression in selecting between behavioral choices, there is little experimental evidence to support its role as a mechanism for eliciting action sequences. The grooming sequence may be considered as a series of ‘forced choices’ among different competing cleaning modules that are selected in priority order through suppression. As each body part is cleaned, suppression of the other cleaning modules is lifted, and a new round of competition between the remaining cleaning options occurs. Our work lends strong support to an emerging view that hierarchical suppression is a ubiquitous action selection mechanism, whether it is used in deciding among available behavioral choices, or selecting movements performed in complex serial tasks. Thus, the evolutionarily ancient ability to select among competing behaviors through hierarchical suppression may have provided the necessary infrastructure to perform motor actions in sequence (<xref ref-type="bibr" rid="bib19">Houghton and Hartley, 1995</xref>).</p></sec><sec id="s3-2"><title>Relationships between fruit fly grooming and parallel models of serial behavior</title><p>Activation chain and parallel models describe two different mechanisms for generating sequential behavior. Activation chains (sometimes referred to as associative chaining, response chaining, or stimulus-response reflex chaining) are the simplest form of sequential execution. These work through feedforward activation of the next movement by the previous one (<xref ref-type="bibr" rid="bib21">James, 1890</xref>). Parallel models (also known as competitive queuing) select movements through winner-take-all inhibition among the different motor units that are competing for output (<xref ref-type="bibr" rid="bib19">Houghton and Hartley, 1995</xref>; <xref ref-type="bibr" rid="bib7">Bullock, 2004</xref>). Thus, the primary difference between the models is movement selection through either feedforward excitatory or competitive inhibitory mechanisms.</p><p>Two lines of evidence argue against a primary role for an activation chain in driving the dust-induced grooming sequence. First, each cleaning movement can be activated by local stimulation of its respective body part without triggering other movements (<xref ref-type="bibr" rid="bib44">Vandervorst and Ghysen, 1980</xref>; <xref ref-type="bibr" rid="bib9">Corfas and Dudai, 1989</xref>; <xref ref-type="bibr" rid="bib24">Kays et al., 2014</xref>). Either local stimulation (<xref ref-type="fig" rid="fig3">Figure 3C</xref>) or neuronal activation (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3C</xref>) of a particular body part-cleaning module activates only one module and does not trigger the others. Feedforward activation models predict a chain of different cleaning modules once the sequence is triggered rather than just one (<xref ref-type="bibr" rid="bib21">James, 1890</xref>; <xref ref-type="bibr" rid="bib40">Rhodes et al., 2004</xref>). Second, the observed structure of grooming behavior in fully dusted flies is inconsistent with an activation chain model. As flies progressively groom their bodies, the transitions among different cleaning modules are gradual (<xref ref-type="fig" rid="fig1">Figure 1D,E</xref>, <xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4B</xref>, <xref ref-type="fig" rid="fig4">Figure 4B–D</xref>). These gradual transitions are characterized by return cleaning among the modules, meaning that previous cleaning modules are revisited after later modules were already selected. Cleaning modules elicited through feedforward activation are not likely to exhibit such return cleaning, but should produce more deterministic sequences, such as those observed for zebra finch bird song (<xref ref-type="bibr" rid="bib31">Long et al., 2010</xref>). Although it is possible that activation chains mediate some aspects of grooming behavior, our evidence indicates that a parallel model alone is fully sufficient to reproduce major features of the dust-induced grooming sequence (discussed below).</p><p>We find that the grooming sequence has features that are similar to parallel models of serial behavior. Both involve the parallel activation of premotor units in the sequence. The activation of the cleaning modules occurs through dust sensing, where each module is independently stimulated by a dust stimulus on its corresponding body part. Coating the body of the flies in dust leads to the parallel stimulation of the modules, and thus competition among them. Parallel models resolve such simultaneous activation schemes by creating a gradient of activity levels among the units that are executed in the sequence and selecting the one with the highest activity in a winner-take-all network. Our computational model of grooming works through a similar mechanism (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). We find that either differences in the sensory gain of the dust response or unidirectional (asymmetric) lateral inhibitory connections among the modules can generate an activity gradient. The most active cleaning module is selected in the winner-take-all layer while the others are suppressed. Parallel models propose that the sequence progresses when the selected unit is deleted, and a new round of competition and suppression occurs between the remaining units. In grooming, the active module ‘deletes’ itself from the sequence by reducing the dust stimulated sensory drive through cleaning (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). Thus, all of the major features of parallel models are present in our model of sequential grooming behavior (parallel activation, competition, activity gradient, winner-take-all selection, and deletion).</p><p>The finding that grooming behavior displays both sequential and cyclic transitions between modules offers an extension to our understanding of the flexibility of parallel models in producing different types of serial behavior. We found that fruit flies make frequent transitions between body cleaning and leg rubbing and that these oscillations can be explained by the same hierarchical rules as those that govern the sequential progression of the behavior (<xref ref-type="fig" rid="fig5">Figure 5</xref>). The only difference between leg rubbing and body cleaning is that the act of cleaning the body part leads to the transfer of dust to the legs, which then activates leg rubbing (<xref ref-type="fig" rid="fig5">Figure 5D</xref>). The cyclic transfer and removal of the dust input leads to oscillatory behavior. Thus, simple modifications to the infrastructure underlying parallel models could produce different types of transition dynamics between modules (i.e., sequential progression and oscillatory dynamics). This demonstrates that these models can generate behaviors of increasing adaptive complexity.</p><p>Does fruit fly grooming behavior provide insight into the organization of more complex motor sequences? Our model of the grooming progression has features like those proposed to explain learned sequences that also require parallel activation of units that compete for motor output. An example of this was derived from studies of human typing that revealed that adjacent letters in a word were often exchanged in error. This suggested that a plan for all the letters necessary to generate a word was readied prior to typing and that execution of each letter competed for output based on a hierarchical prioritization scheme and winner-take-all competition (<xref ref-type="bibr" rid="bib30">Lashley, 1951</xref>). Such studies led to the proposal of parallel models as a way nervous systems implement sequential behavior (<xref ref-type="bibr" rid="bib19">Houghton and Hartley, 1995</xref>; <xref ref-type="bibr" rid="bib7">Bullock, 2004</xref>). To our knowledge, work presented here provides the first evidence of a parallel model in an innate behavior and suggests that this organization may be more widespread than previously thought. Putting these concepts together with those discussed about behavioral choice leads to the consideration of the possibility that the neural infrastructure driving simple behavioral choice has served as a framework for the evolution of complex sequential behaviors such as typing (<xref ref-type="bibr" rid="bib19">Houghton and Hartley, 1995</xref>). The unifying feature of these vastly different examples of action selection is hierarchical suppression among competing actions. This raises the possibility that the underlying neural circuits have common organizational features.</p></sec><sec id="s3-3"><title>Behavioral models inform circuit studies</title><p>In this study, we took advantage of the modularity of grooming to interrogate its behavioral organization. We gained the experimental control necessary for probing this organization by identifying GAL4 lines that target neurons whose activation drove specific cleaning modules. We show cause and effect experiments indicating that suppressive interactions among the modules govern their selection. Many behaviors are thought to consist of subdivisions of simpler motor programs. This approach of acutely manipulating subcomponents of behaviors and assessing how they affect the other components may prove useful for exploring the organization of other complex motor behaviors.</p><p>Our results do not address the neural circuits that mediate the grooming progression but rather suggest possible types of circuit organization that could underlie its sequential nature. Many complex behaviors are likely to involve hundreds or even thousands of neurons and information about the behavioral organization helps focus circuit-mapping efforts on specific features. For example, one prediction of our model of hierarchical suppression points to unidirectional lateral inhibitory connections among the cleaning modules (<xref ref-type="fig" rid="fig4">Figure 4D</xref>). Previous work has demonstrated that such inhibition can occur through direct inhibitory connections from hierarchically superior behavioral circuits to subordinate competing circuits (<xref ref-type="bibr" rid="bib25">Kovac and Davis, 1977</xref>). Therefore, it may be reasonable to search for direct inhibitory connections among the cleaning motor programs. Alternatively, such inhibition among behavioral motor programs may be due to shared neural circuits. In this case, the activity of a behavioral motor program suppresses another, solely because the shared circuit components cannot drive two behaviors at once (<xref ref-type="bibr" rid="bib6">Briggman and Kristan, 2008</xref>). Future experiments will address whether these or other neural circuit mechanisms govern hierarchical inhibition in serial grooming. Thus, the work presented here provides not only a framework for future experiments to understand how neurons and neural circuits mediate serial grooming, but also a basis for extrapolation to analogous organizational logic in other network-driven sequences.</p></sec><sec id="s3-4"><title>Neurons that activate cleaning modules</title><p>The GAL4 lines identified in this study target neurons that activate specific cleaning modules without inducing other behavioral phenotypes. What types of neurons might these GAL4 lines target? Two types that are already implicated in initiating movements are sensory and command neurons. Sensory neurons can activate specific motor programs as the initiators of stimulus-response circuits (<xref ref-type="bibr" rid="bib42">Sherrington, 1906</xref>; <xref ref-type="bibr" rid="bib20">Huston and Jayaraman, 2011</xref>). In fruit fly grooming, mechanosensory neuron-coupled bristles can trigger cleaning responses with mechanical stimulation (<xref ref-type="bibr" rid="bib44">Vandervorst and Ghysen, 1980</xref>; <xref ref-type="bibr" rid="bib9">Corfas and Dudai, 1989</xref>). This suggests that activation of these sensory neurons with dTrpA1 could trigger the specific cleaning modules. Command neurons have been defined as interneurons that are necessary and sufficient for activating specific motor programs (<xref ref-type="bibr" rid="bib27">Kupfermann and Weiss, 1978</xref>). However, the neurons targeted by the GAL4 lines used in this study only show sufficiency for activating cleaning movements as expression of <italic>UAS-Shibire</italic><sup><italic>ts1</italic></sup> or <italic>UAS-TNT</italic> were unable to block cleaning (unpublished data). This may be explained if the GAL4-targeted neurons are those referred to as ‘command-like’ (also known as command systems, decision neurons, or higher order interneurons) (<xref ref-type="bibr" rid="bib28">Kupfermann and Weiss, 2001</xref>; <xref ref-type="bibr" rid="bib26">Kristan, 2008</xref>). These neural types are sufficient to activate particular motor programs but do not necessarily fit the strict criteria of also being necessary. Thus, we propose that sensory neurons, command-like neurons, or both activate the cleaning modules.</p><p>The expression patterns of the GAL4 lines in this study vary in the numbers and types of cells that they target, raising the question as to which neurons in each pattern activate the cleaning modules (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). It is likely that the lines target a mixed population of neurons, where only some are grooming specific. There are examples of GAL4 lines that activate specific behaviors, where only a subset of the neurons within each expression pattern confers the phenotype (<xref ref-type="bibr" rid="bib45">von Philipsborn et al., 2011</xref>; <xref ref-type="bibr" rid="bib32">Luan et al., 2012</xref>). Alternatively, the enhancer fragments used in generating the GAL4 lines might target expression to many different types of neurons involved in the same behavior (<xref ref-type="bibr" rid="bib36">Pfeiffer et al., 2008</xref>). For example, the <italic>fruitless</italic> gene is expressed in 1500 neurons of different types that comprise elements of a courtship circuit (<xref ref-type="bibr" rid="bib48">Yu et al., 2010</xref>). Activation of this population of <italic>fruitless</italic> neurons with dTrpA1 is sufficient to trigger courtship behavior (<xref ref-type="bibr" rid="bib35">Pan et al., 2011</xref>). Further refinement of the expression patterns driven by the GAL4 line enhancers will allow us to distinguish between these possibilities. Thus, we anticipate that identifying the neural circuitry for each cleaning module and determining how these circuitries interact will reveal how the serial organization of grooming behavior is encoded in the nervous system through a hierarchical suppression mechanism.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Fly stocks and rearing conditions</title><p>Canton S flies were obtained from Martin Heisenberg's lab in Wurzburg, Germany. GAL4 stocks were generated in Gerry Rubin's lab at Janelia Research Campus by methods described previously (<xref ref-type="bibr" rid="bib36">Pfeiffer et al., 2008</xref>) and are available at the Bloomington stock center (<xref ref-type="bibr" rid="bib22">Jenett et al., 2012</xref>). BDPGAL4U was used as a control for the GAL4 lines in our experiments and contains the vector backbone used to generate the GAL4 collection (including GAL4) but lacks an enhancer to drive its expression. <italic>UAS-dTrpA1</italic> (on the second chromosome) was obtained from Paul Garrity at Brandeis University (<xref ref-type="bibr" rid="bib17">Hamada et al., 2008</xref>). 20x<italic>UAS-mCD8::GFP</italic> (JFRC7) was constructed as described in <xref ref-type="bibr" rid="bib37">Pfeiffer et al. (2010)</xref>. GAL4 lines were crossed to their respective UAS drivers, and both the parents and their progeny were maintained using the following conditions. Flies were reared at 21–22°C and 50% relative humidity using a 16/8 hr light/dark cycle on standard cornmeal and molasses food. All experiments were done with 5- to 8-day-old males.</p></sec><sec id="s4-2"><title>Grooming apparatus</title><p><italic>Multiwell grooming chambers</italic>: blocks of grooming chambers were designed to facilitate the parallel and uniform dusting of flies for dust pattern measurements and recording videos of cleaning behavior. Blocks were fabricated with 24 or 96 grooming chambers (15.6 mm or 7 mm diameters respectively) and have connector ends and dust removal ends. The connector end has tracks for thin aluminum sliders that gate each chamber to facilitate fly loading (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). The dust removal end consists of a Nitex mesh-covered opening that allows free dust to exit the chamber while preventing flies from escaping (Genesee Scientific Corporation, San Diego, California, 630 μm mesh). Chambers were printed on a 3D printer. <italic>24-well aluminum chambers (for cooling experiments)</italic>: aluminum chambers were identical to those described above, with the exception that the dust removal end was closed such that flies would stand directly on the aluminum (shown in <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1E,F</xref>). These chambers were fabricated for rapid cooling of flies to quickly shut off dTrpA1-activated behaviors. Design plans for the grooming chambers are available in <xref ref-type="supplementary-material" rid="SD1-data">Supplementary file 1</xref>.</p></sec><sec id="s4-3"><title>Dusting flies for body surface imaging or video recordings</title><p>All experiments were carried out in a warm room that was set to 30–32°C. Flies were cold anesthetized (1–2°C), transferred to grooming chambers (single fly per chamber), and allowed to recover for at least 15 min before assaying. Flies were tapped from the chambers into multiwell plates containing measured amounts of Reactive Yellow 86 dust (Organic Dyestuffs Corporation, Concord, North Carolina) and shaken to uniformly coat each fly (<xref ref-type="bibr" rid="bib38">Phillis et al., 1993</xref>). Excess dust was removed by tapping the flies against the mesh on the dust removal end of the grooming block. The flies were then allowed to clean in the chambers with the mesh side down to allow dust to exit. Video recordings of flies were made with a clear acrylic plug covering the adaptor end of the chamber (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1D</xref>). Grooming was terminated at different time points by anesthetizing the flies with CO<sub>2</sub>. 0-min time samples were obtained by dusting the flies and immediately anesthetizing them. Data were acquired from at least four separate crosses. 25 min was chosen as the assay end because most body parts were clean at that point.</p></sec><sec id="s4-4"><title>Quantification of body surface dust patterns</title><p>Dusted flies were prepared as described above and dissected for imaging of their dust patterns. The dissection procedure made it impossible to image the entire body surface of a single fly. Each part was dissected as described below. <italic>Heads:</italic> flies were decapitated using a razor blade, and the heads were affixed face up to a cover slip with double-sided tape (3M Corporation, St. Paul, Minnesota). <italic>Wings:</italic> the left (lateral) wings were removed by grasping the base with a pair of forceps and pulling it off with an adjacent pair of forceps. They were affixed dorsal side up to a cover slip with double-sided tape. <italic>Ventral abdomen:</italic> dissected and imaged shortly after performing grooming assays because the abdomens desiccated quickly. Flies were held on their sides with a scalpel inserted between the head and thorax while all legs and wings were removed. The scalpel was then used to decapitate the fly. Next, the thorax and dorsal abdomen were glued to a cover slip such that the ventral abdomen was facing up using Elmer's No-Wrinkle Rubber Cement (Elmer’s Products, Inc., Columbus, Ohio). <italic>Dorsal abdomen:</italic> flies were held on their sides and the ventral side of the thorax and legs were severed from the dorsal side along a plane that was parallel to the abdomen. The wings were removed and the abdomen was glued dorsal side up. <italic>Thoraces:</italic> no dissection was necessary for imaging thoraces. They were imaged in specially designed chamber that would hold all flies uniformly dorsal side up. Standard preparations and example dirty samples for each body part are displayed in <xref ref-type="fig" rid="fig1">Figure 1B</xref>.</p><p>Body parts were imaged using a Zeiss SteREO Discovery.V12 equipped with an Achromat S 1.0× objective (Carl Zeiss Corporation, Oberkochen, Germany). Heads, abdomens, wings, and thoraces were imaged at 80×, 60×, 65×, and 60× respectively. Z-series were taken and the images were converted into a single, in focus, image with Zeiss AxioVision software using the Extended Focus module (<xref ref-type="fig" rid="fig1">Figure 1B</xref>, <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2A</xref>). Experimental images were manually warped to standard images (see standards and experimental examples <xref ref-type="fig" rid="fig1">Figure 1B</xref>) using the Photoshop transform tool to ensure that the coordinates on each image corresponded to the same location (Adobe Systems Incorporated, San Jose, California). Yellow dust patterns were isolated from each experimental image using the Photoshop color range tool and converted to grayscale. The contrast was then adjusted to 100% to set all dust pixels to a 255 grayscale value (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2B</xref>). To visually display the average dust patterns, we used custom Matlab (MathWorks, Inc., Natick, Massachusetts) code (Groomogram) to generate average projections (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2C</xref>, code included as <xref ref-type="supplementary-material" rid="SD2-data">Source code 1</xref>). Groomogram code works by averaging the grayscale pixel values (0 = no dust/255 = dust) for each pixel coordinate from all experimental images. The average pixel values for the entire image were converted to grayscale colormaps that represent the percent of flies with dust at a particular pixel coordinate (<xref ref-type="fig" rid="fig1">Figure 1B</xref>, <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2D</xref>).</p><p><italic>Calculating normalized dust pixels in a specified region</italic>: pixels with 255 grayscale values (dust pixels), and located within the regions designated by standard masks were counted for each image (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3A,B</xref>). The fractions of dust pixels per total number of pixels in each region as defined by the masks were calculated for each image sample. Normalization in <xref ref-type="fig" rid="fig1">Figure 1D</xref> was calculated as follows: fractions of dust pixels per sample were divided by the mean of the zero time point samples for each body part. Standard error was calculated from these values. Normalization in <xref ref-type="fig" rid="fig3">Figure 3B</xref> was calculated as follows: average dust pixel fractions per body region were divided by the maximum mean value for each body part. The ventral and dorsal abdominal data were combined for display in <xref ref-type="fig" rid="fig3">Figure 3B</xref> by calculating the mean of their normalized values.</p></sec><sec id="s4-5"><title>Behavioral recordings</title><p><italic>Camera setup</italic>: an Edmund Optics 1312C color USB camera (Edmund Optics Corporation, Barrington, New Jersey) equipped with a Computar 25 mm f1.4 lens and an EX2C extender for C-mount (CBC AMERICA Corporation, Commack, New York) was used to record flies at 30 frames per second. <italic>dTrpA1 behavioral analysis (undusted flies)</italic>: this method was used for recording the flies shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>. Flies were cold anesthetized at 1–2°C and placed into a 3 mm high and 13 mm diameter arena sitting directly on a teca solid state heat/cool cold plate (TECA Corporation, Chicago, Illinois). The flies were allowed at least 5 min to recover from the cold anesthesia and then recorded for 2 min when the cold plate temperature sensor read 21°C, 30°C, and then 21°C (post activation analysis) (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). <italic>Dusted experiments:</italic> Canton S or GAL4/<italic>UAS-dTrpA1</italic> flies were dusted individually in 24-well grooming chambers as described above. An acrylic plug was inserted into the hole on the adapter end and the aluminum slider was removed such that the fly could be recorded (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1D</xref>). Flies were also shaken without dust and recorded as a control for the behavioral effects of the shaking. <italic>Dusted/cooled experiments:</italic> flies were shaken with or without dust, allowed to groom for 25 min at 30°C, cooled to 18°C, and their behavior was recorded for 3 min. After grooming for 24 min at 30°C, the flies were transferred to a 24-well aluminum grooming block that was preheated to 30°C. Just before 25 min, an acrylic plug was placed over the chamber opening and the block was placed on a TECA cold plate that was set to 18°C to rapidly cool the flies and shut off the dTrpA1 channel. Cleaning movements were scored for 3 min starting when the plate touched the cold plate surface (<xref ref-type="fig" rid="fig3">Figure 3C</xref>, <xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>).</p></sec><sec id="s4-6"><title>Movement scoring guidelines and definitions</title><p>Pre-recorded video was manually scored using Noldus Observer XT 7.0 software (Noldus Information Technology, Wageningen, Netherlands). A list of cleaning movements was compiled and modified from two different studies (<xref ref-type="bibr" rid="bib43">Szebenyi, 1969</xref>; <xref ref-type="bibr" rid="bib12">Dawkins and Dawkins, 1976</xref>). Flies clean their bodies with their front or hind legs as mutually exclusive events (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). Front leg cleaning movements are directed to the head whereas the hind legs clean the abdomen, wings, and thoraces. Starts of cleaning events are defined when the legs are farthest anterior (hind leg movements) or posterior (front leg movements) of the body part before they sweep in the opposite direction. Transitions between movements were included at the end of the preceding movement. Wing cleaning with the hind legs and leg rubbing using the second legs were sometimes asymmetrically performed in that one leg performed cleaning of a particular body part while the contralateral leg was stationary.</p><p><italic>Eye and head cleaning</italic>: legs sweep across the eyes, tops, and bottoms of the head as it is rotated. Most sweeps across the eyes occur in the absence of head rotation. <italic>Antennae</italic>: legs are directed towards the antennal region, often while the head is tilted slightly forward. The legs sometimes grab the antennae and pull them away from the head. <italic>Proboscis</italic>: sweeps down the length of the extended proboscis. The amount of proboscis extension does not factor into the definition as long as it is partially extended or seen moving with the legs. <italic>Ventral head</italic>: legs sweep the ventral side of the head with no proboscis extension. The front legs almost always sweep the bottom of the head/proboscis in parallel. Note, proboscis and ventral head cleaning were binned with eye and head cleaning for simplicity. <italic>Whole head</italic>: all of the head cleaning behaviors described above are binned. The whole head designation was used because it was not possible to distinguish between eye, head, and antennal cleaning when flies were dusted.</p><p><italic>Abdominal cleaning</italic>: legs sweep the ventral or dorsal surface of the abdomen. The hind legs sometimes clean the genitals. This was included as abdominal cleaning for simplicity. <italic>Wing cleaning</italic>: each leg sweeps the ipsilateral dorsal side of the wings simultaneously, or one at a time. Alternatively, both legs clean a single wing with the ipsilateral leg cleaning the dorsal side and the contralateral leg cleaning the ventral side. Sweeping or kicking the ventral part of the wing with one or both legs was also referred to as wing cleaning. In this case, as the legs sweep anterior to posterior, the wings lift away from the body. <italic>Thoracic cleaning</italic>: hind legs sweep the thorax from anterior to posterior with one or both legs.</p><p><italic>Front/hind leg rubbing</italic>: distal parts of the legs are rubbed together. Behavior begins at the moment that the legs touch each other. If the legs stop motion but remain together, it is defined as leg rubbing as long as they do not touch the ground. The middle legs were sometimes rubbed together with the front or the hind legs. This was included with front leg or hind leg rubbing depending on the leg pair being used with the second legs.</p><p><italic>Standing</italic>: fly does not move more than a body length from the original scored position and does not perform any grooming movements. The beginning of standing is scored as soon as the last leg touches the ground. In some cases, the legs did not touch the ground to initiate the behavior and instead was scored at the point where the previous behavior was judged to have ceased. <italic>Walking</italic>: fly steps more than a body length with no pauses in leg movement. Walking is also defined as moving from one of the following locations in the chamber to another (floor, ceiling, or side). The beginning of walking is scored at the moment that one of the front legs initiates a step.</p></sec><sec id="s4-7"><title>Analysis of behavioral data</title><p>Manually scored behavioral video was analyzed as follows. <italic>Bout frequency:</italic> total number of starts of each behavior per fly. <italic>Bout frequency per interval:</italic> bout starts that fell within a designated time interval. <italic>Marginal probability:</italic> the average fraction of total bouts of a particular behavior. <italic>Change from control:</italic> the experimental parameter (either bout frequency or fraction of time) was subtracted from the control. <italic>Statistical test:</italic> control and experimental flies were compared using a Kruskal–Wallis test. Post-hoc Mann–Whitney U pairwise tests were then performed with Bonferroni correction. <italic>Transition probability:</italic> calculated by counting the number of transitions from each behavior to each other behavior. Next, we calculated the fraction of times that behavior i transitioned to behavior j given the total of number of transitions to all behaviors. Therefore, the probability of going from behavior i to all other behaviors sums to 1.</p></sec><sec id="s4-8"><title>Screening and categorizing grooming GAL4 lines</title><p>GAL4 lines used in this study were obtained from a screen designed to identify and manipulate neural circuitry involved in grooming behavior. We used a collection of enhancer-driven GAL4 lines to genetically target different subsets of neurons with the neural activator <italic>UAS-dTrpA1</italic> (<xref ref-type="bibr" rid="bib17">Hamada et al., 2008</xref>; <xref ref-type="bibr" rid="bib36">Pfeiffer et al., 2008</xref>; <xref ref-type="bibr" rid="bib22">Jenett et al., 2012</xref>). Over 1500 GAL4 lines expressing dTrpA1 were manually examined at 30–32°C for increased grooming compared with wild type. We manually scored the movements of 12 identified GAL4 lines that were sufficient to activate strong cleaning movements (<xref ref-type="fig" rid="fig2">Figure 2</xref>). GAL4 lines used in this study were sufficient to activate cleaning movements but not necessary for cleaning dust off their respective body parts. This was revealed by inhibition and dusting experiments using both <italic>UAS-Shibire</italic><sup><italic>ts1</italic></sup> or <italic>UAS-TNT</italic> (data not shown). GAL4 lines expressing GFP were stained and their patterns imaged using previously published methods (<xref ref-type="bibr" rid="bib37">Pfeiffer et al., 2010</xref>).</p></sec><sec id="s4-9"><title>Computational model of hierarchical suppression among competing cleaning modules</title><p>Two neural network architectures were used to simulate the hierarchical suppression among competing cleaning modules: a <italic>sensory gain model</italic> (SGM, <xref ref-type="fig" rid="fig4">Figure 4C</xref>) and a <italic>unidirectional inhibition model</italic> (UIM, <xref ref-type="fig" rid="fig4">Figure 4D</xref>). Both neural networks were implemented using Matlab 7 (code included as <xref ref-type="supplementary-material" rid="SD2-data">Source code 2</xref>). Both networks are based on three layers: sensory layer, hierarchical layer, and winner-take-all layer.</p><p><italic>Sensory and hierarchical layers</italic>: for both network implementations, we defined a vector of <italic>activation levels</italic>, <bold>a</bold>, to represent <italic>N</italic> neural modules (this is the hierarchical layer). For the UIM architecture, the activation levels are initially set to equal the vector of <italic>amounts of dust</italic>, <bold>d</bold> (this is the sensory input layer). The initial amount of dust was set to 0.9 + <italic>r</italic>, where <italic>r</italic> is a random value between 0 and 0.1, sampled from uniform distribution. This noise term is only a factor in <xref ref-type="fig" rid="fig4">Figure 4B</xref> (no hierarchy set among the modules) where slight differences in the relative dust levels determine which module is selected first. While for the SGM architecture, the vector a = dw<sup>s</sup>, where w<sup>s</sup> is the vector of <italic>sensory weights</italic>. In UIM, w<sup>s</sup> is set to one (no sensory gain differences) and vector a is then multiplied by the <italic>N</italic> × <italic>N</italic> weight matrix, W, of which the diagonal = 1, and the upper triangle is populated by equal negative weights, w = −0.5. For SGM, w<sup>s</sup> is set to w<sup>s</sup> = [<italic>w</italic><sub><italic>max</italic></sub><italic>, w</italic><sub><italic>1</italic></sub><italic>, w</italic><sub><italic>2</italic></sub><italic>, … w</italic><sub><italic>min</italic></sub>], which insures that the sensory weights decrease from the first module to the last. Thus, for each iteration <italic>i,</italic> we update the activation levels as follows:<disp-formula id="equ1"><mml:math id="m1"><mml:mrow><mml:msup><mml:mtext>a</mml:mtext><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mtext>d</mml:mtext><mml:mi>i</mml:mi></mml:msup><mml:msup><mml:mtext>w</mml:mtext><mml:mtext>s</mml:mtext></mml:msup><mml:mo>,</mml:mo><mml:mtext>SGM</mml:mtext></mml:mrow></mml:math></disp-formula><disp-formula id="equ2"><mml:math id="m2"><mml:mrow><mml:msup><mml:mtext>a</mml:mtext><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mtext>a</mml:mtext><mml:mi>i</mml:mi></mml:msup><mml:mtext>W</mml:mtext><mml:mo>,</mml:mo><mml:mtext>UIM</mml:mtext></mml:mrow></mml:math></disp-formula></p><p>For simulating no hierarchical differences among the modules (shown <xref ref-type="fig" rid="fig4">Figure 4B</xref>), we set w<sup>s</sup> to 1, and the upper triangle of W to 0.</p><p><italic>Winner-take-all layer</italic>: to simulate removal of dust from the body parts, this layer first finds the module with the highest activation level that was set by SGM or UIM. The position of the module with maximal activation level, <italic>ma,</italic> is determined: <italic>ma</italic> = <italic>max</italic>(a). The winner-take-all layer is then simply a binary vector e containing all zeros and equals 1 only in the position <italic>ma</italic>, thus pointing to the body part where cleaning behavior will be executed. Next, a constant amount of dust, <italic>dr</italic>, is subtracted from the <italic>ma</italic><sup>th</sup> position in vector d (<italic>d</italic><sub><italic>ma</italic></sub>). Thus, for each iteration <italic>i</italic>:</p><disp-formula id="equ3"><mml:math id="m3"><mml:mrow><mml:mi>m</mml:mi><mml:msup><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mi mathvariant="italic">max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mtext>a</mml:mtext><mml:mi>i</mml:mi></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ4"><mml:math id="m4"><mml:mrow><mml:msubsup><mml:mi>d</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:math></disp-formula><p>Note: we did not explicitly simulate the circuitry required for implementation of the winner-take-all layer. Instead, we selected the module with maximal activation level (<italic>ma</italic>) by simply using the Matlab <italic>max()</italic> function. Winner-take-all neural networks can be modeled using all-to-all inhibitory connections between the different modules (<xref ref-type="bibr" rid="bib19">Houghton and Hartley, 1995</xref>). Such explicit simulations of winner-take-all function might capture the empirically observed behavior even better but would require more complex modeling, going beyond the scope of the claims presented in this work.</p><p><italic>Constitutive activation of cleaning modules:</italic> to implement constitutive cleaning of a particular body part, we held the dust level of a given cleaning module constant (at maximum dust level) (<xref ref-type="fig" rid="fig4">Figure 4E,F</xref>). This models the situation where the fly is receiving constant sensory input even in the absence of stimulus.</p><p><italic>Leg rubbing</italic>: to implement leg rubbing, we assumed two pairs of legs. Both pairs were assigned an initial activation level (al; a 2 dimensional vector), which was directly proportional to the amount of dust on legs (dl). For each iteration <italic>i</italic>, we added a small, constant amount of dust to the pair of legs assigned to clean the body part with the maximal activation level (<italic>ma</italic>). If <italic>ma</italic> =&lt; 3 (‘anterior body parts’) the first leg pair was assigned and if <italic>ma</italic> &gt; 3 (‘posterior body parts’) the second leg pair was assigned to collect dust. Therefore, with each grooming iteration, the activation level of the associated pair of legs increases.</p><p>Leg rubbing (removal of dust from legs themselves) is initiated under two conditions: (1) the activation level of the pair crosses a stationary threshold (same for both pairs) and (2) the activation level of the pair is above the activation level of any body part (above <italic>ma</italic>), including the other pair of legs. The latter condition assures that leg rubbing is still part of the competitive hierarchy of cleaning modules (<xref ref-type="fig" rid="fig5">Figure 5C,D</xref>).</p><p><italic>Model output and display</italic>: the output of the model is the position of the cleaning module with the maximum activation level at iteration <italic>i</italic>(<italic>ma</italic><sup><italic>i</italic></sup>). Thus the output is an array with rows corresponding to <italic>ma</italic><sup><italic>i</italic></sup> (active cleaning module) and columns corresponding to iteration <italic>i</italic> (‘time’). This array was used to generate the ethograms shown in <xref ref-type="fig" rid="fig4">Figure 4</xref> and <xref ref-type="fig" rid="fig5">Figure 5</xref>.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank: Gerald Rubin and Lab for access to the GAL4 collection; James Truman for suggestions about quantification of dust patterns; Eric Hoopfer and Kristin Branson for providing Matlab analysis code, discussions on the work, and feedback on the manuscript; Vivek Jayaraman, Roland Strauss, Ulrike Heberlein, Scott Sternson, Adam Hantman, Shaul Druckmann, Stephanie Albin, Claire McKellar, Jon-Michael Knapp, and Carmen Robinett for feedback on the project and manuscript; Janelia Mechanical Engineering and Fabrication group for the grooming chambers; Janelia Fly Core for providing fly stocks; Rachel Wilson for initial guidance on the project; Daniel Bullock for critical discussions; and Stephen Huston for key ideas on parallel models. This work is dedicated to the memory of Frank M Midgley, Jr. (1971–2014), colleague, friend, and partner.</p></ack><sec sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>The authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>AMS, Conception and design, Acquisition of data, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con2"><p>PR, Developed the computational model, Drafting or revising the article</p></fn><fn fn-type="con" id="con3"><p>BDM, Developed the computational model, Drafting or revising the article</p></fn><fn fn-type="con" id="con4"><p>PC, Acquisition of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con5"><p>SH, Drafting or revising the article, Contributed unpublished essential data or reagents</p></fn><fn fn-type="con" id="con6"><p>FMM, Wrote custom software to analyze grooming data, Drafting or revising the article</p></fn><fn fn-type="con" id="con7"><p>JHS, Conception and design, Drafting or revising the article</p></fn></fn-group></sec><sec sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="SD1-data"><object-id pub-id-type="doi">10.7554/eLife.02951.028</object-id><label>Supplementary file 1.</label><caption><p>This file contains design plans for the grooming chambers used in this study (shown in <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.02951.028">http://dx.doi.org/10.7554/eLife.02951.028</ext-link></p></caption><media mime-subtype="pdf" mimetype="application" xlink:href="elife-02951-supp1-v1.pdf"/></supplementary-material><supplementary-material id="SD2-data"><object-id pub-id-type="doi">10.7554/eLife.02951.029</object-id><label>Source code 1.</label><caption><p>This Matlab code was used to display the average projections of dust patterns on the different body parts (shown in <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2C</xref>). Groomogram code works by averaging the grayscale values from multiple images of the same size for each pixel coordinate.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.02951.029">http://dx.doi.org/10.7554/eLife.02951.029</ext-link></p></caption><media mime-subtype="txt" mimetype="text" xlink:href="elife-02951-code1-v1.txt"/></supplementary-material><supplementary-material id="SD3-data"><object-id pub-id-type="doi">10.7554/eLife.02951.030</object-id><label>Source code 2.</label><caption><p>This code for Matlab will simulate dust-induced fly grooming behavior. Simulations are shown in <xref ref-type="fig" rid="fig4">Figure 4</xref> and <xref ref-type="fig" rid="fig5">Figure 5C,D</xref>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.02951.030">http://dx.doi.org/10.7554/eLife.02951.030</ext-link></p></caption><media mime-subtype="txt" mimetype="text" xlink:href="elife-02951-code2-v1.txt"/></supplementary-material></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adams</surname><given-names>JA</given-names></name></person-group><year>1984</year><article-title>Learning of movement sequences</article-title><source>Psychological Bulletin</source><volume>96</volume><fpage>3</fpage><lpage>28</lpage><pub-id pub-id-type="doi">10.1037/0033-2909.96.1.3</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Averbeck</surname><given-names>BB</given-names></name><name><surname>Chafee</surname><given-names>MV</given-names></name><name><surname>Crowe</surname><given-names>DA</given-names></name><name><surname>Georgopoulos</surname><given-names>AP</given-names></name></person-group><year>2002</year><article-title>Parallel processing of serial movements in prefrontal cortex</article-title><source>Proceedings of the National Academy of Sciences of USA</source><volume>99</volume><fpage>13172</fpage><lpage>13177</lpage><pub-id pub-id-type="doi">10.1073/pnas.162485599</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bentley</surname><given-names>D</given-names></name></person-group><year>1975</year><article-title>Single gene cricket mutations: effects on behavior, sensilla, sensory neurons, and identified interneurons</article-title><source>Science</source><volume>187</volume><fpage>760</fpage><lpage>764</lpage><pub-id pub-id-type="doi">10.1126/science.1114323</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bizzi</surname><given-names>E</given-names></name><name><surname>Cheung</surname><given-names>VC</given-names></name><name><surname>d'Avella</surname><given-names>A</given-names></name><name><surname>Saltiel</surname><given-names>P</given-names></name><name><surname>Tresch</surname><given-names>M</given-names></name></person-group><year>2008</year><article-title>Combining modules for movement</article-title><source>Brain Research Reviews</source><volume>57</volume><fpage>125</fpage><lpage>133</lpage><pub-id pub-id-type="doi">10.1016/j.brainresrev.2007.08.004</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Böröczky</surname><given-names>K</given-names></name><name><surname>Wada-Katsumata</surname><given-names>A</given-names></name><name><surname>Batchelor</surname><given-names>D</given-names></name><name><surname>Zhukovskaya</surname><given-names>M</given-names></name><name><surname>Schal</surname><given-names>C</given-names></name></person-group><year>2013</year><article-title>Insects groom their antennae to enhance olfactory acuity</article-title><source>Proceedings of the National Academy of Sciences of USA</source><volume>110</volume><fpage>3615</fpage><lpage>3620</lpage><pub-id pub-id-type="doi">10.1073/pnas.1212466110</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Briggman</surname><given-names>KL</given-names></name><name><surname>Kristan</surname><given-names>WB</given-names><suffix>Jnr</suffix></name></person-group><year>2008</year><article-title>Multifunctional pattern-generating circuits</article-title><source>Annual Review of Neuroscience</source><volume>31</volume><fpage>271</fpage><lpage>294</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.31.060407.125552</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bullock</surname><given-names>D</given-names></name></person-group><year>2004</year><article-title>Adaptive neural models of queuing and timing in fluent action</article-title><source>Trends in Cognitive Sciences</source><volume>8</volume><fpage>426</fpage><lpage>433</lpage><pub-id pub-id-type="doi">10.1016/j.tics.2004.07.003</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clyne</surname><given-names>JD</given-names></name><name><surname>Miesenböck</surname><given-names>G</given-names></name></person-group><year>2008</year><article-title>Sex-specific control and tuning of the pattern generator for courtship song in Drosophila</article-title><source>Cell</source><volume>133</volume><fpage>354</fpage><lpage>363</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2008.01.050</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Corfas</surname><given-names>G</given-names></name><name><surname>Dudai</surname><given-names>Y</given-names></name></person-group><year>1989</year><article-title>Habituation and dishabituation of a cleaning reflex in normal and mutant Drosophila</article-title><source>The Journal of Neuroscience</source><volume>9</volume><fpage>56</fpage><lpage>62</lpage></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Costa</surname><given-names>RM</given-names></name></person-group><year>2011</year><article-title>A selectionist account of de novo action learning</article-title><source>Current Opinion in Neurobiology</source><volume>21</volume><fpage>579</fpage><lpage>586</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2011.05.004</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davis</surname><given-names>WJ</given-names></name></person-group><year>1979</year><article-title>Behavioural hierarchies</article-title><source>Trends in Neurosciences</source><volume>2</volume><fpage>5</fpage><lpage>7</lpage><pub-id pub-id-type="doi">10.1016/0166-2236(79)90003-1</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dawkins</surname><given-names>R</given-names></name><name><surname>Dawkins</surname><given-names>M</given-names></name></person-group><year>1976</year><article-title>Hierarchical organization and postural facilitation: rules for grooming in flies</article-title><source>Animal Behaviour</source><volume>24</volume><fpage>739</fpage><lpage>755</lpage><pub-id pub-id-type="doi">10.1016/S0003-3472(76)80003-6</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fentress</surname><given-names>JC</given-names></name><name><surname>Stilwell</surname><given-names>FP</given-names></name></person-group><year>1973</year><article-title>Letter: grammar of a movement sequence in inbred mice</article-title><source>Nature</source><volume>244</volume><fpage>52</fpage><lpage>53</lpage><pub-id pub-id-type="doi">10.1038/244052a0</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Flood</surname><given-names>TF</given-names></name><name><surname>Gorczyca</surname><given-names>M</given-names></name><name><surname>White</surname><given-names>BH</given-names></name><name><surname>Ito</surname><given-names>K</given-names></name><name><surname>Yoshihara</surname><given-names>M</given-names></name></person-group><year>2013</year><article-title>A large-scale behavioral screen to identify neurons controlling motor programs in the Drosophila brain</article-title><volume>G3</volume><fpage>1629</fpage><lpage>1637</lpage><pub-id pub-id-type="doi">10.1534/g3.113.006205</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gallistel</surname><given-names>CR</given-names></name></person-group><year>1980</year><source>The Organization of action: a new synthesis</source><publisher-loc>Hillsdale</publisher-loc><publisher-name>Lawrence Erlbaum Associates</publisher-name></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grillner</surname><given-names>S</given-names></name><name><surname>Jessell</surname><given-names>TM</given-names></name></person-group><year>2009</year><article-title>Measured motion: searching for simplicity in spinal locomotor networks</article-title><source>Current Opinion in Neurobiology</source><volume>19</volume><fpage>572</fpage><lpage>586</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2009.10.011</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hamada</surname><given-names>FN</given-names></name><name><surname>Rosenzweig</surname><given-names>M</given-names></name><name><surname>Kang</surname><given-names>K</given-names></name><name><surname>Pulver</surname><given-names>SR</given-names></name><name><surname>Ghezzi</surname><given-names>A</given-names></name><name><surname>Jegla</surname><given-names>TJ</given-names></name><name><surname>Garrity</surname><given-names>PA</given-names></name></person-group><year>2008</year><article-title>An internal thermal sensor controlling temperature preference in Drosophila</article-title><source>Nature</source><volume>454</volume><fpage>217</fpage><lpage>220</lpage><pub-id pub-id-type="doi">10.1038/nature07001</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heymann</surname><given-names>N</given-names></name><name><surname>Lehmann</surname><given-names>FO</given-names></name></person-group><year>2006</year><article-title>The significance of spiracle conductance and spatial arrangement for flight muscle function and aerodynamic performance in flying Drosophila</article-title><source>Journal of Experimental Biology</source><volume>209</volume><fpage>1662</fpage><lpage>1677</lpage><pub-id pub-id-type="doi">10.1242/jeb.02203</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Houghton</surname><given-names>G</given-names></name><name><surname>Hartley</surname><given-names>T</given-names></name></person-group><year>1995</year><article-title>Parallel models of serial behavior: Lashley revisited</article-title><source>Psyche</source><volume>2</volume><fpage>1</fpage><lpage>25</lpage></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huston</surname><given-names>SJ</given-names></name><name><surname>Jayaraman</surname><given-names>V</given-names></name></person-group><year>2011</year><article-title>Studying sensorimotor integration in insects</article-title><source>Current Opinion in Neurobiology</source><volume>21</volume><fpage>527</fpage><lpage>534</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2011.05.030</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>James</surname><given-names>W</given-names></name></person-group><year>1890</year><source>The principles of psychology</source><publisher-loc>London</publisher-loc><publisher-name>Macmillan</publisher-name></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jenett</surname><given-names>A</given-names></name><name><surname>Rubin</surname><given-names>GM</given-names></name><name><surname>Ngo</surname><given-names>TT</given-names></name><name><surname>Shepherd</surname><given-names>D</given-names></name><name><surname>Murphy</surname><given-names>C</given-names></name><name><surname>Dionne</surname><given-names>H</given-names></name><name><surname>Pfeiffer</surname><given-names>BD</given-names></name><name><surname>Cavallaro</surname><given-names>A</given-names></name><name><surname>Hall</surname><given-names>D</given-names></name><name><surname>Jeter</surname><given-names>J</given-names></name><name><surname>Iyer</surname><given-names>N</given-names></name><name><surname>Fetter</surname><given-names>D</given-names></name><name><surname>Hausenfluck</surname><given-names>JH</given-names></name><name><surname>Peng</surname><given-names>H</given-names></name><name><surname>Trautman</surname><given-names>ET</given-names></name><name><surname>Svirskas</surname><given-names>RR</given-names></name><name><surname>Myers</surname><given-names>EW</given-names></name><name><surname>Iwinski</surname><given-names>ZR</given-names></name><name><surname>Aso</surname><given-names>Y</given-names></name><name><surname>DePasquale</surname><given-names>GM</given-names></name><name><surname>Enos</surname><given-names>A</given-names></name><name><surname>Hulamm</surname><given-names>P</given-names></name><name><surname>Lam</surname><given-names>SC</given-names></name><name><surname>Li</surname><given-names>HH</given-names></name><name><surname>Laverty</surname><given-names>TR</given-names></name><name><surname>Long</surname><given-names>F</given-names></name><name><surname>Qu</surname><given-names>L</given-names></name><name><surname>Murphy</surname><given-names>SD</given-names></name><name><surname>Rokicki</surname><given-names>K</given-names></name><name><surname>Safford</surname><given-names>T</given-names></name><name><surname>Shaw</surname><given-names>K</given-names></name><name><surname>Simpson</surname><given-names>JH</given-names></name><name><surname>Sowell</surname><given-names>A</given-names></name><name><surname>Tae</surname><given-names>S</given-names></name><name><surname>Yu</surname><given-names>Y</given-names></name><name><surname>Zugates</surname><given-names>CT</given-names></name></person-group><year>2012</year><article-title>A GAL4-driver line resource for Drosophila neurobiology</article-title><source>Cell Reports</source><volume>2</volume><fpage>991</fpage><lpage>1001</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2012.09.011</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kamikouchi</surname><given-names>A</given-names></name><name><surname>Inagaki</surname><given-names>HK</given-names></name><name><surname>Effertz</surname><given-names>T</given-names></name><name><surname>Hendrich</surname><given-names>O</given-names></name><name><surname>Fiala</surname><given-names>A</given-names></name><name><surname>Göpfert</surname><given-names>MC</given-names></name><name><surname>Ito</surname><given-names>K</given-names></name></person-group><year>2009</year><article-title>The neural basis of Drosophila gravity-sensing and hearing</article-title><source>Nature</source><volume>458</volume><fpage>165</fpage><lpage>171</lpage><pub-id pub-id-type="doi">10.1038/nature07810</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kays</surname><given-names>I</given-names></name><name><surname>Cvetkovska</surname><given-names>V</given-names></name><name><surname>Chen</surname><given-names>BE</given-names></name></person-group><year>2014</year><article-title>Structural and functional analysis of single neurons to correlate synaptic connectivity with grooming behavior</article-title><source>Nature Protocols</source><volume>9</volume><fpage>1</fpage><lpage>10</lpage><pub-id pub-id-type="doi">10.1038/nprot.2013.157</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kovac</surname><given-names>MP</given-names></name><name><surname>Davis</surname><given-names>WJ</given-names></name></person-group><year>1977</year><article-title>Behavioral choice: neural mechanisms in Pleurobranchaea</article-title><source>Science</source><volume>198</volume><fpage>632</fpage><lpage>634</lpage><pub-id pub-id-type="doi">10.1126/science.918659</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kristan</surname><given-names>WB</given-names></name></person-group><year>2008</year><article-title>Neuronal decision-making circuits</article-title><source>Current Biology</source><volume>18</volume><fpage>R928</fpage><lpage>R932</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2008.07.081</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kupfermann</surname><given-names>I</given-names></name><name><surname>Weiss</surname><given-names>KR</given-names></name></person-group><year>1978</year><article-title>The command neuron concept</article-title><source>Behavioral and Brain Sciences</source><volume>1</volume><fpage>3</fpage><lpage>10</lpage><pub-id pub-id-type="doi">10.1017/S0140525X00059057</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kupfermann</surname><given-names>I</given-names></name><name><surname>Weiss</surname><given-names>KR</given-names></name></person-group><year>2001</year><article-title>Motor program selection in simple model systems</article-title><source>Current Opinion in Neurobiology</source><volume>11</volume><fpage>673</fpage><lpage>677</lpage><pub-id pub-id-type="doi">10.1016/S0959-4388(01)00267-7</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laissue</surname><given-names>PP</given-names></name><name><surname>Vosshall</surname><given-names>LB</given-names></name></person-group><year>2008</year><article-title>The olfactory sensory map in Drosophila</article-title><source>Advances in Experimental Medicine and Biology</source><volume>628</volume><fpage>102</fpage><lpage>114</lpage><pub-id pub-id-type="doi">10.1007/978-0-387-78261-4_7</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Lashley</surname><given-names>KS</given-names></name></person-group><year>1951</year><source>Cerebral mechanisms in behavior</source><person-group person-group-type="editor"><name><surname>Jeffress</surname><given-names>LA</given-names></name></person-group><publisher-loc>New York</publisher-loc><publisher-name>Wiley</publisher-name></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Long</surname><given-names>MA</given-names></name><name><surname>Jin</surname><given-names>DZ</given-names></name><name><surname>Fee</surname><given-names>MS</given-names></name></person-group><year>2010</year><article-title>Support for a synaptic chain model of neuronal sequence generation</article-title><source>Nature</source><volume>468</volume><fpage>394</fpage><lpage>399</lpage><pub-id pub-id-type="doi">10.1038/nature09514</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luan</surname><given-names>H</given-names></name><name><surname>Diao</surname><given-names>F</given-names></name><name><surname>Peabody</surname><given-names>NC</given-names></name><name><surname>White</surname><given-names>BH</given-names></name></person-group><year>2012</year><article-title>Command and compensation in a neuromodulatory decision network</article-title><source>The Journal of Neuroscience</source><volume>32</volume><fpage>880</fpage><lpage>889</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3707-11.2012</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marder</surname><given-names>E</given-names></name><name><surname>Bucher</surname><given-names>D</given-names></name><name><surname>Schulz</surname><given-names>DJ</given-names></name><name><surname>Taylor</surname><given-names>AL</given-names></name></person-group><year>2005</year><article-title>Invertebrate central pattern generation moves along</article-title><source>Current Biology</source><volume>15</volume><fpage>R685</fpage><lpage>R699</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2005.08.022</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mushiake</surname><given-names>H</given-names></name><name><surname>Saito</surname><given-names>N</given-names></name><name><surname>Sakamoto</surname><given-names>K</given-names></name><name><surname>Itoyama</surname><given-names>Y</given-names></name><name><surname>Tanji</surname><given-names>J</given-names></name></person-group><year>2006</year><article-title>Activity in the lateral prefrontal cortex reflects multiple steps of future events in action plans</article-title><source>Neuron</source><volume>50</volume><fpage>631</fpage><lpage>641</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2006.03.045</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pan</surname><given-names>Y</given-names></name><name><surname>Robinett</surname><given-names>CC</given-names></name><name><surname>Baker</surname><given-names>BS</given-names></name></person-group><year>2011</year><article-title>Turning males on: activation of male courtship behavior in <italic>Drosophila Melanogaster</italic></article-title><source>PLOS ONE</source><volume>6</volume><fpage>e21144</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0021144</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pfeiffer</surname><given-names>BD</given-names></name><name><surname>Jenett</surname><given-names>A</given-names></name><name><surname>Hammonds</surname><given-names>AS</given-names></name><name><surname>Ngo</surname><given-names>TT</given-names></name><name><surname>Misra</surname><given-names>S</given-names></name><name><surname>Murphy</surname><given-names>C</given-names></name><name><surname>Scully</surname><given-names>A</given-names></name><name><surname>Carlson</surname><given-names>JW</given-names></name><name><surname>Wan</surname><given-names>KH</given-names></name><name><surname>Laverty</surname><given-names>TR</given-names></name><name><surname>Mungall</surname><given-names>C</given-names></name><name><surname>Svirskas</surname><given-names>R</given-names></name><name><surname>Kadonaga</surname><given-names>JT</given-names></name><name><surname>Doe</surname><given-names>CQ</given-names></name><name><surname>Eisen</surname><given-names>MB</given-names></name><name><surname>Celniker</surname><given-names>SE</given-names></name><name><surname>Rubin</surname><given-names>GM</given-names></name></person-group><year>2008</year><article-title>Tools for neuroanatomy and neurogenetics in Drosophila</article-title><source>Proceedings of the National Academy of Sciences of USA</source><volume>105</volume><fpage>9715</fpage><lpage>9720</lpage><pub-id pub-id-type="doi">10.1073/pnas.0803697105</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pfeiffer</surname><given-names>BD</given-names></name><name><surname>Ngo</surname><given-names>TT</given-names></name><name><surname>Hibbard</surname><given-names>KL</given-names></name><name><surname>Murphy</surname><given-names>C</given-names></name><name><surname>Jenett</surname><given-names>A</given-names></name><name><surname>Truman</surname><given-names>JW</given-names></name><name><surname>Rubin</surname><given-names>GM</given-names></name></person-group><year>2010</year><article-title>Refinement of tools for targeted gene expression in Drosophila</article-title><source>Genetics</source><volume>186</volume><fpage>735</fpage><lpage>755</lpage><pub-id pub-id-type="doi">10.1534/genetics.110.119917</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Phillis</surname><given-names>RW</given-names></name><name><surname>Bramlage</surname><given-names>AT</given-names></name><name><surname>Wotus</surname><given-names>C</given-names></name><name><surname>Whittaker</surname><given-names>A</given-names></name><name><surname>Gramates</surname><given-names>LS</given-names></name><name><surname>Seppala</surname><given-names>D</given-names></name><name><surname>Farahanchi</surname><given-names>F</given-names></name><name><surname>Caruccio</surname><given-names>P</given-names></name><name><surname>Murphey</surname><given-names>RK</given-names></name></person-group><year>1993</year><article-title>Isolation of mutations affecting neural circuitry required for grooming behavior in <italic>Drosophila Melanogaster</italic></article-title><source>Genetics</source><volume>133</volume><fpage>581</fpage><lpage>592</lpage></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Redgrave</surname><given-names>P</given-names></name><name><surname>Prescott</surname><given-names>TJ</given-names></name><name><surname>Gurney</surname><given-names>K</given-names></name></person-group><year>1999</year><article-title>The basal ganglia: a vertebrate solution to the selection problem?</article-title><source>Neuroscience</source><volume>89</volume><fpage>1009</fpage><lpage>1023</lpage><pub-id pub-id-type="doi">10.1016/S0306-4522(98)00319-4</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rhodes</surname><given-names>BJ</given-names></name><name><surname>Bullock</surname><given-names>D</given-names></name><name><surname>Verwey</surname><given-names>WB</given-names></name><name><surname>Averbeck</surname><given-names>BB</given-names></name><name><surname>Page</surname><given-names>MP</given-names></name></person-group><year>2004</year><article-title>Learning and production of movement sequences: behavioral, neurophysiological, and modeling perspectives</article-title><source>Human Movement Science</source><volume>23</volume><fpage>699</fpage><lpage>746</lpage><pub-id pub-id-type="doi">10.1016/j.humov.2004.10.008</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sachs</surname><given-names>BD</given-names></name></person-group><year>1988</year><article-title>The development of grooming and its expression in adult animals</article-title><source>Annals of the New York Academy of Sciences</source><volume>525</volume><fpage>1</fpage><lpage>17</lpage><pub-id pub-id-type="doi">10.1111/j.1749-6632.1988.tb38591.x</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sherrington</surname><given-names>CS</given-names></name></person-group><year>1906</year><source>The integrative action of the nervous system</source><publisher-loc>New York</publisher-loc><publisher-name>Charles Scribner's sons</publisher-name></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Szebenyi</surname><given-names>AL</given-names></name></person-group><year>1969</year><article-title>Cleaning behaviour in <italic>Drosophila Melanogaster</italic></article-title><source>Animal Behaviour</source><volume>17</volume><fpage>641</fpage><lpage>651</lpage><pub-id pub-id-type="doi">10.1016/S0003-3472(69)80006-0</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vandervorst</surname><given-names>P</given-names></name><name><surname>Ghysen</surname><given-names>A</given-names></name></person-group><year>1980</year><article-title>Genetic control of sensory connections in Drosophila</article-title><source>Nature</source><volume>286</volume><fpage>65</fpage><lpage>67</lpage><pub-id pub-id-type="doi">10.1038/286065a0</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>von Philipsborn</surname><given-names>AC</given-names></name><name><surname>Liu</surname><given-names>T</given-names></name><name><surname>Yu</surname><given-names>JY</given-names></name><name><surname>Masser</surname><given-names>C</given-names></name><name><surname>Bidaye</surname><given-names>SS</given-names></name><name><surname>Dickson</surname><given-names>BJ</given-names></name></person-group><year>2011</year><article-title>Neuronal control of Drosophila courtship song</article-title><source>Neuron</source><volume>69</volume><fpage>509</fpage><lpage>522</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2011.01.011</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname><given-names>RI</given-names></name></person-group><year>2013</year><article-title>Early olfactory processing in Drosophila: mechanisms and principles</article-title><source>Annual Review of Neuroscience</source><volume>36</volume><fpage>217</fpage><lpage>241</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-062111-150533</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yorozu</surname><given-names>S</given-names></name><name><surname>Wong</surname><given-names>A</given-names></name><name><surname>Fischer</surname><given-names>BJ</given-names></name><name><surname>Dankert</surname><given-names>H</given-names></name><name><surname>Kernan</surname><given-names>MJ</given-names></name><name><surname>Kamikouchi</surname><given-names>A</given-names></name><name><surname>Ito</surname><given-names>K</given-names></name><name><surname>Anderson</surname><given-names>DJ</given-names></name></person-group><year>2009</year><article-title>Distinct sensory representations of wind and near-field sound in the Drosophila brain</article-title><source>Nature</source><volume>458</volume><fpage>201</fpage><lpage>205</lpage><pub-id pub-id-type="doi">10.1038/nature07843</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>JY</given-names></name><name><surname>Kanai</surname><given-names>MI</given-names></name><name><surname>Demir</surname><given-names>E</given-names></name><name><surname>Jefferis</surname><given-names>GS</given-names></name><name><surname>Dickson</surname><given-names>BJ</given-names></name></person-group><year>2010</year><article-title>Cellular organization of the neural circuit that drives Drosophila courtship behavior</article-title><source>Current Biology</source><volume>20</volume><fpage>1602</fpage><lpage>1614</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2010.08.025</pub-id></element-citation></ref></ref-list></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.02951.031</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Reviewing editor</role><aff><institution>Emory University</institution>, <country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>eLife posts the editorial decision letter and author response on a selection of the published articles (subject to the approval of the authors). An edited version of the letter sent to the authors after peer review is shown, indicating the substantive concerns or comments; minor concerns are not usually shown. Reviewers have the opportunity to discuss the decision before the letter is sent (see <ext-link ext-link-type="uri" xlink:href="http://elifesciences.org/review-process">review process</ext-link>). Similarly, the author response typically shows only responses to the major concerns raised by the reviewers.</p></boxed-text><p>Thank you for sending your work entitled “A suppression hierarchy among competing motor programs drives sequential grooming in <italic>Drosophila</italic>” for consideration at <italic>eLife</italic>. Your article has been favorably evaluated by K (Vijay) VijayRaghavan (Senior editor) and 3 reviewers, one of whom, Ronald L Calabrese, is a member of our Board of Reviewing Editors.</p><p>The Reviewing editor and the other reviewers discussed their comments before we reached this decision, and the Reviewing editor has assembled the following comments to help you prepare a revised submission.</p><p>The authors describe experiments on fruit fly grooming when the entire body is dusted. This paradigm sets up a distinctive motor sequence in which grooming proceeds and allowed the testing of the organizational principles governing how dusted flies groom their bodies with sequential movements. Using genetically targeted activation of neural subsets, the authors drove different components of the grooming sequence that clean individual body parts. They then performed competition experiments to show that the different motor components are organized into a suppression hierarchy so that components that occur first suppress those that occur later. They then make a simple 'neural' model with two layers, a hierarchical layer of the independent cleaning movements and a winner take all layer, which nicely captures their data. Cleaning one body part reduces the sensory drive to its cleaning movement, which relieves suppression of the next movement, allowing the grooming sequence to progress down the hierarchy. They then discuss the implications of their finding for how sequential behaviors are performed and how simple behavioral choices are made.</p><p>The paper is beautifully illustrated and all necessary data are presented in the figures and figure supplements. The writing is concise and in general clear, and the Discussion is illuminating, but could be expanded a bit. The paper is highly interesting and innovative and provides a mechanistic explanation for how motor sequences can be organized. It should be of wide interest to the neuroscience community.</p><p>Both the outside reviewers and the Reviewing editor found this paper a pleasure to review and the authors are to be commended for an exceptional piece of work beautifully presented. We encourage the authors to integrate some of the supplemental data into the text, particularly <xref ref-type="fig" rid="fig1s3 fig1s4">Figure 1–figure supplements 3 and 4</xref> and <xref ref-type="fig" rid="fig3s1 fig3s2">Figure 3–figure supplements 1 and 2</xref>.</p><p>The outside reviewers had several concerns that are intended to make this interesting paper yet more interesting. The reviews are very complementary and require only some rewriting to add details, some more discussions of implications and limitations, and limited amount of further analysis. We anticipate that the authors should be able to quickly answer these concerns, despite their considerable number and resubmit this exciting work. No new experiments are requested.</p><p>Specific comments:</p><p><italic>Reviewer #1:</italic></p><p>The paper is very cleanly written.</p><p>I encourage the authors to integrate some of the supplemental data into the text, particularly <xref ref-type="fig" rid="fig1s3 fig1s4">Figure 1–figure supplements 3 and 4</xref> and <xref ref-type="fig" rid="fig3s1 fig3s2">Figure 3–figure supplements 1 and 2</xref>.</p><p>Methods are a little terse; particularly the models and their outputs could be explained more fully.</p><p><italic>Reviewer #2:</italic></p><p>This is an altogether impressive piece of work. The approach, although incredibly complex in its details, is extremely clear-headed in how it is organized and presented. The results are spectacular and, at least to me, completely unexpected. They screened more than 1500 Drosophila GAL4 stocks created at Janelia that expressed a temperature-sensitive cation channel (dTrpA1) in all the GAL4-expressing neurons. From these, they found 12 lines that reliably affected different aspects of grooming behavior. They then devised behavioral and anatomical tests to assay the sequence of behaviors that normally occurs in normal grooming. They then used activation of the components of grooming (using the legs to wipe dust from different body parts) to test whether the sequencing of the grooming components (which they call “modules”) depends upon a series or a parallel mechanism. (They come down strongly in favor of a parallel mechanism.) Both the behavioral and genetic tools they devised are extremely clever (horrendously tedious, but conceptually clear), and the analyses are appropriate and convincing. The major conclusion (that there are separable modules of grooming that inhibit one another in a hierarchical order) is well documented and, for the most part, clearly presented.</p><p>There are, despite these great strengths, a few problems with the study. Some of these problems are mentioned briefly, but others are not. The major ones are:</p><p>1) We are told nothing about the behavioral phenotypes of the 12 lines at the elevated temperature. Ideally, it would be nice to know that the obsessive activation of some aspect of grooming is the only behavioral anomaly that they show.</p><p>2) From the extreme variety of neurons that express GAL4 in the different Drosophila lines (there are vast differences in both total cell numbers and anatomical distributions), it is remarkable that these lines express such specific behavioral activations when heated. I was disappointed that there was no discussion of this remarkable observation. I could think of several alternatives, but was disappointed that people who are much more familiarity with these animals did not address this question, at least briefly.</p><p>3) As far as they carried it, the modeling study was quite useful. Having a fairly simple model that matches the data so well, even some data that they didn't use to construct the model is very comforting. They made a big point, however, that there were two possible explanations (a serial one and a parallel one) for their results, but they attempted to model only the parallel one. Showing that any serial model has serious problems would have rounded off the argument in a satisfying way. They discuss why the serial option would probably not work, but I found this Discussion unconvincing.</p><p>4) I felt blind-sided when, in the Results, I was told that “the frequent alternations between cleaning the body parts and leg rubbing … are an important and prominent feature in normal grooming behavior”. If these movements are so important, why are they mentioned only as a second-order test of the model and not in any of the studies of the behaviors? Minimally, at the end of the first paragraph in Results the authors could tell us that there is another feature of grooming that will be detailed later. In fact, the initial transitions diagram (<xref ref-type="fig" rid="fig1">Figure 1G</xref>) has a hint of this alternation; it could be mentioned in discussing this diagram.</p><p>5) They mention that silencing the same GAL4-expressing neurons does not eliminate the behaviors that activating them elicits. Again, I was looking forward to their ideas about why these neurons are sufficient but not necessary, but they did not go there.</p><p><italic>Reviewer #3:</italic></p><p>Understanding how specific sequences of behavior are executed remains challenging, with a number of alternative models fitting data in different contexts. In this work, Seeds et al. describe a new behavioral sequence that underlies grooming behavior, and take advantage of quantitative analyses and genetic manipulations that allow them to get at the organization of this behavior. Intriguingly, these studies support a parallel track model in which sensory input, combined with different sensory gains and a winner take all competition recapitulate many of the core features of fly behavior. As this system is the first to capture a sequence in which the sensory input that drives the behavior is the same across modules, it represents a powerful paradigm for the dissection of its neural control. This work is quantitative, rigorous, makes a general point and is appropriate for <italic>eLife</italic> with some modest changes I describe below.</p><p>My only concern regarding the fly behavioral data is that I believe that <xref ref-type="fig" rid="fig1">Figure 1H</xref> is oversimplified, and hence misleading. The time traces in <xref ref-type="fig" rid="fig1">Figure 1E</xref> and the fraction changing in <xref ref-type="fig" rid="fig1">Figure 1D</xref> demonstrate that the transition from one behavior mode to another is quite smoothly graded, a feature that is eliminated from the very simple view in <xref ref-type="fig" rid="fig1">Figure 1H</xref>. I would therefore request that the authors extend the type of display in <xref ref-type="fig" rid="fig1">Figure 1G</xref>, developing a time-dependent transition probability model. A simple way to do this would be to cut the ethogram data into 5 minute segments, and replot the transition probability model (thresholded, as the authors do already). This kind of representation should give a more accurate sense of how the behavior changes progressively.</p><p>My second concern has to do with the explanation of the structure of the models the authors use. As far as I can tell, the model structure using sensory feedback and the winner take all layer should be deterministic – at whatever level of sensory gain is initiated, combined with the present level of dust, only one module should be selected (and should persist until the level of dust on that body part drops sufficiently for another module to win). However, the data in <xref ref-type="fig" rid="fig4">Figure 4</xref> show that, like real flies, at most time points, the models have mixed character, with flies alternating between different activities (which change progressively). I understand how leg grooming is exceptional, in the sense that its sensory drive increases periodically (giving an oscillatory character to the behavior), but for all other grooming behaviors, the sensory drive can only decline. Is there a noise term that is not described in the text? If so, what is its form? If not, can the authors provide a more accessible description for why their models are not deterministic in time?</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.02951.032</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p>Reviewer #1:</p><p><italic>The paper is very cleanly written</italic>.</p><p><italic>I encourage the authors to integrate some of the supplemental data into the text, particularly</italic> <xref ref-type="fig" rid="fig1s3 fig1s4"><italic>Figure 1–figure supplements 3 and 4</italic></xref> <italic>and</italic> <xref ref-type="fig" rid="fig3s1 fig3s2"><italic>Figure 3–figure supplements 1 and 2.</italic></xref></p><p>We intended for the main figures to provide a concise view of the results, while the supplemental material expands on the complexity of the data. We made the following additions to the text and figure legends to insure the reader receives full benefit of the figure supplements. Particularly we have tried to make it easier to logically link to figure supplements from the Results section and the primary figure legends. The ease of viewing those figure supplements that complement the primary figures in <italic>eLife</italic>’s online format should facilitate this.</p><p><xref ref-type="fig" rid="fig1s3">Figure 1–figure supplement 3</xref>: We added text to highlight the relationship between this figure supplement and <xref ref-type="fig" rid="fig1">Figure 1D</xref>. We now mention in the <xref ref-type="fig" rid="fig1">Figure 1D</xref> legend that the data used to generate the panel can be found in <xref ref-type="fig" rid="fig1s3">Figure 1–figure supplement 3</xref>: “Figure panel is compiled from data shown in <xref ref-type="fig" rid="fig1s3">Figure 1–figure supplement 3</xref>.” We also mentioned in the supplementary Figure legend: “Data shown here is compiled and plotted in <xref ref-type="fig" rid="fig1">Figure 1D</xref>.” This should allow the reader to more easily see the relationship between the two.</p><p><xref ref-type="fig" rid="fig1s4">Figure 1–figure supplement 4</xref>: We now refer to specific panels of this figure supplement in the first section of the Results. Text now reads: “In response to dust on their bodies, flies groomed with a predictable progression of targeted cleaning movements (<xref ref-type="fig" rid="fig1">Figure 1D–F</xref>, <xref ref-type="fig" rid="fig1s3">Figure 1–figure supplement 3</xref>, <xref ref-type="fig" rid="fig1s4">Figure 1–figure supplement 4B,C</xref>). This progression required dust, as undusted flies did not groom in a sequential progression (<xref ref-type="fig" rid="fig1s4">Figure 1–figure supplement 4A,C</xref>).” We highlight <xref ref-type="fig" rid="fig1s4">Figure 1–figure supplement 4B</xref> more in another sentence of the first Results section that now reads: “That is, the progression was not absolutely unidirectional as flies returned to cleaning earlier body parts even though they had already started cleaning later body parts (referred to as return cleaning, discussed more below) (<xref ref-type="fig" rid="fig1">Figure 1E</xref> and <xref ref-type="fig" rid="fig1s4">Figure 1–figure supplement 4B</xref>, example ethograms).”</p><p><xref ref-type="fig" rid="fig3s1">Figure 3–figure supplement 1</xref>: We now highlight the visual match between the grid in <xref ref-type="fig" rid="fig3">Figure 3B</xref> and the average dust distributions on the fly body parts shown in <xref ref-type="fig" rid="fig3s1">Figure 3–figure supplement 1A</xref>. We added text to the Results section, main Figure legend, and Figure supplement legends to make this point. The Results text now emphasizes the relationship between the two:</p><p>“<xref ref-type="fig" rid="fig3">Figure 3B</xref> illustrates the outcome of these experiments, which matched the prediction of the hierarchical suppression hypothesis (compare <xref ref-type="fig" rid="fig3s1">Figure 3–figure supplement 1A</xref> to <xref ref-type="fig" rid="fig3">Figure 3B</xref>).”</p><p>The legend describing <xref ref-type="fig" rid="fig3">Figure 3B</xref> now states: “Data used to generate the grid is shown in <xref ref-type="fig" rid="fig3s1">Figure 3–figure supplement 1</xref>.” The legend describing <xref ref-type="fig" rid="fig3s1">Figure 3–figure supplement 1</xref> now states:</p><p>“Data shown here is compiled and plotted in <xref ref-type="fig" rid="fig3">Figure 3B</xref>.”</p><p>The Results describing <xref ref-type="fig" rid="fig3">Figure 3</xref> now more specifically refers to <xref ref-type="fig" rid="fig3s1">Figure 3–figure supplement 1</xref>: “GAL4 lines that activated abdominal (R24B03), wing (R53A06) or all posterior cleaning modules (R45G01) showed little impairment in removing dust from their heads (<xref ref-type="fig" rid="fig3">Figure 3B</xref>, <xref ref-type="fig" rid="fig3s1">Figure 3–figure supplement 1</xref>, see R24B03, R53A06, and R45G01).” <xref ref-type="fig" rid="fig3s2">Figure 3–figure supplement 2</xref>: In the Results section, the Figure supplement is more specifically referred to highlight each example. Specific example 1: “For example, when a fly carrying a GAL4 driver that activates abdominal cleaning (R24B03) was stimulated in the presence of whole-body dust, it first cleaned the head, then abdomen (just as wild-type flies do), but then persisted in cleaning its abdomen instead of proceeding to its wings and thorax (<xref ref-type="fig" rid="fig3">Figure 3B</xref>, <xref ref-type="fig" rid="fig3s2">Figure 3–figure supplement 2A,D</xref>, see R24B03).” Specific example 2: “Like wild-type flies, these GAL4 lines cleaned their heads at the onset of dusting, indicating that the normal progression of cleaning was preserved up to the point where it was blocked (<xref ref-type="fig" rid="fig3s2">Figure 3–figure supplement 2A,D,E</xref>, see R24B03, R53A06, and R45G01).”</p><p><italic>Methods are a little terse; particularly the models and their outputs could be explained more fully</italic>.</p><p>We have changed and added text in the methods sections to improve clarity. Sections modified include: Grooming apparatus; Dusting flies for body surface imaging or video recordings; Quantification of body surface dust patterns; Behavioral recordings; Movement scoring guidelines and definitions; Computational model of hierarchical suppression among competing cleaning movements. The Methods pertaining to the model were expanded to describe the outputs and to provide greater conceptual linkage to the Results presented in <xref ref-type="fig" rid="fig4">Figure 4</xref> and <xref ref-type="fig" rid="fig5">Figure 5</xref>.</p><p>Reviewer #2:</p><p><italic>1) We are told nothing about the behavioral phenotypes of the 12 lines at the elevated temperature. Ideally, it would be nice to know that the obsessive activation of some aspect of grooming is the only behavioral anomaly that they show</italic>.</p><p>We deliberately chose lines for this study that were extremely specific for grooming behaviors. These lines were assessed for gross behavioral phenotypes and motor coordination. This was done both in the course of their selection while screening the GAL4 collection and in doing the experiments in this paper. These lines constitutively clean particular body parts and show no other obvious behavior. One line shows a slight motor impairment when it is walking (R23A07, Figure 2–figure supplementary video 1). We emphasize that the readers can watch the representative videos of different GAL4/dTrpA1 lines to see what the phenotypes look like. We added two additional videos (now a total of eight) so all of the lines used in the experiments in <xref ref-type="fig" rid="fig3">Figure 3</xref> and <xref ref-type="fig" rid="fig5">Figure 5</xref> are shown. The specific cleaning phenotypes for each line are described in the video Figure legends and now also describe any other phenotypes that are not conveyed by the <xref ref-type="fig" rid="fig2">Figure 2</xref> ethograms or grid. Most video legends say: “No other overt phenotypes were observed.” The R23A07 legend now says: “Displayed minor walking defect that was unrelated to the cleaning phenotype.”</p><p>We also reference these videos in the Results section of <xref ref-type="fig" rid="fig2">Figure 2</xref>: “We identified different GAL4 lines that caused exclusive cleaning of each body part, including the head, abdomen, wings, and legs (<xref ref-type="fig" rid="fig2">Figure 2</xref>, <xref ref-type="fig" rid="fig2s1">Figure 2–figure supplement 1</xref>, <xref ref-type="fig" rid="fig2s2">Figure 2–figure supplement 2</xref>, see Figure 2–figure supplementary videos 1–8 for representative videos and more detail regarding the behavioral phenotypes).” The ethograms in <xref ref-type="fig" rid="fig2">Figure 2</xref> provide a nice way to get an idea of the phenotypes of these lines. We added description to the <xref ref-type="fig" rid="fig2">Figure 2</xref> legend so that the readers get a fuller understanding of the ethograms for each line: “White space in each ethogram represents time spent walking or standing in place.” We also now address this issue in discussing our rational for selecting lines used in the hierarchy experiment in <xref ref-type="fig" rid="fig3">Figure 3</xref>: “For this experiment, we selected lines that could induce a particular cleaning module and lacked additional phenotypes that might confound our grooming-specific interpretations (<xref ref-type="fig" rid="fig2">Figure 2</xref>, lines labeled in red, Figure 2–figure supplementary videos 1–8).”</p><p><italic>2) From the extreme variety of neurons that express GAL4 in the different Drosophila lines (there are vast differences in both total cell numbers and anatomical distributions), it is remarkable that these lines express such specific behavioral activations when heated. I was disappointed that there was no discussion of this remarkable observation. I could think of several alternatives, but was disappointed that people who are much more familiarity with these animals did not address this question, at least briefly</italic>.</p><p>We now address the expression patterns targeted by the GAL4 lines in the last Discussion section that also covers comment 5 from this reviewer (last three paragraphs of the discussion). In brief, we make two points about these expression patterns as they relate to the behavioral activation phenotypes: 1) Only a fraction of the cells in each expression pattern are responsible for the phenotypes as GAL4 lines do not necessarily target functionally related neurons. 2) The cells targeted in each pattern may be related in function (e.g. such as in the <italic>Drosophila fruitless</italic> circuit). We also described what the actual cell types might be in this discussion section. Namely we discuss two possible neural types as capable of activating such specific behavior: 1) sensory neurons 2) Command-like/decision neurons.</p><p><italic>3) As far as they carried it, the modeling study was quite useful. Having a fairly simple model that matches the data so well, even some data that they didn't use to construct the model is very comforting. They made a big point, however, that there were two possible explanations (a serial one and a parallel one) for their results, but they attempted to model only the parallel one. Showing that any serial model has serious problems would have rounded off the argument in a satisfying way. They discuss why the serial option would probably not work, but I found this Discussion unconvincing</italic>.</p><p>Two major aspects of our data led us to reject the serial model and focus on computationally simulating the parallel model. First, the cleaning modules have parallel sensory inputs and stimulation of one input does not result in a complete sequence of movements, as might be predicted by an activation chain. Second, a serial model does not predict the return cleaning among the modules that occurs in wild type flies (return cleaning is described more in the next paragraph). We reasoned that an activation chain model would simply result in a deterministic sequence of simulated grooming movements, rather than this return cleaning. This said we make no claim that some degree of internal triggering of cleaning modules (through an activation chain) does not exist. In other words, a ‘mixed model’ could explain the empirically observed grooming behavior even better. In this case, execution of a cleaning module is selected by two components: winner-take-all (parallel model) and internal triggering from the previous cleaning module (serial model). All we claim in this work is that the parallel model alone is fully sufficient to reproduce the major aspects of grooming sequence discussed in this manuscript. We revised the Results and Discussion to better set up and then state our argument against an activation chain as the primary mediator of the grooming sequence. The manuscript has been changed to address this and other related comments from reviewers two and three. We now focus more attention on the return cleaning that occurs among the cleaning modules. We do this by first establishing that the flies clean a body part, then clean the next, but still return to clean previous body parts. These returns by the cleaning modules in wild type flies are now emphasized more in the Results that describe <xref ref-type="fig" rid="fig1">Figure 1</xref>. Next, a new paragraph was added on the return cleaning in our description of the output of the model (in reference to <xref ref-type="fig" rid="fig4">Figure 4</xref>). Finally, we argue in the Discussion that return cleaning is not what is expected of a simple activation chain model, but can be explained by our parallel model.</p><p><italic>4) I felt blind-sided when, in the Results, I was told that “the frequent alternations between cleaning the body parts and leg rubbing … are an important and prominent feature in normal grooming behavior”. If these movements are so important, why are they mentioned only as a second-order test of the model and not in any of the studies of the behaviors? Minimally, at the end of the first paragraph in Results the authors could tell us that there is another feature of grooming that will be detailed later. In fact, the initial transitions diagram (</italic><xref ref-type="fig" rid="fig1"><italic>Figure. 1G</italic></xref><italic>) has a hint of this alternation; it could be mentioned in discussing this diagram</italic>.</p><p>We apologize that this was not clear and now emphasize leg rubbing more in the first paragraph of the Results section. There was already text in this paragraph that referred to leg rubbing in grooming behavior. In fact, our primary purpose for including <xref ref-type="fig" rid="fig1">Figure 1G</xref> was to show the prominent transitions between body sweeps and leg rubbing (see below for additional discussion of <xref ref-type="fig" rid="fig1">Figure 1G</xref>). We have revised the section to further emphasize the point (including a reference to watch the supplementary video) and now use a term to describe this feature of grooming (cyclic transitions). The text now reads: “As the flies progressed through the grooming sequence, each bout of body part cleaning featured cyclic transitions between sweeps of the targeted region and rubbing of the legs against each other (<xref ref-type="fig" rid="fig1">Figure 1G</xref>, <xref ref-type="fig" rid="fig1s5">Figure 1–figure supplement 5</xref>, <xref ref-type="other" rid="video1">Video 1</xref>). These cyclic bouts of leg rubbing likely occurred when the legs accumulated sufficient dust from sweeping the body, which was then rubbed towards the distal leg parts and removed.”</p><p>To make this point even more clear, we added additional text that mentions these cyclic transitions in the second to last sentence of the first Results paragraph: “Thus, flies groom by gradually cleaning different body parts in bouts that are characterized by cyclic transitions between body cleaning sweeps and leg rubbing (shown as a series of transition diagrams in <xref ref-type="fig" rid="fig1s6">Figure 1–figure supplement 6</xref>).”</p><p><italic>5) They mention that silencing the same GAL4-expressing neurons does not eliminate the behaviors that activating them elicits. Again, I was looking forward to their ideas about why these neurons are sufficient but not necessary, but they did not go there</italic>.</p><p>We now address this point in a new (last) section of the Discussion that also covers point two from this reviewer: “Neurons that activate cleaning modules”. In brief, we make the point that the neurons may be sensory or command-like neurons. We describe that such command-like neurons do not necessarily follow a strict definition as command neurons in being both necessary and sufficient. Alternatively (not described in the discussion), redundancy exists among the grooming sufficient neurons, and each GAL4 line only targets a fraction of the total population sufficient to drive a specific cleaning movement. This could obscure results of an experiment to test neural necessity in grooming because the entire population would not be inhibited through expression of neural inhibitors.</p><p>Reviewer #3:</p><p><italic>My only concern regarding the fly behavioral data is that I believe that</italic> <xref ref-type="fig" rid="fig1"><italic>Figure 1H</italic></xref> <italic>is oversimplified, and hence misleading. The time traces in</italic> <xref ref-type="fig" rid="fig1"><italic>Figure 1E</italic></xref> <italic>and the fraction changing in</italic> <xref ref-type="fig" rid="fig1"><italic>Figure 1D</italic></xref> <italic>demonstrate that the transition from one behavior mode to another is quite smoothly graded, a feature that is eliminated from the very simple view in</italic> <xref ref-type="fig" rid="fig1"><italic>Figure 1H</italic></xref><italic>. I would therefore request that the authors extend the type of display in</italic> <xref ref-type="fig" rid="fig1"><italic>Figure 1G</italic></xref><italic>, developing a time-dependent transition probability model. A simple way to do this would be to cut the ethogram data into 5 minute segments, and replot the transition probability model (thresholded, as the authors do already). This kind of representation should give a more accurate sense of how the behavior changes progressively</italic>.</p><p>We agree with reviewer three that <xref ref-type="fig" rid="fig1">Figure 1H</xref> is oversimplified and misleading as a representation of what serial grooming actually looks like. To avoid further confusion by other readers on this point we removed <xref ref-type="fig" rid="fig1">Figure 1H</xref> and now simply emphasize the priority order of grooming in a new the last sentence of the first Results section in the text: “The priority order for cleaning the different body parts is: eyes &gt; antennae &gt; abdomen &gt; wings &gt; thorax.”</p><p>Reviewer 3 also suggested that we produce time-binned diagrams (like <xref ref-type="fig" rid="fig1">Figure 1G</xref>) from the twenty-five minute annotated video of dusted flies. <xref ref-type="fig" rid="fig1">Figure 1G</xref> was not intended to be used as evidence supporting the grooming sequence, but to describe two other features of dust induced grooming behavior. First, it shows the frequent transitions between body cleaning and leg rubbing. Second, it shows that the progression of grooming is discontinuous, in that walking frequently interrupts cleaning. Descriptions of this are in the first Results section, and we have added text to make this point more clear (see comments on this in relation a comment from reviewer two). For these reasons, we respectfully ask to keep <xref ref-type="fig" rid="fig1">Figure 1G</xref> in its current place. However, we generated the five-segmented diagrams requested by the reviewer and propose to include it as a figure supplement (<xref ref-type="fig" rid="fig1s6">Figure 1–figure supplement 6</xref>) to add more description of the progression of grooming. <xref ref-type="fig" rid="fig1s6">Figure 1–figure supplement 6</xref> is used to further support the conclusion of the first Results section. The second to last sentence of this section now reads: “Thus, flies groom by gradually cleaning different body parts in bouts that are characterized by cyclic transitions between body cleaning sweeps and leg rubbing (shown as a series of transition diagrams in <xref ref-type="fig" rid="fig1s6">Figure 1–figure supplement 6</xref>).” This sentence also addresses an issue from reviewer two that there was insufficient description of the body cleaning and leg rubbing bouts.</p><p><italic>My second concern has to do with the explanation of the structure of the models the authors use. As far as I can tell, the model structure using sensory feedback and the winner take all layer should be deterministic – at whatever level of sensory gain is initiated, combined with the present level of dust, only one module should be selected (and should persist until the level of dust on that body part drops sufficiently for another module to win). However, the data in</italic> <xref ref-type="fig" rid="fig4"><italic>Figure 4</italic></xref> <italic>show that, like real flies, at most time points, the models have mixed character, with flies alternating between different activities (which change progressively). I understand how leg grooming is exceptional, in the sense that its sensory drive increases periodically (giving an oscillatory character to the behavior), but for all other grooming behaviors, the sensory drive can only decline. Is there a noise term that is not described in the text? If so, what is its form? If not, can the authors provide a more accessible description for why their models are not deterministic in time?</italic></p><p>We do use a noise term in our model that varies the initial amount of dust on the cleaning modules in the upper ten percent of the total dust amount (see revised Methods). This causes variability in which modules are selected first when there is no suppression hierarchy (i.e. as in <xref ref-type="fig" rid="fig4">Figure 4B</xref>). This is not, however, what causes the alternations among the cleaning movements described by the reviewer. Alternations occur as the activation levels between the movements get closer and closer through cleaning. For example, module 1 occurs first in the sequence and proceeds until the dust level on its corresponding body part is reduced enough that the next dirty module 2 now has a higher relative activation level. Module 1 is not yet clean, but clean enough that its sensory drive is less than module 2. Once module 2 cleans its body part, thus reducing its own sensory drive, the activation level of module 1 is now above 2. These two modules will alternate back and forth until their activation levels fall below module 3. Now these alternations will occur among all three modules. Therefore, the sequence has a sequential nature but, at the point where the activity levels become more similar through cleaning, the behavior takes on this alternating character (we now refer to this as return cleaning in the paper – i.e. returning to clean previously cleaned parts). This is apparent in the ethograms of actual flies after they are dusted, and in the model (<xref ref-type="fig" rid="fig1">Figure 1E</xref>, <xref ref-type="fig" rid="fig4">Figure 4B-D</xref>, <xref ref-type="fig" rid="fig5">Figure 5A,C</xref>). Although the appearance of the different movements in a particular order (<xref ref-type="fig" rid="fig1">Figure 1F</xref>) may be thought of as deterministic, the return cleaning between the cleaning movements is more probabilistic. We added a paragraph to the <xref ref-type="fig" rid="fig4">Figure 4</xref> Results section to describe this property of the model.</p></body></sub-article></article>