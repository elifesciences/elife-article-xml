<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">38169</article-id><article-id pub-id-type="doi">10.7554/eLife.38169</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Environmental deformations dynamically shift the grid cell spatial metric</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-112449"><name><surname>Keinath</surname><given-names>Alexandra T</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1622-7835</contrib-id><email>atkeinath@gmail.com</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-32293"><name><surname>Epstein</surname><given-names>Russell A</given-names></name><email>epstein@psych.upenn.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-15603"><name><surname>Balasubramanian</surname><given-names>Vijay</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6497-3819</contrib-id><email>vijay@physics.upenn.edu</email><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund5"/><xref ref-type="other" rid="fund6"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Department of Psychology</institution><institution>University of Pennsylvania</institution><addr-line><named-content content-type="city">Pennsylvania</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Department of Physics</institution><institution>University of Pennsylvania</institution><addr-line><named-content content-type="city">Pennsylvania</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Colgin</surname><given-names>Laura</given-names></name><role>Reviewing Editor</role><aff><institution>The University of Texas at Austin, Center for Learning and Memory</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Frank</surname><given-names>Michael J</given-names></name><role>Senior Editor</role><aff><institution>Brown University</institution><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>22</day><month>10</month><year>2018</year></pub-date><pub-date pub-type="collection"><year>2018</year></pub-date><volume>7</volume><elocation-id>e38169</elocation-id><history><date date-type="received" iso-8601-date="2018-05-08"><day>08</day><month>05</month><year>2018</year></date><date date-type="accepted" iso-8601-date="2018-10-21"><day>21</day><month>10</month><year>2018</year></date></history><permissions><copyright-statement>© 2018, Keinath et al</copyright-statement><copyright-year>2018</copyright-year><copyright-holder>Keinath et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-38169-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.38169.001</object-id><p>In familiar environments, the firing fields of entorhinal grid cells form regular triangular lattices. However, when the geometric shape of the environment is deformed, these time-averaged grid patterns are distorted in a grid scale-dependent and local manner. We hypothesized that this distortion in part reflects dynamic anchoring of the grid code to displaced boundaries, possibly through border cell-grid cell interactions. To test this hypothesis, we first reanalyzed two existing rodent grid rescaling datasets to identify previously unrecognized boundary-tethered shifts in grid phase that contribute to the appearance of rescaling. We then demonstrated in a computational model that boundary-tethered phase shifts, as well as scale-dependent and local distortions of the time-averaged grid pattern, could emerge from border-grid interactions without altering inherent grid scale. Together, these results demonstrate that environmental deformations induce history-dependent shifts in grid phase, and implicate border-grid interactions as a potential mechanism underlying these dynamics.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>grid cell</kwd><kwd>place cell</kwd><kwd>hippocampus</kwd><kwd>entorhinal cortex</kwd><kwd>computational model</kwd><kwd>deformation</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Rat</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>PHY-1734030</award-id><principal-award-recipient><name><surname>Balasubramanian</surname><given-names>Vijay</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>EY022350</award-id><principal-award-recipient><name><surname>Epstein</surname><given-names>Russell A</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>0966142</award-id><principal-award-recipient><name><surname>Keinath</surname><given-names>Alexandra T</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>EY027047</award-id><principal-award-recipient><name><surname>Epstein</surname><given-names>Russell A</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>PHY-1607611</award-id><principal-award-recipient><name><surname>Balasubramanian</surname><given-names>Vijay</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution>Honda Research Institute</institution></institution-wrap></funding-source><award-id>Curious-Minded Machines program</award-id><principal-award-recipient><name><surname>Balasubramanian</surname><given-names>Vijay</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>When a familiar environment is reshaped, the grid cell spatial code is dynamically anchored to recently encountered boundaries and changes throughout exploration with the specific movement history of the navigator.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>The hippocampal formation is thought to maintain a metric representation of space that preserves distances between represented locations, sometimes referred to as a cognitive map (<xref ref-type="bibr" rid="bib38">O'Keefe and Nadel, 1978</xref>; <xref ref-type="bibr" rid="bib37">O'Keefe and Dostrovsky, 1971</xref>). Entorhinal grid cells are hypothesized to generate this metric via an internally updated, path-integrated representation of space (<xref ref-type="bibr" rid="bib19">Hafting et al., 2005</xref>; <xref ref-type="bibr" rid="bib31">McNaughton et al., 2006</xref>; <xref ref-type="bibr" rid="bib32">Moser and Moser, 2008</xref>; <xref ref-type="bibr" rid="bib9">Buzsáki and Moser, 2013</xref>; <xref ref-type="bibr" rid="bib33">Moser et al., 2014</xref>; <xref ref-type="bibr" rid="bib14">Fuhs and Touretzky, 2006</xref>). Results of environmental deformation experiments have led to the belief that this metric is fundamentally malleable (<xref ref-type="bibr" rid="bib2">Barry et al., 2007</xref>; <xref ref-type="bibr" rid="bib27">Krupic et al., 2016</xref>; <xref ref-type="bibr" rid="bib49">Stensola et al., 2012</xref>; <xref ref-type="bibr" rid="bib28">Krupic et al., 2018</xref>). In these experiments, neural activity is recorded as a rat explores a familiar environment that has been modified by stretching, compressing, or removing/inserting chamber walls. Such deformations induce a number of distortions in the time-averaged activity of both grid cells (<xref ref-type="bibr" rid="bib2">Barry et al., 2007</xref>; <xref ref-type="bibr" rid="bib49">Stensola et al., 2012</xref>) and hippocampal place cells (<xref ref-type="bibr" rid="bib36">O'Keefe and Burgess, 1996</xref>; <xref ref-type="bibr" rid="bib16">Gothard et al., 1996</xref>; <xref ref-type="bibr" rid="bib1">Barry et al., 2006</xref>; <xref ref-type="bibr" rid="bib34">Muller and Kubie, 1987</xref>; <xref ref-type="bibr" rid="bib29">Lever et al., 2002</xref>). Often described as ‘rescaling’, these distortions have been taken to suggest that the spatial metric of the cognitive map can be reshaped by altering environmental geometry (<xref ref-type="bibr" rid="bib2">Barry et al., 2007</xref>; <xref ref-type="bibr" rid="bib47">Sheynikhovich et al., 2009</xref>; <xref ref-type="bibr" rid="bib43">Raudies et al., 2016</xref>). This interpretation assumes that the distortions observed in the time-averaged rate maps of grid and place cells reflect fixed changes to the underlying spatial code that are independent of the movement history of the navigator. Here, we present results that challenge this assumption, and indicate that the grid cell spatial metric undergoes dynamic history-dependent phase shifts during environmental deformations.</p><p>In a familiar environment, local navigational boundaries play an important role in anchoring the grid code. For example, the grid representation is most precise when the navigator has recently encountered a boundary (<xref ref-type="bibr" rid="bib20">Hardcastle et al., 2015</xref>). When the environment is moved relative to the broader reference frame of the experimental room, grid phase often remains anchored to the local boundaries (<xref ref-type="bibr" rid="bib46">Savelli et al., 2017</xref>). At a circuit level, these dynamics may be driven by input to grid cells from border cells. Co-localized with grid cells in the entorhinal cortex, border cells are active only when a boundary is nearby and at a particular allocentric direction. Simulations have demonstrated that border input can be sufficient to reset grid phase and stabilize the grid pattern, provided that border inputs coding for different boundaries map to a consistent allocentric grid phase (<xref ref-type="bibr" rid="bib20">Hardcastle et al., 2015</xref>; <xref ref-type="bibr" rid="bib41">Pollock et al., 2018</xref>).</p><p>During an environmental deformation, the familiar arrangement of boundaries is altered. In turn, the relationship among the firing fields of border cells is also altered: stretching or compressing a boundary yields a concomitant rescaling of border activity, displacing a boundary also displaces neighboring border fields, and inserting a new boundary elicits additional border fields at analogous locations neighboring both boundaries (<xref ref-type="bibr" rid="bib48">Solstad et al., 2008</xref>; <xref ref-type="bibr" rid="bib45">Savelli et al., 2008</xref>). This entails that a mapping of border input to grid phase adapted to the familiar environment will no longer signal a consistent allocentric grid phase. This predicts that during a deformation grid phase will dynamically shift as the navigator encounters different boundaries. Importantly, such boundary-tethered shifts in grid phase would be obscured during traditional time-averaged analyses in which data following encounters with different boundaries are pooled together. However, averaging over such shifts would also contribute to distortions of the time-averaged pattern. Thus, grid pattern distortions during environmental deformations may be in part driven by input from border cells (<xref ref-type="bibr" rid="bib27">Krupic et al., 2016</xref>; <xref ref-type="bibr" rid="bib20">Hardcastle et al., 2015</xref>; <xref ref-type="bibr" rid="bib48">Solstad et al., 2008</xref>; <xref ref-type="bibr" rid="bib15">Giocomo, 2016</xref>; <xref ref-type="bibr" rid="bib7">Bush et al., 2014</xref>; <xref ref-type="bibr" rid="bib12">Cheung, 2014</xref>), specifically through dynamic history-dependent shifts in grid phase throughout exploration.</p><p>To test this prediction, we reexamined datasets from two previous environmental deformation experiments (<xref ref-type="bibr" rid="bib2">Barry et al., 2007</xref>; <xref ref-type="bibr" rid="bib49">Stensola et al., 2012</xref>). Our analyses revealed direct evidence of boundary-tethered shifts in grid phase during environmental deformations. These shifts were previously unrecognized and contribute to the appearance of rescaling in the time-averaged rate maps. Next, we implemented a computational model of border cell-grid cell interactions which reproduced these dynamics. These simulations further demonstrated that boundary-tethered shifts in grid phase can interact with the particular path of the navigator to give rise to grid scale-dependent rescaling and local distortions of the time-averaged grid pattern, as observed experimentally (<xref ref-type="bibr" rid="bib2">Barry et al., 2007</xref>; <xref ref-type="bibr" rid="bib49">Stensola et al., 2012</xref>; <xref ref-type="bibr" rid="bib28">Krupic et al., 2018</xref>). Together, these results demonstrate that geometric deformations of a familiar environment induce history-dependent shifts in grid phase and implicate border cell-grid cell interactions as a potential source of these dynamics.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Boundary-tethered shifts in grid phase are observed in recorded grid cells during rescaling deformations</title><p>To test whether boundary-tethered shifts in grid phase are observed during environmental deformations, we reanalyzed data from two classic deformation studies ((<xref ref-type="bibr" rid="bib2">Barry et al., 2007</xref>) and (<xref ref-type="bibr" rid="bib49">Stensola et al., 2012</xref>)). In <xref ref-type="bibr" rid="bib2">Barry et al., 2007</xref>), rats were familiarized with either a 100 cm x 100 cm square or a 100 cm x 70 cm rectangular open environment, and then reintroduced to deformed and undeformed versions of these environments (i.e. all combinations of chamber lengths and widths of 70 cm or 100 cm), while the activity of grid cells was recorded (familiar square: 23 grid cells; familiar rectangle: 13 grid cells meeting criteria; see Materials and methods). In <xref ref-type="bibr" rid="bib49">Stensola et al. (2012)</xref>, rats were familiarized with a 150 cm x 150 cm square open environment, and then reintroduced to deformed (100 cm x 150 cm rectangular) and undeformed versions of this environment, while data were recorded from 51 grid cells. As previously reported (<xref ref-type="bibr" rid="bib2">Barry et al., 2007</xref>; <xref ref-type="bibr" rid="bib49">Stensola et al., 2012</xref>), the time-averaged grid patterns of most of these grid cells appeared to rescale when the environment was deformed, though the grid patterns of a subset of cells with smaller grid scales did not.</p><p>First, we separated the spiking data of each cell according to the most recently contacted boundary, either the north, south, east or west, with contact defined as coming within 12 cm of that boundary (<xref ref-type="bibr" rid="bib20">Hardcastle et al., 2015</xref>). From these data, we created four boundary rate maps which summarized the spatial firing pattern of the grid cell after contacting each boundary. Comparison of such rate maps, conditioned on contact with opposing boundaries (north-south vs. east-west), revealed clear examples of grid shift along deformed dimensions (<xref ref-type="fig" rid="fig1">Figure 1</xref>). To quantify shift separately for each dimension, we cross-correlated the opposing boundary rate map pairs (i.e. north-south or east-west boundary pairs) and computed the distance from center of the cross-correlogram (0,0 lag) to the peak nearest the center along the dimension of interest (see Materials and methods). To ensure that any shifts observed were not the product of differential spatial sampling following each boundary contact, we randomly selected subsets of the data to match the number of samples at each pixel prior to constructing each opposing boundary rate map for this analysis (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). The mean shift across 100 iterations of this analysis was then taken as the final measurement of shift along that dimension.</p><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.38169.002</object-id><label>Figure 1.</label><caption><title>Examples of whole trial rate maps, boundary-conditioned spikes, boundary rate maps, and cross-correlograms of opposing boundary rate maps for recorded grid cells.</title><p>Rat, session, and cell identity indicated above whole trial rate maps. Boundary-conditioned spikes and boundary rate maps organized by opposing north-south (green—purple) and east-west (blue—red) boundary pairs. Colored arrows in morph condition indicate the shifts predicted by the boundary-tethered model during each deformation.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-38169-fig1-v2"/></fig><p>Even in a familiar environment, finite sampling noise will cause this measure of shift to be nonzero. Compared to this baseline, grid shift increased along deformed, but not undeformed, dimensions (<xref ref-type="fig" rid="fig2">Figure 2A</xref>; <xref ref-type="supplementary-material" rid="fig2sdata1">Figure 2—source data 1</xref>). An increased shift was observed even in cells with small-scale grid patterns (<xref ref-type="fig" rid="fig2">Figure 2B</xref>), as well as cells whose time-averaged grid patterns did not appear to rescale (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). This increase in shift along deformed dimensions was not due to differences in sampling during deformation trials (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). In sum, these results indicate that deformation-induced phase shifts are observed in grid cells regardless of their scale or the extent to which their time-averaged rate maps resemble a rescaling.</p><fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.38169.003</object-id><label>Figure 2.</label><caption><title>Opposing boundary rate maps are relatively shifted in phase along deformed dimensions during deformations.</title><p>Data from all experiments in (<xref ref-type="bibr" rid="bib2">Barry et al., 2007</xref>; <xref ref-type="bibr" rid="bib49">Stensola et al., 2012</xref>) combined. All error bars denote mean ±SEM. (<bold>A</bold>) Grid shift as measured by the relative phase between opposing boundary rate maps along deformed and undeformed dimensions. Because of the periodic nature of the grid pattern, shift is bounded by one half of the grid scale. Therefore, we quantify shift as a ratio of shift / (scale/2). (paired t-tests, 1st familiar vs. deformed: t(80) = 5.44, p&lt;0.001; undeformed vs. deformed: t(83) = 4.21, p=0.001; 2nd familiar vs. deformed: t(82) = 5.07, p&lt;0.001; all other comparisons: t &lt; 1.10, p&gt;0.2731; <xref ref-type="supplementary-material" rid="fig2sdata1">Figure 2—source data 1</xref>). (<bold>B</bold>) Histogram of grid scale (left) and shift ratio separated by grid scale along deformed dimensions with mean familiar shift ratio subtracted (right). (t-test versus 0, scale &lt;60 cm: t(45) = 3.43, p=0.001; scale &gt;60 cm: t(40) = 4.67, p&lt;0.001; <xref ref-type="supplementary-material" rid="fig2sdata1">Figure 2—source data 1</xref>). (<bold>C</bold>) Histogram of rescaling (left) and shift ratio separated by rescale along deformed dimensions with mean familiar shift ratio subtracted (right). Because rescaling could vary within cell along deformed dimensions, each condition and deformed dimension was treated independently. (t-test versus 0, rescaling &lt;50%: t(61) = 3.39, p=0.001; rescaling &gt;50%: t(130) = 7.05, p&lt;0.001; <xref ref-type="supplementary-material" rid="fig2sdata1">Figure 2—source data 1</xref>). **p&lt;0.01, ***p&lt;0.001.</p><p><supplementary-material id="fig2sdata1"><object-id pub-id-type="doi">10.7554/eLife.38169.005</object-id><label>Figure 2—source data 1.</label><caption><title>Results of grid shift analyses.</title><p>Contains the values resulting from the shift analysis for each cell trial, as well as the familiar grid scale, amount of rescaling, and shuffled control shift on each trial for each cell.</p></caption><media mime-subtype="excel" mimetype="application" xlink:href="elife-38169-fig2-data1-v2.xls"/></supplementary-material></p><p><supplementary-material id="fig2sdata2"><object-id pub-id-type="doi">10.7554/eLife.38169.006</object-id><label>Figure 2—source data 2.</label><caption><title>Results of phase alignment analysis.</title><p>Contains the values resulting from the alignment analysis indicating whether each boundary rate map was best aligned with the familiar rate map by the most recently contacted boundary (1) or the opposing boundary (0).</p></caption><media mime-subtype="excel" mimetype="application" xlink:href="elife-38169-fig2-data2-v2.xls"/></supplementary-material></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-38169-fig2-v2"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38169.004</object-id><label>Figure 2—figure supplement 1.</label><caption><title>Controlling for sampling biases when measuring boundary-tethered shift.</title><p>To control for sampling differences following each boundary contact during each trial, we matched the sampling distributions of opposing boundary rate maps when computing shift. (<bold>A</bold>) Example sampling distributions and boundary rate maps when all data following boundary contacts are included (top row) and when the sampling distributions are equated (bottom row). (<bold>B</bold>) Because the deformed environments differ in shape and size from the familiar environments, and because the particular movement trajectories of the animal differ from trial to trial, there may be differences in the baseline amount of shift one would expect to observe across conditions. To control for this possibility, we used the whole-trial rate map of each cell as a template for simulating Poisson spikes using the same trajectory as the recorded data. From these simulations, we extracted boundary tethered rate maps and computed shifts between maps tethered to opposite boundaries. We repeated this process 100 times, and took the mean as our measure of the shift one would expect by chance for a cell with that particular rate map and sampling trajectory. This control reflects the shift one would expect if each boundary rate map were a random draw from a stable whole-trial rate map. The shift observed along deformed dimensions exceeded this control (paired t-test: t(87)=5.67, p&lt;0.001). Moreover, the difference between the observed and control shift values was significantly larger along deformed dimensions than that of all other conditions (paired t-tests, 1st familiar vs. deformed: t(80) = 2.66, p=0.010; undeformed vs. deformed: t(83) = 3.77, p&lt;0.001; 2nd familiar vs. deformed: t(82) = 2.64, p=0.010; all other comparisons: t &lt; 1.9, p&gt;0.060; <xref ref-type="supplementary-material" rid="fig2sdata1">Figure 2—source data 1</xref>).</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-38169-fig2-figsupp1-v2"/></fig></fig-group><p>Next, we tested whether the grid pattern of each boundary rate map maintained its familiar phase relative to the corresponding boundary. To address this question, we compared each boundary rate map to the whole-trial familiar environment rate map, while varying the alignment of the two maps along the deformed dimension. If the spatial relationship relative to the most recently contacted boundary is preserved, then each boundary rate map should be most similar to the familiar environment rate map when the two maps are aligned by the corresponding boundary. If, on the other hand, reshaping a familiar environment rescales the grid pattern symmetrically, then the familiar and boundary rate maps should be equally well aligned by either the corresponding or the opposite boundary. Consistent with the boundary-tethered prediction, we found that the correlation between the deformed environment boundary rate map and the familiar environment rate map was maximized when the two maps were aligned by the corresponding boundary rather than the opposite boundary (313 of 390 comparisons; sign test versus 50%: p&lt;0.001; <xref ref-type="supplementary-material" rid="fig2sdata2">Figure 2—source data 2</xref>).</p><p>Boundary-tethered shifts in grid phase may contribute to the appearance of rescaling. If so, then the appearance of rescaling should be reduced when the data are divided according to the most recently contacted boundary. In contrast, if boundary-tethered shifts do not contribute to the appearance of rescaling, then a similar amount of rescaling should be observed regardless of whether or not data are conditioned on the most recently contacted boundary. To test these predictions, we computed the grid rescaling factor between the familiar rate map and each deformed-dimension boundary rate map, aligned by the corresponding boundary. For comparison, we also computed the grid rescaling factor between the familiar rate map and the whole-trial rate map, aligned by the same boundary. To ensure that any reduction in rescaling observed was not the product of differential spatial sampling following boundary contact, we randomly selected subsets of the whole-trial data to match the sampling distributions of the whole-trial rate map and boundary rate map for each comparison (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). The mean rescaling across 100 iterations of this analysis was then taken as the final measurement of whole-trial rate map rescaling. This analysis revealed a significant reduction in the appearance of rescaling following boundary-conditioning (<xref ref-type="fig" rid="fig3">Figure 3A</xref>; <xref ref-type="supplementary-material" rid="fig3sdata1">Figure 3—source data 1</xref>), consistent with a contribution of boundary-tethered phase shifts to the appearance of rescaling in grid cells.</p><fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.38169.007</object-id><label>Figure 3.</label><caption><title>Additional tests of boundary-tethered phase shift predictions.</title><p>Data from all experiments in (<xref ref-type="bibr" rid="bib2">Barry et al., 2007</xref>; <xref ref-type="bibr" rid="bib49">Stensola et al., 2012</xref>) combined unless otherwise noted. All error bars denote mean ± SEM. All reported statistics are paired t-tests, unless otherwise noted. (<bold>A</bold>) Whole-trial versus boundary-conditioned grid rescaling factors, normalized to range from no rescaling (0%) to a matched rescaling (100%). Boundary-conditioning resulted in a significant reduction in the appearance of rescaling (t(194) = 9.54, p&lt;0.001; <xref ref-type="supplementary-material" rid="fig3sdata1">Figure 3—source data 1</xref>). (<bold>B</bold>) Field length along deformed and undeformed dimensions during compression deformations. (1st familiar vs. deformed: t(80) = 3.70, p&lt;0.001; undeformed vs. deformed: t(86) = 2.43, p=0.017; 2nd familiar vs. deformed: t(82) = 3.49, p&lt;0.001; all other comparisons: t &lt; 1.45, p&gt;0.151; <xref ref-type="supplementary-material" rid="fig3sdata2">Figure 3—source data 2</xref>). (<bold>C</bold>) Change in firing rates across conditions. (Peak firing rates, 1st familiar vs. deformation: t(80) = 3.57, p&lt;0.001; 2nd familiar vs. deformation: t(82) = 3.34, p=0.001; 1st familiar vs. 2nd familiar: t(76) = 0.91, p=0.364; Mean firing rates, 1st familiar vs. deformation: t(80) = 3.57, p&lt;0.001; 2nd familiar vs. deformation: t(82) = 3.34, p=0.001; 1st familiar vs. 2nd familiar: t(76) = 0.91, p=0.364; Mean firing rates, 1st familiar vs. deformation: t(80) = 0.54, p=0.591; 2nd familiar vs. deformation: t(82) = 0.03, p=0.978; 1st familiar vs. 2nd familiar: t(76) = 0.71, p=0.479; <xref ref-type="supplementary-material" rid="fig3sdata3">Figure 3—source data 3</xref>). (<bold>D</bold>) Examples of recorded and predicted rate maps during one deformation trial for two simultaneously recorded cell from (<xref ref-type="bibr" rid="bib49">Stensola et al., 2012</xref>). (<bold>E</bold>) Correlation values between the recorded rate map and the rate maps predicted by the boundary-tethered model versus a matched rescaling during compression deformations (<xref ref-type="supplementary-material" rid="fig3sdata4">Figure 3—source data 4</xref>). (<bold>F</bold>) Cumulative distribution of the correlation values depicted in (<bold>E</bold>). The boundary-tethered model results in fewer low-similarity predictions than a matched rescaling (two-sample Kolmogorov-Smirnov test: D = 0.2030, p=0.007: <xref ref-type="supplementary-material" rid="fig3sdata4">Figure 3—source data 4</xref>). *p&lt;0.05, **p&lt;0.01, ***p&lt;0.001.</p><p><supplementary-material id="fig3sdata1"><object-id pub-id-type="doi">10.7554/eLife.38169.009</object-id><label>Figure 3—source data 1.</label><caption><title>Results of rescaling analysis.</title><p>Contains the values resulting from the rescaling analysis indicating for each deformed axis the amount of rescaling observed during the whole trial, after boundary-conditioning, and when only a subset of the whole-trial data are included to match the boundary-conditioned sampling distribution.</p></caption><media mime-subtype="excel" mimetype="application" xlink:href="elife-38169-fig3-data1-v2.xls"/></supplementary-material></p><p><supplementary-material id="fig3sdata2"><object-id pub-id-type="doi">10.7554/eLife.38169.010</object-id><label>Figure 3—source data 2.</label><caption><title>Results of field length analysis.</title><p>Contains the values resulting from the field length analysis in pixels for each cell.</p></caption><media mime-subtype="excel" mimetype="application" xlink:href="elife-38169-fig3-data2-v2.xls"/></supplementary-material></p><p><supplementary-material id="fig3sdata3"><object-id pub-id-type="doi">10.7554/eLife.38169.011</object-id><label>Figure 3—source data 3.</label><caption><title>Results of firing rate analysis.</title><p>Contains the values resulting from the firing rate analysis in Hertz for each cell.</p></caption><media mime-subtype="excel" mimetype="application" xlink:href="elife-38169-fig3-data3-v2.xls"/></supplementary-material></p><p><supplementary-material id="fig3sdata4"><object-id pub-id-type="doi">10.7554/eLife.38169.012</object-id><label>Figure 3—source data 4.</label><caption><title>Results of map prediction analysis.</title><p>Contains the correlation values between the recorded deformation trial rate map and the rate maps predicted by the boundary-tethered model and a matched rescaling for each cell and trial.</p></caption><media mime-subtype="excel" mimetype="application" xlink:href="elife-38169-fig3-data4-v2.xls"/></supplementary-material></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-38169-fig3-v2"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38169.008</object-id><label>Figure 3—figure supplement 1.</label><caption><title>Predicting whole-trial rate maps from boundary-tethered shifts in grid phase.</title><p>(<bold>A</bold>) To predict rate maps from the boundary-tethered shifts for each cell and compression deformation trial we first created predicted boundary rate maps from the familiar environment rate map for each displaced boundary. These rate maps were shifted versions of the familiar rate map, aligned by the corresponding boundary. If the length of a boundary changed, then the central portion of the familiar rate map was used to construct the boundary rate map. Next, the contribution of each boundary rate map at each location was weighted by the actual probability of sampling that location following contact with the corresponding boundary for that deformation trial, computed from the actual path of the rat during that deformation trial. The final boundary-tethered prediction was then the smoothed sum of these predicted boundary rate maps. (<bold>B</bold>) Example recorded rate maps, accompanied by the predictions from the boundary-tethered model and a rescaling matched to the extent of the deformation. Rat, session, and cell identity indicated below each set of recorded rate maps.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-38169-fig3-figsupp1-v2"/></fig></fig-group><p>We next tested whether environmental deformations affect grid field size. Boundary-tethered phase shifts, when averaged over the whole trial, should yield an increase in field length primarily along deformed dimensions, regardless of whether the environment was compressed or stretched. On the other hand, a pure rescaling of the grid pattern predicts an increase in field length during stretching deformations, but a decrease in field length during compressions. Because both accounts predict an increase in field length during stretching deformations, we focused on compression trials. From the whole-trial rate maps of each cell, we computed the field length during compression deformations, separately along deformed and undeformed dimensions. This analysis revealed an increase in field length along deformed, but not undeformed, dimensions relative to field length in the familiar environment (<xref ref-type="fig" rid="fig3">Figure 3B</xref>; <xref ref-type="supplementary-material" rid="fig3sdata2">Figure 3—source data 2</xref>), consistent with the boundary-tethered prediction. For completeness, we also examined stretching deformations. Field length along deformed dimensions also increased numerically during these deformations (mean ±SEM, familiar: 33.27 ± 5.39 cm; deformed: 34.81 ± 4.17 cm), although this effect did not reach significance in this small sample (n = 13; paired t-test: t(12) = 0.22, p=0.828).</p><p>We then examined whether deformations affected firing rates in a manner consistent with the boundary-tethered phase shift prediction. If, during deformations, grid vertices are shifted to different locations when different boundaries are encountered, then averaging across trajectories originating from multiple boundaries will necessarily reduce the peak values of the whole trial rate map. Thus, the boundary-tethered model predicts a reduction in the peak firing rate during environmental deformations, as measured by the maximum value of the whole-trial rate map. On the other hand, because the density of grid fields within the environment remains unchanged on average, grid shift does not predict a change in mean firing rate, as measured by the total number of spikes across the entire trial divided by the trial duration. Although a pure rescaling account does not make specific predictions about peak and mean firing rates, the simplest assumption would be that neither should change, as the density and intensity of fields tiling the space should be preserved during deformations (<xref ref-type="bibr" rid="bib23">Ismakov et al., 2017</xref>). Consistent with the boundary-tethered phase shift prediction, peak firing rates were significantly reduced during deformation trials relative to familiar trials while mean firing rates did not differ significantly (<xref ref-type="fig" rid="fig3">Figure 3C</xref>; <xref ref-type="supplementary-material" rid="fig3sdata3">Figure 3—source data 3</xref>).</p><p>Finally, we tested whether deformed rate maps could be accurately predicted by boundary-tethered phase shifts on a trial-by-trial basis. To do so, for each cell and deformation trial we first created predicted boundary rate maps for each displaced boundary from the familiar environment rate map. These rate maps were shifted versions of the familiar rate map, aligned by the corresponding boundary (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). If the length of a boundary changed, then the central portion of the familiar rate map was used to construct the boundary rate map. Next, each boundary rate map was weighted by the actual sampling biases of the rat during that deformation trial. The final boundary-tethered prediction was then the smoothed sum of these weighted predicted boundary rate maps (See Materials and methods). For comparison, we also computed a rescaled rate map in which the familiar rate map was rescaled to match the deformation. Because additional fields may appear during stretching deformations which were not sampled in the smaller familiar environment, we focused only on compression trials. Across cells, recorded rate maps were more similar to those predicted by the boundary-tethered model than to those predicted by a matched rescaling (<xref ref-type="fig" rid="fig3">Figure 3D</xref>; <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>; <xref ref-type="supplementary-material" rid="fig3sdata4">Figure 3—source data 4</xref>), as quantified by the correlations between maps (paired t-test comparing Fisher-transformed correlation values: t(132) = 2.95, p=0.004; <xref ref-type="fig" rid="fig3">Figure 3E</xref>). This difference was predominantly driven by cells whose activity did not resemble a matched rescaling: recorded rate maps which were well-predicted by a matched rescaling were often similarly well-predicted by the boundary-tethered model, while recorded maps which were not well-predicted by a matched rescaling were nevertheless well-predicted by the boundary-tethered model. This pattern was reflected in the observation of fewer low-similarity predictions from the boundary-tethered model than from a matched rescaling (<xref ref-type="fig" rid="fig3">Figure 3F</xref>). We note, however, that a subset of recorded rate maps were better predicted by a matched rescaling, suggesting that the contribution of boundary-tethered phase shifts to whole-trial rate map distortions may vary (<xref ref-type="fig" rid="fig3">Figure 3E</xref>). Nevertheless, boundary-tethered phase shifts can accurately predict individual whole-trial rate maps on a trial-by-trial basis, even when the resulting rate map does not resemble a rescaling.</p><p>In sum, we have shown that conditioning grid cell activity according to the most recently contacted boundary during environmental deformations reveals grid patterns which are shifted relative to one another, anchored to the conditioned boundary, and appear less rescaled than the whole-trial grid pattern. Furthermore, we have shown that whole-trial field length increases along deformed dimensions, and whole-trial peak firing rates decrease during deformations while mean firing rate remains unchanged, matching boundary-tethered predictions. Finally, we have demonstrated that the boundary-tethered phase shifts, coupled with the particular sampling of the navigator, can accurately predict whole-trial rate maps during deformations whether or not the resulting maps resemble a matched rescaling. Together, these results provide convergent evidence that boundary-tethered shifts in grid phase are present during environmental deformations and contribute to distortions of the time-averaged grid pattern.</p></sec><sec id="s2-2"><title>A model of border cell-grid cell interactions reproduces boundary-tethered phase shifts, scale-dependent rescaling, and local distortions during deformations</title><p>Electrophysiological experiments have shown that rescaling a familiar environment can induce a corresponding rescaling of time-averaged grid patterns, dependent on grid scale (<xref ref-type="bibr" rid="bib2">Barry et al., 2007</xref>; <xref ref-type="bibr" rid="bib49">Stensola et al., 2012</xref>). Relatedly, when part of one wall is displaced, the time-averaged grid pattern is locally distorted near that wall, with grid fields neighboring that wall shifting in the direction of displacement (<xref ref-type="bibr" rid="bib28">Krupic et al., 2018</xref>). Our reanalysis has demonstrated that boundary-tethered shifts in grid phase are observed during rescaling deformations and contribute to the appearance of rescaling in the time-averaged rate maps of grid cells. Together, these results suggest that boundary-tethered phase shifts may also contribute to the scale-dependent and local nature of these deformation-induced distortions.</p><p>We addressed this possibility computationally by implementing a spiking network model of the interactions between border and grid cells which captured boundary-tethered phase shift dynamics (<xref ref-type="bibr" rid="bib24">Keinath, 2018</xref>). (To disambiguate recorded from modeled border and grid cells, we refer to all modeled cells as units.) The border population consisted of 32 units whose activity was designed to mimic the behavior of border cells (<xref ref-type="bibr" rid="bib48">Solstad et al., 2008</xref>). Each border unit was active only when a boundary was nearby, within 12 cm in a particular allocentric direction (<xref ref-type="bibr" rid="bib20">Hardcastle et al., 2015</xref>). The preferred firing field of each border unit covered 50% of the length of one side of the environment. Across units, fields were uniformly distributed around the perimeter with the fields of some units wrapping around corners (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). Fields maintained proportional coverage when the preferred boundary was deformed (<xref ref-type="bibr" rid="bib41">Pollock et al., 2018</xref>; <xref ref-type="bibr" rid="bib48">Solstad et al., 2008</xref>; <xref ref-type="bibr" rid="bib45">Savelli et al., 2008</xref>). The model also instantiated five grid modules, each consisting of a neural sheet of size 128 × 128 units. The internal connectivity and dynamics of each module was based on an attractor model implementing path integration described in <xref ref-type="bibr" rid="bib6">Burak and Fiete (2009)</xref>, and was identical across modules except for a single movement velocity gain parameter which controlled the grid scale of each module. This parameter was adjusted to yield a geometric series of scales across modules (scale factor of 1.42), as observed experimentally (<xref ref-type="bibr" rid="bib49">Stensola et al., 2012</xref>) and explained theoretically (<xref ref-type="bibr" rid="bib52">Wei et al., 2015</xref>; <xref ref-type="bibr" rid="bib30">Mathis et al., 2012</xref>). In the absence of border unit input, grid unit activity in this model is determined by path integration alone.</p><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.38169.013</object-id><label>Figure 4.</label><caption><title>A model of border cell-grid cell interactions reproduces boundary-tethered shifts in grid phase during environmental deformations.</title><p>(<bold>A</bold>) The network model consisted of two layers: a border layer, where unit activity was determined by the presence of a boundary nearby (&lt;12 cm) and in a particular allocentric direction, and a grid layer, where path integration implemented by a periodic attractor network of the form described in <xref ref-type="bibr" rid="bib6">Burak and Fiete (2009)</xref> was used to generate five modules of grid units of different scales. During deformations, border fields scale in concert with changes to their preferred boundary and shift when their preferred boundary is displaced. (<bold>B</bold>) During familiarization, excitatory connections from border units to coactive grid units were strengthened at the expense of non-coactive connections. In deformed environments, border inputs reinstated the familiar phase relative to the most recently contacted boundary (schematically (<bold>C</bold>) and in the model (<bold>D</bold>)). (<bold>E</bold>) Averaged over time, these shifts in grid phase can resemble rescaling.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-38169-fig4-v2"/></fig><p>In addition to the connections among units within its module, each grid unit also received initially random excitatory input from all border units. During familiarization, these connections developed through experience via a Hebbian learning rule in which connections between coactive grid and border units were strengthened at the expense of connections from inactive border units (<xref ref-type="bibr" rid="bib18">Grossberg, 1980</xref>) (<xref ref-type="fig" rid="fig4">Figure 4B</xref>; see Materials and methods). Once familiarized, border unit input acted to reinstate the grid network state associated with the same pattern of border unit responses during familiarization. This grid reinstatement occurred even when border inputs were activated at a new location, such as when a displaced boundary was encountered. In a rescaled environment, this grid reinstatement led to shifts in grid phase, such that the phase relative to the most recent border input matched the phase entrained during familiarization in the undeformed environment (<xref ref-type="fig" rid="fig4">Figure 4C,D</xref>). Averaged over time, these shifts in grid phase can resemble a rescaling (<xref ref-type="fig" rid="fig4">Figure 4E</xref>). Thus, deformations of a familiar environment induced boundary-tethered phase shifts in modeled grid units which can contribute to the appearance of rescaling, similar to those we observed in recorded grid cells.</p><p>Next, we tested whether the appearance of rescaling in this model depends on grid scale. To do so, we first familiarized a naive virtual rat with a 150 cm x 150 cm square environment. During this familiarization period, the border-grid connectivity self-organized via Hebbian learning. The virtual rat then explored the familiar environment and deformed versions of this environment without new learning (chamber lengths between 100 cm to 200 cm in increments of 25 cm; chamber sizes chosen to match experiment (<xref ref-type="bibr" rid="bib49">Stensola et al., 2012</xref>)). Consistent with previous experimental reports (<xref ref-type="bibr" rid="bib2">Barry et al., 2007</xref>; <xref ref-type="bibr" rid="bib49">Stensola et al., 2012</xref>), we observed that these deformations induced rescaling of time-averaged rate maps in some grid modules (<xref ref-type="fig" rid="fig5">Figure 5A</xref>). To quantify this module-dependent rescaling, we computed the grid rescaling factor required to stretch or compress the time-averaged rate maps in the familiar environment to best match the rate maps in the deformed environment, separately for each unit. We found that the grid patterns of units in large-scale modules rescaled with the environment, but grid patterns of units in small-scale modules tended not to rescale (<xref ref-type="fig" rid="fig5">Figure 5B</xref>), as observed experimentally (<xref ref-type="bibr" rid="bib49">Stensola et al., 2012</xref>). Rate-based simulations with larger border fields covering 100% of the length of one wall, and simulation in which boundary-tethered shifts were induced by fiat both reproduced these results (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>; <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>).</p><fig-group><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.38169.014</object-id><label>Figure 5.</label><caption><title>Grid unit responses to deformations of an open environment.</title><p>(<bold>A</bold>) Rate maps from one grid unit from each module across all rescaling deformations. Colors normalized to the maximum across each set of rate maps. Peak firing rate for each trial noted below the lower left corner of each map. (<bold>B</bold>) Grid rescaling factors for each module when the familiar open environment is rescaled to various chamber lengths (right). Error bars denote standard error of the mean (SEM) across 30 random grid units. Color denotes module. Distribution of grid scales for each module indicated (left). (<bold>C</bold>) Rate maps of one grid unit from each module across each partial deformation, plotted as in (<bold>A</bold>). (<bold>D</bold>) Correlation between the familiar and deformed environment rate maps across the population (150 grid units, 30 random cells from each module) at each location (bottom heatmaps) and averaged at each east-west position (top plots).</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-38169-fig5-v2"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38169.015</object-id><label>Figure 5—figure supplement 1.</label><caption><title>A rate-based network model with full-length border units reproduces boundary-tethered shifts, scale-dependent grid rescaling, and local distortions of the grid pattern during deformations.</title><p>The fields of border cells vary in coverage, with fields often covering the entire length of one wall. To ensure that our results were not exclusive to smaller field (50% the length of one border) border units, we reproduced our findings in a rate-based model in which all border units were active in fields 100% the length of one border. The following parameters were changed during rate-based model simulations: 64 border units were simulated; each grid module was composed of a 32 x 32 unit neural sheet; the grid translation scale factor <inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>; the learning rate <inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>.= 0.000075; weight of grid unit radial uniform inhibition was set to -0.045. Stochastic spiking dynamics were eliminated and instead the output activation of each unit was determined by setting <inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (<bold>A</bold>) Examples of rate-based border units. (<bold>B</bold>) Reproduction of scale-dependent grid rescaling (<xref ref-type="fig" rid="fig5">Figure 5A, B</xref>). (<bold>C</bold>) Reproduction of local distortion of the grid pattern during partial deformation (<xref ref-type="fig" rid="fig5">Figure 5C, D</xref>).</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-38169-fig5-figsupp1-v2"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38169.016</object-id><label>Figure 5—figure supplement 2.</label><caption><title>Scale-dependent rescaling arises from boundary-tethered shifts in simulations without plasticity.</title><p>In the main text, simulations were carried out over a limited range of grid scales and deformation extents because of computational constraints. (<bold>A</bold>) To extend this analysis to a much wider range of conditions, and to verify that our results are independent of the specific implementation of the model, we examined the effects of boundary-tethered grid shifts imposed directly on grid patterns. To do so, we first created familiar environment grid cell rate maps by overlapping and rectifying three 60°-offset sine waves (<xref ref-type="bibr" rid="bib7">Bush et al., 2014</xref>). Next, we created predicted boundary rate maps as described in the main text (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>), with sampling biases for each boundary rate map approximated as the inverse distance from the corresponding boundary. (<bold>B</bold>) Grid rescaling when a familiar 150 cm x 150 cm square environment is deformed as a function of grid scale and deformation extent. Grid rescaling normalized to range from no rescaling (0%) to a matched rescaling (100%). Note the dependence of the appearance of rescaling on grid scale and deformation extent, as well as the abrupt transition from the appearance of rescaling to a lack of an appearance of rescaling with more extreme deformations. (<bold>C</bold>) Example non-network simulated rate maps of various scales (30 cm, 45 cm, 60 cm, 90 cm, 120 cm) during a subset of deformations.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-38169-fig5-figsupp2-v2"/></fig><fig id="fig5s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.38169.017</object-id><label>Figure 5—figure supplement 3.</label><caption><title>A more extreme compression deformation does not produce matched rescaling.</title><p>Although grid rescaling was reported during deformation in two electrophysiological studies (<xref ref-type="bibr" rid="bib2">Barry et al., 2007</xref>; <xref ref-type="bibr" rid="bib49">Stensola et al., 2012</xref>), another study implementing a more extreme compression deformation experiment did not observe a matched rescaling, that is a rescaling in which the deformed rate map resembled a compressed version of the familiar rate map, in grid cells (<xref ref-type="bibr" rid="bib45">Savelli et al., 2008</xref>). To test whether the boundary-tethered model could account for a lack of rescaling during this more extreme compression, we familiarized the naive virtual rat with a 135 cm x 135 cm square environment. After this familiarization, the rat then again explored the familiar environment and a compressed 58 cm x 58 cm version of this environment without new learning. During this extreme compression, the grid patterns of modeled grid units did not resemble a matched rescaling of the familiar rate map, although distortions of the grid pattern were observed. Five random grid units from each module, peak firing rate denoted in bold below each map. Color normalized to the maximum for each rate map.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-38169-fig5-figsupp3-v2"/></fig></fig-group><p>How does scale-dependent rescaling emerge from boundary-tethered shifts in grid phase? Because the grid representation is periodic, border input can only reset the network state to within one period, analogous to a modulo operation. Generally, if the deformation extent is less than the grid period then different boundaries will reinstate different phases, resulting in a time-averaged grid pattern which appears rescaled. When the deformation extent nearly matches the grid period, different boundaries will reinstate a similar phase, yielding a largely undistorted time-averaged pattern. When the deformation extent exceeds the period, different boundaries will again reinstate different phases; thus, the time-averaged pattern will appear distorted. However, in the latter case, additional fields will appear (during stretches) or previously-observed fields will disappear (during compressions). Therefore, the time-averaged pattern, although distorted, will not resemble a simple rescaling of the grid to match the deformation.</p><p>In addition to capturing scale-dependent rescaling, this model further predicts that whether or not the grid patterns of a particular module appear to rescale is not an inherent property of the module, but rather an interaction between the grid scale and deformation extent. Specifically, modules with periods less than or equal to the deformation extent will tend not to resemble a rescaling, consistent with the data in (<xref ref-type="bibr" rid="bib49">Stensola et al., 2012</xref>). Moreover, this model predicts that a grid with a given scale can appear to rescale during less extreme but not during more extreme deformations, consistent with comparison across experiments (<xref ref-type="bibr" rid="bib2">Barry et al., 2007</xref>; <xref ref-type="bibr" rid="bib49">Stensola et al., 2012</xref>; <xref ref-type="bibr" rid="bib45">Savelli et al., 2008</xref>) (<xref ref-type="fig" rid="fig5s3">Figure 5—figure supplement 3</xref>). Finally, this model demonstrates that a single mechanism is capable of simultaneously reproducing the appearance and absence of rescaling across modules, suggesting that the extent of rescaling may not be clear evidence of a functional dissociation between modules (<xref ref-type="bibr" rid="bib49">Stensola et al., 2012</xref>).</p><p>Lastly, we tested whether the grid patterns of modeled grid units locally distorted during partial deformations. We familiarized a naive virtual rat with either a 180 cm×90 cm rectangular or right trapezoid environment (long parallel wall of the right trapezoidal environment was 180 cm, short parallel wall was 135 cm). During this familiarization period, the border-grid connectivity self-organized via Hebbian learning. Without new learning, the rat then explored both the rectangular and right trapezoid environments. During deformations, fields near the displaced wall were distorted, often shifting in concert with the displaced wall, while fields far from this wall were less affected (<xref ref-type="fig" rid="fig5">Figure 5C</xref>). To quantify this pattern, we computed the correlation between the familiar and deformed environment rate maps across the population at each location, sometimes called the population vector correlation. This correlation was high at locations far from the displaced wall but was reduced near the displaced wall (<xref ref-type="fig" rid="fig5">Figure 5D</xref>), indicating that time-averaged grid patterns were distorted near the displaced wall but preserved further away from that wall, as observed experimentally (<xref ref-type="bibr" rid="bib28">Krupic et al., 2018</xref>). Rate-based simulations with larger border fields covering 100% of the length of one wall also reproduced these results. (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>).</p><p>How do local distortions emerge from nonlocal boundary-tethered shifts in grid phase during deformations? In the model, distortions of the whole-trial rate map arise from averaging over shifts in grid phase which occur following contact with displaced boundaries. Importantly, the likelihood of having most recently encountered a given boundary differs throughout an open environment: locations near a boundary are more likely to be visited following an encounter with that boundary, while central locations are less biased (<xref ref-type="fig" rid="fig6">Figure 6A</xref>). Because of these biases, time-averaged grid fields near a boundary will appear less distorted than central fields during stretching and compression deformations. Similarly, during partial deformations, locations near the displaced wall are more likely to be visited following contact with that wall; thus shifts in phase following contact will predominantly affect nearby grid fields, with the phase relationship between this wall and neighboring fields better preserved even after averaging over time. Relatedly, the most recently encountered boundary is also correlated with the direction of movement – a given boundary is more likely to have been recently encountered when moving away from that boundary (<xref ref-type="fig" rid="fig6">Figure 6B</xref>). Thus, boundary-tethered shifts in grid phase are also predicted to resemble modulation by movement direction, analogous to similar modulation observed in place cells (<xref ref-type="bibr" rid="bib36">O'Keefe and Burgess, 1996</xref>). Thus, in this model sampling biases, a product of the particular path of the navigator, play a critical role in mediating the contribution of boundary-tethered shifts to distortions of the time-averaged grid pattern.</p><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.38169.018</object-id><label>Figure 6.</label><caption><title>Sampling biases are correlated with the most recently contacted boundary.</title><p>(<bold>A</bold>) Likelihood of having most recently contacted each border as a function of location in a square environment. Hue indicates the most likely recently contacted boundary; saturation denotes the strength of the bias (white – 25% likelihood of sampling; fully saturated – 100% likelihood of sampling). Data from (<xref ref-type="bibr" rid="bib49">Stensola et al., 2012</xref>). (<bold>B</bold>) Joint probability distribution depicting the relationship between movement direction and the most recently contacted boundary. Data from (<xref ref-type="bibr" rid="bib49">Stensola et al., 2012</xref>).</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-38169-fig6-v2"/></fig></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Our results support two primary conclusions. First, boundary-tethered shifts in grid phase are observed directly in the activity of recorded grid cells during environmental deformations, and contribute to the appearance of rescaling. Second, boundary-tethered shifts in grid phase, scale-dependent rescaling, and local distortions of the time-averaged grid pattern can emerge from border cell-grid cell interactions. Together, these results highlight previously unrecognized dynamics governing the grid code during environmental deformations and implicate border cell-grid cell interactions as a potential source of the dynamics we observe as well as of deformation-induced distortions of the grid pattern. These results further indicate that time-averaged analyses may have overestimated the malleability of the grid cell spatial metric in response to environmental deformations and suggest that scale-dependent grid rescaling may not be a clear indicator of a functional dissociation between modules. Finally, these results demonstrate that the effects of environmental deformations are not fixed over time, but instead depend crucially on the movement history of the navigator.</p><p>Through our simulations, we have demonstrated that simple interactions between border cells and grid cells are sufficient to reproduce boundary-tethered shifts in grid phase. However, a variety of alternative circuits and cues could also give rise to boundary-tethered phase shifts. For example, visual inputs (<xref ref-type="bibr" rid="bib39">Pérez-Escobar et al., 2016</xref>) and reciprocal connections from place to grid cells (<xref ref-type="bibr" rid="bib5">Bonnevie et al., 2013</xref>) both play important roles in developing and maintaining a functional grid code, and may contribute to phase anchoring during deformations (<xref ref-type="bibr" rid="bib47">Sheynikhovich et al., 2009</xref>). Moreover, similar boundary-tethered dynamics can be observed in the place code even before the grid code has fully matured, suggesting that additional mechanisms may contribute to similar dynamics in place cells (<xref ref-type="bibr" rid="bib4">Bjerknes et al., 2018</xref>). Thus, while our results implicate border cell-grid cell interactions as one possible source of the experimentally observed grid phase shifts, additional experiments are required to causally test the particular circuit realization which gives rise to these shifts.</p><p>The dynamic boundary-tethered phase anchoring we observe here may reflect a more general phenomenon of grid phase anchoring to external cues or other internal reference frames (<xref ref-type="bibr" rid="bib14">Fuhs and Touretzky, 2006</xref>; <xref ref-type="bibr" rid="bib13">Evans et al., 2016</xref>). Consistent with this idea, the grid representation is shaped by a number of boundary and non-boundary cues even in geometrically undeformed environments. For example, grid scale differs between novel and familiar environments (<xref ref-type="bibr" rid="bib3">Barry et al., 2012</xref>), the grid pattern is anchored both by spatial geometry and other visual features (<xref ref-type="bibr" rid="bib46">Savelli et al., 2017</xref>; <xref ref-type="bibr" rid="bib26">Krupic et al., 2015</xref>), and the grid pattern distorts near familiar boundaries as well as in asymmetric environments (<xref ref-type="bibr" rid="bib26">Krupic et al., 2015</xref>; <xref ref-type="bibr" rid="bib50">Stensola et al., 2015</xref>). These effects were not captured by the border cell-grid cell interactions as implemented here, and may reflect phase-anchoring to external cues (<xref ref-type="bibr" rid="bib14">Fuhs and Touretzky, 2006</xref>; <xref ref-type="bibr" rid="bib46">Savelli et al., 2017</xref>; <xref ref-type="bibr" rid="bib50">Stensola et al., 2015</xref>) or internal reference frames such as those supported by boundary vector cells (<xref ref-type="bibr" rid="bib8">Bush and Burgess, 2014</xref>; <xref ref-type="bibr" rid="bib25">Krupic et al., 2014</xref>) or place cells (<xref ref-type="bibr" rid="bib13">Evans et al., 2016</xref>; <xref ref-type="bibr" rid="bib8">Bush and Burgess, 2014</xref>).</p><p>Our results do not rule out additional dynamics and mechanisms which may be at play during environmental deformations. Indeed, it is likely that multiple mechanisms contribute to the various properties of deformation-induced grid distortions. For example, it is known that during deformations the distorted grid pattern does not persist indefinitely, but relaxes back to the familiar spatial scale with experience (<xref ref-type="bibr" rid="bib2">Barry et al., 2007</xref>). However, in our simulations, model weights were fixed during deformation trials so that no further learning occurred in this phase. Indeed, the effects we observe can be reproduced by directly imposing boundary-tethered grid shifts without invoking plasticity (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>). Even with continued learning, the model as implemented here may not capture long-term relaxation dynamics because grid phase and border input are likely not in conflict long enough for unlearning to occur. More specifically, when the west boundary is encountered following an east boundary contact during an east-west deformation, the border and grid codes are briefly in conflict when the border representation is first activated, causing a small amount of unlearning. However, this border activation also quickly reinstates the learned grid phase, eliminating the conflict between the two. The learned grid phase is then reinforced for as long as the animal remains close to the west boundary, which will typically be long enough to overwrite whatever unlearning has occurred. Thus, other mechanisms, such as anchoring to additional conflicting reference frames (input from visual cues [<xref ref-type="bibr" rid="bib14">Fuhs and Touretzky, 2006</xref>; <xref ref-type="bibr" rid="bib47">Sheynikhovich et al., 2009</xref>; <xref ref-type="bibr" rid="bib4">Bjerknes et al., 2018</xref>; <xref ref-type="bibr" rid="bib42">Raudies and Hasselmo, 2015</xref>), boundary vector cells (<xref ref-type="bibr" rid="bib1">Barry et al., 2006</xref>; <xref ref-type="bibr" rid="bib51">Stewart et al., 2014</xref>), or place-to-grid feedback (<xref ref-type="bibr" rid="bib8">Bush and Burgess, 2014</xref>]) or changes to speed coding (<xref ref-type="bibr" rid="bib53">Zilli, 2012</xref>), are necessary to explain grid relaxation.</p><p>Previous work has also revealed conspicuous parallels between deformation-induced distortions of grid and place cell representations in the rat brain and the spatial memory of humans in deformed environments (<xref ref-type="bibr" rid="bib36">O'Keefe and Burgess, 1996</xref>; <xref ref-type="bibr" rid="bib22">Hartley et al., 2004</xref>; <xref ref-type="bibr" rid="bib21">Hartley et al., 2000</xref>; <xref ref-type="bibr" rid="bib10">Chen et al., 2015</xref>), leading to the suggestion that a common mechanism might underlie these effects. Consistent with this idea, recent evidence suggests that rescaling can be observed in the time-averaged activity of human grid cells (<xref ref-type="bibr" rid="bib35">Nadasdy et al., 2017</xref>). In light of our results and further simulations of place cell activity (see Materials and methods), we suggest that boundary-tethered grid shift may be a common mechanism contributing to these cross-species effects, and predict that similar boundary-tethered shifts should be observed in human spatial memory during environmental deformations.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Model</title><sec id="s4-1-1"><title>Border layer</title><p>The border layer consisted of 32 units. First, the area near each wall in 4 allocentric directions (North, South, East, West) was divided into 8 ‘bricks’ (see [22] for a similar treatment). Each brick extended 12 cm perpendicular from the wall and covered 12.5% of the total environment length along that dimension. Each unit <inline-formula><mml:math id="inf4"><mml:mi mathvariant="normal">j</mml:mi></mml:math></inline-formula>received a uniform input <inline-formula><mml:math id="inf5"><mml:msub><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:math></inline-formula> whenever the simulated rat was within one of four adjacent bricks, resulting in a firing field covering 50% of the environment perimeter for each unit. This input was converted to stochastic spiking activity (see below).</p></sec><sec id="s4-1-2"><title>Grid layer</title><p>The grid layer, derived from the model of [30], consisted of five grid ‘modules’. Each module consisted of a neural sheet with periodic boundary conditions, visualized as a torus. This neural sheet was composed of 64<sup>2</sup> identical 2 unit x 2 unit tiles (128<sup>2</sup> units per module). Each unit in a tile was associated with a particular direction (North, South, East, West), which determined both the movement-direction-specific excitatory input received, as well as its local connectivity. Movement-direction-specific excitatory input <inline-formula><mml:math id="inf6"><mml:msub><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> to grid unit <inline-formula><mml:math id="inf7"><mml:mi mathvariant="normal">j</mml:mi></mml:math></inline-formula> was determined by<disp-formula id="equ1"><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf8"><mml:mi mathvariant="normal">d</mml:mi></mml:math></inline-formula> is the distance moved since the previous timestep, <inline-formula><mml:math id="inf9"><mml:mi mathvariant="normal">θ</mml:mi></mml:math></inline-formula> is the direction of movement, <inline-formula><mml:math id="inf10"><mml:msub><mml:mrow><mml:mi mathvariant="normal">ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the preferred direction of unit <inline-formula><mml:math id="inf11"><mml:mi mathvariant="normal">j</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf12"><mml:msub><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is a gain factor specific to the module <inline-formula><mml:math id="inf13"><mml:mi mathvariant="normal">m</mml:mi></mml:math></inline-formula> to which to unit <inline-formula><mml:math id="inf14"><mml:mi mathvariant="normal">j</mml:mi></mml:math></inline-formula> belongs, and <inline-formula><mml:math id="inf15"><mml:mi mathvariant="normal">γ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:math></inline-formula> is a constant. Local connections within each module consisted of shifted radial inhibition, in which each unit inhibited all units within a 12 unit radius by a uniform weight of -0.02. The center of this radial inhibition output for each unit was shifted by 2 units away from that unit in a direction consistent with each units preferred direction. In the absence of other inputs, each grid module yields a hexagonal grid-like pattern of activation on the neural sheet, which is translated during movement at a rate proportional to the gain factor. Thus, to model modules with varying grid scales, the gain factor <inline-formula><mml:math id="inf16"><mml:msub><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of module <inline-formula><mml:math id="inf17"><mml:mi mathvariant="normal">m</mml:mi></mml:math></inline-formula>was set by<disp-formula id="equ2"><mml:math id="m2"><mml:msub><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo> <mml:mi mathvariant="normal"/><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:math></disp-formula>where <inline-formula><mml:math id="inf18"><mml:msub><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.45</mml:mn></mml:math></inline-formula> is the gain of the smallest-scale module, module 1. This results in a geometric series of biologically-plausible (<xref ref-type="bibr" rid="bib49">Stensola et al., 2012</xref>) grid scales for each module.</p></sec><sec id="s4-1-3"><title>Place layer</title><p>The place layer consisted of 64 units, subject to uniform recurrent inhibition from all place layer units with a weight of −0.15.</p></sec><sec id="s4-1-4"><title>Border-to-grid connectivity</title><p>All grid units received additional excitatory feed-forward projections from all border units. These connections were initialized with random weights uniformly sampled from the range 0 to 0.025, and developed through experience via Hebbian learning (see below and (<xref ref-type="bibr" rid="bib41">Pollock et al., 2018</xref>)).</p></sec><sec id="s4-1-5"><title>Grid-to-place connectivity</title><p>Each place unit received additional excitatory feed-forward projections from 500 random grid units. These connections were initialized with random weights uniformly sampled from the range 0 to 0.022, and developed through experience via Hebbian learning (see below).</p></sec></sec><sec id="s4-2"><title>Model dynamics</title><sec id="s4-2-1"><title>Activation</title><p>The dynamics of the network was developed following the methods in [30]. The activation <inline-formula><mml:math id="inf19"><mml:msub><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of unit <inline-formula><mml:math id="inf20"><mml:mi mathvariant="normal">j</mml:mi></mml:math></inline-formula> was determined by first computing the total input <inline-formula><mml:math id="inf21"><mml:msub><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> to unit <inline-formula><mml:math id="inf22"><mml:mi mathvariant="normal">j</mml:mi></mml:math></inline-formula> according to<disp-formula id="equ3"><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" displaystyle="false" rowspacing=".2em"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf23"><mml:msub><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is a variable quantifying activation of unit <inline-formula><mml:math id="inf24"><mml:mi mathvariant="normal">i</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf25"><mml:msub><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the weight from unit <inline-formula><mml:math id="inf26"><mml:mi mathvariant="normal">i</mml:mi></mml:math></inline-formula> to unit <inline-formula><mml:math id="inf27"><mml:mi mathvariant="normal">j</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf28"><mml:mi mathvariant="normal">I</mml:mi></mml:math></inline-formula>enumerates all the units. (Note that some weights <inline-formula><mml:math id="inf29"><mml:msub><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> can be zero.) Also recall from above that a border unit receives a constant input when the rat is in a boundary region associated with that unit. The total input <inline-formula><mml:math id="inf30"><mml:msub><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> was used to stochastically determine the spiking <inline-formula><mml:math id="inf31"><mml:msub><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of each unit <inline-formula><mml:math id="inf32"><mml:mi mathvariant="normal">j</mml:mi></mml:math></inline-formula> during the current timestep, according to<disp-formula id="equ4"><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" displaystyle="false" rowspacing=".2em"><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>κ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mo>&gt;</mml:mo><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>κ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mo>≤</mml:mo><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf33"><mml:mi mathvariant="normal">κ</mml:mi></mml:math></inline-formula>= 500 is a scale factor, <inline-formula><mml:math id="inf34"><mml:msub><mml:mrow><mml:mi mathvariant="normal">β</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (border units: <inline-formula><mml:math id="inf35"><mml:msub><mml:mrow><mml:mi mathvariant="normal">β</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> = 0; grid units: <inline-formula><mml:math id="inf36"><mml:msub><mml:mrow><mml:mi mathvariant="normal">β</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> = 0.1; place units:</p><p><inline-formula><mml:math id="inf37"><mml:msub><mml:mrow><mml:mi mathvariant="normal">β</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>= 0.05) is the spike threshold for unit <inline-formula><mml:math id="inf38"><mml:mi mathvariant="normal">j</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf39"><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mo>(</mml:mo><mml:mn>0,1</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula> is a single draw from a random uniform distribution ranging from 0 to 1, and <inline-formula><mml:math id="inf40"><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:math></inline-formula> = 0.003 sec is the length of each timestep. Finally, this spiking activity was integrated to update the activation variable <inline-formula><mml:math id="inf41"><mml:msub><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of unit <inline-formula><mml:math id="inf42"><mml:mi mathvariant="normal">j</mml:mi></mml:math></inline-formula>after each timestep according to<disp-formula id="equ5"><mml:math id="m5"><mml:msub><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo> <mml:mi mathvariant="normal"/><mml:mi mathvariant="normal">α</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula></p><p>Where <inline-formula><mml:math id="inf43"><mml:mi mathvariant="normal">α</mml:mi></mml:math></inline-formula> = 0.5 is a scale factor and <inline-formula><mml:math id="inf44"><mml:mi mathvariant="normal">c</mml:mi></mml:math></inline-formula> = 0.03 sec is the time constant of integration.</p></sec><sec id="s4-2-2"><title>Hebbian learning</title><p>All Hebbian weigh ts were updated by the competitive learning rule<disp-formula id="equ6"><mml:math id="m6"><mml:msub><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo> <mml:mi mathvariant="normal"/><mml:msub><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo> <mml:mi mathvariant="normal"/><mml:mi mathvariant="normal">λ</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">ξ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo> <mml:mi mathvariant="normal"/><mml:msub><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>-</mml:mo> <mml:mi mathvariant="normal"/><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mo>≠</mml:mo><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math></disp-formula>where the sum is only over the set of units with nonzero Hebbian weights to unit <inline-formula><mml:math id="inf45"><mml:mi mathvariant="normal">j</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf46"><mml:mi mathvariant="normal">λ</mml:mi></mml:math></inline-formula> = 0.00001 is the learning rate, <inline-formula><mml:math id="inf47"><mml:msub><mml:mrow><mml:mi mathvariant="normal">ξ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is a constant specific to the connection type (border-to-grid: <inline-formula><mml:math id="inf48"><mml:mi mathvariant="normal">ξ</mml:mi></mml:math></inline-formula> = 0.4; grid-to-place: <inline-formula><mml:math id="inf49"><mml:mi mathvariant="normal">ξ</mml:mi></mml:math></inline-formula> = 0.5) (<xref ref-type="bibr" rid="bib18">Grossberg, 1980</xref>; <xref ref-type="bibr" rid="bib40">Pilly and Grossberg, 2013</xref>). This rule results in competitive activity-dependent weight changes among incoming Hebbian connections, and leads over time to a total weight of <inline-formula><mml:math id="inf50"><mml:msub><mml:mrow><mml:mi mathvariant="normal">ξ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> across incoming synapses.</p></sec></sec><sec id="s4-3"><title>Simulation details</title><sec id="s4-3-1"><title>Generating simulated rat paths</title><p>Because some of the deformed environments that we tested have not been experimentally studied, it was necessary to generate simulated rat paths, rather than using experimentally recorded paths. Open-field paths were generated via a bounded random walk model, parameterized by speed and movement direction. At each timestep, unbiased normally distributed random noise was added to both speed (<inline-formula><mml:math id="inf51"><mml:mi mathvariant="normal">σ</mml:mi></mml:math></inline-formula>= 0.001 cm/msec) and movement direction (<inline-formula><mml:math id="inf52"><mml:mi mathvariant="normal">σ</mml:mi></mml:math></inline-formula>= 1.5 °/ms). To approximate actual rat exploration, speed was bounded to the range [0, 40] cm/s. If a step would result in the rat path crossing a boundary, random noise was again added repeatedly to the movement direction until the next step would no longer cross the boundary. Open field paths always began in the center of the environment, with the simulated rat stationary and facing a random direction. Linear track paths were generated as straight end to end laps at a constant speed of 20 cm/s.</p></sec><sec id="s4-3-2"><title>Familiarization</title><p>In all simulations, familiarization with the environment was mimicked by allowing the naive simulated rat to explore the environment for 60 min. Prior to familiarization, grid layer activity was allowed to settle into its grid-like attractor state for 2 s without learning. Initialization of the grid layer was biased so that an axis of the settled grid network state would lie at an angle of −7.5° relative to east, consistent with experiments (<xref ref-type="bibr" rid="bib26">Krupic et al., 2015</xref>; <xref ref-type="bibr" rid="bib50">Stensola et al., 2015</xref>). Following familiarization, the model weights were saved so that all post-familiarization simulations could begin with the familiarized model.</p></sec><sec id="s4-3-3"><title>Post-familiarization testing simulations</title><p>The model weights were reset to the state saved after familiarization, and the experienced virtual rat was allowed to explore each tested environment for 30 min. Grid layer activity was also initially reset to the familiar environment state corresponding to the rat's start location. Learning was turned off during the testing phase.</p></sec></sec><sec id="s4-4"><title>Analysis</title><sec id="s4-4-1"><title>Statistical tests</title><p>All statistical tests are two-tailed unless otherwise noted. All error bars denote mean ±1 standard error of the mean unless otherwise noted.</p></sec><sec id="s4-4-2"><title>Reanalysis of experimental data</title><p>A complete description of the experiments was provided in (<xref ref-type="bibr" rid="bib2">Barry et al., 2007</xref>; <xref ref-type="bibr" rid="bib49">Stensola et al., 2012</xref>). Data from <xref ref-type="bibr" rid="bib2">Barry et al., 2007</xref>) included an initial set of 66 putative cells, from which 38 cells meeting various criteria were selected as grid cells for analysis in the original publication. Similarly, we included only cells with average gridness across both familiar trials &gt; 0.4 from this dataset, yielding 36 included grid cells. Note that unlike in <xref ref-type="bibr" rid="bib2">Barry et al., 2007</xref>) we did not exclude cells which were poorly fit by rescaling during deformation trials, as boundary-tethered phase shifts predict that distortions which do not resemble a rescaling may occur. For alignment, rescaling, and rate map prediction analyses, the first familiar trial rate map were used for comparison; in the few cases where no rate map was recorded during the first familiar trial, the rate map from the second familiar trial was used instead.</p></sec><sec id="s4-4-3"><title>Unit sampling</title><p>Due to computational constraints and the redundant nature of grid unit activity, only the spikes from 30 randomly chosen grid units in each module were recorded and analyzed during all simulations. All place units were recorded and analyzed.</p></sec><sec id="s4-4-4"><title>Rate maps</title><p>Rate maps were created by first dividing the environment into 2.5 cm x 2.5 cm pixels. Then the mean firing rate within each pixel was calculated. Finally, this map was smoothed with an isotropic Gaussian kernel with a standard deviation of 1.5 pixels (3.75 cm) and square extent of 9 pixels x 9 pixels (22.5 cm x 22.5 cm). Pixels which were never visited were excluded during further analyses, with the exception of rate map prediction: all pixels were included during rate map prediction as even few missing pixels lead to large gaps of missing pixels following rescaling.</p></sec><sec id="s4-4-5"><title>Autocorrelations and cross-correlations</title><p>Autocorrelations of rate maps were computed similar to previous reports (<xref ref-type="bibr" rid="bib44">Sargolini et al., 2006</xref>). Briefly, the correlation <inline-formula><mml:math id="inf53"><mml:mi mathvariant="normal">r</mml:mi></mml:math></inline-formula>between overlapping pixels of the original rate map and a shifted version of itself was computed as <inline-formula><mml:math id="inf54"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">J</mml:mi></mml:mrow></mml:mrow></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mo>−</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover><mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:mrow><mml:mo>−</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msqrt><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">J</mml:mi></mml:mrow></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mo>−</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt><mml:msqrt><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">J</mml:mi></mml:mrow></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover><mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:mrow><mml:mo>−</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>where f is the rescaled rate map, <inline-formula><mml:math id="inf55"><mml:mi mathvariant="normal">f</mml:mi></mml:math></inline-formula> is the familiar rate map, i and <inline-formula><mml:math id="inf56"><mml:mi mathvariant="normal">i</mml:mi></mml:math></inline-formula> run over pixels in the overlapping regions of these maps, and <inline-formula><mml:math id="inf57"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mo>−</mml:mo></mml:mover></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf58"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:mover></mml:math></inline-formula> indicate the mean firing rate across overlapping pixels, at a series of single pixel (2.5 cm) step lags. Cross-correlations were computed similarly, except that two different rate maps were correlated, rather than two copies of the same rate map. Autocorrelations and cross-correlations were only estimated for spatial lags with at least 20 overlapping pixels.</p></sec><sec id="s4-4-6"><title>Grid scale</title><p>To compute grid scale for a unit or cell we first computed the rate map autocorrelation. Next, we computed the mean distance from the center of the autocorrelation to the center of mass of the six closest surrounding peaks, excluding the central peak.</p></sec><sec id="s4-4-7"><title>Gridness</title><p>To compute gridness for each unit, we first computed the autocorrelation of its rate map and its grid scale. Next we masked the autocorrelation, eliminating all pixels at a distance from the center greater than 1.5 its scale and less than 0.5 its scale. We then computed the correlation between the masked autocorrelation and a rotated version of itself, rotated 30°, 60°, 90°, 120°, and 150°. The final measure of gridness was then the difference between the minimum of the [60° 120°] correlations minus the maximum of the [30° 90° 150°] correlations.</p></sec><sec id="s4-4-8"><title>Field length</title><p>Field length along each dimension was estimated from the autocorrelation by first determining the extent of the central peak of the autocorrelation, defined as all contiguous pixels with correlation values greater than 10% of the maximum correlation. Next, field length was computed separately for each dimension as the distance between the most extreme pixels within this central peak along that dimension.</p></sec><sec id="s4-4-9"><title>Grid rescaling factor</title><p>The grid rescaling factor during each deformation trial was computed separately for each unit by comparing rescaled versions of the familiar environment rate map to the deformed environment rate map. Following (<xref ref-type="bibr" rid="bib49">Stensola et al., 2012</xref>), the familiar rate map was uniformly rescaled to a series of chamber lengths, ranging from 10 cm below the smaller of the deformed and familiar chamber lengths, through 10 cm above the larger of these chamber lengths in 5 cm (2 pixel) increments. This yielded a set of rescaled familiar rate maps for each unit. For each rescaled map, we computed the correlation <inline-formula><mml:math id="inf59"><mml:mi mathvariant="normal">r</mml:mi></mml:math></inline-formula> (defined above) between the deformed and rescaled rate maps twice, once when the two rate maps were aligned by each opposing boundary. The grid rescaling factor was then defined as the ratio between the rescaled chamber length that yielded the highest correlation and the familiar chamber length, across either alignment.</p><p>When comparing rescaling factors between whole-trial and boundary-conditioned data, rescaling was only computed for alignment by the conditioned boundary. In order to ensure that differences in rescaling following boundary-conditioning were not due to differential sampling following contact with opposing boundaries, whole-trial rate maps were created from random subsets of the data, with the number of samples at each pixel chosen to match the sampling distribution of the to-be-compared boundary rate map. Because subsampling the data to match these sampling distributions introduces variability in the measure of rescaling, we repeated this measure 100 times for each cell with different random subsets of the data and took the mean rescaling across these iterations as our final measure.</p></sec><sec id="s4-4-10"><title>Grid shift analysis</title><p>To test these data for the presence of grid shifts during environmental deformations, we first divided the spiking activity of each cell according to the most recent boundary contact (North, South, East, or West). Boundary contact was defined as the rat being within 12 cm of a boundary. Spiking activity prior to boundary contact at the beginning of the trial was ignored. Next, four separate rate maps were created, one for each most recently contacted boundary. To quantify grid shift along a particular dimension for each cell, the rate maps of opposing boundaries perpendicular to the chosen dimension were cross-correlated at a series of lags in single pixel steps (see above) within the range of plus/minus one half the scale of the grid pattern. In order to ensure that shifts in phase were not due to differential sampling following contact with opposing boundaries, boundary rate maps were created from random subsets of the data, with the number of samples at each pixel chosen to match the sampling distributions of the opposing boundary rate maps. The distance from the center to the nearest peak of this cross-correlogram along the dimension of interest was then determined, with the nearest peak defined by first partitioning the cross-correlogram into ‘blobs’ of contiguous pixels which had positive correlations. Then, the location with the maximum correlation value within the blob nearest to the center was taken as the nearest peak. Because subsampling the data to match the sampling distributions introduces variability in this measure of shift, we repeated this measure 100 times for each cell with different random subsets of the data and took the mean shift across these iterations as our final measure of shift. Because shift is bounded by grid scale, we report shift as a ratio of shift to scale.</p></sec><sec id="s4-4-11"><title>Boundary-tethered rate map prediction</title><p> For each cell and deformation trial we first created predicted boundary rate maps for displaced boundaries from the familiar environment rate map. These rate maps were shifted versions of the familiar rate map, aligned by the corresponding boundary (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). If the length of a boundary changed, then the central portion of the familiar rate map was used to generate the predicted boundary rate map. Next, sampling biases were applied as follows. First, a map of the actual sampling behavior following each boundary contact during the deformation trial was computed, as described in the ‘rate maps’ section above. From these maps, the probability of having most recently contacted each boundary was computed at each pixel. The contribution from each boundary rate map was then weighted by this probability. The final rate map predicted by the boundary-tethered model was then the sum of these weighted boundary rate maps, smoothed with the Gaussian kernel described in the ‘Rate maps’ section above.</p></sec><sec id="s4-4-12"><title>Data and code availability</title><p>All simulations were conducted with custom-written MATLAB scripts. These scripts as well as the simulation results presented here are available on Github at <ext-link ext-link-type="uri" xlink:href="https://github.com/akeinath/Keinath_BoundaryTetheredModel">https://github.com/akeinath/Keinath_BoundaryTetheredModel</ext-link> (<xref ref-type="bibr" rid="bib24">Keinath, 2018</xref>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/Keinath_BoundaryTetheredModel">https://github.com/elifesciences-publications/Keinath_BoundaryTetheredModel</ext-link>). All values generated by our reanalysis are available as source data files. All original reanalyzed data were originally reported in the following papers:</p><list list-type="bullet"><list-item><p><xref ref-type="bibr" rid="bib2">Barry et al., 2007</xref>. <italic>Experience-dependent rescaling of entorhinal grids.</italic> <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn1905">https://doi.org/10.1038/nn1905</ext-link></p> </list-item><list-item><p><xref ref-type="bibr" rid="bib49">Stensola et al., 2012</xref>. <italic>The entorhinal map is descritized</italic>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature11649">https://doi.org/10.1038/nature11649</ext-link></p> <p>These data are available upon request from the corresponding authors of these papers.</p></list-item></list></sec></sec><sec id="s4-5"><title>Simulations of place units</title><p>Environmental deformations also induce distortions of place cell activity which may reflect a contribution of dynamically-shifting grid input. To test this possibility, we concurrently simulated a population of place units receiving input from grid units during a variety of deformations.</p><p>Electrophysiological experiments have shown that stretching a familiar environment induces a heterogeneous mix of responses in the time-averaged activity of place cells (<xref ref-type="bibr" rid="bib36">O'Keefe and Burgess, 1996</xref>). To explore the effects of stretching deformations on model place units, we began by familiarizing the naive virtual rat with a 61 cm×61 cm square open environment, during which period the border-grid connectivity and grid-place connectivity self-organized via Hebbian learning. Following this familiarization, the virtual rat again explored the familiar environment, as well as a number of deformed environments without new learning (various chamber lengths between 61 cm and 122 cm, chamber widths 61 cm or 122 cm; chamber sizes chosen to match experiment (<xref ref-type="bibr" rid="bib36">O'Keefe and Burgess, 1996</xref>)). During these deformations, we observed heterogeneous changes in the time-averaged rate maps of place units (<xref ref-type="fig" rid="fig7">Figure 7A</xref>). A number of place units exhibited place field stretching in proportion to the rescaling deformation. Other units exhibited place field bifurcations accompanied by progressively lower peak firing rates during more extreme deformations. Finally, some units exhibited emergent modulation by movement direction, with place fields shifting ‘upstream’ of the movement direction. A qualitatively similar mix of place field distortions is observed experimentally (<xref ref-type="bibr" rid="bib36">O'Keefe and Burgess, 1996</xref>).</p><fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.38169.019</object-id><label>Figure 7.</label><caption><title>Place units learned from grid unit inputs reproduce heterogeneous place field distortions.</title><p>(<bold>A</bold>) Place unit rate maps when a familiar open environment is stretched. Place fields exhibit stretching, bifurcation, and emergent modulation by movement direction (indicated by white arrows). Colors normalized to the peak for each rate map. Peak firing rate noted below the lower left corner of each map. Note that peak firing rate tends to decrease with more extreme deformations for cells with place fields further from boundaries. (<bold>B</bold>) Place unit activity for all 64 place units during compressions of a familiar linear track, separated by (top) eastward and (bottom) westward laps. Each line indicates the firing rate of a single place unit at each location across the entire track during movement in the specified direction, normalized to the familiar track peak rate. Units sorted by place field location on the familiar track. Note that, during compressions, the place code unfolds as if anchored to the beginning of the track until the end of the track is encountered, at which point the familiar end-of-track place units are reactivated. (<bold>C</bold>) Place unit rate maps demonstrating a mix of place field (left) duplication, (middle) inhibition, and (right) perseverance when a new boundary (white line) is inserted in a familiar open environment. Colors normalized to the maximum of both rate maps. Peak firing rate noted below the lower left corner of each map.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-38169-fig7-v2"/></fig><p>Electrophysiological experiments have also demonstrated that when a familiar linear track is compressed, the place code is updated when track ends are encountered (<xref ref-type="bibr" rid="bib16">Gothard et al., 1996</xref>; <xref ref-type="bibr" rid="bib17">Gothard et al., 2001</xref>). We therefore examined the effects of compressing a familiar linear track on model place units. We first familiarized the naive virtual rat with running laps on a 161 cm long linear track, during which period the border-grid connectivity and grid-place connectivity self-organized via Hebbian learning. Border units were active only within 12 cm of each track end. Following this familiarization, the virtual rat ran laps along both the familiar track and a number of compressed tracks without new learning (track lengths between 53 cm to 161 cm; lengths chosen to match experiment (<xref ref-type="bibr" rid="bib16">Gothard et al., 1996</xref>)). During laps on compressed tracks, place unit activity unfolded as if unaffected by the compression, no matter how extreme, until the opposing track end was reached. Once encountered, the place code previously active at this track end during familiarization reemerged (<xref ref-type="fig" rid="fig7">Figure 7B</xref>), as observed experimentally (<xref ref-type="bibr" rid="bib16">Gothard et al., 1996</xref>). In recording experiments, similar boundary-tethered updating persists in darkness indicating that such dynamics arise even in the absence of visual cues (<xref ref-type="bibr" rid="bib17">Gothard et al., 2001</xref>), a result consistent with the sustained activity of border cells in darkness (<xref ref-type="bibr" rid="bib39">Pérez-Escobar et al., 2016</xref>; <xref ref-type="bibr" rid="bib11">Chen et al., 2016</xref>). However, we note that in these recording experiments the particular transition point differs depending on the availability of visual input and may precede border cell firing, which likely reflects the influence of additional mechanisms outside the scope of our boundary-tethered model (<xref ref-type="bibr" rid="bib47">Sheynikhovich et al., 2009</xref>; <xref ref-type="bibr" rid="bib43">Raudies et al., 2016</xref>).</p><p>Finally, electrophysiological experiments have shown that when a boundary is inserted in a familiar open environment, place fields exhibit a mix of duplication, suppression, and perseverance (<xref ref-type="bibr" rid="bib1">Barry et al., 2006</xref>; <xref ref-type="bibr" rid="bib34">Muller and Kubie, 1987</xref>; <xref ref-type="bibr" rid="bib29">Lever et al., 2002</xref>). We explored the effects of inserting a new boundary on model place units. We first familiarized the naive virtual rat with a 65 cm×65 cm square open environment, during which period the border-grid connectivity and grid-place connectivity self-organized via Hebbian learning. Following this familiarization, the rat explored, without new learning, the familiar environment and a deformed version of this environment containing an additional 40 cm long boundary adjacent to one wall and evenly dividing the space (chosen to match experiment (<xref ref-type="bibr" rid="bib1">Barry et al., 2006</xref>)). Again, we observed heterogeneous changes in the time-averaged rate maps of place units (<xref ref-type="fig" rid="fig7">Figure 7C</xref>). Some units exhibited place field duplication during boundary insertion, while other units exhibited place field inhibition. Still others persevered largely unaffected. A qualitatively similar mix of responses is observed experimentally during boundary insertions (<xref ref-type="bibr" rid="bib1">Barry et al., 2006</xref>; <xref ref-type="bibr" rid="bib34">Muller and Kubie, 1987</xref>; <xref ref-type="bibr" rid="bib29">Lever et al., 2002</xref>). Together, these results demonstrate that many of the heterogeneous place cell behaviors observed across environmental deformations could arise from boundary-tethered shifts in grid code input.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We are grateful to the laboratories of Edvard and May-Britt Moser, Kate Jeffery and Dori Derdikman for making the data from (<xref ref-type="bibr" rid="bib49">Stensola et al., 2012</xref>) and (<xref ref-type="bibr" rid="bib2">Barry et al., 2007</xref>) available for our reanalysis. We also thank Eli Pollock, Niral Desai and Xuexin Wei for advice on implementing spiking border-grid connections. Finally, we gratefully acknowledge support from NSF grant PHY-1734030 (VB), NIH grants EY022350 and EY027047 (RAE), and NSF IGERT grant 0966142 (ATK). VB was also partially supported by the Honda Research Institute Curious-Minded Machines program. VB thanks the Aspen Center for Physics (Aspen, Colorado; NSF grant PHY-1607611) and the International Center for Theoretical Physics (Trieste, Italy) for support and hospitality while this paper was being completed.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con2"><p>Resources, Supervision, Funding acquisition, Methodology, Writing—review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Resources, Formal analysis, Supervision, Funding acquisition, Methodology, Project administration, Writing—review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><object-id pub-id-type="doi">10.7554/eLife.38169.020</object-id><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-38169-transrepform-v2.pdf"/></supplementary-material><p>All simulations were conducted with custom-written MATLAB scripts. These scripts as well as the simulation results presented here are available on Github at: <ext-link ext-link-type="uri" xlink:href="https://github.com/akeinath/Keinath_BoundaryTetheredModel">https://github.com/akeinath/Keinath_BoundaryTetheredModel</ext-link> (copy archived at: <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/Keinath_BoundaryTetheredModel">https://github.com/elifesciences-publications/Keinath_BoundaryTetheredModel</ext-link>). All values generated during our reanalysis are included as source data files. All original reanalyzed data were originally reported in the following papers: 1) Barry et al., 2007. Experience-dependent rescaling of entorhinal grids. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn1905">https://doi.org/10.1038/nn1905</ext-link>; 2) Stensola et al., 2012. The entorhinal map is descritized. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature11649">https://doi.org/10.1038/nature11649</ext-link>. These data are available upon request from the corresponding authors of these papers.</p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barry</surname> <given-names>C</given-names></name><name><surname>Lever</surname> <given-names>C</given-names></name><name><surname>Hayman</surname> <given-names>R</given-names></name><name><surname>Hartley</surname> <given-names>T</given-names></name><name><surname>Burton</surname> <given-names>S</given-names></name><name><surname>O'Keefe</surname> <given-names>J</given-names></name><name><surname>Jeffery</surname> <given-names>K</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>The boundary vector cell model of place cell firing and spatial memory</article-title><source>Reviews in the Neurosciences</source><volume>17</volume><fpage>71</fpage><lpage>97</lpage><pub-id pub-id-type="doi">10.1515/REVNEURO.2006.17.1-2.71</pub-id><pub-id pub-id-type="pmid">16703944</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barry</surname> <given-names>C</given-names></name><name><surname>Hayman</surname> <given-names>R</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name><name><surname>Jeffery</surname> <given-names>KJ</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Experience-dependent rescaling of entorhinal grids</article-title><source>Nature Neuroscience</source><volume>10</volume><fpage>682</fpage><lpage>684</lpage><pub-id pub-id-type="doi">10.1038/nn1905</pub-id><pub-id pub-id-type="pmid">17486102</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barry</surname> <given-names>C</given-names></name><name><surname>Ginzberg</surname> <given-names>LL</given-names></name><name><surname>O'Keefe</surname> <given-names>J</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Grid cell firing patterns signal environmental novelty by expansion</article-title><source>PNAS</source><volume>109</volume><fpage>17687</fpage><lpage>17692</lpage><pub-id pub-id-type="doi">10.1073/pnas.1209918109</pub-id><pub-id pub-id-type="pmid">23045662</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bjerknes</surname> <given-names>TL</given-names></name><name><surname>Dagslott</surname> <given-names>NC</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Path integration in place cells of developing rats</article-title><source>PNAS</source><volume>115</volume><fpage>E1637</fpage><lpage>E1646</lpage><pub-id pub-id-type="doi">10.1073/pnas.1719054115</pub-id><pub-id pub-id-type="pmid">29382754</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bonnevie</surname> <given-names>T</given-names></name><name><surname>Dunn</surname> <given-names>B</given-names></name><name><surname>Fyhn</surname> <given-names>M</given-names></name><name><surname>Hafting</surname> <given-names>T</given-names></name><name><surname>Derdikman</surname> <given-names>D</given-names></name><name><surname>Kubie</surname> <given-names>JL</given-names></name><name><surname>Roudi</surname> <given-names>Y</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Grid cells require excitatory drive from the hippocampus</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>309</fpage><lpage>317</lpage><pub-id pub-id-type="doi">10.1038/nn.3311</pub-id><pub-id pub-id-type="pmid">23334581</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burak</surname> <given-names>Y</given-names></name><name><surname>Fiete</surname> <given-names>IR</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Accurate path integration in continuous attractor network models of grid cells</article-title><source>PLoS Computational Biology</source><volume>5</volume><elocation-id>e1000291</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000291</pub-id><pub-id pub-id-type="pmid">19229307</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bush</surname> <given-names>D</given-names></name><name><surname>Barry</surname> <given-names>C</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>What do grid cells contribute to place cell firing?</article-title><source>Trends in Neurosciences</source><volume>37</volume><fpage>136</fpage><lpage>145</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2013.12.003</pub-id><pub-id pub-id-type="pmid">24485517</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bush</surname> <given-names>D</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A hybrid oscillatory interference/continuous attractor network model of grid cell firing</article-title><source>Journal of Neuroscience</source><volume>34</volume><fpage>5065</fpage><lpage>5079</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4017-13.2014</pub-id><pub-id pub-id-type="pmid">24695724</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buzsáki</surname> <given-names>G</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Memory, navigation and theta rhythm in the hippocampal-entorhinal system</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>130</fpage><lpage>138</lpage><pub-id pub-id-type="doi">10.1038/nn.3304</pub-id><pub-id pub-id-type="pmid">23354386</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname> <given-names>X</given-names></name><name><surname>He</surname> <given-names>Q</given-names></name><name><surname>Kelly</surname> <given-names>JW</given-names></name><name><surname>Fiete</surname> <given-names>IR</given-names></name><name><surname>McNamara</surname> <given-names>TP</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Bias in Human Path Integration Is Predicted by Properties of Grid Cells</article-title><source>Current Biology</source><volume>25</volume><fpage>1771</fpage><lpage>1776</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2015.05.031</pub-id><pub-id pub-id-type="pmid">26073138</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname> <given-names>G</given-names></name><name><surname>Manson</surname> <given-names>D</given-names></name><name><surname>Cacucci</surname> <given-names>F</given-names></name><name><surname>Wills</surname> <given-names>TJ</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Absence of visual input results in the disruption of grid cell firing in the mouse</article-title><source>Current Biology</source><volume>26</volume><fpage>2335</fpage><lpage>2342</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2016.06.043</pub-id><pub-id pub-id-type="pmid">27498565</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cheung</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Estimating location without external cues</article-title><source>PLoS Computational Biology</source><volume>10</volume><elocation-id>e1003927</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003927</pub-id><pub-id pub-id-type="pmid">25356642</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Evans</surname> <given-names>T</given-names></name><name><surname>Bicanski</surname> <given-names>A</given-names></name><name><surname>Bush</surname> <given-names>D</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>How environment and self-motion combine in neural representations of space</article-title><source>The Journal of Physiology</source><volume>594</volume><fpage>6535</fpage><lpage>6546</lpage><pub-id pub-id-type="doi">10.1113/JP270666</pub-id><pub-id pub-id-type="pmid">26607203</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fuhs</surname> <given-names>MC</given-names></name><name><surname>Touretzky</surname> <given-names>DS</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>A spin glass model of path integration in rat medial entorhinal cortex</article-title><source>Journal of Neuroscience</source><volume>26</volume><fpage>4266</fpage><lpage>4276</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4353-05.2006</pub-id><pub-id pub-id-type="pmid">16624947</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Giocomo</surname> <given-names>LM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Environmental boundaries as a mechanism for correcting and anchoring spatial maps</article-title><source>The Journal of Physiology</source><volume>594</volume><fpage>6501</fpage><lpage>6511</lpage><pub-id pub-id-type="doi">10.1113/JP270624</pub-id><pub-id pub-id-type="pmid">26563618</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gothard</surname> <given-names>KM</given-names></name><name><surname>Skaggs</surname> <given-names>WE</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Dynamics of mismatch correction in the hippocampal ensemble code for space: interaction between path integration and environmental cues</article-title><source>The Journal of Neuroscience</source><volume>16</volume><fpage>8027</fpage><lpage>8040</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.16-24-08027.1996</pub-id><pub-id pub-id-type="pmid">8987829</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gothard</surname> <given-names>KM</given-names></name><name><surname>Hoffman</surname> <given-names>KL</given-names></name><name><surname>Battaglia</surname> <given-names>FP</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Dentate gyrus and ca1 ensemble activity during spatial reference frame shifts in the presence and absence of visual input</article-title><source>The Journal of Neuroscience</source><volume>21</volume><fpage>7284</fpage><lpage>7292</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.21-18-07284.2001</pub-id><pub-id pub-id-type="pmid">11549738</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grossberg</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="1980">1980</year><article-title>How does a brain build a cognitive code?</article-title><source>Psychological Review</source><volume>87</volume><fpage>1</fpage><lpage>51</lpage><pub-id pub-id-type="doi">10.1037/0033-295X.87.1.1</pub-id><pub-id pub-id-type="pmid">7375607</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hafting</surname> <given-names>T</given-names></name><name><surname>Fyhn</surname> <given-names>M</given-names></name><name><surname>Molden</surname> <given-names>S</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Microstructure of a spatial map in the entorhinal cortex</article-title><source>Nature</source><volume>436</volume><fpage>801</fpage><lpage>806</lpage><pub-id pub-id-type="doi">10.1038/nature03721</pub-id><pub-id pub-id-type="pmid">15965463</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hardcastle</surname> <given-names>K</given-names></name><name><surname>Ganguli</surname> <given-names>S</given-names></name><name><surname>Giocomo</surname> <given-names>LM</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Environmental boundaries as an error correction mechanism for grid cells</article-title><source>Neuron</source><volume>86</volume><fpage>827</fpage><lpage>839</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2015.03.039</pub-id><pub-id pub-id-type="pmid">25892299</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hartley</surname> <given-names>T</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name><name><surname>Lever</surname> <given-names>C</given-names></name><name><surname>Cacucci</surname> <given-names>F</given-names></name><name><surname>O'Keefe</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Modeling place fields in terms of the cortical inputs to the Hippocampus</article-title><source>Hippocampus</source><volume>10</volume><fpage>369</fpage><lpage>379</lpage><pub-id pub-id-type="doi">10.1002/1098-1063(2000)10:4&lt;369::AID-HIPO3&gt;3.0.CO;2-0</pub-id><pub-id pub-id-type="pmid">10985276</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hartley</surname> <given-names>T</given-names></name><name><surname>Trinkler</surname> <given-names>I</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Geometric determinants of human spatial memory</article-title><source>Cognition</source><volume>94</volume><fpage>39</fpage><lpage>75</lpage><pub-id pub-id-type="doi">10.1016/j.cognition.2003.12.001</pub-id><pub-id pub-id-type="pmid">15302327</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ismakov</surname> <given-names>R</given-names></name><name><surname>Barak</surname> <given-names>O</given-names></name><name><surname>Jeffery</surname> <given-names>K</given-names></name><name><surname>Derdikman</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Grid cells encode local positional information</article-title><source>Current Biology</source><volume>27</volume><fpage>2337</fpage><lpage>2343</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2017.06.034</pub-id><pub-id pub-id-type="pmid">28756950</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Keinath</surname> <given-names>AT</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title><italic>Keinath_BoundaryTetheredModel.</italic></data-title><source>Github</source></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krupic</surname> <given-names>J</given-names></name><name><surname>Bauza</surname> <given-names>M</given-names></name><name><surname>Burton</surname> <given-names>S</given-names></name><name><surname>Lever</surname> <given-names>C</given-names></name><name><surname>O'Keefe</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>How environment geometry affects grid cell symmetry and what we can learn from it</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>369</volume><elocation-id>20130188</elocation-id><pub-id pub-id-type="doi">10.1098/rstb.2013.0188</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krupic</surname> <given-names>J</given-names></name><name><surname>Bauza</surname> <given-names>M</given-names></name><name><surname>Burton</surname> <given-names>S</given-names></name><name><surname>Barry</surname> <given-names>C</given-names></name><name><surname>O'Keefe</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Grid cell symmetry is shaped by environmental geometry</article-title><source>Nature</source><volume>518</volume><fpage>232</fpage><lpage>235</lpage><pub-id pub-id-type="doi">10.1038/nature14153</pub-id><pub-id pub-id-type="pmid">25673417</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krupic</surname> <given-names>J</given-names></name><name><surname>Bauza</surname> <given-names>M</given-names></name><name><surname>Burton</surname> <given-names>S</given-names></name><name><surname>O'Keefe</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Framing the grid: effect of boundaries on grid cells and navigation</article-title><source>The Journal of Physiology</source><volume>594</volume><fpage>6489</fpage><lpage>6499</lpage><pub-id pub-id-type="doi">10.1113/JP270607</pub-id><pub-id pub-id-type="pmid">26969452</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krupic</surname> <given-names>J</given-names></name><name><surname>Bauza</surname> <given-names>M</given-names></name><name><surname>Burton</surname> <given-names>S</given-names></name><name><surname>O'Keefe</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Local transformations of the hippocampal cognitive map</article-title><source>Science</source><volume>359</volume><fpage>1143</fpage><lpage>1146</lpage><pub-id pub-id-type="doi">10.1126/science.aao4960</pub-id><pub-id pub-id-type="pmid">29590044</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lever</surname> <given-names>C</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name><name><surname>Cacucci</surname> <given-names>F</given-names></name><name><surname>Hartley</surname> <given-names>T</given-names></name><name><surname>O'Keefe</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>What can the hippocampal representation of environmental geometry tell us about hebbian learning?</article-title><source>Biological Cybernetics</source><volume>87</volume><fpage>356</fpage><lpage>372</lpage><pub-id pub-id-type="doi">10.1007/s00422-002-0360-z</pub-id><pub-id pub-id-type="pmid">12461626</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mathis</surname> <given-names>A</given-names></name><name><surname>Herz</surname> <given-names>AV</given-names></name><name><surname>Stemmler</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Optimal population codes for space: grid cells outperform place cells</article-title><source>Neural Computation</source><volume>24</volume><fpage>2280</fpage><lpage>2317</lpage><pub-id pub-id-type="doi">10.1162/NECO_a_00319</pub-id><pub-id pub-id-type="pmid">22594833</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McNaughton</surname> <given-names>BL</given-names></name><name><surname>Battaglia</surname> <given-names>FP</given-names></name><name><surname>Jensen</surname> <given-names>O</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Path integration and the neural basis of the 'cognitive map'</article-title><source>Nature Reviews Neuroscience</source><volume>7</volume><fpage>663</fpage><lpage>678</lpage><pub-id pub-id-type="doi">10.1038/nrn1932</pub-id><pub-id pub-id-type="pmid">16858394</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moser</surname> <given-names>EI</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>A metric for space</article-title><source>Hippocampus</source><volume>18</volume><fpage>1142</fpage><lpage>1156</lpage><pub-id pub-id-type="doi">10.1002/hipo.20483</pub-id><pub-id pub-id-type="pmid">19021254</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moser</surname> <given-names>EI</given-names></name><name><surname>Roudi</surname> <given-names>Y</given-names></name><name><surname>Witter</surname> <given-names>MP</given-names></name><name><surname>Kentros</surname> <given-names>C</given-names></name><name><surname>Bonhoeffer</surname> <given-names>T</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Grid cells and cortical representation</article-title><source>Nature Reviews Neuroscience</source><volume>15</volume><fpage>466</fpage><lpage>481</lpage><pub-id pub-id-type="doi">10.1038/nrn3766</pub-id><pub-id pub-id-type="pmid">24917300</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muller</surname> <given-names>RU</given-names></name><name><surname>Kubie</surname> <given-names>JL</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>The effects of changes in the environment on the spatial firing of hippocampal complex-spike cells</article-title><source>The Journal of Neuroscience</source><volume>7</volume><fpage>1951</fpage><lpage>1968</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.07-07-01951.1987</pub-id><pub-id pub-id-type="pmid">3612226</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nadasdy</surname> <given-names>Z</given-names></name><name><surname>Nguyen</surname> <given-names>TP</given-names></name><name><surname>Török</surname> <given-names>Á</given-names></name><name><surname>Shen</surname> <given-names>JY</given-names></name><name><surname>Briggs</surname> <given-names>DE</given-names></name><name><surname>Modur</surname> <given-names>PN</given-names></name><name><surname>Buchanan</surname> <given-names>RJ</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Context-dependent spatially periodic activity in the human entorhinal cortex</article-title><source>PNAS</source><volume>114</volume><fpage>E3516</fpage><lpage>E3525</lpage><pub-id pub-id-type="doi">10.1073/pnas.1701352114</pub-id><pub-id pub-id-type="pmid">28396399</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Keefe</surname> <given-names>J</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Geometric determinants of the place fields of hippocampal neurons</article-title><source>Nature</source><volume>381</volume><fpage>425</fpage><lpage>428</lpage><pub-id pub-id-type="doi">10.1038/381425a0</pub-id><pub-id pub-id-type="pmid">8632799</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Keefe</surname> <given-names>J</given-names></name><name><surname>Dostrovsky</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1971">1971</year><article-title>The Hippocampus as a spatial map. preliminary evidence from unit activity in the freely-moving rat</article-title><source>Brain Research</source><volume>34</volume><fpage>171</fpage><lpage>175</lpage><pub-id pub-id-type="doi">10.1016/0006-8993(71)90358-1</pub-id><pub-id pub-id-type="pmid">5124915</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>O'Keefe</surname> <given-names>J</given-names></name><name><surname>Nadel</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="1978">1978</year><source>The Hippocampus as a Cognitive Map</source><publisher-name>Oxford University Press</publisher-name></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pérez-Escobar</surname> <given-names>JA</given-names></name><name><surname>Kornienko</surname> <given-names>O</given-names></name><name><surname>Latuske</surname> <given-names>P</given-names></name><name><surname>Kohler</surname> <given-names>L</given-names></name><name><surname>Allen</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Visual landmarks sharpen grid cell metric and confer context specificity to neurons of the medial entorhinal cortex</article-title><source>eLife</source><volume>5</volume><elocation-id>e16937</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.16937</pub-id><pub-id pub-id-type="pmid">27449281</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pilly</surname> <given-names>PK</given-names></name><name><surname>Grossberg</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Spiking neurons in a hierarchical self-organizing map model can learn to develop spatial and temporal properties of entorhinal grid cells and hippocampal place cells</article-title><source>PLoS One</source><volume>8</volume><elocation-id>e60599</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0060599</pub-id><pub-id pub-id-type="pmid">23577130</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pollock</surname> <given-names>E</given-names></name><name><surname>Desai</surname> <given-names>N</given-names></name><name><surname>Wei</surname> <given-names>X-X</given-names></name><name><surname>Balasubramanian</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Dynamic self-organized error-correction of grid cells by border cells</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/385229</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raudies</surname> <given-names>F</given-names></name><name><surname>Hasselmo</surname> <given-names>ME</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Differences in Visual-Spatial input may underlie different compression properties of firing fields for grid cell modules in medial entorhinal cortex</article-title><source>PLoS Computational Biology</source><volume>11</volume><elocation-id>e1004596</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004596</pub-id><pub-id pub-id-type="pmid">26584432</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raudies</surname> <given-names>F</given-names></name><name><surname>Hinman</surname> <given-names>JR</given-names></name><name><surname>Hasselmo</surname> <given-names>ME</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Modelling effects on grid cells of sensory input during self-motion</article-title><source>The Journal of Physiology</source><volume>594</volume><fpage>6513</fpage><lpage>6526</lpage><pub-id pub-id-type="doi">10.1113/JP270649</pub-id><pub-id pub-id-type="pmid">27094096</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sargolini</surname> <given-names>F</given-names></name><name><surname>Fyhn</surname> <given-names>M</given-names></name><name><surname>Hafting</surname> <given-names>T</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name><name><surname>Witter</surname> <given-names>MP</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Conjunctive representation of position, direction, and velocity in entorhinal cortex</article-title><source>Science</source><volume>312</volume><fpage>758</fpage><lpage>762</lpage><pub-id pub-id-type="doi">10.1126/science.1125572</pub-id><pub-id pub-id-type="pmid">16675704</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Savelli</surname> <given-names>F</given-names></name><name><surname>Yoganarasimha</surname> <given-names>D</given-names></name><name><surname>Knierim</surname> <given-names>JJ</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Influence of boundary removal on the spatial representations of the medial entorhinal cortex</article-title><source>Hippocampus</source><volume>18</volume><fpage>1270</fpage><lpage>1282</lpage><pub-id pub-id-type="doi">10.1002/hipo.20511</pub-id><pub-id pub-id-type="pmid">19021262</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Savelli</surname> <given-names>F</given-names></name><name><surname>Luck</surname> <given-names>JD</given-names></name><name><surname>Knierim</surname> <given-names>JJ</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Framing of grid cells within and beyond navigation boundaries</article-title><source>eLife</source><volume>6</volume><elocation-id>e21354</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.21354</pub-id><pub-id pub-id-type="pmid">28084992</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sheynikhovich</surname> <given-names>D</given-names></name><name><surname>Chavarriaga</surname> <given-names>R</given-names></name><name><surname>Strösslin</surname> <given-names>T</given-names></name><name><surname>Arleo</surname> <given-names>A</given-names></name><name><surname>Gerstner</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Is there a geometric module for spatial orientation? Insights from a rodent navigation model</article-title><source>Psychological Review</source><volume>116</volume><fpage>540</fpage><lpage>566</lpage><pub-id pub-id-type="doi">10.1037/a0016170</pub-id><pub-id pub-id-type="pmid">19618986</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Solstad</surname> <given-names>T</given-names></name><name><surname>Boccara</surname> <given-names>CN</given-names></name><name><surname>Kropff</surname> <given-names>E</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Representation of geometric borders in the entorhinal cortex</article-title><source>Science</source><volume>322</volume><fpage>1865</fpage><lpage>1868</lpage><pub-id pub-id-type="doi">10.1126/science.1166466</pub-id><pub-id pub-id-type="pmid">19095945</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stensola</surname> <given-names>H</given-names></name><name><surname>Stensola</surname> <given-names>T</given-names></name><name><surname>Solstad</surname> <given-names>T</given-names></name><name><surname>Frøland</surname> <given-names>K</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The entorhinal grid map is discretized</article-title><source>Nature</source><volume>492</volume><fpage>72</fpage><lpage>78</lpage><pub-id pub-id-type="doi">10.1038/nature11649</pub-id><pub-id pub-id-type="pmid">23222610</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stensola</surname> <given-names>T</given-names></name><name><surname>Stensola</surname> <given-names>H</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Shearing-induced asymmetry in entorhinal grid cells</article-title><source>Nature</source><volume>518</volume><fpage>207</fpage><lpage>212</lpage><pub-id pub-id-type="doi">10.1038/nature14151</pub-id><pub-id pub-id-type="pmid">25673414</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stewart</surname> <given-names>S</given-names></name><name><surname>Jeewajee</surname> <given-names>A</given-names></name><name><surname>Wills</surname> <given-names>TJ</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name><name><surname>Lever</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Boundary coding in the rat subiculum</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>369</volume><fpage>20120514</fpage><pub-id pub-id-type="doi">10.1098/rstb.2012.0514</pub-id><pub-id pub-id-type="pmid">24366128</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wei</surname> <given-names>XX</given-names></name><name><surname>Prentice</surname> <given-names>J</given-names></name><name><surname>Balasubramanian</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A principle of economy predicts the functional architecture of grid cells</article-title><source>eLife</source><volume>4</volume><elocation-id>e08362</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.08362</pub-id><pub-id pub-id-type="pmid">26335200</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zilli</surname> <given-names>EA</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Models of grid cell spatial firing published 2005-2011</article-title><source>Frontiers in Neural Circuits</source><volume>6</volume><elocation-id>16</elocation-id><pub-id pub-id-type="doi">10.3389/fncir.2012.00016</pub-id><pub-id pub-id-type="pmid">22529780</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.38169.022</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Colgin</surname><given-names>Laura</given-names></name><role>Reviewing Editor</role><aff><institution>The University of Texas at Austin, Center for Learning and Memory</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Environmental deformations dynamically shift the grid cell spatial metric&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Michael Frank as the Senior Editor. The following individual involved in review of your submission has agreed to reveal his identity: Adrien Peyrache (Reviewer #2). Two other reviewers remain anonymous.</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>Place cells and other spatial cells found in the hippocampal formation strongly suggest the existence of a cognitive map in this area. Grid cells seem to reflect the metrical properties of this map, presumably derived from path integration computations. One reason the metrical character of the grid representation is rejected by some scientists is the fact that the regular grid firing pattern is susceptible to distortions following several types of experimental manipulations. Data from some of these experiments are reanalyzed in this study according to the computational hypothesis that these distortions can be (at least in part) caused by different reset points along the boundaries of the environment. When the boundaries of a familiar environment are manipulated, these points can produce shifted grid representations depending on which point was last encountered by the animal. Averaging together these shifted maps into a whole-trial firing rate map will yield a highly distorted grid. Specifically, the main finding is that the time averaged spatial discharge of grid and place cells look distorted only because it results from the superposition of grid/place fields that are offset depending on the origin of the animal during a particular journey. These new analyses were guided by insightful computational modeling and suggest that grid cells firing patterns reflect a more consistent metric than appears from traditional analyses.</p><p>The reviewers agreed that this work is important. However, they raised some concerns, the most substantial of which perhaps relate to the presentation of results. The reviewers feel that the most novel and important parts of the paper are the analyses, which are perhaps not properly highlighted in the current version of the manuscript. The reviewers' other major concerns are detailed below.</p><p>Essential revisions:</p><p>1) The model is only weakly connected to the data analysis part. As the authors themselves admit in the Discussion, the specific design of the model is not very important (Discussion, second paragraph). The main theoretical idea that border/boundary information resets some path integrating mechanism is actually quite old (and was already concluded from the Gothard et al., 1996 data). This questions whether the present model has any added value, particularly since all model components are well-known in the literature and many of the model assumptions are highly debated (which is not even discussed in the paper). The model should be more clearly presented in the foundation of previous work. Also, the authors should present the results of their data analysis first, and then present the model as a potential mechanistic explanation of the results. In general, they should devote more of the main text to the analysis component (about 3/5 of the supplementary materials are devoted to this part).</p><p>2) The border fields in the model are smaller than typical, firing along only 50% of the border. Although this is not abnormally small, most border cells published in the literature appear to fire along longer segments of a boundary, often times along the entire boundary and extending across a corner. One wonders if the model still works if border cells are incorporated that simulate the range of lengths reported in the literature, with the majority firing along the entire border (or at least &gt;= 75% of the border). Although the analysis of the data based on the authors' insights from the model is the real contribution of this paper, I think it is important for the authors to show whether the model still works with appropriately sized border cells (if for no other reason than to forestall distraction from the experimental analyses if readers are skeptical about the model). If the model fails to produce grid resets with larger border cell fields (perhaps due to ambiguities between the orientation of the grid fields and the extended borders), this would be an important point to discuss, suggesting that other inputs than border cells are necessary to reset the grid phase as compellingly demonstrated in the authors' analyses of the experimental data.</p><p>3) Related to the above point, is the type of learning/plasticity proposed in the model plausible, considering that grid cells are active at most about 50% of the time that a border cell is active? Does the size of the border field matter for the plasticity in the model? It is also unclear how a particular relationship between grid cell and border arises in two dimensions. The authors illustrate their learning algorithm in 1D (Figure 4A). The schematic is very informative but fails to explain clearly how grid cells become associated with a border cell. For cells belonging to the largest grid module (#5), and for which the effect of environmental deformation is the strongest, at most one field is present along a particular wall. This field overlaps only partially with the field of border cells firing for this particular wall. It begs the question of whether the co-firing between the border and the grid cells is actually above 'chance level' (i.e. baseline co-firing) to potentiate the border-to-grid synapse. The size of the border field may thus be determinant for this learning to take place, as suggested in a manuscript published recently (Santos-Pata et al., 2017; not cited). Alternatively, does the relationship between border and grid cells have to be learned? There is a large body of evidence from behavioral and experimental studies that environmental borders reset the path integrator. Can't this effect just be explained by spatially oscillatory neurons (with fixed spatial period) that are reset as soon as animals encounter a border? It might explain the experimental data reanalyzed by the authors without the need of a plasticity process between border and grid cells.</p><p>4) Along the same lines as the previous comment, grid cells have been reported to show less gridness along the walls than at the center of the environment. This could result from enhanced drive by border neurons along the boundaries. Given that grid cells in this manuscript are under direct excitatory influence of border cells, why don't they show more firing along the walls?</p><p>5) There is a potentially major methodological issue with the quantification of the grid shift in Figure 6A. Even in a familiar environment, the authors find a grid shift of about 7 cm. The question remains of whether this is just an artifact of the running statistics. Grid fields close to one border will be mostly visited if the animal was just contacting this border, whereas the occupancy in the maps conditioned to the other border will be very low. Thus the estimate of these fields will be good in the maps conditioned to the close border and bad in the maps conditioned to the distal border. A proper analysis would require some quantification of how much of a grid shift is predicted by the undersampling of the occupancy at the distal border. Similarly, for the rescaling factors in Figure 6B, the rescaling for the boundary-conditioned case could be influenced by noisy estimates of undersampled firing fields.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.38169.023</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) The model is only weakly connected to the data analysis part. As the authors themselves admit in the Discussion, the specific design of the model is not very important (Discussion, second paragraph). The main theoretical idea that border/boundary information resets some path integrating mechanism is actually quite old (and was already concluded from the Gothard et al., 1996 data). This questions whether the present model has any added value, particularly since all model components are well-known in the literature and many of the model assumptions are highly debated (which is not even discussed in the paper). The model should be more clearly presented in the foundation of previous work. Also, the authors should present the results of their data analysis first, and then present the model as a potential mechanistic explanation of the results. In general, they should devote more of the main text to the analysis component (about 3/5 of the supplementary materials are devoted to this part).</p></disp-quote><p>As suggested by the reviewers, we have now reorganized the paper such that the reanalyses are presented first, and with more of the main text and figures devoted to these analyses. We have also moved the place cell modeling portion of the paper to the supplement to foreground the grid cell reanalyses and modeling. Finally, we have grounded our work more fully in the literature.</p><disp-quote content-type="editor-comment"><p>2) The border fields in the model are smaller than typical, firing along only 50% of the border. Although this is not abnormally small, most border cells published in the literature appear to fire along longer segments of a boundary, often times along the entire boundary and extending across a corner. One wonders if the model still works if border cells are incorporated that simulate the range of lengths reported in the literature, with the majority firing along the entire border (or at least &gt;= 75% of the border). Although the analysis of the data based on the authors' insights from the model is the real contribution of this paper, I think it is important for the authors to show whether the model still works with appropriately sized border cells (if for no other reason than to forestall distraction from the experimental analyses if readers are skeptical about the model). If the model fails to produce grid resets with larger border cell fields (perhaps due to ambiguities between the orientation of the grid fields and the extended borders), this would be an important point to discuss, suggesting that other inputs than border cells are necessary to reset the grid phase as compellingly demonstrated in the authors' analyses of the experimental data.</p></disp-quote><p>In our previous submission, border fields did extend around corners uniformly tiling the perimeter of the environment; we now show examples of border units with these properties for clarity (Figure 4A). Following the reviewers’ suggestion, we now also include simulations from a rate-based model in which border fields cover the entire length of a wall of the environment (Figure 5—figure supplement 1). These fields were also distributed evenly around the environment perimeter, with the fields of some border units wrapped around corners. This model reproduces boundary-tethered phase shifts, as well as scale-dependent and local distortions of the time-averaged grid pattern, as reported in the main text and our initial submission.</p><disp-quote content-type="editor-comment"><p>3) Related to the above point, is the type of learning/plasticity proposed in the model plausible, considering that grid cells are active at most about 50% of the time that a border cell is active? Does the size of the border field matter for the plasticity in the model? It is also unclear how a particular relationship between grid cell and border arises in two dimensions. The authors illustrate their learning algorithm in 1D (Figure 4A). The schematic is very informative but fails to explain clearly how grid cells become associated with a border cell. For cells belonging to the largest grid module (#5), and for which the effect of environmental deformation is the strongest, at most one field is present along a particular wall. This field overlaps only partially with the field of border cells firing for this particular wall. It begs the question of whether the co-firing between the border and the grid cells is actually above 'chance level' (i.e. baseline co-firing) to potentiate the border-to-grid synapse. The size of the border field may thus be determinant for this learning to take place, as suggested in a manuscript published recently (Santos-Pata et al., 2017; not cited). Alternatively, does the relationship between border and grid cells have to be learned? There is a large body of evidence from behavioral and experimental studies that environmental borders reset the path integrator. Can't this effect just be explained by spatially oscillatory neurons (with fixed spatial period) that are reset as soon as animals encounter a border? It might explain the experimental data reanalyzed by the authors without the need of a plasticity process between border and grid cells.</p></disp-quote><p>We implemented plasticity in our model to derive a consistent mapping of border input to grid phase in the familiar environment. We selected this particular implementation of plasticity because it had been used previously to model connections between grid cells and place cells (Pilly and Grossberg, 2013). With this form of plasticity it is competition among inputs which matters most – thus the size of the border fields as well as the scale and phase of the grid pattern will have some effect on plasticity. In our model, the connection strengths were chosen such that, despite these differences, border inputs were sufficient to induce boundary-tethered shifts in grid phase in all modules during deformations. Other forms of plasticity could likely also work. We also agree with the reviewers that the results presented here do not necessarily depend on plasticity. To demonstrate this, we now include simulations which reproduce grid scale-dependent rescaling without plasticity as a result of boundary-tethered shifts in phase imposed by fiat in the model (Figure 5—figure supplement 2). Nevertheless, there are experimental results beyond the modeled phenomena which suggest that phase-boundary anchoring may be plastic. For example, as an environment becomes more familiar grid scale decreases (Barry et al., 2012), which would lead to conflicting boundary-phase relationships in the absence of plasticity. Likewise, grid phase relative to boundaries can differ across geometrically identical environments (Marozzi, et al., 2015). Finally, rescaling during deformations does not persist indefinitely, as the grid representation relaxes to its familiar scale over time (Barry, et al., 2007). Thus, even if plasticity is ultimately not necessary to capture the phenomena we model here, there is a motivation for hypothesizing that boundary-phase relationships can change over time.</p><disp-quote content-type="editor-comment"><p>4) Along the same lines as the previous comment, grid cells have been reported to show less gridness along the walls than at the center of the environment. This could result from enhanced drive by border neurons along the boundaries. Given that grid cells in this manuscript are under direct excitatory influence of border cells, why don't they show more firing along the walls?</p></disp-quote><p>As the reviewers note, experimentally-observed reduction in gridness along the walls of the environment could be a result of additional border input. This result can be replicated in our model if the connections from border units to grid units are strengthened – when strengthened, the noisy spiking of individual border units is amplified and can be sufficient to override path integration and shift the grid phase parallel to the boundary in undeformed environments. This results in time-averaged grid patterns with increased out-of-field spiking along borders, as observed in two example units from the same module in a simulation with increased border-to-grid connection strength (<xref ref-type="fig" rid="respfig1">Author response image 1</xref>).</p><fig id="respfig1"><label>Author response image 1.</label><graphic mime-subtype="jpeg" mimetype="image" xlink:href="elife-38169-resp-fig1-v2"/></fig><p>In the model as described in the paper, this disruption of gridness does not occur because we set the strength of border unit input to be: 1) weak enough such that individual noisy border unit inputs are not sufficient on their own to override path integration and induce parallel-to-boundary drift, but also 2) strong enough such that the input from the border unit population as a whole is sufficient to override path integration and shift grid phase. In our view this detail is beyond the scope of the large deformation phenomena we address here, and is for future studies to address. We suggest that future modeling might include increased border-to-grid connection strength in concert with additional inputs such as those derived from visual cues, place cells, or boundary vector cells to capture this grid distortion.</p><disp-quote content-type="editor-comment"><p>5) There is a potentially major methodological issue with the quantification of the grid shift in Figure 6A. Even in a familiar environment, the authors find a grid shift of about 7 cm. The question remains of whether this is just an artifact of the running statistics. Grid fields close to one border will be mostly visited if the animal was just contacting this border, whereas the occupancy in the maps conditioned to the other border will be very low. Thus the estimate of these fields will be good in the maps conditioned to the close border and bad in the maps conditioned to the distal border. A proper analysis would require some quantification of how much of a grid shift is predicted by the undersampling of the occupancy at the distal border. Similarly, for the rescaling factors in Figure 6B, the rescaling for the boundary-conditioned case could be influenced by noisy estimates of undersampled firing fields.</p></disp-quote><p>We thank the reviewers for noting this potentially confounding bias. In the previous draft our shift and rescaling analyses relied only on pixels that were sampled after contact with both opposing boundaries in the hopes of minimizing sampling biases; however, this may be inadequate. We have now changed our measure of shift in two key ways to address this possibility. Firstly, when generating opposing boundary rate maps for the purpose of computing shift we now match the number of samples within each pixel (prior to smoothing) by selecting a random subset of timepoints when the animal was at each location after contacting each boundary. Secondly, because the maximum shift that could possibly be observed is constrained to half the grid scale, we now compute the cross-correlation across the lags of [-grid scale/2 to +grid scale/2], and express shift as a shift-to-scale ratio. Because there is noise introduced by our random selection of timepoints, we repeat this shift calculation for each cell 100 times, and take the average across those repetitions as our final estimate of shift. The shift we observe with this more controlled analysis in which sampling biases are eliminated is qualitatively similar but more reliable (less variance across cells and trials). When computing rescaling, we now also take a similar approach – when comparing rescaling in the wholetrial versus boundary-conditioned data, we subsampled the whole-trial rate map to match the sampling distribution of the to-be-compared boundary rate map, with the mean of 100 repetitions for each comparison taken as the sampling-equated rescaling estimate. As in our original analyses, we find that boundary-conditioning reduces the appearance of rescaling when these sampling biases are eliminated.</p></body></sub-article></article>