<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN"  "JATS-archivearticle1-3-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">94587</article-id><article-id pub-id-type="doi">10.7554/eLife.94587</article-id><article-version article-version-type="publication-state">version of record</article-version><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Evolutionary Biology</subject></subj-group></article-categories><title-group><article-title>Heterozygote advantage can explain the extraordinary diversity of immune genes</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><name><surname>Siljestam</surname><given-names>Mattias</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-3720-4926</contrib-id><email>m@siljestam.com</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Rueffler</surname><given-names>Claus</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9836-2752</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/048a87296</institution-id><institution>Department of Ecology and Genetics, Animal Ecology, Uppsala University</institution></institution-wrap><addr-line><named-content content-type="city">Uppsala</named-content></addr-line><country>Sweden</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Ispolatov</surname><given-names>Yaroslav</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02ma57s91</institution-id><institution>University of Santiago Chile</institution></institution-wrap><country>Chile</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Weigel</surname><given-names>Detlef</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0243gzr89</institution-id><institution>Max Planck Institute for Biology Tübingen</institution></institution-wrap><country>Germany</country></aff></contrib></contrib-group><pub-date publication-format="electronic" date-type="publication"><day>26</day><month>11</month><year>2024</year></pub-date><volume>13</volume><elocation-id>e94587</elocation-id><history><date date-type="received" iso-8601-date="2023-11-16"><day>16</day><month>11</month><year>2023</year></date><date date-type="accepted" iso-8601-date="2024-11-11"><day>11</day><month>11</month><year>2024</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at .</event-desc><date date-type="preprint" iso-8601-date="2018-06-14"><day>14</day><month>06</month><year>2018</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/347344"/></event></pub-history><permissions><copyright-statement>© 2024, Siljestam and Rueffler</copyright-statement><copyright-year>2024</copyright-year><copyright-holder>Siljestam and Rueffler</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-94587-v2.pdf"/><abstract><p>The majority of highly polymorphic genes are related to immune functions and with over 100 alleles within a population, genes of the major histocompatibility complex (MHC) are the most polymorphic loci in vertebrates. How such extraordinary polymorphism arose and is maintained is controversial. One possibility is heterozygote advantage (HA), which can in principle maintain any number of alleles, but biologically explicit models based on this mechanism have so far failed to reliably predict the coexistence of significantly more than 10 alleles. We here present an eco-evolutionary model showing that evolution can result in the emergence and maintenance of more than 100 alleles under HA if the following two assumptions are fulfilled: first, pathogens are lethal in the absence of an appropriate immune defence; second, the effect of pathogens depends on host condition, with hosts in poorer condition being affected more strongly. Thus, our results show that HA can be a more potent force in explaining the extraordinary polymorphism found at MHC loci than currently recognised.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>allelic polymorpahism</kwd><kwd>divergent allele advantage</kwd><kwd>evolutionary invasion analysis</kwd><kwd>negative frequency-dependent selection</kwd><kwd>host-pathogen interaction</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>None</kwd></kwd-group><funding-group><funding-statement>No external funding was received for this work.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>An eco-evolutionary model shows that heterozygote advantage can maintain over 100 major histocompatibility complex alleles, providing a potent explanation for extraordinary immune gene diversity and challenges previous models that predicted limited allele coexistence.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Heterozygote advantage (HA) is a well-established explanation for single locus polymorphism, with the sickle cell locus as a classical textbook example (<xref ref-type="bibr" rid="bib4">Allison, 1954</xref>). However, whether HA is generally important for the maintenance of genetic polymorphism is questioned (<xref ref-type="bibr" rid="bib36">Hedrick, 2012</xref>; <xref ref-type="bibr" rid="bib69">Sellis et al., 2016</xref>). Genes of the major histocompatibility complex (MHC), responsible for inducing immune defences by recognising the agretopes of the pathogenic antigens, are the most polymorphic loci among vertebrates (<xref ref-type="bibr" rid="bib19">Duncan et al., 1979</xref>; <xref ref-type="bibr" rid="bib6">Apanius et al., 1997</xref>; <xref ref-type="bibr" rid="bib61">Penn, 2002</xref>; <xref ref-type="bibr" rid="bib71">Sommer, 2005</xref>; <xref ref-type="bibr" rid="bib21">Eizaguirre and Lenz, 2010</xref>). HA as an explanation for this high level of polymorphism was introduced almost 50 years ago by <xref ref-type="bibr" rid="bib18">Doherty and Zinkernagel, 1975</xref>. The idea suggests that individuals with MHC-molecules from two different alleles are capable of recognising a broader spectrum of pathogens, resulting in higher fitness. This is especially evident when the MHC-molecules of the two alleles have complementary immune profiles (<xref ref-type="bibr" rid="bib63">Pierini and Lenz, 2018</xref>), a phenomenon known as divergent allele advantage (<xref ref-type="bibr" rid="bib80">Wakeland et al., 1990</xref>), and <xref ref-type="bibr" rid="bib74">Stefan et al., 2019</xref> show that this allows for the coexistence of alleles with larger variation in their immune efficiencies. Early theoretical work suggested that HA can maintain an arbitrarily high number of alleles if these alleles have appropriately fine-tuned homo- and heterozygote fitness values (<xref ref-type="bibr" rid="bib42">Kimura and Crow, 1964</xref>; <xref ref-type="bibr" rid="bib85">Wright, 1966</xref>; <xref ref-type="bibr" rid="bib55">Maruyama and Nei, 1981</xref>). However, later work suggests that such genotypic fitness values are unlikely to emerge through random mutations (<xref ref-type="bibr" rid="bib51">Lewontin et al., 1978</xref>). More mechanistic models have also failed to reliably predict very high allele numbers (<xref ref-type="bibr" rid="bib72">Spencer and Marks, 1988</xref>; <xref ref-type="bibr" rid="bib35">Hedrick, 2002</xref>; <xref ref-type="bibr" rid="bib13">De Boer et al., 2004</xref>; <xref ref-type="bibr" rid="bib7">Borghans et al., 2004</xref>; <xref ref-type="bibr" rid="bib75">Stoffels and Spencer, 2008</xref>; <xref ref-type="bibr" rid="bib78">Trotter and Spencer, 2008</xref>; <xref ref-type="bibr" rid="bib79">Trotter and Spencer, 2013</xref>; <xref ref-type="bibr" rid="bib23">Ejsmond and Radwan, 2015</xref>; <xref ref-type="bibr" rid="bib46">Lau et al., 2015</xref>). As a result, HA plays only a minor role in current explanations of polymorphism at MHC loci (<xref ref-type="bibr" rid="bib34">Hedrick, 1998</xref>; <xref ref-type="bibr" rid="bib33">Gould et al., 2004</xref>; <xref ref-type="bibr" rid="bib81">Wegner, 2008</xref>; <xref ref-type="bibr" rid="bib41">Kekäläinen et al., 2009</xref>; <xref ref-type="bibr" rid="bib21">Eizaguirre and Lenz, 2010</xref>; <xref ref-type="bibr" rid="bib49">Lenz, 2011</xref>; <xref ref-type="bibr" rid="bib54">Loiseau et al., 2011</xref>), despite empirical evidence for its existence (<xref ref-type="bibr" rid="bib18">Doherty and Zinkernagel, 1975</xref>; <xref ref-type="bibr" rid="bib37">Hughes and Nei, 1989</xref>; <xref ref-type="bibr" rid="bib39">Jeffery and Bangham, 2000</xref>; <xref ref-type="bibr" rid="bib62">Penn et al., 2002</xref>; <xref ref-type="bibr" rid="bib56">McClelland et al., 2003</xref>; <xref ref-type="bibr" rid="bib28">Froeschke and Sommer, 2005</xref>; <xref ref-type="bibr" rid="bib41">Kekäläinen et al., 2009</xref>; <xref ref-type="bibr" rid="bib60">Oliver et al., 2009</xref>; <xref ref-type="bibr" rid="bib49">Lenz, 2011</xref>). Consequently, other mechanisms are suggested to be important for the maintenance of allelic diversity, such as Red-Queen dynamics, fluctuating selection, and disassortative mating (<xref ref-type="bibr" rid="bib6">Apanius et al., 1997</xref>; <xref ref-type="bibr" rid="bib34">Hedrick, 1998</xref>; <xref ref-type="bibr" rid="bib61">Penn, 2002</xref>; <xref ref-type="bibr" rid="bib7">Borghans et al., 2004</xref>; <xref ref-type="bibr" rid="bib81">Wegner, 2008</xref>; <xref ref-type="bibr" rid="bib73">Spurgin and Richardson, 2010</xref>; <xref ref-type="bibr" rid="bib54">Loiseau et al., 2011</xref>; <xref ref-type="bibr" rid="bib23">Ejsmond and Radwan, 2015</xref>; <xref ref-type="bibr" rid="bib24">Ejsmond et al., 2023</xref>).</p><p>Our study challenges this status quo by demonstrating that HA is a potent force that can drive the evolution and subsequent maintenance of more than 100 alleles. To demonstrate that it is indeed HA that is responsible for allelic diversity in our model, we deliberately keep all aspects of the pathogen community fixed to exclude any Red-Queen dynamics. The novelty of our approach lies in the fact that we do not rely on hand-picked genotypic fitness values. Instead, these fitness values emerge from our eco-evolutionary models, where the allelic values that allow for extraordinary polymorphism are found by evolution in a self-organised process. We do not claim that HA is the only mechanism responsible for the diversity of MHC-alleles in nature. However, our results show that HA can be more important than currently recognised.</p></sec><sec id="s2" sec-type="model"><title>Model</title><p>We investigate the evolution at an MHC locus using mathematical modelling and computer simulations. In the following sections, we describe how genotypes map to immune response and ultimately to survival, followed by a description of our evolutionary algorithm.</p><p>We assume that the MHC-molecules produced by the two alleles at a diploid MHC locus determine the immune response based on antigen recognition against multiple pathogens present in the environment. Our approach is based on the following two key assumptions regarding the relationship between pathogen virulence and host fitness:</p><list list-type="alpha-lower"><list-item><p>Virulent pathogens are lethal in the absence of an appropriate immune defence.</p></list-item><list-item><p>The effect of pathogens on host survival depends on host condition, with hosts in poorer condition being affected more strongly.</p></list-item></list><p>An implication of the second assumption is that the combined effect of multiple pathogens on host survival exceeds the sum of the effects of each pathogen alone.</p><p>To incorporate these two assumptions, we assume that the effect of pathogen attacks on host survival acts through the intermediary step of the host’s ‘condition’, which is a proxy for a suit of measurements describing an individual’s body composition and physiology (<xref ref-type="bibr" rid="bib82">Wilder et al., 2016</xref>). In the absence of an adequate immune response, a pathogen attack reduces the condition of a host to zero, causing its death (assumption a). More generally, we assume that the probability to survive is an increasing function of condition and that a host clearing a pathogen is in a weaker condition afterward. Since the survival probability cannot exceed one, the function that maps condition to survival has to be saturating. Consequently, for high values of conditions, where the survival function has saturated, pathogens reducing condition have small effects on survival. As condition decreases, pathogen-induced reductions have larger effects on survival (assumption b). A natural biological intuition for assumption (b) can be drawn from examples like COVID-19 or influenza, where it is well known that these pathogens do not pose a high mortality risk to individuals in good condition, but can significantly increase mortality risk for individuals in poor condition (<xref ref-type="bibr" rid="bib77">Thompson, 2004</xref>; <xref ref-type="bibr" rid="bib86">Zhou et al., 2020</xref>).</p><p>A further assumption of our model is the existence of a trade-off between the efficiencies of MHC-molecules to induce a defence against different pathogens. Thus, no MHC-molecule can perform optimally with respect to all pathogens and an improved efficiency against one set of pathogens can only be achieved at the expense of a decreased efficiency against another set of pathogens. Under such trade-offs, an MHC-molecule can be specialised to detect a few pathogens with high efficiency, or, alternatively, be a generalist molecule that can detect many pathogens but with low efficiency. There is empirical support for the existence of such trade-offs. First, many MHC-molecules can detect only a certain set of antigens (<xref ref-type="bibr" rid="bib80">Wakeland et al., 1990</xref>; <xref ref-type="bibr" rid="bib29">Froeschke and Sommer, 2012</xref>; <xref ref-type="bibr" rid="bib22">Eizaguirre et al., 2012</xref>; <xref ref-type="bibr" rid="bib10">Chappell et al., 2015</xref>; <xref ref-type="bibr" rid="bib63">Pierini and Lenz, 2018</xref>) and therefore provide different degrees of protection against different pathogens (<xref ref-type="bibr" rid="bib80">Wakeland et al., 1990</xref>; <xref ref-type="bibr" rid="bib6">Apanius et al., 1997</xref>; <xref ref-type="bibr" rid="bib21">Eizaguirre and Lenz, 2010</xref>; <xref ref-type="bibr" rid="bib29">Froeschke and Sommer, 2012</xref>; <xref ref-type="bibr" rid="bib22">Eizaguirre et al., 2012</xref>; <xref ref-type="bibr" rid="bib11">Cortazar Chinarro et al., 2022</xref>). Second, it has also been found that specialist MHC-molecules are expressed at higher levels at the cell surface while generalist MHC-molecules that bind less selectively are expressed at lower levels (<xref ref-type="bibr" rid="bib10">Chappell et al., 2015</xref>), potentially to reduce the harm of binding self-peptides. This could explain the lower efficiency of generalist MHC-molecules.</p><p>We employ two approaches to model this trade-off. First, we use unimodal functions to model the match between MHC-molecules and pathogens. This approach has a long history in evolutionary ecology (e.g. <xref ref-type="bibr" rid="bib50">Levins, 1968</xref>; <xref ref-type="bibr" rid="bib70">Sheftel et al., 2018</xref>), and, when using Gaussian functions, the model becomes amenable to mathematical analysis. We envisage that these pathogen optima represent distinct pathogen species from diverse taxonomic groups such as fungi, viruses, bacteria, protists, helminths, and prions, among others (<xref ref-type="bibr" rid="bib68">Schmid-Hempel, 2021</xref>). Hence, we expect these pathogen optima to remain approximately constant over the time scales considered in our model. By keeping all aspects of the pathogen community fixed, we exclude Red-Queen dynamics and ensure that the observed allelic polymorphism is driven solely by HA.</p><p>To demonstrate that the allelic diversity evolving in the Gaussian model does not dependent on the specificities of this model but rather results from the model fulfilling the above assumptions (a) and (b), we implement an alternative and more mechanistic approach to model pathogen recognition. Inspired by <xref ref-type="bibr" rid="bib7">Borghans et al., 2004</xref>, in this approach, while keeping assumptions (a) and (b) intact, immune defence is based on the match between two binary strings (or bit-strings), one representing the MHC-molecule and the other a peptide of the pathogen. In this model, a single MHC-allele has the potential to detect several pathogens, which could be interpreted as the different pathogens being more closely related.</p><p>By explicitly modelling MHC efficiencies against various pathogens – rather than assuming a fixed proportion of pathogens detected per MHC-molecule (as, e.g., <xref ref-type="bibr" rid="bib13">De Boer et al., 2004</xref>) – our model accounts for the possibility that MHC-molecules can have complementary immune profiles. When paired, complementary alleles produce fit heterozygotes able to detect an increased number of pathogen peptides (<xref ref-type="bibr" rid="bib63">Pierini and Lenz, 2018</xref>), exemplifying the concept of divergent allele advantage in the sense of <xref ref-type="bibr" rid="bib80">Wakeland et al., 1990</xref>.</p><sec id="s2-1"><title>Gaussian model</title><p>In this approach, we use Gaussian functions to model the ability of MHC-molecules to recognise <inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi></mml:mstyle></mml:math></inline-formula> different pathogens, as illustrated in <xref ref-type="fig" rid="fig1">Figure 1</xref>. Here, MHC-alleles and pathogens are represented by vectors <inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, respectively. The MHC-alleles code for MHC-molecules, and the ability of an MHC-molecule to recognise the <italic>k</italic>th pathogen is maximal if <bold><italic>x</italic></bold>=<bold><italic>p</italic></bold><italic><sub>k</sub></italic>. This ability decreases with increasing distance between <inline-formula><mml:math id="inf4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. The decrease is modelled using an <italic>h</italic>-dimensional Gaussian function, as detailed in <xref ref-type="disp-formula" rid="equ23">Equation A14</xref>. The nature of the trade-off can be varied by adjusting the positions of the pathogen optima and the shape of the Gaussian functions.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Efficiency against two pathogens (coloured lines in <bold>A–B</bold>) and three pathogens (coloured cones in <bold>C–D</bold>) as a function of allelic values <inline-formula><mml:math id="inf6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>.</title><p>Efficiencies are modeled with Gaussian functions with pathogen optima at equal distances <inline-formula><mml:math id="inf7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula> (indicated by <inline-formula><mml:math id="inf8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>p</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>p</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> in <bold>A, B</bold>). The width of the Gaussian functions, which determine how severely pathogens affect hosts with suboptimal major histocompatibility complex (MHC) molecules, is given by the virulence parameter <inline-formula><mml:math id="inf10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi></mml:mstyle></mml:math></inline-formula>. With high virulence (<inline-formula><mml:math id="inf11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>7</mml:mn></mml:mstyle></mml:math></inline-formula>, narrow Gaussians in <bold>B, D</bold>), alleles away from the optima have a low efficiency, while for a low virulence (<inline-formula><mml:math id="inf12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>2.5</mml:mn></mml:mstyle></mml:math></inline-formula>, wide Gaussians in <bold>A, C</bold>) efficiency is higher. Grey lines and cones give the condition <inline-formula><mml:math id="inf13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>c</mml:mi></mml:mstyle></mml:math></inline-formula> of homozygote individuals. The generalist allele, maximising condition, is located at the centre with equal distance to all pathogen optima (indicated by <inline-formula><mml:math id="inf14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> in <bold>A, B</bold>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-94587-fig1-v2.tif"/></fig><p>Without loss of generality, we can reduce the dimension of the vectors <inline-formula><mml:math id="inf15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> to <inline-formula><mml:math id="inf17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula>, such that <inline-formula><mml:math id="inf18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. For example, in <xref ref-type="fig" rid="fig1">Figure 1A and B</xref>, where <inline-formula><mml:math id="inf20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula>, the <italic>x</italic>-axis represents the unique line passing through two pathogen optima in a trait space of potentially much higher dimension. Similarly, in <xref ref-type="fig" rid="fig1">Figure 1C and D</xref>, where <inline-formula><mml:math id="inf21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mstyle></mml:math></inline-formula>, the two-dimensional coordinate system represented by the grey surfaces describes the unique plane passing through three pathogen optima. Mathematically speaking, <inline-formula><mml:math id="inf22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi></mml:mstyle></mml:math></inline-formula> linearly independent pathogen optima form the basis of a vector space of dimension <inline-formula><mml:math id="inf23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula>, which we choose as the coordinate system for the vectors <inline-formula><mml:math id="inf24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Allelic vectors outside this set are necessarily maladapted for all pathogens along at least one dimension, and owing to our dimensionality reduction we ignore such trait vectors.</p><p>We examine two versions of the Gaussian model. The first one is based on two symmetry assumptions and shown in <xref ref-type="fig" rid="fig1">Figure 1</xref>: pathogen optima are placed symmetrically such that the distance between any two pathogens equals 1, and the Gaussian functions <inline-formula><mml:math id="inf26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> are isotropic (rotationally symmetric) and of equal width. This allows to simplify the covariance matrix in the Gaussian function <inline-formula><mml:math id="inf27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ23">Equation A14</xref>) such that it can be replaced with a single parameter <inline-formula><mml:math id="inf28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> (Appendix ‘Model description’),<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:msup><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where the superscript <inline-formula><mml:math id="inf29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">T</mml:mi></mml:mstyle></mml:math></inline-formula> indicates vector transposition. The parameter <inline-formula><mml:math id="inf30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi></mml:mstyle></mml:math></inline-formula>, to which we refer as virulence, is the inverse of the width of the Gaussian function. If the Gaussian function is narrow, corresponding to a high virulence <inline-formula><mml:math id="inf31"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi></mml:mstyle></mml:math></inline-formula>, a pathogen causes significant harm if MHC-molecules are not well adapted against it (<xref ref-type="fig" rid="fig1">Figure 1B and D</xref>). On the other hand, if the Gaussian function is wide, corresponding to a low virulence <inline-formula><mml:math id="inf32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi></mml:mstyle></mml:math></inline-formula>, a pathogen causes less harm (<xref ref-type="fig" rid="fig1">Figure 1A and C</xref>).</p><p>We relax these symmetry assumptions in the second version, where we allow for Gaussian functions with arbitrary shape and position. Since the results for the two versions are similar, we here focus on the case with symmetry and refer to Appendices ‘Deviations from symmetry in the Gaussian model’, ‘Mode description’, and ‘Analytical results for the Gaussian model’ for results based on general Gaussian functions.</p></sec><sec id="s2-2"><title>Bit-string model</title><p>Our second approach is inspired by <xref ref-type="bibr" rid="bib7">Borghans et al., 2004</xref>, and commonly referred to as a bit-string model. Pathogens are assumed to produce <inline-formula><mml:math id="inf33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> peptides, and for a pathogen to cause virulence, all of its peptides have to avoid detection by the host’s MHC-molecules. We here equate MHC-alleles with the MHC-molecule they code for, and both MHC-molecules and pathogen peptides are represented by binary strings (or bit-strings) of, following <xref ref-type="bibr" rid="bib7">Borghans et al., 2004</xref>, length 16.</p><p>The probability that an MHC-molecule detects a pathogen peptide increases with the maximum match length of consecutive matches between their binary strings. For an MHC-molecule <inline-formula><mml:math id="inf34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and the <italic>k</italic>th peptide of the <italic>i</italic>th pathogen, this match length is denoted <inline-formula><mml:math id="inf35"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, or <inline-formula><mml:math id="inf36"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>L</mml:mi></mml:mstyle></mml:math></inline-formula> for short (see <xref ref-type="fig" rid="fig2">Figure 2A</xref>). The corresponding detection probability, denoted <inline-formula><mml:math id="inf37"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, is then given by the logistic function<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf38"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi></mml:mstyle></mml:math></inline-formula> denotes the required match length <inline-formula><mml:math id="inf39"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>L</mml:mi></mml:mstyle></mml:math></inline-formula> for a 50% chance of detection. The parameter <inline-formula><mml:math id="inf40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> has again the interpretation of virulence, with higher values indicating pathogen peptides that are harder to detect by MHC-molecules. The positive parameter <inline-formula><mml:math id="inf41"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>a</mml:mi></mml:mstyle></mml:math></inline-formula> governs the steepness of the function <inline-formula><mml:math id="inf42"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>D</mml:mi></mml:mstyle></mml:math></inline-formula>. We choose <inline-formula><mml:math id="inf43"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>9</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, which results in <inline-formula><mml:math id="inf44"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> equalling 10% when <inline-formula><mml:math id="inf45"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mi>v</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and 90% when <inline-formula><mml:math id="inf46"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mi>v</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). Finally, the realised efficiency of an MHC-molecule <inline-formula><mml:math id="inf47"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> against the <italic>k</italic>th pathogen is given by the probability of detecting at least one of its <inline-formula><mml:math id="inf48"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> peptides, which equals<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Detection probability in the bit-string model.</title><p>(<bold>A</bold>) Major histocompatibility complex (MHC) bit-string matching against a pathogen with <inline-formula><mml:math id="inf49"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> peptides. Yellow indicates a match between MHC and peptide bits. The longest consecutive match per peptide (<inline-formula><mml:math id="inf50"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>L</mml:mi></mml:mstyle></mml:math></inline-formula>) is indicated with a black box. The longest match over all peptides occurs for the last peptide, marked in green, with match length <inline-formula><mml:math id="inf51"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>7</mml:mn></mml:mstyle></mml:math></inline-formula>. (<bold>B</bold>) Detection probability for peptides as a function of match length <inline-formula><mml:math id="inf52"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>L</mml:mi></mml:mstyle></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ2">Equation 2</xref> with <inline-formula><mml:math id="inf53"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>9</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>). The dashed lines indicate, from left to right, 10%, 50%, and 90% detection probability.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-94587-fig2-v2.tif"/></fig></sec><sec id="s2-3"><title>From immune defence to survival</title><p>For both versions of our model, we assume that MHC-alleles are co-dominantly expressed (<xref ref-type="bibr" rid="bib21">Eizaguirre and Lenz, 2010</xref>; <xref ref-type="bibr" rid="bib1">Abbas et al., 2014</xref>), and an individual’s efficiency to recognise pathogens of type <inline-formula><mml:math id="inf54"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>k</mml:mi></mml:mstyle></mml:math></inline-formula> is given by the arithmetic mean of the efficiencies from its two alleles. We want to note that assuming co-dominance gives more conservative results in terms of the number of coexisting alleles, as dominance would increase the degree of HA.</p><p>For each pathogen attack, an individual’s condition <inline-formula><mml:math id="inf55"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>c</mml:mi></mml:mstyle></mml:math></inline-formula> is reduced by a certain fraction that depends on the efficiency of the defence <inline-formula><mml:math id="inf56"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>e</mml:mi></mml:mstyle></mml:math></inline-formula> against that pathogen. Since each individual is exposed to all pathogens during their lifetime, the condition <inline-formula><mml:math id="inf57"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>c</mml:mi></mml:mstyle></mml:math></inline-formula> is determined by the product of its defences against all pathogens,<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:msub><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf58"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf59"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> represent the MHC-alleles the host carries at the focal locus, and <inline-formula><mml:math id="inf60"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>c</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> is the condition of a hypothetical individual with perfect defence against all pathogens (see Appendix ‘Model description’ for more details). Because <inline-formula><mml:math id="inf61"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, condition is reduced with each additional pathogen in a proportional manner. The multiplicative nature of <xref ref-type="disp-formula" rid="equ4">Equation 4</xref> has the effect that a poor defence against a single pathogen is sufficient to severely compromise condition, and therefore survival (see next paragraph), fulfilling assumption (a) above.</p><p>Finally, survival <inline-formula><mml:math id="inf62"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>s</mml:mi></mml:mstyle></mml:math></inline-formula> is an increasing but saturating function of an individual’s condition <inline-formula><mml:math id="inf63"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>c</mml:mi></mml:mstyle></mml:math></inline-formula>,<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf64"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi></mml:mstyle></mml:math></inline-formula> is the survival half-saturation constant, giving the condition <inline-formula><mml:math id="inf65"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>c</mml:mi></mml:mstyle></mml:math></inline-formula> required for a 50% chance of survival. This function fulfils assumption (b) above as long as <inline-formula><mml:math id="inf66"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi></mml:mstyle></mml:math></inline-formula> is not too large. Individuals in good health then have a condition <inline-formula><mml:math id="inf67"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>c</mml:mi></mml:mstyle></mml:math></inline-formula> far above <inline-formula><mml:math id="inf68"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi></mml:mstyle></mml:math></inline-formula>, and a decrease in condition only has a small effect on survival. If <inline-formula><mml:math id="inf69"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>c</mml:mi></mml:mstyle></mml:math></inline-formula> is lower than <inline-formula><mml:math id="inf70"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi></mml:mstyle></mml:math></inline-formula>, then the host is in bad health and any additional pathogen causes a large reduction in survival <inline-formula><mml:math id="inf71"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>s</mml:mi></mml:mstyle></mml:math></inline-formula> (orange lines in bottom panel of <xref ref-type="fig" rid="fig3">Figure 3</xref> and 6).</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Evolution of allelic values under the Gaussian model in the presence of three pathogens (arranged as in <xref ref-type="fig" rid="fig1">Figure 1D</xref>) for four different values of the survival half-saturation constant <inline-formula><mml:math id="inf72"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi></mml:mstyle></mml:math></inline-formula> (<bold>A</bold>: <inline-formula><mml:math id="inf73"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <bold>B</bold>: <inline-formula><mml:math id="inf74"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <bold>C</bold>: <inline-formula><mml:math id="inf75"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <bold>D</bold>: <inline-formula><mml:math id="inf76"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>; dashed line in lower panel).</title><p>The top panel shows individual-based simulations. The two horizontal axes give the two allelic values <inline-formula><mml:math id="inf77"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> that characterise an allele, while the vertical axis shows evolutionary time. The thickness of the blue tubes is proportional to allele frequencies. Allelic values at the last generation are projected as red dots on the top as well as on the bottom plane. Coloured circles represent the contour lines of the Gaussian efficiency functions <inline-formula><mml:math id="inf78"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> as shown in <xref ref-type="fig" rid="fig1">Figure 1D</xref>. In all simulations, gradual evolution leads towards the generalist allele <inline-formula><mml:math id="inf79"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> and branching occurs in its neighbourhood, as predicted by our analytical derivations (Appendix ‘The evolutionarily singular point’). In (<bold>A</bold>) there are three consecutive branching events with the second branching event marked by the grey plane (<inline-formula><mml:math id="inf80"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>4.0</mml:mn></mml:mstyle></mml:math></inline-formula>; for details regarding <inline-formula><mml:math id="inf81"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>, see the legend of <xref ref-type="fig" rid="fig4">Figure 4</xref>). (<bold>B and C</bold>) show that, as <inline-formula><mml:math id="inf82"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi></mml:mstyle></mml:math></inline-formula> decreases, the number of branching events increases, resulting in more coexisting alleles (<inline-formula><mml:math id="inf83"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>7.8</mml:mn></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf84"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>16.5</mml:mn></mml:mstyle></mml:math></inline-formula>, respectively). Finally, (<bold>D</bold>) reveals that, as <inline-formula><mml:math id="inf85"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi></mml:mstyle></mml:math></inline-formula> decreases even further such that already low condition values result in high survival, the number of branching events decreases again, resulting in a set of alleles closely clustered around the generalist allele (<inline-formula><mml:math id="inf86"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>10.2</mml:mn></mml:mstyle></mml:math></inline-formula>). The bottom panel shows survival <inline-formula><mml:math id="inf87"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>s</mml:mi></mml:mstyle></mml:math></inline-formula> as a function of condition <inline-formula><mml:math id="inf88"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>c</mml:mi></mml:mstyle></mml:math></inline-formula> as defined by <xref ref-type="disp-formula" rid="equ5">Equation 5</xref> on a log-log scale (orange line, left vertical axis) and the frequencies of individual conditions at the final generation (dark blue bars for homozygotes and light blue bars for heterozygotes, right vertical axis; conditions from 0 to <inline-formula><mml:math id="inf89"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> are incorporated into the first bar). These panels show that increased allelic diversity results in a lower proportion of homozygote individuals, which have lower survival. Other parameter values: <inline-formula><mml:math id="inf90"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf91"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf92"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, and <inline-formula><mml:math id="inf93"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.016</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-94587-fig3-v2.tif"/></fig><p>In summary, <xref ref-type="disp-formula" rid="equ4 equ5">Equations 4 and 5</xref> entail that assumptions (a) and (b), as formulated above, are satisfied. Using two distinct models to describe the interaction of hosts and pathogens, which both impose a trade-off between the ability to detect different pathogens – namely the Gaussian and the bit-string model – we demonstrate below that HA emerges as a potent force capable of driving the evolution of a very high number of coexisting alleles.</p></sec><sec id="s2-4"><title>Analysis</title><p>To study the evolutionary dynamics of allelic values <inline-formula><mml:math id="inf94"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in both the Gaussian and the bit-string model, we simulate a diploid Wright-Fisher model with mutation and selection (<xref ref-type="bibr" rid="bib25">Fisher, 1930</xref>; <xref ref-type="bibr" rid="bib83">Wright, 1931</xref>). Thus, we consider a diploid population of fixed size <inline-formula><mml:math id="inf95"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi></mml:mstyle></mml:math></inline-formula> with non-overlapping generations and random mating. Individuals produce, independent of their genotype, a large number of offspring, resulting in deterministic Hardy-Weinberg proportions before viability selection. After viability selection, which is based on <xref ref-type="disp-formula" rid="equ5">Equation 5</xref> and adjusts the proportion of genotypes accordingly, stochasticity is introduced by random multinomial sampling of <inline-formula><mml:math id="inf96"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi></mml:mstyle></mml:math></inline-formula> surviving offspring, which constitute the adult population of the next generation. Using this model, we follow the fate of recurrent mutations that occur with a per capita mutation probability <italic>µ</italic>. The long-term evolutionary dynamics is obtained by iterating this procedure (<xref ref-type="fig" rid="fig3">Figure 3</xref>, top panel) until the number of alleles equilibrates. This procedure can result in high numbers of coexisting alleles, where the emerging allelic polymorphism is driven by increasing the alleles’ expected survival (or marginal fitness, see <xref ref-type="disp-formula" rid="equ12 equ14">Equations A5–A6</xref> in Appendix ‘Adaptive dynamics and invasion fitness’).</p><p>For the Gaussian model, mutations are drawn from an isotropic normal distribution with expected mutational effect size <inline-formula><mml:math id="inf97"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>δ</mml:mi></mml:mstyle></mml:math></inline-formula> (Appendix ‘Varying the expected mutational step size in the Gaussian model’). We here focus on mutations of small effect (<inline-formula><mml:math id="inf98"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.016</mml:mn></mml:mstyle></mml:math></inline-formula> in <xref ref-type="fig" rid="fig3">Figure 3</xref> and <inline-formula><mml:math id="inf99"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.03</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> in <xref ref-type="fig" rid="fig4">Figure 4</xref>) and thus near-gradual evolution. The effect of smaller and larger effect sizes is investigated in Appendix ‘Varying the expected mutational step size in the Gaussian model’. To minimise computation time, simulations (other than those in <xref ref-type="fig" rid="fig3">Figure 3</xref>) are initialised at the trait vector that is given by the mean of the vectors describing the pathogens. In the bit-string model, the <inline-formula><mml:math id="inf100"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi></mml:mstyle></mml:math></inline-formula> pathogens are each given <inline-formula><mml:math id="inf101"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> randomly drawn bit-strings at the beginning of a simulation and the host population is initialised with a single MHC-allele given by a randomly drawn bit-string. Mutations change a random bit of the MHC-allele. The bit-string model can indeed only be analysed with computer simulations. In contrast, for the Gaussian model we can analytically derive conditions under which to expect either a single generalist allele or the build-up of allelic diversity through gradual evolution in a process known as evolutionary branching (<xref ref-type="bibr" rid="bib57">Metz et al., 1992</xref>; <xref ref-type="bibr" rid="bib30">Geritz et al., 1998</xref>; <xref ref-type="bibr" rid="bib43">Kisdi and Geritz, 1999</xref>; <xref ref-type="bibr" rid="bib17">Doebeli, 2011</xref>) (see Appendices ‘Mathematical analysis of the Gaussian model: Preliminaries’ and ‘Analytical results for the Gaussian model’ for details).</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Number of coexisting alleles under the Gaussian model for <inline-formula><mml:math id="inf102"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi></mml:mstyle></mml:math></inline-formula> pathogens as a function of pathogen virulence <inline-formula><mml:math id="inf103"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi></mml:mstyle></mml:math></inline-formula> and the survival half-saturation constant <inline-formula><mml:math id="inf104"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi></mml:mstyle></mml:math></inline-formula>.</title><p>Figures are based on a single individual-based simulation per pixel and run for 10<sup>6</sup> generations, assuring that the equilibrium distribution of alleles is reached. Results are reported in terms of the effective number of alleles <inline-formula><mml:math id="inf105"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>, which is a conservative measure for the number of alleles, discounting for rare alleles present at mutation-drift balance (see Appendix ‘Eﬀective number of alleles’). The clear pattern in the figures indicates a high degree of determinism in the simulations. Using population size <inline-formula><mml:math id="inf106"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and per capita mutation probability <inline-formula><mml:math id="inf107"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>−</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, the expected <inline-formula><mml:math id="inf108"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> under mutation-drift balance alone equals 1.2 (see Appendix ‘Eﬀective number of alleles’). Dashed and solid lines give the contours for <inline-formula><mml:math id="inf109"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf110"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, respectively. Red arrows indicate <inline-formula><mml:math id="inf111"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:msqrt><mml:mi>m</mml:mi></mml:msqrt></mml:mrow></mml:mstyle></mml:math></inline-formula>, the threshold for polymorphism to emerge from branching (<xref ref-type="disp-formula" rid="equ57">Equation A46</xref>). Accordingly, simulations in the dark blue area result in a single abundant allele with <inline-formula><mml:math id="inf112"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> close to one. Other parameters: expected mutational step size <inline-formula><mml:math id="inf113"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.03</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-94587-fig4-v2.tif"/></fig></sec></sec><sec id="s3" sec-type="results"><title>Results</title><sec id="s3-1"><title>Gaussian model</title><p>In the simulations of the Gaussian model, the evolutionary dynamics first proceed towards a generalist allele with an intermediate efficiency against all pathogens, to which we refer to as <inline-formula><mml:math id="inf114"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>. This generalist allele maximises the condition <inline-formula><mml:math id="inf115"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>c</mml:mi></mml:mstyle></mml:math></inline-formula> for homozygote genotypes (grey lines and cones in <xref ref-type="fig" rid="fig1">Figure 1</xref>, Appendix ‘Absolute convergence stability’). Once this generalist allele is reached, the evolutionary dynamics either stops (<xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1</xref>), resulting in a population where all individuals are homozygous for <inline-formula><mml:math id="inf116"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, or allelic diversification ensues (<xref ref-type="fig" rid="fig3">Figure 3</xref>), resulting in the coexistence of specialist and generalist alleles. Based on the adaptive dynamics approximation, we show analytically (Appendix ‘The evolutionarily singular point’) that <inline-formula><mml:math id="inf117"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is given by the arithmetic mean of the vectors <inline-formula><mml:math id="inf118"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> describing the <inline-formula><mml:math id="inf119"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi></mml:mstyle></mml:math></inline-formula> pathogen optima (see <xref ref-type="disp-formula" rid="equ35">Equation A26</xref> in Appendix ‘The evolutionarily singular point’) and an attractor of any sequence of allelic substitutions. Whether <inline-formula><mml:math id="inf120"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is an evolutionary stable endpoint or an evolutionary branching point where diversification ensues depends on the covariance matrix <inline-formula><mml:math id="inf121"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>p</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mstyle></mml:math></inline-formula> of the pathogen optima relative to the covariance matrices <inline-formula><mml:math id="inf122"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mstyle></mml:math></inline-formula> of the Gaussian efficiency functions (Appendices ‘Derivation of the Hessian matrix of invasion fitness’, ‘Special case: identically shaped Gaussian efficiency functions’, and ‘Special case: maximal symmetry’). For the special case of identically shaped Gaussian functions, diversification occurs if and only if<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>(Appendix ‘Special case: identically shaped Gaussian efficiency functions’). Note, that this expression is independent of the number of pathogens <inline-formula><mml:math id="inf123"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi></mml:mstyle></mml:math></inline-formula>. Under the additional assumption of equally distant pathogens and isotropic Gaussian functions, these covariance matrices are diagonal matrices with identical diagonal entries <inline-formula><mml:math id="inf124"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>σ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf125"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>σ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>, respectively, and <italic>Condition 6</italic> simplifies to <inline-formula><mml:math id="inf126"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>p</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:math></inline-formula>. When pathogen optima have an equal distance of 1, the variance among the optima <inline-formula><mml:math id="inf127"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>p</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mstyle></mml:math></inline-formula> decreases with an increasing number of pathogens <inline-formula><mml:math id="inf128"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi></mml:mstyle></mml:math></inline-formula>, and the condition for evolutionary branching can be rewritten as<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>2</mml:mn><mml:msqrt><mml:mi>m</mml:mi></mml:msqrt><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf129"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> (Appendix ‘Special case: maximal symmetry’).</p><p><xref ref-type="fig" rid="fig4">Figure 4</xref> presents the final number of coexisting alleles as derived from individual-based simulations. It shows that the number of coexisting alleles increases with the number of pathogens <inline-formula><mml:math id="inf130"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi></mml:mstyle></mml:math></inline-formula> and their virulence <inline-formula><mml:math id="inf131"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi></mml:mstyle></mml:math></inline-formula>, but also depends on the survival half-saturation constant <inline-formula><mml:math id="inf132"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi></mml:mstyle></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ5">Equation 5</xref>). For a large part of the parameter space, more than 100 (solid contour lines in <xref ref-type="fig" rid="fig4">Figure 4</xref>) and up to over 200 alleles can emerge and coexist.</p><p>In order to better understand the process of allelic diversification, it is useful to inspect our analytical results in more detail. Evolutionary diversification occurs if mutant alleles <inline-formula><mml:math id="inf133"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> exist that can invade a population that is monomorphic for the generalist allele <inline-formula><mml:math id="inf134"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula>. Initially, while still rare, such mutant alleles will always occur in heterozygous individuals, where they are paired with the generalist allele. Thus, our condition for evolutionary diversification, <inline-formula><mml:math id="inf135"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>v</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>2</mml:mn><mml:msqrt><mml:mi>m</mml:mi></mml:msqrt></mml:mrow></mml:mstyle></mml:math></inline-formula>, is equivalent to <inline-formula><mml:math id="inf136"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. Since, as homozygotes, the generalist allele maximises condition and therefore survival (Appendix ‘Absolute convergence stability’), we also have <inline-formula><mml:math id="inf137"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. In conclusion, individuals heterozygous for <inline-formula><mml:math id="inf138"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf139"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> have higher survival than either homozygote, <inline-formula><mml:math id="inf140"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, and a polymorphism of these two alleles is maintained by HA, as suggested by <xref ref-type="bibr" rid="bib18">Doherty and Zinkernagel, 1975</xref>. Furthermore, the generalist allele is an evolutionary branching point in the sense of adaptive dynamics theory (<xref ref-type="bibr" rid="bib30">Geritz et al., 1998</xref>; <xref ref-type="bibr" rid="bib43">Kisdi and Geritz, 1999</xref>).</p><p>The left-hand side of the diversification condition given by<xref ref-type="disp-formula" rid="equ7">Equation 7</xref> indicates that invasion of more specialised alleles is favoured when pathogen virulence <inline-formula><mml:math id="inf141"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi></mml:mstyle></mml:math></inline-formula> is large (narrow Gaussian functions, see <xref ref-type="fig" rid="fig1">Figure 1A and C</xref>). In this case, homozygotes for the generalist allele <inline-formula><mml:math id="inf142"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> are relatively poorly protected against pathogens and more specialised alleles enjoy a fitness advantage while invading. The opposite is true when <inline-formula><mml:math id="inf143"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi></mml:mstyle></mml:math></inline-formula> is small (wide Gaussian functions, see <xref ref-type="fig" rid="fig1">Figure 1A and C</xref>). The right-hand side of the diversification criterion indicates that the benefit of specialisation decreases with an increasing number of pathogens (compare position of red arrows in <xref ref-type="fig" rid="fig4">Figure 4</xref>), because different pathogens require different adaptations. Thus, counter to intuition, initial allelic diversification is disfavoured in the presence of many pathogens.</p><p>If initial allelic diversification occurs, it leads to a dimorphism from which new mutant alleles can invade if they are more specialised than the allele from which they originated. Then, two allelic lineages emerge from the generalist allele <inline-formula><mml:math id="inf144"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and subsequently diverge (<xref ref-type="fig" rid="fig3">Figure 3A</xref>, up to <inline-formula><mml:math id="inf145"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> below grey plane). Increasing the difference between the two alleles present in such a dimorphism has two opposing effects. The condition and thereby the survival of the heterozygote genotype increases because the MHC-molecules of the two more specialised alleles provide increasingly better protection against complementary sets of pathogens, i.e., these alleles are subject to a divergent allele advantage (<xref ref-type="bibr" rid="bib80">Wakeland et al., 1990</xref>; <xref ref-type="bibr" rid="bib63">Pierini and Lenz, 2018</xref>). On the other hand, survival of the two homozygote genotypes decreases because they become increasingly more vulnerable to the set of pathogens for which their MHC-molecules do not offer protection. Note that, due to random mating and assuming equal allele frequencies, half of the population are high survival heterozygotes and the remaining half homozygotes with low survival. Since survival is a saturating function of condition <inline-formula><mml:math id="inf146"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>c</mml:mi></mml:mstyle></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ5">Equation 5</xref>), it follows that the increase in survival of heterozygotes slows down with increasing condition (plateau of the orange curves in <xref ref-type="fig" rid="fig3">Figure 3</xref>), and the two opposing forces eventually balance each other such that divergence comes to a halt. At this point, our simulations show that the allelic lineages can branch again, resulting in three coexisting alleles. As a result, the proportion of low survival homozygotes decreases, assuming equal allele frequencies, from one-half to one-third. Subsequently, the coexisting alleles diverge further from each other because the increase in heterozygote survival once again outweighs the decreased survival of the (now less frequent) homozygotes (see <xref ref-type="fig" rid="fig3">Figure 3A</xref>, at time <inline-formula><mml:math id="inf147"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, grey plane). In <xref ref-type="fig" rid="fig3">Figure 3A</xref>, this process of evolutionary branching and allelic divergence repeats itself one more time, resulting in four coexisting alleles. Consequently, 10 genotypes emerge: four homozygotes and six heterozygotes. The homozygotes with specialist alleles have a condition, and thereby a survival, close to zero (two left bars in bottom panel). Conversely, the homozygote for the generalist allele <inline-formula><mml:math id="inf148"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> has an intermediate condition (middle bar), and all heterozygote genotypes have a survival close to 1 (right bar).</p><p>In <xref ref-type="fig" rid="fig3">Figure 3B–D</xref>, the process of evolutionary branching and allelic divergence continues to recur. As a consequence, allelic diversity continues to increase while simultaneously the proportion of vulnerable homozygote genotypes decreases (<xref ref-type="fig" rid="fig3">Figure 3</xref>, lower panel). Thus, in contrast to prior approaches (e.g. <xref ref-type="bibr" rid="bib42">Kimura and Crow, 1964</xref>; <xref ref-type="bibr" rid="bib85">Wright, 1966</xref>; <xref ref-type="bibr" rid="bib51">Lewontin et al., 1978</xref>; <xref ref-type="bibr" rid="bib55">Maruyama and Nei, 1981</xref>), we do not rely on hand-picked genotypic fitness values. Instead, in our approach, fitness values emerge from an eco-evolutionary model where evolution can be viewed as a self-organising process finding large sets of alleles that can coexist (<xref ref-type="fig" rid="fig3">Figure 3</xref>, upper panel).</p><p>We note that the half-saturation constant <inline-formula><mml:math id="inf149"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi></mml:mstyle></mml:math></inline-formula> does not appear in the branching condition and thus does not affect whether polymorphism evolves. However, <inline-formula><mml:math id="inf150"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi></mml:mstyle></mml:math></inline-formula> does affect the final number of alleles, which is maximal for intermediate values of <inline-formula><mml:math id="inf151"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi></mml:mstyle></mml:math></inline-formula>. This can be understood as follows. If <inline-formula><mml:math id="inf152"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi></mml:mstyle></mml:math></inline-formula> is very large (right-hand side of the panels in <xref ref-type="fig" rid="fig4">Figure 4</xref>), then heterozygote survival saturates more slowly with increased allelic divergence so that continued allelic divergence is less counteracted. This hinders repeated branching (compare A and C in <xref ref-type="fig" rid="fig3">Figure 3</xref>). On the other hand, if <inline-formula><mml:math id="inf153"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi></mml:mstyle></mml:math></inline-formula> is very small (left-hand side of the panels in <xref ref-type="fig" rid="fig4">Figure 4</xref>), then homozygous individuals can have high survival, which decreases the selective advantage of specialisation, leading to incomplete specialisation and a reduced number of branching events (compare D and C in <xref ref-type="fig" rid="fig3">Figure 3</xref>).</p><p>In summary, high virulence <inline-formula><mml:math id="inf154"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi></mml:mstyle></mml:math></inline-formula> promotes allelic diversification. Increasing the number of pathogens <inline-formula><mml:math id="inf155"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi></mml:mstyle></mml:math></inline-formula> has a dual effect: it hinders initial diversification but facilitates a higher number of coexisting alleles if diversification occurs, especially, for intermediate values of the half-saturation constant <inline-formula><mml:math id="inf156"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi></mml:mstyle></mml:math></inline-formula>.</p><p>We perform several robustness checks. First, <xref ref-type="fig" rid="app4fig1">Appendix 4—figure 1</xref> shows simulations in which we vary the expected mutational step size. These simulations show that the gradual build-up of diversity occurs most readily as long as the mutational step size is neither very small, since then the evolutionary dynamics becomes exceedingly slow, nor very large, since a large fraction of the mutants are then deleterious and end up outside the simplex made up of the pathogen optima (e.g. outside the triangle made up by the three pathogen optima in <xref ref-type="fig" rid="fig1">Figure 1C and D</xref>) so that they perform worse against all pathogens.</p><p>Second, the results presented in <xref ref-type="fig" rid="fig3">Figures 3</xref> and <xref ref-type="fig" rid="fig4">4</xref> are based on the assumptions of equally spaced pathogen optima and equal width and isotropic Gaussian functions <inline-formula><mml:math id="inf157"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> as shown in <xref ref-type="fig" rid="fig1">Figure 1</xref>. In Appendices <italic>‘</italic>Analytical results for the Gaussian model’ and ‘Deviations from symmetry in the Gaussian model’, we present analytical and simulation results, respectively, for the non-symmetric case. In particular, <xref ref-type="fig" rid="app5fig1">Appendix 5—figure 1</xref> shows that the predictions for the number of coexisting alleles presented here are qualitatively robust against deviations from symmetry. This is in line with <italic>Condition 6</italic> and its simplification under full symmetry, <inline-formula><mml:math id="inf158"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>p</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">G</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:math></inline-formula>, showing that the more general condition for the evolution of allelic polymorphism is structurally identical to the condition under full symmetry.</p></sec><sec id="s3-2"><title>Bit-string model</title><p>Evolutionary diversification of MHC-alleles in the bit-string model is analysed with individual-based simulations, and the results are summarised in <xref ref-type="fig" rid="fig5">Figure 5</xref>. Similar to the Gaussian model, we find high levels of allelic polymorphism, with over 100 alleles coexisting in a significant portion of the parameter space. Note that we here keep the half-saturation constant <inline-formula><mml:math id="inf159"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi></mml:mstyle></mml:math></inline-formula> fixed at 1. With this choice, the realised conditions occur both in the range where survival changes drastically with condition and where the survival function saturates (<xref ref-type="fig" rid="fig6">Figure 6</xref>), fulfilling assumption (b). This allows us to focus on the effect of the number of peptides <inline-formula><mml:math id="inf160"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> per pathogen.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Number of coexisting alleles for the bit-string model for four values of virulence <inline-formula><mml:math id="inf161"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi></mml:mstyle></mml:math></inline-formula> as a function of the number of pathogens <inline-formula><mml:math id="inf162"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi></mml:mstyle></mml:math></inline-formula> (increased in steps of 7) and the number of peptides per pathogen <inline-formula><mml:math id="inf163"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>.</title><p>Figures are based on a single individual-based simulation per pixel and run for 10<sup>6</sup> generations. Results are reported in terms of the effective number of alleles <inline-formula><mml:math id="inf164"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>, which discounts for rare alleles present at mutation-drift balance (see Appendix ‘Eﬀective number of alleles’). Using population size <inline-formula><mml:math id="inf165"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and per capita mutation probability <inline-formula><mml:math id="inf166"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, the expected <inline-formula><mml:math id="inf167"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> under mutation-drift balance alone equals 3. Dashed and solid lines give the contours for <inline-formula><mml:math id="inf168"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf169"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mstyle></mml:math></inline-formula>, respectively. Evolution started from populations monomorphic for a random allele, and run for <inline-formula><mml:math id="inf170"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> generations, assuring that the equilibrium distribution of alleles is reached. Other parameters: half-saturation constant <inline-formula><mml:math id="inf171"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-94587-fig5-v2.tif"/></fig><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>A simulation run showing the evolution of allelic diversity under the bit-string model in the presence of <inline-formula><mml:math id="inf172"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>12</mml:mn></mml:mstyle></mml:math></inline-formula> pathogens.</title><p>(<bold>A</bold>) shows the number of alleles <inline-formula><mml:math id="inf173"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi></mml:mstyle></mml:math></inline-formula> and the effective number of alleles <inline-formula><mml:math id="inf174"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> as a function of time (on a log-log scale). (<bold>B–D</bold>) give survival <inline-formula><mml:math id="inf175"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>s</mml:mi></mml:mstyle></mml:math></inline-formula> as a function of condition <inline-formula><mml:math id="inf176"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>c</mml:mi></mml:mstyle></mml:math></inline-formula> as defined by <xref ref-type="disp-formula" rid="equ5">Equation 5</xref> on a log-log scale (orange line, left vertical axis) and the distribution of conditions at three time points (<bold>B</bold> <inline-formula><mml:math id="inf177"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mstyle></mml:math></inline-formula>, <bold>C</bold> <inline-formula><mml:math id="inf178"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>3900</mml:mn></mml:mstyle></mml:math></inline-formula>, <bold>D</bold> <inline-formula><mml:math id="inf179"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula>; vertical green dashed lines in <bold>A</bold>), with dark blue bars for homozygotes and light blue bars for heterozygotes (right vertical axis; conditions from 0 to <inline-formula><mml:math id="inf180"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> are incorporated into the first bar, and conditions from 10<sup>4</sup> and greater are incorporated in the last bar). This shows that as allelic diversity increases, the frequency of homozygotes with low survival decreases. The black dashed lines indicate the value of <inline-formula><mml:math id="inf181"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula>. Other parameter values: <inline-formula><mml:math id="inf182"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>7</mml:mn></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf183"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>12</mml:mn></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf184"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf185"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf186"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-94587-fig6-v2.tif"/></fig><p>Our results can be understood as follows. The likelihood that an MHC-molecule can recognise all pathogens is high in the following regions of the parameter space. Firstly, if virulence <inline-formula><mml:math id="inf187"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi></mml:mstyle></mml:math></inline-formula> is low, then peptide recognition is more likely (<xref ref-type="disp-formula" rid="equ2">Equation 2</xref>). Secondly, if the number of pathogens <inline-formula><mml:math id="inf188"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi></mml:mstyle></mml:math></inline-formula> is low, then detection of all pathogens is a simpler task. Thirdly, if the number of peptides <inline-formula><mml:math id="inf189"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> per pathogen is high, then the potential for successful pathogen detection increases (<xref ref-type="disp-formula" rid="equ3">Equation 3</xref>). Although our model is not sufficiently mechanistic to be directly related to parameters observed in nature, it suggests that when pathogens have a high number of peptides, maintaining allelic polymorphism requires a larger number of pathogens under conditions of low virulence (<inline-formula><mml:math id="inf190"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi><mml:mo>≤</mml:mo><mml:mn>7</mml:mn></mml:mstyle></mml:math></inline-formula>). For higher virulence (<inline-formula><mml:math id="inf191"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi><mml:mo>≥</mml:mo><mml:mn>9</mml:mn></mml:mstyle></mml:math></inline-formula>), the effect of <inline-formula><mml:math id="inf192"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> weakens, and allelic polymorphism evolves seemingly independent of the number of pathogens. Each of these three circumstances facilitates the existence of a single best allele whose MHC-molecule recognises all pathogens with a high probability (dark blue regions in <xref ref-type="fig" rid="fig5">Figure 5</xref>).</p><p>As virulence or the number of pathogens increases, or as the number of peptides decreases, the task of recognising all pathogens with high probability becomes progressively more challenging. This leaves homozygous individuals vulnerable to an increasing array of pathogens. As homozygotes get more vulnerable, there is a growing advantage for heterozygotes carrying alleles with complementary immune profiles, as these are able to detect up to twice as many pathogens as either homozygote. This increasingly stronger HA, in turn, facilitates coexistence of an increasing number of alleles, illustrated by increasingly warmer colours in <xref ref-type="fig" rid="fig5">Figure 5</xref>, and thereby decreases the proportion of vulnerable homozygotes. Thus, similar to the Gaussian model, increasing either the virulence <inline-formula><mml:math id="inf193"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi></mml:mstyle></mml:math></inline-formula> or the number of pathogens <inline-formula><mml:math id="inf194"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi></mml:mstyle></mml:math></inline-formula> enables a higher number of alleles to coexist. However, unlike the Gaussian model, increasing <inline-formula><mml:math id="inf195"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi></mml:mstyle></mml:math></inline-formula> actually facilitates initial diversification rather than hindering it.</p><p>Importantly, in the bit-string model, a point mutation, switching the value of an arbitrary bit in the bit-string, can drastically alter the efficiencies against a large set of pathogens. Because of this, and in contrast to the Gaussian model, a polymorphism maintained by HA can emerge from many different alleles. On the other hand, gradual evolution in the Gaussian model is more efficient in finding the evolutionary endpoint of complementary alleles (<xref ref-type="fig" rid="fig3">Figure 3</xref>), while for the bit-string model, as the number of alleles increases, this becomes slower due to the lack of fine-tuning as mutations have large effect. To compensate for this, we use, compared to the Gaussian model, a higher mutation probability <italic>µ</italic> and run simulations for more generations.</p><p><xref ref-type="fig" rid="fig6">Figure 6A</xref> shows the build-up of allelic diversity over time in an exemplary simulation run, and <xref ref-type="fig" rid="fig6">Figure 6B–D</xref> show the distribution of condition values at three time points, as indicated by green hatched lines in <xref ref-type="fig" rid="fig6">Figure 6A</xref>. In <xref ref-type="fig" rid="fig6">Figure 6B</xref> the population is dimorphic. Due to random mating, half of the population consists of homozygotes with low condition (dark blue bar), while the remaining half are heterozygotes with high condition (light blue bar). As time proceeds, the number of coexisting alleles increases. <xref ref-type="fig" rid="fig6">Figure 6C</xref> depicts a stage with five coexisting alleles (with at least 1% frequency) and an effective number of alleles (<inline-formula><mml:math id="inf196"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>) of 4.4. Ultimately, evolution results in 19 coexisting alleles (with at least 1% frequency), and an <inline-formula><mml:math id="inf197"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> of 16.1, as shown in <xref ref-type="fig" rid="fig6">Figure 6D</xref>. In this process, the number of low condition homozygotes decreases, as indicated by the dark blue bars.</p></sec></sec><sec id="s4" sec-type="discussion"><title>Discussion</title><p>HA as an explanation for the coexistence of a large number of alleles at a single locus has a long history in evolutionary genetics. <xref ref-type="bibr" rid="bib42">Kimura and Crow, 1964</xref>, and subsequently <xref ref-type="bibr" rid="bib85">Wright, 1966</xref> showed that HA can in principle result in the coexistence of an arbitrary number of alleles at a single locus if two conditions are met: (1) all heterozygotes have a similarly high fitness, and (2) all homozygotes have a similarly low fitness. One special class of genes fulfilling these assumptions occur at self-incompatibility loci, where mating partners need to carry different alleles for fertilisation to be successful (<xref ref-type="bibr" rid="bib84">Wright, 1939</xref>; <xref ref-type="bibr" rid="bib8">Castric and Vekemans, 2004</xref>), or loci where homozygosity is lethal (<xref ref-type="bibr" rid="bib16">Ding et al., 2021</xref>). However, more generally these conditions were deemed unrealistic by Kimura, Crow, and Wright themselves. This assessment was subsequently confirmed by <xref ref-type="bibr" rid="bib51">Lewontin et al., 1978</xref>, who investigated a model in which the exact fitnesses are determined by drawing random numbers in a manner that all heterozygotes are more fit than all homozygotes. They found that the proportion of fitness arrays that leads to a stable equilibrium of more than six or seven alleles is vanishingly small. Similarly, the idea that the high allelic diversity found at MHC loci can be explained by HA was initially accepted by theoreticians (e.g. <xref ref-type="bibr" rid="bib55">Maruyama and Nei, 1981</xref>; <xref ref-type="bibr" rid="bib76">Takahata and Nei, 1990</xref>), but several later authors studying models based on more mechanistic assumptions were unable to reliably predict the coexistence of significantly more than 10 alleles (<xref ref-type="bibr" rid="bib72">Spencer and Marks, 1988</xref>; <xref ref-type="bibr" rid="bib35">Hedrick, 2002</xref>; <xref ref-type="bibr" rid="bib13">De Boer et al., 2004</xref>; <xref ref-type="bibr" rid="bib7">Borghans et al., 2004</xref>; <xref ref-type="bibr" rid="bib75">Stoffels and Spencer, 2008</xref>; <xref ref-type="bibr" rid="bib78">Trotter and Spencer, 2008</xref>; <xref ref-type="bibr" rid="bib79">Trotter and Spencer, 2013</xref>; <xref ref-type="bibr" rid="bib23">Ejsmond and Radwan, 2015</xref>; <xref ref-type="bibr" rid="bib46">Lau et al., 2015</xref>). Thus, currently HA is largely dismissed as an explanation for highly polymorphic loci (<xref ref-type="bibr" rid="bib33">Gould et al., 2004</xref>; <xref ref-type="bibr" rid="bib21">Eizaguirre and Lenz, 2010</xref>; <xref ref-type="bibr" rid="bib49">Lenz, 2011</xref>; <xref ref-type="bibr" rid="bib36">Hedrick, 2012</xref>).</p><p>Our study, while not meant to be a highly realistic mechanistic representations of the interaction between MHC genes and pathogens, serves as a proof of principle that a high number of alleles, matching those found at MHC loci in natural populations, can indeed arise in an evolutionary process driven by HA. Our results thus revive the idea that HA has the potential to explain extraordinary allelic diversity. Importantly, and in contrast to several of the above-mentioned studies, this is achieved without making direct assumptions about homozygote and heterozygote fitnesses. Instead, our results emerge from two assumptions about how pathogens affect a host’s condition and how this, in turn, affect survival. Assumption (a) states that pathogens are lethal in the absence of an appropriate immune response. This assumption is implemented in our model by assuming that each pathogen decreases a host’s condition in a proportional manner (<xref ref-type="disp-formula" rid="equ4">Equation 4</xref>), rather than by a fixed amount. Assumption (b) states that the effect of pathogens depends on host condition, with hosts in poorer condition being affected more strongly. Then, the combined effect of multiple pathogens on host survival exceeds the sum of the effects of each pathogen alone. Thus, many pathogens against which a host has an imperfect immune response can collectively push a host’s condition below a threshold where mortality becomes rather high (orange lines in <xref ref-type="fig" rid="fig3">Figures 3</xref> and <xref ref-type="fig" rid="fig6">6</xref>). In our model, this assumption is fulfilled rather naturally. Since the probability to survive can logically not exceed 1, the function that maps condition to survival has to be saturating (<xref ref-type="disp-formula" rid="equ5">Equation 5</xref>).</p><p>In the following, we detail how assumptions (a) and (b) can result in the emergence of well over 100 alleles such that heterozygotes have similarly high fitness (condition (1) of Kimura and Crow) and homozygotes have similarly low fitness (condition (2) of Kimura and Crow). We start with the observation that the survival probabilities in evolved polymorphic populations vary between individuals (lower panels in <xref ref-type="fig" rid="fig4">Figures 4</xref> and <xref ref-type="fig" rid="fig5">5B–D</xref>). Part of the population consists of individuals that have very low survival probabilities. These are individuals with a condition value considerably less than <inline-formula><mml:math id="inf198"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi></mml:mstyle></mml:math></inline-formula> and they are almost exclusively homozygotes. This is because, whenever polymorphism is favoured, homozygotes are poorly defended against some pathogens and the fact that pathogens affect condition multiplicatively (<xref ref-type="disp-formula" rid="equ4">Equation 4</xref>). The remaining part of the population consists of individuals with condition values considerably above <inline-formula><mml:math id="inf199"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi></mml:mstyle></mml:math></inline-formula>. Although the condition of these individuals can differ by several orders of magnitude, their survival is close to 1, which results from the fact that the function that maps condition to survival is saturating. These individuals are almost exclusively heterozygotes. This is because alleles that protect against complementary sets of pathogens, when paired together, offer at least a decent protection against all pathogens. In summary, our assumptions (a) and (b) lead to a set of alleles such that their survival probabilities fall into two clusters as required for conditions (1) and (2) of <xref ref-type="bibr" rid="bib42">Kimura and Crow, 1964</xref> to be fulfilled. The larger the number of alleles, the lower becomes the proportion of vulnerable homozygotes, and the population consists increasingly of almost equally fit heterozygotes.</p><p><xref ref-type="bibr" rid="bib7">Borghans et al., 2004</xref> use a bit-string model similar to ours with <inline-formula><mml:math id="inf200"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> pathogens, <inline-formula><mml:math id="inf201"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> peptides, a virulence of <inline-formula><mml:math id="inf202"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and a step function for the probability that an MHC-molecule detects a peptide (<inline-formula><mml:math id="inf203"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>a</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mstyle></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>). In contrast to our model, they assume that an individual’s condition equals the proportion of detected pathogens, meaning that each pathogen can reduce fitness by only 2% (thereby not fulfilling our assumption a). Additionally, they assume that survival is proportional to the squared condition (not fulfilling our assumption b). <xref ref-type="fig" rid="app6fig1">Appendix 6—figure 1</xref> shows a run of our bit-string model with the parameter values used by <xref ref-type="bibr" rid="bib7">Borghans et al., 2004</xref>, resulting in more than 100 coexisting alleles. In contrast, they find only up to seven coexisting alleles, demonstrating that assumptions (a) and (b) in our model drive the high number of coexisting alleles found by us.</p><p>Currently, there are several mechanisms proposed to explain the diversity observed at MHC loci. First, in the presence of an HA, each allele has an advantage when rare because it almost always occurs in heterozygotes. Thus, there is negative frequency-dependent selection acting at the level of the allele. In addition, negative frequency-dependent selection can arise from, for example, Red-Queen dynamics, fluctuating selection, and disassortative mating (<xref ref-type="bibr" rid="bib6">Apanius et al., 1997</xref>; <xref ref-type="bibr" rid="bib34">Hedrick, 1998</xref>; <xref ref-type="bibr" rid="bib61">Penn, 2002</xref>; <xref ref-type="bibr" rid="bib7">Borghans et al., 2004</xref>; <xref ref-type="bibr" rid="bib81">Wegner, 2008</xref>; <xref ref-type="bibr" rid="bib73">Spurgin and Richardson, 2010</xref>; <xref ref-type="bibr" rid="bib54">Loiseau et al., 2011</xref>; <xref ref-type="bibr" rid="bib23">Ejsmond and Radwan, 2015</xref>; <xref ref-type="bibr" rid="bib52">Lighten et al., 2017</xref>; <xref ref-type="bibr" rid="bib24">Ejsmond et al., 2023</xref>). These mechanisms are similar to HA in the sense that the selective advantage of an allele increases with decreasing frequency. However, they do not result in heterozygotes being more fit than the homozygotes carrying the rare allele. In addition, neutral diversity can be enhanced by recombination (<xref ref-type="bibr" rid="bib44">Klitz et al., 2012</xref>; <xref ref-type="bibr" rid="bib53">Linnenbrink et al., 2018</xref>; <xref ref-type="bibr" rid="bib66">Robinson et al., 2017</xref>). If many individuals are heterozygous, the particularly high levels of gene conversion found at MHC genes can be effective in creating new allelic variants. For instance, for urban human populations with a large effective population size of <inline-formula><mml:math id="inf204"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and a per capita gene conversion probability of <inline-formula><mml:math id="inf205"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> an effective number of alleles as high as <inline-formula><mml:math id="inf206"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:mi>r</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>401</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> can theoretically be maintained by gene conversion (<xref ref-type="bibr" rid="bib44">Klitz et al., 2012</xref>). However, it is important to point out that for gene conversion to increase allelic diversity, some genetic polymorphism due to balancing selection has to exist to start with. We do not claim that the mechanisms listed here do not play an important role in maintaining allelic diversity at MHC loci. Rather, our results show that, contrary to the currently widespread view, HA should not be dismissed as a potent force. In any real system, different mechanisms will jointly affect allelic diversity. For instance, <xref ref-type="bibr" rid="bib52">Lighten et al., 2017</xref> present a model in which, for Red-Queen co-evolution to maintain allelic polymorphism, HA in the form of a divergent allele advantage (<xref ref-type="bibr" rid="bib80">Wakeland et al., 1990</xref>) seems to be a necessary ingredient. Similarly, <xref ref-type="bibr" rid="bib7">Borghans et al., 2004</xref> show that pathogen co-evolution can further increase the number of coexisting alleles compared to HA alone.</p><p>The aim of our study is to understand how HA on its own can result in allelic polymorphism. For this reason, we kept all aspects concerning pathogens fixed, focusing on a scenario where pathogen optima represent diverse taxonomic groups that remain approximately constant over the time scales considered in our model. This approach excludes Red-Queen dynamics and fluctuating selection. Models of Red-Queen dynamics are based that pathogens evolve to avoid detection by the host’s immune system (<xref ref-type="bibr" rid="bib7">Borghans et al., 2004</xref>; <xref ref-type="bibr" rid="bib23">Ejsmond and Radwan, 2015</xref>; <xref ref-type="bibr" rid="bib24">Ejsmond et al., 2023</xref>). In our model, this would correspond to moving pathogen optima (in the Gaussian model) or changes in the pathogen peptides (in the bit-string model). We expect that incorporating this would hamper the build-up of allelic MHC diversity when driven solely by HA if pathogens evolve quickly. Alleles previously maintained as beneficial would then become disadvantageous and go extinct more rapidly than new advantageous alleles can appear.</p><p>Another component of pathogens that can evolve in response to host immune defence is their virulence (<xref ref-type="bibr" rid="bib27">Frank and Schmid-Hempel, 2008</xref>). The transmission-virulence trade-off hypothesis (<xref ref-type="bibr" rid="bib5">Anderson and May, 1982</xref>; <xref ref-type="bibr" rid="bib26">Frank, 1996</xref>; <xref ref-type="bibr" rid="bib3">Alizon et al., 2009</xref>) predicts that pathogens that cause relatively little harm to their host (i.e. pathogens with low virulence) may evolve towards higher virulence to increase their transmission rate. In line with this hypothesis, we speculate that incorporating virulence evolution leads to higher virulence whenever pathogens inflict little harm on their hosts. This scenario applies in the dark blue parameter regions in <xref ref-type="fig" rid="fig4">Figures 4</xref> and <xref ref-type="fig" rid="fig5">5</xref>, where host populations possess a single effective generalist allele. In these regions, the evolution of increased virulence would shift pathogens into parameter regions where allelic polymorphism becomes adaptive. The ensuing build-up of allelic polymorphism decreases the harm inflicted by pathogens through HA, which, in turn, increases the selection pressure acting on pathogens for an even further increase in virulence. This suggests, in contrast to evolving pathogen optima, a positive feedback loop between virulence evolution and the evolution of allelic diversity.</p><p>Our Gaussian model is not restricted to MHC genes, but can apply to any gene that affects several functions important for survival. Examples are genes that are expressed in different ontogenetic stages or different tissues with competing demands on the optimal gene product. However, gene duplication is expected to reduce the potential number of coexisting alleles per locus and eventually lead to a situation where the number of duplicates equals the number of functions (<xref ref-type="bibr" rid="bib65">Proulx and Phillips, 2006</xref>). Under this scenario, the high degree of polymorphism reported here would be transient. However, for MHC genes evidence exist that other forces limit the number of MHC loci (<xref ref-type="bibr" rid="bib61">Penn, 2002</xref>; <xref ref-type="bibr" rid="bib81">Wegner, 2008</xref>; <xref ref-type="bibr" rid="bib21">Eizaguirre and Lenz, 2010</xref>; <xref ref-type="bibr" rid="bib73">Spurgin and Richardson, 2010</xref>). But it is important to point out that, while our model focuses on evolution at a single MHC locus, many vertebrates have more than one MHC locus with similar functions (<xref ref-type="bibr" rid="bib81">Wegner, 2008</xref>; <xref ref-type="bibr" rid="bib21">Eizaguirre and Lenz, 2010</xref>; <xref ref-type="bibr" rid="bib73">Spurgin and Richardson, 2010</xref>). The diversity generating mechanism described here still applies if the different loci are responsible for largely non-overlapping sets of pathogens, indicating that the mechanism presented here can in principle explain the high number of coexisting MHC-alleles.</p><p>In summary, our research offers a fresh view that can help us to understand allelic diversity at MHC loci. We identify two crucial assumptions related to pathogen-host interactions, under which we show that HA emerges as a potent force capable of driving the evolution of a very high number of coexisting alleles.</p></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Formal analysis, Visualization, Methodology, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Supervision, Funding acquisition, Methodology, Writing – original draft, Writing – review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-94587-mdarchecklist1-v2.pdf" mimetype="application" mime-subtype="pdf"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>All data presented and analysed in this study were generated through individual based simulations using Matlab, with code authored by the first author. The corresponding Matlab script is available at Dryad with DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5061/dryad.69p8cz98j">https://doi.org/10.5061/dryad.69p8cz98j</ext-link>.</p><p>The following dataset was generated:</p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset1"><person-group person-group-type="author"><name><surname>Siljestam</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>Heterozygote advantage can explain the extraordinary diversity of immune genes</data-title><source>Dryad Digital Repository</source><pub-id pub-id-type="doi">10.5061/dryad.69p8cz98j</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>We thank Yvonne Meyer-Lucht and Tobias Lenz for helpful discussions and Göran Arnqvist, Helena Westerdahl, Joachim Hermisson, and Sophie Karrenberg for comments on an earlier version of the manuscript.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Abbas</surname><given-names>AK</given-names></name><name><surname>Lichtman</surname><given-names>AH</given-names></name><name><surname>Pillai</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2014">2014</year><source>Basic Immunology: Functions and Disorders of the Immune System</source><publisher-name>Elsevier Health Sciences</publisher-name></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abrams</surname><given-names>PA</given-names></name><name><surname>Matsuda</surname><given-names>H</given-names></name><name><surname>Harada</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Evolutionarily unstable fitness maxima and stable fitness minima of continuous traits</article-title><source>Evolutionary Ecology</source><volume>7</volume><fpage>465</fpage><lpage>487</lpage><pub-id pub-id-type="doi">10.1007/BF01237642</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alizon</surname><given-names>S</given-names></name><name><surname>Hurford</surname><given-names>A</given-names></name><name><surname>Mideo</surname><given-names>N</given-names></name><name><surname>Van Baalen</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Virulence evolution and the trade-off hypothesis: history, current state of affairs and the future</article-title><source>Journal of Evolutionary Biology</source><volume>22</volume><fpage>245</fpage><lpage>259</lpage><pub-id pub-id-type="doi">10.1111/j.1420-9101.2008.01658.x</pub-id><pub-id pub-id-type="pmid">19196383</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Allison</surname><given-names>AC</given-names></name></person-group><year iso-8601-date="1954">1954</year><article-title>Protection afforded by sickle-cell trait against subtertian malareal infection</article-title><source>British Medical Journal</source><volume>1</volume><fpage>290</fpage><lpage>294</lpage><pub-id pub-id-type="doi">10.1136/bmj.1.4857.290</pub-id><pub-id pub-id-type="pmid">13115700</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anderson</surname><given-names>RM</given-names></name><name><surname>May</surname><given-names>RM</given-names></name></person-group><year iso-8601-date="1982">1982</year><article-title>Coevolution of hosts and parasites</article-title><source>Parasitology</source><volume>85</volume><fpage>411</fpage><lpage>426</lpage><pub-id pub-id-type="doi">10.1017/S0031182000055360</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Apanius</surname><given-names>V</given-names></name><name><surname>Penn</surname><given-names>D</given-names></name><name><surname>Slev</surname><given-names>PR</given-names></name><name><surname>Ruff</surname><given-names>LR</given-names></name><name><surname>Potts</surname><given-names>WK</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>The nature of selection on the major histocompatibility complex</article-title><source>Immunology</source><volume>17</volume><fpage>179</fpage><lpage>224</lpage><pub-id pub-id-type="doi">10.1615/CritRevImmunol.v17.i2.40</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Borghans</surname><given-names>JAM</given-names></name><name><surname>Beltman</surname><given-names>JB</given-names></name><name><surname>De Boer</surname><given-names>RJ</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>MHC polymorphism under host-pathogen coevolution</article-title><source>Immunogenetics</source><volume>55</volume><fpage>732</fpage><lpage>739</lpage><pub-id pub-id-type="doi">10.1007/s00251-003-0630-5</pub-id><pub-id pub-id-type="pmid">14722687</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Castric</surname><given-names>V</given-names></name><name><surname>Vekemans</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Plant self-incompatibility in natural populations: a critical assessment of recent theoretical and empirical advances</article-title><source>Molecular Ecology</source><volume>13</volume><fpage>2873</fpage><lpage>2889</lpage><pub-id pub-id-type="doi">10.1111/j.1365-294X.2004.02267.x</pub-id><pub-id pub-id-type="pmid">15367105</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Champagnat</surname><given-names>N</given-names></name><name><surname>Ferrière</surname><given-names>R</given-names></name><name><surname>Méléard</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Unifying evolutionary dynamics: From individual stochastic processes to macroscopic models</article-title><source>Theoretical Population Biology</source><volume>69</volume><fpage>297</fpage><lpage>321</lpage><pub-id pub-id-type="doi">10.1016/j.tpb.2005.10.004</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chappell</surname><given-names>P</given-names></name><name><surname>Meziane</surname><given-names>EK</given-names></name><name><surname>Harrison</surname><given-names>M</given-names></name><name><surname>Magiera</surname><given-names>Ł</given-names></name><name><surname>Hermann</surname><given-names>C</given-names></name><name><surname>Mears</surname><given-names>L</given-names></name><name><surname>Wrobel</surname><given-names>AG</given-names></name><name><surname>Durant</surname><given-names>C</given-names></name><name><surname>Nielsen</surname><given-names>LL</given-names></name><name><surname>Buus</surname><given-names>S</given-names></name><name><surname>Ternette</surname><given-names>N</given-names></name><name><surname>Mwangi</surname><given-names>W</given-names></name><name><surname>Butter</surname><given-names>C</given-names></name><name><surname>Nair</surname><given-names>V</given-names></name><name><surname>Ahyee</surname><given-names>T</given-names></name><name><surname>Duggleby</surname><given-names>R</given-names></name><name><surname>Madrigal</surname><given-names>A</given-names></name><name><surname>Roversi</surname><given-names>P</given-names></name><name><surname>Lea</surname><given-names>SM</given-names></name><name><surname>Kaufman</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Expression levels of MHC class I molecules are inversely correlated with promiscuity of peptide binding</article-title><source>eLife</source><volume>4</volume><elocation-id>e05345</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.05345</pub-id><pub-id pub-id-type="pmid">25860507</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cortazar Chinarro</surname><given-names>M</given-names></name><name><surname>Meurling</surname><given-names>S</given-names></name><name><surname>Schroyens</surname><given-names>L</given-names></name><name><surname>Siljestam</surname><given-names>M</given-names></name><name><surname>Richter-Boix</surname><given-names>A</given-names></name><name><surname>Laurila</surname><given-names>A</given-names></name><name><surname>Höglund</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Major histocompatibility complex variation and haplotype associated survival in response to experimental infection of two Bd-GPL strains along a latitudinal gradient</article-title><source>Frontiers in Ecology and Evolution</source><volume>10</volume><elocation-id>915271</elocation-id><pub-id pub-id-type="doi">10.3389/fevo.2022.915271</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Débarre</surname><given-names>F</given-names></name><name><surname>Nuismer</surname><given-names>SL</given-names></name><name><surname>Doebeli</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Multidimensional (co) evolutionary stability</article-title><source>The American Naturalist</source><volume>184</volume><fpage>158</fpage><lpage>171</lpage><pub-id pub-id-type="doi">10.1086/677137</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Boer</surname><given-names>RJ</given-names></name><name><surname>Borghans</surname><given-names>JAM</given-names></name><name><surname>van Boven</surname><given-names>M</given-names></name><name><surname>Keşmir</surname><given-names>C</given-names></name><name><surname>Weissing</surname><given-names>FJ</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Heterozygote advantage fails to explain the high degree of polymorphism of the MHC</article-title><source>Immunogenetics</source><volume>55</volume><fpage>725</fpage><lpage>731</lpage><pub-id pub-id-type="doi">10.1007/s00251-003-0629-y</pub-id><pub-id pub-id-type="pmid">14722686</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Dercole</surname><given-names>F</given-names></name><name><surname>Rinaldi</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2008">2008</year><source>Analysis of Evolutionary Processes: The Adaptive Dynamics Approach and Its Applications</source><publisher-name>Princeton University Press</publisher-name><pub-id pub-id-type="doi">10.1515/9781400828340</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dieckmann</surname><given-names>U</given-names></name><name><surname>Law</surname><given-names>R</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>The dynamical theory of coevolution: a derivation from stochastic ecological processes</article-title><source>Journal of Mathematical Biology</source><volume>34</volume><fpage>579</fpage><lpage>612</lpage><pub-id pub-id-type="doi">10.1007/BF02409751</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ding</surname><given-names>G</given-names></name><name><surname>Hasselmann</surname><given-names>M</given-names></name><name><surname>Huang</surname><given-names>J</given-names></name><name><surname>Roberts</surname><given-names>J</given-names></name><name><surname>Oldroyd</surname><given-names>BP</given-names></name><name><surname>Gloag</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Global allele polymorphism indicates a high rate of allele genesis at a locus under balancing selection</article-title><source>Heredity</source><volume>126</volume><fpage>163</fpage><lpage>177</lpage><pub-id pub-id-type="doi">10.1038/s41437-020-00358-w</pub-id><pub-id pub-id-type="pmid">32855546</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Doebeli</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><source>Adaptive Diversification MPB-48</source><publisher-name>Princeton University Press</publisher-name><pub-id pub-id-type="doi">10.23943/princeton/9780691128931.001.0001</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doherty</surname><given-names>PC</given-names></name><name><surname>Zinkernagel</surname><given-names>RM</given-names></name></person-group><year iso-8601-date="1975">1975</year><article-title>Enhanced immunological surveillance in mice heterozygous at the H-2 gene complex</article-title><source>Nature</source><volume>256</volume><fpage>50</fpage><lpage>52</lpage><pub-id pub-id-type="doi">10.1038/256050a0</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duncan</surname><given-names>WR</given-names></name><name><surname>Wakeland</surname><given-names>EK</given-names></name><name><surname>Klein</surname><given-names>J</given-names></name></person-group><year iso-8601-date="1979">1979</year><article-title>Histocompatibility-2 system in wild mice</article-title><source>Immunogenetics</source><volume>9</volume><fpage>261</fpage><lpage>272</lpage><pub-id pub-id-type="doi">10.1007/BF01570420</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Durinx</surname><given-names>M</given-names></name><name><surname>(Hans) Metz</surname><given-names>JAJ</given-names></name><name><surname>Meszéna</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Adaptive dynamics for physiologically structured population models</article-title><source>Journal of Mathematical Biology</source><volume>56</volume><fpage>673</fpage><lpage>742</lpage><pub-id pub-id-type="doi">10.1007/s00285-007-0134-2</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eizaguirre</surname><given-names>C</given-names></name><name><surname>Lenz</surname><given-names>TL</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Major histocompatibility complex polymorphism: dynamics and consequences of parasite-mediated local adaptation in fishes</article-title><source>Journal of Fish Biology</source><volume>77</volume><fpage>2023</fpage><lpage>2047</lpage><pub-id pub-id-type="doi">10.1111/j.1095-8649.2010.02819.x</pub-id><pub-id pub-id-type="pmid">21133915</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eizaguirre</surname><given-names>C</given-names></name><name><surname>Lenz</surname><given-names>TL</given-names></name><name><surname>Kalbe</surname><given-names>M</given-names></name><name><surname>Milinski</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Divergent selection on locally adapted major histocompatibility complex immune genes experimentally proven in the field</article-title><source>Ecology Letters</source><volume>15</volume><fpage>723</fpage><lpage>731</lpage><pub-id pub-id-type="doi">10.1111/j.1461-0248.2012.01791.x</pub-id><pub-id pub-id-type="pmid">22583762</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ejsmond</surname><given-names>MJ</given-names></name><name><surname>Radwan</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Red queen processes drive positive selection on major histocompatibility complex (MHC) genes</article-title><source>PLOS Computational Biology</source><volume>11</volume><elocation-id>e1004627</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004627</pub-id><pub-id pub-id-type="pmid">26599213</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ejsmond</surname><given-names>MJ</given-names></name><name><surname>Radwan</surname><given-names>J</given-names></name><name><surname>Ejsmond</surname><given-names>A</given-names></name><name><surname>Gaczorek</surname><given-names>T</given-names></name><name><surname>Babik</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Adaptive immune response selects for postponed maturation and increased body size</article-title><source>Functional Ecology</source><volume>37</volume><fpage>2883</fpage><lpage>2894</lpage><pub-id pub-id-type="doi">10.1111/1365-2435.14416</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Fisher</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="1930">1930</year><source>The Genetical Theory of Natural Selection</source><publisher-name>Oxford University Press</publisher-name><pub-id pub-id-type="doi">10.5962/bhl.title.27468</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frank</surname><given-names>SA</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Models of parasite virulence</article-title><source>The Quarterly Review of Biology</source><volume>71</volume><fpage>37</fpage><lpage>78</lpage><pub-id pub-id-type="doi">10.1086/419267</pub-id><pub-id pub-id-type="pmid">8919665</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frank</surname><given-names>SA</given-names></name><name><surname>Schmid-Hempel</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Mechanisms of pathogenesis and the evolution of parasite virulence</article-title><source>Journal of Evolutionary Biology</source><volume>21</volume><fpage>396</fpage><lpage>404</lpage><pub-id pub-id-type="doi">10.1111/j.1420-9101.2007.01480.x</pub-id><pub-id pub-id-type="pmid">18179516</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Froeschke</surname><given-names>G</given-names></name><name><surname>Sommer</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>MHC class II DRB variability and parasite load in the striped mouse (Rhabdomys pumilio) in the southern Kalahari</article-title><source>Molecular Biology and Evolution</source><volume>22</volume><fpage>1254</fpage><lpage>1259</lpage><pub-id pub-id-type="doi">10.1093/molbev/msi156</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Froeschke</surname><given-names>G</given-names></name><name><surname>Sommer</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Insights into the complex associations between MHC class II DRB polymorphism and multiple gastrointestinal parasite infestations in the striped mouse</article-title><source>PLOS ONE</source><volume>7</volume><elocation-id>e31820</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0031820</pub-id><pub-id pub-id-type="pmid">22389675</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Geritz</surname><given-names>SAH</given-names></name><name><surname>Kisdi</surname><given-names>É</given-names></name><name><surname>Meszéna</surname><given-names>G</given-names></name><name><surname>Metz</surname><given-names>JAJ</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Evolutionarily singular strategies and the adaptive growth and branching of the evolutionary tree</article-title><source>Evolutionary Ecology</source><volume>12</volume><fpage>35</fpage><lpage>57</lpage><pub-id pub-id-type="doi">10.1023/A:1006554906681</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Geritz</surname><given-names>SAH</given-names></name><name><surname>Metz</surname><given-names>JAJ</given-names></name><name><surname>Rueffler</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Mutual invadability near evolutionarily singular strategies for multivariate traits, with special reference to the strongly convergence stable case</article-title><source>Journal of Mathematical Biology</source><volume>72</volume><fpage>1081</fpage><lpage>1099</lpage><pub-id pub-id-type="doi">10.1007/s00285-015-0944-6</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gillespie</surname><given-names>JH</given-names></name></person-group><year iso-8601-date="2004">2004</year><source>Population Genetics: A Concise Guide</source><publisher-name>The Johns Hopkins University Press</publisher-name></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gould</surname><given-names>SJ</given-names></name><name><surname>Hildreth</surname><given-names>JEK</given-names></name><name><surname>Booth</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>The evolution of alloimmunity and the genesis of adaptive immunity</article-title><source>The Quarterly Review of Biology</source><volume>79</volume><fpage>359</fpage><lpage>382</lpage><pub-id pub-id-type="doi">10.1086/426088</pub-id><pub-id pub-id-type="pmid">15669770</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hedrick</surname><given-names>PW</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Balancing selection and MHC</article-title><source>Genetica</source><volume>104</volume><fpage>207</fpage><lpage>214</lpage><pub-id pub-id-type="doi">10.1023/A:1026494212540</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hedrick</surname><given-names>PW</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Pathogen resistance and genetic variation at MHC loci</article-title><source>Evolution; International Journal of Organic Evolution</source><volume>56</volume><fpage>1902</fpage><lpage>1908</lpage><pub-id pub-id-type="doi">10.1554/0014-3820(2002)056[1902:pragva]2.0.co;2</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hedrick</surname><given-names>PW</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>What is the evidence for heterozygote advantage selection?</article-title><source>Trends in Ecology &amp; Evolution</source><volume>27</volume><fpage>698</fpage><lpage>704</lpage><pub-id pub-id-type="doi">10.1016/j.tree.2012.08.012</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hughes</surname><given-names>AL</given-names></name><name><surname>Nei</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>Nucleotide substitution at major histocompatibility complex class II loci: evidence for overdominant selection</article-title><source>PNAS</source><volume>86</volume><fpage>958</fpage><lpage>962</lpage><pub-id pub-id-type="doi">10.1073/pnas.86.3.958</pub-id><pub-id pub-id-type="pmid">2492668</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Iwasa</surname><given-names>Y</given-names></name><name><surname>Pomiankowski</surname><given-names>A</given-names></name><name><surname>Nee</surname><given-names>S</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>The evolution of costly mate preferences ii. the “handicap” principle</article-title><source>Evolution; International Journal of Organic Evolution</source><volume>45</volume><fpage>1431</fpage><lpage>1442</lpage><pub-id pub-id-type="doi">10.1111/j.1558-5646.1991.tb02646.x</pub-id><pub-id pub-id-type="pmid">28563835</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jeffery</surname><given-names>KJ</given-names></name><name><surname>Bangham</surname><given-names>CR</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Do infectious diseases drive MHC diversity?</article-title><source>Microbes and Infection</source><volume>2</volume><fpage>1335</fpage><lpage>1341</lpage><pub-id pub-id-type="doi">10.1016/s1286-4579(00)01287-9</pub-id><pub-id pub-id-type="pmid">11018450</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Johnson</surname><given-names>NL</given-names></name><name><surname>Kotz</surname><given-names>S</given-names></name><name><surname>Balakrishnan</surname><given-names>N</given-names></name></person-group><year iso-8601-date="1994">1994</year><source>Continuous Univariate Distributions</source><publisher-name>John wiley &amp; sons</publisher-name></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kekäläinen</surname><given-names>J</given-names></name><name><surname>Vallunen</surname><given-names>JA</given-names></name><name><surname>Primmer</surname><given-names>CR</given-names></name><name><surname>Rättyä</surname><given-names>J</given-names></name><name><surname>Taskinen</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Signals of major histocompatibility complex overdominance in a wild salmonid population</article-title><source>Proceedings. Biological Sciences</source><volume>276</volume><fpage>3133</fpage><lpage>3140</lpage><pub-id pub-id-type="doi">10.1098/rspb.2009.0727</pub-id><pub-id pub-id-type="pmid">19515657</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kimura</surname><given-names>M</given-names></name><name><surname>Crow</surname><given-names>JF</given-names></name></person-group><year iso-8601-date="1964">1964</year><article-title>The number of alleles that can be maintained in a finite population</article-title><source>Genetics</source><volume>49</volume><fpage>725</fpage><lpage>738</lpage><pub-id pub-id-type="doi">10.1093/genetics/49.4.725</pub-id><pub-id pub-id-type="pmid">14156929</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kisdi</surname><given-names>E</given-names></name><name><surname>Geritz</surname><given-names>SAH</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Adaptive dynamics in allele space: evolution of genetic polymorphism by small mutations in a heterogeneous environment</article-title><source>Evolution</source><volume>53</volume><elocation-id>993</elocation-id><pub-id pub-id-type="doi">10.2307/2640805</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klitz</surname><given-names>W</given-names></name><name><surname>Hedrick</surname><given-names>P</given-names></name><name><surname>Louis</surname><given-names>EJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>New reservoirs of HLA alleles: pools of rare variants enhance immune defense</article-title><source>Trends in Genetics</source><volume>28</volume><fpage>480</fpage><lpage>486</lpage><pub-id pub-id-type="doi">10.1016/j.tig.2012.06.007</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lande</surname><given-names>R</given-names></name></person-group><year iso-8601-date="1979">1979</year><article-title>Quantitative genetic analysis of multivariate evolution, applied to brain: body size allometry</article-title><source>Evolution</source><volume>33</volume><elocation-id>402</elocation-id><pub-id pub-id-type="doi">10.2307/2407630</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lau</surname><given-names>Q</given-names></name><name><surname>Yasukochi</surname><given-names>Y</given-names></name><name><surname>Satta</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A limit to the divergent allele advantage model supported by variable pathogen recognition across HLA-DRB1 allele lineages</article-title><source>Tissue Antigens</source><volume>86</volume><fpage>343</fpage><lpage>352</lpage><pub-id pub-id-type="doi">10.1111/tan.12667</pub-id><pub-id pub-id-type="pmid">26392055</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leimar</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Evolutionary change and darwinian demons</article-title><source>Selection</source><volume>2</volume><fpage>65</fpage><lpage>72</lpage><pub-id pub-id-type="doi">10.1556/Select.2.2001.1-2.5</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leimar</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Multidimensional convergence stability</article-title><source>Evolutionary Ecology Research</source><volume>11</volume><fpage>191</fpage><lpage>208</lpage></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lenz</surname><given-names>TL</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Computational prediction of mhc ii-antigen binding supports divergent allele advantage and explains trans-species polymorphism</article-title><source>Evolution; International Journal of Organic Evolution</source><volume>65</volume><fpage>2380</fpage><lpage>2390</lpage><pub-id pub-id-type="doi">10.1111/j.1558-5646.2011.01288.x</pub-id><pub-id pub-id-type="pmid">21790583</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Levins</surname><given-names>R</given-names></name></person-group><year iso-8601-date="1968">1968</year><source>Evolution in Changing Environments: Some Theoretical Explorations. MPB-2</source><publisher-name>Princeton University Press</publisher-name><pub-id pub-id-type="doi">10.2307/j.ctvx5wbbh</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lewontin</surname><given-names>RC</given-names></name><name><surname>Ginzburg</surname><given-names>LR</given-names></name><name><surname>Tuljapurkar</surname><given-names>SD</given-names></name></person-group><year iso-8601-date="1978">1978</year><article-title>Heterosis as an explanation for large amounts of genic polymorphism</article-title><source>Genetics</source><volume>88</volume><fpage>149</fpage><lpage>169</lpage><pub-id pub-id-type="doi">10.1093/genetics/88.1.149</pub-id><pub-id pub-id-type="pmid">17248790</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lighten</surname><given-names>J</given-names></name><name><surname>Papadopulos</surname><given-names>AST</given-names></name><name><surname>Mohammed</surname><given-names>RS</given-names></name><name><surname>Ward</surname><given-names>BJ</given-names></name><name><surname>G Paterson</surname><given-names>I</given-names></name><name><surname>Baillie</surname><given-names>L</given-names></name><name><surname>Bradbury</surname><given-names>IR</given-names></name><name><surname>Hendry</surname><given-names>AP</given-names></name><name><surname>Bentzen</surname><given-names>P</given-names></name><name><surname>van Oosterhout</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Evolutionary genetics of immunological supertypes reveals two faces of the Red Queen</article-title><source>Nature Communications</source><volume>8</volume><elocation-id>1294</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-017-01183-2</pub-id><pub-id pub-id-type="pmid">29101318</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Linnenbrink</surname><given-names>M</given-names></name><name><surname>Teschke</surname><given-names>M</given-names></name><name><surname>Montero</surname><given-names>I</given-names></name><name><surname>Vallier</surname><given-names>M</given-names></name><name><surname>Tautz</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Meta-populational demes constitute a reservoir for large MHC allele diversity in wild house mice (<italic>Mus musculus</italic>)</article-title><source>Frontiers in Zoology</source><volume>15</volume><elocation-id>15</elocation-id><pub-id pub-id-type="doi">10.1186/s12983-018-0266-9</pub-id><pub-id pub-id-type="pmid">29721030</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Loiseau</surname><given-names>C</given-names></name><name><surname>Zoorob</surname><given-names>R</given-names></name><name><surname>Robert</surname><given-names>A</given-names></name><name><surname>Chastel</surname><given-names>O</given-names></name><name><surname>Julliard</surname><given-names>R</given-names></name><name><surname>Sorci</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Plasmodium relictum infection and MHC diversity in the house sparrow (Passer domesticus)</article-title><source>Proceedings. Biological Sciences</source><volume>278</volume><fpage>1264</fpage><lpage>1272</lpage><pub-id pub-id-type="doi">10.1098/rspb.2010.1968</pub-id><pub-id pub-id-type="pmid">20943698</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maruyama</surname><given-names>T</given-names></name><name><surname>Nei</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1981">1981</year><article-title>Genetic variability maintained by mutation and overdominant selection in finite populations</article-title><source>Genetics</source><volume>98</volume><fpage>441</fpage><lpage>459</lpage><pub-id pub-id-type="doi">10.1093/genetics/98.2.441</pub-id><pub-id pub-id-type="pmid">17249094</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McClelland</surname><given-names>EE</given-names></name><name><surname>Penn</surname><given-names>DJ</given-names></name><name><surname>Potts</surname><given-names>WK</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Major histocompatibility complex heterozygote superiority during coinfection</article-title><source>Infection and Immunity</source><volume>71</volume><fpage>2079</fpage><lpage>2086</lpage><pub-id pub-id-type="doi">10.1128/IAI.71.4.2079-2086.2003</pub-id><pub-id pub-id-type="pmid">12654829</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Metz</surname><given-names>JAJ</given-names></name><name><surname>Nisbet</surname><given-names>RM</given-names></name><name><surname>Geritz</surname><given-names>SAH</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>How should we define ‘fitness’ for general ecological scenarios?</article-title><source>Trends in Ecology &amp; Evolution</source><volume>7</volume><fpage>198</fpage><lpage>202</lpage><pub-id pub-id-type="doi">10.1016/0169-5347(92)90073-K</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Metz</surname><given-names>JAJ</given-names></name></person-group><year iso-8601-date="2008">2008</year><chapter-title>Fitness</chapter-title><person-group person-group-type="editor"><name><surname>Jorgensen</surname><given-names>SE</given-names></name><name><surname>Jorgensen</surname><given-names>B</given-names></name></person-group><source>Encyclopedia of Ecology Oxford</source><publisher-name>Elsevier</publisher-name><fpage>1599</fpage><lpage>1612</lpage><pub-id pub-id-type="doi">10.1016/B978-008045405-4.00792-8</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Metz</surname><given-names>JAJ</given-names></name><name><surname>de Kovel</surname><given-names>CGF</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The canonical equation of adaptive dynamics for Mendelian diploids and haplo-diploids</article-title><source>Interface Focus</source><volume>3</volume><elocation-id>20130025</elocation-id><pub-id pub-id-type="doi">10.1098/rsfs.2013.0025</pub-id><pub-id pub-id-type="pmid">24516713</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oliver</surname><given-names>MK</given-names></name><name><surname>Telfer</surname><given-names>S</given-names></name><name><surname>Piertney</surname><given-names>SB</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Major histocompatibility complex (MHC) heterozygote superiority to natural multi-parasite infections in the water vole (Arvicola terrestris)</article-title><source>Proceedings. Biological Sciences</source><volume>276</volume><fpage>1119</fpage><lpage>1128</lpage><pub-id pub-id-type="doi">10.1098/rspb.2008.1525</pub-id><pub-id pub-id-type="pmid">19129114</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Penn</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>The scent of genetic compatibility: sexual selection and the major histocompatibility complex</article-title><source>Ethology</source><volume>108</volume><fpage>1</fpage><lpage>21</lpage><pub-id pub-id-type="doi">10.1046/j.1439-0310.2002.00768.x</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Penn</surname><given-names>DJ</given-names></name><name><surname>Damjanovich</surname><given-names>K</given-names></name><name><surname>Potts</surname><given-names>WK</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>MHC heterozygosity confers a selective advantage against multiple-strain infections</article-title><source>PNAS</source><volume>99</volume><fpage>11260</fpage><lpage>11264</lpage><pub-id pub-id-type="doi">10.1073/pnas.162006499</pub-id><pub-id pub-id-type="pmid">12177415</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pierini</surname><given-names>F</given-names></name><name><surname>Lenz</surname><given-names>TL</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Divergent allele advantage at human MHC genes: signatures of past and ongoing selection</article-title><source>Molecular Biology and Evolution</source><volume>35</volume><fpage>2145</fpage><lpage>2158</lpage><pub-id pub-id-type="doi">10.1093/molbev/msy116</pub-id><pub-id pub-id-type="pmid">29893875</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Priklopil</surname><given-names>T</given-names></name><name><surname>Lehmann</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Invasion implies substitution in ecological communities with class-structured populations</article-title><source>Theoretical Population Biology</source><volume>134</volume><fpage>36</fpage><lpage>52</lpage><pub-id pub-id-type="doi">10.1016/j.tpb.2020.04.004</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Proulx</surname><given-names>SR</given-names></name><name><surname>Phillips</surname><given-names>PC</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Allelic divergence precedes and promotes gene duplication</article-title><source>Evolution</source><volume>60</volume><elocation-id>881</elocation-id><pub-id pub-id-type="doi">10.1554/05-507.1</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>J</given-names></name><name><surname>Guethlein</surname><given-names>LA</given-names></name><name><surname>Cereb</surname><given-names>N</given-names></name><name><surname>Yang</surname><given-names>SY</given-names></name><name><surname>Norman</surname><given-names>PJ</given-names></name><name><surname>Marsh</surname><given-names>SGE</given-names></name><name><surname>Parham</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Distinguishing functional polymorphism from random variation in the sequences of &gt;10,000 HLA-A, -B and -C alleles</article-title><source>PLOS Genetics</source><volume>13</volume><elocation-id>e1006862</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1006862</pub-id><pub-id pub-id-type="pmid">28650991</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rueffler</surname><given-names>C</given-names></name><name><surname>Van Dooren</surname><given-names>TJM</given-names></name><name><surname>Leimar</surname><given-names>O</given-names></name><name><surname>Abrams</surname><given-names>PA</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Disruptive selection and then what?</article-title><source>Trends in Ecology &amp; Evolution</source><volume>21</volume><fpage>238</fpage><lpage>245</lpage><pub-id pub-id-type="doi">10.1016/j.tree.2006.03.003</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Schmid-Hempel</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2021">2021</year><source>Evolutionary Parasitology: The Integrated Study of Infections, Immunology, Ecology, And</source><publisher-name>Oxford University Press</publisher-name><pub-id pub-id-type="doi">10.1093/oso/9780198832140.001.0001</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sellis</surname><given-names>D</given-names></name><name><surname>Kvitek</surname><given-names>DJ</given-names></name><name><surname>Dunn</surname><given-names>B</given-names></name><name><surname>Sherlock</surname><given-names>G</given-names></name><name><surname>Petrov</surname><given-names>DA</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Heterozygote advantage is a common outcome of adaptation in <italic>Saccharomyces cerevisiae</italic></article-title><source>Genetics</source><volume>203</volume><fpage>1401</fpage><lpage>1413</lpage><pub-id pub-id-type="doi">10.1534/genetics.115.185165</pub-id><pub-id pub-id-type="pmid">27194750</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sheftel</surname><given-names>H</given-names></name><name><surname>Szekely</surname><given-names>P</given-names></name><name><surname>Mayo</surname><given-names>A</given-names></name><name><surname>Sella</surname><given-names>G</given-names></name><name><surname>Alon</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Evolutionary trade-offs and the structure of polymorphisms</article-title><source>Philosophical Transactions of the Royal Society of London. Series B, Biological Sciences</source><volume>373</volume><elocation-id>20170105</elocation-id><pub-id pub-id-type="doi">10.1098/rstb.2017.0105</pub-id><pub-id pub-id-type="pmid">29632259</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sommer</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>The importance of immune gene variability (MHC) in evolutionary ecology and conservation</article-title><source>Frontiers in Zoology</source><volume>2</volume><elocation-id>16</elocation-id><pub-id pub-id-type="doi">10.1186/1742-9994-2-16</pub-id><pub-id pub-id-type="pmid">16242022</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spencer</surname><given-names>HG</given-names></name><name><surname>Marks</surname><given-names>RW</given-names></name></person-group><year iso-8601-date="1988">1988</year><article-title>The maintenance of single-locus polymorphism I Numerical studies of a viability selection model</article-title><source>Genetics</source><volume>120</volume><fpage>605</fpage><lpage>613</lpage><pub-id pub-id-type="doi">10.1093/genetics/120.2.605</pub-id><pub-id pub-id-type="pmid">3197961</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spurgin</surname><given-names>LG</given-names></name><name><surname>Richardson</surname><given-names>DS</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>How pathogens drive genetic diversity: MHC, mechanisms and misunderstandings</article-title><source>Proceedings. Biological Sciences</source><volume>277</volume><fpage>979</fpage><lpage>988</lpage><pub-id pub-id-type="doi">10.1098/rspb.2009.2084</pub-id><pub-id pub-id-type="pmid">20071384</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stefan</surname><given-names>T</given-names></name><name><surname>Matthews</surname><given-names>L</given-names></name><name><surname>Prada</surname><given-names>JM</given-names></name><name><surname>Mair</surname><given-names>C</given-names></name><name><surname>Reeve</surname><given-names>R</given-names></name><name><surname>Stear</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Divergent allele advantage provides a quantitative model for maintaining alleles with a wide range of intrinsic merits</article-title><source>Genetics</source><volume>212</volume><fpage>553</fpage><lpage>564</lpage><pub-id pub-id-type="doi">10.1534/genetics.119.302022</pub-id><pub-id pub-id-type="pmid">30952668</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stoffels</surname><given-names>RJ</given-names></name><name><surname>Spencer</surname><given-names>HG</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>An asymmetric model of heterozygote advantage at major histocompatibility complex genes: degenerate pathogen recognition and intersection advantage</article-title><source>Genetics</source><volume>178</volume><fpage>1473</fpage><lpage>1489</lpage><pub-id pub-id-type="doi">10.1534/genetics.107.082131</pub-id><pub-id pub-id-type="pmid">18245836</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Takahata</surname><given-names>N</given-names></name><name><surname>Nei</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Allelic genealogy under overdominant and frequency-dependent selection and polymorphism of major histocompatibility complex loci</article-title><source>Genetics</source><volume>124</volume><fpage>967</fpage><lpage>978</lpage><pub-id pub-id-type="doi">10.1093/genetics/124.4.967</pub-id><pub-id pub-id-type="pmid">2323559</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thompson</surname><given-names>WW</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Influenza-associated hospitalizations in the united states</article-title><source>JAMA</source><volume>292</volume><elocation-id>1333</elocation-id><pub-id pub-id-type="doi">10.1001/jama.292.11.1333</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trotter</surname><given-names>MV</given-names></name><name><surname>Spencer</surname><given-names>HG</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>The generation and maintenance of genetic variation by frequency-dependent selection: constructing polymorphisms under the pairwise interaction model</article-title><source>Genetics</source><volume>180</volume><fpage>1547</fpage><lpage>1557</lpage><pub-id pub-id-type="doi">10.1534/genetics.108.088880</pub-id><pub-id pub-id-type="pmid">18791254</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trotter</surname><given-names>MV</given-names></name><name><surname>Spencer</surname><given-names>HG</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Models of frequency-dependent selection with mutation from parental alleles</article-title><source>Genetics</source><volume>195</volume><fpage>231</fpage><lpage>242</lpage><pub-id pub-id-type="doi">10.1534/genetics.113.152496</pub-id><pub-id pub-id-type="pmid">23852384</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wakeland</surname><given-names>EK</given-names></name><name><surname>Boehme</surname><given-names>S</given-names></name><name><surname>She</surname><given-names>JX</given-names></name><name><surname>Lu</surname><given-names>C-C</given-names></name><name><surname>McIndoe</surname><given-names>RA</given-names></name><name><surname>Cheng</surname><given-names>I</given-names></name><name><surname>Ye</surname><given-names>Y</given-names></name><name><surname>Potts</surname><given-names>WK</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Ancestral polymorphisms of MHC class II genes: Divergent allele advantage</article-title><source>Immunologic Research</source><volume>9</volume><fpage>115</fpage><lpage>122</lpage><pub-id pub-id-type="doi">10.1007/BF02918202</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wegner</surname><given-names>KM</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Historical and contemporary selection of teleost MHC genes: did we leave the past behind?</article-title><source>Journal of Fish Biology</source><volume>73</volume><fpage>2110</fpage><lpage>2132</lpage><pub-id pub-id-type="doi">10.1111/j.1095-8649.2008.02051.x</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilder</surname><given-names>SM</given-names></name><name><surname>Raubenheimer</surname><given-names>D</given-names></name><name><surname>Simpson</surname><given-names>SJ</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Moving beyond body condition indices as an estimate of fitness in ecological and evolutionary studies</article-title><source>Functional Ecology</source><volume>30</volume><fpage>108</fpage><lpage>115</lpage><pub-id pub-id-type="doi">10.1111/1365-2435.12460</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wright</surname><given-names>S</given-names></name></person-group><year iso-8601-date="1931">1931</year><article-title>Evolution in Mendelian populations</article-title><source>Genetics</source><volume>16</volume><fpage>97</fpage><lpage>159</lpage><pub-id pub-id-type="doi">10.1007/bf02459575</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wright</surname><given-names>S</given-names></name></person-group><year iso-8601-date="1939">1939</year><article-title>The distribution of self-sterility alleles in populations</article-title><source>Genetics</source><volume>24</volume><fpage>538</fpage><lpage>552</lpage><pub-id pub-id-type="doi">10.1093/genetics/24.4.538</pub-id><pub-id pub-id-type="pmid">17246937</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wright</surname><given-names>S</given-names></name></person-group><year iso-8601-date="1966">1966</year><article-title>Polyallelic random drift in relation to evolution</article-title><source>PNAS</source><volume>55</volume><fpage>1074</fpage><lpage>1081</lpage><pub-id pub-id-type="doi">10.1073/pnas.55.5.1074</pub-id><pub-id pub-id-type="pmid">5225508</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>F</given-names></name><name><surname>Yu</surname><given-names>T</given-names></name><name><surname>Du</surname><given-names>R</given-names></name><name><surname>Fan</surname><given-names>G</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name><name><surname>Liu</surname><given-names>Z</given-names></name><name><surname>Xiang</surname><given-names>J</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Song</surname><given-names>B</given-names></name><name><surname>Gu</surname><given-names>X</given-names></name><name><surname>Guan</surname><given-names>L</given-names></name><name><surname>Wei</surname><given-names>Y</given-names></name><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Wu</surname><given-names>X</given-names></name><name><surname>Xu</surname><given-names>J</given-names></name><name><surname>Tu</surname><given-names>S</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Chen</surname><given-names>H</given-names></name><name><surname>Cao</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Clinical course and risk factors for mortality of adult inpatients with COVID-19 in Wuhan, China: a retrospective cohort study</article-title><source>Lancet</source><volume>395</volume><fpage>1054</fpage><lpage>1062</lpage><pub-id pub-id-type="doi">10.1016/S0140-6736(20)30566-3</pub-id><pub-id pub-id-type="pmid">32171076</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec sec-type="appendix" id="s8"><title>Effective number of alleles</title><p>Here, we provide the calculations for the effective number of alleles <inline-formula><mml:math id="inf207"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> reported in <xref ref-type="fig" rid="fig4">Figures 4</xref> and <xref ref-type="fig" rid="fig5">5</xref>. The effective number of alleles is given by the reciprocal of the population homozygosity <inline-formula><mml:math id="inf208"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mo>∑</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf209"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>f</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> denotes the frequency of allele <inline-formula><mml:math id="inf210"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>i</mml:mi></mml:mstyle></mml:math></inline-formula> in the population (<xref ref-type="bibr" rid="bib42">Kimura and Crow, 1964</xref>). Under mutation-drift balance, the expected homozygosity is approximated by <inline-formula><mml:math id="inf211"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>1</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:mi>N</mml:mi><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib32">Gillespie, 2004</xref>), where <inline-formula><mml:math id="inf212"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi></mml:mstyle></mml:math></inline-formula> is population size and <italic>µ</italic> the per capita mutation probability.</p><p>Thus, under mutation-drift balance, the expected value of <inline-formula><mml:math id="inf213"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> equals <inline-formula><mml:math id="inf214"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:mi>N</mml:mi><mml:mi>μ</mml:mi></mml:mstyle></mml:math></inline-formula>. For <xref ref-type="fig" rid="fig4">Figure 4</xref>, where <inline-formula><mml:math id="inf215"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf216"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>−</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula>, the expected value of <inline-formula><mml:math id="inf217"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> is 1.2. In <xref ref-type="fig" rid="fig5">Figure 5</xref>, with <inline-formula><mml:math id="inf218"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf219"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula>, the expected value for <inline-formula><mml:math id="inf220"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> is 3. Hence, <inline-formula><mml:math id="inf221"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>-values significantly higher than these expectations indicate the presence of alleles maintained by balancing selection.</p><p>It is worth noting that when alleles are at equal frequencies <inline-formula><mml:math id="inf222"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>f</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf223"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> is equal to <inline-formula><mml:math id="inf224"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi></mml:mstyle></mml:math></inline-formula>. In our model, both conditions (1) and (2) of <xref ref-type="bibr" rid="bib42">Kimura and Crow, 1964</xref>, are approached at evolutionary equilibrium (i.e. heterozygote having similar and high fitness while homozygote having similar and low fitness), as elaborated in the Discussion. As a result, alleles maintained by HA are maintained at roughly similar frequencies. Consequently, <inline-formula><mml:math id="inf225"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> gives a good estimate for the number of alleles that coexist in a protected polymorphism due to HA, rather than being maintained in a balance between mutation and drift.</p></sec></app><app id="appendix-2"><title>Appendix 2</title><sec sec-type="appendix" id="s9"><title>Evolutionary dynamics without diversification</title><fig id="app2fig1" position="float"><label>Appendix 2—figure 1.</label><caption><title>Evolution of allelic values in the presence of three pathogens.</title><p>This figure is analogous to <xref ref-type="fig" rid="fig3">Figure 3</xref> (see that legend for details) but with wider Gaussians (<inline-formula><mml:math id="inf226"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>2.5</mml:mn></mml:mstyle></mml:math></inline-formula>, as in <xref ref-type="fig" rid="fig1">Figure 1C</xref>). As a consequence, the condition for evolutionary branching (<inline-formula><mml:math id="inf227"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>2</mml:mn><mml:msqrt><mml:mi>m</mml:mi></mml:msqrt></mml:mstyle></mml:math></inline-formula>) is not fulfilled and the evolutionary dynamics result in a monomorphic population consisting essentially of only the generalist allele <inline-formula><mml:math id="inf228"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. This result is independent of the half-saturation constant <inline-formula><mml:math id="inf229"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi></mml:mstyle></mml:math></inline-formula>, here chosen to be <inline-formula><mml:math id="inf230"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mstyle></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-94587-app2-fig1-v2.tif"/></fig></sec></app><app id="appendix-3"><title>Appendix 3</title><sec sec-type="appendix" id="s10"><title>Table of mathematical notation</title><p>List of all mathematical symbols used in the Supplementary Information. Bold italic font indicates vectors (e.g. <inline-formula><mml:math id="inf231"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>) while normal italic font indicates numbers or scalar-valued functions. Capital letters in sans serif font indicate matrices (e.g. <inline-formula><mml:math id="inf232"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="sans-serif">H</mml:mi></mml:mstyle></mml:math></inline-formula>).</p><table-wrap id="inlinetable1" position="anchor"><table frame="hsides" rules="groups"><thead><tr><th align="center" valign="bottom">Notation</th><th align="left" valign="bottom">Explanation</th></tr></thead><tbody><tr><td align="center" valign="middle"><inline-formula><mml:math id="inf233"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">condition function</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="inf234"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">maximum condition</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="inf235"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">C</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">mutational covariance matrix</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="inf236"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">peptide detection probability (bit-string model)</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="inf237"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">expected mutational step size (Gaussian model)</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="inf238"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">efficiency function for pathogen <inline-formula><mml:math id="inf239"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>k</mml:mi></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="inf240"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">frequency of allele <inline-formula><mml:math id="inf241"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="inf242"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">dimensionality of the allelic trait space</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="inf243"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">H</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Hessian matrix</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="inf244"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">identity matrix</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="inf245"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">J</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Jacobian matrix</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="inf246"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">half-saturation constant of survival function</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="inf247"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">number of pathogens</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="inf248"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">per capita mutation probability</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="inf249"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">number of alleles</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="inf250"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">effective number of alleles</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="inf251"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">population size</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="inf252"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">vector describing the <italic>k</italic>th pathogen (Gaussian model)</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="inf253"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">survival function</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="inf254"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">maximum survival</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="inf255"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">covariance matrix of the Gaussian efficiency function <inline-formula><mml:math id="inf256"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>e</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> for pathogen <inline-formula><mml:math id="inf257"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>k</mml:mi></mml:mstyle></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ23">Equation A14</xref>)</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="inf258"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">covariance matrix of the Gaussian efficiency function <inline-formula><mml:math id="inf259"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>e</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>, assuming equal covariance matrices for all pathogens</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="inf260"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">variance of the Gaussian efficiency function <inline-formula><mml:math id="inf261"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>e</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>, assuming full symmetry matrices for all pathogens</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="inf262"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">covariance matrix of the position of the pathogen vectors (Gaussian model)</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="inf263"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">variance of the position of the pathogen vectors, assuming equally distant pathogen optima (Gaussian model)</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="inf264"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">virulence; given by <inline-formula><mml:math id="inf265"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">G</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mstyle></mml:math></inline-formula> for the Gaussian model and the detection threshold value in the bit-string model</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="inf266"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">allelic trait vector of allele <inline-formula><mml:math id="inf267"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>a</mml:mi></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="inf268"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">allelic trait vector of a resident allele</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="inf269"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">allelic trait vector of rare mutant allele</td></tr></tbody></table></table-wrap></sec></app><app id="appendix-4"><title>Appendix 4</title><sec sec-type="appendix" id="s11"><title>Varying the expected mutational step size in the Gaussian model</title><p>For the Gaussian model, mutations are drawn from an isotropic normal distribution, i.e., a matrix with covariance matrix <inline-formula><mml:math id="inf270"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>σ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mi>I</mml:mi></mml:mstyle></mml:math></inline-formula> of dimension <inline-formula><mml:math id="inf271"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>h</mml:mi></mml:mstyle></mml:math></inline-formula>. The expected mutational step size <inline-formula><mml:math id="inf272"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>δ</mml:mi></mml:mstyle></mml:math></inline-formula> is given by <inline-formula><mml:math id="inf273"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>σ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>μ</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> times the expected value of the Chi-distribution (Equation 18.14 in <xref ref-type="bibr" rid="bib40">Johnson et al., 1994</xref>),<disp-formula id="equ8"><label>(A1)</label><mml:math id="m8"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mrow><mml:mi>h</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>h</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><fig id="app4fig1" position="float"><label>Appendix 4—figure 1.</label><caption><title>Number of coexisting alleles as they emerge in individual-based simulations for different expected mutational step sizes <inline-formula><mml:math id="inf274"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>δ</mml:mi></mml:mstyle></mml:math></inline-formula> and eight pathogens (<inline-formula><mml:math id="inf275"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mstyle></mml:math></inline-formula>).</title><p>Parameters are chosen such that up to 200 alleles can evolve (<inline-formula><mml:math id="inf276"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf277"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mstyle></mml:math></inline-formula>; see bottom right panel in <xref ref-type="fig" rid="fig4">Figure 4</xref> in the main text). Solid orange lines and dotted blue lines give the effective number <inline-formula><mml:math id="inf278"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> and the absolute number <inline-formula><mml:math id="inf279"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi></mml:mstyle></mml:math></inline-formula> of alleles, respectively. The number of alleles increases fastest and saturates earliest for an intermediate expected mutational step size of <inline-formula><mml:math id="inf280"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.03</mml:mn></mml:mstyle></mml:math></inline-formula> (<bold>D</bold>; pathogen vectors are <inline-formula><mml:math id="inf281"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>1</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mn>0.03</mml:mn><mml:mo>≈</mml:mo><mml:mn>30</mml:mn></mml:mstyle></mml:math></inline-formula> average mutational steps apart) as used in <xref ref-type="fig" rid="fig4">Figure 4</xref>. Decreasing the average mutational step size slows down the build-up of allelic diversity (<bold>E–G</bold>). In the extreme case shown in G (pathogen vectors are 1/0.001 = 1000 average mutational steps apart), the evolutionary dynamics is strongly limited by the rate of phenotypic change due to the small step size and the number of alleles after 10<sup>7</sup> time steps has reached only 10% the number reached in D. Increasing the average mutational step size also slows down the build-up of allelic diversity (<bold>A–C</bold>). In the extreme case shown in A (pathogen vectors are 1.25 average mutational steps apart), the evolutionary dynamics are strongly limited by the very large proportion of maladapted mutants. Other parameters (as in <xref ref-type="fig" rid="fig4">Figure 4</xref>): <inline-formula><mml:math id="inf282"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf283"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>−</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-94587-app4-fig1-v2.tif"/></fig></sec></app><app id="appendix-5"><title>Appendix 5</title><sec sec-type="appendix" id="s12"><title>Deviations from symmetry in the Gaussian model</title><p>The number of coexisting alleles for different parameter combinations are shown in <xref ref-type="fig" rid="fig4">Figure 4</xref> in the main text. These results are based on two symmetry assumptions. First, the <inline-formula><mml:math id="inf284"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi></mml:mstyle></mml:math></inline-formula> points describing by the pathogen vectors are placed equidistantly with <inline-formula><mml:math id="inf285"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula>, resulting in a regular <inline-formula><mml:math id="inf286"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math></inline-formula>-simplex. Second, the multivariate Gaussian functions <inline-formula><mml:math id="inf287"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>e</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> describing the MHC-molecule’s efficiencies against the different pathogens are isotropic and have equal width, as shown in <xref ref-type="fig" rid="fig1">Figure 1</xref>. Thus, the covariance matrices <inline-formula><mml:math id="inf288"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ23">Equation A14</xref> are equal to <inline-formula><mml:math id="inf289"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">G</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi>I</mml:mi></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf290"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>I</mml:mi></mml:mstyle></mml:math></inline-formula> is the identity matrix. Here, we test the robustness of the outcome shown <xref ref-type="fig" rid="fig4">Figure 4</xref> with respect to violations of these symmetry assumptions. We focus on the case with eight pathogens, and the results are summarised in <xref ref-type="fig" rid="app5fig1">Appendix 5—figure 1</xref>. Panel A is identical to the bottom right panel in <xref ref-type="fig" rid="fig4">Figure 4</xref>, and shown here for comparison. Panels B<italic>–</italic>D show the final number of coexisting alleles for increasing deviations from symmetry, as explained in the following. Note that each pixel in the figure is based on a single simulation with a unique random perturbation from symmetry.</p><p>In <xref ref-type="fig" rid="app5fig1">Appendix 5—figure 1B</xref> the assumption of symmetrically placed pathogen vectors is perturbed while the Gaussian functions <inline-formula><mml:math id="inf291"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>e</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> are kept rotationally symmetric with equal width. Section ‘Random placement of pathogen vectors’ describes the procedure how the positions of the pathogen vectors are randomised. The similarity between panels A and B indicates that deviations from a symmetric placement of pathogen vectors has a minor effect on the number of coexisting alleles. The slightly decreased smoothness of the contours corresponding to 50 and 100 coexisting alleles stems from the fact that each simulation (corresponding to a pixel) is based from a unique perturbation. Note that polymorphism can emerge for values of <inline-formula><mml:math id="inf292"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi></mml:mstyle></mml:math></inline-formula> such that the branching condition <inline-formula><mml:math id="inf293"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>2</mml:mn><mml:msqrt><mml:mi>m</mml:mi></mml:msqrt></mml:mstyle></mml:math></inline-formula> derived for the symmetric case is not fulfilled (below the red arrow). This can be understood based on the expression for the Hessian matrix given in <xref ref-type="disp-formula" rid="equ54">Equation A43</xref>. This Hessian matrix is more likely to be positive definite for asymmetrically placed pathogen vectors.</p><fig id="app5fig1" position="float"><label>Appendix 5—figure 1.</label><caption><title>Number of coexisting alleles for eight pathogens as a function of pathogen virulence <inline-formula><mml:math id="inf294"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi></mml:mstyle></mml:math></inline-formula> and the half-saturation constant <inline-formula><mml:math id="inf295"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi></mml:mstyle></mml:math></inline-formula> for symmetrically (<bold>A</bold>) and non-symmetrically placed pathogen vectors (<bold>B–D</bold>).</title><p>Figures are based on a single individual-based simulation per pixel and run for 10<sup>6</sup> generations, assuring that the equilibrium distribution of alleles is reached. (<bold>A</bold>) shows results for equally spaced pathogen vectors and isotropic functions <inline-formula><mml:math id="inf296"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>e</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ23">Equation A14</xref>). It is identical to the bottom right panel in <xref ref-type="fig" rid="fig4">Figure 4</xref> and shown here for comparison. (<bold>B–D</bold>) show the result for increasing perturbations from symmetry. In (<bold>B</bold>), pathogen vectors are placed randomly (see Section ‘Random placement of pathogen vectors’ for details) while the functions <inline-formula><mml:math id="inf297"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>e</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> are kept rotationally symmetric. In (<bold>C</bold>) and (<bold>D</bold>), additionally to the non-symmetric placement of pathogen vectors, the functions <inline-formula><mml:math id="inf298"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>e</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> are independently perturbed from rotational symmetry (see Appendix ‘Random covariance matrices for the pathogen efficiencies’ for details). In (<bold>C</bold>) the deviations from rotational symmetry are moderate, while in (<bold>D</bold>) they are strong. Note that in (<bold>B–D</bold>) pathogen vectors are no longer at a constant distance 1, but instead have the mean variance calculated from the pathogen optima corresponds to the variance of symmetrically placed pathogens optima with distance 1. Results are reported in terms of the effective number of alleles <inline-formula><mml:math id="inf299"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>, which discounts for alleles arising from mutation-drift balance (see Appendix ‘Effective number of alleles’). Dashed and solid lines give the contours for <inline-formula><mml:math id="inf300"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf301"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mstyle></mml:math></inline-formula>, respectively. Red arrows indicate <inline-formula><mml:math id="inf302"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:msqrt><mml:mn>8</mml:mn></mml:msqrt></mml:mstyle></mml:math></inline-formula>, the minimal value for polymorphism to emerge from branching under full symmetry (<xref ref-type="disp-formula" rid="equ57">Equation A46</xref>). Accordingly, simulations in the dark blue area result in a single abundant allele with <inline-formula><mml:math id="inf303"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> close to one. Other parameters: population size <inline-formula><mml:math id="inf304"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula>, per capita mutation probability <inline-formula><mml:math id="inf305"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>−</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula>, expected mutational step size <inline-formula><mml:math id="inf306"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.03</mml:mn></mml:mstyle></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-94587-app5-fig1-v2.tif"/></fig><p>In <xref ref-type="fig" rid="app5fig1">Appendix 5—figure 1C and D</xref> we, additionally to the non-symmetric placement of pathogen vectors, allow for Gaussian functions <inline-formula><mml:math id="inf307"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>e</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> that are not isotropic. The variances of the perturbed covariance matrices are drawn from the interval <inline-formula><mml:math id="inf308"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>p</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ε</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>p</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>ε</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math></inline-formula> and constrained such that the average variance is equal to 1, and then rotated randomly. Section ‘Random covariance matrices for the pathogen efficiencies’ describes this procedure in detail. Panel C shows the result for modest (<inline-formula><mml:math id="inf309"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ε</mml:mi><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mstyle></mml:math></inline-formula>) and panel D for strong (<inline-formula><mml:math id="inf310"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ε</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mstyle></mml:math></inline-formula>) deviations from rotational symmetry. Comparing panels C to B indicates that modest deviations from rotational symmetry have a relatively minor effect on the final number of coexisting alleles. In contrast, in panel D configurations exist where significantly fewer alleles are able to coexist. Interestingly, configurations resulting in a high number of alleles are more likely to occur in combination with high <inline-formula><mml:math id="inf311"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi></mml:mstyle></mml:math></inline-formula>-values. The highly irregular pattern results from each pixel corresponding to a single simulation with a unique random perturbation from symmetry. Furthermore, the threshold for polymorphism decreases even more because the Hessian matrix given in <xref ref-type="disp-formula" rid="equ53">Equation A42</xref> is even more likely to be positive definite with perturbations in <inline-formula><mml:math id="inf312"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><sec sec-type="appendix" id="s12-1"><title>Random placement of pathogen vectors</title><p>We here describe how we randomly place eight pathogen vectors in trait space. In order to keep the results comparable to the symmetric case, we keep the average variance calculated from the position of their mid-points constant. The distribution of eight pathogen vectors can be described by their seven dimensional covariance matrix <inline-formula><mml:math id="inf313"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> calculated from the coordinates <inline-formula><mml:math id="inf314"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. Since each diagonal element of <inline-formula><mml:math id="inf315"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> describes the variance of the pathogen vectors along a different dimension of the trait space, the average variance equals <inline-formula><mml:math id="inf316"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>7</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf317"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> denotes the trace. This measure is unaffected by rotation of the points <inline-formula><mml:math id="inf318"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. For symmetrically placed pathogen vectors <inline-formula><mml:math id="inf319"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>d</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf320"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>I</mml:mi></mml:mstyle></mml:math></inline-formula> denotes the identity matrix, and therefore <inline-formula><mml:math id="inf321"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi>d</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula>. For the pathogens with perturbed placements (with covariance matrix <inline-formula><mml:math id="inf322"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula>), we demand <inline-formula><mml:math id="inf323"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula>. We achieve this by first choosing eight preliminary points <inline-formula><mml:math id="inf324"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo mathvariant="bold" stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo mathvariant="bold" stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> that are placed randomly within a unit 7-sphere, having the covariance matrix <inline-formula><mml:math id="inf325"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. By subsequently multiplying the coordinates of these points by a scalar <inline-formula><mml:math id="inf326"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>α</mml:mi></mml:mstyle></mml:math></inline-formula>, the variances in <inline-formula><mml:math id="inf327"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> are multiplied by <inline-formula><mml:math id="inf328"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>α</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula>. By setting<disp-formula id="equ9"><label>(A2)</label><mml:math id="m9"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:munder><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mo movablelimits="false">∑</mml:mo><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:msqrt><mml:mo>=</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>m</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mo movablelimits="false">∑</mml:mo><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:msqrt><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>with <inline-formula><mml:math id="inf329"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mstyle></mml:math></inline-formula>, we obtain the final set of pathogen vectors <inline-formula><mml:math id="inf330"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> with a covariance matrix <inline-formula><mml:math id="inf331"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> fulfilling <inline-formula><mml:math id="inf332"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></sec><sec sec-type="appendix" id="s12-2"><title>Random covariance matrices for the pathogen efficiencies</title><p>We here describe how we create random covariance matrices <inline-formula><mml:math id="inf333"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula>. In order to keep the results between the symmetric and asymmetric case comparable, we fix the mean variance over all <inline-formula><mml:math id="inf334"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> to <inline-formula><mml:math id="inf335"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>σ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula>. We obtain the eight random covariance matrices <inline-formula><mml:math id="inf336"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> in the following manner. First, eight random diagonal matrices <inline-formula><mml:math id="inf337"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">D</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">D</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> are determined (one per pathogen vectors) with entries drawn from a uniform distribution <inline-formula><mml:math id="inf338"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mtext class="MJX-tex-mathit" mathvariant="italic">U</mml:mtext></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ε</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>ε</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math></inline-formula>. These matrices are then multiplied with the scalar<disp-formula id="equ10"><label>(A3)</label><mml:math id="m10"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mfrac><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="sans-serif">D</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>with <inline-formula><mml:math id="inf339"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mstyle></mml:math></inline-formula> to obtain the set of matrices <inline-formula><mml:math id="inf340"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">M</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">M</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> obeying <inline-formula><mml:math id="inf341"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>8</mml:mn></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">M</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>7</mml:mn><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. In a final step, we draw eight random rotation matrices <inline-formula><mml:math id="inf342"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">R</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">R</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and calculate our final covariance matrices <inline-formula><mml:math id="inf343"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">P</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">P</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> as <inline-formula><mml:math id="inf344"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="sans-serif">P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="sans-serif">R</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="sans-serif">M</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="sans-serif">R</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></sec></sec></app><app id="appendix-6"><title>Appendix 6</title><sec sec-type="appendix" id="s13"><title>Simulation run of the bit-string model with parameter values as in <xref ref-type="bibr" rid="bib7">Borghans et al., 2004</xref></title><fig id="app6fig1" position="float"><label>Appendix 6—figure 1.</label><caption><title>The number of alleles <inline-formula><mml:math id="inf345"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi></mml:mstyle></mml:math></inline-formula> and the effective number of alleles <inline-formula><mml:math id="inf346"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> as a function of time (on a log-log plot) for a simulation run of our bit-string model.</title><p>Parameters values: <inline-formula><mml:math id="inf347"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf348"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula>. Other parameters as in <xref ref-type="bibr" rid="bib7">Borghans et al., 2004</xref>: <inline-formula><mml:math id="inf349"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>7</mml:mn></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf350"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf351"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mstyle></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-94587-app6-fig1-v2.tif"/></fig><p>We here present a comparison of our bit-string model with that of <xref ref-type="bibr" rid="bib7">Borghans et al., 2004</xref>. These authors analyse a bit-string model with <inline-formula><mml:math id="inf352"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> pathogens (that are allowed to mutate but are not subject to selection), with <inline-formula><mml:math id="inf353"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mstyle></mml:math></inline-formula> peptides each, a virulence of <inline-formula><mml:math id="inf354"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>7</mml:mn></mml:mstyle></mml:math></inline-formula> (with a step function for the probability that an MHC-molecule detects a peptide), a population size of <inline-formula><mml:math id="inf355"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, and a per capita mutation probability of <inline-formula><mml:math id="inf356"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>. In contrast to our model, they assume that condition equals the proportion of detected pathogens, such that each pathogen can lower fitness by only 2% (not fulfilling our assumption a) and that survival is proportional to the squared condition (not fulfilling our assumption b). With these parameters and parameter values, their simulation results in up to seven alleles. We note, that the effective number of alleles in these simulations is likely lower, but no allele frequencies are given.</p><p>We contrast their results with those from our model, which, as detailed in the main part, fulfils assumptions (a) and (b). To approximate the step function for the detection probability, we use<disp-formula id="equ11"><label>(A4)</label><mml:math id="m11"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>2</mml:mn><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>99</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>For this function, <inline-formula><mml:math id="inf357"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi></mml:mstyle></mml:math></inline-formula> is the required match length <inline-formula><mml:math id="inf358"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>L</mml:mi></mml:mstyle></mml:math></inline-formula> for a 99% chance of detection, while a match length <inline-formula><mml:math id="inf359"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mi>v</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula> gives only 1% detection probability. Note, that compared to <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>, we here subtract <inline-formula><mml:math id="inf360"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>1</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula> in the denominator and <inline-formula><mml:math id="inf361"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>99</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math></inline-formula>. Then, our model with the exact same parameters (omitting pathogen mutations) results in 18 alleles and <inline-formula><mml:math id="inf362"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>16.7</mml:mn></mml:mstyle></mml:math></inline-formula>, clearly exceeding the number of alleles found by <xref ref-type="bibr" rid="bib7">Borghans et al., 2004</xref>.</p><p>Based on <xref ref-type="bibr" rid="bib42">Kimura and Crow, 1964</xref>, for the above <inline-formula><mml:math id="inf363"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf364"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>μ</mml:mi></mml:mstyle></mml:math></inline-formula> the effective number of alleles that can be maintained by HA cannot exceed <inline-formula><mml:math id="inf365"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>17.6</mml:mn></mml:mstyle></mml:math></inline-formula> at mutation-drift-selection balance. This suggests that the allelic diversity found by <xref ref-type="bibr" rid="bib7">Borghans et al., 2004</xref>, is likely not limited by the parameters affecting mutation and drift, <inline-formula><mml:math id="inf366"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>μ</mml:mi></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf367"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi></mml:mstyle></mml:math></inline-formula>. In contrast, our final number of alleles (being 95% of the maximum) is likely limited by these parameters. To demonstrate that this is indeed the case, we simulate our model with <inline-formula><mml:math id="inf368"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf369"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, as shown in <xref ref-type="fig" rid="app6fig1">Appendix 6—figure 1</xref>. We find well over 100 alleles (<inline-formula><mml:math id="inf370"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>157</mml:mn></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf371"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>140</mml:mn></mml:mstyle></mml:math></inline-formula>). This demonstrates that the ecological parameter values used by <xref ref-type="bibr" rid="bib7">Borghans et al., 2004</xref>, <inline-formula><mml:math id="inf372"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf373"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mstyle></mml:math></inline-formula>, and <inline-formula><mml:math id="inf374"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>7</mml:mn></mml:mstyle></mml:math></inline-formula>, under our model allows for more than a 20-fold higher allelic diversity.</p></sec></app><app id="appendix-7"><title>Appendix 7</title><sec sec-type="appendix" id="s14"><title>Mathematical analysis of the Gaussian model: preliminaries</title><sec sec-type="appendix" id="s14-1"><title>Adaptive dynamics and invasion fitness</title><p>For the Gaussian model presented in the main part, we investigate with an evolutionary invasion analysis using the adaptive dynamics formalism (<xref ref-type="bibr" rid="bib57">Metz et al., 1992</xref>; <xref ref-type="bibr" rid="bib15">Dieckmann and Law, 1996</xref>; <xref ref-type="bibr" rid="bib30">Geritz et al., 1998</xref>) whether selection favours a single generalist allele or a polymorphic population. In the language of adaptive dynamics, we ask whether a monomorphic population evolves towards an evolutionary branching point, where two coexisting allelic lineages emerge.</p><p>Let us consider a large population of <inline-formula><mml:math id="inf375"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi></mml:mstyle></mml:math></inline-formula> individuals with two segregating alleles <inline-formula><mml:math id="inf376"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf377"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> under Wright-Fisher population dynamics (<xref ref-type="bibr" rid="bib25">Fisher, 1930</xref>; <xref ref-type="bibr" rid="bib83">Wright, 1931</xref>). The allelic frequencies at time <inline-formula><mml:math id="inf378"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>t</mml:mi></mml:mstyle></mml:math></inline-formula> are denoted <inline-formula><mml:math id="inf379"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf380"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, respectively.</p><p>The recurrence equation for the change of frequency of an allele <inline-formula><mml:math id="inf381"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is then given by<disp-formula id="equ12"><label>(A5)</label><mml:math id="m12"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>s</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>s</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mfrac><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf382"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is the survival of an individual carrying the alleles <inline-formula><mml:math id="inf383"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf384"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (see <xref ref-type="disp-formula" rid="equ21">Equation A12</xref>) and<disp-formula id="equ13"><mml:math id="m13"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mover><mml:mi>s</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>is the population mean survival at time <inline-formula><mml:math id="inf385"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>t</mml:mi></mml:mstyle></mml:math></inline-formula>. Note, that the expression within brackets on the right-hand side of <xref ref-type="disp-formula" rid="equ12">Equation A5</xref> describes the marginal fitness of allele <inline-formula><mml:math id="inf386"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>Consider a resident population carrying allele <inline-formula><mml:math id="inf387"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> to which a mutant allele <inline-formula><mml:math id="inf388"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">ϵ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is introduced. In the limit of a mutant allele frequency close to zero, its marginal fitness is given by<disp-formula id="equ14"><label>(A6)</label><mml:math id="m14"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We refer to <inline-formula><mml:math id="inf389"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> as invasion fitness, which is the expected long-term exponential growth rate of an infinitesimally rare mutant allele <inline-formula><mml:math id="inf390"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in a resident population with allele <inline-formula><mml:math id="inf391"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib57">Metz et al., 1992</xref>; <xref ref-type="bibr" rid="bib58">Metz, 2008</xref>). Allele <inline-formula><mml:math id="inf392"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> has a positive probability to invade and increase in frequency if <inline-formula><mml:math id="inf393"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and disappears otherwise.</p><p>We denote the gradient of invasion fitness with respect to the mutant allele <inline-formula><mml:math id="inf394"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, evaluated at <inline-formula><mml:math id="inf395"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, with <inline-formula><mml:math id="inf396"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>▽</mml:mi><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. It has the entries<disp-formula id="equ15"><label>(A7)</label><mml:math id="m15"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>▽</mml:mi><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mpadded width="0"><mml:mphantom><mml:mi>p</mml:mi></mml:mphantom></mml:mpadded></mml:mrow></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>and gives the direction in the <italic>h</italic>-dimensional allelic trait space in which deviations from <inline-formula><mml:math id="inf397"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> result in the fastest increase of invasion fitness.</p><p>If mutations rarely occur, a mutant allele <inline-formula><mml:math id="inf398"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> will either go extinct or reach an equilibrium frequency before the next mutant appears. If, additionally, <inline-formula><mml:math id="inf399"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>▽</mml:mi><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>≠</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and mutational effects are sufficiently small (i.e. <inline-formula><mml:math id="inf400"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">ϵ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> for <inline-formula><mml:math id="inf401"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">ϵ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> small), then invasion of <inline-formula><mml:math id="inf402"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> implies extinction of <inline-formula><mml:math id="inf403"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib14">Dercole and Rinaldi, 2008</xref>; <xref ref-type="bibr" rid="bib64">Priklopil and Lehmann, 2020</xref>).</p><p>In the limit of small mutational steps, the evolutionary dynamics of an allelic lineage becomes gradual and is given by<disp-formula id="equ16"><label>(A8)</label><mml:math id="m16"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>μ</mml:mi><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="sans-serif">C</mml:mi></mml:mrow><mml:mi>▽</mml:mi><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>(<xref ref-type="bibr" rid="bib15">Dieckmann and Law, 1996</xref>; <xref ref-type="bibr" rid="bib9">Champagnat et al., 2006</xref>; <xref ref-type="bibr" rid="bib20">Durinx et al., 2008</xref>; <xref ref-type="bibr" rid="bib59">Metz and de Kovel, 2013</xref>). Here, <inline-formula><mml:math id="inf404"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>μ</mml:mi></mml:mstyle></mml:math></inline-formula> is the per capita mutation probability and <inline-formula><mml:math id="inf405"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="sans-serif">C</mml:mi></mml:mstyle></mml:math></inline-formula> the covariance matrix for the distribution of mutational effects on the trait <inline-formula><mml:math id="inf406"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>We note that <xref ref-type="disp-formula" rid="equ16">Equation A8</xref> is structurally similar to the gradient equation of quantitative genetics, which is based on the assumption of weak selection or, equivalently, small genetic variances (<xref ref-type="bibr" rid="bib45">Lande, 1979</xref>; <xref ref-type="bibr" rid="bib38">Iwasa et al., 1991</xref>; <xref ref-type="bibr" rid="bib2">Abrams et al., 1993</xref>; <xref ref-type="bibr" rid="bib12">Débarre et al., 2014</xref>). In this case, <inline-formula><mml:math id="inf407"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> characterises the mean of the phenotype distribution, the covariance matrix describes the distribution of the standing genetic variation, and the factor <inline-formula><mml:math id="inf408"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>μ</mml:mi><mml:mi>N</mml:mi></mml:mstyle></mml:math></inline-formula> is replaced with a constant.</p><p>Allelic trait values <inline-formula><mml:math id="inf409"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> where <inline-formula><mml:math id="inf410"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>▽</mml:mi><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> are of special interest, and such <inline-formula><mml:math id="inf411"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> are referred to as evolutionarily singular points <inline-formula><mml:math id="inf412"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>Evolutionarily singular points can be either attractors or repellers of the evolutionary dynamics described by <xref ref-type="disp-formula" rid="equ16">Equation A8</xref>. Furthermore, an evolutionarily singular point can be either invadable or uninvadable by nearby mutants. For a resident allele with a one-dimensional trait <inline-formula><mml:math id="inf413"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, a classification of singular strategies is straightforward (<xref ref-type="bibr" rid="bib30">Geritz et al., 1998</xref>). Evolutionarily singular points that are not approached, irrespective of whether they are invadable or uninvadable, act as repellers, and we do not expect to ever find resident alleles with such values. Evolutionarily singular strategies that are attractors and uninvadable are endpoints of the evolutionary dynamics. Finally, evolutionarily singular points that are attractors and invadable are known as evolutionary branching points. In this case, any nearby mutant can invade the singular point and coexist with it in a protected dimorphism. Further evolution leads to divergence of the alleles present in the dimorphism. Thus, evolutionary branching points are points in trait space at which diversity emerges (<xref ref-type="bibr" rid="bib30">Geritz et al., 1998</xref>; <xref ref-type="bibr" rid="bib67">Rueffler et al., 2006</xref>).</p><p>The classification of singular points becomes more complicated in multivariate trait spaces or when several strategies coexist in an evolutionarily singular point (<xref ref-type="bibr" rid="bib48">Leimar, 2009</xref>; <xref ref-type="bibr" rid="bib17">Doebeli, 2011</xref>; <xref ref-type="bibr" rid="bib31">Geritz et al., 2016</xref>). First, in multivariate trait spaces or polymorphic populations, whether a singular point is an attractor does not only depend on the direction of the fitness gradient in the vicinity of the singular point but also on the mutational input (<xref ref-type="bibr" rid="bib48">Leimar, 2009</xref>). Second, in multivariate trait spaces or polymorphic populations, for evolutionary branching it is necessary that a singular point is an attractor and invadable. However, in the multidimensional case, this is generally not sufficient any more (<xref ref-type="bibr" rid="bib31">Geritz et al., 2016</xref>).</p><p>In Section ‘The evolutionarily singular point’, we show for our model that a unique singular point <inline-formula><mml:math id="inf414"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> exists. This allele is uninvadable if it is a minimum of <inline-formula><mml:math id="inf415"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> as a function of <inline-formula><mml:math id="inf416"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. This is the case if the <inline-formula><mml:math id="inf417"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>h</mml:mi></mml:mstyle></mml:math></inline-formula>-dimensional Hessian matrix <inline-formula><mml:math id="inf418"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="sans-serif">H</mml:mi></mml:mstyle></mml:math></inline-formula> with entries<disp-formula id="equ17"><label>(A9)</label><mml:math id="m17"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mpadded width="0"><mml:mphantom><mml:mi>p</mml:mi></mml:mphantom></mml:mpadded></mml:mrow></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>is negative definite (<xref ref-type="bibr" rid="bib48">Leimar, 2009</xref>; <xref ref-type="bibr" rid="bib17">Doebeli, 2011</xref>). In Section ‘Derivation of the Hessian matrix of invasion fitness’ we derive an explicit expression for <inline-formula><mml:math id="inf419"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="sans-serif">H</mml:mi></mml:mstyle></mml:math></inline-formula> for the fully general case of our model that allows to determine invadability of <inline-formula><mml:math id="inf420"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> as a function of the positions of the pathogen vectors, the half-saturation constant <inline-formula><mml:math id="inf421"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi></mml:mstyle></mml:math></inline-formula>, and the covariance matrices <inline-formula><mml:math id="inf422"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> that determine the shape of the efficiency functions <inline-formula><mml:math id="inf423"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>e</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>.</p><p>Whether the singular point <inline-formula><mml:math id="inf424"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is an attractor of the evolutionary dynamics can be evaluated based on the Jacobian matrix <inline-formula><mml:math id="inf425"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="sans-serif">J</mml:mi></mml:mstyle></mml:math></inline-formula> of the fitness gradient <inline-formula><mml:math id="inf426"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>▽</mml:mi><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib48">Leimar, 2009</xref>), which is given by<disp-formula id="equ18"><label>(A10)</label><mml:math id="m18"><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">J</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="sans-serif">H</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">Q</mml:mi></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>and where <inline-formula><mml:math id="inf427"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="sans-serif">Q</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is the <inline-formula><mml:math id="inf428"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>h</mml:mi></mml:mstyle></mml:math></inline-formula>-dimensional matrix of mixed derivatives with entries<disp-formula id="equ19"><label>(A11)</label><mml:math id="m19"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mpadded width="0"><mml:mphantom><mml:mi>p</mml:mi></mml:mphantom></mml:mpadded></mml:mrow></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="bibr" rid="bib48">Leimar, 2009</xref>, shows that if the symmetric part of <inline-formula><mml:math id="inf429"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="sans-serif">J</mml:mi></mml:mstyle></mml:math></inline-formula>, i.e., <inline-formula><mml:math id="inf430"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo stretchy="false">(</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="sans-serif">J</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="sans-serif">J</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula>, is negative definite, then the singular point is an attractor of the evolutionary dynamics described by <xref ref-type="disp-formula" rid="equ16">Equation A8</xref> independent of the mutational covariance matrix <inline-formula><mml:math id="inf431"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="sans-serif">C</mml:mi></mml:mstyle></mml:math></inline-formula> and he refers to this case as strong convergence stability. For the case that the Jacobian matrix is a symmetric negative definite matrix, a stronger result holds, to which he refers to as absolute convergence stability (<xref ref-type="bibr" rid="bib47">Leimar, 2002</xref>; <xref ref-type="bibr" rid="bib48">Leimar, 2009</xref>). In this case, all conceivable gradualistic, adaptive paths starting near the point <inline-formula><mml:math id="inf432"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> converge to it. Furthermore, he shows that the condition for absolute convergence stability is equivalent to the existence of a function <inline-formula><mml:math id="inf433"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> having a maximum at <inline-formula><mml:math id="inf434"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and a positive function <inline-formula><mml:math id="inf435"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> such that the gradient of invasion fitness can be expressed as<disp-formula id="equ20"><mml:math id="m20"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>▽</mml:mi><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>▽</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>In Section ‘Absolute convergence stability’, we show for our model that <inline-formula><mml:math id="inf436"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> is indeed absolutely convergence stable.</p><p>For the case of two-dimensional trait spaces, results in <xref ref-type="bibr" rid="bib31">Geritz et al., 2016</xref>, allow us to conclude that if <inline-formula><mml:math id="inf437"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is invadable, then it is indeed an evolutionary branching point. For trait spaces of dimension three or higher, whether convergence stability and invadability imply evolutionary branching is an open problem (<xref ref-type="bibr" rid="bib31">Geritz et al., 2016</xref>). Individual-based simulations indicate, however, that for our model this is indeed the case.</p></sec><sec sec-type="appendix" id="s14-2"><title>Model description</title><p>In this section, we describe the model ingredients. Survival <inline-formula><mml:math id="inf438"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> of a genotype carrying alleles <inline-formula><mml:math id="inf439"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf440"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is a saturating function of condition <inline-formula><mml:math id="inf441"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>c</mml:mi></mml:mstyle></mml:math></inline-formula> and described by the well-known Michaelis-Menten equation<disp-formula id="equ21"><label>(A12)</label><mml:math id="m21"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:msub><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Here, the half-saturation constant <inline-formula><mml:math id="inf442"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi></mml:mstyle></mml:math></inline-formula> gives the condition <inline-formula><mml:math id="inf443"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>c</mml:mi></mml:mstyle></mml:math></inline-formula> at which half of the maximum survival is reached and <inline-formula><mml:math id="inf444"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>s</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> is the maximum survival probability that is approached when <inline-formula><mml:math id="inf445"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>c</mml:mi></mml:mstyle></mml:math></inline-formula> becomes large.</p><p>The condition of a genotype is given by<disp-formula id="equ22"><label>(A13)</label><mml:math id="m22"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:msub><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mfrac><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf446"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>c</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> is the condition of a hypothetical individual with perfect defence against all <inline-formula><mml:math id="inf447"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi></mml:mstyle></mml:math></inline-formula> pathogens and <inline-formula><mml:math id="inf448"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is the efficiency of an allele’s MHC-molecule against pathogen <inline-formula><mml:math id="inf449"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>k</mml:mi></mml:mstyle></mml:math></inline-formula> in an environment with <inline-formula><mml:math id="inf450"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi></mml:mstyle></mml:math></inline-formula> pathogens.</p><p>Without loss of generality, <inline-formula><mml:math id="inf451"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is standardised to 1 (by choosing <inline-formula><mml:math id="inf452"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>c</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ22">Equation A13</xref> appropriately). This is helpful because it allows us to choose an interval of <inline-formula><mml:math id="inf453"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi></mml:mstyle></mml:math></inline-formula>-values where individuals homozygous for the generalist allele have either a condition in the range where survival changes rapidly (<inline-formula><mml:math id="inf454"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>K</mml:mi><mml:mo>&gt;&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) or slowly (<inline-formula><mml:math id="inf455"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi><mml:mo>&lt;&lt;</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula>) with condition. In <xref ref-type="fig" rid="fig4">Figure 4</xref>, <xref ref-type="fig" rid="app5fig1">Appendix 5—figure 1</xref>, the <italic>x</italic>-axis can be translated into survival <inline-formula><mml:math id="inf456"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> of the generalist genotype using <xref ref-type="disp-formula" rid="equ21">Equation A12</xref>, which then varies between 0.01 for <inline-formula><mml:math id="inf457"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> and 0.99 for <inline-formula><mml:math id="inf458"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula>.</p><p>We assume that the efficiencies <inline-formula><mml:math id="inf459"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> of inducing immune defence against the <inline-formula><mml:math id="inf460"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi></mml:mstyle></mml:math></inline-formula> different pathogens are traded off. This trade-off emerges by describing the efficiencies against different pathogens with multivariate Gaussian functions (see <xref ref-type="fig" rid="fig1">Figure 1</xref>) that have pathogen-dependent optima,<disp-formula id="equ23"><label>(A14)</label><mml:math id="m23"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup><mml:munderover><mml:mo>∑</mml:mo><mml:mi>k</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>These function describes how the efficiency of an allele characterised by the <inline-formula><mml:math id="inf461"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>h</mml:mi></mml:mstyle></mml:math></inline-formula>-dimensional vector <inline-formula><mml:math id="inf462"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> decreases with increasing distance from the pathogen vector <inline-formula><mml:math id="inf463"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. The closer an allelic trait vector is to a pathogen vector, the higher is the efficiency of the MHC-molecule against that pathogen. The magnitude of the decrease in efficiency with increasing distance to the <italic>k</italic>th pathogen is determined by the shape and width of the Gaussian function as determined by the <inline-formula><mml:math id="inf464"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>h</mml:mi></mml:mstyle></mml:math></inline-formula>-dimensional covariance matrix <inline-formula><mml:math id="inf465"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>In the main part, we consider the special case of rotationally symmetric Gaussian functions <inline-formula><mml:math id="inf466"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. These matrices are thus specified by an inverse matrix-covariance matrix <inline-formula><mml:math id="inf467"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> (see <xref ref-type="disp-formula" rid="equ23">Equation A14</xref>) that takes the form of a scalar matrix, i.e., a scalar multiple of the identity matrix <inline-formula><mml:math id="inf468"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>I</mml:mi></mml:mstyle></mml:math></inline-formula>. Furthermore, we assume that all Gaussians are of equal width. Hence, we have a common scalar for all Gaussians that we denote with <inline-formula><mml:math id="inf469"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, i.e., <inline-formula><mml:math id="inf470"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi></mml:mstyle></mml:math></inline-formula> is the inverse of the width of the Gaussian function. We refer to <inline-formula><mml:math id="inf471"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> as virulence (see Section ‘Special case: maximal symmetry’, below).<disp-formula id="equ24"><label>(A15)</label><mml:math id="m24"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:msup><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p></sec></sec></app><app id="appendix-8"><title>Appendix 8</title><sec sec-type="appendix" id="s15"><title>Analytical results for the Gaussian model</title><sec sec-type="appendix" id="s15-1"><title>The evolutionarily singular point</title><p>In this section, we analyse the evolutionary dynamics of a monomorphic resident population in full generality. By subsequently applying several symmetry assumptions, we then derive the analytical results presented in the main text (see Sections ‘Special case: identically shaped Gaussian efficiency functions’ and ‘Special case: maximal symmetry’). Invasion fitness of a rare mutant allele <inline-formula><mml:math id="inf472"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in a resident population with allele <inline-formula><mml:math id="inf473"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is given by its marginal fitness,<disp-formula id="equ25"><label>(A16)</label><mml:math id="m25"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>(see derivation of <xref ref-type="disp-formula" rid="equ14">Equation A6</xref>). Note, that <inline-formula><mml:math id="inf474"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>s</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> cancels out. It is therefore omitted from all further calculations. The direction of the evolutionary dynamics is governed by the selection gradient. Its <italic>i</italic>th entry calculates to<disp-formula id="equ26"><label>(A17)</label><mml:math id="m26"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>▽</mml:mi><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mpadded width="0"><mml:mphantom><mml:mi>p</mml:mi></mml:mphantom></mml:mpadded></mml:mrow></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mpadded width="0"><mml:mphantom><mml:mi>p</mml:mi></mml:mphantom></mml:mpadded></mml:mrow></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Using the definitions for <inline-formula><mml:math id="inf475"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>s</mml:mi></mml:mstyle></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ21">Equation A12</xref>) and <inline-formula><mml:math id="inf476"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>c</mml:mi></mml:mstyle></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ22">Equation A13</xref>) and their derivatives,<disp-formula id="equ27"><label>(A18)</label><mml:math id="m27"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>and<disp-formula id="equ28"><label>(A19)</label><mml:math id="m28"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <xref ref-type="disp-formula" rid="equ28">Equation A19</xref> is obtained by applying the generalised product rule<disp-formula id="equ29"><label>(A20)</label><mml:math id="m29"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">(</mml:mo></mml:mrow><mml:munderover><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">(</mml:mo></mml:mrow><mml:munderover><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">)</mml:mo></mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>we obtain<disp-formula id="equ30"><label>(A21)</label><mml:math id="m30"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>▽</mml:mi><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mi>K</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mpadded width="0"><mml:mphantom><mml:mi>p</mml:mi></mml:mphantom></mml:mpadded></mml:mrow></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mi>K</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>In the next step, we calculate the derivative of the function <inline-formula><mml:math id="inf477"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ23">Equation A14</xref>). Applying the chain rule and simplifying results in<disp-formula id="equ31"><label>(A22)</label><mml:math id="m31"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>h</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>h</mml:mi></mml:munderover><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em">(</mml:mo></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>h</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>h</mml:mi></mml:munderover><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>h</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>h</mml:mi></mml:munderover><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where the entries of the matrix <inline-formula><mml:math id="inf478"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> are denoted by <inline-formula><mml:math id="inf479"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>. Using that <inline-formula><mml:math id="inf480"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> for <inline-formula><mml:math id="inf481"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf482"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula> for <inline-formula><mml:math id="inf483"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mstyle></mml:math></inline-formula> this further simplifies to<disp-formula id="equ32"><label>(A23)</label><mml:math id="m32"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>h</mml:mi></mml:munderover><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Substituting <xref ref-type="disp-formula" rid="equ32">Equation A23</xref> into <xref ref-type="disp-formula" rid="equ30">Equation A21</xref> finally results in<disp-formula id="equ33"><label>(A24)</label><mml:math id="m33"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>▽</mml:mi><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mi>K</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>h</mml:mi></mml:munderover><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>and<disp-formula id="equ34"><label>(A25)</label><mml:math id="m34"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>▽</mml:mi><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi>K</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>As mentioned in Section ‘Adaptive dynamics and invasion fitness’, singular points <inline-formula><mml:math id="inf484"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> are allelic trait vectors for which <xref ref-type="disp-formula" rid="equ34">Equation A25</xref> equals zero. From <xref ref-type="disp-formula" rid="equ34">Equation A25</xref> follows that in our model singular points have to fulfil<disp-formula id="equ35"><label>(A26)</label><mml:math id="m35"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Solving for <inline-formula><mml:math id="inf485"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> yields<disp-formula id="equ36"><label>(A27)</label><mml:math id="m36"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>:=</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Thus, the unique singular point <inline-formula><mml:math id="inf486"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> equals the arithmetic mean of the pathogen vectors <inline-formula><mml:math id="inf487"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, each weighted by the inverse of their Gaussian covariance matrices <inline-formula><mml:math id="inf488"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. For a one-dimensional trait space (<inline-formula><mml:math id="inf489"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula>) this simplifies to<disp-formula id="equ37"><label>(A28)</label><mml:math id="m37"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>=:</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>p</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>which is the well-known weighted average for scalars. If <inline-formula><mml:math id="inf490"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>…</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, then <xref ref-type="disp-formula" rid="equ36">Equation A27</xref> simplifies to the arithmetic mean pathogen vector<disp-formula id="equ38"><label>(A29)</label><mml:math id="m38"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>:=</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>as stated in the main text.</p></sec><sec sec-type="appendix" id="s15-2"><title>Absolute convergence stability</title><p>Below, we prove that the unique singular point <inline-formula><mml:math id="inf491"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ36">Equation A27</xref>) is absolutely convergence stable. To this end, we first demonstrate that the gradient of invasion fitness can be expressed as <inline-formula><mml:math id="inf492"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>▽</mml:mi><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>▽</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf493"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math></inline-formula> is a positive function, and then show that <inline-formula><mml:math id="inf494"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is a maximum of <inline-formula><mml:math id="inf495"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><sec sec-type="appendix" id="s15-2-1"><title>Gradient of condition</title><p>An individual homozygote for <inline-formula><mml:math id="inf496"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> has a condition given by<disp-formula id="equ39"><label>(A30)</label><mml:math id="m39"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:msub><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>and the <italic>i</italic>th entry of the gradient <inline-formula><mml:math id="inf497"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi class="MJX-variant">▽</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math></inline-formula> is given by<disp-formula id="equ40"><label>(A31)</label><mml:math id="m40"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>▽</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Substituting <xref ref-type="disp-formula" rid="equ32">Equation A23</xref> into <xref ref-type="disp-formula" rid="equ40">Equation A31</xref> gives<disp-formula id="equ41"><label>(A32)</label><mml:math id="m41"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>▽</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>h</mml:mi></mml:munderover><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>and<disp-formula id="equ42"><label>(A33)</label><mml:math id="m42"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>▽</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>h</mml:mi></mml:munderover><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>By comparing <xref ref-type="disp-formula" rid="equ42">Equation A33</xref> with <xref ref-type="disp-formula" rid="equ34">Equation A25</xref> we see that<disp-formula id="equ43"><label>(A34)</label><mml:math id="m43"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>▽</mml:mi><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi>K</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi>K</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mi>▽</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where the fraction before <inline-formula><mml:math id="inf498"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi class="MJX-variant">▽</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math></inline-formula> is positive. Thus, <inline-formula><mml:math id="inf499"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi class="MJX-variant">▽</mml:mi><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi class="MJX-variant">▽</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math></inline-formula>.</p></sec><sec sec-type="appendix" id="s15-2-2"><title>Hessian matrix of condition</title><p>The Hessian matrix of a homozygote individual’s condition, evaluated at the singular point, is given by the second-order partial derivative of <inline-formula><mml:math id="inf500"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> with respect to the <italic>i</italic>th and <italic>j</italic>th entry of <inline-formula><mml:math id="inf501"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>We obtain this by differentiating <xref ref-type="disp-formula" rid="equ42">Equation A33</xref> with respect of <inline-formula><mml:math id="inf502"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>, evaluated at <inline-formula><mml:math id="inf503"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, resulting in<disp-formula id="equ44"><label>(A35)</label><mml:math id="m44"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>j</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>j</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>h</mml:mi></mml:munderover><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>l</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>and applying the product rule and using that the first derivative at <inline-formula><mml:math id="inf504"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is zero gives<disp-formula id="equ45"><label>(A36)</label><mml:math id="m45"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>h</mml:mi></mml:munderover><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>l</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>j</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where the last simplification uses that <inline-formula><mml:math id="inf505"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:math></inline-formula> for <inline-formula><mml:math id="inf506"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf507"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula> for <inline-formula><mml:math id="inf508"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mstyle></mml:math></inline-formula>, and<disp-formula id="equ46"><label>(A37)</label><mml:math id="m46"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>H</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>which is always negative definite. Thus, <inline-formula><mml:math id="inf509"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is a maximum and <inline-formula><mml:math id="inf510"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is absolute convergence stable.</p></sec></sec><sec sec-type="appendix" id="s15-3"><title>Derivation of the Hessian matrix of invasion fitness</title><p>As stated in <xref ref-type="disp-formula" rid="equ17">Equation A9</xref>, the entries of the Hessian matrix of invasion fitness are given by<disp-formula id="equ47"><label>(A38)</label><mml:math id="m47"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The second derivative of the function <inline-formula><mml:math id="inf511"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>s</mml:mi></mml:mstyle></mml:math></inline-formula> is obtained by differentiating <xref ref-type="disp-formula" rid="equ27">Equation A18</xref> with respect to <inline-formula><mml:math id="inf512"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>y</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>, resulting in<disp-formula id="equ48"><label>(A39)</label><mml:math id="m48"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mpadded width="0"><mml:mphantom><mml:mi>p</mml:mi></mml:mphantom></mml:mpadded></mml:mrow></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>K</mml:mi><mml:mfrac><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">(</mml:mo></mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">)</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mpadded width="0"><mml:mphantom><mml:mi>p</mml:mi></mml:mphantom></mml:mpadded></mml:mrow></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">(</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mpadded width="0"><mml:mphantom><mml:mi>p</mml:mi></mml:mphantom></mml:mpadded></mml:mrow></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mpadded width="0"><mml:mphantom><mml:mi>p</mml:mi></mml:mphantom></mml:mpadded></mml:mrow></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mpadded width="0"><mml:mphantom><mml:mi>p</mml:mi></mml:mphantom></mml:mpadded></mml:mrow></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mpadded width="0"><mml:mphantom><mml:mi>p</mml:mi></mml:mphantom></mml:mpadded></mml:mrow></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>In the final simplification step we use the conclusion drawn from <xref ref-type="disp-formula" rid="equ30">Equation A21</xref> that <inline-formula><mml:math id="inf513"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and therefore the term after the minus sign disappears.</p><p>The second derivative for the function <inline-formula><mml:math id="inf514"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>c</mml:mi></mml:mstyle></mml:math></inline-formula> is obtained by differentiating <xref ref-type="disp-formula" rid="equ28">Equation A19</xref> with respect to <inline-formula><mml:math id="inf515"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>y</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>, resulting in<disp-formula id="equ49"><label>(A40)</label><mml:math id="m49"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mpadded width="0"><mml:mphantom><mml:mi>p</mml:mi></mml:mphantom></mml:mpadded></mml:mrow></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">(</mml:mo></mml:mrow><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">)</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mpadded width="0"><mml:mphantom><mml:mi>p</mml:mi></mml:mphantom></mml:mpadded></mml:mrow></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mfrac><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">(</mml:mo></mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">)</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mpadded width="0"><mml:mphantom><mml:mi>p</mml:mi></mml:mphantom></mml:mpadded></mml:mrow></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>4</mml:mn><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">(</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mpadded width="0"><mml:mphantom><mml:mi>p</mml:mi></mml:mphantom></mml:mpadded></mml:mrow></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mpadded width="0"><mml:mphantom><mml:mi>p</mml:mi></mml:mphantom></mml:mpadded></mml:mrow></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mpadded width="0"><mml:mphantom><mml:mi>p</mml:mi></mml:mphantom></mml:mpadded></mml:mrow></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Here, the one but last simplification step again follows from the fact that <inline-formula><mml:math id="inf516"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>The second derivative for the function <inline-formula><mml:math id="inf517"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>e</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> is obtained by differentiating <xref ref-type="disp-formula" rid="equ32">Equation A23</xref> with respect to <inline-formula><mml:math id="inf518"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>y</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>, resulting in<disp-formula id="equ50"><label>(A41)</label><mml:math id="m50"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">∂</mml:mi><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>h</mml:mi></mml:munderover><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>h</mml:mi></mml:munderover><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">(</mml:mo></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>h</mml:mi></mml:munderover><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">)</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where the last simplification uses that <inline-formula><mml:math id="inf519"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:math></inline-formula> for <inline-formula><mml:math id="inf520"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf521"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula> for <inline-formula><mml:math id="inf522"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mstyle></mml:math></inline-formula>.</p><p>By recursively substituting <xref ref-type="disp-formula" rid="equ48 equ49 equ50">Equations A39–A41</xref> into <xref ref-type="disp-formula" rid="equ17">Equation A9</xref> we obtain<disp-formula id="equ51"><mml:math id="m51"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mi>K</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>4</mml:mn><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">(</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mpadded width="0"><mml:mphantom><mml:mi>p</mml:mi></mml:mphantom></mml:mpadded></mml:mrow></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mpadded width="0"><mml:mphantom><mml:mi>p</mml:mi></mml:mphantom></mml:mpadded></mml:mrow></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">)</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mi>K</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">(</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>h</mml:mi></mml:munderover><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mtext> </mml:mtext><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>l</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>h</mml:mi></mml:munderover><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mtext> </mml:mtext><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>l</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mtext> </mml:mtext><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where in the last step we substituted <xref ref-type="disp-formula" rid="equ32">Equation A23</xref>. This result can be rewritten as a matrix<disp-formula id="equ52"><mml:math id="m52"><mml:mrow><mml:mrow><mml:mi>𝖧</mml:mi><mml:mo rspace="7.5pt">=</mml:mo><mml:mrow><mml:mfrac><mml:mi>K</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="120%" minsize="120%">(</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>𝒙</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>𝒙</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo maxsize="120%" minsize="120%">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="260%" minsize="260%">(</mml:mo><mml:mrow><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:mo maxsize="160%" minsize="160%">(</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="sans-serif">Σ</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="120%" minsize="120%">(</mml:mo><mml:mrow><mml:msub><mml:mi>𝒑</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msup><mml:mi>𝒙</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow><mml:mo maxsize="120%" minsize="120%">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo maxsize="120%" minsize="120%">(</mml:mo><mml:mrow><mml:msub><mml:mi>𝒑</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msup><mml:mi>𝒙</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow><mml:mo maxsize="120%" minsize="120%">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="sans-serif">Σ</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo maxsize="160%" minsize="160%" rspace="7.5pt">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:msubsup><mml:mi mathvariant="sans-serif">Σ</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mrow><mml:mo maxsize="260%" minsize="260%">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Finally, substituting <inline-formula><mml:math id="inf523"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> with <xref ref-type="disp-formula" rid="equ36">Equation A27</xref>, we obtain<disp-formula id="equ53"><label>(A42)</label><mml:math id="m53"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">H</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mi>K</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em">(</mml:mo></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mi>w</mml:mi></mml:msub><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mi>w</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p></sec><sec sec-type="appendix" id="s15-4"><title>Special case: identically shaped Gaussian efficiency functions</title><p>For the special case that the Gaussian covariance matrices <inline-formula><mml:math id="inf524"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> are equal (<inline-formula><mml:math id="inf525"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>…</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula>), fulfilled in <xref ref-type="fig" rid="app5fig1">Appendix 5—figure 1B</xref>, the Hessian matrix simplifies to<disp-formula id="equ54"><label>(A43)</label><mml:math id="m54"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="sans-serif">H</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>K</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em">(</mml:mo></mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:msup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em">)</mml:mo></mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>K</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where we used that <inline-formula><mml:math id="inf526"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is the covariance matrix of the positions <inline-formula><mml:math id="inf527"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> of the pathogen vectors. Since the fraction in <xref ref-type="disp-formula" rid="equ54">Equation A43</xref> is positive and <inline-formula><mml:math id="inf528"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is positive definite, it follows that the definiteness of <inline-formula><mml:math id="inf529"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="sans-serif">H</mml:mi></mml:mstyle></mml:math></inline-formula> is given by the definiteness of the matrix <inline-formula><mml:math id="inf530"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula>. Hence, the singular point <inline-formula><mml:math id="inf531"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is uninvadable whenever<disp-formula id="equ55"><label>(A44)</label><mml:math id="m55"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where the inequality indicates negative definiteness.</p></sec><sec sec-type="appendix" id="s15-5"><title>Special case: maximal symmetry</title><p>For the even more special case that <inline-formula><mml:math id="inf532"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi>I</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and that the pathogen vectors are arranged symmetrically, resulting in <inline-formula><mml:math id="inf533"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi>I</mml:mi></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula>, we obtain<disp-formula id="equ56"><label>(A45)</label><mml:math id="m56"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="sans-serif">H</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:mi>K</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">I</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>In this case, the singular point <inline-formula><mml:math id="inf534"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is a branching point whenever <inline-formula><mml:math id="inf535"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>p</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mstyle></mml:math></inline-formula>. Assuming that all <inline-formula><mml:math id="inf536"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi></mml:mstyle></mml:math></inline-formula> pathogen vectors have an equal distance <inline-formula><mml:math id="inf537"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>d</mml:mi></mml:mstyle></mml:math></inline-formula> to each other implies that they are arranged in an <inline-formula><mml:math id="inf538"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula>-dimensional regular simplex (see <xref ref-type="fig" rid="fig1">Figure 1</xref>). For this case, <inline-formula><mml:math id="inf539"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>p</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mi>d</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math></inline-formula>, and we obtain the branching condition <inline-formula><mml:math id="inf540"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>2</mml:mn><mml:msqrt><mml:mi>m</mml:mi></mml:msqrt></mml:mrow></mml:mstyle></mml:math></inline-formula>. Assuming pathogen distance <inline-formula><mml:math id="inf541"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula> and substitute <inline-formula><mml:math id="inf542"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> as virulence <inline-formula><mml:math id="inf543"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi></mml:mstyle></mml:math></inline-formula>, we obtain<disp-formula id="equ57"><label>(A46)</label><mml:math id="m57"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>2</mml:mn><mml:msqrt><mml:mi>m</mml:mi></mml:msqrt><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p></sec></sec></app></app-group></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.94587.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Ispolatov</surname><given-names>Yaroslav</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02ma57s91</institution-id><institution>University of Santiago Chile</institution></institution-wrap><country>Chile</country></aff></contrib></contrib-group></front-stub><body><p>This important theoretical and numerical study deals with a contemporary topic in evolutionary biology, immunology and population genetics. The structure of the models and the analytic framework used are relevant and sound, and the combination of two types of models is a powerful approach that produces compelling evidence to support the hypothesis on the role of heterozygote advantage in maintaining MHC gene polymorphism. The description of the models is easy to follow, and the paper would be of interest to specialists in evolution, immunology, and the general <italic>eLife</italic> readership.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.94587.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Ispolatov</surname><given-names>Yaroslav</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02ma57s91</institution-id><institution>University of Santiago Chile</institution></institution-wrap><country>Chile</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Ispolatov</surname><given-names>Yaroslav</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02ma57s91</institution-id><institution>University of Santiago Chile</institution></institution-wrap><country>Chile</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>[Editors’ note: the authors submitted for reconsideration following the decision after peer review. What follows is the decision letter after the first round of review.]</p><p>Thank you for submitting your work entitled &quot;Heterozygote advantage can explain the extraordinary diversity of immune genes&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, one of whom is a member of our Board of Reviewing Editors, and the evaluation has been overseen by a Senior Editor. The reviewers have opted to remain anonymous.</p><p>Our decision has been reached after consultation between the reviewers. Based on these discussions and the individual reviews below, we regret to inform you that your work will not be considered further for publication in <italic>eLife</italic>. However, we would like to keep open the possibility for a new submission of a substantially revised manuscript.</p><p>The reviewers were somewhat divided in their assessment, but it is clear from the comments and the editorial discussion that your paper contains novel ideas and insights that could be relevant for a wide audience. The conclusion that heterozygote advantage can in principle explain high degrees of diversity at MHC loci is important. However, the reviewers also identified a number of shortcomings in the paper. Specifically:</p><p>1) The biological relevance of the assumptions underlying the model is unclear. In particular, it is not clear whether the model assumptions are realistic enough, particularly compared to previous &quot;bitstring&quot; approaches.</p><p>2) There are also a number of mathematical assumptions that are questionable, as pointed out in the reviews.</p><p>Overall, the scope of the model would need to be considerably expanded in order to address the points raised by the reviewers. If you choose to revise and resubmit, please address all points raised by the reviewers. We would likely send a revised version of the paper to additional reviewers for evaluation.</p><p><italic>Reviewer #1:</italic></p><p>This is a very interesting theoretical paper addressing the extraordinary amounts of polymorphism found at MHC loci. The paper shows convincingly that heterozygote advantage can generate coexistence of hundreds of different alleles when there is a tradeoff between the protection that a given allele provides against different pathogens. This result is obtained when the number of different pathogens is not small. The paper is well written, the analysis is sound, and even though the paper is purely theoretical, it will be of interest to a wide audience because of the simplicity of the theoretical principle at work, and because of the importance of the topic.</p><p>Some comments:</p><p>1. It never becomes clear what the significance is of the number of &quot;modules&quot; assumed to make up an allele. This number is assumed to be 10 in the paper, but it would be interesting to know how the model behaves when this number is varied. Presumably, the higher the number of modules, the higher the number of different alleles that can be maintained.</p><p>2. A number of recent papers (including ones by the senior author) have studied the effects of the dimension of phenotype space on the amount of diversity that can be maintained. The number of modules mentioned above could probably be interpreted as the dimension of phenotype space (in some sense), and based on that, I think the authors should discuss their results in the context of previous work about high-dimensional phenotype spaces.</p><p>3. The number of different pathogens, m, also plays the role of a dimension, in this case the dimension of the external environment. The authors show that as this dimension is increased, the number of alleles that can coexist also increases. Again, this finding should be discussed in the context of the effect of dimension on the amount of diversity.</p><p>4. The model assumes that the pathogens are fixed. It would be interesting to know what happens if the pathogens themselves also underwent evolutionary dynamics. I think the authors should at least speculate about the effects of including this complication in the model.</p><p>5. Another connection that should be made much clearer is the relationship of the model that the authors are using to Levene type models for the evolution of habitat specialization. There are some clear paralleles between these two modelling approaches, and this should be discussed and put into context. In fact, I think in some abstract sense, the results that the authors are reporting could be directly translated to certain ecological scenarios of habitat specialization, with the prediction that high-dimensional phenotypes and high-dimensional external habitat structure can lead to large amounts of coexisting diversity, simply based on habitat preference.</p><p>6. The authors argue (convincingly) that coexistence of different alleles is due to heterozygote advantage. In general, coexistence of the type described here is always due to some form of frequency dependence, in the sense that each of the coexisting alleles has an advantage when rare. It would be good if the authors could make this connection between heterozygote advantage and frequency dependence explicit (with the latter being a more general concept).</p><p>7. The authors mention that they assume multiplicativity for the effects of pathogens (Equation1). Does the whole theory break down with additivity? It would be good to include more comments on this.</p><p>8. Likewise, the authors assume codominance in Equation 1. What about other dominance modes? E.g. what about multiplicative effects of the two alleles? Presumably, the results would be rather different in this case…</p><p>9. l. 98: the indices i and j appear out of the blue at this point, and it is not clear in what sense they characterize an individual.</p><p><italic>Reviewer #2:</italic></p><p>Review of Heterozygote advantage can explain the extraordinary diversity of immune genes.</p><p>First I should say that I focus on the immunological aspects of this paper and am not familiar with the population genetic aspects and leave these to a referee more versed in the area. There are also a number of theoretical immunologists who have worked in the area of immune recognition by MHC who would likely know this area better than myself. In particular I would refer to Borgans and De Boer's work in this area.</p><p>I found it hard to follow the biological underpinnings of some of the paper and will try to explain why. My questions are indicated on lines beginning with a ?</p><p>The paper tackles the problem of understanding the causes of MHC diversity. Why are there so many alleles at each locus of the MHC. It would be good if the authors gave us an idea of the extent of the number of alleles that are found at each MHC locus, so we can get an idea of the magnitude of the diversity we are trying to explain. The approach, as far as I could tell is as follows:</p><p>1. The authors use what looks similar to previous bitstring model to describe the extent to which a given MHC provides protection against a given pathogen. Each MHC is given by an m-dimensional vector m as is each pathogen which is given by p.</p><p>2. The efficiency of a given MHC in controlling a given pathogen decreases with increasing euclidian distance between the vectors m and p. I.e. e(p-x)</p><p>3. The overall efficiency of a given individual against a pathogen is the sum of the efficiencies of its two MHC alleles at controlling the pathogen.</p><p>4. The efficiency of an individual against an ensemble of m pathogen c is the product of the efficiency of that individual for controlling each pathogen.</p><p>This is basically equation (i)</p><p>5. Selection is a function of c above.</p><p>6. They follow the evolutionary dynamics of alleles of MHC in a diploid population of size N.</p><p>7. The key results are in Figure 3. The degree of MHC diversity maintained increases with increases in the number of pathogens the degree of pathogen dissimilarity and occurs at intermediate levels of the half saturation constant K.</p><p>Comments in order of being encountered in the paper.</p><p>1. Why not use the earlier bitstring models rather than a new model. What is the justification of letting the elements of m and p be real numbers (and what determines how large these numbers can be?).</p><p>2. Why have c_max or whether the 2 is needed in Equation 1</p><p>3. What is the degree of selection that the pathogens chosen impose? Is it biologically reasonable given what we know about MHC?</p><p>4. The number of pathogens appears limited to a max of 8 why? How does it scale for more reasonable numbers.</p><p>5. Why have models with symmetry in distances between pathogens as in version 1.</p><p>6. I don't see the need for recombination … there can be different MHC generated by mutation.</p><p>7. Is it necessary to use an idea of generalist – it is supported by a single paper and not potentially yet part of mainstream immunology.</p><p>8. From 3 it seems that a key feature is the degree of dissimilarity. A search of the document does not find it being defined? What are biologically plausible values for this parameter?</p><p>9. Does the model make any predictions that allow discrimination or rejection of current hypotheses?</p><p>Overall I found it hard to follow the paper. To a large extent may be because I am not an expert in population genetics. More problematic was the difficulty I found understanding the details of the connection with immunology and lack of parameterization of biologically reasonable parameter regimes. I would be more convinced about the claims of the authors if the above questions were addressed. Finally I believe that either Jose Borghans or Rob De Boer would be very well suited to review the paper.</p><p><italic>Reviewer #3:</italic></p><p>There are good reasons to assume that individuals with two different alleles at an MHC locus are better protected against pathogen-induced disease (and, hence, have a higher fitness) than individuals that are homozygous for any of these alleles. Based on this, it has been argued that such heterozygote advantage may explain the high degree of polymorphism found at MHC loci. However, there is a problem with this argument. In principle, an arbitrary large number of alleles can be kept in the population by heterozygote advantage, but this is only possible if (1) all heterozygotes have a similarly high fitness, while (2) all homozygotes have a similarly low fitness. If the fitness effects of MHC alleles are drawn at random, it is unlikely that these conditions are satisfied. For this reason, earlier studies concluded that heterozygote advantage is most likely not the only factor explaining the high degree of MHC diversity. In the present study, the authors demonstrate that, in principle, the heterozygote-advantage hypothesis can be rescued if the current MHC alleles did not 'fall from the air' (i.e. were created by random mutation of large effect size) but instead were shaped by gradual evolution (based on the rare influx of mutations of small effect size). The authors argue that (under suitable conditions) this evolution process has the tendency to shape MHC alleles in such a way that conditions (1) and (2) are satisfied, hence allowing the stable coexistence of many (even hundreds) of MHC alleles.</p><p>The study shows that probability calculations, as in earlier studies, have to be taken with care, since the current MHC alleles may not be a random sample from a universe of possibilities but rather the product of diversifying evolution. This insight is interesting and important.</p><p>I am less impressed by the model that is used to illustrate their point. Most importantly, fitness (survival) is assumed to be a function of 'condition,' which in turn is defined in a rather specific manner (Equations 1 and 2). To me, it would have been plausible to define survival directly by the product term in Equation 1 (overall survival results from surviving many pathogen-induced challenges), but now this term is plugged into a saturating Michaelis-Menten function. Due to this transformation (which is not motivated well), conditions (1) and (2) are much more easily satisfied. I would like to see the same analysis, but now for the more plausible assumption that condition corresponds to viability. I would also have appreciated if the authors had applied their method to other fitness functions, like the one in De Boer et al. (2004), in order to work out more clearly why the authors arrive at conclusions that contrast with those of earlier studies.</p><p>The authors use an adaptive dynamics approach for modelling the fine-tuning of MHC alleles. I wonder whether this kind of approach, which is based on continuously varying traits and very rare mutations of very small effect size is realistic in the context of MHC evolution. Mutations of MHC alleles seem to occur frequently, and even point mutations do often have a large effect. In other words, the genotypic-phenotype mapping is most probably quite intricate, making some baseline assumptions of the model (e.g. Gaussian distribution of effect sizes) questionable. The study would have been more convincing if the authors would have incorporated more realistic assumptions on the action of MHC alleles in their individual-based simulations, rather than just mimicking the assumptions of their analytical model.</p><p>[Editors’ note: further revisions were suggested prior to acceptance, as described below.]</p><p>Thank you for resubmitting your work entitled &quot;Heterozygote advantage can explain the extraordinary diversity of immune genes&quot; for further consideration by <italic>eLife</italic>. Your revised article has been evaluated by Detlef Weigel (Senior Editor) and a Reviewing Editor.</p><p>The manuscript has been improved but there are some remaining issues that need to be addressed, as outlined below:</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>The MHC genes encode proteins that bind antigenic oligopeptides and present them to receptors on immune cells. Successful presentation of antigens to immune T cells by the MHC is the key stage in the immune response to pathogens. While T cell receptors are variable and can adapt during the process of clonal selection, the MHC repertoire is inherited from parents and does not change during an individual's lifetime. Any pathogen genotype that escapes presentation by the MHC is able to reproduce at a higher rate due to the lack of initiation of an effective immune response. MHC genes are under strong natural selection for efficient binding of pathogen antigens, but surprisingly are often represented by hundreds of alleles (variants) in natural populations of vertebrates. In addition, MHC genes are often characterised by extremely long genealogies. These two features of MHC genes are particularly difficult to reconcile with strong natural selection, which usually results in low genetic polymorphism and often a short coalescence time. The paper by Sijestam and Rueffler investigates the role of one of the key balancing selection forces, the so-called heterozygote advantage, which has been hypothesised to maintain MHC gene polymorphism.</p><p>Strengths</p><p>The manuscript is clearly written and deals with a current and important topic in evolutionary biology, immunology and population genetics.</p><p>The structure of the models presented and the framework used are sound, with one of the models based on a classic theoretical work in the field and predict results that contradict the majority of recent theory on the evolution of MHC gene polymorphism.</p><p>The description of the models is easy to follow. The combination of two types of models ('Gaussian model' and 'bit-string model') is a powerful approach to test the hypothesis on the role of heterozygote advantage in maintaining MHC gene polymorphism.</p><p>The authors list two key assumptions of their model, which they believe are responsible for the conclusion of the paper. However, only one of these assumptions actually provides fundamental support for the role of heterozygote advantage in maintaining MHC gene polymorphism. Recent models show that the Red Queen process is able to maintain high levels of MHC polymorphism despite the mortality of hosts that respond poorly to infections (see detailed comments).</p><p>The work has the potential to shed new light on the long-standing debate about the importance of the Red Queen process vs. heterozygote advantage as a balancing selective force that maintains MHC gene polymorphism, although further analysis is needed to address concerns about some of the model assumptions made.</p><p>Weaknesses</p><p>There are two fundamental weaknesses in the manuscript, as the models in their current form and without additional analyses do not have sufficient scientific strength to restore the heterozygote advantage as a force capable of maintaining high genetic polymorphism of the MHC. First, because some of the assumptions used to model heterozygous advantage differ from those used in previous studies (suggestions I, II below). Second, because there is no reference to the Red Queen, which a balancing selection force currently receiving considerable attention in studies of MHC polymorphism (suggestion III). I also strongly believe that my concerns about the current limited power of the conclusions presented by the authors can be addressed by adding the suggested analyses. This could be quite a lot of work, but the analyses do not need to be performed in the full parameter space but are mandatory for the paper to be of the highest scientific quality. Here is a short list of the analyses that need to be added (see below for a more detailed description): (I.) In the Gaussian model, add analysis of pathogen peptides evolving by genetic drift by allowing Brownian motion to move the pathogen distribution in allele trait space. (II.) In the bit-string model, add analysis of pathogens evolving by genetic drift. (III.) Add simulations with only the Red Queen process operating (e.g. by simulating haploid hosts co-evolving with pathogens). However, it is necessary that all current assumptions of the bit-string model remain unchanged (including the relationship between infection outcome and host fitness), except for the addition of pathogens co-evolving with hosts.</p><p>- The authors do not communicate, or perhaps do so in a way that can be easily overlooked by the reader, the fundamental conceptual challenge associated with testing the role of heterozygote advantage in host-pathogen evolution. By this, I mean that heterozygote advantage can only be modelled or tested in the absence of host-pathogen coevolution, because coevolution generates negative frequency-dependent selection (the Red Queen process). Without this explanation, the fact that pathogens do not evolve in the model may seem ridiculous to the reader. This aspect needs to be clear from the point at which the model is described, or perhaps even from the introduction.</p><p>- In this model, pathogens do not reproduce, and I have explained above why authors cannot indeed link pathogen fitness to the host immune response if they want to test heterozygote advantage in the absence of the Red Queen process. However, as I understood from the description, pathogens in the bit-string model consist of random pools of peptides: &quot;In the bit-string model, the m pathogens are each given npep randomly drawn bit-strings&quot;, and in the Gaussian model, the centres of the pathogens do not change their position in the allele trait space. The consequence of this assumption would be an evolutionary process that stops far in the future (pathogens are constant over time). Even if I am wrong and pathogens are randomly generated in each generation, this will still be incorrect because the model artificially assumes the maximum possible genetic diversity of pathogen peptides, which combined with the way fitness is calculated (similar to a geometric mean) would only favour a large number of alleles under heterozygote advantage. Furthermore, such an unrealistically high genetic diversity of oligopeptides simulates pathogen populations of much larger effective size than in real populations. A proper model for modelling heterozygote advantage would require modelling pathogens evolving by genetic drift. Even if the authors do not agree with my point, they should include the scenario in which pathogens evolve by genetic drift, as this has been assumed in previous models addressing the question of the role of heterozygote advantage and Red Queen on MHC polymorphism. Pathogens evolving by genetic drift are easily implemented in the bit-string model. In the Gaussian model, I would suggest introducing Brownian motion of pathogen distributions. It is very unrealistic to assume that pathogens would occupy a stationary point in the allelic trait space over so many generations, rather than moving.</p><p>- Host fitness is calculated using geometric mean mechanics, which forces the MHC allele (in a hypothetic haploid individual) to be located in the middle of the pathogen distributions located in allele trait space. This is a very strong assumption and differs from other theoretical studies of MHC gene polymorphism (e.g. Borghans et al. 2004, Ejsmond and Radwan 2015). Note, that I do not say that this is an incorrect assumption. Perhaps natural systems differ in the way infections affect host fitness. Anyway, the lack of modelling of other balancing selection forces in the presented work, namely the Red Queen (negative frequency dependence), leaves the reader with a big question mark as to the extent to which the result presented by authors is driven by the specificity of the model or the assumption that immune response and fitness scale in a 'geometric mean'-like manner. Thus, I think the Red Queen process scenario needs to be added, and my suggestion should not be taken as a suggestion of adding an additional analysis beyond the scope of this paper. Each model has its own specificity and it is necessary to know what the levels of polymorphism are when the Red Queen process is simulated. My expectation would be that if fitness is calculated in the way the authors did, the Red Queen process will maintain few alleles. This would be a strong message emerging from this study and the previous literature that heterozygote advantage or the Red Queen process can maintain polymorphism depending on the distribution of fitness effects of infections by different pathogen species.</p><p>- The authors should comment on the fact that the MHC gene polymorphism in their model would break down in the presence of several highly virulent pathogen species (narrow distributions in the Gaussian model) and under more realistic assumptions for pathogen classes e.g. helminths, i.e. a large number of antigenic oligopeptides (Figure 5 for v=5).</p><p>- The assumption (a) that pathogens are lethal in the absence of an appropriate immune response does not support the role of heterozygote advantage in maintaining MHC gene polymorphism as suggested by the authors. See the model of Ejsmond et al. 2023 ('Adaptive immune response selects for postponed maturation and increased body size'), where hosts with a poor response to pathogens also die, but high MHC gene polymorphism is maintained in particular by the Red Queen process. However, note also that Ejsmond et al. assumed that infections affect fitness proportionally, which is contrary to assumption (b) in the reviewed paper. I would suggest reducing the importance of the first assumption or discussing alternative models that show that the Red Queen process is able to maintain high MHC gene polymorphism despite assumption (a). I believe that the difference in assumption (b) is fundamental to the conclusions derived from this paper and other models.</p><p>- Show information about the proportion of hosts in the population dying per generation under main simulated scenarios</p><p>- Consider renaming 'allelic trait space' to epitope or agretope space</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.94587.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p>[Editors’ note: the authors resubmitted a revised version of the paper for consideration. What follows is the authors’ response to the first round of review.]</p><disp-quote content-type="editor-comment"><p>The reviewers were somewhat divided in their assessment, but it is clear from the comments and the editorial discussion that your paper contains novel ideas and insights that could be relevant for a wide audience. The conclusion that heterozygote advantage can in principle explain high degrees of diversity at MHC loci is important. However, the reviewers also identified a number of shortcomings in the paper. Specifically:</p><p>1) The biological relevance of the assumptions underlying the model is unclear. In particular, it is not clear whether the model assumptions are realistic enough, particularly compared to previous &quot;bitstring&quot; approaches.</p><p>2) There are also a number of mathematical assumptions that are questionable, as pointed out in the reviews.</p><p>Overall, the scope of the model would need to be considerably expanded in order to address the points raised by the reviewers. If you choose to revise and resubmit, please address all points raised by the reviewers. We would likely send a revised version of the paper to additional reviewers for evaluation.</p></disp-quote><p>We appreciate the opportunity to revise our manuscript and thank the reviewers for their insightful comments. We have made significant revisions to the manuscript, and are confident that we have adequately addressed the reviewers' comments (see especially our responses to Reviewer 2 and Reviewer 3 below).</p><p>First, we have clarified the ecological assumptions underlying our model and provided stronger motivation and interpretation from a biological standpoint. Specifically, we highlight two crucial assumptions about how pathogens affect the host, which form the basis for our results:</p><list list-type="alpha-lower"><list-item><p>Each pathogen is assumed to be able to cause mortality if not kept at bay by the immune system.</p></list-item><list-item><p>The combined effect of multiple pathogens on host survival exceeds the sum of the effects of each pathogen alone.</p></list-item></list><p>We refer to our response to reviewer 3 for more a more detailed motivation. Under assumption(a) and (b), we show that fitness values emerge such that heterozygote advantage (HA) alone can lead to very high allelic diversity. These assumptions are, in our model, realized by Equation4 and 5, respectively.</p><p>Second, we now include a completely new section where we present a ‘bitstring’ type model to more mechanistically model MHC interactions with pathogens. This bitstring-approach has been used in several prior studies (e.g., Borghans <italic>et al.</italic> 2004, Ejsmond and Radwan 2011, 2015). Our 'bitstring' model qualitatively reproduces the results of our original Gaussian model, thereby confirming that the observed high levels of allelic polymorphism are not due to some specific dynamics exclusive to our Gaussian model, but are a more general outcome resulting from fitness assumptions (a) and (b).</p><disp-quote content-type="editor-comment"><p>Reviewer #1 (General assessment and major comments (Required)):</p><p>This is a very interesting theoretical paper addressing the extraordinary amounts of polymorphism found at MHC loci. The paper shows convincingly that heterozygote advantage can generate coexistence of hundreds of different alleles when there is a tradeoff between the protection that a given allele provides against different pathogens. This result is obtained when the number of different pathogens is not small. The paper is well written, the analysis is sound, and even though the paper is purely theoretical, it will be of interest to a wide audience because of the simplicity of the theoretical principle at work, and because of the importance of the topic.</p></disp-quote><p>Thank you very much for the positive evaluation of our work.</p><disp-quote content-type="editor-comment"><p>Some comments:</p><p>1. It never becomes clear what the significance is of the number of &quot;modules&quot; assumed to make up an allele. This number is assumed to be 10 in the paper, but it would be interesting to know how the model behaves when this number is varied. Presumably, the higher the number of modules, the higher the number of different alleles that can be maintained.</p></disp-quote><p>We agree that these parameters can be interpreted as dimensions in the phenotype and environment spaces, respectively.</p><p>In the revised version, we do not use the term “module” anymore and we reformulated our explanation for why we consider trait spaces that have the dimension one less than the number of pathogens.</p><disp-quote content-type="editor-comment"><p>2. A number of recent papers (including ones by the senior author) have studied the effects of the dimension of phenotype space on the amount of diversity that can be maintained. The number of modules mentioned above could probably be interpreted as the dimension of phenotype space (in some sense), and based on that, I think the authors should discuss their results in the context of previous work about high-dimensional phenotype spaces.</p><p>3. The number of different pathogens, m, also plays the role of a dimension, in this case the dimension of the external environment. The authors show that as this dimension is increased, the number of alleles that can coexist also increases. Again, this finding should be discussed in the context of the effect of dimension on the amount of diversity.</p></disp-quote><p>We believe that the reviewer is referring, amongst others, to the following papers:</p><p>Doebeli and Ispolatov (2010 Science)</p><p>Debarre et al. (2014 AmNat)</p><p>Svardal et al. (2014 Evolution)</p><p>These papers investigate in a resource competition context whether the dimensionality of the consumer trait space facilitates whether a monomorphic consumer population splits into two, but do not address how the dimensionality of the trait space affects final diversity. Furthermore, in these studies, evolutionary branching is driven by negative frequency-dependent selection at the level of the phenotypes. This is not the case in our model, where branching is driven by HA. We therefore chose to not discuss our results in the context of the papers mentioned above.</p><p>Débarre F, Nuismer SL, Doebeli M. Multidimensional (co)evolutionary stability. Am Nat. 2014 Aug;184(2):158-71. doi: 10.1086/677137. Epub 2014 Jul 8. PMID: 25058277.</p><p>Doebeli M, Ispolatov I. Complexity and diversity. Science. 2010 Apr 23;328(5977):494-7. doi:</p><p>10.1126/science.1187468. PMID: 20413499.</p><p>Svardal H, Rueffler C, Doebeli M. Organismal complexity and the potential for evolutionary diversification. Evolution. 2014 Nov;68(11):3248-59. doi: 10.1111/evo.12492. Epub 2014 Sep 2. PMID: 25087681.</p><disp-quote content-type="editor-comment"><p>4. The model assumes that the pathogens are fixed. It would be interesting to know what happens if the pathogens themselves also underwent evolutionary dynamics. I think the authors should at least speculate about the effects of including this complication in the model.</p></disp-quote><p>In the discussion of the revised manuscript, we have included a paragraph discussing evolutionary dynamics in the pathogens [Line 450-465]. We speculate that evolving pathogens could lead to regions of the parameter space where polymorphism can evolve by HA.</p><disp-quote content-type="editor-comment"><p>5. Another connection that should be made much clearer is the relationship of the model that the authors are using to Levene type models for the evolution of habitat specialization. There are some clear paralleles between these two modelling approaches, and this should be discussed and put into context. In fact, I think in some abstract sense, the results that the authors are reporting could be directly translated to certain ecological scenarios of habitat specialization, with the prediction that high-dimensional phenotypes and high-dimensional external habitat structure can lead to large amounts of coexisting diversity, simply based on habitat preference.</p></disp-quote><p>At a first glance, our model may seem similar to Levene-type island models. However, we disagree that there is a structural similarity to our model. Polymorphism in island models is generally driven by negative frequency dependence acting at the level of the phenotype, resulting in local adaptation. In contrast, polymorphism in our model is driven by HA arising from selection to resist all pathogens. As a consequence, in our model fitness is strictly multiplicative while in island models fitness has a strong additive component.</p><disp-quote content-type="editor-comment"><p>6. The authors argue (convincingly) that coexistence of different alleles is due to heterozygote advantage. In general, coexistence of the type described here is always due to some form of frequency dependence, in the sense that each of the coexisting alleles has an advantage when rare. It would be good if the authors could make this connection between heterozygote advantage and frequency dependence explicit (with the latter being a more general concept).</p></disp-quote><p>There are indeed different forms of negative frequency dependence leading to coexistence, where HA is just one. We now discuss the connection between HA and the more general concept of negative frequency dependence in more detail [Line 426-449].</p><disp-quote content-type="editor-comment"><p>7. The authors mention that they assume multiplicativity for the effects of pathogens (Equation1). Does the whole theory break down with additivity? It would be good to include more comments on this.</p></disp-quote><p>We now state explicitly that our results rely on assumptions (a) and (b) (as stated in our response to the editor). Both of these assumptions are essential for the coexistence of a large number of alleles. The first assumption (a) posits that a single pathogen can be lethal if an immune response is lacking. In our model, this assumption is fulfilled due to the multiplicativity in Equation (4). Indeed, assuming that pathogens affect host fitness additively dramatically reduce the number of coexisting alleles.</p><disp-quote content-type="editor-comment"><p>8. Likewise, the authors assume codominance in Equation 1. What about other dominance modes? E.g. what about multiplicative effects of the two alleles? Presumably, the results would be rather different in this case…</p></disp-quote><p>We choose codominance in our model because it seems to be a valid representation for MHC alleles. Dominance results in a higher degree of HA compared to codominance, which in turn leads to a slightly larger number of coexisting alleles (results not shown). In our study, we chose codominance as it provides more conservative estimates regarding the extent of allelic polymorphism. This rationale is now explicitly addressed in the revised manuscript at Line 161-165.</p><p>To the best of our knowledge, there is no literature suggesting a multiplicative effect between two alleles at an MHC locus. In our model, efficiencies range from 0 to 1. Utilizing multiplicative effects, rather than codominance, would result in a model akin to recessivity but even more restrictive. The prevailing theories regarding MHC alleles, such as the HA hypothesis (Doherty and Zinkernagel 1975) and the rare allele advantage hypothesis (Apanius <italic>et al.</italic> 2017), suggest that an individual can benefit already from a single allele at a diploid MHC locus.</p><p>To offer a simplified mechanistic explanation: each allele at an MHC locus produces its own specific MHC molecule, regardless of whether it is present in one or two copies. This leaves us with two scenarios: either the amount of gene product is proportional to the number of alleles or, due to dosage compensation, a single copy or two copies result in the same amount of gene product. These two cases correspond to codominance or full dominance, respectively.</p><p>Apanius V, Penn D, Slev PR, Ruff LR, Potts WK. The nature of selection on the major histocompatibility complex. Crit Rev Immunol. 1997. 17:179-224.</p><p>Doherty PC, Zinkernagel RM. Enhanced immunological surveillance in mice heterozygous at the H-2 gene complex. Nature. 1975. 256:50-2.</p><disp-quote content-type="editor-comment"><p>9. l. 98: the indices i and j appear out of the blue at this point, and it is not clear in what sense they characterize an individual.</p></disp-quote><p>We have now clarified the meaning of i and j, which are giving the index of the alleles of an individual [L. 169]</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (General assessment and major comments (Required)):</p><p>Review of Heterozygote advantage can explain the extraordinary diversity of immune genes.</p><p>First I should say that I focus on the immunological aspects of this paper and am not familiar with the population genetic aspects and leave these to a referee more versed in the area. There are also a number of theoretical immunologists who have worked in the area of immune recognition by MHC who would likely know this area better than myself. In particular I would refer to Borgans and De Boer's work in this area.</p><p>I found it hard to follow the biological underpinnings of some of the paper and will try to explain why. My questions are indicated on lines beginning with a ?</p><p>The paper tackles the problem of understanding the causes of MHC diversity. Why are there so many alleles at each locus of the MHC. It would be good if the authors gave us an idea of the extent of the number of alleles that are found at each MHC locus, so we can get an idea of the magnitude of the diversity we are trying to explain. The approach, as far as I could tell is as follows:</p><p>1. The authors use what looks similar to previous bitstring model to describe the extent to which a given MHC provides protection against a given pathogen. Each MHC is given by an m-dimensional vector m as is each pathogen which is given by p.</p><p>2. The efficiency of a given MHC in controlling a given pathogen decreases with increasing euclidian distance between the vectors m and p. I.e. e(p-x)</p><p>3. The overall efficiency of a given individual against a pathogen is the sum of the efficiencies of its two MHC alleles at controlling the pathogen.</p><p>4. The efficiency of an individual against an ensemble of m pathogen c is the product of the efficiency of that individual for controlling each pathogen.</p><p>This is basically equation (i)</p><p>5. Selection is a function of c above.</p><p>6. They follow the evolutionary dynamics of alleles of MHC in a diploid population of size N.</p><p>7. The key results are in Figure 3. The degree of MHC diversity maintained increases with increases in the number of pathogens the degree of pathogen dissimilarity and occurs at intermediate levels of the half saturation constant K.</p><p>Comments in order of being encountered in the paper.</p><p>1. Why not use the earlier bitstring models rather than a new model. What is the justification of letting the elements of m and p be real numbers (and what determines how large these numbers can be?).</p></disp-quote><p>In our revised manuscript, we have included a completely new section analysing a bitstring model, inspired by Borghans et al. (2004). The bitstring model has both pros and cons and serves as a useful complement to our Gaussian model. The bit-string approach offers a more mechanistic way to define the trade-offs involved in inducing an immune defence against different pathogens. It does, however, not allow for an analytical analysis and also leads to highly specific behaviour in the trade-off dynamics. In contrast, our Gaussian model is not mechanistic but offers a more mathematically flexible definition of the trade-offs, making fewer assumptions in the process.</p><p>In the revised manuscript, we demonstrate that the bit-string model yields qualitatively similar results to the Gaussian model, showing that the key to our findings is the combination of host-pathogen assumptions (a) and (b), (see above), as well as the presence of some form of trade-off, whether modelled through the Gaussian or bit-string approach.</p><disp-quote content-type="editor-comment"><p>2. Why have c_max or whether the 2 is needed in Equation 1</p></disp-quote><p>In our model, <italic>c</italic><sub>max</sub> serves as a scaling constant to standardize the condition of the optimal homozygote <italic>c</italic>(<italic>x</italic>*, <italic>x</italic>*) to 1.</p><p>For our purpose, we are interested in situations where – during the evolutionary process – realized survival probabilities cover a large range of the interval between zero and one. One way to achieve this, is, since evolution passes through the generalist allele, to standardize the condition of individuals homozygous for the generalist allele such that it is in the vicinity of <italic>K</italic>, the condition value for which survival equals one half. By choosing <italic>c</italic><sub>max</sub> such that <italic>c(x*, x*)=1</italic>, we can now choose <italic>K</italic>-values such that our goal is fulfilled, as visible from the x-axes in the lower panel of Figure 3 and in Figure 6B-D.</p><p>The division by 2 in Equation4 is included to reflect the assumption of codominance, whereby the average phenotype is expressed when two different alleles are present</p><disp-quote content-type="editor-comment"><p>3. What is the degree of selection that the pathogens chosen impose? Is it biologically reasonable given what we know about MHC?</p></disp-quote><p>In our model, the degree of selection imposed by pathogens does not depend on any fixed values, but is an emergent property. If our host-pathogen assumptions (a) and (b) are fulfilled and the trade-off in a host’s ability to adapt to different pathogens is sufficiently strong, then evolution results in allelic values that are able to coexist.</p><disp-quote content-type="editor-comment"><p>4. The number of pathogens appears limited to a max of 8 why? How does it scale for more reasonable numbers.</p></disp-quote><p>In our Gaussian model, we limit the number of pathogens to eight because a high level of allelic coexistence is already observed at this point. In this version of our model, pathogens are clearly distinct, representing different taxa rather than merely different species or strains. Therefore, a larger number of pathogens is not essential for the Gaussian model to generate allelic diversity.</p><p>In contrast, the bit-string model allows for more overlap between pathogens, making them better suited to represent closely related species or even different strains of the same species. In this model, we go up to 100 pathogens, observing similar results to those in the Gaussian model but requiring a higher number of pathogens for high MHC diversity to evolve. We now elaborated upon these points in the revised manuscript at Line 352-359.</p><disp-quote content-type="editor-comment"><p>5. Why have models with symmetry in distances between pathogens as in version 1.</p></disp-quote><p>Our qualitative results are unaffected by assuming symmetric or asymmetric pathogen optima. Given this, we opted to present the symmetric case in the main text, and include the results for different non-symmetric scenarios in the supplementary material. This is explained at Line 140-143 in the revised manuscript.</p><disp-quote content-type="editor-comment"><p>6. I don't see the need for recombination … there can be different MHC generated by mutation.</p></disp-quote><p>We now exclude recombination from the model, as it does indeed not provide anything qualitatively different from point mutations.</p><disp-quote content-type="editor-comment"><p>7. Is it necessary to use an idea of generalist – it is supported by a single paper and not potentially yet part of mainstream immunology.</p></disp-quote><p>In the initial Gaussian model, we naturally get the possibility for a generalist allele that is intermediately placed between the different pathogen optima due to the continues nature of the trait space. In our newly introduced bit-string model, which operates in a trait space of a non-continues nature, generalists alleles do not generally exist, particularly in parameter regions where trade-offs exist (warm-coloured regions in Figure 5). Despite this, the bit-string model still replicates the results of high allelic diversity. Therefore, the notion of a generalist is more of an emergent property of the Gaussian model, and although it has some empirical support (Chappell <italic>et al.</italic> 2015, <italic>eLife</italic> 4:e05345), it is not necessary for generating high MHC diversity in our study.</p><disp-quote content-type="editor-comment"><p>8. From 3 it seems that a key feature is the degree of dissimilarity. A search of the document does not find it being defined? What are biologically plausible values for this parameter?</p></disp-quote><p>In the revised manuscript, we have altered the model presentation. In the original manuscript, the dissimilarity <italic>d</italic> was defined as the distance between the Gaussian optima. In the revised version, we achieve the same effect by varying the slope of the Gaussian functions (<italic>v</italic> = <italic>σ</italic> <sup>-1</sup>), while keeping the distance fixed. This is mathematically equivalent to the original approach. We now refer to this new parameter <italic>v</italic> as pathogen virulence. All these details, and the biological interpretation of virulence <italic>v</italic> are described and defined in Line 129-139 and the legend of Figure 1.</p><disp-quote content-type="editor-comment"><p>9. Does the model make any predictions that allow discrimination or rejection of current hypotheses?</p></disp-quote><p>Our primary aim is to investigate whether heterozygote advantage (HA) can, in principle, maintain the high degrees of MHC polymorphism observed in nature. The prevailing hypothesis suggests that HA alone cannot achieve this. Our model challenges this view, suggesting that HA can indeed maintain such high levels of diversity, provided that assumptions (a) and (b) are met, and that a trade-off in immune performance exists. We therefore reject the prevailing hypothesis.</p><disp-quote content-type="editor-comment"><p>Overall I found it hard to follow the paper. To a large extent may be because I am not an expert in population genetics. More problematic was the difficulty I found understanding the details of the connection with immunology and lack of parameterization of biologically reasonable parameter regimes. I would be more convinced about the claims of the authors if the above questions were addressed. Finally I believe that either Jose Borghans or Rob De Boer would be very well suited to review the paper.</p></disp-quote><p>We are thankful that the reviewer took the time to read and evaluate our manuscript from the perspective of their expertise. By addressing their questions, we found many opportunities to improve the quality of our manuscript.</p><disp-quote content-type="editor-comment"><p>Reviewer #3 (General assessment and major comments (Required)):</p><p>There are good reasons to assume that individuals with two different alleles at an MHC locus are better protected against pathogen-induced disease (and, hence, have a higher fitness) than individuals that are homozygous for any of these alleles. Based on this, it has been argued that such heterozygote advantage may explain the high degree of polymorphism found at MHC loci. However, there is a problem with this argument. In principle, an arbitrary large number of alleles can be kept in the population by heterozygote advantage, but this is only possible if (1) all heterozygotes have a similarly high fitness, while (2) all homozygotes have a similarly low fitness. If the fitness effects of MHC alleles are drawn at random, it is unlikely that these conditions are satisfied. For this reason, earlier studies concluded that heterozygote advantage is most likely not the only factor explaining the high degree of MHC diversity. In the present study, the authors demonstrate that, in principle, the heterozygote-advantage hypothesis can be rescued if the current MHC alleles did not 'fall from the air' (i.e. were created by random mutation of large effect size) but instead were shaped by gradual evolution (based on the rare influx of mutations of small effect size). The authors argue that (under suitable conditions) this evolution process has the tendency to shape MHC alleles in such a way that conditions (1) and (2) are satisfied, hence allowing the stable coexistence of many (even hundreds) of MHC alleles.</p><p>The study shows that probability calculations, as in earlier studies, have to be taken with care, since the current MHC alleles may not be a random sample from a universe of possibilities but rather the product of diversifying evolution. This insight is interesting and important.</p></disp-quote><p>Thank you very much for this succinct summary of our study and your positive evaluation.</p><disp-quote content-type="editor-comment"><p>I am less impressed by the model that is used to illustrate their point. Most importantly, fitness (survival) is assumed to be a function of 'condition,' which in turn is defined in a rather specific manner (Equations 1 and 2). To me, it would have been plausible to define survival directly by the product term in Equation 1 (overall survival results from surviving many pathogen-induced challenges), but now this term is plugged into a saturating Michaelis-Menten function. Due to this transformation (which is not motivated well), conditions (1) and (2) are much more easily satisfied.</p></disp-quote><p>We acknowledge that the previous version of our manuscript did not provide adequate motivation for some of our biological assumptions. To improve this, we have substantially revised the manuscript and clarified how pathogens affect host fitness:</p><list list-type="bullet"><list-item><p>Pathogens are assumed to be lethal in the absence of an appropriate immune defence.</p></list-item><list-item><p>The combined effect of multiple pathogens on host survival exceeds the sum of the effects of each pathogen alone. In other words, the effects of pathogens are not independent of each other.</p></list-item></list><p>Assumption results from our Equation (5) , which is criticised by the reviewer. Instead, the reviewer suggested equating the product of the immune efficiencies (Equation 4) directly with survival. Under this assumption, each factor in Equation (4) describes the probability to survive an infection by the corresponding pathogen. While this may seem more straightforward, we argue that it could in fact be less realistic. Equating survival with the product of the probabilities to survive each pathogen implies that the effects of multiple pathogens on a host are strictly independent. Under this formulation, cleared infections have no effect on surviving future infections. While this might apply for some diseases, we argue that it does not apply in general. Instead, we consider the case that a host clearing a pathogen is in a weaker condition afterwards. For example, hosts that have cleared a parasite infection might have lost weight in this process, which affects their ability to cope with future infections. It is for this reason that we model survival as a saturating function of condition. Indeed, under Equation (5), decreasing condition leads to increasingly larger effects on survival. Hence, we believe there is good reason to expect situations in nature where assumption (b) holds true.</p><disp-quote content-type="editor-comment"><p>I would like to see the same analysis, but now for the more plausible assumption that condition corresponds to viability. I would also have appreciated if the authors had applied their method to other fitness functions, like the one in De Boer et al. (2004), in order to work out more clearly why the authors arrive at conclusions that contrast with those of earlier studies.</p></disp-quote><p>In our revised manuscript, we incorporated this suggestion (which was also made by reviewer 2) and included a new section featuring a ‘bit-string’ model using a fitness function inspired by Borghans et al. (2004) and discussed in De Boer et al. (2004). Our 'bit-string' model reproduces the results of our original Gaussian model, showing that high levels of allelic polymorphism are not specific to how the immune efficiencies are modelled but are a more general outcome resulting from assumptions (a) and (b).</p><p>To show more directly that our assumptions (a) and (b) are necessary for high allelic diversity to evolve under heterozygote advantage (HA), we include a comparison of our bit-string model with that of Borghans et al. (2004) (Supplementary Information 5). Our assumption about how matching of bit-strings between hosts and pathogens affect pathogen recognition are identical to Borghans et al. (2004) but in their model host survival does not fulfil our assumptions (a) and (b). While Borghans et al. (2004) report up to seven alleles we find, using the same parameters, well over 100 coexisting alleles.</p><p>In conclusion, heterozygote advantage can maintain high levels of allelic diversity, provided assumptions (a) and (b) are meet. Importantly, we believe that these assumptions can be well motivated on biological grounds.</p><disp-quote content-type="editor-comment"><p>The authors use an adaptive dynamics approach for modelling the fine-tuning of MHC alleles. I wonder whether this kind of approach, which is based on continuously varying traits and very rare mutations of very small effect size is realistic in the context of MHC evolution. Mutations of MHC alleles seem to occur frequently, and even point mutations do often have a large effect. In other words, the genotypic-phenotype mapping is most probably quite intricate, making some baseline assumptions of the model (e.g. Gaussian distribution of effect sizes) questionable. The study would have been more convincing if the authors would have incorporated more realistic assumptions on the action of MHC alleles in their individual-based simulations, rather than just mimicking the assumptions of their analytical model.</p></disp-quote><p>We would like to point out that we already demonstrated that high MHC diversity can evolve even with relatively large mutational steps (see Figure S2). This was based on our Gaussian model, which does use continuous traits.</p><p>Furthermore, in the bit-string model included in our revision the genotype-phenotype map is indeed “intricate” and non-continuous. Specifically, single mutations can have large effects on immune defence. In the bit-string model, MHC binding efficiency is represented mechanistically, and even the smallest mutational change—altering just one bit of the bit-string—can have a substantial impact on the MHC molecule's ability to bind to different pathogen peptides. Importantly, we find that our main results hold true even under these more intricate conditions.</p><p>[Editors’ note: what follows is the authors’ response to the second round of review.]</p><disp-quote content-type="editor-comment"><p>The manuscript has been improved but there are some remaining issues that need to be addressed, as outlined below:</p><p>Reviewer #2 (Recommendations for the authors):</p><p>The MHC genes encode proteins that bind antigenic oligopeptides and present them to receptors on immune cells. Successful presentation of antigens to immune T cells by the MHC is the key stage in the immune response to pathogens. While T cell receptors are variable and can adapt during the process of clonal selection, the MHC repertoire is inherited from parents and does not change during an individual's lifetime. Any pathogen genotype that escapes presentation by the MHC is able to reproduce at a higher rate due to the lack of initiation of an effective immune response. MHC genes are under strong natural selection for efficient binding of pathogen antigens, but surprisingly are often represented by hundreds of alleles (variants) in natural populations of vertebrates. In addition, MHC genes are often characterised by extremely long genealogies. These two features of MHC genes are particularly difficult to reconcile with strong natural selection, which usually results in low genetic polymorphism and often a short coalescence time. The paper by Sijestam and Rueffler investigates the role of one of the key balancing selection forces, the so-called heterozygote advantage, which has been hypothesised to maintain MHC gene polymorphism.</p><p>Strengths</p><p>The manuscript is clearly written and deals with a current and important topic in evolutionary biology, immunology and population genetics.</p><p>The structure of the models presented and the framework used are sound, with one of the models based on a classic theoretical work in the field and predict results that contradict the majority of recent theory on the evolution of MHC gene polymorphism.</p><p>The description of the models is easy to follow. The combination of two types of models ('Gaussian model' and 'bit-string model') is a powerful approach to test the hypothesis on the role of heterozygote advantage in maintaining MHC gene polymorphism.</p><p>The authors list two key assumptions of their model, which they believe are responsible for the conclusion of the paper. However, only one of these assumptions actually provides fundamental support for the role of heterozygote advantage in maintaining MHC gene polymorphism. Recent models show that the Red Queen process is able to maintain high levels of MHC polymorphism despite the mortality of hosts that respond poorly to infections (see detailed comments).</p><p>The work has the potential to shed new light on the long-standing debate about the importance of the Red Queen process vs. heterozygote advantage as a balancing selective force that maintains MHC gene polymorphism, although further analysis is needed to address concerns about some of the model assumptions made.</p><p>Weaknesses</p><p>There are two fundamental weaknesses in the manuscript, as the models in their current form and without additional analyses do not have sufficient scientific strength to restore the heterozygote advantage as a force capable of maintaining high genetic polymorphism of the MHC. First, because some of the assumptions used to model heterozygous advantage differ from those used in previous studies (suggestions I, II below). Second, because there is no reference to the Red Queen, which a balancing selection force currently receiving considerable attention in studies of MHC polymorphism (suggestion III). I also strongly believe that my concerns about the current limited power of the conclusions presented by the authors can be addressed by adding the suggested analyses. This could be quite a lot of work, but the analyses do not need to be performed in the full parameter space but are mandatory for the paper to be of the highest scientific quality. Here is a short list of the analyses that need to be added (see below for a more detailed description): (I.) In the Gaussian model, add analysis of pathogen peptides evolving by genetic drift by allowing Brownian motion to move the pathogen distribution in allele trait space. (II.) In the bit-string model, add analysis of pathogens evolving by genetic drift. (III.) Add simulations with only the Red Queen process operating (e.g. by simulating haploid hosts co-evolving with pathogens). However, it is necessary that all current assumptions of the bit-string model remain unchanged (including the relationship between infection outcome and host fitness), except for the addition of pathogens co-evolving with hosts.</p></disp-quote><p>We appreciate the reviewer’s thoughtful feedback and understand the concerns raised regarding the assumptions and the lack of explicit reference to the Red Queen process. We would like to address these points as follows (see more detailed responses to the specific comments below):</p><p>Assumptions used to model heterozygote advantage (HA)</p><p>We recognize that some of the assumptions in our model differ from those used in previous studies. However, as we clarify in the detailed responses below, our main focus is on demonstrating that HA can, in fact, maintain high MHC polymorphism under the assumptions of our model. We have further explained that assumptions (a) and (b) together enable HA to maintain MHC diversity, which is in contrast to previous work that has concluded otherwise.</p><p>Pathogen co-evolution and the Red Queen process</p><p>We agree that pathogen co-evolution and the Red Queen process play an important role in maintaining MHC polymorphism. However, adding simulations that explicitly model the Red Queen process and pathogen evolution via genetic drift would shift the focus of the manuscript and require substantial additional analyses. Instead, we have expanded the Discussion section to qualitatively address how pathogen co-evolution or drift might influence MHC diversity. We believe this is a more appropriate way to handle the reviewer’s concerns within the current scope of the paper.</p><p>We hope that our clarifications and expanded discussion address the reviewer’s concerns without detracting from the manuscript's primary focus on heterozygote advantage.</p><disp-quote content-type="editor-comment"><p>- The authors do not communicate, or perhaps do so in a way that can be easily overlooked by the reader, the fundamental conceptual challenge associated with testing the role of heterozygote advantage in host-pathogen evolution. By this, I mean that heterozygote advantage can only be modelled or tested in the absence of host-pathogen coevolution, because coevolution generates negative frequency-dependent selection (the Red Queen process). Without this explanation, the fact that pathogens do not evolve in the model may seem ridiculous to the reader. This aspect needs to be clear from the point at which the model is described, or perhaps even from the introduction.</p></disp-quote><p>We agree with the reviewer and have now expanded the explanation in the Introduction as well as the Model section [L52-54, 105-110]. We clarify both the reasoning behind assuming a constant pathogen community and its implications for ensuring that heterozygote advantage is the primary mechanism responsible for maintaining polymorphism.</p><disp-quote content-type="editor-comment"><p>- In this model, pathogens do not reproduce, and I have explained above why authors cannot indeed link pathogen fitness to the host immune response if they want to test heterozygote advantage in the absence of the Red Queen process. However, as I understood from the description, pathogens in the bit-string model consist of random pools of peptides: &quot;In the bit-string model, the m pathogens are each given npep randomly drawn bit-strings&quot;, and in the Gaussian model, the centres of the pathogens do not change their position in the allele trait space. The consequence of this assumption would be an evolutionary process that stops far in the future (pathogens are constant over time). Even if I am wrong and pathogens are randomly generated in each generation, this will still be incorrect because the model artificially assumes the maximum possible genetic diversity of pathogen peptides, which combined with the way fitness is calculated (similar to a geometric mean) would only favour a large number of alleles under heterozygote advantage. Furthermore, such an unrealistically high genetic diversity of oligopeptides simulates pathogen populations of much larger effective size than in real populations. A proper model for modelling heterozygote advantage would require modelling pathogens evolving by genetic drift. Even if the authors do not agree with my point, they should include the scenario in which pathogens evolve by genetic drift, as this has been assumed in previous models addressing the question of the role of heterozygote advantage and Red Queen on MHC polymorphism. Pathogens evolving by genetic drift are easily implemented in the bit-string model.</p></disp-quote><p>We would like to clarify that in our bit-string model, pathogens are indeed fixed over time (the first scenario described by the reviewer). We choose random bit-strings once at the beginning of a simulation.</p><p>Then we wonder whether there could be a misunderstanding. Our bit-string model is inspired by the work of Borghans et al. (2004), who assume 50 pathogen species, each with 20 peptides and 10 genotypes per pathogen species. The reviewer raises the concern that our model assumes an unrealistically high genetic diversity for pathogen peptides. However, we would like to clarify that our model actually assumes less diversity than Borghans et al. (2004), as we do not allow for genetic variation within a pathogen species. Instead, we assume the minimum of one genotype per pathogen species. Specifically, one can consider three levels of genetic variation: between-species diversity, within-species diversity, and between-peptide diversity within a species. In contrast to Borghans et al. (2004), our model assumes no within-species diversity, allowing only between-species and between-peptide diversity.</p><p>As we argue in response to the reviewer’s next comment, we have biological reasons for why we think that in the Gaussian model, stable pathogen optima are a realistic assumption. The bit-string model was added to our manuscript after the first round of reviews as a robustness check for the Gaussian model. Because of this, we prefer to keep the bit-string model and the Gaussian model as similar as possible. Furthermore, as explained above, drift is not easily added to our model as there is no allelic variation within pathogen species that could fluctuate.</p><disp-quote content-type="editor-comment"><p>In the Gaussian model, I would suggest introducing Brownian motion of pathogen distributions. It is very unrealistic to assume that pathogens would occupy a stationary point in the allelic trait space over so many generations, rather than moving.</p></disp-quote><p>We start our response here by first quoting the last paragraph of the result section for the bit-string model: “We note that the Gaussian and bit-string model suggest slightly different interpretations about the nature of the involved pathogens. In the bit-string model, the same MHC-molecule can in principle detect several pathogens (especially for n_pep}&gt;1). This suggests interpreting different pathogens as strains of the same species or different species that are closely related. For the Gaussian model, a single MHC molecule can generally not detect different pathogens with a high probability. This suggests interpreting different pathogens as clearly distinct species, possibly belonging to different higher taxonomic groups.”</p><p>An upshot of our interpretation that different pathogens in the Gaussian model belong to different taxonomic groups is that we consider it likely that the pathogen optima stay approximately constant over the time spans considered here.</p><disp-quote content-type="editor-comment"><p>- Host fitness is calculated using geometric mean mechanics, which forces the MHC allele (in a hypothetic haploid individual) to be located in the middle of the pathogen distributions located in allele trait space. This is a very strong assumption and differs from other theoretical studies of MHC gene polymorphism (e.g. Borghans et al. 2004, Ejsmond and Radwan 2015). Note, that I do not say that this is an incorrect assumption. Perhaps natural systems differ in the way infections affect host fitness. Anyway, the lack of modelling of other balancing selection forces in the presented work, namely the Red Queen (negative frequency dependence), leaves the reader with a big question mark as to the extent to which the result presented by authors is driven by the specificity of the model or the assumption that immune response and fitness scale in a 'geometric mean'-like manner. Thus, I think the Red Queen process scenario needs to be added, and my suggestion should not be taken as a suggestion of adding an additional analysis beyond the scope of this paper. Each model has its own specificity and it is necessary to know what the levels of polymorphism are when the Red Queen process is simulated. My expectation would be that if fitness is calculated in the way the authors did, the Red Queen process will maintain few alleles. This would be a strong message emerging from this study and the previous literature that heterozygote advantage or the Red Queen process can maintain polymorphism depending on the distribution of fitness effects of infections by different pathogen species.</p></disp-quote><p>However, we have indeed expanded the discussion to qualitatively address how pathogen evolution and moving pathogen optima might influence MHC diversity [L473-496]. This approach preserves the main focus while addressing the potential role of pathogen co-evolution.</p><disp-quote content-type="editor-comment"><p>- The authors should comment on the fact that the MHC gene polymorphism in their model would break down in the presence of several highly virulent pathogen species (narrow distributions in the Gaussian model) and under more realistic assumptions for pathogen classes e.g. helminths, i.e. a large number of antigenic oligopeptides (Figure 5 for v=5).</p></disp-quote><p>We suspect that the reviewer has misunderstood the meaning of the virulence parameter <italic>v</italic>.</p><p>The parameter <italic>v</italic> is proportional to the <italic>inverse</italic> of the width of the Gaussian functions (cf. Equation 1). Contrary to the reviewer's concern, MHC gene polymorphism is actually favoured in the presence of highly virulent pathogen species (high values of <italic>v</italic>), particularly when several such species are present (high values of <italic>m</italic>). This is illustrated in Figure 4 for the Gaussian model, and in Figure 5 for the bit-string model.</p><p>Regarding the issue of a large number of antigenic oligopeptides, our bit-string model does indeed suggest that this can impede the evolution of allelic diversity, at least under lower virulence conditions (v ≤ 7, Figure 5). In such scenarios, evolution can converge to a single optimal MHC allele that is capable of detecting all pathogens, preventing the evolution of MHC polymorphism. This is intuitively clear, as a large number of peptides offers more targets for MHC molecules to recognize. We have now expanded our explanation of this topic in the result section to be even clearer [L 345-351].</p><disp-quote content-type="editor-comment"><p>- The assumption (a) that pathogens are lethal in the absence of an appropriate immune response does not support the role of heterozygote advantage in maintaining MHC gene polymorphism as suggested by the authors. See the model of Ejsmond et al. 2023 ('Adaptive immune response selects for postponed maturation and increased body size'), where hosts with a poor response to pathogens also die, but high MHC gene polymorphism is maintained in particular by the Red Queen process. However, note also that Ejsmond et al. assumed that infections affect fitness proportionally, which is contrary to assumption (b) in the reviewed paper. I would suggest reducing the importance of the first assumption or discussing alternative models that show that the Red Queen process is able to maintain high MHC gene polymorphism despite assumption (a). I believe that the difference in assumption (b) is fundamental to the conclusions derived from this paper and other models.</p></disp-quote><p>We would like to clarify two points in response to this comment.</p><p>First, and this is unrelated to the work by Ejsmond et al. (2023), we do not claim that – given assumption (a) is fulfilled – only heterozygote advantage can maintain MHC polymorphism. Instead, we agree that other mechanisms, such as Red Queen processes, can maintain high MHC polymorphism with or without assumption (a). Our main point is that assumptions (a) and (b) together can lead to high MHC diversity being maintained by heterozygote advantage alone, while HA was previously thought to be insufficient for this.</p><p>Second, we wish to clarify how in our view the model of Ejsmond et al. (2023) aligns with assumption (a) and (b), although we consider their results to not conflict with our results, as they present a Red Queen model, which is outside the scope of our work.</p><p>Contrary to the reviewer's suggestion, the model by Ejsmond et al. in our reading fulfils assumption (b) but not assumption (a). In their model, when infections impact survival, they affect an intermediate property <italic>T</italic>, analogous to our concept of “condition”. Individuals are removed if their condition falls below a threshold, which is adjusted each time step to maintain a constant mortality rate. Fitness is therefore not proportional to <italic>T</italic>, but is modelled through a step-function, meaning that individuals well above the threshold are unaffected by small changes in condition, while those near the threshold face significant mortality risk from small decreases in <italic>T</italic>—consistent with our assumption (b).</p><p>However, because <italic>T</italic> represents the average performance against all pathogens (Equation 6 in Ejsmond et al. 2023), a single pathogen can only marginally reduce the condition <italic>T</italic>, so their model does not fulfil assumption (a). In our model, assumption (a) holds because a pathogen to which a host has no immune defence can be lethal, even if the host performs well against all other pathogens</p><disp-quote content-type="editor-comment"><p>- Show information about the proportion of hosts in the population dying per generation under main simulated scenarios</p></disp-quote><p>This information is present in the simulation figures (Figures 3 and 5). The distribution of conditions within the population, divided into homozygotes and heterozygotes, are given by the dark and light blue bars, respectively, and how these conditions map to survival is given by the orange line.</p><disp-quote content-type="editor-comment"><p>- Consider renaming 'allelic trait space' to epitope or agretope space</p></disp-quote><p>We prefer to keep the term ‘allelic trait space’, as allelic values move within this space due to mutations, while pathogens are considered stationary. Therefore, we consider it more appropriate to refer to this as the allelic trait space. However, we appreciate the suggestion and have now incorporated the term 'agretope' in the main text to describe the role of MHC molecules in pathogen detection, ensuring that the immunological context is clear [L 25-28].</p></body></sub-article></article>