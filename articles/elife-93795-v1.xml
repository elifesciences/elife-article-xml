<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN"  "JATS-archivearticle1-3-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">93795</article-id><article-id pub-id-type="doi">10.7554/eLife.93795</article-id><article-id pub-id-type="doi" specific-use="version">10.7554/eLife.93795.3</article-id><article-version article-version-type="publication-state">version of record</article-version><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Predictably manipulating photoreceptor light responses to reveal their role in downstream visual responses</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Chen</surname><given-names>Qiang</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Ingram</surname><given-names>Norianne T</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Baudin</surname><given-names>Jacob</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Angueyra</surname><given-names>Juan M</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9217-3069</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="pa1">†</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Sinha</surname><given-names>Raunak</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7553-1274</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="pa2">‡</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Rieke</surname><given-names>Fred</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1052-2609</contrib-id><email>rieke@uw.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf2"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00cvxb145</institution-id><institution>Department of Physiology and Biophysics, University of Washington</institution></institution-wrap><addr-line><named-content content-type="city">Seattle</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Baccus</surname><given-names>Stephen A</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00f54p054</institution-id><institution>Stanford University</institution></institution-wrap><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Moore</surname><given-names>Tirin</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/006w34k90</institution-id><institution>Stanford University, Howard Hughes Medical Institute</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><author-notes><fn fn-type="present-address" id="pa1"><label>†</label><p>Department of Biology, University of Maryland, College Park, United States</p></fn><fn fn-type="present-address" id="pa2"><label>‡</label><p>Department of Neuroscience, University of Wisconsin-Madison, Madison, United States</p></fn></author-notes><pub-date publication-format="electronic" date-type="publication"><day>05</day><month>11</month><year>2024</year></pub-date><volume>13</volume><elocation-id>RP93795</elocation-id><history><date date-type="sent-for-review" iso-8601-date="2023-11-27"><day>27</day><month>11</month><year>2023</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint.</event-desc><date date-type="preprint" iso-8601-date="2023-10-23"><day>23</day><month>10</month><year>2023</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.10.20.563304"/></event><event><event-desc>This manuscript was published as a reviewed preprint.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2024-02-02"><day>02</day><month>02</month><year>2024</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.93795.1"/></event><event><event-desc>The reviewed preprint was revised.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2024-07-04"><day>04</day><month>07</month><year>2024</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.93795.2"/></event></pub-history><permissions><copyright-statement>© 2024, Chen et al</copyright-statement><copyright-year>2024</copyright-year><copyright-holder>Chen et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-93795-v1.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-93795-figures-v1.pdf"/><abstract><p>Computation in neural circuits relies on the judicious use of nonlinear circuit components. In many cases, multiple nonlinear components work collectively to control circuit outputs. Separating the contributions of these different components is difficult, and this limits our understanding of the mechanistic basis of many important computations. Here, we introduce a tool that permits the design of light stimuli that predictably alter rod and cone phototransduction currents – including stimuli that compensate for nonlinear properties such as light adaptation. This tool, based on well-established models for the rod and cone phototransduction cascade, permits the separation of nonlinearities in phototransduction from those in downstream circuits. This will allow, for example, direct tests of how adaptation in rod and cone phototransduction affects downstream visual signals and perception.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>visual adaptation</kwd><kwd>neural computation</kwd><kwd>sensory processing</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Mouse</kwd><kwd>Rhesus macaque</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>EY028542</award-id><principal-award-recipient><name><surname>Rieke</surname><given-names>Fred</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000181</institution-id><institution>Air Force Office of Scientific Research</institution></institution-wrap></funding-source><award-id>FA9550-21-1-0230</award-id><principal-award-recipient><name><surname>Rieke</surname><given-names>Fred</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection, and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Quantitative models for responses of rod and cone photoreceptors are developed that allow direct tests of the impact of the photoreceptors on responses of downstream visual neurons.</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>publishing-route</meta-name><meta-value>prc</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>A central goal in neuroscience is to understand how behaviorally significant computations are implemented by cellular and synaptic mechanisms (see <xref ref-type="bibr" rid="bib16">Churchland and Abbott, 2016</xref>). Such computations typically rely on a diverse collection of interacting circuit mechanisms, many of which are nonlinear (<xref ref-type="bibr" rid="bib27">Gollisch and Meister, 2010</xref>; <xref ref-type="bibr" rid="bib32">Isaacson and Scanziani, 2011</xref>; <xref ref-type="bibr" rid="bib33">Jadzinsky and Baccus, 2013</xref>; <xref ref-type="bibr" rid="bib56">Zador, 2000</xref>). Circuit outputs – which are often most amenable to experimental measurement – typically do not uniquely identify the role of specific circuit mechanisms. Hence progress toward understanding the mechanistic basis of circuit function requires better tools to manipulate specific mechanisms and identify their contribution to circuit output.</p><p>Sensory systems provide a clear example of these issues. Sensory processing is strongly shaped by the properties of the sensory receptors themselves and by post-receptor circuit mechanisms. Yet separating the contributions of receptor and post-receptor mechanisms to circuit outputs can be difficult, and computational models often make untested assumptions about their relative importance. For example, models for retinal processing generally assume that photoreceptor responses are linear or near linear, despite decades of direct evidence that this is not the case (reviewed by <xref ref-type="bibr" rid="bib11">Burns and Baylor, 2001</xref>; <xref ref-type="bibr" rid="bib48">Schwartz, 2021</xref>). Adaptation to changes in mean light intensity provides a specific and important example. Both photoreceptors and post-photoreceptor circuits adjust response properties such as gain and kinetics to match the prevailing light inputs (reviewed by <xref ref-type="bibr" rid="bib19">Demb, 2008</xref>; <xref ref-type="bibr" rid="bib22">Dunn and Rieke, 2006</xref>), yet models for retinal outputs typically start by passing light inputs through a linear spatio-temporal filter; this architecture includes linear–nonlinear (<xref ref-type="bibr" rid="bib15">Chichilnisky, 2001</xref>), generalized-linear (<xref ref-type="bibr" rid="bib40">Pillow et al., 2008</xref>), and computational neural network (CNN) (<xref ref-type="bibr" rid="bib37">McIntosh et al., 2016</xref>; <xref ref-type="bibr" rid="bib50">Turner et al., 2019</xref>) models. Models with an initial linear filtering stage cannot capture the spatially local adaptation produced by photoreceptors. Tools that separate receptor and post-receptor contributions to adaptation are needed to better understand how this salient aspect of retinal processing works.</p><p>Here, we show how we can predictably manipulate the responses of rod and cone photoreceptors to causally probe their role in shaping responses of downstream visual neurons. We build on decades of work identifying and testing biophysical models for rod and cone phototransduction (<xref ref-type="bibr" rid="bib38">Nikonov et al., 2000</xref>; <xref ref-type="bibr" rid="bib41">Pugh and Lamb, 1993</xref>; <xref ref-type="bibr" rid="bib43">Rieke and Baylor, 1998a</xref>; <xref ref-type="bibr" rid="bib54">Younger et al., 1996</xref>). We show that existing phototransduction models, with appropriate parameters, can account for responses of rod and cone photoreceptors from both primate and mouse to a broad range of inputs. The resulting forward models can be used as a front end for encoding models for responses of downstream visual neurons, resulting in a better accounting for early time-dependent nonlinearities. We then show that these models can be mathematically inverted – enabling the design of stimuli that will elicit photoreceptor responses with specific desired properties such as a linear dependence on light input. Direct recordings of responses to these stimuli show that they work as designed. This approach provides a tool that can be used to predictably shape the photoreceptor responses and hence to casually dissect the impact of specific properties of the phototransduction currents on downstream visual signaling and perception.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Biochemical model</title><p>We chose a model architecture based on the biochemical interactions that comprise the phototransduction cascade. We chose this model rather than empirical models (e.g. <xref ref-type="bibr" rid="bib17">Clark et al., 2013</xref>) because it was more clearly connected to the mechanistic operation of the phototransduction cascade and because it was exactly invertible (see <xref ref-type="bibr" rid="bib2">Angueyra et al., 2022</xref> for comparison of the biochemical model with empirical models).</p><p>Combined work in biochemistry, molecular biology, and physiology has produced a clear understanding of the operation of the phototransduction cascade (<xref ref-type="fig" rid="fig1">Figure 1A</xref>; reviewed by <xref ref-type="bibr" rid="bib11">Burns and Baylor, 2001</xref>; <xref ref-type="bibr" rid="bib44">Rieke and Baylor, 1998b</xref>; <xref ref-type="bibr" rid="bib48">Schwartz, 2021</xref>). In brief, the phototransduction current flows through cGMP-gated channels in the photoreceptor outer segment. Levels of cGMP, and hence the phototransduction current, are maximal in darkness. Light activates G-protein-coupled receptors, which activate G-proteins and a cGMP-phosphodiesterase (PDE). The resulting decrease in cGMP concentration allows some cGMP-gated channels to close and decreases the current. Levels of cGMP are restored by synthesis of cGMP by a guanylate cyclase; cyclase activity is sped by a calcium-feedback pathway that strongly shapes light responses (<xref ref-type="bibr" rid="bib12">Burns et al., 2002</xref>).</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Model and fitting procedure.</title><p>(<bold>A</bold>) Phototransduction cascade and differential equations that describe the operation of key components. Abbreviations are as follows: Stim: stimulus; R: receptor (photopigment) activity; P: phosphodiesterase activity; G: cGMP concentration; S: rate of cGMP synthesis; I: membrane current; C: calcium concentration. (<bold>B</bold>) Fits (red) of a model with four free parameters (<italic>γ</italic>, <italic>σ</italic>, <italic>η</italic>, <italic>K</italic><sub>GC</sub>) to the responses of a mouse rod (see <xref ref-type="table" rid="table1">Table 1</xref>). All measured responses are from the same rod, and all model responses use the same values for the free parameters. Responses to different flash strengths or flash timing have been displaced vertically in the left two panels. The weakest flash in the far left panel produced on average ~3 activated rhodopsin molecules, and each successive flash was twice as bright. The bottom trace in the middle panel was to a light step alone, while the other traces in this panel each had five superimposed flashes. The horizontal scale bar for the inset in B is 1 s.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-93795-fig1-v1.tif"/></fig><p>The biochemical understanding summarized in <xref ref-type="fig" rid="fig1">Figure 1A</xref> has led to several quantitative models for phototransduction (<xref ref-type="bibr" rid="bib38">Nikonov et al., 2000</xref>; <xref ref-type="bibr" rid="bib41">Pugh and Lamb, 1993</xref>; <xref ref-type="bibr" rid="bib43">Rieke and Baylor, 1998a</xref>; <xref ref-type="bibr" rid="bib54">Younger et al., 1996</xref>). We focus on a set of differential equations that form the core of these models. Our goal was to develop a model that generalized across stimuli rather than one in which the parameters provide accurate estimates of how specific components of the cascade work. Below we show that the model illustrated in <xref ref-type="fig" rid="fig1">Figure 1A</xref>, with appropriate parameters, captures the responses of rod and cone photoreceptors to a variety of stimuli. Most importantly for our purposes here, the models are sufficiently accurate to enable us to accurately predict stimuli that elicit desired photoreceptor responses, as tested in Figures 6–9.</p><p>Our phototransduction model has a total of 11 parameters (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). Two of these (<italic>q</italic> and <italic>S<sub>max</sub></italic>) can be expressed in terms of others using steady state conditions – for example the constraint that <italic>dC</italic>(<italic>t</italic>)/<italic>dt</italic> = 0 in steady state. Several others were fixed based on previous measurements and their relatively minor impact on model predictions; this included <italic>k</italic>, <italic>n</italic>, and <italic>m</italic> for both rods and cones (<xref ref-type="bibr" rid="bib35">Koutalos et al., 1995b</xref>; <xref ref-type="bibr" rid="bib42">Rieke and Baylor, 1996</xref>) and <italic>β</italic> for rods (<xref ref-type="bibr" rid="bib25">Field and Rieke, 2002</xref>). The dark cGMP concentration was estimated from the measured dark current for each recorded cell. The receptor and PDE decay rates (<italic>σ</italic> and <italic>Φ</italic>) had near identical effects on predictions (see <xref ref-type="bibr" rid="bib41">Pugh and Lamb, 1993</xref>) and were constrained to be equal. These considerations allowed us to reduce the number of free model parameters to 4 for rods and 5 for cones. This choice reflects a balance of minimizing the number of free model parameters while providing sufficient flexibility to capture key aspects of the light response.</p><p>The free parameters consisted of the gain <italic>γ</italic> with which photons are converted to photopigment activity, the photopigment decay rate <italic>σ</italic>, the spontaneous PDE activation rate <italic>η</italic>, the constant <italic>K<sub>GC</sub></italic> specifying the calcium sensitivity of the cGMP synthesis rate, and (for cones) the rate <italic>β</italic> of Ca<sup>2+</sup> extrusion. This choice of free parameters is not unique given the similar impact of some parameters on model output (such as <italic>σ</italic> and <italic>Φ</italic>). But, as indicated below, it provided sufficient flexibility to capture measured responses to a variety of stimuli. We numerically identified optimal values for these parameters separately for each photoreceptor type (see Methods).</p><p>We were able to collect responses to a larger set of stimuli from individual rods than cones due to differences in recording techniques. We recorded from rod photoreceptors using suction electrodes, which allow for stable, long-lasting recordings. This allowed us to measure responses to a comprehensive set of stimuli from each individual rod. We recorded from cone photoreceptors using whole-cell patch clamp recordings. Light responses are stable in these recordings for a much shorter time (due to internal dialysis), and consequently we recorded responses to a single stimulus type from each individual cone. Despite these differences in data collection, we identified values for the free parameters in both rod and cone models by numerically minimizing the mean-squared error (MSE) between model predictions and measured responses (see Methods for more details).</p></sec><sec id="s2-2"><title>Fitting rod phototransduction models</title><p>We measured responses of mouse and macaque rod photoreceptors to a set of stimuli consisting of a family of brief flashes of different strengths, flashes delivered at several times relative to the onset and offset of a light step, and a ‘variable mean noise stimulus’ consisting of Gaussian noise with periodic changes in mean intensity (<xref ref-type="fig" rid="fig1">Figure 1B</xref>; see Methods for experimental details). The variable mean noise stimulus approximates the large and frequent changes in input that are characteristic of natural vision (<xref ref-type="bibr" rid="bib26">Frazor and Geisler, 2006</xref>). These large (up to 30-fold) changes in mean intensity strongly engage photoreceptor adaptation, and the superimposed Gaussian noise probes sensitivity to rapidly varying inputs.</p><p>We recorded responses to this collection of stimuli for each rod in our dataset. We fit mouse and macaque rods separately, in each case seeking a common model (i.e. with the same parameters) that fit responses across stimuli. We identified model parameters by numerically minimizing the MSE between the model predictions and measured responses across stimuli (see Methods).</p><p><xref ref-type="fig" rid="fig1">Figure 1B</xref> compares the predicted and measured responses of a mouse rod photoreceptor. Predicted and measured responses are not identical – for example the model predicts a faster initial rising phase of the flash response than that measured and underestimates the amplitude of flashes delivered shortly after a light step. Nonetheless, a common model specified by four free parameters (<italic>γ</italic>, <italic>σ</italic>, <italic>η</italic>, and <italic>K<sub>GC</sub></italic>) accounts for many aspects of the responses to this set of stimuli. These parameters were well constrained by fitting the measured responses: best-fit parameters varied by ~10% across different photoreceptors, and the MSE increased significantly for 10–20% changes in parameters (see Methods for a more detailed analysis).</p><p>To arrive at consensus models for rod transduction currents, we fit measured responses from multiple rods from either primate or mouse simultaneously. We first used the measured dark current and the previously measured relation between current and cGMP (<xref ref-type="disp-formula" rid="equ4">Equation 4</xref> in <xref ref-type="fig" rid="fig1">Figure 1</xref>; <xref ref-type="bibr" rid="bib42">Rieke and Baylor, 1996</xref>) to specify the cGMP concentration in darkness for each cell. We then allowed <italic>γ</italic> to vary between cells to account for differences in sensitivity. The remaining parameters (<italic>σ</italic>, <italic>η</italic>, and <italic>K<sub>GC</sub></italic>) were constrained to have the same value across cells. We then numerically identified best values for these parameters by minimizing the MSE between model predictions and the set of recorded rod responses. These consensus models provide our best estimate of how an unrecorded cell of a given type will respond; these models provide the foundation for the manipulations of the photoreceptor responses in Figures 6–10. Consensus parameters for mouse and primate rods were very similar (see <xref ref-type="table" rid="table1">Table 1</xref>).</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Parameters and best fit consensus values for biophysical phototransduction models for each cell type (see Methods for fitting details).</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom" rowspan="2">Parameter</th><th align="left" valign="bottom" rowspan="2">Symbol</th><th align="left" valign="bottom" rowspan="2">Units</th><th align="left" valign="bottom" rowspan="2">Type</th><th align="left" valign="bottom" colspan="4">Photoreceptor type</th></tr><tr><th align="left" valign="bottom">Primatecone</th><th align="left" valign="bottom">Mousecone</th><th align="left" valign="bottom">Primaterod</th><th align="left" valign="bottom">Mouserod</th></tr></thead><tbody><tr><td align="left" valign="bottom">Opsin decay rate const.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf1"><mml:mi>σ</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Free</td><td align="char" char="." valign="bottom">22</td><td align="char" char="." valign="bottom">9.74</td><td align="char" char="." valign="bottom">7.07</td><td align="char" char="." valign="bottom">7.66</td></tr><tr><td align="left" valign="bottom">PDE decay rate const.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf3"><mml:mi>ϕ</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Constrained (<italic>φ</italic> = <italic>σ</italic>)</td><td align="char" char="." valign="bottom">22</td><td align="char" char="." valign="bottom">9.74</td><td align="char" char="." valign="bottom">7.07</td><td align="char" char="." valign="bottom">7.66</td></tr><tr><td align="left" valign="bottom">PDE dark activation rate</td><td align="left" valign="bottom"><italic>η</italic></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Free</td><td align="char" char="." valign="bottom">2000</td><td align="char" char="." valign="bottom">761</td><td align="char" char="." valign="bottom">2.53</td><td align="char" char="." valign="bottom">1.62</td></tr><tr><td align="left" valign="bottom">Dark current</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf6"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">pA</td><td align="left" valign="bottom">Measured</td><td align="char" char="." valign="bottom">−240 to −428</td><td align="char" char="." valign="bottom">−41 to −80</td><td align="char" char="." valign="bottom">−19 to −37</td><td align="char" char="." valign="bottom">−16 to −24</td></tr><tr><td align="left" valign="bottom">cGMP concentration in dark</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf7"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Derived</td><td align="char" char="ndash" valign="bottom">28.7 to 35</td><td align="char" char="ndash" valign="bottom">15.9 to 20</td><td align="char" char="ndash" valign="bottom">12.1 to 15.0</td><td align="char" char="ndash" valign="bottom">11.4 to 13.1</td></tr><tr><td align="left" valign="bottom">cGMP-to-current constant</td><td align="left" valign="bottom"><italic>k</italic></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>μ</mml:mi><mml:msup><mml:mi mathvariant="normal">M</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Fixed</td><td align="char" char="." valign="bottom">0.01</td><td align="char" char="." valign="bottom">0.01</td><td align="char" char="." valign="bottom">0.01</td><td align="char" char="." valign="bottom">0.01</td></tr><tr><td align="left" valign="bottom">cGMP channel cooperativity</td><td align="left" valign="bottom"><italic>n</italic></td><td align="left" valign="bottom">Unitless</td><td align="left" valign="bottom">Fixed</td><td align="char" char="." valign="bottom">3</td><td align="char" char="." valign="bottom">3</td><td align="char" char="." valign="bottom">3</td><td align="char" char="." valign="bottom">3</td></tr><tr><td align="left" valign="bottom">Ca<sup>2+</sup> concentration in dark</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf10"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Fixed</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">1</td></tr><tr><td align="left" valign="bottom">Ca<sup>2+</sup> extrusion rate constant</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf12"><mml:mi>β</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Fixed (rods)<break/>Free (cones)</td><td align="char" char="." valign="bottom">9</td><td align="char" char="." valign="bottom">2.64</td><td align="char" char="." valign="bottom">25</td><td align="char" char="." valign="bottom">25</td></tr><tr><td align="left" valign="bottom">Cooperativity of GC Ca<sup>2+</sup> dependence</td><td align="left" valign="bottom"><italic>m</italic></td><td align="left" valign="bottom">Unitless</td><td align="left" valign="bottom">Fixed</td><td align="char" char="." valign="bottom">4</td><td align="char" char="." valign="bottom">4</td><td align="char" char="." valign="bottom">4</td><td align="char" char="." valign="bottom">4</td></tr><tr><td align="left" valign="bottom">Affinity of GC Ca<sup>2+</sup> dependence</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf14"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Free</td><td align="char" char="." valign="bottom">0.5</td><td align="char" char="." valign="bottom">0.4</td><td align="char" char="." valign="bottom">0.5</td><td align="char" char="." valign="bottom">0.4</td></tr><tr><td align="left" valign="bottom">Opsin gain</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf16"><mml:mi>γ</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Unitless</td><td align="left" valign="bottom">Free</td><td align="char" char="." valign="bottom">10</td><td align="char" char="." valign="bottom">10</td><td align="char" char="." valign="bottom">4.2</td><td align="char" char="." valign="bottom">8</td></tr></tbody></table></table-wrap></sec><sec id="s2-3"><title>Fitting cone phototransduction models</title><p>Due to the limited duration of the cone recordings, we focused on the variable mean noise stimulus. This stimulus was the most effective in constraining cone model parameters, likely because it strongly engages adaptation and thoroughly probes response dynamics.</p><p>We identified consensus cone models by fitting measured responses to the variable mean noise stimulus from multiple cones simultaneously, as described above for the rods. Four parameters (<italic>σ</italic>, <italic>η</italic>, <italic>K<sub>GC</sub></italic>, and <italic>β</italic>) were constrained to have the same value across cones, while <italic>γ</italic> was allowed to vary across cells. Consensus parameters for mouse and primate cones differed substantially, reflecting the ~twofold faster kinetics of primate cone responses (flash response time-to-peak is ~35 ms in primate cones, and ~70 ms in mouse cones; see <xref ref-type="table" rid="table1">Table 1</xref>). For primate cones, performance using these consensus parameters was very similar to that from the parameters in <xref ref-type="bibr" rid="bib2">Angueyra et al., 2022</xref>; for consistency we used these published parameters for our consensus model.</p></sec><sec id="s2-4"><title>Model performance</title><p><xref ref-type="fig" rid="fig2">Figure 2</xref> tests the performance of the consensus models for both rod and cone photoreceptors. We focused on the variable mean noise stimulus since it probes responses to rapid stimulus variations and large changes in mean intensity that strongly engage photoreceptor nonlinearities. For each individual cell, we specified the dark cGMP concentration (<italic>G<sub>D</sub></italic>) using the measured dark current and allowed the overall gain <italic>γ</italic> to vary; the remaining parameters were set to the consensus model values in <xref ref-type="table" rid="table1">Table 1</xref>. The resulting models (red) captured the measured responses (black) well.</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Photoreceptor model and fits.</title><p>(<bold>A</bold>) Comparison of measured responses (black) with predictions of full (red) and linear model (blue) to variable mean noise stimulus (gray). Full model responses used consensus parameters from fitting responses of multiple cells of each type simultaneously, with the dark current and sensitivity allowed to vary between cells (see Methods and <xref ref-type="table" rid="table1">Table 1</xref>). The linear model was generated from fitting the low-contrast responses of the full model (see Methods). Insets expand regions in gray boxes. Linear model parameters (see <xref ref-type="disp-formula" rid="equ10">Equation 7</xref>) were <italic>α</italic> = 0.31, <italic>τ</italic><sub><italic>R</italic></sub> = 10.6 ms, and <italic>τ</italic><sub><italic>D</italic></sub> = 23.6 ms for the primate cone, <italic>α</italic> = 0.031, <italic>τ</italic><sub><italic>R</italic></sub> = 31.6 ms, and <italic>τ</italic><sub><italic>D</italic></sub> = 56.7 ms for the mouse cone, <italic>α</italic> = 5.3, <italic>τ</italic><sub><italic>R</italic></sub> = 141 ms, and <italic>τ</italic><sub><italic>D</italic></sub> = 208 ms for the primate rod, and <italic>α</italic> = 4.7, <italic>τ</italic><sub><italic>R</italic></sub> = 115 ms, and <italic>τ</italic><sub><italic>D</italic></sub> = 185 ms for the mouse rod, (<bold>B</bold>) Fraction of variance explained for the full model fit to each cell individually (<italic>y</italic>-axis) plotted against that for the consensus model that has fixed parameters across cells except for the dark current and sensitivity. Means ± SDs were 0.90 ± 0.04 (specific model) and 0.87 ± 0.05 (consensus model) for six primate cones, 0.92 ± 0.02 and 0.94 ± 0.02 for six mouse cones, 0.94 ± 0.02, 0.94 ± 0.02 and 0.94 ± 0.02 for six primate rods and 0.93 ± 0.03 and 0.93 ± 0.03 for eight mouse rods. Data for Figures 1-5 is available at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5061/dryad.q2bvq83vg">https://doi.org/10.5061/dryad.q2bvq83vg</ext-link>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-93795-fig2-v1.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Tests of the ability of the model to generalize across stimuli and across cells.</title><p>(<bold>A</bold>) Generalization across stimuli. Responses of primate and mouse rods were fit to the variable mean noise stimulus only and model performance was evaluated for responses to the flash family and flashes and steps, using the fraction of variance explained to evaluate the fits (see <xref ref-type="fig" rid="fig1">Figure 1B</xref>). The generalization performance to stimuli not included in the fit (<italic>y</italic>-axis) is compared to performance when the model is fit to all stimuli (<italic>x</italic>-axis). Means ± SDs were 0.92 ± 0.05 (generalize) and 0.94 ± 0.03 (fit all) for six primate rods and 0.90 ± 0.04 and 0.92 ± 0.02 for eight mouse rods. (<bold>B</bold>) Generalization across cells. Models were fit to the variable mean noise stimulus. The performance of each cell was evaluated for a model in which all cells were fit (<italic>x</italic>-axis), or in which the test cell was excluded from the fit (<italic>y</italic>-axis). <italic>γ</italic> was allowed to vary for the held-out cell while other parameters were determined by fitting the remaining data as for the consensus models. Means ± SDs were 0.88 ± 0.04 (hold out) and 0.87 ± 0.05 (fit all) for six primate cones, 0.90 ± 0.02 and 0.91 ± 0.02 for six mouse cones, 0.96 ± 0.02 and 0.96 ± 0.02 for six primate rods, and 0.95 ± 0.02 and 0.95 ± 0.02 for eight mouse rods.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-93795-fig2-figsupp1-v1.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Full models systematically outperform linear models.</title><p>Linear models were generated by fitting low-contrast responses to the full model for each cell. Full models and linear models were optimized with a single-scale factor for each cell (<italic>γ</italic> for the full model and α for the linear model in <xref ref-type="disp-formula" rid="equ10">Equation 7</xref>). The fraction of variance explained was computed for the variable mean noise stimuli as in <xref ref-type="fig" rid="fig2">Figure 2</xref>. Means ± SDs were 0.63 ± 0.15 (linear) and 0.87 ± 0.05 (consensus) for six primate cones, 0.68 ± 0.04 and 0.91 ± 0.02 for six mouse cones, 0.86 ± 0.02 and 0.96 ± 0.02 for six primate rods, and 0.86 ± 0.04 and 0.95 ± 0.02 for eight mouse rods.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-93795-fig2-figsupp2-v1.tif"/></fig></fig-group><p>For each recorded cell, the consensus models captured more than 80% of the variance of the responses (<xref ref-type="fig" rid="fig2">Figure 2B</xref>); on average these models captured ~90% of the variance. We compared the performance of the consensus models with that of models fit to each cell individually. Consensus models and models fit to individual cells performed similarly (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). Models also generalized well across stimuli and to cells that did not contribute to the fits (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). This suggests that the consensus models can be used to predict responses of unrecorded cells.</p><p><xref ref-type="fig" rid="fig2">Figure 2</xref> also shows predictions of a linear phototransduction model (blue) (see Methods). Rod and cone phototransduction currents depend linearly on light intensity for low-contrast inputs (e.g. <xref ref-type="bibr" rid="bib5">Baylor et al., 1984</xref>; <xref ref-type="bibr" rid="bib29">Hass et al., 2015</xref>; <xref ref-type="bibr" rid="bib46">Schnapf et al., 1990</xref>). Hence, the linear model was fit to responses of the full model to low-contrast inputs at the mean intensity of the variable mean noise stimulus (25 R*/rod/s for rods and 22,000 R*/cone/s for cones; see Methods for model construction details); this means that the differences between the linear and full model responses can be directly attributed to nonlinearities in phototransduction. Linear predictions deviated from the measured responses considerably more than did predictions of our biochemical model (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). Specifically, linear models overpredicted responses at high mean light levels, and underpredicted responses at low mean light levels. Some of these issues could be resolved by adding a free scale factor (e.g. in <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>) or a time-independent nonlinearity to the linear model (i.e. a linear–nonlinear model); however, responses to many stimuli show clear time-dependent nonlinearities that are not captured by linear–nonlinear models (e.g. Figure 6; see also <xref ref-type="bibr" rid="bib2">Angueyra et al., 2022</xref>). The biochemical model, though not perfect, tracked the measured responses quite well.</p><p><xref ref-type="fig" rid="fig1">Figures 1</xref> and <xref ref-type="fig" rid="fig2">2</xref> indicate that the known components of the phototransduction cascade, with appropriate parameters, can account for the full time course of the rod and cone photocurrents, including the nonlinearities in the photoreceptor responses. These models will not capture slow forms of adaptation that might become important, for example, at high light levels; for the range of stimuli used here, such slow adaptation contributes little to the photoreceptor currents (e.g. <xref ref-type="bibr" rid="bib2">Angueyra et al., 2022</xref>). Our central goal was to use these models to design stimuli that permit predictable manipulations of the photoreceptor responses. Hence, more important than the accuracy of the forward model is the ability to predict stimuli the elicit desired responses. We directly evaluate these stimulus predictions below.</p></sec><sec id="s2-5"><title>Model inversion</title><p>In this section, we show that the model illustrated in <xref ref-type="fig" rid="fig1">Figure 1A</xref> can be exactly inverted to identify the stimulus that corresponds to a specific desired photoreceptor response. The resulting unique correspondence between photocurrent and stimulus applies to the entire stimulus waveform, including the mean intensity and modulations about the mean. In other words, the result of model inversion is an estimate of the full stimulus in real units (isomerizations per second) corresponding to the desired response.</p><p>Model inversion requires a one-to-one relationship between inputs and outputs – that is for every input there must be a unique output and vice versa. Mathematically, this holds for the phototransduction model summarized in <xref ref-type="fig" rid="fig1">Figure 1A</xref>: the model consists of linear elements (<xref ref-type="disp-formula" rid="equ1 equ2 equ5">Equations 1, 2, and 5</xref>), static nonlinear elements (<xref ref-type="disp-formula" rid="equ4 equ6">Equations 4 and 6</xref>), and a time-dependent nonlinear element (<xref ref-type="disp-formula" rid="equ3">Equation 3</xref>). The linear elements can be described as linear filters and inverted by deconvolution. The static nonlinear elements consist of one-to-one mappings of inputs to outputs and can be inverted correspondingly. The time-dependent nonlinear component can be rearranged and solved analytically (see Methods). The result is an analytical relationship between the phototransduction current and the stimulus – in other words an inverse model that takes the photocurrent as input and identifies the corresponding stimulus.</p><p><xref ref-type="fig" rid="fig3">Figure 3</xref> illustrates the steps in this procedure, using the current response generated by the forward model to the variable mean noise stimulus as an example ‘target’ (far right). The first step is to convert this target current response to corresponding time-varying concentrations of cGMP and calcium using <xref ref-type="disp-formula" rid="equ4 equ5">Equations 4 and 5</xref> (step 1). In step 2, the time courses of cGMP and calcium are used to determine the time-varying PDE activity using <xref ref-type="disp-formula" rid="equ3 equ6">Equations 3 and 6</xref>. In the final step (step 3), the PDE activity is used to determine the stimulus through <xref ref-type="disp-formula" rid="equ1 equ2">Equations 1 and 2</xref>. In this case, as expected, we recover exactly the stimulus that we started with, confirming that mathematically the phototransduction model can be inverted.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Steps in model inversion.</title><p>A test current was generated from a variable mean noise stimulus using the full model (far right). Step 1 (right) converts this current into changes in cGMP and calcium using <xref ref-type="disp-formula" rid="equ4 equ5">Equations 4 and 5</xref> (see <xref ref-type="fig" rid="fig1">Figure 1</xref>). Step 2 converts the time course of the cGMP and calcium into that of the phosphodiesterase (PDE) activity using <xref ref-type="disp-formula" rid="equ3 equ6">Equations 3 and 6</xref>. Finally, step 3 converts the PDE to the stimulus using <xref ref-type="disp-formula" rid="equ1 equ2">Equations 1 and 2</xref>. The estimated stimulus is identical to the initial stimulus because there is no added noise and the inversion process is exact. Icons at the far right depict different versions of the model used throughout the paper.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-93795-fig3-v1.tif"/></fig><p>The procedure illustrated in <xref ref-type="fig" rid="fig3">Figure 3</xref> is exact in the context of the phototransduction model – that is, given the architecture of the model, there is a one-to-one mapping of inputs to outputs. In practice, we would like to use this procedure to predict stimuli that will elicit specific photoreceptor responses. These model-based predictions could fail if the forward model does not accurately capture aspects of the real photoreceptor responses that are important for inversion. The model, for example, may capture some temporal frequencies of the response better than others, and this could limit the accuracy of the model inversion at those frequencies that are not captured well.</p><p>To test how well the model inversion process works on real responses, we applied it to measured photoreceptor responses to the variable mean noise stimulus. Noise in the measured responses could cause the estimate to be better at some temporal frequencies than others; this is particularly true at high temporal frequencies that are poorly encoded by the photoreceptors. The limited ability to recover spatial information in deconvolution microscopy provides an example of how noise can limit model inversion even with a good forward model. Noise in deconvolution microscopy is controlled by choosing not to try to recover spatial frequencies at which the noise is too high. We took a similar approach: we limited the frequency content of the stimulus to temporal frequencies that we could reasonably expect to recover (0–60 Hz for primate cones, 0–30 Hz for mouse cones, 0–15 Hz for both primate and mouse rods) and required that the power spectrum of our estimate matched that of the true stimulus (see Methods). These constraints reduced high-frequency noise in the estimated stimuli. <xref ref-type="fig" rid="fig4">Figure 4</xref> shows stimulus estimates based on measured responses for each photoreceptor type. The estimates closely approximate the actual stimulus, including recovering rapid stimulus fluctuations (insets). For each photoreceptor type, stimulus estimates based on model inversion captured the majority of the stimulus variance (<xref ref-type="fig" rid="fig4">Figure 4B</xref>).</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Test of model inversion based on measured responses.</title><p>(<bold>A</bold>) Stimulus (gray in top panel), measured response (black in lower panels), and estimated stimulus (blue in top panels) calculated by using the measured response as input to the inverse model as in <xref ref-type="fig" rid="fig3">Figure 3</xref>. Estimates are able to recover both the periodic changes in mean intensity and the more rapid superimposed stimulus modulations (insets). (<bold>B</bold>) Variance explained for stimulus estimates based on the average response across multiple stimulus trials compared to that based on individual responses. Since the model captures only the deterministic part of the response, noise in the individual responses lowers the accuracy of the estimates and causes the points to fall below the unity line. This effect is modest but systematic. Means ± SDs were 0.91 ± 0.02 (single epochs) and 0.92 ± 0.02 (mean) for six primate cones, 0.66 ± 0.08 and 0.72 ± 0.06 for six mouse cones, 0.74 ± 0.03 and 0.81 ± 0.04 for six primate rods, and 0.68 ± 0.04 and 0.77 ± 0.05 for eight mouse rods.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-93795-fig4-v1.tif"/></fig><p>Variance explained, as in <xref ref-type="fig" rid="fig4">Figure 4B</xref>, mixes low temporal frequencies for which we might expect inversion to work well with high temporal frequencies for which it is expected to do less well. To explore the accuracy of the inversion across temporal frequencies, we compared the power spectrum of the stimulus with that of the residuals given by the difference between the stimulus and estimate (<xref ref-type="fig" rid="fig5">Figure 5</xref>). At low temporal frequencies, stimulus power was much greater than that of the residuals, consistent with accurate stimulus estimation at these frequencies. This difference decreased with increasing frequency, and the two power spectra converged near 30 Hz for primate cones, 10 Hz for mouse cones, and 2–3 Hz for both primate and mouse rods. This provides an estimate of the frequency range over which stimulus inversion is possible for each photoreceptor type.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Errors in stimulus estimation.</title><p>Power spectra of stimulus and residual (stimulus − estimate) for example primate and mouse rods and cones (top) and averages across cells (bottom; six primate cones, six mouse cones, six primate rods, eight mouse rods). The stimulus and residual power spectra diverge strongly at low frequencies where the estimates are close to the actual stimulus, and converge at higher frequencies when the estimate becomes poor. The convergence point depends on photoreceptor type, as expected for the different kinetics of rod and cone responses.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-93795-fig5-v1.tif"/></fig><p>The ability to convert photoreceptor responses to input stimuli is useful in several ways (see Discussion). Our focus in the remainder of the Results is on using this approach to design stimuli that alter the photoreceptor responses in specific ways, such as negating the impact of adaptation and shaping response kinetics.</p></sec><sec id="s2-6"><title>Light-adaptation clamp examples</title><p><xref ref-type="fig" rid="fig6">Figure 6</xref> illustrates how we can use the model inversion procedure to predictably manipulate photoreceptor responses, in this case using the cone model and (for simplicity) a sinusoidal stimulus. Unlike <xref ref-type="fig" rid="fig4">Figure 4</xref> where we invert measured responses, we now start with a desired or target response. For the specific applications described below, the aim was to remove nonlinearities in photoreceptor responses and hence we generate the target response from a linear phototransduction model. As in <xref ref-type="fig" rid="fig2">Figure 2</xref>, the linear model used to generate the target response was obtained by fitting responses of the full phototransduction model to low-contrast noise stimuli at a specified mean light level (see Methods). The output of this linear model provides an estimate of how the photoreceptors would respond if we could eliminate their nonlinear properties. The response of the linear model to a sinusoidal stimulus is, as expected, another sinusoid (<xref ref-type="fig" rid="fig6">Figure 6</xref>, second panel from left). The response of real cones, and of the full cone model, deviates strongly from a sinusoid (black trace in the far right panel; <xref ref-type="bibr" rid="bib2">Angueyra et al., 2022</xref>).</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Light-adaptation clamp procedure.</title><p>Starting with an initial stimulus (left), we generate a target or desired response (second panel from right).</p><p>In this case, the target was chosen to be the response of a linear phototransduction model; for a sinusoidal input, a linear model produces a sinusoidal output. We use the (linear) target response as the input to the inverse phototransduction model and identify the stimulus required to elicit that response (red in third panel from left). Substantial stimulus modifications are required for the full model to produce a sinusoidal output. Finally, we confirm that the modified stimulus works as designed in direct recordings, in this case from a primate cone (right panel). Linear model parameters used to compute the target response (see <xref ref-type="disp-formula" rid="equ10">Equation 7</xref>) were <italic>α</italic> = 0.31, <italic>τ</italic><sub><italic>R</italic></sub> = 10.6 ms, and <italic>τ</italic><sub><italic>D</italic></sub> = 23.6 ms.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-93795-fig6-v1.tif"/></fig><p>Adaptive nonlinearities in phototransduction cause the responses to sinusoidal light inputs to deviate from sinusoids. These time-dependent nonlinearities operate sufficiently rapidly to shape each cycle of the response, causing responses to decreases in light intensity to be larger than those to increases and causing the responses to light-to-dark transitions to be slower than those to dark-to-light transitions. To eliminate the impact of these nonlinear response properties, we seek a stimulus that will cause the response of the full model to match the target response – that is a stimulus that ‘clamps’ the cone response to the target. The model inversion process identifies such a stimulus directly (red trace in second panel from right). Our primary interest is not in the shape of the stimulus itself but instead in the response that the stimulus produces. The right panel in <xref ref-type="fig" rid="fig6">Figure 6</xref> compares measured cone responses to the original (black) and modified (red) stimuli; responses to the modified stimulus are considerably more sinusoidal than those to the original stimulus, as quantified in more detail below.</p><p>The approach outlined in <xref ref-type="fig" rid="fig6">Figure 6</xref> is exact in principle, but could fail due either to inadequacies of the model or to cell-to-cell variability in the photoreceptor responses. Hence, a key step is testing whether the calculated stimuli produce the expected responses. <xref ref-type="fig" rid="fig7">Figures 7</xref>—<xref ref-type="fig" rid="fig9">9</xref> test this approach quantitatively for several stimulus manipulations.</p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Compensating for increment/decrement asymmetries in responses to sinusoidal stimuli.</title><p>(<bold>A</bold>) Photoreceptor responses to original sinusoidal stimuli (bottom, black) and modified stimuli (red). Dashed lines in the bottom panels are best-fitting sinusoids for reference. Original and modified stimuli are shown above the recorded responses. Linear model parameters used to compute the target responses (see <xref ref-type="disp-formula" rid="equ10">Equation 7</xref>) were <italic>α</italic> = 0.31 (20,000 R*/s) and 1.65 (5000 R*/s), <italic>τ</italic><sub><italic>R</italic></sub> = 10.6 and 15.2 ms, and <italic>τ</italic><sub><italic>D</italic></sub> = 23.6 and 18.1 ms for the primate cone, <italic>α</italic> = 0.031 and 0.13, <italic>τ</italic><sub><italic>R</italic></sub> = 31.6 and 26.7 ms, and <italic>τ</italic><sub><italic>D</italic></sub> = 56.7 and 50.3 ms for the mouse cone, <italic>α</italic> = 5.3, <italic>τ</italic><sub><italic>R</italic></sub> = 141 ms, and <italic>τ</italic><sub><italic>D</italic></sub> = 208 ms for the primate rod, and <italic>α</italic> = 4.7, <italic>τ</italic><sub><italic>R</italic></sub> = 115 ms, and <italic>τ</italic><sub><italic>D</italic></sub> = 185 ms for the mouse rod. (<bold>B</bold>) Mean-squared error between measured responses and best-fitting sinusoids for modified stimuli plotted against that for original stimuli for each recorded cell. Points with error bars are means ± SDs. These values are 0.15 ± 0.05 (modified) and 0.02 ± 0.02 (original) at 20,000 R*/s and 0.08 ± 0.06 and 0.03 ± 0.02 at 5000 R*/s for six primate cones, 0.10 ± 0.01 and 0.04 ± 0.03 (20,000 R*/s) and 0.06 ± 0.03 and 0.02 ± 0.01 (5000 R*/s) for five mouse cones, 0.14 ± 0.08 and 0.05 ± 0.01 for six primate rods, and 0.16 ± 0.04 and 0.03 ± 0.01 for seven mouse rods.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-93795-fig7-v1.tif"/></fig><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Compensating for adaptation produced by changes in mean light level.</title><p>(<bold>A</bold>) Responses to a brief light flash delivered before and during a step in light intensity. For the original stimuli, flashes delivered before and during the step are identical, and the resulting responses decrease in amplitude ~twofold (summarized on <italic>x</italic>-axis of bottom panels). Red traces show responses to stimuli designed to compensate for the adaptation produced by the change in light intensity (following approach in <xref ref-type="fig" rid="fig6">Figure 6</xref>). Linear model parameters used to compute the target responses (see <xref ref-type="disp-formula" rid="equ10">Equation 7</xref>) were <italic>α</italic> = 1.65, <italic>τ</italic><sub><italic>R</italic></sub> = 15.2 ms, and <italic>τ</italic><sub><italic>D</italic></sub> = 18.1 ms for the primate cone, <italic>α</italic> = 0.13, <italic>τ</italic><sub><italic>R</italic></sub> = 26.7 ms, and <italic>τ</italic><sub><italic>D</italic></sub> = 50.3 ms for the mouse cone, <italic>α</italic> = 5.3, <italic>τ</italic><sub><italic>R</italic></sub> = 141 ms, and <italic>τ</italic><sub><italic>D</italic></sub> = 208 ms for the primate rod, and <italic>α</italic> = 4.7, <italic>τ</italic><sub><italic>R</italic></sub> = 115 ms, and <italic>τ</italic><sub><italic>D</italic></sub> = 185 ms for the mouse rod. (<bold>B</bold>) Summary of gain changes (amplitude of response during the step divided by that of response prior to step) for responses to modified (<italic>y</italic>-axis) and original (<italic>x</italic>-axis) stimuli. Open circles show the mean ± SD; values are 1.2 ± 0.2 (modified) and 0.52 ± 0.06 (original) for 10 primate cones, 0.8 ± 0.1 and 0.32 ± 0.05 for 5 mouse cones, 1.3 ± 0.3 and 0.6 ± 0.1 for 7 primate rods, and 1.0 ± 0.1 and 0.47 ± 0.08 for 7 mouse rods.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-93795-fig8-v1.tif"/></fig><fig id="fig9" position="float"><label>Figure 9.</label><caption><title>Manipulating kinetics of photoreceptor responses.</title><p>(<bold>A</bold>) Responses of primate cones and mouse rods to brief flashes (black) and stimuli designed to slow down responses slightly (left) and more substantially (right) (red). Traces show the mean ± SEM (four cells for upper left, three for upper right, five for both bottom panels). Thin traces show the target responses used to generate the modified stimuli. (<bold>B</bold>) As in A for stimuli designed to speed up responses (measured traces show mean ± SEM for four cones in the top panel and three rods in the bottom panel). (<bold>C</bold>) Measured change in time-to-peak plotted against predicted change for a variety of manipulations of kinetics as in A and B. Linear model parameters used to compute the target responses (see <xref ref-type="disp-formula" rid="equ10">Equation 7</xref>) were <italic>α</italic> = 1.65, <italic>τ</italic><sub><italic>R</italic></sub> = 15.2 ms, and <italic>τ</italic><sub><italic>D</italic></sub> = 18.1 ms for the primate cone, <italic>α</italic> = 0.13, <italic>τ</italic><sub><italic>R</italic></sub> = 26.7 ms, and <italic>τ</italic><sub><italic>D</italic></sub> = 50.3 ms for the mouse cone, <italic>α</italic> = 5.3, <italic>τ</italic><sub><italic>R</italic></sub> = 141 ms, and <italic>τ</italic><sub><italic>D</italic></sub> = 208 ms for the primate rod, and <italic>α</italic> = 4.7, <italic>τ</italic><sub><italic>R</italic></sub> = 115 ms, and <italic>τ</italic><sub><italic>D</italic></sub> = 185 ms for the mouse rod.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-93795-fig9-v1.tif"/></fig></sec><sec id="s2-7"><title>Sinusoidal stimuli</title><p>We start with the sinusoidal stimuli illustrated in <xref ref-type="fig" rid="fig6">Figure 6</xref>. As predicted by the model, responses of both rod and cone photoreceptors to high-contrast sinusoidal light inputs are strongly nonsinusoidal: responses to decreases in light intensity are larger than those to increases, and responses to dark-to-light transitions are faster than those to corresponding light-to-dark transitions (<xref ref-type="fig" rid="fig7">Figure 7A</xref>). These nonlinearities in the photoreceptor responses are clear from the substantial deviations between the measured responses and the best-fitting sinusoids (dashed lines in <xref ref-type="fig" rid="fig7">Figure 7A</xref>). These response asymmetries are important in interpreting responses of downstream visual neurons to similar stimuli. For example, asymmetries in signaling of On and Off ganglion cells are often attributed to differences in On and Off retinal circuits (e.g. <xref ref-type="bibr" rid="bib49">Stockman et al., 2014</xref>), and the possibility that they arise at least in part in the photoreceptors themselves is rarely considered.</p><p>Responses to the modified stimuli (red traces in <xref ref-type="fig" rid="fig7">Figure 7A</xref>) were much closer to sinusoidal than responses to the original sinusoidal stimuli (black traces). Specifically, asymmetries between increment and decrement responses and light-to-dark vs dark-to-light transitions were substantially reduced for the modified stimuli. We quantified these deviations of the measured responses from a sinusoid for both original and modified stimuli by computing the MSE between the recorded responses and the best-fit sinusoid. Sinusoidal fits to responses to the modified stimuli had considerably lower MSE than those to the original stimuli in each rod and cone tested (<xref ref-type="fig" rid="fig7">Figure 7B</xref>). Neither the sinusoidal stimuli nor the specific cells that contribute to <xref ref-type="fig" rid="fig7">Figure 7</xref> were used in fitting the phototransduction models. Hence, <xref ref-type="fig" rid="fig7">Figure 7</xref> tests the ability of the model-based inversion process to generalize across photoreceptors and across stimuli.</p><p><xref ref-type="fig" rid="fig7">Figure 7</xref> demonstrates that the adaptive nonlinearities in phototransduction that distort responses to sinusoidal stimuli can largely be compensated for, resulting in near-sinusoidal responses. These or similar modified stimuli could in turn be used to test the contribution of nonlinearities in phototransduction to asymmetries in responses of On and Off retinal neurons to sinusoidal stimuli such as drifting or contrast-reversing gratings.</p></sec><sec id="s2-8"><title>Steps and flashes</title><p>As a second example of the light-adaptation clamp procedure, we generated stimuli that compensate for the adaptive changes in gain of photoreceptor responses produced by changes in mean light intensity. These gain changes cause responses to a fixed strength flash to become smaller and faster when the mean light intensity increases.</p><p>The control stimulus consisted of identical flashes delivered at two mean light levels. As expected, responses to this stimulus (black traces in <xref ref-type="fig" rid="fig8">Figure 8A</xref>) showed clear effects of adaptation. Specifically, the response to the flash decreased ~twofold at the higher mean light level (summarized in <xref ref-type="fig" rid="fig8">Figure 8B</xref>). We then passed this original stimulus through a linear model to estimate the photoreceptor response without adaptation. This linear prediction provided the target response in the stimulus identification process illustrated in <xref ref-type="fig" rid="fig6">Figure 6</xref>; the resulting modified stimuli are shown in red at the top of <xref ref-type="fig" rid="fig8">Figure 8A</xref>. None of the cells used to test these modified stimuli contributed to the model fitting, so this again tests the ability of the models to generalize across photoreceptors.</p><p>The red traces in <xref ref-type="fig" rid="fig8">Figure 8A</xref> (bottom) show responses to the stimuli designed to compensate for adaptation. Responses to the test flashes had similar amplitudes at the low and high mean light level. This similarity is held across cells (the ratio of the response amplitudes is plotted on the <italic>y</italic>-axes in <xref ref-type="fig" rid="fig8">Figure 8B</xref>). The change in gain produced by the background was reduced in all photoreceptor types. Responses to the modified stimuli in some cases (e.g. the mouse cones) show a systematic dependence on background, likely due to differences in sensitivity between the cells used to fit and test the model. Nonetheless, the modified stimuli compensated for much of the reduction in response gain produced by adaptation.</p></sec><sec id="s2-9"><title>Altering kinetics</title><p>As for adaptation, separating the contributions of phototransduction and post-transduction circuit mechanisms to the kinetics of responses of downstream cells is difficult. Hence, we sought to use the model inversion process to predictably alter the kinetics of the photoreceptor responses, which could help elucidate the impact of photoreceptor kinetics on downstream signaling. For example, compensating for the speeding of photoreceptor responses that occurs with increasing light intensity would isolate the kinetics of the post-transduction circuitry and determine if they change independently from the changes in kinetics of the photoreceptor responses.</p><p>Slowing down the kinetics is conceptually straightforward – we slow down the kinetics of the stimulus itself and that will also cause the response to slow down. We applied this approach to responses to brief flashes. To test if we could do this in a predictable manner, we slowed the linear responses to a brief flash by factors of 1.25–4 by scaling the time constants in <xref ref-type="disp-formula" rid="equ10">Equation 7</xref>. We used the resulting responses as the targets for the model inversion as in <xref ref-type="fig" rid="fig6">Figure 6</xref>. We omitted mouse cones because these experiments required longer-lasting recordings with stable kinetics, which were difficult to achieve with these cells.</p><p>The top panels in <xref ref-type="fig" rid="fig9">Figure 9A</xref> show original (black) and modified (red) stimuli designed to slow down the photoreceptor response slightly (left) and more substantially (right). The bottom panels compare measured (thick traces) and predicted (thin traces) responses to the original flash and the modified stimuli. Changes in time-to-peak of the measured responses to the modified stimuli follow the predictions well for both rod and cone photoreceptors (summarized in <xref ref-type="fig" rid="fig9">Figure 9C</xref>).</p><p>Speeding up the responses is similarly straightforward in principle but more difficult in practice. Stimuli that speed up the response consist of a brief increment followed by a decrement – which together cause all but the initial rising phase of the response to cancel. In practice, this approach is limited because the contrast of the decrement cannot exceed 100%. Nonetheless, speeding up responses by 20–30% is possible, and stimuli predicted to achieve this are shown in <xref ref-type="fig" rid="fig9">Figure 9B</xref>. Measured responses sped as predicted, although the falling phase of the response, particularly for mouse rods, was faster than the predicted response. This again likely reflects differences in the specific cells used to fit and test the model. As for slowing responses, the time-to-peak of the measured responses closely follows predictions (<xref ref-type="fig" rid="fig9">Figure 9C</xref>).</p></sec><sec id="s2-10"><title>Impact of cone adaptation on ganglion cell responses</title><p>The overall goal of this project is to separate the contributions of phototransduction and post-transduction circuit mechanisms to downstream visual signaling. Here, we show two examples of how the ability to manipulate photoreceptor responses can reveal adaptational mechanisms at different locations in retinal circuits.</p><p>First, we compare responses of primate cones and downstream retinal neurons to the step plus flash stimulus used in <xref ref-type="fig" rid="fig8">Figure 8</xref>. <xref ref-type="fig" rid="fig10">Figure 10A</xref> shows responses of a primate cone, a horizontal cell, and an On parasol ganglion cell to the original step plus flash stimulus (black) and the modified stimulus that negates cone adaptation (red). The stimuli used for the three cells illustrated were identical. As shown in <xref ref-type="fig" rid="fig8">Figure 8</xref>, the modified stimulus effectively negates adaptation in the cone transduction currents, and the responses to the cone responses to the two flashes are similar. Negating adaptation in the cones also eliminated most or all of the adaptation in downstream responses (summarized in <xref ref-type="fig" rid="fig10">Figure 10B</xref>). Ratios exceeding one are likely due to differences in sensitivity between the cells used to fit and test the model. Previous work reached a similar conclusion by quantitatively comparing adaptation measured in cones and retinal ganglion cells (<xref ref-type="bibr" rid="bib23">Dunn et al., 2007</xref>). Negating cone adaptation provides an alternative approach to this issue and similar questions about the contributions of photoreceptor and post-photoreceptor adaptation.</p><fig id="fig10" position="float"><label>Figure 10.</label><caption><title>Cone and post-cone adaptation.</title><p>(<bold>A</bold>) Left: schematic of retinal circuit. Right: responses of a cone (top), horizontal cell (middle), and On parasol ganglion cell (bottom) to the step and flash protocol for both original and modified stimuli. Stimuli were delivered from a computer monitor at a refresh rate of 60 Hz and hence appear different from those in <xref ref-type="fig" rid="fig8">Figure 8</xref>. (<bold>B</bold>) Summary of experiments like those in A, plotting the change in gain for the modified stimuli (the ratio of the amplitude of the response to the flash during the step that before) against that for the original stimuli. Means ± SDs were 1.2 ± 0.2 (modified) 0.52 ± 0.06 (original) for 10 cones and 1.2 ± 0.1 and 0.6 ± 0.2 for 5 parasol RGCs. (<bold>C</bold>) Left: horizontal cell responses to a sinusoidal stimulus (black) and stimulus modified to generate sinusoidal cone responses (red, see also <xref ref-type="fig" rid="fig6">Figures 6</xref> and <xref ref-type="fig" rid="fig7">7</xref>). Right: trajectories of responses to one stimulus cycle. The response to the original stimulus follows different trajectories during the depolarizing (a→b→c) phase compared to the hyperpolarizing (c→d→a) phase. (<bold>D</bold>) Summary of results from three horizontal cells and three cone bipolar cells. Time-dependent nonlinearities were measured from the area enclosed by response trajectories as in C. Means ± SDs were 0.08 ± 0.05 (area modified) and 0.22 ± 0.08 (area original) across all six cells. Linear model parameters used to compute the target responses (see <xref ref-type="disp-formula" rid="equ10">Equation 7</xref>) were <italic>α</italic> = 1.65, <italic>τ</italic><sub><italic>R</italic></sub> = 15.2 ms, and <italic>τ</italic><sub><italic>D</italic></sub> = 18.1 ms.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-93795-fig10-v1.tif"/></fig><p>Second, we recorded responses of primate horizontal cells and cone bipolar cells to sinusoidal stimuli and stimuli designed to produce sinusoidal cone transduction currents (as in <xref ref-type="fig" rid="fig6">Figures 6</xref> and <xref ref-type="fig" rid="fig7">7</xref>). Horizontal cell responses to both stimuli showed clear nonlinearities (<xref ref-type="fig" rid="fig10">Figure 10C</xref>, left); specifically, responses to the increment and decrement phases of the stimuli were highly asymmetric. The depolarizing and hyperpolarizing phases of the responses, however, appeared more symmetrical for the modified stimuli (red). The change in shape can be visualized by plotting the trajectories of one cycle of the responses vs the stimulus (<xref ref-type="fig" rid="fig10">Figure 10C</xref>, right). For the original sinusoid, the depolarizing (a→b→c) and hyperpolarizing (c-→d→a) response phases differed considerably. These differences were much smaller for the modified stimuli. This difference in response shape held across cells (<xref ref-type="fig" rid="fig10">Figure 10D</xref>). In this case, compensating for nonlinearities in cone phototransduction reveals an additional, largely time-independent, nonlinear process shaping horizontal and cone bipolar responses. Furthermore, it disentangles contributions of phototransduction and post-transduction processes to time-dependent and time-independent nonlinearities in the horizontal and bipolar responses.</p><p><xref ref-type="fig" rid="fig10">Figure 10</xref> shows two relatively simple examples of how the stimulus design approach developed here can be used. We return to other possible applications in the Discussion.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Rod and cone photoreceptors play an essential role in the responses of downstream visual neurons and visual perception. Refining this picture to identify the specific contributions of photoreceptors and post-photoreceptor circuitry to the computations that underlie vision has been difficult. Here, we have created and tested a tool that allows predictable manipulations of the photoreceptor responses to reveal their role in downstream signaling. Direct tests indicate that this tool is effective, and that it generalizes well across photoreceptors and stimuli. We envision this being useful to causally test how responses of downstream cells or perception are shaped by specific aspects of the photoreceptor responses such as adaptation. We have described in Methods procedures that should help translate this tool to other laboratories.</p><sec id="s3-1"><title>Limitations</title><sec id="s3-1-1"><title>Model validation</title><p>The procedure that we use to invert the phototransduction cascade is only as good as the model upon which it is based. Thus, a focus of the experiments presented here was to test a range of manipulations for stimuli and photoreceptors that did not contribute to the model fits. We did this by fitting consensus models to recordings from one set of photoreceptors of a given type, and then testing the stimuli generated by these models on different photoreceptors from different retinas. Discrepancies between the predicted and measured responses to these new stimuli reflect both failures of the model inversion and cell-to-cell variability. Systematic differences between predicted and measured responses were relatively small, and most of the differences appear to reflect variability between cells (e.g. due to cell-to-cell differences in sensitivity).</p></sec><sec id="s3-1-2"><title>Focus on phototransduction</title><p>Our model describes the relationship between light inputs and phototransduction currents. We restricted our consideration to photocurrents rather than photoreceptor synaptic output because the latter is shaped by several mechanisms (e.g. electrical coupling between photoreceptors <xref ref-type="bibr" rid="bib18">Copenhagen and Owen, 1976</xref>; <xref ref-type="bibr" rid="bib20">Detwiler and Hodgkin, 1979</xref>; <xref ref-type="bibr" rid="bib47">Schwartz, 1976</xref> and horizontal feedback <xref ref-type="bibr" rid="bib4">Baylor et al., 1971</xref>) that are less well understood than phototransduction. A similar approach could be extended beyond phototransduction to include electrical properties of the photoreceptor inner segment and photoreceptor output synapses when additional quantitative information about these mechanisms is available. The models we develop here will be important in such future work, as they will allow isolation of mechanisms operating after phototransduction (e.g. in <xref ref-type="fig" rid="fig10">Figure 10C</xref>).</p></sec><sec id="s3-1-3"><title>Photopigment bleaching</title><p>The model that we used does not consider photopigment bleaching and regeneration via the pigment epithelium. We omitted these aspects of photoreceptor function because the experiments to which we fit and test the model require that we remove the pigment epithelium. We restricted total light exposure in these experiments to minimize bleaching, and this limits the range of light levels over which the model is applicable. This is less of a concern for rods, where rod saturation occurs for light levels at which a small fraction of the rod pigment is bleached, and correspondingly our models cover most or all of the range of rod signals. For cones, the model is limited to light levels &lt;50,000 R*/s (similar to or a bit brighter than typical indoor lighting conditions).</p></sec><sec id="s3-1-4"><title>Speeding vs slowing responses</title><p>Not all manipulations of the photoreceptor responses are equally easily achieved. Speeding responses is particularly difficult because it requires increasing the amplitude of high temporal frequencies, and the ability to do that is limited by the requirement that light intensities not assume negative values. This means that low-contrast stimuli can be sped more than high-contrast stimuli.</p></sec><sec id="s3-1-5"><title>Calibrations</title><p>The accuracy of the model predictions depends critically on accurate light calibrations. We have detailed our procedure in Methods and supplied our calibration code (<ext-link ext-link-type="uri" xlink:href="https://github.com/chrischen2/photoreceptorLinearization">https://github.com/chrischen2/photoreceptorLinearization</ext-link>, copy archived at <xref ref-type="bibr" rid="bib14">Chen, 2024</xref>). With consistent calibrations, the approaches we use here should translate directly across laboratories and to in vivo physiological or perceptual studies.</p></sec></sec><sec id="s3-2"><title>Applications</title><sec id="s3-2-1"><title>‘Front end’ for encoding models for downstream responses and perception</title><p>Two broad classes of encoding models have been used to describe responses of retinal ganglion cells and cells in downstream visual areas. Empirical models take light stimuli as inputs and convert these, through a series of linear and nonlinear elements, to predicted responses (<xref ref-type="bibr" rid="bib15">Chichilnisky, 2001</xref>; <xref ref-type="bibr" rid="bib40">Pillow et al., 2008</xref>). Time-dependent nonlinearities are particularly hard to capture in such models, and few existing models account for them. CNN models similarly take light input and convert it, via the learned CNN weights, to predicted neural responses (<xref ref-type="bibr" rid="bib37">McIntosh et al., 2016</xref>; <xref ref-type="bibr" rid="bib50">Turner et al., 2019</xref>). Like empirical models, time-dependent nonlinearities such as adaptation are generally not well described by such models. As a result, these models work best when stimulus parameters such as mean light intensity do not change.</p><p>The photoreceptor models described here convert light inputs to photoreceptor responses, capturing time-dependent nonlinearities in this process. Empirical or CNN models could then be used to describe the conversion of photoreceptor signals to downstream neural responses. This architecture – a phototransduction model front end followed by an empirical model – should decrease the demand placed on the empirical model and improve the ability to capture responses to stimuli that strongly engage photoreceptor adaptation. Hybrid models of this type indeed show improved performance in predicting retinal ganglion cell responses across light levels (<xref ref-type="bibr" rid="bib30">Idrees et al., 2024</xref>). Models for visual perception could similarly incorporate a photoreceptor front end, and by doing so directly test which aspects of perception can be explained by phototransduction and which are due to downstream processing.</p></sec><sec id="s3-2-2"><title>‘Back end’ to decoding models</title><p>Approaches to decode neural responses and estimate stimulus properties could also benefit from the photoreceptor models. Current decoding approaches either empirically fit response–stimulus relationships or invert encoding models to compute the likelihood of particular stimuli given the neural response (<xref ref-type="bibr" rid="bib7">Bialek et al., 1991</xref>; <xref ref-type="bibr" rid="bib9">Brackbill et al., 2020</xref>; <xref ref-type="bibr" rid="bib52">Wu et al., 2024</xref>). In either case, decoding in the context of stimuli that strongly engage time-dependent nonlinearities has proven difficult.</p><p>Incorporating the inverse photoreceptor model into decoding approaches should improve decoding performance. Specifically, existing decoding approaches could be used to estimate the photoreceptor signal from downstream neural responses (e.g. those of retinal ganglion cells), and then the inverse phototransduction model would convert the estimated photoreceptor signals to estimated stimuli. This again could decrease the demand placed on the decoding model. For example, under conditions in which much of retinal adaptation is largely accounted for by adaptation in the photoreceptors, the model used to estimate photoreceptor responses from retinal ganglion cell responses would not need to incorporate adaptive nonlinearities. Instead, this model could be fixed even as mean light levels change, and the inverse photoreceptor model would account for photoreceptor adaptation. A ganglion cell→photoreceptor decoding model should be simpler to fit and hence perform better than a full ganglion cell→stimulus model.</p></sec><sec id="s3-2-3"><title>Complementing genetic approaches</title><p>Genetic manipulations provide another approach to alter photoreceptor responses and characterize the impact on responses of downstream visual neurons or behavior. Such approaches have the advantage of associating specific molecular components with alterations in vision – for example the role of arrestin (<xref ref-type="bibr" rid="bib13">Burns et al., 2006</xref>; <xref ref-type="bibr" rid="bib53">Xu et al., 1997</xref>) and rhodopsin kinase (<xref ref-type="bibr" rid="bib3">Arshavsky, 2002</xref>; <xref ref-type="bibr" rid="bib51">Wilden et al., 1986</xref>; <xref ref-type="bibr" rid="bib58">Zhao et al., 1995</xref>) in specific forms of stationary night blindness (<xref ref-type="bibr" rid="bib21">Dryja, 2000</xref>; <xref ref-type="bibr" rid="bib57">Zeitz et al., 2014</xref>). But interpretation of these genetic manipulations can be limited by compensatory changes.</p><p>The approach that we introduce here complements genetic manipulations in at least two ways. First, it could be used in conjunction with genetic manipulations – for example to restore normal kinetics in photoreceptors in which the genetic alteration changes response kinetics. Second, the stimulus design approach provides an alternative that provides less detailed mechanistic information, but which allows more specific functional manipulations to be made and does not require genetic access.</p></sec><sec id="s3-2-4"><title>Manipulations of phototransduction currents and identifying nonlinear circuit properties</title><p>The models that we introduce here provide a new tool to causally test the impact of alterations in photoreceptor responses on downstream responses and perception. For example, asymmetries in how increments and decrements in light intensity are processed have been well studied, including responses in retina, cortex, and perception (<xref ref-type="bibr" rid="bib8">Bowen et al., 1989</xref>; <xref ref-type="bibr" rid="bib36">Lu and Sperling, 2012</xref>). Parallel On and Off visual pathways are initiated at the cone output synapse, and asymmetries in downstream responses or perception are often attributed to asymmetries in the On and Off retinal circuits conveying photoreceptor signals to the ganglion cells (e.g. <xref ref-type="bibr" rid="bib49">Stockman et al., 2014</xref>). The implicit assumption is that photoreceptor inputs to On and Off retinal circuits are symmetrical. While this is likely the case for low-contrast stimuli, rapid adaptation in phototransduction means that high-contrast stimuli will often not produce symmetric input to those circuits, and On/Off asymmetries may originate at least in part from asymmetric photoreceptor responses to light increments and decrements (<xref ref-type="bibr" rid="bib2">Angueyra et al., 2022</xref>; <xref ref-type="bibr" rid="bib17">Clark et al., 2013</xref>; <xref ref-type="bibr" rid="bib24">Endeman and Kamermans, 2010</xref>). The ability to invert the phototransduction model permits the design of stimuli that minimize such asymmetries in the photoreceptor responses to test how they contribute to On/Off differences in downstream responses (e.g. <xref ref-type="bibr" rid="bib55">Yu et al., 2022</xref>).</p><p>More generally, the ability to shape photoreceptor responses in predictable ways provides a needed tool to isolate the effects of photoreceptor and post-photoreceptor circuits to shaping responses of downstream neurons and perception. Nonlinear circuit properties are a particular challenge since their impact depends on the input stimulus, yet they are also particularly important since they account for the bulk of interesting computation. Advances in modeling, particularly CNN-based approaches, can be used to fit circuit outputs and reveal how specific computations may be implemented. But such approaches rarely identify a unique explanation. Another approach is to record from each of the relevant circuit elements. This is technically challenging. Manipulating photoreceptor responses provides another tool, as illustrated in <xref ref-type="fig" rid="fig10">Figure 10</xref>. A key feature of this tool is the ability of our photoreceptor models to generalize across stimuli, including accounting for nonlinear properties of the photoreceptor responses to stimuli that did not contribute to the model directly.</p></sec></sec></sec><sec id="s4" sec-type="methods"><title>Methods</title><table-wrap id="keyresource" position="anchor"><label>Key resources table</label><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Reagent type (species) or resource</th><th align="left" valign="bottom">Designation</th><th align="left" valign="bottom">Source or reference</th><th align="left" valign="bottom">Identifiers</th><th align="left" valign="bottom">Additional information</th></tr></thead><tbody><tr><td align="left" valign="bottom">Biological sample (<italic>Mus musculus</italic>)</td><td align="char" char="." valign="bottom">129S1/SvlmJ</td><td align="left" valign="bottom">The Jackson Laboratory</td><td align="left" valign="bottom">RRID:<ext-link ext-link-type="uri" xlink:href="https://identifiers.org/RRID/RRID:IMSR_JAX:002448">IMSR_JAX:002448</ext-link></td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Biological sample (<italic>Mus musculus</italic>)</td><td align="left" valign="bottom">C57BL/6J</td><td align="left" valign="bottom">The Jackson Laboratory</td><td align="left" valign="bottom">RRID:<ext-link ext-link-type="uri" xlink:href="https://identifiers.org/RRID/RRID:IMSR_JAX:000664">IMSR_JAX:000664</ext-link></td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Biological sample (<italic>Macaca fascicularis</italic>)</td><td align="left" valign="bottom"/><td align="left" valign="bottom">Washington Regional Primate Research Center</td><td align="left" valign="bottom">N/A</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Biological sample (<italic>Macaca nemenstrina</italic>)</td><td align="left" valign="bottom"/><td align="left" valign="bottom">Washington Regional Primate Research Center</td><td align="left" valign="bottom">N/A</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Chemical compound, drug</td><td align="left" valign="bottom">Ames</td><td align="left" valign="bottom">MilliporeSigma</td><td align="left" valign="bottom">Cat #A1420</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Software, algorithms</td><td align="left" valign="bottom">MATLAB</td><td align="left" valign="bottom">Mathworks</td><td align="left" valign="bottom"><ext-link ext-link-type="uri" xlink:href="https://www.mathworks.com/products/matlab.html">https://www.mathworks.com/products/matlab.html</ext-link></td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Software, algorithms</td><td align="left" valign="bottom">Stage</td><td align="left" valign="bottom">Stage-VSS</td><td align="left" valign="bottom"><ext-link ext-link-type="uri" xlink:href="https://stage-vss.github.io">https://stage-vss.github.io</ext-link></td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Software, algorithms</td><td align="left" valign="bottom">Symphony</td><td align="left" valign="bottom">Symphony-DS</td><td align="left" valign="bottom"><ext-link ext-link-type="uri" xlink:href="http://symphony-das.github.io">http://symphony-das.github.io</ext-link></td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Software, algorithms</td><td align="left" valign="bottom">Igor Pro</td><td align="left" valign="bottom">Wavemetrics</td><td align="left" valign="bottom">N/A</td><td align="left" valign="bottom"/></tr></tbody></table></table-wrap><sec id="s4-1"><title>Recordings</title><p>We performed electrophysiological recordings from primate (<italic>Macaca fascicularis</italic>, <italic>nemestrina</italic>, and <italic>mulatta</italic>, either sex, 2–20 years) and mouse retina (C57/BL6 or sv-129, either sex, 1–12 months) in accordance with the University of Washington Institutional Animal Care and Use Committee. Primate retinas were obtained through the Tissue Distribution Program of the University of Washington Regional Primate Research Center. Primate recordings were all at &gt;20<sup>o</sup> eccentricity.</p><p>Rod responses were recorded with suction electrodes (<xref ref-type="bibr" rid="bib25">Field and Rieke, 2002</xref>). These recordings were sufficiently stable that we could record responses to all three test stimuli in <xref ref-type="fig" rid="fig1">Figure 1B</xref>. Data were collected from any primate rod with a dark current exceeding 18 pA and any mouse rod with a dark current exceeding 15 pA. Periodic standardized flashes tested for changes in kinetics or amplitude of the light response, and recordings were terminated if such changes were apparent. Most recordings were stable for at least 10–15 min before changes in kinetics were apparent, and all cells meeting this criterion are included in our analyses.</p><p>Cones were recorded with whole-cell patch clamp techniques in slice (mouse; <xref ref-type="bibr" rid="bib31">Ingram et al., 2019</xref>) and whole-mount preparations (primate; <xref ref-type="bibr" rid="bib1">Angueyra and Rieke, 2013</xref>). We focused on M and S cones in mouse and L and M cones in primate. Data were collected and analyzed from any primate cone with a dark current exceeding 200 pA and any mouse cone with a dark current exceeding 40 pA. Cone responses in these recordings run down quickly due to intracellular dialysis of the cell; hence, responses to only one of the stimuli in <xref ref-type="fig" rid="fig1">Figure 1B</xref> were recorded from each cone. All data reported here were collected within 2–3 min of patch rupture and the onset of intracellular dialysis.</p></sec><sec id="s4-2"><title>Light calibrations</title><p>Optical power was measured at the preparation with a calibrated power meter (Graseby). Power readings were converted to isomerizations per second (R*/s) using the photoreceptor spectral sensitivities, the LED spectral outputs, and collecting areas of rods and cones (1 and 0.37 μm<sup>2</sup> for primates, 0.5 and 0.2 μm<sup>2</sup> for mouse). This conversion proceeded in three steps: (1) the total calibrated power was converted to a power density (W/μm<sup>2</sup>) using the size of the illuminated area in the microscope image plane; (2) LED emission spectra were scaled such that their integrals matched the calibrated power density; (3) the resulting calibrated LED emission spectra were converted to R*/s by taking the dot product with the photoreceptor spectral sensitivities (<xref ref-type="bibr" rid="bib6">Baylor et al., 1987</xref>; <xref ref-type="bibr" rid="bib39">Nikonov et al., 2006</xref>) and scaling by the collecting area (<ext-link ext-link-type="uri" xlink:href="https://github.com/chrischen2/photoreceptorLinearization">https://github.com/chrischen2/photoreceptorLinearization</ext-link>, copy archived at <xref ref-type="bibr" rid="bib14">Chen, 2024</xref>).</p><p>Light stimuli from the LEDs were focused on the preparation via the microscope condenser or objective. Stimuli uniformly illuminated a 600-μm diameter spot. LED outputs were carefully checked for linearity. For rod recordings, we used an LED with peak output at 470 nm, near the peak of the rod spectral sensitivity. For cone recordings, we used an LED with peak output at 405 nm, which produced near-equal (within 10%) activation of L and M cones in primate and S and M cones in mouse. <xref ref-type="fig" rid="fig10">Figure 10</xref> used an OLED computer monitor (eMagin) to deliver stimuli; the monitor outputs were calibrated as above for the LEDs.</p></sec><sec id="s4-3"><title>Forward model</title><p>The phototransduction cascade was modeled with the set of differential equations illustrated in <xref ref-type="fig" rid="fig1">Figure 1A</xref>. This follows previous modeling work in both rods and cones (<xref ref-type="bibr" rid="bib2">Angueyra et al., 2022</xref>; <xref ref-type="bibr" rid="bib38">Nikonov et al., 2000</xref>; <xref ref-type="bibr" rid="bib41">Pugh and Lamb, 1993</xref>; <xref ref-type="bibr" rid="bib43">Rieke and Baylor, 1998a</xref>; <xref ref-type="bibr" rid="bib54">Younger et al., 1996</xref>). Our model has 11 parameters. In the first step of the model, the light stimulus (Stim) activates opsin molecules, converting inactive opsin (<italic>R</italic>) to active opsin (<italic>R*</italic>). Active opsin decays with a rate constant <italic>σ</italic> (<xref ref-type="fig" rid="fig1">Figure 1A</xref>).:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mi>d</mml:mi><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>γ</mml:mi><mml:mi>S</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>σ</mml:mi><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Next, PDE molecules are activated by active opsin molecules via the G-protein transducin; the resulting PDE activity (<italic>P</italic>) decays with a rate constant <italic>Φ</italic> (<xref ref-type="fig" rid="fig1">Figure 1A</xref>):<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mi>d</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>η</mml:mi></mml:mrow></mml:math></disp-formula></p><p>We assume that the delay caused by transducin activation is negligible and hence omit this step for simplicity. The opsin decay rate <italic>σ</italic> and the PDE decay rate <italic>Φ</italic> were interchangeable (<xref ref-type="bibr" rid="bib41">Pugh and Lamb, 1993</xref>), and the model output depended only on the smaller of these (i.e. the slower process). Hence, <italic>σ</italic> and <italic>Φ</italic> were constrained to be equal.</p><p>The concentration of cGMP in the outer segment (<italic>G</italic>) is determined by the balance of cGMP hydrolysis mediated by PDE and synthesis (<italic>S</italic>) through guanylate cyclase (<italic>GC</italic>) (<xref ref-type="fig" rid="fig1">Figure 1A</xref>):<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mi>d</mml:mi><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>For physiological conditions, the outer segment current (<italic>I</italic>) through cGMP-gated channels depends on a power of the cGMP concentration (<xref ref-type="fig" rid="fig1">Figure 1A</xref>; <xref ref-type="bibr" rid="bib42">Rieke and Baylor, 1996</xref>):<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:msup><mml:mi>G</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Calcium enters the outer segment through open cGMP channels and is removed by an exchange protein, with a rate constant <italic>β</italic> (<xref ref-type="fig" rid="fig1">Figure 1A</xref>):<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mi>d</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The calcium concentration (<italic>C</italic>) regulates the rate of cGMP synthesis (<italic>S</italic>); this dependence is modeled as a Hill curve (<xref ref-type="fig" rid="fig1">Figure 1A</xref>):<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mtext> </mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>Two model parameters were fixed by steady-state conditions and prior measurements. First, the constant <italic>q</italic> that relates current and changes in calcium can be expressed in terms of the dark calcium concentration, dark current, and rate constant <italic>β</italic> for calcium extrusion:<disp-formula id="equ7"><mml:math id="m7"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>β</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>Second, the maximal cyclase rate (<italic>S<sub>max</sub></italic>) can be written in terms of <italic>Φ</italic>, <italic>η</italic>, <italic>K<sub>GC</sub></italic>, <italic>m</italic>, and the dark calcium (<italic>C<sub>D</sub></italic>) and cGMP concentrations (<italic>G<sub>D</sub></italic>):<disp-formula id="equ8"><mml:math id="m8"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mtext> </mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>We fixed the constants <italic>k</italic> and <italic>n</italic> that determine the relation between cGMP and current at values measured for rods (e.g. <xref ref-type="bibr" rid="bib42">Rieke and Baylor, 1996</xref>); modest changes in these parameters produced little or no change in model performance due to compensation by other model parameters. Using these constants, the cGMP concentration in darkness <inline-formula><mml:math id="inf17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> was estimated from the measured dark current (<inline-formula><mml:math id="inf18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) using <xref ref-type="disp-formula" rid="equ4">Equation 4</xref> (e.g. the response to a saturating light flash) for each recorded cell. We also fixed <italic>m</italic> for both rods and cones and <italic>β</italic> for rods based on previous measurements (<xref ref-type="bibr" rid="bib25">Field and Rieke, 2002</xref>; <xref ref-type="bibr" rid="bib34">Koutalos et al., 1995a</xref>; <xref ref-type="bibr" rid="bib42">Rieke and Baylor, 1996</xref>). We assumed a dark calcium concentration (<italic>C<sub>D</sub></italic>) of 1 μM (<xref ref-type="bibr" rid="bib28">Gray-Keller and Detwiler, 1994</xref>; <xref ref-type="bibr" rid="bib45">Sampath et al., 1999</xref>); the model was insensitive to this value, as the dependence of the synthesis rate on calcium (<italic>K<sub>GC</sub></italic>) compensated for any change.</p><p>This left a total of four free parameters for rod models (<italic>γ</italic>, <italic>η</italic>, <italic>σ</italic>, <italic>K<sub>GC</sub></italic>), and five for cone models (<italic>γ</italic>, <italic>η</italic>, <italic>β</italic>, <italic>σ</italic>, <italic>K<sub>GC</sub></italic>). These parameters were determined by minimizing the mean-squared difference between the measured responses and model predictions while the remaining model parameters were held fixed. Some combinations of model parameters can trade for each other, resulting in similar model performance (e.g. <italic>C<sub>D</sub></italic> and <italic>K<sub>GC</sub></italic>). Our goal here was to identify a model that captures photoreceptor responses across a range of stimuli, rather than a model in which the fit parameters were predictions of the underlying biochemical parameters.</p><p>We identified optimal values for the free parameters (see <xref ref-type="table" rid="table1">Table 1</xref>) using the MATLAB fminsearch routine, which employs the Nelder–Mead simplex algorithm. The time step in these calculations was 0.1 ms for cones and 1 ms for rods. The objective function minimized the MSE between the measured and predicted responses. The goodness of fit was assessed using the fraction of variance explained, calculated as 1 − (<italic>SSE</italic>/<italic>SST</italic>), where <italic>SSE</italic> is the sum of squared errors between the model and the data, and <italic>SST</italic> is the total sum of squares (variance) of the data. The model’s performance was validated using independent datasets.</p><p>Parameters of consensus models were determined by simultaneously fitting measured responses across all recorded cells of a given type. To evaluate the model’s ability to generalize across different cells and stimuli, we fixed all parameters except for <italic>G<sub>D</sub></italic> and <italic>γ. G<sub>D</sub></italic> was determined from the measured dark current (<italic>I<sub>D</sub></italic>) for each individual photoreceptor. <italic>γ</italic> was allowed to vary between cells to account for differences in sensitivity, while the remaining parameters were constrained to be identical. For example, consensus parameters for a set of five cones would have common free parameters of <italic>η</italic>, <italic>β</italic>, <italic>σ</italic>, <italic>K<sub>GC</sub></italic> and five individual <italic>γs</italic> (one for each cell). Consensus parameters are given in <xref ref-type="table" rid="table1">Table 1</xref>. Fitted <italic>γ</italic> values were 8 ± 3 (mean ± SD) for primate cones, 3 ± 1 for mouse cones, 5.3 ± 0.7 for primate rods, and 7.4 ± 2.4 for mouse rods.</p><p>We evaluated the sensitivity of the model outputs to each fit parameter by identifying parameter ranges that doubled the MSE of the fits. <xref ref-type="table" rid="table2">Table 2</xref> includes these parameter ranges. We also tested sensitivity to combinations of parameters using sloppy modeling (see further details below and <xref ref-type="bibr" rid="bib10">Brown and Sethna, 2003</xref>). This approach identifies specific combinations of parameters that have maximal and minimal impact on model error – in our case the MSE. For cone models, parameters controlling the calcium feedback (<italic>β</italic> and <italic>K<sub>GC</sub></italic>) could compensate for each other to have relatively minor effects on fit quality. Fit quality was particularly sensitive to changes in the parameters controlling the PDE activation (<italic>σ</italic> and <italic>η</italic>). Rod models were relatively insensitive to changes in <italic>σ</italic> and <italic>η</italic> and were particularly sensitive to changes in <italic>K<sub>GC</sub></italic> and <italic>γ</italic>.</p><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>Parameter variations that double the mean-squared error of the fits.</title><p>Error was measured while a single parameter was systematically varied; other parameters were held fixed at the consensus model values.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom" rowspan="2">Parameter</th><th align="left" valign="bottom" rowspan="2">Symbol</th><th align="left" valign="bottom" rowspan="2">Units</th><th align="left" valign="bottom" colspan="4">Values: optimal [lower, upper]</th></tr><tr><th align="left" valign="bottom">Primatecone</th><th align="left" valign="bottom">Mousecone</th><th align="left" valign="bottom">Primaterod</th><th align="left" valign="bottom">Mouserod</th></tr></thead><tbody><tr><td align="left" valign="bottom">Opsin decay rate const.</td><td align="left" valign="bottom"><italic>σ</italic></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="char" char="." valign="bottom">22 [14, 34]</td><td align="char" char="." valign="bottom">9.74 [7.3, 13.1]</td><td align="char" char="." valign="bottom">7.07 [5.8, 8.8]</td><td align="char" char="." valign="bottom">7.66 [6.1, 9.3]</td></tr><tr><td align="left" valign="bottom">PDE dark activation rate</td><td align="left" valign="bottom"><italic>η</italic></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="char" char="." valign="bottom">2000 [1300, 3300]</td><td align="char" char="." valign="bottom">761 [494, 1218]</td><td align="char" char="." valign="bottom">2.53 [2.1, 3.2]</td><td align="char" char="." valign="bottom">1.62 [1.3, 2.1]</td></tr><tr><td align="left" valign="bottom">Ca<sup>2+</sup> extrusion rate const.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf21"><mml:mi>β</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="char" char="." valign="bottom">9 [5, 40]</td><td align="char" char="." valign="bottom">2.64 [1.58, 5.7]</td><td align="left" valign="bottom">N.A.</td><td align="left" valign="bottom">N.A.</td></tr><tr><td align="left" valign="bottom">Ca<sup>2+</sup> GC affinity</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf23"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="char" char="." valign="bottom">0.5 [0, 0.6]</td><td align="char" char="." valign="bottom">0.4 [0.26 0.46]</td><td align="char" char="." valign="bottom">0.5 [0.44, 0.53]</td><td align="char" char="." valign="bottom">0.4 [0.32, 0.44]</td></tr></tbody></table></table-wrap></sec><sec id="s4-4"><title>Sloppy modeling</title><p>Sloppy modeling enables us to understand how a model’s cost function depends on the model parameters individually and in combination. We started by computing the Hessian matrix <italic>H</italic> at a location in parameter space given by the consensus fit parameters<disp-formula id="equ9"><mml:math id="m9"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf25"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf26"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> represent different parameters and <italic>C</italic> is the cost function. The Hessian provides a measure of the curvature of the cost function around the best-fit model parameters. We numerically approximate the Hessian by taking incremental changes in pairs of parameters around the best fit and measuring the changes in MSE. The eigenvectors of the Hessian matrix identify directions in parameter space in which the cost function changes slowly or rapidly.</p></sec><sec id="s4-5"><title>Linear model</title><p>The linear models used to generate the target response were obtained by fitting a parameterized linear filter to the response of the full model to low-contrast Gaussian noise at a specific mean light level. The linear filter is defined as:<disp-formula id="equ10"><label>(7)</label><mml:math id="m10"><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mi>t</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mspace width="thinmathspace"/></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mi>t</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mi>t</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mspace width="thinmathspace"/></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is a scaling factor, and <inline-formula><mml:math id="inf28"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf29"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are the rising and decay time constants. This model provides good fits to measured low-contrast responses of rods and cones (<xref ref-type="bibr" rid="bib1">Angueyra and Rieke, 2013</xref>). Photoreceptor responses to low-contrast stimuli depend linearly on the stimulus (<xref ref-type="bibr" rid="bib29">Hass et al., 2015</xref>), and hence this approach ensured that the linear model matched the full model for such stimuli. The linear filter was convolved directly with the light stimulus to obtain a linear estimate of the responses.</p></sec><sec id="s4-6"><title>Inverse model</title><p>The differential equations that comprise our model consist of several time-independent nonlinearities (<xref ref-type="disp-formula" rid="equ4 equ6">Equations 4 and 6</xref> in <xref ref-type="fig" rid="fig1">Figure 1</xref>), several linear differential equations (<xref ref-type="disp-formula" rid="equ1 equ2 equ5">Equations 1, 2, and 5</xref> in <xref ref-type="fig" rid="fig1">Figure 1</xref>), and one nonlinear differential equation (<xref ref-type="disp-formula" rid="equ3">Equation 3</xref> in <xref ref-type="fig" rid="fig1">Figure 1</xref>). The time-independent nonlinearities can be inverted directly as a look-up table – for example the cGMP depends directly on the current as <italic>G</italic> = (<italic>I</italic>/<italic>k</italic>)<sup>1/</sup><italic><sup>n</sup></italic>. The linear differential equations can be solved directly by deconvolution – for example the Fourier transform of the calcium concentration from <xref ref-type="disp-formula" rid="equ5">Equation 5</xref> in <xref ref-type="fig" rid="fig1">Figure 1</xref> is obtained directly from the Fourier transform of the measured current (<italic>I</italic>(<italic>f</italic>)) as<disp-formula id="equ11"><label>(8)</label><mml:math id="m11"><mml:mrow><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>−</mml:mo><mml:mtext> </mml:mtext><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>i</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>where <italic>f</italic> is the temporal frequency. The nonlinear differential equation (<xref ref-type="disp-formula" rid="equ3">Equation 3</xref> in <xref ref-type="fig" rid="fig1">Figure 1</xref>) can be reexpressed as an equation for the PDE activity <italic>P</italic> in terms of the cGMP concentration <italic>G</italic> and its derivative <italic>dG</italic>/<italic>dt</italic> as<disp-formula id="equ12"><label>(9)</label><mml:math id="m12"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>This equation can be solved given <italic>G</italic> (obtained from the current via <xref ref-type="disp-formula" rid="equ4">Equation 4</xref> in <xref ref-type="fig" rid="fig1">Figure 1</xref>), and <italic>S</italic> (obtained from the calcium concentration <italic>C</italic>(<italic>t</italic>) and <xref ref-type="disp-formula" rid="equ6">Equation 6</xref> in <xref ref-type="fig" rid="fig1">Figure 1</xref>). These steps in the inversion process are illustrated in <xref ref-type="fig" rid="fig3">Figure 3</xref>.</p><p>This process results in an exact mapping between responses and stimuli – that is every response <italic>I</italic>(<italic>t</italic>) has a corresponding unique stimulus <italic>Stim</italic>(<italic>t</italic>). In practice, noise in the measured responses can corrupt the estimated stimuli. This is a general problem in deconvolution of noisy data – for example in microscopy. As indicated in the text, we controlled this noise when necessary by imposing that the power spectrum of our estimated stimulus be equal to the power spectrum of the true stimulus. This constraint was imposed by generating the estimated stimulus as described above, and then reweighting the power spectrum of the estimated stimulus to match the power spectrum of the true stimulus. This constraint was used in generating the estimated stimuli in <xref ref-type="fig" rid="fig4">Figure 4</xref>.</p></sec><sec id="s4-7"><title>Predictably altering photoreceptor responses</title><p>Model inversion as described above allowed us to identify stimuli that would produce a desired phototransduction current (which we refer to as a target response). For the applications in <xref ref-type="fig" rid="fig6">Figures 6</xref>—<xref ref-type="fig" rid="fig10">10</xref>, we generated this response using the linear model of the transduction cascade described above (<xref ref-type="disp-formula" rid="equ10">Equation 7</xref>). We passed an initial stimulus (e.g. a sinusoid in <xref ref-type="fig" rid="fig6">Figures 6</xref> and <xref ref-type="fig" rid="fig7">7</xref>) through the linear model to generate the target response. The model inversion process for the full (i.e. nonlinear) phototransduction cascade model then determined the stimulus which, when delivered to the full model, would produce the linear target response. In particular, this allowed us to identify stimuli that negated the impact of adaptation on the photoreceptor responses.</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>Reviewing editor, eLife</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Investigation, Visualization, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Investigation</p></fn><fn fn-type="con" id="con3"><p>Investigation, Writing – review and editing</p></fn><fn fn-type="con" id="con4"><p>Software, Formal analysis, Investigation, Writing – review and editing</p></fn><fn fn-type="con" id="con5"><p>Investigation, Writing – review and editing</p></fn><fn fn-type="con" id="con6"><p>Conceptualization, Software, Formal analysis, Funding acquisition, Investigation, Visualization, Writing – original draft, Project administration, Writing – review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>Experiments were performed on mouse and primate retina following procedures in accordance with the University of Washington Institutional Animal Care and Use Committee (protocols 4140-01 and 3030-01). Primate retinas were obtained through the Tissue Distribution Program of the University of Washington's Regional Primate Research Center. Recordings were made from retinas from <italic>Macaca fascicularis</italic>, <italic>Macaca nemestrina</italic>, and <italic>Macaca mulatta</italic> of both sexes, aged 2–20 years. Recordings from mouse used animals of both sexes with ages of 6–12 weeks.</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-93795-mdarchecklist1-v1.pdf" mimetype="application" mime-subtype="pdf"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>Data used in all the model fitting is available at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5061/dryad.q2bvq83vg">https://doi.org/10.5061/dryad.q2bvq83vg</ext-link>. This includes all the source data for Figures 1–5 and associated figure supplements.</p><p>The following dataset was generated:</p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset1"><person-group person-group-type="author"><name><surname>Rieke</surname><given-names>F</given-names></name><name><surname>Chen</surname><given-names>Q</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>Predictably manipulating photoreceptor light responses to reveal their role in downstream visual responses</data-title><source>Dryad Digital Repository</source><pub-id pub-id-type="doi">10.5061/dryad.q2bvq83vg</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>We thank Shellee Cunnington for excellent technical support. We are grateful for assistance from the WaNPRC staff, especially Chris English, for access to primate tissue. Shane Boniec, Greg Horwitz, and Saad Idrees provided invaluable feedback on a draft of the manuscript. This work was supported by NIH grant EY028542 (FR) and the Air Force Office of Scientific Research under award number FA9550-21-1-0230 (special thanks to the AFOSR’s Cognitive &amp; Computational Neuroscience Program).</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Angueyra</surname><given-names>JM</given-names></name><name><surname>Rieke</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Origin and effect of phototransduction noise in primate cone photoreceptors</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>1692</fpage><lpage>1700</lpage><pub-id pub-id-type="doi">10.1038/nn.3534</pub-id><pub-id pub-id-type="pmid">24097042</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Angueyra</surname><given-names>JM</given-names></name><name><surname>Baudin</surname><given-names>J</given-names></name><name><surname>Schwartz</surname><given-names>GW</given-names></name><name><surname>Rieke</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Predicting and manipulating cone responses to naturalistic inputs</article-title><source>The Journal of Neuroscience</source><volume>42</volume><fpage>1254</fpage><lpage>1274</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0793-21.2021</pub-id><pub-id pub-id-type="pmid">34949692</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arshavsky</surname><given-names>VY</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Rhodopsin phosphorylation: from terminating single photon responses to photoreceptor dark adaptation</article-title><source>Trends in Neurosciences</source><volume>25</volume><fpage>124</fpage><lpage>126</lpage><pub-id pub-id-type="doi">10.1016/s0166-2236(00)02094-4</pub-id><pub-id pub-id-type="pmid">11852136</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baylor</surname><given-names>DA</given-names></name><name><surname>Fuortes</surname><given-names>MG</given-names></name><name><surname>O’Bryan</surname><given-names>PM</given-names></name></person-group><year iso-8601-date="1971">1971</year><article-title>Receptive fields of cones in the retina of the turtle</article-title><source>The Journal of Physiology</source><volume>214</volume><fpage>265</fpage><lpage>294</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.1971.sp009432</pub-id><pub-id pub-id-type="pmid">5579638</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baylor</surname><given-names>DA</given-names></name><name><surname>Nunn</surname><given-names>BJ</given-names></name><name><surname>Schnapf</surname><given-names>JL</given-names></name></person-group><year iso-8601-date="1984">1984</year><article-title>The photocurrent, noise and spectral sensitivity of rods of the monkey Macaca fascicularis</article-title><source>The Journal of Physiology</source><volume>357</volume><fpage>575</fpage><lpage>607</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.1984.sp015518</pub-id><pub-id pub-id-type="pmid">6512705</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baylor</surname><given-names>DA</given-names></name><name><surname>Nunn</surname><given-names>BJ</given-names></name><name><surname>Schnapf</surname><given-names>JL</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Spectral sensitivity of cones of the monkey Macaca fascicularis</article-title><source>The Journal of Physiology</source><volume>390</volume><fpage>145</fpage><lpage>160</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.1987.sp016691</pub-id><pub-id pub-id-type="pmid">3443931</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bialek</surname><given-names>W</given-names></name><name><surname>Rieke</surname><given-names>F</given-names></name><name><surname>de Ruyter van Steveninck</surname><given-names>RR</given-names></name><name><surname>Warland</surname><given-names>D</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>Reading a neural code</article-title><source>Science</source><volume>252</volume><fpage>1854</fpage><lpage>1857</lpage><pub-id pub-id-type="doi">10.1126/science.2063199</pub-id><pub-id pub-id-type="pmid">2063199</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bowen</surname><given-names>RW</given-names></name><name><surname>Pokorny</surname><given-names>J</given-names></name><name><surname>Smith</surname><given-names>VC</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>Sawtooth contrast sensitivity: decrements have the edge</article-title><source>Vision Research</source><volume>29</volume><fpage>1501</fpage><lpage>1509</lpage><pub-id pub-id-type="doi">10.1016/0042-6989(89)90134-x</pub-id><pub-id pub-id-type="pmid">2635476</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brackbill</surname><given-names>N</given-names></name><name><surname>Rhoades</surname><given-names>C</given-names></name><name><surname>Kling</surname><given-names>A</given-names></name><name><surname>Shah</surname><given-names>NP</given-names></name><name><surname>Sher</surname><given-names>A</given-names></name><name><surname>Litke</surname><given-names>AM</given-names></name><name><surname>Chichilnisky</surname><given-names>EJ</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Reconstruction of natural images from responses of primate retinal ganglion cells</article-title><source>eLife</source><volume>9</volume><elocation-id>e58516</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.58516</pub-id><pub-id pub-id-type="pmid">33146609</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname><given-names>KS</given-names></name><name><surname>Sethna</surname><given-names>JP</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Statistical mechanical approaches to models with many poorly known parameters</article-title><source>Physical Review. E, Statistical, Nonlinear, and Soft Matter Physics</source><volume>68</volume><elocation-id>021904</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.68.021904</pub-id><pub-id pub-id-type="pmid">14525003</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burns</surname><given-names>ME</given-names></name><name><surname>Baylor</surname><given-names>DA</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Activation, deactivation, and adaptation in vertebrate photoreceptor cells</article-title><source>Annual Review of Neuroscience</source><volume>24</volume><fpage>779</fpage><lpage>805</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.24.1.779</pub-id><pub-id pub-id-type="pmid">11520918</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burns</surname><given-names>ME</given-names></name><name><surname>Mendez</surname><given-names>A</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Baylor</surname><given-names>DA</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Dynamics of cyclic GMP synthesis in retinal rods</article-title><source>Neuron</source><volume>36</volume><fpage>81</fpage><lpage>91</lpage><pub-id pub-id-type="doi">10.1016/s0896-6273(02)00911-x</pub-id><pub-id pub-id-type="pmid">12367508</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burns</surname><given-names>ME</given-names></name><name><surname>Mendez</surname><given-names>A</given-names></name><name><surname>Chen</surname><given-names>CK</given-names></name><name><surname>Almuete</surname><given-names>A</given-names></name><name><surname>Quillinan</surname><given-names>N</given-names></name><name><surname>Simon</surname><given-names>MI</given-names></name><name><surname>Baylor</surname><given-names>DA</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Deactivation of phosphorylated and nonphosphorylated rhodopsin by arrestin splice variants</article-title><source>The Journal of Neuroscience</source><volume>26</volume><fpage>1036</fpage><lpage>1044</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3301-05.2006</pub-id><pub-id pub-id-type="pmid">16421323</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>Q</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>PhotoreceptorLinearization</data-title><version designator="swh:1:rev:1bcf7c9a6a6814ef39d2c39d82cf8dd1b5b39db2">swh:1:rev:1bcf7c9a6a6814ef39d2c39d82cf8dd1b5b39db2</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:019825874ad88407c750a1d5af9d840a298cc4dd;origin=https://github.com/chrischen2/photoreceptorLinearization;visit=swh:1:snp:00f274bbc4d9f40b5ee6762012967111e3f1e266;anchor=swh:1:rev:1bcf7c9a6a6814ef39d2c39d82cf8dd1b5b39db2">https://archive.softwareheritage.org/swh:1:dir:019825874ad88407c750a1d5af9d840a298cc4dd;origin=https://github.com/chrischen2/photoreceptorLinearization;visit=swh:1:snp:00f274bbc4d9f40b5ee6762012967111e3f1e266;anchor=swh:1:rev:1bcf7c9a6a6814ef39d2c39d82cf8dd1b5b39db2</ext-link></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chichilnisky</surname><given-names>EJ</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>A simple white noise analysis of neuronal light responses</article-title><source>Network</source><volume>12</volume><fpage>199</fpage><lpage>213</lpage><pub-id pub-id-type="doi">10.1080/net.12.2.199.213</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Churchland</surname><given-names>AK</given-names></name><name><surname>Abbott</surname><given-names>LF</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Conceptual and technical advances define a key moment for theoretical neuroscience</article-title><source>Nature Neuroscience</source><volume>19</volume><fpage>348</fpage><lpage>349</lpage><pub-id pub-id-type="doi">10.1038/nn.4255</pub-id><pub-id pub-id-type="pmid">26906500</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clark</surname><given-names>DA</given-names></name><name><surname>Benichou</surname><given-names>R</given-names></name><name><surname>Meister</surname><given-names>M</given-names></name><name><surname>Azeredo da Silveira</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Dynamical adaptation in photoreceptors</article-title><source>PLOS Computational Biology</source><volume>9</volume><elocation-id>e1003289</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003289</pub-id><pub-id pub-id-type="pmid">24244119</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Copenhagen</surname><given-names>DR</given-names></name><name><surname>Owen</surname><given-names>WG</given-names></name></person-group><year iso-8601-date="1976">1976</year><article-title>Coupling between rod photoreceptors in a vertebrate retina</article-title><source>Nature</source><volume>260</volume><fpage>57</fpage><lpage>59</lpage><pub-id pub-id-type="doi">10.1038/260057a0</pub-id><pub-id pub-id-type="pmid">1264196</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Demb</surname><given-names>JB</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Functional circuitry of visual adaptation in the retina</article-title><source>The Journal of Physiology</source><volume>586</volume><fpage>4377</fpage><lpage>4384</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.2008.156638</pub-id><pub-id pub-id-type="pmid">18617564</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Detwiler</surname><given-names>PB</given-names></name><name><surname>Hodgkin</surname><given-names>AL</given-names></name></person-group><year iso-8601-date="1979">1979</year><article-title>Electrical coupling between cones in turtle retina</article-title><source>The Journal of Physiology</source><volume>291</volume><fpage>75</fpage><lpage>100</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.1979.sp012801</pub-id><pub-id pub-id-type="pmid">225478</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dryja</surname><given-names>TP</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Molecular genetics of Oguchi disease, fundus albipunctatus, and other forms of stationary night blindness: LVII Edward Jackson Memorial Lecture</article-title><source>American Journal of Ophthalmology</source><volume>130</volume><fpage>547</fpage><lpage>563</lpage><pub-id pub-id-type="doi">10.1016/s0002-9394(00)00737-6</pub-id><pub-id pub-id-type="pmid">11078833</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dunn</surname><given-names>FA</given-names></name><name><surname>Rieke</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>The impact of photoreceptor noise on retinal gain controls</article-title><source>Current Opinion in Neurobiology</source><volume>16</volume><fpage>363</fpage><lpage>370</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2006.06.013</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dunn</surname><given-names>FA</given-names></name><name><surname>Lankheet</surname><given-names>MJ</given-names></name><name><surname>Rieke</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Light adaptation in cone vision involves switching between receptor and post-receptor sites</article-title><source>Nature</source><volume>449</volume><fpage>603</fpage><lpage>606</lpage><pub-id pub-id-type="doi">10.1038/nature06150</pub-id><pub-id pub-id-type="pmid">17851533</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Endeman</surname><given-names>D</given-names></name><name><surname>Kamermans</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Cones perform a non-linear transformation on natural stimuli</article-title><source>The Journal of Physiology</source><volume>588</volume><fpage>435</fpage><lpage>446</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.2009.179036</pub-id><pub-id pub-id-type="pmid">20008463</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Field</surname><given-names>GD</given-names></name><name><surname>Rieke</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Mechanisms regulating variability of the single photon responses of mammalian rod photoreceptors</article-title><source>Neuron</source><volume>35</volume><fpage>733</fpage><lpage>747</lpage><pub-id pub-id-type="doi">10.1016/s0896-6273(02)00822-x</pub-id><pub-id pub-id-type="pmid">12194872</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frazor</surname><given-names>RA</given-names></name><name><surname>Geisler</surname><given-names>WS</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Local luminance and contrast in natural images</article-title><source>Vision Research</source><volume>46</volume><fpage>1585</fpage><lpage>1598</lpage><pub-id pub-id-type="doi">10.1016/j.visres.2005.06.038</pub-id><pub-id pub-id-type="pmid">16403546</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gollisch</surname><given-names>T</given-names></name><name><surname>Meister</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Eye smarter than scientists believed: neural computations in circuits of the retina</article-title><source>Neuron</source><volume>65</volume><fpage>150</fpage><lpage>164</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2009.12.009</pub-id><pub-id pub-id-type="pmid">20152123</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gray-Keller</surname><given-names>MP</given-names></name><name><surname>Detwiler</surname><given-names>PB</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>The calcium feedback signal in the phototransduction cascade of vertebrate rods</article-title><source>Neuron</source><volume>13</volume><fpage>849</fpage><lpage>861</lpage><pub-id pub-id-type="doi">10.1016/0896-6273(94)90251-8</pub-id><pub-id pub-id-type="pmid">7524559</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hass</surname><given-names>CA</given-names></name><name><surname>Angueyra</surname><given-names>JM</given-names></name><name><surname>Lindbloom-Brown</surname><given-names>Z</given-names></name><name><surname>Rieke</surname><given-names>F</given-names></name><name><surname>Horwitz</surname><given-names>GD</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Chromatic detection from cone photoreceptors to V1 neurons to behavior in rhesus monkeys</article-title><source>Journal of Vision</source><volume>15</volume><elocation-id>1</elocation-id><pub-id pub-id-type="doi">10.1167/15.15.1</pub-id><pub-id pub-id-type="pmid">26523737</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Idrees</surname><given-names>S</given-names></name><name><surname>Manookin</surname><given-names>MB</given-names></name><name><surname>Rieke</surname><given-names>F</given-names></name><name><surname>Field</surname><given-names>GD</given-names></name><name><surname>Zylberberg</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Biophysical neural adaptation mechanisms enable artificial neural networks to capture dynamic retinal computation</article-title><source>Nature Communications</source><volume>15</volume><elocation-id>5957</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-024-50114-5</pub-id><pub-id pub-id-type="pmid">39009568</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ingram</surname><given-names>NT</given-names></name><name><surname>Sampath</surname><given-names>AP</given-names></name><name><surname>Fain</surname><given-names>GL</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Voltage-clamp recordings of light responses from wild-type and mutant mouse cone photoreceptors</article-title><source>The Journal of General Physiology</source><volume>151</volume><fpage>1287</fpage><lpage>1299</lpage><pub-id pub-id-type="doi">10.1085/jgp.201912419</pub-id><pub-id pub-id-type="pmid">31562185</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Isaacson</surname><given-names>JS</given-names></name><name><surname>Scanziani</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>How inhibition shapes cortical activity</article-title><source>Neuron</source><volume>72</volume><fpage>231</fpage><lpage>243</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2011.09.027</pub-id><pub-id pub-id-type="pmid">22017986</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jadzinsky</surname><given-names>PD</given-names></name><name><surname>Baccus</surname><given-names>SA</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Transformation of visual signals by inhibitory interneurons in retinal circuits</article-title><source>Annual Review of Neuroscience</source><volume>36</volume><fpage>403</fpage><lpage>428</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-062012-170315</pub-id><pub-id pub-id-type="pmid">23724996</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koutalos</surname><given-names>Y</given-names></name><name><surname>Nakatani</surname><given-names>K</given-names></name><name><surname>Tamura</surname><given-names>T</given-names></name><name><surname>Yau</surname><given-names>KW</given-names></name></person-group><year iso-8601-date="1995">1995a</year><article-title>Characterization of guanylate cyclase activity in single retinal rod outer segments</article-title><source>The Journal of General Physiology</source><volume>106</volume><fpage>863</fpage><lpage>890</lpage><pub-id pub-id-type="doi">10.1085/jgp.106.5.863</pub-id><pub-id pub-id-type="pmid">8648296</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koutalos</surname><given-names>Y</given-names></name><name><surname>Nakatani</surname><given-names>K</given-names></name><name><surname>Yau</surname><given-names>KW</given-names></name></person-group><year iso-8601-date="1995">1995b</year><article-title>Cyclic GMP diffusion coefficient in rod photoreceptor outer segments</article-title><source>Biophysical Journal</source><volume>68</volume><fpage>373</fpage><lpage>382</lpage><pub-id pub-id-type="doi">10.1016/S0006-3495(95)80198-0</pub-id><pub-id pub-id-type="pmid">7536055</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lu</surname><given-names>ZL</given-names></name><name><surname>Sperling</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Black-white asymmetry in visual perception</article-title><source>Journal of Vision</source><volume>12</volume><elocation-id>8</elocation-id><pub-id pub-id-type="doi">10.1167/12.10.8</pub-id><pub-id pub-id-type="pmid">22984221</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McIntosh</surname><given-names>LT</given-names></name><name><surname>Maheswaranathan</surname><given-names>N</given-names></name><name><surname>Nayebi</surname><given-names>A</given-names></name><name><surname>Ganguli</surname><given-names>S</given-names></name><name><surname>Baccus</surname><given-names>SA</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Deep learning models of the retinal response to natural scenes</article-title><source>Advances in Neural Information Processing Systems</source><volume>29</volume><fpage>1369</fpage><lpage>1377</lpage><pub-id pub-id-type="pmid">28729779</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nikonov</surname><given-names>S</given-names></name><name><surname>Lamb</surname><given-names>TD</given-names></name><name><surname>Pugh</surname><given-names>EN</given-names><suffix>Jr</suffix></name></person-group><year iso-8601-date="2000">2000</year><article-title>The role of steady phosphodiesterase activity in the kinetics and sensitivity of the light-adapted salamander rod photoresponse</article-title><source>The Journal of General Physiology</source><volume>116</volume><fpage>795</fpage><lpage>824</lpage><pub-id pub-id-type="doi">10.1085/jgp.116.6.795</pub-id><pub-id pub-id-type="pmid">11099349</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nikonov</surname><given-names>SS</given-names></name><name><surname>Kholodenko</surname><given-names>R</given-names></name><name><surname>Lem</surname><given-names>J</given-names></name><name><surname>Pugh</surname><given-names>EN</given-names><suffix>Jr</suffix></name></person-group><year iso-8601-date="2006">2006</year><article-title>Physiological features of the S- and M-cone photoreceptors of wild-type mice from single-cell recordings</article-title><source>The Journal of General Physiology</source><volume>127</volume><fpage>359</fpage><lpage>374</lpage><pub-id pub-id-type="doi">10.1085/jgp.200609490</pub-id><pub-id pub-id-type="pmid">16567464</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pillow</surname><given-names>JW</given-names></name><name><surname>Shlens</surname><given-names>J</given-names></name><name><surname>Paninski</surname><given-names>L</given-names></name><name><surname>Sher</surname><given-names>A</given-names></name><name><surname>Litke</surname><given-names>AM</given-names></name><name><surname>Chichilnisky</surname><given-names>EJ</given-names></name><name><surname>Simoncelli</surname><given-names>EP</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Spatio-temporal correlations and visual signalling in a complete neuronal population</article-title><source>Nature</source><volume>454</volume><fpage>995</fpage><lpage>999</lpage><pub-id pub-id-type="doi">10.1038/nature07140</pub-id><pub-id pub-id-type="pmid">18650810</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pugh</surname><given-names>EN</given-names><suffix>Jr</suffix></name><name><surname>Lamb</surname><given-names>TD</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Amplification and kinetics of the activation steps in phototransduction</article-title><source>Biochimica et Biophysica Acta</source><volume>1141</volume><fpage>111</fpage><lpage>149</lpage><pub-id pub-id-type="doi">10.1016/0005-2728(93)90038-h</pub-id><pub-id pub-id-type="pmid">8382952</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rieke</surname><given-names>F</given-names></name><name><surname>Baylor</surname><given-names>DA</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Molecular origin of continuous dark noise in rod photoreceptors</article-title><source>Biophysical Journal</source><volume>71</volume><fpage>2553</fpage><lpage>2572</lpage><pub-id pub-id-type="doi">10.1016/S0006-3495(96)79448-1</pub-id><pub-id pub-id-type="pmid">8913594</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rieke</surname><given-names>F</given-names></name><name><surname>Baylor</surname><given-names>DA</given-names></name></person-group><year iso-8601-date="1998">1998a</year><article-title>Single-photon detection by rod cells of the retina</article-title><source>Reviews of Modern Physics</source><volume>70</volume><fpage>1027</fpage><lpage>1036</lpage><pub-id pub-id-type="doi">10.1103/RevModPhys.70.1027</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rieke</surname><given-names>F</given-names></name><name><surname>Baylor</surname><given-names>DA</given-names></name></person-group><year iso-8601-date="1998">1998b</year><article-title>Origin of reproducibility in the responses of retinal rods to single photons</article-title><source>Biophysical Journal</source><volume>75</volume><fpage>1836</fpage><lpage>1857</lpage><pub-id pub-id-type="doi">10.1016/S0006-3495(98)77625-8</pub-id><pub-id pub-id-type="pmid">9746525</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sampath</surname><given-names>AP</given-names></name><name><surname>Matthews</surname><given-names>HR</given-names></name><name><surname>Cornwall</surname><given-names>MC</given-names></name><name><surname>Bandarchi</surname><given-names>J</given-names></name><name><surname>Fain</surname><given-names>GL</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Light-dependent changes in outer segment free-Ca2+ concentration in salamander cone photoreceptors</article-title><source>The Journal of General Physiology</source><volume>113</volume><fpage>267</fpage><lpage>277</lpage><pub-id pub-id-type="doi">10.1085/jgp.113.2.267</pub-id><pub-id pub-id-type="pmid">9925824</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schnapf</surname><given-names>JL</given-names></name><name><surname>Nunn</surname><given-names>BJ</given-names></name><name><surname>Meister</surname><given-names>M</given-names></name><name><surname>Baylor</surname><given-names>DA</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Visual transduction in cones of the monkey Macaca fascicularis</article-title><source>The Journal of Physiology</source><volume>427</volume><fpage>681</fpage><lpage>713</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.1990.sp018193</pub-id><pub-id pub-id-type="pmid">2100987</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwartz</surname><given-names>EA</given-names></name></person-group><year iso-8601-date="1976">1976</year><article-title>Electrical properties of the rod syncytium in the retina of the turtle</article-title><source>The Journal of Physiology</source><volume>257</volume><fpage>379</fpage><lpage>406</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.1976.sp011374</pub-id><pub-id pub-id-type="pmid">950599</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Schwartz</surname><given-names>GW</given-names></name></person-group><year iso-8601-date="2021">2021</year><source>Retinal Computation</source><publisher-name>Elsevier</publisher-name></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stockman</surname><given-names>A</given-names></name><name><surname>Petrova</surname><given-names>D</given-names></name><name><surname>Henning</surname><given-names>GB</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Color and brightness encoded in a common L- and M-cone pathway with expansive and compressive nonlinearities</article-title><source>Journal of Vision</source><volume>14</volume><elocation-id>1</elocation-id><pub-id pub-id-type="doi">10.1167/14.3.1</pub-id><pub-id pub-id-type="pmid">24591566</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turner</surname><given-names>MH</given-names></name><name><surname>Sanchez Giraldo</surname><given-names>LG</given-names></name><name><surname>Schwartz</surname><given-names>O</given-names></name><name><surname>Rieke</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Stimulus- and goal-oriented frameworks for understanding natural vision</article-title><source>Nature Neuroscience</source><volume>22</volume><fpage>15</fpage><lpage>24</lpage><pub-id pub-id-type="doi">10.1038/s41593-018-0284-0</pub-id><pub-id pub-id-type="pmid">30531846</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilden</surname><given-names>U</given-names></name><name><surname>Hall</surname><given-names>SW</given-names></name><name><surname>Kühn</surname><given-names>H</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>Phosphodiesterase activation by photoexcited rhodopsin is quenched when rhodopsin is phosphorylated and binds the intrinsic 48-kDa protein of rod outer segments</article-title><source>PNAS</source><volume>83</volume><fpage>1174</fpage><lpage>1178</lpage><pub-id pub-id-type="doi">10.1073/pnas.83.5.1174</pub-id><pub-id pub-id-type="pmid">3006038</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>EG</given-names></name><name><surname>Brackbill</surname><given-names>N</given-names></name><name><surname>Rhoades</surname><given-names>C</given-names></name><name><surname>Kling</surname><given-names>A</given-names></name><name><surname>Gogliettino</surname><given-names>AR</given-names></name><name><surname>Shah</surname><given-names>NP</given-names></name><name><surname>Sher</surname><given-names>A</given-names></name><name><surname>Litke</surname><given-names>AM</given-names></name><name><surname>Simoncelli</surname><given-names>EP</given-names></name><name><surname>Chichilnisky</surname><given-names>EJ</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Fixational eye movements enhance the precision of visual information transmitted by the primate retina</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2023.08.12.552902</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>J</given-names></name><name><surname>Dodd</surname><given-names>RL</given-names></name><name><surname>Makino</surname><given-names>CL</given-names></name><name><surname>Simon</surname><given-names>MI</given-names></name><name><surname>Baylor</surname><given-names>DA</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Prolonged photoresponses in transgenic mouse rods lacking arrestin</article-title><source>Nature</source><volume>389</volume><fpage>505</fpage><lpage>509</lpage><pub-id pub-id-type="doi">10.1038/39068</pub-id><pub-id pub-id-type="pmid">9333241</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Younger</surname><given-names>JP</given-names></name><name><surname>McCarthy</surname><given-names>ST</given-names></name><name><surname>Owen</surname><given-names>WG</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Light-dependent control of calcium in intact rods of the bullfrog Rana catesbeiana</article-title><source>Journal of Neurophysiology</source><volume>75</volume><fpage>354</fpage><lpage>366</lpage><pub-id pub-id-type="doi">10.1152/jn.1996.75.1.354</pub-id><pub-id pub-id-type="pmid">8822563</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>Z</given-names></name><name><surname>Turner</surname><given-names>MH</given-names></name><name><surname>Baudin</surname><given-names>J</given-names></name><name><surname>Rieke</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Adaptation in cone photoreceptors contributes to an unexpected insensitivity of primate On parasol retinal ganglion cells to spatial structure in natural images</article-title><source>eLife</source><volume>11</volume><elocation-id>e70611</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.70611</pub-id><pub-id pub-id-type="pmid">35285798</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zador</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>The basic unit of computation</article-title><source>Nature Neuroscience</source><volume>3 Suppl</volume><elocation-id>1167</elocation-id><pub-id pub-id-type="doi">10.1038/81432</pub-id><pub-id pub-id-type="pmid">11127830</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zeitz</surname><given-names>C</given-names></name><name><surname>Robson</surname><given-names>AG</given-names></name><name><surname>Audo</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Congenital stationary night blindness: an analysis and update of genotype-phenotype correlations and pathogenic mechanisms</article-title><source>Progress in Retinal and Eye Research</source><volume>45</volume><fpage>58</fpage><lpage>110</lpage><pub-id pub-id-type="doi">10.1016/j.preteyeres.2014.09.001</pub-id><pub-id pub-id-type="pmid">25307992</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>X</given-names></name><name><surname>Palczewski</surname><given-names>K</given-names></name><name><surname>Ohguro</surname><given-names>H</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Mechanism of rhodopsin phosphorylation</article-title><source>Biophysical Chemistry</source><volume>56</volume><fpage>183</fpage><lpage>188</lpage><pub-id pub-id-type="doi">10.1016/0301-4622(95)00031-r</pub-id><pub-id pub-id-type="pmid">7662865</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.93795.3.sa0</article-id><title-group><article-title>eLife assessment</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Baccus</surname><given-names>Stephen A</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution>Stanford University</institution><country>United States</country></aff></contrib></contrib-group><kwd-group kwd-group-type="evidence-strength"><kwd>Compelling</kwd></kwd-group><kwd-group kwd-group-type="claim-importance"><kwd>Important</kwd></kwd-group></front-stub><body><p>This paper provides an <bold>important</bold> method that uses a computational model to predict photoreceptor currents in mammalian photoreceptors. By inverting the model, visual stimuli can be constructed to produce desired photoreceptor current responses. The authors provide <bold>compelling</bold> evidence that this approach can disentangle the effects of photoreceptor nonlinearities including light adaptation from downstream nonlinear processing, thus facilitating future studies of the higher visual system.</p></body></sub-article><sub-article article-type="referee-report" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.93795.3.sa1</article-id><title-group><article-title>Reviewer #1 (Public Review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>This manuscript aims at a quantitative model of how visual stimuli, given as time-dependent light intensity signals, are transduced into electrical currents in photoreceptors of macaque and mouse retina. Based on prior knowledge on the fundamental biophysical steps of the transduction cascade and a relatively small number of free parameters, the resulting model is found to fairly accurately capture measured photoreceptor currents under a range of diverse visual stimuli and with parameters that are (mostly) identical for photoreceptors of the same type.</p><p>Furthermore, as the model is invertible, the authors show that it can be used to derive visual stimuli that result in a desired, predetermined photoreceptor response. As demonstrated with several examples, this can be used to probe how the dynamics of phototransduction affect downstream signals in retinal ganglion cells, for example, by manipulating the visual stimuli in such a way that photoreceptor signals are linear or have reduced or altered adaptation. This innovative approach had already previously been used by the same lab to probe the contribution of photoreceptor adaptation to differences between On and Off parasol cells (Yu et al, eLife 2022), but the present paper extends this by describing and testing the photoreceptor model more generally and in both macaque and mouse as well as for both rods and cones.</p><p>Strengths:</p><p>The presentation of the model is thorough and convincing, and the ability to capture responses to stimuli as different as white noise with varying mean intensity and flashes with a common set of model parameters across cells is impressive. Also, the suggested approach of applying the model to modify visual stimuli that effectively alter photoreceptor signal processing is thought-provoking and should be a powerful tool for future investigations of retinal circuit function. The examples of how this approach can be applied are convincing and corroborate, for example, previous findings that adaptation to ambient light in the primate retina, as measured by responses to light flashes, mostly originates in photoreceptors. Application of the approach by other labs is facilitated by the clear exposition and the listing of obtained optimal parameter values.</p><p>Weaknesses:</p><p>The model is impressive, but not perfect, including some small systematic differences between model predictions and measurements from held-out cells. The deviations likely (partly) reflect differences between cells used for parameter optimization and test cells, as stated in the text (though this is not fully proven), which has to be kept in mind when applying the model, in particular with the listed parameters.</p></body></sub-article><sub-article article-type="referee-report" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.93795.3.sa2</article-id><title-group><article-title>Reviewer #2 (Public Review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>This manuscript proposes a modeling approach to capture nonlinear processes of photocurrents in mammalian (mouse, primate) rod and cone photoreceptors. The ultimate goal is to separate these nonlinearities at the level of photocurrent from subsequent nonlinear processing that occurs in retinal circuitry. The authors devised a strategy to generate stimuli that cancel the major nonlinearities in photocurrents. For example, modified stimuli would generate genuine sinusoidal modulation of the photocurrent, whereas a sinusoidal stimulus would not (i.e., because of asymmetries in the photocurrent to light vs. dark phases of a sinusoidal stimulus); and modified stimuli that could cancel the effects of light adaptation at the photocurrent level. Using these modified stimuli, one could record downstream neurons, knowing that any nonlinearities that emerge must happen beyond the stage of the photocurrent. This could be a useful method for separating nonlinear mechanisms across different stages of retinal processing and may be useful in vivo.</p><p>Strengths:</p><p>(1) This is a very quantitative and thoughtful approach and addresses a long-standing problem in the field: determining the location of nonlinearities within a complex circuit, including asymmetric responses to different polarities of contrast, adaptation, etc.</p><p>(2) The study presents data for two primary models of mammalian retina, mouse and primate, and shows that the basic strategy works in each case.</p><p>(3) Ideally, the present results would generalize to the work in other labs and possibly other sensory systems. The authors do provide evidence that a photocurrent model constructed from data in one set of cells can be used in a second set of cells.</p><p>Weaknesses:</p><p>(1) The model is limited to describing photoreceptor responses at the level of photocurrents, as opposed to the output of the cell, which takes into account voltage-dependent mechanisms, horizontal cell feedback, etc., as the authors acknowledge. It could be interesting to expand the model in the future to include factors that affect photoreceptor output beyond the stage of the photocurrent.</p><p>(2). It will be interesting to eventually test the impact of this work for in vivo experiments.</p></body></sub-article><sub-article article-type="referee-report" id="sa3"><front-stub><article-id pub-id-type="doi">10.7554/eLife.93795.3.sa3</article-id><title-group><article-title>Reviewer #3 (Public Review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>The authors propose to invert a mechanistic model of phototransduction in mouse and rod photoreceptors to derive stimuli that compensate for nonlinearities in these cells. They fit the model to a large set of photoreceptor recordings, and show in additional data that the compensation works. This can allow to exclude photoreceptors as a source of nonlinear computation in the retina, as desired to pinpoint nonlinearties in retinal computation. The recordings made by the authors are impressive and I appreciate the simplicity and elegance of the idea. The data support the authors conclusions.</p><p>Strengths:</p><p>- The authors collected an impressive set of recordings from mouse and primate photoreceptors, which is very challenging to obtain.</p><p>- The other proposes to exploit mechanistic mathematical models of a well understood phototransduction to design light stimuli which compensate for nonlinearities.</p><p>- The authors demonstrate through additional experiments that their proposed approach works and is useful for offering insights into retinal computation.</p><p>- The biophysical modeling approach is well described.</p></body></sub-article><sub-article article-type="author-comment" id="sa4"><front-stub><article-id pub-id-type="doi">10.7554/eLife.93795.3.sa4</article-id><title-group><article-title>Author response</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Chen</surname><given-names>Qiang</given-names></name><role specific-use="author">Author</role><aff><institution>The University of Chicago</institution><addr-line><named-content content-type="city">Chicago</named-content></addr-line><country>United States</country></aff></contrib><contrib contrib-type="author"><name><surname>Ingram</surname><given-names>Norianne T</given-names></name><role specific-use="author">Author</role><aff><institution>University of Washington</institution><addr-line><named-content content-type="city">Seattle</named-content></addr-line><country>United States</country></aff></contrib><contrib contrib-type="author"><name><surname>Baudin</surname><given-names>Jacob</given-names></name><role specific-use="author">Author</role><aff><institution>University of Washington</institution><addr-line><named-content content-type="city">Seattle</named-content></addr-line><country>United States</country></aff></contrib><contrib contrib-type="author"><name><surname>Angueyra</surname><given-names>Juan M</given-names></name><role specific-use="author">Author</role><aff><institution>National Institutes of Health</institution><addr-line><named-content content-type="city">Bethesda</named-content></addr-line><country>United States</country></aff></contrib><contrib contrib-type="author"><name><surname>Sinha</surname><given-names>Raunak</given-names></name><role specific-use="author">Author</role><aff><institution>University of Wisconsin</institution><addr-line><named-content content-type="city">Madison</named-content></addr-line><country>United States</country></aff></contrib><contrib contrib-type="author"><name><surname>Rieke</surname><given-names>Fred</given-names></name><role specific-use="author">Author</role><aff><institution>University of Washington</institution><addr-line><named-content content-type="city">Seattle</named-content></addr-line><country>United States</country></aff></contrib></contrib-group></front-stub><body><p>The following is the authors’ response to the original reviews.</p><disp-quote content-type="editor-comment"><p><bold>Public Reviews:</bold></p><p><bold>Reviewer #1 (Public Review):</bold></p><p>Summary:</p><p>This manuscript aims at a quantitative model of how visual stimuli, given as time-dependent light intensity signals, are transduced into electrical currents in photoreceptors of macaque and mouse retina. Based on prior knowledge of the fundamental biophysical steps of the transduction cascade and a relatively small number of free parameters, the resulting model is found to fairly accurately capture measured photoreceptor currents under a range of diverse visual stimuli and with parameters that are (mostly) identical for photoreceptors of the same type.</p><p>Furthermore, as the model is invertible, the authors show that it can be used to derive visual stimuli that result in a desired, predetermined photoreceptor response. As demonstrated with several examples, this can be used to probe how the dynamics of phototransduction affect downstream signals in retinal ganglion cells, for example, by manipulating the visual stimuli in such a way that photoreceptor signals are linear or have reduced or altered adaptation. This innovative approach had already previously been used by the same lab to probe the contribution of photoreceptor adaptation to differences between On and Off parasol cells (Yu et al, eLife 2022), but the present paper extends this by describing and testing the photoreceptor model more generally and in both macaque and mouse as well as for both rods and cones.</p><p>Strengths:</p><p>The presentation of the model is thorough and convincing, and the ability to capture responses to stimuli as different as white noise with varying mean intensity and flashes with a common set of model parameters across cells is impressive. Also, the suggested approach of applying the model to modify visual stimuli that effectively alter photoreceptor signal processing is thought-provoking and should be a powerful tool for future investigations of retinal circuit function. The examples of how this approach can be applied are convincing and corroborate, for example, previous findings that adaptation to ambient light in the primate retina, as measured by responses to light flashes, mostly originates in photoreceptors.</p><p>Weaknesses:</p><p>In the current form of the presentation, it doesn't become fully clear how easily the approach is applicable at different mean light levels and where exactly the limits for the model inversion are at high frequency. Also, accessibility and applicability by others could be strengthened by including more details about how parameters are fixed and what consensus values are selected.</p></disp-quote><p>Thank you - indeed a central goal of writing this paper was to provide a tool that could be easily used by other laboratories. We have clarified and expanded four points in this regard: (1) we have stated more clearly that mean light levels are naturally part of inversion process, and hence the approach can be applied across a broad range of light levels (lines 292-297); (2) we have expanded our analysis of the high frequency limits to the inversion and added that expanded figure to the main text (new Fig 5); (3) we have included additional detail about our calibration procedures, including our calibration code, to facilitate transfer to other labs; and, (4) we have detailed the procedure for identification of consensus parameters (line 172-182, 191-199 and Methods section starting on line 831).</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #2 (Public Review):</bold></p><p>Summary:</p><p>This manuscript proposes a modeling approach to capture nonlinear processes of photocurrents in mammalian (mouse, primate) rod and cone photoreceptors. The ultimate goal is to separate these nonlinearities at the level of photocurrent from subsequent nonlinear processing that occurs in retinal circuitry. The authors devised a strategy to generate stimuli that cancel the major nonlinearities in photocurrents. For example, modified stimuli would generate genuine sinusoidal modulation of the photocurrent, whereas a sinusoidal stimulus would not (i.e., because of asymmetries in the photocurrent to light vs. dark changes); and modified stimuli that could cancel the effects of light adaptation at the photocurrent level. Using these modified stimuli, one could record downstream neurons, knowing that any nonlinearities that emerge must happen post-photocurrent. This could be a useful method for separating nonlinear mechanisms across different stages of retinal processing, although there are some apparent limitations to the overall strategy.</p><p>Strengths:</p><p>(1) This is a very quantitative and thoughtful approach and addresses a long-standing problem in the field: determining the location of nonlinearities within a complex circuit, including asymmetric responses to different polarities of contrast, adaptation, etc.</p><p>(2) The study presents data for two primary models of mammalian retina, mouse, and primate, and shows that the basic strategy works in each case.</p><p>(3) Ideally, the present results would generalize to the work in other labs and possibly other sensory systems. How easy would this be? Would one lab have to be able to record both receptor and post-receptor neurons? Would in vitro recordings be useful for interpreting in vivo studies? It would be useful to comment on how well the current strategy could be generalized.</p></disp-quote><p>We agree that generalization to work in other laboratories is important, and indeed that was a motivation for writing this as a methods paper. The key issue in such generalization is calibration. We have expanded our discussion of our calibration procedures and included that code as part of the github repository associated with the paper. Figure 10 (previously Figure 9) was added to illustrate generalization. We believe that the approach we introduce here should generalize to in vivo conditions. We have expanded the text on these issues in the Discussion (sections starting on line 689 and 757).</p><disp-quote content-type="editor-comment"><p>Weaknesses:</p><p>(1) The model is limited to describing photoreceptor responses at the level of photocurrents, as opposed to the output of the cell, which takes into account voltage-dependent mechanisms, horizontal cell feedback, etc., as the authors acknowledge. How would one distinguish nonlinearities that emerge at the level of post-photocurrent processing within the photoreceptor as opposed to downstream mechanisms? It would seem as if one is back to the earlier approach, recording at multiple levels of the circuit (e.g., Dunn et al., 2006, 2007).</p></disp-quote><p>Indeed the current model is limited to a description of rod and cone photocurrents. Nonetheless, the transformation of light inputs to photocurrents can be strongly nonlinear, and such nonlinearities can be difficult to untangle from those occurring late in visual processing. Hence, we feel that the ability to capture and manipulate nonlinearities in the photocurrents is an important step. We have expanded Figure 10 to show an additional example of how manipulation of nonlinearities in phototransduction can give insight into downstream responses. We have also noted in text that an important next step would be to include inner segment mechanisms (section starting on line 661); doing so will require not only characterization of the current-to-voltage transformation, but also horizontal cell feedback and properties of the cone output synapse.</p><disp-quote content-type="editor-comment"><p>(2) It would have been nice to see additional confirmations of the approach beyond what is presented in Figure 9. This is limited by the sample (n = 1 horizontal cell) and the number of conditions (1). It would have been interesting to at least see the same test at a dimmer light level, where the major adaptation mechanisms are supposed to occur beyond the photoreceptors (Dunn et al., 2007).</p></disp-quote><p>We have added an additional experiment to this figure (now Figure 10) which we feel nicely exemplifies the approach. The approach that we introduce here really only makes sense at light levels where the photoreceptors are adapting; at lower light levels the photoreceptors respond near-linearly, so our “modified” and “original” stimuli as in Figure 10 (previously Figure 9) would be very similar (and post-phototransduction nonlinearities are naturally isolated at these light levels).</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #3 (Public Review):</bold></p><p>Summary:</p><p>The authors propose to invert a mechanistic model of phototransduction in mouse and rod photoreceptors to derive stimuli that compensate for nonlinearities in these cells. They fit the model to a large set of photoreceptor recordings and show in additional data that the compensation works. This can allow the exclusion of photoreceptors as a source of nonlinear computation in the retina, as desired to pinpoint nonlinearities in retinal computation. Overall, the recordings made by the authors are impressive and I appreciate the simplicity and elegance of the idea. The data support the authors' conclusions but the presentation can be improved.</p><p>Strengths:</p><p>- The authors collected an impressive set of recordings from mouse and primate photoreceptors, which is very challenging to obtain.</p><p>- The authors propose to exploit mechanistic mathematical models of well-understood phototransduction to design light stimuli that compensate for nonlinearities.</p><p>- The authors demonstrate through additional experiments that their proposed approach works.</p><p>Weaknesses:</p><p>- The authors use numerical optimization for fitting the parameters of the photoreceptor model to the data. Recently, the field of simulation-based inference has developed methods to do so, including quantification of the uncertainty of the resulting estimates. Since the authors state that two different procedures were used due to the different amounts of data collected from different cells, it may be worthwhile to rather test these methods, as implemented e.g. in the SBI toolbox (https://joss.theoj.org/papers/10.21105/joss.02505). This would also allow them to directly identify dependencies between parameters, and obtain associated uncertainty estimates. This would also make the discussion of how well constrained the parameters are by the data or how much they vary more principled because the SBI uncertainty estimates could be used.</p></disp-quote><p>Thank you - we have improved how we describe and report parameter values in several ways. First, the previous text erroneously stated that we used different fitting procedures for different cell types - but the real difference was in the amount of data and range of stimuli we had available between rods and cones. The fitting procedure itself was the same for all cell types. We have clarified this along with other details of the model fitting both in the main text (lines 121-130) and in the Methods (section starting on line 832). We also collected parameter values and estimates of allowed ranges in two tables. Finally, we used sloppy modeling to identify parameters that could covary with relatively small impact on model performance; we added a description of this analysis to the Methods (section starting on line 903).</p><disp-quote content-type="editor-comment"><p>- In several places, the authors refer the reader to look up specific values e.g. of parameters in the associated MATLAB code. I don't think this is appropriate, important values/findings/facts should be in the paper (lines 142, 114, 168). I would even find the precise values that the authors measure interesting, so I think the authors should show them in a figure/table. In general, I would like to see also the average variance explained by different models summarized in a table and precise mean/median values for all important quantities (like the response amplitude ratios in Figures 6/9).</p></disp-quote><p>We have added two tables with these parameters values and estimates of allowable ranges. We also added points to show the mean (and SD) across cells to the population figures and added those numerical values to the figure legends throughout.</p><disp-quote content-type="editor-comment"><p>- If the proposed model is supposed to model photoreceptor adaptation on a longer time scale, I fail to see why this can be an invertible model. Could the authors explain this better? I suspect that the model is mainly about nonlinearities as the authors also discuss in lines 360ff.</p></disp-quote><p>For the stimuli that we use we see little or no contribution of slow adaptation in phototransduction. We have expanded the description of this point in the text and referred to Angueyra et al (2022) which looks at this issue in more detail for primate cones (paragraph starting on line 280).</p><disp-quote content-type="editor-comment"><p>- The important Figures 6-8 are very hard to read, as it is not easy to see what the stimulus is, the modified stimulus, the response with and without modification, what the desired output looks like, and what is measured for part B. Reworking these figures would be highly recommended.</p></disp-quote><p>We have reworked all of the figures to make the traces clearer.</p><disp-quote content-type="editor-comment"><p>- If I understand Figure 6 correctly, part B is about quantifying the relative size of the response to the little first flash to the little second flash. While clearly, the response amplitude of the second flash is only 50% for the second flash compared to the first flash in primate rod and cones in the original condition, the modified stimulus seems to overcompensate and result in 130% response for the second flash. How do the authors explain this? A similar effect occurs in Figure 9, which the authors should also discuss.</p></disp-quote><p>Indeed, in those instances the modified stimulus does appear to overcompensate. We suspect this is due to differences in sensitivity of the specific cells probed for these experiments and those used in the model construction. We now describe this limitation in more detail (lines 524-526). A similar point comes up for those experiments in which we speed the photoreceptor responses (new FIgure 9B), and we similarly note that the cells used to test those manipulations differed systematically from those used to fit the model (lines 558-560).</p><disp-quote content-type="editor-comment"><p><bold>Recommendations for the authors:</bold></p><p><bold>Reviewer #1 (Recommendations For The Authors):</bold></p><p>I only have a few minor questions and suggestions for clarification.</p><p>It hasn't become fully clear to me how general the model is when different mean light levels (on long-time scales) are considered. Are there slow adaptation processes not captured in the model that affect model performance? And how should one go about setting the mean light level when, for example, probing ganglion cells with a stimulus obtained through model inversion? Should it work to add an appropriate DC component to the current that is provided as input to the inverted model? (Presumably, deriving a stimulus and then just adding background illumination should not work, or could this be a good approximation, given a steady state that is adapted to the background?)</p></disp-quote><p>We have clarified in the main text that slow adaptation does not contribute substantially to responses to the range of stimuli we explored (lines 281-289). We have also clarified that the stimulus in the model inversion is specified in isomerizations per second - so the mean value of the stimulus is automatically included in the model inversion (lines 293-298).</p><disp-quote content-type="editor-comment"><p>Furthermore, a caveat for the model inversion seems to be the potential amplification of high-frequency noise. The suggested application of a cutoff temporal frequency seems appropriate, but data are shown only for a few example cells. Is this consistent across cells? (Given that performance between, e.g., mouse cones can vary considerably according to Fig. 4B?) I would also like to suggest moving the corresponding Supplemental Figure (4.1) into the main part of the manuscript, as it seems quite important.</p></disp-quote><p>We have added population analysis to the new Figure 5 (which was Figure 4 - Figure Supplement 1). We have also clarified that the amplification of high frequency noise is an issue only when we try to apply model inversion to measured stimuli. When we use model inversion to identify stimuli that elicit desired responses, the target responses are computed from a linear model that has no noise, so this is not a concern in applications like those in Figures 6-10.</p><disp-quote content-type="editor-comment"><p>Also, could the authors explain more clearly what the effect of the normalization of the estimated stimulus by the power of the true stimulus is? Does this simply reduce power at high frequency or also affect frequencies below the suggested cutoff (where the stimulus reconstruction should presumably be accurate even without normalization)?</p></disp-quote><p>Indeed this normalization reduces high frequency power and has little impact on low frequencies where the inversion is accurate; this is now noted in the text (line 363). As for amplification of high frequency noise (previous comment), the normalization by the stimulus power is only needed when inverting measured responses (i.e. responses with noise) and is omitted when we are identifying stimuli that elicit desired responses (e.g. in Figures 6-10).</p><disp-quote content-type="editor-comment"><p>While the overall performance of the model to predict photoreceptor currents is impressive, it seems that particular misses occur for flashes right after a step in background illumination and for the white-noise responses at low background illumination (e.g. Figure 1B). Is that systematic, and if so what might be missing in the model?</p></disp-quote><p>Indeed the model (at least with fixed parameters across stimuli) appears to systematically miss a few aspects of the photoreceptor responses. These include the latency of the response to a bright flash and the early flashes in the step + flash protocol in Figure 1B. Model errors for the variable mean noise stimulus (Figure 2) showed little dependence on time even when responses were sorted by mean light level and by previous mean level. Model errors did not show a clear systematic dependence on light level; this likely reflects, at least in part, the use of mean-square-error to identify model parameters. We have expanded our discussion of these systematic errors in the text (lines 164-166).</p><disp-quote content-type="editor-comment"><p>I was also wondering whether this is related to the fact that in Figure 9B, the gain in the modified condition is actually systematically higher when there is more background light. Do the authors think that this could be a real effect or rather an overcompensation from the model? (By the way, is it specified what &quot;Delta-gain&quot; really is, i.e., ratio or normalized difference?)</p></disp-quote><p>We suspect this is an issue with the sensitivity of the specific cells for which we did these experiments (i.e. variability in the gamma parameter between cells). This sensitivity varies between cells, and such variations are likely to place the strongest limitation on our ability to use this approach to manipulate responses in different retinas. We now note those issues in the Results (lines 523-526, 557-559 and 591-593) with reference to Figures 9 (previously Figure 8) and 10 (previously Figure 9), and describe this limitation more generally in the Discussion (section starting on line 649). We have also changed delta-gain to response ratio, which seemed more intuitive.</p><disp-quote content-type="editor-comment"><p>Maybe I missed this, but it seems that the parameter gamma is fitted in a cell-type-specific fashion (e.g. line 163), but then needs to be fixed for held-out cells. How was this done? Is there much variability of gamma between cells?</p></disp-quote><p>There is variability in gamma between cells, and this likely explains some of systematic differences between data and model (see above and Methods, lines 902-903). For the consensus models in Figure 2B, gamma was allowed to vary for each cell while the remaining consensus model parameters were fixed. Gamma was set equal to the mean value across cells for model inversion (i.e. for all of the analyses in Figures 4-10). We have described the fitting procedure in considerably more detail in the revised Methods (starting on line 832).</p><disp-quote content-type="editor-comment"><p>For completeness, it would be nice to have the applied consensus model parameters in the manuscript rather than just in the Matlab code (especially since the code has not been part of the submission). Also, some notes on how the numerical integration of the differential equations was done would be nice (time step size?).</p></disp-quote><p>We have added tables with consensus parameters and estimates of the sensitivity of model predictions to each parameter. We have also added additional details about the numerical approaches (including the time step) to Methods.</p><disp-quote content-type="editor-comment"><p>Similarly, it would be nice to explicitly see the relationships that are used to fix certain model parameters (lines 705ff). And can the constants k and n (lines 709-710) be assumed identical for different species and receptor types?</p></disp-quote><p>We have added more details to the model fitting to the methods, including the use of steady-state conditions to hold certain parameters fixed (lines 862 and 866). We are not aware of any direct comparisons of k and n across species and receptor types. We have noted that model performance was not improved by modest changes in these parameters (due to compensation by other model parameters). More generally, we have explained how some parameters trade for others and hence the logic of fixing some even when exact values were not available.</p><disp-quote content-type="editor-comment"><p>For the previous measurements of m and beta (lines 712-713), is there a reference or source?</p></disp-quote><p>We have added references for these values.</p><disp-quote content-type="editor-comment"><p>Did the authors check for differences in the model parameters between cone types (e.g., S vs. M)?</p></disp-quote><p>We did not include S cones here. They are harder to record from and collecting a fairly large data set across a range of stimuli would be challenging. Our previous work shows that S cones have slower responses than L and M cones, and this would certainly be reflected in differences in model parameters. We have noted this in the text (Methods, line 808-810).</p><disp-quote content-type="editor-comment"><p>For the stated flash responses time-to-peak (lines 183-184), is this for a particular light intensity with no background illumination?</p></disp-quote><p>Those are flashes from darkness - now noted in the text.</p><disp-quote content-type="editor-comment"><p>Figure 2 - Supplement 1 doesn't have panel labels A and B, unlike the legend.</p></disp-quote><p>Fixed - thank you.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #2 (Recommendations For The Authors):</bold></p><p>(1) Fig. 2B - for some cells, the consensus model seems to fit better than the individual model. How is this possible?</p></disp-quote><p>This was mostly an error on our part (we inadvertently included responses to more stimuli in fitting the individual models, which slightly hampered their performance). Even with this correction, however, a few cells remain for which the consensus model outperforms and individual model. We believe this is because there is more data to constrain model parameters for the consensus models (since they are fit to all cells at the same time), and that can compensate for improvements associated with customizing parameters to specific cells.</p><disp-quote content-type="editor-comment"><p>(2) Fig. 2 Supplement 1, it would be useful to see a blow-up of the data in an inset, as in Fig. 2B.</p></disp-quote><p>Thanks - added.</p><disp-quote content-type="editor-comment"><p>(3) Line 400 - this paragraph could include additional quantification and statistics to back up claims re 'substantially reduced', 'considerably lower'.</p></disp-quote><p>We quantify that in the next sentence by computing the mean-square-error between responses and sinusoidal fits (also in Figure 7B, which now includes statistics as well). We have made that connection more direct in the text.</p><disp-quote content-type="editor-comment"><p>(4) Maybe a supplement to Fig. 8 could show the changes to the stimulus required to alter the kinetics in both directions - to give more insight into part B., especially.</p></disp-quote><p>Good suggestion - we have added the stimuli to all of the panels of the figure (now Figure 9).</p><disp-quote content-type="editor-comment"><p>(5) Fig. 8B - in 'Speed response up' condition - there seems to be error in the model for the decay time of the response - especially for the 'original' condition, which is not quantified in 8C. Was it generally difficult to predict responses to flashes?</p></disp-quote><p>That seems largely to reflect that the cells used for those experiments had faster initial kinetics than the average cells (responses to the control traces are also faster than model predictions in these cells - black traces in Figure 9B). We have added this to the text.</p><disp-quote content-type="editor-comment"><p>(6) Line 678, possibly notes that 405 nm equally activates S and M photopigments in mice, since most of the cones co-express the two photopigments (Rohlich et al., 1994; Applebury et al., 2000; Wang et al., 2011).</p></disp-quote><p>Thanks - we have added this (lines 827-829).</p><disp-quote content-type="editor-comment"><p>(7) The discussion could include a broader description of the various approaches to identifying nonlinearities within retinal circuitry, which include (incomplete list): recording at multiple levels of the circuit (e.g., Kim and Rieke 2001; Rieke, 2001; Baccus and Meister, 2002; Dunn et al., 2006; 2007; Beaudoin et al., 2007; Baccus et al., 2008); recording currents vs. spiking responses in a ganglion cell (e.g., Kim and Rieke, 2001; Zaghloul et al., 2005; Cui et al., 2016); neural network modeling approaches (e.g., Maheswaranathan et al., 2023); optogenetic approaches to studying filtering/nonlinear behavior at synapses (e.g., Pottackal et al., 2020; 2021).</p></disp-quote><p>Good suggestion - we have added this to the final paragraph of the Discussion.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #3 (Recommendations For The Authors):</bold></p><p>- I am personally not a fan of the style: &quot;... as Figure 4A shows...&quot; or comparable and much prefer a direct &quot;We observe that X is the case (Figure 4A)&quot;. If the authors agree, they may want to revise their paper in this way.</p></disp-quote><p>We have revised the text to avoid the “... as Figure xx shows” construction. We have retained multiple instances which follow a “Figure xx shows that …” construction (which is both active rather than passive and does not use a personal pronoun).</p><disp-quote content-type="editor-comment"><p>- I am not a fan of the title. Light-adaption clamp caters only to a very specialized audience.</p></disp-quote><p>We have changed the title to “Predictably manipulating photoreceptor light responses to reveal their role in downstream visual responses.”</p><disp-quote content-type="editor-comment"><p>- The parameter fitting procedure should not only be described in Matlab code, but in the paper.</p></disp-quote><p>Thanks - we have expanded this in the Methods considerably (section starting on line 832).</p><disp-quote content-type="editor-comment"><p>- The authors should elaborate on why different fitting procedures were used.</p></disp-quote><p>We did not describe that issue clearly. The fitting procedures used across cells were identical, but we had different data available for different cell types due to experimental limitations. We have substantially revised that part of the main text to clarify this issue (paragraph starting on line 121).</p><disp-quote content-type="editor-comment"><p>- The authors state in line 126 that the input stimulus is supposed to mimic eye movements mouse, monkey, or human? Please clarify.</p></disp-quote><p>Thanks - we have changed this sentence to “abrupt and frequent changes in intensity that characterize natural vision.”</p><disp-quote content-type="editor-comment"><p>- Please improve the figure style. For example, labels should be in consistent capitalization and ideally use complete words (e.g. Figure 2B, 4B, and others).</p></disp-quote><p>We have made numerous small changes in the figures to make them more consistent.</p><disp-quote content-type="editor-comment"><p>- Is the fraction of variance calculated on held-out-data? Linear models should be added to Figure 2B.</p></disp-quote><p>The fraction of variance explained was not calculated on held out data because of limitations in the duration of our recordings. Given the small number of free parameters, and the ability of the model to capture held out cells, we believe that the model generalizes well. We have added a supplemental figure with linear model performance (Figure 2 - Figure Supplement 2).</p><disp-quote content-type="editor-comment"><p>- Fig. 9A is lacking bipolar cell and amacrine cell labels. Currently, it looks like HC is next to the BC in the schematic.</p></disp-quote><p>Thanks - we have updated that figure (now Figure 10A)</p><disp-quote content-type="editor-comment"><p>- Maybe I am misunderstanding something, but it seems like the linear model prediction shown in Figure 2A for the rod could be easily improved by scaling it appropriately. Is this impression correct or why not?</p></disp-quote><p>We have clarified how the linear model is constructed (by fitting the linear model to low contrast responses of the full model at the mean stimulus intensity). We also added a supplemental figure, following the suggestion above, showing the linear model performance when a free scaling factor is included for each cell.</p><disp-quote content-type="editor-comment"><p>- The verification experiment in Fig. 5 is only anecdotal and is elaborated only in Figure 6. If I am not mistaken, this does not necessitate its own figure/section but could rather be merged.</p></disp-quote><p>We have kept this figure separate (now Figure 6) as we felt that it was important to highlight the approach in general in a figure before getting into quantification of how well it works.</p><disp-quote content-type="editor-comment"><p>- Figure 5 right is lacking labels. What is red and grey?</p></disp-quote><p>Thanks for catching that - labels are added now.</p><disp-quote content-type="editor-comment"><p>- The end of the Discussion is slightly unusual. Did some text go missing?</p></disp-quote><p>Thanks - we have rearranged the Discussion so as not to end on Limitations.</p><disp-quote content-type="editor-comment"><p>- There is a bonus figure at the end which seems also not to belong in the manuscript.</p></disp-quote><p>Thanks - the bonus figure is removed now.</p><disp-quote content-type="editor-comment"><p>- The methods should also describe briefly what kind of routines were used in the Matlab code, e.g. gradient descent with what optimizer?</p></disp-quote><p>We’ve added that information as well.</p></body></sub-article></article>