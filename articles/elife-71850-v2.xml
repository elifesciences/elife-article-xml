<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article article-type="research-article" dtd-version="1.2" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">71850</article-id><article-id pub-id-type="doi">10.7554/eLife.71850</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Hippocampal sharp wave-ripples and the associated sequence replay emerge from structured synaptic interactions in a network model of area CA3</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-245462"><name><surname>Ecker</surname><given-names>András</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9635-4169</contrib-id><email>andras.ecker@epfl.ch</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="pa1">†</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-245463"><name><surname>Bagi</surname><given-names>Bence</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="pa2">‡</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-245464"><name><surname>Vértes</surname><given-names>Eszter</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="pa3">§</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-245465"><name><surname>Steinbach-Németh</surname><given-names>Orsolya</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-226692"><name><surname>Karlócai</surname><given-names>Mária R</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-245466"><name><surname>Papp</surname><given-names>Orsolya I</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-245467"><name><surname>Miklós</surname><given-names>István</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-265058"><name><surname>Hájos</surname><given-names>Norbert</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-47099"><name><surname>Freund</surname><given-names>Tamás F</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund5"/><xref ref-type="other" rid="fund7"/><xref ref-type="other" rid="fund8"/><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-245468"><name><surname>Gulyás</surname><given-names>Attila I</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund5"/><xref ref-type="other" rid="fund6"/><xref ref-type="other" rid="fund7"/><xref ref-type="other" rid="fund8"/><xref ref-type="fn" rid="con10"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-245461"><name><surname>Káli</surname><given-names>Szabolcs</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2740-6057</contrib-id><email>kali@koki.hu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund5"/><xref ref-type="other" rid="fund6"/><xref ref-type="other" rid="fund9"/><xref ref-type="other" rid="fund7"/><xref ref-type="other" rid="fund8"/><xref ref-type="fn" rid="con11"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01jsgmp44</institution-id><institution>Institute of Experimental Medicine, Eötvös Loránd Research Network</institution></institution-wrap><addr-line><named-content content-type="city">Budapest</named-content></addr-line><country>Hungary</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05v9kya57</institution-id><institution>Faculty of Information Technology and Bionics, Pázmány Péter Catholic University</institution></institution-wrap><addr-line><named-content content-type="city">Budapest</named-content></addr-line><country>Hungary</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03vw74f64</institution-id><institution>Alfréd Rényi Institute of Mathematics, Eötvös Loránd Research Network</institution></institution-wrap><addr-line><named-content content-type="city">Budapest</named-content></addr-line><country>Hungary</country></aff><aff id="aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0249v7n71</institution-id><institution>Institute for Computer Science and Control, Eötvös Loránd Research Network</institution></institution-wrap><addr-line><named-content content-type="city">Budapest</named-content></addr-line><country>Hungary</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Burgess</surname><given-names>Neil</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02jx3x895</institution-id><institution>University College London</institution></institution-wrap><country>United Kingdom</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Colgin</surname><given-names>Laura L</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00hj54h04</institution-id><institution>University of Texas at Austin</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><author-notes><fn fn-type="present-address" id="pa1"><label>†</label><p>Blue Brain Project, École polytechnique fédérale de Lausanne (EPFL), Campus Biotech, Geneva, Switzerland</p></fn><fn fn-type="present-address" id="pa2"><label>‡</label><p>Department of Bioengineering, Imperial College London, London, United Kingdom</p></fn><fn fn-type="present-address" id="pa3"><label>§</label><p>Gatsby Computational Neuroscience Unit, University College London, London, United Kingdom</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>18</day><month>01</month><year>2022</year></pub-date><pub-date pub-type="collection"><year>2022</year></pub-date><volume>11</volume><elocation-id>e71850</elocation-id><history><date date-type="received" iso-8601-date="2021-07-02"><day>02</day><month>07</month><year>2021</year></date><date date-type="accepted" iso-8601-date="2022-01-17"><day>17</day><month>01</month><year>2022</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at .</event-desc><date date-type="preprint" iso-8601-date="2021-02-18"><day>18</day><month>02</month><year>2021</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2021.02.18.431868"/></event></pub-history><permissions><copyright-statement>© 2022, Ecker et al</copyright-statement><copyright-year>2022</copyright-year><copyright-holder>Ecker et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-71850-v2.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-71850-figures-v2.pdf"/><abstract><p>Hippocampal place cells are activated sequentially as an animal explores its environment. These activity sequences are internally recreated (‘replayed’), either in the same or reversed order, during bursts of activity (sharp wave-ripples [SWRs]) that occur in sleep and awake rest. SWR-associated replay is thought to be critical for the creation and maintenance of long-term memory. In order to identify the cellular and network mechanisms of SWRs and replay, we constructed and simulated a data-driven model of area CA3 of the hippocampus. Our results show that the chain-like structure of recurrent excitatory interactions established during learning not only determines the content of replay, but is essential for the generation of the SWRs as well. We find that bidirectional replay requires the interplay of the experimentally confirmed, temporally symmetric plasticity rule, and cellular adaptation. Our model provides a unifying framework for diverse phenomena involving hippocampal plasticity, representations, and dynamics, and suggests that the structured neural codes induced by learning may have greater influence over cortical network states than previously appreciated.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>hippocampus</kwd><kwd>place cell</kwd><kwd>sequence replay</kwd><kwd>spike-timing-dependent plasticity</kwd><kwd>computational modeling</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Mouse</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003549</institution-id><institution>Hungarian Scientific Research Fund</institution></institution-wrap></funding-source><award-id>K83251</award-id><principal-award-recipient><name><surname>Gulyás</surname><given-names>Attila I</given-names></name><name><surname>Káli</surname><given-names>Szabolcs</given-names></name><name><surname>Karlócai</surname><given-names>Mária</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003549</institution-id><institution>Hungarian Scientific Research Fund</institution></institution-wrap></funding-source><award-id>K85659</award-id><principal-award-recipient><name><surname>Papp</surname><given-names>Orsolya I</given-names></name><name><surname>Hájos</surname><given-names>Norbert</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003549</institution-id><institution>Hungarian Scientific Research Fund</institution></institution-wrap></funding-source><award-id>K115441</award-id><principal-award-recipient><name><surname>Gulyás</surname><given-names>Attila I</given-names></name><name><surname>Káli</surname><given-names>Szabolcs</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100010749</institution-id><institution>Hungarian Medical Research Council</institution></institution-wrap></funding-source><award-id>2017-1.2.1-NKP-2017-00002</award-id><principal-award-recipient><name><surname>Hájos</surname><given-names>Norbert</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000780</institution-id><institution>European Commission</institution></institution-wrap></funding-source><award-id>ERC 2011 ADG 294313</award-id><principal-award-recipient><name><surname>Freund</surname><given-names>Tamás</given-names></name><name><surname>Gulyás</surname><given-names>Attila I</given-names></name><name><surname>Káli</surname><given-names>Szabolcs</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000780</institution-id><institution>European Commission</institution></institution-wrap></funding-source><award-id>604102</award-id><principal-award-recipient><name><surname>Freund</surname><given-names>Tamás</given-names></name><name><surname>Gulyás</surname><given-names>Attila I</given-names></name><name><surname>Káli</surname><given-names>Szabolcs</given-names></name></principal-award-recipient></award-group><award-group id="fund7"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000780</institution-id><institution>European Commission</institution></institution-wrap></funding-source><award-id>720270</award-id><principal-award-recipient><name><surname>Freund</surname><given-names>Tamás F</given-names></name><name><surname>Gulyás</surname><given-names>Attila I</given-names></name><name><surname>Káli</surname><given-names>Szabolcs</given-names></name></principal-award-recipient></award-group><award-group id="fund8"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000780</institution-id><institution>European Commission</institution></institution-wrap></funding-source><award-id>785907</award-id><principal-award-recipient><name><surname>Freund</surname><given-names>Tamás F</given-names></name><name><surname>Gulyás</surname><given-names>Attila I</given-names></name><name><surname>Káli</surname><given-names>Szabolcs</given-names></name></principal-award-recipient></award-group><award-group id="fund9"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100018818</institution-id><institution>National Research, Development and Innovation Office</institution></institution-wrap></funding-source><award-id>Artificial Intelligence National Laboratory</award-id><principal-award-recipient><name><surname>Káli</surname><given-names>Szabolcs</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Simulations of a detailed network model show that the pattern of synaptic interactions resulting from learning is critical for the emergence of population bursts, sequential neuronal activity, and fast oscillations in the hippocampus.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>The hippocampal region plays a pivotal role in spatial and episodic memory (<xref ref-type="bibr" rid="bib86">O’Keefe and Nadel, 1978</xref>; <xref ref-type="bibr" rid="bib77">Morris et al., 1982</xref>). The different stages of memory processing (<xref ref-type="bibr" rid="bib70">Marr, 1971</xref>; <xref ref-type="bibr" rid="bib10">Buzsáki, 1989</xref>) are associated with distinct brain states and are characterized by distinct oscillatory patterns of the hippocampal local field potential (LFP) (<xref ref-type="bibr" rid="bib8">Buzsáki et al., 1983</xref>; <xref ref-type="bibr" rid="bib15">Colgin, 2016</xref>). When rodents explore their environment, place cells of the hippocampus are activated in a sequence that corresponds to the order in which the animal visits their preferred spatial locations (place fields) (<xref ref-type="bibr" rid="bib85">O’Keefe and Dostrovsky, 1971</xref>). The same sequences of firing activity can also be identified, on a faster time scale, during individual cycles of the 4–10 Hz theta oscillation that dominates the hippocampal LFP in this state (<xref ref-type="bibr" rid="bib87">O’Keefe and Recce, 1993</xref>; <xref ref-type="bibr" rid="bib23">Dragoi and Buzsáki, 2006</xref>; <xref ref-type="bibr" rid="bib33">Foster and Wilson, 2007</xref>). These compressed sequences are thought to be optimal for learning via activity-dependent synaptic plasticity (<xref ref-type="bibr" rid="bib54">Jensen and Lisman, 2005</xref>; <xref ref-type="bibr" rid="bib33">Foster and Wilson, 2007</xref>).</p><p>Other behavioral states such as slow-wave sleep and quiet wakefulness are characterized by the repetitive but irregular occurrence of bursts of activity in the hippocampus, marked by the appearance of sharp waves (<xref ref-type="bibr" rid="bib8">Buzsáki et al., 1983</xref>; <xref ref-type="bibr" rid="bib108">Wilson and McNaughton, 1994</xref>) and associated high-frequency (150–220 Hz) ripple oscillations (<xref ref-type="bibr" rid="bib86">O’Keefe and Nadel, 1978</xref>; <xref ref-type="bibr" rid="bib11">Buzsáki et al., 1992</xref>) in the LFP. Disruption of SWRs was shown to impair long-term memory (<xref ref-type="bibr" rid="bib42">Girardeau et al., 2009</xref>; <xref ref-type="bibr" rid="bib25">Ego-Stengel and Wilson, 2010</xref>; <xref ref-type="bibr" rid="bib52">Jadhav et al., 2012</xref>; <xref ref-type="bibr" rid="bib83">Oliva et al., 2020</xref>). The activity sequences observed during exploration are also recapitulated during SWRs (<xref ref-type="bibr" rid="bib78">Nádasdy et al., 1999</xref>; <xref ref-type="bibr" rid="bib61">Kudrimoti et al., 1999</xref>; <xref ref-type="bibr" rid="bib62">Lee and Wilson, 2002</xref>), in the absence of any apparent external driver, and this ‘replay’ can happen either in the same or in a reversed order relative to the original behaviorally driven sequence (<xref ref-type="bibr" rid="bib32">Foster and Wilson, 2006</xref>; <xref ref-type="bibr" rid="bib17">Csicsvari et al., 2007</xref>; <xref ref-type="bibr" rid="bib21">Diba and Buzsáki, 2007</xref>; <xref ref-type="bibr" rid="bib18">Davidson et al., 2009</xref>; <xref ref-type="bibr" rid="bib57">Karlsson and Frank, 2009</xref>; <xref ref-type="bibr" rid="bib44">Gupta et al., 2010</xref>). More specifically, awake replay is predominantly in the ‘forward’ direction near choice points during navigation (<xref ref-type="bibr" rid="bib21">Diba and Buzsáki, 2007</xref>; <xref ref-type="bibr" rid="bib89">Pfeiffer and Foster, 2013</xref>), while it is mainly ‘backward’ when the animal encounters a reward (<xref ref-type="bibr" rid="bib21">Diba and Buzsáki, 2007</xref>). Consequently, while sleep replay was suggested to be involved in memory consolidation, forward and reverse replay in awake animals may contribute to memory recall and reward-based learning, respectively (<xref ref-type="bibr" rid="bib13">Carr et al., 2011</xref>; <xref ref-type="bibr" rid="bib34">Foster, 2017</xref>; <xref ref-type="bibr" rid="bib91">Pfeiffer, 2017</xref>; <xref ref-type="bibr" rid="bib81">Olafsdottir et al., 2018</xref>). Finally, behavioral tasks with a high memory demand led to an increase in the duration of SWRs, while artificial prolongation of SWRs improved memory (<xref ref-type="bibr" rid="bib30">Fernández-Ruiz et al., 2019</xref>).</p><p>For several decades, area CA3 of the hippocampus has been proposed to be a critical site for hippocampal memory operations, mainly due to the presence of an extensive set of modifiable excitatory recurrent connections that could support the storage and retrieval of activity patterns and thus implement long-term memory (<xref ref-type="bibr" rid="bib70">Marr, 1971</xref>; <xref ref-type="bibr" rid="bib72">McNaughton and Morris, 1987</xref>; <xref ref-type="bibr" rid="bib65">Levy, 1996</xref>; <xref ref-type="bibr" rid="bib94">Rolls, 1996</xref>; <xref ref-type="bibr" rid="bib56">Káli and Dayan, 2000</xref>). Area CA3 was also shown to be strongly involved in the generation of SWRs and the associated forward and reverse replay (<xref ref-type="bibr" rid="bib12">Buzsáki, 2015</xref>; <xref ref-type="bibr" rid="bib19">Davoudi and Foster, 2019</xref>).</p><p>Several modeling studies have addressed either theta oscillogenesis, learning, sequence replay or ripples; however, a unifying model of how the generation of SWRs and the associated neuronal activity are shaped by previous experience is currently lacking. In the present study, we built a minimal, yet data-driven model of the CA3 network, which, after learning via a symmetric spike-timing-dependent synaptic plasticity rule (<xref ref-type="bibr" rid="bib75">Mishra et al., 2016</xref>) during simulated exploration, featured both forward and backward replay during autonomously generated sharp waves, as well as ripple oscillations generated in the recurrently connected network of perisomatic interneurons. After validating the model against several in vivo and in vitro results (<xref ref-type="bibr" rid="bib11">Buzsáki et al., 1992</xref>; <xref ref-type="bibr" rid="bib47">Hájos et al., 2013</xref>; <xref ref-type="bibr" rid="bib28">English et al., 2014</xref>; <xref ref-type="bibr" rid="bib97">Schlingloff et al., 2014</xref>; <xref ref-type="bibr" rid="bib99">Stark et al., 2014</xref>; <xref ref-type="bibr" rid="bib90">Pfeiffer and Foster, 2015</xref>; <xref ref-type="bibr" rid="bib37">Gan et al., 2017</xref>), we took advantage of its in silico nature that made feasible a variety of selective manipulations of cellular and network characteristics. Analyzing the changes in the model’s behavior after these perturbations allowed us to establish the link between learning from theta sequences and the emergence of SWRs during ‘offline’ states, to provide a possible explanation for forward and backward replays, and to disentangle the mechanisms responsible for sharp waves and ripple oscillations.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>To identify the core mechanisms that are responsible for the relationship between learning during exploration and SWRs during rest, we built a scaled-down network model of area CA3 of the rodent hippocampus. In this model, we specifically did not aim to capture all the biological details of hippocampal neurons and circuits; instead, our goal was to reveal and analyze those mechanisms that are essential for the generation of sharp waves, ripple oscillations, and bidirectional activity replay. The main assumptions underlying the construction of our model are listed in Table 1. The complete network consisted of 8000 excitatory pyramidal cells (PCs) and 150 inhibitory parvalbumin-containing basket cells (PVBCs), corresponding roughly to the size of the CA3 area in a 600-µm-thick slice of the mouse hippocampus, which is known to be capable of generating SWRs (<xref ref-type="bibr" rid="bib47">Hájos et al., 2013</xref>; <xref ref-type="bibr" rid="bib97">Schlingloff et al., 2014</xref>). These two cell types are known to be indispensable to the generation of SWRs (<xref ref-type="bibr" rid="bib92">Rácz et al., 2009</xref>; <xref ref-type="bibr" rid="bib27">Ellender et al., 2010</xref>; <xref ref-type="bibr" rid="bib28">English et al., 2014</xref>; <xref ref-type="bibr" rid="bib97">Schlingloff et al., 2014</xref>; <xref ref-type="bibr" rid="bib99">Stark et al., 2014</xref>; <xref ref-type="bibr" rid="bib43">Gulyás and Freund, 2015</xref>; <xref ref-type="bibr" rid="bib12">Buzsáki, 2015</xref>; <xref ref-type="bibr" rid="bib37">Gan et al., 2017</xref>). All neurons in the network were modeled as single-compartment, adaptive exponential integrate-and-fire (AdExpIF) models whose parameters were fit to reproduce in vitro voltage traces of the given cell types in response to a series of step current injections (‘Materials and methods’ and <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>). Connections of all types (PC-PC, PC-PVBC, PVBC-PC, PVBC-PVBC) were established randomly using connection type-specific probabilities estimated from anatomical studies. All model parameters are detailed in the ‘Materials and methods’ section and summarized in Tables 2 and 3.</p><p>Simulations of the network were run in two phases corresponding to spatial exploration and ‘offline’ hippocampal states (slow-wave sleep and awake immobility), respectively. During the exploration phase, the spiking activity of PCs was explicitly set to mimic the firing patterns of a population of place cells during simulated runs on a linear track, and the recurrent connections between PCs evolved according to an experimentally constrained, spike-timing-dependent plasticity (STDP) rule (see below). In the subsequent offline phase, we recorded the spontaneous dynamics of the network in the absence of structured external input (or plasticity), analyzed the global dynamics (including average firing rates and oscillations), and looked for the potential appearance of sequential activity patterns corresponding to the previous activation of place cells during exploration, often referred to as ‘replay.’ The main features of the model are summarized in <xref ref-type="fig" rid="fig1">Figure 1</xref>.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Overview of learning and the spontaneous generation of sharp wave-ripples (SWRs) and sequence replay in the model.</title><p>(<bold>A</bold>) Tuning curves (Equation (1)) of exemplar place cells covering the whole 3-m-long linear track. (<bold>B</bold>) Broad, symmetric spike-timing-dependent plasticity (STDP) kernel used in the learning phase. The time constant was fit directly to experimental data from <xref ref-type="bibr" rid="bib75">Mishra et al., 2016</xref>. (<bold>C</bold>) Learned excitatory recurrent weight matrix. Place cells are ordered according to the location of their place fields; neurons with no place field in the environment are scattered randomly among the place cells. Actual dimensions are 8000 * 8000, but, for better visualization, each pixel shown represents the average of an 80 * 80 square. (<bold>D</bold>) Pyramidal cell (PC) raster plot is shown in the top panel, color-coded, and ordered as the place fields in (<bold>A</bold>). PC population rate (middle), and local field potential (LFP) estimate (bottom panel), corresponding to the same time period. (<bold>E</bold>) Posterior matrix of the decoded positions from spikes within the high activity period shown in (<bold>D</bold>). Gray lines indicate the edges of the decoded, constant velocity path.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71850-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>The generation of the spike trains of pyramidal cells (PCs) in the exploration phase.</title><p>(<bold>A</bold>) Firing rates of exemplar place cells covering the whole 3-m-long linear track. In contrast to the spatial tuning curves shown in <xref ref-type="fig" rid="fig1">Figure 1A</xref> (Equation (1)), these are time-dependent rates modulated by theta oscillation and phase precession (Equation (2)). (<bold>B</bold>) Exemplar spike trains generated based on the firing rates shown in (<bold>A</bold>). (Spike trains used in the learning phase were 400 s long. For the purpose of visualization, only the beginning is shown here.) (<bold>C</bold>) Interspike interval (ISI) distribution of the generated spike trains. ISIs of place cells (<bold>C1</bold>) (inset is a zoom into the same distribution at a finer timescale to show theta modulation) and nonplace cells (<bold>C2</bold>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71850-fig1-figsupp1-v2.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 2.</label><caption><title>Single-cell models.</title><p>(<bold>A</bold>) Fitted AdExpIF pyramidal cell (PC) model (blue) and experimental traces (green) are shown in the top panel. The amplitudes of the 800-ms-long step current injections shown at the bottom were as follows: –0.04, 0.15, and 0.6 nA. (<bold>B</bold>) Fitted ExpIF parvalbumin-containing basket cell (PVBC) model (pink) and experimental traces (green) are shown in the top panel. The amplitudes of the 800-ms-long step current injections shown at the bottom were as follows: –0.03, 0.09, and 0.25 nA. Insets show the f–I curve of the in vitro (green) and in silico (red) cells. For parameters of the cell models, see <xref ref-type="table" rid="table2">Table 2</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71850-fig1-figsupp2-v2.tif"/></fig></fig-group><sec id="s2-1"><title>Recurrent weights are learned during exploration via a symmetric STDP rule</title><p>During exploration, half of the PCs had randomly assigned, overlapping place fields in the simulated environment, characterized by Gaussian spatial tuning curves, whereas the others fired at low rates in a spatially nonspecific manner (‘Materials and methods’ and <xref ref-type="fig" rid="fig1">Figure 1A</xref>). During simulated unidirectional runs along a 3-m-long linear track, these tuning curves, modulated by theta oscillation and phase precession, gave rise to generated spike trains similar to those observed for real place cells under similar conditions (‘Materials and methods’ and <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). The simulated spike trains served as inputs for STDP, which was characterized by the broad, symmetric kernel observed in pairs of CA3 PCs recorded in hippocampal slices (<xref ref-type="fig" rid="fig1">Figure 1B</xref>; <xref ref-type="bibr" rid="bib75">Mishra et al., 2016</xref>). The anatomical connectivity of PCs was sparse and random, assuming 10% PC-PC connection probability (<xref ref-type="bibr" rid="bib67">Lisman, 1999</xref>; <xref ref-type="bibr" rid="bib1">Andersen et al., 2007</xref>), and only these preexisting connections were allowed to evolve (‘Materials and methods’).</p><p>The most prominent feature of the learned recurrent excitatory synaptic weight matrix was its highly organized structure (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). Relatively few strong (&gt;1 nS) synapses near the diagonal (representing pairs of cells with overlapping place fields) emerged from a background of much weaker connections. Similar symmetric weight structures have been used in continuous ‘bump’ attractor models of various neural systems such as head direction cells, place cells, and parametric working memory (<xref ref-type="bibr" rid="bib111">Zhang, 1996</xref>; <xref ref-type="bibr" rid="bib96">Samsonovich and McNaughton, 1997</xref>; <xref ref-type="bibr" rid="bib56">Káli and Dayan, 2000</xref>; <xref ref-type="bibr" rid="bib16">Compte et al., 2000</xref>). In these studies, the weights were typically either imposed or learned using rate-based (not STDP) learning rules, and led to stationary patterns of activity in the absence of external input. By contrast, most previous spiking neuron models of sequence learning used temporally asymmetric STDP rules, resulting in a weight structure dominated by feedforward chains (each neuron giving the strongest input to other neurons that follow it in the spatial sequence), and sequential activity patterns that follow these chains of strong connections (<xref ref-type="bibr" rid="bib53">Jahnke et al., 2015</xref>). In order to reveal the combined effect of learned, essentially symmetric connections and realistic cell-type-specific neuronal spike responses, we next explored the spontaneously generated activity patterns in our full network model.</p></sec><sec id="s2-2"><title>The dynamics of the network model reproduce key features of SWRs and replay</title><p>The sparse recurrent excitatory weight matrix resulting from the phenomenological exploration (<xref ref-type="fig" rid="fig1">Figure 1C</xref>) was used directly in network simulations mimicking resting periods, in which (with the exception of the simulations shown later in <xref ref-type="fig" rid="fig2">Figure 2C</xref>) PCs received only spatially and temporally unstructured random synaptic input (‘Materials and methods’). The maximal conductances of the other types of connections in the network (the weights of PC-PVBC, PVBC-PC, and PVBC-PVBC connections as well as the weight of the external random input) were optimized using an evolutionary algorithm with network-level objectives, which included physiological PC population firing rates, suppressed gamma (30–100 Hz) oscillation in the PC population, and strong ripple oscillation in the PVBC population (see ‘Materials and methods’ for details).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Forward and backward replay events, accompanied by ripple oscillations, can occur spontaneously but can also be cued.</title><p>(<bold>A</bold>) Pyramidal cell (PC) raster plot of a 10-s-long simulation, with sequence replays initiating at random time points and positions and propagating either in forward or backward direction on the top panel. PC population firing rate is plotted below. Dashed vertical black lines indicate the periods marked as sustained high-activity states (above 2 Hz for at least 260 ms), which are submitted to automated spectral and replay analysis. (<bold>B</bold>) Estimated local field potential (LFP) in the top panel and its time-frequency representation (wavelet analysis) below. (<bold>C</bold>) Forward and backward sequence replays resulting from targeted stimulation (using 200-ms-long 20 Hz Poisson spike trains) of selected 100-neuron subgroups, indicated by the black rectangles in the raster plots. (<bold>C1</bold>) Example of cued forward replay. PC raster plot is shown at the top with PC population rate, LFP estimate, and its time-frequency representation (wavelet analysis) below. (<bold>C2</bold>) Same as (<bold>C1</bold>), but different neurons are stimulated at the beginning, leading to backward replay.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71850-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>The step-size distribution of the decoded paths is much wider than expected.</title><p>(<bold>A</bold>) Posterior matrix of the decoded positions from spikes within a selected high-activity state (first one from <xref ref-type="fig" rid="fig2">Figure 2A</xref>). Thick gray lines indicate the edges of the decoded, constant velocity path. Thin gray line shows the decoded path by connecting the weighted average positions in every 10-ms-long time step. (<bold>B</bold>) Step sizes from the decoded, variable velocity path (see <bold>A</bold>) for the same period (first high-activity state in <xref ref-type="fig" rid="fig2">Figure 2A</xref>). The horizontal dashed black line shows the average or predicted step size within the given period. (<bold>C1</bold>) Skewed distribution of observed step sizes (in gray) and the predicted (from evenly spacing) step-size distribution (in red) for more than a hundred replay events (similar to the one in <bold>A</bold> and <bold>B</bold>). Inset shows the same distributions at smaller scales. (<bold>C2</bold>) Cumulative distribution of the observed and predicted step sizes shown in (<bold>C1</bold>). Observed vs. predicted distributions differ significantly (two-sample Kolmogorov–Smirnov test).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71850-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Single-cell characteristics during network simulations.</title><p>(<bold>A</bold>) Distributions of single pyramidal cell (PC) (<bold>A1</bold>) and parvalbumin-containing basket cell (PVBC) (<bold>A2</bold>) firing rates during the 10-s-long simulation shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>. (<bold>B</bold>) Distributions of interspike intervals (ISIs) of PCs (<bold>B1</bold>) and PVBCs (<bold>B2</bold>) in the 10-s-long simulation shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>. (<bold>C</bold>) Voltage traces of selected place cells from the beginning, middle, and end of the track, a nonplace cell and a PVBC on top, and their input currents (EPSC (excitatory postsynaptic current) in blue, IPSC (inhibitory postsynaptic current) in pink, y-axis on the right) and intrinsic adaptation current <italic>w</italic> (red, y-axis on the left) at the bottom of each panel, during a full forward replay. Dashed vertical lines indicate the period marked as high-activity state. (<bold>D</bold>) Synaptic input currents of PCs (<bold>D1</bold>) and PVBCs (<bold>D2</bold>) during sequence replay initiation. Gray lines are the averages of the EPSCs and IPSCs of 400 PCs and 30 PVBCs, respectively (similar to the ones shown in <bold>C</bold>). Individual gray lines correspond to individual high-activity states (n = 7, see <xref ref-type="fig" rid="fig2">Figure 2A</xref>). Dashed vertical lines (at 0 ms) indicate the beginning of the periods marked as high-activity states (see <xref ref-type="fig" rid="fig2">Figure 2A</xref>). Colored lines represent the grand average EPSC (blue) and IPSC (pink) arriving at PCs (<bold>D1</bold>) and PVBCs (<bold>D2</bold>) during sharp wave-ripple (SWR) initiation.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71850-fig2-figsupp2-v2.tif"/></fig></fig-group><p>Spontaneously generated activity in the network consisted of alternating periods of low activity (mean PC rates below 1 Hz) and high activity (mean PC rates around 3.5 Hz), which resembled the recurring appearance of sharp wave events during slow-wave sleep and quiet wakefulness (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). Similar to experimental sharp waves, high-activity events in the model were accompanied by transient oscillations in the ripple frequency range (<xref ref-type="fig" rid="fig2">Figure 2B</xref>; <xref ref-type="bibr" rid="bib9">Buzsáki, 1986</xref>; <xref ref-type="bibr" rid="bib11">Buzsáki et al., 1992</xref>; <xref ref-type="bibr" rid="bib32">Foster and Wilson, 2006</xref>; <xref ref-type="bibr" rid="bib12">Buzsáki, 2015</xref>). We calculated an estimate of the LFP by summing the synaptic inputs of a small, randomly selected subset of PCs (<xref ref-type="bibr" rid="bib71">Mazzoni et al., 2008</xref>), and found that ripple oscillations were reliably present in this signal during the high-activity periods (<xref ref-type="fig" rid="fig1">Figures 1D</xref> and <xref ref-type="fig" rid="fig2">2B</xref>).</p><p>When we plotted the spike times of all PCs with place cells ordered according to the location of their place fields on the track during the learning phase, it became clear that place cell sequences were replayed during simulated SWRs, while activity had no obvious structure in the low-activity periods between SWRs (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). Interestingly, replay of place cell sequences could occur in either the forward or the backward direction relative to the order of activation in the learning phase (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). Importantly, apart from some initial transients, simultaneous forward and backward replay was never observed. This is because simultaneous replay in both directions induces competition (mediated by global feedback inhibition) between the two active populations, and one of the sequences always dies out after a short period (this is also because mutual support through recurrent excitation diminishes as the two active populations move further away from each other). This is similar to the competitive behavior observed in ‘bump attractor’ models (<xref ref-type="bibr" rid="bib20">Dayan and Abbott, 2001</xref>). These qualitative observations of sequence replay were confirmed by analyzing high-activity (SWR) periods with a Bayesian place decoding and path fitting method using spatial tuning curves introduced for spike train generation in the exploration part (‘Materials and methods’ and <xref ref-type="fig" rid="fig1">Figure 1E</xref>; <xref ref-type="bibr" rid="bib18">Davidson et al., 2009</xref>; <xref ref-type="bibr" rid="bib57">Karlsson and Frank, 2009</xref>; <xref ref-type="bibr" rid="bib81">Olafsdottir et al., 2018</xref>). Interestingly, our network model also reproduced the broad, long-tailed step-size distribution in the sequence of decoded locations during SWRs, as observed experimentally by <xref ref-type="bibr" rid="bib90">Pfeiffer and Foster, 2015</xref>; <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>.</p><p>It was also possible to ‘cue’ replay by giving an additional external stimulation to a small subpopulation (<inline-formula><mml:math id="inf1"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula>) of PCs that had overlapping place fields in the learned environment. In this case, sequence replay started at the location corresponding to the cells that received extra stimulation (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). This feature may explain why awake replay tends to be forward when the animal is planning a trajectory from its current location and backward at the goal location.</p><p>At the level of single cells, we found that both PCs and PVBCs received approximately balanced excitation and inhibition during SWR events, and inhibitory currents were modulated at the ripple frequency in these periods (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2C and D</xref>). Excitatory inputs dominated between SWRs and during the initiation of SWR events. Only a small minority of PCs fired in individual ripple cycles, while the participation of PVBCs was much higher (but not complete), resulting in a mean PVBC firing rate of ∼65 Hz during the SWRs, which is much higher than their baseline rate, but significantly below the ripple frequency (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2A and B</xref>). All of these findings were consistent with experimental results in vitro (<xref ref-type="bibr" rid="bib47">Hájos et al., 2013</xref>; <xref ref-type="bibr" rid="bib97">Schlingloff et al., 2014</xref>) and in vivo (<xref ref-type="bibr" rid="bib106">Varga et al., 2012</xref>; <xref ref-type="bibr" rid="bib28">English et al., 2014</xref>; <xref ref-type="bibr" rid="bib50">Hulse et al., 2016</xref>; <xref ref-type="bibr" rid="bib37">Gan et al., 2017</xref>). The firing of individual PCs appears to differ across experimental conditions, with mostly single spikes in vitro (<xref ref-type="bibr" rid="bib47">Hájos et al., 2013</xref>; <xref ref-type="bibr" rid="bib97">Schlingloff et al., 2014</xref>) and occasional burst firing and a lognormal firing rate distribution in vivo (<xref ref-type="bibr" rid="bib76">Mizuseki and Buzsáki, 2013</xref>). In our simulations, many PCs fired more than one spike per SWR, but these were not bursts in the usual sense as even the shortest ISIs were over 5 ms. The firing rate distribution was skewed, although not particularly long-tailed (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2B and C</xref>).</p><sec id="s2-2-1"><title>SWRs and replay are robust when recurrent excitation is varied</title><p>To show that our network model reproduces the wide range of experimental findings presented above in a robust manner, we ran a sensitivity analysis of several parameters. We started by studying the effects of the recurrent excitatory weights, which are the link between exploratory and resting dynamics. To this end, we ran simulations with PC-PC weights that were systematically up- or downscaled after the learning phase, and automatically evaluated various features of the network dynamics, such as population-averaged firing rates, the presence of sequence replay, as well as significant peaks in the ripple frequency range in the power spectra as shown before (‘Materials and methods’ and <xref ref-type="fig" rid="fig3">Figure 3</xref>). The network with PC-PC weights multiplied by 0.8 displayed a low-activity, noisy state with severely reduced mean PC firing rate, no sequence replay, and no clear oscillation (<xref ref-type="fig" rid="fig3">Figure 3A1</xref>). At the 0.9 multiplier level, sequence replays started to appear, but were less frequent than in the baseline model (<xref ref-type="fig" rid="fig3">Figure 3A2</xref>). As the PC-PC synaptic weights were scaled up, sequence replays became faster (completed in a shorter time) and occurred more often (<xref ref-type="fig" rid="fig3">Figure 3A3</xref>), a behavior that was stable and realistic up to the 1.5 multiplier level. Ripple oscillations had higher power and appeared at lower multiplier levels in the PVBC population than in the PC population (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>), suggesting that they originate from the PVBCs and propagate to the PCs, in agreement with theories based on experimental findings (<xref ref-type="bibr" rid="bib11">Buzsáki et al., 1992</xref>; <xref ref-type="bibr" rid="bib109">Ylinen et al., 1995</xref>; <xref ref-type="bibr" rid="bib92">Rácz et al., 2009</xref>; <xref ref-type="bibr" rid="bib97">Schlingloff et al., 2014</xref>; <xref ref-type="bibr" rid="bib99">Stark et al., 2014</xref>; <xref ref-type="bibr" rid="bib37">Gan et al., 2017</xref>). Overall, the qualitative behavior of our model was similar in a fairly wide range of recurrent excitation, although our baseline model was relatively close to the lower end of this range.</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Sharp waves, ripple oscillations, and replay are robust with respect to scaling the recurrent excitatory weights.</title><p>(<bold>A</bold>) Pyramidal cell (PC) raster plots on top and PC population rates at the bottom for E-E scaling factors 0.9 (<bold>A1</bold>), 0.95 (<bold>A2</bold>), and 1.05 (<bold>A3</bold>). (Scaling factor of 1.0 is equivalent to <xref ref-type="fig" rid="fig2">Figure 2A</xref>.) Dashed vertical black lines have the same meaning as in <xref ref-type="fig" rid="fig2">Figure 2A</xref>. (<bold>B</bold>) Analysis of selected indicators of network dynamics across different E-E weight scaling factors (0.8–1.2). Mean PC (blue) and parvalbumin-containing basket cell (PVBC) (pink) population rates are shown on top. The frequency of significant ripple oscillations (black) and the percentage of power in the ripple frequency range (red) in the estimated local field potential (LFP) is shown at the bottom. Errors bars indicate standard deviation and are derived from simulations with five different random seeds. See also <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71850-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Spectral analysis of network dynamics across different pyramidal cell-pyramidal cell (PC-PC) weight scaling factors.</title><p>(<bold>A</bold>) Power spectral densities (PSDs) of PC (<bold>A1</bold>) and parvalbumin-containing basket cell (PVBC) (<bold>A2</bold>) population rates and estimated local field potential (LFP) (<bold>A3</bold>). Gray lines correspond to individual high-activity states (n = 14) shown in <xref ref-type="fig" rid="fig2">Figure 2A</xref>, while the thicker-colored lines are their averages. Ripple frequency range (150–220 Hz) is highlighted in red. Shaded red area below the curves indicates the power in the ripple range. (<bold>B</bold>) Spectral analysis of network dynamics across different E-E weight scaling factors (0.8–1.2). The frequency of any significant ripple oscillation (black) and the percentage of power in the ripple band (red) are shown for PC (<bold>B1</bold>) and PVBC (<bold>B2</bold>) population rates and estimated LFP (<bold>B3</bold>). (<bold>B3</bold>) is the same as the bottom panel of <xref ref-type="fig" rid="fig3">Figure 3B</xref>, and it is duplicated here only to show how similar the curves are for the rates and the estimated LFP.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71850-fig3-figsupp1-v2.tif"/></fig></fig-group></sec><sec id="s2-2-2"><title>Multiple environments can be learned and replayed</title><p>Next, we showed that it is possible to store the representations of multiple environments in the weight matrix, and this change does not fundamentally alter the network dynamics (<xref ref-type="fig" rid="fig4">Figure 4</xref>). In particular, we simulated experience and STDP-based learning in two linear environments with a different but overlapping random set of place cells (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). The resulting population-level dynamics was quite similar to the one following experience in a single environment, but, during each SWR event, a place cell sequence from either one or the other environment was reactivated (<xref ref-type="fig" rid="fig4">Figure 4B and C</xref>). Learning two sequences with the same additive symmetric (nondecreasing) STDP rule led to stronger PC-PC synapses on average (<xref ref-type="fig" rid="fig4">Figure 4A4</xref>), which resulted in a higher overall mean PC rate (<xref ref-type="fig" rid="fig4">Figure 4B and D</xref>). As a consequence, detectable sequence replays and significant ripple oscillations appeared at lower PC-PC weight multiplier levels (<xref ref-type="fig" rid="fig4">Figure 4D</xref>).</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Two distinct environments can be learned and replayed by the network.</title><p>(<bold>A</bold>) Learned excitatory recurrent weight matrices. (<bold>A1</bold>) Weights after learning the first environment. Note that the matrix appears random because neurons are arranged according to their place field location in the second environment, which has not been explored at this point. (<bold>A3</bold>) Weights after learning in the second environment. (<bold>A2, A4</bold>) Distribution of nonzero synaptic weights in the learned weight matrices in (<bold>A1</bold>) and (<bold>A2</bold>), respectively. (<bold>B</bold>) Pyramidal cell (PC) raster plots: in the top panel, neurons are ordered and colored according to the first environment; in the middle panel, neurons are ordered and colored according to the second environment; and PC population rate is shown at the bottom (see <xref ref-type="fig" rid="fig2">Figure 2A</xref>) from a simulation run with 0.9* the modified weight matrix shown in (<bold>A3</bold>). (<bold>C</bold>) Posterior matrices of decoded positions from spikes (see <xref ref-type="fig" rid="fig1">Figure 1E</xref>) within two selected high-activity periods (8th and 10th from <bold>B</bold>). From left to right: decoding of replay in first environment (eighth event from <bold>B</bold>) according to the first (significant) and second environment; decoding of replay in second environment (10th event from <bold>B</bold>) according to the first and second (significant) environment. (<bold>D</bold>) Analysis of selected network dynamics indicators across different E-E weight scaling factors (0.7–1.1) as in <xref ref-type="fig" rid="fig3">Figure 3B</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71850-fig4-v2.tif"/></fig></sec></sec><sec id="s2-3"><title>Manipulating the model reveals mechanisms of SWR generation and sequence replay</title><p>Our network model, equipped with structured recurrent excitation resulting from learning, was able to robustly reproduce recurring sharp wave events accompanied by bidirectional sequence replay and ripple oscillations. Next, we set out to modify this excitatory weight matrix to gain a more causal understanding of how the learned weight pattern is related to the emergent spontaneous dynamics of the network.</p><sec id="s2-3-1"><title>Symmetric STDP rule is necessary for bidirectional replay</title><p>First, in order to gauge the significance of the experimentally determined symmetric STDP rule, we changed the STDP kernel to the classical asymmetric one that characterizes many other connections in the nervous system (<xref ref-type="fig" rid="fig5">Figure 5A–C</xref>; <xref ref-type="bibr" rid="bib5">Bi and Poo, 1998</xref>; <xref ref-type="bibr" rid="bib41">Gerstner et al., 2014</xref>). In this case, the learned weight matrix was reminiscent of the feedforward chains that characterized several of the earlier models of hippocampal replay (<xref ref-type="bibr" rid="bib53">Jahnke et al., 2015</xref>; <xref ref-type="bibr" rid="bib14">Chenkov et al., 2017</xref>; <xref ref-type="bibr" rid="bib103">Theodoni et al., 2018</xref>). We found that this weight structure also supported the generation of SWR events and the reactivation of learned sequences in our model; however, crucially, sequence replays occurred only in the forward direction (<xref ref-type="fig" rid="fig5">Figure 5D and E</xref>). <xref ref-type="bibr" rid="bib103">Theodoni et al., 2018</xref> presented a thorough analysis of the relationship between the shape of the (asymmetric) plasticity kernel and sequence replay in a rate-based model, and thus we shifted our focus towards different modifications.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Learning with an asymmetric spike-timing-dependent plasticity (STDP) rule leads to the absence of backward replay.</title><p>(<bold>A</bold>) Asymmetric STDP kernel used in the learning phase. (<bold>B</bold>) Learned excitatory recurrent weight matrix. (<bold>C</bold>) Distribution of nonzero synaptic weights in the weight matrix shown in (<bold>B</bold>). (<bold>D</bold>) Pyramidal cell (PC) raster plot on top and PC population rate at the bottom (see <xref ref-type="fig" rid="fig2">Figure 2A</xref>) from a simulation run with the weight matrix shown in (<bold>B</bold>). (<bold>E</bold>) Posterior matrix of the decoded positions from spikes (see <xref ref-type="fig" rid="fig1">Figure 1E</xref>) within a selected high-activity state (sixth one from <bold>D</bold>). (<bold>F</bold>) Analysis of selected network dynamics indicators across different E-E weight scaling factors (0.8–1.2) as in <xref ref-type="fig" rid="fig3">Figure 3B</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71850-fig5-v2.tif"/></fig></sec><sec id="s2-3-2"><title>The structure rather than the statistics of recurrent excitatory weights is critical for SWRs</title><p>Inspired by the observation that many network-level properties, such as single PC firing rates, burst index, and participation in SWR events, follow a skewed, lognormal distribution in vivo (<xref ref-type="bibr" rid="bib76">Mizuseki and Buzsáki, 2013</xref>), <xref ref-type="bibr" rid="bib84">Omura et al., 2015</xref> built a network model with recurrent excitatory weights following a lognormal distribution. Their network with unstructured, but lognormally distributed, recurrent synaptic strengths reproduced most of the in vivo observations of <xref ref-type="bibr" rid="bib76">Mizuseki and Buzsáki, 2013</xref>; however, no sequence replay or ripple oscillation was involved. In the network presented here, the distribution of PC-PC weights is the result of the application of STDP to the generated spike trains and does not strictly follow a lognormal distribution, although it has a similar long tail (<xref ref-type="fig" rid="fig6">Figure 6D2</xref>). In order to establish whether the overall distribution or the fine structure of the weights is the key determinant of neural dynamics in our model, we performed two more drastic perturbations of the recurrent weight matrix itself, starting from the version established in the learning phase of our baseline model (<xref ref-type="fig" rid="fig1">Figure 1C</xref>).</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Altering the structure of recurrent excitatory interactions changes the network dynamics but altering the weight statistics has little effect.</title><p>(<bold>A1</bold>) Binarized (largest 3% and remaining 97% nonzero weights averaged separately) recurrent excitatory weight matrix. (Derived from the baseline one shown in <xref ref-type="fig" rid="fig1">Figure 1C</xref>.) (<bold>A2</bold>) Distribution of nonzero synaptic weights in the learned weight matrix shown in (<bold>A1</bold>). (<bold>B</bold>) Pyramidal cell (PC) raster plot on top and PC population rate at the bottom (see <xref ref-type="fig" rid="fig2">Figure 2A</xref>) from a simulation run with 1.1* the binarized weight matrix shown in (<bold>A</bold>). (<bold>C</bold>) Analysis of selected network dynamics indicators across different E-E weight scaling factors (0.9–1.3) as in <xref ref-type="fig" rid="fig3">Figure 3B</xref>. (<bold>D1</bold>) Column-shuffled recurrent excitatory weight matrix. (Derived from the baseline one shown in <xref ref-type="fig" rid="fig1">Figure 1C</xref>.) (<bold>D2</bold>) Distribution of nonzero synaptic weights in the weight matrix shown in (<bold>D1</bold>) (identical to the distribution of the baseline weight matrix shown in <xref ref-type="fig" rid="fig1">Figure 1C</xref>). (<bold>E</bold>) PC raster plot on top and PC population rate at the bottom from a simulation run with the shuffled weight matrix shown in (<bold>D1</bold>). (<bold>F</bold>) Analysis of selected network dynamics indicators across different E-E weight scaling factors (1.0–4.0) as in <xref ref-type="fig" rid="fig3">Figure 3B</xref>. Note the significantly extended horizontal scale compared to other cases.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71850-fig6-v2.tif"/></fig><p>Our first perturbation kept the structure of the interactions and the overall mean weight intact, but completely changed the distribution of the weights. This was achieved by binarizing the values of the learned weight matrix. Specifically, we divided weights into two groups, the strongest 3% and the remaining 97%, and set each weight in both groups to the group average (<xref ref-type="fig" rid="fig6">Figure 6A</xref>). Using the modified recurrent synapses between the PCs in the network, we observed extremely similar behavior to our baseline network: recurring sharp waves and sequence replays in both directions, always accompanied by ripple oscillations, with only a small change in the required multiplier for the PC-PC weights (<xref ref-type="fig" rid="fig6">Figure 6B and C</xref>).</p><p>The second modification kept the same overall weight distribution and even the actual values of the outgoing weights for all neurons, but destroyed the global structure of synaptic interactions in the network. To this end, we randomly shuffled the identity of the postsynaptic neurons (by shuffling the columns of the weight matrix). Strong synapses were not clustered anymore along the diagonal (representing interactions between neurons with nearby place fields), but distributed homogeneously within the matrix (<xref ref-type="fig" rid="fig6">Figure 6D1</xref>). None of the networks equipped with the scaled versions of this shuffled weight matrix exhibited sequence replay, mean PC rates were severely reduced, and no sharp wave-like events were observed (<xref ref-type="fig" rid="fig6">Figure 6E and F</xref>). On the other hand, with sufficiently amplified (*3.5) PC-PC weights, we detected significant peaks in the ripple frequency range of the LFP (<xref ref-type="fig" rid="fig6">Figure 6F</xref>).</p><p>Taken together, these modifications suggest that, unlike in the model of <xref ref-type="bibr" rid="bib84">Omura et al., 2015</xref>, the distribution of the excitatory recurrent synaptic weights is neither necessary nor sufficient for the observed physiological population activity in our model. In other words, our simulation results suggest that the fine structure of recurrent excitation not only enables coding (sequence replay), but also has a major effect on the global average network dynamics (firing rates, sharp waves, and ripple oscillations) in hippocampal area CA3.</p></sec><sec id="s2-3-3"><title>Cellular adaptation is necessary for replay</title><p>As mentioned earlier, most previous models with symmetrical local excitatory interactions and global feedback inhibition functioned as ‘bump attractor’ networks, in which the dynamics converge to stable patterns of activity involving high rates in a group of neurons with similar tuning properties (adjacent place fields), and suppressed firing in the rest of the excitatory population (<xref ref-type="bibr" rid="bib111">Zhang, 1996</xref>; <xref ref-type="bibr" rid="bib96">Samsonovich and McNaughton, 1997</xref>; <xref ref-type="bibr" rid="bib56">Káli and Dayan, 2000</xref>; <xref ref-type="bibr" rid="bib16">Compte et al., 2000</xref>). Recent work with rate-based models has also shown that these ‘stable bumps’ can be transformed into ‘traveling bumps’ by the introduction of short-term depression (<xref ref-type="bibr" rid="bib110">York and van Rossum, 2009</xref>; <xref ref-type="bibr" rid="bib95">Romani and Tsodyks, 2015</xref>; <xref ref-type="bibr" rid="bib103">Theodoni et al., 2018</xref>) or spike threshold adaptation (<xref ref-type="bibr" rid="bib51">Itskov et al., 2011</xref>; <xref ref-type="bibr" rid="bib2">Azizi et al., 2013</xref>). On the other hand, previous spiking models of sequence learning and recall/replay typically relied on temporally asymmetric learning rules and the resulting asymmetric weight matrices to ensure that neurons are reactivated in the same sequence as during learning (<xref ref-type="bibr" rid="bib53">Jahnke et al., 2015</xref>; <xref ref-type="bibr" rid="bib14">Chenkov et al., 2017</xref>), which is also why it is difficult for these models to capture bidirectional replay. <xref ref-type="bibr" rid="bib14">Chenkov et al., 2017</xref> also explored the effects of symmetric connectivity patterns in a spiking network with local feedback inhibition and demonstrated the possibility of bidirectional replay, but the excitatory weights in their models were hard-wired rather than learned. Our model uses the experimentally recorded symmetric STDP rule, which results in symmetrical synaptic interactions (although only at the population level rather than the single-neuron level due to the randomness of connectivity). Since our network generated a bump of activity that traveled unidirectionally in any given replay event rather than a stationary bump, we hypothesized that the cellular-level adaptation that characterized CA3 PCs and was also captured by our model may destabilize stable bumps and lead to their constant movement.</p><p>To test this hypothesis, we refitted our single-cell data on PC responses to current injections using a modified ExpIF model that did not contain any adaptation mechanism (but was otherwise similar to the baseline model). Although the nonadapting ExpIF model provided a reasonably good fit to our single-cell data (<xref ref-type="fig" rid="fig7">Figure 7A</xref>), and the weights resulting from learning were identical to the baseline case, the spontaneous network dynamics was completely different: there was no sequence replay for any scaling of the recurrent PC-PC weights; instead, when structured activity emerged from the random background, it was in the form of a stationary rather than a moving bump (<xref ref-type="fig" rid="fig7">Figure 7B</xref>). Therefore, it was the combination of a symmetric learning rule with cellular adaptation that created the possibility of bidirectional replay in our network model.</p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Sequential replay requires firing rate adaptation in the pyramidal cell (PC) population.</title><p>(<bold>A</bold>) Voltage traces of fitted AdExpIF (blue) and ExpIF (gray) PC models and experimental traces (green) are shown in the top panel. Insets show the f–I curves of the in vitro and in silico cells. The amplitudes of the 800-ms-long step current injections shown at the bottom were as follows: –0.04, 0.15, and 0.6 nA. For parameters of the cell models, see <xref ref-type="table" rid="table2">Table 2</xref>. (<bold>B</bold>) PC raster plot of a 10-s-long simulation with the ExpIF PC models, showing stationary activity in the top panel. PC population rate is shown below.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71850-fig7-v2.tif"/></fig></sec><sec id="s2-3-4"><title>Ripple oscillations are generated by the recurrently coupled inhibitory population</title><p>From the weight matrix modifications, we also learned that ripple oscillations can be disentangled from sequence replays and only require sufficient drive to the interconnected PVBC population in our model (<xref ref-type="fig" rid="fig6">Figure 6F</xref>). The same conclusion was reached by recent optogenetic studies in vitro (<xref ref-type="bibr" rid="bib27">Ellender et al., 2010</xref>; <xref ref-type="bibr" rid="bib97">Schlingloff et al., 2014</xref>) and in vivo (<xref ref-type="bibr" rid="bib99">Stark et al., 2014</xref>). To further investigate the generation of ripples in our model, we simulated and analyzed two additional modified versions of the full network.</p><p>First, we disconnected the PVBC network from the PCs and replaced the PC input with independent Poisson synaptic input at rates derived from the firing of the PC population during SWRs in the full simulation (<xref ref-type="fig" rid="fig8">Figure 8A and B</xref>). In this simplified, recurrently connected, purely PVBC network, we systematically scanned different values of PC input rate and PC-PVBC synaptic weight and measured ripple power as well as the frequency of any significant ripple oscillation as in the full network before (<xref ref-type="fig" rid="fig8">Figure 8A and B</xref>). We found that ripple oscillations emerged when the net excitatory drive to PVBCs (which is proportional to the product of the incoming weight and the presynaptic firing rate) was sufficiently large. Above this threshold, the properties of the oscillation depended only mildly on the strength of the input (e.g., the frequency of the oscillation increased moderately with increasing drive), and the firing of PVBCs was synchronized mainly by the decay of inhibitory synaptic current evoked by shared input from their peers.</p><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Generation of ripple oscillations relies on recurrent connections within the parvalbumin-containing basket cell (PVBC) population.</title><p>(<bold>A</bold>) Significant ripple frequency (<bold>A1</bold>) and ripple power (<bold>A2</bold>) of a purely PVBC network, driven by (independent) spike trains mimicking pyramidal cell (PC) population activity. Gray color in (<bold>A1</bold>) means no significant ripple peak. (<bold>B</bold>) From top to bottom: raster plot, mean PVBC rate, voltage trace (of a selected cell), EPSCs, and IPSCs of the selected cell from the middle (100-ms-long window) of a simulation used for (<bold>A</bold>). Ripple frequency and power corresponding to this simulation are marked with a black rectangle in (<bold>A1</bold>) and (<bold>A2</bold>). (<bold>C</bold>) PC raster plot on top and PC population rate at the bottom from a simulation run with a network with 1.3* baseline E-E weight matrix but without any PVBC-PVBC synapses, featuring stochastic forward and backward replays but no ripple oscillation (see below). (<bold>D</bold>) Estimated local field potential (LFP) in the top panel and its time-frequency representation (wavelet analysis) below. (Compared to <xref ref-type="fig" rid="fig2">Figure 2B</xref>, there is increased power in the gamma range, but no ripple frequency oscillation.) (<bold>E</bold>) Analysis of selected network dynamics indicators across different E-E weight scaling factors (0.8–1.6) as in <xref ref-type="fig" rid="fig3">Figure 3B</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71850-fig8-v2.tif"/></fig><p>Several experiments have shown that local application of GABA blockers eliminates ripples (<xref ref-type="bibr" rid="bib68">Maier et al., 2003</xref>; <xref ref-type="bibr" rid="bib27">Ellender et al., 2010</xref>; <xref ref-type="bibr" rid="bib97">Schlingloff et al., 2014</xref>; <xref ref-type="bibr" rid="bib99">Stark et al., 2014</xref>); however, in an experimental setup it is hard to distinguish feedback inhibition (PVBC-PC) from reciprocal inhibition (PVBC-PVBC). As a final perturbation, we modified the full baseline model by eliminating only the recurrent inhibitory synapses (<xref ref-type="fig" rid="fig8">Figure 8C and D</xref>). The resulting dynamics were stable and with enhanced (*1.3) PC-PC weights it also displayed sequence replay, but ripple oscillations were never observed (<xref ref-type="fig" rid="fig8">Figure 8D and E</xref>). Taken together, these results support the conclusions of previous modeling (<xref ref-type="bibr" rid="bib7">Brunel and Wang, 2003</xref>; <xref ref-type="bibr" rid="bib40">Geisler et al., 2005</xref>; <xref ref-type="bibr" rid="bib102">Taxidis et al., 2012</xref>; <xref ref-type="bibr" rid="bib22">Donoso et al., 2018</xref>; <xref ref-type="bibr" rid="bib93">Ramirez-Villegas et al., 2018</xref>) as well as experimental studies (<xref ref-type="bibr" rid="bib11">Buzsáki et al., 1992</xref>; <xref ref-type="bibr" rid="bib109">Ylinen et al., 1995</xref>; <xref ref-type="bibr" rid="bib92">Rácz et al., 2009</xref>; <xref ref-type="bibr" rid="bib27">Ellender et al., 2010</xref>; <xref ref-type="bibr" rid="bib97">Schlingloff et al., 2014</xref>; <xref ref-type="bibr" rid="bib99">Stark et al., 2014</xref>; <xref ref-type="bibr" rid="bib43">Gulyás and Freund, 2015</xref>; <xref ref-type="bibr" rid="bib37">Gan et al., 2017</xref>), proposing that ripple oscillations are generated in strongly driven, recurrently connected inhibitory networks by the fast inhibitory neuronal oscillation (FINO) mechanism. In fact, recurrent inhibitory connections were both necessary and sufficient for the generation of ripple oscillations in our model.</p></sec></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Using a data-driven network model of area CA3 of the hippocampus that reproduces the main characteristics of SWRs, we examined the link between learning during exploration and the network dynamics in resting periods. Our principal findings from analyzing and manipulating this model are as follows: (1) structured (learned) recurrent excitation in the CA3 region not only enables coding and memory, but is critical for the generation of SWRs as well; (2) the symmetric STDP rule described by <xref ref-type="bibr" rid="bib75">Mishra et al., 2016</xref>, in combination with cellular adaptation in CA3 PCs, provides an explanation for the coexistence of forward and reverse replays; (3) the pattern of strong connections in the network rather than the overall weight statistics may be critical for the emergence and key properties of SWRs and replay in area CA3; and (4) ripple oscillations are generated in the strongly driven, recurrently connected network of fast-spiking PVBCs by the FINO mechanism (<xref ref-type="bibr" rid="bib97">Schlingloff et al., 2014</xref>) (also known as PYR-INT-INT [<xref ref-type="bibr" rid="bib99">Stark et al., 2014</xref>; <xref ref-type="bibr" rid="bib12">Buzsáki, 2015</xref>; <xref ref-type="bibr" rid="bib93">Ramirez-Villegas et al., 2018</xref>]).</p><sec id="s3-1"><title>Connections of sharp waves, sequence replay, and ripple oscillations</title><p>SWRs represent the most synchronous physiological activity pattern with the largest excitatory gain in the mammalian brain (<xref ref-type="bibr" rid="bib8">Buzsáki et al., 1983</xref>; <xref ref-type="bibr" rid="bib11">Buzsáki et al., 1992</xref>; <xref ref-type="bibr" rid="bib10">Buzsáki, 1989</xref>; <xref ref-type="bibr" rid="bib12">Buzsáki, 2015</xref>). Under normal conditions, ripples are typically observed riding on top of naturally emerging sharp waves. More recently, using optogenetics, <xref ref-type="bibr" rid="bib97">Schlingloff et al., 2014</xref> and <xref ref-type="bibr" rid="bib99">Stark et al., 2014</xref> managed to decouple ripples from sharp waves by directly and indirectly activating the interconnected network of PVBCs. Our in silico results perfectly parallel this work: without drastic, nonphysiological modifications of the model ripples were always tied to sequence replay, which was in turn associated with bouts of increased spiking activity in the network (the sharp waves). When we separated the PVBC network, we found that a relatively high (&gt;2 Hz) mean firing rate in the PC population was required for inducing ripple oscillation, a condition that was satisfied only during sharp wave events and the associated sequence replay in our full baseline network. When the PC population reaches this frequency after a stochastically initiated buildup period (<xref ref-type="bibr" rid="bib97">Schlingloff et al., 2014</xref>), the strongly driven, high-frequency firing of PVBCs is synchronized and phase-locked via reciprocal inhibition. Thus, the learned recurrent PC-PC synaptic weights are responsible for coding, govern sequence replay, and, by giving rise to high PC activity during the replay, they also cause the ripples. In summary, memory storage and recall, as well as the main hippocampal oscillations and transient activity patterns, are intimately interconnected in our unifying model.</p></sec><sec id="s3-2"><title>Experimental predictions</title><p>The identification of the mechanisms in the model through which specific synaptic interactions, plasticity, and cellular properties give rise to sequence generation and particular aspects of population dynamics (sharp waves and ripple oscillations) also allows us to make explicit experimental predictions. Although some of the manipulations that we used to probe our model (such as shuffling the weights) are not feasible in the biological system, others could probably be replicated using modern (e.g., optogenetic or chemogenetic) tools. As an important example, our model predicts that selectively blocking recurrent inhibitory connections between PVBCs should completely eliminate ripple oscillations, while having only minor quantitative effects (through modifying the effective gain of feedback inhibition of PCs) on sharp waves and sequence replay. By contrast, blocking or substantially attenuating recurrent excitatory interactions in area CA3 is expected to simultaneously eliminate sharp waves, ripple oscillations, and autonomous sequence replay.</p><p>Recent experimental findings indicated that the content of replay may be substantially different depending on the experience of the animal (<xref ref-type="bibr" rid="bib90">Pfeiffer and Foster, 2015</xref>; <xref ref-type="bibr" rid="bib100">Stella et al., 2019</xref>; <xref ref-type="bibr" rid="bib58">Kay et al., 2020</xref>). In our model, the nature of replayed sequences depends mostly on the activity patterns of hippocampal neurons during exploration, which determine, through learning, the subsequent pattern of recurrent interactions. In the basic scenario explored in our paper, learning occurred during repeated runs along a single linear track, which led to reactivations consisting of random chunks of the single learned trajectory, and allowed our model to replicate the replay dynamics observed by <xref ref-type="bibr" rid="bib90">Pfeiffer and Foster, 2015</xref>. However, other types of learning experience would be expected to result in different reactivation dynamics. For instance, random exploration in an open field, as investigated by <xref ref-type="bibr" rid="bib100">Stella et al., 2019</xref>, may be expected to result in a 2D bump attractor structure encoded in the recurrent weights (similarly to the earlier model of <xref ref-type="bibr" rid="bib56">Káli and Dayan, 2000</xref>), and this, combined with adaptation and some random noise, may explain the diffusive nature of reactivation in their experiments. Similarly, the learning of alternative routes in the experiments of <xref ref-type="bibr" rid="bib58">Kay et al., 2020</xref>, combined with adaptation, may explain the spontaneous switching between representations of alternative future paths. Overall, a general prediction of our framework is that one could deduce the nature of reactivations in different experiments using the same model simply by changing the spike statistics during the learning phase so that it mimics the corresponding experimental observations. It also follows from this argument that the different results of these studies should stem primarily from the different environments and protocols used during training rather than, for instance, differences in analysis methods.</p><p>Experimental studies focusing on conventional forms of sequence reactivation found that the dominant direction of replay depended on the behavioral state of the animal (<xref ref-type="bibr" rid="bib32">Foster and Wilson, 2006</xref>; <xref ref-type="bibr" rid="bib21">Diba and Buzsáki, 2007</xref>; <xref ref-type="bibr" rid="bib89">Pfeiffer and Foster, 2013</xref>), and replay often started at behaviorally relevant locations (<xref ref-type="bibr" rid="bib57">Karlsson and Frank, 2009</xref>). In our model, the starting point and direction of replay depend on systematic biases and random variations in the weight structure, but also on (random or deterministic) spatio-temporal structure in the external inputs. We believe that the cued replay scenario that we simulated is not entirely artificial – even real environments may contain choice points where the animal pauses to plan its route, or reward sites that again make the animal stop and may also activate subcortical modulatory systems that affect plasticity. At intermediate sites, systematic bias could be introduced during exploration by factors that influence behavior (e.g., running speed), neuronal activity or plasticity (e.g., attention), especially if such factors can change the fully symmetric nature of the synaptic plasticity rule. Random variations in connectivity or the weights (e.g., due to stochastic spiking during learning) will lead to a location-dependent systematic bias towards forward or reverse replay. Finally, (randomly occurring or input-driven) sequences in the external input are also expected to bias the direction of replay even at intermediate points. Although a detailed analysis of the relative impact of these factors will require further efforts, we can already make some predictions regarding the effects of various experimental manipulations. In particular, it should be possible to influence the starting point and direction of replay by the selective activation of place cells representing a particular location (or a sequence of locations) in offline states, although the rapid sequential activation of functionally defined chains of neurons might be technically challenging. More importantly, our model also predicts that similar manipulations of neuronal activity <italic>during exploration</italic> should also have an impact on the content of replay, and even on the global properties of sharp waves, through their influence on the learned synaptic weight structure.</p><p>Finally, our modeling results also suggest that it would be critical to explore whether the unusual, temporally symmetric STDP rule uncovered by <xref ref-type="bibr" rid="bib75">Mishra et al., 2016</xref> correctly describes the plasticity of CA3 excitatory recurrent collaterals under all physiological circumstances, or perhaps the rule is different (not entirely symmetric or even antisymmetric) under some conditions in vivo, for example, depending on behavioral variables and the associated pattern of subcortical inputs. One specific prediction of our model is that any factors that change the symmetric nature of the plasticity rule during exploration should alter the balance of forward and backward replay events during subsequent SWRs.</p></sec><sec id="s3-3"><title>Biological plausibility of the model</title><p>The network model presented here was constrained strongly by the available experimental data. Many cellular and synaptic parameters were fit directly to in vitro measurements, and most functional parameters correspond to in vivo recordings of hippocampal place cells. Nevertheless, there are certainly many biological features that are currently missing from our model. We do not see this as a major limitation of our study as our goal was to provide a mechanistic explanation for a core set of phenomena by identifying the key underlying biological components and interactions. On the other hand, our model can be systematically refined and extended, especially when new experimental data become available. The main assumptions we made when constructing the model are explicitly stated in <xref ref-type="table" rid="table1">Table 1</xref>. Here, we briefly discuss some of these assumptions, as well as some remaining discrepancies between our simulation results and the corresponding experimental data.</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>List of modeling assumptions.</title></caption><table frame="hsides" rules="groups"><tbody><tr><td align="char" char="." valign="bottom">1</td><td align="left" valign="bottom">In the absence of unified datasets, it was assumed that published parameters from different animals (mouse/rat, strain, sex, age) can be used together to build a general model.</td></tr><tr><td align="char" char="." valign="bottom">2</td><td align="left" valign="bottom">Connection probabilities were assumed to depend only on the presynaptic cell type and to be independent of distance.</td></tr><tr><td align="char" char="." valign="bottom">3</td><td align="left" valign="bottom">Each pyramidal cell was assumed to have a place field in any given environment with a probability of 50%. For simplicity, multiple place fields were not allowed.</td></tr><tr><td align="char" char="." valign="bottom">4</td><td align="left" valign="bottom">When constructing the ‘teaching spike trains’ during simulated exploration, place fields were assumed to have a uniform size, tuning curve shape, and maximum firing rate.</td></tr><tr><td align="char" char="." valign="bottom">5</td><td align="left" valign="bottom">For simplicity, all synaptic interactions in the network were modeled as deterministic conductance changes. Short-term plasticity was not included, and long-term plasticity was assumed to operate only in the learning phase.</td></tr><tr><td align="char" char="." valign="bottom">6</td><td align="left" valign="bottom">When considering the nonspecific drive to the network in the offline state, it was assumed that the external input can be modeled as uncorrelated random spike trains (one per cell) activating strong synapses (representing the mossy fibers) in the pyramidal cell population.</td></tr><tr><td align="char" char="." valign="bottom">7</td><td align="left" valign="bottom">Some fundamental assumptions are inherited from common practices in computational neuroscience; these include modeling spike trains as Poisson processes, capturing weight changes with additive spike-timing-dependent plasticity, describing cells with single-compartmental AdExpIF models, modeling a neuronal population with replicas of a single model, and representing synapses with conductance-based models with biexponential kinetics.</td></tr><tr><td align="char" char="." valign="bottom">8</td><td align="left" valign="bottom">When comparing our model to in vivo data, an implicit assumption was that the behavior of a simplified model based on slice constraints can generalize to the observed behavior of the full CA3 region in vivo, in the context of studying the link between activity-dependent plasticity and network dynamics.</td></tr></tbody></table></table-wrap><p>The 10% PC-PC connection probability is based on the classical viewpoint that considers the CA3 region as a highly interconnected network (<xref ref-type="bibr" rid="bib67">Lisman, 1999</xref>; <xref ref-type="bibr" rid="bib1">Andersen et al., 2007</xref>). Although a recent physiological study (<xref ref-type="bibr" rid="bib45">Guzman et al., 2016</xref>) estimated &lt;1% connection probability in 400-µm-thick slices, the authors concluded from ‘virtual slicing’ experiments that recurrent axons were substantially reduced. This is in agreement with <xref ref-type="bibr" rid="bib66">Li et al., 1994</xref>, who reported at least 70% axonal loss in 400 µm slices. Thus, the in vivo connection probability is likely to be considerably higher than 1%. Furthermore, due to the long-tailed distribution of synaptic weights, many of the anatomically existing connections that are represented in our model may be too weak to be reliably detected in paired recording experiments.</p><p>Our model network contained 8000 PCs and 150 PVBCs, which is rather small compared to the full rodent CA3 region. While in vitro studies suggest that this network size is sufficient for the generation of SWRs, and that these two cell types are the key players in this process, it is likely that the much larger network size and the various additional cell types modify the quantitative aspects of SWRs in vivo.</p><p>For simplicity, we also decided not to model all the different types of variation in single-cell and synaptic properties that characterize real cortical networks. However, it is important to note that several sources of variability (e.g., those resulting from the random assignment of place field locations, sparse, randomized connectivity, and stochastic, independent external drive) were still included in the model. The variability that we include is sufficient to avoid the regular, unnaturally synchronous dynamics that often characterize homogeneous networks, and results in variable, natural-looking spike patterns during both exploration and spontaneous SWR activity. Including additional forms of heterogeneity would likely increase the cell-to-cell variability of activity (such as firing rates), but (up to a certain limit) would not be expected to change our results qualitatively.</p><p>We modeled activity-dependent synaptic plasticity based on the study of <xref ref-type="bibr" rid="bib75">Mishra et al., 2016</xref>, who uncovered an unusual, temporally symmetric form of STDP in the recurrent excitatory connections between CA3 pyramidal neurons. We fit the temporal kernel of our STDP rule directly to their data, assumed linear summation of synaptic modifications from all the spike pairs that occurred during the exploration phase, and ignored all higher-order (triplet, etc.) spike interactions. However, we note that the details of the plasticity rule are not expected to have a major impact on our results concerning the emergent dynamics of the CA3 network during resting periods as long as learning results in the strengthening of connections between PCs that are approximately co-active during exploration, independent of the exact temporal order of their spikes. This requirement would be satisfied by a variety of different learning rules, including the behavioral timescale plasticity rule recently described in hippocampal CA1 PCs (<xref ref-type="bibr" rid="bib6">Bittner et al., 2017</xref>).</p><p>The complete absence of plasticity in the second phase of our simulations may not be realistic. On the other hand, plasticity is known to be strongly modulated by brain state (e.g., through the action of subcortical inputs on hippocampal cells and synapses), so plasticity may be substantially weaker or different in offline states (such as slow-wave sleep; see <xref ref-type="bibr" rid="bib48">Hasselmo, 2006</xref>; <xref ref-type="bibr" rid="bib36">Fuenzalida et al., 2021</xref> for reviews). Finally, since replay recapitulates activity correlations in the learning phase, the main effect of plasticity during replay would be to reinforce existing patterns of weights and activity, although some kind of homeostatic mechanism may be required to prevent uncontrolled positive feedback in this case.</p><p>One substantial difference between SWRs in the model and those recorded in vivo is the duration of the SWR events and the associated replay. Ripple episodes typically last 40–100 ms in vivo (<xref ref-type="bibr" rid="bib86">O’Keefe and Nadel, 1978</xref>; <xref ref-type="bibr" rid="bib8">Buzsáki et al., 1983</xref>; <xref ref-type="bibr" rid="bib11">Buzsáki et al., 1992</xref>; <xref ref-type="bibr" rid="bib109">Ylinen et al., 1995</xref>), although <xref ref-type="bibr" rid="bib30">Fernández-Ruiz et al., 2019</xref> recently showed that learning in spatial memory tasks is associated with prolonged SWRs and replays. In our model, SWRs can be up to 800 ms in duration as they are terminated when the replayed sequence reaches either the end or the beginning of the learned trajectory (depending on the direction of replay), thus the length of the track determines the maximal duration of the SWR, in combination with the speed of replay (i.e., the rate at which activation propagates across the population of place cells). The speed of replay in the model is consistent with experimental findings, but a single replay event can cover the whole 3-m-long track. <xref ref-type="bibr" rid="bib18">Davidson et al., 2009</xref> also used a long track in their experiments; however, they reported that the whole path was never replayed during a single SWR, only short segments, which combined to cover the whole track over multiple SWRs. Therefore, it appears likely that our simplified model lacks some additional mechanisms that contribute to the termination of individual SWRs in the experiments. For example, building on the work of <xref ref-type="bibr" rid="bib110">York and van Rossum, 2009</xref>, some rate-based models of sequence replay in a circular environment (<xref ref-type="bibr" rid="bib95">Romani and Tsodyks, 2015</xref>; <xref ref-type="bibr" rid="bib103">Theodoni et al., 2018</xref>) included short-term synaptic depression as a mechanism for terminating replay. However, <xref ref-type="bibr" rid="bib45">Guzman et al., 2016</xref> found pseudo-linear short-term plasticity profiles for the recurrent PC-PC connections at physiological temperatures (although depression was present in recordings at room temperature). Another possibility is that an additional cell type that is not currently included in our model is responsible for the termination of SWR events. More specifically, the duration of the in silico SWRs could probably be controlled by a second interneuron population providing delayed, long-lasting feedback inhibition to the PCs. Three-population models were recently analyzed in detail by <xref ref-type="bibr" rid="bib29">Evangelista et al., 2020</xref>, who found that competitive interactions between PVBCs and another (so far unidentified) interneuron population inhibiting PCs, combined with appropriate short-term synaptic plasticity of the relevant connections, could explain many key experimental findings regarding the initiation and termination of SWRs.</p><p>Finally, we have presented our work as a model of the hippocampal CA3 area. This is because this area is known to be able to generate SWRs on its own, has modifiable recurrent connections that are thought to be essential for memory, and there are sufficient experimental data from this region to constrain the model. However, other cortical regions such as CA2, the subiculum, and entorhinal cortex are likely involved in the initiation of SWRs under normal conditions (<xref ref-type="bibr" rid="bib82">Oliva et al., 2016</xref>; <xref ref-type="bibr" rid="bib83">Oliva et al., 2020</xref>), and the mechanisms we describe here may be operational in these and other brain areas as well.</p></sec><sec id="s3-4"><title>Previous models of SWRs and sequence replay</title><p>In this study, our main objective was to build a simplified, yet powerful model of area CA3 that is constrained by experimental data at all (possible) levels, and thus allows us to uncover the mechanistic links between learning, neural population dynamics, and the representation of spatial (or other) sequences in the hippocampus during different behavioral states. Although there is a plethora of hippocampal models that shed light on some of these aspects (these models have been recently reviewed [<xref ref-type="bibr" rid="bib12">Buzsáki, 2015</xref>; <xref ref-type="bibr" rid="bib53">Jahnke et al., 2015</xref>] and are also cited when relevant throughout the ‘Results’ section), there are only a handful of recent models that attempted to treat all of them within a single coherent framework.</p><p>The study of <xref ref-type="bibr" rid="bib53">Jahnke et al., 2015</xref> is probably the most similar in spirit to ours as it also explores the relationship between learning, replay, and SWRs. One distinguishing feature of their model is that it relies on the nonlinear amplification of synaptic inputs by dendritic spikes in CA3 PCs for the generation of both sequential activity and ripple oscillations (<xref ref-type="bibr" rid="bib73">Memmesheimer, 2010</xref>). Importantly, replay always occurs in the forward direction in their model as it relies on feedforward chains of strong weights in the network, established by an asymmetric STDP rule that is quite distinct from the one that was later found empirically by <xref ref-type="bibr" rid="bib75">Mishra et al., 2016</xref>. In addition, the generation of ripple oscillations in their model relies on synchronized pulses of activity generated by interconnected PCs, while recent experimental findings appear to provide causal evidence for the involvement of fast-spiking PVBCs in ripple frequency oscillation generation (<xref ref-type="bibr" rid="bib92">Rácz et al., 2009</xref>; <xref ref-type="bibr" rid="bib27">Ellender et al., 2010</xref>; <xref ref-type="bibr" rid="bib28">English et al., 2014</xref>; <xref ref-type="bibr" rid="bib97">Schlingloff et al., 2014</xref>; <xref ref-type="bibr" rid="bib99">Stark et al., 2014</xref>; <xref ref-type="bibr" rid="bib43">Gulyás and Freund, 2015</xref>; <xref ref-type="bibr" rid="bib12">Buzsáki, 2015</xref>; <xref ref-type="bibr" rid="bib37">Gan et al., 2017</xref>). Finally, SWRs need to be evoked by synchronous external input in the model of <xref ref-type="bibr" rid="bib53">Jahnke et al., 2015</xref>, while they can also emerge spontaneously in our model.</p><p><xref ref-type="bibr" rid="bib69">Malerba and Bazhenov, 2019</xref> developed a combined model of areas CA3 and CA1 to study the generation of sharp waves in CA3 and associated ripple oscillations in CA1. This model relies on distance-dependent connection probabilities in the network for the generation of spatially localized SWR events. The study shows that modifying the recurrent excitatory weights via an asymmetric STDP rule during a simulated learning epoch biases the content of SWRs towards the (forward) reactivation of learned trajectories. Ripple oscillations are modeled only in CA1 and, in contrast to our model (and the models of <xref ref-type="bibr" rid="bib102">Taxidis et al., 2012</xref>; <xref ref-type="bibr" rid="bib22">Donoso et al., 2018</xref>; <xref ref-type="bibr" rid="bib93">Ramirez-Villegas et al., 2018</xref>), their generation is independent of recurrent inhibition.</p><p>A notable recent example of functionally motivated (top-down) modeling of these phenomena is the study of <xref ref-type="bibr" rid="bib80">Nicola and Clopath, 2019</xref>. The authors designed and trained (using supervised learning methods) a network of spiking neurons to generate activity sequences that were either tied to the population-level theta oscillation or occurred spontaneously in isolation (in a compressed manner) depending on the presence or absence of an external theta-frequency input. Interestingly, these results were achieved by tuning specifically the inhibitory weights in the network, while all other models (including ours) rely on plasticity in the recurrent excitatory synapses. Their model produced forward replay of sequences by default; however, sequences could be reversed by the activation of a distinct, dedicated class of interneurons.</p><p>To our best knowledge, ours is the first model that autonomously generates SWRs and replay in a spiking network model using synaptic weights established via the experimentally observed symmetric STDP rule. The model of <xref ref-type="bibr" rid="bib46">Haga and Fukai, 2018</xref> used symmetric STDP (in combination with short-term plasticity) to modify an existing (pre-wired) weight structure, and showed that these changes biased evoked activity sequences towards reverse replay. Neither spontaneous sharp waves nor ripple oscillations were observed in this model.</p><p>We believe that our approach of fitting the parameters of our single-cell models directly to experimental data to mimic the physiological spiking behavior of real PCs and PVBCs is also quite unique. This enabled our models of PCs to capture spike frequency adaptation, which proved to be essential for the generation of propagating activity (sequence replay) despite the essentially symmetric nature of synaptic interactions.</p></sec><sec id="s3-5"><title>Conclusions</title><p>At a more general level, our results highlight the significance of some previously neglected interactions between three fundamental components of brain function: population dynamics, coding, and plasticity. Specifically, the different types of population dynamics (including oscillations and transients such as sharp waves) are mostly seen as a background over which coding and plasticity occur, while the impacts of plasticity and especially neural representations on the generation of population activity patterns are rarely considered. However, our results strongly suggest that the structured network interactions resulting from activity-dependent learning (or development) lead to specific spatio-temporal activity patterns (such as autonomously generated replay sequences), which are in turn critical for the emergence of physiological population activity (such as sharp waves and ripple oscillations). Therefore, our study indicates that the complex structure of synaptic interactions in neuronal networks may have a hitherto unappreciated degree of control over the general mode of activity in the network and should be taken into account by future theories and models of population activity patterns in any part of the nervous system.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><p>In order to investigate the mechanisms underlying hippocampal network dynamics and how these are affected by learning, we built a simplified network model of area CA3. This scaled-down version of CA3 contained 8000 PCs and 150 PVBCs, which is approximately equivalent to cell numbers in area CA3 in a 600-µm-thick hippocampal slice based on our previous estimates (<xref ref-type="bibr" rid="bib97">Schlingloff et al., 2014</xref>), which are also in good agreement with other estimates (<xref ref-type="bibr" rid="bib4">Bezaire and Soltesz, 2013</xref>; <xref ref-type="bibr" rid="bib22">Donoso et al., 2018</xref>; <xref ref-type="bibr" rid="bib29">Evangelista et al., 2020</xref>). The connection probability was estimated to be 25% for PVBCs (<xref ref-type="bibr" rid="bib97">Schlingloff et al., 2014</xref>) and 10% for PCs (Table 3), and was independent of distance in the model. Half of the PCs were assumed to have place fields on the simulated 3-m-long linear track.</p><p>Only PCs received external input; during exploration, they were activated directly to model place-associated firing; otherwise, they received synaptic input (through the mossy fibers) in the form of uncorrelated Poisson spike trains with a mean rate of 15 Hz. As the hallmark of granule cell activity in the dentate gyrus is sparse, low-frequency firing (<xref ref-type="bibr" rid="bib55">Jung and McNaughton, 1993</xref>; <xref ref-type="bibr" rid="bib98">Skaggs et al., 1996</xref>), and each CA3 PC is contacted by only a few mossy fibers, the physiological mean rate of mossy fiber input to PCs is probably substantially lower (especially in offline states of the hippocampus). On the other hand, real CA3 PCs also receive direct input from the entorhinal cortex, and also spontaneous EPSPs from a large population of recurrent collateral synapses. Overall, these other numerous, but small-amplitude inputs may be responsible for most of the depolarization required to bring CA3 PCs close to their firing threshold, in which case mossy fiber input at a significantly lower rate would be sufficient to evoke the same number of action potentials in CA3 PCs.</p><p>Network simulations were run in Brian2 (<xref ref-type="bibr" rid="bib101">Stimberg et al., 2019</xref>). Learning of the structure of recurrent excitation, single-cell and network optimization, and the analysis of the network simulations are detailed in the following sections. A comprehensive list of assumptions made during the model building process is presented in <xref ref-type="table" rid="table1">Table 1</xref>.</p><sec id="s4-1"><title>Spike trains during exploration</title><p>Spike trains mimicking CA3 PC activity during exploration were generated with exponentially distributed interspike intervals (ISIs) with mean <inline-formula><mml:math id="inf2"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:math></inline-formula>, giving rise to Poisson processes. Spike trains of nonplace cells had constant mean firing rates of <inline-formula><mml:math id="inf3"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> Hz. For the spike trains of the randomly selected 4000 place cells, homogeneous Poisson processes with <inline-formula><mml:math id="inf4"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula> Hz were generated, and spike times were accept-reject sampled with acceptance probability coming from place cell-like tuning curves (Equation (2)), which led to inhomogeneous Poisson processes with time-dependent rate <inline-formula><mml:math id="inf5"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Tuning curves were modeled as Gaussians centered at randomly distributed positions and standard deviation (<inline-formula><mml:math id="inf6"><mml:mi>σ</mml:mi></mml:math></inline-formula>) set to cover 10% of the 3-m-long linear track (Equation (1)). Edges of the place fields were defined where the firing rate dropped to 10% of the maximal 20 Hz (<xref ref-type="bibr" rid="bib23">Dragoi and Buzsáki, 2006</xref>). Tuning curves were also modulated in time by the background <inline-formula><mml:math id="inf7"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:math></inline-formula> Hz theta activity, and phase precessed up to 180° at the beginning of the place field (<xref ref-type="bibr" rid="bib87">O’Keefe and Recce, 1993</xref>). The firing rate of the <inline-formula><mml:math id="inf8"><mml:mi>i</mml:mi></mml:math></inline-formula>th place cell was calculated as follows:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo maxsize="160%" minsize="160%">(</mml:mo><mml:mfrac><mml:mrow><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>F</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo maxsize="160%" minsize="160%">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo maxsize="160%" minsize="160%">(</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mfrac><mml:mi>π</mml:mi><mml:msup><mml:mi>l</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>F</mml:mi></mml:mrow></mml:msup></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="120%" minsize="120%">(</mml:mo><mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>F</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo maxsize="120%" minsize="120%">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo maxsize="160%" minsize="160%">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf9"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the spatial tuning curve of the <inline-formula><mml:math id="inf10"><mml:mi>i</mml:mi></mml:math></inline-formula>th neuron, <inline-formula><mml:math id="inf11"><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the position of the animal, <inline-formula><mml:math id="inf12"><mml:msubsup><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>F</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="inf13"><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>F</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula> m, and <inline-formula><mml:math id="inf14"><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>F</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> are the middle, length, and start of the given place field, respectively; <inline-formula><mml:math id="inf15"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula> Hz is the maximum in-field firing rate.</p><p>Spikes within a 5 ms refractory period of the previous spike were always rejected. The speed of the animal was set to 32.5 cm/s, thus each run took ∼9.2 s, after which the animal was immediately ‘teleported back’ to the start of the linear track. Generated spike trains were 400 s long, leading to ∼43 repetitions on the same linear track.</p></sec><sec id="s4-2"><title>Learning via STDP</title><p>STDP was implemented by an additive pair-based learning rule, evaluated at spike arrivals (<xref ref-type="bibr" rid="bib59">Kempter et al., 1999</xref>; <xref ref-type="bibr" rid="bib41">Gerstner et al., 2014</xref>). Synaptic weights evolved as follows:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mfrac><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:mtext> at </mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mtext> if </mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mfrac><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:mtext> at </mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mtext> if </mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf16"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the time difference between action potentials, and <inline-formula><mml:math id="inf17"><mml:msub><mml:mi>A</mml:mi><mml:mo>±</mml:mo></mml:msub></mml:math></inline-formula> describes the weight update, which decayed exponentially with time constants <inline-formula><mml:math id="inf18"><mml:msub><mml:mi>τ</mml:mi><mml:mo>±</mml:mo></mml:msub></mml:math></inline-formula>. Synaptic weights were cropped at <inline-formula><mml:math id="inf19"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula> nS. To reproduce the broad STDP curve presented in <xref ref-type="bibr" rid="bib75">Mishra et al., 2016</xref>, <inline-formula><mml:math id="inf20"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mo>±</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mn>62.5</mml:mn></mml:mrow></mml:math></inline-formula> ms was used. In the classical asymmetric STDP rules, <inline-formula><mml:math id="inf21"><mml:msub><mml:mi>A</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula> is positive, while <inline-formula><mml:math id="inf22"><mml:msub><mml:mi>A</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula> is negative; here, both of them were set to 80 pA to obtain a symmetric STDP curve (<xref ref-type="bibr" rid="bib75">Mishra et al., 2016</xref>). In simulations using the asymmetric STDP rule, <inline-formula><mml:math id="inf23"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mo>±</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula> ms, <inline-formula><mml:math id="inf24"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mn>400</mml:mn></mml:mrow></mml:math></inline-formula> pA, <inline-formula><mml:math id="inf25"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mo>-</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>400</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> pA, and <inline-formula><mml:math id="inf26"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>40</mml:mn></mml:mrow></mml:math></inline-formula> nS were used. In both cases, PCs were sparsely connected (Table 3) and weights were initialized to 0.1 nS. In the learning phase, the intrinsic dynamics of the PCs were not modeled explicitly since only the timing of their spikes mattered, which was set directly as described above. No self-connections were allowed, and diagonal elements of the learned recurrent weight matrix were always set to zero after any modification.</p></sec><sec id="s4-3"><title>In vitro electrophysiology</title><p>Somatic whole-cell patch-clamp recordings were performed in acute hippocampal slices as described before (<xref ref-type="bibr" rid="bib88">Papp et al., 2013</xref>; <xref ref-type="bibr" rid="bib97">Schlingloff et al., 2014</xref>; <xref ref-type="bibr" rid="bib60">Kohus et al., 2016</xref>). PCs were recorded in the CA3 PC layer of juvenile control mice, while PVBCs were recorded in a targeted manner in transgenic mice that expressed enhanced green fluorescent protein controlled by the parvalbumin promoter (BAC-PV-eGFP) (<xref ref-type="bibr" rid="bib74">Meyer et al., 2002</xref>). To characterize the physiological response properties of the neurons, hyperpolarizing and depolarizing current steps of various amplitudes were injected into the soma, and the voltage response of the cell was recorded. Injected current pulses had a duration of 800 ms, and amplitudes between –100 and 600 pA. Experimental traces were corrected for the theoretical liquid junction potential before further use.</p></sec><sec id="s4-4"><title>Single-cell models</title><p>Neurons were modeled with the AdExpIF model (<xref ref-type="bibr" rid="bib79">Naud et al., 2008</xref>; <xref ref-type="bibr" rid="bib41">Gerstner et al., 2014</xref>). AdExpIF neurons are described by their membrane potential <inline-formula><mml:math id="inf27"><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and the adaptation variable <inline-formula><mml:math id="inf28"><mml:mrow><mml:mi>w</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which obey<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mo maxsize="160%" minsize="160%">(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo maxsize="160%" minsize="160%">(</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo maxsize="160%" minsize="160%">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo maxsize="160%" minsize="160%">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>w</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf29"><mml:msub><mml:mi>C</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> is the membrane capacitance, <inline-formula><mml:math id="inf30"><mml:msub><mml:mi>g</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula> is the leak conductance, <inline-formula><mml:math id="inf31"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the reversal potential of the linear leak current (which is approximately equal to the resting potential), <inline-formula><mml:math id="inf32"><mml:mi>ϑ</mml:mi></mml:math></inline-formula> is the intrinsic spike threshold, <inline-formula><mml:math id="inf33"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> characterizes the ‘sharpness’ of the threshold, <inline-formula><mml:math id="inf34"><mml:mrow><mml:mi>w</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the adaptation current, and <inline-formula><mml:math id="inf35"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the synaptic current (see below). When <inline-formula><mml:math id="inf36"><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> crosses the firing threshold <inline-formula><mml:math id="inf37"><mml:mi>θ</mml:mi></mml:math></inline-formula>, it is reset to <inline-formula><mml:math id="inf38"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and remains there for a refractory period <inline-formula><mml:math id="inf39"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. The adaptation current is also increased by a factor <inline-formula><mml:math id="inf40"><mml:mi>b</mml:mi></mml:math></inline-formula> at each spike arrival. The parameter <inline-formula><mml:math id="inf41"><mml:mi>a</mml:mi></mml:math></inline-formula> describes the strength of subthreshold adaptation.</p><p>To investigate the role of adaptation, an ExpIF PC model was also fit to the data. The ExpIF model is the same as Equation (5) without the <inline-formula><mml:math id="inf42"><mml:mrow><mml:mi>w</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> adaptation current (implemented as an AdExpIF model with parameters <inline-formula><mml:math id="inf43"><mml:mi>a</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf44"><mml:mi>b</mml:mi></mml:math></inline-formula> set identically to zero). The parameters of all models were fit to experimental data from our somatic whole-cell recordings, and the voltage responses to current injections of four different amplitudes (including two subthreshold and two suprathreshold stimuli) were used in each case. Parameters were tuned using the Optimizer package (<xref ref-type="bibr" rid="bib35">Friedrich et al., 2014</xref>) with the NEST simulator as backend (<xref ref-type="bibr" rid="bib104">van Albada et al., 2015</xref>). Spike count, ISI distribution, latency to first spike, and mean squared error (excluding spikes) were used as equally weighted features. After comparing different optimization techniques, the final parameters presented here were obtained with an evolutionary algorithm implemented by the inspyred package (<xref ref-type="bibr" rid="bib38">Garrett, 2012</xref>), running for 100 generations with a population size of 100. The parameters that yield the best models for the CA3 populations are summarized in <xref ref-type="table" rid="table2">Table 2</xref>.</p><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>Optimized parameters of pyramidal cell (PC) (AdExpIF and ExpIF) and parvalbumin-containing basket cell (PVBC) models.</title><p>Physical dimensions are as follows: <inline-formula><mml:math id="inf45"><mml:msub><mml:mi>C</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula>: pF; <inline-formula><mml:math id="inf46"><mml:msub><mml:mi>g</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf47"><mml:mi>a</mml:mi></mml:math></inline-formula>: nS; <inline-formula><mml:math id="inf48"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf49"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf50"><mml:mi>ϑ</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf51"><mml:mi>θ</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf52"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>: mV; <inline-formula><mml:math id="inf53"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf54"><mml:msub><mml:mi>τ</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math></inline-formula>: ms; <inline-formula><mml:math id="inf55"><mml:mi>b</mml:mi></mml:math></inline-formula>: pA.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"/><th align="left" valign="bottom"><inline-formula><mml:math id="inf56"><mml:msub><mml:mi mathsize="90%">C</mml:mi><mml:mi mathsize="90%">m</mml:mi></mml:msub></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf57"><mml:msub><mml:mi mathsize="90%">g</mml:mi><mml:mi mathsize="90%">L</mml:mi></mml:msub></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf58"><mml:msub><mml:mi mathsize="90%">V</mml:mi><mml:mrow><mml:mi mathsize="90%">r</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">e</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">s</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf59"><mml:mrow><mml:mi mathsize="90%" mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">T</mml:mi></mml:mrow></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf60"><mml:mi mathsize="90%">ϑ</mml:mi></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf61"><mml:mi mathsize="90%">θ</mml:mi></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf62"><mml:msub><mml:mi mathsize="90%">V</mml:mi><mml:mrow><mml:mi mathsize="90%">r</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">e</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">s</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">e</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf63"><mml:msub><mml:mi mathsize="90%">t</mml:mi><mml:mrow><mml:mi mathsize="90%">r</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">e</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">f</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf64"><mml:msub><mml:mi mathsize="90%">τ</mml:mi><mml:mi mathsize="90%">w</mml:mi></mml:msub></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf65"><mml:mi mathsize="90%">a</mml:mi></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf66"><mml:mi mathsize="90%">b</mml:mi></mml:math></inline-formula></th></tr></thead><tbody><tr><td align="left" valign="bottom">PC</td><td align="char" char="." valign="bottom">180.13</td><td align="char" char="." valign="bottom">4.31</td><td align="char" char="." valign="bottom">–75.19</td><td align="char" char="." valign="bottom">4.23</td><td align="char" char="." valign="bottom">–24.42</td><td align="char" char="." valign="bottom">–3.25</td><td align="char" char="." valign="bottom">–29.74</td><td align="char" char="." valign="bottom">5.96</td><td align="char" char="." valign="bottom">84.93</td><td align="char" char="." valign="bottom">–0.27</td><td align="char" char="." valign="bottom">206.84</td></tr><tr><td align="left" valign="bottom">PC</td><td align="char" char="." valign="bottom">344.18</td><td align="char" char="." valign="bottom">4.88</td><td align="char" char="." valign="bottom">–75.19</td><td align="char" char="." valign="bottom">10.78</td><td align="char" char="." valign="bottom">–28.77</td><td align="char" char="." valign="bottom">25.13</td><td align="char" char="." valign="bottom">–58.82</td><td align="char" char="." valign="bottom">1.07</td><td align="left" valign="bottom">-</td><td align="left" valign="bottom">-</td><td align="left" valign="bottom">-</td></tr><tr><td align="left" valign="bottom">PVBC</td><td align="char" char="." valign="bottom">118.52</td><td align="char" char="." valign="bottom">7.51</td><td align="char" char="." valign="bottom">–74.74</td><td align="char" char="." valign="bottom">4.58</td><td align="char" char="." valign="bottom">–57.71</td><td align="char" char="." valign="bottom">–34.78</td><td align="char" char="." valign="bottom">–64.99</td><td align="char" char="." valign="bottom">1.15</td><td align="char" char="." valign="bottom">178.58</td><td align="char" char="." valign="bottom">3.05</td><td align="char" char="." valign="bottom">0.91</td></tr></tbody></table></table-wrap></sec><sec id="s4-5"><title>Synapse models</title><p>Synapses were modeled as conductances with biexponential kinetics:<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="160%" minsize="160%">(</mml:mo><mml:mrow><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mi>t</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mfrac></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mi>t</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mfrac></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo maxsize="160%" minsize="160%">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf67"><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> is the peak conductance (which will also be referred to as the synaptic weight) and <inline-formula><mml:math id="inf68"><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf69"><mml:msub><mml:mi>τ</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math></inline-formula> are rise and decay time constants, respectively. The normalization constant <inline-formula><mml:math id="inf70"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>τ</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mfrac></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mfrac></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> was chosen such that the synapses reach their peak conductance at <inline-formula><mml:math id="inf71"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> ms. Kinetic parameters were taken from the literature (<xref ref-type="bibr" rid="bib39">Geiger et al., 1997</xref>; <xref ref-type="bibr" rid="bib3">Bartos et al., 2002</xref>; <xref ref-type="bibr" rid="bib64">Lee et al., 2014</xref>; <xref ref-type="bibr" rid="bib107">Vyleta et al., 2016</xref>; <xref ref-type="bibr" rid="bib45">Guzman et al., 2016</xref>) and are summarized in <xref ref-type="table" rid="table3">Table 3</xref>. The postsynaptic current contained AMPA receptor- and GABA-A receptor-mediated components, and was computed as<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf72"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> mV and <inline-formula><mml:math id="inf73"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>70</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> mV are the reversal potentials of excitatory and inhibitory currents, respectively.</p><table-wrap id="table3" position="float"><label>Table 3.</label><caption><title>Synaptic parameters (taken from the literature or optimized).</title><p>Physical dimensions are as follows: <inline-formula><mml:math id="inf74"><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>: nS; <inline-formula><mml:math id="inf75"><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf76"><mml:msub><mml:mi>τ</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math></inline-formula>, and <italic>t</italic><sub><italic>d</italic></sub> (synaptic delay): ms; and connection probability <inline-formula><mml:math id="inf77"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is dimensionless. GC stands for the granule cells of the dentate gyrus. (<inline-formula><mml:math id="inf78"><mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mo>→</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> synapses are referred as mossy fibers.) Sym. and asym. indicate maximal conductance parameters obtained for networks trained with the symmetric and the asymmetric spike-timing-dependent plasticity (STDP) kernel, respectively. PC: pyramidal cell; PVBC: parvalbumin-containing basket cell.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2" valign="bottom"/><th align="left" colspan="2" valign="bottom"><inline-formula><mml:math id="inf79"><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf80"><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf81"><mml:msub><mml:mi>τ</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math></inline-formula></th><th align="left" valign="bottom"><italic>t</italic><sub><italic>d</italic></sub></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf82"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></th></tr><tr><th align="left" valign="bottom">Sym.</th><th align="left" valign="bottom">Asym.</th><th align="left" valign="bottom"/><th align="left" valign="bottom"/><th align="left" valign="bottom"/><th align="left" valign="bottom"/></tr></thead><tbody><tr><td align="left" valign="bottom">PC<inline-formula><mml:math id="inf83"><mml:mo>→</mml:mo></mml:math></inline-formula> PC</td><td align="char" char="ndash" valign="bottom">0.1–6.3</td><td align="char" char="ndash" valign="bottom">0–15</td><td align="char" char="." valign="bottom">1.3</td><td align="char" char="." valign="bottom">9.5</td><td align="char" char="." valign="bottom">2.2</td><td align="char" char="." valign="bottom">0.1</td></tr><tr><td align="left" valign="bottom">PC<inline-formula><mml:math id="inf84"><mml:mo>→</mml:mo></mml:math></inline-formula> PVBC</td><td align="char" char="." colspan="2" valign="bottom">0.85</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">4.1</td><td align="char" char="." valign="bottom">0.9</td><td align="char" char="." valign="bottom">0.1</td></tr><tr><td align="left" valign="bottom">PVBC<inline-formula><mml:math id="inf85"><mml:mo>→</mml:mo></mml:math></inline-formula> PC</td><td align="char" char="." colspan="2" valign="bottom">0.65</td><td align="char" char="." valign="bottom">0.3</td><td align="char" char="." valign="bottom">3.3</td><td align="char" char="." valign="bottom">1.1</td><td align="char" char="." valign="bottom">0.25</td></tr><tr><td align="left" valign="bottom">PVBC<inline-formula><mml:math id="inf86"><mml:mo>→</mml:mo></mml:math></inline-formula> PVBC</td><td align="char" char="." colspan="2" valign="bottom">5</td><td align="char" char="." valign="bottom">0.25</td><td align="char" char="." valign="bottom">1.2</td><td align="char" char="." valign="bottom">0.6</td><td align="char" char="." valign="bottom">0.25</td></tr><tr><td align="left" valign="bottom">GC<inline-formula><mml:math id="inf87"><mml:mo>→</mml:mo></mml:math></inline-formula> PC</td><td align="char" char="." valign="bottom">19.15</td><td align="char" char="." valign="bottom">21.5</td><td align="char" char="." valign="bottom">0.65</td><td align="char" char="." valign="bottom">5.4</td><td align="left" valign="bottom">-</td><td align="left" valign="bottom">-</td></tr></tbody></table></table-wrap></sec><sec id="s4-6"><title>Network optimization</title><p>Synaptic weights of the network (five parameters in total) were optimized with an evolutionary algorithm using a custom written evaluator in BluePyOpt (<xref ref-type="bibr" rid="bib105">Van Geit et al., 2016</xref>). The multiobjective fitness function <inline-formula><mml:math id="inf88"><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi></mml:math></inline-formula>, designed specifically for this network, included six separately weighted features (Equation (9)): physiological PC firing rate, no significant gamma oscillation in the PVBC population, significant ripple frequency oscillations in the rates of PC and PVBC populations, as well as high ripple vs. gamma power in the rates of the PC and PVBC populations:<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">[</mml:mo></mml:mrow></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>0.5</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>γ</mml:mi><mml:mi>P</mml:mi><mml:mi>V</mml:mi><mml:mi>B</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>P</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>180</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>20</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>P</mml:mi><mml:mi>V</mml:mi><mml:mi>B</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>180</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>20</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mfrac><mml:mrow><mml:mo>∑</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>P</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>∑</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>γ</mml:mi><mml:mi>P</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:mo>∑</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>P</mml:mi><mml:mi>V</mml:mi><mml:mi>B</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>∑</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>γ</mml:mi><mml:mi>P</mml:mi><mml:mi>V</mml:mi><mml:mi>B</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">]</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf89"><mml:mi>ν</mml:mi></mml:math></inline-formula> is the firing rate; <inline-formula><mml:math id="inf90"><mml:mi>δ</mml:mi></mml:math></inline-formula>(<inline-formula><mml:math id="inf91"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>γ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula><sub>PVBC</sub>) is 1 if no significant gamma oscillation was detected in the PVBC population rate, and 0 otherwise; <inline-formula><mml:math id="inf92"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf93"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>γ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> are significant peaks in the ripple and gamma range (see below) of the PSD of the firing rate, respectively; <inline-formula><mml:math id="inf94"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf95"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mi>γ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are the periodogram values within the gamma and ripple bands of the firing rate, respectively, while the sums represent the total power within the relevant frequency bands (as below). Ripple/gamma power ratios used for the optimization were clipped to fall into [0, 5]. As in the case of the network simulations (see above), spectral features were extracted only in those time windows when the PC firing rate exceeded the 2 Hz high-activity state detection threshold. Sequence replay was not analyzed during the optimization. Optimizations were run with 50 offspring for 10 generations. Synaptic weights were varied in the [0.1, 5] nS range, except the ‘detonator’ mossy fiber ones that were given a higher [15, 30] nS range (<xref ref-type="bibr" rid="bib49">Henze et al., 2002</xref>; <xref ref-type="bibr" rid="bib107">Vyleta et al., 2016</xref>). For the learned recurrent excitatory weights, an additional scaling factor was introduced. All learned weights are presented with this optimized scale factor (0.62 for symmetric and 1.27 for asymmetric STDP rule) taken into account. Final weights are presented in <xref ref-type="table" rid="table3">Table 3</xref>. The ExpIF PC model required much higher synaptic drive to fire at the same frequency as the AdExpIF model, thus the mossy fiber input weight was doubled (38.3 nS) when ExpIF PC models were used.</p></sec><sec id="s4-7"><title>LFP estimate</title><p>An estimate of the LFP was calculated by summing the synaptic currents of a randomly selected subset of <inline-formula><mml:math id="inf96"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>400</mml:mn></mml:mrow></mml:math></inline-formula> PCs (<xref ref-type="bibr" rid="bib71">Mazzoni et al., 2008</xref>). This approach is essentially equivalent to using ‘transmembrane’ currents to calculate the field potential at an arbitrary sampling point <italic>x</italic><sub><italic>e</italic></sub> using volume conduction theory and the forward model (<xref ref-type="bibr" rid="bib26">Einevoll et al., 2013</xref>):<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi><mml:mo>⁢</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mfrac><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf97"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>3.54</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> S/m is the extracellular conductivity and <inline-formula><mml:math id="inf98"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> denotes the transmembrane currents of the <inline-formula><mml:math id="inf99"><mml:mi>n</mml:mi></mml:math></inline-formula>th neuron. There was no attempt to replicate the spatial organization of CA3 PCs, and a uniform <inline-formula><mml:math id="inf100"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> distance from the sampling point was used (note that this choice affects the results only as a constant scaling factor). The resulting signal was low-pass filtered at 500 Hz with a third-order Butterworth filter.</p></sec><sec id="s4-8"><title>Spectral analysis</title><p>Power spectral density (PSD) was estimated by Welch’s method with a Hann window using 512 long segments in case of population rates (sampling frequency = 1 kHz) and 4096 long segments for LFP (see below, sampling frequency = 10 kHz) with 0.5 overlap. If the network showed multiple sequence replays during the 10-s-long simulations (most cases), only the detected high-activity states (see above) were analyzed and averaged to get rid of the high power at ~1.5 Hz, signaling the frequency of sequence replays. In this case, shorter segments (256 and 2048, respectively) were used to estimate the PSD. The significance of peaks in the power spectra in the gamma (30–100 Hz) and ripple (150–220 Hz) bands was evaluated using Fisher’s g-statistic (<xref ref-type="bibr" rid="bib31">Fisher, 1929</xref>) defined as<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>max</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf101"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the periodogram (Welch’s method estimates PSD by averaging periodograms from the short segments) evaluated at <inline-formula><mml:math id="inf102"><mml:mi>k</mml:mi></mml:math></inline-formula> discrete frequencies, <inline-formula><mml:math id="inf103"><mml:mi>N</mml:mi></mml:math></inline-formula> is the length of the periodogram, and <inline-formula><mml:math id="inf104"><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is the total power of the spectrum. The distribution of g-statistics under the null hypothesis (<italic>H</italic><sub>0</sub>) (Gaussian white noise) is given by<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>g</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>§gt;</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>b</mml:mi></mml:munderover><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfrac><mml:mrow><mml:mi>N</mml:mi><mml:mo>!</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>!</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>!</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>k</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf105"><mml:mi>b</mml:mi></mml:math></inline-formula> is the largest integer less than <inline-formula><mml:math id="inf106"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:math></inline-formula>. Large value of <inline-formula><mml:math id="inf107"><mml:mi>g</mml:mi></mml:math></inline-formula> (small p-value) indicates a strong periodic component and leads to the rejection of <italic>H</italic><sub>0</sub>. Alpha level 0.05 was used throughout the study. To characterize nonsignificant oscillations too, gamma and ripple power (defined as the sum in the given frequency band divided by the total power in the 0–500 Hz range) were calculated as well. Time-frequency representations were created by convolving the firing rates (or LFP) with samples of the integral of the Morlet wavelet <inline-formula><mml:math id="inf108"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msup><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>5</mml:mn><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> evaluated at the scales corresponding to the 25–325 Hz band using the pywt package (<xref ref-type="bibr" rid="bib63">Lee et al., 2006</xref>).</p></sec><sec id="s4-9"><title>Replay analysis</title><p>Sequence replay was analyzed with methods used by experimentalists having access to spike times of hundreds of identified neurons (<xref ref-type="bibr" rid="bib81">Olafsdottir et al., 2018</xref>). Firstly, candidate replay events were selected based on the averaged (into 20 ms bins) PC population firing rate crossing the threshold of 2 Hz for at least 260 ms. Secondly, the animal’s position was estimated with a memoryless Bayesian place decoder based on the observed spikes within the selected time windows (<xref ref-type="bibr" rid="bib18">Davidson et al., 2009</xref>; <xref ref-type="bibr" rid="bib57">Karlsson and Frank, 2009</xref>). Only spikes from the <inline-formula><mml:math id="inf109"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>4000</mml:mn></mml:mrow></mml:math></inline-formula> place cells were used. For numerical stability, log likelihoods were calculated:<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <italic>n</italic><sub><italic>i</italic></sub> is the number of spikes of the <inline-formula><mml:math id="inf110"><mml:mi>i</mml:mi></mml:math></inline-formula>th neuron within the <inline-formula><mml:math id="inf111"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>-ms-long, nonoverlapping time bins, and <inline-formula><mml:math id="inf112"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the tuning curve used for spike train generation (Equation (1)). The 3-m-long linear track was binned into 50 intervals, resulting in 6 cm spatial resolution. Thirdly, constant velocity <inline-formula><mml:math id="inf113"><mml:mi>v</mml:mi></mml:math></inline-formula> neural trajectories were detected with a 2D band finding method in the decoded posterior matrix (<xref ref-type="bibr" rid="bib18">Davidson et al., 2009</xref>). For candidate events consisting of <inline-formula><mml:math id="inf114"><mml:mi>n</mml:mi></mml:math></inline-formula> time bins, the average likelihood <inline-formula><mml:math id="inf115"><mml:mi>R</mml:mi></mml:math></inline-formula> that the animal is within distance <inline-formula><mml:math id="inf116"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>18</mml:mn></mml:mrow></mml:math></inline-formula> cm of a particular trajectory is given by<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>≤</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <italic>x</italic><sub>0</sub> is the starting position of the trajectory. <inline-formula><mml:math id="inf117"><mml:mrow><mml:mi>R</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> was maximized using an exhaustive search to test all combinations of <inline-formula><mml:math id="inf118"><mml:mi>v</mml:mi></mml:math></inline-formula> between –18 m/s and 18 m/s in 0.3 ms/s increments (excluding slow trajectories with speed <inline-formula><mml:math id="inf119"><mml:mrow><mml:mi/><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.3</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mn>0.3</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> m/s) and <italic>x</italic><sub>0</sub> between –1.5 m and 4.5 m in 3 cm increments. Lastly, to determine the significance of replay, <inline-formula><mml:math id="inf120"><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> was compared to the best-line fits of 100 posterior probability matrices generated by shuffling the identities of cells included in the candidate event. Only events with <inline-formula><mml:math id="inf121"><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> values exceeding the 95th percentile of their own shuffled distribution were labeled as replay.</p><p>To replicate the step-size analysis of <xref ref-type="bibr" rid="bib90">Pfeiffer and Foster, 2015</xref>, the position of the animal was estimated as a weighted average based on the posterior matrix in each time bin instead of the band finding method. As their control distribution for the skewed step sizes (‘predicted step-size’ distribution) was derived for a 2D arena, it was not directly applicable to our linear track setup. Therefore, we defined the predicted step-size distribution based on the ratio of the length of the replayed path and the duration of the replay event for the SWRs detected in the simulations.</p></sec><sec id="s4-10"><title>Accessibility</title><p>The source code is publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/KaliLab/ca3net">https://github.com/KaliLab/ca3net</ext-link> (copy archived at ,<ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:be7bc5450d9298c0399d5d0255f5071e818c37c3;origin=https://github.com/KaliLab/ca3net;visit=swh:1:snp:dab3aa5ca2492d1f40d08c9b735a2335592cd299;anchor=swh:1:rev:bfeb4fa6c8d07f75778df671cc9500cf0316df51">swh:1:rev:bfeb4fa6c8d07f75778df671cc9500cf0316df51</ext-link>, <xref ref-type="bibr" rid="bib24">Ecker, 2022</xref>).</p></sec></sec></body><back><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Formal analysis, Investigation, Methodology, Software, Visualization, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Data curation, Formal analysis, Investigation, Methodology, Software, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Formal analysis, Investigation, Methodology, Software, Writing – review and editing</p></fn><fn fn-type="con" id="con4"><p>Formal analysis, Investigation, Writing – review and editing</p></fn><fn fn-type="con" id="con5"><p>Investigation, Writing – review and editing</p></fn><fn fn-type="con" id="con6"><p>Data curation, Investigation, Writing – review and editing</p></fn><fn fn-type="con" id="con7"><p>Formal analysis, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con8"><p>Conceptualization, Data curation, Writing – review and editing</p></fn><fn fn-type="con" id="con9"><p>Conceptualization, Funding acquisition, Writing – review and editing</p></fn><fn fn-type="con" id="con10"><p>Conceptualization, Data curation, Writing – review and editing</p></fn><fn fn-type="con" id="con11"><p>Conceptualization, Data curation, Funding acquisition, Investigation, Methodology, Supervision, Writing – original draft, Writing – review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>Experiments were approved by the Committee for the Scientific Ethics of Animal Research (22.1/4027/003/2009) and were performed according to the guidelines of the institutional ethical code and the Hungarian Act of Animal Care and Experimentation. Experiments were performed in acute brain slices; no animal suffering was involved as mice were deeply anaesthetized with isoflurane and decapitated before slice preparation. Data recorded in the context of other studies were used for model fitting, and therefore no additional animals were used for the purpose of this study.</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-71850-transrepform1-v2.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>The source code to build, run and analyze our model is publicly available on GitHub: <ext-link ext-link-type="uri" xlink:href="https://github.com/KaliLab/ca3net">https://github.com/KaliLab/ca3net</ext-link>, (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:be7bc5450d9298c0399d5d0255f5071e818c37c3;origin=https://github.com/KaliLab/ca3net;visit=swh:1:snp:dab3aa5ca2492d1f40d08c9b735a2335592cd299;anchor=swh:1:rev:bfeb4fa6c8d07f75778df671cc9500cf0316df51">swh:1:rev:bfeb4fa6c8d07f75778df671cc9500cf0316df51</ext-link>).</p></sec><ack id="ack"><title>Acknowledgements</title><p>We thank G Buzsáki, D Csordás, G Nyíri, B Ujfalussy, and V Varga for insightful comments on the manuscript, M Stimberg for his help with Brian2, and F Crameri for colormaps.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Andersen</surname><given-names>P</given-names></name><name><surname>Morris</surname><given-names>R</given-names></name><name><surname>Amaral</surname><given-names>D</given-names></name><name><surname>Bliss</surname><given-names>T</given-names></name><name><surname>O’Keefe</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2007">2007</year><source>The Hippocampus Book</source><publisher-name>Oxford University Press</publisher-name><pub-id pub-id-type="doi">10.1093/acprof:oso/9780195100273.001.0001</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Azizi</surname><given-names>AH</given-names></name><name><surname>Wiskott</surname><given-names>L</given-names></name><name><surname>Cheng</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A computational model for preplay in the hippocampus</article-title><source>Frontiers in Computational Neuroscience</source><volume>7</volume><elocation-id>161</elocation-id><pub-id pub-id-type="doi">10.3389/fncom.2013.00161</pub-id><pub-id pub-id-type="pmid">24282402</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bartos</surname><given-names>M</given-names></name><name><surname>Vida</surname><given-names>I</given-names></name><name><surname>Frotscher</surname><given-names>M</given-names></name><name><surname>Meyer</surname><given-names>A</given-names></name><name><surname>Monyer</surname><given-names>H</given-names></name><name><surname>Geiger</surname><given-names>JRP</given-names></name><name><surname>Jonas</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Fast synaptic inhibition promotes synchronized gamma oscillations in hippocampal interneuron networks</article-title><source>PNAS</source><volume>99</volume><fpage>13222</fpage><lpage>13227</lpage><pub-id pub-id-type="doi">10.1073/pnas.192233099</pub-id><pub-id pub-id-type="pmid">12235359</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bezaire</surname><given-names>MJ</given-names></name><name><surname>Soltesz</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Quantitative assessment of CA1 local circuits: knowledge base for interneuron-pyramidal cell connectivity</article-title><source>Hippocampus</source><volume>23</volume><fpage>751</fpage><lpage>785</lpage><pub-id pub-id-type="doi">10.1002/hipo.22141</pub-id><pub-id pub-id-type="pmid">23674373</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bi</surname><given-names>GQ</given-names></name><name><surname>Poo</surname><given-names>MM</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Synaptic modifications in cultured hippocampal neurons: dependence on spike timing, synaptic strength, and postsynaptic cell type</article-title><source>The Journal of Neuroscience</source><volume>18</volume><fpage>10464</fpage><lpage>10472</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.18-24-10464.1998</pub-id><pub-id pub-id-type="pmid">9852584</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bittner</surname><given-names>KC</given-names></name><name><surname>Milstein</surname><given-names>AD</given-names></name><name><surname>Grienberger</surname><given-names>C</given-names></name><name><surname>Romani</surname><given-names>S</given-names></name><name><surname>Magee</surname><given-names>JC</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Behavioral time scale synaptic plasticity underlies CA1 place fields</article-title><source>Science</source><volume>357</volume><fpage>1033</fpage><lpage>1036</lpage><pub-id pub-id-type="doi">10.1126/science.aan3846</pub-id><pub-id pub-id-type="pmid">28883072</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brunel</surname><given-names>N</given-names></name><name><surname>Wang</surname><given-names>XJ</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>What determines the frequency of fast network oscillations with irregular neural discharges? I. Synaptic dynamics and excitation-inhibition balance</article-title><source>Journal of Neurophysiology</source><volume>90</volume><fpage>415</fpage><lpage>430</lpage><pub-id pub-id-type="doi">10.1152/jn.01095.2002</pub-id><pub-id pub-id-type="pmid">12611969</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buzsáki</surname><given-names>G</given-names></name><name><surname>Lai-Wo S.</surname><given-names>L</given-names></name><name><surname>Vanderwolf</surname><given-names>CH</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>Cellular bases of hippocampal EEG in the behaving rat</article-title><source>Brain Research Reviews</source><volume>6</volume><fpage>139</fpage><lpage>171</lpage><pub-id pub-id-type="doi">10.1016/0165-0173(83)90037-1</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>Hippocampal sharp waves: Their origin and significance</article-title><source>Brain Research</source><volume>398</volume><fpage>242</fpage><lpage>252</lpage><pub-id pub-id-type="doi">10.1016/0006-8993(86)91483-6</pub-id><pub-id pub-id-type="pmid">3026567</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>Two-stage model of memory trace formation: A role for “noisy” brain states</article-title><source>Neuroscience</source><volume>31</volume><fpage>551</fpage><lpage>570</lpage><pub-id pub-id-type="doi">10.1016/0306-4522(89)90423-5</pub-id><pub-id pub-id-type="pmid">2687720</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buzsáki</surname><given-names>G</given-names></name><name><surname>Horváth</surname><given-names>Z</given-names></name><name><surname>Urioste</surname><given-names>R</given-names></name><name><surname>Hetke</surname><given-names>J</given-names></name><name><surname>Wise</surname><given-names>K</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>High-frequency network oscillation in the hippocampus</article-title><source>Science</source><volume>256</volume><fpage>1025</fpage><lpage>1027</lpage><pub-id pub-id-type="doi">10.1126/science.1589772</pub-id><pub-id pub-id-type="pmid">1589772</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Hippocampal sharp wave‐ripple: A cognitive biomarker for episodic memory and planning</article-title><source>Hippocampus</source><volume>25</volume><fpage>1073</fpage><lpage>1188</lpage><pub-id pub-id-type="doi">10.1002/hipo.22488</pub-id><pub-id pub-id-type="pmid">26135716</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carr</surname><given-names>MF</given-names></name><name><surname>Jadhav</surname><given-names>SP</given-names></name><name><surname>Frank</surname><given-names>LM</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Hippocampal replay in the awake state: a potential substrate for memory consolidation and retrieval</article-title><source>Nature Neuroscience</source><volume>14</volume><fpage>147</fpage><lpage>153</lpage><pub-id pub-id-type="doi">10.1038/nn.2732</pub-id><pub-id pub-id-type="pmid">21270783</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chenkov</surname><given-names>N</given-names></name><name><surname>Sprekeler</surname><given-names>H</given-names></name><name><surname>Kempter</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Memory replay in balanced recurrent networks</article-title><source>PLOS Computational Biology</source><volume>13</volume><elocation-id>e1005359</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005359</pub-id><pub-id pub-id-type="pmid">28135266</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Colgin</surname><given-names>LL</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Rhythms of the hippocampal network</article-title><source>Nature Reviews. Neuroscience</source><volume>17</volume><fpage>239</fpage><lpage>249</lpage><pub-id pub-id-type="doi">10.1038/nrn.2016.21</pub-id><pub-id pub-id-type="pmid">26961163</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Compte</surname><given-names>A</given-names></name><name><surname>Brunel</surname><given-names>N</given-names></name><name><surname>Goldman-Rakic</surname><given-names>PS</given-names></name><name><surname>Wang</surname><given-names>XJ</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Synaptic mechanisms and network dynamics underlying spatial working memory in a cortical network model</article-title><source>Cerebral Cortex</source><volume>10</volume><fpage>910</fpage><lpage>923</lpage><pub-id pub-id-type="doi">10.1093/cercor/10.9.910</pub-id><pub-id pub-id-type="pmid">10982751</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Csicsvari</surname><given-names>J</given-names></name><name><surname>O’Neill</surname><given-names>J</given-names></name><name><surname>Allen</surname><given-names>K</given-names></name><name><surname>Senior</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Place-selective firing contributes to the reverse-order reactivation of CA1 pyramidal cells during sharp waves in open-field exploration</article-title><source>The European Journal of Neuroscience</source><volume>26</volume><fpage>704</fpage><lpage>716</lpage><pub-id pub-id-type="doi">10.1111/j.1460-9568.2007.05684.x</pub-id><pub-id pub-id-type="pmid">17651429</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davidson</surname><given-names>TJ</given-names></name><name><surname>Kloosterman</surname><given-names>F</given-names></name><name><surname>Wilson</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Hippocampal replay of extended experience</article-title><source>Neuron</source><volume>63</volume><fpage>497</fpage><lpage>507</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2009.07.027</pub-id><pub-id pub-id-type="pmid">19709631</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davoudi</surname><given-names>H</given-names></name><name><surname>Foster</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Acute silencing of hippocampal CA3 reveals a dominant role in place field responses</article-title><source>Nature Neuroscience</source><volume>22</volume><fpage>337</fpage><lpage>342</lpage><pub-id pub-id-type="doi">10.1038/s41593-018-0321-z</pub-id><pub-id pub-id-type="pmid">30664772</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Dayan</surname><given-names>P</given-names></name><name><surname>Abbott</surname><given-names>LF</given-names></name></person-group><year iso-8601-date="2001">2001</year><source>Theoretical Neuroscience</source><publisher-loc>Cambridge, MA, USA</publisher-loc><publisher-name>MIT Press</publisher-name></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Diba</surname><given-names>K</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Forward and reverse hippocampal place-cell sequences during ripples</article-title><source>Nature Neuroscience</source><volume>10</volume><fpage>1241</fpage><lpage>1242</lpage><pub-id pub-id-type="doi">10.1038/nn1961</pub-id><pub-id pub-id-type="pmid">17828259</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Donoso</surname><given-names>JR</given-names></name><name><surname>Schmitz</surname><given-names>D</given-names></name><name><surname>Maier</surname><given-names>N</given-names></name><name><surname>Kempter</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Hippocampal Ripple Oscillations and Inhibition-First Network Models: Frequency Dynamics and Response to GABA Modulators</article-title><source>The Journal of Neuroscience</source><volume>38</volume><fpage>3124</fpage><lpage>3146</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0188-17.2018</pub-id><pub-id pub-id-type="pmid">29453207</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dragoi</surname><given-names>G</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Temporal encoding of place sequences by hippocampal cell assemblies</article-title><source>Neuron</source><volume>50</volume><fpage>145</fpage><lpage>157</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2006.02.023</pub-id><pub-id pub-id-type="pmid">16600862</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Ecker</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>Data-driven network model of CA3 - featuring sequence replay and ripple oscillation.</data-title><version designator="swh:1:rev:bfeb4fa6c8d07f75778df671cc9500cf0316df51">swh:1:rev:bfeb4fa6c8d07f75778df671cc9500cf0316df51</version><source>Software Heritage.</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:be7bc5450d9298c0399d5d0255f5071e818c37c3;origin=https://github.com/KaliLab/ca3net;visit=swh:1:snp:dab3aa5ca2492d1f40d08c9b735a2335592cd299;anchor=swh:1:rev:bfeb4fa6c8d07f75778df671cc9500cf0316df51">https://archive.softwareheritage.org/swh:1:dir:be7bc5450d9298c0399d5d0255f5071e818c37c3;origin=https://github.com/KaliLab/ca3net;visit=swh:1:snp:dab3aa5ca2492d1f40d08c9b735a2335592cd299;anchor=swh:1:rev:bfeb4fa6c8d07f75778df671cc9500cf0316df51</ext-link></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ego-Stengel</surname><given-names>V</given-names></name><name><surname>Wilson</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Disruption of ripple-associated hippocampal activity during rest impairs spatial learning in the rat</article-title><source>Hippocampus</source><volume>20</volume><fpage>1</fpage><lpage>10</lpage><pub-id pub-id-type="doi">10.1002/hipo.20707</pub-id><pub-id pub-id-type="pmid">19816984</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Einevoll</surname><given-names>GT</given-names></name><name><surname>Kayser</surname><given-names>C</given-names></name><name><surname>Logothetis</surname><given-names>NK</given-names></name><name><surname>Panzeri</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Modelling and analysis of local field potentials for studying the function of cortical circuits</article-title><source>Nature Reviews. Neuroscience</source><volume>14</volume><fpage>770</fpage><lpage>785</lpage><pub-id pub-id-type="doi">10.1038/nrn3599</pub-id><pub-id pub-id-type="pmid">24135696</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ellender</surname><given-names>TJ</given-names></name><name><surname>Nissen</surname><given-names>W</given-names></name><name><surname>Colgin</surname><given-names>LL</given-names></name><name><surname>Mann</surname><given-names>EO</given-names></name><name><surname>Paulsen</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Priming of hippocampal population bursts by individual perisomatic-targeting interneurons</article-title><source>The Journal of Neuroscience</source><volume>30</volume><fpage>5979</fpage><lpage>5991</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3962-09.2010</pub-id><pub-id pub-id-type="pmid">20427657</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>English</surname><given-names>DF</given-names></name><name><surname>Peyrache</surname><given-names>A</given-names></name><name><surname>Stark</surname><given-names>E</given-names></name><name><surname>Roux</surname><given-names>L</given-names></name><name><surname>Vallentin</surname><given-names>D</given-names></name><name><surname>Long</surname><given-names>MA</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Excitation and inhibition compete to control spiking during hippocampal ripples: intracellular study in behaving mice</article-title><source>The Journal of Neuroscience</source><volume>34</volume><fpage>16509</fpage><lpage>16517</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2600-14.2014</pub-id><pub-id pub-id-type="pmid">25471587</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Evangelista</surname><given-names>R</given-names></name><name><surname>Cano</surname><given-names>G</given-names></name><name><surname>Cooper</surname><given-names>C</given-names></name><name><surname>Schmitz</surname><given-names>D</given-names></name><name><surname>Maier</surname><given-names>N</given-names></name><name><surname>Kempter</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Generation of Sharp Wave-Ripple Events by Disinhibition</article-title><source>The Journal of Neuroscience</source><volume>40</volume><fpage>7811</fpage><lpage>7836</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2174-19.2020</pub-id><pub-id pub-id-type="pmid">32913107</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fernández-Ruiz</surname><given-names>A</given-names></name><name><surname>Oliva</surname><given-names>A</given-names></name><name><surname>Fermino de Oliveira</surname><given-names>E</given-names></name><name><surname>Rocha-Almeida</surname><given-names>F</given-names></name><name><surname>Tingley</surname><given-names>D</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Long-duration hippocampal sharp wave ripples improve memory</article-title><source>Science</source><volume>364</volume><fpage>1082</fpage><lpage>1086</lpage><pub-id pub-id-type="doi">10.1126/science.aax0758</pub-id><pub-id pub-id-type="pmid">31197012</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fisher</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="1929">1929</year><article-title>Tests of significance in harmonic analysis</article-title><source>Proceedings of the Royal Society of London. Series A, Containing Papers of a Mathematical and Physical Character</source><volume>125</volume><fpage>54</fpage><lpage>59</lpage><pub-id pub-id-type="doi">10.1098/rspa.1929.0151</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foster</surname><given-names>DJ</given-names></name><name><surname>Wilson</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Reverse replay of behavioural sequences in hippocampal place cells during the awake state</article-title><source>Nature</source><volume>440</volume><fpage>680</fpage><lpage>683</lpage><pub-id pub-id-type="doi">10.1038/nature04587</pub-id><pub-id pub-id-type="pmid">16474382</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foster</surname><given-names>DJ</given-names></name><name><surname>Wilson</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Hippocampal theta sequences</article-title><source>Hippocampus</source><volume>17</volume><fpage>1093</fpage><lpage>1099</lpage><pub-id pub-id-type="doi">10.1002/hipo.20345</pub-id><pub-id pub-id-type="pmid">17663452</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foster</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Replay Comes of Age</article-title><source>Annual Review of Neuroscience</source><volume>40</volume><fpage>581</fpage><lpage>602</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-072116-031538</pub-id><pub-id pub-id-type="pmid">28772098</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friedrich</surname><given-names>P</given-names></name><name><surname>Vella</surname><given-names>M</given-names></name><name><surname>Gulyás</surname><given-names>AI</given-names></name><name><surname>Freund</surname><given-names>TF</given-names></name><name><surname>Káli</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A flexible, interactive software tool for fitting the parameters of neuronal models</article-title><source>Frontiers in Neuroinformatics</source><volume>8</volume><elocation-id>63</elocation-id><pub-id pub-id-type="doi">10.3389/fninf.2014.00063</pub-id><pub-id pub-id-type="pmid">25071540</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fuenzalida</surname><given-names>M</given-names></name><name><surname>Chiu</surname><given-names>CQ</given-names></name><name><surname>Chávez</surname><given-names>AE</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Muscarinic Regulation of Spike Timing Dependent Synaptic Plasticity in the Hippocampus</article-title><source>Neuroscience</source><volume>456</volume><fpage>50</fpage><lpage>59</lpage><pub-id pub-id-type="doi">10.1016/j.neuroscience.2020.08.015</pub-id><pub-id pub-id-type="pmid">32828940</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gan</surname><given-names>J</given-names></name><name><surname>Weng</surname><given-names>S-M</given-names></name><name><surname>Pernía-Andrade</surname><given-names>AJ</given-names></name><name><surname>Csicsvari</surname><given-names>J</given-names></name><name><surname>Jonas</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Phase-Locked Inhibition, but Not Excitation, Underlies Hippocampal Ripple Oscillations in Awake Mice In Vivo</article-title><source>Neuron</source><volume>93</volume><fpage>308</fpage><lpage>314</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.12.018</pub-id><pub-id pub-id-type="pmid">28041883</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Garrett</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2012">2012</year><data-title>inspyred, Inspired Intelligence.</data-title><source>GitHub.</source><ext-link ext-link-type="uri" xlink:href="https://github.com/aarongarrett/inspyred">https://github.com/aarongarrett/inspyred</ext-link></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Geiger</surname><given-names>JRP</given-names></name><name><surname>Lübke</surname><given-names>J</given-names></name><name><surname>Roth</surname><given-names>A</given-names></name><name><surname>Frotscher</surname><given-names>M</given-names></name><name><surname>Jonas</surname><given-names>P</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Submillisecond AMPA receptor-mediated signaling at a principal neuron-interneuron synapse</article-title><source>Neuron</source><volume>18</volume><fpage>1009</fpage><lpage>1023</lpage><pub-id pub-id-type="doi">10.1016/s0896-6273(00)80339-6</pub-id><pub-id pub-id-type="pmid">9208867</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Geisler</surname><given-names>C</given-names></name><name><surname>Brunel</surname><given-names>N</given-names></name><name><surname>Wang</surname><given-names>XJ</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Contributions of intrinsic membrane dynamics to fast network oscillations with irregular neuronal discharges</article-title><source>Journal of Neurophysiology</source><volume>94</volume><fpage>4344</fpage><lpage>4361</lpage><pub-id pub-id-type="doi">10.1152/jn.00510.2004</pub-id><pub-id pub-id-type="pmid">16093332</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gerstner</surname><given-names>W</given-names></name><name><surname>Kistler</surname><given-names>WM</given-names></name><name><surname>Naud</surname><given-names>R</given-names></name><name><surname>Paninski</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2014">2014</year><source>Neuronal Dynamics: From Single Neurons to Networks and Models of Cognition</source><publisher-loc>Cambridge</publisher-loc><publisher-name>Cambridge University Press</publisher-name><pub-id pub-id-type="doi">10.1017/CBO9781107447615</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Girardeau</surname><given-names>G</given-names></name><name><surname>Benchenane</surname><given-names>K</given-names></name><name><surname>Wiener</surname><given-names>SI</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name><name><surname>Zugaro</surname><given-names>MB</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Selective suppression of hippocampal ripples impairs spatial memory</article-title><source>Nature Neuroscience</source><volume>12</volume><fpage>1222</fpage><lpage>1223</lpage><pub-id pub-id-type="doi">10.1038/nn.2384</pub-id><pub-id pub-id-type="pmid">19749750</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gulyás</surname><given-names>AI</given-names></name><name><surname>Freund</surname><given-names>TT</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Generation of physiological and pathological high frequency oscillations: the role of perisomatic inhibition in sharp-wave ripple and interictal spike generation</article-title><source>Current Opinion in Neurobiology</source><volume>31</volume><fpage>26</fpage><lpage>32</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2014.07.020</pub-id><pub-id pub-id-type="pmid">25128735</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gupta</surname><given-names>AS</given-names></name><name><surname>van der Meer</surname><given-names>MAA</given-names></name><name><surname>Touretzky</surname><given-names>DS</given-names></name><name><surname>Redish</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Hippocampal replay is not a simple function of experience</article-title><source>Neuron</source><volume>65</volume><fpage>695</fpage><lpage>705</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2010.01.034</pub-id><pub-id pub-id-type="pmid">20223204</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guzman</surname><given-names>SJ</given-names></name><name><surname>Schlögl</surname><given-names>A</given-names></name><name><surname>Frotscher</surname><given-names>M</given-names></name><name><surname>Jonas</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Synaptic mechanisms of pattern completion in the hippocampal CA3 network</article-title><source>Science</source><volume>353</volume><fpage>1117</fpage><lpage>1123</lpage><pub-id pub-id-type="doi">10.1126/science.aaf1836</pub-id><pub-id pub-id-type="pmid">27609885</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haga</surname><given-names>T</given-names></name><name><surname>Fukai</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Recurrent network model for learning goal-directed sequences through reverse replay</article-title><source>eLife</source><volume>7</volume><elocation-id>e34171</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.34171</pub-id><pub-id pub-id-type="pmid">29969098</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hájos</surname><given-names>N</given-names></name><name><surname>Karlócai</surname><given-names>MR</given-names></name><name><surname>Németh</surname><given-names>B</given-names></name><name><surname>Ulbert</surname><given-names>I</given-names></name><name><surname>Monyer</surname><given-names>H</given-names></name><name><surname>Szabó</surname><given-names>G</given-names></name><name><surname>Erdélyi</surname><given-names>F</given-names></name><name><surname>Freund</surname><given-names>TF</given-names></name><name><surname>Gulyás</surname><given-names>AI</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Input-output features of anatomically identified CA3 neurons during hippocampal sharp wave/ripple oscillation in vitro</article-title><source>The Journal of Neuroscience</source><volume>33</volume><fpage>11677</fpage><lpage>11691</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.5729-12.2013</pub-id><pub-id pub-id-type="pmid">23843535</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hasselmo</surname><given-names>ME</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>The role of acetylcholine in learning and memory</article-title><source>Current Opinion in Neurobiology</source><volume>16</volume><fpage>710</fpage><lpage>715</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2006.09.002</pub-id><pub-id pub-id-type="pmid">17011181</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Henze</surname><given-names>DA</given-names></name><name><surname>Wittner</surname><given-names>L</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Single granule cells reliably discharge targets in the hippocampal CA3 network in vivo</article-title><source>Nature Neuroscience</source><volume>5</volume><fpage>790</fpage><lpage>795</lpage><pub-id pub-id-type="doi">10.1038/nn887</pub-id><pub-id pub-id-type="pmid">12118256</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hulse</surname><given-names>BK</given-names></name><name><surname>Moreaux</surname><given-names>LC</given-names></name><name><surname>Lubenov</surname><given-names>EV</given-names></name><name><surname>Siapas</surname><given-names>AG</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Membrane Potential Dynamics of CA1 Pyramidal Neurons during Hippocampal Ripples in Awake Mice</article-title><source>Neuron</source><volume>89</volume><fpage>800</fpage><lpage>813</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.01.014</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Itskov</surname><given-names>V</given-names></name><name><surname>Curto</surname><given-names>C</given-names></name><name><surname>Pastalkova</surname><given-names>E</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Cell assembly sequences arising from spike threshold adaptation keep track of time in the hippocampus</article-title><source>The Journal of Neuroscience</source><volume>31</volume><fpage>2828</fpage><lpage>2834</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3773-10.2011</pub-id><pub-id pub-id-type="pmid">21414904</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jadhav</surname><given-names>SP</given-names></name><name><surname>Kemere</surname><given-names>C</given-names></name><name><surname>German</surname><given-names>PW</given-names></name><name><surname>Frank</surname><given-names>LM</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Awake hippocampal sharp-wave ripples support spatial memory</article-title><source>Science</source><volume>336</volume><fpage>1454</fpage><lpage>1458</lpage><pub-id pub-id-type="doi">10.1126/science.1217230</pub-id><pub-id pub-id-type="pmid">22555434</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jahnke</surname><given-names>S</given-names></name><name><surname>Timme</surname><given-names>M</given-names></name><name><surname>Memmesheimer</surname><given-names>RM</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A Unified Dynamic Model for Learning, Replay, and Sharp-Wave/Ripples</article-title><source>The Journal of Neuroscience</source><volume>35</volume><fpage>16236</fpage><lpage>16258</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3977-14.2015</pub-id><pub-id pub-id-type="pmid">26658873</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jensen</surname><given-names>O</given-names></name><name><surname>Lisman</surname><given-names>JE</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Hippocampal sequence-encoding driven by a cortical multi-item working memory buffer</article-title><source>Trends in Neurosciences</source><volume>28</volume><fpage>67</fpage><lpage>72</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2004.12.001</pub-id><pub-id pub-id-type="pmid">15667928</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jung</surname><given-names>MW</given-names></name><name><surname>McNaughton</surname><given-names>BL</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Spatial selectivity of unit activity in the hippocampal granular layer</article-title><source>Hippocampus</source><volume>3</volume><fpage>165</fpage><lpage>182</lpage><pub-id pub-id-type="doi">10.1002/hipo.450030209</pub-id><pub-id pub-id-type="pmid">8353604</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Káli</surname><given-names>S</given-names></name><name><surname>Dayan</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>The involvement of recurrent connections in area CA3 in establishing the properties of place fields: a model</article-title><source>The Journal of Neuroscience</source><volume>20</volume><fpage>7463</fpage><lpage>7477</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.20-19-07463.2000</pub-id><pub-id pub-id-type="pmid">11007906</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karlsson</surname><given-names>MP</given-names></name><name><surname>Frank</surname><given-names>LM</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Awake replay of remote experiences in the hippocampus</article-title><source>Nature Neuroscience</source><volume>12</volume><fpage>913</fpage><lpage>918</lpage><pub-id pub-id-type="doi">10.1038/nn.2344</pub-id><pub-id pub-id-type="pmid">19525943</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kay</surname><given-names>K</given-names></name><name><surname>Chung</surname><given-names>JE</given-names></name><name><surname>Sosa</surname><given-names>M</given-names></name><name><surname>Schor</surname><given-names>JS</given-names></name><name><surname>Karlsson</surname><given-names>MP</given-names></name><name><surname>Larkin</surname><given-names>MC</given-names></name><name><surname>Liu</surname><given-names>DF</given-names></name><name><surname>Frank</surname><given-names>LM</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Constant Sub-second Cycling between Representations of Possible Futures in the Hippocampus</article-title><source>Cell</source><volume>180</volume><fpage>552</fpage><lpage>567</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2020.01.014</pub-id><pub-id pub-id-type="pmid">32004462</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kempter</surname><given-names>R</given-names></name><name><surname>Gerstner</surname><given-names>W</given-names></name><name><surname>van Hemmen</surname><given-names>JL</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Hebbian learning and spiking neurons</article-title><source>Physical Review E</source><volume>59</volume><fpage>4498</fpage><lpage>4514</lpage><pub-id pub-id-type="doi">10.1103/PhysRevE.59.4498</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kohus</surname><given-names>Z</given-names></name><name><surname>Káli</surname><given-names>S</given-names></name><name><surname>Rovira-Esteban</surname><given-names>L</given-names></name><name><surname>Schlingloff</surname><given-names>D</given-names></name><name><surname>Papp</surname><given-names>O</given-names></name><name><surname>Freund</surname><given-names>TF</given-names></name><name><surname>Hájos</surname><given-names>N</given-names></name><name><surname>Gulyás</surname><given-names>AI</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Properties and dynamics of inhibitory synaptic communication within the CA3 microcircuits of pyramidal cells and interneurons expressing parvalbumin or cholecystokinin</article-title><source>The Journal of Physiology</source><volume>594</volume><fpage>3745</fpage><lpage>3774</lpage><pub-id pub-id-type="doi">10.1113/JP272231</pub-id><pub-id pub-id-type="pmid">27038232</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kudrimoti</surname><given-names>HS</given-names></name><name><surname>Barnes</surname><given-names>CA</given-names></name><name><surname>McNaughton</surname><given-names>BL</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Reactivation of hippocampal cell assemblies: effects of behavioral state, experience, and EEG dynamics</article-title><source>The Journal of Neuroscience</source><volume>19</volume><fpage>4090</fpage><lpage>4101</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.19-10-04090.1999</pub-id><pub-id pub-id-type="pmid">10234037</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>AK</given-names></name><name><surname>Wilson</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Memory of sequential experience in the hippocampus during slow wave sleep</article-title><source>Neuron</source><volume>36</volume><fpage>1183</fpage><lpage>1194</lpage><pub-id pub-id-type="doi">10.1016/s0896-6273(02)01096-6</pub-id><pub-id pub-id-type="pmid">12495631</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>G</given-names></name><name><surname>Wasilewski</surname><given-names>FRG</given-names></name><name><surname>Wohlfahrt</surname><given-names>K</given-names></name><name><surname>O’Leary</surname><given-names>A</given-names></name><name><surname>Nahrsteadt</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2006">2006</year><data-title>PyWavelets - Wavelet Transforms in Python.</data-title><source>GitHub.</source><ext-link ext-link-type="uri" xlink:href="https://github.com/PyWavelets/pywt">https://github.com/PyWavelets/pywt</ext-link></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>SH</given-names></name><name><surname>Marchionni</surname><given-names>I</given-names></name><name><surname>Bezaire</surname><given-names>M</given-names></name><name><surname>Varga</surname><given-names>C</given-names></name><name><surname>Danielson</surname><given-names>N</given-names></name><name><surname>Lovett-Barron</surname><given-names>M</given-names></name><name><surname>Losonczy</surname><given-names>A</given-names></name><name><surname>Soltesz</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Parvalbumin-positive basket cells differentiate among hippocampal pyramidal cells</article-title><source>Neuron</source><volume>82</volume><fpage>1129</fpage><lpage>1144</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.03.034</pub-id><pub-id pub-id-type="pmid">24836505</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levy</surname><given-names>WB</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>A sequence predicting CA3 is a flexible associator that learns and uses context to solve hippocampal-like tasks</article-title><source>Hippocampus</source><volume>6</volume><fpage>579</fpage><lpage>590</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1098-1063(1996)6:6&lt;579::AID-HIPO3&gt;3.0.CO;2-C</pub-id><pub-id pub-id-type="pmid">9034847</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>XG</given-names></name><name><surname>Somogyi</surname><given-names>P</given-names></name><name><surname>Ylinen</surname><given-names>A</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>The hippocampal CA3 network: an in vivo intracellular labeling study</article-title><source>The Journal of Comparative Neurology</source><volume>339</volume><fpage>181</fpage><lpage>208</lpage><pub-id pub-id-type="doi">10.1002/cne.903390204</pub-id><pub-id pub-id-type="pmid">8300905</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lisman</surname><given-names>JE</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Relating hippocampal circuitry to function: recall of memory sequences by reciprocal dentate-CA3 interactions</article-title><source>Neuron</source><volume>22</volume><fpage>233</fpage><lpage>242</lpage><pub-id pub-id-type="doi">10.1016/s0896-6273(00)81085-5</pub-id><pub-id pub-id-type="pmid">10069330</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maier</surname><given-names>N</given-names></name><name><surname>Nimmrich</surname><given-names>V</given-names></name><name><surname>Draguhn</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Cellular and network mechanisms underlying spontaneous sharp wave-ripple complexes in mouse hippocampal slices</article-title><source>The Journal of Physiology</source><volume>550</volume><fpage>873</fpage><lpage>887</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.2003.044602</pub-id><pub-id pub-id-type="pmid">12807984</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Malerba</surname><given-names>P</given-names></name><name><surname>Bazhenov</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Circuit mechanisms of hippocampal reactivation during sleep</article-title><source>Neurobiology of Learning and Memory</source><volume>160</volume><fpage>98</fpage><lpage>107</lpage><pub-id pub-id-type="doi">10.1016/j.nlm.2018.04.018</pub-id><pub-id pub-id-type="pmid">29723670</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marr</surname><given-names>D</given-names></name></person-group><year iso-8601-date="1971">1971</year><article-title>Simple memory: a theory for archicortex</article-title><source>Philosophical Transactions of the Royal Society of London. Series B, Biological Sciences</source><volume>262</volume><fpage>23</fpage><lpage>81</lpage><pub-id pub-id-type="doi">10.1098/rstb.1971.0078</pub-id><pub-id pub-id-type="pmid">4399412</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mazzoni</surname><given-names>A</given-names></name><name><surname>Panzeri</surname><given-names>S</given-names></name><name><surname>Logothetis</surname><given-names>NK</given-names></name><name><surname>Brunel</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Encoding of naturalistic stimuli by local field potential spectra in networks of excitatory and inhibitory neurons</article-title><source>PLOS Computational Biology</source><volume>4</volume><elocation-id>e1000239</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000239</pub-id><pub-id pub-id-type="pmid">19079571</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McNaughton</surname><given-names>BL</given-names></name><name><surname>Morris</surname><given-names>RGM</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Hippocampal synaptic enhancement and information storage within a distributed memory system</article-title><source>Trends in Neurosciences</source><volume>10</volume><fpage>408</fpage><lpage>415</lpage><pub-id pub-id-type="doi">10.1016/0166-2236(87)90011-7</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Memmesheimer</surname><given-names>RM</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Quantitative prediction of intermittent high-frequency oscillations in neural networks with supralinear dendritic interactions</article-title><source>PNAS</source><volume>107</volume><fpage>11092</fpage><lpage>11097</lpage><pub-id pub-id-type="doi">10.1073/pnas.0909615107</pub-id><pub-id pub-id-type="pmid">20511534</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meyer</surname><given-names>AH</given-names></name><name><surname>Katona</surname><given-names>I</given-names></name><name><surname>Blatow</surname><given-names>M</given-names></name><name><surname>Rozov</surname><given-names>A</given-names></name><name><surname>Monyer</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>In vivo labeling of parvalbumin-positive interneurons and analysis of electrical coupling in identified neurons</article-title><source>The Journal of Neuroscience</source><volume>22</volume><fpage>7055</fpage><lpage>7064</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.22-16-07055.2002</pub-id><pub-id pub-id-type="pmid">12177202</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mishra</surname><given-names>RK</given-names></name><name><surname>Kim</surname><given-names>S</given-names></name><name><surname>Guzman</surname><given-names>SJ</given-names></name><name><surname>Jonas</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Symmetric spike timing-dependent plasticity at CA3-CA3 synapses optimizes storage and recall in autoassociative networks</article-title><source>Nature Communications</source><volume>7</volume><elocation-id>11552</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms11552</pub-id><pub-id pub-id-type="pmid">27174042</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mizuseki</surname><given-names>K</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Preconfigured, skewed distribution of firing rates in the hippocampus and entorhinal cortex</article-title><source>Cell Reports</source><volume>4</volume><fpage>1010</fpage><lpage>1021</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2013.07.039</pub-id><pub-id pub-id-type="pmid">23994479</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morris</surname><given-names>RG</given-names></name><name><surname>Garrud</surname><given-names>P</given-names></name><name><surname>Rawlins</surname><given-names>JN</given-names></name><name><surname>O’Keefe</surname><given-names>J</given-names></name></person-group><year iso-8601-date="1982">1982</year><article-title>Place navigation impaired in rats with hippocampal lesions</article-title><source>Nature</source><volume>297</volume><fpage>681</fpage><lpage>683</lpage><pub-id pub-id-type="doi">10.1038/297681a0</pub-id><pub-id pub-id-type="pmid">7088155</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nádasdy</surname><given-names>Z</given-names></name><name><surname>Hirase</surname><given-names>H</given-names></name><name><surname>Czurkó</surname><given-names>A</given-names></name><name><surname>Csicsvari</surname><given-names>J</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Replay and time compression of recurring spike sequences in the hippocampus</article-title><source>The Journal of Neuroscience</source><volume>19</volume><fpage>9497</fpage><lpage>9507</lpage><pub-id pub-id-type="pmid">10531452</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Naud</surname><given-names>R</given-names></name><name><surname>Marcille</surname><given-names>N</given-names></name><name><surname>Clopath</surname><given-names>C</given-names></name><name><surname>Gerstner</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Firing patterns in the adaptive exponential integrate-and-fire model</article-title><source>Biological Cybernetics</source><volume>99</volume><fpage>335</fpage><lpage>347</lpage><pub-id pub-id-type="doi">10.1007/s00422-008-0264-7</pub-id><pub-id pub-id-type="pmid">19011922</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nicola</surname><given-names>W</given-names></name><name><surname>Clopath</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>A diversity of interneurons and Hebbian plasticity facilitate rapid compressible learning in the hippocampus</article-title><source>Nature Neuroscience</source><volume>22</volume><fpage>1168</fpage><lpage>1181</lpage><pub-id pub-id-type="doi">10.1038/s41593-019-0415-2</pub-id><pub-id pub-id-type="pmid">31235906</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Olafsdottir</surname><given-names>HF</given-names></name><name><surname>Bush</surname><given-names>D</given-names></name><name><surname>Barry</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>The Role of Hippocampal Replay in Memory and Planning</article-title><source>Current Biology</source><volume>28</volume><fpage>R37</fpage><lpage>R50</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2017.10.073</pub-id><pub-id pub-id-type="pmid">29316421</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oliva</surname><given-names>A</given-names></name><name><surname>Fernández-Ruiz</surname><given-names>A</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name><name><surname>Berényi</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Role of Hippocampal CA2 Region in Triggering Sharp-Wave Ripples</article-title><source>Neuron</source><volume>91</volume><fpage>1342</fpage><lpage>1355</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.08.008</pub-id><pub-id pub-id-type="pmid">27593179</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oliva</surname><given-names>A</given-names></name><name><surname>Fernández-Ruiz</surname><given-names>A</given-names></name><name><surname>Leroy</surname><given-names>F</given-names></name><name><surname>Siegelbaum</surname><given-names>SA</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Hippocampal CA2 sharp-wave ripples reactivate and promote social memory</article-title><source>Nature</source><volume>587</volume><fpage>264</fpage><lpage>269</lpage><pub-id pub-id-type="doi">10.1038/s41586-020-2758-y</pub-id><pub-id pub-id-type="pmid">32968277</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Omura</surname><given-names>Y</given-names></name><name><surname>Carvalho</surname><given-names>XMM</given-names></name><name><surname>Inokuchi</surname><given-names>K</given-names></name><name><surname>Fukai</surname><given-names>XT</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A Lognormal Recurrent Network Model for Burst Generation during Hippocampal Sharp Waves</article-title><source>The Journal of Neuroscience</source><volume>35</volume><fpage>14585</fpage><lpage>14601</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4944-14.2015</pub-id><pub-id pub-id-type="pmid">26511248</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O’Keefe</surname><given-names>J</given-names></name><name><surname>Dostrovsky</surname><given-names>J</given-names></name></person-group><year iso-8601-date="1971">1971</year><article-title>The hippocampus as a spatial map. Preliminary evidence from unit activity in the freely-moving rat</article-title><source>Brain Research</source><volume>34</volume><fpage>171</fpage><lpage>175</lpage><pub-id pub-id-type="doi">10.1016/0006-8993(71)90358-1</pub-id><pub-id pub-id-type="pmid">5124915</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>O’Keefe</surname><given-names>J</given-names></name><name><surname>Nadel</surname><given-names>L</given-names></name></person-group><year iso-8601-date="1978">1978</year><source>The Hippocampus as a Cognitive Map</source><publisher-name>Oxford University Press</publisher-name></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O’Keefe</surname><given-names>J</given-names></name><name><surname>Recce</surname><given-names>ML</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Phase relationship between hippocampal place units and the EEG theta rhythm</article-title><source>Hippocampus</source><volume>3</volume><fpage>317</fpage><lpage>330</lpage><pub-id pub-id-type="doi">10.1002/hipo.450030307</pub-id><pub-id pub-id-type="pmid">8353611</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Papp</surname><given-names>OI</given-names></name><name><surname>Karlócai</surname><given-names>MR</given-names></name><name><surname>Tóth</surname><given-names>IE</given-names></name><name><surname>Freund</surname><given-names>TF</given-names></name><name><surname>Hájos</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Different input and output properties characterize parvalbumin-positive basket and Axo-axonic cells in the hippocampal CA3 subfield</article-title><source>Hippocampus</source><volume>23</volume><fpage>903</fpage><lpage>918</lpage><pub-id pub-id-type="doi">10.1002/hipo.22147</pub-id><pub-id pub-id-type="pmid">23733415</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pfeiffer</surname><given-names>BE</given-names></name><name><surname>Foster</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Hippocampal place-cell sequences depict future paths to remembered goals</article-title><source>Nature</source><volume>497</volume><fpage>74</fpage><lpage>79</lpage><pub-id pub-id-type="doi">10.1038/nature12112</pub-id><pub-id pub-id-type="pmid">23594744</pub-id></element-citation></ref><ref id="bib90"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pfeiffer</surname><given-names>BE</given-names></name><name><surname>Foster</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>PLACE CELLS. Autoassociative dynamics in the generation of sequences of hippocampal place cells</article-title><source>Science</source><volume>349</volume><fpage>180</fpage><lpage>183</lpage><pub-id pub-id-type="doi">10.1126/science.aaa9633</pub-id><pub-id pub-id-type="pmid">26160946</pub-id></element-citation></ref><ref id="bib91"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Pfeiffer</surname><given-names>BE</given-names></name></person-group><year iso-8601-date="2017">2017</year><source>The Content of Hippocampal Replay.</source><publisher-name>Hippocampus</publisher-name></element-citation></ref><ref id="bib92"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rácz</surname><given-names>A</given-names></name><name><surname>Ponomarenko</surname><given-names>AA</given-names></name><name><surname>Fuchs</surname><given-names>EC</given-names></name><name><surname>Monyer</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Augmented hippocampal ripple oscillations in mice with reduced fast excitation onto parvalbumin-positive cells</article-title><source>The Journal of Neuroscience</source><volume>29</volume><fpage>2563</fpage><lpage>2568</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.5036-08.2009</pub-id><pub-id pub-id-type="pmid">19244531</pub-id></element-citation></ref><ref id="bib93"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramirez-Villegas</surname><given-names>JF</given-names></name><name><surname>Willeke</surname><given-names>KF</given-names></name><name><surname>Logothetis</surname><given-names>NK</given-names></name><name><surname>Besserve</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Dissecting the Synapse- and Frequency-Dependent Network Mechanisms of In Vivo Hippocampal Sharp Wave-Ripples</article-title><source>Neuron</source><volume>100</volume><fpage>1224</fpage><lpage>1240</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2018.09.041</pub-id><pub-id pub-id-type="pmid">30482688</pub-id></element-citation></ref><ref id="bib94"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rolls</surname><given-names>ET</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>A theory of hippocampal function in memory</article-title><source>Hippocampus</source><volume>6</volume><fpage>601</fpage><lpage>620</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1098-1063(1996)6:6&lt;601::AID-HIPO5&gt;3.0.CO;2-J</pub-id><pub-id pub-id-type="pmid">9034849</pub-id></element-citation></ref><ref id="bib95"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Romani</surname><given-names>S</given-names></name><name><surname>Tsodyks</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Short-term plasticity based network model of place cells dynamics</article-title><source>Hippocampus</source><volume>25</volume><fpage>94</fpage><lpage>105</lpage><pub-id pub-id-type="doi">10.1002/hipo.22355</pub-id><pub-id pub-id-type="pmid">25155013</pub-id></element-citation></ref><ref id="bib96"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Samsonovich</surname><given-names>A</given-names></name><name><surname>McNaughton</surname><given-names>BL</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Path integration and cognitive mapping in a continuous attractor neural network model</article-title><source>The Journal of Neuroscience</source><volume>17</volume><fpage>5900</fpage><lpage>5920</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.17-15-05900.1997</pub-id><pub-id pub-id-type="pmid">9221787</pub-id></element-citation></ref><ref id="bib97"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schlingloff</surname><given-names>D</given-names></name><name><surname>Káli</surname><given-names>S</given-names></name><name><surname>Freund</surname><given-names>TF</given-names></name><name><surname>Hájos</surname><given-names>N</given-names></name><name><surname>Gulyás</surname><given-names>AI</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Mechanisms of sharp wave initiation and ripple generation</article-title><source>The Journal of Neuroscience</source><volume>34</volume><fpage>11385</fpage><lpage>11398</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0867-14.2014</pub-id><pub-id pub-id-type="pmid">25143618</pub-id></element-citation></ref><ref id="bib98"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skaggs</surname><given-names>WE</given-names></name><name><surname>McNaughton</surname><given-names>BL</given-names></name><name><surname>Wilson</surname><given-names>MA</given-names></name><name><surname>Barnes</surname><given-names>CA</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Theta phase precession in hippocampal neuronal populations and the compression of temporal sequences</article-title><source>Hippocampus</source><volume>6</volume><fpage>149</fpage><lpage>172</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1098-1063(1996)6:2&lt;149::AID-HIPO6&gt;3.0.CO;2-K</pub-id><pub-id pub-id-type="pmid">8797016</pub-id></element-citation></ref><ref id="bib99"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stark</surname><given-names>E</given-names></name><name><surname>Roux</surname><given-names>L</given-names></name><name><surname>Eichler</surname><given-names>R</given-names></name><name><surname>Senzai</surname><given-names>Y</given-names></name><name><surname>Royer</surname><given-names>S</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Pyramidal cell-interneuron interactions underlie hippocampal ripple oscillations</article-title><source>Neuron</source><volume>83</volume><fpage>467</fpage><lpage>480</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.06.023</pub-id><pub-id pub-id-type="pmid">25033186</pub-id></element-citation></ref><ref id="bib100"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stella</surname><given-names>F</given-names></name><name><surname>Baracskay</surname><given-names>P</given-names></name><name><surname>O’Neill</surname><given-names>J</given-names></name><name><surname>Csicsvari</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Hippocampal Reactivation of Random Trajectories Resembling Brownian Diffusion</article-title><source>Neuron</source><volume>102</volume><fpage>450</fpage><lpage>461</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2019.01.052</pub-id><pub-id pub-id-type="pmid">30819547</pub-id></element-citation></ref><ref id="bib101"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stimberg</surname><given-names>M</given-names></name><name><surname>Brette</surname><given-names>R</given-names></name><name><surname>Goodman</surname><given-names>DF</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Brian 2, an intuitive and efficient neural simulator</article-title><source>eLife</source><volume>8</volume><elocation-id>e47314</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.47314</pub-id><pub-id pub-id-type="pmid">31429824</pub-id></element-citation></ref><ref id="bib102"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taxidis</surname><given-names>J</given-names></name><name><surname>Coombes</surname><given-names>S</given-names></name><name><surname>Mason</surname><given-names>R</given-names></name><name><surname>Owen</surname><given-names>MR</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Modeling sharp wave-ripple complexes through a CA3-CA1 network model with chemical synapses</article-title><source>Hippocampus</source><volume>22</volume><fpage>995</fpage><lpage>1017</lpage><pub-id pub-id-type="doi">10.1002/hipo.20930</pub-id><pub-id pub-id-type="pmid">21452258</pub-id></element-citation></ref><ref id="bib103"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Theodoni</surname><given-names>P</given-names></name><name><surname>Rovira</surname><given-names>B</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Roxin</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Theta-modulation drives the emergence of connectivity patterns underlying replay in a network model of place cells</article-title><source>eLife</source><volume>7</volume><elocation-id>e37388</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.37388</pub-id></element-citation></ref><ref id="bib104"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>van Albada</surname><given-names>S</given-names></name><name><surname>Chindemi</surname><given-names>G</given-names></name><name><surname>Deger</surname><given-names>M</given-names></name><name><surname>Diesmann</surname><given-names>M</given-names></name><name><surname>Djurfeldt</surname><given-names>M</given-names></name><name><surname>Enger</surname><given-names>H</given-names></name><name><surname>Eppler</surname><given-names>JM</given-names></name><name><surname>Gewaltig</surname><given-names>MO</given-names></name><name><surname>Helias</surname><given-names>M</given-names></name><name><surname>Kunkel</surname><given-names>S</given-names></name><name><surname>Morrison</surname><given-names>A</given-names></name><name><surname>Muller</surname><given-names>E</given-names></name><name><surname>Plesser</surname><given-names>HE</given-names></name><name><surname>Schrader</surname><given-names>S</given-names></name><name><surname>Tetzlaff</surname><given-names>T</given-names></name><name><surname>Zaytsev</surname><given-names>YV</given-names></name></person-group><year iso-8601-date="2015">2015</year><source>Nest 2.2.0</source><publisher-name>Zenodo</publisher-name></element-citation></ref><ref id="bib105"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van Geit</surname><given-names>W</given-names></name><name><surname>Gevaert</surname><given-names>M</given-names></name><name><surname>Chindemi</surname><given-names>G</given-names></name><name><surname>Rössert</surname><given-names>C</given-names></name><name><surname>Courcol</surname><given-names>J-D</given-names></name><name><surname>Muller</surname><given-names>EB</given-names></name><name><surname>Schürmann</surname><given-names>F</given-names></name><name><surname>Segev</surname><given-names>I</given-names></name><name><surname>Markram</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>BluePyOpt: Leveraging Open Source Software and Cloud Infrastructure to Optimise Model Parameters in Neuroscience</article-title><source>Frontiers in Neuroinformatics</source><volume>10</volume><elocation-id>17</elocation-id><pub-id pub-id-type="doi">10.3389/fninf.2016.00017</pub-id><pub-id pub-id-type="pmid">27375471</pub-id></element-citation></ref><ref id="bib106"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Varga</surname><given-names>C</given-names></name><name><surname>Golshani</surname><given-names>P</given-names></name><name><surname>Soltesz</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Frequency-invariant temporal ordering of interneuronal discharges during hippocampal oscillations in awake mice</article-title><source>PNAS</source><volume>109</volume><fpage>E2726</fpage><lpage>E2734</lpage><pub-id pub-id-type="doi">10.1073/pnas.1210929109</pub-id><pub-id pub-id-type="pmid">23010933</pub-id></element-citation></ref><ref id="bib107"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vyleta</surname><given-names>NP</given-names></name><name><surname>Borges-Merjane</surname><given-names>C</given-names></name><name><surname>Jonas</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Plasticity-dependent, full detonation at hippocampal mossy fiber-CA3 pyramidal neuron synapses</article-title><source>eLife</source><volume>5</volume><elocation-id>e17977</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.17977</pub-id><pub-id pub-id-type="pmid">27780032</pub-id></element-citation></ref><ref id="bib108"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname><given-names>MA</given-names></name><name><surname>McNaughton</surname><given-names>BL</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Reactivation of hippocampal ensemble memories during sleep</article-title><source>Science</source><volume>265</volume><fpage>676</fpage><lpage>679</lpage><pub-id pub-id-type="doi">10.1126/science.8036517</pub-id><pub-id pub-id-type="pmid">8036517</pub-id></element-citation></ref><ref id="bib109"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ylinen</surname><given-names>A</given-names></name><name><surname>Bragin</surname><given-names>A</given-names></name><name><surname>Nádasdy</surname><given-names>Z</given-names></name><name><surname>Jandó</surname><given-names>G</given-names></name><name><surname>Szabó</surname><given-names>I</given-names></name><name><surname>Sik</surname><given-names>A</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Sharp wave-associated high-frequency oscillation (200 Hz) in the intact hippocampus: network and intracellular mechanisms</article-title><source>The Journal of Neuroscience</source><volume>15</volume><fpage>30</fpage><lpage>46</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.15-01-00030.1995</pub-id><pub-id pub-id-type="pmid">7823136</pub-id></element-citation></ref><ref id="bib110"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>York</surname><given-names>LC</given-names></name><name><surname>van Rossum</surname><given-names>MCW</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Recurrent networks with short term synaptic depression</article-title><source>Journal of Computational Neuroscience</source><volume>27</volume><fpage>607</fpage><lpage>620</lpage><pub-id pub-id-type="doi">10.1007/s10827-009-0172-4</pub-id><pub-id pub-id-type="pmid">19578989</pub-id></element-citation></ref><ref id="bib111"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>K</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Representation of spatial orientation by the intrinsic dynamics of the head-direction cell ensemble: a theory</article-title><source>The Journal of Neuroscience</source><volume>16</volume><fpage>2112</fpage><lpage>2126</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.16-06-02112.1996</pub-id><pub-id pub-id-type="pmid">8604055</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.71850.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Burgess</surname><given-names>Neil</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02jx3x895</institution-id><institution>University College London</institution></institution-wrap><country>United Kingdom</country></aff></contrib></contrib-group><related-object id="sa0ro1" link-type="continued-by" object-id="10.1101/2021.02.18.431868" object-id-type="id" xlink:href="https://sciety.org/articles/activity/10.1101/2021.02.18.431868"/></front-stub><body><p>This manuscript will be of interest to theoretical neuroscientists broadly defined and potentially also to experimentalists investigating the hippocampus. A biologically plausible spiking neural network model of subregion CA3 of the hippocampus is proposed and studied in order to pinpoint the mechanistic sources of sharp wave ripples and replay observed in vivo.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.71850.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Burgess</surname><given-names>Neil</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02jx3x895</institution-id><institution>University College London</institution></institution-wrap><country>United Kingdom</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>McNamee</surname><given-names>Daniel</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00971b260</institution-id><institution>DeepMind</institution></institution-wrap><country>United Kingdom</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Graham</surname><given-names>Bruce</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/045wgfr59</institution-id><institution>University of Stirling</institution></institution-wrap><country>United Kingdom</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="box1"><p>Our editorial process produces two outputs: (i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2021.02.18.431868">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2021.02.18.431868v5">the preprint</ext-link> for the benefit of readers; (ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Hippocampal sharp wave-ripples and the associated sequence replay emerge from structured synaptic interactions in a network model of area CA3&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Laura Colgin as the Senior Editor. The following individuals involved in review of your submission have agreed to reveal their identity: Daniel McNamee (Reviewer #1); Bruce Graham (Reviewer #3).</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>The reviewers agree that this manuscript is worthy of acceptance, but that the authors should be encouraged to further clarify or explain the mechanisms causing ripples and replay, as detailed in their responses below. The main broad issues for consideration are: (1) What causes forward versus backwards replay; (2) The necessity or otherwise for the recurrent connectivity created by the specific STDP rule used in generating replay; (3) The necessity of adaptation in causing replay, when cells might fire only once per event; (4) Whether the contribution of an extra inhibitory neuronal cell type might produce a more accurate model of the duration of SWRs; (5) Whether any explicit experimental predictions can be made.</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>Thank you for the well-written manuscript and also for providing your source code. I had a few queries and suggestions that I hope may be helpful.</p><p>1. What is the functional role of the non-spatial PCs?</p><p>2. It seems that the heavy-tailed step size distribution of Pfeiffer and Foster is replicated (line 160). Can the gaussian step size distribution of diffusive reactivations be induced? (observed during rest, see Stella et al., Neuron, 2019). Furthermore, beyond the bidrectionality of replay, recent experiments have demonstrated that sequential hippocampal reactivations make take on even more exotic forms such as generative cycling (Kay et al., Cell, 2020). It would be interesting to speculate how such flexible dynamism may emerge in this circuit model e.g. based on entorhinal input.</p><p>3: it seems (line 538) that the exploring rodents moved at a constant velocity. If this interpretation is correct, Im wondering if the replay phenomenology is robust to heterogeneous velocities during naturalistic movement (e.g. stop/starts)?</p><p>4: Can the model be successfully deployed in an open box environment?</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>Below is a list of questions and comments in ascending order with respect to the line number. I have marked some with an 'S' to highlight that I find them pretty significant. Some of these points are already made in the Public Review and I allow myself to repeat them here so that they are easier to understand. Apologies if this unduly increases the length of the review.</p><p>l. 95- 96: Could the authors highlight the main characteristics of the connection probabilites in their model? What are their typical numerical values? They are given in Methods, but I think it is nicer to have an idea about them without having to go consult that section.</p><p>(S) Figure 1: How important is it that the STDP kernel is temporally broad (broader than the timescale of a ripple oscillation)?</p><p>l. 110: To which figures does the reference refer to? To Figure 1A or its Supplement? Or is Methods and Figure 1A simultaneously referenced? Then, 'Methods and Figure 1A' would be more appropriate. Please clarify.</p><p>l. 130: Chenkov et al., also use a symmetric learning rule (see their Figure 8) supporting reverse replay, so this part of the manuscript is not novel. The authors should rephrase this part to clarify the point.</p><p>After l. 134: it should be made clearer what the 'spatially and temporally unstructured' external inputs to the network are, and which cells (all? only a fraction?) are receiving them.</p><p>l. 172: At least in CA1, PVBCs fire at the ripple frequency of 200 Hz, see e.g. Ylinen et al., 1995. Is this comparatively low inhibitory population firing rate important for the model?</p><p>l. 178: Are the weights scaled after the initial learning phase, or before? Please clarify this.</p><p>l. 192: The reference should be to Supplementary Figure 3 since there are no spectral measures shown in Supplementary Figure 1.</p><p>(S) l. 195: The main result of Stark et al., 2014 is that interactions between PCs and PVBCs underlie ripple oscillations, and that both cell types are needed for ripples. So citing this reference when saying that ripples start from the PVBC population and then propagate to the pyramidal cells does not seem to be right.</p><p>Figure 3B bottom plot: To which scaling factor does 100% LFP power correspond to?</p><p>l. 222: Did Theodoni et al., show that one needs a symmetric STDP kernel to generate both forward and reverse replay? If so, it would be good to state this explicitly.</p><p>l. 238 ff. Is it important that a 97-3 split is done on the weight matrix? What would happen if, for example, a 50-50 split was done? The choice for the split seems arbitrary and should be better justified.</p><p>(S) l. 251: This reads as if the PC-PC coupling structure 'does everything', i.e. it generates replay but also ripple oscillations. This raises the interesting question whether ripples could in principle also be observed in unstructured networks. Could the authors comment on this (for example, by showing a PC spike raster for Figure 6F, where ripple oscillations seem to be present for large PC weight multipliers)?</p><p>(S) l. 258 ff. There seems to be a dichotomy revealed by the model: the PC-PC connections are crucial, but the ripple oscillation is generated by PVBCs and is only present in the LFP, but not in the PC firing activity- although the model was designed to show ripple oscillations in the PC activity (Equation 9). Is there an easy intuitive reason for why this is the case?</p><p>Figure 7B: It is confusing that the PCs with the highest indices in the rasterplot have the same color (orange) as the BCs in the scheme on top of the figure. Similarly at the top of Figure 2.</p><p>(S) l. 295: Similarly to comment about l. 195, Stark et al., 2014 seem to be cited incorrectly: in that study, driving PVBCs did not result in ripple frequency oscillations in the LFP, see their Figure 5. E and F and 6.</p><p>l. 321-322: This reads like an addition, while it is a summary of the paragraph above. Please consider re-writing to reflect this.</p><p>(S) l. 262: The spike-triggered adaptation must be quite strong because a single PC spikes only once or twice during a given ripple, so the adaptation variable gets only one kick and then decays. This means that either the adaptation starts already at quite a high value or the kick size is large, because otherwise there would be no effect on the membrane voltage. Could the authors comment on this?</p><p>l. 347- 348: What is a stochastically initiated buildup period? Was it described before?</p><p>l. 365: Given that after learning, the distribution of the PC-PC synaptic strengths is also long-tailed, it might well be that the effective connectivity is lower than 10% because only strongly connected cells fire and the rest stays silent. Is this plausible?</p><p>l. 422: Maybe the authors would find the study 'Generation of Sharp Wave-Ripple Events by Disinhibition' (Evangelista et al., J Neurosci 2020) interesting. This study contains a mechanism for the generation of SPW/R events by disinhibition of PCs by a third inhibitory cell population. Here, short-term depression acts on the connection between PVBCs and the third cell population.</p><p>Table 3: The decay time constant for PC-PC synapses is large (more than 5 ms). Is this a realistic value for AMPAergic synapses?</p><p>(S) l. 604/ 620 (and also the section beginning on l. 291): The network was optimized to generate strong ripple-frequency oscillations in both the PC and PVBC population (Equation 9). In Figure 1D, however, it looks as if there was no ripple oscillation in the PC rate, but only in the LFP. Could the authors please clarify this? It would be nice to see a magnification of the spike rasterplot at the top of Figure 1D. I also wonder whether there could be a ripple oscillation present in the spiking activity of PCs shown in Figure 8C. It isn't present in the LFP as shown in Figure 8D, but since the network was optimized to display ripple oscillations in the PC activity (Equation 9) and since there still is bi-directional replay in the model, it might well be that there are still ripple oscillations in the PC population activity, as shown in Figure 3—figure supplement 1 for a different setup. It is also not defined how the population rates for PCs and PVBCs are calculated, but the temporal resolution (for example in Figure 1D middle plot) looks rather low and this might mask fast oscillations. Could the authors comment on this?</p><p>Figure 2, supplement 2: it looks like some fraction of PC and PVBCs is bursting (very small ISIs). Are they important for the network dynamics? Is the adaptation maybe only effective in the bursting PCs? This might be important to gain a better mechanistic understanding of the model.</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>The authors are careful to consider some of the limitations of their simple model. However, their study would certainly be strengthened if some of these and other questions could be addressed. Specific consideration should be given to the following:</p><p>Spike adaptation alone does not result in a match to the experimentally-recorded durations of SWRs, as the authors acknowledge. It would be good at least to see results from the simulations that have been tried using an extra inhibitory neuron type to try to address this mismatch; and other mechanisms also could be explored here.</p><p>What specific spatio-temporal characteristics of spike activity trigger a sequence replay? For example, how sensitive is this to the number of closely associated place cells that spike contemporaneously and does it require some sequencing in this spiking? Is it such initial sequencing that determines whether forward or backward replay occurs?</p><p>As discussed, there are biases towards forward or backward replay in different animal situations. How can such biases arise in this model? The &quot;cued&quot; replay results (Figure 2C) demonstrate the obvious of forward replay if the cue is at the track beginning, with backward replay if the cue is at the end of the track, but how in general may such &quot;beginnings&quot; and &quot;ends&quot; be defined in terms of place cells? The strict beginning and end here is somewhat artificial. How can a bias for forwards or backwards replay be introduced at intermediate points along the track? Insights into the characteristics of spike activity triggering replay, as asked for above, should help answer this.</p><p>Why do we not see simultaneous forward and backward replay from a single trigger point?</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.71850.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>The reviewers agree that this manuscript is worthy of acceptance, but that the authors should be encouraged to further clarify or explain the mechanisms causing ripples and replay, as detailed in their responses below. The main broad issues for consideration are: (1) What causes forward versus backwards replay;</p></disp-quote><p>This question was explored explicitly in the simulations shown in Figure 2C, which demonstrated that one can evoke either forward or backward replay via external input that corresponds to neural activity at the start and the end of the track, respectively. Without any cuing input we find (as expected from the symmetry of the plasticity rule and all other properties of the network) that forward and backward replays occur with the same frequency. At a more general level, the direction of replay in the model can depend on systematic biases and random variations in the weight structure, but also on (random or deterministic) spatio-temporal structure in the external inputs. A more detailed discussion of this issue has been incorporated into the Discussion section of the paper, and also appears in our responses to the reviewers below.</p><disp-quote content-type="editor-comment"><p>2) The necessity or otherwise for the recurrent connectivity created by the specific STDP rule used in generating replay;</p></disp-quote><p>A key finding of our work is that sufficiently strong, properly structured recurrent excitatory connections are essential for several key aspects of network dynamics, including sequence replay, sharp waves, and (indirectly, by causing a high level of PVBC activity) ripple oscillations. In principle, such structured connectivity could be formed by a variety of different mechanisms (as discussed in the section “Biological plausibility of the model”). The plasticity rule that we used in most of our simulations is based on direct measurement of STDP in pairs of CA3 pyramidal neurons in hippocampal slices (Mishra et al., Nature Comms., 2016). To our best knowledge this is the only rule that has been experimentally measured in area CA3. On the other hand, we do investigate the effect of using a different type of STDP rule (one that has been measured in several other types of synapse), and find that this choice leads to altered dynamics and the absence of reverse replay events (Figure 5). Therefore, our results confirm that applying the experimentally determined plasticity rule to activity patterns seen during exploration leads to a pattern of synaptic interactions that gives rise to the correct form of network dynamics (including sharp wave-ripples and bidirectional replay) in off-line states of the hippocampus.</p><disp-quote content-type="editor-comment"><p>3) The necessity of adaptation in causing replay, when cells might fire only once per event;</p></disp-quote><p>In our model, adaptation is necessary for sequence replay as it destabilizes a stationary bump of activity, and causes it to move on to previously inactive populations with nearby place fields. This is clearly demonstrated by Figure 7, which shows that the activity bump remains stationary without adaptation in PCs. On the other hand, spike-triggered adaptation does not need to be dominant in single cells to shift network activity away from the currently active population, and we have confirmed this by looking at synaptic and adaptation currents in some randomly selected neurons. Excitation and inhibition are almost balanced in active cells, and the addition of the adaptation current is sufficient to silence them. By contrast, previously inactive cells with nearby place fields still get strong excitatory input, so that they can start to fire if they were not recently active (and thus have no adaptation current). In addition, the majority of place cells in our model fire more than once during individual sharp waves, although we do not believe this to be essential for the main results of the paper. We have amended the manuscript to clarify this fact, and also added an insert to panel B1 and a new panel C to Supplementary Figure 4.</p><disp-quote content-type="editor-comment"><p>4) Whether the contribution of an extra inhibitory neuronal cell type might produce a more accurate model of the duration of SWRs;</p></disp-quote><p>The mechanisms responsible for the termination of SWRs are currently unknown, and this is also an open question for our current model. Several different mechanisms based on cellular adaptation, short-term synaptic plasticity, and multiple inhibitory cell populations have been proposed. An additional possible mechanism based on the (learned or hard-wired) structure of recurrent excitation is demonstrated in this paper. As we briefly mentioned in the previous version of the manuscript, we also found that adding a second inhibitory population that provides delayed, long-lasting negative feedback to the PCs could explain the termination of SWRs. However, these simulations were performed in an earlier version of the circuit model that lacked learned excitatory connections, and we found that introducing this mechanism in the final model required substantial retuning of several parameters. Therefore, we decided to defer the full exploration of possible SWR termination mechanisms to a subsequent study; we have removed the reference in the manuscript to the preliminary simulation results, and cite related published work (Evangelista et al., J. Neurosci. 2020) to back the proposed idea.</p><disp-quote content-type="editor-comment"><p>5) Whether any explicit experimental predictions can be made.</p></disp-quote><p>Both our concrete mechanistic model and the general conceptual framework suggested by our simulation results can be used to derive novel experimental predictions. In fact, the consequences of all the manipulations that we employed to probe our <italic>in silico</italic> network can be regarded as experimental predictions. Although some of these manipulations (such as shuffling the weights) would be difficult to replicate in real experiments, others are probably feasible using modern tools (cell-type-specific targeting, optogenetics, chemogenetics, etc.). We have listed several specific predictions of our modeling work in a new section of the Discussion (“Experimental predictions”). These predictions include the following:</p><p>– Blocking PVBC-PVBC synaptic interactions should eliminate ripples but not sharp waves or replay, while blocking recurrent excitation is expected to eliminate sharp waves, ripple oscillations and spontaneous replay as well.</p><p>– The nature of replay (e.g., stereotypical vs. diffusive) should depend on the task and behavior during learning (e.g., 1D vs. 2D environment, goal-oriented vs. random foraging task).</p><p>– It should be possible to influence the content of replay by providing structured input either during learning or before/during SWRs.</p><p>– Any manipulation changing the symmetry of the STDP rule should bias the direction of replay.</p><disp-quote content-type="editor-comment"><p>Reviewer #1 (Recommendations for the authors):</p><p>Thank you for the well-written manuscript and also for providing your source code. I had a few queries and suggestions that I hope may be helpful.</p><p>1. What is the functional role of the non-spatial PCs?</p></disp-quote><p>When we constructed the model, we included PCs that do not have place fields in a particular environment to better match the relevant experimental data. This also allowed us to check whether these cells have any functional role in our model; however, we found that (at least in the current, simplified model where cells without place fields fired at low rates during exploration) non-spatial neurons had only weak excitatory interactions with other PCs, and were not significantly involved in the generation of SWRs or replay. On the other hand, when we investigated the effects of learning in multiple environments, place cells were selected independently and randomly; in this case, the presence of non-spatial cells decreased the amount of overlap between representations of the two environments, which may have contributed to the robustness of independent replay of spatial sequences in the two environments (although we have not tested this explicitly).</p><disp-quote content-type="editor-comment"><p>2. It seems that the heavy-tailed step size distribution of Pfeiffer and Foster is replicated (line 160). Can the gaussian step size distribution of diffusive reactivations be induced? (observed during rest, see Stella et al., Neuron, 2019). Furthermore, beyond the bidrectionality of replay, recent experiments have demonstrated that sequential hippocampal reactivations make take on even more exotic forms such as generative cycling (Kay et al., Cell, 2020). It would be interesting to speculate how such flexible dynamism may emerge in this circuit model e.g. based on entorhinal input.</p></disp-quote><p>Thank you for drawing our attention to this interesting issue. In our model, the nature of replayed sequences depends mostly on the activity patterns of hippocampal neurons during exploration (which determine the pattern of recurrent interactions), but it is also influenced by (either sensory-driven or random) input before/during reactivation episodes. In the basic scenario explored in our paper, learning occurred during repeated runs along a single linear track, which led to reactivations consisting of random chunks of the single learned trajectory, and allowed our model to replicate the replay dynamics observed by Pfeiffer and Foster. However, other types of learning experience would be expected to result in different reactivation dynamics. For instance, the random 2D exploration investigated by Stella et al., Neuron, (2019) may be expected to result in a 2D bump attractor structure encoded in the recurrent weights, and this, combined with adaptation and some random noise, may explain the diffusive nature of reactivation in their experiments. Similarly, the learning of alternative routes in the experiments of Kay et al. Cell., (2020), combined with adaptation, may explain the spontaneous switching between representations of alternative future paths. We have included these thoughts in the Discussion (lines 384-403).</p><disp-quote content-type="editor-comment"><p>3: It seems (line 538) that the exploring rodents moved at a constant velocity. If this interpretation is correct, Im wondering if the replay phenomenology is robust to heterogeneous velocities during naturalistic movement (e.g. stop/starts)?</p></disp-quote><p>At an intuitive level, if velocity varies more or less randomly across trials, and the starts and stops occur at different locations in each trial, then replay should be robust given enough repetitions of the same path (the current results are based on more than 40 repetitions), although we have not tested this explicitly. Robustness against variations in speed is also increased by the broad temporal kernel of the STDP rule. On the other hand, if starts and stops occurred at stereotypical locations, our model predicts that these locations would become preferred starting points (or endpoints) of replayed paths. In fact, it would be relatively straightforward to modify the spike patterns used during the exploration phase to model variations in speed.</p><disp-quote content-type="editor-comment"><p>4: Can the model be successfully deployed in an open box environment?</p></disp-quote><p>In principle, exploration in an open box (or any other environment) could be modeled by changing the spike statistics during the learning phase so that it mimics the corresponding experimental observations. All other properties and parameters of the model would remain unchanged. This would also allow us to test whether we can predict the replay dynamics in these novel situations (see above), and we intend to examine this in a follow-up project.</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>Below is a list of questions and comments in ascending order with respect to the line number. I have marked some with an 'S' to highlight that I find them pretty significant. Some of these points are already made in the Public Review and I allow myself to repeat them here so that they are easier to understand. Apologies if this unduly increases the length of the review.</p><p>l. 95- 96: Could the authors highlight the main characteristics of the connection probabilites in their model? What are their typical numerical values? They are given in Methods, but I think it is nicer to have an idea about them without having to go consult that section.</p></disp-quote><p>We decided to list most parameter values in the Methods rather than the Results section so that the Results can remain focused on the main ideas and the new results. More specifically, we do not think that the precise connection probabilities have a major qualitative effect on the behavior of the model, and their biological values are also to some extent uncertain, so we prefer to keep them in the Methods, but added an internal reference (line 97) to the manuscript to facilitate the localization of this information.</p><disp-quote content-type="editor-comment"><p>(S) Figure 1: How important is it that the STDP kernel is temporally broad (broader than the timescale of a ripple oscillation)?</p></disp-quote><p>The exact width of the STDP kernel is probably not critical in our model (its symmetry is more important for our results) although it is likely to influence the exact replay dynamics (e.g., the speed of activity propagation). However, we did not investigate this issue in detail here because the effects of the shape of the STDP kernel of network dynamics were recently analyzed by Theodoni et al., <italic>eLife</italic>, (2017).</p><disp-quote content-type="editor-comment"><p>l. 110: To which figures does the reference refer to? To Figure 1A or its Supplement? Or is Methods and Figure 1A simultaneously referenced? Then, 'Methods and Figure 1A' would be more appropriate. Please clarify.</p></disp-quote><p>We thank the reviewer for drawing our attention to this issue; we have added “and” to this reference in the manuscript (and to all similar cases as well).</p><disp-quote content-type="editor-comment"><p>l. 130: Chenkov et al., also use a symmetric learning rule (see their Figure 8) supporting reverse replay, so this part of the manuscript is not novel. The authors should rephrase this part to clarify the point.</p></disp-quote><p>We first note that Chenkov et al., PLOS, (2017) did not use a learning rule to set up the excitatory recurrent connections. The authors constructed hard-wired chains of assemblies and varied the connection probabilities within and between assemblies (and used inhibitory plasticity to balance the network) As a last experiment they showed that symmetric connections can lead to reverse replay, but only if it is cued (as shown in their Figure 8). We have clarified this point in the manuscript (lines 291-293). Besides, we do not claim to be the first to observe reverse replay with a symmetric learning rule (see e.g., the citation of Haga et al., <italic>eLife</italic>, (2018) in lines 565-568).</p><disp-quote content-type="editor-comment"><p>After l. 134: it should be made clearer what the 'spatially and temporally unstructured' external inputs to the network are, and which cells (all? only a fraction?) are receiving them.</p></disp-quote><p>These inputs represent the spontaneous (random) activation of all synapses onto all CA3 PCs, although, for simplicity, we use only a single type of synapse in the model whose parameters best match those of mossy fiber inputs. We have added a reference to the Methods (where the nature of external inputs is discussed in detail) in line 139 to clarify this point.</p><disp-quote content-type="editor-comment"><p>l. 172: At least in CA1, PVBCs fire at the ripple frequency of 200 Hz, see e.g. Ylinen et al., 1995. Is this comparatively low inhibitory population firing rate important for the model?</p></disp-quote><p>According to more recent publications that recorded the firing activity of identified PVBCs during SWRs, their firing rate is typically substantially less than 200 Hz; e.g., Varga et al., PNAS, (2012) measured 75 Hz in awake mice, and Hájos et al., J. Neurosci., (2013) measured 82 Hz in the CA3 region of the mouse hippocampal slice. These values are in good agreement with our simulation results. Moreover, the exact frequency of PVBC firing is not important in our model; the PVBCs increase their rate, and skip fewer and fewer ripple cycles, as their input is increased.</p><disp-quote content-type="editor-comment"><p>l. 178: Are the weights scaled after the initial learning phase, or before? Please clarify this.</p></disp-quote><p>They are scaled after learning; please see lines 196-197.</p><disp-quote content-type="editor-comment"><p>l. 192: The reference should be to Supplementary Figure 3 since there are no spectral measures shown in Supplementary Figure 1.</p></disp-quote><p>We thank the Reviewer for catching this mistake, resulting from an error in the LaTeX source file. The error has been corrected.</p><disp-quote content-type="editor-comment"><p>(S) l. 195: The main result of Stark et al., 2014 is that interactions between PCs and PVBCs underlie ripple oscillations, and that both cell types are needed for ripples. So citing this reference when saying that ripples start from the PVBC population and then propagate to the pyramidal cells does not seem to be right.</p></disp-quote><p>Stark et al., Neuron, (2014) show that activation of PVBCs induces ripple-frequency coherent spiking of PVBCs and PCs, although this is not detectable in the LFP. They say: “although tonic light activation of PV interneurons cannot induce LFP ripples, it can organize neuronal ensemble spiking into coherent ripple-frequency oscillations, consistent with a modified version of an INT-INT-based timing mechanism (<ext-link ext-link-type="uri" xlink:href="https://www.sciencedirect.com/science/article/pii/S0896627314005455?via%3Dihub#fig1">Figure 1</ext-link>D).”</p><disp-quote content-type="editor-comment"><p>Figure 3B bottom plot: To which scaling factor does 100% LFP power correspond to?</p></disp-quote><p>None – this plot shows the percentage of power in the ripple range relative to the total power of the signal for each multiplier. 100% power is the total power within the whole 0-500 Hz range as explained in the Methods.</p><disp-quote content-type="editor-comment"><p>l. 222: Did Theodoni et al., show that one needs a symmetric STDP kernel to generate both forward and reverse replay? If so, it would be good to state this explicitly.</p></disp-quote><p>No, they did not. We have clarified this in line 239.</p><disp-quote content-type="editor-comment"><p>l. 238 ff. Is it important that a 97-3 split is done on the weight matrix? What would happen if, for example, a 50-50 split was done? The choice for the split seems arbitrary and should be better justified.</p></disp-quote><p>The split is indeed arbitrary. We have tried several splits in the 99-1 and 90-10% range; the results were qualitatively similar, but this one gave the cleanest result. There is definitely a tradeoff between the number (more the better) and strength (the fewer averaged the better) of the near-diagonal synapses, but we did not think that the results were interesting enough to be presented in the article. The important point here is that this is a manipulation of the weight matrix that preserves the global structure but completely changes the weight statistics.</p><disp-quote content-type="editor-comment"><p>(S) l. 251: This reads as if the PC-PC coupling structure 'does everything', i.e. it generates replay but also ripple oscillations. This raises the interesting question whether ripples could in principle also be observed in unstructured networks. Could the authors comment on this (for example, by showing a PC spike raster for Figure 6F, where ripple oscillations seem to be present for large PC weight multipliers)?</p></disp-quote><p>In our baseline model, ripples are indeed strongly tied to replay because PVBCs receive a sufficiently large excitatory drive only during these events (corresponding to sharp waves). Ripples can also be observed in unstructured networks (which lack replay), but only with much (3.5 times) stronger weights. For some additional discussion of this issue, please see our response to point 1 in the Public Review section above.</p><disp-quote content-type="editor-comment"><p>(S) l. 258 ff. There seems to be a dichotomy revealed by the model: the PC-PC connections are crucial, but the ripple oscillation is generated by PVBCs and is only present in the LFP, but not in the PC firing activity- although the model was designed to show ripple oscillations in the PC activity (Equation 9). Is there an easy intuitive reason for why this is the case?</p></disp-quote><p>As we discussed in our response to question 3 in the Public Review section, the second part of the statement above is incorrect (ripples are indeed present in the PC rate as shown in Supplementary Figure 5), which solves the apparent paradox.</p><disp-quote content-type="editor-comment"><p>Figure 7B: It is confusing that the PCs with the highest indices in the rasterplot have the same color (orange) as the BCs in the scheme on top of the figure. Similarly at the top of Figure 2.</p></disp-quote><p>We thank the reviewer for pointing out this issue, and we have changed the color of the PVBCs in all figures.</p><disp-quote content-type="editor-comment"><p>(S) l. 295: Similarly to comment about l. 195, Stark et al., 2014 seem to be cited incorrectly: in that study, driving PVBCs did not result in ripple frequency oscillations in the LFP, see their Figure 5. E and F and 6.</p></disp-quote><p>As we also indicated in our response above, Stark et al., Neuron, (2014) do find that PVBC activation induces coherent ripple-frequency spiking activity (although this is not reflected by the LFP, presumably because of insufficient PC activity). As our argument here is about ripple-frequency synchrony and not the LFP, we think that this citation is appropriate.</p><disp-quote content-type="editor-comment"><p>l. 321-322: This reads like an addition, while it is a summary of the paragraph above. Please consider re-writing to reflect this.</p></disp-quote><p>This sentence (saying that recurrent inhibitory connections are both necessary and sufficient for ripple oscillations) is actually meant to be an addition to (or amendment of) the previous sentence (which is only about sufficiency), while it is also a concise summary of the results presented in this section.</p><disp-quote content-type="editor-comment"><p>(S) l. 262: The spike-triggered adaptation must be quite strong because a single PC spikes only once or twice during a given ripple, so the adaptation variable gets only one kick and then decays. This means that either the adaptation starts already at quite a high value or the kick size is large, because otherwise there would be no effect on the membrane voltage. Could the authors comment on this?</p></disp-quote><p>First, we note that spike-triggered adaptation does not need to be dominant in single cells to shift network activity away from the currently active population, and we have confirmed this by looking at synaptic and adaptation currents in some randomly selected neurons. Excitation and inhibition are almost balanced in active cells, and the addition of the adaptation current is sufficient to silence them. By contrast, previously inactive cells with nearby place fields still get strong excitatory input (plus slightly less inhibitory input), so that they can start to fire if they were not recently active (and thus have no adaptation current). In addition, the majority of place cells in our model fire more than once during individual sharp waves. We have amended the manuscript to clarify this fact in lines 188-191 and also added an insert to panel B1 and a new panel C to Supplementary Figure 4.</p><disp-quote content-type="editor-comment"><p>l. 347- 348: What is a stochastically initiated buildup period? Was it described before?</p></disp-quote><p>The stochastic initiation of SWRs was described and discussed extensively by Schlingloff et al., J. Neurosci., (2014). We have now added this citation to this point of the manuscript in line 366.</p><disp-quote content-type="editor-comment"><p>l. 365: Given that after learning, the distribution of the PC-PC synaptic strengths is also long-tailed, it might well be that the effective connectivity is lower than 10% because only strongly connected cells fire and the rest stays silent. Is this plausible?</p></disp-quote><p>We first note that there is no special population of strongly connected place cells in the model, and most place cells participate in replay events (although there are differences due to random variations of spiking activity in the learning phase). On the other hand, it is true that most PCs have a small number of (incoming and outgoing) large weights and many smaller ones, and many of the anatomically existing connections may be too weak to be reliably detected in paired recording experiments. We have added this point to the manuscript in lines 453-455.</p><disp-quote content-type="editor-comment"><p>l. 422: Maybe the authors would find the study 'Generation of Sharp Wave-Ripple Events by Disinhibition' (Evangelista et al., J Neurosci 2020) interesting. This study contains a mechanism for the generation of SPW/R events by disinhibition of PCs by a third inhibitory cell population. Here, short-term depression acts on the connection between PVBCs and the third cell population.</p></disp-quote><p>We thank the Reviewer for drawing our attention to this interesting paper. A proper exploration of all possible termination mechanisms is a major task that we have postponed to a follow-up study. For now, we have removed the reference to our preliminary results, and added a citation to the article mentioned by the Reviewer in lines 510-516.</p><disp-quote content-type="editor-comment"><p>Table 3: The decay time constant for PC-PC synapses is large (more than 5 ms). Is this a realistic value for AMPAergic synapses?</p></disp-quote><p>Yes, this value is not just realistic, but it was determined experimentally for these connections by Guzman et al., Science, (2016).</p><disp-quote content-type="editor-comment"><p>(S) l. 604/ 620 (and also the section beginning on l. 291): The network was optimized to generate strong ripple-frequency oscillations in both the PC and PVBC population (Equation 9). In Figure 1D, however, it looks as if there was no ripple oscillation in the PC rate, but only in the LFP. Could the authors please clarify this? It would be nice to see a magnification of the spike rasterplot at the top of Figure 1D. I also wonder whether there could be a ripple oscillation present in the spiking activity of PCs shown in Figure 8C. It isn't present in the LFP as shown in Figure 8D, but since the network was optimized to display ripple oscillations in the PC activity (Equation 9) and since there still is bi-directional replay in the model, it might well be that there are still ripple oscillations in the PC population activity, as shown in Figure 3—figure supplement 1 for a different setup. It is also not defined how the population rates for PCs and PVBCs are calculated, but the temporal resolution (for example in Figure 1D middle plot) looks rather low and this might mask fast oscillations. Could the authors comment on this?</p></disp-quote><p>Ripples are present in the PC rate as shown in Supplementary Figure 5 (please also refer to our earlier responses). The population rate is calculated in 1 ms-long time windows as described in Methods line 724. On the other hand, plots showing the long-term population rate (such as the middle plot of Figure 1D) use a lower temporal resolution of 10 ms. The Reviewer is right that one cannot judge the presence or absence of ripple frequency oscillation from these plots, but we intended those panels to show the overall increase in PC population rate during sequence replay. On the other hand, Supplementary Figure 5 explicitly documents the presence of ripple oscillations in PC spiking activity.</p><disp-quote content-type="editor-comment"><p>Figure 2, supplement 2: it looks like some fraction of PC and PVBCs is bursting (very small ISIs). Are they important for the network dynamics? Is the adaptation maybe only effective in the bursting PCs? This might be important to gain a better mechanistic understanding of the model.</p></disp-quote><p>We have added panel C to Supplementary Figure 4, which shows that the low ISI values in PCs are due to some place cells firing more than once during a sharp wave (see the voltage trace of the second place cell). To further clarify this point, we have added an insert to panel B1 as well, showing that the lowest PC ISIs are above 5 ms (in fact, 5.96 ms is their refractory period (see Table 2)). Therefore, PCs in our model do not burst according to the usual definition (ISIs below 5 ms), but some of them do fire more than once during a sharp wave. As we argued above, we do not think that these multiple spikes are critical for the qualitative behavior of the network model. In principle, one could re-optimize the whole network with an extra feature controlling the number of PC spikes to judge how important this feature is, but we have not done so in the interest of time. However, we have added lines 186-191 to the results stating that this is a potential difference between the current model and the available data.</p><disp-quote content-type="editor-comment"><p>Reviewer #3 (Recommendations for the authors):</p><p>The authors are careful to consider some of the limitations of their simple model. However, their study would certainly be strengthened if some of these and other questions could be addressed. Specific consideration should be given to the following:</p><p>Spike adaptation alone does not result in a match to the experimentally-recorded durations of SWRs, as the authors acknowledge. It would be good at least to see results from the simulations that have been tried using an extra inhibitory neuron type to try to address this mismatch; and other mechanisms also could be explored here.</p></disp-quote><p>The mechanisms responsible for the termination of SWRs are currently unknown, and this is also an open question for our current model. Several different mechanisms based on cellular adaptation, short-term synaptic plasticity, and multiple inhibitory cell populations have been proposed. An additional possible mechanism based on the (learned or hard-wired) structure of recurrent excitation is demonstrated in this paper. As we briefly mentioned in the previous version of the manuscript, we also found that adding a second inhibitory population that provides delayed, long-lasting negative feedback to the PCs could explain the termination of SWRs. However, these simulations were performed in an earlier version of the circuit model that lacked learned excitatory connections, and we found that introducing this mechanism in the final model required substantial retuning of several parameters. Therefore, we decided to defer the full exploration of possible SWR termination mechanisms to a subsequent study; we have removed the reference in the manuscript to the preliminary simulation results, and cite some related published work (Evangelista et al., J. Neurosci. 2020) to back the proposed idea.</p><disp-quote content-type="editor-comment"><p>What specific spatio-temporal characteristics of spike activity trigger a sequence replay? For example, how sensitive is this to the number of closely associated place cells that spike contemporaneously and does it require some sequencing in this spiking?</p></disp-quote><p>This is an excellent question but, unfortunately, we do not know the answer yet. Simple observation of the spike rasters reveals no obvious pattern. One might guess that some combination of activity noise (stochastic activation of neurons) and “frozen noise” (randomness in connectivity and synaptic weights) determines where replay starts and the direction it takes (in the absence of external bias). However, it will require more sophisticated analysis methods or clever manipulations of inputs and weights to find a definite answer.</p><disp-quote content-type="editor-comment"><p>Is it such initial sequencing that determines whether forward or backward replay occurs?</p><p>As discussed, there are biases towards forward or backward replay in different animal situations. How can such biases arise in this model? The &quot;cued&quot; replay results (Figure 2C) demonstrate the obvious of forward replay if the cue is at the track beginning, with backward replay if the cue is at the end of the track, but how in general may such &quot;beginnings&quot; and &quot;ends&quot; be defined in terms of place cells? The strict beginning and end here is somewhat artificial. How can a bias for forwards or backwards replay be introduced at intermediate points along the track? Insights into the characteristics of spike activity triggering replay, as asked for above, should help answer this.</p></disp-quote><p>In general, the direction of replay in the model can depend on systematic biases and random variations in the weight structure, but also on (random or deterministic) spatio-temporal structure in the external inputs. We believe that the cued replay scenario that we simulated is not entirely artificial – even real environments may contain choice points where the animal pauses to plan its route, or reward sites that again make the animal stop and may also activate subcortical modulatory systems that affect plasticity. At intermediate sites, systematic bias could be introduced during exploration by factors that influence behavior (e.g., running speed), neuronal activity or plasticity (e.g., attention), especially if such factors can change the fully symmetric nature of the synaptic plasticity rule. Random variations in connectivity or the weights (e.g., due to stochastic spiking during learning) will lead to a location-dependent systematic bias towards forward or reverse replay. Finally, (randomly occurring or input-driven) sequences in the external input are also expected to bias the direction of replay even at intermediate points. However, a detailed analysis of the relative impact of these factors will require further efforts. We have included some of these arguments in lines 404-427 of the Discussion.</p><disp-quote content-type="editor-comment"><p>Why do we not see simultaneous forward and backward replay from a single trigger point?</p></disp-quote><p>In fact, we do see some evidence of replay starting in both directions in the model in certain cases (please refer to the first and second detected replays in Figure 2A). However, there is competition between the two active populations (mediated by feedback inhibition), and one of the sequences always dies out after a short period (this is also because mutual support through recurrent excitation diminishes as the two active populations move further away from each other). This is similar to the competitive behavior of other “bump attractor” models. We have included these arguments in lines 159-164.</p></body></sub-article></article>