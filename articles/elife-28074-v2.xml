<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">28074</article-id><article-id pub-id-type="doi">10.7554/eLife.28074</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>A unified internal model theory to resolve the paradox of active versus passive self-motion sensation</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-66060"><name><surname>Laurens</surname><given-names>Jean</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9101-2802</contrib-id><email>jean.laurens@gmail.com</email><xref ref-type="aff" rid="aff1"/><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-55289"><name><surname>Angelaki</surname><given-names>Dora E</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9650-8962</contrib-id><email>angelaki@bcm.edu</email><xref ref-type="aff" rid="aff1"/><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><institution content-type="dept">Department of Neuroscience</institution><institution>Baylor College of Medicine</institution><addr-line><named-content content-type="city">Houston</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor" id="author-78611"><name><surname>Glasauer</surname><given-names>Stefan</given-names></name><role>Reviewing Editor</role><aff><institution>Ludwig-Maximilian University of Munich</institution><country>Germany</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>18</day><month>10</month><year>2017</year></pub-date><pub-date pub-type="collection"><year>2017</year></pub-date><volume>6</volume><elocation-id>e28074</elocation-id><history><date date-type="received" iso-8601-date="2017-04-25"><day>25</day><month>04</month><year>2017</year></date><date date-type="accepted" iso-8601-date="2017-10-11"><day>11</day><month>10</month><year>2017</year></date></history><permissions><copyright-statement>© 2017, Laurens et al</copyright-statement><copyright-year>2017</copyright-year><copyright-holder>Laurens et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-28074-v2.pdf"/><related-object ext-link-type="url" xlink:href="https://elifesciences.org/articles/e28074v1"><date date-type="v1" iso-8601-date="2017-10-18"><day>18</day><month>10</month><year>2017</year></date></related-object><abstract><object-id pub-id-type="doi">10.7554/eLife.28074.001</object-id><p>Brainstem and cerebellar neurons implement an internal model to accurately estimate self-motion during externally generated (‘passive’) movements. However, these neurons show reduced responses during self-generated (‘active’) movements, indicating that predicted sensory consequences of motor commands cancel sensory signals. Remarkably, the computational processes underlying sensory prediction during active motion and their relationship to internal model computations during passive movements remain unknown. We construct a Kalman filter that incorporates motor commands into a previously established model of optimal passive self-motion estimation. The simulated sensory error and feedback signals match experimentally measured neuronal responses during active and passive head and trunk rotations and translations. We conclude that a single sensory internal model can combine motor commands with vestibular and proprioceptive signals optimally. Thus, although neurons carrying sensory prediction error or feedback signals show attenuated modulation, the sensory cues and internal model are both engaged and critically important for accurate self-motion estimation during active head movements.</p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.28074.002</object-id><title>eLife digest</title><p>When seated in a car, we can detect when the vehicle begins to move even with our eyes closed. Structures in the inner ear called the vestibular, or balance, organs enable us to sense our own movement. They do this by detecting head rotations, accelerations and gravity. They then pass this information on to specialized vestibular regions of the brain.</p><p>Experiments using rotating chairs and moving platforms have shown that passive movements – such as car journeys and rollercoaster rides – activate the brain’s vestibular regions. But recent work has revealed that voluntary movements – in which individuals start the movement themselves – activate these regions far less than passive movements. Does this mean that the brain ignores signals from the inner ear during voluntary movements? Another possibility is that the brain predicts in advance how each movement will affect the vestibular organs in the inner ear. It then compares these predictions with the signals it receives during the movement. Only mismatches between the two activate the brain’s vestibular regions.</p><p>To test this theory, Laurens and Angelaki created a mathematical model that compares predicted signals with actual signals in the way the theory proposes. The model accurately predicts the patterns of brain activity seen during both active and passive movement. This reconciles the results of previous experiments on active and passive motion. It also suggests that the brain uses similar processes to analyze vestibular signals during both types of movement.</p><p>These findings can help drive further research into how the brain uses sensory signals to refine our everyday movements. They can also help us understand how people recover from damage to the vestibular system. Most patients with vestibular injuries learn to walk again, but have difficulty walking on uneven ground. They also become disoriented by passive movement. Using the model to study how the brain adapts to loss of vestibular input could lead to new strategies to aid recovery.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>bayesian</kwd><kwd>vestibular</kwd><kwd>efference copy</kwd><kwd>vestibular nucleus</kwd><kwd>cerebellum</kwd><kwd>internal model</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000055</institution-id><institution>National Institute on Deafness and Other Communication Disorders</institution></institution-wrap></funding-source><award-id>NIH R01DC004260</award-id><principal-award-recipient><name><surname>Laurens</surname><given-names>Jean</given-names></name><name><surname>Angelaki</surname><given-names>Dora E</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Central vestibular regions in the brainstem and cerebellum perform dynamic Bayesian inference to combine motor commands and sensory signals into an optimal estimate of self-motion.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>For many decades, research on vestibular function has used passive motion stimuli generated by rotating chairs, motion platforms or centrifuges to characterize the responses of the vestibular motion sensors in the inner ear and the subsequent stages of neuronal processing. This research has revealed elegant computations by which the brain uses an internal model to overcome the dynamic limitations and ambiguities of the vestibular sensors (<xref ref-type="fig" rid="fig1">Figure 1A</xref>; <xref ref-type="bibr" rid="bib70">Mayne, 1974</xref>; <xref ref-type="bibr" rid="bib79">Oman, 1982</xref>; <xref ref-type="bibr" rid="bib14">Borah et al., 1988</xref>; <xref ref-type="bibr" rid="bib36">Glasauer, 1992</xref>; <xref ref-type="bibr" rid="bib76">Merfeld, 1995</xref>; <xref ref-type="bibr" rid="bib35">Glasauer and Merfeld, 1997</xref>; <xref ref-type="bibr" rid="bib15">Bos et al., 2001</xref>; <xref ref-type="bibr" rid="bib112">Zupan et al., 2002</xref>; <xref ref-type="bibr" rid="bib62">Laurens, 2006</xref>; <xref ref-type="bibr" rid="bib55">Laurens and Droulez, 2007</xref>; <xref ref-type="bibr" rid="bib56">Laurens and Droulez, 2008</xref>; <xref ref-type="bibr" rid="bib53">Laurens and Angelaki, 2011</xref>; <xref ref-type="bibr" rid="bib48">Karmali and Merfeld, 2012</xref>; <xref ref-type="bibr" rid="bib65">Lim et al., 2017</xref>). These computations are closely related to internal model mechanisms that underlie motor control and adaptation (<xref ref-type="bibr" rid="bib106">Wolpert et al., 1995</xref>; <xref ref-type="bibr" rid="bib52">Körding and Wolpert, 2004</xref>; <xref ref-type="bibr" rid="bib100">Todorov, 2004</xref>; <xref ref-type="bibr" rid="bib24">Chen-Harris et al., 2008</xref>; <xref ref-type="bibr" rid="bib11">Berniker et al., 2010</xref>; <xref ref-type="bibr" rid="bib10">Berniker and Kording, 2011</xref>; <xref ref-type="bibr" rid="bib31">Franklin and Wolpert, 2011</xref>; <xref ref-type="bibr" rid="bib90">Saglam et al., 2011</xref>; <xref ref-type="bibr" rid="bib91">2014</xref>). Neuronal correlates of the internal model of self-motion have been identified in brainstem and cerebellum (<xref ref-type="bibr" rid="bib8">Angelaki et al., 2004</xref>; <xref ref-type="bibr" rid="bib93">Shaikh et al., 2005</xref>; <xref ref-type="bibr" rid="bib109">Yakusheva et al., 2007</xref>, <xref ref-type="bibr" rid="bib107">2008</xref>, <xref ref-type="bibr" rid="bib108">2013</xref>, <xref ref-type="bibr" rid="bib58">Laurens et al., 2013a</xref>, <xref ref-type="bibr" rid="bib59">2013b</xref>).</p><fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.28074.003</object-id><label>Figure 1.</label><caption><title>Internal model computations for self-motion estimation.</title><p>(<bold>A</bold>) Previous studies based on passive stimuli have proposed that vestibular sensory signals are processed by an internal model to compute optimal estimates of self-motion. (<bold>B</bold>) Other studies (<xref ref-type="bibr" rid="bib88">Roy and Cullen, 2004</xref>) have shown that the cancellation of central vestibular responses during active motion is gated by mismatches between predicted and actual neck proprioceptive signals, and interpreted central vestibular responses as a passive motion signal. (<bold>C</bold>) Brooks and Cullen (<xref ref-type="bibr" rid="bib18">Brooks et al., 2015</xref>; <xref ref-type="bibr" rid="bib20">Brooks and Cullen, 2013</xref>) have proposed that an internal model processes motor commands to compute sensory predictions during active motion and that central vestibular neurons encode sensory prediction errors. (<bold>D</bold>) Framework proposed in this study, in which the internal models in (<bold>A</bold>) and (<bold>C</bold>) are in fact identical and interactions between head motion commands and sensory signals are modeled as a Kalman filter (blue) that computes optimal self-motion estimates during both passive and active motions. For simplicity, we have not included how head motion commands are generated (red), how head movements are executed, as well as the contribution of feedback to error correction and motor learning (dashed blue arrow). In line with B, the proprioceptive gating mechanism in D is shown as a switch controlling the transmission of head motion commands to the Kalman filter. Solid lines in (<bold>D</bold>): computations modeled as a Kalman filter. Broken lines in (<bold>D</bold>): additional computations that are only discussed (but not modeled) in the present study. Note that the ‘self-motion signal’ box in D stands for both the predicted motion and final self-motion estimate (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>).</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-28074-fig1-v2"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.28074.004</object-id><label>Figure 1—figure supplement 1.</label><caption><title>Alternative computational schemes where separate internal models process vestibular signals and motor commands.</title><p>(<bold>A</bold>) Sensory signals may be switched off during active motion. This model will be refuted by simulations in <xref ref-type="fig" rid="fig8">Figure 8</xref>. (<bold>B,C</bold>) Alternatively, the output of the ‘internal model processing motor commands’ (whose nature and properties have never been defined in all previous publications by Cullen and colleagues) may be subtracted from the output (<bold>B</bold>) or the input (<bold>C</bold>) of the sensory internal model. In (<bold>B</bold>), sensory signals would be transformed into head motion signals before being cancelled by a predicted self-motion signal, which implies that central vestibular neurons would encode a motion prediction error (equal to the passive component of head motion), instead of a sensory prediction error. We refute this possibility in <xref ref-type="fig" rid="fig9">Figure 9</xref>. In (<bold>C</bold>), the processing is similar to the Kalman filter. This is because, as demonstrated in this study, the transformation of motor commands into predicted sensory signals <italic>requires</italic> the same sensory internal model that processes vestibular signals during passive motion, and we collapse these computations into a single internal model in <xref ref-type="fig" rid="fig1">Figure 1D</xref>. Note that the Kalman filter could be transformed into the model in panel (<bold>B</bold>) by (unnecessarily) duplicating this single internal model. We discuss these alternative possibilities in Results: ‘Alternative models of interaction between active and passive motions’.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-28074-fig1-figsupp1-v2"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.28074.005</object-id><label>Figure 1—figure supplement 2.</label><caption><title>Generic structure of a Kalman Filter.</title><p>(<bold>A</bold>) Equations of the Kalman filter algorithm describing how motor commands and sensory signals are processed for optimal state estimation. Motion variables (<inline-formula><mml:math id="inf1"><mml:mi>X</mml:mi></mml:math></inline-formula>) are computed as a function of motor commands <inline-formula><mml:math id="inf2"><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and unpredictable perturbations <inline-formula><mml:math id="inf3"><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>. Matrices <inline-formula><mml:math id="inf4"><mml:mi>D</mml:mi></mml:math></inline-formula>,<inline-formula><mml:math id="inf5"> <mml:mi/><mml:mi>M</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf6"><mml:mi>E</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf7"><mml:mi>T</mml:mi></mml:math></inline-formula> encode the system’s dynamics. Sensory inputs <inline-formula><mml:math id="inf8"><mml:mi>S</mml:mi></mml:math></inline-formula> are computed as a function of <inline-formula><mml:math id="inf9"><mml:mi>X</mml:mi></mml:math></inline-formula> and sensory noise, <inline-formula><mml:math id="inf10"><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>. (<bold>B</bold>) Schematic implementing the equations of the Kalman filter algorithm. An internal estimate of motion variables (internal states, <inline-formula><mml:math id="inf11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>) is computed dynamically as a function of <inline-formula><mml:math id="inf12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, motor commands <inline-formula><mml:math id="inf13"><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> and sensory signals <inline-formula><mml:math id="inf14"><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>. The dashed arrows indicate that the estimate at time <inline-formula><mml:math id="inf15"><mml:mi>t</mml:mi></mml:math></inline-formula> is passed to the next time step, where it becomes the estimate at <inline-formula><mml:math id="inf16"><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>. Sensory errors <inline-formula><mml:math id="inf17"><mml:mi>δ</mml:mi><mml:mi>S</mml:mi></mml:math></inline-formula> are transformed into feedback <inline-formula><mml:math id="inf18"><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>K</mml:mi><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>S</mml:mi></mml:math></inline-formula>, where <inline-formula><mml:math id="inf19"><mml:mi>K</mml:mi></mml:math></inline-formula> is a matrix of feedback gains, whose rank is determined by the dimensionality of both the state variable <inline-formula><mml:math id="inf20"><mml:mi>X</mml:mi></mml:math></inline-formula> and the sensory signals <inline-formula><mml:math id="inf21"><mml:mi>S</mml:mi></mml:math></inline-formula>. The box defined by dashed gray lines illustrates the Kalman filter computations.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-28074-fig1-figsupp2-v2"/></fig></fig-group><p>In the past decade, a few research groups have also studied how brainstem and cerebellar neurons modulate during active, self-generated head movements. Strikingly, several types of neurons, well-known for responding to vestibular stimuli during passive movement, lose or reduce their sensitivity during self-generated movement (<xref ref-type="bibr" rid="bib33">Gdowski et al., 2000</xref>; <xref ref-type="bibr" rid="bib34">Gdowski and McCrea, 1999</xref>; <xref ref-type="bibr" rid="bib69">Marlinski and McCrea, 2009</xref>; <xref ref-type="bibr" rid="bib71">McCrea et al., 1999</xref>; <xref ref-type="bibr" rid="bib72">McCrea and Luan, 2003</xref>; <xref ref-type="bibr" rid="bib87">Roy and Cullen, 2001</xref>; <xref ref-type="bibr" rid="bib88">2004</xref>; <xref ref-type="bibr" rid="bib19">Brooks and Cullen, 2009</xref>; <xref ref-type="bibr" rid="bib20">2013</xref>; <xref ref-type="bibr" rid="bib21">2014</xref>; <xref ref-type="bibr" rid="bib18">Brooks et al., 2015</xref>; <xref ref-type="bibr" rid="bib22">Carriot et al., 2013</xref>). In contrast, vestibular afferents respond indiscriminately for active and passive stimuli (<xref ref-type="bibr" rid="bib27">Cullen and Minor, 2002</xref>; <xref ref-type="bibr" rid="bib89">Sadeghi et al., 2007</xref>; <xref ref-type="bibr" rid="bib45">Jamali et al., 2009</xref>). These properties resemble sensory prediction errors in other sensorimotor functions such as fish electrosensation (<xref ref-type="bibr" rid="bib83">Requarth and Sawtell, 2011</xref>; <xref ref-type="bibr" rid="bib49">Kennedy et al., 2014</xref>) and motor control (<xref ref-type="bibr" rid="bib101">Tseng et al., 2007</xref>; <xref ref-type="bibr" rid="bib92">Shadmehr et al., 2010</xref>). Yet, a consistent quantitative take-home message has been lacking. Initial experiments and reviews implicated proprioceptive switches (<xref ref-type="fig" rid="fig1">Figure 1B</xref>; <xref ref-type="bibr" rid="bib88">Roy and Cullen, 2004</xref>; <xref ref-type="bibr" rid="bib26">Cullen et al., 2011</xref>; <xref ref-type="bibr" rid="bib28">Cullen, 2012</xref>; <xref ref-type="bibr" rid="bib22">Carriot et al., 2013</xref>; <xref ref-type="bibr" rid="bib21">Brooks and Cullen, 2014</xref>). More recently, elegant experiments by Brooks and colleagues (<xref ref-type="bibr" rid="bib20">Brooks and Cullen, 2013</xref>; <xref ref-type="bibr" rid="bib18">Brooks et al., 2015</xref>) started making the suggestion that the brain predicts how self-generated motion activates the vestibular organs and subtracts these predictions from afferent signals to generate sensory prediction errors (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). However, the computational processes underlying this sensory prediction have remained unclear.</p><p>Confronting the findings of studies utilizing passive and active motion stimuli leads to a paradox, in which central vestibular neurons encode self-motion signals computed by feeding vestibular signals through an internal model during passive motion (<xref ref-type="fig" rid="fig1">Figure 1A</xref>), but during active motion, efference copies of motor commands, also transformed by an internal model (<xref ref-type="fig" rid="fig1">Figure 1C</xref>), attenuate the responses of the same neurons. Thus, a highly influential interpretation is that the elaborate internal model characterized with passive stimuli would only be useful in situations that involve unexpected (passive) movements but would be unused during normal activities, because either its input or its output (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>) would be suppressed during active movement. Here, we propose an alternative that the internal model that processes vestibular signals (<xref ref-type="fig" rid="fig1">Figure 1A</xref>) and the internal model that generates sensory predictions during active motion (<xref ref-type="fig" rid="fig1">Figure 1C</xref>) are identical. In support of this theory, we show that the processing of motor commands must involve an internal model of the physical properties of the vestibular sensors, identical to the computations described during passive motion, otherwise accurate self-motion estimation would be severely compromised during actively generated movements.</p><p>The essence of the theory developed previously for passive movements is that the brain uses an internal representation of the laws of physics and sensory dynamics (which has been elegantly modeled as forward internal models of the sensors) to process vestibular signals. In contrast, although it is understood that transforming head motor commands into sensory predictions is likely to also involve internal models, no explicit mathematical implementation has ever been proposed for explaining the response attenuation in central vestibular areas. A survey of the many studies by Cullen and colleagues even questions the origin and function of the sensory signals canceling vestibular afferent activity, as early studies emphasized a critical role of neck proprioception in <italic>gating</italic> the cancellation signal (<xref ref-type="fig" rid="fig1">Figure 1B</xref>, <xref ref-type="bibr" rid="bib88">Roy and Cullen, 2004</xref>), whereas follow-up studies proposed that the brain computes sensory prediction errors, without ever specifying whether the implicated forward internal models involve vestibular or proprioceptive cues (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, <xref ref-type="bibr" rid="bib18">Brooks et al., 2015</xref>). This lack of quantitative analysis has obscured the simple solution, which is that transforming motor commands into sensory predictions requires exactly the same forward internal model that has been used to model passive motion. We show that all previous experimental findings during both active and passive movements can be explained by a single sensory internal model that is used to generate optimal estimates of self-motion (<xref ref-type="fig" rid="fig1">Figure 1D</xref>, ‘Kalman filter’). Because we focus on sensory predictions and self-motion estimation, we do not model in detail the motor control aspects of head movements and we consider the proprioception gating mechanism as a switch external to the Kalman filter, similar to previous studies (<xref ref-type="fig" rid="fig1">Figure 1D</xref>, black dashed lines and red switch).</p><p>We use the framework of the Kalman filter (<xref ref-type="fig" rid="fig1">Figure 1D</xref>; <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>; <xref ref-type="bibr" rid="bib47">Kalman, 1960</xref>), which represents the simplest and most commonly used mathematical technique to implement statistically optimal dynamic estimation and explicitly computes sensory prediction errors. We build a quantitative Kalman filter that integrates motion signals originating from motor, canal, otolith, vision and neck proprioceptor signals during active and passive rotations, tilts and translations. We show how the same internal model must process both active and passive motion stimuli, and we provide quantitative simulations that reproduce a wide range of behavioral and neuronal responses, while simultaneously demonstrating that the alternative models (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>) do not. These simulations also generate testable predictions, in particular which passive stimuli should induce sensory errors and which should not, that may motivate future studies and guide interpretation of experimental findings. Finally, we summarize these internal model computations into a schematic diagram, and we discuss how various populations of brainstem and cerebellar neurons may encode the underlying sensory error or feedback signals.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Overview of Kalman filter model of head motion estimation</title><p>The structure of the Kalman filter in <xref ref-type="fig" rid="fig1">Figure 1D</xref> is shown with greater detail in <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref> and described in Materials and methods. In brief, a Kalman filter (<xref ref-type="bibr" rid="bib47">Kalman, 1960</xref>) is based on a forward model of a dynamical system, defined by a set of state variables <inline-formula><mml:math id="inf22"><mml:mi>X</mml:mi></mml:math></inline-formula> that are driven by their own dynamics, motor commands and internal or external perturbations. A set of sensors, grouped in a variable <inline-formula><mml:math id="inf23"><mml:mi>S</mml:mi></mml:math></inline-formula>, provide sensory signals that reflect a transformation of the state variables. Note that <inline-formula><mml:math id="inf24"><mml:mi>S</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> may provide ambiguous or incomplete information, since some sensors may measure a mixture of state variables, and some variables may not be measured at all.</p><p>The Kalman filter uses the available information to track an optimal internal estimate of the state variable <inline-formula><mml:math id="inf25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. At each time <inline-formula><mml:math id="inf26"><mml:mi>t</mml:mi></mml:math></inline-formula>, the Kalman filter computes a preliminary estimate (also called a prediction, <inline-formula><mml:math id="inf27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>) and a corresponding predicted sensory signal <inline-formula><mml:math id="inf28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>. In general, the resulting state estimate <inline-formula><mml:math id="inf29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and the predicted sensory prediction <inline-formula><mml:math id="inf30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> may differ from the real values <inline-formula><mml:math id="inf31"><mml:mi>X</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf32"><mml:mi>S</mml:mi></mml:math></inline-formula>. These errors are reduced using sensory information, as follows (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2B</xref>): First, the prediction <inline-formula><mml:math id="inf33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and the sensory input <inline-formula><mml:math id="inf34"><mml:mi>S</mml:mi></mml:math></inline-formula> are compared to compute a sensory error <inline-formula><mml:math id="inf35"><mml:mi>δ</mml:mi><mml:mi>S</mml:mi><mml:mo>.</mml:mo></mml:math></inline-formula> Second, sensory errors are transformed into a feedback <inline-formula><mml:math id="inf36"><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>K</mml:mi><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>S</mml:mi></mml:math></inline-formula>, where <inline-formula><mml:math id="inf37"><mml:mi>K</mml:mi></mml:math></inline-formula> is a matrix of feedback gains, whose dimensionality depends on both the state variable <italic><inline-formula><mml:math id="inf38"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></italic> and the sensory inputs. Thus, an improved estimate at time <inline-formula><mml:math id="inf39"><mml:mi>t</mml:mi></mml:math></inline-formula> is <inline-formula><mml:math id="inf40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>K</mml:mi><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. The feedback gain matrix <inline-formula><mml:math id="inf41"><mml:mi>K</mml:mi></mml:math></inline-formula> determines how sensory errors improve the final estimate <inline-formula><mml:math id="inf42"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (see Supplementary methods, ‘Kalman filter algorithm’ for details).</p><p><xref ref-type="fig" rid="fig2">Figure 2</xref> applies this framework to the problem of estimating self-motion (rotation, tilt and translation) using vestibular sensors, with two types of motor commands: angular velocity (<inline-formula><mml:math id="inf43"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>) and translational acceleration (<inline-formula><mml:math id="inf44"><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>), with corresponding unpredicted inputs, <inline-formula><mml:math id="inf45"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf46"><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2A</xref>) that represent passive motion or motor error (see Discussion: ‘Role of the vestibular system during active motion: fundamental, ecological and clinical implications’). The sensory signals (<inline-formula><mml:math id="inf47"><mml:mi>S</mml:mi></mml:math></inline-formula>) we consider initially encompass the semicircular canals (rotation sensors that generate a sensory signal <inline-formula><mml:math id="inf48"><mml:mi>V</mml:mi></mml:math></inline-formula>) and the otoliths organs (linear acceleration sensors that generate a sensory signal <inline-formula><mml:math id="inf49"><mml:mi>F</mml:mi></mml:math></inline-formula>) – proprioception is also added in subsequent sections. Each of these sensors has distinct properties, which can be accounted for by the internal model of the sensors. The semicircular canals exhibit high-pass dynamic properties, which are modeled by another state variable <inline-formula><mml:math id="inf50"><mml:mi>C</mml:mi></mml:math></inline-formula> (see Supplementary methods, ‘Model of head motion and vestibular sensors’). The otolith sensors exhibit negligible dynamics, but are fundamentally ambiguous: they sense gravitational as well as linear acceleration – a fundamental ambiguity resulting from Einstein’s equivalence principle [<xref ref-type="bibr" rid="bib30">Einstein, 1907</xref>; modeled here as <inline-formula><mml:math id="inf51"><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo> <mml:mi/><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mi>Ω</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>.</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf52"><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>A</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>; note that <inline-formula><mml:math id="inf53"><mml:mi>G</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf54"><mml:mi>A</mml:mi></mml:math></inline-formula> are expressed in comparable units; see Materials and methods; 'Simulation parameters']. Thus, in total, the state variable <inline-formula><mml:math id="inf55"><mml:mi>X</mml:mi></mml:math></inline-formula> has 4-degrees of freedom (<xref ref-type="fig" rid="fig2">Figure 2A</xref>): angular velocity <inline-formula><mml:math id="inf56"><mml:mi>Ω</mml:mi></mml:math></inline-formula> and linear acceleration <inline-formula><mml:math id="inf57"><mml:mi>A</mml:mi></mml:math></inline-formula> (which are the input/output variables directly controlled), as well as <inline-formula><mml:math id="inf58"><mml:mi>C</mml:mi></mml:math></inline-formula> (a hidden variable that must be included to model the dynamics of the semicircular canals) and tilt position <inline-formula><mml:math id="inf59"><mml:mi>G</mml:mi></mml:math></inline-formula> (another hidden variable that depends on rotations <inline-formula><mml:math id="inf60"><mml:mi>Ω</mml:mi></mml:math></inline-formula>, necessary to model the sensory ambiguity of the otolith organs).</p><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.28074.006</object-id><label>Figure 2.</label><caption><title>Application of the Kalman filter algorithm into optimal self-motion estimation using an internal model with four state variables and two vestibular sensors.</title><p>(<bold>A</bold>) Schematic diagram of the model. Inputs to the model include motor commands, unexpected perturbations, as well as sensory signals. Motor commands during active movements, that is angular velocity (<inline-formula><mml:math id="inf61"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>) and translational acceleration (<inline-formula><mml:math id="inf62"><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>), are known by the brain. Unpredicted internal or external factors such as external (passive) motion are modeled as variables <inline-formula><mml:math id="inf63"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf64"><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>. The state variable has 4 degrees of freedom: angular velocity <inline-formula><mml:math id="inf65"><mml:mi>Ω</mml:mi></mml:math></inline-formula>, tilt position <inline-formula><mml:math id="inf66"><mml:mi>G</mml:mi><mml:mo>,</mml:mo></mml:math></inline-formula> linear acceleration <inline-formula><mml:math id="inf67"><mml:mi>A</mml:mi></mml:math></inline-formula> and a hidden variable <inline-formula><mml:math id="inf68"><mml:mi>C</mml:mi></mml:math></inline-formula> used to model the dynamics of the semicircular canals (see Materials and methods). Two sensory signals are considered: semicircular canals (rotation sensors that generate a signal <inline-formula><mml:math id="inf69"><mml:mi>V</mml:mi></mml:math></inline-formula>) and the otoliths organs (linear acceleration sensors that generate a signal <inline-formula><mml:math id="inf70"><mml:mi>F</mml:mi></mml:math></inline-formula>). Sensory noise <inline-formula><mml:math id="inf71"><mml:msup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf72"><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is illustrated here but omitted from all simulations for simplicity. (<bold>B, C</bold>) illustration of rotations around earth-vertical (<bold>B</bold>) and earth-horizontal (<bold>C</bold>) axes.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-28074-fig2-v2"/></fig><p>The Kalman filter computes optimal estimates <inline-formula><mml:math id="inf73"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf74"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf75"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf76"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> based on motor commands and sensory signals. Note that we do not introduce any tilt motor command, as tilt is assumed to be controlled only indirectly though rotation commands (<inline-formula><mml:math id="inf77"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>). For simplicity, we restrict self-motion to a single axis of rotation (e.g. roll) and a single axis of translation (inter-aural). The model can simulate either rotations in the absence of head tilt (e.g. rotations around an earth-vertical axis: EVAR, <xref ref-type="fig" rid="fig2">Figure 2B</xref>) or tilt (<xref ref-type="fig" rid="fig2">Figure 2C</xref>, where tilt is the integral of rotation velocity, <inline-formula><mml:math id="inf78"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mo>∫</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>) using a switch (but see Supplementary methods, ‘Three-dimensional Kalman filter’ for a 3D model). Sensory errors are used to correct internal motion estimates using the Kalman gain matrix, such that the Kalman filter as a whole performs optimal estimation. In theory, the Kalman filter includes a total of eight feedback signals, corresponding to the combination of two sensory (canal and otolith) errors and four internal states (<inline-formula><mml:math id="inf79"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf80"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf81"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf82"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>). From those eight feedback signals, two are always negligible (Table 2; see also Supplementary methods, ‘Kalman feedback gains’).</p><p>We will show how this model performs optimal estimation of self-motion using motor commands and vestibular sensory signals in a series of increasingly complex simulations. We start with a very short (0.2 s) EVAR stimulus, where canal dynamics are negligible (<xref ref-type="fig" rid="fig3">Figure 3</xref>), followed by a longer EVAR that highlights the role of an internal model of the canals (<xref ref-type="fig" rid="fig4">Figure 4</xref>). Next, we consider the more complex tilt and translation movements that require all four state variables to demonstrate how canal and otolith errors interact to disambiguate otolith signals (<xref ref-type="fig" rid="fig5">Figures 5</xref> and <xref ref-type="fig" rid="fig6">6</xref>). Finally, we extend our model to simulate independent movement of the head and trunk by incorporating neck proprioceptive sensory signals (<xref ref-type="fig" rid="fig7">Figure 7</xref>). For each motion paradigm, identical active and passive motion simulations will be shown side by side in order to demonstrate how the internal model integrates sensory information and motor commands. We show that the Kalman feedback plays a preeminent role, which explains why lots of brain machinery is devoted to its implementation (see Discussion). For convenience, all mathematical notations are summarized in <xref ref-type="table" rid="table1">Table 1</xref>. For Kalman feedback gain nomenclature and numerical values, see <xref ref-type="table" rid="table2">Table 2</xref>.</p><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.28074.007</object-id><label>Figure 3.</label><caption><title>Short duration rotation around an earth-vertical axis (as in <xref ref-type="fig" rid="fig2">Figure 2B</xref>).</title><p>(<bold>A</bold>) Illustration of the stimulus lasting, 200 ms. (<bold>B,C</bold>) Time course of motion variables and sensory (canal) signals. (<bold>D–K</bold>) Simulated variables during active (left panels) and passive motion (right panels). Only the angular velocity state variable <inline-formula><mml:math id="inf83"><mml:mi>Ω</mml:mi></mml:math></inline-formula> is shown (tilt position <inline-formula><mml:math id="inf84"><mml:mi>G</mml:mi></mml:math></inline-formula> and linear acceleration <inline-formula><mml:math id="inf85"><mml:mi>A</mml:mi></mml:math></inline-formula> are not considered in this simulation, and the hidden variable <inline-formula><mml:math id="inf86"><mml:mi>C</mml:mi></mml:math></inline-formula> is equal to zero). Continuous arrows represent the flow of information during one time step, and broken arrows the transfer of information from one time step to the next. (<bold>J</bold>) Kalman feedback. For clarity, the Kalman feedback is shown during passive motion only (it is always zero during active movements in the absence of any perturbation and noise). The box defined by dashed gray lines illustrates the Kalman filter computations. For the rest of mathematical notations, see <xref ref-type="table" rid="table1">Table 1</xref>.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-28074-fig3-v2"/></fig><fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.28074.008</object-id><label>Figure 4.</label><caption><title>Medium-duration rotation around an earth-vertical axis, demonstrating the role of the internal model of canal dynamics.</title><p>(<bold>A</bold>) Illustration of the stimulus lasting 2 s. (<bold>B,C</bold>) Time course of motion variables and sensory (canal) signals. (<bold>D–K</bold>) Simulated variables during active (left panels) and passive motions (right panels). Two state variables are shown: the angular velocity <inline-formula><mml:math id="inf87"><mml:mi>Ω</mml:mi></mml:math></inline-formula> (blue) and canal dynamics <inline-formula><mml:math id="inf88"><mml:mi>C</mml:mi></mml:math></inline-formula> (cyan). Continuous arrows represent the flow of information during one time step, and broken arrows the transfer of information from one time step to the next. (<bold>J</bold>) Kalman feedback. For clarity, the Kalman feedback (reflecting feedback from the canal error signal to the two state variables) is shown during passive motion only (it is always zero during active movements in the absence of any perturbation and noise). All simulations use a canal time constant of 4 s. Note that, because of the integration, the illustrated feedback <inline-formula><mml:math id="inf89"><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is scaled by a factor <inline-formula><mml:math id="inf90"><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:math></inline-formula>; see Supplementary methods, ‘Kalman feedback gains’. The box defined by dashed gray lines illustrates the Kalman filter computations. For the rest of mathematical notations, see <xref ref-type="table" rid="table1">Table 1</xref>.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-28074-fig4-v2"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.28074.009</object-id><label>Figure 4—figure supplement 1.</label><caption><title>Processing of rotation information during long-duration motion.</title><p>(<bold>A,B</bold>) Simulation of constant velocity rotation lasting 60 s, followed by 60 s where the head doesn’t rotate (top row, <inline-formula><mml:math id="inf91"><mml:mi>Ω</mml:mi></mml:math></inline-formula>, blue). The semicircular canal signal (top row, V, magenta) decreases exponentially (time constant = 4 s) during the rotation (<inline-formula><mml:math id="inf92"><mml:mi>V</mml:mi></mml:math></inline-formula> = <inline-formula><mml:math id="inf93"><mml:mi>Ω</mml:mi></mml:math></inline-formula>–<inline-formula><mml:math id="inf94"> <mml:mi/><mml:mi>C</mml:mi></mml:math></inline-formula>; <inline-formula><mml:math id="inf95"><mml:mi>C</mml:mi></mml:math></inline-formula> represented by cyan lines). The deceleration at t = 60 s induces a canal after-effect. During active rotation (<bold>A</bold>), the final estimates of rotation velocity (<inline-formula><mml:math id="inf96"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> lower row, blue) and canal dynamics (<inline-formula><mml:math id="inf97"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, lower row, cyan) are identical to their real respective values (<bold>A</bold>, top panel). In contrast, during passive rotation (<bold>B</bold>), the final estimate of rotation differs from the stimulus: <inline-formula><mml:math id="inf98"><mml:mover accent="true"><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> decreases exponentially toward zero, although the decrease is slower (time constant = 16.5 s) than that of the canals. This prolonged estimate arises from the contribution of the internal state variable <inline-formula><mml:math id="inf99"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, which rises at the beginning of rotation as in (<bold>A</bold>) but reaches a maximum and decreases towards zero. (<bold>C</bold>) Simulation of optokinetic stimulation, i.e., a visual stimulus rotating at constant velocity (<inline-formula><mml:math id="inf100"><mml:mi>V</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:math></inline-formula>, top row, green) while the head is immobile. The rotation estimate <inline-formula><mml:math id="inf101"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> rises immediately to 70% of stimulus velocity at the beginning of the stimulation, and then increases exponentially to 96% of stimulus velocity. <inline-formula><mml:math id="inf102"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> rises exponentially to the stimulation velocity but doesn’t exhibit an immediate increase at the beginning of the stimulation. Both <inline-formula><mml:math id="inf103"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf104"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> persist at the end of the rotation. The simulated results in B and C match the perceptual (<xref ref-type="bibr" rid="bib12">Bertolini et al., 2011</xref>) and reflex (<xref ref-type="bibr" rid="bib81">Raphan et al., 1979</xref>) responses to these stimuli. Furthermore, the rotation estimate <inline-formula><mml:math id="inf105"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is equal to the Kalman feedback signal during passive rotation (<bold>B</bold>) and visual surround rotation (<bold>C</bold>). As expected, VN neurons responses follow the same dynamics than <inline-formula><mml:math id="inf106"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> in these conditions (<xref ref-type="bibr" rid="bib104">Waespe and Henn, 1977</xref>; <xref ref-type="bibr" rid="bib110">Yakushin et al., 2017</xref>). Previous work (<xref ref-type="bibr" rid="bib81">Raphan et al., 1979</xref>; <xref ref-type="bibr" rid="bib53">Laurens and Angelaki, 2011</xref>) used an intermediate variable called ‘velocity storage’ to model low-frequency responses to vestibular and visual stimulation. The state variable <inline-formula><mml:math id="inf107"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> in the Kalman filter model is identical to the velocity storage. An optimal model based on particle filtering also produced identical results (<xref ref-type="bibr" rid="bib55">Laurens and Droulez, 2007</xref>; <xref ref-type="bibr" rid="bib56">Laurens and Droulez, 2008</xref>). The Kalman filter also predicts that rotation perception should last indefinitely during active constant-velocity rotation (<bold>A</bold>), unlike passive rotation (<bold>B</bold>), in agreement with experimental findings (<xref ref-type="bibr" rid="bib97">Solomon and Cohen, 1992</xref>; <xref ref-type="bibr" rid="bib38">Guedry and Benson, 1983</xref>; <xref ref-type="bibr" rid="bib43">Howard et al., 1998</xref>; <xref ref-type="bibr" rid="bib46">Jürgens et al., 1999</xref>). Note, however, that sustained rotation perception during active rotation saturates at about 10°/s in humans (<xref ref-type="bibr" rid="bib38">Guedry and Benson, 1983</xref>; <xref ref-type="bibr" rid="bib43">Howard et al., 1998</xref>), possibly related to the saturation of the velocity storage (<inline-formula><mml:math id="inf108"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>) at velocities of ~20–30°/s in humans (<xref ref-type="bibr" rid="bib61">Laurens et al., 2011</xref>). Therefore, actively rotating at substantially higher velocities may lead to disorientation and vertigo (as commonly experienced by children and waltz dancers). Note that all Kalman filter simulations do not include this saturation. Sustained rotation perception does not saturate in macaques at velocities up to 200°/s (<xref ref-type="bibr" rid="bib97">Solomon and Cohen, 1992</xref>).</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-28074-fig4-figsupp1-v2"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.28074.010</object-id><label>Figure 4—figure supplement 2.</label><caption><title>Same simulation as in <xref ref-type="fig" rid="fig4">Figure 4</xref>, where the internal model of canals dynamic is not used.</title><p>Note error in the final estimate of rotation (G) during both active and passive movements.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-28074-fig4-figsupp2-v2"/></fig><fig id="fig4s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.28074.011</object-id><label>Figure 4—figure supplement 3.</label><caption><title>Quantitative analysis of the importance of an internal model of the canals for ecological movements.</title><p>The internal variable <inline-formula><mml:math id="inf109"><mml:mi>C</mml:mi></mml:math></inline-formula>, which represents the difference between head angular velocity and the canal signal <inline-formula><mml:math id="inf110"><mml:mi>V</mml:mi></mml:math></inline-formula>, and needs to be estimated by the internal model of the canals for accurate velocity perception, has low-pass dynamics. Nevertheless, its importance is highest for high velocities. To illustrate this, here we simulate <inline-formula><mml:math id="inf111"><mml:mi>C</mml:mi></mml:math></inline-formula> during either (<bold>A,B</bold>) constant velocity or (<bold>C,D</bold>) Gaussian-velocity rotations of various amplitudes and durations. (<bold>A,C</bold>) Rotations with an amplitude of 90° and duration of 0.5, 2 and 9 s (i.e. rotations at 180, 45 and 10°/s, respectively). We find that the peak value of <inline-formula><mml:math id="inf112"><mml:mi>C</mml:mi></mml:math></inline-formula> is, 21°/s during a fast movement (0.5 s), whereas it is only 9°/s during a slow movement (9 s). Therefore, for a given movement amplitude, the internal model contribution is larger at larger velocities. (<bold>B,D</bold>) Maximum value of <inline-formula><mml:math id="inf113"><mml:mi>C</mml:mi></mml:math></inline-formula> as a function of movement amplitude for slow (60°/s) and rapid (180°/s, and infinite velocity) movements. During fast movements, <inline-formula><mml:math id="inf114"><mml:mi>C</mml:mi></mml:math></inline-formula> may exceed 20°/s during 90° rotation and 40°/s during 180° rotation. We note that the velocity storage likely saturates at ~20–30°/s in humans (<xref ref-type="bibr" rid="bib61">Laurens et al., 2011</xref>) and ~60°/s in macaques (<xref ref-type="bibr" rid="bib103">Waespe et al., 1983</xref>) (shown in B and D as gray bands; this saturation is not included in the Kalman filter). For fast rotations (180°/s or more), the saturation would be reached for rotations of 130° in humans (assuming a saturation velocity of 30°/s) and 290° in macaques. These simulations demonstrate that the role of the velocity storage in compensating for canal dynamics is not restricted to long-duration rotations but encompasses natural movements.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-28074-fig4-figsupp3-v2"/></fig></fig-group><fig-group><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.28074.012</object-id><label>Figure 5.</label><caption><title>Simulation of short duration head tilt.</title><p>(<bold>A</bold>) Illustration of the stimulus lasting 0.2 s. (<bold>B,C</bold>) Time course of motion variables and sensory (canal and otolith) signals. (<bold>D–L</bold>) Simulated variables during active (left panels) and passive motions (right panels). Three state variables are shown: the angular velocity <inline-formula><mml:math id="inf115"><mml:mi>Ω</mml:mi></mml:math></inline-formula> (blue), tilt position <inline-formula><mml:math id="inf116"><mml:mi>G</mml:mi><mml:mo>,</mml:mo></mml:math></inline-formula> and linear acceleration <inline-formula><mml:math id="inf117"><mml:mi>A</mml:mi></mml:math></inline-formula>. Continuous arrows represent the flow of information during one time step, and broken arrows represent the transfer of information from one time step to the next. (<bold>J, K</bold>) Kalman feedback (shown during passive motion only). Two error signals (<inline-formula><mml:math id="inf118"><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:math></inline-formula>: canal error; <inline-formula><mml:math id="inf119"><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:math></inline-formula>: otolith error) are transformed into feedback to state variables <inline-formula><mml:math id="inf120"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>: blue, <inline-formula><mml:math id="inf121"><mml:msup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>: green, <inline-formula><mml:math id="inf122"><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>: red (variable <inline-formula><mml:math id="inf123"><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>is not shown, but see <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref> for simulations of a 2-s tilt). Feedback originating from <inline-formula><mml:math id="inf124"><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:math></inline-formula> is shown in (<bold>J</bold>) and from <inline-formula><mml:math id="inf125"><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:math></inline-formula> in (<bold>K</bold>). The feedback to <inline-formula><mml:math id="inf126"><mml:msup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is scaled by a factor <inline-formula><mml:math id="inf127"><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:math></inline-formula> (see Supplementary methods, ‘Kalman feedback gains’). Note that in this simulation we consider an active (<inline-formula><mml:math id="inf128"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>) or passive (<inline-formula><mml:math id="inf129"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>) rotation velocity as input. The tilt itself is a consequence of the rotation, and not an independent input. The box defined by dashed gray lines illustrates the Kalman filter computations. For the rest of mathematical notations, see <xref ref-type="table" rid="table1">Table 1</xref>.</p></caption><graphic mime-subtype="jpeg" mimetype="image" xlink:href="elife-28074-fig5-v2"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.28074.013</object-id><label>Figure 5—figure supplement 1.</label><caption><title>Simulation of medium duration (2 s) head tilt movement.</title><p>Panels as in <xref ref-type="fig" rid="fig5">Figure 5</xref>; the canal dynamics state variable, <inline-formula><mml:math id="inf130"><mml:mi>C</mml:mi></mml:math></inline-formula>, is shown in cyan. Although canal responses exhibit significant dynamics (magenta in panel <bold>C</bold>), rotation perception remains accurate (panel <bold>G</bold>, blue traces) during both active and passive tilts (as in <xref ref-type="fig" rid="fig4">Figure 4</xref>). The final estimate of tilt (panel <bold>G</bold>, green traces) is also accurate during active and passive tilts. As a consequence, the otolith error (panel <bold>L</bold>, gray traces) and the corresponding Kalman feedback (<bold>J</bold>) are negligible. Note that the feedback to <inline-formula><mml:math id="inf131"><mml:msup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf132"><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is scaled by a factor <inline-formula><mml:math id="inf133"><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:math></inline-formula> (because of the integration; see Supplementary methods, ‘Kalman feedback gains’).</p></caption><graphic mime-subtype="jpeg" mimetype="image" xlink:href="elife-28074-fig5-figsupp1-v2"/></fig></fig-group><fig-group><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.28074.014</object-id><label>Figure 6.</label><caption><title>Simulation of short duration translation.</title><p>Same legend as <xref ref-type="fig" rid="fig5">Figure 5</xref>. Note that <inline-formula><mml:math id="inf134"><mml:mi>F</mml:mi></mml:math></inline-formula> is identical in <xref ref-type="fig" rid="fig5">Figures 5</xref> and <xref ref-type="fig" rid="fig6">6</xref>: in terms of sensory inputs, these simulation differ only in the canal signal.</p></caption><graphic mime-subtype="jpeg" mimetype="image" xlink:href="elife-28074-fig6-v2"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.28074.015</object-id><label>Figure 6—figure supplement 1.</label><caption><title>Long duration translation, demonstrating the time course of the somatogravic effect.</title><p>Note that <inline-formula><mml:math id="inf135"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> slightly overshoots <inline-formula><mml:math id="inf136"><mml:mi>F</mml:mi></mml:math></inline-formula> transiently: this is the indirect consequence of an additional feedback from <inline-formula><mml:math id="inf137"><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:math></inline-formula> to <inline-formula><mml:math id="inf138"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (not shown here for simplicity; but detailed in <xref ref-type="bibr" rid="bib53">Laurens and Angelaki, 2011</xref>). In this simulation, we observe that the tilt estimate <inline-formula><mml:math id="inf139"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> develops until its magnitude matches the otolith signal <inline-formula><mml:math id="inf140"><mml:mi>F</mml:mi></mml:math></inline-formula>. At this point, the corresponding predicted otolith signal <inline-formula><mml:math id="inf141"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> matches the real signal <inline-formula><mml:math id="inf142"><mml:mi>F</mml:mi></mml:math></inline-formula>. Therefore, the otolith error, <inline-formula><mml:math id="inf143"><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:math></inline-formula>, as well as the net acceleration estimate, <inline-formula><mml:math id="inf144"><mml:mover accent="true"><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula>, vanish. This feedback, which allows the otolith organs to create a rotation signal, has only a low magnitude and a slight effect on the dynamics of <inline-formula><mml:math id="inf145"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> in this simulation. In general, however, it allows the otolith system to detect low-frequency head rotation velocity relative to gravity (<xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3</xref>; see also <xref ref-type="bibr" rid="bib4">Angelaki and Hess (1995a)</xref>,<xref ref-type="bibr" rid="bib5">b</xref>; <xref ref-type="bibr" rid="bib60">Laurens et al. (2010)</xref>; <xref ref-type="bibr" rid="bib53">Laurens and Angelaki, 2011</xref>).</p></caption><graphic mime-subtype="jpeg" mimetype="image" xlink:href="elife-28074-fig6-figsupp1-v2"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.28074.016</object-id><label>Figure 6—figure supplement 2.</label><caption><title>Simulation of simultaneous tilt and translation.</title><p>Head tilt (as in <xref ref-type="fig" rid="fig5">Figure 5</xref>) and translation (as in <xref ref-type="fig" rid="fig6">Figure 6</xref> but in the opposite direction) are performed simultaneously. As a consequence, the otolith signals (that are identical in <xref ref-type="fig" rid="fig5">Figure 5C</xref> and <xref ref-type="fig" rid="fig6">Figure 6C</xref>) now cancel each other (panel <bold>C</bold>, gray trace). This protocol can be seen as an activation of the semicircular canals that indicates a tilt movement, but in the absence of the corresponding tilt-induced activation of the otolith organs. As expected, and in agreement with behavioral (<xref ref-type="bibr" rid="bib7">Angelaki et al., 1999</xref>; <xref ref-type="bibr" rid="bib75">Merfeld et al., 1999</xref>) and neuronal findings (<xref ref-type="bibr" rid="bib8">Angelaki et al., 2004</xref>; <xref ref-type="bibr" rid="bib93">Shaikh et al., 2005</xref>; <xref ref-type="bibr" rid="bib109">Yakusheva et al., 2007</xref>; <xref ref-type="bibr" rid="bib107">2008</xref>; <xref ref-type="bibr" rid="bib108">2013</xref>; <xref ref-type="bibr" rid="bib58">Laurens et al., 2013a</xref>; <xref ref-type="bibr" rid="bib59">Laurens et al., 2013b</xref>), the results of a tilt-translation simulation are the sum of a tilt simulation and a translation simulation (the latter being reversed). Interestingly, this simulation illustrates how activation of the semicircular canals without a corresponding activation of the otoliths leads to an otolith error (panel <bold>L</bold>, gray trace signaling <inline-formula><mml:math id="inf146"><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:math></inline-formula>). This simulates how translation-selective neurons in the vestibular nuclei and cerebellum modulate during tilt-translation in experimental studies using this stimulus (<xref ref-type="bibr" rid="bib8">Angelaki et al., 2004</xref>; <xref ref-type="bibr" rid="bib93">Shaikh et al., 2005</xref>; <xref ref-type="bibr" rid="bib109">Yakusheva et al., 2007</xref>; <xref ref-type="bibr" rid="bib107">2008</xref>; <xref ref-type="bibr" rid="bib108">2013</xref>; <xref ref-type="bibr" rid="bib58">Laurens et al., 2013a</xref>; <xref ref-type="bibr" rid="bib59">Laurens et al., 2013b</xref>).</p></caption><graphic mime-subtype="jpeg" mimetype="image" xlink:href="elife-28074-fig6-figsupp2-v2"/></fig><fig id="fig6s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.28074.017</object-id><label>Figure 6—figure supplement 3.</label><caption><title>Otolith influence on rotation estimate during passive rotations.</title><p>These simulations show that signals from the otoliths (that sense indirectly whether or not the head rotates relative to gravity) can also influence the rotation estimate <inline-formula><mml:math id="inf147"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> at low frequencies (this property has been extensively considered by <xref ref-type="bibr" rid="bib60">Laurens et al., 2010</xref>; <xref ref-type="bibr" rid="bib53">Laurens and Angelaki, 2011</xref>). (<bold>A</bold>) Long-duration EVAR (‘Vertical’ refers to the orientation of the rotation axis), similar to <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2B</xref>. The post-rotatory response (from t = 60 s to t = 120 s) is identical (with a reversed sign) to the initial rotatory response (from t = 0 to t = 60 s). (<bold>B</bold>) Post-rotatory tilt (<xref ref-type="bibr" rid="bib4">Angelaki and Hess, 1995a</xref>; <xref ref-type="bibr" rid="bib60">Laurens et al., 2010</xref>), where the head is rapidly reoriented at t = 60 s such that the rotation axis (i.e. around which the head rotated from t = 0 to t = 60 s) becomes horizontal. The post-rotatory response is largely suppressed (time constant = 2.7 s versus 16 s in A). (<bold>C</bold>) Earth-horizontal Axis Rotation (<xref ref-type="bibr" rid="bib5">Angelaki and Hess, 1995b</xref>; <xref ref-type="bibr" rid="bib60">Laurens et al., 2010</xref>), where the head is first rotated around a vertical axis until the canal signal <inline-formula><mml:math id="inf148"><mml:mi>V</mml:mi></mml:math></inline-formula> (and rotation estimates <inline-formula><mml:math id="inf149"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf150"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>) subside. Next (t = 60 s) the rotation axis is reoriented. The reorientation does not activate the canals (magenta). Yet, a rotation estimate <inline-formula><mml:math id="inf151"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> develops, rising exponentially with a short time constant (3.1 s) close to the time constant of the post-rotatory response (as in <xref ref-type="bibr" rid="bib60">Laurens et al., 2010</xref>). The rotation estimates <inline-formula><mml:math id="inf152"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf153"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> decrease exponentially when the rotation axis is reoriented back to vertical at t = 120 s. These simulations illustrate the influence of the velocity feedback from the otoliths to <inline-formula><mml:math id="inf154"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (detailed can be found in <xref ref-type="bibr" rid="bib53">Laurens and Angelaki, 2011</xref>). As in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1B,C</xref>, the rotation estimate <inline-formula><mml:math id="inf155"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is equal to the Kalman feedback signal in (<bold>B</bold>) and (<bold>C</bold>). As expected, VN neurons responses follow the same dynamics than <inline-formula><mml:math id="inf156"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> in these conditions (<xref ref-type="bibr" rid="bib82">Reisine and Raphan, 1992</xref>; <xref ref-type="bibr" rid="bib110">Yakushin et al., 2017</xref>).</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-28074-fig6-figsupp3-v2"/></fig></fig-group><fig-group><fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.28074.018</object-id><label>Figure 7.</label><caption><title>Simulations of passive trunk and head movements.</title><p>We use a variant of the Kalman filter model (see Supplementary methods) that tracks the velocity of both head and trunk (trunk in space: gray; head in space: blue; head on trunk: red) based on semicircular canal and neck proprioception signals. The real motion (first line), sensory signals (second line) and velocity feedback signals (third to fifth lines) are shown during (<bold>A</bold>) passive whole head and trunk rotation, (<bold>B</bold>) passive head on trunk rotation, and (<bold>C</bold>) passive trunk under head rotation. See <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>–<xref ref-type="fig" rid="fig7s3">3</xref> for other variables and simulations of active motion.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-28074-fig7-v2"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.28074.019</object-id><label>Figure 7—figure supplement 1.</label><caption><title>Active and passive head and trunk rotation.</title><p>(<bold>A</bold>) Illustration of the stimulus. (<bold>B</bold>) Motion variables. (<bold>C</bold>) Sensory signals. (<bold>D–J</bold>) Simulated variables during active (left panels) and passive motions (right panels). Continuous arrows represent the flow of information during one time step, and broken arrows the transfer of information from one time step to the next. (<bold>K,J</bold>) Kalman feedback, shown during passive motion only (it is always zero during active movements in the absence of any perturbation and noise). For the rest of mathematical notations, see <xref ref-type="table" rid="table1">Table 1</xref>. In this simulation, the head/trunk rotates for 0.2 s (thus, canal dynamics are excluded for simplicity). During active rotation, the predicted motion and sensory signals match the real motion and sensory signals, and sensory errors are null. During passive rotation, sensory errors are transformed into feedback signals (<bold>J,K</bold>) to <inline-formula><mml:math id="inf157"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (gray), <inline-formula><mml:math id="inf158"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext> </mml:mtext><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (red) and <inline-formula><mml:math id="inf159"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>N</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (green; note that the feedback <inline-formula><mml:math id="inf160"><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is scaled by <inline-formula><mml:math id="inf161"><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:math></inline-formula>, see Supplementary methods, ‘Feedback signals during neck movement’). The feedback about head velocity in space <inline-formula><mml:math id="inf162"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> (blue) is not directly computed by the model, but defined as the sum of <inline-formula><mml:math id="inf163"><mml:msubsup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf164"><mml:msubsup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>. The canal error <inline-formula><mml:math id="inf165"><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:math></inline-formula> (panel L, magenta), which is similar to <xref ref-type="fig" rid="fig3">Figures 3</xref> and <xref ref-type="fig" rid="fig4">4</xref>, is converted into a feedback about trunk in space velocity (<inline-formula><mml:math id="inf166"><mml:msubsup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>, panel K, gray) and a corresponding feedback about head in space velocity <inline-formula><mml:math id="inf167"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>, whereas feedback originating from <inline-formula><mml:math id="inf168"><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:math></inline-formula> has a limited magnitude (see <xref ref-type="table" rid="table3">Table 3</xref>). The proprioceptive error <inline-formula><mml:math id="inf169"><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:math></inline-formula> (panel L, green; note that <inline-formula><mml:math id="inf170"><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:math></inline-formula> is scaled by <inline-formula><mml:math id="inf171"><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:math></inline-formula>, see Supplementary methods, ‘Feedback signals during neck movement’) is close to zero. In conclusion, as expected, an activation of the semicircular canals (when proprioceptive information does not indicate a movement of the neck) induces a perception of whole head and trunk rotation, where the head and the trunk move together.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-28074-fig7-figsupp1-v2"/></fig><fig id="fig7s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.28074.020</object-id><label>Figure 7—figure supplement 2.</label><caption><title>Active and passive head on trunk rotation.</title><p>(<bold>A</bold>) Illustration of the stimulus. (<bold>B</bold>) Motion variables: the head rotates on the trunk (<inline-formula><mml:math id="inf172"><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, red) for 0.2 s, and the neck position <inline-formula><mml:math id="inf173"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> increases during this period. (<bold>C</bold>) The sensory signals encode head velocity (canal signal, <inline-formula><mml:math id="inf174"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, magenta) and neck position (proprioceptive signal, <inline-formula><mml:math id="inf175"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, green). (<bold>D–J</bold>) Simulated variables during active (left panels) and passive motion (right panels). Continuous arrows represent the flow of information during one time step, and broken arrows the transfer of information from one time step to the next. (<bold>K,J</bold>) Kalman feedback, shown during passive motion only (it is always zero during active movements in the absence of any perturbation and noise). Passive motion induces the same canal error <inline-formula><mml:math id="inf176"><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:math></inline-formula> as in <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>. Furthermore, during passive motion, there is a small but significant mismatch between the predicted and actual proprioceptive signals (see Supplementary methods, ‘Feedback signals during neck movements’) resulting in a proprioceptive error <inline-formula><mml:math id="inf177"><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:math></inline-formula>. Note that, although proprioceptive signals <inline-formula><mml:math id="inf178"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> encode neck position, <inline-formula><mml:math id="inf179"><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:math></inline-formula> encodes the velocity of the movement (panel L; green). As in <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>, the error <inline-formula><mml:math id="inf180"><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:math></inline-formula> is converted into a feedback that encodes rotation of the trunk in space (panel K, <inline-formula><mml:math id="inf181"><mml:msubsup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>, gray). However, the error <inline-formula><mml:math id="inf182"><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:math></inline-formula> is converted into an opposite feedback (panel J, <inline-formula><mml:math id="inf183"><mml:msubsup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>, gray). Therefore, the total trunk rotation feedback and the final estimate of trunk velocity <inline-formula><mml:math id="inf184"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (panel G, gray) are zero. Furthermore, <inline-formula><mml:math id="inf185"><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:math></inline-formula> is converted into feedback <inline-formula><mml:math id="inf186"><mml:msubsup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> that encodes the velocity of the head relative to the trunk (panel J, red).</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-28074-fig7-figsupp2-v2"/></fig><fig id="fig7s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.28074.021</object-id><label>Figure 7—figure supplement 3.</label><caption><title>Active and passive rotation of the trunk while the head is stationary.</title><p>This paradigm illustrates information processing in response to neck rotation in the absence of semicircular canal stimulation. Signals and parameters as in <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplements 1</xref> and <xref ref-type="fig" rid="fig7s2">2</xref>.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-28074-fig7-figsupp3-v2"/></fig><fig id="fig7s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.28074.022</object-id><label>Figure 7—figure supplement 4.</label><caption><title>Simulated tuning of unimodal and bimodal neuron as a function of neck position offset.</title><p>(<bold>A</bold>) Experimental manipulation used by (<xref ref-type="bibr" rid="bib19">Brooks and Cullen, 2009</xref>) to demonstrate that the response of bimodal neurons to sinusoidal motion varies if a head rotation offset is superimposed to the sinusoidal stimulus. (<bold>B</bold>) Schematic responses of two bimodal neurons (one in solid lines and the other in broken lines). Individual neurons exhibit hill-shaped tuning curves as a function of head rotation offset, and the location of the peak varies from neuron to neuron. Remarkably, neurons exhibit similar tuning curves in response to canal stimulation (rotation of the head and trunk; magenta curves), and to neck proprioceptor stimulation (rotation of the trunk only, green). The fact that these tuning curves are matched allows bimodal neurons to encode trunk velocity during combined trunk and head motion, regardless of head position offset (<xref ref-type="bibr" rid="bib19">Brooks and Cullen, 2009</xref>). However, the reason why bimodal neuron responses are modulated as a function of head offset is unknown. We propose that head rotation offset extends or contracts individual neck muscles and affects the signal-to-noise ratio of their afferent proprioceptive signals. Assuming that individual neurons receive proprioceptive afferents from distinct pools of muscles, the signal-to-noise ratio of proprioceptive signals would form a distinct curve in each neuron (C: the solid and broken curves correspond to the solid and broken curves in B). (<bold>D</bold>) Simulations of bimodal neurons (i.e. the trunk velocity feedback <inline-formula><mml:math id="inf187"><mml:msubsup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>) during passive trunk and head rotation (magenta) and trunk only rotation (green), with increasing amount of proprioceptive noise <inline-formula><mml:math id="inf188"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (the vertical broken lines in (<bold>A,B</bold>) indicate the value <inline-formula><mml:math id="inf189"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> used in other figures). We find that increasing <inline-formula><mml:math id="inf190"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> leads to a concomitant decrease of the response gains in both conditions. The responses curves in (<bold>B</bold>) can be obtained by combining panels (<bold>C</bold>) and (<bold>D</bold>). (<bold>E</bold>) Furthermore, we find that the simulated response of unimodal neurons (assumed to encode the trunk velocity feedback <inline-formula><mml:math id="inf191"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>) is independent of proprioceptive noise, in agreement with experimental results (<xref ref-type="bibr" rid="bib19">Brooks and Cullen, 2009</xref>) that demonstrate that that gain of unimodal neurons is not sensitive to static neck position.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-28074-fig7-figsupp4-v2"/></fig><fig id="fig7s5" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.28074.023</object-id><label>Figure 7—figure supplement 5.</label><caption><title>Long-duration passive head and trunk movements.</title><p>The dynamics of head and trunk rotation perception during combined passive head and trunk movements were studied by (<xref ref-type="bibr" rid="bib78">Mergner et al., 1991</xref>). Here, we reproduce the results of this study by simulating the same movements as in <xref ref-type="fig" rid="fig7">Figure 7</xref> with a longer duration (60 s). The feedback signals about head in space velocity (third row, blue), trunk in space velocity (fourth row, gray) and head on trunk velocity (fifth row, red) are shown. During passive motion, this feedback is identical to the final motion estimate, and therefore, the curves in rows 3 to 5 also represent the perception of motion during these stimuli. A combined rotation of the head and trunk (<bold>A</bold>) activates the canals (magenta curve). Following the initial acceleration at t = 0, canal signals fade away with a time constant of 4 s. A canal aftereffect occurs following the deceleration at t = 60 s. The estimates of head in space and trunk in space velocity are identical to each other, and exhibit similar dynamics as the canal signal, although with a longer time constant of 16.5 s (for the same reasons as those described in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1B</xref>). When rotating the head while the trunk is stationary (<bold>B</bold>), the simulated estimates of head in space (third row, blue) and head on trunk (fifth row, red) velocity persist indefinitely, as illustrated experimentally by <xref ref-type="bibr" rid="bib78">Mergner et al. (1991)</xref>. The difference in the time course of the signals in panels A and B is due to the additional presence of the neck proprioceptive signal. Strinkingly, during long duration rotation (<bold>C</bold>), the estimate of trunk in space velocity (fourth row, gray) decreases with an identical time constant as in (<bold>A</bold>), although the underlying sensory signals, that originate from the canals in A and from neck proprioception in <bold>C</bold>, have fundamentally different dynamics. Futher, the perception of trunk rotation is replaced by an illusion of head rotation (third row, blue) in an opposite direction. These model predictions exactly match experimental findings by <xref ref-type="bibr" rid="bib78">Mergner et al. (1991)</xref>.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-28074-fig7-figsupp5-v2"/></fig><fig id="fig7s6" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.28074.024</object-id><label>Figure 7—figure supplement 6.</label><caption><title>Modeling the impact of perturbing motor activity during active movement.</title><p>Experimental studies (<xref ref-type="bibr" rid="bib88">Roy and Cullen, 2004</xref>; <xref ref-type="bibr" rid="bib22">Carriot et al., 2013</xref>; <xref ref-type="bibr" rid="bib18">Brooks et al., 2015</xref>) have shown that VN neurons encode active and passive motion (i.e. head velocity or linear acceleration) indiscriminately when active movements are blocked or perturbed by unexpected torques, as simulated here. (<bold>A</bold>) Simulated experimental condition, where the animal attempts to perform a head movement (while the trunk remains immobile). Due to an unexpected resistive torque, the actual movement amplitude and velocity are only half of the intended motion, as indicated by neck position (green) and head velocity (red) traces (compare ‘Intended Motion’ and ‘Actual Motion’ panels). The resulting sensory signals (canals, magenta, and neck proprioceptors, green) encode the actual (reduced) velocity and amplitude of the movement. (<bold>B</bold>) Kalman filter simulation using the same model as in <xref ref-type="fig" rid="fig7">Figure 7</xref>. Because the actual head velocity (A, ‘Actual Motion’) is slower than the predicted velocity (B, ‘Predicted Motion’), a negative canal error <inline-formula><mml:math id="inf192"><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:math></inline-formula> occurs. As a result, the velocity feedback about head in space (blue) is negative. (<bold>C</bold>) Alternative simulation, where the motor input to the internal model (<inline-formula><mml:math id="inf193"><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>) is set to zero. In this situation, the motion is perceived as if it was entirely passive (exactly as in <xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2</xref>, with only half the amplitude) and therefore the feedback pathways encode a positive head in space velocity signal. Thus, the simulation in B predicts that central neurons that encode feedback signals about head velocity in space, are inhibited in this experimental condition. In contrast, the simulation in C predicts that these neurons are activated (and encode net head velocity with the same gain as in <xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2</xref>). Experiments (<xref ref-type="bibr" rid="bib18">Brooks et al., 2015</xref>) yield results consistent with (<bold>C</bold>) but contrary to (<bold>B</bold>). Note that, in (<bold>B</bold>) and (<bold>C</bold>), the predicted neck position is close to the actual position and the proprioceptive error <inline-formula><mml:math id="inf194"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> encodes a velocity error (close to <inline-formula><mml:math id="inf195"> <mml:mi/><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:math></inline-formula>). This occurs for the same reason as during passive neck movements, as described in Supplementary methods, ‘Feedback signals during neck movement’.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-28074-fig7-figsupp6-v2"/></fig><fig id="fig7s7" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.28074.025</object-id><label>Figure 7—figure supplement 7.</label><caption><title>Neuronal responses when perturbing motor activity during active movement.</title><p>This figure recapitulates neuronal responses (VN and unimodal rFN neurons encoding passive head rotations) during various combinations of passive and active whole body or neck rotation, and corresponding sensory and motor variables. (<bold>A-D</bold>) Movements modeled in <xref ref-type="fig" rid="fig7">Figure 7</xref> and <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>–<xref ref-type="fig" rid="fig7s5">5</xref>, where neurons encode the difference between the vestibular rotation signal (magenta) and a cancellation signal (cyan), which in the Kalman filter model is interpreted as a predicted vestibular signal based on efference copies of neck (red lines and arrows) or body (in A; pink broken line and arrow) motor commands. (<bold>E-H</bold>) Here, assistive or resistive torques are applied during an active neck movement, increasing or preventing the actual neck rotation (magenta). If responses were additive (solid lines), protocols E and F would be equivalent to (C + D) and (<bold>C-D</bold>), respectively, and neuronal firing rate would encode the head rotation component generated by the passive torque. In contrast, <xref ref-type="bibr" rid="bib88">Roy and Cullen (2004)</xref> and <xref ref-type="bibr" rid="bib21">Brooks and Cullen (2014)</xref> showed that VN neurons encode net head velocity (broken line), indicating that the process of transforming motor commands into a cancellation signal stops. Similarly, <xref ref-type="bibr" rid="bib18">Brooks et al. (2015)</xref> applied a resistive torque during active head movements and found that, early in the experiments, rFN encoded net head velocity (G, broken line). They also found that the animals learned to compensate for the torque, at which point rFN neurons responses were again suppressed (<bold>H</bold>). Together, these results indicate that a mismatch between expected and actual head proprioception occurring during active neck movements results in a non-additive response that has been modeled by a non-linear ‘switching’ mechanism (<xref ref-type="bibr" rid="bib88">Roy and Cullen, 2004</xref>). In contrast, vestibular mismatches do not induce any non-linear interactions, at least in the ensemble of stimuli considered here.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-28074-fig7-figsupp7-v2"/></fig></fig-group><table-wrap id="table1" position="float"><object-id pub-id-type="doi">10.7554/eLife.28074.026</object-id><label>Table 1.</label><caption><title>List of motion variables and mathematical notations.</title></caption><table frame="hsides" rules="groups"><tbody><tr valign="top"><td/><td><bold><italic>Motion variables</italic></bold></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf196"><mml:mi>Ω</mml:mi></mml:math></inline-formula></td><td><italic>Head rotation velocity (in space)</italic></td></tr><tr valign="top"><td><italic>G</italic></td><td><italic>Head Tilt</italic></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf197"><mml:mi>A</mml:mi></mml:math></inline-formula></td><td><italic>Linear Acceleration</italic></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf198"><mml:mi>C</mml:mi></mml:math></inline-formula></td><td><italic>Canals dynamics</italic></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf199"><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td><italic>Trunk in space rotation velocity (variant of the model)</italic></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf200"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><italic>Head on trunk rotation velocity (variant of the model)</italic></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf201"><mml:mi>N</mml:mi></mml:math></inline-formula></td><td><italic>Neck position (variant of the model)</italic></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf202"><mml:mi>X</mml:mi></mml:math></inline-formula></td><td><italic>Matrix containing all motion variables in a model</italic></td></tr><tr valign="top"><td/><td><bold><italic>Sensory variables</italic></bold></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf203"><mml:mi>V</mml:mi></mml:math></inline-formula></td><td><italic>Semicircular canal signal</italic></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf204"><mml:mi>F</mml:mi></mml:math></inline-formula></td><td><italic>Otolith signal</italic></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf205"><mml:mi>P</mml:mi></mml:math></inline-formula></td><td><italic>Neck proprioceptive signal</italic></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf206"><mml:mi>V</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:math></inline-formula></td><td><italic>Visual rotation signal</italic></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf207"><mml:mi>S</mml:mi></mml:math></inline-formula></td><td><italic>Matrix containing all sensory variables in a model</italic></td></tr><tr valign="top"><td/><td><bold><italic>Accent and superscripts (motion variables)</italic></bold></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf208"><mml:mi>X</mml:mi></mml:math></inline-formula></td><td><italic>Real value of a variable</italic></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf209"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><italic>Final estimate</italic></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf210"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><italic>Predicted (or preliminary) estimate</italic></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf211"><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula></td><td><italic>Motor command affecting the variable</italic></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf212"><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula></td><td> <italic>Perturbation or motor error affecting the variable (standard deviation</italic> <inline-formula><mml:math id="inf213"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>)</td></tr><tr valign="top"><td><inline-formula><mml:math id="inf214"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td> <italic>Standard deviation of</italic> <inline-formula><mml:math id="inf215"><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf216"><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula></td><td><italic>Kalman feedback on the variable</italic></td></tr><tr valign="top"><td/><td><bold><italic>Accent and superscripts (sensory variables)</italic></bold></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf217"><mml:mi>S</mml:mi></mml:math></inline-formula></td><td><italic>Real value of a variable</italic></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf218"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>Predicted value</td></tr><tr valign="top"><td><inline-formula><mml:math id="inf219"><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula></td><td>Sensory noise</td></tr><tr valign="top"><td><inline-formula><mml:math id="inf220"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td> <italic>Standard deviation of</italic> <inline-formula><mml:math id="inf221"><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf222"><mml:mi>δ</mml:mi><mml:mi>S</mml:mi></mml:math></inline-formula></td><td>Sensory error</td></tr><tr valign="top"><td><inline-formula><mml:math id="inf223"><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula></td><td><italic>Kalman gain of the feedback from S to a motion variable X</italic></td></tr><tr valign="top"><td/><td><bold><italic>Other</italic></bold></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf224"><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:math></inline-formula></td><td><italic>Time step used in the simulations</italic></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf225"><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>'</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula></td><td><italic>Transposed of a matrix M</italic></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf226"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><italic>Time constant of the semicircular canals</italic></td></tr></tbody></table></table-wrap><table-wrap id="table2" position="float"><object-id pub-id-type="doi">10.7554/eLife.28074.027</object-id><label>Table 2.</label><caption><title>Kalman feedback gains during EVAR and tilt/translation.</title><p>Some feedback gains are constant independently of <inline-formula><mml:math id="inf227"><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:math></inline-formula> while some other scale with <inline-formula><mml:math id="inf228"><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:math></inline-formula> (see Supplementary methods, ‘Feedback gains’ for explanations). Gains that have negligible impact on the motion estimates are indicated in normal fonts, others with profound influence are indicated in bold. The feedback gains transform error signals into feedback signals.</p></caption><table frame="hsides" rules="groups"><thead><tr valign="top"><th colspan="2"/><th>Gains during EVAR</th><th>Gains during tilt</th><th>Notes</th></tr></thead><tbody><tr valign="top"><td rowspan="4">Canal feedbacks</td><td><inline-formula><mml:math id="inf229"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><bold>0.94</bold></td><td><bold>0.94</bold></td><td/></tr><tr valign="top"><td><inline-formula><mml:math id="inf230"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><bold>0.19 <inline-formula><mml:math id="inf231"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula><italic>t</italic></bold></td><td><bold>0.23 <inline-formula><mml:math id="inf232"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula><italic>t</italic></bold></td><td rowspan="2" valign="middle"><italic>Integrated over time</italic></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf233"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0.00</td><td><bold>0.90 <inline-formula><mml:math id="inf234"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula><italic>t</italic></bold></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf235"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0.00</td><td>-0.90 <inline-formula><mml:math id="inf236"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula><italic>t</italic></td><td><italic>Negligible</italic></td></tr><tr valign="top"><td rowspan="4">Otolith feedbacks</td><td><inline-formula><mml:math id="inf237"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>-</td><td>0.00</td><td><italic>Negligible</italic></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf238"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>-</td><td><bold>0.14 <inline-formula><mml:math id="inf239"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula><italic>t</italic></bold></td><td rowspan="2" valign="middle"><italic>Integrated over time</italic> <break/></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf240"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>-</td><td><bold>0.76 <inline-formula><mml:math id="inf241"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula><italic>t</italic></bold></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf242"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>-</td><td><bold>0.99</bold></td><td/></tr></tbody></table></table-wrap><table-wrap id="table3" position="float"><object-id pub-id-type="doi">10.7554/eLife.28074.028</object-id><label>Table 3.</label><caption><title>Kalman feedback gains during head and neck rotation.</title><p>As in <xref ref-type="table" rid="table2">Table 2</xref>, some feedback gains are constant and independently of <inline-formula><mml:math id="inf243"><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:math></inline-formula>, while some others scale with or inversely to <inline-formula><mml:math id="inf244"><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:math></inline-formula> (see Supplementary methods, ‘Feedback gains of the model of head and neck motion’ for explanations). Gains that have negligible impact on the motion estimates are indicated in normal fonts, others with profound influence are indicated in bold. The feedback gains <inline-formula><mml:math id="inf245"><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf246"><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow></mml:msubsup> <mml:mi/></mml:math></inline-formula>are computed as <inline-formula><mml:math id="inf247"><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf248"><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:math></inline-formula>.</p></caption><table frame="hsides" rules="groups"><thead><tr valign="top"><th colspan="2"/><th>Gains</th><th>Notes</th></tr></thead><tbody><tr valign="top"><td rowspan="5">Canal feedbacks</td><td><inline-formula><mml:math id="inf249"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><bold>0.85</bold></td><td/></tr><tr valign="top"><td><inline-formula><mml:math id="inf250"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><bold>0.10</bold></td><td/></tr><tr valign="top"><td><inline-formula><mml:math id="inf251"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0.05 <inline-formula><mml:math id="inf252"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula><italic>t</italic></td><td><italic>Negligible</italic></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf253"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><bold>0.22</bold> <inline-formula><mml:math id="inf254"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula><bold><italic>t</italic></bold></td><td><italic>Integrated over time</italic></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf255"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0.95</td><td/></tr><tr valign="top"><td rowspan="5">Proprioceptive feedbacks</td><td><inline-formula><mml:math id="inf256"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><bold>-0.84/</bold><inline-formula><mml:math id="inf257"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula><bold>t</bold></td><td/></tr><tr valign="top"><td><inline-formula><mml:math id="inf258"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><bold>0.89/</bold><inline-formula><mml:math id="inf259"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula><bold>t</bold></td><td/></tr><tr valign="top"><td><inline-formula><mml:math id="inf260"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><bold>0.94</bold></td><td/></tr><tr valign="top"><td><inline-formula><mml:math id="inf261"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0.03</td><td><italic>Negligible</italic></td></tr><tr valign="top"><td><inline-formula><mml:math id="inf262"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0.05/<inline-formula><mml:math id="inf263"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>t</td><td><italic>Negligible</italic></td></tr></tbody></table></table-wrap></sec><sec id="s2-2"><title>Passive motion induces sensory errors</title><p>In <xref ref-type="fig" rid="fig3">Figure 3</xref>, we simulate rotations around an earth-vertical axis (<xref ref-type="fig" rid="fig3">Figure 3A</xref>) with a short duration (0.2 s, <xref ref-type="fig" rid="fig3">Figure 3B</xref>), chosen to minimize canal dynamics (<inline-formula><mml:math id="inf264"><mml:mi>C</mml:mi><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>, <xref ref-type="fig" rid="fig3">Figure 3B</xref>, cyan) such that the canal response matches the velocity stimulus (<inline-formula><mml:math id="inf265"><mml:mi>V</mml:mi><mml:mo>≈</mml:mo> <mml:mi/><mml:mi>Ω</mml:mi></mml:math></inline-formula>, compare magenta curve in <xref ref-type="fig" rid="fig3">Figure 3C</xref> with blue curve in <xref ref-type="fig" rid="fig3">Figure 3B</xref>). We simulate active motion (<xref ref-type="fig" rid="fig3">Figure 3D–K</xref>, left panels), where <inline-formula><mml:math id="inf266"><mml:mi>Ω</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3">Figure 3D</xref>) and <inline-formula><mml:math id="inf267"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> (not shown), as well as passive motion (<xref ref-type="fig" rid="fig3">Figure 3D–K</xref>, right panels), where <inline-formula><mml:math id="inf268"><mml:mi>Ω</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3">Figure 3D</xref>) and <inline-formula><mml:math id="inf269"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> (not shown). The rotation velocity stimulus (<inline-formula><mml:math id="inf270"><mml:mi>Ω</mml:mi></mml:math></inline-formula>, <xref ref-type="fig" rid="fig3">Figure 3E</xref>, blue) and canal activation (<inline-formula><mml:math id="inf271"><mml:mi>V</mml:mi></mml:math></inline-formula>, <xref ref-type="fig" rid="fig3">Figure 3F</xref>, magenta) are identical in both active and passive stimulus conditions. As expected, the final velocity estimate <inline-formula><mml:math id="inf272"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mtext> </mml:mtext></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (output of the filter, <xref ref-type="fig" rid="fig3">Figure 3G</xref>, blue) is equal to the stimulus <inline-formula><mml:math id="inf273"><mml:mi>Ω</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3">Figure 3E</xref>, blue) during both passive and active conditions. Thus, this first simulation is meant to emphasize differences in the flow of information <italic>within</italic> the Kalman filter, rather than differences in performance between passive and active motions (which is identical).</p><p>The fundamental difference between active and passive motions resides in the prediction of head motion (<xref ref-type="fig" rid="fig3">Figure 3H</xref>) and sensory canal signals (<xref ref-type="fig" rid="fig3">Figure 3I</xref>). During active motion, the motor command <inline-formula><mml:math id="inf274"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3">Figure 3D</xref>) is converted into a predicted rotation <inline-formula><mml:math id="inf275"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3">Figure 3H</xref>) by the internal model, and in turn in a predicted canal signal <inline-formula><mml:math id="inf276"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3">Figure 3I</xref>). Of course, in this case, we have purposely chosen the rotation stimulus to be so short (0.2 s), such that canal afferents reliably encode the rotation stimulus (<inline-formula><mml:math id="inf277"><mml:mi>V</mml:mi><mml:mo>≈</mml:mo><mml:mi>Ω</mml:mi></mml:math></inline-formula>; compare <xref ref-type="fig" rid="fig3">Figure 3F and E</xref>, left panels) and the internal model of canals dynamics have a negligible contribution; that is, <inline-formula><mml:math id="inf278"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula><inline-formula><mml:math id="inf279"><mml:mo>≈</mml:mo></mml:math></inline-formula><inline-formula><mml:math id="inf280"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> (compare <xref ref-type="fig" rid="fig3">Figure 3I and H</xref>, left panels). Because the canal sensory error is null, that is <inline-formula><mml:math id="inf281"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mi>V</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3">Figure 3K</xref>, left panel), the Kalman feedback pathway remains silent (not shown) and the net motion estimate is unchanged compared to the prediction, that is, <inline-formula><mml:math id="inf282"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. In conclusion, during active rotation (and in the absence of perturbations, motor or sensory noise), motion estimates are generated entirely based on an accurate predictive process, in turn leading to an accurate prediction of canal afferent signals. In the absence of sensory mismatch, these estimates don’t require any further adjustment.</p><p>In contrast, during passive motion the predicted rotation is null (<inline-formula><mml:math id="inf283"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <xref ref-type="fig" rid="fig3">Figure 3H</xref>, right panel), and therefore the predicted canal signal is also null (<inline-formula><mml:math id="inf284"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <xref ref-type="fig" rid="fig3">Figure 3I</xref>, right panel). Therefore, canal signals during passive motion generate a sensory error <inline-formula><mml:math id="inf285"><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mo>=</mml:mo> <mml:mi/><mml:mi>V</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup> <mml:mi/><mml:mo>=</mml:mo> <mml:mi/><mml:mi>V</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3">Figure 3K</xref>, right panel). This sensory error is converted into a feedback signal <inline-formula><mml:math id="inf286"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo> <mml:mi/><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3">Figure 3J</xref>) with a Kalman gain <inline-formula><mml:math id="inf287"><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> (feedback from canal error <inline-formula><mml:math id="inf288"><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:math></inline-formula> to angular velocity estimate <inline-formula><mml:math id="inf289"><mml:mi>Ω</mml:mi></mml:math></inline-formula>) that is close to 1 (<xref ref-type="table" rid="table2">Table 2</xref>; note that this value represents an optimum and is computed by the Kalman filter algorithm). The final motion estimate is generated by this feedback, that is <inline-formula><mml:math id="inf290"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mi>V</mml:mi><mml:mo>≈</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>These results illustrate the fundamental rules of how active and passive motion signals are processed by the Kalman filter (and, as hypothesized, the brain). During active movements, motion estimates are generated by a <italic>predictive mechanism,</italic> where motor commands are fed into an internal model of head motion. During passive movement, motion estimates are formed based on <italic>feedback signals</italic> that are themselves driven by sensory canal signals. In both cases, specific nodes in the network are silent (e.g. predicted canal signal during passive motion, <xref ref-type="fig" rid="fig3">Figure 3I</xref>; canal error signal during active motion, <xref ref-type="fig" rid="fig3">Figure 3K</xref>), but the same network operates in unison under <italic>all</italic> stimulus conditions. Thus, depending on whether the neuron recorded by a microelectrode in the brain carries <italic>predicted</italic>, <italic>actual</italic> or <italic>error</italic> sensory signals, differences in neural response modulation are expected between active and passive head motion. For example, if a cell encodes canal error exclusively, it will show maximal modulation during passive rotation, and no modulation at all during active head rotation. If a cell encodes mixtures of canal sensory error and actual canal sensory signals (e.g. through a direct canal afferent input), then there will be non-zero, but attenuated, modulation during active, compared to passive, head rotation. Indeed, a range of response attenuation has been reported in the vestibular nuclei (see Discussion).</p><p>We emphasize that in <xref ref-type="fig" rid="fig3">Figure 3</xref> we chose a <italic>very</italic> short-duration (0.2 s) motion profile, for which semicircular canal dynamics are negligible and the sensor can accurately follow the rotation velocity stimulus. We now consider more realistic rotation durations, and demonstrate how predictive and feedback mechanisms interact for accurate self-motion estimation. Specifically, canal afferent signals attenuate (because of their dynamics) during longer duration rotations – and this attenuation is already sizable for rotations lasting 1 s or longer. We next demonstrate that the internal model of canal dynamics must be engaged for accurate rotation estimation, even during purely actively generated head movements.</p></sec><sec id="s2-3"><title>Internal model of canals</title><p>We now simulate a longer head rotation, lasting 2 s (<xref ref-type="fig" rid="fig4">Figure 4A,B</xref>, blue). The difference between the actual head velocity <inline-formula><mml:math id="inf291"><mml:mi>Ω</mml:mi></mml:math></inline-formula> and the average canal signal <inline-formula><mml:math id="inf292"><mml:mi>V</mml:mi></mml:math></inline-formula> is modeled as an internal state variable <inline-formula><mml:math id="inf293"><mml:mi>C</mml:mi></mml:math></inline-formula>, which follows low-pass dynamics (see Supplementary methods, ‘Model of head motion and vestibular sensors’). At the end of the 2 s rotation, the value of <inline-formula><mml:math id="inf294"><mml:mi>C</mml:mi></mml:math></inline-formula> reaches its peak at ~40% of the rotation velocity (<xref ref-type="fig" rid="fig4">Figure 4B</xref>, cyan), modeled to match precisely the afferent canal signal <inline-formula><mml:math id="inf295"><mml:mi>V</mml:mi></mml:math></inline-formula>, which decreases by a corresponding amount (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). Note that <inline-formula><mml:math id="inf296"><mml:mi>C</mml:mi></mml:math></inline-formula> persists when the rotation stops, matching the canal aftereffect (<inline-formula><mml:math id="inf297"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>C</mml:mi><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> after t &gt; 2 s). Next, we demonstrate how the Kalman filter uses the internal variable <inline-formula><mml:math id="inf298"><mml:mi>C</mml:mi></mml:math></inline-formula> to compensate for canal dynamics.</p><p>During active motion, the motor command <inline-formula><mml:math id="inf299"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4">Figure 4D</xref>) is converted into an accurate prediction of head velocity <inline-formula><mml:math id="inf300"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4">Figure 4H</xref>, blue). Furthermore, <inline-formula><mml:math id="inf301"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is also fed through the internal model of the canals to predict <inline-formula><mml:math id="inf302"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4">Figure 4H</xref>, cyan). By combining the predicted internal state variables <inline-formula><mml:math id="inf303"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf304"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, the Kalman filter computes a canal prediction <inline-formula><mml:math id="inf305"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> that follows the same dynamics as <inline-formula><mml:math id="inf306"><mml:mi>V</mml:mi></mml:math></inline-formula> (compare <xref ref-type="fig" rid="fig4">Figure 4F and I</xref>, left panels). Therefore, as in <xref ref-type="fig" rid="fig3">Figure 3</xref>, the resulting sensory mismatch is <inline-formula><mml:math id="inf307"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mi>V</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and the final estimates (<xref ref-type="fig" rid="fig4">Figure 4G</xref>) are identical to the predicted estimates (<xref ref-type="fig" rid="fig4">Figure 4H</xref>). Thus, the Kalman filter maintains an accurate rotation estimate by feeding motor commands through an internal model of the canal dynamics. Note, however, that because in this case <inline-formula><mml:math id="inf308"><mml:mi>V</mml:mi><mml:mo>≠</mml:mo><mml:mi>Ω</mml:mi></mml:math></inline-formula> (compare magenta curve in <xref ref-type="fig" rid="fig4">Figure 4F</xref> and blue curve in <xref ref-type="fig" rid="fig4">Figure 4E</xref>, left panels), <inline-formula><mml:math id="inf309"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula><inline-formula><mml:math id="inf310"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>≠</mml:mo><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> (compare magenta curve in <xref ref-type="fig" rid="fig4">Figure 4I</xref> and blue curve in <xref ref-type="fig" rid="fig4">Figure 4H</xref>, left panels). Thus, the sensory mismatch can only be null under the assumption that motor commands have been processed through the internal model of the canals. But before we elaborate on this conclusion, let’s first consider passive stimulus processing.</p><p>During passive motion, the motor command <inline-formula><mml:math id="inf311"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is equal to zero. First, note that the final estimate <inline-formula><mml:math id="inf312"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is accurate (<xref ref-type="fig" rid="fig4">Figure 4G</xref>), as in <xref ref-type="fig" rid="fig3">Figure 3G</xref>, although canal afferent signals don’t encode <inline-formula><mml:math id="inf313"><mml:mi>Ω</mml:mi></mml:math></inline-formula> accurately. Second, note that the internal estimate of canal dynamics <inline-formula><mml:math id="inf314"><mml:mover accent="true"><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4">Figure 4G</xref>) and the corresponding prediction (<inline-formula><mml:math id="inf315"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>; <xref ref-type="fig" rid="fig4">Figure 4H</xref>) are both accurate (compare with <xref ref-type="fig" rid="fig4">Figure 4E</xref>). This occurs because the canal error <inline-formula><mml:math id="inf316"><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4">Figure 4K</xref>) is converted into a second feedback, <inline-formula><mml:math id="inf317"><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>, (<xref ref-type="fig" rid="fig4">Figure 4J</xref>, cyan), which updates the internal estimate <inline-formula><mml:math id="inf318"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (see Supplementary methods, ‘Velocity Storage’). Finally, in contrast to <xref ref-type="fig" rid="fig3">Figure 3</xref>, the canal sensory error <inline-formula><mml:math id="inf319"><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4">Figure 4K</xref>) does not follow the same dynamics as <inline-formula><mml:math id="inf320"><mml:mi>V</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4">Figure 4C,F</xref>), but is (as it should) equal to <inline-formula><mml:math id="inf321"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). This happens because, though a series of steps (<inline-formula><mml:math id="inf322"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> = -<inline-formula><mml:math id="inf323"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> in <xref ref-type="fig" rid="fig4">Figure 4I</xref> and <inline-formula><mml:math id="inf324"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mi>V</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> in <xref ref-type="fig" rid="fig4">Figure 4K</xref>), <inline-formula><mml:math id="inf325"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is added to the vestibular signal <inline-formula><mml:math id="inf326"><mml:mi>V</mml:mi></mml:math></inline-formula> to compute <inline-formula><mml:math id="inf327"><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mo>≈</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula>. This leads to the final estimate <inline-formula><mml:math id="inf328"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mo>≈</mml:mo><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4">Figure 4G</xref>). Model simulations during even longer duration rotations and visual-vestibular interactions are illustrated in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>. Thus, the internal model of canal dynamics improves the rotation estimate during passive motion. Remarkably, this is important not only during very long duration rotations (as is often erroneously presumed), but also during short stimuli lasting 1–2 s, as illustrated with the simulations in <xref ref-type="fig" rid="fig4">Figure 4</xref>.</p><p>We now return to the actively generated head rotations to ask the important question: What would happen if the brain didn’t use an internal model of canal dynamics? We simulated motion estimation where canal dynamics were removed from the internal model used by the Kalman filter (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>). During both active and passive motion, the net estimate <inline-formula><mml:math id="inf329"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is inaccurate as it parallels<inline-formula><mml:math id="inf330"> <mml:mi/><mml:mi>V</mml:mi></mml:math></inline-formula>, exhibiting a decrease over time and an aftereffect. In particular, during active motion, the motor commands provide accurate signals <inline-formula><mml:math id="inf331"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, but the internal model of the canals fails to convert them into a correct prediction <inline-formula><mml:math id="inf332"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, resulting in a sensory mismatch. This mismatch is converted into a feedback signal <inline-formula><mml:math id="inf333"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> that degrades the accurate prediction <inline-formula><mml:math id="inf334"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> such that the final estimate <inline-formula><mml:math id="inf335"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is inaccurate. These simulations highlight the role of the internal model of canal dynamics, which continuously integrates rotation information in order to anticipate canal afferent activity during <italic>both</italic> active and passive movements. Without this sensory internal model, active movements would result in sensory mismatch, and the brain could either transform this mismatch into sensory feedback, resulting in inaccurate motion estimates, or ignore it and lose the ability to detect externally generated motion or movement errors. Note that the impact of canal dynamics is significant even during natural short-duration and high-velocity head rotations (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>). Thus, even though particular nodes (neurons) in the circuit (e.g. vestibular and rostral fastigial nuclei cells presumably reflecting either <inline-formula><mml:math id="inf336"><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:math></inline-formula> or <inline-formula><mml:math id="inf337"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> in <xref ref-type="fig" rid="fig3">Figures 3</xref> and <xref ref-type="fig" rid="fig4">4</xref>; see Discussion) are attenuated or silent during active head rotations, efference copies of motor commands must <italic>always</italic> be processed though the internal model of the canals – motor commands <italic>cannot</italic> directly drive appropriate sensory prediction errors. This intuition has remained largely unappreciated by studies comparing how central neurons modulate during active and passive rotations – a misunderstanding that has led to a fictitious dichotomy belittling important insights gained by decades of studies using passive motion stimuli (see Discussion).</p></sec><sec id="s2-4"><title>Active versus passive tilt</title><p>Next, we study the interactions between rotation, tilt and translation perception. We first simulate a short duration (0.2 s) roll tilt (<xref ref-type="fig" rid="fig5">Figure 5A</xref>; with a positive tilt velocity <inline-formula><mml:math id="inf338"><mml:mi>Ω</mml:mi></mml:math></inline-formula>, <xref ref-type="fig" rid="fig5">Figure 5B</xref>, blue). Tilt position (<inline-formula><mml:math id="inf339"><mml:mi>G</mml:mi></mml:math></inline-formula>, <xref ref-type="fig" rid="fig5">Figure 5B</xref>, green) ramps during the rotation and then remains constant. As in <xref ref-type="fig" rid="fig3">Figure 3</xref>, canal dynamics <inline-formula><mml:math id="inf340"><mml:mi>C</mml:mi></mml:math></inline-formula> are negligible (<inline-formula><mml:math id="inf341"><mml:mi>V</mml:mi><mml:mo>≈</mml:mo><mml:mi>Ω</mml:mi></mml:math></inline-formula>; <xref ref-type="fig" rid="fig5">Figure 5F</xref>, magenta) and the final rotation estimate <inline-formula><mml:math id="inf342"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is accurate (<xref ref-type="fig" rid="fig5">Figure 5G</xref>, blue). Also similar to <xref ref-type="fig" rid="fig3">Figure 3</xref>, <inline-formula><mml:math id="inf343"><mml:mover accent="true"><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> is carried by the predicted head velocity node during active motion (<inline-formula><mml:math id="inf344"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>; <inline-formula><mml:math id="inf345"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>) and by the Kalman feedback node during passive motion (<inline-formula><mml:math id="inf346"><mml:mi>Ω</mml:mi><mml:mo>≈</mml:mo><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>; <inline-formula><mml:math id="inf347"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). That is, the final rotation estimate, which is accurate during both active and passive movements, is carried by different nodes (thus, likely different cell types; see Discussion) within the neural network.</p><p>When rotations change orientation relative to gravity, another internal state (tilt position <inline-formula><mml:math id="inf348"><mml:mi>G</mml:mi></mml:math></inline-formula>, not included in the simulations of <xref ref-type="fig" rid="fig3">Figures 3</xref> and <xref ref-type="fig" rid="fig4">4</xref>) and another sensor (otolith organs; <inline-formula><mml:math id="inf349"><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mi>G</mml:mi></mml:math></inline-formula> since <inline-formula><mml:math id="inf350"><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> in this simulation; <xref ref-type="fig" rid="fig5">Figure 5F</xref>, black) are engaged. During actively generated tilt movements, the rotation motor command (<inline-formula><mml:math id="inf351"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>) is temporally integrated by the internal model (see <inline-formula><mml:math id="inf352"><mml:mi>E</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo> <mml:mi/><mml:mn>3</mml:mn><mml:mi>c</mml:mi></mml:math></inline-formula> of Supplementary methods, ‘Kalman filter algorithm developed’), generating an accurate prediction of head tilt <inline-formula><mml:math id="inf353"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup><mml:mo>.</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig5">Figure 5H</xref>, left panel, green). This results in a correct prediction of the otolith signal <inline-formula><mml:math id="inf354"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig5">Figure 5I</xref>, grey) and therefore, as in previous simulations of active movement, the sensory mismatch for both the canal and otolith signals (<xref ref-type="fig" rid="fig5">Figure 5L</xref>, magenta and gray, respectively) and feedback signals (not shown) are null; and the final estimates, driven exclusively by the prediction, are accurate; <inline-formula><mml:math id="inf355"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf356"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>During passive tilt, the canal error, <inline-formula><mml:math id="inf357"><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:math></inline-formula>, is converted into Kalman feedback that updates <inline-formula><mml:math id="inf358"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig5">Figure 5K</xref>, blue) and <inline-formula><mml:math id="inf359"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (not shown here; but see <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref> for 2 s tilt simulations), as well as the two other state variables (<inline-formula><mml:math id="inf360"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf361"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>). Specifically, the feedback from <inline-formula><mml:math id="inf362"><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:math></inline-formula> to <inline-formula><mml:math id="inf363"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (<inline-formula><mml:math id="inf364"><mml:msup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo> <mml:mi/></mml:math></inline-formula>updates the predicted tilt <inline-formula><mml:math id="inf365"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and is temporally integrated by the Kalman filter (<inline-formula><mml:math id="inf366"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>; see Supplementary methods, ‘Passive Tilt’; <xref ref-type="fig" rid="fig5">Figure 5K</xref>, green). The feedback signal from <inline-formula><mml:math id="inf367"><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:math></inline-formula> to <inline-formula><mml:math id="inf368"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> has a minimal impact, as illustrated in <xref ref-type="fig" rid="fig5">Figure 5K</xref>, red (see also Supplementary methods,’ Kalman feedback gains’ and <xref ref-type="table" rid="table2">Table 2</xref>).</p><p>Because <inline-formula><mml:math id="inf369"><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:math></inline-formula> efficiently updates the tilt estimate <inline-formula><mml:math id="inf370"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, the otolith error <inline-formula><mml:math id="inf371"><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:math></inline-formula> is close to zero during passive tilt (<xref ref-type="fig" rid="fig5">Figure 5L</xref>, gray; see Supplementary methods, ‘Passive Tilt’) and therefore all feedback signals originating from <inline-formula><mml:math id="inf372"><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig5">Figure 5J</xref>) play a minimal role (see Supplementary methods, ‘Passive Tilt’) during pure tilt (this is the case even for longer duration stimuli; <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). This simulation highlights that, although tilt is sensed by the otoliths, passive tilt doesn’t induce any sizeable otolith error. Thus, unlike neurons tuned to canal error, the model predicts that those cells tuned to otolith error will not modulate during either passive or actively-generated head tilt. Therefore, cells tuned to otolith error would respond primarily during translation, and not during tilt, thus they would be identified ‘translation-selective’. Furthermore, the model predicts that those neurons tuned to passive tilt (e.g. Purkinje cells in the caudal cerebellar vermis; <xref ref-type="bibr" rid="bib59">Laurens et al., 2013b</xref>) likely reflect a canal error that has been transformed into a tilt velocity error (<xref ref-type="fig" rid="fig5">Figure 5L</xref>, magenta). Thus, the model predicts that tilt-selective Purkinje cells should encode tilt velocity, and not tilt position, a prediction that remains to be tested experimentally (see Discussion).</p></sec><sec id="s2-5"><title>Otolith errors are interpreted as translation and tilt with distinct dynamics</title><p>Next, we simulate a brief translation (<xref ref-type="fig" rid="fig6">Figure 6</xref>). During active translation, we observe, as in previous simulations of active movements, that the predicted head motion matches the sensory (otolith in this case: <inline-formula><mml:math id="inf373"><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi></mml:math></inline-formula>) signals (<inline-formula><mml:math id="inf374"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf375"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>F</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>). Therefore, as in previous simulations of active motion, the sensory prediction error is zero (<xref ref-type="fig" rid="fig6">Figure 6L</xref>) and the final estimate is equal to, and driven by, the prediction (<inline-formula><mml:math id="inf376"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>; <xref ref-type="fig" rid="fig6">Figure 6G</xref>, red).</p><p>During passive translation, the predicted acceleration is null (<inline-formula><mml:math id="inf377"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <xref ref-type="fig" rid="fig6">Figure 6H</xref>, red), similar as during passive rotation in <xref ref-type="fig" rid="fig3">Figures 3</xref> and <xref ref-type="fig" rid="fig4">4</xref>). However, a sizeable tilt signal (<inline-formula><mml:math id="inf378"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf379"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <xref ref-type="fig" rid="fig6">Figure 6G,H</xref>, green), develops over time. This (erroneous) tilt estimate can be explained as follows: soon after translation onset (vertical dashed lines in <xref ref-type="fig" rid="fig6">Figure 6B–J</xref>), <inline-formula><mml:math id="inf380"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is close to zero. The corresponding predicted otolith signal is also close to zero (<inline-formula><mml:math id="inf381"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), leading to an otolith error <inline-formula><mml:math id="inf382"><mml:mi>δ</mml:mi><mml:mi>F</mml:mi> <mml:mi/><mml:mo>≈</mml:mo><mml:mi>A</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig6">Figure 6L</xref>, right, gray). Through the Kalman feedback gain matrix, this otolith error, <inline-formula><mml:math id="inf383"><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:math></inline-formula>, is converted into: (1) an acceleration feedback <inline-formula><mml:math id="inf384"><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> (<xref ref-type="fig" rid="fig6">Figure 6J</xref>, red) with gain <inline-formula><mml:math id="inf385"><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.995</mml:mn></mml:math></inline-formula> (the close to unity feedback gain indicates that otolith errors are interpreted as acceleration: <inline-formula><mml:math id="inf386"><mml:mover accent="true"><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo> <mml:mi/><mml:mi>δ</mml:mi><mml:mi>F</mml:mi><mml:mo>≈</mml:mo><mml:mi>A</mml:mi></mml:math></inline-formula>; note however that the otolith error <inline-formula><mml:math id="inf387"><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:math></inline-formula> vanishes over time, as explained next); and (2) a tilt feedback <inline-formula><mml:math id="inf388"><mml:msup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> (<xref ref-type="fig" rid="fig6">Figure 6J</xref>, green), with <inline-formula><mml:math id="inf389"><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:math></inline-formula>. This tilt feedback, although too weak to have any immediate effect, is integrated over time (<inline-formula><mml:math id="inf390"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>; see <xref ref-type="fig" rid="fig5">Figure 5</xref> and Supplementary methods, ‘Somatogravic effect’), generating the rising tilt estimate <inline-formula><mml:math id="inf391"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig6">Figure 6G</xref>, green) and <inline-formula><mml:math id="inf392"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig6">Figure 6H</xref>, green).</p><p>The fact that the Kalman gain feedback from the otolith error to the <inline-formula><mml:math id="inf393"><mml:mover accent="true"><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> internal state generates the somatogravic effect is illustrated in <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>, where a longer acceleration (20 s) is simulated. At the level of final estimates (perception), these simulations predict the occurrence of tilt illusions during sustained translation (somatogravic illusion; <xref ref-type="bibr" rid="bib37">Graybiel, 1952</xref>; <xref ref-type="bibr" rid="bib80">Paige and Seidman, 1999</xref>). Further simulations show how activation of the semicircular canals without a corresponding activation of the otoliths (e.g. during combination of tilt and translation; <xref ref-type="bibr" rid="bib8">Angelaki et al. (2004)</xref>; <xref ref-type="bibr" rid="bib109">Yakusheva et al., 2007</xref>) leads to an otolith error (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>) and how signals from the otoliths (that sense indirectly whether or not the head rotates relative to gravity) can also influence the rotation estimate <inline-formula><mml:math id="inf394"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> at low frequencies (<xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3</xref>; this property has been extensively evaluated by <xref ref-type="bibr" rid="bib53">Laurens and Angelaki, 2011</xref>). These simulations demonstrate that the Kalman filter model efficiently simulates all previous properties of both perception and neural responses during passive tilt and translation stimuli (see Discussion).</p></sec><sec id="s2-6"><title>Neck proprioceptors and encoding of trunk versus head velocity</title><p>The model analyzed so far has considered only vestibular sensors. Nevertheless, active head rotations often also activate neck proprioceptors, when there is an independent rotation of the head relative to the trunk. Indeed, a number of studies (<xref ref-type="bibr" rid="bib51">Kleine et al., 2004</xref>; <xref ref-type="bibr" rid="bib19">Brooks and Cullen, 2009</xref>; <xref ref-type="bibr" rid="bib20">2013</xref>; <xref ref-type="bibr" rid="bib18">Brooks et al., 2015</xref>) have identified neurons in the rostral fastigial nuclei that encode the rotation velocity of the trunk. These neurons receive convergent signals from the semicircular canals and neck muscle proprioception and, accordingly, are named ‘bimodal neurons’, to contrast with ‘unimodal neurons’, which encode passive head velocity. Because the bimodal neurons do not respond to active head and trunk movements (<xref ref-type="bibr" rid="bib20">Brooks and Cullen, 2013</xref>; <xref ref-type="bibr" rid="bib18">Brooks et al., 2015</xref>), they likely encode feedback signals related to trunk velocity. We developed a variant of the Kalman filter to model both unimodal and bimodal neuron types (<xref ref-type="fig" rid="fig7">Figure 7</xref>; see also Supplementary methods and <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>–<xref ref-type="fig" rid="fig7s3">3</xref>).</p><p>The model tracks the velocity of the trunk in space <inline-formula><mml:math id="inf395"><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and the velocity of the head on the trunk <inline-formula><mml:math id="inf396"><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> as well as neck position (<inline-formula><mml:math id="inf397"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>). Sensory inputs are provided by the canals (that sense the total head velocity, <inline-formula><mml:math id="inf398"><mml:msub><mml:mrow><mml:mi>Ω</mml:mi><mml:mo>=</mml:mo> <mml:mi/><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>), and proprioceptive signals from the neck musculature (<inline-formula><mml:math id="inf399"><mml:mi>P</mml:mi></mml:math></inline-formula>), which are assumed to encode neck position (<xref ref-type="bibr" rid="bib23">Chan et al., 1987</xref>).</p><p>In line with the simulations presented above, we find that, during active motion, the predicted sensory signals are accurate. Consequently, the Kalman feedback pathways are silent (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>–<xref ref-type="fig" rid="fig7s3">3</xref>; active motion is not shown in <xref ref-type="fig" rid="fig7">Figure 7</xref>). In contrast, passive motion induces sensory errors and Kalman feedback signals. The velocity feedback signals (elaborated in <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>–<xref ref-type="fig" rid="fig7s3">3</xref>) have been re-plotted in <xref ref-type="fig" rid="fig7">Figure 7</xref>, where we illustrate head in space (blue), trunk in space (gray), and head on trunk (red) velocity (neck position feedback signals are only shown in <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>–<xref ref-type="fig" rid="fig7s3">3</xref>).</p><p>During passive whole head and trunk rotation, where the trunk rotates in space (<xref ref-type="fig" rid="fig7">Figure 7A</xref>, Real motion: <inline-formula><mml:math id="inf400"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, grey) and the head moves together with the trunk (head on trunk velocity <inline-formula><mml:math id="inf401"><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>, red, head in space <inline-formula><mml:math id="inf402"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, blue), we find that the resulting feedback signals accurately encode these rotation components (<xref ref-type="fig" rid="fig7">Figure 7A</xref>, Velocity Feedback; see also <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>). During head on trunk rotation (<xref ref-type="fig" rid="fig7">Figure 7B</xref>, <xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2</xref>), the Kalman feedback signals accurately encode the head on trunk (red) or in space (blue) rotation, and the absence of trunk in space rotation (gray). Finally, during trunk under head rotation that simulates a rotation of the trunk while the head remains fixed in space, resulting in a neck counter-rotation, the various motion components are accurately encoded by Kalman feedback (<xref ref-type="fig" rid="fig7">Figure 7C</xref>, <xref ref-type="fig" rid="fig7s3">Figure 7—figure supplement 3</xref>). We propose that unimodal and bimodal neurons reported in (<xref ref-type="bibr" rid="bib19">Brooks and Cullen, 2009</xref>; <xref ref-type="bibr" rid="bib20">2013</xref>) encode feedback signals about the velocity of the head in space (<inline-formula><mml:math id="inf403"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>, <xref ref-type="fig" rid="fig7">Figure 7</xref>, blue) and of the trunk in space (<inline-formula><mml:math id="inf404"><mml:msubsup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>, <xref ref-type="fig" rid="fig7">Figure 7</xref>, gray), respectively. Furthermore, in line with experimental findings (<xref ref-type="bibr" rid="bib20">Brooks and Cullen, 2013</xref>), these feedback pathways are silent during self-generated motion.</p><p>The Kalman filter makes further predictions that are entirely consistent with experimental results. First, it predicts that proprioceptive error signals during passive neck rotation encode velocity (<xref ref-type="fig" rid="fig7s3">Figure 7—figure supplement 3L</xref>; see Supplementary methods, ‘Feedback signals during neck movement’). Thus, the Kalman filter explains the striking result that the proprioceptive responses of bimodal neurons encode trunk <italic>velocity</italic> (<xref ref-type="bibr" rid="bib19">Brooks and Cullen, 2009</xref>; <xref ref-type="bibr" rid="bib20">2013</xref>), even if neck proprioceptors encode neck position. Note that neck proprioceptors likely encode a mixture of neck position and velocity at high frequencies (<xref ref-type="bibr" rid="bib23">Chan et al., 1987</xref>; <xref ref-type="bibr" rid="bib78">Mergner et al., 1991</xref>); and additional simulations (not shown) based on this hypothesis yield similar results as those shown here. We used here a model in which neck proprioceptors encode position for simplicity, and in order to demonstrate that Kalman feedback signals encode trunk velocity even when proprioceptive signals encode position.</p><p>Second, the model predicts another important property of bimodal neurons: their response gains to both vestibular (during sinusoidal motion of the head and trunk together) and proprioceptive (during sinusoidal motion of the trunk when the head is stationary) stimulation vary identically if a constant rotation of the head relative to the trunk is added, as an offset, to the sinusoidal motion (<xref ref-type="bibr" rid="bib19">Brooks and Cullen, 2009</xref>). We propose that this offset head rotation extends or contracts individual neck muscles and affects the signal to noise ratio of neck proprioceptors. Indeed, simulations shown in <xref ref-type="fig" rid="fig7s4">Figure 7—figure supplement 4</xref> reproduce the effect of head rotation offset on bimodal neurons. In agreement with experimental findings, we also find that simulated unimodal neurons are not affected by these offsets (<xref ref-type="fig" rid="fig7s4">Figure 7—figure supplement 4</xref>).</p><p>Finally, the model also predicts the dynamics of trunk and head rotation perception during long-duration rotations (<xref ref-type="fig" rid="fig7s5">Figure 7—figure supplement 5</xref>), which has been established by behavioral studies (<xref ref-type="bibr" rid="bib78">Mergner et al., 1991</xref>).</p></sec><sec id="s2-7"><title>Alternative models of interaction between active and passive motions</title><p>The theoretical framework of the Kalman filter asserts that the brain uses a single internal model to process copies of motor commands and sensory signals. But could alternative computational schemes, involving distinct internal models for motor and sensory signals, explain neuronal and behavioral responses during active and passive motions? Here, we consider three possibilities, illustrated in <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>. First, that the brain computes head motion based on motor commands only and suppresses vestibular sensory inflow entirely during active motion (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1A</xref>). Second, that a ‘motor’ internal model and a ‘sensory’ internal model run in parallel, and that central neurons encode the difference between their outputs – which would represent a motion prediction error instead of a sensory prediction error, as proposed by the Kalman filter framework (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1B</xref>). Third, that the brain computes sensory prediction errors based on sensory signals and the output of the ‘motor’ internal model, and then feeds these errors into the ‘sensory’ internal model (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1C</xref>).</p><p>We first consider the possibility that the brain simply suppresses vestibular sensory inflow. Experimental evidence against this alternative comes from recordings performed when passive motion is applied concomitantly to an active movement (<xref ref-type="bibr" rid="bib20">Brooks and Cullen, 2013</xref>; <xref ref-type="bibr" rid="bib21">2014</xref>; <xref ref-type="bibr" rid="bib22">Carriot et al., 2013</xref>). Indeed, neurons that respond during passive but not active motion have been found to encode the passive component of combined passive and active motions, as expected based on the Kalman framework. We present corresponding simulation results in <xref ref-type="fig" rid="fig8">Figure 8</xref>. We simulate a rotation movement (<xref ref-type="fig" rid="fig8">Figure 8A</xref>), where an active rotation (<inline-formula><mml:math id="inf405"><mml:msup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">u</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>, Gaussian velocity profile) is combined with a passive rotation (<inline-formula><mml:math id="inf406"><mml:msup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">ε</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>, trapezoidal profile), a tilt movement (<xref ref-type="fig" rid="fig8">Figure 8B</xref>; using similar velocity inputs, <inline-formula><mml:math id="inf407"><mml:msup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">u</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf408"><mml:msup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">ε</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>, where the resulting active and passive tilt components are <inline-formula><mml:math id="inf409"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">u</mml:mi></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf410"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">ε</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:math></inline-formula>), and a translation movement (<xref ref-type="fig" rid="fig8">Figure 8C</xref>). We find that, in all simulations, the final motion estimate (<xref ref-type="fig" rid="fig8">Figure 8D–F</xref>; <inline-formula><mml:math id="inf411"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf412"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf413"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, respectively) matches the combined active and passive motions (<inline-formula><mml:math id="inf414"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf415"><mml:mi mathvariant="normal">G</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf416"><mml:mi mathvariant="normal">A</mml:mi></mml:math></inline-formula>, respectively). In contrast, the Kalman feedback signals (<xref ref-type="fig" rid="fig8">Figure 8G–I</xref>) specifically encode the passive motion components. Specifically, the rotation feedback (<inline-formula><mml:math id="inf417"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>, <xref ref-type="fig" rid="fig8">Figure 8G</xref>) is identical to the passive rotation <inline-formula><mml:math id="inf418"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> (<xref ref-type="fig" rid="fig8">Figure 8A</xref>). As in <xref ref-type="fig" rid="fig5">Figure 5</xref>, the tilt feedback (<inline-formula><mml:math id="inf419"><mml:msup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>, <xref ref-type="fig" rid="fig8">Figure 8H</xref>) encodes tilt velocity, also equal to <inline-formula><mml:math id="inf420"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> (<xref ref-type="fig" rid="fig8">Figure 8A</xref>). Finally, the linear acceleration feedback (<inline-formula><mml:math id="inf421"><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>, <xref ref-type="fig" rid="fig8">Figure 8I</xref>) follows the passive acceleration component, although it decreases slightly with time because of the somatogravic effect. Thus, Kalman filter simulations confirm that neurons that encode sensory mismatch or Kalman feedback should selectively follow the passive component of combined passive and active motions.</p><fig id="fig8" position="float"><object-id pub-id-type="doi">10.7554/eLife.28074.029</object-id><label>Figure 8.</label><caption><title>Interaction of active and passive motion.</title><p>Active movements (Gaussian profiles) and passive movements (short trapezoidal profiles) are superimposed. (<bold>A</bold>) Active (<inline-formula><mml:math id="inf422"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>) and passive (<inline-formula><mml:math id="inf423"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>) rotations. (<bold>B</bold>) Head tilt resulting from active and passive rotations (the corresponding tilt components are <inline-formula><mml:math id="inf424"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup><mml:mo>.</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf425"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup><mml:mo>.</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>). (<bold>C</bold>) Active (<inline-formula><mml:math id="inf426"><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>) and passive (<inline-formula><mml:math id="inf427"><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>) translations. (<bold>D-F</bold>) Final motion estimates (equal to the total motion). (<bold>G-I</bold>) The Kalman feedback corresponds to the passive motion component. (<bold>J-K</bold>) Final estimates computed by inactivating all Kalman feedback pathways. These simulations represent the motion estimates that would be produced if the brain suppressed sensory inflow during active motion. The simulations contradict the alternative scheme of <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1A</xref>.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-28074-fig8-v2"/></fig><p>What would happen if, instead of computing sensory prediction errors, the brain simply discarded vestibular sensory (or feedback) signals during active motion? We repeat the simulations of <xref ref-type="fig" rid="fig8">Figure 8A–I</xref> after removing the vestibular sensory input signals from the Kalman filter. We find that the net motion estimates encode only the active movement components (<xref ref-type="fig" rid="fig8">Figure 8J–L</xref>; <inline-formula><mml:math id="inf428"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf429"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf430"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>) – thus, not accurately estimating the true movement. Furthermore, as a result of the sensory signals being discarded, all sensory errors and Kalman feedback signals are null. These simulations indicate that suppressing vestibular signals during active motion would prevent the brain from detecting passive motion occurring during active movement (see Discussion, ‘Role of the vestibular system during active motion: ecological, clinical and fundamental implications.”), in contradiction with experimental results.</p><p>Next, we simulate (<xref ref-type="fig" rid="fig9">Figure 9</xref>) the alternative model of <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1B</xref>, where the motor commands are used to predict head motion (<xref ref-type="fig" rid="fig9">Figure 9</xref>, first row) while the sensory signals are used to compute a self-motion estimate (second row). According to this model, these two signals would be compared to compute a motion prediction error instead of a sensory prediction error (third row; presumably represented in the responses of central vestibular neurons). We first simulate short active and passive rotations (<xref ref-type="fig" rid="fig9">Figure 9A,B</xref>; same motion as in <xref ref-type="fig" rid="fig3">Figure 3</xref>). During active rotation (<xref ref-type="fig" rid="fig9">Figure 9A</xref>), both the motor prediction and the sensory self-motion estimate are close to the real motion and therefore the motor prediction is null (<xref ref-type="fig" rid="fig9">Figure 9A</xref>, third row). In contrast, the sensory estimate is not cancelled during passive rotation, leading to a non-zero motion prediction error (<xref ref-type="fig" rid="fig9">Figure 9B</xref>, third row). Thus, the motion prediction errors in <xref ref-type="fig" rid="fig9">Figure 9A,B</xref> resemble the sensory prediction errors predicted by the Kalman filter in <xref ref-type="fig" rid="fig3">Figure 3</xref> and may explain neuronal responses recorded during brief rotations.</p><fig id="fig9" position="float"><object-id pub-id-type="doi">10.7554/eLife.28074.030</object-id><label>Figure 9.</label><caption><title>Simulations of the alternative scheme where motor commands cancel the output of a sensory internal model.</title><p>In this figure, we consider an alternative scheme (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1B</xref>), where the motor commands (first row), which are assumed to encode head angular velocity and linear acceleration (as in the Kalman filer model), are used to cancel the output of a ‘sensory only’ internal model (second row, also identical to the Kalman filter model) to compute motion prediction errors (third row), instead of sensory prediction error, as in the Kalman filter model. (<bold>A</bold>) During a short active rotation (same as in <xref ref-type="fig" rid="fig3">Figure 3</xref>), both the motor prediction and the sensory self-motion estimate are close to the real motion and therefore the motor prediction cancels the sensory estimate accurately. (<bold>B</bold>) Similarly to <xref ref-type="fig" rid="fig3">Figure 3</xref>, the motor prediction is null and the sensory estimate is not cancelled during passive rotation. (<bold>C</bold>) During long-duration active rotation (same motion as in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1A,B</xref>), the motor prediction (top row) does not match the sensory signal (second row), resulting in a substantial prediction error (third row). This contrasts with Kalman filter simulations, where no sensory prediction errors occur during active motion. (<bold>D</bold>) During long-duration passive motion, results agree with Kalman filter predictions. (<bold>E</bold>) During active translation (same motion as in <xref ref-type="fig" rid="fig6">Figure 6</xref>), the somatogravic effect would induce a tilt illusion (green) and an underestimation of linear acceleration (red), again leading to motion prediction errors. Thus, although the predictions of this alternative model resemble those of the Kalman filter during short active rotations, they differ during long rotations or active translations and are contradicted by experimental observations. The last row shows the final self-motion estimate obtained by computing a weighted average of the predicted head motion and sensory motion estimates. Three different weights are considered: 100% motor signals (dark blue), 100% sensory estimates (dark blue) or 50%/50% (blue).</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-28074-fig9-v2"/></fig><p>However, this similarity breaks down when simulating a long-duration active or passive rotation (<xref ref-type="fig" rid="fig9">Figure 9C,D</xref>; same motion as in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1A,B</xref>). The motor prediction of rotation velocity would remain constant during 1 min of active rotation (<xref ref-type="fig" rid="fig9">Figure 9C</xref>, first row), whereas the sensory estimate would decrease over time and exhibit an aftereffect (<xref ref-type="fig" rid="fig9">Figure 9C</xref>, second row). This would result in a substantial difference between the motor prediction and the sensory estimate (<xref ref-type="fig" rid="fig9">Figure 9C</xref>, third row) during active motion. This contrasts with Kalman filter simulations, where no sensory prediction errors occur during active motion.</p><p>A similar difference would also be seen during active translation (<xref ref-type="fig" rid="fig9">Figure 9E</xref>; same motion as in <xref ref-type="fig" rid="fig6">Figure 6</xref>). While the motion prediction (first row) would encode the active translation, the sensory estimate (second row) would be affected by the somatogravic effect (as in <xref ref-type="fig" rid="fig6">Figure 6</xref>), which causes the linear acceleration signal (red) to be replaced by a tilt illusion (green), also leading to motion prediction errors (third row). In contrast, the Kalman filter predicts that no sensory prediction error should occur during active translation.</p><p>These simulations indicate that processing motor and vestibular information independently would lead to prediction errors that would be avoided by the Kalman filter. Beyond theoretical arguments, this scheme may be rejected based on behavioral responses: Both rotation perception and the vestibulo-ocular reflex (VOR) decrease during sustained passive rotations, but persist indefinitely during active rotation (macaques: <xref ref-type="bibr" rid="bib97">Solomon and Cohen, 1992</xref>); humans: <xref ref-type="bibr" rid="bib38">Guedry and Benson (1983)</xref>; <xref ref-type="bibr" rid="bib43">Howard et al. (1998)</xref>; <xref ref-type="bibr" rid="bib46">Jürgens et al., 1999</xref>). In fact, this scheme cannot account for experimental findings, even if we consider different weighting for how the net self-motion signal is constructed from the independent motor and sensory estimates (<xref ref-type="fig" rid="fig9">Figure 9</xref>, bottom row). For example, if the sensory estimate is weighted 100%, rotation perception would decay during active motion (<xref ref-type="fig" rid="fig9">Figure 9C</xref>, bottom, dark blue), inconsistent with experimental results. If the motor prediction is weighted 100%, passive rotations would not be detected at all (<xref ref-type="fig" rid="fig9">Figure 9B,D</xref>, light blue). Finally, intermediate solutions (e.g. 50%/50%) would result in undershooting of both the steady state active (<xref ref-type="fig" rid="fig9">Figure 9C</xref>) and passive (<xref ref-type="fig" rid="fig9">Figure 9B,D</xref>) rotation perception estimates. Note also that, in all cases, the rotation after-effect would be identical during active and passive motion (<xref ref-type="fig" rid="fig9">Figure 9C,D</xref>, bottom), in contradiction with experimental findings (<xref ref-type="bibr" rid="bib97">Solomon and Cohen, 1992</xref>; <xref ref-type="bibr" rid="bib38">Guedry and Benson, 1983</xref>; <xref ref-type="bibr" rid="bib43">Howard et al., 1998</xref>).</p><p>Finally, the third alternative scheme (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1C</xref>), where sensory prediction error is used to cancel the input of a sensory internal model is, in fact, a more complicated version of the Kalman filter. This is because an internal model that processes motor commands to predict sensory signals must necessarily include an internal model of the sensors. Thus, simulations of the model in <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1C</xref> would be identical to the Kalman filter, by merely re-organizing the sequence of operations and uselessly duplicating some of the elements, to ultimately produce the same results.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We have tested the hypothesis that the brain uses, during active motion, exactly the same sensory internal model computations already discovered using passive motion stimuli (<xref ref-type="bibr" rid="bib70">Mayne, 1974</xref>; <xref ref-type="bibr" rid="bib79">Oman, 1982</xref>; <xref ref-type="bibr" rid="bib14">Borah et al., 1988</xref>; <xref ref-type="bibr" rid="bib76">Merfeld, 1995</xref>; <xref ref-type="bibr" rid="bib112">Zupan et al., 2002</xref>; <xref ref-type="bibr" rid="bib62">Laurens, 2006</xref>; <xref ref-type="bibr" rid="bib55">Laurens and Droulez, 2007</xref>; <xref ref-type="bibr" rid="bib56">Laurens and Droulez, 2008</xref>; <xref ref-type="bibr" rid="bib53">Laurens and Angelaki, 2011</xref>; <xref ref-type="bibr" rid="bib48">Karmali and Merfeld, 2012</xref>; <xref ref-type="bibr" rid="bib65">Lim et al., 2017</xref>). Presented simulations confirm the hypothesis that the <italic>same</italic> internal model (consisting of forward internal models of the canals, otoliths and neck proprioceptors) can reproduce behavioral and neuronal responses to <italic>both</italic> active and passive motions. The formalism of the Kalman filter allows predictions of internal variables during both active and passive motions, with a strong focus on sensory error and feedback signals, which we hypothesize are realized in the response patterns of central vestibular neurons.</p><p>Perhaps most importantly, this work resolves an apparent paradox in neuronal responses between active and passive movements (<xref ref-type="bibr" rid="bib3">Angelaki and Cullen, 2008</xref>), by placing them into a unified theoretical framework in which a single internal model tracks head motion based on motor commands and sensory feedback signals. Although particular cell types that encode sensory errors or feedback signals may not modulate during active movements because the corresponding sensory prediction error is negligible, the internal models of canal dynamics and otolith ambiguity operate continuously to generate the <italic>correct sensory prediction</italic> during <italic>both</italic> active and passive movements. Thus, the model presented here should eliminate the <italic>misinterpretation that vestibular signals are ignored during self-generated motion, and that internal model computations during passive motion are unimportant for every day’s life</italic>. We hope that this realization should also highlight the relevance and importance of passive motion stimuli, as critical experimental paradigms that can efficiently interrogate the network and unravel computational principles of natural motor activities, which cannot easily be disentangled during active movements.</p><sec id="s3-1"><title>Summary of the Kalman filter model</title><p>We have developed the first ever model that simulates self-motion estimates during both actively generated and passive head movements. This model, summarized schematically in <xref ref-type="fig" rid="fig10">Figure 10</xref>, transforms motor commands and Kalman filter feedback signals into internal estimates of head motion (rotation and translation) and predicted sensory signals. There are two important take-home messages: (1) Because of the physical properties of the two vestibular sense organs, the predicted motion generated from motor commands is not equal to predicted sensory signals (for example, the predicted rotation velocity is processed to account for canal dynamics in <xref ref-type="fig" rid="fig4">Figure 4</xref>). Instead, the predicted rotation, tilt and translation signals generated by efference copies of motor commands must be processed by the corresponding forward models of the sensors in order to generate accurate sensory predictions. This important insight about the nature of these internal model computations has not been appreciated by the qualitative schematic diagrams of previous studies. (2) In an environment devoid of externally generated passive motion, motor errors and sensory noise, the resulting sensory predictions would always match sensory afferent signals accurately. In a realistic environment, however, unexpected head motion occurs due to both motor errors and external perturbations (see ‘Role of the vestibular system during active motion: ecological, clinical and fundamental implications’). Sensory vestibular signals are then used to correct internal motion estimates through the computation of sensory errors and their transformation into Kalman feedback signals. Given two sensory errors (<inline-formula><mml:math id="inf431"><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:math></inline-formula> originating from the semicircular canals and <inline-formula><mml:math id="inf432"><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:math></inline-formula> originating from the otoliths) and four internal state variables (rotation, internal canal dynamics, tilt and linear acceleration: <inline-formula><mml:math id="inf433"><mml:mover accent="true"><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula>, <inline-formula><mml:math id="inf434"><mml:mover accent="true"><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula>, <inline-formula><mml:math id="inf435"><mml:mover accent="true"><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula>, <inline-formula><mml:math id="inf436"><mml:mover accent="true"><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula>), eight feedback signals must be constructed. However, in practice, two of these signals have negligible influence for all movements (<inline-formula><mml:math id="inf437"><mml:mi mathvariant="normal">δ</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:math></inline-formula> feedback to <inline-formula><mml:math id="inf438"><mml:mover accent="true"><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf439"><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:math></inline-formula> feedback to <inline-formula><mml:math id="inf440"><mml:mover accent="true"><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula>; see <xref ref-type="table" rid="table2">Table 2</xref> and Supplementary methods, ‘Kalman Feedback Gains’), thus only six elements are summarized in <xref ref-type="fig" rid="fig10">Figure 10</xref>.</p><fig-group><fig id="fig10" position="float"><object-id pub-id-type="doi">10.7554/eLife.28074.031</object-id><label>Figure 10.</label><caption><title>Schematic diagram of central vestibular computations.</title><p>This diagram is organized to offer a synthetic view of the processing elements, as well as their putative neural correlates. An internal model (top gray box) predicts head motion based on motor commands and receives feedback signals. The internal model computes predicted canal and otolith signals that are compared to actual canal and otolith inputs. The resulting sensory errors are transformed by the Kalman gain matrix into a series of feedback ‘error’ signals. Left: canal error feedback signals; Right: otolith error feedback signals. Rotation signals are spatially transformed (‘3D’ boxes) into tilt velocity signals. Ovals indicate putative neuronal correlates of the feedback signals (VN: vestibular only vestibular nuclei neurons; rFN: rostral fastigial nuclei neurons, PC: Purkinje cells in the caudal vermis, DCN: deep cerebellar nuclei).</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-28074-fig10-v2"/></fig><fig id="fig10s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.28074.032</object-id><label>Figure 10—figure supplement 1.</label><caption><title>Alternative diagram.</title><p>Where the Kalman feedback encoding passive tilt velocity is removed. Instead, a final rotation estimate <inline-formula><mml:math id="inf441"><mml:mover accent="true"><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> is computed and transformed into a tilt velocity signal.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-28074-fig10-figsupp1-v2"/></fig><fig id="fig10s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.28074.033</object-id><label>Figure 10—figure supplement 2.</label><caption><title>Influence of model parameters.</title><p>This figure recapitulates the consequences of increasing or decreasing the Kalman filter’s parameters (<inline-formula><mml:math id="inf442"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>: vestibular noise; <inline-formula><mml:math id="inf443"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>: standard deviation of prior distribution of passive rotation and rotational motor error; <inline-formula><mml:math id="inf444"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>: standard deviation of passive linear acceleration and translational motor error) by a factor of 2. (<bold>A,B</bold>) Influence during rotation (as in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1A,B</xref>). During passive rotation (solid lines), the rotation estimate decreases over time because (1) noise on the vestibular signal causes the rotation estimate of be unreliable and (2) the prior on rotation velocity drives the unreliable estimate towards zero. Accordingly, the time constant of the estimated rotation velocity decreases when vestibular noise increases or when the velocity prior is stronger (i.e. <inline-formula><mml:math id="inf445"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is low). There is also a slight decrease of the rotation estimate at t = 0 (that has a gain of 0.8, 0.94 and 0.98 when <inline-formula><mml:math id="inf446"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> varies from, 20°/s to 5°/s). During active rotation (broken line), the rotation estimate is driven by motor commands and independent of the model’s parameters (all lines are superimposed). (<bold>C,D</bold>) Influence during translation (as in <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). During passive translation (solid lines), the translation estimate decreases over time because (1) noise on the vestibular signal causes the estimate of tilt to be unreliable and (2) the prior on linear acceleration generates a tilt illusion that minimizes the acceleration estimate (the tilt estimate, not shown here, mirrors the translation estimate as in <xref ref-type="fig" rid="fig6">Figure 6</xref>). Accordingly, the time constant of the estimated translation decreases when vestibular noise increases or when the acceleration prior is stronger (i.e. <inline-formula><mml:math id="inf447"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is low). During active translation (broken line), the rotation estimate is driven by motor commands and thus is independent of the model’s parameters (all lines are superimposed). (<bold>E,F</bold>) Influence during tilt (as in <xref ref-type="fig" rid="fig5">Figure 5</xref>). During passive tilt, the estimated tilt is practically veridical, irrespective of model parameters, except when the vestibular noise is large (<bold>E</bold>) in which case the estimate undershoots head tilt transiently (light green line at t = 2 s) because the gain of the rotation estimate is lower.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-28074-fig10-figsupp2-v2"/></fig></fig-group><p>The non-negligible feedback signals originating from the canal error <inline-formula><mml:math id="inf448"><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:math></inline-formula> are as follows (<xref ref-type="fig" rid="fig10">Figure 10</xref>, left):</p><list list-type="bullet"><list-item><p>The feedback to the rotation estimate <inline-formula><mml:math id="inf449"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> represents the traditional ‘direct’ vestibular pathway (<xref ref-type="bibr" rid="bib81">Raphan et al., 1979</xref>; <xref ref-type="bibr" rid="bib53">Laurens and Angelaki, 2011</xref>). It is responsible for rotation perception during high-frequency (unexpected) vestibular stimulation, and has a gain close to unity.</p></list-item><list-item><p>The feedback to <inline-formula><mml:math id="inf450"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> feeds into the internal model of the canals, thus allowing compensation for canals dynamics. This pathway corresponds to the ‘velocity storage’ (<xref ref-type="bibr" rid="bib81">Raphan et al., 1979</xref>; <xref ref-type="bibr" rid="bib53">Laurens and Angelaki, 2011</xref>). Importantly, the contribution of this signal is significant for movements larger than ~1 s, particularly during high velocity rotations.</p></list-item><list-item><p>The feedback to tilt (<inline-formula><mml:math id="inf451"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>) converts canal errors into a tilt velocity (<inline-formula><mml:math id="inf452"><mml:mi>d</mml:mi><mml:mi>G</mml:mi><mml:mo>/</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:math></inline-formula>) signal, which is subsequently integrated by the internal model of head tilt.</p></list-item></list><p>The non-negligible feedback signals originating from the otolith error <inline-formula><mml:math id="inf453"><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:math></inline-formula> are as follows (<xref ref-type="fig" rid="fig9">Figure 9</xref>, right):</p><list list-type="bullet"><list-item><p>The feedback to linear acceleration (<inline-formula><mml:math id="inf454"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>) converts unexpected otolith activation into an acceleration signal and is responsible for acceleration perception during passive translations (as well as experimentally generated otolith errors; <xref ref-type="bibr" rid="bib75">Merfeld et al., 1999</xref>; <xref ref-type="bibr" rid="bib58">Laurens et al., 2013a</xref>).</p></list-item><list-item><p>The <inline-formula><mml:math id="inf455"><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:math></inline-formula> feedback to tilt (<inline-formula><mml:math id="inf456"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>) implements the somatogravic effect that acts to bias the internal estimate of gravity toward the net otolith signal <inline-formula><mml:math id="inf457"> <mml:mi/></mml:math></inline-formula>so as to reduce the otolith error.</p></list-item><list-item><p>The <inline-formula><mml:math id="inf458"><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:math></inline-formula> feedback to <inline-formula><mml:math id="inf459"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> plays a similar role with the feedback to tilt <inline-formula><mml:math id="inf460"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, that is, to reduce the otolith error; but acts indirectly by biasing the internal estimate of rotation in a direction which, after integration, drives the internal model of tilt so that it matches otolith signal (this feedback was called ‘velocity feedback’ in <xref ref-type="bibr" rid="bib53">Laurens and Angelaki, 2011</xref>). Behavioral studies (and model simulations) indicate that this phenomenon has low-frequency dynamics and results in the ability of otolith signals to estimate rotational velocity (<xref ref-type="bibr" rid="bib6">Angelaki and Hess, 1996</xref>; <xref ref-type="bibr" rid="bib41">Hess and Angelaki, 1993</xref>). Lesion studies have demonstrated that this feedback depends on an intact nodulus and ventral uvula, the vermal vestibulo-cerebellum (<xref ref-type="bibr" rid="bib4">Angelaki and Hess, 1995a</xref>; <xref ref-type="bibr" rid="bib5">Angelaki and Hess, 1995b</xref>).</p></list-item></list><p>The model in <xref ref-type="fig" rid="fig10">Figure 10</xref> is entirely compatible with previous models based on optimal passive self-motion computations (<xref ref-type="bibr" rid="bib79">Oman, 1982</xref>; <xref ref-type="bibr" rid="bib14">Borah et al., 1988</xref>; <xref ref-type="bibr" rid="bib76">Merfeld, 1995</xref>; <xref ref-type="bibr" rid="bib62">Laurens, 2006</xref>; <xref ref-type="bibr" rid="bib55">Laurens and Droulez, 2007</xref>; <xref ref-type="bibr" rid="bib56">Laurens and Droulez, 2008</xref>; <xref ref-type="bibr" rid="bib53">Laurens and Angelaki, 2011</xref>; <xref ref-type="bibr" rid="bib48">Karmali and Merfeld, 2012</xref>; <xref ref-type="bibr" rid="bib65">Lim et al., 2017</xref>; <xref ref-type="bibr" rid="bib112">Zupan et al., 2002</xref>). The present model is, however, distinct in two very important aspects: First, it takes into account active motor commands and integrates these commands with the vestibular sensory signals. Second, because it is formulated as a Kalman filter, it makes specific predictions about the feedback error signals, which constitute the most important nodes in understanding the neural computations underlying head motion sensation. Indeed, as will be summarized next, the properties of most cell types in the vestibular and cerebellar nuclei, as well as the vestibulo-cerebellum, appear to represent either sensory error or feedback signals.</p></sec><sec id="s3-2"><title>Vestibular and rostral fastigial neurons encode sensory error or feedback signals during rotation and translation</title><p>Multiple studies have reported that vestibular-only (erroneous term to describe ‘non-eye-movement-sensitive’) neurons in the VN encode selectively passive head rotation (<xref ref-type="bibr" rid="bib72">McCrea and Luan, 2003</xref>; <xref ref-type="bibr" rid="bib87">Roy and Cullen, 2001</xref>; <xref ref-type="bibr" rid="bib88">2004</xref>; <xref ref-type="bibr" rid="bib21">Brooks and Cullen, 2014</xref>) or passive translation (<xref ref-type="bibr" rid="bib22">Carriot et al., 2013</xref>), but suppress this activity during active head movements. In addition, a group of rostral fastigial nuclei (unimodal rFN neurons; <xref ref-type="bibr" rid="bib20">Brooks and Cullen, 2013</xref>; <xref ref-type="bibr" rid="bib18">Brooks et al., 2015</xref>) also selectively encodes passive (but not active) rotations. These rotation-responding VN/rFN neurons likely encode either the semicircular canal error <inline-formula><mml:math id="inf461"><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:math></inline-formula> itself or its Kalman feedback to the rotation estimate (blue in <xref ref-type="fig" rid="fig10">Figure 10</xref>, dashed and solid ovals ‘VN, rFN’, respectively). The translation-responding neurons likely encode either the otolith error <inline-formula><mml:math id="inf462"><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:math></inline-formula> or its feedback to the linear acceleration estimate (<xref ref-type="fig" rid="fig10">Figure 10</xref>, solid and dashed red lines ‘VN, trans PC’). Because error and feedback signals are proportional to each other in the experimental paradigms considered here, whether VN/rFN encode sensory errors or feedback signals cannot easily be distinguished using vestibular stimuli alone. Nevertheless, it is also important to emphasize that, while the large majority of VN and rFN neurons exhibit reduced responses during active head movements, this suppression is rarely complete (<xref ref-type="bibr" rid="bib71">McCrea et al., 1999</xref>; <xref ref-type="bibr" rid="bib87">Roy and Cullen, 2001</xref>; <xref ref-type="bibr" rid="bib20">Brooks and Cullen, 2013</xref>; <xref ref-type="bibr" rid="bib22">Carriot et al., 2013</xref>). Thus, neuronal responses likely encode mixtures of error/feedback and sensory motion signals (e.g. such as those conveyed by direct afferent inputs).</p><p>During large amplitude passive rotations (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>), the rotation estimate persists longer than the vestibular signal (<xref ref-type="fig" rid="fig4">Figure 4</xref>, blue; a property called velocity storage). Because the internal estimate is equal to the canal error, this implies that VN neurons (that encode the canal error) should exhibit dynamics that are different from those of canal afferents, having incorporated velocity storage signals. This has indeed been demonstrated in VN neurons during optokinetic stimulation (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>; <xref ref-type="bibr" rid="bib104">Waespe and Henn, 1977</xref>; <xref ref-type="bibr" rid="bib110">Yakushin et al., 2017</xref>) and rotation about tilted axes (<xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3</xref>; <xref ref-type="bibr" rid="bib82">Reisine and Raphan, 1992</xref>; <xref ref-type="bibr" rid="bib110">Yakushin et al., 2017</xref>).</p></sec><sec id="s3-3"><title>Thalamus-projecting VN neurons possibly encode final motion estimates</title><p>Based on the work summarized above, the final estimates of rotation (<xref ref-type="fig" rid="fig4">Figure 4G</xref>) and translation (<xref ref-type="fig" rid="fig6">Figure 6G</xref>), which are the desirable signals to drive both perception and spatial navigation, do not appear to be encoded by most VN/rFN cells. Thus, one may assume that they are reconstructed downstream, perhaps in thalamic (<xref ref-type="bibr" rid="bib68">Marlinski and McCrea, 2008</xref>; <xref ref-type="bibr" rid="bib74">Meng et al., 2007</xref>; <xref ref-type="bibr" rid="bib73">Meng and Angelaki, 2010</xref>) or cortical areas. Interestingly, more than half (57%) of ventral thalamic neurons (<xref ref-type="bibr" rid="bib68">Marlinski and McCrea, 2008</xref>) and an identical fraction (57%) of neurons of the VN cells projecting to the thalamus (<xref ref-type="bibr" rid="bib69">Marlinski and McCrea, 2009</xref>) respond similarly during passive and actively-generated head rotations. The authors emphasized that VN neurons with attenuated responses during actively-generated movements constitute only a small fraction (14%) of those projecting to the thalamus. Thus, although abundant in the VN, these passive motion-selective neurons may carry sensory error/feedback signals to the cerebellum, spinal cord or even other VN neurons (e.g. those coding the final estimates; <xref ref-type="bibr" rid="bib69">Marlinski and McCrea, 2009</xref>). Note that <xref ref-type="bibr" rid="bib29">Dale and Cullen, 2016</xref>, reported contrasting results where a large majority of ventral thalamus neurons exhibit attenuated responses during active motion. Even if not present in the ventral posterior thalamus, this signal should exist in the spatial perception/spatial navigation pathways. Thus, future studies should search for the neural correlates of the final self-motion signal. VN neurons identified physiologically to project to the cervical spinal cord do not to modulate during active rotations, so they could encode either passive head rotation or active and passive trunk rotation (<xref ref-type="bibr" rid="bib71">McCrea et al., 1999</xref>).</p><p>Furthermore, the dynamics of the thalamus-projecting VN neurons with similar responses to passive and active stimuli were not measured (<xref ref-type="bibr" rid="bib69">Marlinski and McCrea, 2009</xref>). Recall that the model predicts that final estimates of rotation differ from canal afferent signals only in their response dynamics (<xref ref-type="fig" rid="fig4">Figure 4</xref>, compare panels F and G). It would make functional sense that these VN neurons projecting to the thalamus follow the final estimate dynamics (i.e., they are characterized by a prolonged time constant compared to canal afferents) – and future experiments should investigate this hypothesis.</p></sec><sec id="s3-4"><title>Rostral fastigial neurons encoding passive trunk rotations</title><p>Another class of rFN neurons (and possibly VN neurons projecting to the thalamus; <xref ref-type="bibr" rid="bib69">Marlinski and McCrea, 2009</xref>, or those projecting to the spinal cord; <xref ref-type="bibr" rid="bib71">McCrea et al., 1999</xref>) specifically encodes passive trunk velocity in space, independently of head velocity (bimodal neurons; <xref ref-type="bibr" rid="bib19">Brooks and Cullen, 2009</xref>; <xref ref-type="bibr" rid="bib20">2013</xref>; <xref ref-type="bibr" rid="bib18">Brooks et al., 2015</xref>). These neurons likely encode Kalman feedback signals about trunk velocity (<xref ref-type="fig" rid="fig7">Figure 7</xref>, blue). Importantly, these neurons respond equivalently to passive whole trunk rotation when the trunk and the head rotate together (<xref ref-type="fig" rid="fig7">Figure 7A</xref>) and to passive trunk rotation when the head is space-fixed (<xref ref-type="fig" rid="fig7">Figure 7C</xref>). The first protocol activates the semicircular canals and induces a canal error <inline-formula><mml:math id="inf463"><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:math></inline-formula>, while the later activates neck proprioceptors and generates a proprioceptive error, <inline-formula><mml:math id="inf464"><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:math></inline-formula>. From a physiological point of view, this indicates that bimodal neurons respond to semicircular canals as well as neck proprioceptors (hence their name). Note that several other studies identified VN (<xref ref-type="bibr" rid="bib2">Anastasopoulos and Mergner, 1982</xref>), rFN (<xref ref-type="bibr" rid="bib51">Kleine et al., 2004</xref>) and anterior suprasylvian gyrus (<xref ref-type="bibr" rid="bib77">Mergner et al., 1985</xref>) neurons that encode trunk velocity during passive motion, but didn’t test their response to active motion.</p><p>The Kalman filter also predicts that neck proprioceptive signals that encode neck position should be transformed into error signals that encode neck velocity. In line with model predictions, bimodal neurons encode velocity signals that originate from neck proprioception during passive sinusoidal (1 Hz, <xref ref-type="bibr" rid="bib19">Brooks and Cullen, 2009</xref>) and transient (Gaussian velocity profile, <xref ref-type="bibr" rid="bib20">Brooks and Cullen, 2013</xref>) movements. Remarkably, although short-duration rotation of the trunk while the head is stationary in space leads to a veridical perception of trunk rotation, long duration trunk rotation leads to an attenuation of the perceived trunk rotation and a growing illusion of head rotation in the opposite direction (<xref ref-type="bibr" rid="bib78">Mergner et al., 1991</xref>). These experimental findings are also predicted by the Kalman filter model (<xref ref-type="fig" rid="fig7s5">Figure 7—figure supplement 5</xref>).</p></sec><sec id="s3-5"><title>Purkinje cells in the vestibulo-cerebellum encode tilt and acceleration feedback</title><p>The simple spike modulation of two distinct types of Purkinje cells in the caudal cerebellar vermis (lobules IX-X, Uvula and Nodulus) encodes tilt (tilt-selective cells) and translation (translation-selective cells) during three-dimensional motion (<xref ref-type="bibr" rid="bib109">Yakusheva et al., 2007</xref>, <xref ref-type="bibr" rid="bib107">2008</xref>, <xref ref-type="bibr" rid="bib108">2013</xref>; <xref ref-type="bibr" rid="bib58">Laurens et al., 2013a</xref>; <xref ref-type="bibr" rid="bib59">Laurens et al., 2013b</xref>). Therefore, it is possible that tilt- and translation selective cells encode tilt and acceleration feedback signals (<xref ref-type="fig" rid="fig10">Figure 10</xref>, green and red lines, respectively). If so, we hypothesize that their responses are suppressed during active motion (<xref ref-type="fig" rid="fig5">Figures 5</xref> and <xref ref-type="fig" rid="fig6">6</xref>). How Purkinje cells modulate during active motion is currently unknown. However, one study (<xref ref-type="bibr" rid="bib64">Lee et al., 2015</xref>) performed when rats learned to balance on a swing indicates that Purkinje cell responses that encode trunk motion are reduced during predictable movements, consistent with the hypothesis that they encode sensory errors or Kalman feedback signals.</p><p>Model simulations have also revealed that passive tilt does not induce any significant otolith error (<xref ref-type="fig" rid="fig5">Figure 5J</xref>). In contrast, passive tilt elicits a significant canal error (<xref ref-type="fig" rid="fig5">Figure 5K</xref>). Thus, we hypothesize that the tilt signal present in the responses of Purkinje cells originates from the canal error <inline-formula><mml:math id="inf465"><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:math></inline-formula> onto the tilt internal state variable. If it is indeed a canal, rather than an otolith, error, it should be proportional to tilt velocity instead of tilt position (or linear acceleration). Accordingly, we observed (<xref ref-type="bibr" rid="bib59">Laurens et al., 2013b</xref>) that tilt-selective Purkinje cell responses were on average close to velocity (average phase lag of 36° during sinusoidal tilt at 0.5 Hz). However, since sinusoidal stimuli are not suited for establishing dynamics (<xref ref-type="bibr" rid="bib57">Laurens et al., 2017</xref>), further experiments are needed to confirm that tilt-selective Purkinje cells indeed encode tilt velocity.</p><p>Model simulations have also revealed that passive translation, unlike passive tilt, should include an otolith error. This otolith error feeds also into the tilt internal variable (<xref ref-type="fig" rid="fig9">Figure 9</xref>, somatogravic feedback) and is responsible for the illusion of tilt during sustained passive linear acceleration (somatogravic effect; <xref ref-type="bibr" rid="bib37">Graybiel, 1952</xref>). Therefore, as summarized in <xref ref-type="fig" rid="fig10">Figure 10</xref> (green lines), both canal and otolith errors should feedback onto the tilt internal variable. The canal error should drive modulation during tilt, whereas the otolith error should drive modulation during translation. In support of these predictions, we have demonstrated that tilt-selective Purkinje cells also modulate during translation, with a gain and phase consistent with the simulated otolith-driven feedback (<xref ref-type="bibr" rid="bib59">Laurens et al., 2013b</xref>). Thus, both of these feedback error signals might be carried by caudal vermis Purkinje cells – and future experiments should address these predictions.</p><p>Note that semicircular canal errors must be spatially transformed in order to produce an appropriate tilt feedback. Indeed, converting a rotation into head tilt requires taking into account the angle between the rotation axis and earth-vertical. This transformation is represented by a bloc marked ‘3D’ in <xref ref-type="fig" rid="fig9">Figure 9</xref> (see also (<inline-formula><mml:math id="inf466"><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo> <mml:mi/><mml:mn>9</mml:mn></mml:math></inline-formula>) in Supplemenatry methods, ‘Three-Dimensional Kalman filter’. Importantly, we have established (<xref ref-type="bibr" rid="bib59">Laurens et al., 2013b</xref>) that tilt-selective Purkinje cells encode spatially transformed rotation signals, as predicted by theory. In fact, we have demonstrated that tilt-selective Purkinje cells do not simply modulate during vertical canal stimulation, but also carry the tilt signal during off-vertical axis yaw rotations (<xref ref-type="bibr" rid="bib59">Laurens et al., 2013b</xref>).</p><p>In this respect, it is important to emphasize that truly tilt-selective neurons exclusively encode changes in orientation relative to gravity, rather than being generically activated by vertical canal inputs. Thus, it is critical that this distinction is experimentally made using three-dimensional motion (see <xref ref-type="bibr" rid="bib59">Laurens et al., 2013b</xref>; <xref ref-type="bibr" rid="bib54">Laurens and Angelaki, 2015</xref>). Whereas 3D rotations have indeed been used to identify tilt-selective Purkinje cells in the vermis (<xref ref-type="bibr" rid="bib59">Laurens et al., 2013b</xref>; <xref ref-type="bibr" rid="bib109">Yakusheva et al., 2007</xref>), this is not true for other studies. For example, <xref ref-type="bibr" rid="bib95">Siebold et al., 1997</xref>, <xref ref-type="bibr" rid="bib96">Siebold et al., 1999</xref>, <xref ref-type="bibr" rid="bib94">2001</xref>), <xref ref-type="bibr" rid="bib54">Laurens and Angelaki, 2015</xref> and <xref ref-type="bibr" rid="bib111">Zhou et al. (2006)</xref> have reported tilt-modulated cells in the rFN and VN, respectively, but because these neurons were not tested in three dimensions, the signals carried by these neurons remain unclear.</p></sec><sec id="s3-6"><title>Further notes on tilt-selective Purkinje cells</title><p>As summarized above, the simple spike responses of tilt-selective Purkinje cells during passive motion have already revealed many details of the internal model computations. Thus, we have proposed that tilt- selective Purkinje cells encode the feedback signals about tilt, which includes scaled and processed (i.e. by a spatial transformation, green ‘3D’ box in <xref ref-type="fig" rid="fig10">Figure 10</xref>) versions of both canal and otolith sensory errors (<xref ref-type="fig" rid="fig10">Figure 10</xref>, green oval, ‘tilt PC?’). However, there could be alternative implementations of the Kalman filter, where tilt-selective Purkinje cells may not encode only feedback signals, as proposed next:</p><p>We note that motor commands <inline-formula><mml:math id="inf467"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> must be also be spatially processed (black ‘3D’ box in <xref ref-type="fig" rid="fig10">Figure 10</xref>) to contribute to the tilt prediction. One may question whether two distinct neuronal networks transform motor commands and canal errors independently (resulting in two ‘3D’ boxes in <xref ref-type="fig" rid="fig10">Figure 10</xref>). An alternative (<xref ref-type="fig" rid="fig10s1">Figure 10—figure supplement 1</xref>) would be that the brain merges motor commands and canal error to produce a final rotation estimate prior to performing this transformation. From a mathematical point of view, this alternative would only require a re-arrangement of the Kalman filter equations, which would not alter any of the model’s conclusions. However, tilt-selective Purkinje cells, which encode a spatially transformed signal, would then carry a mixture of predictive and feedback signals and would therefore respond identically to active and passive tilt velocity. Therefore, the brain may perform a spatial transformation of predictive and feedback rotation signals independently (<xref ref-type="fig" rid="fig10">Figure 10</xref>); or may merge them before transforming them (<xref ref-type="fig" rid="fig10s1">Figure 10—figure supplement 1</xref>). Recordings from tilt-selective Purkinje cells during active movements will distinguish between these alternatives.</p></sec><sec id="s3-7"><title>Summary of the neural implementation of sensory error and feedback signals</title><p>In summary, many of the response properties described by previous studies for vestibular nuclei and cerebellar neurons can be assigned a functional ‘location’ within the Kalman filter model. Interestingly, most of the central neurons fit well with the properties of sensory errors and/or feedback signals. That an extensive neural machinery has been devoted to feedback signals is not surprising, given their functional importance for self-motion estimation. For many of these signals, a distinction between sensory errors and feedback signals is not easily made. That is, rotation-selective VN and rFN neurons can encode either canal error (<xref ref-type="fig" rid="fig10">Figure 10</xref>, bottom, dashed blue oval) or rotation feedback (<xref ref-type="fig" rid="fig10">Figure 10</xref>, bottom, solid blue oval). Similarly, translation-selective VN, rFN and Purkinje cells can encode either otolith error (<xref ref-type="fig" rid="fig10">Figure 10</xref>, bottom, dashed red oval) or translation feedback (<xref ref-type="fig" rid="fig10">Figure 10</xref>, bottom, solid red oval). The only feedback that is easily distinguished based on currently available data is the tilt feedback (<xref ref-type="fig" rid="fig10">Figure 10</xref>, green lines).</p><p>Although the blue, green and red feedback components of <xref ref-type="fig" rid="fig10">Figure 10</xref> can be assigned to specific cell groups, this is not the case with the cyan feedback components. First, note that, like the tilt variable, the canal internal model variable, receives non-negligible feedback contributions from both the canal and otolith sensory errors (<xref ref-type="fig" rid="fig10">Figure 10</xref>, cyan lines). The canal feedback error changes the time constant of the rotation estimate (<xref ref-type="fig" rid="fig4">Figure 4</xref> and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplements 1</xref> and <xref ref-type="fig" rid="fig4s3">3</xref>), whereas the otolith feedback error may suppress (post-rotatory tilt) or create (horizontal axis rotation) a rotation estimate (<xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3</xref>). The neuronal implementations of the internal model of the canals (<inline-formula><mml:math id="inf468"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>), and of its associated feedback pathways, are currently unknown. However, lesion studies clearly indicate that the caudal cerebellar vermis, lobules X and IX may influence the canal internal model state variable (<xref ref-type="bibr" rid="bib4">Angelaki and Hess, 1995a</xref>; <xref ref-type="bibr" rid="bib5">Angelaki and Hess, 1995b</xref>; <xref ref-type="bibr" rid="bib105">Wearne et al., 1998</xref>). In fact, it is possible that the simple-spike output of the translation-selective Purkinje cells also carries the otolith sensory error feedback to the canal internal model state variable (<xref ref-type="fig" rid="fig10">Figure 10</xref>, bottom, cyan arrow passing though the dashed red ellipse). Similarly, the canal error feedback to the canal internal model state variable (<xref ref-type="fig" rid="fig10">Figure 10</xref>, bottom, cyan arrow originating from the dashed blue ellipse) can originate from VN or rFN cells that selectively encode passive, not active, head rotation (<xref ref-type="fig" rid="fig4">Figure 4J</xref>, note that the <inline-formula><mml:math id="inf469"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> feedback is but a scaled-down version of the <inline-formula><mml:math id="inf470"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> feedback).</p><p>Thus, although the feedback error signals to the canal internal model variable can be linked to known neural correlates, cells coding for the state variable <inline-formula><mml:math id="inf471"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> exclusively have not been identified. It is possible that the hidden variable <inline-formula><mml:math id="inf472"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> may be coded in a distributed fashion. After all, as already stated above, VN and rFN neurons have also been shown to carry mixed signals - they can respond to both rotation and translation, as well as they may carry both feedback/error and actual sensory signals. Thus, it is important to emphasize that these Kalman variables and error signals may be represented in a multiplexed way, where single neurons manifest mixed selectivity to more than just one internal state and/or feedback signals. This appears to be an organizational principle both in central vestibular areas (<xref ref-type="bibr" rid="bib57">Laurens et al., 2017</xref>) and throughout the brain (<xref ref-type="bibr" rid="bib84">Rigotti et al., 2013</xref>; <xref ref-type="bibr" rid="bib32">Fusi et al., 2016</xref>). It has been proposed that mixed selectivity has an important computational advantage: high-dimensional representations with mixed selectivity allow a simple linear readout to generate a diverse array of potential responses (<xref ref-type="bibr" rid="bib32">Fusi et al., 2016</xref>). In contrast, representations based on highly specialized neurons are low dimensional and may preclude a linear readout from generating several responses that depend on multiple task-relevant variables.</p></sec><sec id="s3-8"><title>Recalibration of motor internal model computations during proprioceptive mismatch</title><p>In this treatment, we have considered primarily the importance of the internal models of the sensors to emphasize its necessity for both self-generated motor commands and unpredicted, external perturbations. It is important to point out that self-generated movements involve internal model computations that have been studied extensively in the field of motor control and motor adaptation (<xref ref-type="bibr" rid="bib106">Wolpert et al., 1995</xref>; <xref ref-type="bibr" rid="bib52">Körding and Wolpert, 2004</xref>; <xref ref-type="bibr" rid="bib100">Todorov, 2004</xref>; <xref ref-type="bibr" rid="bib24">Chen-Harris et al., 2008</xref>; <xref ref-type="bibr" rid="bib11">Berniker et al., 2010</xref>; <xref ref-type="bibr" rid="bib10">Berniker and Kording, 2011</xref>; <xref ref-type="bibr" rid="bib31">Franklin and Wolpert, 2011</xref>; <xref ref-type="bibr" rid="bib90">Saglam et al., 2011</xref>; <xref ref-type="bibr" rid="bib91">2014</xref>). While the question of motor adaptation are not addressed directly in the present study, experiments in which resistive or assistive torques are applied to the head (<xref ref-type="bibr" rid="bib18">Brooks et al., 2015</xref>) or in which active movements are entirely blocked (<xref ref-type="bibr" rid="bib88">Roy and Cullen, 2004</xref>; <xref ref-type="bibr" rid="bib22">Carriot et al., 2013</xref>) reveal how central vestibular pathways respond in situations that cause motor adaptation. Under these conditions, central neurons have been shown to encode net head motion (i.e. active and passive indiscriminately) with a similar gain as during passive motion (<xref ref-type="fig" rid="fig7s6">Figure 7—figure supplements 6</xref> and <xref ref-type="fig" rid="fig7s7">7</xref>). This may be interpreted and modeled by assuming that central vestibular pathways cease to integrate copies of motor commands (<xref ref-type="fig" rid="fig7s6">Figure 7—figure supplement 6</xref>) whenever active head motion is perturbed, until the internal model of the motor plant recalibrates to anticipate this perturbation (<xref ref-type="bibr" rid="bib18">Brooks et al., 2015</xref>). Further analysis of these experimental results (<xref ref-type="fig" rid="fig7s7">Figure 7—figure supplement 7</xref>) indicate that they are fundamentally non-linear and cannot be reproduced by the Kalman filter (which is limited to linear operations) and therefore requires the addition of an external gating mechanism (black pathway in <xref ref-type="fig" rid="fig1">Figure 1D</xref>).</p><p>Notably, this nonlinearity is triggered with proprioceptive mismatch, that is, when there is a discrepancy between the intended head position and proprioceptive feedback. Note that perturbing head motion also induces a vestibular mismatch since it causes the head velocity to differ from the motor plan. However, central vestibular neurons still encode specifically passive head movement during vestibular mismatch, as can be shown by superimposing passive whole body rotations to active movements (<xref ref-type="bibr" rid="bib20">Brooks and Cullen, 2013</xref>; <xref ref-type="bibr" rid="bib21">2014</xref>; <xref ref-type="bibr" rid="bib22">Carriot et al., 2013</xref>) and illustrated in the model predictions of <xref ref-type="fig" rid="fig8">Figure 8</xref>. Remarkably, the elementary and fundamental difference between these different types of computations has never before been presented in a single theoretical framework.</p><p>Proprioceptive mismatch is likely a specific indication that the internal model of the motor plant (necessary for accurate motor control; <xref ref-type="fig" rid="fig1">Figure 1D</xref>, red) needs to be recalibrated. Applying resistive head torques (<xref ref-type="bibr" rid="bib18">Brooks et al., 2015</xref>) or increasing head inertia (<xref ref-type="bibr" rid="bib90">Saglam et al., 2011</xref>; <xref ref-type="bibr" rid="bib91">2014</xref>) does indeed induce motor adaptation which is not modeled in the present study (but see <xref ref-type="bibr" rid="bib9">Berniker and Kording, 2008</xref> ). Interestingly, the studies by <xref ref-type="bibr" rid="bib90">Saglam et al. (2011)</xref>, <xref ref-type="bibr" rid="bib91">2014</xref>) indicate that healthy subjects use a re-calibrated model of the motor plant to restore optimal motor performance, but that vestibular deficient patients fail to do so, indicating that vestibular error signals participate in motor adaptation (<xref ref-type="fig" rid="fig1">Figure 1D</xref>, broken blue arrow).</p></sec><sec id="s3-9"><title>Relation to previous dynamical models</title><p>The internal model framework has been widely used to simulate optimal motor control strategies (<xref ref-type="bibr" rid="bib100">Todorov, 2004</xref>; <xref ref-type="bibr" rid="bib24">Chen-Harris et al., 2008</xref>; <xref ref-type="bibr" rid="bib90">Saglam et al., 2011</xref>; <xref ref-type="bibr" rid="bib91">2014</xref>) and to create Kalman filter models of reaching movements (<xref ref-type="bibr" rid="bib9">Berniker and Kording, 2008</xref>) and postural control (<xref ref-type="bibr" rid="bib102">van der Kooij et al., 2001</xref>). The present model, however, is to our knowledge the first to apply these principles to optimal head movement perception during active and passive motion. As such, it makes explicit links between sensory dynamics (i.e. the canals), ambiguities (i.e. the otoliths), priors and motor efference copies. Perhaps most importantly, the focus of this study has been to explain neuronal response properties. By simulating and explaining neuronal responses during active and passive self-motion in the light of a quantitative model, this study advances our understanding of how theoretical principles about optimal combinations of motor signals, multiple sensory modalities with distinct dynamic properties and ambiguities and Bayesian priors map onto brainstem and cerebellar circuits.</p><p>To simplify the main framework and associated predictions, as well as the in-depth mathematical analyses of the model’s dynamics (Supplementary methods), we have presented a linearized one-dimensional model. This model was used to simulate either rotations around an earth-vertical axis or combinations of translation and rotations around an earth-horizontal axis. A more natural and general way to simulate self-motion information processing is to design a three-dimensional Kalman filter model. Such models have been used in previous studies, either by programming Kalman filters explicitly (<xref ref-type="bibr" rid="bib14">Borah et al., 1988</xref>; <xref ref-type="bibr" rid="bib65">Lim et al., 2017</xref>), or by building models based on the Kalman filter framework (<xref ref-type="bibr" rid="bib36">Glasauer, 1992</xref>; <xref ref-type="bibr" rid="bib76">Merfeld, 1995</xref>; <xref ref-type="bibr" rid="bib35">Glasauer and Merfeld, 1997</xref>; <xref ref-type="bibr" rid="bib15">Bos et al., 2001</xref>; <xref ref-type="bibr" rid="bib112">Zupan et al., 2002</xref>). We show in Supplementary methods, ‘Three-dimensional Kalman filter’, how to generalize the model to three dimensions.</p><p>The passive motion components of the model presented here are to a large extent identical to the Particle filter Bayesian model in (<xref ref-type="bibr" rid="bib62">Laurens, 2006</xref>; <xref ref-type="bibr" rid="bib55">Laurens and Droulez, 2007</xref>,<xref ref-type="bibr" rid="bib56">Laurens and Droulez, 2008</xref>; <xref ref-type="bibr" rid="bib53">Laurens and Angelaki, 2011</xref>), which we have re-implemented as a Kalman filter, and into which we incorporated motor commands. One fundamental aspect of previous Bayesian models (<xref ref-type="bibr" rid="bib62">Laurens, 2006</xref>; <xref ref-type="bibr" rid="bib55">Laurens and Droulez, 2007</xref>,<xref ref-type="bibr" rid="bib56">Laurens and Droulez, 2008</xref>) is the explicit use of two Bayesian priors that prevent sensory noise from accumulating over time. These priors encode the natural statistics of externally generated motion or motion resulting from motor errors and unexpected perturbations. Because, on average, rotation velocities and linear accelerations are close to zero, these Bayesian priors are responsible for the decrease of rotation estimates during sustained rotation (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>) and for the somatogravic effect (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>) (see <xref ref-type="bibr" rid="bib53">Laurens and Angelaki, 2011</xref>) for further explanations). The influence of the priors is higher when the statistical distributions of externally generated rotation (<inline-formula><mml:math id="inf473"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>) and acceleration (<inline-formula><mml:math id="inf474"><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>) are narrower (<xref ref-type="fig" rid="fig10s2">Figure 10—figure supplement 2</xref>), that is when their standard deviation is smaller. Stronger priors reduce the gain and time constant of rotation and acceleration estimates (<xref ref-type="fig" rid="fig10s2">Figure 10—figure supplement 2B,D</xref>). Importantly, the Kalman filter model predicts that the priors affect only the passive, but not the active, self-motion final estimates. Indeed, the rotation and acceleration estimates last indefinitely during simulated active motion (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>, <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>, <xref ref-type="fig" rid="fig10s2">Figure 10—figure supplement 2</xref>). In this respect, the Kalman filter may explain why the time constant of the vestibulo-ocular reflex is reduced in figure ice skaters (<xref ref-type="bibr" rid="bib98">Tanguy et al., 2008</xref>; <xref ref-type="bibr" rid="bib1">Alpini et al., 2009</xref>): The range of head velocities experienced in these activities is wider than normal. In previous Bayesian models, we found that widening the rotation prior should increase the time constant of vestibular responses, apparently in contradiction with these experimental results. However, these models did not consider the difference between active and passive stimuli. The formalism of the Kalman filter reveals that Bayesian priors should reflect the distribution of passive motion or motor errors. In athletes that are highly trained to perform stereotypic movements, this distribution likely narrows, resulting in stronger priors and reduced vestibular responses.</p></sec><sec id="s3-10"><title>Further behavioral evidence of optimal combination of vestibular signals and efference copies</title><p>One of the predictions of the Kalman filter is that motion illusions, such as the disappearance of rotation perception during long-duration rotation and the ensuing post-rotatory response (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1B</xref>) should not occur during active motion (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1A</xref>). This has indeed been observed in monkeys (<xref ref-type="bibr" rid="bib97">Solomon and Cohen, 1992</xref>) and humans, where steady-state per-rotatory responses plateau at 10°/s and post-rotatory responses are decreased by a similar amount (<xref ref-type="bibr" rid="bib38">Guedry and Benson, 1983</xref>; <xref ref-type="bibr" rid="bib43">Howard et al., 1998</xref>); see also <xref ref-type="bibr" rid="bib16">Brandt et al., 1977a</xref>). The fact that post-rotatory responses are reduced following active, as compared to passive, rotations is of particular interest, because it demonstrates that motor commands influence rotation perception even after the movement has stopped. As shown in <xref ref-type="fig" rid="fig4">Figure 4</xref>, The Kalman filter reproduces this effect by feeding motor commands though an internal model of the canals. As shown in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>, this process is equivalent to the concept of ‘velocity storage’ (<xref ref-type="bibr" rid="bib81">Raphan et al., 1979</xref>; see <xref ref-type="bibr" rid="bib62">Laurens, 2006</xref>, <xref ref-type="bibr" rid="bib56">Laurens and Droulez, 2008</xref>, <xref ref-type="bibr" rid="bib66">MacNeilage et al. (2008)</xref>, <xref ref-type="bibr" rid="bib53">Laurens and Angelaki (2011)</xref> for a Bayesian interpretation of the concept of velocity storage). Therefore, the functional significance of this network, including velocity storage, is found during natural active head movements (see also <xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>), rather than during passive low-frequency rotations with which it has been traditionally associated with in the past (but see <xref ref-type="bibr" rid="bib53">Laurens and Angelaki, 2011</xref>).</p><p>A recent study (<xref ref-type="bibr" rid="bib67">MacNeilage and Glasauer, 2017</xref>) evaluated how motor noise varies across locomotor activities and within gait cycles when walking. They found that motor noise peaks shortly before heel strike and after toe off; and is minimal during swing periods. They interpreted experimental findings using principles of sensory fusion, an approach that uses the same principles of optimal cue combination as the Kalman filter but doesn’t include dynamics. Interestingly, this analysis showed that vestibular cues should have a maximal effect when motor noise peaks, in support with experimental observations (<xref ref-type="bibr" rid="bib17">Brandt et al., 1999</xref>; <xref ref-type="bibr" rid="bib44">Jahn et al., 2000</xref>).</p><p>To avoid further complications to the solution to the Kalman filter gains, the presented model does not consider how the brain generates motor commands in response to vestibular stimulation, e.g. to stabilize the head in response to passive motion or to use vestibular signals to correct motor commands. This would require an additional feedback pathway - the reliance of motor command generation on sensory estimates (<xref ref-type="fig" rid="fig1">Figure 1D</xref>, blue broken arrow). For example, a passive head movement could result in a stabilizing active motor command. Or an active head movement could be less than desired because of noise, requiring an adjustment of the motor command to compensate. These feedback pathways have been included in previous Kalman filter models (e.g. <xref ref-type="bibr" rid="bib102">van der Kooij et al., 2001</xref>), a study that focused specifically on postural control and reproduced human postural sway under a variety of conditions. Thus, the Kalman filter framework may be extended to model neuronal computations underlying postural control as well as the vestibulo-collic reflex.</p></sec><sec id="s3-11"><title>Role of the vestibular system during active motion: ecological, clinical and fundamental implications</title><p>Neuronal recordings (<xref ref-type="bibr" rid="bib20">Brooks and Cullen, 2013</xref>; <xref ref-type="bibr" rid="bib21">2014</xref>; <xref ref-type="bibr" rid="bib22">Carriot et al., 2013</xref>) and the present modeling unambiguously demonstrate that central neurons respond to unexpected motion during active movement (a result that we reproduced in <xref ref-type="fig" rid="fig8">Figure 8G–I</xref>). Beyond experimental manipulations, a number of processes may cause unpredictable motion to occur in natural environments. When walking on tree branches, boulders or soft grounds, the support surface may move under the feet, leading to unexpected trunk motion. A more dramatic example of unexpected trunk motion, that requires immediate correction, occurs when slipping or tripping. Complex locomotor activities involve a variety of correction mechanism among which spinal mechanisms and vestibular feedback play preeminent roles (<xref ref-type="bibr" rid="bib50">Keshner et al., 1987</xref>; <xref ref-type="bibr" rid="bib13">Black et al., 1988</xref>; <xref ref-type="bibr" rid="bib42">Horstmann and Dietz, 1988</xref>).</p><p>The contribution of the vestibular system for stabilizing posture is readily demonstrated by considering the impact of chronic bilateral vestibular deficits. While most patients retain an ability to walk on firm ground and even perform some sports (<xref ref-type="bibr" rid="bib25">Crawford, 1964</xref>; <xref ref-type="bibr" rid="bib39">Herdman, 1996</xref>), vestibular deficit leads to an increased incidence of falls (<xref ref-type="bibr" rid="bib40">Herdman et al., 2000</xref>), difficulties in walking on uneven terrains and deficits in postural responses to perturbations (<xref ref-type="bibr" rid="bib50">Keshner et al., 1987</xref>; <xref ref-type="bibr" rid="bib13">Black et al., 1988</xref>; <xref ref-type="bibr" rid="bib85">Riley, 2010</xref>). This confirms that vestibular signals are important during active motion, especially in challenging environments. In this respect, the Kalman filter framework appears particularly well suited for understanding the effect of vestibular lesions.</p><p>As mentioned earlier, vestibular sensory errors also occur when the internal model of the motor apparatus is incorrect (<xref ref-type="bibr" rid="bib18">Brooks et al., 2015</xref>) and these errors can lead to recalibration of internal models. This suggests that vestibular error signals during self-generated motion may play two fundamental roles: (1) updating self-motion estimates and driving postural or motor corrections, and (2) providing teaching signals to internal models of motor control (<xref ref-type="bibr" rid="bib106">Wolpert et al., 1995</xref>) and therefore facilitating motor learning. This later point is supported by the finding that patients with vestibular deficits fail to recalibrate their motor strategies to account for changes in head inertia (<xref ref-type="bibr" rid="bib91">Sağlam et al., 2014</xref>).</p><p>But perhaps most importantly, the model presented here should eliminate the misinterpretation that vestibular signals are ignored during self-generated motion – and that passive motion stimuli are old-fashioned and should no longer be used in experiments. Regarding the former conclusion, the presented simulations highlight the role of the internal models of canal dynamics and otolith ambiguity, which operate continuously to generate the <italic>correct sensory prediction</italic> during <italic>both</italic> active and passive movements. Without these internal models, the brain would be unable to correctly predict sensory canal and otolith signals and everyday active movements would lead to sensory mismatch (e.g. for rotations, see <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplements 2</xref> and <xref ref-type="fig" rid="fig4s3">3</xref>). Thus, even though particular nodes (neurons) in the circuit show attenuated or no modulation during active head rotations, vestibular processing remains the same - the internal model is both engaged and critically important for accurate self-motion estimation, even during actively-generated head movements. Regarding the latter conclusion, it is important to emphasize that passive motion stimuli have been, and continue to be, extremely valuable in revealing salient computations that would have been amiss if the brain’s intricate wisdom was interrogated only with self-generated movements.</p><p>Furthermore, a quantitative understanding of how efference copies and vestibular signals interact for accurate self-motion sensation is primordial for our understanding of many other brain functions, including balance and locomotor control. As stated in <xref ref-type="bibr" rid="bib10">Berniker and Kording (2011)</xref>: ‘A crucial first step for motor control is therefore to integrate sensory information reliably and accurately’, and practically any locomotor activity beyond reaching movements in seated subjects will affect posture and therefore recruit the vestibular sensory modality. It is thus important for both motor control and spatial navigation functions (for which intact vestibular cues appear to be critical; <xref ref-type="bibr" rid="bib99">Taube, 2007</xref>) to correct the misconception of incorrectly interpreting that vestibular signals are cancelled and thus are not useful during actively generated movements. By providing a state-of-the-art model of self-motion processing during active and passive motion, we are bridging several noticeable gaps between the vestibular and motor control/navigation fields.</p></sec><sec id="s3-12"><title>Conclusion</title><p>‘A good model has a delightful way of building connections between phenomena that never would have occurred to one’ (<xref ref-type="bibr" rid="bib86">Robinson, 1977</xref>). Four decades later, this beautifully applies here, where the mere act of considering how the brain should process self-generated motion signals in terms of mathematical equations (instead of schematic diagrams) immediately revealed a striking similarity with models of passive motion processing and, by motivating this work, opened an avenue to resolve a standing paradox in the field.</p><p>The internal model framework and the series of quantitative models it has spawned have explained and simulated behavioral and neuronal responses to self-motion using a long list of passive motion paradigms, and with a spectacular degree of accuracy (<xref ref-type="bibr" rid="bib70">Mayne, 1974</xref>; <xref ref-type="bibr" rid="bib79">Oman, 1982</xref>; <xref ref-type="bibr" rid="bib14">Borah et al., 1988</xref>; <xref ref-type="bibr" rid="bib36">Glasauer, 1992</xref>; <xref ref-type="bibr" rid="bib76">Merfeld, 1995</xref>; <xref ref-type="bibr" rid="bib35">Glasauer and Merfeld, 1997</xref>; <xref ref-type="bibr" rid="bib15">Bos et al., 2001</xref>; <xref ref-type="bibr" rid="bib112">Zupan et al., 2002</xref>; <xref ref-type="bibr" rid="bib62">Laurens, 2006</xref>; <xref ref-type="bibr" rid="bib55">Laurens and Droulez, 2007</xref>,<xref ref-type="bibr" rid="bib56">Laurens and Droulez, 2008</xref>; <xref ref-type="bibr" rid="bib53">Laurens and Angelaki, 2011</xref>; <xref ref-type="bibr" rid="bib48">Karmali and Merfeld, 2012</xref>; <xref ref-type="bibr" rid="bib65">Lim et al., 2017</xref>). Internal models also represent the predominant theoretical framework for studying motor control (<xref ref-type="bibr" rid="bib106">Wolpert et al., 1995</xref>; <xref ref-type="bibr" rid="bib52">Körding and Wolpert, 2004</xref>; <xref ref-type="bibr" rid="bib100">Todorov, 2004</xref>; <xref ref-type="bibr" rid="bib24">Chen-Harris et al., 2008</xref>; <xref ref-type="bibr" rid="bib11">Berniker et al., 2010</xref>; <xref ref-type="bibr" rid="bib10">Berniker and Kording, 2011</xref>; <xref ref-type="bibr" rid="bib31">Franklin and Wolpert, 2011</xref>; <xref ref-type="bibr" rid="bib90">Saglam et al., 2011</xref>; <xref ref-type="bibr" rid="bib91">2014</xref>). The vestibular system shares many common questions with the motor control field, such as that of 3D coordinate transformations and dynamic Bayesian inference, but, being considerably simpler, can be modeled and studied using relatively few variables. As a result, head movements represent a valuable model system for investigating the neuronal implementation of computational principles that underlie motor control. The present study thus offers the theoretical framework which will likely assist in understanding neuronal computations that are essential to active self-motion perception, spatial navigation, balance and motor activity in everyday life.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Structure of a Kalman filter</title><p>In a Kalman filter (<xref ref-type="bibr" rid="bib47">Kalman, 1960</xref>), state variables <inline-formula><mml:math id="inf475"><mml:mi>X</mml:mi></mml:math></inline-formula> are driven by their own dynamics (matrix <inline-formula><mml:math id="inf476"><mml:mi>D</mml:mi></mml:math></inline-formula>), motor commands <inline-formula><mml:math id="inf477"><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and unpredictable perturbations resulting from motor noise and external influence <inline-formula><mml:math id="inf478"><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> through the equation (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2A</xref>):<disp-formula id="equ1"><mml:math id="m1"><mml:mi>X</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mo>.</mml:mo><mml:mi>X</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>M</mml:mi><mml:mo>.</mml:mo><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>E</mml:mi><mml:mo>.</mml:mo><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:math></disp-formula></p><p>where matrices <inline-formula><mml:math id="inf479"><mml:mi>M</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf480"><mml:mi>E</mml:mi></mml:math></inline-formula> reflect the response to motor inputs and perturbations, respectively.</p><p>A set of sensors, grouped in a variable <inline-formula><mml:math id="inf481"><mml:mi>S</mml:mi></mml:math></inline-formula>, measure state variables transformed by a matrix <inline-formula><mml:math id="inf482"><mml:mi>T</mml:mi></mml:math></inline-formula>, and are modeled as:<disp-formula id="equ2"><mml:math id="m2"><mml:mi>S</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mo>.</mml:mo><mml:mi>X</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo> <mml:mi/><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf483"><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is Gaussian sensory noise (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2A</xref>, right). The model assumes that the brain has an exact knowledge of the forward model, that is, of <inline-formula><mml:math id="inf484"><mml:mi>D</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf485"><mml:mi>M</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf486"><mml:mi>E</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf487"><mml:mi>T</mml:mi></mml:math></inline-formula> as well as the variances of <inline-formula><mml:math id="inf488"><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf489"><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>. Furthermore, the brain knows the values of the motor inputs <inline-formula><mml:math id="inf490"><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and sensory signals <inline-formula><mml:math id="inf491"><mml:mi>S</mml:mi></mml:math></inline-formula>, but doesn’t have access to the actual values of <inline-formula><mml:math id="inf492"><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf493"><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>.</p><p>At each time <inline-formula><mml:math id="inf494"><mml:mi>t</mml:mi></mml:math></inline-formula>, the Kalman filter computes a preliminary estimate (also called a prediction) <inline-formula><mml:math id="inf495"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mo>.</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>M</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and a corresponding predicted sensory signal <inline-formula><mml:math id="inf496"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mo>.</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2B</xref>). In general, the resulting state estimate <inline-formula><mml:math id="inf497"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and the predicted sensory prediction <inline-formula><mml:math id="inf498"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> may differ from the real values <inline-formula><mml:math id="inf499"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf500"><mml:mi>S</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> because: (1) <inline-formula><mml:math id="inf501"><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>, but the brain cannot predict the perturbation <inline-formula><mml:math id="inf502"><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, (2) the brain does not know the value of the sensory noise <inline-formula><mml:math id="inf503"><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> and (3) the previous estimate <inline-formula><mml:math id="inf504"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> used to compute <inline-formula><mml:math id="inf505"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> could be incorrect. These errors are reduced using sensory information, as follows (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2B</xref>). First, this prediction <inline-formula><mml:math id="inf506"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and the sensory input <inline-formula><mml:math id="inf507"><mml:mi>S</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> are compared to compute a sensory error <inline-formula><mml:math id="inf508"><mml:mi>δ</mml:mi><mml:mi>S</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math></inline-formula> Second, sensory errors are then transformed into a feedback <inline-formula><mml:math id="inf509"><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>K</mml:mi><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>S</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> where <inline-formula><mml:math id="inf510"><mml:mi>K</mml:mi></mml:math></inline-formula> is a matrix of feedback gains. Thus, an improved estimate at time <inline-formula><mml:math id="inf511"><mml:mi>t</mml:mi></mml:math></inline-formula> is <inline-formula><mml:math id="inf512"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>K</mml:mi><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. The value of the feedback gain matrix <inline-formula><mml:math id="inf513"><mml:mi>K</mml:mi></mml:math></inline-formula> determines how sensory errors (and therefore sensory signals) are used to compute the final estimate <inline-formula><mml:math id="inf514"><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> and is computed based on <inline-formula><mml:math id="inf515"><mml:mi>D</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf516"><mml:mi>E</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf517"><mml:mi>T</mml:mi></mml:math></inline-formula> and on the variances of <inline-formula><mml:math id="inf518"><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf519"><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> (see Supplementary methods, ‘Kalman filter algorithm’).</p><p>In the case of the self-motion model, the motor commands <inline-formula><mml:math id="inf520"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf521"><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> are inputs to the Kalman filter (<xref ref-type="fig" rid="fig2">Figure 2</xref>). Note that, while the motor system may actually control other variables (such as forces or accelerations), we consider that these variables are converted into <inline-formula><mml:math id="inf522"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf523"><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>. We demonstrate in Supplementary methods,’ Model of motor commands’ that altering these assumptions does not alter our conclusions. In addition to motor commands, a variety of unpredictable factors such as motor noise and external (passive) motion also affect <inline-formula><mml:math id="inf524"><mml:mi>Ω</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf525"><mml:mi>A</mml:mi></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib67">MacNeilage and Glasauer, 2017</xref>). The total rotation and acceleration components resulting from these factors are modeled as variables <inline-formula><mml:math id="inf526"><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf527"><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>. Similar to (<xref ref-type="bibr" rid="bib62">Laurens, 2006</xref>; <xref ref-type="bibr" rid="bib55">Laurens and Droulez, 2007</xref>,<xref ref-type="bibr" rid="bib56">Laurens and Droulez, 2008</xref>) we modeled the statistical distribution of these variables as Gaussians, with standard deviations <inline-formula><mml:math id="inf528"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf529"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>.</p><p>Excluding vision and proprioception, the brain senses head motion though the semicircular canals (that generate a signal <inline-formula><mml:math id="inf530"><mml:mi>V</mml:mi></mml:math></inline-formula>) and the otoliths organs (that generate a signal <inline-formula><mml:math id="inf531"><mml:mi>F</mml:mi></mml:math></inline-formula>). Thus, in initial simulations (<xref ref-type="fig" rid="fig3">Figures 3</xref>–<xref ref-type="fig" rid="fig6">6</xref>), the variable <inline-formula><mml:math id="inf532"><mml:mi>S</mml:mi></mml:math></inline-formula> encompasses <inline-formula><mml:math id="inf533"><mml:mi>V</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf534"><mml:mi>F</mml:mi></mml:math></inline-formula> (neck proprioceptors are added in <xref ref-type="fig" rid="fig7">Figure 7</xref>).</p><p>The semicircular canals are rotation sensors that, due to their mechanical characteristic, exhibit high-pass filter properties. These dynamics may be neglected for rapid movements of small amplitude (such as <xref ref-type="fig" rid="fig3">Figure 3</xref>) but can have significant impact during natural movements (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>). They are modeled using a hidden state variable <inline-formula><mml:math id="inf535"><mml:mi>C</mml:mi></mml:math></inline-formula>. The canals are also subject to sensory noise <inline-formula><mml:math id="inf536"><mml:msup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>. Taken both the noise and the dynamics into account, the canals signal is modeled as <inline-formula><mml:math id="inf537"><mml:mi>V</mml:mi><mml:mo>=</mml:mo> <mml:mi/><mml:mi>Ω</mml:mi><mml:mo>-</mml:mo><mml:mi>C</mml:mi><mml:mo>+</mml:mo> <mml:mi/><mml:msup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>.</p><p>The otolith organs are acceleration sensors. They exhibit negligible temporal dynamics in the range of motion considered here, but are fundamentally ambiguous: they sense gravitational as well as linear acceleration – a fundamental ambiguity resulting from Einstein’s equivalence principle (<xref ref-type="bibr" rid="bib30">Einstein, 1907</xref>). Gravitational acceleration along the inter-aural axis depends on head roll position, modeled here as <inline-formula><mml:math id="inf538"><mml:mi>G</mml:mi><mml:mo>=</mml:mo> <mml:mi/><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mi>Ω</mml:mi><mml:mo>.</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. The otoliths encode the sum of <inline-formula><mml:math id="inf539"><mml:mi>A</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf540"><mml:mi>G</mml:mi></mml:math></inline-formula> and is also affected by sensory noise <inline-formula><mml:math id="inf541"><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>, such that the net otolith signal is <inline-formula><mml:math id="inf542"><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mo>+</mml:mo><mml:mi>G</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>.</p><p>How sensory errors are used to correct motion estimates depends on the Kalman gain matrix, which is computed by the Kalman algorithm such that the Kalman filter as a whole performs optimal estimation. In theory, the Kalman filter includes a total of 8 feedback signals, corresponding to the combination of two sensory errors (canal and otolith errors) and four internal states (see Supplementary methods,’ Kalman feedback gains’).</p><p>It is important to emphasize that the Kalman filter model is closely related to previous models of vestibular information processing. Indeed, simulations of long-duration rotation and visuo-vestibular interactions (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>), as well as mathematical analysis (<xref ref-type="bibr" rid="bib62">Laurens, 2006</xref>), demonstrate that <inline-formula><mml:math id="inf543"><mml:mover accent="true"><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> is equivalent to the ‘velocity storage’ (<xref ref-type="bibr" rid="bib81">Raphan et al., 1979</xref>; <xref ref-type="bibr" rid="bib53">Laurens and Angelaki, 2011</xref>). These low-frequency dynamics, as well as visuo-vestibular interactions, were previously simulated and interpreted in the light of optimal estimation theory; and accordingly are reproduced by the Kalman filter model.</p><p>The model presented here is to a large extent identical to the Particle filter Bayesian model in (<xref ref-type="bibr" rid="bib62">Laurens, 2006</xref>; <xref ref-type="bibr" rid="bib55">Laurens and Droulez, 2007</xref>, <xref ref-type="bibr" rid="bib56">Laurens and Droulez, 2008</xref>; <xref ref-type="bibr" rid="bib53">Laurens and Angelaki, 2011</xref>). It should be emphasized that: (1) transforming the model into a Kalman filter didn’t alter the assumptions upon which the Particle filter was build; (2) introducing motor commands into the Kalman filter was a textbook process that did not require any additional assumptions or parameters; and (3) we used exactly the same parameter values as in <xref ref-type="bibr" rid="bib62">Laurens, 2006</xref> and <xref ref-type="bibr" rid="bib56">Laurens and Droulez, 2008</xref> (with the exception of <inline-formula><mml:math id="inf544"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> whose impact, however, is negligible, and of the model of head on trunk rotation that required additional parameters; see next section).</p></sec><sec id="s4-2"><title>Simulation parameters</title><p>The parameters of the Kalman filter model are directly adapted from previous studies (<xref ref-type="bibr" rid="bib62">Laurens, 2006</xref>; <xref ref-type="bibr" rid="bib56">Laurens and Droulez, 2008</xref>). Tilt angles are expressed in radians, rotation velocities in rad/s, and accelerations in <italic>g</italic> (1 <italic>g</italic> = 9.81 m/s<sup>2</sup>). Note that a small linear acceleration <inline-formula><mml:math id="inf545"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in a direction perpendicular to gravity will rotate the gravito-inertial force vector around the head by an angle <inline-formula><mml:math id="inf546"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≈</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. For this reason, tilt and small amplitude linear accelerations are expressed, in one dimension, in equivalent units that may be added or subtracted. The standard deviations of the unpredictable rotations (<inline-formula><mml:math id="inf547"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>) and accelerations (<inline-formula><mml:math id="inf548"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>) are set to the standard deviations of the Bayesian a priori in <xref ref-type="bibr" rid="bib62">Laurens, 2006</xref> and <xref ref-type="bibr" rid="bib56">Laurens and Droulez, 2008</xref>, that is, <inline-formula><mml:math id="inf549"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo> <mml:mi mathvariant="normal"/></mml:math></inline-formula>0.7 rad/s <inline-formula><mml:math id="inf550"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf551"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:math></inline-formula>0.3 <italic>g</italic> (<inline-formula><mml:math id="inf552"><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>). The standard deviation of the noise affecting the canals (<inline-formula><mml:math id="inf553"><mml:msup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>) was set to <inline-formula><mml:math id="inf554"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:math></inline-formula>0.175 rad/s (as in <xref ref-type="bibr" rid="bib62">Laurens, 2006</xref> and <xref ref-type="bibr" rid="bib56">Laurens and Droulez, 2008</xref>; see <xref ref-type="fig" rid="fig10s2">Figure 10—figure supplement 2</xref> for simulations with different parameters). The standard deviation of the otolith noise (<inline-formula><mml:math id="inf555"><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>) was set to <inline-formula><mml:math id="inf556"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">F</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:math></inline-formula>0.002<inline-formula><mml:math id="inf557"> <mml:mi/><mml:mi>g</mml:mi></mml:math></inline-formula> (2 cm/s<sup>2</sup>). We verified that values ranging from 0 to 0.01<inline-formula><mml:math id="inf558"> <mml:mi/><mml:mi>g</mml:mi></mml:math></inline-formula> had no effect on simulation results. The time constant of the canals was set to τ<sub>c</sub>=4s. Simulations used a time step of <inline-formula><mml:math id="inf559"><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:math></inline-formula> = 0.01 s. We verified that changing the value of the time step without altering other parameters had no effect on the results.</p><p>We ran simulations using a variant of the model that included visual information encoding rotation velocity. The visual velocity signals were affected by sensory noise with a standard deviation <inline-formula><mml:math id="inf560"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> = 0.12 rad/s, as in <xref ref-type="bibr" rid="bib56">Laurens and Droulez, 2008</xref>.</p><p>Another variant modeled trunk in space velocity (<inline-formula><mml:math id="inf561"><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) and head on trunk velocity (<inline-formula><mml:math id="inf562"><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) independently. The standard deviations of unpredictable rotations were set to <inline-formula><mml:math id="inf563"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> = 0.7 rad/s (identical to <inline-formula><mml:math id="inf564"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) and <inline-formula><mml:math id="inf565"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> = 3.5 rad/s. The standard deviation of sensory noise affecting neck afferents was set manually to <inline-formula><mml:math id="inf566"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> = 0.0017 rad. We found that increasing the neck afferent noise reduces the gain of head on trunk and trunk in space velocity estimate (<xref ref-type="fig" rid="fig7">Figure 7C</xref>) (e.g. by 60% for a tenfold increase in afferent noise). Reducing the value of this noise has little effect on the simulations.</p><p>For simplicity, all simulations were run without adding the sensory noise <inline-formula><mml:math id="inf567"><mml:msup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf568"><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>. These noise-free simulations are representative of the results that would be obtained by averaging several simulation runs performed with sensory noise (e.g. as in <xref ref-type="bibr" rid="bib55">Laurens and Droulez, 2007</xref>). We chose to present noise-free results here in order to facilitate the comparison between simulations of active and passive motions.</p><p>A Matlab implementation of the Kalman model is available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/JeanLaurens/Laurens_Angelaki_Kalman_2017">https://github.com/JeanLaurens/Laurens_Angelaki_Kalman_2017</ext-link> (<xref ref-type="bibr" rid="bib63">Laurens, 2017</xref>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/Laurens_Angelaki_Kalman_2017">https://github.com/elifesciences-publications/Laurens_Angelaki_Kalman_2017</ext-link>).</p></sec></sec></body><back><sec id="s6" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Investigation, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Supervision, Funding acquisition, Writing—original draft, Writing—review and editing</p></fn></fn-group></sec><sec id="s5" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><object-id pub-id-type="doi">10.7554/eLife.28074.034</object-id><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-28074-transrepform-v2.docx"/></supplementary-material></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alpini</surname> <given-names>D</given-names></name><name><surname>Botta</surname> <given-names>M</given-names></name><name><surname>Mattei</surname> <given-names>V</given-names></name><name><surname>Tornese</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Figure ice skating induces vestibulo-ocular adaptation specific to required athletic skills</article-title><source>Sport Sciences for Health</source><volume>5</volume><fpage>129</fpage><lpage>134</lpage><pub-id pub-id-type="doi">10.1007/s11332-009-0088-4</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anastasopoulos</surname> <given-names>D</given-names></name><name><surname>Mergner</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="1982">1982</year><article-title>Canal-neck interaction in vestibular nuclear neurons of the cat</article-title><source>Experimental Brain Research</source><volume>46</volume><fpage>269</fpage><lpage>280</lpage><pub-id pub-id-type="doi">10.1007/BF00237185</pub-id><pub-id pub-id-type="pmid">6284541</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Angelaki</surname> <given-names>DE</given-names></name><name><surname>Cullen</surname> <given-names>KE</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Vestibular system: the many facets of a multimodal sense</article-title><source>Annual Review of Neuroscience</source><volume>31</volume><fpage>125</fpage><lpage>150</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.31.060407.125555</pub-id><pub-id pub-id-type="pmid">18338968</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Angelaki</surname> <given-names>DE</given-names></name><name><surname>Hess</surname> <given-names>BJ</given-names></name></person-group><year iso-8601-date="1995">1995a</year><article-title>Lesion of the nodulus and ventral uvula abolish steady-state off-vertical axis otolith response</article-title><source>Journal of Neurophysiology</source><volume>73</volume><fpage>1716</fpage><lpage>1720</lpage><pub-id pub-id-type="pmid">7643178</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Angelaki</surname> <given-names>DE</given-names></name><name><surname>Hess</surname> <given-names>BJ</given-names></name></person-group><year iso-8601-date="1995">1995b</year><article-title>Inertial representation of angular motion in the vestibular system of rhesus monkeys. II. Otolith-controlled transformation that depends on an intact cerebellar nodulus</article-title><source>Journal of Neurophysiology</source><volume>73</volume><fpage>1729</fpage><lpage>1751</lpage><pub-id pub-id-type="pmid">7623076</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Angelaki</surname> <given-names>DE</given-names></name><name><surname>Hess</surname> <given-names>BJ</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Three-dimensional organization of otolith-ocular reflexes in rhesus monkeys. II. Inertial detection of angular velocity</article-title><source>Journal of Neurophysiology</source><volume>75</volume><fpage>2425</fpage><lpage>2440</lpage><pub-id pub-id-type="pmid">8793754</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Angelaki</surname> <given-names>DE</given-names></name><name><surname>McHenry</surname> <given-names>MQ</given-names></name><name><surname>Dickman</surname> <given-names>JD</given-names></name><name><surname>Newlands</surname> <given-names>SD</given-names></name><name><surname>Hess</surname> <given-names>BJ</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Computation of inertial motion: neural strategies to resolve ambiguous otolith information</article-title><source>The Journal of Neuroscience : The Official Journal of the Society for Neuroscience</source><volume>19</volume><fpage>316</fpage><lpage>327</lpage><pub-id pub-id-type="pmid">9870961</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Angelaki</surname> <given-names>DE</given-names></name><name><surname>Shaikh</surname> <given-names>AG</given-names></name><name><surname>Green</surname> <given-names>AM</given-names></name><name><surname>Dickman</surname> <given-names>JD</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Neurons compute internal models of the physical laws of motion</article-title><source>Nature</source><volume>430</volume><fpage>560</fpage><lpage>564</lpage><pub-id pub-id-type="doi">10.1038/nature02754</pub-id><pub-id pub-id-type="pmid">15282606</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berniker</surname> <given-names>M</given-names></name><name><surname>Kording</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Estimating the sources of motor errors for adaptation and generalization</article-title><source>Nature Neuroscience</source><volume>11</volume><fpage>1454</fpage><lpage>1461</lpage><pub-id pub-id-type="doi">10.1038/nn.2229</pub-id><pub-id pub-id-type="pmid">19011624</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berniker</surname> <given-names>M</given-names></name><name><surname>Kording</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Bayesian approaches to sensory integration for motor control</article-title><source>Wiley Interdisciplinary Reviews: Cognitive Science</source><volume>2</volume><fpage>419</fpage><lpage>428</lpage><pub-id pub-id-type="doi">10.1002/wcs.125</pub-id><pub-id pub-id-type="pmid">26302201</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berniker</surname> <given-names>M</given-names></name><name><surname>Voss</surname> <given-names>M</given-names></name><name><surname>Kording</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Learning priors for Bayesian computations in the nervous system</article-title><source>PLoS One</source><volume>5</volume><elocation-id>e12686</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0012686</pub-id><pub-id pub-id-type="pmid">20844766</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bertolini</surname> <given-names>G</given-names></name><name><surname>Ramat</surname> <given-names>S</given-names></name><name><surname>Laurens</surname> <given-names>J</given-names></name><name><surname>Bockisch</surname> <given-names>CJ</given-names></name><name><surname>Marti</surname> <given-names>S</given-names></name><name><surname>Straumann</surname> <given-names>D</given-names></name><name><surname>Palla</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Velocity storage contribution to vestibular self-motion perception in healthy human subjects</article-title><source>Journal of Neurophysiology</source><volume>105</volume><fpage>209</fpage><lpage>223</lpage><pub-id pub-id-type="doi">10.1152/jn.00154.2010</pub-id><pub-id pub-id-type="pmid">21068266</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Black</surname> <given-names>FO</given-names></name><name><surname>Shupert</surname> <given-names>CL</given-names></name><name><surname>Horak</surname> <given-names>FB</given-names></name><name><surname>Nashner</surname> <given-names>LM</given-names></name></person-group><year iso-8601-date="1988">1988</year><article-title>Abnormal postural control associated with peripheral vestibular disorders</article-title><source>Progress in Brain Research</source><volume>76</volume><fpage>263</fpage><lpage>275</lpage><pub-id pub-id-type="doi">10.1016/S0079-6123(08)64513-6</pub-id><pub-id pub-id-type="pmid">3265212</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Borah</surname> <given-names>J</given-names></name><name><surname>Young</surname> <given-names>LR</given-names></name><name><surname>Curry</surname> <given-names>RE</given-names></name></person-group><year iso-8601-date="1988">1988</year><article-title>Optimal estimator model for human spatial orientation</article-title><source>Annals of the New York Academy of Sciences</source><volume>545</volume><fpage>51</fpage><lpage>73</lpage><pub-id pub-id-type="doi">10.1111/j.1749-6632.1988.tb19555.x</pub-id><pub-id pub-id-type="pmid">3071213</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Bos</surname> <given-names>JE</given-names></name><name><surname>Bles</surname> <given-names>W</given-names></name><name><surname>Hosman</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Modeling human spatial orientation and motion perception</article-title><conf-name><italic>AIAA Modeling and Simulation Technologies Conference</italic></conf-name><publisher-loc>Montreal</publisher-loc><fpage>6</fpage><lpage>9</lpage></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brandt</surname> <given-names>T</given-names></name><name><surname>Büchele</surname> <given-names>W</given-names></name><name><surname>Arnold</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="1977">1977b</year><article-title>Arthrokinetic nystagmus and ego-motion sensation</article-title><source>Experimental Brain Research</source><volume>30</volume><fpage>331</fpage><lpage>338</lpage><pub-id pub-id-type="doi">10.1007/BF00237260</pub-id><pub-id pub-id-type="pmid">598431</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brandt</surname> <given-names>T</given-names></name><name><surname>Strupp</surname> <given-names>M</given-names></name><name><surname>Benson</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>You are better off running than walking with acute vestibulopathy</article-title><source>The Lancet</source><volume>354</volume><elocation-id>746</elocation-id><pub-id pub-id-type="doi">10.1016/S0140-6736(99)03179-7</pub-id><pub-id pub-id-type="pmid">10475195</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brooks</surname> <given-names>JX</given-names></name><name><surname>Carriot</surname> <given-names>J</given-names></name><name><surname>Cullen</surname> <given-names>KE</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Learning to expect the unexpected: rapid updating in primate cerebellum during voluntary self-motion</article-title><source>Nature Neuroscience</source><volume>18</volume><fpage>1310</fpage><lpage>1317</lpage><pub-id pub-id-type="doi">10.1038/nn.4077</pub-id><pub-id pub-id-type="pmid">26237366</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brooks</surname> <given-names>JX</given-names></name><name><surname>Cullen</surname> <given-names>KE</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Multimodal integration in rostral fastigial nucleus provides an estimate of body movement</article-title><source>Journal of Neuroscience</source><volume>29</volume><fpage>10499</fpage><lpage>10511</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1937-09.2009</pub-id><pub-id pub-id-type="pmid">19710303</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brooks</surname> <given-names>JX</given-names></name><name><surname>Cullen</surname> <given-names>KE</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The primate cerebellum selectively encodes unexpected self-motion</article-title><source>Current Biology</source><volume>23</volume><fpage>947</fpage><lpage>955</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2013.04.029</pub-id><pub-id pub-id-type="pmid">23684973</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brooks</surname> <given-names>JX</given-names></name><name><surname>Cullen</surname> <given-names>KE</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Early vestibular processing does not discriminate active from passive self-motion if there is a discrepancy between predicted and actual proprioceptive feedback</article-title><source>Journal of Neurophysiology</source><volume>111</volume><fpage>2465</fpage><lpage>2478</lpage><pub-id pub-id-type="doi">10.1152/jn.00600.2013</pub-id><pub-id pub-id-type="pmid">24671531</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carriot</surname> <given-names>J</given-names></name><name><surname>Brooks</surname> <given-names>JX</given-names></name><name><surname>Cullen</surname> <given-names>KE</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Multimodal integration of self-motion cues in the vestibular system: active versus passive translations</article-title><source>Journal of Neuroscience</source><volume>33</volume><fpage>19555</fpage><lpage>19566</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3051-13.2013</pub-id><pub-id pub-id-type="pmid">24336720</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chan</surname> <given-names>YS</given-names></name><name><surname>Kasper</surname> <given-names>J</given-names></name><name><surname>Wilson</surname> <given-names>VJ</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Dynamics and directional sensitivity of neck muscle spindle responses to head rotation</article-title><source>Journal of Neurophysiology</source><volume>57</volume><fpage>1716</fpage><lpage>1729</lpage><pub-id pub-id-type="pmid">2955083</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen-Harris</surname> <given-names>H</given-names></name><name><surname>Joiner</surname> <given-names>WM</given-names></name><name><surname>Ethier</surname> <given-names>V</given-names></name><name><surname>Zee</surname> <given-names>DS</given-names></name><name><surname>Shadmehr</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Adaptive control of saccades via internal feedback</article-title><source>Journal of Neuroscience</source><volume>28</volume><fpage>2804</fpage><lpage>2813</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.5300-07.2008</pub-id><pub-id pub-id-type="pmid">18337410</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crawford</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1964">1964</year><article-title>living without a balancing mechanism</article-title><source>British Journal of Ophthalmology</source><volume>48</volume><fpage>357</fpage><lpage>360</lpage><pub-id pub-id-type="doi">10.1136/bjo.48.7.357</pub-id><pub-id pub-id-type="pmid">14190450</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cullen</surname> <given-names>KE</given-names></name><name><surname>Brooks</surname> <given-names>JX</given-names></name><name><surname>Jamali</surname> <given-names>M</given-names></name><name><surname>Carriot</surname> <given-names>J</given-names></name><name><surname>Massot</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Internal models of self-motion: computations that suppress vestibular reafference in early vestibular processing</article-title><source>Experimental Brain Research</source><volume>210</volume><fpage>377</fpage><lpage>388</lpage><pub-id pub-id-type="doi">10.1007/s00221-011-2555-9</pub-id><pub-id pub-id-type="pmid">21286693</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cullen</surname> <given-names>KE</given-names></name><name><surname>Minor</surname> <given-names>LB</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Semicircular canal afferents similarly encode active and passive head-on-body rotations: implications for the role of vestibular efference</article-title><source>The Journal of Neuroscience : The Official Journal of the Society for Neuroscience</source><volume>22</volume><elocation-id>RC226</elocation-id><pub-id pub-id-type="pmid">12040085</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cullen</surname> <given-names>KE</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The vestibular system: multimodal integration and encoding of self-motion for motor control</article-title><source>Trends in Neurosciences</source><volume>35</volume><fpage>185</fpage><lpage>196</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2011.12.001</pub-id><pub-id pub-id-type="pmid">22245372</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Dale</surname> <given-names>A</given-names></name><name><surname>Cullen</surname> <given-names>KE</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Sensory coding in the vestibular thalamus discriminates passive from active self-motion</article-title><conf-name><italic>Program No. 181.10/JJJ22, Neuroscience Meeting Planner. Society for Neuroscience Meeting</italic></conf-name><conf-loc>San Diego</conf-loc><publisher-loc>United States</publisher-loc></element-citation></ref><ref id="bib30"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Einstein</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="1907">1907</year><chapter-title>Über das Relativitätsprinzip und die aus demselben gezogenen Folgerungen</chapter-title><source>Jahrbuch Der Radioaktivität Und Elektronik</source><volume>4</volume><fpage>411</fpage><lpage>462</lpage></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Franklin</surname> <given-names>DW</given-names></name><name><surname>Wolpert</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Computational mechanisms of sensorimotor control</article-title><source>Neuron</source><volume>72</volume><fpage>425</fpage><lpage>442</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2011.10.006</pub-id><pub-id pub-id-type="pmid">22078503</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fusi</surname> <given-names>S</given-names></name><name><surname>Miller</surname> <given-names>EK</given-names></name><name><surname>Rigotti</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Why neurons mix: high dimensionality for higher cognition</article-title><source>Current Opinion in Neurobiology</source><volume>37</volume><fpage>66</fpage><lpage>74</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2016.01.010</pub-id><pub-id pub-id-type="pmid">26851755</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gdowski</surname> <given-names>GT</given-names></name><name><surname>Boyle</surname> <given-names>R</given-names></name><name><surname>McCrea</surname> <given-names>RA</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Sensory processing in the vestibular nuclei during active head movements</article-title><source>Archives Italiennes De Biologie</source><volume>138</volume><fpage>15</fpage><lpage>28</lpage><pub-id pub-id-type="pmid">10604030</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gdowski</surname> <given-names>GT</given-names></name><name><surname>McCrea</surname> <given-names>RA</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Integration of vestibular and head movement signals in the vestibular nuclei during whole-body rotation</article-title><source>Journal of Neurophysiology</source><volume>82</volume><fpage>436</fpage><lpage>449</lpage><pub-id pub-id-type="pmid">10400970</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Glasauer</surname> <given-names>S</given-names></name><name><surname>Merfeld</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="1997">1997</year><chapter-title>Modelling three-dimensional vestibular responses during complex motion stimulation</chapter-title><source>Three-Dimensional Kinematics of Eye, Head and Limb Movements</source><fpage>387</fpage><lpage>398</lpage></element-citation></ref><ref id="bib36"><element-citation publication-type="thesis"><person-group person-group-type="author"><name><surname>Glasauer</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Das Zusammenspiel von Otolithen und Bogengängen im Wirkungsgefüge der Subjektiven vertikale</article-title><publisher-loc>Munich, Germany</publisher-loc><publisher-name>Lehrstuhl für Nachrichtentechnik der Technischen Universitat München</publisher-name></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Graybiel</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="1952">1952</year><article-title>Oculogravic illusion</article-title><source>Archives of Ophthalmology</source><volume>48</volume><fpage>605</fpage><lpage>615</lpage><pub-id pub-id-type="doi">10.1001/archopht.1952.00920010616007</pub-id><pub-id pub-id-type="pmid">12984891</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guedry</surname> <given-names>FE</given-names></name><name><surname>Benson</surname> <given-names>AJ</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>Modification of per- and postrotational responses by voluntary motor activity of the limbs</article-title><source>Experimental Brain Research</source><volume>52</volume><fpage>190</fpage><lpage>198</lpage><pub-id pub-id-type="doi">10.1007/BF00236627</pub-id><pub-id pub-id-type="pmid">6605873</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Herdman</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="1996">1996</year><chapter-title>Vestibular Rehabilitation</chapter-title><person-group person-group-type="editor"><name><surname>Baloh</surname> <given-names>R. W</given-names></name><name><surname>Halmagyi</surname> <given-names>G. M</given-names></name></person-group><source>Disorders of the Vestibular System</source><publisher-loc>Oxford</publisher-loc><publisher-name>Oxford University Press</publisher-name><fpage>583</fpage><lpage>597</lpage></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Herdman</surname> <given-names>SJ</given-names></name><name><surname>Blatt</surname> <given-names>P</given-names></name><name><surname>Schubert</surname> <given-names>MC</given-names></name><name><surname>Tusa</surname> <given-names>RJ</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Falls in patients with vestibular deficits</article-title><source>The American Journal of Otology</source><volume>21</volume><fpage>847</fpage><lpage>851</lpage><pub-id pub-id-type="pmid">11078074</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hess</surname> <given-names>BJ</given-names></name><name><surname>Angelaki</surname> <given-names>DE</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Angular velocity detection by head movements orthogonal to the plane of rotation</article-title><source>Experimental Brain Research</source><volume>95</volume><fpage>77</fpage><lpage>83</lpage><pub-id pub-id-type="doi">10.1007/BF00229656</pub-id><pub-id pub-id-type="pmid">8405254</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Horstmann</surname> <given-names>GA</given-names></name><name><surname>Dietz</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="1988">1988</year><article-title>The contribution of vestibular input to the stabilization of human posture: a new experimental approach</article-title><source>Neuroscience Letters</source><volume>95</volume><fpage>179</fpage><lpage>184</lpage><pub-id pub-id-type="doi">10.1016/0304-3940(88)90653-2</pub-id><pub-id pub-id-type="pmid">3226607</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Howard</surname> <given-names>IP</given-names></name><name><surname>Zacher</surname> <given-names>JE</given-names></name><name><surname>Allison</surname> <given-names>RS</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Post-rotatory nystagmus and turning sensations after active and passive turning</article-title><source>Journal of Vestibular Research</source><volume>8</volume><fpage>299</fpage><lpage>312</lpage><pub-id pub-id-type="doi">10.1016/S0957-4271(97)00079-7</pub-id><pub-id pub-id-type="pmid">9652480</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jahn</surname> <given-names>K</given-names></name><name><surname>Strupp</surname> <given-names>M</given-names></name><name><surname>Schneider</surname> <given-names>E</given-names></name><name><surname>Dieterich</surname> <given-names>M</given-names></name><name><surname>Brandt</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Differential effects of vestibular stimulation on walking and running</article-title><source>NeuroReport</source><volume>11</volume><fpage>1745</fpage><lpage>1748</lpage><pub-id pub-id-type="doi">10.1097/00001756-200006050-00029</pub-id><pub-id pub-id-type="pmid">10852236</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jamali</surname> <given-names>M</given-names></name><name><surname>Sadeghi</surname> <given-names>SG</given-names></name><name><surname>Cullen</surname> <given-names>KE</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Response of vestibular nerve afferents innervating utricle and saccule during passive and active translations</article-title><source>Journal of Neurophysiology</source><volume>101</volume><fpage>141</fpage><lpage>149</lpage><pub-id pub-id-type="doi">10.1152/jn.91066.2008</pub-id><pub-id pub-id-type="pmid">18971293</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jürgens</surname> <given-names>R</given-names></name><name><surname>Boss</surname> <given-names>T</given-names></name><name><surname>Becker</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Estimation of self-turning in the dark: comparison between active and passive rotation</article-title><source>Experimental Brain Research</source><volume>128</volume><fpage>491</fpage><lpage>504</lpage><pub-id pub-id-type="doi">10.1007/s002210050872</pub-id><pub-id pub-id-type="pmid">10541743</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kalman</surname> <given-names>RE</given-names></name></person-group><year iso-8601-date="1960">1960</year><article-title>A new approach to linear filtering and prediction problems</article-title><source>Journal of Basic Engineering</source><volume>82</volume><fpage>35</fpage><lpage>45</lpage><pub-id pub-id-type="doi">10.1115/1.3662552</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karmali</surname> <given-names>F</given-names></name><name><surname>Merfeld</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>A distributed, dynamic, parallel computational model: the role of noise in velocity storage</article-title><source>Journal of Neurophysiology</source><volume>108</volume><fpage>390</fpage><lpage>405</lpage><pub-id pub-id-type="doi">10.1152/jn.00883.2011</pub-id><pub-id pub-id-type="pmid">22514288</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kennedy</surname> <given-names>A</given-names></name><name><surname>Wayne</surname> <given-names>G</given-names></name><name><surname>Kaifosh</surname> <given-names>P</given-names></name><name><surname>Alviña</surname> <given-names>K</given-names></name><name><surname>Abbott</surname> <given-names>LF</given-names></name><name><surname>Sawtell</surname> <given-names>NB</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A temporal basis for predicting the sensory consequences of motor commands in an electric fish</article-title><source>Nature Neuroscience</source><volume>17</volume><fpage>416</fpage><lpage>422</lpage><pub-id pub-id-type="doi">10.1038/nn.3650</pub-id><pub-id pub-id-type="pmid">24531306</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keshner</surname> <given-names>EA</given-names></name><name><surname>Allum</surname> <given-names>JH</given-names></name><name><surname>Pfaltz</surname> <given-names>CR</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Postural coactivation and adaptation in the sway stabilizing responses of normals and patients with bilateral vestibular deficit</article-title><source>Experimental Brain Research</source><volume>69</volume><fpage>77</fpage><lpage>92</lpage><pub-id pub-id-type="doi">10.1007/BF00247031</pub-id><pub-id pub-id-type="pmid">3501760</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kleine</surname> <given-names>JF</given-names></name><name><surname>Guan</surname> <given-names>Y</given-names></name><name><surname>Kipiani</surname> <given-names>E</given-names></name><name><surname>Glonti</surname> <given-names>L</given-names></name><name><surname>Hoshi</surname> <given-names>M</given-names></name><name><surname>Büttner</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Trunk position influences vestibular responses of fastigial nucleus neurons in the alert monkey</article-title><source>Journal of Neurophysiology</source><volume>91</volume><fpage>2090</fpage><lpage>2100</lpage><pub-id pub-id-type="doi">10.1152/jn.00849.2003</pub-id><pub-id pub-id-type="pmid">15069099</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Körding</surname> <given-names>KP</given-names></name><name><surname>Wolpert</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Bayesian integration in sensorimotor learning</article-title><source>Nature</source><volume>427</volume><fpage>244</fpage><lpage>247</lpage><pub-id pub-id-type="doi">10.1038/nature02169</pub-id><pub-id pub-id-type="pmid">14724638</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laurens</surname> <given-names>J</given-names></name><name><surname>Angelaki</surname> <given-names>DE</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The functional significance of velocity storage and its dependence on gravity</article-title><source>Experimental Brain Research</source><volume>210</volume><fpage>407</fpage><lpage>422</lpage><pub-id pub-id-type="doi">10.1007/s00221-011-2568-4</pub-id><pub-id pub-id-type="pmid">21293850</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Laurens</surname> <given-names>J</given-names></name><name><surname>Angelaki</surname> <given-names>DE</given-names></name></person-group><year iso-8601-date="2015">2015</year><chapter-title>How the vestibulocerebellum builds an internal model of self-motion</chapter-title><source>The Neuronal Codes of the Cerebellum</source><fpage>97</fpage><lpage>115</lpage><pub-id pub-id-type="doi">10.1016/B978-0-12-801386-1.00004-6</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laurens</surname> <given-names>J</given-names></name><name><surname>Droulez</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Bayesian processing of vestibular information</article-title><source>Biological Cybernetics</source><volume>96</volume><fpage>389</fpage><lpage>404</lpage><pub-id pub-id-type="doi">10.1007/s00422-006-0133-1</pub-id><pub-id pub-id-type="pmid">17146661</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Laurens</surname> <given-names>J</given-names></name><name><surname>Droulez</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2008">2008</year><chapter-title>Bayesian modelling of visuo-vestibular interactions</chapter-title><source>Probabilistic Reasoning and Decision Making in Sensory-Motor Systems</source><publisher-loc>Heidelberg</publisher-loc><publisher-name>Springer</publisher-name><fpage>279</fpage><lpage>300</lpage><pub-id pub-id-type="doi">10.1007/978-3-540-79007-5_12</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laurens</surname> <given-names>J</given-names></name><name><surname>Liu</surname> <given-names>S</given-names></name><name><surname>Yu</surname> <given-names>XJ</given-names></name><name><surname>Chan</surname> <given-names>R</given-names></name><name><surname>Dickman</surname> <given-names>D</given-names></name><name><surname>DeAngelis</surname> <given-names>GC</given-names></name><name><surname>Angelaki</surname> <given-names>DE</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Transformation of spatiotemporal dynamics in the macaque vestibular system from otolith afferents to cortex</article-title><source>eLife</source><volume>6</volume><elocation-id>e20787</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.20787</pub-id><pub-id pub-id-type="pmid">28075326</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laurens</surname> <given-names>J</given-names></name><name><surname>Meng</surname> <given-names>H</given-names></name><name><surname>Angelaki</surname> <given-names>DE</given-names></name></person-group><year iso-8601-date="2013">2013a</year><article-title>Computation of linear acceleration through an internal model in the macaque cerebellum</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>1701</fpage><lpage>1708</lpage><pub-id pub-id-type="doi">10.1038/nn.3530</pub-id><pub-id pub-id-type="pmid">24077562</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laurens</surname> <given-names>J</given-names></name><name><surname>Meng</surname> <given-names>H</given-names></name><name><surname>Angelaki</surname> <given-names>DE</given-names></name></person-group><year iso-8601-date="2013">2013b</year><article-title>Neural representation of orientation relative to gravity in the macaque cerebellum</article-title><source>Neuron</source><volume>80</volume><fpage>1508</fpage><lpage>1518</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.09.029</pub-id><pub-id pub-id-type="pmid">24360549</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laurens</surname> <given-names>J</given-names></name><name><surname>Straumann</surname> <given-names>D</given-names></name><name><surname>Hess</surname> <given-names>BJ</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Processing of angular motion and gravity information through an internal model</article-title><source>Journal of Neurophysiology</source><volume>104</volume><fpage>1370</fpage><lpage>1381</lpage><pub-id pub-id-type="doi">10.1152/jn.00143.2010</pub-id><pub-id pub-id-type="pmid">20610780</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laurens</surname> <given-names>J</given-names></name><name><surname>Valko</surname> <given-names>Y</given-names></name><name><surname>Straumann</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Experimental parameter estimation of a visuo-vestibular interaction model in humans</article-title><source>Journal of Vestibular Research : Equilibrium &amp; Orientation</source><volume>21</volume><fpage>251</fpage><lpage>266</lpage><pub-id pub-id-type="doi">10.3233/VES-2011-0425</pub-id><pub-id pub-id-type="pmid">22101296</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="thesis"><person-group person-group-type="author"><name><surname>Laurens</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Modélisation Bayésienne des interactions visuo-vestibulaires</article-title><publisher-loc>Paris, France</publisher-loc><publisher-name>Doctoral Dissertation</publisher-name></element-citation></ref><ref id="bib63"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Laurens</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2017">2017</year><data-title>Laurens_Angelaki_Kalman_2017</data-title><source>GitHub</source><version designator="c7cf44686ce7577167c90e18e38f1024270dd189">c7cf44686ce7577167c90e18e38f1024270dd189</version><ext-link ext-link-type="uri" xlink:href="https://github.com/JeanLaurens/Laurens_Angelaki_Kalman_2017">https://github.com/JeanLaurens/Laurens_Angelaki_Kalman_2017</ext-link></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname> <given-names>RX</given-names></name><name><surname>Huang</surname> <given-names>JJ</given-names></name><name><surname>Huang</surname> <given-names>C</given-names></name><name><surname>Tsai</surname> <given-names>ML</given-names></name><name><surname>Yen</surname> <given-names>CT</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Plasticity of cerebellar Purkinje cells in behavioral training of body balance control</article-title><source>Frontiers in Systems Neuroscience</source><volume>9</volume><elocation-id>113</elocation-id><pub-id pub-id-type="doi">10.3389/fnsys.2015.00113</pub-id><pub-id pub-id-type="pmid">26300746</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lim</surname> <given-names>K</given-names></name><name><surname>Karmali</surname> <given-names>F</given-names></name><name><surname>Nicoucar</surname> <given-names>K</given-names></name><name><surname>Merfeld</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Perceptual precision of passive body tilt is consistent with statistically optimal cue integration</article-title><source>Journal of Neurophysiology</source><volume>117</volume><fpage>2037</fpage><lpage>2052</lpage><pub-id pub-id-type="doi">10.1152/jn.00073.2016</pub-id><pub-id pub-id-type="pmid">28179477</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>MacNeilage</surname> <given-names>PR</given-names></name><name><surname>Ganesan</surname> <given-names>N</given-names></name><name><surname>Angelaki</surname> <given-names>DE</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Computational approaches to spatial orientation: from transfer functions to dynamic Bayesian inference</article-title><source>Journal of Neurophysiology</source><volume>100</volume><fpage>2981</fpage><lpage>2996</lpage><pub-id pub-id-type="doi">10.1152/jn.90677.2008</pub-id><pub-id pub-id-type="pmid">18842952</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>MacNeilage</surname> <given-names>PR</given-names></name><name><surname>Glasauer</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Quantification of Head Movement Predictability and Implications for Suppression of Vestibular Input during Locomotion</article-title><source>Frontiers in Computational Neuroscience</source><volume>11</volume><elocation-id>47</elocation-id><pub-id pub-id-type="doi">10.3389/fncom.2017.00047</pub-id><pub-id pub-id-type="pmid">28638335</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marlinski</surname> <given-names>V</given-names></name><name><surname>McCrea</surname> <given-names>RA</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Coding of self-motion signals in ventro-posterior thalamus neurons in the alert squirrel monkey</article-title><source>Experimental Brain Research</source><volume>189</volume><fpage>463</fpage><lpage>472</lpage><pub-id pub-id-type="doi">10.1007/s00221-008-1442-5</pub-id><pub-id pub-id-type="pmid">18535821</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marlinski</surname> <given-names>V</given-names></name><name><surname>McCrea</surname> <given-names>RA</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Self-motion signals in vestibular nuclei neurons projecting to the thalamus in the alert squirrel monkey</article-title><source>Journal of Neurophysiology</source><volume>101</volume><fpage>1730</fpage><lpage>1741</lpage><pub-id pub-id-type="doi">10.1152/jn.90904.2008</pub-id><pub-id pub-id-type="pmid">19176611</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Mayne</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="1974">1974</year><chapter-title>A systems concept of the vestibular organs</chapter-title><source>Vestibular System Part 2: Psychophysics, Applied Aspects and General Interpretations</source><publisher-loc>Heidelberg</publisher-loc><publisher-name>Springer</publisher-name><fpage>493</fpage><lpage>580</lpage></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McCrea</surname> <given-names>RA</given-names></name><name><surname>Gdowski</surname> <given-names>GT</given-names></name><name><surname>Boyle</surname> <given-names>R</given-names></name><name><surname>Belton</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Firing behavior of vestibular neurons during active and passive head movements: vestibulo-spinal and other non-eye-movement related neurons</article-title><source>Journal of neurophysiology</source><volume>82</volume><fpage>416</fpage><lpage>428</lpage><pub-id pub-id-type="pmid">10400968</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McCrea</surname> <given-names>RA</given-names></name><name><surname>Luan</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Signal processing of semicircular canal and otolith signals in the vestibular nuclei during passive and active head movements</article-title><source>Annals of the New York Academy of Sciences</source><volume>1004</volume><fpage>169</fpage><lpage>182</lpage><pub-id pub-id-type="doi">10.1196/annals.1303.015</pub-id><pub-id pub-id-type="pmid">14662457</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meng</surname> <given-names>H</given-names></name><name><surname>Angelaki</surname> <given-names>DE</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Responses of ventral posterior thalamus neurons to three-dimensional vestibular and optic flow stimulation</article-title><source>Journal of Neurophysiology</source><volume>103</volume><fpage>817</fpage><lpage>826</lpage><pub-id pub-id-type="doi">10.1152/jn.00729.2009</pub-id><pub-id pub-id-type="pmid">19955294</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meng</surname> <given-names>H</given-names></name><name><surname>May</surname> <given-names>PJ</given-names></name><name><surname>Dickman</surname> <given-names>JD</given-names></name><name><surname>Angelaki</surname> <given-names>DE</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Vestibular signals in primate thalamus: properties and origins</article-title><source>Journal of Neuroscience</source><volume>27</volume><fpage>13590</fpage><lpage>13602</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3931-07.2007</pub-id><pub-id pub-id-type="pmid">18077671</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Merfeld</surname> <given-names>DM</given-names></name><name><surname>Zupan</surname> <given-names>L</given-names></name><name><surname>Peterka</surname> <given-names>RJ</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Humans use internal models to estimate gravity and linear acceleration</article-title><source>Nature</source><volume>398</volume><fpage>615</fpage><lpage>618</lpage><pub-id pub-id-type="doi">10.1038/19303</pub-id><pub-id pub-id-type="pmid">10217143</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Merfeld</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Modeling the vestibulo-ocular reflex of the squirrel monkey during eccentric rotation and roll tilt</article-title><source>Experimental Brain Research</source><volume>106</volume><fpage>123</fpage><lpage>134</lpage><pub-id pub-id-type="doi">10.1007/BF00241362</pub-id><pub-id pub-id-type="pmid">8542968</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mergner</surname> <given-names>T</given-names></name><name><surname>Becker</surname> <given-names>W</given-names></name><name><surname>Deecke</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>Canal-neck interaction in vestibular neurons of the cat's cerebral cortex</article-title><source>Experimental Brain Research</source><volume>61</volume><fpage>94</fpage><lpage>108</lpage><pub-id pub-id-type="doi">10.1007/BF00235625</pub-id><pub-id pub-id-type="pmid">4085606</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mergner</surname> <given-names>T</given-names></name><name><surname>Siebold</surname> <given-names>C</given-names></name><name><surname>Schweigart</surname> <given-names>G</given-names></name><name><surname>Becker</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>Human perception of horizontal trunk and head rotation in space during vestibular and neck stimulation</article-title><source>Experimental Brain Research</source><volume>85</volume><fpage>389</fpage><lpage>404</lpage><pub-id pub-id-type="doi">10.1007/BF00229416</pub-id><pub-id pub-id-type="pmid">1893987</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oman</surname> <given-names>CM</given-names></name></person-group><year iso-8601-date="1982">1982</year><article-title>A heuristic mathematical model for the dynamics of sensory conflict and motion sickness</article-title><source>Acta Oto-Laryngologica. Supplementum</source><volume>392</volume><fpage>1</fpage><lpage>44</lpage><pub-id pub-id-type="pmid">6303041</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paige</surname> <given-names>GD</given-names></name><name><surname>Seidman</surname> <given-names>SH</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Characteristics of the VOR in response to linear acceleration</article-title><source>Annals of the New York Academy of Sciences</source><volume>871</volume><fpage>123</fpage><lpage>135</lpage><pub-id pub-id-type="doi">10.1111/j.1749-6632.1999.tb09179.x</pub-id><pub-id pub-id-type="pmid">10372066</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raphan</surname> <given-names>T</given-names></name><name><surname>Matsuo</surname> <given-names>V</given-names></name><name><surname>Cohen</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="1979">1979</year><article-title>Velocity storage in the vestibulo-ocular reflex arc (VOR)</article-title><source>Experimental Brain Research</source><volume>35</volume><fpage>229</fpage><lpage>248</lpage><pub-id pub-id-type="doi">10.1007/BF00236613</pub-id><pub-id pub-id-type="pmid">108122</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reisine</surname> <given-names>H</given-names></name><name><surname>Raphan</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Neural basis for eye velocity generation in the vestibular nuclei of alert monkeys during off-vertical axis rotation</article-title><source>Experimental Brain Research</source><volume>92</volume><fpage>209</fpage><lpage>226</lpage><pub-id pub-id-type="doi">10.1007/BF00227966</pub-id><pub-id pub-id-type="pmid">1493862</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Requarth</surname> <given-names>T</given-names></name><name><surname>Sawtell</surname> <given-names>NB</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Neural mechanisms for filtering self-generated sensory signals in cerebellum-like circuits</article-title><source>Current Opinion in Neurobiology</source><volume>21</volume><fpage>602</fpage><lpage>608</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2011.05.031</pub-id><pub-id pub-id-type="pmid">21704507</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rigotti</surname> <given-names>M</given-names></name><name><surname>Barak</surname> <given-names>O</given-names></name><name><surname>Warden</surname> <given-names>MR</given-names></name><name><surname>Wang</surname> <given-names>XJ</given-names></name><name><surname>Daw</surname> <given-names>ND</given-names></name><name><surname>Miller</surname> <given-names>EK</given-names></name><name><surname>Fusi</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The importance of mixed selectivity in complex cognitive tasks</article-title><source>Nature</source><volume>497</volume><fpage>585</fpage><lpage>590</lpage><pub-id pub-id-type="doi">10.1038/nature12160</pub-id><pub-id pub-id-type="pmid">23685452</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="thesis"><person-group person-group-type="author"><name><surname>Riley</surname> <given-names>NH</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Neuromuscular adaptations during perturbations in individuals with and without bilateral vestibular loss</article-title><publisher-loc>University of Iowa, United States</publisher-loc><publisher-name>Doctoral Dissertation</publisher-name></element-citation></ref><ref id="bib86"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Robinson</surname> <given-names>DA</given-names></name></person-group><year iso-8601-date="1977">1977</year><chapter-title>Vestibular and optokinetic symbiosis: an example of explaining by modelling</chapter-title><source>Control of Gaze by Brain Stem Neurons</source><publisher-loc>Amsterdam</publisher-loc><publisher-name>Elsevier</publisher-name><fpage>49</fpage><lpage>58</lpage></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roy</surname> <given-names>JE</given-names></name><name><surname>Cullen</surname> <given-names>KE</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Selective processing of vestibular reafference during self-generated head motion</article-title><source>Journal of Neuroscience</source><volume>21</volume><fpage>2131</fpage><lpage>2142</lpage><pub-id pub-id-type="pmid">11245697</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roy</surname> <given-names>JE</given-names></name><name><surname>Cullen</surname> <given-names>KE</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Dissociating self-generated from passively applied head motion: neural mechanisms in the vestibular nuclei</article-title><source>Journal of Neuroscience</source><volume>24</volume><fpage>2102</fpage><lpage>2111</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3988-03.2004</pub-id><pub-id pub-id-type="pmid">14999061</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sadeghi</surname> <given-names>SG</given-names></name><name><surname>Minor</surname> <given-names>LB</given-names></name><name><surname>Cullen</surname> <given-names>KE</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Response of vestibular-nerve afferents to active and passive rotations under normal conditions and after unilateral labyrinthectomy</article-title><source>Journal of Neurophysiology</source><volume>97</volume><fpage>1503</fpage><lpage>1514</lpage><pub-id pub-id-type="doi">10.1152/jn.00829.2006</pub-id><pub-id pub-id-type="pmid">17122313</pub-id></element-citation></ref><ref id="bib90"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saglam</surname> <given-names>M</given-names></name><name><surname>Lehnen</surname> <given-names>N</given-names></name><name><surname>Glasauer</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Optimal control of natural eye-head movements minimizes the impact of noise</article-title><source>Journal of Neuroscience</source><volume>31</volume><fpage>16185</fpage><lpage>16193</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3721-11.2011</pub-id><pub-id pub-id-type="pmid">22072670</pub-id></element-citation></ref><ref id="bib91"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sağlam</surname> <given-names>M</given-names></name><name><surname>Glasauer</surname> <given-names>S</given-names></name><name><surname>Lehnen</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Vestibular and cerebellar contribution to gaze optimality</article-title><source>Brain</source><volume>137</volume><fpage>1080</fpage><lpage>1094</lpage><pub-id pub-id-type="doi">10.1093/brain/awu006</pub-id><pub-id pub-id-type="pmid">24549962</pub-id></element-citation></ref><ref id="bib92"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shadmehr</surname> <given-names>R</given-names></name><name><surname>Smith</surname> <given-names>MA</given-names></name><name><surname>Krakauer</surname> <given-names>JW</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Error correction, sensory prediction, and adaptation in motor control</article-title><source>Annual Review of Neuroscience</source><volume>33</volume><fpage>89</fpage><lpage>108</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-060909-153135</pub-id><pub-id pub-id-type="pmid">20367317</pub-id></element-citation></ref><ref id="bib93"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shaikh</surname> <given-names>AG</given-names></name><name><surname>Ghasia</surname> <given-names>FF</given-names></name><name><surname>Dickman</surname> <given-names>JD</given-names></name><name><surname>Angelaki</surname> <given-names>DE</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Properties of cerebellar fastigial neurons during translation, rotation, and eye movements</article-title><source>Journal of Neurophysiology</source><volume>93</volume><fpage>853</fpage><lpage>863</lpage><pub-id pub-id-type="doi">10.1152/jn.00879.2004</pub-id><pub-id pub-id-type="pmid">15371498</pub-id></element-citation></ref><ref id="bib94"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Siebold</surname> <given-names>C</given-names></name><name><surname>Anagnostou</surname> <given-names>E</given-names></name><name><surname>Glasauer</surname> <given-names>S</given-names></name><name><surname>Glonti</surname> <given-names>L</given-names></name><name><surname>Kleine</surname> <given-names>JF</given-names></name><name><surname>Tchelidze</surname> <given-names>T</given-names></name><name><surname>Büttner</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Canal-otolith interaction in the fastigial nucleus of the alert monkey</article-title><source>Experimental Brain Research</source><volume>136</volume><fpage>169</fpage><lpage>178</lpage><pub-id pub-id-type="doi">10.1007/s002210000575</pub-id><pub-id pub-id-type="pmid">11206279</pub-id></element-citation></ref><ref id="bib95"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Siebold</surname> <given-names>C</given-names></name><name><surname>Glonti</surname> <given-names>L</given-names></name><name><surname>Glasauer</surname> <given-names>S</given-names></name><name><surname>Büttner</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Rostral fastigial nucleus activity in the alert monkey during three-dimensional passive head movements</article-title><source>Journal of Neurophysiology</source><volume>77</volume><fpage>1432</fpage><lpage>1446</lpage><pub-id pub-id-type="pmid">9084609</pub-id></element-citation></ref><ref id="bib96"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Siebold</surname> <given-names>C</given-names></name><name><surname>Kleine</surname> <given-names>JF</given-names></name><name><surname>Glonti</surname> <given-names>L</given-names></name><name><surname>Tchelidze</surname> <given-names>T</given-names></name><name><surname>Büttner</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Fastigial nucleus activity during different frequencies and orientations of vertical vestibular stimulation in the monkey</article-title><source>Journal of Neurophysiology</source><volume>82</volume><fpage>34</fpage><lpage>41</lpage><pub-id pub-id-type="pmid">10400932</pub-id></element-citation></ref><ref id="bib97"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Solomon</surname> <given-names>D</given-names></name><name><surname>Cohen</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Stabilization of gaze during circular locomotion in darkness. II. Contribution of velocity storage to compensatory eye and head nystagmus in the running monkey</article-title><source>Journal of Neurophysiology</source><volume>67</volume><fpage>1158</fpage><lpage>1170</lpage><pub-id pub-id-type="pmid">1597705</pub-id></element-citation></ref><ref id="bib98"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tanguy</surname> <given-names>S</given-names></name><name><surname>Quarck</surname> <given-names>G</given-names></name><name><surname>Etard</surname> <given-names>O</given-names></name><name><surname>Gauthier</surname> <given-names>A</given-names></name><name><surname>Denise</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Vestibulo-ocular reflex and motion sickness in figure skaters</article-title><source>European Journal of Applied Physiology</source><volume>104</volume><fpage>1031</fpage><lpage>1037</lpage><pub-id pub-id-type="doi">10.1007/s00421-008-0859-7</pub-id><pub-id pub-id-type="pmid">18758803</pub-id></element-citation></ref><ref id="bib99"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taube</surname> <given-names>JS</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>The head direction signal: origins and sensory-motor integration</article-title><source>Annual Review of Neuroscience</source><volume>30</volume><fpage>181</fpage><lpage>207</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.29.051605.112854</pub-id><pub-id pub-id-type="pmid">17341158</pub-id></element-citation></ref><ref id="bib100"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Todorov</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Optimality principles in sensorimotor control</article-title><source>Nature Neuroscience</source><volume>7</volume><fpage>907</fpage><lpage>915</lpage><pub-id pub-id-type="doi">10.1038/nn1309</pub-id><pub-id pub-id-type="pmid">15332089</pub-id></element-citation></ref><ref id="bib101"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tseng</surname> <given-names>YW</given-names></name><name><surname>Diedrichsen</surname> <given-names>J</given-names></name><name><surname>Krakauer</surname> <given-names>JW</given-names></name><name><surname>Shadmehr</surname> <given-names>R</given-names></name><name><surname>Bastian</surname> <given-names>AJ</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Sensory prediction errors drive cerebellum-dependent adaptation of reaching</article-title><source>Journal of Neurophysiology</source><volume>98</volume><fpage>54</fpage><lpage>62</lpage><pub-id pub-id-type="doi">10.1152/jn.00266.2007</pub-id><pub-id pub-id-type="pmid">17507504</pub-id></element-citation></ref><ref id="bib102"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van der Kooij</surname> <given-names>H</given-names></name><name><surname>Jacobs</surname> <given-names>R</given-names></name><name><surname>Koopman</surname> <given-names>B</given-names></name><name><surname>van der Helm</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>An adaptive model of sensory integration in a dynamic environment applied to human stance control</article-title><source>Biological Cybernetics</source><volume>84</volume><fpage>103</fpage><lpage>115</lpage><pub-id pub-id-type="doi">10.1007/s004220000196</pub-id><pub-id pub-id-type="pmid">11205347</pub-id></element-citation></ref><ref id="bib103"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Waespe</surname> <given-names>W</given-names></name><name><surname>Cohen</surname> <given-names>B</given-names></name><name><surname>Raphan</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>Role of the flocculus and paraflocculus in optokinetic nystagmus and visual-vestibular interactions: effects of lesions</article-title><source>Experimental Brain Research</source><volume>50</volume><fpage>9</fpage><lpage>33</lpage><pub-id pub-id-type="doi">10.1007/BF00238229</pub-id><pub-id pub-id-type="pmid">6357831</pub-id></element-citation></ref><ref id="bib104"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Waespe</surname> <given-names>W</given-names></name><name><surname>Henn</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="1977">1977</year><article-title>Neuronal activity in the vestibular nuclei of the alert monkey during vestibular and optokinetic stimulation</article-title><source>Experimental Brain Research</source><volume>27</volume><fpage>523</fpage><lpage>538</lpage><pub-id pub-id-type="doi">10.1007/BF00239041</pub-id><pub-id pub-id-type="pmid">404173</pub-id></element-citation></ref><ref id="bib105"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wearne</surname> <given-names>S</given-names></name><name><surname>Raphan</surname> <given-names>T</given-names></name><name><surname>Cohen</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Control of spatial orientation of the angular vestibuloocular reflex by the nodulus and uvula</article-title><source>Journal of Neurophysiology</source><volume>79</volume><fpage>2690</fpage><lpage>2715</lpage><pub-id pub-id-type="pmid">9582239</pub-id></element-citation></ref><ref id="bib106"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolpert</surname> <given-names>DM</given-names></name><name><surname>Ghahramani</surname> <given-names>Z</given-names></name><name><surname>Jordan</surname> <given-names>MI</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>An internal model for sensorimotor integration</article-title><source>Science</source><volume>269</volume><fpage>1880</fpage><lpage>1882</lpage><pub-id pub-id-type="doi">10.1126/science.7569931</pub-id><pub-id pub-id-type="pmid">7569931</pub-id></element-citation></ref><ref id="bib107"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yakusheva</surname> <given-names>T</given-names></name><name><surname>Blazquez</surname> <given-names>PM</given-names></name><name><surname>Angelaki</surname> <given-names>DE</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Frequency-selective coding of translation and tilt in macaque cerebellar nodulus and uvula</article-title><source>Journal of Neuroscience</source><volume>28</volume><fpage>9997</fpage><lpage>10009</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2232-08.2008</pub-id><pub-id pub-id-type="pmid">18829957</pub-id></element-citation></ref><ref id="bib108"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yakusheva</surname> <given-names>TA</given-names></name><name><surname>Blazquez</surname> <given-names>PM</given-names></name><name><surname>Chen</surname> <given-names>A</given-names></name><name><surname>Angelaki</surname> <given-names>DE</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Spatiotemporal properties of optic flow and vestibular tuning in the cerebellar nodulus and uvula</article-title><source>Journal of Neuroscience</source><volume>33</volume><fpage>15145</fpage><lpage>15160</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2118-13.2013</pub-id><pub-id pub-id-type="pmid">24048845</pub-id></element-citation></ref><ref id="bib109"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yakusheva</surname> <given-names>TA</given-names></name><name><surname>Shaikh</surname> <given-names>AG</given-names></name><name><surname>Green</surname> <given-names>AM</given-names></name><name><surname>Blazquez</surname> <given-names>PM</given-names></name><name><surname>Dickman</surname> <given-names>JD</given-names></name><name><surname>Angelaki</surname> <given-names>DE</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Purkinje cells in posterior cerebellar vermis encode motion in an inertial reference frame</article-title><source>Neuron</source><volume>54</volume><fpage>973</fpage><lpage>985</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2007.06.003</pub-id><pub-id pub-id-type="pmid">17582336</pub-id></element-citation></ref><ref id="bib110"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yakushin</surname> <given-names>SB</given-names></name><name><surname>Raphan</surname> <given-names>T</given-names></name><name><surname>Cohen</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Coding of velocity storage in the vestibular nuclei</article-title><source>Frontiers in Neurology</source><volume>8</volume><elocation-id>386</elocation-id><pub-id pub-id-type="doi">10.3389/fneur.2017.00386</pub-id><pub-id pub-id-type="pmid">28861030</pub-id></element-citation></ref><ref id="bib111"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname> <given-names>W</given-names></name><name><surname>Tang</surname> <given-names>BF</given-names></name><name><surname>Newlands</surname> <given-names>SD</given-names></name><name><surname>King</surname> <given-names>WM</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Responses of monkey vestibular-only neurons to translation and angular rotation</article-title><source>Journal of Neurophysiology</source><volume>96</volume><fpage>2915</fpage><lpage>2930</lpage><pub-id pub-id-type="doi">10.1152/jn.00013.2006</pub-id><pub-id pub-id-type="pmid">16943321</pub-id></element-citation></ref><ref id="bib112"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zupan</surname> <given-names>LH</given-names></name><name><surname>Merfeld</surname> <given-names>DM</given-names></name><name><surname>Darlot</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Using sensory weighting to model the influence of canal, otolith and visual cues on spatial orientation and eye movements</article-title><source>Biological Cybernetics</source><volume>86</volume><fpage>209</fpage><lpage>230</lpage><pub-id pub-id-type="doi">10.1007/s00422-001-0290-1</pub-id><pub-id pub-id-type="pmid">12068787</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec id="s7" sec-type="appendix"><title>Supplementary Methods</title><boxed-text><object-id pub-id-type="doi">10.7554/eLife.28074.035</object-id><p>Here we describe the Kalman model in more detail. We present the model of head motion and vestibular information processing, first as a set of linear equations (‘Model of head motion and vestibular sensors’), and then in matrix form (‘Model of head motion in matrix form’). Next we present the Kalman filter algorithm, in the form of matrix computations (‘Kalman filter algorithm’) and then as a series of equations (‘Kalman filter algorithm developed’).</p><p>Next, we derive a series of properties of the internal model computations (‘Velocity Storage during EVAR’; ‘Passive Tilt’,’ Kalman feedback gains’,’ Time constant of the somatogravic effect’,’ Model of motor commands’).</p><p>We then present some variations of the Kalman model (‘Visual rotation signals’,’ Model of head and neck rotations’, ‘Feedback signals during neck movement’, ‘Three-dimensional Kalman filter’).</p></boxed-text></sec><sec id="s8" sec-type="appendix"><title>Model of head motion and vestibular sensors</title><boxed-text><p>The model of head motion in (<xref ref-type="fig" rid="fig2">Figure 2</xref>) can be described by the following equations (see <xref ref-type="table" rid="table1">Table 1</xref> for a list of mathematical variables):<disp-formula id="equ3"><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>3</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>A</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>4</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf569"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> states that head velocity <inline-formula><mml:math id="inf570"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the sum of self-generated rotation <inline-formula><mml:math id="inf571"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and of unexpected rotations <inline-formula><mml:math id="inf572"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> resulting from motor errors and passive motion. In the absence of motor commands, <inline-formula><mml:math id="inf573"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is expected to be zero on average, independently from all previous events.</p><p><inline-formula><mml:math id="inf574"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>E</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> describes the first-order low-pass dynamics of the canals:<disp-formula id="equ4"><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>.</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>which yields:<disp-formula id="equ5"><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>with <inline-formula><mml:math id="inf575"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf576"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p><inline-formula><mml:math id="inf577"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>E</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>3</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> integrates rotation <inline-formula><mml:math id="inf578"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> into tilt <inline-formula><mml:math id="inf579"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. The variable <inline-formula><mml:math id="inf580"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> acts as a switch: it is set to one during tilt and to 0 during EVAR (in which case <inline-formula><mml:math id="inf581"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> remains equal to zero, independently of <inline-formula><mml:math id="inf582"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>).</p><p>Finally, <inline-formula><mml:math id="inf583"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>E</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>4</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> that describes linear acceleration, resembles <inline-formula><mml:math id="inf584"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>E</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> in form and properties.</p><p>The system of these equations is rewritten as follows in order to eliminate <inline-formula><mml:math id="inf585"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> from the right-hand side (which is needed so that it may fit into the form of <inline-formula><mml:math id="inf586"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>7</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> below):<disp-formula id="equ6"><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>1</mml:mn><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>2</mml:mn><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:mi>s</mml:mi><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi><mml:mo>.</mml:mo><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:mi>s</mml:mi><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi><mml:mo>.</mml:mo><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>3</mml:mn><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>A</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>4</mml:mn><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The model sensory transduction is:<disp-formula id="equ7"><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>5</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>6</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p><inline-formula><mml:math id="inf587"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>E</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>5</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> indicates that the semicircular canals encode rotation velocity, minus the dynamic component <inline-formula><mml:math id="inf588"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>; and <inline-formula><mml:math id="inf589"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>E</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>6</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> indicates that the otolith organs encode the sum of tilt and acceleration.</p></boxed-text></sec><sec id="s9" sec-type="appendix"><title>Model of head motion in matrix form</title><boxed-text><p>The system of equations (<inline-formula><mml:math id="inf590"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>1</mml:mn><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:mi>b</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>) can be rewritten in matrix form:<disp-formula id="equ8"><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mo>.</mml:mo><mml:mi>X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>M</mml:mi><mml:mo>.</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>E</mml:mi><mml:mo>.</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>7</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>with:</p><p><inline-formula><mml:math id="inf591"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi mathvariant="normal">Ω</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>C</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>G</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>A</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf592"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnalign="center center center center" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf593"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnalign="center center" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>s</mml:mi><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf594"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>,<inline-formula><mml:math id="inf595"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext> </mml:mtext><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf596"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>Similarly, the model of sensory transduction <inline-formula><mml:math id="inf597"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>5</mml:mn><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is rewritten as:<disp-formula id="equ9"><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mo>.</mml:mo><mml:mi>X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>8</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>With:<disp-formula id="equ10"><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Given the standard deviations of <inline-formula><mml:math id="inf598"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf599"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf600"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf601"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> (<inline-formula><mml:math id="inf602"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf603"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf604"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf605"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>), the covariance matrices of <inline-formula><mml:math id="inf606"><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf607"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> (that are needed to perform Kalman filter computations) are respectively:</p><p><inline-formula><mml:math id="inf608"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mo>.</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnalign="center center" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf609"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnalign="center center" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>Note that the matrix <inline-formula><mml:math id="inf610"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> used here that unexpected rotations <inline-formula><mml:math id="inf611"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and accelerations <inline-formula><mml:math id="inf612"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> are independent. However, it could easily be adapted to represent more complex covariance matrices resulting for instance from motor noise.</p></boxed-text></sec><sec id="s10" sec-type="appendix"><title>Kalman filter algorithm</title><boxed-text><p>The Kalman filter algorithm (<xref ref-type="bibr" rid="bib47">Kalman, 1960</xref>) computes optimal state estimates in any model that follows the structure of <inline-formula><mml:math id="inf613"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mi>n</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>7</mml:mn><mml:mo>,</mml:mo><mml:mn>8</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>). The optimal estimate <inline-formula><mml:math id="inf614"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is computed by the following steps (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2B</xref>):<disp-formula id="equ11"><mml:math id="m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>D</mml:mi><mml:mo>.</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>M</mml:mi><mml:mo>.</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mspace width="2em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mo>.</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mspace width="2em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mtext> </mml:mtext><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>y</mml:mi><mml:mtext> </mml:mtext><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>δ</mml:mi><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mspace width="2em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>y</mml:mi><mml:mtext> </mml:mtext><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>K</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mspace width="2em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mtext> </mml:mtext><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The Kalman gain matrix <inline-formula><mml:math id="inf615"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>K</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is computed as:<disp-formula id="equ12"><mml:math id="m12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>K</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>.</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>.</mml:mo><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf616"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mo>.</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf617"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext> </mml:mtext><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mi>K</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> are the covariance of the predicted and updated estimates, <inline-formula><mml:math id="inf618"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf619"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> are the covariance matrices of <inline-formula><mml:math id="inf620"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>E</mml:mi><mml:mo>.</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf621"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, and <inline-formula><mml:math id="inf622"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is an identity matrix. These equations are not shown in <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>.</p><p>The initial conditions of <inline-formula><mml:math id="inf623"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> are set according to the initial head position in the simulated motion, and the initial value of <inline-formula><mml:math id="inf624"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf625"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> are set to their steady-state value, which are computed by setting <inline-formula><mml:math id="inf626"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and then running 500 iterations of the Kalman filter algorithm.</p></boxed-text></sec><sec id="s11" sec-type="appendix"><title>Kalman filter algorithm developed</title><boxed-text><p>The inference is performed by applying the Kalman filter algorithm on <inline-formula><mml:math id="inf627"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>E</mml:mi><mml:mi>q</mml:mi><mml:mi>s</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>7</mml:mn><mml:mo>−</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. The corresponding computations can be expanded in the following equations:</p><sec id="s11-1"><title>State predictions</title><p><disp-formula id="equ13"><mml:math id="m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>1</mml:mn><mml:mi>c</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>2</mml:mn><mml:mi>c</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>.</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>3</mml:mn><mml:mi>c</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>4</mml:mn><mml:mi>c</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p></sec><sec id="s11-2"><title>Sensory predictions</title><p><disp-formula id="equ14"><mml:math id="m14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>5</mml:mn><mml:mi>c</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>6</mml:mn><mml:mi>c</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p></sec><sec id="s11-3"><title>Sensory errors</title><p><disp-formula id="equ15"><mml:math id="m15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>5</mml:mn><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>δ</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>6</mml:mn><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p></sec><sec id="s11-4"><title>Final estimates</title><p><disp-formula id="equ16"><mml:math id="m16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>1</mml:mn><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>2</mml:mn><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>3</mml:mn><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>4</mml:mn><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>These equations form the basis of the model (in <xref ref-type="fig" rid="fig9">Figure 9</xref>, <inline-formula><mml:math id="inf628"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf629"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> are assumed to be zero, see ‘Kalman feedback gains’ and <xref ref-type="table" rid="table2">Table 2</xref>).</p></sec></boxed-text></sec><sec id="s12" sec-type="appendix"><title>Velocity storage during EVAR</title><boxed-text><p>Here we analyze the Kalman filter equations to derive the dynamics of rotation perception during passive EVAR and compare it to existing models. During passive EVAR (<inline-formula><mml:math id="inf630"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf631"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), the dynamics of the rotation estimate depends of <inline-formula><mml:math id="inf632"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, which is governed by <inline-formula><mml:math id="inf633"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>2</mml:mn><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>:<disp-formula id="equ17"><mml:math id="m17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mspace width="2em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mtext> </mml:mtext><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>2</mml:mn><mml:mi>c</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mtd><mml:mtd><mml:mspace width="2em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mtext> </mml:mtext><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>2</mml:mn><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>With:<disp-formula id="equ18"><mml:math id="m18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="2em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mtext> </mml:mtext><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>5</mml:mn><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Based on these equations, <inline-formula><mml:math id="inf634"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> follows a first-order differential equation:<disp-formula id="equ19"><mml:math id="m19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="2em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>2</mml:mn><mml:mi>e</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>This equation is characteristic of a leaky integrator, that integrates <inline-formula><mml:math id="inf635"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> with a gain <inline-formula><mml:math id="inf636"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>, and has a time constant <inline-formula><mml:math id="inf637"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> which is computed by solving:<disp-formula id="equ20"><mml:math id="m20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Based on the values of <xref ref-type="table" rid="table2">Table 2</xref>, we compute <inline-formula><mml:math id="inf638"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>=16.5 s (in agreement with the simulations in <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>).</p><p>The final rotation estimate is the sum of <inline-formula><mml:math id="inf639"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and the canal signal:<disp-formula id="equ21"><mml:math id="m21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="2em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mtext> </mml:mtext><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>1</mml:mn><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>These equations reproduce the standard model of (<xref ref-type="bibr" rid="bib81">Raphan et al., 1979</xref>). Note that the gains <inline-formula><mml:math id="inf640"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.19</mml:mn><mml:mtext> </mml:mtext><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf641"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>=16.5 s, and <inline-formula><mml:math id="inf642"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.94</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> are similar to the values in (<xref ref-type="bibr" rid="bib81">Raphan et al., 1979</xref>) and to model fits to experimental data in (<xref ref-type="bibr" rid="bib61">Laurens et al., 2011</xref>). The dynamics of <inline-formula><mml:math id="inf643"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula><inline-formula><mml:math id="inf644"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>2</mml:mn><mml:mi>e</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> can be observed in simulations, i.e. in <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2B</xref> where the leaky integrator is charged by vestibular signals <inline-formula><mml:math id="inf645"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> at t = 0 to 10 s and t = 60 to 70 s; and subsequently discharges with a time constant <inline-formula><mml:math id="inf646"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>=16.5 s. The discharge of the integrator is also observed in <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2C</xref> when t &gt; 60 s <xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3C</xref> when t &gt; 120 s.</p></boxed-text></sec><sec id="s13" sec-type="appendix"><title>Passive tilt</title><boxed-text><p>Here we provide additional mathematical analyses about motion estimation during passive tilt. During passive tilt (<inline-formula><mml:math id="inf647"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>;</mml:mo><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>), the internal estimate <inline-formula><mml:math id="inf648"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> follows:<disp-formula id="equ22"><mml:math id="m22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mspace width="2em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mtext> </mml:mtext><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>3</mml:mn><mml:mi>c</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mspace width="2em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>3</mml:mn><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>First, we note that <inline-formula><mml:math id="inf649"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>3</mml:mn><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> combine into <inline-formula><mml:math id="inf650"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>. In other words, the tilt estimate during passive tilt is computed by integrating feedback signals <inline-formula><mml:math id="inf651"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>Also, to a first approximation, the gain <inline-formula><mml:math id="inf652"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> is close to <inline-formula><mml:math id="inf653"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, the canal error <inline-formula><mml:math id="inf654"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> encodes <inline-formula><mml:math id="inf655"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf656"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is approximately null. In this case, <inline-formula><mml:math id="inf657"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>≈</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi><mml:mo>.</mml:mo><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf658"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Therefore, during passive tilt (<xref ref-type="fig" rid="fig5">Figure 5</xref>, <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>), the internal model (<inline-formula><mml:math id="inf659"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>3</mml:mn><mml:mi>c</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>) integrates tilt velocity signals that originate from the canals and are conveyed by feedback pathways.</p><p>Note, however, that the Kalman gain <inline-formula><mml:math id="inf660"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> is slightly lower than <inline-formula><mml:math id="inf661"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (<inline-formula><mml:math id="inf662"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>≈</mml:mo><mml:mn>0.9</mml:mn><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>; <xref ref-type="table" rid="table2">Table 2</xref>). Yet, the final tilt estimate remains accurate due to an additional feedback originating from <inline-formula><mml:math id="inf663"><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:math></inline-formula> which can be analyzed as follows. Because <inline-formula><mml:math id="inf664"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, the tilt estimate <inline-formula><mml:math id="inf665"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> lags behind <inline-formula><mml:math id="inf666"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, resulting in a small otolith error <inline-formula><mml:math id="inf667"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> that contributes to the feedback signal (via the term <inline-formula><mml:math id="inf668"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> in <inline-formula><mml:math id="inf669"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>3</mml:mn><mml:mi>d</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>). The value of <inline-formula><mml:math id="inf670"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> stabilizes to a steady-state where <inline-formula><mml:math id="inf671"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Based on <inline-formula><mml:math id="inf672"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>3</mml:mn><mml:mi>d</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, we obtain:<disp-formula id="equ23"><mml:math id="m23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>with <inline-formula><mml:math id="inf673"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf674"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>≈</mml:mo><mml:mn>0.13</mml:mn><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (based on <xref ref-type="table" rid="table2">Table 2</xref>).</p><p>Thus, a feedback signal originating from the otolith error complements the canal error. This effect is nevertheless too small to be appreciated in <xref ref-type="fig" rid="fig5">Figure 5</xref>.</p></boxed-text></sec><sec id="s14" sec-type="appendix"><title>Kalman feedback gains</title><boxed-text><p>Here we provide additional information about Kalman gains and we justify that some feedback signals are considered negligible.</p><p>First, we note that some values of the Kalman gain matrix (those involved in a temporal integration), include the parameter <inline-formula><mml:math id="inf675"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="table" rid="table2">Table 2</xref>). This is readily explained by the following example. Consider, for instance, the gain of the vestibular feedback to the tilt estimate (<inline-formula><mml:math id="inf676"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>). During passive tilt, the tilt estimate <inline-formula><mml:math id="inf677"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is tracked by the Kalman filter according to:<disp-formula id="equ24"><mml:math id="m24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="2em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mtext> </mml:mtext><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>3</mml:mn><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mtext> </mml:mtext><mml:mi>δ</mml:mi><mml:mi>F</mml:mi><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Since <inline-formula><mml:math id="inf678"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is computed by integrating canal signals (<inline-formula><mml:math id="inf679"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>) over time, we would expect the equation above to be approximately equal to the following:<disp-formula id="equ25"><mml:math id="m25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Therefore, we expect that <inline-formula><mml:math id="inf680"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>≈</mml:mo><mml:mtext> </mml:mtext><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. When simulations are performed with <inline-formula><mml:math id="inf681"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>s, we find indeed that <inline-formula><mml:math id="inf682"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.009</mml:mn><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn><mml:mtext> </mml:mtext><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Furthermore, if simulations are performed again, but with <inline-formula><mml:math id="inf683"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>s, we find <inline-formula><mml:math id="inf684"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.09</mml:mn><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn><mml:mtext> </mml:mtext><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. In other words, the Kalman gain computed by the filter is scaled as a function of <inline-formula><mml:math id="inf685"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in order to perform the operation of temporal integration (albeit with a gain of 0.9). For this reason, we write <inline-formula><mml:math id="inf686"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn><mml:mtext> </mml:mtext><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in <xref ref-type="table" rid="table2">Table 2</xref>, which is more informative than <inline-formula><mml:math id="inf687"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.009</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. Similarly, other Kalman gain values corresponding to <inline-formula><mml:math id="inf688"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf689"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (which is also computed by temporal integration of Kalman feedback) are shown as a function of <inline-formula><mml:math id="inf690"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in <xref ref-type="table" rid="table2">Table 2</xref>.</p><p>Furthermore, the values of <inline-formula><mml:math id="inf691"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf692"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> are divided by <inline-formula><mml:math id="inf693"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in all figures, for the same reason. If, for example, <inline-formula><mml:math id="inf694"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, then the corresponding value and <inline-formula><mml:math id="inf695"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> would be 0.009 (<inline-formula><mml:math id="inf696"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>). This value is correct (since <inline-formula><mml:math id="inf697"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn><mml:mtext> </mml:mtext><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>) but would cause <inline-formula><mml:math id="inf698"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> to appear disproportionately small. In order to compensate for this, we plot <inline-formula><mml:math id="inf699"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in the figures. The feedback <inline-formula><mml:math id="inf700"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is scaled in a similar manner. In contrast, neither <inline-formula><mml:math id="inf701"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> nor <inline-formula><mml:math id="inf702"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> are scaled.</p><p>Note that the feedback gain <inline-formula><mml:math id="inf703"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> (from the canal error <inline-formula><mml:math id="inf704"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> to <inline-formula><mml:math id="inf705"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>) is equal to -<inline-formula><mml:math id="inf706"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="table" rid="table2">Table 2</xref>). This compensates for a part of the error <inline-formula><mml:math id="inf707"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> during tilt (see previous section), which generates an erroneous acceleration feedback <inline-formula><mml:math id="inf708"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>. This component has a negligible magnitude and is not discussed in the text or included in the model of <xref ref-type="fig" rid="fig9">Figure 9</xref>.</p><p>Note also that the Kalman filter gain <inline-formula><mml:math id="inf709"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> is practically equal to zero (<xref ref-type="table" rid="table2">Table 2</xref>). In practice, this means that the otoliths affect rotation perception only through variable <inline-formula><mml:math id="inf710"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. Accordingly, otolith-generated rotation signals (e.g. <xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3C</xref>, from t = 60 s to t = 120 s) exhibit low-pass dynamics.</p><p>Because <inline-formula><mml:math id="inf711"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf712"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> are practically null and have no measurable effect on behavioral or neuronal responses, the corresponding feedback pathways are excluded from <xref ref-type="fig" rid="fig9">Figure 9</xref>.</p></boxed-text></sec><sec id="s15" sec-type="appendix"><title>Time constant of the somatogravic effect</title><boxed-text><p>Here we analyze the dynamics of the somatogravic effect. During passive linear acceleration, the otolith error <inline-formula><mml:math id="inf713"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> determines the feedback <inline-formula><mml:math id="inf714"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> that aligns <inline-formula><mml:math id="inf715"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> with <inline-formula><mml:math id="inf716"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and therefore minimizes the feedback. This process can be modeled as a low-pass filter based on the following equations:<disp-formula id="equ26"><mml:math id="m26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>3</mml:mn><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ27"><mml:math id="m27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>3</mml:mn><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>g</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mtext> </mml:mtext><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Leading to:</p><p><inline-formula><mml:math id="inf717"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>)</p><p>This equation illustrates that <inline-formula><mml:math id="inf718"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is a low-pass filter that converges towards <inline-formula><mml:math id="inf719"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> with a time constant <inline-formula><mml:math id="inf720"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> = <inline-formula><mml:math id="inf721"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>=1.3 s (<xref ref-type="table" rid="table2">Table 2</xref>).</p><p>Note that the feedback from <inline-formula><mml:math id="inf722"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> to <inline-formula><mml:math id="inf723"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> adds, indirectly, a second component to the differential equation above, leading <inline-formula><mml:math id="inf724"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> to transiently overshoot <inline-formula><mml:math id="inf725"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>. Nonetheless, describing the somatogravic effect as a first-order low-pass filter is accurate enough for practical purposes.</p></boxed-text></sec><sec id="s16" sec-type="appendix"><title>Model of motor commands</title><boxed-text><p>In this model, we assume that the Kalman filter receives copies of motor commands that encode rotation velocity <inline-formula><mml:math id="inf726"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and linear acceleration <inline-formula><mml:math id="inf727"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>. We assume that motor noise and external perturbations amount to two independent Gaussian processes sum up to generate the total unpredictable components <inline-formula><mml:math id="inf728"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf729"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>. It should be noted that internal model computations that underlie motor control, and in particular the transformation of muscle activity into <inline-formula><mml:math id="inf730"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf731"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, requires a series of coordinate transformations that are not modelled here, and that these transformation may affect the covariance matrix of motor noise and therefore of <inline-formula><mml:math id="inf732"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>We found that this simplistic description of motor inputs to the Kalman filter was adequate in this study for two reasons. First, the motor inputs <inline-formula><mml:math id="inf733"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf734"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> appear only in the prediction stage of the Kalman filter <inline-formula><mml:math id="inf735"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>7</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. In all simulations presented in this study, we have observed that motor commands were transformed into accurate predictions of motor commands. We reason that, if the model of motor commands was changed, it would still lead to accurate predictions of the self-generated motion component, as long as the motor inputs are unbiased and are sufficient to compute all motion variables, either directly or indirectly through the internal model. Under these hypotheses, simulation results would remain unchanged.</p><p>Regarding the covariance matrix of motor noise, we find that assuming that the unpredictable motion components <inline-formula><mml:math id="inf736"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf737"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> are independent is sufficient to model the experimental studies considered here. Furthermore, we note that the Kalman filter could readily accommodate a more sophisticated noise covariance matrix, should it be necessary.</p></boxed-text></sec><sec id="s17" sec-type="appendix"><title>Visual rotation signals</title><boxed-text><p>In <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2C</xref>, a visual sensory signal <inline-formula><mml:math id="inf738"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>V</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> was added to the model as in (<xref ref-type="bibr" rid="bib62">Laurens, 2006</xref>; <xref ref-type="bibr" rid="bib56">Laurens and Droulez, 2008</xref>) by simply assuming that it encodes rotation velocity:<disp-formula id="equ28"><mml:math id="m28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>V</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo>+</mml:mo><mml:mi>V</mml:mi><mml:mi>i</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Where <inline-formula><mml:math id="inf739"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>V</mml:mi><mml:mi>i</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is a Gaussian noise with standard deviation <inline-formula><mml:math id="inf740"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.12 rad/s (<xref ref-type="bibr" rid="bib56">Laurens and Droulez, 2008</xref>).</p><p>This signal is incorporated into the matrices of the sensory model as follows:</p><p><inline-formula><mml:math id="inf741"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>V</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>F</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>V</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf742"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnalign="center center center center" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf743"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>V</mml:mi><mml:mi>i</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf744"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnalign="center center center" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>The model of head motion and the matrix equations of the Kalman filter remain unchanged.</p></boxed-text></sec><sec id="s18" sec-type="appendix"><title>Model of head and neck rotations</title><boxed-text><p>We created a variant of the Kalman filter, where trunk velocity in space and head velocity relative to the trunk are two independent variables <inline-formula><mml:math id="inf745"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf746"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. We assumed that head position relative to the trunk is sensed by neck proprioceptors. To model this, we added an additional variable <inline-formula><mml:math id="inf747"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (for ‘neck’) that encodes the position of the head relative to the trunk: <inline-formula><mml:math id="inf748"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. We also added a sensory modality <inline-formula><mml:math id="inf749"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> that represents neck proprioception.</p><p>Total head velocity (which is not an explicit variable in the model but may be computed as <inline-formula><mml:math id="inf750"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) is sensed through the semicircular canals, which were modeled as previously.</p><p>The model of head and trunk motion is based on the following equations:<disp-formula id="equ29"><mml:math id="m29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:msubsup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:msubsup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:msubsup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:msubsup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi><mml:mo>.</mml:mo><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mi>S</mml:mi><mml:mn>3</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mi>S</mml:mi><mml:mn>4</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Note that (<inline-formula><mml:math id="inf751"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) and (<inline-formula><mml:math id="inf752"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), are analogous to (<inline-formula><mml:math id="inf753"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> in the main model and imply that <inline-formula><mml:math id="inf754"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf755"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> are the sum of self-generated (<inline-formula><mml:math id="inf756"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf757"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>) and unpredictable components (<inline-formula><mml:math id="inf758"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf759"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>). <inline-formula><mml:math id="inf760"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>E</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mi>S</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> encodes <inline-formula><mml:math id="inf761"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. The canal model (<inline-formula><mml:math id="inf762"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mi>S</mml:mi><mml:mn>4</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) is identical as in (<inline-formula><mml:math id="inf763"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), the input being the velocity of the head in space, i.e. <inline-formula><mml:math id="inf764"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>The sensory model includes the canal signal <inline-formula><mml:math id="inf765"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and a neck proprioceptive signal <inline-formula><mml:math id="inf766"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> that encodes neck position:<disp-formula id="equ30"><mml:math id="m30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mi>S</mml:mi><mml:mn>5</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mi>S</mml:mi><mml:mn>6</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Note that <inline-formula><mml:math id="inf767"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mi>S</mml:mi><mml:mn>5</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is identical to <inline-formula><mml:math id="inf768"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>5</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> in the main model, and that <inline-formula><mml:math id="inf769"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is subject to sensory noise <inline-formula><mml:math id="inf770"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>Similar to the main model, <inline-formula><mml:math id="inf771"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>S</mml:mi><mml:mn>6</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> are written in matrix form:<disp-formula id="equ31"><mml:math id="m31"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mo>.</mml:mo><mml:mi>X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>M</mml:mi><mml:mo>.</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>E</mml:mi><mml:mo>.</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mi>S</mml:mi><mml:mn>7</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>with:</p><p><inline-formula><mml:math id="inf772"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>N</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>C</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf773"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnalign="center center center center" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf774"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnalign="center center" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf775"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msubsup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>,<inline-formula><mml:math id="inf776"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf777"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msubsup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>Similarly, the model of sensory transduction <inline-formula><mml:math id="inf778"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mi>S</mml:mi><mml:mn>5</mml:mn><mml:mo>−</mml:mo><mml:mi>S</mml:mi><mml:mn>6</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is rewritten as:<disp-formula id="equ32"><mml:math id="m32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mo>.</mml:mo><mml:mi>X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mi>S</mml:mi><mml:mn>8</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>with:<disp-formula id="equ33"><mml:math id="m33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>V</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>P</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Given the standard deviations of <inline-formula><mml:math id="inf779"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf780"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf781"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>and <inline-formula><mml:math id="inf782"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> (<inline-formula><mml:math id="inf783"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf784"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf785"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf786"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>), the covariance matrices of <inline-formula><mml:math id="inf787"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf788"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> are respectively:<disp-formula id="equ34"><mml:math id="m34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mo>.</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnalign="center center" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Simulations were performed using the Kalman filter algorithm, as in the main model.</p></boxed-text></sec><sec id="s19" sec-type="appendix"><title>Feedback signals during neck movement</title><boxed-text><p>In <xref ref-type="fig" rid="fig7s2">Figure 7—figure supplements 2</xref> and <xref ref-type="fig" rid="fig7s3">3</xref>, we note that passive neck motion induces a proprioceptive feedback <inline-formula><mml:math id="inf789"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> that encodes neck velocity, although proprioceptive signals <inline-formula><mml:math id="inf790"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> are assumed to encode neck position. This dynamic transformation is explained by considering that, during passive motion:<disp-formula id="equ35"><mml:math id="m35"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>N</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi>N</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ36"><mml:math id="m36"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>N</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>N</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mrow><mml:mover><mml:mi>N</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Because <inline-formula><mml:math id="inf791"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="table" rid="table3">Table 3</xref>), neck position is updated exclusively by its own proprioceptive feedback <inline-formula><mml:math id="inf792"><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:math></inline-formula>. Furthermore, the equation above is transformed into:<disp-formula id="equ37"><mml:math id="m37"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>N</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mrow><mml:mover><mml:mi>N</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>In a steady-state, <inline-formula><mml:math id="inf793"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>N</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mrow><mml:mover><mml:mi>N</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mtext> </mml:mtext><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, leading to:</p><p><inline-formula><mml:math id="inf794"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> that is <inline-formula><mml:math id="inf795"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>P</mml:mi><mml:mo>≈</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (with <inline-formula><mml:math id="inf796"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mo>≈</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>)</p><p>Thus, similar to the reasons already pointed out in section ‘Kalman feedback gains’, the feedback signal <inline-formula><mml:math id="inf797"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is scaled by <inline-formula><mml:math id="inf798"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>–<xref ref-type="fig" rid="fig7s3">3</xref>. Also, because the gain <inline-formula><mml:math id="inf799"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> (which is close to 1, see <xref ref-type="table" rid="table3">Table 3</xref>) doesn’t scale with <inline-formula><mml:math id="inf800"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, the feedback <inline-formula><mml:math id="inf801"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is also scaled by <inline-formula><mml:math id="inf802"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>–<xref ref-type="fig" rid="fig7s3">3</xref>.</p><p>Importantly, the equations above indicate that neck proprioception error should encode neck velocity even when the proprioceptive signals are assumed to encode neck position.</p><p>Next, we note that, during passive neck rotation, the estimate of head velocity relative to the trunk is determined by <inline-formula><mml:math id="inf803"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Since <inline-formula><mml:math id="inf804"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>P</mml:mi><mml:mo>≈</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, we expect that <inline-formula><mml:math id="inf805"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>≈</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Accordingly, simulations performed with <inline-formula><mml:math id="inf806"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> yield <inline-formula><mml:math id="inf807"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>89</mml:mn><mml:mo>=</mml:mo><mml:mn>0.89</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Furthermore, performing simulations with <inline-formula><mml:math id="inf808"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> leads to <inline-formula><mml:math id="inf809"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>8.9</mml:mn><mml:mo>=</mml:mo><mml:mn>0.89</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. We find that <inline-formula><mml:math id="inf810"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> is also dependent of <inline-formula><mml:math id="inf811"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Therefore, the corresponding Kalman gains scale with <inline-formula><mml:math id="inf812"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in <xref ref-type="table" rid="table3">Table 3</xref>.</p><p>Note that the considerations above can equally explain the amplitude and dynamics of the predicted neck position and of the neck proprioceptive error in <xref ref-type="fig" rid="fig7s6">Figure 7—figure supplement 6</xref>. The simulation in <xref ref-type="fig" rid="fig7s6">Figure 7—figure supplement 6C</xref> is identical (with half the amplitude) to a passive rotation of the head relative to the trunk (<xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2</xref>), where <inline-formula><mml:math id="inf813"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. The simulation in <xref ref-type="fig" rid="fig7s6">Figure 7—figure supplement 6C</xref> can be explained mathematically by noticing that it is equivalent to an active head motion (where <inline-formula><mml:math id="inf814"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) superimposed to a passive rotation of the head with a gain of 0.5 and in the opposite direction, resulting in <inline-formula><mml:math id="inf815"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></boxed-text></sec><sec id="s20" sec-type="appendix"><title>Three-dimensional Kalman filter</title><boxed-text><p>For the sake of simplicity, we have restricted our model to one dimension in this study. However, generalizing the model to three-dimensions may be useful for further studies and is relatively easily accomplished, by (1) replacing one-dimensional variables by three-dimensional vectors and (2) locally linearizing a non-linearity that arises from a vectorial cross-product (<inline-formula><mml:math id="inf816"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>E</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>9</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> below), as shown in this section.</p><sec id="s20-1"><title>Principle</title><p>Generalization of the Kalman filter to three dimensions requires replacing each motion and sensory parameter with a 3D vector. For instance, <inline-formula><mml:math id="inf817"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is replaced by <inline-formula><mml:math id="inf818"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf819"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf820"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> that encode the three-dimensional rotation vector in a head-fixed reference frame <inline-formula><mml:math id="inf821"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. Sensory variables are also replaced by three variables, that is (<inline-formula><mml:math id="inf822"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf823"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf824"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) and (<inline-formula><mml:math id="inf825"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf826"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf827"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) that encode afferent signals from the canals and otoliths in three dimensions.</p><p>With one exception, all variables along one axis (e.g. <inline-formula><mml:math id="inf828"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> along the <inline-formula><mml:math id="inf829"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> axis) are governed by the same set of equations (<inline-formula><mml:math id="inf830"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mi>n</mml:mi><mml:mtext> </mml:mtext><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) as the main model. Therefore, the full 3D model can be thought of as three independent Kalman filters operating along the <inline-formula><mml:math id="inf831"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf832"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> dimensions. The only exception is the three-dimensional computation of tilt, which follows the equation:<disp-formula id="equ38"><mml:math id="m38"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:mi>δ</mml:mi><mml:mi>t</mml:mi><mml:mo>.</mml:mo><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mover><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="2em"/><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>9</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Where <inline-formula><mml:math id="inf833"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf834"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mstyle></mml:math></inline-formula> are vectorial representations of (<inline-formula><mml:math id="inf835"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) and (<inline-formula><mml:math id="inf836"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>), and <inline-formula><mml:math id="inf837"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>×</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> represents a vectorial cross-product. In matrix form,<disp-formula id="equ39"><mml:math id="m39"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi><mml:mo>.</mml:mo><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>×</mml:mo><mml:mover><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>δ</mml:mi><mml:mi>t</mml:mi><mml:mo>.</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi><mml:mo>.</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>This non-linearity is implemented by placing the terms <inline-formula><mml:math id="inf838"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and (<inline-formula><mml:math id="inf839"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) in the matrices <inline-formula><mml:math id="inf840"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf841"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> that integrate rotation inputs (<inline-formula><mml:math id="inf842"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf843"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>) into tilt, as shown below.</p></sec><sec id="s20-2"><title>Implementation</title><p>The implementation of the 3D Kalman filter is best explained by demonstrating how the matrices of the 1D filter are replaced by scaled-up matrices.</p><p>First, we replace all motion variables and inputs by triplets of variables along <inline-formula><mml:math id="inf844"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf845"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>:</p><p><inline-formula><mml:math id="inf846"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi mathvariant="normal">Ω</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>C</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>G</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>A</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf847"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf848"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> are replaced by: <inline-formula><mml:math id="inf849"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mtext> </mml:mtext><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext> </mml:mtext><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext> </mml:mtext><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext> </mml:mtext><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext> </mml:mtext><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext> </mml:mtext><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext> </mml:mtext><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext> </mml:mtext><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext> </mml:mtext><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext> </mml:mtext><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext> </mml:mtext><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext> </mml:mtext><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf850"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msubsup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>,<inline-formula><mml:math id="inf851"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext> </mml:mtext><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msubsup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>Next, we scale the matrix <inline-formula><mml:math id="inf852"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> up; each non-zero element in the 1D version being repeated twice in the 3D version:</p><p><inline-formula><mml:math id="inf853"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnalign="center center center center" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is replaced by <inline-formula><mml:math id="inf854"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnalign="center center center center center center center center center center center center" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>We build <inline-formula><mml:math id="inf855"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in a similar manner. Furthermore, the element <inline-formula><mml:math id="inf856"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (that encodes the integration of <inline-formula><mml:math id="inf857"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> into <inline-formula><mml:math id="inf858"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>) is replaced by a set of terms that encode the cross-product in <inline-formula><mml:math id="inf859"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mn>9</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, as follows:<disp-formula id="equ40"><mml:math id="m40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi><mml:mo>.</mml:mo><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>×</mml:mo><mml:mover><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>δ</mml:mi><mml:mi>t</mml:mi><mml:mo>.</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi><mml:mo>.</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi><mml:mo>.</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>−</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>−</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>−</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p><inline-formula><mml:math id="inf860"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnalign="center center" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>s</mml:mi><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is replaced by <inline-formula><mml:math id="inf861"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnalign="center center center center center center" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>−</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mtd><mml:mtd><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>−</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>−</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mtd><mml:mtd><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>As previously, <inline-formula><mml:math id="inf862"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Note that <inline-formula><mml:math id="inf863"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>and <inline-formula><mml:math id="inf864"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> must be recomputed at each iteration since <inline-formula><mml:math id="inf865"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf866"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> change continuously.</p><p>Similarly, we build the sensor model as follows:</p><p><inline-formula><mml:math id="inf867"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>V</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>F</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf868"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> are replaced by <inline-formula><mml:math id="inf869"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf870"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p><inline-formula><mml:math id="inf871"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnalign="center center center center" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is replaced by <inline-formula><mml:math id="inf872"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnalign="center center center center center center center center center center center center" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p><inline-formula><mml:math id="inf873"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mo>.</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnalign="center center" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf874"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnalign="center center" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> are replaced by:</p><p><inline-formula><mml:math id="inf875"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mo>.</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnalign="center center center center center center" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf876"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnalign="center center center center center center" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></p></sec></boxed-text></sec></app></app-group></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.28074.036</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Glasauer</surname><given-names>Stefan</given-names></name><role>Reviewing Editor</role><aff><institution>Ludwig-Maximilian University of Munich</institution><country>Germany</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;A unified internal model theory to resolve the paradox of active versus passive self-motion sensation&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, and the evaluation has been overseen by a Senior Editor and a Reviewing Editor. The following individual involved in review of your submission has agreed to reveal his identity: Laurence Harris (Reviewer #3).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>This very timely and comprehensive theory paper studies the way self-motion may be estimated by the brain and mainly concerns the vestibular system during active and passive head movements. In particular, it suggests a unified theory for how active and passive motion can be estimated by a single internal model. This extends previous, well-established work by the authors and others applying internal models to the problem of estimation of passive motion. A Kalman filter framework was used to determine optimal (Bayesian) solutions. The paper draws on a considerable amount of previously published experimental evidence from a rich series of elegant experiments to argue the hypothesis and to consolidate a large amount of previously collected data into an explanatory model. The internal forward model proposed here is used to make a series of specific experimental predictions (mainly found in the supplementary information). The model's mathematical development and execution is very thoroughly motivated, as it draws on a solid body of previous computational work. The manuscript did an excellent job of simplifying the description of such complex models. Model simulation results are shown for different scenarios and compared descriptively with neurophysiologic evidence. A particularly strong point about the paper is that it makes multiple testable predictions and could be used, for example, to predict the consequences of experience in microgravity. The principle of this type of model may find application beyond the situation considered here, for example, in looking at how the sensory consequences of an eye movement are combined with retinal information to provide the perception of an apparently stable world (e.g., Bridgeman et al. 1994).</p><p>The reviewers appreciate the structure of the paper and the systematic testing using different conditions building in complexity. The unusual interactive connection with the supplemental material to try and keep the main paper shorter is also appreciated.</p><p>Essential revisions:</p><p>1) Novelty: A major concern for the paper is the nature of the advancement of our understanding of computational principles in the brain: Internal forward models, priors and their impact on error-based movement correction have been extensively studied in the human reaching / motor control literature (from Wolpert et al. to Bernicker et al.; some of this should be mentioned to make a connection to this body of literature) and as such their ability to explain active and passive motion (of arms) are not especially novel. Thus, the main advance must lie in the domain of vestibular information processing, which needs to motivated better.</p><p>2) Cancellation mechanism: The authors state that &quot;we have tested the hypothesis that this postulated cancellation mechanism uses exactly the same sensory internal model computations….&quot; While the authors have put forward one framework that explains a variety of phenomenon, the reviewers wonder if other models could also explain these phenomena. Perhaps (at least for some of the scenarios) the motor command could be subtracted from the sensory estimate of a &quot;passive only&quot; internal model and yield the same response. This should be addressed by a comparison to an alternative &quot;subtraction model&quot;. The simple model is probably what people naively think might be the case and so demonstrating its failings might give the paper more impact.</p><p>3) Reliance of motor command generation: The model does not include an additional feedback pathway – the reliance of motor command generation on sensory estimates. For example, a passive head movement could result in a stabilizing active motor command. Or an active head movement could be less than desired because of noise, requiring an adjustment of the motor command to compensate. Obviously these additional pathways complicate the solution to the Kalman filter gains. While the model is still an important contribution without these pathways, the limitations of the model without these pathways should be addressed.</p><p>4) Motor commands: The authors assume that the motor command is a noiseless signal that is perfectly executed. This apparently doesn't account for motor error, since the effect of motor commands is not deterministic and noiseless, as assumed by injecting the motor command as Xu (see <xref ref-type="fig" rid="fig1">Figure 1B</xref>) into the system model. It seems that this ignores motor noise and execution noise, even though these sources of noise are extremely important (see work by Wolpert and others). In the second paragraph of the subsection “Model of motor commands” the authors claim that 𝑋<sup>𝜀</sup> includes motor noise, but this is not evident and needs to be discussed better. Motor noise would, in this reviewer's opinion, enter before applying M and therefore would have a different noise spectrum and/or covariance matrix than the system noise 𝑋<sup>𝜀</sup>.</p><p>An alternative view would be that processed efference copy signals (i.e. predicted sensory signals) have to be treated the same way as other sensory signals, because 1) the efference copy just like any neural signal cannot be assumed to be noiseless and 2) it would take into account the motor noise appropriately (instead of treating it as external perturbation). Is that view wrong? Or would it provide an alternative to your present model? It seems to me that approaches such as described in papers by Wolpert et al. would consider efference copy input as containing noise. For example, MacNeilage and Glasauer (Front Comput Neurosci 2017) assume that vestibular and efference copy signals are combined like two sensory signals, weighted by their reliability.</p><p>5) Reference frames: a theoretical concern is how do the motor signals (and proprioceptive signals) arrive in the correct form and frame of reference to be compared to the sensory information?</p><p>6) Active vs. passive movements: As mentioned in the text (subsection “Interruption of internal model computations during proprioceptive mismatch”), the current model cannot reproduce some important results concerning active movements: when active head movement is blocked or torque is applied, &quot;central neurons were shown to encode net head motion&quot;. The authors suggest that this &quot;result may be reproduced by the Kalman filter by switching off the internal model of the motor plant.…&quot;. However, this actually means that the Kalman filter model fails to explain this result, because it would need another element. What the authors propose here sounds like an ad-hoc extension of the model (a switch) to explain results, which can as well be interpreted as evidence against the model. It is important to discuss this more appropriately.</p><p>In the second paragraph of the aforementioned subsection, the authors suggest that &quot;proprioceptive mismatch&quot; would cause to stop using the internal model. However, that seems a bit oversimplifying: Proprioceptive mismatch occurs due to a variety of natural conditions (e.g. increased head inertia due to carrying food, or due to fatigue, etc.) for which it would make no sense at all to completely stop using the internal model.</p><p>7) Parameter variations: Technically, systematic parameter variations to test for the robustness of the model predictions are missing (which can be easily addressed).</p><p>8) One reviewer would also like to see more quantitative results showing time courses of adaptation in the model and e.g. firing rates match up with each other. This brings up the question of whether the model does adapt or whether all Kalman filters operate with steady state gain (as suggested by another reviewer).</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.28074.037</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) Novelty: A major concern for the paper is the nature of the advancement of our understanding of computational principles in the brain: Internal forward models, priors and their impact on error-based movement correction have been extensively studied in the human reaching / motor control literature (from Wolpert et al. to Bernicker et al.; some of this should be mentioned to make a connection to this body of literature) and as such their ability to explain active and passive motion (of arms) are not especially novel. Thus, the main advance must lie in the domain of vestibular information processing, which needs to motivated better.</p></disp-quote><p>We agree with the reviewers that the general framework of the internal model has been largely validated by studies of human motor control and has been used to build quantitative dynamic models of trajectory planning (e.g. work on optimal control by Todorov; studies of saccade dynamics by Chen-Harris and eye-head gaze shifts by Saglam and Glasauer) or adaptation (e.g. Kalman filter model by Berlinker and Körding). We added references to this literature in the Introduction; and discussed it in “Discussion: Relation to previous dynamical models” to highlight this connection. However, our model is the only one, to our knowledge, to make the link between sensory dynamics (i.e. the canals), ambiguities (i.e. the otoliths), priors and motor efference copies to simulate the time course of sensory illusions during passive motion.</p><p>Perhaps most importantly, the focus of this study is to model neuronal responses – and this is what our simulations deal with. Thus, it is very different from studies of motor control, where the complexity of the system prevents easy prediction about neural responses. By simulating and explaining neuronal responses during active and passive self-motion in the light of a quantitative model (already well-established during passive motion), this study advances our understanding of how theoretical principles map onto brainstem and cerebellar circuits, and will guide further experimental testing in the future. In our view, this is an advance that extends far beyond the field of vestibular processing.</p><p>Furthermore, understanding how efference copies contribute to self-motion perception will impact many fields connected to the vestibular field, such as that of balance and locomotor control. We discuss in the manuscript how this model clarifies the role of vestibular signals in locomotion and explains the consequences of vestibular deficits. As stated in Berniker and Körding, 2011: “A crucial first step for motor control is therefore to integrate sensory information reliably and accurately”, and practically any locomotor activity beyond reaching movements in seated subjects will affect posture and therefore recruit the vestibular sensory modality. This study will also impact the field of navigation: there is currently a debate why head direction cell tuning disappears in vestibular deficient animals. These papers reason that, since vestibular signals are cancelled in actively moving animals, removing the vestibular organs should not make a difference, which is exactly the sort of misconception that our study aims at dissipating. By providing a state of the art model of self-motion processing during active and passive motion, we are bridging several noticeable gaps between the vestibular and motor control/navigation fields.</p><p>We would also like to point out that the internal model framework presented here accounts for and explains more than half a century of behavioral and neurophysiological experimental findings under a wide range of conditions (active versus passive self-motion, visuo-vestibular interactions; canal-otolith interactions; head/neck rotations). This demonstration of the power of the internal model framework in accounting for and predicting neural responses should rejoice the motor control community, where neurophysiological testing of this framework has been limited.</p><p>We have redesigned <xref ref-type="fig" rid="fig1">Figure 1</xref> to better summarize the relation between our work and previous studies and to illustrate (panel D) how the Kalman filter computations presented here may relate to and interact with internal model computations that underlie motor control. The original <xref ref-type="fig" rid="fig1">Figure 1</xref> has been moved to supplementary figures (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>).</p><disp-quote content-type="editor-comment"><p>2) Cancellation mechanism: The authors state that &quot;we have tested the hypothesis that this postulated cancellation mechanism uses exactly the same sensory internal model computations…&quot; While the authors have put forward one framework that explains a variety of phenomenon, the reviewers wonder if other models could also explain these phenomena. Perhaps (at least for some of the scenarios) the motor command could be subtracted from the sensory estimate of a &quot;passive only&quot; internal model and yield the same response. This should be addressed by a comparison to an alternative &quot;subtraction model&quot;. The simple model is probably what people naively think might be the case and so demonstrating its failings might give the paper more impact.</p></disp-quote><p>We are now considering this and other alternative models in <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> (and <xref ref-type="fig" rid="fig9">Figure 9</xref>) and we have added a section at the end of the Results to present the alternative models. The alternative model suggested by the reviewers can reproduce the suppression of neuronal responses during short-duration rotation, but produces different results from the Kalman filter during translation or long-duration rotations. The idea is that, during brief rotations, both the motor command and the “passive” model would produce estimates that are close to the real motion, and therefore one may cancel another. In contrast, it is well known that passive long-duration rotations, as well as translations, induce motion illusions. When these movements are performed actively, the output of the “passive” model would be affected by these illusions whereas the motor command would encode real motion and therefore they would not cancel each other (see simulations in <xref ref-type="fig" rid="fig9">Figure 9</xref>).</p><p>Can we refute this alternative model based on experimental evidence? To date, we are not aware of neuronal recording studies that has experimentally tested these predictions. Testing this alternative “subtraction model” would require recording VN or rFN neurons during long-duration active rotations; or to record them during tilt and translations with sufficient experimental control to test whether they are affected by the somatogravic effect (as in <xref ref-type="fig" rid="fig9">Figure 9E</xref>). To our knowledge, this has not been done.</p><p>But we can refute the “subtraction” model based on behavioral evidence. Specifically, during long-duration active rotation, rotation perception and the VOR persist indefinitely (although it saturates at about 10°/s in humans, unlike in monkeys; Solomon and Cohen 1992; humans: Guedry and Benson 1983). As shown in <xref ref-type="fig" rid="fig9">Figure 9</xref>, the subtraction model cannot reproduce this.</p><p>Furthermore, post-rotatory responses (i.e. the “negative” rotation estimate that occurs when the rotation stops) are reduced following active rotations in humans and completely cancelled in monkeys (Solomon and Cohen 1992; humans: Guedry and Benson 1983, Howard et al. 1995). These experimental findings severely contradict the “subtraction” model, because the motor command would stop when the motion stops, and the “passive” model would output the same post-rotatory response as during passive motion. Therefore, the “subtraction” model would predict the same post-rotatory response during active and passive motion. In contrast, the Kalman filter predicts that the motor commands are fed through an internal model of the canals (i.e. the same internal model that generates a “velocity storage” signal during passive motion), and this internal model anticipates and cancels post-rotatory responses.</p><p>Another way to understand why the subtraction model would not work is to consider the question of how the brain would generate the correct final self-motion estimate using the difference between the sensory estimate and the motor command as a correction signal. That is, (final estimate) = (motor prediction) + (correction signal). However, if the motor command is identical to the prediction (based on the subtraction model), this would develop as (final estimate) = (motor prediction) + (sensory estimate-motor prediction) = sensory estimate. In other words, this model would predict that the final self-motion estimate is driven by vestibular signals only, even during active motion, in contradiction with the behavioral findings that show an improvement of self-motion perception during active motion. We also consider in <xref ref-type="fig" rid="fig9">Figure 9</xref> other possibilities where the final estimate would be a weighted average of the motor command and sensory predictions, and we demonstrate that none of these combinations accounts for experimental findings (such as the reduction of post-rotatory responses following active rotation).</p><p>We thank the reviewers for bringing this up, as it has helped make our argument for the optimal (Kalman) model stronger.</p><disp-quote content-type="editor-comment"><p>3) Reliance of motor command generation: The model does not include an additional feedback pathway – the reliance of motor command generation on sensory estimates. For example, a passive head movement could result in a stabilizing active motor command. Or an active head movement could be less than desired because of noise, requiring an adjustment of the motor command to compensate. Obviously these additional pathways complicate the solution to the Kalman filter gains. While the model is still an important contribution without these pathways, the limitations of the model without these pathways should be addressed.</p></disp-quote><p>Indeed we have not modelled this feedback pathway because we did not want to complicate an already complex story. A previous Kalman filter model that focused on postural control has done it (van der Kooij et al. 2001). We now show this up front (<xref ref-type="fig" rid="fig1">Figure 1D</xref>) and refer to this again in the Discussion: “Further behavioral evidence” and mention the possibility of extending the Kalman filter approach to model neuronal pathways involved in head stabilization (i.e. the vestibulo-collic reflex and postural control). We agree that this would be a very interesting topic for future work.</p><disp-quote content-type="editor-comment"><p>4) Motor commands: The authors assume that the motor command is a noiseless signal that is perfectly executed. This apparently doesn't account for motor error, since the effect of motor commands is not deterministic and noiseless, as assumed by injecting the motor command as Xu (see <xref ref-type="fig" rid="fig1">Figure 1B</xref>) into the system model. It seems that this ignores motor noise and execution noise, even though these sources of noise are extremely important (see work by Wolpert and others). In the second paragraph of the subsection “Model of motor commands” the authors claim that 𝑋<sup>𝜀</sup> includes motor noise, but this is not evident and needs to be discussed better. Motor noise would, in this reviewer's opinion, enter before applying M and therefore would have a different noise spectrum and/or covariance matrix than the system noise 𝑋<sup>𝜀</sup>.</p></disp-quote><p>We apologize for not clarifying this point better. We use 𝑋<sup>𝜀</sup> to model the responses to passive vestibular stimulation through most sections of the manuscript. However, the model does <italic>not</italic> assume that the motor command is a noiseless signal. Instead, it assumes that motor errors and externally generated perturbations are Gaussian and additive. The sum of multivariate Gaussians is a multivariate Gaussian and the term E. 𝑋<sup>𝜀</sup> represents this sum. Note that this approach can generally be applied even when motor noise and external perturbations have different covariance matrices.</p><p>Here we have used a simple assumption that Ω<sup>ε</sup> (the sum of ‘rotational’ motor errors and passive rotations) and A<sup>ε</sup> (the sum of ‘translational’ motor errors and passive linear accelerations) are independent. Motor noise could indeed have a covariance matrix where these errors are not independent, and this could be easily introduced in the model by a simple adjustment of the matrix Q. Therefore, our choice to assume a simple covariance matrix should not be seen as weakness but instead of the application of the principle of parsimony. Our aim is to model the largest amount of experimental data (within the scope of the study) with the minimal number of parameters, and there are no data (in the experimental studies considered here) that require the adoption of a more complex covariance matrix. Should any subsequent study focus on this issue, the Kalman filter may easily be adapted for this purpose. We discuss this point in Supplementary Methods: “Model of motor commands”.</p><disp-quote content-type="editor-comment"><p>An alternative view would be that processed efference copy signals (i.e. predicted sensory signals) have to be treated the same way as other sensory signals, because 1) the efference copy just like any neural signal cannot be assumed to be noiseless and 2) it would take into account the motor noise appropriately (instead of treating it as external perturbation). Is that view wrong? Or would it provide an alternative to your present model? It seems to me that approaches such as described in papers by Wolpert et al. would consider efference copy input as containing noise. For example, MacNeilage and Glasauer (Front Comput Neurosci 2017) assume that vestibular and efference copy signals are combined like two sensory signals, weighted by their reliability.</p></disp-quote><p>In our model, treating efference copies as sensory signals (and introducing them in the sensory signal matrix S) would change the model’s results. This relates to the way the motor command and the prior on external motion are combined, as can be explained by the following example. Consider a short rotation (ignoring the dynamics of the canals), and suppose that the vestibular signal has a noise of σv = 10°/s, the motor noise has a standard deviation σm = 10°/s and the prior on external perturbations a standard deviation σp = 39°/s (together, σm and σp combine to form the total unpredictable component σε = sqrt(σm^2 + σp^2)≈40°/s). Suppose further that the motor commands encodes a rotation at 100°/s but the canals sense a velocity of 0°/s.</p><p>In our model, the external perturbations are added to the motor command to form a predictive signal with an average of 100°/s and a standard deviation of 40°/s. This will be combined with the signals from the canals (average of 0° and standard deviation of 10°/s) according to the rules of sensory fusion, resulting in a weight of 0.94 for the canals (identical to the vestibular gain k^Omega_deltaV in <xref ref-type="table" rid="table2">Table 2</xref>), 0.06 for the motor command and a final estimate of 6°/s.</p><p>If the motor commands were treated as sensory signals (like the vestibular signals), then the model would make a fusion between 3 Gaussians: the prior on external perturbations (average: 0°/s, standard deviation: 39°/s), the vestibular signals (average: 0°/s, standard deviation: 10°/s) and the motor command (average: 100°/s, standard deviation: 10°/s). The motor command and vestibular signals, having identical levels of noise, would receive identical weights (of 0.48) and the final estimate would be 48°/s. As a conclusion, the basic assumption in sensory fusion is that the reading of a sensor is equal to the variable of interest, plus sensory noise. In the case of motor commands, the efference copy is equal to head motion, plus motor noise, plus external motion. Therefore, treating the motor command as a sensory modality is possible only if the “sensory weight” of the motor commands reflects both the motor noise and the distribution of external motion.</p><p>Another aspect of this question is how Kalman filter relate to weighted averaging. It is indeed possible to approximate the Kalman filter model using weighted averaging operations, assuming (1) short duration stimuli where the internal model’s dynamics can be neglected and (2) that “noise” added to efference copies encompasses external perturbations as well as motor noise (which is what MacNeilage and Glasauer did; c.f. the fourth paragraph of the Introduction). Therefore, their study uses similar concepts to our model – and we thank the reviewer for bringing it to our attention: we now refer to it in the Discussion: “Further behavioral evidence”.</p><disp-quote content-type="editor-comment"><p>5) Reference frames: a theoretical concern is how do the motor signals (and proprioceptive signals) arrive in the correct form and frame of reference to be compared to the sensory information?</p></disp-quote><p>This is indeed a theoretical necessity, and we discuss this point in Supplementary Methods: “Model of motor commands”. The question of how the brain performs the reference frame transformations necessary for motor planning and proprioception is certainly a very exciting and challenging question for the motor control community. While we would not presume to model the neurophysiological operations that underlie these multiple reference frame transformations, we would point out that the present and previous publications address this question to a certain extent. Indeed, the transformation of rotation signals onto tilt derivative signals (represented by “3D” boxes in <xref ref-type="fig" rid="fig10">Figure 10</xref>) and its integration over time amounts to a 3D coordinate transformation (from egocentric to a gravity-centered reference frame) and requires the brain to overcome the non-commutativity of rotations. One of our previous studies (Laurens and Angelaki, Neuron 2013) demonstrated that cerebellar circuits were able to perform this coordinate transformation (i.e. identified the tilt-selective PC represented in <xref ref-type="fig" rid="fig10">Figure 10</xref> and demonstrated that they convert 3D rotation signals into a tilt signal referenced to gravity). Thus, our model actually encompasses one 3D coordinate transformation whose neuronal correlate has been identified experimentally.</p><p>By the way, this point illustrates the fact that, while the vestibular field is considerably simpler than the motor control field, it shares many common questions such as that of 3D coordinate transformations and dynamic Bayesian inference. Furthermore, the vestibular field benefits from the fact that it can be modelled and studied using relatively few variables; it can be supported by a very powerful theoretical framework and very powerful quantitative models, and a sizeable fraction of neuronal populations in vestibular areas of the brainstem and cerebellum have been characterized. We would like to think that it could serve as a valuable model system for investigating the neuronal implementation of computational principles (reference frame transformations, dynamics Bayesian inference…) that are relevant to the motor control community.</p><disp-quote content-type="editor-comment"><p>6) Active vs. passive movements: As mentioned in the text (subsection “Interruption of internal model computations during proprioceptive mismatch”), the current model cannot reproduce some important results concerning active movements: when active head movement is blocked or torque is applied, &quot;central neurons were shown to encode net head motion&quot;. The authors suggest that this &quot;result may be reproduced by the Kalman filter by switching off the internal model of the motor plant.…&quot;. However, this actually means that the Kalman filter model fails to explain this result, because it would need another element. What the authors propose here sounds like an ad-hoc extension of the model (a switch) to explain results, which can as well be interpreted as evidence against the model. It is important to discuss this more appropriately.</p></disp-quote><p>We thank the reviewers for motivating us to discuss this point better. We are now introducing this question in the Introduction, and we discuss it in more detail.</p><p>In brief, several experiments from the Cullen lab demonstrated that, whenever proprioceptive errors occur during active neck movement, neuronal responses become non-linear in the sense that neurons encode the total head motion irrespective of the actual motor command. It is obvious that this cannot be modelled by a Kalman filter (which is linear) and therefore simulating these properties requires an extension of the model. We added a figure (<xref ref-type="fig" rid="fig7s7">Figure 7—figure supplement 7</xref>) that summarizes these findings and points out this non-linearity.</p><p>We do not see this as a weakness of the model. The whole point of the Kalman filter is to model the (linear) internal model computations that has been shown experimentally to affect neuronal responses (linearly) in a wide range of conditions, including combination of active motion and passive whole body rotations; and the Kalman filter does it well. Cullen’s results have demonstrated that proprioceptive conflicts during active motion have consequences that are best described by assuming that these internal model computations cease to influence neuronal responses, and can’t be described in linear terms. In this situation, introducing an ‘ad-hoc’ switching mechanism seems a sensible way to account for this experimental observation.</p><p>In fact, this feature of the model highlights that Cullen’s work has revealed two very different processes – which have never before been described in a single model – or even acknowledged as different. In (Roy and Cullen, 2004; Cullen et al., 2011; Cullen 2012; Carriot et al., 2013; Brooks and Cullen, 2014), the “sensory prediction mismatch” refers to neck proprioceptive errors. In (Brooks and Cullen, 2013, Brooks et al. 2015), “sensory prediction errors” refer to vestibular sensory errors. Cullen’s work has demonstrated that these two errors have fundamentally different roles in internal model computations. The former set of studies have clearly described the “switching” effect of proprioceptive mismatch; and the latter set has interpreted central vestibular responses as vestibular prediction errors (like the present study). However, the elementary difference between these mismatches has never been explained clearly in Cullen’s publications (in fact most of these publications use the term “sensory prediction” indiscriminately to refer to proprioceptive or vestibular predictions). We have now presented these points in the Introduction, and added a section addressing this in the Discussion.</p><disp-quote content-type="editor-comment"><p>In the second paragraph of the aforementioned subsection, the authors suggest that &quot;proprioceptive mismatch&quot; would cause to stop using the internal model. However, that seems a bit oversimplifying: Proprioceptive mismatch occurs due to a variety of natural conditions (e.g. increased head inertia due to carrying food, or due to fatigue, etc.) for which it would make no sense at all to completely stop using the internal model.</p></disp-quote><p>We apologize for this inadvertent oversimplification that would clearly be incorrect in other contexts than Cullen’s experiments, and we carefully reworded this section.</p><disp-quote content-type="editor-comment"><p>7) Parameter variations: Technically, systematic parameter variations to test for the robustness of the model predictions are missing (which can be easily addressed).</p></disp-quote><p>We re-designed <xref ref-type="fig" rid="fig10s2">Figure 10—figure supplement 2</xref> to show the impact of varying (twofold increase or decrease) the parameters of the main model (canal and otoliths). We also tested variations of the parameter of the head and neck model but only described the results in the legend for brevity. Model predictions are generally very robust in the sense that changing model parameters won’t lead to numerical instability or affect simulation results qualitatively but, as expected, may affect the dynamic of the motion estimates.</p><disp-quote content-type="editor-comment"><p>8) One reviewer would also like to see more quantitative results showing time courses of adaptation in the model and e.g. firing rates match up with each other. This brings up the question of whether the model does adapt or whether all Kalman filters operate with steady state gain (as suggested by another reviewer).</p></disp-quote><p>Indeed, we did not model adaptation in this study. Although we are convinced that modeling the internal model’s adaptation would be very valuable work (in particular in connection with works on cerebellar learning as well as previous works on adaptation in the motor system, e.g. Berniker and Körding 2008), we thought that it would be best to keep it for a future study. The present manuscript is already packed with much information and a large number of main text and supplemental figures.</p></body></sub-article></article>