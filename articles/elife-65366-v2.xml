<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">65366</article-id><article-id pub-id-type="doi">10.7554/eLife.65366</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Evolutionary Biology</subject></subj-group></article-categories><title-group><article-title>Whole genome phylogenies reflect the distributions of recombination rates for many bacterial species</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-219810"><name><surname>Sakoparnig</surname><given-names>Thomas</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-219812"><name><surname>Field</surname><given-names>Chris</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6434-3745</contrib-id><xref ref-type="aff" rid="aff1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="pa1">†</xref></contrib><contrib contrib-type="author" corresp="yes" id="author-22473"><name><surname>van Nimwegen</surname><given-names>Erik</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-6338-1312</contrib-id><email>erik.vannimwegen@unibas.ch</email><xref ref-type="aff" rid="aff1"/><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><institution>Biozentrum, University of Basel, and Swiss Institute of Bioinformatics</institution><addr-line><named-content content-type="city">Basel</named-content></addr-line><country>Switzerland</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Nourmohammad</surname><given-names>Armita</given-names></name><role>Reviewing Editor</role><aff><institution>University of Washington</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Walczak</surname><given-names>Aleksandra M</given-names></name><role>Senior Editor</role><aff><institution>École Normale Supérieure</institution><country>France</country></aff></contrib></contrib-group><author-notes><fn fn-type="present-address" id="pa1"><label>†</label><p>Institute of Microbiology, ETH-Zurich, Zurich, Switzerland</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>08</day><month>01</month><year>2021</year></pub-date><pub-date pub-type="collection"><year>2021</year></pub-date><volume>10</volume><elocation-id>e65366</elocation-id><history><date date-type="received" iso-8601-date="2020-12-02"><day>02</day><month>12</month><year>2020</year></date><date date-type="accepted" iso-8601-date="2021-01-07"><day>07</day><month>01</month><year>2021</year></date></history><permissions><copyright-statement>© 2021, Sakoparnig et al</copyright-statement><copyright-year>2021</copyright-year><copyright-holder>Sakoparnig et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-65366-v2.pdf"/><abstract><p>Although recombination is accepted to be common in bacteria, for many species robust phylogenies with well-resolved branches can be reconstructed from whole genome alignments of strains, and these are generally interpreted to reflect clonal relationships. Using new methods based on the statistics of single-nucleotide polymorphism (SNP) splits, we show that this interpretation is incorrect. For many species, each locus has recombined many times along its line of descent, and instead of many loci supporting a common phylogeny, the phylogeny changes many thousands of times along the genome alignment. Analysis of the patterns of allele sharing among strains shows that bacterial populations cannot be approximated as either clonal or freely recombining but are structured such that recombination rates between lineages vary over several orders of magnitude, with a unique pattern of rates for each lineage. Thus, rather than reflecting clonal ancestry, whole genome phylogenies reflect distributions of recombination rates.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>prokaryotic genome evolution</kwd><kwd>recombination</kwd><kwd>phylogeny</kwd><kwd>population structure</kwd><kwd>single nucleotide polymorphisms</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>B. subtilis</italic></kwd><kwd><italic>E. coli</italic></kwd><kwd>Human</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001711</institution-id><institution>Swiss National Science Foundation</institution></institution-wrap></funding-source><award-id>31003A_135397</award-id><principal-award-recipient><name><surname>van Nimwegen</surname><given-names>Erik</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>For many bacterial species, recombination dominates genome evolution and phylogenetic patterns that have so far been assumed to reflect clonal relationships, in fact reflect variation in recombination rates across lineages.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>The only illustration that appears in Darwin’s Origin of Species (<xref ref-type="bibr" rid="bib7">Darwin, 1859</xref>) is of a phylogenetic tree. Indeed, the tree has become the archetypical concept representing biological evolution. Since every biological cell that has ever lived was the result of a cell division, all cells are connected through cell divisions in a giant tree that stretches all the way back to the earliest cells that existed on earth. Thus, the study of biological evolution in some sense corresponds to the study of the structure of this giant cell-division tree.</p><p>It is therefore natural that the first step in the analysis of a set of related biological sequences is to reconstruct the phylogenetic tree that reflects the cell division history of the sequences, that is their ‘clonal phylogeny’. Once the ancestral relationships between the sequences are known, the evolution of the sequences can then be modeled along the branches of this tree. Indeed, virtually all models of evolutionary dynamics are formulated as occurring along the branches of a tree, and many mathematical and computational methods have been developed for their inference, see for example (<xref ref-type="bibr" rid="bib16">Felsenstein, 1981</xref>; <xref ref-type="bibr" rid="bib37">Page and Holmes, 1998</xref>). This strategy has been employed from the earliest days of sequence analysis (<xref ref-type="bibr" rid="bib53">Zuckerkandl and Pauling, 1965</xref>) and is almost invariably applied in the analysis of microbial genome sequences, which is the main topic of this work.</p><p>A second key concept in models of evolutionary dynamics is the idea of a ‘population’ of organisms that are mutually competing for resources and that, for purposes of mathematical modeling, can be considered exchangeable in the sense that they are subjected to the same environment. Indeed, populations of exchangeable individuals form the basis of almost all mathematical population genetics models (see e.g. [<xref ref-type="bibr" rid="bib21">Hartl and Clark, 2006</xref>]), including coalescent models for phylogenies (<xref ref-type="bibr" rid="bib49">Wakeley, 2008</xref>). Although it is of course well recognized that, in the real world, populations are structured into sub-populations with varying degrees of interaction between them, population genetics models of evolutionary dynamics almost by definition assume that at some level there are sub-populations of exchangeable individuals sharing a common environment.</p><p>In this paper, we present evidence that we believe challenges the usefulness of applying these two concepts for describing genome evolution in prokaryotes. First, we find that for most bacterial species recombination is so frequent that, within an alignment of strains, each genomic locus has been overwritten by recombination many times and the phylogeny typically changes tens of thousands of times along the genome. Moreover, for most pairs of strains, none of the loci in their pairwise alignment derives from their ancestor in the clonal phylogeny, and the vast majority of genomic differences result from recombination events, even for very close pairs. Consequently, apart from a few groups of very closely related strains, clonal ancestry cannot be reconstructed from the genome sequences using currently available methods and, more generally, the strategy of modeling microbial genome evolution as occurring along the branches of a single phylogeny breaks down.</p><p>Second, we show that recombination among bacterial strains is not random but subject to strong and complex <italic>population structure</italic>, that is recombination occurs at very different rates between different lineages. Although almost every short segment in the whole genome alignment of a set of strains follows a different phylogeny, these phylogenies are not uniformly randomly sampled from all possible phylogenies, but sampled from highly biased distributions that reflect this population structure. In particular, while a large diversity of phylogenetic trees occurs along the whole genome alignment, some subsets of strains share alleles much more frequently than others. In particular, the frequencies with which different subsets of strains share alleles follow approximately power-law distributions. In addition, almost every individual strain has a distinct distribution of frequencies with which it shares alleles with other strains. This suggests that the rates at which the genetic ancestors of each strain have recombined with the genetic ancestors of other strains are unique for each strain, so that the assumption that at some level the strains can be considered as exchangeable members of a population may also fundamentally break down.</p><p>The structure of the paper is as follows. To present our analyses, we will focus on a collection of 91 wild <italic>Escherichia coli</italic> strains that were isolated over a short period from a common habitat (<xref ref-type="bibr" rid="bib24">Ishii et al., 2007</xref>). Using these strains, we introduce the main puzzle of bacterial whole genome phylogeny: although the phylogenies of individual genomic loci are all distinct, the phylogeny inferred from any large collection of genomic loci converges to a common structure, for example (<xref ref-type="bibr" rid="bib50">Wolf et al., 2002</xref>; <xref ref-type="bibr" rid="bib28">Lerat et al., 2003</xref>; <xref ref-type="bibr" rid="bib46">Touchon et al., 2009</xref>). This convergence has led many researchers to assume that the phylogeny reconstructed from a whole genome alignment must represent the clonal phylogeny, and that recombination can be detected and quantified by measuring deviations from this whole genome phylogeny, for example (<xref ref-type="bibr" rid="bib4">Bobay et al., 2015</xref>; <xref ref-type="bibr" rid="bib11">Didelot and Wilson, 2015</xref>; <xref ref-type="bibr" rid="bib51">Yahara et al., 2016</xref>; <xref ref-type="bibr" rid="bib33">Mostowy et al., 2017</xref>; <xref ref-type="bibr" rid="bib17">Garud et al., 2019</xref>). However, as far as we are aware, there are no rigorous justifications for assuming that this whole genome phylogeny corresponds to the clonal phylogeny or that deviations from this global phylogeny can be used to quantify recombination. Here, we introduce methods for quantifying the role of recombination that do not rely on such assumptions and show that the whole genome phylogeny in fact does not correspond to the clonal phylogeny for many bacterial species, but instead reflects population structure.</p><p>We first study recombination by studying pairs of strains, extending a recent approach by <xref ref-type="bibr" rid="bib12">Dixit et al., 2015</xref>, to model each pairwise alignment as a mixture of clonally inherited and recombined regions. We show that, as the distance to the pair’s clonal ancestor increases, the fraction of the genome covered by recombined segments increases, and at some pairwise distance all clonally inherited DNA disappears. Importantly, this distance is far below the typical divergence of pairs of strains such that for the vast majority of pairs, none of the DNA in their genome alignment stems from their clonal ancestor.</p><p>Much of the new analysis methodology that we introduce is based on bi-allelic single-nucleotide polymorphisms (SNPs; which constitute almost all SNPs in the core alignment). Although bi-allelic SNPs have been studied to estimate the number of recombinations along alignments of sexually reproducing species (<xref ref-type="bibr" rid="bib22">Hudson and Kaplan, 1985</xref>), they have received relatively little attention in the study of prokaryotic genomes. We show that almost every bi-allelic SNP corresponds to a single-nucleotide substitution in the history of the strains at the corresponding genomic position, so that the subset of strains sharing a common nucleotide must form a clade in the phylogeny at that position. We show various ways in which these bi-allelic SNPs can be used to investigate which SNPs are consistent with given phylogenies, or each other, and use them to quantify the amount of phylogenetic variation along the alignment. Using such analysis, we show that the phylogeny must change every few SNPs along the genome alignment, and derive a lower bound on the ratio of recombination to mutation events in the genome alignment.</p><p>To obtain a separate validation of our methods, we not only apply our methods to the real data from the <italic>E. coli</italic> strains but also to data from simulations of a simple evolutionary dynamics in which genomes of a well-mixed population of fixed size <italic>N</italic> evolve under reproduction, (neutral) mutation at a fixed rate <italic>μ</italic> per base per generation, and homologous recombination at a rate <italic>ρ</italic> per base per generation. By comparing the known ground truth for the simulated data with the results of our methods, we confirm the accuracy of our methods on the simulated data. We also use results of our methods on simulated data to clarify the precise meaning of several statistics that we calculate.</p><p>Applying the methods and statistics that we developed for <italic>E. coli</italic> to a set of other bacterial species, that is <italic>Bacillus subtilis</italic>, <italic>Helicobacter pylori</italic>, <italic>Mycobacterium tuberculosis</italic>, <italic>Salmonella enterica</italic>, and <italic>Staphylococcus aureus</italic>, we show that, with the exception of <italic>M. tuberculosis</italic> where all strains are very closely related and most if not all DNA has been clonally inherited, all other species follow the same general behavior as <italic>E. coli</italic>.</p><p>To explain how a robust core genome phylogeny can emerge in spite of the fact that a very large number of different phylogenies occurs along the genome, we use data from human genomes as an illustration. We show that phylogenies reconstructed from large numbers of loci from human genomes also converge to a robust phylogeny. Moreover, this phylogeny reflects the known human population structure, and we propose that bacterial whole genome phylogenies similarly reflect population structure, that is the rates with which different lineages have recombined. To support this interpretation, we show how bi-allelic SNPs can also be used to quantify the relative frequencies with which different subsets of strains share alleles. We find that these frequencies follow approximately scale-free distributions, indicating that there is population structure at every scale. Finally, we define entropy profiles of the phylogenetic variability of each strain and show that these entropy profiles provide a unique phylogenetic fingerprint of almost every strain. In addition, we show that simple evolutionary models of fully mixed populations cannot reproduce the statistics we observe for real genomic data, further supporting that these phylogenetic patterns reflect complex population structure. We conclude that our observations necessitate a new way of thinking about how to model genome evolution in prokaryotes.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>To illustrate our methods, we focus on the SC1 collection of wild <italic>E. coli</italic> isolates that were collected in 2003–2004 near the shore of the St. Louis river in Duluth, Minnesota (<xref ref-type="bibr" rid="bib23">Ishii et al., 2006</xref>; <xref ref-type="bibr" rid="bib24">Ishii et al., 2007</xref>). We sequenced 91 strains from this collection together with the K12 MG1655 lab strain as a reference. In a companion paper (Field, 2020, in preparation), we discuss this collection in more detail and extensively analyze the evolution of gene content and phenotypes of this collection. Here, we focus on sequence evolution in the core genome of these strains, that is the genomic regions that are shared by all strains. Although the SC1 strains were collected from a common habitat over a short period of time, they show a remarkable diversity, with no two identical strains, all known major phylogroups of <italic>E. coli</italic> represented, as well as an ‘out group’ of 9 strains that are more than 6% diverged at the nucleotide level from other <italic>E. coli</italic> strains (see <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> for a phylogenetic tree constructed using maximum likelihood on the joint core genome of the SC1 strains and 189 reference strains [Field, 2020, in preparation]).</p><sec id="s2-1"><title>Phylogenies of individual loci disagree with the phylogeny of the core genome</title><p>To construct a core genome alignment of the SC1 strains and K12 MG1655, that is the genomic regions that occur in all strains, we used the Realphy software (<xref ref-type="bibr" rid="bib3">Bertels et al., 2014</xref>; see Materials and methods), resulting in a multiple alignment across all 92 strains of <inline-formula><mml:math id="inf1"><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mn>756</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mn>541</mml:mn></mml:mrow></mml:math></inline-formula> base pairs long, with <inline-formula><mml:math id="inf2"><mml:mrow><mml:msup><mml:mn>299</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mn>077</mml:mn></mml:mrow></mml:math></inline-formula> (10.8%) of the positions exhibiting polymorphism. Note that the core genome length corresponds to about 56% of the median genome length of the strains. Although all strains are unique when their full genomes are considered, there are some groups of strains that are so close that they are identical in their core genomes, so that there are only 82 unique core genomes in total. Realphy used PhyML (<xref ref-type="bibr" rid="bib19">Guindon et al., 2010</xref>) to reconstruct a phylogeny from the core genome alignment and we will refer to this tree as the <italic>core tree</italic> from here on (<xref ref-type="fig" rid="fig1">Figure 1</xref>).</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Whereas phylogenies of individual alignment blocks differ substantially from the core tree, phylogenies reconstructed from a large number of blocks are highly similar to the core tree.</title><p>Top left: For each split (i.e. branch) in the core tree, the color indicates what fraction of the phylogenies of 3 kb blocks support that bi-partition of the strains. Top right: Cumulative distribution of branch support, that is fraction of 3 kb blocks supporting each branch. The dotted lines indicated show the fraction of branches that have less than 50% support (yellow) and the median support per branch (purple). Bottom left and bottom right : As in the top row, but now based on phylogenies reconstructed from random subsets of 50% of all 3 kb blocks as opposed to individual blocks.</p><p><supplementary-material id="fig1sdata1"><label>Figure 1—source data 1.</label><caption><title>List of database accessions of the genomes used.</title></caption><media mime-subtype="plain" mimetype="text" xlink:href="elife-65366-fig1-data1-v2.txt"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Joint maximum likelihood phylogeny of our strains and 189 <italic>E.coli</italic> reference strains.</title><p>Maximum likelihood tree reconstructed from the core genome alignments of the SC1 strains (red font names), the K-12 lab strain (green font name), and 189 <italic>E. coli</italic> reference strains (black font names). Known phylogroups are indicated as different colored leaf nodes. The SC1 strains are distributed across essentially all known phylogroups, include strains that cannot be easily assigned to a phylogroup, and a distal ‘outgroup’ of nine strains (black leaves) that are at 6% nucleotide divergence from other strains (branch shortened).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig1-figsupp1-v2.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 2.</label><caption><title>Each 3 kb alignment block rejects the core tree topology as well as the topologies of the phylogenies reconstructed from all other blocks.</title><p>Each 3 kb alignment block rejects the core tree topology as well as the topologies of the phylogenies reconstructed from all other blocks. Left panel: For each 3 kb block in the core alignment, we used PhyML to reconstruct a phylogeny and then calculated the difference in the log-likelihood of the alignment block under the topology of the core tree and the log-likelihood of the reconstructed phylogeny. The figure shows the reverse cumulative distribution of these log-likelihood differences, with the vertical axis shown on a logarithmic scale. There are virtually no blocks for which the log-likelihood of the core tree topology is close to the log-likelihood under the block’s own phylogeny. Right panel: As in the left panel, but now we calculated, for each 3 kb block, the log-likelihood differences for the topologies of the phylogenies reconstructed from all other blocks. Each block attains a substantially higher log-likelihood when using its own topology than using the topology of any other alignment block.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig1-figsupp2-v2.tif"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 3.</label><caption><title>Fractions of positions that are clonally inherited (not affected by recombination) along each branch of the clonal phylogeny for the simulated datasets.</title><p>Fractions of positions that are clonally inherited (not affected by recombination) along each branch of the clonal phylogeny for the simulated datasets. Each panel shows the clonal phylogeny with the color of the branches indicating what fraction of positions were clonally inherited from all (blue) to none (red) along that branch. Panels correspond, from top-left to bottom-right, to recombination to mutation rates of <inline-formula><mml:math id="inf3"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> equalling 10, 1, 0.3, 0.1, 0.01, and 0.001. The fractions at the leaves indicate the fraction of the genome that was clonally inherited along each terminal branch.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig1-figsupp3-v2.tif"/></fig></fig-group><p>We first checked to what extent the alignments of individual genomic loci are statistically consistent with the core tree. For each 3 kb block of the core alignment, we used PhyML to reconstruct a phylogeny and then compared its log-likelihood with the log-likelihood that can be obtained when the phylogeny is constrained to have the topology of the core tree. We find that essentially all 3 kb alignment blocks reject the core tree topology (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>, left panel). Moreover, each alignment block rejects the topologies that were constructed from all other alignment blocks (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>, right panel).</p><p>Although it thus appears that the phylogeny at each genomic locus is statistically significantly distinct, it is still possible that all these phylogenies are highly similar. In order to quantify the differences between the core tree and the phylogenies of 3 kb blocks we calculated, for each split in the core tree, the fraction of 3 kb blocks for which the same split occurred in the phylogeny reconstructed from that alignment block. As shown in the top row of <xref ref-type="fig" rid="fig1">Figure 1</xref>, the phylogenies of individual blocks differ substantially from the core tree: roughly two-thirds of the splits in the core tree occur in less than half of 3 kb block phylogenies and half of the core tree splits occur in less than a quarter of all 3 kb block phylogenies. Particularly, the splits higher up in the core tree do not occur in the large majority of block phylogenies.</p><p>These observations are not particularly novel. There is by now a vast and sometimes contentious literature on the role of recombination in prokaryotic genome evolution which is beyond the scope of this article to review. We thus focus on a few key points that are central to the questions and methods we study here. First, systematic studies of complete microbial genomes have shown that horizontal gene transfer is relatively common and can significantly affect phylogenies of individual loci, for example (<xref ref-type="bibr" rid="bib20">Guttman and Dykhuizen, 1994</xref>; <xref ref-type="bibr" rid="bib27">Lawrence and Ochman, 1998</xref>), and many studies have observed that different genomic loci support different phylogenies, for example (<xref ref-type="bibr" rid="bib43">Shapiro et al., 2012</xref>). Such observations caused some researchers to question whether trees can be meaningfully used to describe genome evolution (<xref ref-type="bibr" rid="bib14">Doolittle, 1999</xref>). Interestingly, it has recently been shown that recombination can play a major role in genome evolution even within relatively short-term laboratory evolution experiments (<xref ref-type="bibr" rid="bib32">Maddamsetti and Lenski, 2018</xref>).</p><p>In spite of this, many researchers in the field feel that a major phylogenetic backbone can still be extracted from genomic data. For example, it has been observed that, whenever a phylogeny is reconstructed from the alignments of a large number of genomic loci, one obtains the same or highly similar phylogenies, for example (<xref ref-type="bibr" rid="bib50">Wolf et al., 2002</xref>; <xref ref-type="bibr" rid="bib28">Lerat et al., 2003</xref>; <xref ref-type="bibr" rid="bib46">Touchon et al., 2009</xref>). We also observe this behavior for our strains. Phylogenies reconstructed from a random sample of 50% of all 3 kb blocks look highly similar to the core tree, that is with two thirds of the core tree’s splits occurring in <italic>all</italic> phylogenies (<xref ref-type="fig" rid="fig1">Figure 1</xref>, bottom row).</p><p>How should we interpret this convergence of phylogenies to the core phylogeny as increasing numbers of genomic loci are included? One interpretation that has been proposed is that once a large number of genomic segments is considered, effects of horizontal transfer are effectively averaged out and the phylogeny that emerges corresponds to the clonal ancestry of the strains, for example (<xref ref-type="bibr" rid="bib50">Wolf et al., 2002</xref>; <xref ref-type="bibr" rid="bib4">Bobay et al., 2015</xref>). Indeed, it has become quite common for researchers to detect and quantify recombination using methods that compare local phylogenetic patterns with an overall reference phylogeny constructed from the entire genome, for example (<xref ref-type="bibr" rid="bib4">Bobay et al., 2015</xref>; <xref ref-type="bibr" rid="bib11">Didelot and Wilson, 2015</xref>; <xref ref-type="bibr" rid="bib51">Yahara et al., 2016</xref>; <xref ref-type="bibr" rid="bib33">Mostowy et al., 2017</xref>; <xref ref-type="bibr" rid="bib17">Garud et al., 2019</xref>; <xref ref-type="bibr" rid="bib6">Croucher et al., 2015</xref>). However, the validity of such approaches rests on the assumption that this reference phylogeny really represents the clonal phylogeny, and it is currently unclear whether this is justified.</p><p>Indeed, some recent studies have argued that recombination is so common in some bacterial species that it is impossible to meaningfully reconstruct the clonal tree from the genome sequences, and that these species should be considered freely recombining, for example (<xref ref-type="bibr" rid="bib41">Rosen et al., 2015</xref>). However, if members of the species are freely recombining, one would expect the core tree to take on a star-like structure as opposed to the clear and consistent phylogenetic structure that phylogenies converge to as more genomic regions are included in the analysis. Addressing this puzzle is one of the topics of this work.</p></sec><sec id="s2-2"><title>Simulations of a simple evolutionary model including drift, mutation, and recombination</title><p>To confirm the validity of our methods introduced below, and to provide a reference for comparison of the results we observe on the <italic>E. coli</italic> data with those from a well-understood evolutionary dynamics, we performed simulations of a relatively simple evolutionary model that includes drift, (neutral) mutation, and recombination. As described in the Materials and methods, we simulated populations of constant size <italic>N</italic> with non-overlapping generations, a constant mutation rate <italic>μ</italic> per generation per base, and assuming all mutations are neutral. We also included recombination by inserting genomic fragments of length <inline-formula><mml:math id="inf4"><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula> from randomly chosen other individuals in the population at a rate <italic>ρ</italic> per position per generation. In order to make the simulation results comparable to our core genome alignment of <italic>E. coli</italic> strains, we focused on genome alignments of a sample of <inline-formula><mml:math id="inf5"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula> individuals from the population and set the mutation rate <italic>μ</italic> such that the fraction of polymorphic columns in the simulated alignment is similar to that observed in the real data, that is 10%. Apart from simulations without recombination, we performed simulations with a wide range of recombination to mutation rates from <inline-formula><mml:math id="inf6"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf7"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>. We used <inline-formula><mml:math id="inf8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>12</mml:mn><mml:mi>k</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> for the length of the recombination segments which is on the lower end of the recombinant segments we observe in <italic>E. coli</italic>, as we will see below (<xref ref-type="fig" rid="fig2">Figure 2J</xref>). In addition, in order to facilitate comparison of statistics across simulations with different recombination rates, we made sure to design these simulations such that a clonal tree of the sample of <inline-formula><mml:math id="inf9"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula> genomes is drawn once according to the well-known Kingman coalescent (<xref ref-type="bibr" rid="bib49">Wakeley, 2008</xref>), and then used the same clonal tree in all simulations. In each simulation, we explicitly tracked how many times each position in the genome was overwritten by recombination along each branch of the clonal phylogeny (see Materials and methods).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Pairwise analysis of recombination in the SC1 strains.</title><p>(<bold>A-C</bold>) SNP densities (SNPs per kilobase) along the core genome for three pairs of strains at overall nucleotide divergences of <inline-formula><mml:math id="inf10"><mml:mrow><mml:mn>4</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> (D6–F2), 0.002 (C10–D7), and 0.0048 (D6–H10). (<bold>D-F</bold>) Corresponding histograms for the number of SNPs per kilobase (dots) together with fits of the mixture model for D6-F2 (blue), C10-D7 (green), and D6-H10 (red). Note the vertical axis is on a logarithmic scale. (<bold>G</bold>) For each pair of strains (dots), the fraction of the genome that was inherited clonally is shown as a function of the nucleotide divergence of the pair, shown on a logarithmic scale. The three pairs that were shown in panels (<bold>A-F</bold>) are shown as the blue, green, and red dots. The light green, yellow, and blue segments show strains that are mostly clonal, a mixture of clonal and recombined, and fully recombined, respectively. (<bold>H</bold>) Fraction of all SNPs that lie in recombined regions as a function of the clonally inherited fraction of the genome. (<bold>I</bold>) Cumulative distribution of the clonal fractions of the pairs. (<bold>J</bold>) Cumulative distribution of the lengths of recombined segments for pairs that are in the mostly clonal regime. The mean length of recombined regions is <inline-formula><mml:math id="inf11"><mml:mrow><mml:msup><mml:mn>31</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mn>197</mml:mn></mml:mrow></mml:math></inline-formula>, with first quartile 2000, median <inline-formula><mml:math id="inf12"><mml:mrow><mml:msup><mml:mn>19</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mn>500</mml:mn></mml:mrow></mml:math></inline-formula>, and third quartile <inline-formula><mml:math id="inf13"><mml:mrow><mml:msup><mml:mn>66</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Statistics of the pairwise analysis on the simulated data.</title><p>Statistics of the pairwise analysis on the simulated data. Each row of panels corresponds to simulations performed with a different recombination rate (indicated in each row) and shows, in blue, the same results as in panels G, H, and I of <xref ref-type="fig" rid="fig2">Figure 2</xref>, that is the fraction of the genome that was clonally inherited as a function of divergence for each pair, the fraction of all mutations that derive from recombination as a function of the clonally inherited fraction, and the cumulative distribution of clonally inherited fractions. For reference, the corresponding results for the <italic>E. coli</italic> strains are shown in gray.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>The pairwise analysis accurately estimates both the clonally inherited fractions and the sizes of the recombined segments for the simulation data.</title><p>The pairwise analysis accurately estimates both the clonally inherited fractions and the sizes of the recombined segments. Left panels: Comparison of the true fraction of the genome that was clonally inherited (horizontal axis) and the estimated fraction from the pairwise analysis (vertical axis) for the simulation with <inline-formula><mml:math id="inf14"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> (top) and 0.01 (bottom). Each dot corresponds to one pair and the diagonal line shows the line <inline-formula><mml:math id="inf15"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula>. Right panels: Cumulative distribution of the lengths of the recombined segments, as estimated by the pairwise analysis of the simulations with <inline-formula><mml:math id="inf16"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> (top) and 0.01 (bottom). The vertical dotted lines show the ground truth, that is all recombined segments were 12 kb long in the simulations.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig2-figsupp2-v2.tif"/></fig></fig-group><p>As the ratio of the recombination and mutation rate <inline-formula><mml:math id="inf17"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> is increased, progressively more of the clonal history is lost. <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref> shows, for different values of <inline-formula><mml:math id="inf18"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula>, the clonal tree with branches colored according to the fraction of positions in the genome that were clonally inherited (that is not overwritten by recombination) along the branch. At a very low rate of recombination of <inline-formula><mml:math id="inf19"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>, the large majority of all positions in each branch are clonally inherited. When the ratio <inline-formula><mml:math id="inf20"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> is raised to 0.01, evolution is still mostly clonal along most of the branches toward the leaves of the tree, but for the few long internal branches near the root that separate the major ’clades’, most positions have already been affected by recombination. Once the ratio <inline-formula><mml:math id="inf21"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> is further raised to 0.1, almost all branches are dominated by recombination except for a few branches near the leaves. For <inline-formula><mml:math id="inf22"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula> or larger, almost every position in every branch has been overwritten by recombination.</p></sec><sec id="s2-3"><title>Quantifying recombination through analysis of pairs of strains</title><p>As a first analysis of the impact of recombination, we follow an approach recently proposed by Dixit et al. based on the pairwise comparison of strains (<xref ref-type="bibr" rid="bib12">Dixit et al., 2015</xref>). The simplest measure of the distance between a pair of strains is their nucleotide divergence, that is the fraction of mismatching nucleotides between the two strains in the core genome alignment. For pairs of strains with very low divergence, for example D6 and F2 with divergence <inline-formula><mml:math id="inf23"><mml:mrow><mml:mn>4</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2A</xref>), the effects of recombination are almost directly visible in the pattern of SNP density along the genome. While the SNP density is very low along most of the genome, that is <inline-formula><mml:math id="inf24"><mml:mrow><mml:mn>0</mml:mn><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> SNPs per kilobase, there are a few segments, typically tens of kilobases long, where the SNP density is much higher and similar to the typical SNP density between random pairs of <italic>E. coli</italic> strains, that is <inline-formula><mml:math id="inf25"><mml:mrow><mml:mn>10</mml:mn><mml:mo>-</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math></inline-formula> SNPs per kilobase. These high SNP density regions almost certainly result from horizontal transfer events in which a segment of DNA from another <italic>E. coli</italic> strain, for example carried by a phage, made it into one of the ancestor cells of this pair, and was incorporated into the genome through homologous recombination. For pairs of increasing divergence, for example the pair C10-D7 with divergence 0.002 in <xref ref-type="fig" rid="fig2">Figure 2B</xref>, the frequency of these recombined regions increases, until eventually most of the genome is covered by such regions (pair D6-H10 in <xref ref-type="fig" rid="fig2">Figure 2C</xref>).</p><p>For close pairs, the histograms of SNP densities also clearly separate into two components: a majority of clonally inherited regions with up to at most 3 SNPs per kilobase, and a long tail of recombined regions with up to 50 or 60 SNPs per kilobase (<xref ref-type="fig" rid="fig2">Figure 2D–E</xref>). As explained in the methods, the distributions of SNP densities are well described by mixtures of a Poisson distribution for the clonally inherited regions plus a negative binomial for the recombined regions (solid line fits in <xref ref-type="fig" rid="fig2">Figure 2D–F</xref>). In this way we can estimate, for each pair of strains, the fraction <italic>f</italic><sub><italic>c</italic></sub> of the genome that was clonally inherited, and the fraction <italic>f</italic><sub><italic>r</italic></sub> of SNPs that fall in clonally inherited versus recombined regions. In addition, to estimate the lengths of the recombined fragments we focused on very close pairs for which recombination events are sparse enough so that overlapping events are very unlikely, and used a Hidden Markov model to estimate the distribution of lengths of recombined regions (see Materials and methods). We find that most recombined segments are in the range of <inline-formula><mml:math id="inf26"><mml:mrow><mml:mn>10</mml:mn><mml:mo>-</mml:mo><mml:mn>70</mml:mn></mml:mrow></mml:math></inline-formula> kilobases long with a mean of 31 kilobases (<xref ref-type="fig" rid="fig2">Figure 2</xref>, and see Appendix 2 for additional comments on the accuracy of this estimate).</p><p>From this analysis we see that, whenever the pairwise divergence is less than 0.001, the large majority of blocks is clonally inherited, which is indicated as the light-green segment in <xref ref-type="fig" rid="fig2">Figure 2G</xref>. However, over a narrow range of divergence between 0.001 and 0.01 the fraction of clonally inherited DNA drops dramatically (yellow segment in <xref ref-type="fig" rid="fig2">Figure 2G</xref>) and at a divergence of about 0.014 essentially the entire alignment has been overwritten by recombination and all clonally inherited DNA is lost (blue segment in <xref ref-type="fig" rid="fig2">Figure 2G</xref>). Notably, 80% of all strain pairs lie in this fully recombined regime (<xref ref-type="fig" rid="fig2">Figure 2I</xref>). Thus, for the large majority of pairs of strains, none of the DNA in their alignment derives from their clonal ancestor, making it impossible to estimate the distance to their clonal ancestor from comparing their sequences.</p><p>Moreover, as shown in <xref ref-type="fig" rid="fig2">Figure 2H</xref>, even for pairs that are so close that most of their genomes are clonally inherited, the large majority of the substitutions derives from the recombined regions. That is, for pairs of strains that are so close that the clonally inherited fraction is around <inline-formula><mml:math id="inf27"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:math></inline-formula>, the fraction of substitutions deriving from recombination is roughly <inline-formula><mml:math id="inf28"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:math></inline-formula> as well. We note that in previous studies the quantitative importance of recombination has often been summarized by a ratio <inline-formula><mml:math id="inf29"><mml:mrow><mml:mi>R</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> of the rates at which substitutions are introduced by recombination and mutation, for example (<xref ref-type="bibr" rid="bib47">Vos and Didelot, 2009</xref>). Note that, if we assume a fixed ratio of recombination-to-mutation <inline-formula><mml:math id="inf30"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula>, then <inline-formula><mml:math id="inf31"><mml:mrow><mml:mi>R</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> equals <inline-formula><mml:math id="inf32"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> times the average number of substitutions that are introduced per recombination event. In our pairwise analysis, the ratio <inline-formula><mml:math id="inf33"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> corresponds to the ratio of the number of substitutions deriving from recombination and mutation, so that one can obtain an estimate of <inline-formula><mml:math id="inf34"><mml:mrow><mml:mi>R</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> by calculating <inline-formula><mml:math id="inf35"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for very close pairs with <inline-formula><mml:math id="inf36"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, that is the dots at the right border in <xref ref-type="fig" rid="fig2">Figure 2H</xref>. However, we see that in this limit the fraction <italic>f</italic><sub><italic>r</italic></sub> of SNPs deriving from recombination becomes highly variable, giving a first indication that <inline-formula><mml:math id="inf37"><mml:mrow><mml:mi>R</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> may vary across different pairs of closely related strains. Indeed, we will see below that recombination rates vary over a wide range across different lineages, so that it is inherently misleading to quantify recombination by a <italic>single</italic> ratio <inline-formula><mml:math id="inf38"><mml:mrow><mml:mi>R</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula>.</p><p>To test the accuracy of the pair analysis, we applied the same pairwise analysis to alignments of the <inline-formula><mml:math id="inf39"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula> sample genomes from each of the simulations. <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref> shows the results, analogous to those of <xref ref-type="fig" rid="fig2">Figure 2G–I</xref>, for the data from simulations with recombination to mutation ratios of <inline-formula><mml:math id="inf40"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0.001</mml:mn><mml:mo>,</mml:mo><mml:mn>0.01</mml:mn><mml:mo>,</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, and 0.3. For the simulations without recombination, the pairwise analysis correctly infers that all of the genome is clonally inherited for all pairs. For the very low recombination rate <inline-formula><mml:math id="inf41"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>, the model also correctly infers that clonal evolution dominates, that is more than 50% of the genome is clonally inherited for all pairs, and more than 90% of the genome is clonally inherited for about 40% of all pairs. The pairwise analysis of the simulation data with recombination rate <inline-formula><mml:math id="inf42"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> are also consistent with the ground truth of <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3, i</xref> for half of the pairs there is a substantial fraction of clonally inherited genome, whereas for the other half of more distally related pairs recombination has already affected more than 90% of the genome. Similarly, for <inline-formula><mml:math id="inf43"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> the pairwise analysis correctly infers that pairs which are not yet fully recombined have become rare, and for <inline-formula><mml:math id="inf44"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula> essentially all pairs have become fully recombined. The pairwise analysis of the simulated data thus paints a correct picture of the ground truth shown in <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>.</p><p>To get a more quantitative assessment of the accuracy of the pairwise analysis, <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref> directly compares the true fraction of clonally inherited genome for each pair with the estimated fraction from the pairwise analysis for the simulations with <inline-formula><mml:math id="inf45"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf46"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula>. We see that for all pairs the estimated fraction of the genome that was clonally inherited is close to the true fraction. In fact, it appears that the estimation method tends to slightly overestimate the fraction of clonally inherited genome for almost all pairs. Finally, as for the real data, we also used close pairs from the simulations with <inline-formula><mml:math id="inf47"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf48"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> to estimate the sizes of the recombined segments. As shown in <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>, the sizes of the recombined regions estimated by the method are very close to the ground truth of 12 kb recombination segments.</p><p>In summary, application of the pairwise analysis to the simulation results strongly support that the pairwise analysis accurately quantifies the fraction of the genome that was affected by recombination for each pair, as well as estimate the lengths of the recombined segments.</p><p>For later comparison with the data on other species, we summarize our observations from the pairwise analysis by a few key statistics. First, half of the genome is recombined at a <italic>critical divergence</italic> of 0.0032. Second, at this critical divergence, the fraction of all SNPs that is in recombined regions is 0.95. Third, the fraction of mostly clonal pairs is 0.077, and finally, the fraction of fully recombined pairs is 0.78 (see Materials and methods). All these statistics suggest that pairwise divergences between strains are almost entirely driven by recombination and do not reflect distances to their clonal ancestors. To understand how a consistent phylogenetic structure can still emerge when the full core genomes of all strains are compared, we need to go beyond studying pairs.</p></sec><sec id="s2-4"><title>SNPs in the core genome alignment correspond to splits in the local phylogeny</title><p>Although there may not be a single phylogeny that captures the evolution of our genomes, each <italic>single position</italic> in the core genome alignment, that is each alignment column, will have evolved according to some phylogenetic tree. A key observation is that our set of strains is sufficiently closely related that there are almost no alignment columns for which more than one substitution occurred in its evolutionary history. In particular, of the almost 2.8 million columns in the core genome alignment, almost 90% show an identical nucleotide for all 92 strains, that is only 10.85% are polymorphic. Moreover, almost all of these SNP columns are bi-allelic, that is for 93.6% of the SNPs only two nucleotides appear, 6.3% have three nucleotides, and in 0.2% all four nucleotides occur. These statistics strongly suggest that most positions have not undergone any substitutions, and that columns with multiple substitutions are rare. Notably, these statistics are still inflated due to the occurrence of an outgroup of nine strains that is far removed from the other strains (the clade from B5 to B3 visible on the right in <xref ref-type="fig" rid="fig1">Figure 1</xref>). We observe that almost 36% of all SNPs correspond to SNPs in which all nine strains of this outgroup have one nucleotide, and all other 83 strains have another nucleotide. If we remove the outgroup from our alignment, the fraction of SNPs in the alignment drops from 10.85% to 6.7%, and the fraction of SNPs that are bi-allelic increases to 95.5%.</p><p>Whenever a bi-allelic SNP corresponds to a single substitution in the evolutionary history of the position, the SNP pattern provides an important piece of information about the phylogeny at that position in the alignment: whatever this phylogeny is, it must contain a split, that is a branch bi-partitioning the set of strains, such that all strains with one letter occur on one side of the split, and all strains with the other letter on the other side (<xref ref-type="fig" rid="fig3">Figure 3</xref>).</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Bi-allelic SNPs correspond to phylogeny splits.</title><p>A segment of a multiple alignment of 6 strains containing three bi-allelic SNPs, <italic>X</italic>, <italic>Y</italic>, and <italic>Z</italic>. Assuming that each SNP corresponds to a single substitution in the evolutionary history of the position, each SNP constrains the local phylogeny to contain a particular split, that is bi-partition of the strains, as illustrated by the three diagrams immediately below each SNP. In this example, the neighboring pairs of SNPs <inline-formula><mml:math id="inf49"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf50"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are both consistent with a common phylogeny and can be used to further resolve the phylogeny in the local segment of the alignment as shown in the second row with two diagrams. However, SNPs <italic>X</italic> and <italic>Z</italic> are mutually inconsistent with a common phylogeny (red cross at the bottom) indicating that somewhere between <italic>X</italic> and <italic>Z</italic> at least one recombination event must have occurred.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Comparison of the observed frequencies of columns with different numbers of nucleotides with predictions from a simple substitution model.</title><p>Comparison of the observed frequencies of columns with 1, 2, 3, and 4 different nucleotides under the simple model described in the methods. Different colored dots correspond to different subsets of columns, as indicated in the legend. For each color, four dots are shown corresponding to the observed frequencies of columns with 1, 2, 3, and 4 nucleotides (horizontal axis) and the predicted frequencies according to the simple model (vertical axis). The dashed line shows the identity <inline-formula><mml:math id="inf51"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula>. Both axes are shown on logarithmic scales.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig3-figsupp1-v2.tif"/></fig></fig-group><p>As illustrated in <xref ref-type="fig" rid="fig3">Figure 3</xref>, pairs of SNPs can either be consistent with a common phylogeny, that is columns <italic>X</italic> and <italic>Y</italic> or columns <italic>Y</italic> and <italic>Z</italic>, or they can be inconsistent with a common phylogeny, that is columns <italic>X</italic> and <italic>Z</italic>. The pairwise comparison of SNP columns for consistency with a common phylogeny is known as the four-gamete test and is very commonly used in the literature on sexual species, for example to give a lower bound on the number of recombination events in an alignment (<xref ref-type="bibr" rid="bib22">Hudson and Kaplan, 1985</xref>). However, so far it has rarely been used for quantifying recombination in bacteria (<xref ref-type="bibr" rid="bib25">Lai and Ioerger, 2018</xref> and (<xref ref-type="bibr" rid="bib2">Arnold et al., 2018</xref>) being the only exceptions we are aware of). In the rest of this paper, we show how analysis of bi-allelic SNPs (which from now on we will just call SNPs) can be systematically used to quantify not only the overall amount of recombination in alignments, but also the relative rates with which different lineages have recombined.</p><p>Since all these analyses assume that bi-allelic SNPs correspond to single substitutions, it is important to quantify how accurate this assumption is. In particular, some apparent SNPs might correspond to sequencing errors rather than true substitutions and, more importantly, some bi-allelic SNPs may correspond to multiple substitution events (often called homoplasies). In the Materials and methods, we show that sequencing errors must be so rare that they can be safely neglected. In addition, to estimate the fraction of bi-allelic SNPs that correspond to homoplasies we analyzed the frequencies of columns with 1, 2, 3, and 4 different nucleotides using a simple substitution model, separately analyzing positions that are under least selection (third positions of fourfold degenerate codons) and positions under most selection (second positions in codons), and either including or excluding the outgroup (see Materials and methods, and <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). These analyses indicate that only 2–6% of bi-allelic SNPs correspond to homoplasies. We confirmed the accuracy of this estimation procedure using our simulation data, for which the true fraction of homoplasies is 2.56% and our simple method estimates 2.43%.</p><p>In addition, to put an upper bound on how much our results could be affected by a small fraction of homoplasies, we developed a method that removes, from the core genome alignment, a given fraction of alignment columns that exhibit most inconsistencies with alignment columns in their neighborhood (see Materials and methods), and checked how much the various statistics that we calculate are altered when we remove either 5% or 10% of such potentially homoplasic positions. Finally, we also apply each of our analyses to the data from the simulations with known ground truth, to further validate the accuracy of our methods.</p></sec><sec id="s2-5"><title>SNP statistics are inconsistent with a single phylogeny</title><p>One of the key uses of a phylogeny is in describing the differences between the strains by an evolutionary dynamics that takes place along the branches of the phylogeny. However, for such an approach to apply, it is important that the large majority of evolutionary changes were indeed introduced along the branches of the phylogeny.</p><p>That there are significant differences between the SNP statistics as predicted by the core tree, and the actual SNP statistics observed in the data is already evident from the fact that the observed pairwise divergences between strains are systematically less than their divergences along the branches of the core phylogeny ( <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>, left panel). In addition, for many branches of the core tree, the observed number of SNPs corresponding to that branch is up to 100-fold lower than number of SNPs that are predicted to occur on that branch (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>, right panel).</p><p>To test to what extent the observed evolutionary changes occurred along the branches of the core tree, we calculated the fraction of observed SNP splits that fall on the branches of the core phylogeny. Overall, 58% of the SNPs that are shared by at least two strains correspond to a branch of the core tree, whereas 42% clash with it (SNPs that occur in only a single strain are consistent with any phylogeny). However, this relatively high fraction results almost entirely from SNPs on the single branch connecting the outgroup to the other strains, which is responsible for almost 36% of all SNPs. When the outgroup is removed, only 27.4% of all SNPs are consistent with the core tree. Since the core tree was constructed using a maximum likelihood approach that assumes the entire alignment follows one common tree, we investigated to what extent the number of tree supporting SNPs can be improved by specifically constructing a tree to maximize the number of supporting SNPs (see Materials and methods). However, this only marginally improves the number of supporting SNPs by 0.1%.</p><p>Since the overall fraction of SNPs that correspond to branches of the core phylogeny is dominated by a few very common SNP patterns, it is more informative to assess to what extent each individual branch of the core tree is consistent with the observed SNPs. We thus calculated, for each branch in the core tree, the number of supporting SNPs <italic>S</italic> that match the split, and the number of clashing SNPs <italic>C</italic> that are inconsistent with the split, to calculate the fraction <inline-formula><mml:math id="inf52"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>+</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> of SNPs supporting the branch. <xref ref-type="fig" rid="fig4">Figure 4</xref> shows that, for two-thirds of the branches, there are more clashing than supporting SNPs. Moreover, for half of the branches in the core tree, the fraction of supporting SNPs is less than 5%, that is there are at least 20-fold more clashing than supporting SNP columns. To check to what extent homoplasies may affect these statistics, we calculated the same statistics on core genome alignments from which either 5% or 10% of potentially homoplasic sites were removed, and observed that the distribution of SNP support is almost unchanged (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>).</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Most branches of the core genome tree are rejected by the statistics of individual SNPs.</title><p>Left panel: Fraction of supporting versus clashing SNPs for each branch of the core tree. Right panel: Cumulative distribution of the fraction of supporting SNPs across all branches. The purple and orange dotted lines show the median and the frequency of branches with 50% or less support, respectively.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>The pairwise distances and number of SNPs on each branch as predicted by the core tree do not match the pairwise distances and SNP numbers observed in the data.</title><p>Comparison of pairwise distances and number of SNPs on each branch as predicted by the core tree, with pairwise distances and SNP numbers observed in the data. Left panel: Scatter plot of the pairwise divergences along the core tree (horizontal axis) versus the observed pairwise divergences (vertical axis). Right panel: For each branch of the tree, the total number of SNPs predicted to fall on the branch, that is the probability of a substitution to occur along the branch times the number of columns in the alignment, is shown (horizontal axis) against the actual number of SNPs in the data that fall on the branch. All axes are shown on logarithmic scales.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig4-figsupp1-v2.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 2.</label><caption><title>Homoplasies do not significantly effect the fractions of supporting SNPs for <italic>E.coli</italic>.</title><p>Cumulative distribution of the fraction of supporting SNPs across all branches of the core tree for the original alignment of <italic>E. coli</italic> strains (blue) as well as for alignments from which 5% (orange) and 10% of potentially homoplasic columns were removed. The fact that the curves are almost identical shows that the distribution of SNP support is highly insensitive to a small fraction of homoplasies among the SNPs.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig4-figsupp2-v2.tif"/></fig><fig id="fig4s3" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 3.</label><caption><title>Distributions of SNP support for the data from the simulations.</title><p>Cumulative distributions of the fraction of supporting SNPs across all branches of the core tree for the alignments resulting from the simulations with <inline-formula><mml:math id="inf53"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (dark blue), <inline-formula><mml:math id="inf54"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula> (light blue), <inline-formula><mml:math id="inf55"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> (light green), <inline-formula><mml:math id="inf56"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> (dark green), <inline-formula><mml:math id="inf57"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula> (orange), <inline-formula><mml:math id="inf58"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> (red), and <inline-formula><mml:math id="inf59"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula> (dark red). The panels corresponds to the distribution for the original alignment (left), and alignments from which 5% (middle) and 10% of potentially homoplasic columns were removed. For reference, the distribution of support for the <italic>E. coli</italic> data is shown in black. Note that except for the simulations without any recombination where all inconsistencies are caused by homoplasies, the distributions are generally insensitive to the removal of homoplasic positions.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig4-figsupp3-v2.tif"/></fig><fig id="fig4s4" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 4.</label><caption><title>Supporting versus clashing SNPs for trees that were built bottom-up, while minimizing SNP clashes.</title><p>Supporting versus clashing SNPs for trees that were built bottom-up, while minimizing SNP clashes. Left panel: Illustration of the iterative bottom-up tree reconstruction. At each step, the pair of clades is fused that minimizes the number of SNPs that clash with the fusion (red arrows). In case of multiple pairs that have the same number of clashing SNPs, the pair with the largest number of supporting SNPs (green arrows) is chosen. Right panel: Fraction of SNPs that support vs. clash with the partially reconstructed tree as a function of the average pairwise divergence of strains that occur within the clades of the partially reconstructed tree. The blue curve corresponds to the full set of strains and the red curve to all strains except for the outgroup. The horizontal axis is shown on a logarithmic scale.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig4-figsupp4-v2.tif"/></fig><fig id="fig4s5" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 5.</label><caption><title>Quartets of roughly equidistant strains have no consensus phylogeny.</title><p>Quartets of roughly equidistant strains have no consensus phylogeny. Left: Using the distribution of pairwise distances (top panel) we select, for each pairwise distance <italic>D</italic>, quartets of strains whose pairwise distances are all within a factor 1.25 of <italic>D</italic>. SNPs for which two strains have one letter and two strains another are informative for the topology and each support one of the three possible topologies. Right: For each quartet, we determined the topology that is supported by most SNPs and then calculated the fraction of topology-informative SNPs that supported the most common topology. The plot shows the fraction of SNPs supporting the most common topology (vertical axis) as a function of the total number of informative SNPs (horizontal axis). The horizontal line marks the minimal possible fraction, which is attained when all three topologies are supported by 1/3 of the SNPs. Note that, for the majority of quartets, the most common topology is supported by less than half of the informative SNPs.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig4-figsupp5-v2.tif"/></fig></fig-group><p>To further elucidate the meaning of these SNP support distributions, we calculated the same statistics for the simulations with different recombination rates, including on alignments where 5% or 10% of potentially homoplasic columns were removed (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>). In general the removal of 5% or even 10% of potentially homoplasic sites has only a minor effect on the distribution of SNP support except for the simulations without recombination. When there is no recombination all inconsistencies are due to homoplasies, and we indeed see that all branches are fully supported after 5% of potential homoplasic sites have been removed. For a very small recombination rate of <inline-formula><mml:math id="inf60"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>, most branches in the core tree still have strong SNP support but already at a recombination rate of <inline-formula><mml:math id="inf61"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> more than 80% of the branches are supported by less than half of the informative SNPs, and half of the branches have less than 20% support. It is instructive to compare this result with the fractions of the genome that are clonally inherited along each branch, that is the bottom left panel in <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>, and the pair statistics (middle row of <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>) for this simulation. We see that, although there is some recombination in most branches, most of the genome is clonally inherited for all but the long inner branches. However, even though most of the genome is clonally inherited along most branches, for most pairs the large majority of the SNPs derive from recombination (middle panel in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). This means that, at <inline-formula><mml:math id="inf62"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>, we are in a parameter regime where most of the genome is still clonally inherited, and the clonal tree can thus also be reconstructed from the data, but the large majority of the differences between strains already derive from recombination events. This shows that, even if recombination is rare enough that the clonal tree can be successfully reconstructed from the genome sequences, it might already be incorrect to assume most genomic changes were introduced along the branches of this clonal phylogeny.</p><p>For recombination rates of <inline-formula><mml:math id="inf63"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> or larger, recombination dominates completely in that there are essentially no branches with significant SNP support. The distribution of support for <italic>E. coli</italic> does not look like any of the distributions from the simulations, but could be described as a hybrid of one third of branches with strong clonal support and two thirds of branches dominated by recombination. Besides the branch to the outgroup, all supported branches lead to groups of highly similar strains near the bottom of the tree. We thus wondered if it would be possible to construct well supported subtrees for clades of closely related strains near the bottom of the tree. We devised a method that builds subtrees bottom-up by iteratively fusing clades so as to minimize the number of clashing SNPs at each step (see Materials and methods and <xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4</xref>, left panel). As shown in <xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4</xref>, while the fraction of clashing SNPs is initially low, it rises quickly as soon as the average divergence within the reconstructed subtrees exceeds <inline-formula><mml:math id="inf64"><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, which is more than 100-fold below the typical pairwise distance between <italic>E. coli</italic> strains. Thus, while some groups of very closely related strains that have a recent common ancestor can be unambiguously identified, only a minute fraction of the overall sequence divergence falls within these groups, and the bulk of the sequence variation between the strains is not consistent with a single phylogeny.</p><p>To assess whether any of these statistics could be skewed due to a few strains with aberrant behavior, we also investigated whether SNPs are more consistent with a dominant phylogeny when we do not consider all strains, but only subsets of the strains. We focused on the smallest subsets of strains that have meaningfully different phylogenetic tree topologies. For a quartet of strains <inline-formula><mml:math id="inf65"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>J</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, there are three possibly binary trees, that is with <inline-formula><mml:math id="inf66"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>J</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf67"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> nearest neighbors, with <inline-formula><mml:math id="inf68"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf69"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>J</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, or with <inline-formula><mml:math id="inf70"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf71"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>J</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> (see <xref ref-type="fig" rid="fig4s5">Figure 4—figure supplement 5</xref>). We selected quartets of roughly equidistant strains and checked, for each quartet, whether the SNPs clearly supported one of the tree possible topologies. However, we find that alternative topologies are always supported by a substantial fraction of the SNPs, and that for most quartets the most supported topology is supported by less than half of the SNPs (<xref ref-type="fig" rid="fig4s5">Figure 4—figure supplement 5</xref>).</p><p>In summary, consistent with the picture that emerged from our analysis of pairs of strains, most of the differences between the <italic>E. coli</italic> strains did not occur along the branches of a single phylogeny. This suggests that, rather than describing the relationships between the strains by a single phylogeny, we should think of multiple different phylogenies occurring along the genome alignment.</p></sec><sec id="s2-6"><title>The phylogeny changes every few SNPs along the core alignment</title><p>So far, we have analyzed SNP consistency without regard to their relative positions in the alignment. We now analyze to what extent mutually consistent SNPs are clustered along the alignment. In particular, we calculate the lengths of segments along the alignment that are consistent with a single phylogeny.</p><p>We first assessed the length-scale over which phylogenies are correlated by calculating a standard linkage disequilibrium (LD) measure as a function of distance along the alignment (<xref ref-type="fig" rid="fig5">Figure 5A</xref> and Materials and methods). LD drops quickly over the first 100 base pairs and becomes approximately constant at distances beyond <inline-formula><mml:math id="inf72"><mml:mrow><mml:mn>200</mml:mn><mml:mo>-</mml:mo><mml:mn>300</mml:mn></mml:mrow></mml:math></inline-formula> base pairs, indicating that segments of correlated phylogenies are much shorter than the typical length of a gene. Very short linkage profiles were recently also observed in thermophilic <italic>Cyanobacteria</italic> isolated in Yellowstone National Park (<xref ref-type="bibr" rid="bib41">Rosen et al., 2015</xref>). Instead of using correlation between SNPs at different distances, one can also calculate the probability for a pair of SNPs to be consistent with a common phylogeny, as a function of their genome distance (<xref ref-type="bibr" rid="bib2">Arnold et al., 2018</xref>). As shown in in <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>, like LD, pairwise compatibility of SNPs also drops quickly over the first 100 base pairs. Note, however, that even at large distances the pairwise compatibility of SNPs is close to 90%. The reason for this is that most SNPs are shared by only a small subset of strains, and as long as two SNPs are shared by non-overlapping subsets of strains, they will be compatible with a tree. In order to more efficiently detect recombination using SNP compatibility, we need to check for the mutual consistency of <italic>all</italic> SNPs within a given segment of the alignment.</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>SNP compatibility along the core genome alignment shows tree-compatible segments are short.</title><p>(<bold>A</bold>) Linkage disequilibrium (squared correlation, see Materials and methods) as a function of the separation of a pair of columns in the core genome alignment. (<bold>B</bold>) Probability distribution of the number of consecutive SNP columns that are consistent with a common phylogeny for the core genome alignment (orange) and for an alignment in which the positions of all columns have been randomized (blue). (<bold>C</bold>) Probability distribution of the number of consecutive alignment columns consistent with a common phylogeny for both the real (orange) and randomized alignment (blue).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Pairwise SNP compatibility as a function of genomic distance.</title><p>Pairwise SNP compatibility as a function of genomic distance. The plot show the fraction of SNP pairs that are compatible with a common phylogeny as a function of the genomic distance between the pair (in nucleotides).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig5-figsupp1-v2.tif"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 2.</label><caption><title>Lengths of tree-compatible segments for the data from the simulations.</title><p>Probability distributions of the length of tree-compatible segments along the alignments of the <italic>E. coli</italic> genomes (black line) and the alignments of the sequences from the simulations with <inline-formula><mml:math id="inf73"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (dark blue), <inline-formula><mml:math id="inf74"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula> (light blue), <inline-formula><mml:math id="inf75"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> (light green), <inline-formula><mml:math id="inf76"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> (dark green), <inline-formula><mml:math id="inf77"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula> (orange), <inline-formula><mml:math id="inf78"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> (red), and <inline-formula><mml:math id="inf79"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula> (dark red). The left panels show the distributions of the number of consecutive SNP columns and the right panels the distributions of the number of consecutive nucleotides. The top row corresponds to the full alignments, and the middle and bottoms row to the alignments from which 5% and 10% of potentially homoplasic positions have been removed, respectively. All axes are shown on logarithmic scales.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig5-figsupp2-v2.tif"/></fig></fig-group><p>Starting from each SNP <italic>s</italic>, we determined the number of consecutive SNPs <italic>n</italic> that are all mutually consistent with a common phylogeny. As shown in <xref ref-type="fig" rid="fig5">Figure 5B</xref>, the distribution of the lengths of tree-compatible stretches has a mode at <inline-formula><mml:math id="inf80"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>, and stretches are very rarely longer than <inline-formula><mml:math id="inf81"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula> consecutive SNPs. In terms of number of base pairs along the genome, tree-compatible segments are typically just a few tens of base pairs long, and very rarely more than 300 base pairs (<xref ref-type="fig" rid="fig5">Figure 5C</xref>). Thus, stretches of tree-compatible segments are very short. For comparison, we also calculated the distribution of tree-compatible segment lengths in an alignment where the positions of all columns have been completely randomized and observe that these are still a bit shorter (blue distributions in <xref ref-type="fig" rid="fig5">Figure 5B and C</xref>). Thus, while there is some evidence that neighboring SNPs are more likely to be compatible than random pairs of SNPs, this compatibility is lost very quickly, typically within a handful of SNPs.</p><p>To elucidate how the recombination-to-mutation ratio determines the lengths of tree-compatible stretches for the simulations, we calculated the same distribution for the data from the simulations with different recombination rates. In addition, to assess the affect of homoplasies on the distribution of the lengths of tree-compatible stretches, we also calculated these distributions for alignments from which 5% or 10% of potentially homoplasic sites were removed (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>). In addition, <xref ref-type="table" rid="app1table1">Appendix 1—table 1</xref> shows the average length of tree-compatible segments for each of these datasets. We see that removal of homoplasies only has a significant effect on the distribution of tree-compatible stretches for <inline-formula><mml:math id="inf82"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>≤</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>. That is, homoplasies only significantly affect the distribution of tree-compatible stretches when <inline-formula><mml:math id="inf83"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> is less than the rate of homoplasies (which is 2.5%). For the <italic>E. coli</italic> data, removal of homoplasies has only a minor effect, that is the average number of consecutive tree-compatible SNPs increases from 7.6 to 8.8 when 5% potentially homoplasic sites are removed. Although there is of course no reason to assume that the simple evolutionary dynamics of any of our simulations realistically describes the genome evolution of the <italic>E. coli</italic> strains, we note that the distribution of tree-compatible stretches for <italic>E. coli</italic> is between what is observed for simulations with <inline-formula><mml:math id="inf84"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf85"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Notably, as is clear from <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>, <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>, and <xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>, when <inline-formula><mml:math id="inf86"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>≥</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula> the evolution along every branch of the phylogeny is almost completely dominated by recombination.</p><p>In summary, our analysis shows that, as one moves along the core genome alignment, the phylogeny changes typically every 5–10 SNP columns, that is every 50–100 nucleotides. We next use this to put a lower bound on the ratio of the number of phylogeny changes to mutations in the alignment.</p></sec><sec id="s2-7"><title>A lower bound on the ratio of phylogeny changes to substitution events</title><p>Every time inconsistent SNP columns are encountered as one moves along the core genome alignment, the local phylogeny must change. For example, somewhere between columns <italic>X</italic> and <italic>Z</italic> in <xref ref-type="fig" rid="fig3">Figure 3</xref> the phylogeny must change. This in turn implies that the start (or end) of at least one recombination event must occur between columns <italic>X</italic> and <italic>Z</italic>. By going along the core genome, and determining the minimum number of times the phylogeny must change, one can thus derive a lower bound on the total number of recombination events and, in the study of sexually reproducing species, this has been a standard method to put a lower bound on the number of recombination events within a genome alignment (<xref ref-type="bibr" rid="bib22">Hudson and Kaplan, 1985</xref>) (see Materials and methods). Using this we find that the phylogeny must change at least <inline-formula><mml:math id="inf87"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mn>43</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mn>575</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> times along the core phylogeny. However, this neglects that some of the inconsistencies may result from homoplasies. To correct for this, we remove 5% of potential homoplasic positions by removing 5% of the SNP columns that are most inconsistent with neighboring columns (Materials and methods) and find that the phylogeny must still change <inline-formula><mml:math id="inf88"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mn>34</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mn>030</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> times along this 5% homoplasy-corrected alignment. Because homoplasies are relatively rare, the number of bi-allelic SNPs in the alignment is a good estimate for the total number of mutations in the alignment and the ratio <inline-formula><mml:math id="inf89"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> thus provides a lower bound for the ratio between the total number of phylogeny changes and substitutions that occur along genome alignment. For the 5% homoplasy-corrected alignment we obtain a ratio <inline-formula><mml:math id="inf90"><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.129</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>Apart from the full alignment, we can calculate the lower bound on the ratio of phylogeny changes to substitution events <inline-formula><mml:math id="inf91"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> for any subset of strains. <xref ref-type="fig" rid="fig6">Figure 6</xref> shows the ratio <inline-formula><mml:math id="inf92"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> for random subsets of our 92 strains as a function of the number of strains in the subset, using again the 5% homoplasy-corrected alignment. For comparison, <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref> also shows the same results for the full alignment, which shows ratios <inline-formula><mml:math id="inf93"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> that are about 20% higher.</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Ratio <inline-formula><mml:math id="inf94"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> of the minimal number of phylogeny changes <italic>C</italic> to substitutions <italic>M</italic> for random subsets of strains using the alignment from which 5% of potentially homoplasic positions have been removed.</title><p>For strain numbers ranging from <inline-formula><mml:math id="inf95"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf96"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>92</mml:mn></mml:mrow></mml:math></inline-formula>, we collected random subsets of <italic>n</italic> strains and calculated the ratios <inline-formula><mml:math id="inf97"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> of phylogeny changes to SNPs in the alignment. The figure shows box-whisker plots that indicate, for each strain number <italic>n</italic>, the 5th percentile, first quartile, median, third quartile, and 95th percentile of the distribution of <inline-formula><mml:math id="inf98"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> across subsets. The blue line shows <inline-formula><mml:math id="inf99"><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.129</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig6-v2.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Ratios <inline-formula><mml:math id="inf100"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> for homoplasy-corrected and full alignments of random subsets of strains.</title><p>Ratio <inline-formula><mml:math id="inf101"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> of the minimal number of phylogeny changes <italic>C</italic> to substitutions <italic>M</italic> for random subsets of strains using the alignment for which 5% of potentially homoplasic positions have been removed (orange) as well as for the full alignment (gray). For strain numbers ranging from <inline-formula><mml:math id="inf102"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf103"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>92</mml:mn></mml:mrow></mml:math></inline-formula>, we collected random subsets of <italic>n</italic> strains and calculated the ratios <inline-formula><mml:math id="inf104"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> of phylogeny changes to SNPs in the alignment. The figure shows box-whisker plots that indicate, for each strain number <italic>n</italic>, the 5th percentile, first quartile, median, third quartile, and 95th percentile of the distribution of <inline-formula><mml:math id="inf105"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> across subsets. The blue line shows <inline-formula><mml:math id="inf106"><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.129</mml:mn></mml:mrow></mml:math></inline-formula> and the gray line <inline-formula><mml:math id="inf107"><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.155</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig6-figsupp1-v2.tif"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 2.</label><caption><title>Lower bound <inline-formula><mml:math id="inf108"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> on the ratio of phylogeny changes to mutations, versus the ratio <inline-formula><mml:math id="inf109"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> of recombination to mutation rate, for the data of the simulations.</title><p>Observed ratio <inline-formula><mml:math id="inf110"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> of the minimal number of phylogeny changes <italic>C</italic> and SNPs <italic>M</italic> in the alignment (vertical axis) as a function of the ratio of recombination and mutation rate <inline-formula><mml:math id="inf111"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> used in the simulation (horizontal axis), as calculated on the simulation data using the alignments from which 5% of potentially homoplasic sites have been removed. Each blue dot corresponds to a simulation with a given value of <inline-formula><mml:math id="inf112"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula>. Both axes are shown on logarithmic scales. For guidance, the lines <inline-formula><mml:math id="inf113"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula> (blue) and <inline-formula><mml:math id="inf114"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> (green) are shown. The horizontal dashed line shows the ratio <inline-formula><mml:math id="inf115"><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.13</mml:mn></mml:mrow></mml:math></inline-formula> that is observed for the 5% homoplasy corrected alignment of the <italic>E. coli</italic> strains.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig6-figsupp2-v2.tif"/></fig><fig id="fig6s3" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 3.</label><caption><title>Distributions of the number of times each position in the alignment has been overwritten by recombination for the data of the simulations.</title><p>Histograms of the number of times each position in the genome was overwritten by recombination along the branches of the clonal phylogeny, for the simulations with recombination-to-mutation ratios ranging from <inline-formula><mml:math id="inf116"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula> (top left), to <inline-formula><mml:math id="inf117"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula> (bottom right).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig6-figsupp3-v2.tif"/></fig><fig id="fig6s4" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 4.</label><caption><title>Comparison of the estimated and true average number of times each position in the alignment has been overwritten by recombination for the data of the simulations.</title><p>Comparison of the true average number of times <inline-formula><mml:math id="inf118"><mml:msub><mml:mi>T</mml:mi><mml:mi>true</mml:mi></mml:msub></mml:math></inline-formula> that positions were overwritten by recombination along the branches of the clonal phylogeny (horizontal axis) versus the estimated number of times <inline-formula><mml:math id="inf119"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>est</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, as estimated from the lower bound on the number of phylogeny changes (with <italic>L</italic> the length of the alignment and <inline-formula><mml:math id="inf120"><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula> the average length of the recombination segments), for the simulation data. Each dot corresponds to a simulation dataset with a different recombination to mutation rate <inline-formula><mml:math id="inf121"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> (see legend). The diagonal line shows the line <inline-formula><mml:math id="inf122"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig6-figsupp4-v2.tif"/></fig></fig-group><p>We see that, for small subsets of strains, the ratio <inline-formula><mml:math id="inf123"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> shows substantial fluctuations. For example, for subsets of <inline-formula><mml:math id="inf124"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula> strains, the ratio <inline-formula><mml:math id="inf125"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> ranges from 0.026 to 0.112, with a median of 0.075. However, as the number of strains in the subset increases, the ratio converges to the value <inline-formula><mml:math id="inf126"><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.129</mml:mn></mml:mrow></mml:math></inline-formula> and for large subsets of strains there is little variation in the ratio <inline-formula><mml:math id="inf127"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula>. Thus, for alignments of large sets of strains, the phylogeny must change at least every <inline-formula><mml:math id="inf128"><mml:mrow><mml:mn>7</mml:mn><mml:mo>-</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math></inline-formula> SNPs.</p><sec id="s2-7-1"><title><inline-formula><mml:math id="inf129"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> within phylogroups</title><p>Apart from random subsets of strains, we also calculated <italic>C</italic>, <italic>M</italic> and <inline-formula><mml:math id="inf130"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> for subsets of strains from the same phylogroup (<xref ref-type="table" rid="app1table2">Appendix 1—table 2</xref>, and see <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> for the phylogroup annotation). The ratios <inline-formula><mml:math id="inf131"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> that are observed for the phylogroups increase with the overall divergence within the phylogroup. For phylogroups that are more than 1% diverged (B1, B2, and D), the ratio <inline-formula><mml:math id="inf132"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> is close to that of the full alignment, and there are at least thousands of phylogeny changes along their sub-alignments. The two phylogroups with lower divergence, that is A with divergence 0.0024 and the outgroup with divergence 0.003 have lower ratios <inline-formula><mml:math id="inf133"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula>. The ratio is particularly low for the outgroup O for which only two phylogeny changes are detected. While this may suggest that recombination rates are particularly low within lineages of the outgroup, it should be noted that such low values of <inline-formula><mml:math id="inf134"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula>, while rare, were also observed for some random subsets of strains of the same size (<xref ref-type="fig" rid="fig6">Figure 6</xref>).</p></sec><sec id="s2-7-2"><title><inline-formula><mml:math id="inf135"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> for the simulation data</title><p>Note that, because each recombination event introduces at most two phylogeny changes (one at the start of the recombined segment and one at its end), <inline-formula><mml:math id="inf136"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> is a lower bound on the number of recombination events that occurred in the evolutionary history of an alignment. However, this lower bound may significantly underestimate the true number of recombination events. To obtain more insight into the relationship between this lower bound and recombination rates, we compared the ratios <inline-formula><mml:math id="inf137"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> of each simulated dataset (using the 5% homoplasy-corrected alignment) with the ratio <inline-formula><mml:math id="inf138"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> of recombination and mutation rate used in the simulation (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>). The results show that when recombination rates are very low, that is <inline-formula><mml:math id="inf139"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>≤</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>, the ratio <inline-formula><mml:math id="inf140"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is almost exactly equal to <inline-formula><mml:math id="inf141"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula>. In this regime recombination events are so sparse on the alignment that many SNP columns occur between every two consecutive phylogeny changes, and this causes almost every phylogeny change to introduce an inconsistency. Since each recombination event introduces two breaks, <inline-formula><mml:math id="inf142"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> equals twice the number of recombinations per mutation <inline-formula><mml:math id="inf143"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula>. However, as <inline-formula><mml:math id="inf144"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> increases, fewer SNP columns occur between consecutive phylogeny changes, and more and more of the phylogeny changes go undetected because they do not introduce inconsistencies between the SNPs. Consequently, the ratio <inline-formula><mml:math id="inf145"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> becomes systematically lower than <inline-formula><mml:math id="inf146"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> and the difference can become very large. For example, at <inline-formula><mml:math id="inf147"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, the observed ratio <inline-formula><mml:math id="inf148"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> is almost tenfold lower than <inline-formula><mml:math id="inf149"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula>. Note also that since the lower bound <inline-formula><mml:math id="inf150"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> cannot exceed 1 (i.e. a phylogeny change at every SNP), the ratio <inline-formula><mml:math id="inf151"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> can exceed <inline-formula><mml:math id="inf152"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> by arbitrarily large factors at high <inline-formula><mml:math id="inf153"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s2-7-3"><title>Each genomic position has likely been overwritten hundreds of times by recombination</title><p>We can also provide a rough estimate for the average number of times <italic>T</italic> that a randomly chosen position in the core genome alignment has been overwritten by recombination in its history, that is since the genetic ancestors of the position in the alignment diverged from a common ancestor.</p><p>If <italic>L</italic> is the total genome length, <inline-formula><mml:math id="inf154"><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula> the average length of recombination segments, and <inline-formula><mml:math id="inf155"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> the lower bound on the number of recombination events in the alignment, then a lower bound on the average number of times positions in the genome have been overwritten by recombination is <inline-formula><mml:math id="inf156"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. For the <italic>E. coli</italic> data with <inline-formula><mml:math id="inf157"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mn>34</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mn>030</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> phylogeny changes for the 5% homoplasy-corrected alignment of length <inline-formula><mml:math id="inf158"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mn>756</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mn>541</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, and the value of <inline-formula><mml:math id="inf159"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:msup><mml:mn>31</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> base pairs that we estimated previously (<xref ref-type="fig" rid="fig2">Figure 2J</xref>), we obtain <inline-formula><mml:math id="inf160"><mml:mrow><mml:mi>T</mml:mi><mml:mo>≈</mml:mo><mml:mn>190</mml:mn></mml:mrow></mml:math></inline-formula>. That is, on average each position in the genome has been overwritten at least 190 times by recombination. We note that, since this lower bound for <italic>T</italic> is proportional to the estimated average length of recombination segments <inline-formula><mml:math id="inf161"><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula>, it of course depends on this estimate as discussed in Appendix 2.</p><p>In the simulations, we specifically tracked the number of times each position in the alignment was overwritten by recombination along each branch of the clonal phylogeny, and we thus know precisely how many times each position of the alignment was overwritten by recombination in its evolutionary history. <xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3</xref> shows the distribution of the number of times each position in the alignment was overwritten for the simulations with <inline-formula><mml:math id="inf162"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> ranging from 0.001 to 10. We see that, in line with all previous analyses, positions that are clonally inherited along the whole tree only occur for the lowest recombination rate of <inline-formula><mml:math id="inf163"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>, at <inline-formula><mml:math id="inf164"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> each position has been overwritten <inline-formula><mml:math id="inf165"><mml:mrow><mml:mn>5</mml:mn><mml:mo>-</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:math></inline-formula> times, and at <inline-formula><mml:math id="inf166"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> each position has already been overwritten <inline-formula><mml:math id="inf167"><mml:mrow><mml:mn>120</mml:mn><mml:mo>-</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math></inline-formula> times. For each <inline-formula><mml:math id="inf168"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> we calculated the average number of times <inline-formula><mml:math id="inf169"><mml:msub><mml:mi>T</mml:mi><mml:mi>true</mml:mi></mml:msub></mml:math></inline-formula> that positions were overwritten by recombination and compared this with the estimated number of times using the simple estimate <inline-formula><mml:math id="inf170"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>est</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. <xref ref-type="fig" rid="fig6s4">Figure 6—figure supplement 4</xref> shows that, while the estimate is in fact quite accurate at very low mutation rate <inline-formula><mml:math id="inf171"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>, as the recombination rate increases the estimate severely underestimates the true number of times positions in the alignment were overwritten by recombination, for example at <inline-formula><mml:math id="inf172"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> the true number <inline-formula><mml:math id="inf173"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>true</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1561</mml:mn></mml:mrow></mml:math></inline-formula> is more than twenty times as large as the estimated number <inline-formula><mml:math id="inf174"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>est</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>67</mml:mn></mml:mrow></mml:math></inline-formula>. Thus, for the <italic>E. coli</italic> data it is certainly not implausible that each position in the alignment was in fact overwritten by recombination more than 1000 times. As discussed in Appendix 2, a rough estimate of <italic>T</italic> can also be derived from an analysis of the pair statistics of <xref ref-type="fig" rid="fig2">Figure 2</xref>, and this estimate suggests that <italic>T</italic> lies somewhere between <inline-formula><mml:math id="inf175"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf176"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>500</mml:mn></mml:mrow></mml:math></inline-formula>, which is consistent with our lower bound based on <italic>C</italic>.</p><p>The observed ratio <inline-formula><mml:math id="inf177"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> for the <italic>E. coli</italic> alignments is very similar to the value of <inline-formula><mml:math id="inf178"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> observed in the simulations with <inline-formula><mml:math id="inf179"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>). Although it is tempting to conclude from this that the ratio of recombination to mutation rate must be close to one for the <italic>E. coli</italic> strains, such a conclusion would be unwarranted. The evolutionary dynamics of the simulations makes several strong simplifying assumptions, that is that the clonal phylogeny is drawn from the Kingman coalescent process, and that the population is completely mixed so that all strains are equally likely to recombine. Both these assumptions may not apply to the evolution of <italic>E. coli</italic> in the wild. Indeed, we will see below that there is strong evidence that relative recombination rates vary highly across lineages so that instead of a single recombination rate, there is a wide distribution of recombination rates between different lineages. Therefore, it could be misleading to describe <italic>E. coli</italic>’s evolution by a single recombination rate <italic>ρ</italic> and we instead focus on providing a lower bound <inline-formula><mml:math id="inf180"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> on the number of phylogeny changes per SNP column, which is a meaningful quantity independent of the precise evolutionary dynamics that caused the substitutions and phylogeny changes, and can be calculated independently for any subset of strains.</p></sec></sec><sec id="s2-8"><title>Other bacterial species show similar patterns of recombination-dominated genome evolution</title><p>To investigate to what extent the observations we made for <italic>E. coli</italic> generalize to other species of bacteria, we selected five additional species from different bacterial groups for which sufficiently many complete genome sequences of strains were available, and used Realphy to obtain a core genome alignment of the strains for each species (see <xref ref-type="table" rid="app1table3">Appendix 1—table 3</xref> for a list of the species, the number of strains, and other core genome statistics for each species). We then performed most of the analyses that we presented above for <italic>E. coli</italic> on each of these core alignments. <xref ref-type="fig" rid="fig7">Figure 7</xref> presents a summary of the results that we observe across the species.</p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Quantification of the importance of recombination across species.</title><p>(<bold>A</bold>) The cumulative distribution of pairwise divergences is shown as a different colored line for each species (see legend in panel B). Both axes are shown on logarithmic scales. The vertical lines in corresponding colors show the critical divergences at which half of the genome is recombined for each species. (<bold>B</bold>) Cumulative distributions of clonal fractions across the pairs of strains for each species, with the blue, yellow, and green shaded regions indicating the fully recombined, partially recombined, and mostly clonal regimes, respectively, that is analogous to <xref ref-type="fig" rid="fig2">Figure 2I</xref> (<bold>C</bold>) For each species, the height of the bar shows the fraction of SNPs that fall in recombined regions for pairs of strains for which half of the genome is recombined, that is see <xref ref-type="fig" rid="fig2">Figure 2H</xref>. (<bold>D</bold>) The violin plots show, for each species, the distribution of branch support, that is the relative ratio of SNPs supporting versus clashing with each branch split, analogous to the right panel of <xref ref-type="fig" rid="fig4">Figure 4</xref>. The blue lines correspond to the medians of the distributions. (<bold>E</bold>) Box-whisker plots showing the 5, 25, 50, 75, and 95 percentiles of the distributions of nucleotide distances between consecutive SNPs (green) and phylogeny breakpoints (blue, that is analogous to <xref ref-type="fig" rid="fig5">Figure 5C</xref>), for each species. The axis is shown on a logarithmic scale. (<bold>F</bold>) Box-whisker plots of the distributions of the number of consecutive SNPs in tree-compatible segments, that is analogous to <xref ref-type="fig" rid="fig5">Figure 5B</xref>.</p><p><supplementary-material id="fig7sdata1"><label>Figure 7—source data 1.</label><caption><title>List of database accessions of the genomes used.</title></caption><media mime-subtype="plain" mimetype="text" xlink:href="elife-65366-fig7-data1-v2.txt"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig7-v2.tif"/></fig><p><xref ref-type="fig" rid="fig7">Figure 7A</xref> shows the cumulative distributions of pairwise divergences between strains for all species. We see that, while among our <italic>E. coli</italic> strains that were sampled from a common habitat there is a small percentage of very close pairs with divergence below <inline-formula><mml:math id="inf181"><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, for the strains of the other species the closest pairs are at divergence <inline-formula><mml:math id="inf182"><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>. With the exception of <italic>M. tuberculosis</italic>, where the median pair divergence is around <inline-formula><mml:math id="inf183"><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, the median pairwise divergence in all other species is around <inline-formula><mml:math id="inf184"><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> or larger. The vertical lines in <xref ref-type="fig" rid="fig7">Figure 7A</xref> indicate the critical divergences, for each species, where half of the alignment is recombined. With the exception of <italic>M. tuberculosis</italic>, where all pairs are mostly clonal, the critical divergences lie in a fairly narrow range of 0.003–0.01. <xref ref-type="fig" rid="fig7">Figure 7B</xref> shows the cumulative distributions, across pairs of strains, of the fraction of the alignment that is clonally inherited, that is as for <xref ref-type="fig" rid="fig2">Figure 2I</xref> for <italic>E. coli</italic>. Note that, for all species except <italic>M. tuberculosis</italic>, the large majority of the pairs is fully recombined, ranging from about 15% of pairs with a substantial fraction of clonally inherited DNA for <italic>S. aureus</italic>, to virtually no pairs with clonally inherited DNA for <italic>H. pylori</italic>. Thus, we see that for almost all species the situation is similar to what we observed in <italic>E. coli</italic>: for most pairs the distance to their common ancestor cannot be estimated from their alignment, because the entire alignment has been overwritten by recombination events. Note also that, for all species, there is only a relatively small fraction of pairs that lie in the partially recombined regime (yellow segment in <xref ref-type="fig" rid="fig7">Figure 7B</xref>).</p><p>For <italic>E. coli</italic> we found that, even for close pairs for which a substantial fraction of the genome was clonally inherited, most of the SNPs between them still derive from recombination (<xref ref-type="fig" rid="fig2">Figure 2H</xref>). We find that, with the exception of <italic>M. tuberculosis</italic>, this applies to the other species as well. <xref ref-type="fig" rid="fig7">Figure 7C</xref> shows, for each species, the fraction of all SNPs that derive from recombination, for pairs of strains that are at the critical divergence where half of the alignment is recombined. Even though this critical divergence occurs for pairs that are relatively close compared to the typical distance between pairs, for all species more than 90% of the SNPs derive from recombination. That is, we also see that for all five species the divergence between close strains is dominated by SNPs that are introduced through recombination.</p><p>Another way to quantify to what extent the observed sequence variation is consistent with evolution along the branches of the core genome each branch of the core tree. <xref ref-type="fig" rid="fig7">Figure 7D</xref> summarizes the distributions of support of the branches of the core tree as violin plots, that is as shown for <italic>E. coli</italic> as a cumulative distribution in <xref ref-type="fig" rid="fig4">Figure 4</xref>. In <italic>E. coli</italic> most branches have many more SNPs that reject the split than support it, and even stronger rejection of the branches of the core tree are observed for <italic>B. subtilis</italic> and <italic>H. pylori</italic>. For the other species, an almost uniform distribution of branch support is shown, that is for these species there are roughly as many branches that are strongly supported by the SNPs, strongly rejected by the SNPs, or supported and rejected by roughly equally many SNPs.</p><p><xref ref-type="fig" rid="fig7">Figure 7E</xref> summarizes, for each species, the distribution of distances between SNPs along the core alignment as box-whisker plots (green) as well as the distribution of distances between phylogeny breakpoints (blue), that is as shown in <xref ref-type="fig" rid="fig5">Figure 5C</xref> for <italic>E. coli</italic>. The figure shows that, with the exception of <italic>M. tuberculosis</italic>, the inter-SNP distances range from a few to a few dozen base pairs, with a median inter-SNP distance of 4 (<italic>H. pylori</italic>) to 15 (<italic>S. aureus</italic>) base pairs. For these five species, the median distances between phylogeny breakpoints range from around 10 (<italic>H. pylori</italic>) to about 100 base pairs for <italic>S. aureus</italic>. Note that, for all species, the left tails of the distributions stretch to very short distances between breakpoints, whereas distances between breakpoints of more than 200 bps are very rare for all these five species. Thus, for these species the segments that are consistent with a single phylogeny are always much shorter than the typical length of a gene. In contrast, for <italic>M. tuberculosis</italic> both the distances between SNPs and the distances between breakpoints are almost two orders of magnitude larger, indicating that these strains are much more closely related than the strains of the other species.</p><p><xref ref-type="fig" rid="fig7">Figure 7F</xref> shows box-whisker plots for the distributions of the number of consecutive SNPs between breakpoints, as was shown for <italic>E. coli</italic> in <xref ref-type="fig" rid="fig5">Figure 5B</xref>. We see that for all species, including <italic>M. tuberculosis</italic>, there are typically less than a handful of SNPs in a row before a phylogeny breakpoint occurs, and very rarely more than a dozen SNPs. The smallest number of SNPs per breakpoint is observed for <italic>H. pylori</italic>, that is typically less than 2 SNPs per breakpoint, but the range of SNPs per breakpoint is very similar across all species.</p><p>Finally, <xref ref-type="table" rid="app1table4">Appendix 1—table 4</xref> shows the fraction of alignment columns that are SNPs, the lower bound <italic>C</italic> on the number of phylogeny changes, and the lower bound <inline-formula><mml:math id="inf185"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> on the ratio of phylogeny changes to SNP columns, for each of the six species. We see that with the exception of <italic>H. pylori</italic>, which has a high ratio <inline-formula><mml:math id="inf186"><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>≈</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula>, and <italic>M. tuberculosis</italic> which has significantly lower ratio <inline-formula><mml:math id="inf187"><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>≈</mml:mo><mml:mn>0.08</mml:mn></mml:mrow></mml:math></inline-formula>, the other species have ratios <inline-formula><mml:math id="inf188"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> similar to that observed for <italic>E. coli</italic>. Note that the high rate of recombination that we infer for <italic>H. pylori</italic> is consistent with the consensus in the literature that genome evolution is dominated by recombination in this species, for example (<xref ref-type="bibr" rid="bib45">Suerbaum et al., 1998</xref>).</p><p>In contrast, the consensus in the field of <italic>M. tuberculosis</italic> evolution is that essentially no recombination occurs in this species. Although there have been reports of evidence for recombination (<xref ref-type="bibr" rid="bib31">Liu et al., 2006</xref>; <xref ref-type="bibr" rid="bib34">Namouchi et al., 2012</xref>; <xref ref-type="bibr" rid="bib38">Phelan et al., 2016</xref>), follow-up analyses suggested that these may well be a result of problems with genome assemblies and genome alignments (<xref ref-type="bibr" rid="bib18">Godfroid et al., 2018</xref>). Although our statistics indicate that evolution in <italic>M. tuberculosis</italic> is predominantly clonal, we do find a significant fraction of SNPs that clash with the whole genome tree. However, because SNPs are relatively rare in <italic>M. tuberculosis</italic>, that is on average one SNP every 1200 base pairs, SNPs that clash with the core phylogeny occur only once every 4700 base pairs, and it is not hard to imagine that problems with the genome assemblies of just a few strains could cause artefactual SNPs to occur at that rate. Indeed, we found that 5 of the <italic>M. tuberculosis</italic> genomes in our dataset have recently been retracted from the database because of evidence of contamination. Notably, we found that these strains were responsible for the large majority of the clashing SNPs. That is, after removal of these five strains, clashing SNPs now only occur once every 12'700 base pairs on average. Since it is not implausible that there may be problems with the genome assemblies of one or more of the remaining strains, this suggests that these remaining clashing SNPs may well be artefacts as well. In conclusion, although we cannot definitively conclude there is no recombination at all in <italic>M. tuberculosis</italic>, our analysis confirms that it must be rare.</p><p>In summary, with the exception of <italic>M. tuberculosis</italic>, all other species show the same pattern as <italic>E. coli</italic> with genome evolution being dominated by recombination. For most pairs, no DNA in their alignment was clonally inherited, even for close pairs most of the SNPs derive from recombination events, the phylogeny changes thousands of times along the core genome alignment, typically within a handful of SNPs, and each position in the alignment has been overwritten by recombination many times in its history.</p></sec><sec id="s2-9"><title>Phylogenetic structures reflect population structure</title><p>All our results so far show that the core tree cannot represent the evolutionary relationships between the strains and that a large number of different phylogenies occurs across the alignment. It may thus seem all the more puzzling that, when trees are constructed from sufficiently many genomic loci, the core tree reliably emerges (<xref ref-type="fig" rid="fig1">Figure 1</xref>, bottom).</p><p>As we mentioned in the introduction, some researchers interpret this convergence to the core tree to mean that the core tree must correspond to the <italic>clonal</italic> phylogeny of the strains. The interpretation is that the SNP patterns in the data are a combination ‘clonal SNPs’ that fall on the clonal phylogeny, plus a substantial number of ‘recombined SNPs’ that act so as to introduce noise on the clonal phylogenetic signal. In this interpretation, trees build from individual loci can differ from the core tree because the ‘recombination noise’ can locally drown out the clonal signal, but once sufficiently many loci are considered, this recombination noise ‘averages out’ and the true clonal structure emerges. However, this interpretation rests on two assumptions that do not necessarily hold. First, in order for the effects of recombination to ‘average out’ when many loci are considered, one has to assume that the recombination ‘noise’ has no systematic structure itself. That is, one has to assume that there is no population structure, that is that all lineages are equally likely recombine with each other. Second, for the clonal phylogeny to emerge one has to also assume that there are sufficiently many loci that have not been affected by recombination. However, the results above show that recombination is so common that each locus has been overwritten many times by recombination, that is there are essentially no loci that are unaffected by recombination.</p><p>Note that if the phylogenies along the alignment were a combination of clonal and randomly recombined SNPs, then one would expect that removal of all the clonal SNPs would destabilize the core tree. However, if we remove all SNP columns from the core genome alignment that correspond to branches of the core tree, and then reconstruct a phylogeny from this edited alignment, the resulting tree is still highly similar to the core tree (<xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1</xref>). That is, we obtain a very similar tree from this edited alignment, even though virtually <italic>all</italic> SNPs in this alignment are inconsistent with this tree. This confirms that the structure in the core tree does not derive from the subset of SNPs that fall on the core tree, but rather reflects overall statistical properties of all SNPs.</p><p>We propose that, rather than thinking of the SNP patterns as deriving from a single ‘true’ phylogeny plus unstructured recombination noise, the statistics of the SNP patterns reflect structure in the recombination process itself. In particular, we propose that because of population structure, that is the fact that different lineages recombine at different rates, the recombination process is itself structured, and that the distribution of phylogenies that occur along the alignment reflects this population structure. To illustrate this interpretation, we will use data from a species for which there is no question that recombination dominates and no ‘clonal’ structure can exist.</p><sec id="s2-9-1"><title>Phylogenies reconstructed from human genome sequences also exhibit robust phylogenetic structure</title><p>We randomly selected 40 genomes from the 1000 Genomes project, used PhyML to build a phylogenetic tree from chromosomes 1–12 of these genomes, and then investigated to what extent branches in this tree also occur in trees build from random subsets of the genomic loci. As shown in <xref ref-type="fig" rid="fig8">Figure 8</xref>, a robust phylogeny also emerges for the human data. In particular, individuals with the same geographic ancestry consistently form clades in the trees build from large numbers of loci.</p><fig-group><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Core tree build by PhyML from the sequences of chromosomes 1–12 of 40 randomly chosen human genomes of the 1000 Genome project.</title><p>The colors indicate what fraction of the time each split in the core tree occurred in trees build from random subsets of half of the genomic loci. The colors on the leaves indicate the annotated ancestry of the individuals, with blue corresponding to African ancestry, green to European ancestry, red to (South) American ancestry, cyan to East Asian ancestry, and magenta to South Asian ancestry. Individuals from the same geographic area reliably form clades in the tree with the exception of South Americans, two of which form an outgroup of the Europeans, three an outgroup of East Asians, and two an outgroup of Africans.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig8-v2.tif"/></fig><fig id="fig8s1" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 1.</label><caption><title>The <italic>E.coli</italic> core tree is relatively insensitive to removal of all SNPs that correspond to branches of the core tree.</title><p>Differences between the core tree <italic>T</italic> and the tree <inline-formula><mml:math id="inf189"><mml:msup><mml:mi>T</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> reconstructed from the alignment from which all SNPs that fall on branches of the core tree have been removed. Each branch of the core tree <italic>T</italic> is colored green when the branch also occurs in <inline-formula><mml:math id="inf190"><mml:msup><mml:mi>T</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> and pink if it does not. The Robinson-Foulds distance between two trees is defined as the number of branches (that is bi-partitions) that occur in only one of the two trees. For <italic>T</italic> and <inline-formula><mml:math id="inf191"><mml:msup><mml:mi>T</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> the Robinson-Foulds distance is 62 out of a maximal 178, that is a fraction 0.35 does not match. Note that for tree <inline-formula><mml:math id="inf192"><mml:msup><mml:mi>T</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> only 3% of the SNPs fall on its branches.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig8-figsupp1-v2.tif"/></fig></fig-group><p>However, it is of course clear that this phylogeny cannot correspond to the ‘clonal phylogeny’ of the human sequences, because there is no such thing as a ‘clonal phylogeny’ for the human sequences. Perhaps, the closest analog of a ‘clonal tree’ for the human data would be the phylogeny of the strictly maternal lineage. However, since at each generation roughly half of the autosomal chromosomes derives from the mother, and half from the father, there are few if any loci in the genome that follow this strictly maternal lineage, that is almost every locus was paternally inherited in at least <italic>some</italic> generations. Instead, it is clear that there are many different phylogenies along the genome, each with different ancestries.</p><p>The reason that a robust phylogeny still emerges is that the different phylogenies that occur along the genome are not completely random. That is, human populations are not completely mixed but people are more likely to mate with others from the same geographic area. Because of this, recombination tends to occur among people of the same geographic area, and because of this population structure the phylogenies that occur along the alignment of a set of human genomes are not sampled uniformly from all possible phylogenies, but some topologies are more likely to occur than others. In particular, individuals from the same geographic area will have recent ancestors in a larger fraction of the phylogenies along the genome than individuals from different geographic areas. Indeed, a simple principal component analysis of SNP statistics in genomes of European ancestry recapitulates geographic structure in remarkable detail (<xref ref-type="bibr" rid="bib35">Novembre et al., 2008</xref>).</p><p>Of course, there are good reasons that human population geneticists do not typically represent the ancestral population structure of human sequences by a single phylogeny. We know that many different phylogenies occur along the genome and it would be misleading to pretend that this distribution of phylogenies can be summarized by a single tree. However, if one insists on representing the population structure by a single tree and asks PhyML to build a single phylogeny from many loci of the human sequences, then one does get convergence to a common phylogeny for the human data as well. The reason one gets this convergence is because asking for a single tree is analogous to asking for the ‘average’ of a distribution. The average of almost any distribution becomes very robust given enough samples, even if this average does not actually represent any typical sample. For example, instead of the total divergence between a pair of individuals representing the distance to their clonal ancestor, this divergence represents the <italic>average</italic> distance to the many different common ancestors of the pair across the many different phylogenies along the genome, and this average is a function of the rates at which their genetic ancestors have recombined. That is, the distances in this tree reflect the relative rates of recombination among the different lineages.</p><p>We propose that the situation for the bacterial data is very similar. Our analysis above has shown that many different phylogenies occur along the alignment and that the core tree must reflect the statistics of this distribution of phylogenies. We propose that, in the same way as for the human data, the core tree that results from applying PhyML to the core genome of a set of bacterial strains reflects population structure, that is the relative rates with which different lineages have recombined. To support this, we return to the <italic>E. coli</italic> data and use the SNP statistics to quantify the relative rates with which different lineages have recombined.</p></sec><sec id="s2-9-2"><title>Recombination rates across lineages follow approximately scale-free distributions</title><p>The analyses above have shown that the core alignment of the <italic>E. coli</italic> strains consists of tens of thousands of short segments with different phylogenies. Thus, one approximate way of thinking about the core genome alignment is that the phylogeny at every genomic locus is independently drawn from some distribution over all possible phylogenies. Conceptually, whereas for purely clonal evolution each strain will have a unique clonal ancestor at each time <italic>t</italic> in the past, due to the frequent recombination each strain will have a large number of different genetic ancestors, that are responsible for different parts of the strain’s genome. We will refer to the genetic ancestors of each strain as one moves back in time as the <italic>lineages</italic> of each strain. Population structure corresponds to the fact that different lineages, that is the genetic ancestors of different strains, did not all recombine at the same rate, but that some recombined much more frequently than others.</p><p>The distribution of observed SNP types in fact contains extensive information about the relative frequencies with which different lineages have recombined at different times in the past. For example, imagine a SNP where two strains share a nucleotide which differs from the nucleotide that all other strains possess. We will denote such SNPs as 2-SNPs or pair-SNPs. If, at some genomic locus <italic>g</italic>, we find a 2-SNP shared by strains <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub>, then it follows that, whatever the phylogeny is at locus <italic>g</italic>, the strains <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub> must be nearest neighbors in the tree, and the SNP corresponds to a substitution that occurred on the branch connecting the ancestor of <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub> to all other strains. As an example, <xref ref-type="fig" rid="fig9">Figure 9A</xref> graphically shows the frequencies of all pair-SNPs <inline-formula><mml:math id="inf193"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> in which A1 shares a SNP with one other strain <italic>s</italic>. Note that, if the data consisted of a clonal phylogeny plus random recombinations, we would expect A1 to have a substantial number of 2-SNPs with its nearest neighbor in the clonal phylogeny, plus a small number of 2-SNPs with a random collection of other strains. Also, if all lineages were freely recombining, we would expect roughly equal frequencies of all possible 2-SNPs <inline-formula><mml:math id="inf194"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. However, this is not what we see. A1 shares 2-SNPs with 17 of the 92 strains in our collection at a wide range of frequencies. Instead of a clear ‘clonal’ neighbor with most SNPs, there are three strains that share 2-SNPs almost equally commonly with A1, that is A2, A11, and D8 with about 200 2-SNPs each. There are some strains with intermediate numbers of 2-SNPs, that is D4, and H6 with about 70 occurences each, 10 strains with 10 or less 2-SNPs each, and four strains with only a single 2-SNP.</p><fig-group><fig id="fig9" position="float"><label>Figure 9.</label><caption><title>SNP-type frequencies follow approximately power-law distributions.</title><p>(<bold>A</bold>) Frequencies of 2-SNPs of the type <inline-formula><mml:math id="inf195"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> in which a SNP is shared between strain A1 and one other strain <italic>s</italic>. Each edge corresponds to a 2-SNP <inline-formula><mml:math id="inf196"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and the thickness of the edge is proportional to the logarithm of the number of occurrences of this 2-SNP. The frequency of each edge is also indicated at the corresponding outer node. (<bold>B</bold>) A graph showing all 2-SNPs <inline-formula><mml:math id="inf197"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> that were observed in the core genome alignment. Each node corresponds to a strain and each edge to a 2-SNP, with the thickness of the edge proportional to the logarithm of the number of occurrences of the SNP. (<bold>C</bold>) Reverse cumulative distributions of the frequencies of all observed 2-SNPs (blue dots), 3-SNPs (orange dots), 4-SNPs (green dots), and 12-SNPs (red dots). The solid lines in corresponding colors show power-law fits. Both axes are shown on a logarithmic scale. (<bold>D</bold>) Exponents of the power-law fits to the <italic>n</italic>-SNP frequency distributions, as a function of the number of strains sharing a SNP <italic>n</italic>. Error bars correspond to 95% posterior probability intervals.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig9-v2.tif"/></fig><fig id="fig9s1" position="float" specific-use="child-fig"><label>Figure 9—figure supplement 1.</label><caption><title>The <italic>n</italic>-SNP distributions are insensitive to removal of potential homoplasies and removal of <italic>n</italic>-SNPs corresponding to branches of the core tree.</title><p>Distributions of <italic>n</italic>-SNP frequencies (left panels) and exponents of the power-law fits (right panels) for original <italic>E. coli</italic> core genome alignment (top row), the 5% homoplasy-corrected core genome alignment (middle row), and the 5% homoplasy-corrected alignment from which all <italic>n</italic>-SNPs that correspond to branches of the core tree have been removed (bottom row). The observed <italic>n</italic>-SNP distributions and exponents are very similar for all three datasets, showing that the <italic>n</italic>-SNP distributions are not affected by homoplasies, and that clonal SNPs make only a minor contribution to these distributions.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig9-figsupp1-v2.tif"/></fig></fig-group><p>We propose that these relative numbers of SNP-sharing directly reflect relative rates of recombination between the genetic ancestors of these strains. Note that since all loci are overwritten many times by recombination, essentially every locus <italic>g</italic> along the alignment has its own unique lineage of genetic ancestors, as determined by the recombination events overlapping this locus, resulting in its own unique phylogeny <inline-formula><mml:math id="inf198"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math></inline-formula>. Tracing the genetic ancestors of a pair of strains <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub> into the past, we will say that their lineages ‘have recombined’ at time <italic>t</italic> in the past, when their most recent common genetic ancestor occurs at time <italic>t</italic> in the past. In order for strains <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub> to share a 2-SNP at locus <italic>g</italic>, they must be nearest neighbors in phylogeny <inline-formula><mml:math id="inf199"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math></inline-formula>, that is their lineages must thus have recombined with each other before recombining with the lineages of any of the other strains. In addition, a substitution must have occurred on the lineage from their common ancestor to the next common ancestor in phylogeny <inline-formula><mml:math id="inf200"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math></inline-formula>.</p><p>Thus, the number of times <inline-formula><mml:math id="inf201"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> we expect to see a 2-SNP of type <inline-formula><mml:math id="inf202"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is proportional to the fraction <inline-formula><mml:math id="inf203"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> of genomic loci <italic>g</italic> for which <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub> have recombined before recombining with any of the other lineages, times the average length <inline-formula><mml:math id="inf204"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> of the branches from the genetic ancestors of <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub> to the next common ancestor in these phylogenies <inline-formula><mml:math id="inf205"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math></inline-formula>, that is<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>∝</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The fraction <inline-formula><mml:math id="inf206"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> reflects the rate with which the lineages of <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub> have recombined, relative to the rates with which the lineages of <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub> recombine with the lineages of all other strains. In contrast, the average branch length <inline-formula><mml:math id="inf207"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> reflects the <italic>total</italic> rate at which the lineages of the ancestors of <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub> recombine with any of the other lineages. Since the total rates of recombination are determined by sums of many rates, we believe that it is likely that variation in the average branch lengths <inline-formula><mml:math id="inf208"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> across pairs <inline-formula><mml:math id="inf209"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is significantly less than the variation in <inline-formula><mml:math id="inf210"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula>. That is, we believe the variation in the number of occurrences <inline-formula><mml:math id="inf211"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> across pairs <inline-formula><mml:math id="inf212"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> mostly reflects variation in the fractions <inline-formula><mml:math id="inf213"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula>, which directly reflect variation in the rates of recombination.</p><p>To investigate how the relative rates of recombination vary across all pairs, we calculated the frequencies <inline-formula><mml:math id="inf214"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> of 2-SNPs across all pairs of strains. <xref ref-type="fig" rid="fig9">Figure 9B</xref> shows a graph representation of all observed pair-SNPs, with the thickness of the edges proportional to the logarithm of the frequency of occurrence of each 2-SNP type. We see that each strain is connected through 2-SNPs to a substantial number of other strains, indicating a high diversity of recent recombination events across the strains. At the same time, the large variability in the thickness of the edges indicates that some pairs occur much more frequently than others. <xref ref-type="fig" rid="fig9">Figure 9C</xref> shows the reverse cumulative distribution of the frequencies of all observed 2-SNPs (blue dots), that is the distribution of the thickness of the edges in <xref ref-type="fig" rid="fig9">Figure 9B</xref>. Note that, if the strains were to recombine freely, each 2-SNP would be equally likely to occur, and 2-SNP frequencies would show little variation. Instead, we see that 2-SNP frequencies <italic>f</italic> vary over more than 3 orders of magnitude, that is from an occurrence of just <inline-formula><mml:math id="inf215"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> for many 2-SNPs to <inline-formula><mml:math id="inf216"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>2965</mml:mn></mml:mrow></mml:math></inline-formula> occurrences for the most common 2-SNP. Since the reverse cumulative distribution of 2-SNP frequencies follows an approximate straight-line in a log-log plot, the frequency distribution roughly follows a power-law distribution <inline-formula><mml:math id="inf217"><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∝</mml:mo><mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. Fitting the 2-SNP data to a power-law (see Materials and methods) we find that the exponent equals approximately <inline-formula><mml:math id="inf218"><mml:mrow><mml:mi>α</mml:mi><mml:mo>≈</mml:mo><mml:mn>1.41</mml:mn></mml:mrow></mml:math></inline-formula> (blue line in <xref ref-type="fig" rid="fig9">Figure 9C</xref>). While clearly not a perfect power-law, the distribution is long tailed and much better fit by a straight line in a log-log plot than by a straight line in either a linear or semi-log plot.</p><p>Beyond SNPs shared by pairs of strains, we can of course also look at SNPs shared by triplets, quartets, and so on. Besides the distribution of 2-SNP frequencies, <xref ref-type="fig" rid="fig9">Figure 9C</xref> also shows the reverse cumulative distributions of 3-SNPs (orange dots), 4-SNPs (green dots), and 12-SNPs (red dots). We see that all these distributions can be approximated with power-law fits (solid lines). We find that essentially all <italic>n</italic>-SNP distributions are approximately scale-free, that is can be fitted with power-laws. Thus, while some sets of <italic>n</italic> strains share SNPs much more often than others, their frequencies fall along a scale-free continuum, so that there is no natural way of dividing the clades of <italic>n</italic> strains into ‘common’ and ‘rare’ clades. Note also that each <italic>n</italic>-SNP corresponds to a mutation that occurred on the branch leading to the ancestor of a group of <italic>n</italic> strains. Therefore, <italic>n</italic>-SNPs for larger <italic>n</italic> typically correspond to mutational events that occurred further back in time. As shown in <xref ref-type="fig" rid="fig9">Figure 9D</xref>, the exponent α of the <italic>n</italic>-SNP distribution increases with <italic>n</italic>, ranging from <inline-formula><mml:math id="inf219"><mml:mrow><mml:mi>α</mml:mi><mml:mo>≈</mml:mo><mml:mn>1.25</mml:mn></mml:mrow></mml:math></inline-formula> for singlets, that is <inline-formula><mml:math id="inf220"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, to <inline-formula><mml:math id="inf221"><mml:mrow><mml:mi>α</mml:mi><mml:mo>≈</mml:mo><mml:mn>2.8</mml:mn></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf222"><mml:mrow><mml:mi>n</mml:mi><mml:mo>≥</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula>. The fact that <italic>n</italic>-SNP distributions become more steep as <italic>n</italic> increases means that the average number of occurrences per <italic>n</italic>-SNP decreases as <italic>n</italic> increases. Thus, the diversity of <italic>n</italic>-SNPs tends to be larger further back in time (see also Appendix 4).</p><p>One might wonder to what extent ‘clonal’ SNPs also contribute to the observed distributions of <italic>n</italic>-SNPs, for example whether the most frequent <italic>n</italic>-SNPs in the tails of the distributions might correspond to clonal SNPs. However, removal of all <italic>n</italic>-SNPs that correspond to branches of the core tree has little effect on the <italic>n</italic>-SNP distributions (<xref ref-type="fig" rid="fig9s1">Figure 9—figure supplement 1</xref>). In addition, the <italic>n</italic>-SNP distributions for the 5% homoplasy-corrected alignments also look virtually identical (<xref ref-type="fig" rid="fig9s1">Figure 9—figure supplement 1</xref>), showing that homoplasies do not significantly affect the <italic>n</italic>-SNP distributions either.</p><p>If, as we have argued, these long-tailed distributions of <italic>n</italic>-SNP frequencies indicate complex population structure, that is that recombination rates of different lineages vary along a wide continuum, then one would expect that the <italic>n</italic>-SNP statistics that are observed for clonally evolving populations, or populations that are freely recombining, look fundamentally different. This is indeed what we observe. Appendix 4 presents an in-depth comparison of <italic>n</italic>-SNP statistics observed for the <italic>E. coli</italic> data, with the <italic>n</italic>-SNPs observed for simulations with different amounts of recombination. To summarize, when recombination rates are so low that populations evolve mostly clonally, that is <inline-formula><mml:math id="inf223"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>≤</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>, the diversity of <italic>n</italic>-SNP types is low. Although the distribution of <italic>n</italic>-SNP frequencies exhibits long tails, these frequencies mostly reflect the lengths of the branches in the clonal tree, and the exponents are much smaller and approximately independent of <italic>n</italic>. When recombination rates are higher, and more similar to what we inferred for the <italic>E. coli</italic> data, there is a very large diversity of <italic>n</italic>-SNPs, but the <italic>n</italic>-SNP distributions do not exhibit long tails. Instead, all <italic>n</italic>-SNP types have similar frequencies. Thus, the combination of the high diversity of <italic>n</italic>-SNP types with the long-tailed distributions that get more steep as <italic>n</italic> increases, is unique for the <italic>E. coli</italic> data, supporting that these distributions reflect population structure.</p><p>Finally, although it is tempting to interpret the <italic>n</italic>-SNP distributions as reflecting an almost ‘scale free’ population structure, they depend in a complex manner on both the distributions of topologies and branch lengths of the phylogenies across the alignment. As we do not yet have a general theory for the evolutionary process that generates the distribution of phylogenies along the alignment, it is at this point difficult to disentangle the contributions from variations in topologies and branch lengths to the <italic>n</italic>-SNP distributions. Consequently, it is difficult to give a precise interpretation of either the approximate power-law form or the meaning of the exponents.</p></sec><sec id="s2-9-3"><title>Phylogenetic entropy profiles of individual strains</title><p>Another way to characterize the structure of the <italic>n</italic>-SNP distributions is to quantify, for each strain <italic>s</italic>, how diverse the clades are that <italic>s</italic> occurs in at different <italic>n</italic>. To illustrate the idea, we refer back to <xref ref-type="fig" rid="fig9">Figure 9A</xref>, which shows all the 2-SNPs in which strain A1 occurs. Note that these 2-SNPs are all mutually inconsistent, that is in any one phylogenetic tree the strain A1 can only occur in a pair with <italic>one</italic> other strain. Therefore, the relative frequencies of the different 2-SNPs in which A1 occurs reflect the relative frequencies of phylogenies in which A1 is paired with different strains, and the diversity of these pairs can be quantified by the <italic>entropy</italic> of this distribution. That is, if <inline-formula><mml:math id="inf224"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> is the number of 2-SNPs of type <inline-formula><mml:math id="inf225"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, then the fraction of pairs for which A1 occurs with <italic>s</italic> is <inline-formula><mml:math id="inf226"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, and the entropy of the distribution of 2-SNPs for A1 is <inline-formula><mml:math id="inf227"><mml:mrow><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>s</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>Note that the same calculation can be done for any strain <italic>s</italic> and any <italic>n</italic>. For example, if the strain <italic>s</italic> occurs in 10 different quartets of strains <italic>q</italic>, then all quartets <italic>q</italic> are mutually inconsistent, and the diversity of quartets in which <italic>s</italic> occurs can be calculated as the entropy <inline-formula><mml:math id="inf228"><mml:mrow><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>q</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> of the relative frequencies with which the different quartets <italic>q</italic> occur. In this way, for each strain <italic>s</italic> we can calculate an entropy profile <inline-formula><mml:math id="inf229"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> that contains the entropies of the <italic>n</italic>-SNP distributions in which strain <italic>s</italic> occurs, as a function of <italic>n</italic> (see Materials and methods). <xref ref-type="fig" rid="fig10">Figure 10</xref> shows the entropy profiles of all strains (right panel), as well for a selection of six example strains (left panel), as calculated on the 5% homoplasy-corrected alignments.</p><fig-group><fig id="fig10" position="float"><label>Figure 10.</label><caption><title>Phylogenetic entropy profiles of the <italic>E.coli</italic> strains.</title><p>Left panel: Entropy profiles <inline-formula><mml:math id="inf230"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (in bits) for six example strains, indicated in the legend. Right panel: Entropy profiles <inline-formula><mml:math id="inf231"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for all <italic>E. coli</italic> strains.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig10-v2.tif"/></fig><fig id="fig10s1" position="float" specific-use="child-fig"><label>Figure 10—figure supplement 1.</label><caption><title>Entropy profiles of the <italic>n</italic>-SNP distributions for each of the <italic>E.coli</italic> phylogroups.</title><p>Entropy profiles of the <italic>n</italic>-SNP distributions for each of the <italic>E. coli</italic> phylogroups. Each panel shows the entropy <inline-formula><mml:math id="inf232"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of the <italic>n</italic>-SNP distribution (vertical axis) as a function of <italic>n</italic> for each strain <italic>s</italic> (differently colored lines) within a phylogroup (indicated at the top of the panel). All entropies were calculated on the 5% homoplasy-corrected alignments. For phylogroups with less than 10 strains, the names of the strains are indicated in the legend of the plot. Note that the bottom right panel corresponds to the outgroup of nine strains that are highly diverged from all other strains. Note also that entropy profiles are perfectly overlapping for strains within groups that are so close that they had a recent clonal ancestor. For example, for the pairs (C10,C11) and (D3,D7) in phylogroup A, the pair (A7,B2) in phylogroup B2, and pair (B6,C1) in phylogroup F, the two profiles are identical and only one curve is visible.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig10-figsupp1-v2.tif"/></fig><fig id="fig10s2" position="float" specific-use="child-fig"><label>Figure 10—figure supplement 2.</label><caption><title>Statistical significance of the difference in <italic>n</italic>-SNP statistics for all pairs of strains.</title><p>Statistical significance of the difference in <italic>n</italic>-SNP statistics for all pairs of strains. Left panel: Cumulative distribution of the p-values of the Fisher exact test (Materials and methods) for the <italic>n</italic>-SNP statistics across all pairs of strains. About 94% of all pairs have significantly different <italic>n</italic>-SNP distributions. Right panel: p-values of the Fisher-exact test as a function of the divergence of each pair of strains. Each dot corresponds to one pair with the horizontal axis showing the total number of single-nucleotide differences between the pair of core genomes and the vertical axis showing minus the logarithm of the p-value (base 10). The diagonal line corresponds to the line <inline-formula><mml:math id="inf233"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula> and the horizontal dashed line corresponds to a p-value of 0.001. Note that the significance correlates very well with the divergence of the pair and that only pairs of genomes that differ in less than 10 nucleotides in their core genomes have indistinguishable <italic>n</italic>-SNP statistics.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig10-figsupp2-v2.tif"/></fig><fig id="fig10s3" position="float" specific-use="child-fig"><label>Figure 10—figure supplement 3.</label><caption><title>Comparison of the entropy profiles of the <italic>n</italic>-SNP distributions of <italic>E.coli</italic> with those of the data of the simulations.</title><p>Entropy profiles of the <italic>n</italic>-SNP distributions for the <italic>E. coli</italic> data (top left panel) and the data from the simulations other panels, with the recombination rate <inline-formula><mml:math id="inf234"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> indicated in the title of each panel. Each panel shows the entropy <inline-formula><mml:math id="inf235"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of the <italic>n</italic>-SNP distribution (vertical axis) as a function of <italic>n</italic> for each strain <italic>s</italic> (differently colored lines). All entropies were calculated using the 5% homoplasy-corrected alignments. Note that the small number of nonzero entropies for the simulations without recombination are due to the small number of remaining homoplasies.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig10-figsupp3-v2.tif"/></fig></fig-group><p>Note that, if evolution were strictly clonal, then all entropies <inline-formula><mml:math id="inf236"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> would be zero, but instead we see entropies going up to 6–8 bits for all strains. However, probably the most striking feature of the entropy profiles is their great variability across the strains. If all lineages were recombining with each other at equal rates, we would expect the diversity of <italic>n</italic>-SNPs to increase in the same way for each strain, but the data show almost as many distinct entropy profiles as there are strains. This shows directly that the recombination rates across lineages must be highly heterogeneous.</p><p>For most strains the entropy increases quickly with <italic>n</italic>, for example for strain A10 the entropy rises to <inline-formula><mml:math id="inf237"><mml:mrow><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mn>10</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula> bits, which is equivalent to strain A10 occurring in approximately 64 different quartets with equal frequency. In contrast, for strain E7 the entropy stays zero until <inline-formula><mml:math id="inf238"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula>, and for strain G8 even until <inline-formula><mml:math id="inf239"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula>. As can be seen in the core tree (<xref ref-type="fig" rid="fig1">Figure 1</xref>), E7 and G8 are part of groups of <inline-formula><mml:math id="inf240"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf241"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula> very closely related strains, respectively. Both these groups had a clonal ancestor so recently that essentially no recombination events occurred since. Consequently, the strains in these groups occur in at most 1 type of <italic>n</italic>-SNP for <inline-formula><mml:math id="inf242"><mml:mrow><mml:mi>n</mml:mi><mml:mo>≤</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf243"><mml:mrow><mml:mi>n</mml:mi><mml:mo>≤</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula>, respectively. Thus, for groups of <italic>m</italic> strains with a very recent common ancestor, the entropies <inline-formula><mml:math id="inf244"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are essentially zero when <inline-formula><mml:math id="inf245"><mml:mrow><mml:mi>n</mml:mi><mml:mo>≤</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>. In this way, the entropy profiles directly show when strains are parts of a clonal clade.</p><p>Although the entropies generally go up with <italic>n</italic>, they do not increase monotonically. For example, for strain B11, the entropy increases to around <inline-formula><mml:math id="inf246"><mml:mrow><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mn>11</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf247"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf248"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math></inline-formula>, but then drops back to almost zero at <inline-formula><mml:math id="inf249"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:math></inline-formula>. Notably, this strain B11 is a member of the outgroup of nine strains that are highly diverged from all the other strains (<xref ref-type="fig" rid="fig1">Figure 1</xref>) and the fact that <inline-formula><mml:math id="inf250"><mml:mrow><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>9</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mn>11</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> reflects the fact that 9-SNPs shared by all strains of the outgroup are vastly more numerous than any other 9-SNP in which B11 occurs. That is, whereas B11 occurs in different clades of sizes <inline-formula><mml:math id="inf251"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> through 8, the phylogenies of almost all its genomic loci contain the same clade of <inline-formula><mml:math id="inf252"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:math></inline-formula> strains corresponding to the outgroup.</p><p>Another feature that is evident is that the entropy profiles of some strains appear to nearly merge at large <italic>n</italic>. For example, the entropy profiles of A10 and E7 become very similar from <inline-formula><mml:math id="inf253"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>34</mml:mn></mml:mrow></mml:math></inline-formula> onward, and from about <inline-formula><mml:math id="inf254"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>40</mml:mn></mml:mrow></mml:math></inline-formula> on-wards the profile of K12 becomes very similar to these two as well. However, not all entropy profiles merge, and different groups of profiles remain up until <inline-formula><mml:math id="inf255"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>46</mml:mn></mml:mrow></mml:math></inline-formula>. As can be seen in <xref ref-type="fig" rid="fig10s1">Figure 10—figure supplement 1</xref>, we generally observe that strains from the same phylogroup tend to merge their entropy profiles at large <italic>n</italic>. Importantly, however, although the entropy profiles become highly similar at large <italic>n</italic>, they do not become identical. In contrast, for strains with a recent clonal ancestor, the entropy profiles are perfectly identical. For example, the entropy profiles of the close pairs (B6, C1) from phylogroup F, and (A7, B2) from phylogroup B2, completely overlap so that only one of the two colors of each pair is visible in the plot (<xref ref-type="fig" rid="fig10s1">Figure 10—figure supplement 1</xref>). We developed a simple statistical test, based on the Fisher-exact test (Materials and methods) to quantify the extent to which the <italic>n</italic>-SNP statistics of a pair of strains are significantly distinct. As shown in <xref ref-type="fig" rid="fig10s2">Figure 10—figure supplement 2</xref>, we find that only very closely related pairs of strains that had a recent common ancestor, corresponding to about 5% of all pairs, have statistically indistinguishable <italic>n</italic>-SNP statistics. Thus, while strains with a recent clonal ancestor have identical entropy profiles, the entropy profiles of strains from a phylogroup have similar but not identical <italic>n</italic>-SNP distributions at large <italic>n</italic>. Moreover, strains from different phylogroups can have very different entropy profiles even at large <italic>n</italic>. To provide additional insights into what the <italic>n</italic>-SNP statistics show about recombination patterns, Appendix 5 provides an in-depth analysis of the <italic>n</italic>-SNP statistics for the relatively small phylogroup B2.</p><p>Thus, the general picture that emerges from the entropy profiles is that, while some of the structure at small <italic>n</italic> is due to clonal relationships, at large <italic>n</italic> the entropy profiles reflect the statistics of recombination of different lineages. While strains from the same phylogroup tend to show highly similar <italic>n</italic>-SNP statistics at high <italic>n</italic>, suggesting that their lineages have similar recombination statistics sufficiently far into the past, strains from different lineages have clearly different recombination statistics even far into the past.</p><p>Finally, the entropy profiles observed for the <italic>E. coli</italic> strains differ fundamentally from what is observed for the data from simulations (<xref ref-type="fig" rid="fig10s3">Figure 10—figure supplement 3</xref>). For the simulations without recombination, the entropies are almost all zero and at the very low recombination rate of <inline-formula><mml:math id="inf256"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>, where clonal SNPs dominate along all branches of the clonal tree, all entropies are small. In contrast, in the regime where recombination dominates along all branches of the clonal tree, that is for <inline-formula><mml:math id="inf257"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>≥</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula>, the entropy profiles of all strains are highly similar. This confirms that when lineages recombine at equal rates, highly similar entropy profiles result. Therefore, the fact that the entropy profiles are highly heterogeneous for <italic>E. coli</italic>, and that virtually every strain has a distinct entropy profile, directly shows that the lineages of almost every strain have a distinct pattern of recombination rates with the lineages of the other strains.</p></sec><sec id="s2-9-4"><title><italic>n</italic>-SNP statistics and entropy profiles for the other bacterial species</title><p>We next investigated whether the <italic>n</italic>-SNPs of the other species also exhibit approximately power-law distributions, as observed in <italic>E. coli</italic>. <xref ref-type="fig" rid="fig11s1">Figure 11—figure supplement 1</xref> shows the reverse cumulative distributions of 2-SNPs, 3-SNPs, 4-SNPs, and 12-SNPs across all six species together with power-law fits. Although the curves often deviate substantially from simple straight lines, they all exhibit long tails and range over several orders of magnitudes, that is up to five orders of magnitude for 2-SNPs in <italic>S. enterica</italic>. Note that <italic>M. tuberculosis</italic> is again an exception. The total number of different <italic>n</italic>-SNP types is so small for this species that the <italic>n</italic>-SNP distributions are not well defined, suggesting again that this species is mostly if not completely clonal, and we will not further comment on its <italic>n</italic>-SNP statistics.</p><p><xref ref-type="fig" rid="fig11">Figure 11</xref> (left panel) shows the fitted exponents of the power-law distributions of <italic>n</italic>-SNPs as a function of <italic>n</italic> for all species. We see that the exponents generally increase with <italic>n</italic> indicating that the phylogenetic diversity generally increases as one moves further back in time, that is to larger <italic>n</italic>. Consistent with other observations, <italic>H. pylori</italic> shows the highest exponents, that is the highest diversity. It is also interesting that, while the exponents become roughly constant when <inline-formula><mml:math id="inf258"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula> for <italic>E. coli</italic>, <italic>H. pylori</italic> and <italic>S. aureus</italic>, <italic>B. subtilis</italic> and <italic>S. enterica</italic>, exhibit more complex patterns with sudden drops in exponent at particular values of <italic>n</italic>, suggesting more complex population structures at large <italic>n</italic> for these species.</p><fig-group><fig id="fig11" position="float"><label>Figure 11.</label><caption><title>Left panel: Exponents of the power-law fits to the <italic>n</italic>-SNP frequency distributions, as a function of the number of strains sharing a SNP <italic>n</italic> for each of the species (different colors).</title><p>Error bars correspond to 95% posterior probability intervals. Right panel: Mean entropy of the entropy profiles <inline-formula><mml:math id="inf259"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, averaged over all strains <italic>s</italic>, as a function of the number <italic>n</italic> of strains sharing the SNP, for each of the species (different colors). The error bars correspond to two standard-errors of the mean.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig11-v2.tif"/></fig><fig id="fig11s1" position="float" specific-use="child-fig"><label>Figure 11—figure supplement 1.</label><caption><title>Power-law fits of the <italic>n</italic>-SNP distributions for all six species.</title><p>Power-law fits of the <italic>n</italic>-SNP distributions for all six species. Each panel shows the reverse cumulative distributions of the frequencies of all observed 2-SNPs (blue dots), 3-SNPs (orange dots), 4-SNPs (green dots), and 12-SNPs (red dots), with the solid lines in corresponding colors showing power-law fits. The species is indicated at the top of each panel.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig11-figsupp1-v2.tif"/></fig><fig id="fig11s2" position="float" specific-use="child-fig"><label>Figure 11—figure supplement 2.</label><caption><title>Entropy profiles of all the strains for each of the six species.</title><p>Entropy profiles of all the strains for each of the six species. Each panel corresponds to one species (indicated at the top) and shows the entropy profiles <inline-formula><mml:math id="inf260"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of the distributions of <italic>n</italic>-SNPs in which a particular strain <italic>s</italic> occurs as a function of the number of strains <italic>n</italic> (different colors).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig11-figsupp2-v2.tif"/></fig><fig id="fig11s3" position="float" specific-use="child-fig"><label>Figure 11—figure supplement 3.</label><caption><title><italic>n</italic>-SNPs distributions and entropy profiles for the human data.</title><p><italic>n</italic>-SNPs distributions and entropy profiles for the human data. Left panel: Reverse cumulative distributions of the frequencies of all observed 2-SNPs (blue dots), 3-SNPs (orange dots), 4-SNPs (green dots), and 12-SNPs (red dots), with the solid lines in corresponding colors showing power-law fits, for the human data. Both axes are shown on a logarithmic scale. Middle panel: Fitted exponents for the power-law <italic>n</italic>-SNP distributions on the human data for <italic>n</italic> ranging from 1 to 30. The error bars correspond to 95% posterior probability intervals. Right panel: Entropy profiles of the <italic>n</italic>-SNP distributions for the individuals from the 1000 Genomes project. Individuals with African ancestry are in blue, European in green, South American in red, East Asian in cyan, and South Asian in magenta.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-fig11-figsupp3-v2.tif"/></fig></fig-group><p><xref ref-type="fig" rid="fig11s2">Figure 11—figure supplement 2</xref> shows the entropy profiles <inline-formula><mml:math id="inf261"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for all strains <italic>s</italic> in each of the species. Consistent with all other statistics, all entropies are low for the <italic>M. tuberculosis</italic> strains, further supporting that this species is predominantly clonal. With the exception of <italic>H. pylori</italic>, where the entropy profiles are quite similar for most strains, consistent with an almost ‘freely recombining’ population (<xref ref-type="bibr" rid="bib45">Suerbaum et al., 1998</xref>), all other species exhibit highly diverse entropy profiles across strains, showing that also in these other species almost every strain has a unique ‘fingerprint’ of frequencies with which its lineages recombine with the lineages of other strains. That is, the entropy profile analysis suggests that, in most species, population structure is complex, with highly heterogeneous recombination rates across the lineages of different strains.</p><p>Although the entropy rises quickly to values in the range <inline-formula><mml:math id="inf262"><mml:mrow><mml:mn>4</mml:mn><mml:mo>-</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math></inline-formula> for most strains, we also see strains for which the entropy only rises after <italic>n</italic> exceeds some fairly large value of <italic>n</italic>, for example at <inline-formula><mml:math id="inf263"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula> for some strains in <italic>H. pylori</italic>, and at <inline-formula><mml:math id="inf264"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>24</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf265"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>62</mml:mn></mml:mrow></mml:math></inline-formula> for some <italic>S. enterica</italic> strains. This suggests that the corresponding strains are part of clonal groups of very closely related strains. To summarize the entropy profiles of each species, the right panel of <xref ref-type="fig" rid="fig11">Figure 11</xref> shows the mean and standard-error of the entropy profiles, averaged over all strains, as a function of <italic>n</italic>. As for most other statistics, <italic>M. tuberculosis</italic> is an outlier whose strains generally only show low phylogenetic entropy. For all other species, the average entropy clearly increases as <italic>n</italic> increases, indicating again that the phylogenetic diversity increases further back in the past. For four of the six species, the mean entropy at large <italic>n</italic> falls in a narrow range between 7 and 8 bits, suggesting that the effective number of different ancestries far back in the past is relatively similar for these species.</p><p>Finally, for comparison we decided to also calculate these patterns on the human data. In particular, we extracted SNP data for chromosomes <inline-formula><mml:math id="inf266"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mn>12</mml:mn></mml:mrow></mml:math></inline-formula> for 2504 humans from the 1000 Genomes project (<xref ref-type="bibr" rid="bib1">1000 Genomes Project Consortium et al., 2015</xref>). <xref ref-type="fig" rid="fig11s3">Figure 11—figure supplement 3</xref> shows examples of the <italic>n</italic>-SNP distributions for human together with the fitted exponents for <italic>n</italic> ranging from 1 to 30, as well as the entropy profiles for the 40 randomly chosen individuals used previously in <xref ref-type="fig" rid="fig8">Figure 8</xref>. Apart from the 2-SNPs, which appear to show a biphasic pattern, all other <italic>n</italic>-SNP distributions in human are all well fit by power-law distributions. Moreover, for <inline-formula><mml:math id="inf267"><mml:mrow><mml:mi>n</mml:mi><mml:mo>≥</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> the exponents are almost constant around a value of 2.8. Interestingly, the entropy profiles of all 40 individuals quickly rise to around 10 bits. However, from that point onward the entropy profiles of individuals with African ancestry deviate from those of the other individuals, showing consistently higher entropy, confirming the well-known fact that African populations have higher genetic diversity. However, in contrast to what we observe for most bacterial species, the entropy profiles for individuals with the same geographic ancestry are all very similar. Among the bacterial species we studied, only <italic>H. pylori</italic> shows similar entropy profiles. In this respect it is noteworthy that previous studies have argued that <italic>H. pylori</italic> is almost freely recombining (<xref ref-type="bibr" rid="bib45">Suerbaum et al., 1998</xref>), and that the population structure that it exhibits in fact reflects the population structure of its human host (<xref ref-type="bibr" rid="bib15">Falush et al., 2003</xref>).</p></sec></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Despite the fact that complete bacterial genomes have been available for more than 20 years, we still lack a clear picture of the relative contributions of recombination and clonal evolution in shaping the observed sequence variation among strains of a bacterial species. In our view, a key problem is that previous methods for quantifying the role of recombination virtually all make specific simplifying assumptions about the underlying evolutionary dynamics. However, we do not know to what extent these assumptions hold and affect the conclusions. To address this problem, we have here developed new methods that avoid making specific assumptions about the evolutionary dynamics as much as possible. In particular, showing that almost all bi-allelic SNPs in the core genome alignment correspond to single mutations in the history of the coresponding positions, we showed several new ways in which these SNPs can be used to quantify phylogenetic structures and the role of recombination in genome evolution.</p><p>Our analysis shows that, for all but one of the species studied here, evolution of the core genome is almost entirely driven by recombination. Recombination is so common that for most pairs of strains none of the DNA in their pairwise alignment derives from their clonal ancestor. Although pairs of strains exist that are so closely related that most of their DNA was clonally inherited, even for such pairs the large majority of substitutions that separate them derive from recombination events. When considering the core genome alignment of a collection of roughly 100 strains, we found that each genomic locus has been overwritten many times by recombination in the history of the strains, that is hundreds if not more than a thousand times for <italic>E. coli</italic>. Consequently, few if any of the loci follow the clonal phylogeny, and we found that the core genome alignment fragments into many thousands of short segments with different phylogenies. Thus, approximating sequence evolution in the core genome as occurring along the branches of a fixed phylogenetic tree is clearly inappropriate.</p><p>One might infer from these results that the dynamics of genome evolution within a bacterial species could be better approximated as quasi-sexual with free recombination between lineages. However, as has been noted previously (<xref ref-type="bibr" rid="bib52">Yang et al., 2019</xref>), such an approximation is also inconsistent with the data. Strains do not appear roughly equidistant and phylogenies build from large numbers of genomic loci clearly converge to a well-defined phylogeny. We here argued that this clear phylogenetic structure reflects population structure, that is variation in the relative rates with which different lineages recombine. As a consequence of this population structure, the many different phylogenies that occur along the genome alignment are drawn from a highly non-uniform distribution, and the core genome phylogeny represents an effective average of this distribution of phylogenies.</p><p>These conclusions are clearly at odds with the prevailing view that, although <italic>E. coli</italic> is subject to substantial amounts of recombination, an overall phylogenetic backbone representing clonal relationships can still be identified (<xref ref-type="bibr" rid="bib46">Touchon et al., 2009</xref>; <xref ref-type="bibr" rid="bib9">Didelot et al., 2012</xref>; <xref ref-type="bibr" rid="bib4">Bobay et al., 2015</xref>; <xref ref-type="bibr" rid="bib8">Denamur et al., 2021</xref>), either by constructing a maximum-likelihood phylogeny from whole genome alignments (<xref ref-type="bibr" rid="bib46">Touchon et al., 2009</xref>; <xref ref-type="bibr" rid="bib11">Didelot and Wilson, 2015</xref>), or using more sophisticated approaches based on detecting loci that have not been affected by recombination (<xref ref-type="bibr" rid="bib9">Didelot et al., 2012</xref>; <xref ref-type="bibr" rid="bib6">Croucher et al., 2015</xref>), and inferring the clonal tree from those. If, as we are arguing, this prevailing view is mistaken, this raises the question why these previous approaches reached misleading conclusions. The answer is that these approaches rely on assumptions that do not apply. First, methods that aim to reconstruct the clonal phylogeny from a subset of positions that have not been affected by recombination are inherently problematic because our analysis shows that, for most species, such positions simply do not exist. An arguably more fundamental problem with previous analyses is that they assume recombination is completely random, that is without population structure. For example, the sophisticated ClonalFrame method (<xref ref-type="bibr" rid="bib10">Didelot and Falush, 2007</xref>), which has been used to reconstruct a clonal phylogeny of <italic>E. coli</italic> strains (<xref ref-type="bibr" rid="bib9">Didelot et al., 2012</xref>), uses a model in which along each branch of the clonal phylogeny a fraction of the loci is overwritten by recombination, while the rest is inherited clonally. However, instead of explicitly modeling recombination between lineages, it models the effects of recombination as simply introducing random substitutions at a fixed rate into the recombined segments. Consequently, recombination cannot introduce any phylogenetic structure by construction, and any phylogenetic structure evident in the data will thus be interpreted as reflecting clonal relationships. In short, a key problem with previous methods is that, by either explicitly or implicitly relying on models that assume that there is no population structure, the phylogenetic patterns resulting from population structure have been mistaken for clonal relationships. Note that this also implies that methods that aim to detect or quantify recombination by deviation from clonal phylogenies inferred by such methods are also fundamentally flawed.</p><p>Many studies have aimed to gain insight into bacterial genome evolution by simulating simple models of evolutionary dynamics, and comparing statistics in the resulting data with analogous statistics in real data. However, when these simple models make assumptions that do not hold in the real world, one may easily reach misleading conclusions. For example, a recent study used simulations of a simple genome evolution model with completely random recombination to conclude that, even which recombination is very frequent, phylogenies reconstructed from whole genome alignments can still correctly identify clonal relationships (<xref ref-type="bibr" rid="bib44">Stott and Bobay, 2020</xref>). This is not surprising because, as we just noted, when recombination is random any phylogenetic structure in the data can only reflect clonal relationships by construction. However, in the real world, recombination is not completely random, that is there is population structure.</p><p>To further support that phylogenetic structures in whole genome alignments reflect population structure, we also developed methods for quantifying this population structure in more detail. In particular, we showed that bi-allelic SNPs contain much information about the statistics of relative recombination rates across lineages. Whenever a particular <italic>n</italic>-SNP occurs in the alignment, the <italic>n</italic> strains sharing the SNP must occur as a clade in the phylogeny at that locus. Consequently, the relative frequencies of different <italic>n</italic>-SNP types reflect the relative frequencies with which different subsets of strains occur as clades across the phylogenies. We find that the frequencies of <italic>n</italic>-SNP types vary over 3–5 orders of magnitude and follow roughly power-law distributions. Notably, since the <italic>n</italic>-SNP distributions follow smooth long-tailed distributions that do not appear to have a characteristic scale, it is not possible to naturally subdivide subsets into highly and rarely recombining types. Rather, there seems to be a large continuum of relative rates, with population structure on all scales. Given that recombination rates vary over orders of magnitude across different lineages, the idea of an effective single recombination rate for a bacterial species might be misleading, and it thus seems problematic to fit the data to models that assume a constant rate of recombination within a species, for example (<xref ref-type="bibr" rid="bib47">Vos and Didelot, 2009</xref>; <xref ref-type="bibr" rid="bib30">Lin and Kussell, 2019</xref>).</p><p>Essentially, all population genetics and coalescent models start from assuming one or more populations of individuals that, for the purpose of the model, are exchangeable. However, our analysis of the entropy profiles and <italic>n</italic>-SNP statistics showed that, apart from some groups of extremely closely related strains that share a common ancestor before any recombination events occurred, almost every strain has its own distinct <italic>n</italic>-SNP statistics. In particular, virtually every strain <italic>s</italic> has a unique entropy profile <inline-formula><mml:math id="inf268"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of the distributions of frequencies with which it occurs in different clades of size <italic>n</italic>. This suggests that almost every strain has a unique pattern of relative recombination rates between its lineages and the lineages of the other strains. Consequently, models that start from populations of exchangeable individuals may be inappropriate by definition.</p><p>Given that models that assume either a single consensus tree, a fixed rate of recombination across strains, or exchangeable individuals, are all clearly at odds with the data on prokaryotic genome evolution, this raises the question of what would be an appropriate mathematical ‘null model’ that can capture the statistics that we observed here. In such a model, almost every lineage must have distinct rates of recombination with other lineages, these rates must vary over multiple orders of magnitude, and the model should reproduce the roughly power-law distributions of <italic>n</italic>-SNP frequencies, ideally with exponents that can be tuned by parameters in the model. It is currently unclear how to construct such a model.</p><p>Apart from the question of how to mathematically model the observed patterns, a second key question is what determines the highly variable relative rates of recombination across lineages. Just natural selection acts on mutations and thereby shapes the observed patterns of substitutions, selection also undoubtedly strongly acts on recombination events and shapes the recombination patterns that we detect in the core genome alignments. Indeed, strong selection on horizontal transfer events between two <italic>B. subtilis</italic> strains was recently observed in a laboratory evolution experiment (<xref ref-type="bibr" rid="bib39">Power et al., 2020</xref>). However, it is currently not clear to what extent the differences in observed recombination rates are shaped mainly by natural selection, for example that due to epistatic interactions only recombinant segments from other strains with similar ‘ecotypes’ are not removed by purifying selection, as suggested by some previous works (<xref ref-type="bibr" rid="bib43">Shapiro et al., 2012</xref>; <xref ref-type="bibr" rid="bib5">Cadillo-Quiroz et al., 2012</xref>), or that recombination rates may be set mostly by which lineages co-occur at the same geographical location. It is also conceivable that phages are a major source of transfer of DNA between strains, so that recombination rates may reflect the rates at which different lineages are infected by the same types of phages.</p><p>It is well-known that homologous recombination requires sufficient homology between the endpoints of the DNA fragment and the homologous segment in the host genome. Thus, recombination rates will intrinsically decrease with the nucleotide divergence between strains. An intriguing and theoretically attractive proposal is that relative recombination rates are simply set by sequence divergence and that bacterial species may essentially be defined by the collection of strains that are sufficiently close to allow efficient recombination (<xref ref-type="bibr" rid="bib13">Dixit et al., 2017</xref>). Previous studies have estimated that the rate of successful recombination decreases exponentially with nucleotide divergence (<xref ref-type="bibr" rid="bib48">Vulić et al., 1997</xref>; <xref ref-type="bibr" rid="bib36">Oliveira et al., 2016</xref>), and in <xref ref-type="bibr" rid="bib48">Vulić et al., 1997</xref> it was estimated that every 1% of sequence divergence leads to a roughly two-fold reduction in recombination efficiency. However, since most <italic>E. coli</italic> strains are within 1–3% sequence divergence, this would suggest less than 10-fold variability in the relative recombination rates across our strains, whereas the <italic>n</italic>-SNP statistics suggest a much larger range of relative recombination rates.</p><p>Finally, while we here studied the frequency distribution of <italic>n</italic>-SNP types as well as the entropies <inline-formula><mml:math id="inf269"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of the <italic>n</italic>-SNP distributions for each strain, it appears to us that this is just the tip of the iceberg of possible ways in which <italic>n</italic>-SNPs can be used to study the evolution of a set of strains from their core genome alignment. Our analyses indicate that prokaryotic genome evolution is driven by recombination that occurs at a very wide distribution of different rates between different lineages, and there is now a strong need for identifying what sets these rates, and the development of new mathematical tools and models that can accurately describe this kind of genome evolution.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Data</title><p>The <italic>E. coli</italic> sequences analyzed here can be accessed on NCBI Bioproject via the accession number PRJNA432505 (<xref ref-type="bibr" rid="bib24">Ishii et al., 2007</xref>; Field, 2020, in preparation). These genomes were sequenced with Illumina HiSeq 2000 technology. Samples were multiplexed, 24 per lane, producing 100 bp paired end reads which resulted in an average coverage depth of between 125x and 487x (with four strains over-represented at more than 1000x).</p><p>Genome sequences for all other species were downloaded from <ext-link ext-link-type="uri" xlink:href="http://ftp.ncbi.nlm.nih.gov/genomes/refseq/bacteria">http://ftp.ncbi.nlm.nih.gov/genomes/refseq/bacteria</ext-link>. The following two source data files contain accessing numbers for all the genomes used in this study.</p><p><xref ref-type="supplementary-material" rid="fig1sdata1">Figure 1—source data 1</xref>. Table with source data for <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>. <xref ref-type="supplementary-material" rid="fig7sdata1">Figure 7—source data 1</xref>. Table with source data for <xref ref-type="fig" rid="fig7">Figure 7</xref>.</p><p>In order to facilitate reproduction of the results presented here, we also provide a comprehensive collection of data files containing not only all raw genome sequences and the core genome alignments for each of the species, but also processed data files containing the results of the pairwise analysis and SNP statistics. These data files are available as object 10.5281/zenodo.4420880 from <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/4420880">https://zenodo.org/record/4420880</ext-link>.</p></sec><sec id="s4-2"><title>Core genome alignment and core tree</title><p>To build a core genome alignment for the SC1 strains, we used the Realphy tool (<xref ref-type="bibr" rid="bib3">Bertels et al., 2014</xref>) with default parameters and Bowtie 2 (<xref ref-type="bibr" rid="bib26">Langmead and Salzberg, 2012</xref>) for the alignments. The Illumina sequencing used to sequence the <italic>E. coli</italic> strains can still make sequencing errors at a certain rate and obtaining accurate base calls genome-wide relies on having sufficient read coverage at each position to confidently call the consensus nucleotide. We note that, in order to avoid sequencing errors, Realphy is quite conservative in its construction of the core genome alignment. In particular, in order for a position to be included each strain has to be represented, the coverage has to be at least 10 in each strain, and at least 95% of the reads from each strain have to agree on the nucleotide. A rough bound on the rate of sequencing errors can be obtained by noting that some of our strains are extremely closely related, that is while all 92 strains are unique in their full genome, there are only 82 unique core genomes. This means that there are 10 genomes that are identical in their core to another genome. Given that the length of the core alignment is <inline-formula><mml:math id="inf270"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mn>756</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mn>541</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, this means there were <inline-formula><mml:math id="inf271"><mml:mrow><mml:mn>10</mml:mn><mml:mo>×</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> nucleotides sequenced without a sequencing error and a simple Bayesian calculation shows that this implies that, with 99% posterior probability, the rate of sequencing errors is less than <inline-formula><mml:math id="inf272"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1.1</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>Realphy used PhyML (<xref ref-type="bibr" rid="bib19">Guindon et al., 2010</xref>) with parameters -m GTR -b 0 to infer trees from the whole and parts of the core alignment. The tree visualizations were made using the Figtree software (<xref ref-type="bibr" rid="bib40">Rambaut, 2018</xref>).</p></sec><sec id="s4-3"><title>Analysis of core alignment blocks</title><p>For each 3 kb block of the core alignment, we used PhyML using the option -c one to infer a phylogeny while restricting the number of relative substitution rate categories to one. Furthermore, to calculate the log-likelihood of a given 3 kb block under the tree topologies of other blocks, we reran PhyML using the -o ’lr’ option, which only optimizes the branch lengths as well as the substitution rate parameters but does not alter the topology of the phylogeny.</p></sec><sec id="s4-4"><title>Pairwise analysis and mixture modeling</title><p>For each pair of strains we slide a 1 kb window over the core genome alignment of the pair, shifting by 100 bp at a time, and build a histogram of the number of SNPs per kilobase by counting the number of SNPs in each window. That is, we obtain the distribution <inline-formula><mml:math id="inf273"><mml:msub><mml:mi>P</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> of the fraction of 1 kb windows that have <italic>n</italic> SNPs. We then assumed that the one kilobase blocks can be separated into a fraction <italic>f</italic><sub><italic>a</italic></sub> of ‘ancestral blocks’, that is regions that were inherited from the clonal ancestor of the pair, and a fraction <inline-formula><mml:math id="inf274"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> that have been recombined since the pair diverged from a common ancestor. Although in previous work a simple ad hoc scheme was used in which it was assumed that blocks with less than a particular number of SNPs are ancestral and blocks with more SNPs are recombined (<xref ref-type="bibr" rid="bib12">Dixit et al., 2015</xref>), we found that this approach is not satisfactory and results significantly depend on the cut-off chosen.</p><p>We thus decided to employ a more principled mixture model approach. For the ancestral regions, the number of SNPs per kilobase should follow a simple Poisson distribution <inline-formula><mml:math id="inf275"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo lspace="0pt" rspace="3.5pt">!</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, with <italic>μ</italic> the expected number of mutations per block. For the recombined regions, we note that these regions themselves will consist of mosaics of sub-regions that have been recombined previously. Consequently, the recombined regions will consist of a mixture of Poisson distributions with different rates. It is well-known that mixtures of Poisson distributions with rates that are (close to) Gamma-distributed follow a negative binomial distribution and we found empirically that negative binomial distributions give excellent fits to the observed SNP distributions in our data. For the recombined regions, we thus assume a negative binomial distribution of the form<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo lspace="0pt" rspace="3.5pt">!</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mi>λ</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>α</mml:mi></mml:msup></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf276"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>λ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf277"><mml:mrow><mml:mi>α</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> are parameters of the distribution. We thus fit the observed distribution of SNPs per block <inline-formula><mml:math id="inf278"><mml:msub><mml:mi>P</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> using the following mixture:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mi>n</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>n</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <italic>f</italic><sub><italic>a</italic></sub> is the fraction of the genome that is inherited from the clonal ancestor. Fits were obtained using maximum likelihood. While expectation maximization was used to optimize the parameters <italic>f</italic><sub><italic>a</italic></sub>, <italic>μ</italic>, and <italic>λ</italic>, a grid search was employed to find the optimal dispersion parameter <italic>α</italic>.</p><p>Note that, in terms of the fitted parameters, the total number of mutations in ancestral blocks is <inline-formula><mml:math id="inf279"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, and the number of mutations in recombined blocks is <inline-formula><mml:math id="inf280"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>To estimate the lengths of recombination events, we first extracted pairs that are sufficiently close (divergence less than 0.002) such that multiple overlapping recombination events are unlikely. We then used a two-state HMM with the same two components, that is a Poisson and a negative binomial component corresponding to ancestral and recombined segments, and having fixed transition rates from the ancestral to the recombined state and vice versa, to parse the pairwise alignment into ancestral and recombined segments. Note that the parameters of the HMM are fitted separately for each pair of strains. For each pair, we took as recombined segments those contiguous stretches that were assigned to the recombined state by the HMM.</p><p>We define mostly clonal pairs as pairs with more than 90% of the alignment classified as ancestral, fully recombined pairs as pairs with less than 10% of the alignment classified as ancestral, and all other pairs as transition pairs. In order to estimate the critical divergence at which half of the genome is recombined we fit a linear model to the observed relationship between divergence and clonal fraction in all transition pairs, and define the critical divergence as the divergence at which the linear fit has a clonal fraction of 50%. To calculate the fraction of mutations that derive from recombined segments at the critical divergence, we compute the fraction of mutations in recombined segments for all transition pairs (using the results from the mixture model) and fit a linear model to the observed dependence between the ancestral fraction an the fraction of mutations in recombined segments. We then define the fraction of mutations in recombined regions at the critical divergence as the fraction of mutations in the linear fit when the ancestral fraction is 50%.</p></sec><sec id="s4-5"><title>Simulated data sets</title><p>In order to simulate genome evolution under a simple evolutionary model that includes drift, mutation, and recombination, we developed new software (manuscript in preparation) based on general purpose GPU programming (GPGPU), which is available from <ext-link ext-link-type="uri" xlink:href="https://github.com/thomsak/GPUprokEvolSim">https://github.com/thomsak/GPUprokEvolSim</ext-link> (<xref ref-type="bibr" rid="bib42">Sakoparnig, 2021</xref>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:48718e01b2d55d6e0dd6cac46f58d8dbeec71912;origin=https://github.com/thomsak/GPUprokEvolSim;visit=swh:1:snp:7ff4e662878c10ceccc4cc7ca2e27e35f797f0b9;anchor=swh:1:rev:ed15c4b013068d684874c3d7c9d710e289e3f31c/">swh:1:rev:ed15c4b013068d684874c3d7c9d710e289e3f31c</ext-link>). Our software explicitly simulates the evolution of a population of <italic>N</italic> DNA sequences of length <inline-formula><mml:math id="inf281"><mml:msub><mml:mi>L</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math></inline-formula> using a Wright-Fisher model with non-overlapping generations. In order to be able to not only evolve the sequences, but also track recombination events occurring along the clonal history of a sample of <italic>S</italic> genomes from the population of <italic>N</italic>, we proceed as follows.</p><p>The evolution of the <italic>N</italic> genomes is simulated for <inline-formula><mml:math id="inf282"><mml:mrow><mml:mn>8</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> generations. First, a ‘guide’ clonal history for the sample of <italic>S</italic> sequences is determined using the Kingman coalescent (<xref ref-type="bibr" rid="bib49">Wakeley, 2008</xref>) for <italic>S</italic> individuals within the population of <italic>N</italic>. In particular, for the subset of <italic>S</italic> genomes, their ancestry is determined for <inline-formula><mml:math id="inf283"><mml:mrow><mml:mn>8</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> generations into the past. Notably, because the <italic>S</italic> sequences will have a common ancestor much more recently than <inline-formula><mml:math id="inf284"><mml:mrow><mml:mn>8</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> generations in the past, for many of these generations there will only be a single ancestor.</p><p>We then simulate <inline-formula><mml:math id="inf285"><mml:mrow><mml:mn>8</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> generations of the evolution of <italic>N</italic> genomes of length <inline-formula><mml:math id="inf286"><mml:msub><mml:mi>L</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math></inline-formula> forward in time by iterating:</p><list list-type="order"><list-item><p>For each individual corresponding to an ancestor from the clonal phylogeny of the sample of <italic>S</italic> genomes, its parent in the previous generation is chosen according to the guide clonal phylogeny. For each other individual, a random parent is chosen from the previous population of <italic>N</italic> individuals.</p></list-item><list-item><p>For each individual of the new generation, the genome of the ancestor is copied, scanned from left to right, and at each position a recombination event is initiated with probability ρ. If a recombination is chosen to occur at position <italic>i</italic>, one of the <inline-formula><mml:math id="inf287"><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> other members of the population is chosen at random, and the section of its genome from position <inline-formula><mml:math id="inf288"><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf289"><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is copied into the current genome. After this, each position in the genome is mutated with probability μ. The target nucleotide is chosen randomly using a transition-transversion ratio of 3-to-1.</p></list-item></list><p>Apart from tracking the <italic>N</italic> genome sequences, we also track, for each branch of the clonal phylogeny of the <italic>S</italic> individuals, how many times each position was overwritten by recombination during the evolution along the branch. This allows us to calculate what fraction of positions are inherited clonally along each branch, how many times each position in the final alignment of <italic>S</italic> genomes was overwritten by recombination during its clonal history, and what fraction of positions was clonally inherited for each pair of strains.</p><sec id="s4-5-1"><title>Parameter settings</title><p>To keep the simulations computationally feasible, we simulated a population of <inline-formula><mml:math id="inf290"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>3600</mml:mn></mml:mrow></mml:math></inline-formula> individuals. To make the simulations directly comparable with the data from <italic>E. coli</italic>, we focused on samples of <inline-formula><mml:math id="inf291"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula> individuals, used a genome size of <inline-formula><mml:math id="inf292"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mn>560</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> bp, and used a size of <inline-formula><mml:math id="inf293"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mn>12</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> bp for the recombined fragments. Note that this length of recombined fragments is toward the lower range of the sizes of recombined fragments estimated from close pairs of <italic>E. coli</italic> strains. For a Kingman coalescent, the expected fraction of columns that is not polymorphic in an alignment of <italic>S</italic> individuals is given by<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:munderover><mml:mfrac><mml:mi>k</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>and we set <italic>μ</italic> such that this fraction is 0.9, that is similar to what is observed for the alignment of <italic>E. coli</italic> strains. In particular we set <inline-formula><mml:math id="inf294"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>3.28</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> so that <inline-formula><mml:math id="inf295"><mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.012</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>Finally, apart from simulations without recombination, that is <inline-formula><mml:math id="inf296"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, we performed simulations with six different recombination rates, corresponding to ratios of recombination to mutation of <inline-formula><mml:math id="inf297"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf298"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf299"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf300"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf301"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf302"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>, that is covering four orders of magnitude. Note that the clonal phylogeny for the subset of <italic>S</italic> strains was created once, and then used in all simulations with different recombination rates to facilitate direct comparisons.</p></sec></sec><sec id="s4-6"><title>Estimating the fraction of SNPs that correspond to single substitution events</title><p>Our analyses assume that bi-allelic SNPs correspond to single substitution events in the evolutionary history of the genomic position. This assumption may break down due to apparent SNPs caused by sequencing errors, as well as due to homoplasies, that is bi-allelic columns for which more than one substitution event occurred. We here estimate the frequency of both types of events.</p><sec id="s4-6-1"><title>SNPs due to sequencing errors are negligible</title><p>Above we estimated, from the fact that we observe 10 strains that are identical in their core genome to another strain, that the rate of sequencing errors is at most <inline-formula><mml:math id="inf303"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1.1</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. Using this, we expect a sequencing error to occur in at most <inline-formula><mml:math id="inf304"><mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>92</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>28</mml:mn></mml:mrow></mml:math></inline-formula> of the columns of our length <inline-formula><mml:math id="inf305"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mn>756</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mn>541</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> core genome alignment. Note that, because the fraction of columns with more than one sequencing error is negligible, all these sequencing errors will produce a mutant nucleotide in only one strain, because the expected number of columns with two sequencing errors is negligible. Thus, if a sequencing error occurs in a column that is otherwise non-polymorphic, it will create a bi-allelic SNP in which only one strain carries a differing base and such SNPs do not affect any of the phylogenetic analyses. Thus, sequencing errors affecting the phylogenetic analysis only occur when the sequencing error occurs in a SNP column, and creates one of the two nucleotides that already existed. Since only about 10% of columns are polymorphic, the expected number of SNP columns that are informative for phylogeny and affected by sequencing errors is at most <inline-formula><mml:math id="inf306"><mml:mrow><mml:mrow><mml:mn>28</mml:mn><mml:mo>/</mml:mo><mml:mn>10</mml:mn></mml:mrow><mml:mo>=</mml:mo><mml:mn>2.8</mml:mn></mml:mrow></mml:math></inline-formula>. Given that there are <inline-formula><mml:math id="inf307"><mml:mrow><mml:msup><mml:mn>247</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mn>822</mml:mn></mml:mrow></mml:math></inline-formula> phylogeny informative SNPs in total, the expected fraction of these that are affected by sequencing errors is roughly <inline-formula><mml:math id="inf308"><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>.</p></sec><sec id="s4-6-2"><title>Estimating the rate of homoplasy</title><p>The relatively low frequency of SNPs and the fact that almost all SNPs are bi-allelic strongly suggests that almost all bi-allelic SNPs correspond to single substitution events in the evolutionary history of the position. Here, we use a simple substitution model to estimate the fraction of bi-allelic SNPs that correspond to multiple substitution events, that is homoplasies. To do this, we will analyze the observed frequencies of columns with 1, 2, 3, and 4 different nucleotides under a simple substitution model. Note that, in this simple model we assume that all substitutions are neutral, so that there is essentially no difference between mutations and substitutions. In the real data some mutations are deleterious and some of these are removed by purifying selection, leading to lower rates of substitutions at some positions than at others. Indeed, for our core genome alignment of <italic>E. coli</italic> strains, we observed that SNPs occur almost 10 times more frequently at synonymous sites than at second positions in codons. To assess the effects of selection, we will fit our model to the frequencies of columns with 1, 2, 3, and 4 different nucleotides both for the subset of positions that should be under relatively little selection, that is third positions in fourfold degenerate codons, and positions that should be under relatively strong selection, that is second positions in codons. Since a large fraction of all SNPs corresponds to SNPs in which the outgroup of nine strains has a nucleotide that differs from the nucleotide of all other strains, we will also fit the model separately for all strains, and all strains minus the nine strains of the outgroup.</p><p>We will consider the following simple model for the substitutions in a single alignment column. Note that, because the phylogeny may change across positions in the alignment, the sum of the length of the branches of the phylogeny at a given position will vary from position to position. Let <italic>μ</italic> denote the product of the substitution rate times the total length of the branches in the phylogeny at the position of interest. The variable <italic>μ</italic> thus corresponds to the expected number of substitutions in the evolutionary history of this position. The probability that <italic>n</italic> substitutions took place at this position is then given by a Poisson distribution:<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:msup><mml:mi>μ</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mrow><mml:mi>n</mml:mi><mml:mo lspace="0pt" rspace="3.5pt">!</mml:mo></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>and each of these substitutions is equally likely to occur anywhere on the branches of the phylogeny.</p><p>We want to calculate the probability <inline-formula><mml:math id="inf309"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, that if <italic>n</italic> substitutions occurred along the phylogeny, that <italic>d</italic> different nucleotides will occur at the leaves. Clearly, if no substitutions occurred, there will be only one nucleotide, so that <inline-formula><mml:math id="inf310"><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="inf311"><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> the Kronecker delta function. Also, if one substitution occurred, then we know there must be two nucleotides occuring at the leaves, that is one nucleotide in all leaves downstream of the branch in which the substitution occurred, and one other nucleotide at all other leaves, that is <inline-formula><mml:math id="inf312"><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. However, when two or more substitutions occur, the situation is more complicated. Let α denote the ancestral nucleotide and assume that the first substitution mutated α to β. The second substitution either occurs in one of the branches carrying the ancestral nucleotide α, or in one of the branches carrying β. To remain at <inline-formula><mml:math id="inf313"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> nucleotides, one has to either have another substitution <inline-formula><mml:math id="inf314"><mml:mrow><mml:mi>α</mml:mi><mml:mo>→</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:math></inline-formula>, or a substitution <inline-formula><mml:math id="inf315"><mml:mrow><mml:mi>β</mml:mi><mml:mo>→</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:math></inline-formula>. In all other cases the number of nucleotides will increase to 3.</p><p>Under this simple model, we can calculate the general probabilities <inline-formula><mml:math id="inf316"><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>d</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> that, if there are currently <italic>d</italic> different nucleotides and another substitution is added, that there will be <inline-formula><mml:math id="inf317"><mml:msup><mml:mi>d</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> different nucleotides after the substitution. These probabilities depend on the relative probability for transitions and transversions to occur and we will assume that transitions are <italic>r</italic> times as likely to occur as transversions. Besides having <inline-formula><mml:math id="inf318"><mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, we find that <inline-formula><mml:math id="inf319"><mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf320"><mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf321"><mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf322"><mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf323"><mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. All other transition probabilities are zero.</p><p>Starting from a single nucleotide in the column, the probability <inline-formula><mml:math id="inf324"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to end up with <italic>d</italic> different nucleotides after <italic>n</italic> mutations is given by the <italic>n</italic>-th power of the transition matrix <italic>T</italic>, that is <inline-formula><mml:math id="inf325"><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi>T</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. From this, we can work out the probability <inline-formula><mml:math id="inf326"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to end up with <italic>d</italic> different nucleotides as a function of the expected number of mutations μ as<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:munderover><mml:mrow><mml:msup><mml:mi>T</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mfrac><mml:msup><mml:mi>μ</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mrow><mml:mi>n</mml:mi><mml:mo lspace="0pt" rspace="3.5pt">!</mml:mo></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>which can be easily numerically evaluated to sufficient precision.</p><p>Assume we observe <italic>c</italic><sub><italic>d</italic></sub> columns with <italic>d</italic> different nucleotides, with <italic>d</italic> running from 1 to 4. The log-likelihood of this count data given <italic>μ</italic> is<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>4</mml:mn></mml:munderover><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>and by maximizing this log-likelihood with respect to <italic>μ</italic> (numerically), we obtain an estimate <inline-formula><mml:math id="inf327"><mml:msub><mml:mi>μ</mml:mi><mml:mo>*</mml:mo></mml:msub></mml:math></inline-formula> given the counts <italic>c</italic><sub><italic>d</italic></sub>. Finally, given <inline-formula><mml:math id="inf328"><mml:msub><mml:mi>μ</mml:mi><mml:mo>*</mml:mo></mml:msub></mml:math></inline-formula>, the fraction <italic>f</italic><sub><italic>h</italic></sub> of homoplasies, that is bi-allelic SNPs that correspond to multiple substitutions, is given by the fraction of all columns for which <inline-formula><mml:math id="inf329"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> but <inline-formula><mml:math id="inf330"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. This fraction is given by<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mo>*</mml:mo></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mo>*</mml:mo></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mo>*</mml:mo></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="table" rid="table1">Table 1</xref> shows the estimated expected number of mutations per column <inline-formula><mml:math id="inf331"><mml:msub><mml:mi>μ</mml:mi><mml:mo>*</mml:mo></mml:msub></mml:math></inline-formula> and the estimated fraction of homoplasies <italic>f</italic><sub><italic>h</italic></sub> for the five different subsets of columns, using a transition-to-transversion ratio of <inline-formula><mml:math id="inf332"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>. We see that the fraction <italic>f</italic><sub><italic>h</italic></sub> is at most 6.3% and less than 1% for second positions in codons.</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Estimated expected number of mutations per position <inline-formula><mml:math id="inf333"><mml:msub><mml:mi>μ</mml:mi><mml:mo>*</mml:mo></mml:msub></mml:math></inline-formula> and estimated fraction of homoplasies for five different subsets of core alignment columns: all columns, all synonymous positions (third positions in fourfold degenerate codons), second positions in codons, synonymous positions excluding the outgroup, and second positions in codons excluding the outgroup.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Column set</th><th><inline-formula><mml:math id="inf334"><mml:msub><mml:mi>μ</mml:mi><mml:mo>*</mml:mo></mml:msub></mml:math></inline-formula></th><th><italic>f</italic><sub><italic>h</italic></sub></th></tr></thead><tbody><tr><td>All columns</td><td>0.118</td><td>0.026</td></tr><tr><td>Synonymous positions</td><td>0.287</td><td>0.063</td></tr><tr><td>Second positions in codons</td><td>0.0258</td><td>0.006</td></tr><tr><td>Synom. pos. without outgroup</td><td>0.149</td><td>0.033</td></tr><tr><td>Sec. pos. without outgroup</td><td>0.0172</td><td>0.004</td></tr></tbody></table></table-wrap><p>In addition, <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> shows a comparison of the observed and predicted frequencies of columns with 1, 2, 3, and 4 letters. Since effects of selection are likely least for the synonymous positions, we expect the simple model to fit the data best and we indeed observe that, for the synonymous positions, the simple model can reasonably accurately fit the observed frequencies, and even for the set of all alignment columns the fits are quite accurate (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). In contrast, for the second positions in codons, we can see the effects of selection in that, from the larger fractions of columns without SNPs, the model infers a lower <inline-formula><mml:math id="inf335"><mml:msub><mml:mi>μ</mml:mi><mml:mo>*</mml:mo></mml:msub></mml:math></inline-formula>, and this leads to an underestimation of columns with four nucleotides. Thus, the true fraction <italic>f</italic><sub><italic>h</italic></sub> is more likely close to the values inferred from the synonymous positions. Note that <inline-formula><mml:math id="inf336"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.063</mml:mn></mml:mrow></mml:math></inline-formula> when including the outgroup and <inline-formula><mml:math id="inf337"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.033</mml:mn></mml:mrow></mml:math></inline-formula> when the outgroup is excluded. The difference between these two estimates derives from the very high fraction of SNP columns in which the 9 strains of the outgroup have another nucleotide than all other strains. For this subset of SNPs, the fraction of columns that have more than one mutation is much higher than for any other SNP column. Thus, for all other SNP columns, the estimate that a fraction of 3.3% correspond to homoplasies is likely the most accurate. For completeness, we provide the full statistics of the observed polymorphisms in <xref ref-type="table" rid="table2">Table 2</xref>.</p><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>Detailed statistics on the polymorphisms in the whole core genome alignment, at synonymous positions (third positions in fourfold degenerate codons) and at second codon positions (where all substitutions are non-synonymous).</title><p>First, for each set of positions the table lists the total number of positions, and the number of positions at which 1, 2, 3 or 4 different nucleotides appear. Second, for the subset of positions where two nucleotides appear, the table lists the total number of transitions and transversions, and the number of positions with each of the six possible two-nucleotide subsets.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Statistic</th><th>All columns</th><th>Synom. codon pos.</th><th>Sec. codon pos.</th></tr></thead><tbody><tr><td>Total columns</td><td>2,880,516</td><td>349,311</td><td>960,172</td></tr><tr><td>1-letter columns</td><td>2,484,831</td><td>299,536</td><td>936,588</td></tr><tr><td>2-letter columns</td><td>363,164</td><td>46,807</td><td>22,505</td></tr><tr><td>3-letter columns</td><td>30,611</td><td>2838</td><td>1029</td></tr><tr><td>4-letter columns</td><td>1910</td><td>130</td><td>50</td></tr><tr><td>Transitions</td><td>275,134</td><td>36,866</td><td>13,420</td></tr><tr><td>Transversions</td><td>88,030</td><td>9941</td><td>9085</td></tr><tr><td>A ↔ G</td><td>138,728</td><td>21,767</td><td>6676</td></tr><tr><td>C ↔ T</td><td>136,406</td><td>15,099</td><td>6744</td></tr><tr><td>G ↔ T</td><td>23,679</td><td>2198</td><td>963</td></tr><tr><td>A ↔ C</td><td>23,636</td><td>3294</td><td>3510</td></tr><tr><td>A ↔ T</td><td>21,036</td><td>2416</td><td>2549</td></tr><tr><td>C ↔ G</td><td>19,679</td><td>2033</td><td>2063</td></tr></tbody></table></table-wrap><p>As an additional test, we also applied this simple method to estimate the rate of homoplasy for the simulation data. For the simulation data without recombination we explicitly kept track of homoplasies and determined that a fraction <inline-formula><mml:math id="inf338"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.0256</mml:mn></mml:mrow></mml:math></inline-formula> of bi-allelic positions correspond to homoplasies. Applying our estimation method to the alignment of the <inline-formula><mml:math id="inf339"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula> sample genomes from this simulation, we estimated <inline-formula><mml:math id="inf340"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.0243</mml:mn></mml:mrow></mml:math></inline-formula>, which is within 2% of the true value, further supporting our method for estimating the homoplasy rate.</p><p>In summary, our estimates strongly suggest that the rate of homoplasies among bi-allelic SNPs in our core genome alignment of the <italic>E. coli</italic> strains lies somewhere in the range of 2-6%.</p></sec></sec><sec id="s4-7"><title>Removing potentially homoplasic positions from the core genome alignment</title><p>Even though the analysis of the previous section has shown that homoplasies are only a very small fraction of all bi-allelic SNPs, we decided to investigate to what extent this small fraction of homoplasies may affect the various statistics that we calculate. Ideally, if we knew which alignment columns correspond to homoplasies, we could simply remove all homoplasic columns and recalculate all statistics of interest on the reduced alignment from which these homoplasic sites were removed. However, since we only know the approximate fraction <italic>f</italic><sub><italic>h</italic></sub> of homoplasies and do not know which columns are homoplasies, a conservative approach is to remove those columns that are most phylogenetically inconsistent with other columns in their neighborhood.</p><p>In particular, for each bi-allelic SNP <italic>s</italic> in the alignment, we check its phylogenetic consistency with the nearest 200 SNP columns to the left and nearest 200 SNP columns to the right, that is its consistency with others SNPs within a roughly 4 kb region. We then assign each SNP column an inconsistency score <inline-formula><mml:math id="inf341"><mml:msub><mml:mi>I</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> corresponding to the fraction of the 400 neighboring columns that are phylogenetically inconsistent with it. We then sort all SNP columns by their inconsistency <inline-formula><mml:math id="inf342"><mml:msub><mml:mi>I</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> and remove a fraction <italic>f</italic> of SNP columns with the highest inconsistency. After this, we can recalculate all statistics of interest on the alignment from which these potentially homoplasic columns have been removed. In particular, we generated reduced alignments from which a fraction <inline-formula><mml:math id="inf343"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula> and a fraction of <inline-formula><mml:math id="inf344"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> of most inconsistent columns were removed.</p></sec><sec id="s4-8"><title>Constructing a tree that maximizes the number of compatible SNPs</title><p>We classify all SNPs in the core genome alignment into <italic>SNP types</italic> as follows. For each bi-allelic SNP, we map all letters with the majority nucleotide to a 0 and the minority nucleotide to a one and sort the bits according to the alphabetic order of the strain names. For SNPs where one allele occurs in exactly half of the strains the minority allele is not defined and the ambiguity is resolved by setting the first bit of the string to 0. In this way, each SNP is mapped to a binary sequence of length 92. This binary sequence defines the SNP type. Note that a SNP type corresponds to a particular bi-partition of the strains.</p><p>We next counted the number of occurrences <italic>n</italic><sub><italic>t</italic></sub> of each SNP type <italic>t</italic> and sorted the SNP types from most to least common. We then used the following greedy algorithm to a collect a subset <italic>T</italic> of mutually compatible SNP types that accounts for as many SNPs as possible. We seed <italic>T</italic> with the most common SNP type, that is the SNP type occurring at the top of the list. We then go down the list of SNP types, iteratively adding SNP types <italic>t</italic> to the set <italic>T</italic> that are compatible with all previous types in the set <italic>T</italic>.</p></sec><sec id="s4-9"><title>Bottom up tree building</title><p>In this procedure, we build phylogenies of subclades in a bottom-up manner, starting from the full set of 92 strains and iteratively fusing pairs, minimizing the number of incompatible SNPs at each step.</p><p>For any subset of strains <italic>S</italic>, we define the number of supporting SNPs <inline-formula><mml:math id="inf345"><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:math></inline-formula> as the number of SNPs that fall on the branch between the subset <italic>S</italic> and the other strains, that is the number of SNPs in which all strains in <italic>S</italic> have one letter, and all other strains another letter. Similarly, we define the number of clashing SNPs <inline-formula><mml:math id="inf346"><mml:msub><mml:mi>c</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:math></inline-formula> as the number of SNPs that are incompatible with the strains in <italic>S</italic> forming a subclade in the tree.</p><p>The iterative merging procedure is initiated with each of the 92 strains forming a subclade <italic>S</italic>. At each step of the iteration we calculate, for each pair of existing subclades <italic>S</italic><sub>1</sub>, <italic>S</italic><sub>2</sub>, the number of clashing SNPs <inline-formula><mml:math id="inf347"><mml:msub><mml:mi>c</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:math></inline-formula> and supporting SNPs <inline-formula><mml:math id="inf348"><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:math></inline-formula> for the set of strains <inline-formula><mml:math id="inf349"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∪</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> consisting of the union of the strains in <italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub>. We then merge the pair <inline-formula><mml:math id="inf350"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> that minimizes the clashes <inline-formula><mml:math id="inf351"><mml:msub><mml:mi>c</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:math></inline-formula> and, when their are ties, maximizes the number of supporting SNPs <inline-formula><mml:math id="inf352"><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:math></inline-formula>. At each step of the calculation, we keep track of the total number of SNPs on the branches of the subtrees build so far, as well as the total number of SNPs that are inconsistent with the subtrees build so far. In addition, we calculate the average pairwise divergences of the strains within the subclades. <xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4</xref> shows the ratio of clashing to supporting SNPs as a function of the divergence within the subclades.</p></sec><sec id="s4-10"><title>Quartet analysis</title><p>Quartets were assembled in the following way. We construct a grid of target distances <italic>d</italic> starting at 0.00001 and having 50 points with 0.0005 sized distance. For every target distance <italic>d</italic>, we scan the alignment for four strains which have all pairwise distances within 1.25-fold of distance <italic>d</italic>. Every target distance <italic>d</italic> for which no quartet can be found fulfilling these criteria is ignored.</p><p>For each quartet, we extract all SNP columns where two strains have a specific nucleotide and the other two strains have another nucleotide. Every such SNP column unambiguously supports one out of three possible tree topologies for this quartet. For each quartet, we determine which topology has the largest number of supporting SNPs, and what the fraction of SNPs is that support this topology.</p></sec><sec id="s4-11"><title>Linkage disequilibrium measure</title><p>A standard measure of linkage disequilibrium of SNPs at a given distance is given by the average squared-correlation of the genotypes at these positions (<xref ref-type="bibr" rid="bib29">Lewontin, 1988</xref>). For a pair of loci with bi-allelic SNPs there are four possible genotypes which we indicate as binary patterns 00, 01, 10, and 11. If the frequencies of these genotypes are <italic>f</italic><sub>00</sub>, <italic>f</italic><sub>01</sub>, <italic>f</italic><sub>10</sub>, and <italic>f</italic><sub>11</sub>, then the squared correlation is calculated as<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mrow><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>.0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>.1</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where the variables with dots correspond to marginal probabilities, for example <inline-formula><mml:math id="inf353"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf354"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>.1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and so on.</p></sec><sec id="s4-12"><title>Distribution of tree-compatible stretches</title><p>To calculate the distribution of the number of consecutive tree-compatible SNPs, we start from each SNP <italic>s</italic> in the core genome alignment and count the number <italic>n</italic><sub><italic>s</italic></sub> of SNP columns immediately following <italic>s</italic>, until a SNP column occurs that is incompatible with at least one of the <italic>n</italic><sub><italic>s</italic></sub> SNP columns. Similarly, to obtain the distribution of the number of consecutive tree-compatible nucleotides we start from each position <italic>p</italic> in the core genome alignment and count the number <italic>n</italic><sub><italic>p</italic></sub> of consecutive nucleotides until a SNP column occurs that is incompatible with at least one of the SNP columns among the <italic>n</italic><sub><italic>p</italic></sub> nucleotides.</p></sec><sec id="s4-13"><title>Minimum number of phylogeny changes <italic>C</italic></title><p>We iterate over all SNP columns along the core genome alignment and add the current SNP to a list if it is pairwise compatible with all SNPs currently in the list. If it is incompatible with at least one SNP in this list, we empty the list, re-initialize the list with the current SNP, and increase the phylogeny counter <italic>C</italic> by one.</p></sec><sec id="s4-14"><title>Phylogenies of human genome sequences</title><p>We selected 40 individuals at random from the 1000 Genome project (<xref ref-type="bibr" rid="bib1">1000 Genomes Project Consortium et al., 2015</xref>) and build a ‘core tree’ by applying PhyML to the sequences of chromosomes 1 through 12. To investigate the robustness of this core tree, we cut the alignment in 1000 bp blocks and did 100 random resamplings of half of the blocks, building a phylogeny for each resampling using PhyML. We then determined the fraction of times each split in the core tree occurred in the trees of the 100 resamplings.</p></sec><sec id="s4-15"><title>Power-law fits of <italic>n</italic>-SNP distributions</title><p>We extract each <italic>n</italic>-SNP from the core genome alignment and count the frequency, that is the number of occurrences, <italic>f</italic><sub><italic>t</italic></sub> of each <italic>n</italic>-SNP type <italic>t</italic> as well as the total number <italic>T</italic> of <italic>n</italic>-SNP types that occur at least once. We assume the <italic>n</italic>-SNP type occurrences are drawn from a power-law of the form<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf355"><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the Riemann zeta function defined by<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mrow><mml:mrow><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:munderover><mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The log-likelihood of the frequencies <italic>f</italic><sub><italic>t</italic></sub> as a function of α is given by<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mrow><mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>t</mml:mi></mml:munder><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf356"><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:math></inline-formula> is the average of the logarithm of the SNP-type frequencies. Using a uniform prior on <italic>α</italic>, the posterior distribution of <italic>α</italic> is simply proportional to the likelihood function. The optimal exponent <inline-formula><mml:math id="inf357"><mml:msub><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msub></mml:math></inline-formula> is the solution of<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>ζ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>To calculate error-bars on the fitted exponentials we approximate the posterior by a Gaussian by expanding the log-likelihood to second order around the optimal exponent <inline-formula><mml:math id="inf358"><mml:msub><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msub></mml:math></inline-formula>. We then find for the standard-deviation of the posterior distribution:<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>σ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mi>T</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>ζ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>ζ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msqrt></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p></sec><sec id="s4-16"><title>Entropy profiles of <italic>n</italic>-SNP distributions</title><p>For a given strain <italic>X</italic>, we first extract all SNP types <italic>t</italic> for which <italic>X</italic> is one of the strains that shares the minority nucleotide. We then further stratify these SNP types by the number of strains <italic>n</italic> sharing the minority nucleotide. For each <italic>n</italic>, we thus obtain a set <inline-formula><mml:math id="inf359"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of <italic>n</italic>-SNPs in which strain <italic>X</italic> is one of the strains sharing the SNP. We denote the number of occurrences of an SNP of type <italic>t</italic> by <italic>f</italic><sub><italic>t</italic></sub> and the total number of <italic>n</italic>-SNPs within set <inline-formula><mml:math id="inf360"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as <inline-formula><mml:math id="inf361"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula>, that is<disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:munder><mml:msub><mml:mi>f</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The entropy <inline-formula><mml:math id="inf362"><mml:mrow><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of the <italic>n</italic>-SNP distribution of strain <italic>X</italic> is then defined as<disp-formula id="equ16"><label>(16)</label><mml:math id="m16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:mfrac><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msub><mml:mi>log</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p></sec><sec id="s4-17"><title>Comparing <italic>n</italic>-SNP statistics of pairs of strains</title><p>The considerable variability of the entropy profiles of <italic>E. coli</italic>’s strains suggests that the lineages of different strains must have recombined at different rates with other lineages. Indeed, we observe much less variation in the entropy profiles of the data from simulations in which each strain recombines at an equal rate with each other strain, than we observe for the <italic>E. coli</italic> data (<xref ref-type="fig" rid="fig10s3">Figure 10—figure supplement 3</xref>). However, since we currently lack a concrete evolutionary model that can reproduce all the statistics that we observe in the data, it is difficult to quantify how different the recombination rates of different lineages have to be in order to reproduce the observed variation in entropy profiles.</p><p>Nonetheless, it is straight-forward to define a simple statistical measure of the difference in the <italic>n</italic>-SNP statistics of a given pair of strains <inline-formula><mml:math id="inf363"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Each SNP in the core genome alignment can be categorized by the subset of strains <italic>S</italic> that share the minority allele. Given a pair of strains <inline-formula><mml:math id="inf364"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, this subset <italic>S</italic> can take on four possible types: <italic>S</italic><sub>0</sub> = (<italic>Z</italic>), <italic>S</italic><sub>2</sub> = (<inline-formula><mml:math id="inf365"><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:math></inline-formula>), <inline-formula><mml:math id="inf366"><mml:msub><mml:mi>S</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula> = (<inline-formula><mml:math id="inf367"><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:math></inline-formula>), and <inline-formula><mml:math id="inf368"><mml:msub><mml:mi>S</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula> = (<inline-formula><mml:math id="inf369"><mml:mrow><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:math></inline-formula>), where <italic>Z</italic> is a subset of strains that does not include <italic>x</italic> or <italic>y</italic>. That is, either neither <italic>x</italic> or <italic>y</italic> carry the minority allele, they both do, or only one of them does. We are interested in comparing the relative frequencies with which <italic>x</italic> and <italic>y</italic> co-occur with different subsets <italic>Z</italic> in SNPs across the alignment. Note that to this end, we can ignore SNPs of the type <italic>S</italic><sub>0</sub> and <italic>S</italic><sub>2</sub> because <italic>x</italic> and <italic>y</italic> occur together in these SNPs, so that the frequency with which different subsets <italic>Z</italic> occur in types <italic>S</italic><sub>0</sub> and <italic>S</italic><sub>2</sub> is per definition the same for both <italic>x</italic> and <italic>y</italic>. Thus, the relevant SNPs are of the type <inline-formula><mml:math id="inf370"><mml:msub><mml:mi>S</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf371"><mml:msub><mml:mi>S</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula>.</p><p>Let <inline-formula><mml:math id="inf372"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> be the number of SNPs of the type <inline-formula><mml:math id="inf373"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Z</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf374"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> the number of SNPs of type <inline-formula><mml:math id="inf375"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Z</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and the totals <inline-formula><mml:math id="inf376"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>Z</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf377"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>Z</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. We can then define two probability distributions over all possible subsets <italic>Z</italic>, that is <inline-formula><mml:math id="inf378"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>Z</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf379"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>Z</mml:mi><mml:mi>y</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. These two probability distributions give the relative frequencies with which <italic>x</italic> and <italic>y</italic> are observed to occur in SNPs with all other sets of strains <italic>Z</italic> and there are standard methods to quantify to what extent these two probability distributions are statistically significantly different. A standard orthodox statistical test is the Fisher exact test, which uses the test statistic<disp-formula id="equ17"><label>(17)</label><mml:math id="m17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>!</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>!</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>!</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mo>!</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Note that, if the counts are large enough so that we can use the Stirling approximation <inline-formula><mml:math id="inf380"><mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo lspace="0pt" rspace="3.5pt">!</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, this can be rewritten as<disp-formula id="equ18"><label>(18)</label><mml:math id="m18"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mi>x</mml:mi></mml:msup><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mi>y</mml:mi></mml:msup><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where the distribution <italic>p</italic> is the marginal distribution over the sets <italic>Z</italic><disp-formula id="equ19"><label>(19)</label><mml:math id="m19"><mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>Z</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>and <inline-formula><mml:math id="inf381"><mml:mrow><mml:mi>D</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the Kullback-Leibler divergence (or relative entropy) of the distribution <italic>p</italic> with respect to distribution <italic>q</italic>. Note that the probability <inline-formula><mml:math id="inf382"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> corresponds directly to the <italic>p</italic>-value of the Fisher exact test. The cumulative distribution of p-values across all pairs of strains is shown in <xref ref-type="fig" rid="fig10s2">Figure 10—figure supplement 2</xref>, left panel, showing that the <italic>n</italic>-SNP profiles are different for about 95% of all pairs. In the right panel we show a scatter of the distance <inline-formula><mml:math id="inf383"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> of the n-SNP frequency profiles of each pair of strains <inline-formula><mml:math id="inf384"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> as a function of their nucleotide divergence <inline-formula><mml:math id="inf385"><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. This shows that only very close pairs that differ by less than 10 SNPs in their core genomes have statistically identical <italic>n</italic>-SNP frequency profiles. In addition, there is a very high correlation between the nucleotide divergence <inline-formula><mml:math id="inf386"><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and the distance <inline-formula><mml:math id="inf387"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> of the <italic>n</italic>-SNP frequency profiles.</p><p>Finally, one caveat of the Fisher exact test is that it presumes that all the observed <italic>n</italic>-SNPs of the types (<inline-formula><mml:math id="inf388"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula>) and (<inline-formula><mml:math id="inf389"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:math></inline-formula>) are statistically independent, and in the absence of a concrete stochastic model for the evolutionary dynamics, we do not know whether this assumption holds. However, the p-values for most pairs are so low that, even if we assume the true numbers of independent events are 500-fold less, the fraction of significantly different pairs would still be larger than 90%.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>The authors thank Olin Silander and Diana Blank for their laboratory work on the sequencing of the SC strains. During the development of this work, the authors have benefited from discussions with many researchers including Olin Silander, Frederic Bertels, Sergei Maslov, Purushottam Dixit, Edo Kussell, Boris Shraiman, Eugene Koonin, Daniel Fisher, Paul Rainey, Oskar Hallatschek, Mikhail Tikhonov, Richard Neher, Bruce Levin, Otto Cordero, and Daniel Weissman. This work was supported by the Swiss National Science Foundation grant No. 31003A_135397. In addition, this work was done in part while the authors were visiting the Simons Institute for the Theory of Computing and was thus supported in part by NSF Grant No. PHY17-48958, NIH Grant No. R25GM067110, and the Gordon and Betty Moore Foundation Grant No. 2919.01. Calculations were performed at sciCORE (<ext-link ext-link-type="uri" xlink:href="http://scicore.unibas.ch/">http://scicore.unibas.ch/</ext-link>), the scientific computing core facility of the University of Basel.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Resources, Data curation, Investigation, Visualization, Methodology, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Formal analysis, Supervision, Funding acquisition, Validation, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-65366-transrepform-v2.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All data generated or analyzed during this study are available from public databases and links to all the source data are provided in the article.</p><p>The following datasets were generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Field</surname><given-names>C</given-names></name><name><surname>Sakoparnig</surname><given-names>T</given-names></name><name><surname>van</surname><given-names>Nimwegen E</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>Sequencing, assembly and annotation of naturalized E. coli isolates from Lake Superior Watersheds</data-title><source>NCBI BioProject</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJNA432505">PRJNA432505</pub-id></element-citation></p><p><element-citation id="dataset2" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Sakoparnig</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>Microbial recombination with population structure</data-title><source>Zenodo</source><pub-id assigning-authority="Zenodo" pub-id-type="doi">10.5281/zenodo.4420880</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><collab>1000 Genomes Project Consortium</collab><name><surname>Auton</surname> <given-names>A</given-names></name><name><surname>Brooks</surname> <given-names>LD</given-names></name><name><surname>Durbin</surname> <given-names>RM</given-names></name><name><surname>Garrison</surname> <given-names>EP</given-names></name><name><surname>Kang</surname> <given-names>HM</given-names></name><name><surname>Korbel</surname> <given-names>JO</given-names></name><name><surname>Marchini</surname> <given-names>JL</given-names></name><name><surname>McCarthy</surname> <given-names>S</given-names></name><name><surname>McVean</surname> <given-names>GA</given-names></name><name><surname>Abecasis</surname> <given-names>GR</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A global reference for human genetic variation</article-title><source>Nature</source><volume>526</volume><fpage>68</fpage><lpage>74</lpage><pub-id pub-id-type="doi">10.1038/nature15393</pub-id><pub-id pub-id-type="pmid">26432245</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arnold</surname> <given-names>BJ</given-names></name><name><surname>Gutmann</surname> <given-names>MU</given-names></name><name><surname>Grad</surname> <given-names>YH</given-names></name><name><surname>Sheppard</surname> <given-names>SK</given-names></name><name><surname>Corander</surname> <given-names>J</given-names></name><name><surname>Lipsitch</surname> <given-names>M</given-names></name><name><surname>Hanage</surname> <given-names>WP</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Weak epistasis may drive adaptation in recombining Bacteria</article-title><source>Genetics</source><volume>208</volume><fpage>1247</fpage><lpage>1260</lpage><pub-id pub-id-type="doi">10.1534/genetics.117.300662</pub-id><pub-id pub-id-type="pmid">29330348</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bertels</surname> <given-names>F</given-names></name><name><surname>Silander</surname> <given-names>OK</given-names></name><name><surname>Pachkov</surname> <given-names>M</given-names></name><name><surname>Rainey</surname> <given-names>PB</given-names></name><name><surname>van Nimwegen</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Automated reconstruction of whole-genome phylogenies from short-sequence reads</article-title><source>Molecular Biology and Evolution</source><volume>31</volume><fpage>1077</fpage><lpage>1088</lpage><pub-id pub-id-type="doi">10.1093/molbev/msu088</pub-id><pub-id pub-id-type="pmid">24600054</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bobay</surname> <given-names>LM</given-names></name><name><surname>Traverse</surname> <given-names>CC</given-names></name><name><surname>Ochman</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Impermanence of bacterial clones</article-title><source>PNAS</source><volume>112</volume><fpage>8893</fpage><lpage>8900</lpage><pub-id pub-id-type="doi">10.1073/pnas.1501724112</pub-id><pub-id pub-id-type="pmid">26195749</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cadillo-Quiroz</surname> <given-names>H</given-names></name><name><surname>Didelot</surname> <given-names>X</given-names></name><name><surname>Held</surname> <given-names>NL</given-names></name><name><surname>Herrera</surname> <given-names>A</given-names></name><name><surname>Darling</surname> <given-names>A</given-names></name><name><surname>Reno</surname> <given-names>ML</given-names></name><name><surname>Krause</surname> <given-names>DJ</given-names></name><name><surname>Whitaker</surname> <given-names>RJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Patterns of gene flow define species of thermophilic archaea</article-title><source>PLOS Biology</source><volume>10</volume><elocation-id>e1001265</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1001265</pub-id><pub-id pub-id-type="pmid">22363207</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Croucher</surname> <given-names>NJ</given-names></name><name><surname>Page</surname> <given-names>AJ</given-names></name><name><surname>Connor</surname> <given-names>TR</given-names></name><name><surname>Delaney</surname> <given-names>AJ</given-names></name><name><surname>Keane</surname> <given-names>JA</given-names></name><name><surname>Bentley</surname> <given-names>SD</given-names></name><name><surname>Parkhill</surname> <given-names>J</given-names></name><name><surname>Harris</surname> <given-names>SR</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Rapid phylogenetic analysis of large samples of recombinant bacterial whole genome sequences using gubbins</article-title><source>Nucleic Acids Research</source><volume>43</volume><elocation-id>e15</elocation-id><pub-id pub-id-type="doi">10.1093/nar/gku1196</pub-id><pub-id pub-id-type="pmid">25414349</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Darwin</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="1859">1859</year><source>On the Origin of Species by Means of Natural Selection, Or, the Preservation of Favoured Races in the Struggle for Life</source><publisher-name>John Murray</publisher-name></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Denamur</surname> <given-names>E</given-names></name><name><surname>Clermont</surname> <given-names>O</given-names></name><name><surname>Bonacorsi</surname> <given-names>S</given-names></name><name><surname>Gordon</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>The population genetics of pathogenic <italic>Escherichia coli</italic></article-title><source>Nature Reviews Microbiology</source><volume>19</volume><fpage>37</fpage><lpage>54</lpage><pub-id pub-id-type="doi">10.1038/s41579-020-0416-x</pub-id><pub-id pub-id-type="pmid">32826992</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Didelot</surname> <given-names>X</given-names></name><name><surname>Méric</surname> <given-names>G</given-names></name><name><surname>Falush</surname> <given-names>D</given-names></name><name><surname>Darling</surname> <given-names>AE</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Impact of homologous and non-homologous recombination in the genomic evolution of <italic>Escherichia coli</italic></article-title><source>BMC Genomics</source><volume>13</volume><elocation-id>256</elocation-id><pub-id pub-id-type="doi">10.1186/1471-2164-13-256</pub-id><pub-id pub-id-type="pmid">22712577</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Didelot</surname> <given-names>X</given-names></name><name><surname>Falush</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Inference of bacterial microevolution using multilocus sequence data</article-title><source>Genetics</source><volume>175</volume><fpage>1251</fpage><lpage>1266</lpage><pub-id pub-id-type="doi">10.1534/genetics.106.063305</pub-id><pub-id pub-id-type="pmid">17151252</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Didelot</surname> <given-names>X</given-names></name><name><surname>Wilson</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>ClonalFrameML: efficient inference of recombination in whole bacterial genomes</article-title><source>PLOS Computational Biology</source><volume>11</volume><elocation-id>e1004041</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004041</pub-id><pub-id pub-id-type="pmid">25675341</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dixit</surname> <given-names>PD</given-names></name><name><surname>Pang</surname> <given-names>TY</given-names></name><name><surname>Studier</surname> <given-names>FW</given-names></name><name><surname>Maslov</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Recombinant transfer in the basic genome of <italic>Escherichia coli</italic></article-title><source>PNAS</source><volume>112</volume><fpage>9070</fpage><lpage>9075</lpage><pub-id pub-id-type="doi">10.1073/pnas.1510839112</pub-id><pub-id pub-id-type="pmid">26153419</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dixit</surname> <given-names>PD</given-names></name><name><surname>Pang</surname> <given-names>TY</given-names></name><name><surname>Maslov</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Recombination-Driven genome evolution and stability of bacterial species</article-title><source>Genetics</source><volume>207</volume><fpage>281</fpage><lpage>295</lpage><pub-id pub-id-type="doi">10.1534/genetics.117.300061</pub-id><pub-id pub-id-type="pmid">28751420</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doolittle</surname> <given-names>WF</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Phylogenetic classification and the universal tree</article-title><source>Science</source><volume>284</volume><fpage>2124</fpage><lpage>2128</lpage><pub-id pub-id-type="doi">10.1126/science.284.5423.2124</pub-id><pub-id pub-id-type="pmid">10381871</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Falush</surname> <given-names>D</given-names></name><name><surname>Wirth</surname> <given-names>T</given-names></name><name><surname>Linz</surname> <given-names>B</given-names></name><name><surname>Pritchard</surname> <given-names>JK</given-names></name><name><surname>Stephens</surname> <given-names>M</given-names></name><name><surname>Kidd</surname> <given-names>M</given-names></name><name><surname>Blaser</surname> <given-names>MJ</given-names></name><name><surname>Graham</surname> <given-names>DY</given-names></name><name><surname>Vacher</surname> <given-names>S</given-names></name><name><surname>Perez-Perez</surname> <given-names>GI</given-names></name><name><surname>Yamaoka</surname> <given-names>Y</given-names></name><name><surname>Mégraud</surname> <given-names>F</given-names></name><name><surname>Otto</surname> <given-names>K</given-names></name><name><surname>Reichard</surname> <given-names>U</given-names></name><name><surname>Katzowitsch</surname> <given-names>E</given-names></name><name><surname>Wang</surname> <given-names>X</given-names></name><name><surname>Achtman</surname> <given-names>M</given-names></name><name><surname>Suerbaum</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Traces of human migrations in Helicobacter pylori populations</article-title><source>Science</source><volume>299</volume><fpage>1582</fpage><lpage>1585</lpage><pub-id pub-id-type="doi">10.1126/science.1080857</pub-id><pub-id pub-id-type="pmid">12624269</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Felsenstein</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1981">1981</year><article-title>Evolutionary trees from DNA sequences: a maximum likelihood approach</article-title><source>Journal of Molecular Evolution</source><volume>17</volume><fpage>368</fpage><lpage>376</lpage><pub-id pub-id-type="doi">10.1007/BF01734359</pub-id><pub-id pub-id-type="pmid">7288891</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garud</surname> <given-names>NR</given-names></name><name><surname>Good</surname> <given-names>BH</given-names></name><name><surname>Hallatschek</surname> <given-names>O</given-names></name><name><surname>Pollard</surname> <given-names>KS</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Evolutionary dynamics of Bacteria in the gut microbiome within and across hosts</article-title><source>PLOS Biology</source><volume>17</volume><elocation-id>e3000102</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.3000102</pub-id><pub-id pub-id-type="pmid">30673701</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Godfroid</surname> <given-names>M</given-names></name><name><surname>Dagan</surname> <given-names>T</given-names></name><name><surname>Kupczok</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Recombination signal in Mycobacterium tuberculosis stems from Reference-guided assemblies and alignment artefacts</article-title><source>Genome Biology and Evolution</source><volume>10</volume><fpage>1920</fpage><lpage>1926</lpage><pub-id pub-id-type="doi">10.1093/gbe/evy143</pub-id><pub-id pub-id-type="pmid">30010866</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guindon</surname> <given-names>S</given-names></name><name><surname>Dufayard</surname> <given-names>JF</given-names></name><name><surname>Lefort</surname> <given-names>V</given-names></name><name><surname>Anisimova</surname> <given-names>M</given-names></name><name><surname>Hordijk</surname> <given-names>W</given-names></name><name><surname>Gascuel</surname> <given-names>O</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>New algorithms and methods to estimate maximum-likelihood phylogenies: assessing the performance of PhyML 3.0</article-title><source>Systematic Biology</source><volume>59</volume><fpage>307</fpage><lpage>321</lpage><pub-id pub-id-type="doi">10.1093/sysbio/syq010</pub-id><pub-id pub-id-type="pmid">20525638</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guttman</surname> <given-names>DS</given-names></name><name><surname>Dykhuizen</surname> <given-names>DE</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Clonal divergence in <italic>Escherichia coli</italic> as a result of recombination, not mutation</article-title><source>Science</source><volume>266</volume><fpage>1380</fpage><lpage>1383</lpage><pub-id pub-id-type="doi">10.1126/science.7973728</pub-id><pub-id pub-id-type="pmid">7973728</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Hartl</surname> <given-names>DL</given-names></name><name><surname>Clark</surname> <given-names>AG</given-names></name></person-group><year iso-8601-date="2006">2006</year><source>Principles of Population Genetics</source><publisher-name>Sinauer Associates</publisher-name></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hudson</surname> <given-names>RR</given-names></name><name><surname>Kaplan</surname> <given-names>NL</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>Statistical properties of the number of recombination events in the history of a sample of dna sequences</article-title><source>Genetics</source><volume>111</volume><fpage>147</fpage><lpage>164</lpage><pub-id pub-id-type="pmid">4029609</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ishii</surname> <given-names>S</given-names></name><name><surname>Ksoll</surname> <given-names>WB</given-names></name><name><surname>Hicks</surname> <given-names>RE</given-names></name><name><surname>Sadowsky</surname> <given-names>MJ</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Presence and growth of naturalized <italic>Escherichia coli</italic> in temperate soils from lake superior watersheds</article-title><source>Applied and Environmental Microbiology</source><volume>72</volume><fpage>612</fpage><lpage>621</lpage><pub-id pub-id-type="doi">10.1128/AEM.72.1.612-621.2006</pub-id><pub-id pub-id-type="pmid">16391098</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ishii</surname> <given-names>S</given-names></name><name><surname>Hansen</surname> <given-names>DL</given-names></name><name><surname>Hicks</surname> <given-names>RE</given-names></name><name><surname>Sadowsky</surname> <given-names>MJ</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Beach sand and sediments are temporal sinks and sources of <italic>Escherichia coli</italic> in lake superior</article-title><source>Environmental Science &amp; Technology</source><volume>41</volume><fpage>2203</fpage><lpage>2209</lpage><pub-id pub-id-type="doi">10.1021/es0623156</pub-id><pub-id pub-id-type="pmid">17438764</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lai</surname> <given-names>YP</given-names></name><name><surname>Ioerger</surname> <given-names>TR</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A statistical method to identify recombination in bacterial genomes based on SNP incompatibility</article-title><source>BMC Bioinformatics</source><volume>19</volume><elocation-id>450</elocation-id><pub-id pub-id-type="doi">10.1186/s12859-018-2456-z</pub-id><pub-id pub-id-type="pmid">30466385</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langmead</surname> <given-names>B</given-names></name><name><surname>Salzberg</surname> <given-names>SL</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Fast gapped-read alignment with bowtie 2</article-title><source>Nature Methods</source><volume>9</volume><fpage>357</fpage><lpage>359</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id><pub-id pub-id-type="pmid">22388286</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lawrence</surname> <given-names>JG</given-names></name><name><surname>Ochman</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Molecular archaeology of the <italic>Escherichia coli</italic> genome</article-title><source>PNAS</source><volume>95</volume><fpage>9413</fpage><lpage>9417</lpage><pub-id pub-id-type="doi">10.1073/pnas.95.16.9413</pub-id><pub-id pub-id-type="pmid">9689094</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lerat</surname> <given-names>E</given-names></name><name><surname>Daubin</surname> <given-names>V</given-names></name><name><surname>Moran</surname> <given-names>NA</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>From gene trees to organismal phylogeny in prokaryotes: the case of the gamma-Proteobacteria</article-title><source>PLOS Biology</source><volume>1</volume><elocation-id>e19</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.0000019</pub-id><pub-id pub-id-type="pmid">12975657</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lewontin</surname> <given-names>RC</given-names></name></person-group><year iso-8601-date="1988">1988</year><article-title>On measures of gametic disequilibrium</article-title><source>Genetics</source><volume>120</volume><fpage>849</fpage><lpage>852</lpage><pub-id pub-id-type="doi">10.1093/genetics/120.3.849</pub-id><pub-id pub-id-type="pmid">3224810</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname> <given-names>M</given-names></name><name><surname>Kussell</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Inferring bacterial recombination rates from large-scale sequencing datasets</article-title><source>Nature Methods</source><volume>16</volume><fpage>199</fpage><lpage>204</lpage><pub-id pub-id-type="doi">10.1038/s41592-018-0293-7</pub-id><pub-id pub-id-type="pmid">30664775</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname> <given-names>X</given-names></name><name><surname>Gutacker</surname> <given-names>MM</given-names></name><name><surname>Musser</surname> <given-names>JM</given-names></name><name><surname>Fu</surname> <given-names>YX</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Evidence for recombination in Mycobacterium tuberculosis</article-title><source>Journal of Bacteriology</source><volume>188</volume><fpage>8169</fpage><lpage>8177</lpage><pub-id pub-id-type="doi">10.1128/JB.01062-06</pub-id><pub-id pub-id-type="pmid">16997954</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maddamsetti</surname> <given-names>R</given-names></name><name><surname>Lenski</surname> <given-names>RE</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Analysis of bacterial genomes from an evolution experiment with horizontal gene transfer shows that recombination can sometimes overwhelm selection</article-title><source>PLOS Genetics</source><volume>14</volume><elocation-id>e1007199</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1007199</pub-id><pub-id pub-id-type="pmid">29385126</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mostowy</surname> <given-names>R</given-names></name><name><surname>Croucher</surname> <given-names>NJ</given-names></name><name><surname>Andam</surname> <given-names>CP</given-names></name><name><surname>Corander</surname> <given-names>J</given-names></name><name><surname>Hanage</surname> <given-names>WP</given-names></name><name><surname>Marttinen</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Efficient inference of recent and ancestral recombination within bacterial populations</article-title><source>Molecular Biology and Evolution</source><volume>34</volume><fpage>1167</fpage><lpage>1182</lpage><pub-id pub-id-type="doi">10.1093/molbev/msx066</pub-id><pub-id pub-id-type="pmid">28199698</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Namouchi</surname> <given-names>A</given-names></name><name><surname>Didelot</surname> <given-names>X</given-names></name><name><surname>Schöck</surname> <given-names>U</given-names></name><name><surname>Gicquel</surname> <given-names>B</given-names></name><name><surname>Rocha</surname> <given-names>EP</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>After the bottleneck: genome-wide diversification of the Mycobacterium tuberculosis complex by mutation, recombination, and natural selection</article-title><source>Genome Research</source><volume>22</volume><fpage>721</fpage><lpage>734</lpage><pub-id pub-id-type="doi">10.1101/gr.129544.111</pub-id><pub-id pub-id-type="pmid">22377718</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Novembre</surname> <given-names>J</given-names></name><name><surname>Johnson</surname> <given-names>T</given-names></name><name><surname>Bryc</surname> <given-names>K</given-names></name><name><surname>Kutalik</surname> <given-names>Z</given-names></name><name><surname>Boyko</surname> <given-names>AR</given-names></name><name><surname>Auton</surname> <given-names>A</given-names></name><name><surname>Indap</surname> <given-names>A</given-names></name><name><surname>King</surname> <given-names>KS</given-names></name><name><surname>Bergmann</surname> <given-names>S</given-names></name><name><surname>Nelson</surname> <given-names>MR</given-names></name><name><surname>Stephens</surname> <given-names>M</given-names></name><name><surname>Bustamante</surname> <given-names>CD</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Genes mirror geography within Europe</article-title><source>Nature</source><volume>456</volume><fpage>98</fpage><lpage>101</lpage><pub-id pub-id-type="doi">10.1038/nature07331</pub-id><pub-id pub-id-type="pmid">18758442</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oliveira</surname> <given-names>PH</given-names></name><name><surname>Touchon</surname> <given-names>M</given-names></name><name><surname>Rocha</surname> <given-names>EP</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Regulation of genetic flux between Bacteria by restriction-modification systems</article-title><source>PNAS</source><volume>113</volume><fpage>5658</fpage><lpage>5663</lpage><pub-id pub-id-type="doi">10.1073/pnas.1603257113</pub-id><pub-id pub-id-type="pmid">27140615</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Page</surname> <given-names>RDM</given-names></name><name><surname>Holmes</surname> <given-names>EC</given-names></name></person-group><year iso-8601-date="1998">1998</year><source>Molecular Evolution: A Phylogenetic Approach</source><publisher-loc>New Jersey, United States</publisher-loc><publisher-name>John Wiley &amp; Sons, Inc</publisher-name></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Phelan</surname> <given-names>JE</given-names></name><name><surname>Coll</surname> <given-names>F</given-names></name><name><surname>Bergval</surname> <given-names>I</given-names></name><name><surname>Anthony</surname> <given-names>RM</given-names></name><name><surname>Warren</surname> <given-names>R</given-names></name><name><surname>Sampson</surname> <given-names>SL</given-names></name><name><surname>Gey van Pittius</surname> <given-names>NC</given-names></name><name><surname>Glynn</surname> <given-names>JR</given-names></name><name><surname>Crampin</surname> <given-names>AC</given-names></name><name><surname>Alves</surname> <given-names>A</given-names></name><name><surname>Bessa</surname> <given-names>TB</given-names></name><name><surname>Campino</surname> <given-names>S</given-names></name><name><surname>Dheda</surname> <given-names>K</given-names></name><name><surname>Grandjean</surname> <given-names>L</given-names></name><name><surname>Hasan</surname> <given-names>R</given-names></name><name><surname>Hasan</surname> <given-names>Z</given-names></name><name><surname>Miranda</surname> <given-names>A</given-names></name><name><surname>Moore</surname> <given-names>D</given-names></name><name><surname>Panaiotov</surname> <given-names>S</given-names></name><name><surname>Perdigao</surname> <given-names>J</given-names></name><name><surname>Portugal</surname> <given-names>I</given-names></name><name><surname>Sheen</surname> <given-names>P</given-names></name><name><surname>de Oliveira Sousa</surname> <given-names>E</given-names></name><name><surname>Streicher</surname> <given-names>EM</given-names></name><name><surname>van Helden</surname> <given-names>PD</given-names></name><name><surname>Viveiros</surname> <given-names>M</given-names></name><name><surname>Hibberd</surname> <given-names>ML</given-names></name><name><surname>Pain</surname> <given-names>A</given-names></name><name><surname>McNerney</surname> <given-names>R</given-names></name><name><surname>Clark</surname> <given-names>TG</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Recombination in pe/ppe genes contributes to genetic variation in Mycobacterium tuberculosis lineages</article-title><source>BMC Genomics</source><volume>17</volume><elocation-id>151</elocation-id><pub-id pub-id-type="doi">10.1186/s12864-016-2467-y</pub-id><pub-id pub-id-type="pmid">26923687</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Power</surname> <given-names>JJ</given-names></name><name><surname>Pinheiro</surname> <given-names>F</given-names></name><name><surname>Pompei</surname> <given-names>S</given-names></name><name><surname>Kovacova</surname> <given-names>V</given-names></name><name><surname>Yúksel</surname> <given-names>M</given-names></name><name><surname>Rathmann</surname> <given-names>I</given-names></name><name><surname>Förster</surname> <given-names>M</given-names></name><name><surname>Lässig</surname> <given-names>M</given-names></name><name><surname>Maier</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Adaptive evolution of hybrid Bacteria by horizontal gene transfer</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2020.04.23.057174</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Rambaut</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2018">2018</year><source>FigTree Software Package</source><version designator="1.4.4">1.4.4</version><ext-link ext-link-type="uri" xlink:href="http://tree.bio.ed.ac.uk/software/figtree">http://tree.bio.ed.ac.uk/software/figtree</ext-link></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosen</surname> <given-names>MJ</given-names></name><name><surname>Davison</surname> <given-names>M</given-names></name><name><surname>Bhaya</surname> <given-names>D</given-names></name><name><surname>Fisher</surname> <given-names>DS</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Microbial diversity Fine-scale diversity and extensive recombination in a quasisexual bacterial population occupying a broad niche</article-title><source>Science</source><volume>348</volume><fpage>1019</fpage><lpage>1023</lpage><pub-id pub-id-type="doi">10.1126/science.aaa4456</pub-id><pub-id pub-id-type="pmid">26023139</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Sakoparnig</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>GPUprokEvolSim</data-title><source>Software Heritage</source><version designator="swh:1:rev:ed15c4b013068d684874c3d7c9d710e289e3f31c">swh:1:rev:ed15c4b013068d684874c3d7c9d710e289e3f31c</version><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:48718e01b2d55d6e0dd6cac46f58d8dbeec71912;origin=https://github.com/thomsak/GPUprokEvolSim;visit=swh:1:snp:7ff4e662878c10ceccc4cc7ca2e27e35f797f0b9;anchor=swh:1:rev:ed15c4b013068d684874c3d7c9d710e289e3f31c/">https://archive.softwareheritage.org/swh:1:dir:48718e01b2d55d6e0dd6cac46f58d8dbeec71912;origin=https://github.com/thomsak/GPUprokEvolSim;visit=swh:1:snp:7ff4e662878c10ceccc4cc7ca2e27e35f797f0b9;anchor=swh:1:rev:ed15c4b013068d684874c3d7c9d710e289e3f31c/</ext-link></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shapiro</surname> <given-names>BJ</given-names></name><name><surname>Friedman</surname> <given-names>J</given-names></name><name><surname>Cordero</surname> <given-names>OX</given-names></name><name><surname>Preheim</surname> <given-names>SP</given-names></name><name><surname>Timberlake</surname> <given-names>SC</given-names></name><name><surname>Szabó</surname> <given-names>G</given-names></name><name><surname>Polz</surname> <given-names>MF</given-names></name><name><surname>Alm</surname> <given-names>EJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Population genomics of early events in the ecological differentiation of Bacteria</article-title><source>Science</source><volume>336</volume><fpage>48</fpage><lpage>51</lpage><pub-id pub-id-type="doi">10.1126/science.1218198</pub-id><pub-id pub-id-type="pmid">22491847</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stott</surname> <given-names>CM</given-names></name><name><surname>Bobay</surname> <given-names>LM</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Impact of homologous recombination on core genome phylogenies</article-title><source>BMC Genomics</source><volume>21</volume><elocation-id>829</elocation-id><pub-id pub-id-type="doi">10.1186/s12864-020-07262-x</pub-id><pub-id pub-id-type="pmid">33238876</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Suerbaum</surname> <given-names>S</given-names></name><name><surname>Smith</surname> <given-names>JM</given-names></name><name><surname>Bapumia</surname> <given-names>K</given-names></name><name><surname>Morelli</surname> <given-names>G</given-names></name><name><surname>Smith</surname> <given-names>NH</given-names></name><name><surname>Kunstmann</surname> <given-names>E</given-names></name><name><surname>Dyrek</surname> <given-names>I</given-names></name><name><surname>Achtman</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Free recombination within Helicobacter pylori</article-title><source>PNAS</source><volume>95</volume><fpage>12619</fpage><lpage>12624</lpage><pub-id pub-id-type="doi">10.1073/pnas.95.21.12619</pub-id><pub-id pub-id-type="pmid">9770535</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Touchon</surname> <given-names>M</given-names></name><name><surname>Hoede</surname> <given-names>C</given-names></name><name><surname>Tenaillon</surname> <given-names>O</given-names></name><name><surname>Barbe</surname> <given-names>V</given-names></name><name><surname>Baeriswyl</surname> <given-names>S</given-names></name><name><surname>Bidet</surname> <given-names>P</given-names></name><name><surname>Bingen</surname> <given-names>E</given-names></name><name><surname>Bonacorsi</surname> <given-names>S</given-names></name><name><surname>Bouchier</surname> <given-names>C</given-names></name><name><surname>Bouvet</surname> <given-names>O</given-names></name><name><surname>Calteau</surname> <given-names>A</given-names></name><name><surname>Chiapello</surname> <given-names>H</given-names></name><name><surname>Clermont</surname> <given-names>O</given-names></name><name><surname>Cruveiller</surname> <given-names>S</given-names></name><name><surname>Danchin</surname> <given-names>A</given-names></name><name><surname>Diard</surname> <given-names>M</given-names></name><name><surname>Dossat</surname> <given-names>C</given-names></name><name><surname>Karoui</surname> <given-names>ME</given-names></name><name><surname>Frapy</surname> <given-names>E</given-names></name><name><surname>Garry</surname> <given-names>L</given-names></name><name><surname>Ghigo</surname> <given-names>JM</given-names></name><name><surname>Gilles</surname> <given-names>AM</given-names></name><name><surname>Johnson</surname> <given-names>J</given-names></name><name><surname>Le Bouguénec</surname> <given-names>C</given-names></name><name><surname>Lescat</surname> <given-names>M</given-names></name><name><surname>Mangenot</surname> <given-names>S</given-names></name><name><surname>Martinez-Jéhanne</surname> <given-names>V</given-names></name><name><surname>Matic</surname> <given-names>I</given-names></name><name><surname>Nassif</surname> <given-names>X</given-names></name><name><surname>Oztas</surname> <given-names>S</given-names></name><name><surname>Petit</surname> <given-names>MA</given-names></name><name><surname>Pichon</surname> <given-names>C</given-names></name><name><surname>Rouy</surname> <given-names>Z</given-names></name><name><surname>Ruf</surname> <given-names>CS</given-names></name><name><surname>Schneider</surname> <given-names>D</given-names></name><name><surname>Tourret</surname> <given-names>J</given-names></name><name><surname>Vacherie</surname> <given-names>B</given-names></name><name><surname>Vallenet</surname> <given-names>D</given-names></name><name><surname>Médigue</surname> <given-names>C</given-names></name><name><surname>Rocha</surname> <given-names>EP</given-names></name><name><surname>Denamur</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Organised genome dynamics in the <italic>Escherichia coli</italic> species results in highly diverse adaptive paths</article-title><source>PLOS Genetics</source><volume>5</volume><elocation-id>e1000344</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1000344</pub-id><pub-id pub-id-type="pmid">19165319</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vos</surname> <given-names>M</given-names></name><name><surname>Didelot</surname> <given-names>X</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>A comparison of homologous recombination rates in Bacteria and archaea</article-title><source>The ISME Journal</source><volume>3</volume><fpage>199</fpage><lpage>208</lpage><pub-id pub-id-type="doi">10.1038/ismej.2008.93</pub-id><pub-id pub-id-type="pmid">18830278</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vulić</surname> <given-names>M</given-names></name><name><surname>Dionisio</surname> <given-names>F</given-names></name><name><surname>Taddei</surname> <given-names>F</given-names></name><name><surname>Radman</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Molecular keys to speciation: dna polymorphism and the control of genetic exchange in enterobacteria</article-title><source>PNAS</source><volume>94</volume><fpage>9763</fpage><lpage>9767</lpage><pub-id pub-id-type="doi">10.1073/pnas.94.18.9763</pub-id><pub-id pub-id-type="pmid">9275198</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Wakeley</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2008">2008</year><source>Coalescent Theory: An Introduction. W. H</source><publisher-name>Freeman</publisher-name></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolf</surname> <given-names>YI</given-names></name><name><surname>Rogozin</surname> <given-names>IB</given-names></name><name><surname>Grishin</surname> <given-names>NV</given-names></name><name><surname>Koonin</surname> <given-names>EV</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Genome trees and the tree of life</article-title><source>Trends in Genetics</source><volume>18</volume><fpage>472</fpage><lpage>479</lpage><pub-id pub-id-type="doi">10.1016/S0168-9525(02)02744-0</pub-id><pub-id pub-id-type="pmid">12175808</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yahara</surname> <given-names>K</given-names></name><name><surname>Didelot</surname> <given-names>X</given-names></name><name><surname>Jolley</surname> <given-names>KA</given-names></name><name><surname>Kobayashi</surname> <given-names>I</given-names></name><name><surname>Maiden</surname> <given-names>MC</given-names></name><name><surname>Sheppard</surname> <given-names>SK</given-names></name><name><surname>Falush</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The landscape of realized homologous recombination in pathogenic Bacteria</article-title><source>Molecular Biology and Evolution</source><volume>33</volume><fpage>456</fpage><lpage>471</lpage><pub-id pub-id-type="doi">10.1093/molbev/msv237</pub-id><pub-id pub-id-type="pmid">26516092</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Yang</surname> <given-names>C</given-names></name><name><surname>Cui</surname> <given-names>Y</given-names></name><name><surname>Didelot</surname> <given-names>X</given-names></name><name><surname>Yang</surname> <given-names>R</given-names></name><name><surname>Falush</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Why panmictic Bacteria are rare</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/385336</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zuckerkandl</surname> <given-names>E</given-names></name><name><surname>Pauling</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="1965">1965</year><article-title>Evolutionary divergence and convergence in proteins</article-title><source>Evolving Genes and Proteins</source><volume>97</volume><fpage>97</fpage><lpage>166</lpage><pub-id pub-id-type="doi">10.1016/B978-1-4832-2734-4.50017-6</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><boxed-text><table-wrap id="app1table1" position="float"><label>Appendix 1—table 1.</label><caption><title>Average length of tree compatible segments, both in terms of number of consecutive SNPs and number of consecutive nucleotides, for the full <italic>E. coli</italic> and simulation data, as well as for alignments from which 5% or 10% of potentially homoplasic sites were removed.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Statistic</th><th colspan="3">Average nb. of SNPs</th><th colspan="3">Average nb. of nucleotides</th></tr><tr><th>Perc. homoplasies removed</th><th>0%</th><th>5%</th><th>10%</th><th>0%</th><th>5%</th><th>10%</th></tr></thead><tbody><tr><td><italic>E. coli</italic></td><td>7.59</td><td>8.79</td><td>10.75</td><td>123</td><td>145</td><td>179</td></tr><tr><td><inline-formula><mml:math id="inf390"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula></td><td>32</td><td>2757</td><td>11606</td><td>387</td><td>30435</td><td>108413</td></tr><tr><td><inline-formula><mml:math id="inf391"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula></td><td>32</td><td>430</td><td>702</td><td>371</td><td>5020</td><td>8396</td></tr><tr><td><inline-formula><mml:math id="inf392"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula></td><td>28</td><td>57</td><td>85</td><td>365</td><td>733</td><td>1158</td></tr><tr><td><inline-formula><mml:math id="inf393"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula></td><td>14</td><td>16</td><td>18</td><td>211</td><td>256</td><td>312</td></tr><tr><td><inline-formula><mml:math id="inf394"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula></td><td>8</td><td>9</td><td>10</td><td>135</td><td>157</td><td>183</td></tr><tr><td><inline-formula><mml:math id="inf395"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula></td><td>5</td><td>5</td><td>5</td><td>88</td><td>100</td><td>114</td></tr><tr><td><inline-formula><mml:math id="inf396"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula></td><td>3</td><td>3</td><td>3</td><td>57</td><td>62</td><td>68</td></tr></tbody></table></table-wrap><table-wrap id="app1table2" position="float"><label>Appendix 1—table 2.</label><caption><title>Number of substitutions and phylogeny changes within sub-alignments corresponding to known phylogroups.</title><p>Starting from the full 5% homoplasy-corrected core genome alignment we extracted, for each phylogroup, the sub-alignment of all strains belonging to that phylogroup and determined the number of bi-allelic SNPs <italic>M</italic> and number of phylogeny changes <italic>C</italic>. Each row of the table corresponds to one of the known phylogroups and shows the number of our strains in that phylogroup, the SNP rate within the clade <inline-formula><mml:math id="inf397"><mml:mrow><mml:mi>M</mml:mi><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, the lower bound <italic>C</italic> on the number of phylogeny changes, the ratio <inline-formula><mml:math id="inf398"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula>, and the estimated average number of times each position in the genome has been overwritten by recombination <inline-formula><mml:math id="inf399"><mml:msub><mml:mi>T</mml:mi><mml:mi>est</mml:mi></mml:msub></mml:math></inline-formula>. Note that the phylogroup ’O’ stands for the outgroup. See <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> for the phylogroup annotation of our strains.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Phylogroup</th><th>No. of strains</th><th>SNP rate <inline-formula><mml:math id="inf400"><mml:mrow><mml:mi>M</mml:mi><mml:mo mathvariant="normal">/</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula></th><th>Phyl. changes <italic>C</italic></th><th><inline-formula><mml:math id="inf401"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula></th><th><inline-formula><mml:math id="inf402"><mml:msub><mml:mi>T</mml:mi><mml:mi>est</mml:mi></mml:msub></mml:math></inline-formula></th></tr></thead><tbody><tr><td>A</td><td>6</td><td>0.0024</td><td>178</td><td>0.027</td><td>0.65</td></tr><tr><td>B1</td><td>35</td><td>0.013</td><td>4540</td><td>0.130</td><td>16.5</td></tr><tr><td>B2</td><td>6</td><td>0.011</td><td>2664</td><td>0.088</td><td>9.7</td></tr><tr><td>D</td><td>29</td><td>0.017</td><td>5426</td><td>0.114</td><td>19.7</td></tr><tr><td>E</td><td>1</td><td>-</td><td>-</td><td>-</td><td>-</td></tr><tr><td>F</td><td>3</td><td>0.007</td><td>-</td><td>-</td><td>-</td></tr><tr><td>O</td><td>9</td><td>0.003</td><td>2</td><td>0.0002</td><td>0.007</td></tr></tbody></table></table-wrap><table-wrap id="app1table3" position="float"><label>Appendix 1—table 3.</label><caption><title>Summary statistics of the core genome alignments of the different bacterial species.</title><p>For each species, the number of strains, the median genome size, the size of the core genome alignment, and the total number of informative SNPs (that is SNPs that occur in at least two strains) are listed.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Species</th><th>Strains</th><th>Genome size</th><th>Core size</th><th>Inf. SNPs</th></tr></thead><tbody><tr><td><italic>Escherichia coli</italic></td><td>92</td><td>4,929,299</td><td>2,756,541 (56%)</td><td>247,822</td></tr><tr><td><italic>Bacillus subtilis</italic></td><td>75</td><td>4,155,843</td><td>2,341,553 (56%)</td><td>182,535</td></tr><tr><td><italic>Helicobacter pylori</italic></td><td>83</td><td>1,655,288</td><td>850,827 (51%)</td><td>114,993</td></tr><tr><td><italic>Mycobacterium tuberculosis</italic></td><td>40</td><td>4,465,985</td><td>4,150,139 (93%)</td><td>3502</td></tr><tr><td><italic>Salmonella enterica</italic></td><td>155</td><td>4,810,980</td><td>2,846,634 (59%)</td><td>192,117</td></tr><tr><td><italic>Staphylococcus aureus</italic></td><td>95</td><td>2,881,899</td><td>2,002,833 (69%)</td><td>73,756</td></tr></tbody></table></table-wrap><table-wrap id="app1table4" position="float"><label>Appendix 1—table 4.</label><caption><title>Summary statistics on mutation and recombination for each of the six species.</title><p>For each species, the table shows the SNP rate (SNPs per alignment column) <inline-formula><mml:math id="inf403"><mml:mrow><mml:mi>M</mml:mi><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, the lower bound on the number of phylogeny changes <italic>C</italic>, and the lower bound on the ratio of phylogeny changes to mutations <inline-formula><mml:math id="inf404"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula>.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Species</th><th>SNP rate <inline-formula><mml:math id="inf405"><mml:mrow><mml:mi>M</mml:mi><mml:mo mathvariant="normal">/</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula></th><th>Phyl. changes <italic>C</italic></th><th><inline-formula><mml:math id="inf406"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula></th></tr></thead><tbody><tr><td><italic>Escherichia coli</italic></td><td>0.101</td><td>43,575</td><td>0.156</td></tr><tr><td><italic>Bacillus subtilis</italic></td><td>0.113</td><td>40,811</td><td>0.155</td></tr><tr><td><italic>Helicobacter pylori</italic></td><td>0.202</td><td>50,743</td><td>0.295</td></tr><tr><td><italic>Mycobacterium tuberculosis</italic></td><td>0.002</td><td>755</td><td>0.078</td></tr><tr><td><italic>Salmonella enterica</italic></td><td>0.085</td><td>31,598</td><td>0.131</td></tr><tr><td><italic>Staphylococcus aureus</italic></td><td>0.053</td><td>13,215</td><td>0.124</td></tr></tbody></table></table-wrap></boxed-text></app><app id="appendix-2"><title>Appendix 2</title><boxed-text><sec id="s8" sec-type="appendix"><title>Comment on the estimation of recombination segment lengths</title><p>The recombination segment lengths that we inferred from comparing closely related pairs of strains (<xref ref-type="fig" rid="fig2">Figure 2J</xref>), and the average segment length of <inline-formula><mml:math id="inf407"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>31</mml:mn><mml:mi>k</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, are significantly longer than estimates that have been reported previously, for example (<xref ref-type="bibr" rid="bib47">Vos and Didelot, 2009</xref>; <xref ref-type="bibr" rid="bib46">Touchon et al., 2009</xref>). In contrast to our method, which directly identifies recombined segments as regions of high SNP density in pairwise genome alignments, which can be easily detected by eye (i.e. see <xref ref-type="fig" rid="fig2">Figure 2A and B</xref>), these previous estimates were based on fitting of more complex population genetics models to the entire multiple alignment. Since these models make a number of assumptions that our results suggest do not hold, this may explain why these models inferred significantly lower fragment lengths. However, one may still ask whether our estimate of the average recombination segment length could be significantly inflated, for example due to our method failing to detect short recombination events.</p><p>We do not believe this is plausible for a number of reasons. First, the simple HMM that we used to detect recombined segments uses 1 kb as a minimal segment length, and as much as 30% of the recombination segments that we infer are only <inline-formula><mml:math id="inf408"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> kb long (<xref ref-type="fig" rid="fig2">Figure 2J</xref>). This shows that our method has no difficulty in detecting relative short recombination segments.</p><p>Second, a simple back-of-the-envelope calculation suggests that segments have to be very short in order for our method to fail to detect them. For the close pairs that we use to estimate the lengths of recombination segments, SNPs in clonally inherited regions are so rare that essentially only 1 kb blocks with 0, 1, or at most 2 SNPs will be assumed to be clonally inherited. Since the recombined segments derive from strains that are typically 1–2% diverged, even a recombination segment of length 200 bp would cause three or more SNPs, and would be detected by our method. Thus, very roughly speaking, segments of length 200 bp or more are expected to be reliably detected and only segments of 100 bp or less could easily be missed.</p><p>Third, to substantially affect the average length of the recombination segments, undetectable short segments (i.e. of length less than 100 bp) would have to be extremely frequent. That is, if we denote by <inline-formula><mml:math id="inf409"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>31000</mml:mn></mml:mrow></mml:math></inline-formula> the average length of the detected segments, by <inline-formula><mml:math id="inf410"><mml:msub><mml:mi>L</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:math></inline-formula> the average length of undetected segments, by <inline-formula><mml:math id="inf411"><mml:msub><mml:mi>L</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> the true average segment length, and by <italic>f</italic><sub><italic>d</italic></sub> the fraction of all segments that were detected, we have<disp-formula id="equ20"><label>(20)</label><mml:math id="m20"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>L</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>In the limit that <inline-formula><mml:math id="inf412"><mml:msub><mml:mi>L</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:math></inline-formula> is much smaller than both <inline-formula><mml:math id="inf413"><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf414"><mml:msub><mml:mi>L</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>, we have approximately <inline-formula><mml:math id="inf415"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. Thus, in order for the average segment length to be overestimated 10-fold, we would have to assume that for every detected recombination segment of length 200 bp or more, there are 10 undetected recombination segments of length 100 or less. This seems rather implausible to us.</p><p>Finally, the average length of the recombination segments <inline-formula><mml:math id="inf416"><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula> is immaterial for almost all of our results, with the exception of our estimated lower bound on the number of times <italic>T</italic> each locus has been overwritten by recombination. In particular, this lower bound <italic>T</italic> is directly proportional to the average length of the recombination segments <inline-formula><mml:math id="inf417"><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula>. However, the estimate <italic>T</italic> is also directly proportional to the lower bound <italic>C</italic> on the number of phylogeny changes along the genome, and we saw in the main text that in our simulations the true number of phylogeny changes can easily be 10-fold larger than this lower bound <italic>C</italic>. Therefore, our lower bound for <italic>T</italic> can only be larger than the true value if the average segment length <inline-formula><mml:math id="inf418"><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula> is overestimated by a large factor.</p></sec></boxed-text></app><app id="appendix-3"><title>Appendix 3</title><boxed-text><sec id="s9" sec-type="appendix"><title>Estimating <italic>T</italic> using statistics from the pair analysis</title><p>For a pair of strains <inline-formula><mml:math id="inf419"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> our pairwise analysis estimates the fraction <italic>f</italic><sub><italic>c</italic></sub> of the genome that was clonally inherited and the divergence <italic>d</italic><sub><italic>c</italic></sub> (i.e. fraction of positions for which <italic>s</italic> and <inline-formula><mml:math id="inf420"><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> have different nucleotides) in the clonally inherited regions, from the density of SNPs along their core genome alignment. If we make the assumptions that, since <italic>s</italic> and <inline-formula><mml:math id="inf421"><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> diverged from a common clonal ancestor, substitutions have occurred at a constant rate μ per unit time, recombination events have occurred at a constant rate ρ per unit time, and the average length of the recombination segments is <inline-formula><mml:math id="inf422"><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula>, then <italic>f</italic><sub><italic>c</italic></sub> is approximately given by<disp-formula id="equ21"><label>(21)</label><mml:math id="m21"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>with <inline-formula><mml:math id="inf423"><mml:msub><mml:mi>L</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math></inline-formula> the length of the core genome alignment, and <italic>t</italic> the time since the common ancestor of <italic>s</italic> and <inline-formula><mml:math id="inf424"><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula>. Similarly, the divergence <italic>d</italic><sub><italic>c</italic></sub> is given by<disp-formula id="equ22"><label>(22)</label><mml:math id="m22"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Using these, we can solve for the clonal fraction <italic>f</italic><sub><italic>c</italic></sub> as a function of the divergence <italic>d</italic><sub><italic>c</italic></sub> and find<disp-formula id="equ23"><label>(23)</label><mml:math id="m23"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula></p><p>Thus, given an estimate of the fraction of clonally inherited genome <italic>f</italic><sub><italic>c</italic></sub> and divergence <italic>d</italic><sub><italic>c</italic></sub> in these clonally inherited regions, we can infer an effective value of <inline-formula><mml:math id="inf425"><mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> for this pair, that is<disp-formula id="equ24"><label>(24)</label><mml:math id="m24"><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>In order for these simple equations to be applicable, we have to be in a regime where there are enough recombined regions so that their number and average size is not too noisy, but also not so many that the recombined regions start to significantly overlap. We thus extracted all pairs of strains for which <inline-formula><mml:math id="inf426"><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mo>≤</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> and plotted the estimate of <inline-formula><mml:math id="inf427"><mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> against <italic>f</italic><sub><italic>c</italic></sub> for each pair (<xref ref-type="fig" rid="fig1">Figure 1</xref>).</p><fig id="app3fig1" position="float"><label>Appendix 3—figure 1.</label><caption><title>Estimate of the effective recombination strength <inline-formula><mml:math id="inf428"><mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> (vertical axis) as a function of the estimated fraction of clonally inherited genome <italic>f</italic><sub><italic>c</italic></sub> (horizontal axis) for each pair of strains with <italic>f</italic><sub><italic>c</italic></sub> between <inline-formula><mml:math id="inf429"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf430"><mml:mrow><mml:mn>3</mml:mn><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>.</title><p>Each point corresponds to a pair of strains.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-app3-fig1-v2.tif"/></fig><p>We see that based on this simple model, the estimates of <inline-formula><mml:math id="inf431"><mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> range from about 2100–4600.</p><p>Finally, we can use these estimates of <inline-formula><mml:math id="inf432"><mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> to derive an estimate for the average number of times <italic>T</italic> that a given locus in the core genome alignment has been overwritten by recombination. Note that, because recombination is very frequent, many thousands of different phylogenies occur along the core genome, but each single position <italic>i</italic> has some definite phylogeny <inline-formula><mml:math id="inf433"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>. If we denote by <inline-formula><mml:math id="inf434"><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> the total length of the branches of phylogeny <inline-formula><mml:math id="inf435"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, then the expected number of times position <italic>i</italic> has been substituted is roughly <inline-formula><mml:math id="inf436"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and the expected number of times position <italic>i</italic> has been recombined is <inline-formula><mml:math id="inf437"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. From the observation that 10% of the positions in the core genome alignment are polymorphic, it follows that <inline-formula><mml:math id="inf438"><mml:mrow><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="inf439"><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:math></inline-formula> the average of <inline-formula><mml:math id="inf440"><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> across all positions. Consequently, the average number of times <italic>T</italic> that a position in the genome has been overwritten by recombination is given by<disp-formula id="equ25"><label>(25)</label><mml:math id="m25"><mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mn>0.1</mml:mn><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:mfrac></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Thus, this simple model predicts, from the statistics of the partially recombined pairs, that <italic>T</italic> lies somewhere between 210 and 460, which is consistent with our lower bound of <inline-formula><mml:math id="inf441"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>190</mml:mn></mml:mrow></mml:math></inline-formula> that we estimated based on <inline-formula><mml:math id="inf442"><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> and the estimated average length of recombination segments <inline-formula><mml:math id="inf443"><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula>.</p><p>In spite of this consistency, we want to stress that this simple model assumes that there is a fixed rate of recombination, whereas our data indicates that recombination rates vary strongly across lineages. As such, it is inherently misleading to try to summarize the strength of recombination by a single recombination rate <italic>ρ</italic>. Moreover, in going from the estimate of <inline-formula><mml:math id="inf444"><mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> of each pair, to the estimate of <italic>T</italic>, we implicitly assume that the rates inferred for these partially recombined pairs can be extended to the full core genome alignment. This too is potentially problematic. We therefore consider this method for estimating <italic>T</italic> to be only a rough order-of-magnitude check on the lower bound on <italic>T</italic> that we estimated from the lower bound on the number of phylogeny changes <italic>C</italic>.</p></sec></boxed-text></app><app id="appendix-4"><title>Appendix 4</title><boxed-text><sec id="s10" sec-type="appendix"><title><italic>E. coli</italic>'s <italic>n</italic>-SNP statistics differ from <italic>n</italic>-SNP statistics of simulations with free recombination</title><p>In this section, we systematically compare the <italic>n</italic>-SNP statistics observed for the <italic>E. coli</italic> data with <italic>n</italic>-SNP statistics observed for the simulations with different rates of recombination. We show that the <italic>n</italic>-SNP statistics for <italic>E. coli</italic> differ in several fundamental ways from those observed for simulations of populations of freely recombining individuals.</p><p>An often considered statistic in the population genetic analysis of sexually reproducing species is the so-called site frequency spectrum, which in our terminology corresponds to the total number of <italic>n</italic>-SNPs <inline-formula><mml:math id="inf445"><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, that is the total number of SNPs shared by <italic>n</italic> strains, as a function of <italic>n</italic>. <xref ref-type="fig" rid="fig1">Figure 1</xref> shows the site frequency spectrum <inline-formula><mml:math id="inf446"><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for the <italic>E. coli</italic> data, the simulations without recombination, and the simulations with recombination to mutation rates ranging from <inline-formula><mml:math id="inf447"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula> to 10, using the 5% homoplasy-corrected alignments. To distinguish the contribution of potentially clonal SNPs falling on the core tree, the solid lines show <inline-formula><mml:math id="inf448"><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for all SNPs, and the dashed lines show <inline-formula><mml:math id="inf449"><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for all but the <italic>n</italic>-SNPs falling on the core tree.</p><fig id="app4fig1" position="float"><label>Appendix 4—figure 1.</label><caption><title>SNP frequency spectra.</title><p>Total number of occurrences of n-SNPs, that is SNPs shared by <italic>n</italic> strains (vertical axes) as a function of <italic>n</italic> (horizontal axes) for the <italic>E. coli</italic> data (top left panel) and all simulated data with different recombination rates, where the ratio of recombination to mutation rate <inline-formula><mml:math id="inf450"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> is indicated above each panel. The solid lines correspond to all <italic>n</italic>-SNPs in the 5% homoplasy-corrected alignment, whereas for the dashed lines all <italic>n</italic>-SNPs corresponding to branches in the core tree have been removed. Note that all axes are shown on logarithmic scales and for high recombination rates <inline-formula><mml:math id="inf451"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>≥</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula>, the <italic>n</italic>-SNP frequencies are approximately proportional to <inline-formula><mml:math id="inf452"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-app4-fig1-v2.tif"/></fig><p>We first focus on the simulation data. It is well-known that, for populations evolving under a Kingman coalescent, <inline-formula><mml:math id="inf453"><mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∝</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, that is the total frequency of SNPs shared by <italic>n</italic> strains falls as <inline-formula><mml:math id="inf454"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> when averaged over many instantiations of the coalescent process. Indeed, for recombination rates sufficiently high that essentially all branches in the clonal history are dominated by recombination, that is <inline-formula><mml:math id="inf455"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>≥</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula>, the observed site frequency spectrum falls exactly as <inline-formula><mml:math id="inf456"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>, and removing the SNPs that fall on the core tree has virtually no effect on the <italic>n</italic>-SNP frequencies <inline-formula><mml:math id="inf457"><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. In contrast, for the simulations without recombination (top center panel in <xref ref-type="fig" rid="fig1">Figure 1</xref>) virtually all SNPs fall on the clonal tree, that is after removal of the core tree SNPs only a tiny number of SNPs remain that derive from homoplasies that escaped the homoplasy correction. Moreover, because the counts <inline-formula><mml:math id="inf458"><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for the simulation without recombination derive from a single tree, we observe significant deviations from the average trend <inline-formula><mml:math id="inf459"><mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∝</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, for example the clonal tree happens to have particularly long branches toward clades with <italic>n</italic>=5, <italic>n</italic>=7, and <italic>n</italic>=12 .</p><p>For <inline-formula><mml:math id="inf460"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula> all loci are still predominantly clonally inherited across all branches of the tree (see <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>), which is reflected in the fact that the number of SNPs drops dramatically when the clonal SNPs are removed, and that we clearly see the peaks in <inline-formula><mml:math id="inf461"><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> at <inline-formula><mml:math id="inf462"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf463"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf464"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>12</mml:mn></mml:mrow></mml:math></inline-formula> that derive from the clonal tree. The recombination rate <inline-formula><mml:math id="inf465"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> is an interesting intermediate case. While most branches of the tree are predominantly clonally inherited, a few longer branches are already mostly recombined (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>). Reflecting this, we see that for <inline-formula><mml:math id="inf466"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> clonal SNPs dominate the <italic>n</italic>-SNP counts for small <italic>n</italic>, whereas from about <inline-formula><mml:math id="inf467"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula> onward, the <italic>n</italic>-SNP counts derive mostly from recombination. At recombination rate, <inline-formula><mml:math id="inf468"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> clonal SNPs only affect <italic>n</italic>-SNP counts for <inline-formula><mml:math id="inf469"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>, and for higher recombination rates the site frequencies <inline-formula><mml:math id="inf470"><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> perfectly follow the function <inline-formula><mml:math id="inf471"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>.</p><p>For the <italic>E. coli</italic> data, we see that core tree SNPs make a significant contribution to the <italic>n</italic>-SNP counts for <inline-formula><mml:math id="inf472"><mml:mrow><mml:mi>n</mml:mi><mml:mo>≤</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:math></inline-formula>. In particular, the peak at <inline-formula><mml:math id="inf473"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:math></inline-formula>, corresponding to the extremely common SNPs toward the outgroup, as well as a smaller peak at <inline-formula><mml:math id="inf474"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula>, corresponding to a group of 20 extremely close strains, both disappear after removal of the core tree SNPs. From <inline-formula><mml:math id="inf475"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula> onward the core tree SNPs do not contribute significantly to the <italic>n</italic>-SNP counts <inline-formula><mml:math id="inf476"><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Interestingly, while the counts <inline-formula><mml:math id="inf477"><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> roughly follow the <inline-formula><mml:math id="inf478"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> trend until <inline-formula><mml:math id="inf479"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula>, for <inline-formula><mml:math id="inf480"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula> the counts <inline-formula><mml:math id="inf481"><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> do not further decrease but appear virtually constant. This behavior is not observed in any of the simulated datasets.</p><p>Next, we investigated how many different <italic>types</italic> of <italic>n</italic>-SNPs occur as a function of <italic>n</italic> for the different datasets, as well as the average number of occurrence of the each of the <italic>n</italic>-SNP types. Since the exponents of the power-law fits are determined by the geometric average of the <italic>n</italic>-SNP type occurrences (see Materials and methods), we calculated the geometric average of the counts per <italic>n</italic>-SNP type as a function of <italic>n</italic> for each dataset. To focus on the <italic>n</italic>-SNPs associated with recombination, we used the SNPs from the 5% homoplasy-corrected alignment and removed all SNPs corresponding to branches of the core tree. The results are shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>.</p><fig id="app4fig2" position="float"><label>Appendix 4—figure 2.</label><caption><title>Diversity of <italic>n</italic>-SNPs.</title><p>Left panel: Number of <italic>n</italic>-SNP types (vertical axis) as a function of <italic>n</italic> (horizontal axis) for the <italic>E. coli</italic> data (black line) and for simulations with different recombination to mutation rates <inline-formula><mml:math id="inf482"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> (colored lines, see legend). Both axes are shown on a logarithmic scale. Right panel: Geometric average of the number of occurrences per <italic>n</italic>-SNP type (vertical axis) as a function of <italic>n</italic> for the <italic>E. coli</italic> data (black line) and for simulations with different recombination to mutation rates <inline-formula><mml:math id="inf483"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> (colored lines, see legend). Both axes are shown on a logarithmic scale. Note that, in order to better show the heights of the curves for the different datasets the vertical axis is clipped at 50. For the simulated datasets, the geometric mean of the 1-SNP counts runs from 400 to 1000.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-app4-fig2-v2.tif"/></fig><p>We first note that the number of 1-SNP types is 50 for all the simulated data (which consisted of a sample of <inline-formula><mml:math id="inf484"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula>) genomes. That is 1-SNPs are observed that are exclusive to each of the 50 genomes. However, the number of 1-SNP types observed for the <italic>E. coli</italic> data is 55, that is much less than the 92 possible types given that there are 92 strains. This reflects the fact that, in our collection of wild <italic>E. coli</italic> isolates, there are some groups of extremely closely related strains with identical core genomes. Note that such closely related strains are unlikely to occur for random samples from a Kingman coalescent.</p><p>Second, we see that, for the <italic>E. coli</italic> data, the number of <italic>n</italic>-SNP types increases with <italic>n</italic>, saturating at around <inline-formula><mml:math id="inf485"><mml:mrow><mml:mn>500</mml:mn><mml:mo>-</mml:mo><mml:mn>800</mml:mn></mml:mrow></mml:math></inline-formula> unique <italic>n</italic>-SNP types for each <italic>n</italic> at <inline-formula><mml:math id="inf486"><mml:mrow><mml:mi>n</mml:mi><mml:mo>≥</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>. In the right panel of <xref ref-type="fig" rid="fig2">Figure 2</xref> we see that, as the number of <italic>n</italic>-SNP types increases, the geometric mean frequency of the <italic>n</italic>-SNP types decreases smoothly. This smooth decrease of the geometric mean mirrors the increasing exponents of the <italic>n</italic>-SNP power-laws. None of the simulation data resemble the pattern that is observed for the <italic>E. coli</italic> data. First, at the lowest recombination rate <inline-formula><mml:math id="inf487"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula> the number of <italic>n</italic>-SNP types is low and decreasing with <italic>n</italic>. Second, for recombination rate <inline-formula><mml:math id="inf488"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>, the number of SNP types increases more gradually with <italic>n</italic>, saturating at about 200 <italic>n</italic>-SNP types for large <italic>n</italic>. However, in contrast to what we observe for the <italic>E. coli</italic> data, the geometric mean number of occurrences for the simulations with <inline-formula><mml:math id="inf489"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> is much larger and virtually constant for <inline-formula><mml:math id="inf490"><mml:mrow><mml:mi>n</mml:mi><mml:mo>≥</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>. At higher recombination rates <inline-formula><mml:math id="inf491"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>≥</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula>, the number of <italic>n</italic>-SNP types rises quickly with <italic>n</italic>, reaching a maximum of thousands of unique <italic>n</italic>-SNP types between <inline-formula><mml:math id="inf492"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf493"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>, and then decreases with larger <italic>n</italic>. At the same time, the geometric mean of the number of occurrences per type decreases quickly with <italic>n</italic> and stays at low values of about three for <inline-formula><mml:math id="inf494"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> and close to one for the highest recombination rates. That is, when recombination completely dominates, and there is no population structure by construction, almost all SNP types are distinct, occurring only once or a few times.</p><p>Note that our previous analysis has shown that the number of phylogeny changes per SNP column C/M for <italic>E. coli</italic> is similar to that observed for <inline-formula><mml:math id="inf495"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. However, as <xref ref-type="fig" rid="fig2">Figure 2</xref> shows, at such high recombination rates one would expect much higher <italic>n</italic>-SNP diversity still than is observed for the <italic>E. coli</italic> data. The fact that the <italic>E. coli</italic> data shows evidence of high recombination on the one hand, in combination with lower SNP diversity, is consistent with SNP diversity being constrained by population structure.</p><p>We next compared the approximately power-law <italic>n</italic>-SNP frequency distributions that we observed for <italic>E. coli</italic>, with the <italic>n</italic>-SNP frequency distributions observed for the simulation data. <xref ref-type="fig" rid="fig3">Figure 3</xref> shows the <italic>n</italic>-SNP distributions for six different values of <italic>n</italic> ranging from <inline-formula><mml:math id="inf496"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf497"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>12</mml:mn></mml:mrow></mml:math></inline-formula>.</p><fig id="app4fig3" position="float"><label>Appendix 4—figure 3.</label><caption><title>Example <italic>n</italic>-SNP distributions for <italic>E. coli</italic> (black lines) as well as for the simulations with different rates of recombination with <inline-formula><mml:math id="inf498"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> shown in blue, <inline-formula><mml:math id="inf499"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula> in cyan, <inline-formula><mml:math id="inf500"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> in light green, <inline-formula><mml:math id="inf501"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> in dark green, <inline-formula><mml:math id="inf502"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula> in orange, <inline-formula><mml:math id="inf503"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> in red, and <inline-formula><mml:math id="inf504"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula> in brown.</title><p>Each panel corresponds to the observed <italic>n</italic>-SNP distributions with the value of <italic>n</italic> indicated at the top of each panel. All axes are shown on logarithmic scales.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-app4-fig3-v2.tif"/></fig><p>Whereas, for the <italic>E. coli</italic> data, all distributions are approximately power-law, almost all of the distributions for the simulated data are clearly bending downwards in the log-log plot, often severely so. Long tailed distributions are only observed for the very low recombination rates <inline-formula><mml:math id="inf505"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf506"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>, for which we have seen that <italic>n</italic>-SNPs are still largely dominated by clonal SNPs at small values of <italic>n</italic>. However, as we have seen above, such low recombination rates are not consistent with the <italic>E. coli</italic> data. In addition, as we will see in more detail below, the exponents of the <italic>n</italic>-SNP distributions at recombination rates <inline-formula><mml:math id="inf507"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf508"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> are much lower than is observed for <italic>E. coli</italic>, and the average number of occurrence per <italic>n</italic>-SNP type are significantly higher than observed for <italic>E. coli</italic> (<xref ref-type="fig" rid="fig2">Figure 2</xref>, right panel).</p><p>All <italic>n</italic>-SNP distributions at recombination rates <inline-formula><mml:math id="inf509"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>≥</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> differ clearly from power-laws. That is, instead of long-tailed distributions most of these <italic>n</italic>-SNP frequencies fall within a fairly narrow range. For example, at <inline-formula><mml:math id="inf510"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> most 2-SNPs have frequencies between <inline-formula><mml:math id="inf511"><mml:mrow><mml:mn>10</mml:mn><mml:mo>-</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula>, most 3-SNPs have frequencies between <inline-formula><mml:math id="inf512"><mml:mrow><mml:mn>2</mml:mn><mml:mo>-</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula>, and 4-SNPs that occur more than 10 times are very rare.</p><p>Although the <italic>n</italic>-SNP distributions at mutation rates <inline-formula><mml:math id="inf513"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>≥</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> cannot reasonably be fitted to power-laws, we can still determine the exponents of the maximum likelihood fits since these only depend on the geometric average number of occurrences of the <italic>n</italic>-SNP types (see Materials and methods). <xref ref-type="fig" rid="fig4">Figure 4</xref> shows the resulting exponents for the simulated data, as well as for the <italic>E. coli</italic> data for reference.</p><fig id="app4fig4" position="float"><label>Appendix 4—figure 4.</label><caption><title>Fitted exponents of the <italic>n</italic>-SNP distributions for the <italic>E. coli</italic> data (black) and the data from the simulations with different recombination rates (colors, see legend).</title><p>The bars show the fitted exponent plus and minus one standard-deviation of the posterior distribution.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-app4-fig4-v2.tif"/></fig><p>We see that, for the simulation data, exponents increase systematically with recombination rate. For low recombination rates <inline-formula><mml:math id="inf514"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf515"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> all exponents are below 1.5, whereas for recombination rate <inline-formula><mml:math id="inf516"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> the exponents lie in the range <inline-formula><mml:math id="inf517"><mml:mrow><mml:mn>2.3</mml:mn><mml:mo>-</mml:mo><mml:mn>2.6</mml:mn></mml:mrow></mml:math></inline-formula>. In contrast to the <italic>E. coli</italic> data, for which exponents increase smoothly from about 1.25–2.7 as <italic>n</italic> increases, for the simulations the exponents tend to be more constant as a function of <italic>n</italic>.</p><p>In summary, none of the <italic>n</italic>-SNP statistics of the data from simulations resemble the <italic>n</italic>-SNP statistics observed for the <italic>E. coli</italic> data. For example, while fairly long-tailed distributions of <italic>n</italic>-SNPs are observed at very low recombination rates, the exponents of these distributions are much lower than found for the <italic>E. coli</italic> data, and the <italic>n</italic>-SNP diversity is lower than observed for the <italic>E. coli</italic> data. In addition, such low recombination rates are inconsistent with all of our other analyses of the <italic>E. coli</italic> data. In contrast, while high <italic>n</italic>-SNP diversity is observed at higher recombination rates, there the <italic>n</italic>-SNP distributions are not long tailed, but instead <italic>n</italic>-SNP frequencies vary only over a relatively narrow range.</p></sec></boxed-text></app><app id="appendix-5"><title>Appendix 5</title><boxed-text><sec id="s11" sec-type="appendix"><title>Detailed SNP statistics for Phylogroup B2</title><p>In the main text, we illustrated 2-SNPs using strain A1 (<xref ref-type="fig" rid="fig9">Figure 9</xref>), which is part of the phylogroup B2. The phylogroup B2, which is represented by the six strains A1, A2, A7, A11, B2, and D8 in our dataset, is small enough to allow for an illustrative discussion of what our various analyses show about the role of recombination in the evolutionary history of these strains.</p></sec><sec id="s12" sec-type="appendix"><title>Pairwise analysis for the sextet of strains (A1,A2,A7,A11,B2,D8)</title><p><xref ref-type="table" rid="app5table1">Appendix 5—table 1</xref> shows the pairwise divergences between strain A1 and the other strains of this phylogroup.</p><table-wrap id="app5table1" position="float"><label>Appendix 5—table 1.</label><caption><title>Pairwise divergence of strain <inline-formula><mml:math id="inf518"><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> with each of the other strains of phylogroup B2.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Strain</th><th>Divergence</th></tr></thead><tbody><tr><td>B2</td><td>0.00626</td></tr><tr><td>A7</td><td>0.00627</td></tr><tr><td>A11</td><td>0.00702</td></tr><tr><td>D8</td><td>0.00729</td></tr><tr><td>A2</td><td>0.00778</td></tr></tbody></table></table-wrap><p>Note that these divergences are in the regime where, in general, most of the pairwise alignment has already been overwritten by recombination (see <xref ref-type="fig" rid="fig2">Figure 2G</xref> and note that the critical divergence at which 50% of the genome has recombined is 0.0032). Indeed, if one looks at the pairwise alignments of A1 with these strains (<xref ref-type="fig" rid="fig1">Figure 1</xref>), one finds that for each of these five strains there is little if any ancestrally inherited DNA left.</p><fig id="app5fig1" position="float"><label>Appendix 5—figure 1.</label><caption><title>Left panels: SNP densities (SNPs per kilobase) along the core genome for the five pairs of strains (A1-B2), (A1-A7), (A1-A11), (A1-D8), and (A1-A2).</title><p>Right panels: Corresponding histograms for the number of SNPs per kilobase (dots) together with fits of the mixture model. Note the vertical axis is on a logarithmic scale.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-app5-fig1-v2.tif"/></fig><p>This is in fact true for <italic>all</italic> pairs of the phylogroup B2, with the exception of the pair (A7,B2). The divergence of A7 and B2 is less than <inline-formula><mml:math id="inf519"><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> and their alignment is fully clonal, that is A7 and B2 share a recent common ancestor. However, according to the analysis of SNP densities along the pairwise alignments, all other pairs in this clade are close to fully recombined. Note that this also means that the pairwise divergences are dominated by mutations in recombined regions, not by ancestrally inherited mutations (see <xref ref-type="fig" rid="fig2">Figure 2H</xref>). Thus, the pairwise analysis rejects that the core genome phylogeny for this phylogroup corresponds to the clonal phylogeny.</p></sec><sec id="s13" sec-type="appendix"><title>Pair-SNPs of A1 along the core genome alignment</title><p>In the main text, we introduced the 2-SNP concept by showing the distribution of 2-SNPs for the strain A1, which belongs to phylogroup B2. This analysis showed that strain A1 occurs in 2-SNPs with 17 different other strains from our collection, and most commonly with strains D8, A2, and A11, which each have around 200 2-SNPs with strain A1. Besides these three strains from phylogroup B2, strains D4 (from phylogroup F) and H6 (which does not have a clear phylogroup) each also have over 70 2-SNPs with A1. <xref ref-type="fig" rid="fig2">Figure 2</xref> shows how these five most common 2-SNP types involving strain A1 are distributed along the core genome alignment. Note that, wherever a 2-SNP occurs of type <inline-formula><mml:math id="inf520"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, it means that the strains A1 and <italic>s</italic> are nearest neighbors in the phylogeny at that locus. Consequently, the pattern of 2-SNP types along the core genome alignment gives an indication of how different phylogenies are distributed along the genome.</p><fig id="app5fig2" position="float"><label>Appendix 5—figure 2.</label><caption><title>Distribution of the five most common 2-SNP patterns involving strain A1 along the core genome alignment.</title><p>Left: Direct visualization of the positions of each of the 2-SNP patterns along the core genome alignment. Each dashed line corresponds to an SNP and SNPs are colored according to the 2-SNP type (see legend in middle and right panels) and ordered with the most common type at the bottom. Middle: Reverse cumulative distributions of the distances between consecutive SNPs of the same type. Each colored line corresponds to the distribution for one 2-SNP type (see legend). The vertical axis is shown on a logarithmic scale. Right: Reverse cumulative distribution of the length of runs of consecutive 2-SNPs of the same type. Each colored line corresponds to the distribution for one 2-SNP type (see legend). The vertical axis is shown on a logarithmic scale.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-app5-fig2-v2.tif"/></fig><p>The results in <xref ref-type="fig" rid="fig2">Figure 2</xref> are consistent with the pairwise analysis, showing that the different 2-SNP types are fairly uniformly spread along the core genome alignment, and that the phylogeny changes many times. As shown in the middle panel of <xref ref-type="fig" rid="fig2">Figure 2</xref>, the tails of the distributions of distances between 2-SNPs of the same type are approximately exponential, indicating that 2-SNPs of the same type occur approximately at a constant rate on a large length-scale. However, on short length-scales there is some evidence for clustering of 2-SNPs of the same type. To further elucidate this, the right panel of <xref ref-type="fig" rid="fig2">Figure 2</xref> shows the reverse cumulative distribution of consecutive runs of the same 2-SNP type. This indicates that these runs are mostly very short, that is 3 or less 2-SNPs of the same type in a row for 90% of the runs. The longest runs are one run of 16 SNPs in a row of the most common type (A1,D8), and one run of 16 SNPs in a row where strain A1 shares a SNP with the strain D4 from phylogroup F. The fact that 2-SNPs of A1 with strains D4 and H6, both of which do not belong to phylogroup B2, are dispersed all across the core genome alignment underscores again that phylogroups should not be thought of as reflecting <italic>clonal</italic> ancestry, that is there is no single common ancestor cell of the strains in phylogroup B2. Instead, different positions in the core genome alignment have different ancestries and the strains of phylogroup B2 form a ‘group’ in the sense that, for many positions in the alignment, these strains share ancestors with each other more recently than with other strains.</p></sec><sec id="s14" sec-type="appendix"><title>Phylogeny changes along the core alignment of phylogroup B2</title><p>That recombination is pervasive within this set of strains with relatively low divergence is confirmed by the phylogenetic inconsistencies along the alignment made from the core genomes of just this sextet of strains (A1,A2,A7,A11,B2,D8). In particular, in the 5% homoplasy-corrected alignment there are <inline-formula><mml:math id="inf521"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mn>30</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mn>196</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> SNPs and at least <inline-formula><mml:math id="inf522"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mn>2664</mml:mn></mml:mrow></mml:math></inline-formula> changes in phylogeny along this core genome alignment. This means that the lower bound on the ratio of the number of phylogeny changes to mutation events is <inline-formula><mml:math id="inf523"><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.088</mml:mn></mml:mrow></mml:math></inline-formula>, that is a break on average every 11 SNPs. <xref ref-type="fig" rid="fig3">Figure 3</xref> shows the distribution of segment lengths between phylogeny breaks (either counting the number of consecutive SNPs or total length of the segments) which shows that breaks typically occur within 10 SNPs and within a few hundred base pairs.</p><fig id="app5fig3" position="float"><label>Appendix 5—figure 3.</label><caption><title>Left: Histogram of the number of consecutive SNPs before an inconsistency in the core genome alignment of the sextet of strains (A1,A2,A7,A11,B2,D8) of phylogroup B2.</title><p>Note that the vertical axis corresponds to the number of segments with the corresponding number of consecutive SNPs. Middle: Histogram of the length of segments without phylogeny breaks. Right: Histogram of the SNP density across the segments that are consistent with a single phylogeny (shown on a logarithmic axis). Note that the SNP densities vary by two orders of magnitude.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-app5-fig3-v2.tif"/></fig><p><xref ref-type="fig" rid="fig3">Figure 3</xref> also shows (right panel) that the SNP density varies by as much as hundred-fold across the 2664 segments, consistent with the fact that the transferred fragments are themselves mosaics of previous recombination events.</p></sec><sec id="s15" sec-type="appendix"><title>SNP types for the strains in phylogroup B2</title><p>Another indication that these single-phylogeny segments are the result of recombination comes from looking at what the actual SNP types are that occur in the segments. <xref ref-type="table" rid="app5table2">Appendix 5—table 2</xref> shows, for the 10 longest segments, the lengths, the total number of SNPs, and SNP-types that occur in each segment.</p><table-wrap id="app5table2" position="float"><label>Appendix 5—table 2.</label><caption><title>Lengths, total SNP count, and SNP types (that is the strains that carry the minority allele) for the ten longest segments (in terms of number of consecutive SNPs) along the core genome of the sextet (A1,A2,A7,A11,B2,D8) of phylogroup B2.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Length segment</th><th>Number of SNPs</th><th>SNP types</th></tr></thead><tbody><tr><td>9698</td><td>109</td><td>(A7, B2) (A1, A7, B2) (A2, D8)</td></tr><tr><td>5672</td><td>100</td><td>(A7,B2) (A1,A2) (A11,D8)</td></tr><tr><td>2068</td><td>100</td><td>(A2,D8) (A11,A7,B2)</td></tr><tr><td>2255</td><td>95</td><td>(A7,B2) (A11,A2) (A1,A11,A2)</td></tr><tr><td>11726</td><td>95</td><td>(A7,B2) (A2,A7,B2) (A1,D8)</td></tr><tr><td>11790</td><td>93</td><td>(A7,B2) (A2,D8)</td></tr><tr><td>3614</td><td>86</td><td>(A11,A2)</td></tr><tr><td>4564</td><td>86</td><td>(A11,A7,B2) (A1,A2)</td></tr><tr><td>2890</td><td>75</td><td>(A7,B2) (A1,A7,B2)</td></tr><tr><td>2390</td><td>71</td><td>(A1,A11)</td></tr></tbody></table></table-wrap><p>Note that the SNP-types that occur in these longest unbroken segments are not only almost all inconsistent with the core genome phylogeny, they are also almost all inconsistent with each other. That is, each of these segments suggests a different phylogeny. Note also that, in each segment, there are typically multiple SNPs of the same type.</p><table-wrap id="app5table3" position="float"><label>Appendix 5—table 3.</label><caption><title>All 2-SNPs, 3-SNPs, and 4-SNPs involving strains from the sextet (A1 A2 A7 A11 B2 D8), that occur at least 100 times, sorted by their frequency of occurrence.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Strains</th><th>Number of occ.</th></tr></thead><tbody><tr><td>A7 B2</td><td>1227</td></tr><tr><td>A11 D8</td><td>306</td></tr><tr><td>A2 D8</td><td>291</td></tr><tr><td>A11 A2</td><td>284</td></tr><tr><td>A1 D8</td><td>214</td></tr><tr><td>A1 A2</td><td>196</td></tr><tr><td>A1 A11</td><td>194</td></tr><tr><td>A1 A7 B2</td><td>389</td></tr><tr><td>A7 B2 D8</td><td>303</td></tr><tr><td>A11 A7 B2</td><td>265</td></tr><tr><td>A2 A7 B2</td><td>208</td></tr><tr><td>A11 A2 D8</td><td>179</td></tr><tr><td>A1 A11 D8</td><td>172</td></tr><tr><td>A1 A11 A2</td><td>161</td></tr><tr><td>A1 A2 D8</td><td>153</td></tr><tr><td>A1 A11 A7 B2</td><td>265</td></tr><tr><td>A1 A11 A2 D8</td><td>248</td></tr><tr><td>A11 A7 B2 D8</td><td>232</td></tr><tr><td>A1 A7 B2 D8</td><td>226</td></tr><tr><td>A1 A2 A7 B2</td><td>139</td></tr><tr><td>A2 A7 B2 D8</td><td>136</td></tr><tr><td>A11 A2 A7 B2</td><td>110</td></tr></tbody></table></table-wrap><p>Finally, the fact that the alignment of this sextet is a mixture of segments that follow different phylogenies is also confirmed by the overall relative frequencies of the SNP-types that are observed for these strains. <xref ref-type="table" rid="app5table3">Appendix 5—table 3</xref> shows the most common 2-SNPs, 3-SNPs, and 4-SNPs together with their number of occurrences, for this sextet of strains. Note that these are SNP-types obtained from the entire alignment. That is, a 4-SNP (A1 A11 A7 B2) means that these strains share a nucleotide that differs from the nucleotide that all other 88 strains have.</p><p><xref ref-type="table" rid="app5table3">Appendix 5—table 3</xref> shows that, apart from the clonal pair (A7 B2), which is consistently supported by the observed SNPs, the others strains occur at similar frequencies in different mutually inconsistent combinations. For example, the four most common 3-SNPs all consist of the pair (A7 B2) with a different third strain. This diversity of phylogenetic partners for each strain is well summarized by the entropy profiles of these six strains, as shown in <xref ref-type="fig" rid="fig4">Figure 4</xref>.</p><fig id="app5fig4" position="float"><label>Appendix 5—figure 4.</label><caption><title>Entropy profiles for the six strains (A1, A2, A7, A11, B2, D8).</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65366-app5-fig4-v2.tif"/></fig><p>First, note that the strains of the pair (A7 B2) have virtually identical entropy profiles, indicating that they had a clonal ancestor before much recombination took place, that is their entropy profiles correspond to the entropy profile of their common ancestor. They also have zero pair entropy because they only occur in pairs with each other. However, all other strains have pair entropies around 2.5, which is equivalent to occurring with equal frequency in <inline-formula><mml:math id="inf524"><mml:mrow><mml:mn>5</mml:mn><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula> different pairs. For quartets, the entropies range from 3.6 to 4, equivalent to <inline-formula><mml:math id="inf525"><mml:mrow><mml:mn>12</mml:mn><mml:mo>-</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:math></inline-formula> equally frequent quartets. That is, there is a diverse collection of phylogenetic relationships in which these six strains occur.</p></sec><sec id="s16" sec-type="appendix"><title>Summary: the phylogeny of strains (A1,A2,A7,A11,B2,D8)</title><p>In summary, all statistics show that even for the relative close sextet of strains (A1, A2, A7, A11, B2, D8), the only clear clonal signal left is the close pair (A7 B2). The alignments between all other pairs have been mostly overwritten by recombination, the phylogeny changes thousands of times along the core genome alignment, and each strain occurs in a diverse collection of multiply inconsistent <italic>n</italic>-SNPs with the other strains. However, as shown in the bottom panel of <xref ref-type="fig" rid="fig1">Figure 1</xref> of the main text, the branches in the core tree of this sextet are well supported when a tree is constructed from sufficiently many loci. That is, the core genome phylogeny is just the best compromise capturing the statistics with which different phylogenetic patterns appear, and one reliably converges to this best compromise when sufficiently many loci are taken into account.</p></sec></boxed-text></app></app-group></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.65366.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Nourmohammad</surname><given-names>Armita</given-names></name><role>Reviewing Editor</role><aff><institution>University of Washington</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>This work offers a careful, quantitative analysis of a population of <italic>E. coli</italic> genomes sampled at the same time from one location. Combining genomic analysis, with population genetics models and very extensive simulations to test different evolutionary scenarios, the authors have shown that the observed genetic diversity is inconsistent with both pure clonal evolution and a freely recombining population. Instead, population structure which leads to a broad range of recombination rates within a species must be considered. This careful study, while it does not offer a unique solution, is an important starting point to a broader discussion, both at the level of population genetics modelling and the level of the biological and ecological sources of the population structure.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your work entitled &quot;Whole genome phylogenies reflect the distributions of recombination rates for many bacterial species&quot; for consideration by <italic>eLife</italic>. Your article has been evaluated by Aleksandra Walczak (Senior Editor) and a Reviewing Editor.</p><p>This work offers a careful, quantitative analysis of a population of <italic>E. coli</italic> genomes sampled at the same time from one location. Combining genomic analysis, with population genetics models and very extensive simulations to test different evolutionary scenarios, the authors have shown that the observed genetic diversity is inconsistent with both pure clonal evolution and a freely recombining population. Instead, population structure which leads to a broad range of recombination rates within a species must be considered. This careful study, while it does not offer a unique solution, is an important starting point to a broader discussion, both at the level of population genetics modelling and the level of the biological and ecological sources of the population structure.</p><p>Both reviewers had access to the multiple rounds of reviews from a previous journal that the authors provided with their submission, and their responses to the concerns raised in these previous reviews. These concerns especially addressed some of the technical aspects of the work, and the reviewers at <italic>eLife</italic> felt that your responses were not only adequate, but also that the additional analyses further elevated the work.</p><p>Taking this into account, the reviewers agreed that the work should be published largely as is, with just a few clarifications, noted below:</p><p>1) A recent study by J. Power et al. (https://doi.org/10.1101/2020.04.23.057174) has shown prevalence of strong selection on horizontal gene transfer in <italic>B. subtilis</italic> in an experimental evolution setup in the lab. I understand that population diversity in the work of Power et al. arises from a clone in the lab and the time-scale of evolution is substantially different from what you are considering in this manuscript. Nonetheless, I was wondering if you could comment how (if at all) selection on horizontal gene transfer (or recombination) could impact some of the results and the interpretations presented in the manuscript; a few sentences in the Discussion section would be sufficient.</p><p>2) Figure 11B very interesting. Is there a biological explanation (from the literature) as why H. Pylori has such high entropy level and a rapid saturation at n~5?</p><p>3) Please thoroughly address reviewer #1 comments on language edits.</p><p><italic>Reviewer #1:</italic></p><p>I suggest that you carefully go through the text and make language edits throughout. For example, there are issues with the usage of past and present tense and sometimes the narrative switched between the two even within a single paragraph. Also, there are typos and issues with the usage of articles and commas, which at times cause confusion.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.65366.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Both reviewers had access to the multiple rounds of reviews from a previous journal that the authors provided with their submission, and their responses to the concerns raised in these previous reviews. These concerns especially addressed some of the technical aspects of the work, and the reviewers at eLife felt that your responses were not only adequate, but also that the additional analyses further elevated the work.</p><p>Taking this into account, the reviewers agreed that the work should be published largely as is, with just a few clarifications, noted below:</p><p>1) A recent study by J. Power et al. (https://doi.org/10.1101/2020.04.23.057174) has shown prevalence of strong selection on horizontal gene transfer in <italic>B. subtilis</italic> in an experimental evolution setup in the lab. I understand that population diversity in the work of Power et al. arises from a clone in the lab and the time-scale of evolution is substantially different from what you are considering in this manuscript. Nonetheless, I was wondering if you could comment how (if at all) selection on horizontal gene transfer (or recombination) could impact some of the results and the interpretations presented in the manuscript; a few sentences in the Discussion section would be sufficient.</p></disp-quote><p>Just as there is no doubt that selection acts on mutations, there is of course also no doubt that selection acts on recombination events. As we already noted in the Discussion, it is likely that natural selection plays an important role in determining the relative rates of recombination that we observe in the data. To what extent natural selection versus other mechanisms such as geographic population structure determine the relative rates of observed recombinations is extremely interesting, but beyond the scope of this work. Here we are just trying to provide quantitative estimates for how much recombination occurred in the history of a set of strains and the statistics of which strains have recombined more or less frequently. These results are not affected by the extent to which selection has shaped the observed patterns. We’ve extended our remarks in the Discussion and added a reference to the preprint that the reviewer mentioned.</p><disp-quote content-type="editor-comment"><p>2) Figure 11B very interesting. Is there a biological explanation (from the literature) as why H. Pylori has such high entropy level and a rapid saturation at n~5?</p></disp-quote><p>Previous studies have noted that recombination rates are very high in <italic>H. pylori</italic> and suggested that this species is’ freely recombining’ (Suerbaum et al., PNAS 1998). That is, <italic>H. pylori</italic> is the one species for which the consensus in the literature already is that its evolution is pretty much dominated by recombination. In addition, it has also been argued that population structure evident in <italic>H. pylori</italic> sequences reflects the population structure of its human host (Falush et al., 2003). We have added some remarks in the text, including citations to these papers, to make clear that the high amount of recombination that we infer for <italic>H. pylori</italic> is consistent with the literature.</p><disp-quote content-type="editor-comment"><p>3) Please thoroughly address reviewer #1 comments on language edits.</p></disp-quote><p>We have followed the reviewer’s advice and gone through the text in search for typos, superfluous commas, and unwarranted switches between tenses. However, we feel that in many places a mixture of tenses is appropriate, e.g. we say that we <italic>found</italic> that <italic>n</italic>-SNP distribution <italic>have</italic> long tails, because while this finding occurred in the past, the distributions did not cease to have long tails.</p><p>[Editors' note: we include below the reviews that the authors received from another journal, along with the authors’ responses.]</p><disp-quote content-type="editor-comment"><p>Reviewer 1</p><p>1.1) This manuscript tackles an interesting question and tries some new and worthwhile approaches. It brings a commendable amount of fresh energy to the problem. However makes many provocative claims in the Abstract that are not justified by the analysis performed. Furthermore, several of the sections have conceptual problems and are unclear. In general the authors rely far too much on verbal argument and intuition about what the quantities they calculate mean. There is a total absence of testing to show that the methods are actually measuring what is claimed. If published in anything like its current form, it would be an extremely confusing addition to the literature.</p></disp-quote><p>After damning us with faint praise, the reviewer starts the review by making a number of strong and very critical claims, including:</p><p>1) That claims in the Abstract are not justified by our analysis.</p><p>2) That we ‘rely on verbal arguments’, provide no quantitative support, nor any testing, to support that the quantities we calculate mean what we claim.</p><p>Since the reviewer makes these claims without identifying any concrete issue, method, or statement here, let alone providing an argument for these criticisms, we can at this point only note that we strongly disagree with these claims.</p><p>As detailed below, we have performed many additional analyses and validations to comprehensively address every concrete issue raised by the reviewer. These analyses include extensive comparisons with data from simulations of populations evolving under drift, mutation, and recombination (for which we specifically developed new simulation code). All these analyses confirm the accuracy of our methods. Moreover, although some valid technical issues were raised, we also show that quite a number of the critical claims made by the reviewer do not hold up to careful scrutiny, e.g. see responses to points 1.3, 1.4, 1.8, 1.9, 1.10, and 1.12.</p><p>In contrast, we do accept the reviewer’s criticism that several conceptual issues were not sufficiently clearly explained and we have now significantly rewritten and extended discussions in the manuscript to make these points clear. Here too we have taken advantage of the simulation results, where the ground truth is known, to better explain the meaning of some of the quantities we calculate. In addition, we introduced a new section in which we illustrate conceptual issues regarding the interpretation of the core genome phylogeny by using data from human genomes, and we also expanded the section on the entropy profiles to better explain what the <italic>n</italic>-SNP statistics show about the relative recombination rates among different strains. Finally, to further clarify the meaning of the results we added analyses on the phylogroups(Appendix 1—table 2, and Figure 10—figure supplement 1), including an in-depth analysis of the SNP patterns for phylogroup B2.</p><disp-quote content-type="editor-comment"><p>1.2) As the authors remark, the phylogeny section (Figure 1) is not hugely new and the authors provide no way to quantify recombination patterns from degree of incongruence.</p></disp-quote><p>The main aim of the analysis of Figure 1 is to introduce the general problem that the paper addresses using well-known previously used methods, i.e. that phylogenies reconstructed from individual 3Kb alignment blocks are incongruent, but that phylogenies reconstructed from a large number of such blocks converge to a robust phylogenetic tree.</p><p>We agree that these incongruence measures do not directly quantify recombination patterns. Indeed, this is precisely the problem that our manuscript addresses and much of the rest of the manuscript is exactly about quantifying recombination patterns.</p><p>However, it should be noted that the results of Figure 1 do already rule out several suppositions that are sometimes made in the literature. First, if there were a significant fraction of blocks that were unaffected by recombination, than all these blocks would have to be consistent with a common phylogeny. The fact that every 3Kb block significantly rejects the phylogeny of every other block shows that this cannot be the case, i.e. almost every block has to be affected by recombination to some extent. Second, it is also often presumed that, while phylogenies may vary along the genome, that deviations from the core tree reconstructed from all blocks are only minor. Figure 1 also shows that this is not the case but that the incongruences are very substantial, i.e. half of the branches of the core tree occur in less than a quarter of all blocks.</p><p>In the revision we have rephrased so as to stress these points.</p><disp-quote content-type="editor-comment"><p>1.3) The pair of strains analysis (Figure 2) assumes that the simple statistical model that the authors use is fully accurate in identifying recombined regions. The method that the authors used is reasonable (others have used similar models) but is sure to make errors. Moreover, these errors are unlikely to be random within the dataset, since distinguishing recombined regions from non-recombined ones becomes harder as divergence between strains increases. This bias is likely to interfere materially with the arguments the authors want to make.</p></disp-quote><p>It is not true that the results in Figure 2 assume that the identification of recombined regions is ‘fully accurate’. We state very clearly that this method is used to estimate the recombined regions for each pair. We also completely agree with the reviewer that it becomes harder to estimate the fraction of clonally inherited regions as divergence increases. Indeed, one purpose of panels A, B, and C of Figure 2 was to show readers that the rare recombined regions in close pairs can almost be identified by eye whereas, as recombined regions get denser on the genome, it becomes harder to distinguish them from the clonally inherited regions.</p><p>In contrast to what the reviewer implies, the conclusions that we draw from Figure 2 are very robust to inaccuracies in these estimates. We are noting broad quantitative trends that are observed reproducibly across many independently analyzed pairs of strains. For example, <italic>all</italic> close pairs with divergence less than 0.001 have more than 90% clonally inherited regions and <italic>all</italic> pairs with divergence over 0.01 have a very low fraction of clonally inherited regions. In addition, in the transition regime of divergences between 0.001 and 0.01, the estimated fraction of clonally inherited regions drops systematically with divergence. That is, even though each pair is analyzed independently, the fraction of clonally inherited regions decreases in a very systematic and reproducible way as a function of the divergence between the strains. Our conclusions only depend on this very reproducible trend seen across all pairs of strains. We find it hard to imagine how inaccuracy in these estimates could artificially produce such a clear systematic dependence on divergence.</p><p>Nonetheless, to remove any doubts about the accuracy of this procedure, we now additionally apply the same pairwise analysis to data from simulations for which the ground truth is known. We show that the results of the pair statistics accurately reflect the known ground truth in those simulations (Figure 1—figure supplement 3 and Figure 2—figure supplement 2). In addition, in Figure 2—figure supplement 2 we directly show that the estimated fractions of clonally inherited loci are always very close to the true fractions of clonally inherited loci. This analysis shows that our method is in fact conservative in that it tends to slightly overestimate the fraction of clonally inherited loci.</p><disp-quote content-type="editor-comment"><p>1.4) Further, large recombination events are easier to detect than small ones. Also, multiple recombination events can easily be called as one, whether or not they actually overlap. This makes it very likely that the median size of recombination events is overestimated, probably substantially.</p></disp-quote><p>We agree that overlapping recombination events can lead to overestimation of the size of recombination events. Precisely for this reason, we estimated the sizes of recombination events using only comparison of very close strains that have only a handful of recombination events between them, i.e. we stated:”Using a Hidden Markov model on close pairs, we also estimated the distribution of lengths of recombined regions (see Materials and methods),” and in the Materials and methods it says:”To estimate the lengths of recombination events, we first extracted pairs that are sufficiently close (divergence less than 0.002) such that multiple overlapping recombination events are unlikely.” It appears the reviewer failed to note this. Nonetheless, to further confirm that our approach accurately estimates the size of recombination events, we applied the same approach to data from simulations for the revision. As shown in Figure 2—figure supplement 2, the sizes estimated from the simulated data are in fact very close to the true size of the recombined fragments used in the simulation.</p><p>Note also that, even if we did overestimate the size of the recombination events, it would leave virtually all the main conclusions of the paper unaffected, because almost none of our conclusions strongly depend it.</p><disp-quote content-type="editor-comment"><p>1.5) The authors nowhere acknowledge that the recombination detection method is less than perfect, attempt to quantify its errors or allow for those errors in interpreting the patterns they deduce from it.</p></disp-quote><p>It is not entirely clear which of our methods the reviewer refers to here. If this still refers to the pairwise analysis, then this comment repeats comment 1.3. We thus suspect that the reviewer must be referring to the method explained in Figure 3 and used in the results of Figures 4, 5, and 6.</p><p>First, as we pointed out in the paper, this use of bi-allelic SNPs to detect phylogenetic inconsistencies is in fact commonly used in the literature on sexually reproducing species. Second, it is not true that we pretended this method is ‘perfect’. We explicitly discuss that the method assumes that bi-allelic SNPs predominantly correspond to single substitution events, i.e. that homoplasies are rare. Indeed, to support this assumption, we included calculations in the Materials and methods to estimate the fraction of homoplasies and showed that those are very rare. Moreover, in the application in Figure 6 we explicitly discussed that the method gives only a lower bound on the number of recombination events.</p><p>However, we agree that we did not explicitly try to quantify the effects of a small fraction of homoplasies (or other errors) since we thought it was obvious that our interpretation of the results in Figures 4, 5, and 6 could not possibly be substantially affected by them. From the response of this reviewer and reviewer 2, we now see that this was apparently not obvious and that we <italic>should</italic> have done an explicit quantification. Thus, for the revision we have performed several new analyses to explicitly quantify the accuracy of this method:</p><p>1) Following questions from reviewer 2 we now quantify the rate of sequencing errors and show these are so rare that they cannot possible affect any of these analyses.</p><p>2) We have extended our model for estimating the homoplasy rate by including a 3-to-1 transition to transversion ratio in mutations (which raises the estimated homoplasy rate from 2.5% to 3.3%). In addition, we confirm the accuracy of the estimation of the homoplasy rate using data from simulations for which the exact homoplasy rate is known (Materials and methods).</p><p>3) We introduce a new method for correcting for homoplasies. In particular, we first quantify for each SNP column in the core genome to what extent it clashes with other SNP columns in its vicinity, and then remove the most inconsistent columns from the alignment. By recalculating the effect on all of our statistics (i.e. those of Figures 4, 5, and 6) of removing either 5% or 10% of potentially homoplasic columns, we show that our results are indeed not substantially affected by homoplasies (see Figure 4—figure supplement 2, Figure 5—figure supplement and Figure 6—figure supplement 1).</p><p>4) We also calculate all the relevant statistics from Figures 4, 5 and 6 for the data from the simulations and we do this both for the original data and for data from which 5% or 10% of potentially homoplasic columns have been removed. Comparisons with the known ground truth allow us to assess the accuracy and precise meaning of our statistics (see Figure 4—figure supplement 3, Figure 5—figure supplement 2, Figure 6—figure supplement 2, Figure 6—figure supplement 3 and Figure 6—figure supplement 4).</p><p>These very substantial additional analyses and validations all confirm the validity of our methods and results.</p><disp-quote content-type="editor-comment"><p>1.6) The LD plot is not new nor (more importantly) particularly well integrated with the rest of the manuscript.</p></disp-quote><p>We did not claim this analysis is new. On the contrary, we explicitly stated that this is a standard LD measure. We included it because this analysis has been used in other studies, e.g the recent analysis of thermophilic Cyanobacteria from Yellowstone, which we specifically refer to.</p><disp-quote content-type="editor-comment"><p>1.7) The section on the lower bound of recombination to substitution events fails to note that a single recombination event will introduce changes in phylogeny at both ends of the event. Therefore, even if the rest of the reasoning is correct, the estimate would be off by a factor of 2.</p></disp-quote><p>This is correct and we thank the reviewer for pointing this out. <italic>C/M</italic> is a lower bound on the number of phylogeny changes per SNP, not recombinations. Knowing that this lower bound likely strongly underestimates the true number, we sloppily failed to properly distinguish between phylogeny changes and recombination events. In the revision we now explicitly compare the lower bound <italic>C/M</italic> of phylogeny changes per SNP obtained for simulation data, with the ratio <italic>ρ/µ</italic> of recombination to mutation rate used in the simulations. This analysis shows that, at very low recombination rates, the ratio <italic>C/M</italic> is exactly twice <italic>ρ/µ</italic>, precisely for the reason that the reviewer mentions. Thus, for very low recombination rates, the ratio <italic>C/</italic>(2<italic>M</italic>) accurately estimates the recombination to mutation rate (Figure 6—figure supplement 1). At such low ratios <italic>ρ/µ</italic>, there are many SNPs columns that separate consecutive edges of recombination events on the alignment, so that each such edge leads to detectable phylogeny clashes. However, already when <italic>ρ/µ</italic> ≥ 0.05 or so (Figure 6—figure supplement 2), a substantial fraction of recombination events goes undetected because they do not result in phylogeny clashes, so that <italic>C/M</italic> is in fact substantially lower than <italic>ρ/µ</italic>. In the regime of the <italic>E. coli</italic> data, i.e. <italic>C/M</italic> ≈ 0.13, the ratio <italic>C/M</italic> likely underestimates the ratio of recombination to mutation events by more than a factor ten.</p><p>In the revision we have now paid attention to clearly distinguish the lower bound on the number of phylogeny changes <italic>C</italic>, from a lower bound on the number of recombination events, which is <italic>C/</italic>2. However, as just noted, this factor 2 correction is small compared to the factor by which the ratio <italic>C/M</italic> underestimates the true ratio of recombination to mutation.</p><disp-quote content-type="editor-comment"><p>1.8) The authors have also made no effort to quantify how large the effect of homoplasy is on these results. It may be larger than they imagine, since each homoplasy can potentially introduce two phylogeny changes. My intuition is that only a relatively small proportion of SNPs need to be affected to have quite substantial effects. Of course, this is not tested in any way.</p></disp-quote><p>As discussed already above, we have now explicitly tested this and show that, even using a very conservative procedure in which the most clashing columns are removed, and a larger fraction of columns is removed than the estimated homoplasy rate, the estimate of <italic>C/M</italic> only decreases by about 16% from 0.155 to 0.13 (see Figure 6—figure supplement 1).</p><disp-quote content-type="editor-comment"><p>1.9) Even if the estimate for C is accepted, the estimate for the number of times that each site has recombined is questionable for a few reasons. The estimate of average recombination size of 20kb is totally inappropriate to use for this purpose. As discussed above it is sure to be upwardly biased. We know in any case that there are multiple mechanisms of bacterial recombination and that they have very different length sizes. Long ones are disproportionately important in break up the clonal frame, while short ones break up the phylogeny. Dividing C by M effectively assumes, I think, that all recombinations are the mean estimated length.</p></disp-quote><p>We would like to again point out that the method for providing a lower bound <italic>C</italic> is a very standard method in the field of sexually reproducing species.</p><p>Regarding our order of magnitude estimate for the average number of times alignment positions have been overwritten by recombination, we do not make the assumption that all segments must have the same length. The argument is very simple and just based on the estimated average length <italic>L<sub>r</sub> </italic>of the recombined segments. We tried to clarify this in the revision.</p><p>Second, as we explained above, the reviewer’s claim that our estimate of the mean size of recombination segments is biased upward is based on a misunderstanding of how this estimate was done (and we now provide results from analysis of simulations to validate the accuracy of our estimation method).</p><p>Third, in the revision we use data from simulations to show that, even if we use an average length of recombined segments approximately half of what we estimate from the <italic>E. coli</italic> data, already at recombination to mutation rates as low as <italic>ρ/µ</italic> = 0.01, positions in the genome have been overwritten on average more than 12 times, and at <italic>ρ/µ</italic> = 1, positions have been overwritten on average more than 1500 times (Figure 6—figure supplement 3). In addition, using the simulation data we also show that our simple order of magnitude estimate <italic>CL<sub>r</sub>/</italic>(2<italic>L</italic>) in fact severely <italic>underestimates</italic> the true average number of times positions in the genome have been overwritten by recombination (Figure 6—figure supplement 4).</p><p>But independently of all this, we make very clear in the manuscript that this is only an order of magnitude estimate that we use to conclude that each position in the genome has been overwritten many times. The precise number is completely immaterial for the overall conclusions and message of the paper. Indeed, in the revision the number has been changed from 300 to 125 due to the factor 2 we overlooked (see response 1.7) and because we now use the 5% homoplasy corrected alignments. But, as suggested by the analysis of the simulated data (Figure 6—figure supplement 4), this estimate may well be a factor 10 below the true value. That is, it is clear that we are very far from having any loci in the genome that are not affected by recombination, and this is all that matters for our conclusions.</p><disp-quote content-type="editor-comment"><p>1.10) Furthermore, even if the estimate of C/M is taken at face value, it is difficult to interpret. There are 87 genomes in the sample, so it implies that each strain has recombined about 4 times on average at each site since the shared common ancestor. But the largest number of recombination events per site per strain that their method can detect is 1. So all that this “order of magnitude” estimate implies, I think, is that assumptions of the inference of C/M are wrong in some way, as I would expect based on the arguments above.</p></disp-quote><p>We frankly cannot follow the reasoning in this comment. There are 92 instead of 87 genomes in our sample, but this is a detail. Mutations and recombinations are not events that happen to ‘strains’, they are events that happen in the evolutionary history of a set of strains. Each mutation at a genomic position is an event that happened on a branch of the phylogenetic tree at that position. For recombinations the situation is even more complex, i.e to precisely describe the recombination events in the history of a set of strains one needs the more complex structure of a recombination graph.</p><p>The <italic>C/M</italic> value provides a lower bound on the ratio of the number of times the phylogeny changes along the alignment and the number of mutations along the alignment. Thus if the rate of SNPs is about 1<italic>/</italic>10 and <italic>C/M</italic> ≈ 1<italic>/</italic>7, it means that once every 10 alignment columns, a substitution occurred along some branch of the phylogeny at that position, and once every 7 SNPs (or 70 bps) a phylogeny change occurred, i.e. either the start or end of a recombination event that occurred somewhere in the evolutionary history of the strains.</p><p>We do agree that, per definition <italic>C/M</italic> cannot be larger than 1, and so in the limit that recombination rates are higher than mutation rates, i.e. <italic>ρ/µ &gt;</italic> 1, the lower bound <italic>C/</italic>2 will hugely underestimate the true number of recombination events (see Figure 6—figure supplement 2). This is precisely why this method can only give a lower bound.</p><p>In any case, the comparisons with ground truth in the simulations show that the estimate <italic>C/</italic>(2<italic>M</italic>) accurately estimates the ratio of recombination-to-mutation rate <italic>ρ/µ</italic> when this ratio is very low, and gives a valid lower bound when it is large. Similarly, we also show that the estimate <italic>L<sub>r</sub>C/</italic>(2<italic>L</italic>) is a valid lower bound for the average number of times each position in the alignment was overwritten by recombination. These additional comparisons with data from simulations should remove any questions about the meaning of these estimates and confirms their validity.</p><disp-quote content-type="editor-comment"><p>1.11) In any case, the authors provide little guidance on what they think the value actually means. How much of the recombination do the authors think has taken place since the evolution of the phylogroups, for example? I have no idea.</p></disp-quote><p>Although we tried to be already quite specific in the original submission, for the revision we have made sure to spell out precisely in the text what the various lower bounds mean. In particular,</p><list list-type="bullet"><list-item><p><italic>C</italic> gives a lower bound on the number of phylogeny changes in an alignment.</p></list-item><list-item><p><italic>C/</italic>2 gives a lower bound on the number of recombination events in an alignment.</p></list-item><list-item><p><italic>C/M</italic> gives a lower bound on the ratio of phylogeny changes to substitutions in the alignment.</p></list-item><list-item><p><italic>C/</italic>(2<italic>M</italic>) gives a lower bound on the number of recombination events per substitution in the alignment.</p></list-item><list-item><p><italic>T</italic><sub>est</sub> = <italic>L<sub>r</sub>C/</italic>(2<italic>L</italic>) gives a lower bound on the average number of times each position in the genome has been overwritten by recombination.</p></list-item></list><p>Note that we confirm the validity of all these lower bounds using data from simulations.</p><p>At the request of the reviewer, we have now also calculated these quantities for each of the phylogroups represented in our dataset (Appendix 1—table 2). In addition, we have added a supplementary analysis where we look in great detail at all statistics for the phylogroup B2, which is represented by 6 strains in our collection.</p><disp-quote content-type="editor-comment"><p>1.12) The n-SNP section is interesting, particular for 2-SNPs. I have not seen this in bacterial genomics and believe it can potentially be very informative. However, this section, based on weird reasoning, completely ignores the impact of clonal relationships. Pairs of strains that share a recent common ancestor will share many 2-SNPs. They have not undergone large amounts of recombination. This is obviously likely to account for many of the extremely high 2-SNP values. The so called “scale free” distribution, which I do not think is terribly helpful in any case – parameter estimation would be a better idea – is very dependent on these high values. Note also that individual large recombination events can give high 2-SNP values between pairs of less closely strains. The authors also do not discuss this at all.</p></disp-quote><p>The claims of the reviewer, i.e. that the pairs with highest 2-SNP counts are ‘obviously likely’ due to clonal pairs, and that the long-tailed distribution of 2-SNP counts is ‘very dependent’ on these clonal pairs, are both incorrect. One only needs to carefully look at Figure 9 to see that the first claim cannot be maintained. In Figure 9A strain A1 is shown to share the highest number of 2-SNPs with strains D8 (214 2-SNPS), A2 (196 2-SNPs) and A11 (194 2-SNPs). Figure 9C shows that these pairs are among the top 10 highest of all 2-SNP counts. However, only one of these three strains can share a most recent clonal ancestor with A1 so at least 2 of these three pairs do not correspond to clonal pairs.</p><p>In order to determine the exact effect of 2-SNPs from clonal pairs on the long-tailed distributions in Figure 9C we would of course have to know which pairs correspond to clonal pairs, and this is not always obvious, as the example in Figure 9A demonstrates. However, to make a conservative estimate of how much removal of clonal SNPs <italic>could</italic> have on Figures 9C and 9D we proceeded as follows: We first assumed that all SNPs that correspond to bi-partitions that occur in the clonal tree are clonal SNPs. We then removed all these potentially clonal SNPs and remade Figures 9C and D without the n-SNPs corresponding to clonal SNPs. As show in Figure 9—figure supplement 1, removal of these potentially clonal n-SNPs has very little effect on the distributions of n-SNPs.</p><disp-quote content-type="editor-comment"><p>1.13) Furthermore, there is an apparent confusion between lineages having high average rates of recombination, i.e. measured relative to time or to rates of mutation and lineages being very non-random in their patterns of recombination, i.e. which strains they recombine with. What the authors are actually measuring is much more related to the latter. These results gives no indication that strains differ in their absolute recombination rates, but this is the impression given, including in the headline conclusion that is made prominently in the Abstract. It’s really extremely unclear what the authors actually think they have shown.</p></disp-quote><p>As we already mentioned in our response 1.10, recombinations are not events that happen to strains. It therefore makes fundamentally no sense to talk about the recombination rate ‘of a strain’. We were in fact careful to talk in the Abstract about the ‘recombination rates between different <italic>lineages</italic>’ (emphasis added). Moreover, the statement in the Abstract is about the amount of <italic>variation</italic> in the recombination rates across different lineages and this is thus per definition a statement about the relative sizes of rates.</p><p>We thought that it was clear that, while the analysis in Figures 5 and 6 quantifies the absolute amount of recombination within alignments of subsets of strains, Figure 9 shows that the <italic>relative</italic> rates of recombination between different lineages vary along a long-tailed continuum that spans several orders of magnitude. To avoid any confusion, we now explicitly emphasize this point in the description of these results.</p><disp-quote content-type="editor-comment"><p>1.14) In the discussion the authors conclude (which is not novel), that the ancestral phylogeny is very difficult, or impossible to reconstruct. This is true for most bacterial species, but this is typically because there are branches at the base of the tree that are extremely uncertain. It is still likely possible to infer a great deal about bacterial evolution from inferring clonal relationships closer to the tips. For most species, this includes a fairly substantial proportion of the clonal tree. While there are the kernel of some good ideas presented, I am not sure, once the substantial issues underlined above are dealt with, that this manuscript ultimately changes our view of this in a substantive way.</p></disp-quote><p>It seems that this final comment is not so much a specific criticism of any of our analyses, but more an expression of the reviewer’s own views regarding the role of recombination in bacterial genome evolution. We understand the results of our analyses are at least partially at odds with these views, but we hope the reviewer can agree that this is not in itself a valid reason to reject our work.</p><p>Also, there is by no means consensus in the field on these points. For example, while this reviewer claims that it is ‘not novel’ to conclude that the ancestral phylogeny cannot be reconstructed, reviewer 2 seems to be of the opinion that it can. In fact, since reviewer 2 identified himself, we know that this reviewer is co-author on a well-known paper on <italic>E. coli</italic> genome evolution that makes this claim. A main aim of our manuscript is to provide new methods that can help clarify these issues.</p><p>We are of course aware that our results challenge views held by many in the field of bacterial genome evolution, and because of this we not only spend great time and effort to develop our analysis methods, extensively testing and redesigning them over more than 6 years, but we also made sure to draw conclusions based not on the results of one single method, but on the very consistent quantitative picture that emerges from multiple different and complementary methods. Thus, even if there were valid technical issues with some of our methods, we find it very hard to see how several different and complementary methods can all paint the same quantitative picture that is wrong. Unfortunately, it seems that the reviewer has completely ignored this point.</p><p>Nonetheless, for the revision we have now addressed <italic>every single one</italic> of the technical issues that were raised in the review, providing extensive additional analyses and validations to confirm that our methods were in fact all valid and support the conclusions we draw. We hope the reviewer can appreciate this and will agree with us that, having addressed all issues that were raised, there are no good reasons left to obstruct publication of this work, and allowing other researchers to learn about our analyses.</p><disp-quote content-type="editor-comment"><p>Reviewer 2 - Olivier Tenaillon:</p></disp-quote><p>Reviewer 2’s review was long and complex and there were multiple cases where the same or highly-related issues came up in different contexts. Therefore, instead of going through all comments one by one, we have attempted to bring some structure in both the issues raised and all our responses to these issues.</p><p>To provide structure to the reviewer’s comments and our responses, we start from points (i)-(vi) of the review, which provide a fairly accurate summary of the key points of the paper (maybe with exception of the interpretation of the results of Figures 7 and 9). To anticipate some of the responses to specific comments of the reviewer, we’ve added short comments to each of these points.</p><disp-quote content-type="editor-comment"><p>• Ad (i): phylogenies constructed from blocks of 3kb are distinct from whole-genome phylogeny (”core tree”), and distinct across blocks. However, phylogenies of 50% of the 3kb blocks are similar to the core tree.</p></disp-quote><p>Note that we also show that the block phylogenies are not just minor variants but that they substantially differ from the core tree. that is, we do not just do a same/different but look individually at each branch of the core tree. Half of the branches in the core tree are found in less than 25% of the block phylogenies and only a small fraction of the branches is supported by the large majority of the blocks.</p><disp-quote content-type="editor-comment"><p>• Ad (ii):when comparing pairs of <italic>E. coli</italic> genomes, SNP density is either low (interpreted as clonal inheritance of mutations) or high (interpreted as recombination). The fraction of recombination SNPs (high density regions) increases with divergence between strains. Half of the genome is recombined at a low divergence of 0.0032.</p></disp-quote><p>Note also that. even for close pairs, most SNPs derive from recombination. For example, for the green pair in Figure 2, at divergence 0.002, even though almost 90% of the alignment is clonally inherited, 90% of the SNPs lie in the recombined regions. That is, there are virtually no pairs where their divergence reflects the distance to the clonal ancestor of the pair and most of the divergence derives from recombinations.</p><disp-quote content-type="editor-comment"><p>• Ad (iii): only about half of the individual SNPs support the core tree</p></disp-quote><p>Although this is correct, the total fraction of SNPs consistent with the core tree is not very informative because a significant fraction of all SNPs correspond to a single branch (i.e. 36% of all SNPs are of the type where the outgroup has one allele and all other strains another allele). To get a more informative picture of the SNP support for the core tree we analyzed the SNP support separately for each branch of the core tree. We find that for half of the branches in the tree, the branch is rejected by 20 times as many SNPs as support it, and this applies to virtually all branches deeper in the tree (with the exception of the branch to the outgroup). The only branches that do not have a high fraction of rejecting SNPs are branches to clades of strains that are all extremely close to each other.</p><disp-quote content-type="editor-comment"><p>• Ad (iv): phylogeny changes every ∼ 10 bp along the genome, implying a ratio of recombination to mutation events of at least 0.15</p></disp-quote><p>Note that we calculated the ratio of phylogeny changes to substitution events (C/M) not only for the full alignment, but across a very large number of random subsets of strains (Figure 6). The results show that, the smaller the subset of strains, the more variable the C/M ratio, suggesting recombination rates vary across lineages. However, as soon as one looks at groups of 10 or more strains, the C/M ratio is never small (i.e. larger than 0.05 meaning a recombination occurs every 20 SNPs in the alignment of the subset).</p><disp-quote content-type="editor-comment"><p>• Ad (v): For a focal strain, they identify all strains that share a SNP with the focal strain and none of the others. The frequency distribution of the number of 2-SNPs (SNPs present in exactly 2 strains) shared by a focal strain with each other strain is scale free. This is taken as evidence that there is no group of highly recombining clades.</p></disp-quote><p>This is the one point where the reviewer’s summary does not quite match what we were intending to show. The n-SNP patterns were used for two complementary analyses. When we plot the distribution of 2-SNPs (Figure 9C), we are not looking at a focal strain but put all 2-SNPs are put’ in a pot’ and we simply plot their overall frequency distribution. That is, we are plotting the distribution of the thickness of all lines in Figure 9B (and similarly for 3-SNPs, 4-SNPs, etc). We interpret the fact that all these distributions are smooth and approximately scale-free as showing that the strains cannot be easily clustered into groups that have high within-group and low between-group recombination rates.</p><p>The second analysis, which does use focal strains, calculates entropy profiles. Whenever a focal strain occurs in different <italic>n</italic>-SNP types, all these <italic>n</italic>-SNP types are mutually inconsistent, so that each <italic>n</italic>-SNP type must correspond to a different phylogeny. For each focal strain and <italic>n</italic>, we can summarize the diversity of mutually exclusive <italic>n</italic>-SNP types by the entropy of <italic>n</italic>-SNP type frequencies (Materials and methods). This gives the entropy profiles of Figure 10 of the revision. The main result of this analysis is that, especially when <italic>n</italic> gets larger, all strains show high entropy indicating that they occur in a diverse set of phylogenies in which they belong to different subgroups of strains. In addition, the fact that the entropy profiles look different for most strains shows that the <italic>n</italic>-SNP distributions are distinct across strains.</p><p><bold>The main criticism separated into 2 parts</bold></p><p>The main criticism is that we have not provided sufficient validation for our two claims that 1. the structure of the phylogeny is generated by recombination patterns (as opposed to clonal ancestry) and that 2. there is currently no known model that can account for the patterns we observe. I would like to start by stressing that we are not contending that there is an unambiguous phylogenetic structure in the sense that when one reconstructs a phylogeny from sufficiently many genomic loci, one tends to obtain very similar phylogenies. Indeed we explicitly show this in Figure 1. The question is what this phylogenetic structure reflects. Second, for the purpose of the discussion, it is useful to separate our claims into 2 parts:</p><p>1) We show, using several complementary methods, that recombination is so dominant over clonal mutations that the clonal phylogeny cannot be reconstructed and it is unlikely that the core genome tree corresponds to the clonal phylogeny. Moreover, even if we could reconstruct the clonal phylogeny, there is such a large number of different phylogenies along the alignment that the observed mutational patterns cannot be meaningfully captured by a single phylogeny.</p><p>2) If the core genome phylogeny doesn’t reflect clonal structure, how does one explain there is a stable phylogeny? We argue that, since all genomic loci have been affected many times by recombination and thousands of different phylogenies occur along the alignment, the overall phylogenetic structure reflects the statistics of the <italic>distribution</italic> of phylogenies that occur along the alignment. We propose that these statistics reflect the relative frequencies with which recombination has occurred among different lineages. To support this we showed that, indeed, the relative frequencies with which different subsets of strains share SNPs varies over a wide continuum spanning several orders of magnitude and that almost every strain has its own distinct statistics of SNP sharing with other strains. No population genetics model that we are aware of can reproduce such statistics.</p><p><bold>Issues affecting part 1 of our claims.</bold></p><p>Let’s first discuss part 1 of our claims. The main criticism of our methods for quantifying recombination is that we fail to account for alternative explanations for phylogenetic inconsistencies and the following alternative explanations are put forward by the reviewer:</p><list list-type="alpha-lower"><list-item><p>Tree inference errors.</p></list-item><list-item><p>Sequencing errors.</p></list-item><list-item><p>Homoplasies.</p></list-item></list><p>Let’s go through points (i)-(v) and examine how each of these 3 alternative explanations would affect the results we report.</p><p><bold>Tree inference errors</bold></p><p>Tree inference errors can only affect the analysis of (i) because none of the other results rely on tree inference. As an aside, the main point of (i) is not to present new results but to introduce the main problem that our study addresses using a well-established method (PhyML).</p><p>We of course agree that there can be tree inference errors but Figure 1 shows large statistical patterns of the phylogenies across all 3Kb blocks, i.e. the fraction of 3Kb block phylogenies that support each branch of the core tree. We find that the majority of the core tree branches occur only in a minority of the 3Kb block phylogenies. We cannot see how tree inference errors could substantially affect such broad statistics. Note also that each block significantly rejects the phylogeny of each other block (Figure 1—figure supplement 2), i.e the log-likelihood differences between different phylogenies on a given alignment block are never small. To argue that the apparent inconsistencies between the phylogenies of 3Kb blocks are artefacts of tree inference errors one would have to argue that the ML inference on alignment blocks is so error prone that even overall statistical patterns (i.e. fractions of blocks agreeing on the occurrence of particular bipartitions) cannot be trusted at all. This would essentially invalidate <italic>any</italic> analysis using ML phylogeny reconstruction and it seems unlikely to us that the reviewer really wants to claim that.</p><p>However, since Figure 1 is only used to introduce the problem we analyze, even if the reviewer wants to discount the results of Figure 1 altogether, this does not really affect any of the methods and conclusions we present.</p><p><bold>Sequencing errors</bold></p><p>We completely agree that we should have included more about the sequencing methods and the potential rate of sequencing errors. For the revision we have now included a section at the start of the methods describing the sequencing procedures and the core alignment construction using Realphy. Realphy is in fact very conservative in what alignment columns to include in the core genome alignment and we also show that, from the occurrence of multiple independent genomes that are <italic>identical</italic> in the core genome, we can bound the rate of sequencing errors to be less than 1.1 ∗ 10<sup>−7</sup>.</p><p>In the methods we now also provide a new section that shows, using a simple calculation, that sequencing errors can account for at most one in every hundred thousand informative SNPs, which obviously is not going to meaningfully affect any of the results.</p><p><bold>Homoplasies</bold></p><p>This leaves homoplasies. We agree with the reviewer that if the rate of homoplasy were very high (e.g. if the majority of SNPs were homoplasies), then this would be problematic. Indeed, to show that homoplasies must be rare we presented analysis in the methods to give a rough estimate of the rate of homoplasy. The most relevant estimate is for synonymous sites excluding the outgroup and gives that about 2.5% of all bi-allelic SNPs are homoplasies (i.e. more than 1 mutation occurred).</p><p>One criticism that the reviewer had is that we may be significantly underestimating the homoplasy rate because we ignore heterogeneity in mutation rates, in particular that transition mutations are more frequent than transversion mutations. For the revision we have now redone the analysis using a 3-to-1 transition to reversion ratio. We show that this only raises the estimated homoplasy rate from 2.5% to 3.3%, i.e. still well below 5%.</p><p>Note that, for the revision, we have developed new software for simulating populations evolving under drift, mutation, and recombination (of the type where a genomic segment from one individual is recombined in the genome of another) while at the same time keeping track of the clonal phylogeny, and the number of times each position on each branch of the clonal tree is affected by recombination. We then used this software to simulate populations evolving under a large range of recombination rates. Throughout the revision we use data from these simulations to validate our analysis methods and to compare results on <italic>E. coli</italic> with corresponding results from simulations for which the ground truth is known.</p><p>To confirm the accuracy of the estimation method for the rate of homoplasies, we used data from our simulations and compared the estimated rate of homoplasy with the true rate of homoplasy in the alignment, finding them to be virtually identical, i.e. 2.43% estimated versus 2.56% true rate.</p><p>We thought that it would be obvious that such a low rate of homoplasy, although of course affecting the precise values of the various statistics, could not meaningfully affect any of our conclusions. However, both this reviewer and reviewer 1 question this, suggesting that even a fairly low rate of homoplasy could have large effects on the results of the analysis. To dispel this concern we developed a method that estimates the maximal effect homoplasies can have on the results, by identifying those SNP columns in the alignment that lead to the largest number of clashes with other SNP columns, and removing either the 5% or 10% most clashing SNP columns. We then redid all the analyses with such ‘homoplasy-corrected’ alignments and included comparison of the original and homoplasy-corrected results in the revision. In addition, we also performed such comparisons for all the data from the simulations.</p><p>Note that our method is conservative because it does not just remove potentially homoplasic columns, but systematically removes those columns that lead to the largest number of inconsistencies. In addition, we remove up to 3-fold more columns than the estimated rate of homoplasies. We now discuss what this new analysis showed about the effect of homoplasies on each of our results.</p><p>Effect of homoplasies on the results (ii): The analysis in (ii) is not based on phylogenetic inconsistencies at all and just looks at the patterns of SNP density in pairwise alignments. Therefore, these analyses are not affected at all by homoplasies and neither are the conclusions from the pairwise analysis, i.e. that for the vast majority of pairs no clonally inherited DNA is left in their pairwise alignment, and that even for close pairs for which most genomic segments were clonally inherited, the large majority of their SNPs comes from recombined regions.</p><p>Note also that in the revision we extensively validate the accuracy of the pairwise analyses using data from simulations (Figure 1—figure supplement 3, Figure 2—figure supplement 1 and Figure 2—figure supplement 2).</p><p>Effect of homoplasies on the results (iii): Regarding (iii), our main observation in Figure 4 is that for half of the branches in the core tree, there are 20 times as many conflicting as supporting SNPs. As shown in Figure 4—figure supplement 2, these results are virtually unchanged for the homoplasy-corrected alignments for which 5% or 10% of the most clashing SNP columns have been removed.</p><p>To further explore the possible effect of homoplasies on this type of analyses, Figure 4—figure supplement 3 shows the same analysis on the simulated datasets. We see that homoplasies only significantly affect the results when there is no recombination at all. In this case all clashing SNPs result from homoplasies and the homoplasy removal has a substantial effect, i.e. only after 5% of homoplasies have been removed does the analysis confirm that there is essentially 100% SNP support for each branch.</p><p>The analysis of the simulation data also confirm what our pairwise analysis already indicated: that even in situations where most genomic loci are clonally inherited, the large majority of the SNPs can result from recombination events. In particular, for the low recombination rate of <italic>ρ/µ</italic> = 0.01, most genomic loci are clonally inherited along all but the long inner branches of the clonal tree (Figure 1—figure supplement 3). However, for most pairs of strains, including pairs for which almost all loci were clonally inherited, most of their divergence derives from recombination events (Figure 2—figure supplement 1), and this is confirmed by the analysis in Figure 4—figure supplement 3, which shows that for simulations with <italic>ρ/µ</italic> = 0.01, half of the branches have less than 20% support.</p><p>Effect of homoplasies on the results (iv): Homoplasies are most relevant for the analysis of (iv) and we agree with the reviewer that it is worthwhile to investigate how much homoplasies can affect the results shown in Figures 5 and 6. For the revision we have now explicitly done so by redoing all these analyses on the homoplasy-corrected alignments. In addition, to further validate these analyses, we have also performed all these analyses on the data from the simulations, including investigating the effect of removing 5% or 10% of potentially homoplasic sites from the alignments of the simulation data.</p><p>As shown in the new Figure 5—figure supplement 2 and Appendix 1—table 1, the distribution of the number of consecutive tree-compatible SNPs is only very modestly affected by the removal of potentially homoplasic SNPs, i.e. the average number of consecutive tree-compatible SNPs increases from 7.6 to 8.8 when 5% of potentially homoplasic sites are removed. For the simulation data, the removal of homoplasies only significantly affects the results for low recombination rates <italic>ρ/µ</italic> ≤ 0.01, i.e. exactly when the frequency of true recombination events is lower than the frequency of homoplasies. However, the <italic>E. coli</italic> data is clearly in the regime where homoplasies have little effect on this statistic.</p><p>As shown in the new Figure 6—figure supplement 1, the observed ratios <italic>C/M</italic> for random subsets of strains are about 20% higher for the full alignment than for the 5% homoplasy-corrected alignment, i.e. <italic>C/M</italic> increases from 0.13 to 0.155 for the full set of strains. For the revision, we now show the results from the 5% homoplasy-corrected alignment in the main paper. In addition, following a request by reviewer 1, we also show <italic>C/M</italic> statistics for the subsets of strains of different phylogroups represented in our data (Appendix 1—table 2).</p><p>The analysis of C/M on the simulation data allows us to compare the lower bound on the recombination to mutation ratio <italic>C/</italic>(2<italic>M</italic>) with the ground truth, i.e. the ratio <italic>ρ/µ</italic> in the simulations. This analysis shows (Figure 6—figure supplement 2) that for very low recombination rates, i.e. <italic>ρ/µ</italic> ≤ 0.01, the ratio <italic>C/</italic>(2<italic>M</italic>) actually estimates the true recombination to mutation rate very accurately. However, as <italic>ρ</italic> increases the ratio <italic>C/</italic>(2<italic>M</italic>) severely underestimates the true ratio of recombination to mutation rate. For example, for the <italic>E. coli</italic> data we have <italic>C/</italic>(2<italic>M</italic>) ≈ 0.065, which is very close to the observed ratio <italic>C/</italic>(2<italic>M</italic>) for simulations with <italic>ρ/µ</italic> = 1, i.e. almost 20-fold higher.</p><p>We also expanded the section on the lower bound for the average number of times each position in the genome has been overwritten by recombination. Using data from simulations for which the ground truth is known we show that only at <italic>ρ/µ</italic> = 0.001 are there any positions left that have <italic>not</italic> been overwritten by recombination, at <italic>ρ/µ</italic> = 0.1 positions have been overwritten 120 − 200 times, and at <italic>ρ/µ</italic> = 1 each position has been overwritten 1450 − 1700 times by recombination (Figure 6—figure supplement 3). We also show (Figure 6—figure supplement 4) that our lower bound on the number of times each position has been overwritten by recombination is strongly underestimating the true number as soon as <italic>ρ/µ</italic> ≥ 0.1. Thus, although the lower bound for the <italic>E. coli</italic> data is that each position has been overwritten at least 125 times by recombination, the true number is likely larger than 1000 times.</p><p>Effect of homoplasies on the results (v): For the revision, we show in Figure 9—figure supplement 1 that the <italic>n</italic>-SNP distributions of the 5% homoplasy-corrected alignment are virtually identical to <italic>n</italic>SNP distributions of the full alignment. Also, none of the 2-SNPs in Figure 9A were removed by the 5% homoplasy correction.</p><p>Even though homoplasies hardly affect the overall patterns we see in the <italic>n</italic>-SNP statistics, for the revision we nonetheless used the 5% homoplasy-corrected alignments for all the <italic>E. coli</italic> results shown on <italic>n</italic>-SNP distributions and entropy profiles.</p><p><bold>Response to miscellaneous comments regarding part 1 of our claim</bold></p><p>For completeness, we will also address the remaining other comments that reviewer 2 made regarding part 1 of our claims.</p><p><bold>Using a strict criterion of phylogenetic consistency</bold></p><p>First, there are these 3 related comments:</p><disp-quote content-type="editor-comment"><p>A lot of the issues come from the use of a strict criterion for phylogeny support, that with more strains added gives an evident discrepancy as soon as a bit of recombination or homoplasy is present. So the present manuscript strongly validates the idea that there is some recombination but falls short of telling significantly how strong.</p><p>The larger the dataset, the most likely it is that each fragment will be affected to some extent by both of these processes, and the phylogeny will be different, but if one strain out of 100 is changing place in the phylogeny, the phylogeny will be said to be incompatible, though it still holds some strong information. Similarly, for the bi-partition analysis, the more strains there are below a branch, the more likely it is that one of the strains will not fit the bi-partition. So once again the analysis is not conclusive regarding the quantitative importance of recombination.</p><p>Analyses based on comparison of phylogenies (i), (iii), (iv) would benefit from a more progressive metric of agreement between two phylogenies. Two phylogenies can conflict for very minor reasons (e.g. different structure of small terminal sub-trees) or major topological changes. The authors choose a binary measure to compare phylogenies based on the presence or not of a specific strain bi-partition. But one could use a progressive measure of distance between two bi-partitions, e.g. based on the transfer distance (number of taxa that must be transferred to make the two bi-partitions identical) Lemoine et al. Nature 2018. In principle changes in topologies along the genome should be due to minor differences (small transfer distances).</p></disp-quote><p>We of course agree that, the more strains are involved, the easier it becomes to detect phylogenetic inconsistencies. We also agree that more ‘soft’ or graded measures of inconsistency across phylogenies could be useful to measure the statistics of similarities of the different phylogenies that occur along the alignment. The problem is, however, that if there is a lot of population structure such that relative recombination rates are very different across lineages (as we indeed claim is the case) then even when there is a saturating amount of recombination, the phylogenies at different loci may still show significant similarities. Therefore, one cannot reliably take similarity of phylogenies as a measure for the amount of recombination that has occurred.</p><p>A strict measure of inconsistency is in fact a more reliable way to quantify the amount of recombination. In particular, whether ‘small’ or ‘large’, each inconsistency is still an inconsistency. For each such inconsistency, there either is another explanation (e.g. homoplasy), or else it indicates the occurrence of a recombination event. The methods of Figures 3-6 precisely use this fact to quantify how much recombination must have occurred. And as mentioned already, the methods we use here are variations of very standard approaches used in the field of sexually reproducing eukaryotes.</p><p>We cannot understand how the reviewer can claim that we did not provide quantitative estimates of the importance of recombination. In fact, we provide several very direct quantifications of the amount and importance of recombination using several different methods. These include:</p><list list-type="bullet"><list-item><p>Figure 2G quantifies what fraction of the core genome alignment of pairs of strains has been recombined as a function of their total divergence. This is a direct quantitative measure of the strength of recombination that does not rely on any phylogenetic consistency evaluations at all.</p></list-item><list-item><p>Figure 2H quantifies, for each pair of strain, what fraction of nucleotide differences between them were derived ancestrally versus from recombination events. This directly quantifies how much of the pairwise divergence of each pair is due to recombination, and again this measure does not use phylogenetic consistency at all.</p></list-item><list-item><p>Figure 4 shows the relative numbers of supporting vs. inconsistent SNPs, separately for each branch of the tree. Although this is a more indirect measure of the amount of recombination, it does directly quantify the amount of inconsistency separately for each branch of the core tree.</p></list-item><list-item><p>Figure 6 provides a direct lower bound on the ratio <italic>C/M</italic> of the number of phylogeny changes to mutation events in the core alignments not only of the full set of strains, but for arbitrary subsets of any number of strains. We can hardly see what more direct quantitative bound on the amount of recombination one could give. Indeed, our simulation analyses confirm that <italic>C/</italic>(2<italic>M</italic>) is a direct lower bound on the overall recombination to mutation ratio.</p></list-item></list><p><bold>Heterogeneity of rates along the genome and effects of selection:</bold></p><disp-quote content-type="editor-comment"><p>The distribution of differences along the genome is also not supposed to be homogenous along the core genome. Some genes are much more conserved than others even at synonymous sites, and the mutation rate has been shown to be locally heterogenous. Selection on recombinant may also differ along the genome, and some regions like the O-antigene lead to strong selection of recombinant that affect the neighbouring core genes. These regions may increase the estimated contribution of recombination. Selection may also counter select recent recombinant and lead to an overestimation recombination: in a similar way based on recent phage insertion in genomes we could conjecture that ancestral genomes should be only composed of prophages.</p></disp-quote><p>We think it is important to distinguish between the actual rates at which mutations and recombinations are introduced into individuals of the evolving populations, and the number of substitutions and recombination events that have occurred in the evolutionary history of the sequences in the core genome alignment. We are nowhere in the article attempting to estimate the actual mutation and recombination rates precisely because it is obviously very hard to accurately estimate the size of the effects of selection. Instead, we aim to provide estimates and bounds for the number of substitutions and recombination events that have occurred in the history of the observed strains. We tried to make this point clear in the revision.</p><p><bold>Reconciliation with approaches that claim to remove recombination events:</bold></p><disp-quote content-type="editor-comment"><p>It is difficult to reconcile this set of analysis with how people deal with recombination in bacterial genomics. Softwares exist to remove recombination events, some of them similar to the approach used by the authors (Figure 2), e.g. Gubbins or others (Bratnextgen). These allow estimating ratios of SNPs introduced by recombination over mutation (r/m ratios). Phylogenies can then be inferred on alignments without recombination. How does this approach compare to the authors’?</p></disp-quote><p>Although we did not refer to the two specific methods mentioned here (i.e. Gubbins and Bratnextgen), we discussed this general issue in the discussion of the results in Figure 1, i.e. we wrote:</p><p>“How should we interpret this convergence of phylogenies to the core phylogeny as increasing numbers of genomic loci are included? One interpretation that has been proposed, is that once a large number of genomic segments is considered, effects of horizontal transfer are effectively averaged out, and the phylogeny that emerges corresponds to the clonal ancestry of the strains, e.g. [8,11]. Indeed, it has become quite common for researchers to detect and quantify recombination using methods that compare local phylogenetic patterns with an overall reference phylogeny constructed from the entire genome, e.g. [11–15]. However, the validity of such approaches rests on the assumption that this reference phylogeny really represents the clonal phylogeny, and it is currently unclear whether this is justified. Indeed, some recent studies have argued that recombination is so common in some bacterial species that it is impossible to meaningfully reconstruct the clonal ancestry from the genome sequences, and that these species should be considered freely recombining, e.g. [27].”</p><p>Like the methods we cite here, methods like Gubbins and Bratnextgen simply start from the assumption that recombination is sufficiently limited such that the clonal phylogeny can be inferred from the core genome alignment. In particular, these methods assume that there are sufficiently many genomic loci whose phylogeny has not been disturbed by recombination so that the clonal phylogeny can be inferred from those loci. However, we are not aware of any demonstration that real data of bacterial genomes are in the regime where this assumption holds and, as we point out, there is no agreement in the community on this fact. Indeed, reviewer 1 expresses the opinion that it is true and ‘not novel’ that the precise clonal phylogeny cannot be reconstructed for most bacterial species.</p><p>One of the aims of our work is to rigorously investigate this assumption and we feel that our results clearly show that recombination occurs so often that no loci evolve free from recombination, and the clonal phylogeny cannot be reconstructed at all. In other words, we maintain that methods like Gubbins and Bratnextgen start from assumptions that do not hold for the bacterial species that we analyzed. We made this point clear in the revision.</p><p><bold>Summary, status of part 1 of our claims</bold></p><p>In summary, all our additional analyses and validations using data from simulations show that <italic>none</italic> of the technical issues raised can substantially effect any of the results (i)-(v). But even if there were valid questions about the reliability of some of our statistics, we feel that the validity of our overall conclusions are supported by something far stronger. The results of (i)-(v) are based on very different and mutually complementary methods, and these analyses all independently paint the same quantitatively consistent picture, i.e. that recombination is completely dominating and has overwritten virtually all clonal structure. Even if there were a technical problem with one or other of these methods, we find it extremely hard to see how <italic>all</italic> of the methods could consistently create the wrong impression that recombination is dominating.</p><p>In order to maintain the belief that, in spite of all our results, the clonal structure is what is determining the core genome phylogeny, one would have to argue that all results (i)-(v) are not only all wrong, but that they somehow also all fortuitously paint the same quantitative picture, and that for some reason they also by sheer luck happen to paint a correct picture on simulation data. We submit that this is simply not believable.</p><p><bold>Part 2 of our claims</bold></p><p>To most constructively discuss part 2 of our claims, we think it useful to start with the following comment from the end of the review:</p><disp-quote content-type="editor-comment"><p>Overall, a lot of remaining questions are not solved by the present model: if recombination is so massive, we would expect each transferred fragment to be itself the result of multiple fragments and therefore to leave a somehow fragmented signature of recombination, how does this model allow diversification to occur and most importantly why is the phylogeny overall stable since the use of MLST two decades ago…</p></disp-quote><p>First, as already mentioned above, we do not at all dispute that a clear phylogenetic structure is present in the data. Indeed we start by explicitly showing in Figure 1 that, given sufficiently many genomic loci, the phylogeny reconstructed from them converges to the core genome phylogeny. As we pointed out in the discussion of this result, some in the field see no alternative but to conclude that this stable phylogeny must correspond to the clonal phylogeny. But it is not at all impossible for there to be massive recombination and a stable genome-wide phylogeny at the same time. Even if, through massive recombination, there is a large number of different phylogenies along the genome, an algorithm that attempts to fit the data assuming a single phylogeny (like PhyML), will generally still converge to a stable result when given sufficient data. To give an analogy, imagine that we fit data coming from a complex mixture of Gaussian distributions to a single Gaussian. Given sufficiently many samples from the complex distribution, the fit to a single Gaussian will become very stable, even though the underlying distribution is not a simple Gaussian at all.</p><p>Since there clearly was confusion on this point we have included new sections in the revision explaining these points in detail. In particular, we illustrate the point by constructing phylogenies (using PhyML) from autosomal sequences from the 1000 genomes project, i.e. human genomes. We show that, even though there is of course no such thing as a clonal phylogeny for human autosomal chromosomes, phylogenies reconstructed from sufficiently many loci robustly converge to the’ core’ phylogeny. Moreover, this phylogeny reflects known population structure, i.e. individuals from the same geographic regions consistently form clades in the phylogeny (Figure 8). That is, humans with ancestors who predominantly come from a common geographic area end up closer in this phylogeny because they are more likely to share recent ancestors <italic>on average</italic> across the different phylogenies along the genome. In exactly the same way, we propose that the whole genome phylogenies for many bacterial species reflect the statistics of recombination between their ancestors.</p><p><bold>Do 'close' strains recombine more often?</bold></p><disp-quote content-type="editor-comment"><p>It seems that strains share SNPs much more frequently with close strains. This information can be found for strain A1 from comparing Figure 7A and Figure 1—figure supplement 1, showing that strain A1 shares a lot of 2-SNPs with its neighbours H5, D8, A2. If these SNPs are indeed shared because of the action of recombination, this means that a good description of recombination patterns would be one where the rate of recombination between pairs of strains is a decreasing function of their divergence. This relationship must be systematically investigated and presented. This relationship has been known for a while, has been used in models of diversification (e.g. Fraser et al., 2007) and seems a natural way to describe recombination structure. Yet this is not mentioned at all in the text.</p></disp-quote><p>I think this comment is very valuable because it illustrates so clearly the confusion that results from continuing to think of pairwise divergence as reflecting the distance to a clonal ancestor. That is, the reviewer’s comment presupposes that the pairwise divergences and rates of recombination are separate independent entities which do not <italic>a priori</italic> need to correlate, but that the data just happen to suggest that they do.</p><p>However, in the regime where recombination dominates almost every SNP can be thought of as deriving from an independent phylogeny. In that limit, in order for two strains <italic>x</italic> and <italic>y</italic> to have a different nucleotide in a given SNP column, the mutation must be more recent than the common ancestor of <italic>x</italic> and <italic>y</italic> in the phylogeny <italic>at that position</italic>. Thus, the divergence of a pair of strains does not reflect the distance to their clonal ancestor, but the <italic>average</italic> distance to their common ancestors across the many different trees. And these distances depend precisely on how often the lineages of strains <italic>x</italic> and <italic>y</italic> have recombined. If their lineages recombine rarely, then on average their common ancestors will lie further in the past, and if they recombine a lot, their common ancestors will on average be recent. Thus, when recombination dominates the pairwise divergence of two strains is a direct reflection of the recombination rates of their lineages, and it becomes almost a tautology that the lineages of strains that have low pairwise divergence must have recombined frequently. That is, rather than a surprising observation this correlation is in fact predicted by our interpretation of the data.</p><p>In the revision we have added comments to make this point clear. Also, we have added an Appendix in which we perform an in-depth analysis of the recombination structure of phylogroup B2 (to which the strains the reviewer mentions belong) to further illustrate and confirm this interpretation.</p><p><bold>Entropy profiles of <italic>n</italic>-SNPs</bold></p><disp-quote content-type="editor-comment"><p>We are not convinced about the interpretation of the 2-SNP, 3-SNP, etc., analysis. This analysis is interpreted as implying that each strain has a unique recombination profile, that “there is no natural way of dividing the strains into groups of highly recombining clades” and that individuals are not exchangeable. How do the authors quantify the uniqueness of the’ entropy profiles’ (Figure 10)?</p></disp-quote><p>For the revision, we have significantly extended the analysis of the entropy profiles and this answers the question of the reviewer in several ways. Apart from showing the entropy profiles of all <italic>E. coli</italic> strains in the main text, and discussing several example profiles, we now also show the entropy profiles of the strains of each of the phylogroups that are represented in the dataset (Figure 10—figure supplement 1). This analysis shows that, when a group of strains has a very recent common ancestor, their entropy profiles <italic>H<sub>n</sub></italic>(<italic>s</italic>) are not just similar, they are exactly identical. In contrast, entropy profiles <italic>H<sub>n</sub></italic>(<italic>s</italic>) for strains of the same phylogroup look similar for large <italic>n</italic>, but they are never identical. Moreover, entropy profiles of strains from different phylogroups tend to look clearly different, even at large <italic>n</italic>.</p><p>Following the reviewer’s comments, we also developed a statistical test (based on the Fisher exact test) for testing the difference in <italic>n</italic>-SNP statistics for a pair of strains. This analysis shows that about 95% of all pairs of strains have significantly different entropy profiles (Figure 10—figure supplement 2). Finally, we also show that the entropy profiles of the data of the simulations look very different from those of the <italic>E. coli</italic> data. Instead of highly variable entropy profiles, entropy profiles from simulations show consistently low entropies at low recombination rates, and very similar looking entropy profiles for all strains at high recombination rates (Figure 10—figure supplement 3).</p><p><bold>What do we mean with a population of exchangeable individuals?</bold></p><disp-quote content-type="editor-comment"><p>Finally, the article starts by posing two cornerstones of bacterial epidemiology: a robust phylogeny and a population like structure. It is not clear to us what is the meaning of the second assertion and how recombination differs from mutation in that process. In a coalescent as much as in coalescent with recombination, the genealogy has fractal structure and any of the possible clustering relies on some arbitrary choice. Whether mutation or recombination contribute to that process, there is no clear definition of population. Only at the ecological level can one find within a population of hosts some discrete bacterial populations.</p></disp-quote><p>We are here referring specifically to the concept of a population of exchangeable individuals in <italic>mathematical models</italic> of evolutionary dynamics. In mathematical population genetics models members of the ‘same population’ are treated as exchangeable. For example, in coalescent models, each pair of lineages is equally likely to coalesce. In models with recombination, such as the one we use in the simulations, each pair of individuals is equally likely to recombine. Even in models with substructure, e.g. with different subpopulations with migration between them, the members within each sub-population are still treated as exchangeable.</p><p>We believe that, in order to successfully model the <italic>n</italic>-SNP statistics and entropy profiles that we observe, we would have to introduce almost as many subpopulations as there are strains in our collection. If one needs almost as many subpopulations as there are strains to successfully model the observations, it becomes reasonable to question whether models that start from subpopulations of exchangeable individuals are appropriate at all. In the revision we have attempted to clarify these points.</p><p><bold>What would <italic>n</italic>-SNP distributions look like for no or free recombination?</bold></p><disp-quote content-type="editor-comment"><p>Moreover, while the distribution of 2-SNP for one strain may reflect some recombination, it is not clear what is expected for the overall distribution in the absence of recombination. A simple coalescent process could also presumably lead to a long-tailed distribution. The arguments made in the text on the typical mode of 2-SNP in the case of free recombination is not substantiated and should be validated by simulations or an analytical derivation. The whole topology of the tree will affect how many sites are shared by two strains. If a pair of strains coalesced, what matter for 2SNP is the time of the coalescence of their ancestor. This is not a homogeneous distribution. We need to know how much the distribution is informative about the recombination process, but the manuscript in its present form is not addressing that question: what is expected in the absence of recombination, in the presence of homoplasy, how much a little bit of recombination is affecting the patterns… These are key question if one want as the author to challenge the whole idea of phylogeny.</p></disp-quote><p>These are valid points. We could have discussed much more the interpretation of these distributions of <italic>n</italic>-SNPs. In addition, we agree that it is useful to see what such distributions look like for simulations of either a simple Kingman coalescent without recombination, or a model with mutation and free recombination within a well-mixed population. As already discussed, for the revision we have developed simulation code and performed such simulations with a large range of recombination-to-mutation rate ratios.</p><p>In the revision we now use the 5% homoplasy-corrected alignments for the <italic>n</italic>-SNP analysis, and in Appendix 4 we present extensive comparison of the <italic>n</italic>-SNP distributions observed for <italic>E. coli</italic> with those observed for the simulations, either without recombination, or with different recombination rates. This analysis shows that <italic>n</italic>-SNP statistics observed for <italic>E. coli</italic> are fundamentally different from the <italic>n</italic>-SNP statistics observed for any of the simulations. In particular, we confirm that at recombination rates as high as we observe for the <italic>E. coli</italic> data, no long-tailed distributions of <italic>n</italic>-SNPs are observed in the simulations.</p><p>Finally, we agree that the number of <italic>n</italic>-SNPs of a given type does not only depend on the fraction of the phylogenies along the genome for which that group of <italic>n</italic> strains form a clade in the tree, but also on the average length of the branch from their ancestor to the next coalescence. In the revision we have now explicitly pointed this out.</p><p><bold>Is our set of strains special?</bold></p><disp-quote content-type="editor-comment"><p>Of note the strains were also isolated in some atypical reservoir of <italic>E. coli</italic>. In this ecological niche it is not impossible that recent transfer may be magnified due to higher action of phage and larger diversity than within a regular gut (colonised by a few strains maximum). However the fact that the pattern is similar to the one described by Dixit and Maslov suggest this may not be too much of an issue.</p></disp-quote><p>The fact that we observed very similar statistics for the other species already shows that our observations are not specific to our set of <italic>E. coli</italic> strains. However, we have also performed our analyses on a collection of <italic>E. coli</italic> genomes from public databases and confirmed that these show the same overall patterns. We could in principle also include these analyses but this would be quite some extra work and we don’t think this would bring any useful additional information.</p><disp-quote content-type="editor-comment"><p>Reviewer 3 - Daniel Weissman</p><p>3.1) This is a very exciting manuscript that changed the way that I think about bacterial evolution. The key findings are:</p><p>• For several different species of bacteria, there are essentially no parts of the genome that are inherited along the clonal phylogeny in samples of size 100.</p><p>• Despite this, there is a clear preferred genome tree, indicating that there are patterns in which some strains preferentially recombine with each other. These patterns persist deep into the past, beyond the point at which every gene has recombined off the clonal phylogeny.</p></disp-quote><p>We thank the reviewer for these comments. It is very rewarding to see that some readers do appreciate the key points of our work.</p><disp-quote content-type="editor-comment"><p>3.2) These findings indicate that there is some hidden structure in the studied bacterial populations. I think the nature of this structure is a real mystery. It could be ecological, epistatic, spontaneously arising from genome divergence suppressing recombination, or something else entirely. I hope that this paper will spark a wave of interest in trying to figure out what population genetics should look like in most of the tree of life. The authors make a first attempt at this by looking at some interesting distributions of shared SNPs across strains. I found these distributions hard to interpret and wasn’t sure about all the details of the analysis, but I think it’s good to try out some new ways of looking at the data.</p></disp-quote><p>We completely agree with the reviewer. Indeed, the key question is now to understand what this ‘population structure’ setting these very different relative rates of recombination between different lineages represents. We also agree that our <italic>n</italic>-SNP distributions (and <italic>n</italic>-SNP entropy profiles) are only a first step toward solving this puzzle. To make clearer what these <italic>n</italic>-SNP distributions represent, we now also calculate these distributions for data from simulations of completely mixed populations evolving under (neutral) mutation, drift, and recombination and compare and contrast the patterns that are observed for the real data with the patterns that are observed from these simulations. We also show what the entropy profiles look like for the traditional <italic>E. coli</italic> phylogroups.</p><disp-quote content-type="editor-comment"><p>3.3) I would partially reorganize the paper so that it’s organized more by method/analysis than species. Concretely, I would move Figure 7 (non-<italic>E. coli</italic> bacteria) and the accompanying analysis up so that they come before Figure 9 (SNP-sharing distributions) and its accompanying analysis. This way, you would introduce the tree analysis in <italic>E. coli</italic>, then apply it to other species showing that you get similar results, then move on to SNP sharing.</p></disp-quote><p>Upon reflection, we agree with the reviewer that it makes sense to first show that the dominance of recombination is also observed for other species, and then turn to the question about what the phylogenetic structure in the data represents. Thus, for the revision we have reorganized the presentation as suggested by the reviewer.</p><disp-quote content-type="editor-comment"><p>3.4) I would try changing the analysis comparing SNPs to putative branches. Right now, it’s just consistent vs inconsistent, which is nice because it’s simple. But I don’t think it’s that informative. If you have a putative branch that splits the sample in half, and a SNP at 50% frequency, and they totally agree except for a single sample, that gets called “inconsistent”, whereas a random SNP that’s only found in a pair of individuals has a 50% chance of being consistent. Similarly, a putative branch that just lies above a pair of samples will be consistent with lots of SNPs just by chance. What about using mutual information, either instead of consistency or as an additional analysis? I think that Figure 8—figure supplement 1 indicates that you have lots of SNPs that are nearly or partly consistent, given that you recover something very close to the original tree using only inconsistent SNPs. Hopefully an MI analysis would pick these up as still being correlated with the branches. (Of course, MI can’t go negative, but you can still classify branch-SNP pairs as correlated or not depending on whether the MI exceeds what you would get if you drew them both at random conditioning on number of strains under the branch and SNP frequency.)</p></disp-quote><p>In Figures 4, 5, and 6 the aim is to show that the SNP inconsistencies imply certain lower bounds on the number of recombination events and show that very large fractions of SNPs do not correspond to mutations along the branches of the core tree, i.e. that one cannot approximate the dynamics as taking place along the branches of the tree. For that it is essential to categorize SNPs as simply consistent/inconsistent with particular tree branches or with each other.</p><p>At the same time, we of course agree that the distribution of SNP types is not random at all but that some lineages are much more likely to recombine with each other than others. That is, whereas recombination is so frequent that many thousands of phylogenies occur along the alignment, these phylogenies are not completely random but drawn from some biased distribution over phylogenies. How to efficiently capture or summarize this distribution over phylogenies is an entirely separate question. In the paper we have proposed the <italic>n</italic>-SNP distributions and <italic>n-</italic>SNP entropy profiles of individual strains. For the revision we now also provide a new statistic that quantifies the similarity of the <italic>n</italic>-SNP statistics of two strains. We agree that additional more graded measures of similarity between SNPs could be helpful but it is not entirely clear to us what precisely measures such as the mutual information that the reviewer proposes would capture. It is still the case that a single recombination event can either make a large or a small change to the SNP pattern.</p><p>Figure 8—figure supplement 1 simply shows that, if one is forced to summarize the patterns of SNP sharing across the strains (which really reflects the distribution of phylogenies along the alignment) by a single ‘average’ phylogeny, then this average is very similar whether one includes the SNPs that actually fall on this tree or not. This observation is analogous to observing that the median or average of a sample from a distribution is typically unchanged under removing data points near this median/average.</p><disp-quote content-type="editor-comment"><p>3.5) I don’t understand the argument that because Figure 9C shows broad distributions, that must mean that strains are not organized into subpopulations. Figure 11—figure supplement 3 shows a similar pattern for humans – are the authors claiming that subpopulations are not a good description of the human data? At the very least, couldn’t the sub-population sizes be broadly distributed? But more basically, do we know what these distributions should look like in a simple well-mixed, recombining Wright-Fisher population? I’m sorry, I really meant to simulate this, but I’m turning in this review late as it is. Maybe you get that the occurrence of a particular kind of n-SNP can be dominated by its occurrence on a single genome block?</p></disp-quote><p>We agree that interpreting what the <italic>n</italic>-SNP distributions indicate regarding the population structure is still challenging at this point. We presume that, if there were clear subpopulations with high recombination rates within them, and low recombination rates between them, then this would be visible as specific substructure in the <italic>n</italic>-SNP distributions. However, we agree we have no strong argument to support this and for the revision we have rewritten this section to make clear that the precise interpretation of the <italic>n</italic>-SNP distributions is currently unclear.</p><p>Following the suggestion of the reviewer, we now extensively compare the observed <italic>n</italic>-SNP statistics with statistics from simulations of a simple well-mixed Wright-Fisher model with the product of population size and mutation rate set to match the sequence diversity observed in our <italic>E. coli</italic> strains, and recombination-to-mutation rates ranging from <italic>ρ/µ</italic> = 0.001 to <italic>ρ/µ</italic> = 10 (Appendix 4). We show that the <italic>n</italic>-SNP distributions observed in these simulations differ significantly from what we observe for the real data. In the limit where recombination is very weak there are not many <italic>n</italic>-SNP types and they essentially capture the structure of the clonal tree. When recombination is high (like for the real data) the complete mixing causes different <italic>n</italic>-SNP patterns to occur with similar frequency, and the distributions are no longer long-tailed.</p><p>With regard to the evidence of the population separating into subpopulations, we have moved our discussion of this issue to the discussion of the entropy profiles, since these contain more relevant information about this question.</p><p><bold>Detailed questions/comments:</bold></p><disp-quote content-type="editor-comment"><p>3.6) What’s the allele frequency spectrum look like? I don’t think I saw this anywhere in the manuscript.</p></disp-quote><p>This was shown in Figure 4—figure supplement 2. We have extended this analysis to include data from the simulations and the allele frequency spectra are now shown in Appendix 4—figure 1.</p><disp-quote content-type="editor-comment"><p>3.7) How well does the consensus tree capture the pairwise distances among strains?</p></disp-quote><p>We now show this in Figure 4—figure supplement 1. Since the pairwise divergences vary over 4 orders of magnitude, there is a good correlation between the pairwise divergences and the pairwise distances in the core tree, but the distances along the tree are systematically lower than the true distance. Moreover, the branch lengths of the core tree and the observed frequencies of SNPs falling on each branch differ by up to a factor 100 (Figure 4—figure supplement 1, right panel).</p><disp-quote content-type="editor-comment"><p>3.8) Could you say more about the potential effects of the SNPs that correspond to multiple mutational events? If I understand the numbers correctly, in one of the 3kb blocks you expect about 5 SNPs to actually come from two independent mutations. Does PhyML take this into account? I don’t think it should be a big deal for most of the rest of the analysis, since Figure 5 indicates that you see inconsistencies after about 10 SNPs, and you don’t expect a multi-origin till you have about 50 SNPs, but I think it would be worth going through this explicitly.</p></disp-quote><p>We are glad to see that the reviewer appreciates that a back-of-the-envelope calculation already shows that multiple mutations (homoplasies) cannot substantially affect our analyses. However, we agree a explicit calculations are helpful. For the revision we have done extensive analyses of the potential effects of homoplasies. First, we updated our estimate of the rate of homoplasy taking transition-to-transversion bias into account. We now estimate about 3.3% of bi-allelic SNPs to correspond to homoplasies (this previously was 2.5%). Second, we developed a method for ranking SNP columns by the overall amount of phylogenetic clashes they generate with other SNPs in their neighborhood. To correct for homoplasies we then removed either 5% or 10% of the most clashing SNPs from the alignment and redid all our analysis with this homoplasy-corrected alignment. We also investigated the effects of homoplasy removal for all the simulation data. These analyses show that, indeed, none of our results and conclusions are significantly affected by homoplasies.</p><p>With regards to PhyML, this indeed implements a full likelihood model that does allow for multiple substitutions.</p><disp-quote content-type="editor-comment"><p>3.9) What do the wiggles in Figure 9C mean? They’re produced by the tree structure, right, and correspond to approximately exchangeable strains?</p></disp-quote><p>We’re sorry but we are not sure what the reviewer has in mind. We can see wiggles in Figure 7C (now 9C) but we do not know what causes them and cannot think of an easy way to figure this out. Frankly, we would already be happy to have a theory for the overall slope of these approximate power-laws.</p><disp-quote content-type="editor-comment"><p>3.10) For the human analysis, was it too much computationally to do more than just chromosome 21? Could you do all the autosomes for individuals from just one subpopulation at least?</p></disp-quote><p>For the revision we have now done chromosomes 1-12.</p><disp-quote content-type="editor-comment"><p>3.11) Did you ever think about just running STRUCTURE on the <italic>E. coli</italic> data and seeing what it said for different values of k? Maybe it would find “subpopulations” that would be clustered on the consensus tree.</p></disp-quote><p>We hope the reviewer can understand that, given very large number of additional analyses we already performed in response to reviewers 1 and 2, we feel that this rather exploratory additional analysis is beyond the scope of this manuscript.</p><disp-quote content-type="editor-comment"><p>3.12) I don’t find the power law fits to the SNP-sharing distributions very convincing, particularly the ones shown in Figure 11—figure supplement 1. I would cut the left panel of Figure 9, and I would qualify the sentence on p13 starting “Moreover…”</p></disp-quote><p>We do not agree with the reviewer here. For some reason, whereas one rarely hears complaints about fitting a linear trend to scatters that are far from straight, nor complaints about fitting an approximate exponential increase or decay to scatters on a semi-log plot, the moment one fits a line on a log-log plot there are immediately complaints that the data are ‘not really power laws’. We are not claiming that these are perfect power laws. However, it is a fact that these scatters look far more straight in log-log scales than on linear or semi-log scales. The fits just capture the overall trend of these long-tailed distributions. We have now explicitly pointed out that we are not claiming that these distributions are perfect power-laws.</p><disp-quote content-type="editor-comment"><p>3.13) What do the entropy curves look like for the human data?</p></disp-quote><p>For the revision we have performed this analysis, which is shown in Figure 11—figure supplement 3. Interestingly, the entropy profiles are virtually identical for all individuals, except for the individuals with African ancestry, which have clearly larger entropy at large <italic>n</italic>. Note that the similarity of the entropy profiles doesn’t imply that there aren’t any human subpopulations. It just implies that the diversity of different <italic>n</italic>-SNPs across the genome increases in a similar fashion for all individuals.</p><p>[Editors' note: we include below the second set of reviews that the authors received from another journal, along with the authors’ responses.]</p><disp-quote content-type="editor-comment"><p>Reviewer 1 - Daniel Falush:</p><p>1.1) This paper is substantially improved, thanks especially to the introduction of simulations and extensive reworking of many sections and the fixing of logical and other errors. I still have a number of substantial problems with it, as I will explain below. I do find the response more confrontational and even highhanded than is necessary, to the point of rudeness. Within the cover letter this is exemplified by bringing out one clich´e of the self-proclaimed oppressed revolutionary scientist, Max Planck’s quote that science progresses one funeral at a time. Which comes perilously close to implying that the field would be in better shape if me and the other people who were not happy to accept the work in its current form were no longer in it. The counterpoint to that quote is the opinion that I first saw in a movie about the life of Sigmund Freud but I believe has another original source: “The work contains much that is new and much that is true. However that which is new is not true and that which is true is not new.” Which is what the old turks in most scientific fields think of the great majority attempts to foment revolution. And at least 90% of the time they are right.</p></disp-quote><p>We are sorry that our attempt at levity toward the end of the cover letter appears to have misfired. We hope that the reviewer noticed that we did not approvingly cite Max Planck, but instead pointed out that we are much more optimistic than Max Planck and expected that we <italic>can</italic> convince the ‘old turks’ that our work contains results that are both new and true. We’ll leave it up to the reviewer to decide whether this optimism is warranted.</p><disp-quote content-type="editor-comment"><p>1.2) The manuscript is greatly improved and some important errors have been fixed. I thank them for the extensive time and effort they have put into this; once they did it they made an effort to do it properly but I wish to remind them that reviewers and editors put their time in gratis. We could be doing our own research instead. The onus is on authors, not editors or reviewers to make the manuscript and its relationship to previous literature clear and unfortunately this still has not been achieved. Despite the many improvements, establishing what is new and what is true in this manuscript remains a substantial problem, firstly because the Introduction continues to set up a straw man for what is actually believed within the field. The authors correctly point out that neither a phylogenetic approach or a population genetic approach is fully applicable to bacteria. However this is common knowledge in the field. For example Didelot and Falush, 2007, when attempting to apply ClonalFrame to entire bacterial species state: A more ambitious use of the method is to attempt to define the clonal relationships and imports for a sample from an entire bacterial species. The assumptions of the model fit less well since in many instances recombination will reassort existing polymorphisms rather than introduce novel ones. In addition, the deeper branches in the genealogy might be difficult or impossible to resolve accurately, especially if there has been substantial recombination so that most of the genome of each strain has been exchanged since they shared a common ancestor. The authors imply that it is believed within the bacterial population genetics field that phylogenetic methods should recover the true genealogy but this is simply not true. ClonalFrame, Gubbins and other methods reconstruct genealogies while simultaneously trying to account for recombination events, in the latter case by removing recombined regions from the alignment and clonalframe attempts to use MCMC to represent the substantial uncertainty that exists about the genealogy while other methods (BURST, BAPS, PopPunk) forgo attempts to reconstruct an entire genealogy and instead try to identify relationships amongst closely related strains at the tip of the genealogy. Insofar as people in the field do use phylogenetic methods to infer relationships, this is a compromise, most usually due to computational issues. Unfortunately the MCMC approach to inferring genealogies used by ClonalFrame does not scale up, so ClonalframeML uses a maximum likelihood tree but this does not mean that the authors of that paper believe it to be the correct answer and I myself am currently involved in attempting to make a method that is based on inferred local genealogies and that attempts to indicate which branches cannot be inferred with any statistical confidence. The Introduction of the manuscripts states: First, we find that for most bacterial species recombination is so frequent that, within an alignment of strains, each genomic locus has been overwritten by recombination many times and the phylogeny typically changes tens of thousands of times along the genome. Moreover, for most pairs of strains, none of the loci in their pairwise alignment derives from their ancestor in the ancestral phylogeny, and the vast majority of genomic differences result from recombination events, even for very close pairs. Consequently, the ancestral phylogeny cannot be reconstructed from the genome sequences using currently available methods and, more generally, the strategy of modelling microbial genome evolution as occurring along the branches of an ancestral phylogeny breaks down.</p><p>In my view, none of these claims are new, or indeed depart obviously from the informed consensus in the field.</p></disp-quote><p>In his previous review the reviewer characterized our paper as making ‘provocative claims that are not supported by the evidence provided’, and the review focused on pointing out perceived problems with our methodology, leading the reviewer to claim that our methods were sufficiently flawed that our conclusions could not be trusted. In response we thoroughly addressed all methodological issues raised and showed that our conclusions were in fact fully warranted. The reviewer appears to accept this because (with the exception of a discussion of potential underestimating of the average length of recombined regions that we respond to below) the reviewer no longer raises any technical issues. In light of this, we hope the reviewer can understand that we are quite surprised that he now takes the position that it is unclear to what extent any of our claims are novel. In response, we first of all note that this position is clearly at odds with those of reviewers 2 and 3.</p><p>The central novel insight of our work is that the robust phylogenetic structure that is evident in whole genome alignments of bacterial strains does not reflect clonal ancestry, but reflects population structure. We indicated this in the <italic>title</italic> of our manuscript, we explained it at length in the paper, and again in our responses to the reviews. In addition, to avoid any conceptual misunderstanding on this central point, we included a new section in the first revision showing how population structure can cause robust phylogenetic relationships to appear even in a manifestly non-clonal species such as human.</p><p>Unfortunately, the reviewer simply does not engage at all with this central result. It is unclear to us whether the reviewer has not understood this central claim, or that he simply rejects it without giving a justification for this rejection. It is clear from the reviewer’s comments, however, that he continues to assume that robust phylogenetic structures in whole genome alignments can only reflect ancestry. Although the reviewer quotes from Didelot and Falush, 2007, to point out that it has been acknowledged that approaches such as ClonalFrame are not perfect, and that it may be impossible to accurately reconstruct branches deep in the clonal tree, the entire premise of such methods is that much of the clonal tree <italic>can</italic> be inferred from the whole genome alignment. Indeed, in the section of Didelot and Falush, 2007 following the passage that the reviewer quotes, these authors apply ClonalFrame to a dataset of sequences from <italic>multiple</italic> Bacillus species, implying that they believe clonal relationships can be successfully inferred even beyond individual species. This is also consistent with statements of this reviewer in his first review: “In the discussion the authors conclude (which is not novel), that the ancestral phylogeny is very difficult, or impossible to reconstruct. This is true for most bacterial species, but this is typically because there are branches at the base of the tree that are extremely uncertain. It is still likely possible to infer a great deal about bacterial evolution from inferring clonal relationships closer to the tips. For most species, this includes a fairly substantial proportion of the clonal tree.” In summary, while the reviewer acknowledges that it may be difficult to reconstruct the entire clonal tree, it is clearly assumed that approaches such as ClonalFrame, Gubbins, and ClonalFrameML can be used to recover much of the clonal tree.</p><p>Our work fundamentally challenges this assumption and several passages in our manuscript explicitly stated this:</p><list list-type="bullet"><list-item><p>Subsection “Phylogenies of individual loci disagree with the phylogeny of the core genome” introduces the main assumption, explicitly cites methods such as clonalframeML as examples of it, and makes clear we are going to question this assumption: “How should we interpret this convergence of phylogenies to the core phylogeny as increasing numbers of genomic loci are included? One interpretation that has been proposed, is that once a large number of genomic segments is considered, effects of horizontal transfer are effectively averaged out, and the phylogeny that emerges corresponds to the clonal ancestry of the strains, e.g. [8,11]. Indeed, it has become quite common for researchers to detect and quantify recombination using methods that compare local phylogenetic patterns with an overall reference phylogeny constructed from the entire genome, e.g. [11–15,27]. However, the validity of such approaches rests on the assumption that this reference phylogeny really represents the clonal phylogeny, and it is currently unclear whether this is justified.”</p></list-item><list-item><p>In subsection “Phylogenetic structures reflect population structure” after having shown that recombination is so common that hardly any clonally inherited DNA is left in the genome alignments, we explicitly point out that these results invalidate this assumption: “As we mentioned in the Introduction, some researchers interpret this convergence to the core tree to mean that the core tree must correspond to the clonal phylogeny of the strains. The interpretation is that the SNP patterns in the data are a combination ‘clonal SNPs’ that fall on the clonal phylogeny, plus a substantial number of ‘recombined SNPs’ that were affected by recombination, which act so as to introduce noise on the clonal phylogenetic signal. In this interpretation, trees build from individual loci can differ from the core tree because the ‘recombination noise’ can locally drown out the true clonal signal, but once sufficiently many loci are considered, the recombination noise ‘averages out’ and the true clonal structure emerges. However, this interpretation makes two assumptions that do not necessarily hold. First, assuming that the effects of recombination will ‘average out’ when sufficiently many loci are considered only holds if recombination is effectively random and does not have clear population structure itself. Second, for the clonal phylogeny to emerge one has to assume that there are sufficiently many genomic loci left that have not been affected by recombination, whereas our analyses above have shown that there is no clonally inherited DNA left for most pairs, and that each locus in the genome has been overwritten many times by recombination.”We then go on to show that the first assumption, i.e. that there is no population structure, also has to be rejected, and that instead of averaging out, this population structure can cause robust phylogenetic structures to appear.</p></list-item><list-item><p>Finally, in the discussion we summarized our findings by stressing that methods which assume that much of the clonal tree can be recovered are inherently flawed: “Given this, there is no reason to assume that a phylogeny reconstructed using maximum likelihood from the core genome alignment corresponds to the clonal phylogeny of the strains. Moreover, methods that aim to reconstruct the clonal phylogeny from a subset of positions that have not been affected by recombination are also inherently problematic because our analysis shows that, for most species, such positions simply do not exist.”</p></list-item></list><p>As a general principle, we try to avoid directly attacking previous work of other researchers as fundamentally flawed in our paper. Instead, we assumed that the passages cited above would make it obvious to readers that approaches such as ClonalFrame, Gubbins, and ClonalFrameML are fundamentally flawed because they rely on assumptions that do not hold.</p><p>However, since this was apparently not clear to the reviewer, we can explain more explicitly what the problems are with an approach such as ClonalFrame. For a given set of sequences, ClonalFrame aims to reconstruct the clonal tree of these sequences using a model that assumes that</p><list list-type="order"><list-item><p>The clonal tree follows Kingman coalescent statistics.</p></list-item><list-item><p>Along each branch of the tree, some genomic segments evolve clonally at a constant mutation rate, while other segments are overwritten by recombination events.</p></list-item><list-item><p>The lengths of the recombined segments are exponentially distributed with a mean length fitted from the data.</p></list-item><list-item><p>It is assumed these recombination events do not copy a DNA segment from another member of the population, but rather simply bring in random substitutions at a fixed rate.</p></list-item></list><p>There are several problems with these assumptions. First, there is no reason to assume that the clonal relationships of real sequences should follow Kingman coalescent statistics. Second, the average length of the recombined segments is typically fitted to something relative small, e.g. 1 kilobase. Given the assumed exponential distribution, this would make it virtually <italic>impossible</italic> to ever see recombined segments of 10Kb or more. In contrast, based on comparison of very close pairs of strains in <italic>E. coli</italic>, as much as half of the recombined segments range from 20 to 80 Kb. However, these are not our main concern. The main concern is the last assumption, i.e that recombination events simply bring in random substitutions at a fixed rate. It is not only unrealistic to assume that all recombined segments are always at a fixed divergence from the sequence they recombine into, more importantly, it assumes that there is no population structure at all. As a consequence, in this model recombination cannot introduce any phylogenetic structure <italic>by construction</italic> and any phylogenetic structure evident in the data will per definition be assumed to reflect clonal relationships. Thus, approaches such as ClonalFrame will mistake the phylogenetic structure introduced by population structure for clonal relationships by construction.</p><p>In the latest revision we have edited the text in a number of places to make these points clearer, including some comments in the Discussion.</p><disp-quote content-type="editor-comment"><p>1.3) There is a significant (and not cited) literature on estimating ratio of changes due to recombination and mutation (most notably an article by Vos and Didelot from 2008) which show that there are many species where R/M is substantially above one. Are the predictions of the authors actually substantially different from these either methodologically or in terms of the estimates produced. If so why? Even if they are, the qualitative conclusion is not different.</p></disp-quote><p>In order to determine R/M, the study of Vos and Didelot uses ClonalFrame to determine both the clonal tree, as well as the recombination events. For reasons just explained, we do not believe one can validly estimate the extent of recombination in this way. More importantly, however, we never estimated a value for R/M in the paper, because we believe this is conceptually misleading. That is, one of the key results of our paper is that <italic>there is no such thing as a single ratio R/M for a bacterial species</italic>. The ratio R/M depends both on the ratio of mutation and recombination <italic>ρ/µ</italic> as well as on the number of substitutions that are introduced per recombination event, which depends both on the lengths of the recombination events, and on the divergence between the donor and acceptor strains of the recombination events. Since our results show that there is a significant population structure, with rates of recombination varying dramatically between different lineages, it would be misleading to pretend that a species can be represented by a single ratio R/M.</p><p>We note that we explicitly pointed this out in subsection “lower bound on the ratio of phylogeny changes to substitution events” of the previous revision: “The observed ratio C/M for the <italic>E. coli</italic> alignments is very similar to the value of C/M observed in the simulations with ρ/µ = 1 (Figure 6—figure supplement 2). Although it is tempting to conclude from this that the ratio of recombination to mutation rate must be close to 1 for the <italic>E. coli</italic> strains, such a conclusion would be unwarranted. The evolutionary dynamics of the simulations makes several strong simplifying assumptions, i.e. that the clonal phylogeny is drawn from the Kingman coalescent process, and that the population is completely mixed so that all strains are equally likely to recombine. Both these assumptions may not apply to the evolution of <italic>E. coli</italic> in the wild. Indeed, we will see below that there is strong evidence that relative recombination rates vary highly across lineages so that instead of a single recombination rate, there is a wide distribution of recombination rates between different lineages. Therefore, it could be misleading to describe <italic>E. coli</italic>’s evolution by a single recombination rate ρ and we instead focus on providing a lower bound C/M on the number of phylogeny changes per SNP column, which is a meaningful quantity independent of the precise evolutionary dynamics that caused the substitutions and phylogeny changes, and can be calculated independently for any subset of strains.”</p><p>This point was reiterated in the Discussion section: “Given that recombination rates vary over orders of magnitude across different lineages, the idea of an effective single recombination rate for a species might be misleading, and it seems problematic to fit the data to models that assume a constant rate of recombination within a species [34].”For the latest revision we have added the citation to Vos and Didelot at this point.</p><p>We note that closest to estimates of R/M are the results shown in Figure 2H. These show, for each pair of strains, the fraction <italic>f<sub>r</sub> </italic>of the single nucleotide differences between the pair of genomes that is due to recombination. The ratio R/M thus roughly corresponds to <italic>f<sub>r</sub>/</italic>(1 − <italic>f<sub>r</sub></italic>) in the limit of very close pairs. However, as can be seen from the figure, the ratio <italic>f<sub>r</sub>/</italic>(1 − <italic>f<sub>r</sub></italic>) becomes highly variable for close pairs that are mostly clonal. This already suggests that <italic>R/M</italic> can vary significantly across different pairs of closely related strains, and our results on <italic>n</italic>-SNP statistics confirm this. In the latest revision we have pointed this out in the section on the pair statistics.</p><p>In summary, both our approach and our results are qualitatively different in that our results show there is no single ratio <italic>R/M</italic>.</p><disp-quote content-type="editor-comment"><p>1.4) The claim about most pairs of strains having no genome shared by recombination is also true for many species. See for example our preprint”why panmictic bacteria are rare”, which shows that for many species, the recombination scaled effective population size is 100 or more, which indeed means that for most pairs of strains the proportion of shared inherited clonal frame will be vanishingly small.</p></disp-quote><p>Like in the other studies that the reviewer cites, the cited paper uses a model that assumes that the clonal phylogeny obeys Kingman coalescent statistics, that there is no population structure (i.e. panmixia), and that recombination introduces segments of DNA at a fixed divergence from the donor strain. In particular, it uses such a model to estimate <italic>N<sub>e</sub></italic>×<italic>r</italic>. The main result of this work is that the data <italic>rejects</italic> the assumption of panmixia and we in fact cited this paper in our Discussion section in this context.</p><p>However, given that the panmictic model was rejected by the data, we do not see how it can be used to accurately estimate what fraction of pairs have still clonally inherited DNA in their alignment. In fact, the methods used in the paper seem to <italic>assume a priori</italic> that pairwise divergences are dominated by recombination.</p><disp-quote content-type="editor-comment"><p>1.5) Phylogeny (I would prefer the more exact terminology local tree or local genealogy) changing tens of thousands of times is not a quantitively surprising prediction (and is very dependent on the size of the sample). We do not currently have the technology to make robust inferences of tens of thousands of distinct local trees but we know that the tree changes many times. This is just not new either. The second set of claims potentially has more novel elements but has a number of problems of coherence. Second, we show that the structure represented in whole genome phylogenies of microbial strains does not reflect ancestry, but instead the relative rates with which different lineages have recombined in the past.</p><p>“ancestry” is normally used (e.g. in human genetics) to reflect the gene pools from which DNA comes. I think that here it is meant to mean “clonal inheritance”. But if this is what is meant it is an overstatement since the authors do analyse pairs of closely related strains in order to estimate relative ratio of recombination and mutation. In so far as it is a coherent statement it simply seems to be a restatement of the claims made in the paragraph above.</p></disp-quote><p>We agree with the reviewer that the term ancestry may be ambiguous and have rephrased in our latest revision to make clear that we are referring to the clonal phylogeny.</p><p>Apart from this, the reviewers comments just repeat what we already addressed in response 1.2, i.e. the reviewer does not engage with the central claim made in the title of our paper that the whole genome tree reflects population structure. We have rephrased this section of the Introduction in an attempt to be clearer.</p><disp-quote content-type="editor-comment"><p>1.6) Whereas almost every short genomic segment follows a different phylogeny, these phylogenies are not uniformly randomly sampled from all possible phylogenies, but sampled from highly biased distributions.</p><p>Some parts of every local tree will follow the clonal frame and thus be a highly non-random subset of all possible local genealogies. So this is predicted even under a standard coalescent with gene conversion model. The bias can of course be made larger by non-random recombination.</p></disp-quote><p>This comment simply revisits the view that substantial parts of the local genealogies will reflect the clonal phylogeny. However, this is only true if a substantial fraction of the genome is unaffected by recombination along each branch of the clonal tree, and our results show that this is not the case. While the reviewer acknowledges that non-random recombination, i.e. population structure, can increase biases in the distribution of phylogenies along the genome, he somehow fails to acknowledge that this non-random recombination can itself induce phylogenetic structure. We expected that our analysis of the human data would have driven this point home, but for the revision we have rewritten this section in an attempt to further clarify this point.</p><disp-quote content-type="editor-comment"><p>1.7) In particular, the relative frequencies with which particular sub-clades of strains occur in the phylogenies at different loci follow roughly power-law distributions and each strain has a distinct distribution of co-occurrence frequency with the other strains.</p><p>It took a great deal of effort before I was able to start to parse this key sentence and I am still left guessing what co-occurrence frequency refers exactly to.</p></disp-quote><p>Whenever a SNP occurs that is shared only by the triplet of strains (A,B,C), then the strains (A,B,C) form a clade in the phylogenetic tree of that particular locus. The statement simply means that we observe that the frequencies of different triplets (A,B,C) follows a power-law. For the revision we have rephrased so as to make this clear.</p><disp-quote content-type="editor-comment"><p>1.8) Since almost every strain has a unique ‘finger print’ of recombination rates with the lineages of other strains, the assumption that at some level the strains can be considered as exchangeable members of a population, also fundamentally breaks down.</p><p>The idea that recombination is non-random is also extremely well known within the bacterial field. This is firstly due to laboratory experiments that have shown that in many species recombination rates are suppressed as a function of the number of mismatches between donor and recipient. Secondly, there have been studies done on <italic>E. coli</italic>, which show that recombination is highly non-random, with higher rates occurring within phylogroups than between them. Therefore this claim is not new either. See Didelot, Meric, Falush and Darling, BMC Microbiology 2012, and also the literature cited therein.</p><p>Therefore, I have got to the end of the Introduction and still have little idea what the novel claims of the manuscript actually are.</p></disp-quote><p>We are well aware that biases in recombination have been shown previously, and in fact explicitly discussed the suppression by mismatches in the Discussion section, including citations. However, we are not aware of any studies showing or even suggesting that the phylogenetic trees that are reconstructed from whole genome alignments reflect the statistics of biases in recombination rates.</p><disp-quote content-type="editor-comment"><p>1.9) We can also provide a rough estimate for the typical number of times T that each position in the genome has been overwritten by recombination in its history.</p><p>It needs to be made clear what “its history” means. This means anywhere across the clonal genealogy of these strains. It does not cover events before their common ancestor. It is the property of a sample of strains. It is not the property of any one strain for example, since this will also have undergone recombination events going back to LUCA.</p></disp-quote><p>We are referring to the history of a <italic>particular position in the core genome alignment</italic>. Note that, because of recombination, the nucleotides at different loci derive from different ancestors with different histories and a different common ancestor. It is thus not only a property of the set of strains but also of the specific position and <italic>T</italic> corresponds to the average across positions. We have rephrased in the revision to make this point clear.</p><disp-quote content-type="editor-comment"><p>1.10) I thank the authors for doing simulations. The reasons I am personally sceptical of these estimates of T is that I think 20,000 base pairs is a substantial over-estimate of the mean length of the recombination events that change the local trees. Some recombination events will be this long and these are the easiest events to detect. However there can also be many shorter events that still introduce 2 changes in local genealogies. It is known for example that individual events can lead to introduction of several fragments, many of which are short, within a long sequence block. For example see Golubchik et al. Nature genetics 2012. These events naturally get fused together in the kind of pairwise analysis that the authors do. It can be that the events of more than 20,000 bases are responsible for half of the Introduction of DNA but only responsible for a very small fraction of changes in local genealogy. If the authors estimated mean recombination fragment size by methods based on LD rather than by attempting to characterize individual events they would I think get much shorter estimates. I am not exactly sure what the authors should do to address this issue. One is to ask whether the pattern of LD as a function of genetic distance is really consistent with 20,000 bp imports. Another is simply to acknowledge the methodological difficulties.</p></disp-quote><p>The reviewer imagines that our identification of recombination segments in very close pairs may miss short segments, and that this may cause us to significantly overestimate the average length of recombined segments.</p><p>For this revision we have included a new Appendix 2 discussing why we believe it is unlikely that we are underestimating the average length of the recombination segments by a significant factor. To summarize: Our method does not have trouble detecting relatively short segments, i.e. fully 30% of the recombination segments we identify are only 1-2Kb long. Second, because typical pairs of <italic>E. coli</italic> strains are 1 − 3% diverged, even a recombined segment of only 250bp long would bring in 4-7 mutations, and this would easily be detectable in the alignment of a very close pairs of strains, which have at most 2 SNPs or less per kilobase in clonally inherited regions. In order for our method to plausibly miss a recombined segment it would have to be shorter than 100bp. Third, as we discuss in the Appendix 2, in order for our estimate of the average length of the recombination segments to be too large by a factor <italic>n</italic>, we would have to assume that for each recombination event of length 250 bp or more that we can detect, there are <italic>n</italic> recombination events of length 100 bp or less that we cannot detect.</p><p>The LD analyses that the reviewer mentions are based on explicit population genetics models that make a number of assumptions that, according to the results we present, simply do not hold. Consequently, we do not believe the results of such analyses can be trusted. To give just one example, such analyses typically assume that lengths of recombination segments are exponentially distributed and typically fit a mean length of 1 kilobase or less. Under such a model, recombination segments of length 10Kb or more would be essentially impossible. However, our pairwise analysis of very close pairs clearly shows that recombination segments of tens of kilobases long are in fact common (Figure 2A, B, and J).</p><p>The only statistic that we report that is affected by the estimated average length of the recombination segments is the average number of times <italic>T</italic> each position in the alignment has been overwritten by recombination. This latter estimate is based on the lower bound on the number of phylogeny changes in the alignment. Comparison with simulations suggests that this estimate may well be 10-fold below the true value. Thus, in order for our estimate to still be an overestimate one would have to assume that our 20Kb recombination segment length (which is already 50% less than the actual mean that we estimated) is an overestimate by 10-fold or more. We think it is very implausible that there are 10 times as many recombination events of length 100 bp or less as all recombination events of length 250bp or more.</p><p>In addition, in response to a suggestion by reviewer 3 we have included an Appendix 3 with a complementary estimate of the number of times each position has been overwritten by recombination, based on the statistics from the pair analysis (see response 3.5). The results of this analysis are entirely consistent with our estimate based on the minimal number of phylogeny changes across the genome alignment, i.e. suggesting that each position has been overwritten somewhere between 200 and 500 times by recombination on average.</p><p>Finally, as already pointed out in our previous response, <italic>even if</italic> our estimate were still a significant overestimate, this would still not affect any of the main conclusions of our paper.</p><p>For the revision we have further rephrased the discussion of this estimate to make clear that it could be affected if there were very large numbers of very short recombination events that we cannot detect.</p><disp-quote content-type="editor-comment"><p>1.11) The consensus in the field based on careful work of many scientists is that M. tuberculosis has undergone no recombination at all in its history back to its last common ancestor and that when authors detect it, it is due to methodological issues (either with the analysis method or with the data). If the authors wish to claim that they have detected positive evidence for recombination in the species, they need to spell out why. Otherwise, they need to comment on which the deviation from this established truth says about the practical limitations of their methods.</p></disp-quote><p>We agree that, while there are some reports in the literature of evidence for recombination with <italic>M. tuberculosis</italic>, the consensus is that, if there is any recombination, it must be very rare. In line with this, almost all of our statistics on <italic>M. tuberculosis</italic> confirm that, if there is any recombination, it is really rare. The pair statistics infers that all pairs are almost fully clonal, there is no diversity of <italic>n</italic>-SNP patterns, and the <italic>n</italic>-SNP entropy profiles all have low entropy. The only potential evidence of recombination is the occurrence of a (small) fraction of SNPs that clash with the core tree. Since these clashing SNPs are relatively rare, i.e. roughly one every 4.7Kb along the genome, we do not think it can excluded that they are due to problems with either the assembly of some strains, or their alignment.</p><p>Since the reviewer asked we have performed some more analysis of the <italic>M. tuberculosis</italic> SNPs for this revision. We discovered that the majority of clashing SNPs involved a particular pair of strains and found that these two strains have since been <italic>removed</italic> from the database because of evidence of contamination in these sequences. In total the genomes of 5 of the strains that we used have since been retracted. We removed these strains from the alignments and redid all analysis to find that the rate of clashing SNPs has now been reduced to once every 12.7Kb. Although there are still clashing SNPs left, we obviously cannot exclude that there are problems with the assemblies of some of the other strains as well.</p><p>For the revision we have edited the way we describe our <italic>M. tuberculosis</italic> results, and have added comments about the retracted strains and their effect on the frequency of SNPs that clash with the core genome phylogeny.</p><disp-quote content-type="editor-comment"><p>1.12) Figure 10—figure supplement 3 and Figure 11—figure supplement 2 are interesting because they show a deviation of the <italic>E. coli</italic> and other species data from the standard model of evolution with gene conversion model. It is nice to see that H. pylori looks like a freely recombining species, while M. tb looks like a non-recombining species according to this pattern (I think these plots should be given the same scale). This is the first part of the manuscript where I think I am seeing a new and interesting way of visualizing the data. However, frustratingly, the difference is not worked through and explained. My view is that these figures should be brought into the main text and the difference in pattern between simulated data with intermediate recombination rates and what is seen in <italic>E. coli</italic> should be explained carefully. The problem with the current main text figures is that they are very dry; it is far from obvious what they actually say about what is happening in <italic>E. coli</italic> and it takes a great deal of effort to fight through and understand them.</p><p>As stated above, in our 2012 paper we showed that recombination was inhomogeneous within <italic>E. coli</italic>. We used ClonalOrigin to infer recombination events and found more events within clades than between them. The visualization in Figure 10—figure supplement 3 and Figure 11—figure supplement 2 is interesting because it shows that inhomogeneity is a direct feature of the data compared to simulated data and does not need complex inference methods to detect. This I believe should be the centre point of the manuscript.</p></disp-quote><p>We are very glad that the reviewer appreciates that the results in Figure 10—figure supplement 3 and Figure 11—figure supplement 2 directly show the heterogeneity in recombination without the need of postulating specific models. In the first revision we already moved some of these entropy profile results to the main text (Figure 10) and we do not think it is necessary to move these supplementary figures to the main text as well. We also note that reviewer 2 has the opposite opinion, i.e. that we should spend less space in the main text on these results. We believe that the current presentation strikes a reasonable balance.</p><p>At the suggestion of the reviewer, we have reworked the text describing these results to improve the explanation of what they show.</p><disp-quote content-type="editor-comment"><p>1.13) I asked a talented postdoc to look at the preprint of this paper and tell me what he thought. He spent 4 hours and was not able to decide whether anything could be concluded from all these new methods. The real task of the authors now is to focus down on making what is genuinely new accessible and with the time I can feasibly devote to it these are my comments to help the author to get there. I hope they are grateful!</p></disp-quote><p>We’re convinced that many of the comments of the reviewer have ultimately positively impacted the paper.</p><disp-quote content-type="editor-comment"><p>Reviewer 2</p><p>2.1) The manuscript has largely improved since last version and is making a clear point. It now combines multiple previous observations and some new statistics to discuss the impact of recombination on bacterial genetic diversity and the possibility to represent bacterial evolutionary history as a phylogeny.</p><p>The addition of situations added clearly some idea for comparison with a standard population genetic background.</p><p>Yet the picture is still not clear and can become quite technical. Here are a few propositions to improve the manuscript.</p></disp-quote><p>In light of this reviewer’s strong skepticism of the original version of our manuscript, we are very grateful to the reviewer for these gracious comments.</p><disp-quote content-type="editor-comment"><p>2.2) The main problem is that the n-SNPs statistics remain difficult to interpret. Specifically, the authors give an intuition for the n-SNP distribution in a freely recombining population. It should be peaked around a typical number of occurrence per type (Appendix 4—figure 3, brown line), In a clonal population, the n-SNP distribution can also resemble a power law (Appendix 4—figure 3), a fact that is somewhat buried in the Supplement of the manuscript. A first clear description of the expected n-SNPs distribution in these two extreme scenarios is warranted before going to more complex statistics (e.g. the entropy profiles).</p></disp-quote><p>We note that reviewer 3 also asked about the interpretation of the n-SNP distributions in the first round of review, and did feel that our revisions had cleared this up. Nonetheless, for this revision we have significantly edited the text to make as clear as possible what these <italic>n</italic>-SNPs represent, including a formal description of how we imagine relative rates of recombination determine the relative frequencies of different <italic>n</italic>-SNP patterns. We have also edited our descriptions of what is observed in the clonal and freely recombining limits, and how those observations fundamentally differ from what we see in the <italic>E. coli</italic> data.</p><disp-quote content-type="editor-comment"><p>2.3) At the 2 SNPs, it makes sense that having multiple strains with almost equivalent level of 2 SNPs links is a reflection of recombination. But it would be interesting to plot the genomic localisation of the 2SNPs of the Figure 9A. The initial part of the paper mentions that for closely related strains a single recombination event will bring most variable SNPs. As such a recombination between two distant strains may lead to a high 2SNPs score just based on one transfer. Conversely, consider that strain A and B are more closely related and C is their closest relative. All mutations that occurred between on the branch leading to clone ABC will appear as 2 SNPs between either A and B, B and C or A and C if they occurred in regions that have later been overwritten by a recombination in branch C, A or B respectively. Here, the topology will play a major role. The 2SNPs connection will reflect clonality perturbed by recombination, not preferential recombination between strains. The 2 SNPs statistics is both dependent on the topology (its asymmetry, long branches…) and on the recombination. The simulations using coalescent approach did not capture the highly biased sampling structure of the population of genomes studied. So it would be interesting to illustrate on the example of Figure 9A where are the 2SNPs to substantiate the underlying structure of these 2 SNPs.</p></disp-quote><p>For this revision we have followed the reviewer’s suggestion and included a supplementary figure showing the distribution along the genome of the 5 most common 2-SNPs from Figure 9A (Appendix 5—figure 2) within the section analyzing phylogroup B2 in detail (A1 belongs to phylogroup B2). Consistent with our observation (from the pair statistics) that little clonal signal is left for this set of strains, and that recombination has overwritten each locus already multiple times, we observe a fairly uniform distribution of these 2-SNPs along the genome. Apart from just visualizing where these SNPs fall along the alignment, we have also shown the distributions of distances between consecutive occurrences of the same 2-SNP, and the distribution of the length of runs of the same 2-SNP. This shows that, although there are some locations where a cluster of the same 2-SNP occurs, runs of identical 2-SNPs are mostly short. Finally, among the top 5 pair-SNP partners of A1 are strains D4 and H6, neither of which belong to phylogroup B2. Appendix 5—figure 2 also shows that 2-SNPs of A1 with D4 and H6 are dispersed all across the core genome alignment and in the latest revision we point out that this also underscores that phylogroups should not be thought of as reflecting clonal ancestry.</p><disp-quote content-type="editor-comment"><p>2.4) The trouble in the later part of the paper is that the idea of preferential recombination is not clearly supported by the data. The n-SNPs distribution in data do not perfectly follow the simulation model (although on Appendix 4—figure 3, the profiles are not that distinct either). But this does not imply that strains have to present “unique recombination profiles”. Moreover, the fact that the distribution is scale free does not necessarily imply that there are no groups of preferential recombination. All in all, we had trouble following the whole paragraph on n-SNPs distribution and even more that on the entropy profiles. All we see is that indeed the simulations do not perfectly match these profiles. There could be multiple processes behind this poor match, like population structure for example or sampling biases. We would therefore suggest to considerably shorten that part (which comes at the end of an already long paper) and to present the “unique recombination profile” as one hypothesis by which these patterns could possibly arise (although this is only based on a verbal argument).</p></disp-quote><p>Reviewer 2’s opinion differs from the opinions of both reviewers 1 and 3 on these points. Reviewer 3 agrees we have explained the interpretation of these n-SNP distributions and feels they clearly differ from the simulations and show evidence of population structure. Note also that, whereas reviewer 2 appears to contrast ‘population structure’ and ‘preferential recombination’, these two terms mean essentially the same in this context (as reviewer 3 has stressed). Regarding how long this section should be, we note that here the reviewer is also in disagreement with those of the other two reviewers, e.g. reviewer 1 feels we should expand the section on the entropy profiles. Overall we believe that the amount of space invested on the <italic>n</italic>-SNP statistics is appropriate.</p><p>For this revision we have rewritten the section in question once more to stress that our results show that the <italic>n</italic>-SNP distributions and entropy profiles show that different lineages recombine at significantly different rates, and that (apart from strains that had a common ancestor very recently) the lineages of each strain have a unique pattern of recombination with the lineages of other strains.</p><disp-quote content-type="editor-comment"><p>2.5) Heterogeneity in selection: One question that is not addressed is the heterogeneity in selective pressure along the genome? This heterogeneity could contribute to an over estimation of the fraction that is linked to recombination. Specifically, in the figure showing the accumulation or recombination with divergence, the last panel could be misleading because to the lack of resolution. Some genes are much more conserved than others and that intergenic regions. Synonymous are much more frequent (more than 10 fold) than non-synonymous…. All these factors could play a role in the variability observed at intermediate levels of divergence. Could a zoom on some regions reveal the heretogeneity of divergence and its decorrelation from the underlying genetic structure. Is this pattern different from simulations that lack these diversity on the level of constraints.</p></disp-quote><p>The reviewer is presumably referring to the panels of Figure 2A-C and wondering whether we may be over-estimating the amount of recombination because of heterogeneity in purifying selection. If we understand it correctly, the reviewer imagines that one could mistake a region with little purifying selection, and thus, increased mutations, for a recombined region. Or vice versa, mistake regions under strong purifying selection for ancestral regions. We agree with the reviewer that, for pairs that are close to fully recombined, it becomes harder to clearly distinguish ancestral from recombined regions, but this does not affect the overall statistics that we derive from the pair analysis, which are driven by closer pairs that contain substantial fractions of ancestrally inherited DNA, i.e. as in Figure 2A and 2B, where the recombined regions can be easily detected.</p><p>Moreover, we stress again that our quantification of recombination is not only based on the pair analysis, but also on the consistency of SNP splits, and those statistics are not affected by selection.</p><disp-quote content-type="editor-comment"><p>2.6) For the detection of homoplasy, the impact of synonymous and transitions transversion, the model proposed could be better explained and the supporting data (number of transitions transversions leading to bi, tri or quadri allelic data for different types of mutation (synonymous, intergenic...)) should be provided.</p></disp-quote><p>For the revision we have edited this section to improve clarity and expanded the explanation. In addition, we have added a table reporting the statistics the reviewer requested (Table 2).</p><disp-quote content-type="editor-comment"><p>2.7) Overall the article has improved but we fill the nSNP interpretation, could still be clarified and/or shortened.</p></disp-quote><p>As mentioned above, we have now further revised the section on the interpretation of the <italic>n</italic>-SNP statistics to improve clarity and expand the explanation.</p><disp-quote content-type="editor-comment"><p>2.8) Please specify the length of recombination fragments (20 kb) when you explain how recombination is implemented in the simulations.</p></disp-quote><p>In the simulations the lengths of the recombination segments were 12Kb, which we now also specify in the main text.</p><disp-quote content-type="editor-comment"><p>2.9) In paragraph “Recombination rates across lineages follow approx... scale-free distributions”, did not follow the sentence starting in “Formally,.…” are nearest neighbour in the phylogeny” - which phylogeny are you mentioning?</p></disp-quote><p>It is the different phylogenies along the genome alignment, i.e. each phylogeny at each locus. We have edited the text to make this clear.</p><disp-quote content-type="editor-comment"><p>2.10) Discussion “n-SNP types reflect the relative frequencies with which different subsets of n strains share a common ancestor across the phylogenies” - is that statement correct?</p></disp-quote><p>We have rewritten this section to make sure the statement is clear.</p><disp-quote content-type="editor-comment"><p>Reviewer 3 - Daniel B Weissman:</p><p>3.1) I was very positive in my first review, and I remain so: all the things that I really liked about the manuscript are still there, with more support. The authors have addressed my main comment (reorganizing the manuscript) and one of my main comments (interpreting the n-SNP distributions), and partially addressed my other main comment (quantitative analysis of agreement between SNPs and the core tree), while explaining why they have not done more (it’s just a hard problem that will take some more serious analysis than my dashed-off idea). My main concern is just that the first submission was already quite a lot to take in (e.g., despite trying to read it carefully, I missed the site frequency spectrum) and now after addressing all the comments it’s really sprawling. I can’t think of magic fix to this, but a few of the minor suggestions below may help.</p></disp-quote><p>We are happy that reviewer 3 feels we have addressed his comments about the interpretation of the <italic>n</italic>-SNP distributions. We agree with the reviewer that, in response to the many additional controls that reviewers 1 and 2 requested, including simulations, there is now so much extra material that it will make it harder for readers to follow the main thread of the argument. In this second revision we have gone over the whole text again and tried to improve the presentation so that the overall thread is clear.</p><disp-quote content-type="editor-comment"><p>3.2) There’s a lot to the simulation analysis, and I got kind of lost at points. To me, there are two main points of the simulations. The first is just to provide a quick check on the all the statements the authors are making in the first part of the manuscript, where they show that recombination has erased the clonal tree. This part was pretty easy to follow.</p></disp-quote><p>We agree with the reviewer.</p><disp-quote content-type="editor-comment"><p>3.3) The second main point are the n-SNP distributions. The authors’ main claim about the <italic>E. coli</italic> n-SNP distributions is that they are roughly scale-free. The human ones exhibit this even more clearly. The simulations show a different pattern. This suggests that a more complex history, with a mix of population size changes, population structure, and gene flow, as in humans, is a better starting point than the simple simulation model.</p></disp-quote><p>Indeed, in the first round of reviews the reviewers questioned whether a simple model of neutral evolution plus fully mixed recombination would not lead to the same n-SNP distributions and the second point of the simulations is to show that it doesn’t. In this revision we also tried to make clearer that this is the main second point to take from these simulations.</p><disp-quote content-type="editor-comment"><p>3.4) I didn’t care so much about the fact that the simulations don’t match all the <italic>E. coli</italic> diversity statistics in detail – it would be weird if they did, given that they don’t even have the same sample size and that the core tree doesn’t look like a Kingman tree. If I’m correct about the two main points, it would be helpful if the authors could emphasize this to help guide the reader.</p></disp-quote><p>We agree and have tried to make this clearer in the revision.</p><disp-quote content-type="editor-comment"><p>3.5) Reviewer 1 mentioned the issue of biases in the estimation of the length distribution of the recombined segments. I don’t think the simulations fully address this, particularly the problem of missing small recombination events, since they assume that all recombination events are 12 kb. The authors mention that most of their conclusions don’t depend on the distribution of recombined segment lengths, which I agree with, but I think that the estimate of how many times each part of the genome is overwritten by recombination does depend on it. One could imagine a situation in which most of the phylogeny switches from alignment column are caused by very short recombined segments, while the segments detectable in close pairs are much longer. I don’t think that’s the case here, but the authors should make an argument why it’s not. What does ρ/µ look like if you just estimate from the close pairs? Is it roughly consistent with the ρ ≈ 0.3 − 1 that gives frequency of phylogeny changes in the alignment in simulations?</p></disp-quote><p>We agree with the reviewer that the estimate of the average size of recombination events is unimportant for almost all of our conclusions, and only affects the estimate of the number of times <italic>T</italic> each locus has been overwritten by recombination. Regarding the question of whether it is plausible that our lower bound estimate for <italic>T</italic> is still an overestimate, we refer the reviewer to our response 1.10. In short, for our estimate of the average length <italic>L<sub>r</sub> </italic>of the recombined segments to be an over-estimate by <italic>n</italic> fold one would need to have that for each recombined segment of length 250 or more, there are at least <italic>n</italic> recombined segments of length 100 or less. We feel that it is therefore not plausible that are estimate is off by a large factor.</p><p>The reviewer further asks whether we cannot get an estimate of <italic>ρ/µ</italic> using the analysis of close pairs. In response we have now added a Appendix 3 that estimates <italic>L<sub>r</sub>ρ/µ</italic> using statistics from partially recombined pairs for which the fraction of clonally inherited genome is between 0.25 and 0.75. This analysis suggests that <italic>L<sub>r</sub>ρ/µ</italic> ranges from 2100 to 4600 for these pairs.</p><p>Assuming that these rates also apply to the full evolutionary history of the strains in the genome alignment, the Appendix 3 also explains that, because a fraction 0.1 of columns in the alignment are polymorhic, this implies that the average number of times <italic>T</italic> each position in the alignment has been overwritten by recombination lies between <italic>T</italic> = 210 and <italic>T</italic> = 460. Note that this is consistent with our estimate based on the lower bound on the number of phylogeny changes <italic>C</italic>, which suggests <italic>T</italic> is at least 191 and may be as large as 1000.</p><p>However, we feel that this simple estimate based on the pair statistics should only be considered an order-of-magnitude check on the lower bound obtained from <italic>C</italic> for several reasons. First, the simple model assumes that, for a given pair, recombination has occured at a constant rate <italic>ρ</italic> since they diverged from a common ancestor. However, our results show that recombination rates vary strongly across lineages. More importantly, to estimate <italic>T</italic> we have to assume that the estimates of <italic>L<sub>r</sub>ρ/µ</italic> for the partially recombined pairs can be extended to the full core genome alignment, and it is not clear at all whether this is valid. We have noted this as well in Appendix 3.</p><disp-quote content-type="editor-comment"><p>3.6) I would replace “recombination rates between lineages” with “population structure” as much as possible. First, technically, with so much recombination, each sample corresponds to many lineages, not one, and the recombination will almost never actually occur between two lineages ancestral to sampled individuals. Rather, recombination will split one ancestral lineage, and then deeper in the past one of the resulting lineages will coalesce with a different ancestral lineage. Second and more importantly, population structure is a familiar notion in population genetics, so it will hopefully reduce cognitive load on readers. You can emphasize early on that this structure doesn’t need to be geographic. For “variation of relative recombination rates among lineages”, maybe “variation in proportions of shared ancestry among lineages”? Not sure, could also see leaving it as-is.</p></disp-quote><p>Precisely what terminology to use is something we have been thinking about quite a bit and it is very useful to have the reviewer give his views on this. We agree that ‘population structure’ is a familiar notion to some, but this may not include all readers of our paper and some may mistakenly think we are talking only about geographic distribution or something like that. Note that, in his last review, reviewer 2 refers to population structure and ‘preferential recombination’ as if they were two separate things. In our latest revision we have attempted to make sure that it is clear how we are using the terminology and we have in general increased the use of the term population structure.</p><p>The reviewer’s comments also made us realize that with ‘lineages’ we were not only thinking of the clonal ancestors of the sample, but the lineages of all ancestors that have contributed genetically to the genomes in the sample. In this revision we have also tried to make this point clearer by pointing how we use the term ‘lineages’.</p><disp-quote content-type="editor-comment"><p>3.7) In the human section: “few if any loci in the genome that follow this strictly maternal lineage”. I would explicitly mention the mitochondrion, and actually build a mitochondrial tree for the human sample that you can compare to the whole-genome tree. This would really help make things concrete, which I think would help people understand the bacterial results. If you want to, you could even include a cartoon human population tree, showing African and European admixture into Native Americans. Seeing the three trees (genomic consensus, mitochondrial/clonal, and model population structure) next to each other would drive the point home.</p></disp-quote><p>We agree that contrasting a mitochondrial tree with the whole-genome tree would help drive the point home. Unfortunately, the mitochondrial sequences are not available for these genome sequences.</p><disp-quote content-type="editor-comment"><p>3.8) I didn’t really understand the motivation behind the simulation setup. Why was it important that there be a single clonal tree shared by all the simulations? If anything, this seems to introduce a lot of noise, and I would be worried about unluckily drawing a weird tree. I would think it would be easier to use a pure coalescent simulation. If there’s an issue with the ARG getting too huge because recombination is too frequent, then I think that means that there is a corresponding issue in the forward-time simulations where multiple recombined segments are too frequently being drawn from the same lineages. The authors might even be able to use existing software. ms and I believe msprime can do gene conversion, and if the exploding ARG is a problem, FastSimBac uses a Sequential Markov approximation and also keeps track of the clonal frame. I don’t know if any of them record all the stats that the authors use in this manuscript though.</p></disp-quote><p>The reason we use the same clonal tree is to be able to more directly show the effect of different recombination rates on various statistics. For example, in Figure 1—figure supplement 3 we show, for different recombination rates, what the fraction is of the genome that has been overwritten by recombination along each branch of the clonal tree. If there had been different clonal trees for each simulation, it would be much harder to meaningfully compare these statistics for different recombination rates.</p><p>We have extensively looked into using existing software for doing our simulations but none allow us to gather all statistics we want to gather.</p><disp-quote content-type="editor-comment"><p>3.9) I would try to maintain a clear distinction between a locus being overwritten many times by recombination in the phylogeny as a whole, and being overwritten many times along the line of descent of any given individual. As I understand it, the authors are making the second, stronger claim for most of the species studied, but I wasn’t sure what the actual numbers quoted in, e.g., Figures 6—figure supplement 3 and 4 correspond to.</p></disp-quote><p>In Figures 6—figure supplement 3 and 4, we are referring to the number of times positions have been overwritten along the whole phylogeny. In this revision we have made sure to be explicit about this so that no confusion can occur.</p><disp-quote content-type="editor-comment"><p>3.10) “Indeed, if we remove…”: I’m not sure that the argument in this paragraph is quite correct as written. Suppose we had a large sample from a basic unstructured Wright-Fisher population with a low rate of recombination. Then even if we were to take only recombined loci, wouldn’t we still get back something like the clonal phylogeny? I think the key point is the one you make in the sentence before this paragraph, that every locus has recombined many times. So then yes, maybe those all those trees look like the clonal phylogeny, but there’s no particular reason to expect them to, any more than we expect all the loci in humans to have trees that look like the mitochondrion’s.</p></disp-quote><p>We don’t think that there is anything incorrect with the argument in this paragraph, but we clearly did not explain ourselves well enough. This section of the paper concerns the question of why there is a robust core phylogeny in the face of so much recombination. At the start of this section we introduced a viewpoint that many in the field take regarding this question: “some researchers interpret this convergence to the core tree to mean that the core tree must correspond to the clonal phylogeny of the strains. The interpretation is that the SNP patterns in the data are a combination ‘clonal SNPs’ that fall on the clonal phylogeny, plus a substantial number of ‘recombined SNPs’ that were affected by recombination, which act so as to introduce noise on the clonal phylogenetic signal. In this interpretation, trees build from individual loci can differ from the core tree because the ‘recombination noise’ can locally drown out the true clonal signal, but once sufficiently many loci are considered, the recombination noise ‘averages out’ and the true clonal structure emerges.”</p><p>If this interpretation were correct, one would expect that explicit removal of all SNPs that fall on the core tree would destabilize the phylogeny. However, this is not what we observe. For this revision we have rephrased this section with the aim of making this point clearer.</p><disp-quote content-type="editor-comment"><p>3.11) “Essentially all population genetics…”: I’m not sure that I see the contradiction in this paragraph. As I understand, say, STRUCTURE or ADMIXTURE, they have no problem with each sampled individual having a unique distribution of ancestry across populations, which would seem to correspond to the claim being made about the <italic>E. coli</italic> strains.</p></disp-quote><p>Software such as STRUCTURE fit the data to a general purpose mixture model which, at least as far as we understand it, is not based on any explicit model for the evolutionary dynamics. We suspect that it would not be easy to device an explicit dynamical model to reproduce a specific fit to the mixture model of STRUCTURE.</p><disp-quote content-type="editor-comment"><p>3.12) The SI would be easier to navigate if it had a table of contents and if Table S5 were a separate data file.</p></disp-quote><p>We agree with the reviewer and, for the revision, we have made these changes.</p><p>[Editors' note: we include below the third round of reviews that the authors received from another journal, there is no corresponding authors’ response, as the authors opted to submit to <italic>eLife</italic>.]</p><disp-quote content-type="editor-comment"><p>Thank you for the revisions and for the lengthy rebuttal.</p><p>The problem with this paper continues to be that while the analyses are interesting, the description of the results and their interpretation remains garbled and confusing. Previous literature is mischaracterized but beyond that the manuscript fails to be clear in its own terms. These two problems need to be solved in parallel.</p><p>It is quite tiring to spend a long time wading through unclear text and then to get an overly combative response yet again. For this reason, I have again not attempted a comprehensive review of the manuscript but tried to focus on the most important problem, which is that the manuscript needs a clear statement of what is actually new - using instructive examples.</p><p>If correctly explained, the authors do have more than enough material for a solid and exciting contribution to bacterial population genetics that would be suitable for publication. Alas, unless the core issues of scientific clarity are addressed, the manuscript remains unsuitable for publication anywhere.</p><p>The authors are correct to highlight the issue, we do not know how many well-resolved branches can be attributed to clonal structure and how many can be attributed to non-random patterns of recombination (and how many can be attributed e.g. to technical factors in phylogenetic reconstruction) and that we indeed have limited understanding of the effect of gene flow on overall patterns of variation. It is an interesting, deep and under-appreciated question in bacterial evolution. The best parts of the paper (still alas buried in the supplement) show that the null single gene-pool model, with homogeneous recombination rates between lineages (which is indeed used as the basis for many inference methods and simulations, especially due to the difficulty of implementing other models) is very far from being correct in many species.</p><p>The paper examines some summary statistics that avoid several of the assumptions made by more parameterized inference approaches. But they do not provide meaningful quantitative estimates of, for example, how many well-resolved branches of the phylogeny in any given species are inconsistent with the clonal tree. Furthermore, they do not provide estimates of how non-random recombination actually is. These problems are not easy to address directly.</p><p>The title, which describes “long-tailed distribution of recombination rates” is therefore extremely misleading. The authors do not provide estimates of recombination rates between pairs of lineages. The long-tailed distribution refer to n-SNP patterns, not directly to recombination patterns. This issue of jumping between one and the other is repeated throughout the manuscript and destroys its scientific clarity.</p><p>“Each genomic locus has been overwritten so many times by recombination that it is impossible to reconstruct the clonal phylogeny and, instead of a consensus phylogeny, the phylogeny typically changes many thousands of times along the core genome alignment.”</p><p>This section of the Abstract is entirely garbled. The question of whether it is possible to recover the clonal genealogy is a technical question rather than a biological one. We always know there is a clonal genealogy, because bacteria always reproduce by binary fission, the question is just whether it is recoverable from the data. For example, if the level of recombination between strains was determined entirely by how closely related they were (which is close to the truth if recombination is extremely homology dependent), then you could have infinite recombination rates and still be able to successfully reconstruct clonal relationships. I can only guess what is meant by the sentence “instead of a consensus phylogeny”. A consensus phylogeny is something that it is always possible to calculate but is often difficult to interpret. So in what sense is it “instead” that the phylogeny (which means actually local genealogies) changes many thousands of times. I cannot see what possible logic this sentence could be conveying.</p><p>“Our findings show that bacterial populations are neither clonal nor freely recombining, but structured such that recombination rates between different lineages vary along a continuum spanning several orders of magnitude, with a unique pattern of rates for each lineage.”</p><p>The first part is most definitely not new while the second part might be true but is not demonstrated. Recombination rates have not been measured directly, only n-SNP patterns.</p><p>“The reviewer no longer raises any technical issues.”</p><p>The reason I did not raise many technical issues in my review of Revision 1 is not because I had gone carefully through the entire manuscript and was unable to find any but because, as I stated in the review, I was already exhausted and spent far more time on the review than I wanted by the time I got to the end of the manuscript introduction. Now we are at revision 2 and there was a real danger of exhaustion by the time I get to the end of reading and responding to the cover letter. Do they actually want me to state every technical issue I have?</p><p>“Our conclusions were in fact fully warranted.”</p><p>I have pointed out several substantive and important mistakes, such as the factor of 2 misestimate of recombination in the previous version. The authors did actually make many scientifically substantive changes in response to my comments in this iteration as well on M. tb and on variation in tract length, which I thank them for.</p><p>The main point here is that the conclusions were not, and still are not, clearly stated. So how can they possibly be fully warranted?</p><p>I’m not going to respond line-by-line to the rebuttal of my reviewer points made in the cover letter, although it’s tempting, but the whole premise of the argument that is made is false in a key respect:</p><p>“It is clear from the reviewer’s comments, however, that he continues to assume that robust phylogenetic structures in whole genome alignments can only reflect ancestry.”</p><p>In 2003, my colleagues and I published a paper entitled “Traces of human migrations in Helicobacter pylori populations” in Science. Helicobacter pylori is a particularly recombinogenic species (as their analysis confirms) and recombination has abolished most obvious traces of clonal structure in the genomic data, at least if strains are sampled from unrelated individuals within large human populations. Nevertheless, in population level H. pylori data one recovers a tree, which has several well-supported deep branches. Indeed, figure 1 in that paper is a population tree, showing those branches. These robust phylogenetic structures clearly reflect patterns of gene flow (populations refers to population genetics which is the study of gene pools) and not clonal structure. (as I noted, their usage of the term ancestry is non-standard – it also seems to be extremely vague - and should be avoided).</p><p>If strains are sampled from related individuals, one often finds clones and can infer some clonal structure, as I did for example in a paper published in 2015 in the journal Gut which found that the strains sampled from a single patient derived from two distinct clones but had recombined substantially.</p><p>Moreover, in 2019 my colleagues and I published a paper in ISME journal showing that the marine pathogen Vibrio parahaemolyticus also has populations defined by gene flow, while showing near-to free recombination within each of those populations. Note however that in this species there is plenty of evidence for clonal structure. For example, if you sample strains that cause human disease, you find a handful of lineages of recent origin predominate. Within these lineages, there are nice time-resolved phylogenies that make total sense. It is easy to infer clonal structure and it is also known that recombination rates can differ substantially within these lineages.</p><p>“The central novel insight of our work is that the robust phylogenetic structure that is evi- dent in whole genome alignments of bacterial strains does not reflect clonal ancestry, but reflects population structure.”</p><p>This “central novel insight” is thus neither new nor true. In Helicobacter pylori we have already long ago and more recently in Vibrio parahaemolyticus shown that robust phylogentic structure in some parts of the tree results from clonal ancestry and in other parts of the tree from population structure. It all depends on where in the tree you look.</p><p>“We are much more optimistic than Max Planck and expected that we can convince the ‘old turks’ that our work contains results that are both new and true. We’ll leave it up to the reviewer to decide whether this optimism is warranted.”</p><p>I believe that there are new and true results in this work but unfortunately my doubts persist about whether they will ever be described accurately enough to allow people in the field to establish what they are.</p></disp-quote></body></sub-article></article>