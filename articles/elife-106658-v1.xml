<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN"  "JATS-archivearticle1-3-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">106658</article-id><article-id pub-id-type="doi">10.7554/eLife.106658</article-id><article-id pub-id-type="doi" specific-use="version">10.7554/eLife.106658.3</article-id><article-version article-version-type="publication-state">version of record</article-version><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Coordinated spinal locomotor network dynamics emerge from cell-type-specific connectivity patterns</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Wandler</surname><given-names>F David</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Lemberger</surname><given-names>Benjamin K</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>McLean</surname><given-names>David L</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-6337-2301</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Murray</surname><given-names>James M</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3706-4895</contrib-id><email>jmurray9@uoregon.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0293rh119</institution-id><institution>Institute of Neuroscience, University of Oregon</institution></institution-wrap><addr-line><named-content content-type="city">Eugene</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01nrxwf90</institution-id><institution>Discovery Brain Sciences, University of Edinburgh</institution></institution-wrap><addr-line><named-content content-type="city">Edinburgh</named-content></addr-line><country>United Kingdom</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Thirumalai</surname><given-names>Vatsala</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03gf8rp76</institution-id><institution>National Centre for Biological Sciences</institution></institution-wrap><country>India</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Poirazi</surname><given-names>Panayiota</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01gzszr18</institution-id><institution>FORTH Institute of Molecular Biology and Biotechnology</institution></institution-wrap><country>Greece</country></aff></contrib></contrib-group><pub-date publication-format="electronic" date-type="publication"><day>31</day><month>12</month><year>2025</year></pub-date><volume>14</volume><elocation-id>RP106658</elocation-id><history><date date-type="sent-for-review" iso-8601-date="2025-03-19"><day>19</day><month>03</month><year>2025</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint.</event-desc><date date-type="preprint" iso-8601-date="2025-03-01"><day>01</day><month>03</month><year>2025</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2024.12.20.629829"/></event><event><event-desc>This manuscript was published as a reviewed preprint.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2025-06-06"><day>06</day><month>06</month><year>2025</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.106658.1"/></event><event><event-desc>The reviewed preprint was revised.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2025-12-05"><day>05</day><month>12</month><year>2025</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.106658.2"/></event></pub-history><permissions><copyright-statement>© 2025, Wandler et al</copyright-statement><copyright-year>2025</copyright-year><copyright-holder>Wandler et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-106658-v1.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-106658-figures-v1.pdf"/><abstract><p>Even without detailed instruction from the brain, spinal locomotor circuitry generates coordinated behavior characterized by left–right alternation, segment-to-segment propagation, and variable-speed control. While existing models have emphasized the contributions of cellular- and network-level properties, the core mechanisms underlying rhythmogenesis remain incompletely understood. Further, neither family of models has fully accounted for recent experimental results in zebrafish and other organisms pointing to the importance of cell-type-specific intersegmental connectivity patterns and recruitment of speed-selective subpopulations of interneurons. Informed by these experimental findings and others, we developed a hierarchy of increasingly detailed models of the locomotor network. We find that coordinated locomotion emerges in an inhibition-dominated network in which connectivity is determined by intersegmental phase relationships among interneurons and variable-speed control is implemented by recruitment of speed-selective subpopulations. Further, while structured excitatory connections are not necessary for rhythmogenesis, they are useful for increasing peak locomotion frequency, albeit at the cost of smooth transitions at intermediate frequencies, suggesting a basic computational trade-off between speed and control. Together, this family of models shows that network-level interactions are sufficient to generate coordinated, variable-speed locomotion, providing new interpretations of intersegmental excitatory and inhibitory connectivity, as well as the basic, recruitment-based mechanism of speed control.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>spinal locomotor network</kwd><kwd>rhythmogenesis</kwd><kwd>speed control</kwd><kwd>recurrent neural network</kwd><kwd>interneuron connectivity</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01cwqze88</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>U01-NS136458</award-id><principal-award-recipient><name><surname>Wandler</surname><given-names>F David</given-names></name><name><surname>Lemberger</surname><given-names>Benjamin K</given-names></name><name><surname>McLean</surname><given-names>David L</given-names></name><name><surname>Murray</surname><given-names>James M</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection, and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A hierarchy of models guided by experimental results from zebrafish shows that coordinated, variable-speed locomotion can emerge from network-level interactions among interneuron populations with structured spatial connectivity.</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>publishing-route</meta-name><meta-value>prc</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>It has long been known that the spinal cord is capable of generating locomotor movements even in the absence of detailed instructive input from the brain (<xref ref-type="bibr" rid="bib7">Brown and Sherrington, 1911</xref>). The core dynamical features of spinal locomotor circuitry are left–right alternation and rostro-caudal propagation of cyclical activity over a range of frequencies. These core features are most obvious during swimming in aquatic vertebrates (<xref ref-type="bibr" rid="bib18">Grillner and Wallén, 1985</xref>), but they are also apparent during limbed locomotion (<xref ref-type="bibr" rid="bib6">Bonnot et al., 2002</xref>; <xref ref-type="bibr" rid="bib54">Yakovenko et al., 2002</xref>; <xref ref-type="bibr" rid="bib10">Cazalets, 2005</xref>; <xref ref-type="bibr" rid="bib23">Ivanenko et al., 2006</xref>; <xref ref-type="bibr" rid="bib12">Cuellar et al., 2009</xref>; <xref ref-type="bibr" rid="bib43">Saltiel et al., 2016</xref>).</p><p>Despite decades of work, the mechanisms by which rhythm is generated for coordinated locomotion are not yet fully understood. One line of research has focused on the intrinsic properties of individual excitatory spinal interneurons, whose mutual interactions serve to orchestrate rhythmic oscillations among downstream interneurons and motor neurons (<xref ref-type="bibr" rid="bib21">Grillner and Kozlov, 2021</xref>; <xref ref-type="bibr" rid="bib40">Rancic and Gosgnach, 2021</xref>; <xref ref-type="bibr" rid="bib20">Grillner and El Manira, 2015</xref>). This perspective is supported by the observation of rhythmic bursting of excitatory interneurons in response to tonic input (<xref ref-type="bibr" rid="bib51">Song et al., 2020</xref>; <xref ref-type="bibr" rid="bib1">Agha et al., 2024</xref>), but it is potentially challenged by the observation that targeted disruptions of sources of phasic inhibition interfere with rhythmogenesis (<xref ref-type="bibr" rid="bib8">Buchanan and McPherson, 1995</xref>; <xref ref-type="bibr" rid="bib35">Moult et al., 2013</xref>; <xref ref-type="bibr" rid="bib37">Picton et al., 2022</xref>; <xref ref-type="bibr" rid="bib1">Agha et al., 2024</xref>). Another line of work has suggested that rhythmic oscillations may be generated as a network-level phenomenon via random recurrent connectivity, without requiring specialized single-cell properties (<xref ref-type="bibr" rid="bib29">Lindén et al., 2022</xref>). While this model is supported by the observation of ‘rotational’ population dynamics rather than purely biphasic dynamics (<xref ref-type="bibr" rid="bib29">Lindén et al., 2022</xref>), the possible roles of particular cell types and their characteristic connectivity patterns are not addressed. In addition, the observation of recruitment of speed-selective interneuron populations (<xref ref-type="bibr" rid="bib31">McLean and Fetcho, 2011</xref>; <xref ref-type="bibr" rid="bib20">Grillner and El Manira, 2015</xref>) and the functional roles of cell-type-specific intersegmental connectivity within spinal cord (<xref ref-type="bibr" rid="bib47">Sengupta and Bagnall, 2023</xref>) have not yet been fully accounted for in either the cellular- or the network-level perspective.</p><p>Here, we construct a hierarchy of increasingly detailed models in which spinal central pattern generation occurs in a distributed manner, and the essential ingredients for producing coordinated locomotion are cell-type- and speed-specific connectivity motifs rather than specialized cellular properties or random connectivity. In all of these models, we represent individual neurons in a highly simplified way, so the dynamical properties of the network are entirely driven by emergent population dynamics due to connectivity patterns among units. First, we show that letting connectivity be determined by intersegmental phase relationships in a single-population, inhibition-dominated network is sufficient to account for left–right alternation and rostro-caudal propagation. Next, we show that dividing our units into fast- and slow-preferring populations is sufficient to account for variable-frequency control with constant phase lag via speed-dependent recruitment. Finally, in our most detailed model, we show that the strength and modularity of recurrent excitation facilitates faster locomotion, but that there is a trade-off between maximum speed and controllability at intermediate speeds.</p><p>Together, these results point to an updated model of the spinal locomotor network as a distributed pattern generator, in which rhythm generation and other locomotion features emerge from collective population dynamics via patterned connectivity and speed-dependent recruitment.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>To investigate the degree to which population-specific connectivity patterns might account for the phenomenology of the spinal network described above, we developed a family of models at different levels of detail. In order to focus our investigation on connectivity patterns and the emergent population dynamics that result from them, we modeled the dynamics of individual neurons in a highly simplified way:<disp-formula id="equ1"><label>(1)</label><alternatives><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo mathvariant="bold">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t1">\begin{document}$$\displaystyle \tau_{i}\frac{dr_{i}(t)}{dt}=-r_{i}(t)+\left[{\boldsymbol \sum}_{j}{\boldsymbol W}_{ij}{\boldsymbol r}_{j}(t-\Delta_{ij})+D_{i}\right]_{+},$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <inline-formula><alternatives><mml:math id="inf1"><mml:msub><mml:mi>r</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="inft1">\begin{document}$r_{i}(t)$\end{document}</tex-math></alternatives></inline-formula> is interpreted as the firing rate of unit <inline-formula><alternatives><mml:math id="inf2"><mml:mi>i</mml:mi></mml:math><tex-math id="inft2">\begin{document}$i$\end{document}</tex-math></alternatives></inline-formula> at time <inline-formula><alternatives><mml:math id="inf3"><mml:mi>t</mml:mi></mml:math><tex-math id="inft3">\begin{document}$t$\end{document}</tex-math></alternatives></inline-formula>, <inline-formula><alternatives><mml:math id="inf4"><mml:msub><mml:mi>τ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft4">\begin{document}$\tau_{i}$\end{document}</tex-math></alternatives></inline-formula> is the membrane time constant, <inline-formula><alternatives><mml:math id="inf5"><mml:msub><mml:mi>D</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft5">\begin{document}$D_{i}$\end{document}</tex-math></alternatives></inline-formula> is the tonic drive, <inline-formula><alternatives><mml:math id="inf6"><mml:msub><mml:mi>W</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft6">\begin{document}$W_{ij}$\end{document}</tex-math></alternatives></inline-formula> are recurrent weights from other units in the circuit, and <inline-formula><alternatives><mml:math id="inf7"><mml:mo stretchy="false">[</mml:mo><mml:mo>.</mml:mo><mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:math><tex-math id="inft7">\begin{document}$[.]_{+}$\end{document}</tex-math></alternatives></inline-formula> denotes rectification. The axonal time delays <inline-formula><alternatives><mml:math id="inf8"><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft8">\begin{document}$\Delta_{ij}$\end{document}</tex-math></alternatives></inline-formula> are proportional to the number of segments between units <inline-formula><alternatives><mml:math id="inf9"><mml:mi>i</mml:mi></mml:math><tex-math id="inft9">\begin{document}$i$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf10"><mml:mi>j</mml:mi></mml:math><tex-math id="inft10">\begin{document}$j$\end{document}</tex-math></alternatives></inline-formula>.</p><p>The three subsections that follow describe a hierarchy of increasingly detailed models, all of which are described by this basic dynamical equation. This approach enables us to focus mainly on basic computational properties within the relatively abstract, high-level model, whereas the lower-level models focus on implementation of distinct cell-type populations for obtaining additional features.</p><sec id="s2-1"><title>Phase relationships determine connectivity in a distributed pattern generator</title><p>Recent work mapping cell-type-specific connectivity patterns in zebrafish (<xref ref-type="bibr" rid="bib32">Menelaou et al., 2014</xref>; <xref ref-type="bibr" rid="bib48">Sengupta et al., 2025</xref>; <xref ref-type="bibr" rid="bib47">Sengupta and Bagnall, 2023</xref>), mouse (<xref ref-type="bibr" rid="bib2">Alaynick et al., 2011</xref>; <xref ref-type="bibr" rid="bib17">Goulding, 2009</xref>), and other organisms has revealed a substantial presence of both excitatory and inhibitory connectivity traversing multiple segments. This is somewhat difficult to interpret in light of classical models of the spinal locomotor circuit, in which dynamical single-cell properties such as bursting or synaptic fatigue generate oscillations within each segment, and these oscillators are then coupled together with intersegmental interactions (see <xref ref-type="bibr" rid="bib11">Cohen et al., 1992</xref>; <xref ref-type="bibr" rid="bib49">Sigvardt and Miller, 1998</xref>; <xref ref-type="bibr" rid="bib19">Grillner et al., 2007</xref>; <xref ref-type="bibr" rid="bib3">Ausborn et al., 2021</xref> for reviews). We hypothesized that spatially patterned connectivity alone may be sufficient to drive coordinated locomotion even in the absence of dynamical single-cell properties. To test this, we constructed a high-level model in which dynamical single-cell properties are absent, and the basic features of left–right alternation and segment-to-segment propagation are driven by connectivity patterns. We took inspiration from ‘moving bump’ models of brain circuits, for example in models of head-direction circuits, which have shown that inhibition-dominated, asymmetric connectivity can give rise to activation sequences (<xref ref-type="bibr" rid="bib55">Zhang, 1996</xref>; <xref ref-type="bibr" rid="bib44">Samsonovich and McNaughton, 1997</xref>; <xref ref-type="bibr" rid="bib36">Murray and Escola, 2017</xref>). Such models are also motivated by recent work in zebrafish demonstrating the importance of strong phasic inhibition for generating rhythmic locomotor activity (<xref ref-type="bibr" rid="bib1">Agha et al., 2024</xref>). This high-level model featured a single, homogeneous population of units described by <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>, where all units have identical membrane time constant <inline-formula><alternatives><mml:math id="inf11"><mml:mi>τ</mml:mi></mml:math><tex-math id="inft11">\begin{document}$\tau$\end{document}</tex-math></alternatives></inline-formula> and common excitatory input drive <inline-formula><alternatives><mml:math id="inf12"><mml:mi>D</mml:mi></mml:math><tex-math id="inft12">\begin{document}$D$\end{document}</tex-math></alternatives></inline-formula>.</p><p>The connections <inline-formula><alternatives><mml:math id="inf13"><mml:msub><mml:mi>W</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft13">\begin{document}$W_{ij}$\end{document}</tex-math></alternatives></inline-formula> between units in this model were all set to be negative or zero, so that units in the model receive excitation only from the tonic drive, not from each other. Previous related work on threshold-linear recurrent networks with binary inhibitory weights and tonic input has shown that, despite their relative simplicity, such networks are capable of supporting rich dynamics (<xref ref-type="bibr" rid="bib13">Curto and Morrison, 2023</xref>). Due to the (piecewise) linearity of the activation function, the magnitude of the nonzero weights has no effect on the dynamics, so we set <inline-formula><alternatives><mml:math id="inf14"><mml:msub><mml:mi>W</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:math><tex-math id="inft14">\begin{document}$W_{ij}=-1$\end{document}</tex-math></alternatives></inline-formula>.</p><p>Given these simplifying choices, the nontrivial question in designing this model is which pairs of units should inhibit one another. The key principle that this model led us to is that the connectivity between pairs of units should encode the desired phase relationships between those units. A version of this idea is already present in classical models, where left and right populations of neurons within each segment laterally inhibit one another, ensuring that they fire exactly out of phase. Here, we apply this same principle to model the longitudinal connectivity of the spinal locomotor network.</p><p>According to this principle, a mid-body unit should inhibit contralateral units in the same segment and in nearby segments, as well as inhibiting ipsilateral units more distally (shown schematically for a <inline-formula><alternatives><mml:math id="inf15"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>9</mml:mn></mml:math><tex-math id="inft15">\begin{document}$N=9$\end{document}</tex-math></alternatives></inline-formula>-segment model in <xref ref-type="fig" rid="fig1">Figure 1A</xref>). To make this precise, we can summarize the desired phase relationships for a pair of units <inline-formula><alternatives><mml:math id="inf16"><mml:mi>i</mml:mi></mml:math><tex-math id="inft16">\begin{document}$i$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf17"><mml:mi>j</mml:mi></mml:math><tex-math id="inft17">\begin{document}$j$\end{document}</tex-math></alternatives></inline-formula> as follows:<disp-formula id="equ2"><label>(2)</label><alternatives><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mtext>mod</mml:mtext><mml:mtext> </mml:mtext><mml:mi>N</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mtext>mod</mml:mtext><mml:mtext> </mml:mtext><mml:mn>2</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t2">\begin{document}$$\displaystyle \phi_{ij}=\frac{(s_{i}-s_{j})\ \text{mod}\ N}{N}+\frac{(a_{i}-a_{j})\ \text{mod}\ 2}{2},$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <inline-formula><alternatives><mml:math id="inf18"><mml:mi>N</mml:mi></mml:math><tex-math id="inft18">\begin{document}$N$\end{document}</tex-math></alternatives></inline-formula> is the number of segments. In this equation, <inline-formula><alternatives><mml:math id="inf19"><mml:msub><mml:mi>s</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft19">\begin{document}$s_{i}$\end{document}</tex-math></alternatives></inline-formula> denotes the segment number of unit <inline-formula><alternatives><mml:math id="inf20"><mml:mi>i</mml:mi></mml:math><tex-math id="inft20">\begin{document}$i$\end{document}</tex-math></alternatives></inline-formula>, and <inline-formula><alternatives><mml:math id="inf21"><mml:msub><mml:mi>a</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><tex-math id="inft21">\begin{document}$a_{i}=0$\end{document}</tex-math></alternatives></inline-formula> if unit <inline-formula><alternatives><mml:math id="inf22"><mml:mi>i</mml:mi></mml:math><tex-math id="inft22">\begin{document}$i$\end{document}</tex-math></alternatives></inline-formula> is in the left hemi-segment or 1 if it is in the right hemi-segment.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>A single-population recurrent network generates rhythm, segment-to-segment propagation, and left–right alternation.</title><p>(<bold>A</bold>) Schematic connectivity diagram. Grayscale circles represent individual units at different phases of oscillation, with one unit per hemi-segment. Red lines schematically illustrate inhibitory projections from a mid-body unit. (<bold>B</bold>) Weight matrix illustrating all outgoing inhibitory projections from the mid-body unit labeled with a red dot. (<bold>C</bold>) Time dependence of network activity with all units receiving the same tonic drive. The different traces represent different units.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-106658-fig1-v1.tif"/></fig><p>In order to realize these desired phase relationships, we set the connection strength from neuron <inline-formula><alternatives><mml:math id="inf23"><mml:mi>j</mml:mi></mml:math><tex-math id="inft23">\begin{document}$j$\end{document}</tex-math></alternatives></inline-formula> to neuron <inline-formula><alternatives><mml:math id="inf24"><mml:mi>i</mml:mi></mml:math><tex-math id="inft24">\begin{document}$i$\end{document}</tex-math></alternatives></inline-formula> as <inline-formula><alternatives><mml:math id="inf25"><mml:msub><mml:mi>W</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="inft25">\begin{document}$W_{ij}=f(\phi_{ij})$\end{document}</tex-math></alternatives></inline-formula>, where <inline-formula><alternatives><mml:math id="inf26"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft26">\begin{document}$\phi_{ij}\in[0,1)$\end{document}</tex-math></alternatives></inline-formula> is calculated from <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>, and<disp-formula id="equ3"><label>(3)</label><alternatives><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mml:mtr><mml:mtd><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mtext>else</mml:mtext><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t3">\begin{document}$$\displaystyle  f(\phi)=\begin{cases} -1,\quad\phi_{l} \lt \phi \lt \phi_{u},\\ 0,\quad\text{else}.\end{cases}$$\end{document}</tex-math></alternatives></disp-formula></p><p>This equation describes local contralateral inhibition together with more-distal ipsilateral inhibition. Because <inline-formula><alternatives><mml:math id="inf27"><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:math><tex-math id="inft27">\begin{document}$\phi_{ij}=0.5$\end{document}</tex-math></alternatives></inline-formula> for two units that are out of phase, it is necessary to choose <inline-formula><alternatives><mml:math id="inf28"><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0.5</mml:mn></mml:math><tex-math id="inft28">\begin{document}$\phi_{l} \lt 0.5$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf29"><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0.5</mml:mn></mml:math><tex-math id="inft29">\begin{document}$\phi_{u} \gt 0.5$\end{document}</tex-math></alternatives></inline-formula>. Further, in order for propagation to proceed head-to-tail rather than tail-to-head, it is necessary for the connectivity to be asymmetric, with a relatively larger window of disinhibition downstream and a relatively smaller window of disinhibition upstream. Hence, we chose <inline-formula><alternatives><mml:math id="inf30"><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:math><tex-math id="inft30">\begin{document}$\phi_{l}=0.3$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf31"><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:math><tex-math id="inft31">\begin{document}$\phi_{u}=0.8$\end{document}</tex-math></alternatives></inline-formula> to define the window of inhibition. Finally, we can note that the most-distal ipsilateral projections described by <xref ref-type="disp-formula" rid="equ3">Equation 3</xref> (of length <inline-formula><alternatives><mml:math id="inf32"><mml:mo>≳</mml:mo><mml:mi>N</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:math><tex-math id="inft32">\begin{document}$\gtrsim N/2$\end{document}</tex-math></alternatives></inline-formula>) are not actually necessary, since the units targeted by such inhibition already receive contralateral inhibition from nearby active units on the opposite side. Indeed, such long-range projections are not typically found in the zebrafish (<xref ref-type="bibr" rid="bib22">Higashijima et al., 2004</xref>; <xref ref-type="bibr" rid="bib9">Callahan et al., 2019</xref>; <xref ref-type="bibr" rid="bib46">Sengupta et al., 2021</xref>). Hence, in this model and in the others presented below, all connections between segments more than 13 segments apart were set to 0 (<xref ref-type="fig" rid="fig1">Figure 1B</xref>).</p><p>Driving this network with tonic input, and setting the axonal delay <inline-formula><alternatives><mml:math id="inf33"><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><tex-math id="inft33">\begin{document}$\Delta_{ij}=0$\end{document}</tex-math></alternatives></inline-formula> for simplicity, we observed the key features of coordinated locomotion: phasic bumps of activity in each segment, with smooth propagation of the bump from head to tail and strict alternation between left and right within each segment (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). While this high-level model is a highly simplified and abstract representation of the spinal locomotor network, it illustrates several key ideas that may be relevant for characterizing locomotor circuitry in biological organisms and will continue to be present in the more elaborate models developed in the following subsections. First, rhythm can be generated by the network as a whole, rather than by dynamical single-neuron properties or single-segment oscillations. Second, the network’s recurrent connectivity is dominated by inhibition, illustrating that inhibition is capable of and perhaps necessary for sculpting the dynamics. Finally, the pattern of inhibitory connectivity is determined by the desired phase relationships between pairs of units. In the following sections, we will build upon this model by introducing multiple interneuron populations and allowing for more-heterogeneous connectivity between units.</p></sec><sec id="s2-2"><title>Fast and slow speed modules implement frequency control via recruitment</title><p>While the single-population model described above was able to implement coordinated locomotion, it did so at a single, fixed frequency. This frequency was set by the only timescale in the model: the membrane time constant. Inspired by observations of <italic>speed-module</italic> structure in spinal circuitry in zebrafish (<xref ref-type="bibr" rid="bib30">McLean et al., 2008</xref>) and mouse (<xref ref-type="bibr" rid="bib39">Rancic et al., 2020</xref>), whereby interneurons are recruited at either fast or slow locomotion speeds but not both, we made a minimal change to our initial model that introduces an additional timescale, replacing each unit by two units: a ‘fast’ unit with a 1-ms membrane time constant, and a ‘slow’ unit with a 10-ms time constant, as observed experimentally in larval zebrafish (<xref ref-type="bibr" rid="bib34">Menelaou et al., 2022</xref>). Trivially, in the absence of connectivity between the fast and slow modules, this model amounts to two copies of our earlier model and is capable of operating at two speeds: a fast speed if tonic input is provided only to the fast-preferring units, and a slow speed if tonic input is provided only to the slow-preferring units (<xref ref-type="bibr" rid="bib38">Pujala and Koyama, 2019</xref>). In each case, the period of left–right alternation and head-to-tail propagation would be roughly proportional to the corresponding membrane time constant (though perhaps not perfectly proportional if axonal delays are included).</p><p>In order for the two parts of the network to oscillate at a single global frequency and to interpolate continuously between slow and fast speeds, connectivity between the two modules is required. To begin, we adopted the simplest choice and made the connectivity weights the same for between-module projections and within-module projections, with the same spatial connectivity patterns for between- and within-module projections (<xref ref-type="fig" rid="fig2">Figure 2A, B</xref>). We found that the circuit exhibited coordinated locomotion characterized by head-to-tail propagation and left–right alternation at a single global frequency that was intermediate between the characteristic frequencies of the fast and slow modules. Further, the locomotion frequency could be controlled in a graded manner by driving the two modules with different inputs. Locomotion was fast when the fast units received most of the tonic drive, and it was slow when the slow units received most of the tonic drive, with smooth interpolation of intermediate frequencies as the ratio of tonic drives was varied (<xref ref-type="fig" rid="fig2">Figure 2C</xref>).</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Fast and slow speed modules enable control of locomotion frequency.</title><p>(<bold>A</bold>) Connectivity schematic illustrating that fast- and slow-module units receive distinct tonic drives and project both within and between modules. (<bold>B</bold>) Map of outgoing projections from a mid-body unit (red). (<bold>C</bold>) Time-dependent activity of fast- and slow-module units given different levels of tonic drive to the two populations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-106658-fig2-v1.tif"/></fig><p>Analyzing the model in greater detail revealed that varying the relative levels of tonic drive to the two populations strongly modulated the frequency (<xref ref-type="fig" rid="fig3">Figure 3A, B</xref>). This is made possible by selective recruitment of fast and slow speed modules, such that the fast population is active at faster locomotion frequencies, while the slow population is active at slower locomotion frequencies, with a smooth crossover between these two regimes (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). Such recruitment has been observed experimentally (<xref ref-type="bibr" rid="bib30">McLean et al., 2008</xref>) but has not been accounted for by previous models. In <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>, we further show that the disengagement of the slow module as frequency increases can occur due to inhibition from the increasingly active fast module, without requiring changes in the tonic drive to the slow population, which is also observed experimentally (<xref ref-type="bibr" rid="bib30">McLean et al., 2008</xref>).</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Speed-module recruitment enables frequency control.</title><p>(<bold>A</bold>) Locomotion frequency with different levels of tonic drive to fast and slow units. (<bold>B</bold>) Frequency along the path shown in (<bold>A</bold>). (<bold>C</bold>) Frequency-dependent recruitment of fast and slow units as a function of locomotion frequency along the path shown in (<bold>A</bold>). (<bold>D</bold>) Phase difference between left and right units within each segment (dotted line corresponds to half of a period). (<bold>E</bold>) Phase difference (where 1 corresponds to a full period of oscillation) between pairs of units on the same side in adjacent segments (dotted line corresponds to <inline-formula><alternatives><mml:math id="inf34"><mml:mn>1</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>N</mml:mi></mml:math><tex-math id="inft34">\begin{document}$1/N$\end{document}</tex-math></alternatives></inline-formula>, where <inline-formula><alternatives><mml:math id="inf35"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>30</mml:mn></mml:math><tex-math id="inft35">\begin{document}$N=30$\end{document}</tex-math></alternatives></inline-formula> is the number of segments). Error bars in all panels denote standard deviation across units.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-106658-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Recruitment of the fast module at high frequencies inhibits the slow module.</title><p>Frequency-dependent recruitment of fast and slow units as a function of locomotion frequency with constant drive to the slow population (left: small drive; right: large drive) and varying drive to the fast population.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-106658-fig3-figsupp1-v1.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Frequency determination from time series is performed through calculating the period from the autocorrelation spectrum.</title><p>(<bold>A</bold>) An example of a high-frequency rate time series from a single unit in the eight-population model. (<bold>B</bold>) The autocorrelation spectrum corresponding to the time series in (<bold>A</bold>). The global minimum and resultant period are marked in dashed and solid lines, respectively. (<bold>C</bold>) An example of a low-frequency time series from a single unit in the eight-population model. (<bold>D</bold>) The autocorrelation spectrum for the time series in (<bold>C</bold>). The global minimum and resultant period are marked in dashed and solid lines, respectively. (<bold>E</bold>) An example time series without a single dominant frequency in the eight-population model. The failure was brought about by increasing the global strength of excitatory connections to 0.5 and the modularity to 0.4. (<bold>F</bold>) The autocorrelation spectrum of the time series in (<bold>E</bold>). The global minimum and resultant period are marked in dashed and solid black lines, respectively. The first local minimum and resultant period are marked in dashed and solid red lines, respectively.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-106658-fig3-figsupp2-v1.tif"/></fig></fig-group><p>To establish that the model exhibits coordinated locomotion across all frequencies, we additionally computed the left–right phase difference between the pairs of units on either side of each segment, finding that the phase differed by half of a period across all locomotion frequencies (<xref ref-type="fig" rid="fig3">Figure 3D</xref>). We then computed the phase difference between pairs of units in adjacent segments, finding that this phase was approximately equal to <inline-formula><alternatives><mml:math id="inf36"><mml:mn>1</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>N</mml:mi></mml:math><tex-math id="inft36">\begin{document}$1/N$\end{document}</tex-math></alternatives></inline-formula> across all locomotion frequencies, where <inline-formula><alternatives><mml:math id="inf37"><mml:mi>N</mml:mi></mml:math><tex-math id="inft37">\begin{document}$N$\end{document}</tex-math></alternatives></inline-formula> is the number of segments (<xref ref-type="fig" rid="fig3">Figure 3E</xref>), so that the length of the spinal cord exhibits approximately one period of oscillation. This <italic>constant phase lag</italic> relationship is a core feature of locomotion that has been observed during swimming in a variety of animals (<xref ref-type="bibr" rid="bib50">Skinner and Mulloney, 1998</xref>). While it does not appear by default in models that chain individually oscillating segments together via longitudinal excitation, constant phase lag emerges in our model as a natural consequence of the fact that the desired phase relationships between segments are built into the circuitry via long-range inhibitory projections. Because the phase relationships are determined by the connectivity, which is the same at all speeds, the phase relationships do not depend on locomotion frequency.</p><p>These results show that, by including fast and slow subpopulations and coupling these sub-networks together, the model succeeds in producing coordinated locomotion across a broad range of frequencies, with control of frequency via selective recruitment of the two subpopulations. While this model succeeds in producing much of the phenomenology of the spinal locomotor network, it does not yet fully address the diversity of excitatory and inhibitory cell types that are known to play a role in the biological circuitry (<xref ref-type="bibr" rid="bib47">Sengupta and Bagnall, 2023</xref>). We turn our attention to this question in the following section.</p></sec><sec id="s2-3"><title>Excitatory and inhibitory cell types</title><p>To address the role of cell-type-specific connectivity patterns in greater detail, we next incorporated excitatory and distinct inhibitory populations by replacing each unit in the above model with four units, leading to an eight-population model (since each of the four types has fast and slow subtypes) (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). One of these populations (corresponding to V2a interneurons in the zebrafish) consisted of excitatory units with descending, ipsilateral projections. The other three populations consisted of inhibitory units, essentially breaking the inhibitory population from the earlier model into three populations that have identical activity (since they all receive the same inputs) but differ in their projection targets. One population of inhibitory units (corresponding to V1 interneurons in the zebrafish) had ascending, ipsilateral projections; another (corresponding to V2b interneurons in the zebrafish) had descending, ipsilateral projections; and a third (corresponding to dI6 and V0d interneurons in the zebrafish) had contralateral projections. The tonic drive was provided equally to all units.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>A model with excitatory and inhibitory populations.</title><p>(<bold>A</bold>) Schematic diagram illustrating connectivity among cell types (but not longitudinal connectivity) for the eight-population model. (<bold>B</bold>) Detailed connectivity matrices for an example mid-body unit from each population. (<bold>C</bold>) Time-dependent activity traces at slow (left) and fast (right) locomotion frequencies (traces are slightly offset for clarity).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-106658-fig4-v1.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Speed-module recruitment enables coordinated locomotion with frequency and amplitude control in an eight-population model.</title><p>(<bold>A</bold>) Amplitude of the fast population (left), the slow population (center), and averaged over the fast and slow populations (right). (<bold>B</bold>) Levels of tonic drive to the fast and slow populations determine locomotion frequency. (<bold>C</bold>) Average amplitude and frequency along the path shown as a solid line in (<bold>A-B</bold>). (<bold>D</bold>) Average amplitude and frequency along the path shown as a dash-dot line in (<bold>A-B</bold>). (<bold>E</bold>) Frequency-dependent recruitment of fast and slow units as a function of locomotion frequency. (<bold>F</bold>) Phase difference between units within each segment (dotted line corresponds to half of a period). (<bold>G</bold>) Phase difference between pairs of units on the same side in adjacent segments (dotted line corresponds to, <inline-formula><alternatives><mml:math id="inf38"><mml:mn>1</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>N</mml:mi></mml:math><tex-math id="inft38">\begin{document}$1/N$\end{document}</tex-math></alternatives></inline-formula>, where <inline-formula><alternatives><mml:math id="inf39"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>30</mml:mn></mml:math><tex-math id="inft39">\begin{document}$N=30$\end{document}</tex-math></alternatives></inline-formula> is the number of segments). Error bars in all panels denote standard deviation across units.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-106658-fig4-figsupp1-v1.tif"/></fig></fig-group><p>The outgoing spatial connectivity of each of these cell types is illustrated in <xref ref-type="fig" rid="fig4">Figure 4B</xref>. Each cell-type projects equally to all of the units within each segment that it targets, so that all units within each segment receive the same inputs. As in the two-population model above, we set the spatial connectivity patterns for the inhibitory units according to the desired phase relationships between units, with short-range contralateral inhibition and intermediate-range ipsilateral inhibition. For the excitatory units, we assumed that the projections are descending only in order to facilitate head-to-tail propagation. All units within each speed module had the same membrane time constant and axonal conduction velocity. As in the earlier models, providing distinct tonic drives to the fast- and slow-module units led to coordinated locomotion at a range of frequencies (<xref ref-type="fig" rid="fig4">Figure 4C</xref>).</p><p>Before analyzing the full model in detail, we decoupled the two speed modules from one another and began by studying the effects of various single-cell and cell-type-specific connectivity properties on the characteristic oscillation frequency of an individual speed module. Unsurprisingly, the locomotion frequency depended strongly on the membrane time constants, with smaller values of these parameters leading to faster frequencies (<xref ref-type="fig" rid="fig5">Figure 5A, B</xref>). Because the characteristic frequencies of the two speed modules set the upper and lower limits of locomotion frequency once the modules are coupled together in the full model, it is likely advantageous for an organism to have values of these parameters that differ strongly in fast- and slow-preferring neurons. This agrees with observations from the zebrafish, where the membrane time constants and axonal delays differ for fast- and slow-preferring excitatory and inhibitory interneurons (<xref ref-type="bibr" rid="bib33">Menelaou and McLean, 2019</xref>; <xref ref-type="bibr" rid="bib34">Menelaou et al., 2022</xref>). For our subsequent simulations, we fixed these parameters for the fast and slow modules at the experimentally determined values indicated in <xref ref-type="fig" rid="fig5">Figure 5A, B</xref>; <xref ref-type="bibr" rid="bib33">Menelaou and McLean, 2019</xref>; <xref ref-type="bibr" rid="bib34">Menelaou et al., 2022</xref>.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Single-cell properties and excitatory connectivity influence locomotor frequency in an individual speed module.</title><p>(<bold>A, B</bold>) Dependence of locomotion frequency on the axonal delay per segment and membrane time constant of units ((<bold>A</bold>) shows a broad range of values; (<bold>B</bold>) shows an inset from (<bold>A</bold>)). Stars denote experimentally observed values for fast and slow excitatory V2a cells in zebrafish (<xref ref-type="bibr" rid="bib33">Menelaou and McLean, 2019</xref>; <xref ref-type="bibr" rid="bib34">Menelaou et al., 2022</xref>). (<bold>C</bold>) Dependence of locomotion frequency on the projection distances of excitatory connections originating from the excitatory unit labeled blue.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-106658-fig5-v1.tif"/></fig><p>We next investigated the effect of connectivity properties on locomotion frequency for the decoupled speed module. We found that the frequency was modulated by more than a factor of two as the excitatory projection distances were varied (<xref ref-type="fig" rid="fig5">Figure 5C</xref>). This agrees with observations from zebrafish, where the extents of intersegmental projections have been shown to differ for fast- and slow-preferring excitatory interneurons, with fast-preferring V2a interneurons projecting more distally than slow-preferring V2a neurons (<xref ref-type="bibr" rid="bib32">Menelaou et al., 2014</xref>). For our subsequent simulations, we fixed these parameters for the fast and slow modules at the experimentally determined values illustrated in <xref ref-type="fig" rid="fig5">Figure 5B</xref> (<xref ref-type="bibr" rid="bib32">Menelaou et al., 2014</xref>).</p><p>Having shown that the spatial extent of excitatory projections has a strong effect on locomotion frequency, we next asked whether varying connectivity properties would also modulate the range of possible frequencies in the full model with two coupled speed modules. Varying the global strength of excitatory projections had a strong effect on the range of possible frequencies, with stronger excitation facilitating faster locomotion (<xref ref-type="fig" rid="fig6">Figure 6A</xref>). In particular, whereas the purely inhibitory model with experimentally determined membrane time constants and axonal conduction velocities realizes a maximum frequency much lower than that observed in larval zebrafish (approximately 20 Hz, black line in <xref ref-type="fig" rid="fig6">Figure 6A</xref>), the inclusion of excitatory interneurons facilitates maximum frequencies of over 50 Hz, which is approaching peak swim speeds in larval zebrafish (<xref ref-type="bibr" rid="bib1">Agha et al., 2024</xref>). Thus, while excitatory interneurons are not necessary for producing coordinated locomotion in our model, they do facilitate faster locomotion, suggesting that this may be a fundamental role for feedforward excitation in the spinal network.</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Frequency range depends on excitatory projection strength and modularity.</title><p>(<bold>A</bold>) Dependence of the range of possible locomotion frequencies on the global strength of excitatory projections relative to that of inhibitory projections. (<bold>B</bold>) Dependence of the frequency range on connectivity modularity, which quantifies the strength of inter-module (fast-to-slow and slow-to-fast) projections relative to intra-module (fast-to-fast and slow-to-slow) projections. (Missing intermediate points correspond to cases where coordinated locomotion does not appear.) (<bold>C</bold>) Dependence of the frequency range on connectivity modularity of excitatory units, where inhibitory units have modularity set to zero. (<bold>D</bold>) Dependence of the frequency range on connectivity modularity of inhibitory units, where excitatory units have modularity set to zero. (In (<bold>A</bold>), modularity is set to zero; in (<bold>B-D</bold>), strength of excitation is set to 0.4.)</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-106658-fig6-v1.tif"/></fig><p>Given that connectivity within and between speed modules has been shown in zebrafish to be modular, with stronger projections within modules than between modules (<xref ref-type="bibr" rid="bib51">Song et al., 2020</xref>), we asked what would be the effect of varying modularity in the model. We defined modularity as the difference between intra- versus inter-module connection strength divided by the sum of these quantities, such that modularity of 1 corresponds to fully decoupled modules, while modularity of 0 corresponds to identical connection strengths within versus between modules.</p><p>Varying the modularity of all four populations together, we found that there was essentially no effect on the maximum or minimum possible frequencies. Further, the model lost the ability to produce locomotion at intermediate frequencies as modularity was increased (<xref ref-type="fig" rid="fig6">Figure 6B</xref>). However, when we varied modularity among only the excitatory or only the inhibitory populations, we observed much more significant changes in the maximum frequency (<xref ref-type="fig" rid="fig6">Figure 6C, D</xref>). These changes occurred in opposite directions, with excitatory (inhibitory) modularity favoring faster (slower) speeds, suggesting that the lack of an observed change in frequency range when both types of modularity were varied together (<xref ref-type="fig" rid="fig6">Figure 6B</xref>) was due to cancellation between these two effects.</p><p>Together, these results show that the strength of feedforward excitation and the modularity of excitatory connectivity have a strong effect on the range of possible locomotion frequencies. There is a trade-off, however, in that the model loses the ability to smoothly interpolate between fast and slow frequencies in cases where the excitatory connectivity becomes too strong or too modular (<xref ref-type="fig" rid="fig6">Figure 6A, C</xref>). This requirement that excitation not be too strong is in accord with experimental observations from zebrafish (<xref ref-type="bibr" rid="bib1">Agha et al., 2024</xref>), which have shown that peak excitatory post-synaptic currents are much weaker than peak inhibitory post-synaptic currents in V2a interneurons, consistent with the possibility that excitation may be globally weaker than inhibition in the spinal circuitry. Further, the fact that the model exhibits a frequency range similar to that of the zebrafish for parameters that are close to the critical values where smooth frequency control becomes impossible suggests that the spinal locomotor circuit faces a trade-off between speed and controllability, and that its excitatory connectivity may be configured in a way that optimizes this trade-off.</p><p>Having established the roles played by single-cell and connectivity properties of different cell types in the eight-population model, we fixed these parameters and analyzed the behavior of the model over the range of possible tonic drives to fast and slow populations (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). Similar to the two-population model, the eight-population with coupled fast and slow speed modules model exhibited head-to-tail propagation with constant phase lag (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1G</xref>), left–right alternation (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1F</xref>), and frequency-dependent recruitment of fast and slow populations (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1E</xref>). In addition to varying the frequency of oscillations, we also found that the overall amplitude of interneuron activity in the model could be varied by co-varying the drives to the fast and slow populations (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1C, D</xref>). This provides a potential mechanism to independently control frequency and amplitude of locomotion, although the manner in which the amplitude of interneuron activity relates to the amplitude of locomotion would depend on the assumptions made about how interneuron activity drives the activity of motor neurons, which we have not included in our models.</p><p>We next investigated the effects of perturbing the model by partially ablating (i.e. attenuating the outgoing activity of) each interneuron population (<xref ref-type="fig" rid="fig7">Figure 7</xref>). At all locomotion speeds, we found that ablating excitatory units decreased locomotion frequency. This is in agreement with experiments in zebrafish, where ablation of excitatory V2a interneurons had the same effect (<xref ref-type="bibr" rid="bib15">Eklöf-Ljunggren et al., 2012</xref>). Further, we found that ablating inhibitory units with ascending ipsilateral projections decreased locomotor frequency, while ablating inhibitory units with descending projections increased locomotor frequency across all locomotion speeds. This is also in agreement with experiments in zebrafish, where ablation of inhibitory V1 interneurons slowed swimming (<xref ref-type="bibr" rid="bib26">Kimura and Higashijima, 2019</xref>), while ablation of V2b interneurons led to faster swimming (<xref ref-type="bibr" rid="bib9">Callahan et al., 2019</xref>; <xref ref-type="bibr" rid="bib48">Sengupta et al., 2025</xref>). Finally, we found that ablating the contralaterally projecting inhibitory units led to a modest increase in frequency, but that coordinated locomotion was lost when the degree of ablation became too great. The impact on frequency was most obvious at fast speeds, with a more modest impact at slow speeds. This is consistent with recent experiments in zebrafish, which found the impact of attenuating contralateral inhibitory projections from dI6 neurons on coordination was most obvious at fast speeds (<xref ref-type="bibr" rid="bib1">Agha et al., 2024</xref>). Similar results were found in <italic>Xenopus</italic>, where silencing contralaterally projecting inhibitory interneurons can eliminate rhythm generation (<xref ref-type="bibr" rid="bib35">Moult et al., 2013</xref>) or lead to an increase in swim frequency (<xref ref-type="bibr" rid="bib14">Dale, 1995</xref>). Together, these results show that, where comparisons with experimental data are possible, perturbations to our model lead to effects on locomotion frequency that generally agree with experimental observations. This agreement provides support for the possibility that the basic mechanisms underlying variable-frequency locomotion in our model—namely cell-type-specific connectivity patterns and speed-module recruitment—may also be at play in the spinal locomotor network.</p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Ablating populations affects locomotion frequency dependence of locomotion frequency (normalized to its unperturbed value) on ablation of each of the four interneuron populations during slow speed oscillations (dashed lines; fast drive = 1.0, slow drive = 1.0; frequency = 9.3 Hz) and fast speed oscillations (dotted lines; fast drive = 2.0, slow drive = 0.5; frequency = 34.0 Hz).</title><p>Asterisks mark points where the model failed to produce a coherent oscillation (see Methods).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-106658-fig7-v1.tif"/></fig></sec><sec id="s2-4"><title>Robustness in a biophysical model</title><p>One potential pitfall with the ‘rate models’ considered above is that the oscillatory behavior seen in these models might be overwhelmed by the inherent stochasticity of a biophysical setting. To test the robustness of our connectivity-based mechanisms for rhythmogenesis and frequency control, we built a spiking-neuron version of each model.</p><p>The spiking models were generated from the rate models by replacing each unit in the rate model with <inline-formula><alternatives><mml:math id="inf40"><mml:mi>n</mml:mi></mml:math><tex-math id="inft40">\begin{document}$n$\end{document}</tex-math></alternatives></inline-formula> leaky-integrate-and-fire (LIF) neurons. A rough estimate suggests that the locomotor circuit is made up of 50–100 neurons of each cell type per segment (<xref ref-type="bibr" rid="bib1">Agha et al., 2024</xref>; <xref ref-type="bibr" rid="bib9">Callahan et al., 2019</xref>; <xref ref-type="bibr" rid="bib46">Sengupta et al., 2021</xref>; <xref ref-type="bibr" rid="bib27">Kishore et al., 2020</xref>). In accordance with this estimate, most of our simulations use <inline-formula><alternatives><mml:math id="inf41"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>80</mml:mn></mml:math><tex-math id="inft41">\begin{document}$n=80$\end{document}</tex-math></alternatives></inline-formula>, though versions with smaller <inline-formula><alternatives><mml:math id="inf42"><mml:mi>n</mml:mi></mml:math><tex-math id="inft42">\begin{document}$n$\end{document}</tex-math></alternatives></inline-formula> also performed well (<xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1</xref>). Connectivity between neurons in the spiking model was determined by including a random fraction <inline-formula><alternatives><mml:math id="inf43"><mml:mi>p</mml:mi></mml:math><tex-math id="inft43">\begin{document}$p$\end{document}</tex-math></alternatives></inline-formula> of all possible connections between groups of neurons corresponding to connected units in the rate model. The strength of these connections was determined by the strength of the corresponding connection in the rate model (for details, see Methods).</p><p>In addition to the stochasticity introduced via the randomized connectivity, we introduced stochasticity in the spiking model by replacing the tonic input drive of the rate model with EI-balanced Poisson input. This input was independently sampled for each neuron, with a uniform rate for each speed population. In the rate model, a given tonic drive represented the firing rate that an isolated unit would maintain without recurrent connections. To similarly control the input to the spiking model, the rates of the EI-balanced Poisson inputs were chosen to produce a target firing rate in an isolated LIF neuron. Since frequency control depended primarily on the ratio of the fast and slow tonic drives, and the target firing needed to be high enough to ensure spikes would occur reliably within the maxima of the oscillations, we chose our target rates to be 100 Hz times the equivalent tonic drive.</p><p>The spiking version of the single-population model demonstrated left–right alternation and head-to-tail propagation (<xref ref-type="fig" rid="fig8">Figure 8A</xref>). As with the rate model, the frequency of firing rate oscillations in this model did not depend on the input drive but did depend on the membrane time constant (<xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1C</xref>). We found that coherent oscillatory behavior survived at <inline-formula><alternatives><mml:math id="inf44"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>80</mml:mn></mml:math><tex-math id="inft44">\begin{document}$n=80$\end{document}</tex-math></alternatives></inline-formula> even when the connectivity fraction <inline-formula><alternatives><mml:math id="inf45"><mml:mi>p</mml:mi></mml:math><tex-math id="inft45">\begin{document}$p$\end{document}</tex-math></alternatives></inline-formula> was reduced down to 0.05 (i.e. only 5% of connections are made), but that oscillations broke down for smaller values of <inline-formula><alternatives><mml:math id="inf46"><mml:mi>p</mml:mi></mml:math><tex-math id="inft46">\begin{document}$p$\end{document}</tex-math></alternatives></inline-formula> (<xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1A</xref>). At <inline-formula><alternatives><mml:math id="inf47"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:math><tex-math id="inft47">\begin{document}$n=10$\end{document}</tex-math></alternatives></inline-formula>, we found that the cutoff for stable oscillations was <inline-formula><alternatives><mml:math id="inf48"><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:math><tex-math id="inft48">\begin{document}$p=0.6$\end{document}</tex-math></alternatives></inline-formula> (<xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1B</xref>).</p><fig-group><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>A spiking network model confirms that network-based mechanisms for rhythmogenesis and frequency control are robust in stochastic settings.</title><p>(<bold>A</bold>) A raster plot from the single-population spiking model. The blue (red) dots show spikes from neurons on the left (right) side of the spinal cord. (<bold>B</bold>) A raster plot from the two-population spiking model, with spikes from the fast (slow) population shown in the left (right) panel. (<bold>C</bold>) Dependence of the frequency in the two-population spiking model on the driving rate. Given a fast drive equivalent, <inline-formula><alternatives><mml:math id="inf49"><mml:mi>f</mml:mi></mml:math><tex-math id="inft49">\begin{document}$f$\end{document}</tex-math></alternatives></inline-formula>, the EI-balanced Poisson inputs have rates chosen to produce <inline-formula><alternatives><mml:math id="inf50"><mml:mi>f</mml:mi><mml:mo>×</mml:mo><mml:mn>100</mml:mn><mml:mtext> Hz</mml:mtext></mml:math><tex-math id="inft50">\begin{document}$f\times 100\text{ Hz}$\end{document}</tex-math></alternatives></inline-formula> in an isolated fast neuron and <inline-formula><alternatives><mml:math id="inf51"><mml:mn>1</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>f</mml:mi><mml:mo>×</mml:mo><mml:mn>100</mml:mn><mml:mtext> Hz</mml:mtext></mml:math><tex-math id="inft51">\begin{document}$1/f\times 100\text{ Hz}$\end{document}</tex-math></alternatives></inline-formula> in an isolated slow neuron. (<bold>D</bold>) Dependence of the frequency in the eight-population spiking model on the strength of excitatory connections relative to the strength of inhibitory connections. The simulations shown here use 0 modularity for all populations. (<bold>E</bold>) Dependence of the firing rate oscillations in the eight-population spiking model on the modularity of the excitatory connections. The simulation uses an excitatory connection strength of 0.4 and 0 modularity for the inhibitory connections. All spiking model simulations shown here use <inline-formula><alternatives><mml:math id="inf52"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>80</mml:mn></mml:math><tex-math id="inft52">\begin{document}$n=80$\end{document}</tex-math></alternatives></inline-formula> leaky-integrate-and-fire (LIF) neurons for each unit of the corresponding rate model and connectivity fraction <inline-formula><alternatives><mml:math id="inf53"><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:math><tex-math id="inft53">\begin{document}$p=0.1$\end{document}</tex-math></alternatives></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-106658-fig8-v1.tif"/></fig><fig id="fig8s1" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 1.</label><caption><title>Dependence of spiking model behavior on <inline-formula><alternatives><mml:math id="inf54"><mml:mi>n</mml:mi></mml:math><tex-math id="inft54">\begin{document}$n$\end{document}</tex-math></alternatives></inline-formula>,<inline-formula><alternatives><mml:math id="inf55"><mml:mi>p</mml:mi></mml:math><tex-math id="inft55">\begin{document}$p$\end{document}</tex-math></alternatives></inline-formula>, and <inline-formula><alternatives><mml:math id="inf56"><mml:mi>τ</mml:mi></mml:math><tex-math id="inft56">\begin{document}$\tau$\end{document}</tex-math></alternatives></inline-formula>.</title><p>(<bold>A</bold>) Raster plots for the <inline-formula><alternatives><mml:math id="inf57"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>80</mml:mn></mml:math><tex-math id="inft57">\begin{document}$n=80$\end{document}</tex-math></alternatives></inline-formula> single-population spiking model at different values of <inline-formula><alternatives><mml:math id="inf58"><mml:mi>p</mml:mi></mml:math><tex-math id="inft58">\begin{document}$p$\end{document}</tex-math></alternatives></inline-formula>. The membrane time constant is <inline-formula><alternatives><mml:math id="inf59"><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mtext> ms</mml:mtext></mml:math><tex-math id="inft59">\begin{document}$\tau=10\text{ ms}$\end{document}</tex-math></alternatives></inline-formula> for these simulations. (<bold>B</bold>) Raster plots for the <inline-formula><alternatives><mml:math id="inf60"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:math><tex-math id="inft60">\begin{document}$n=10$\end{document}</tex-math></alternatives></inline-formula> single-population spiking model at different values of <inline-formula><alternatives><mml:math id="inf61"><mml:mi>p</mml:mi></mml:math><tex-math id="inft61">\begin{document}$p$\end{document}</tex-math></alternatives></inline-formula>. The membrane time constant is <inline-formula><alternatives><mml:math id="inf62"><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mtext> ms</mml:mtext></mml:math><tex-math id="inft62">\begin{document}$\tau=10\text{ ms}$\end{document}</tex-math></alternatives></inline-formula> for these simulations. (<bold>C</bold>) Dependence of the frequency of firing rate oscillations in the single-population model on the membrane time constant <inline-formula><alternatives><mml:math id="inf63"><mml:mi>τ</mml:mi></mml:math><tex-math id="inft63">\begin{document}$\tau$\end{document}</tex-math></alternatives></inline-formula>. The spiking model was simulated with <inline-formula><alternatives><mml:math id="inf64"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>80</mml:mn></mml:math><tex-math id="inft64">\begin{document}$n=80$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf65"><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:math><tex-math id="inft65">\begin{document}$p=0.1$\end{document}</tex-math></alternatives></inline-formula>. The rate model was simulated without synaptic time delays. (<bold>D</bold>) Dependence of the frequency of firing rate oscillations in the two-population model on <inline-formula><alternatives><mml:math id="inf66"><mml:mi>p</mml:mi></mml:math><tex-math id="inft66">\begin{document}$p$\end{document}</tex-math></alternatives></inline-formula> and the driving frequency. The simulations used <inline-formula><alternatives><mml:math id="inf67"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>80</mml:mn></mml:math><tex-math id="inft67">\begin{document}$n=80$\end{document}</tex-math></alternatives></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-106658-fig8-figsupp1-v1.tif"/></fig></fig-group><p>We next simulated the spiking model with fast and slow populations, the counterpart to our two-population rate model (<xref ref-type="fig" rid="fig8">Figure 8B, C</xref>). Choosing the membrane time constants to be the same as the rate model (i.e. 1 ms for the fast population and 10 ms for the slow population) led to issues with controllability. In particular, it led to a breakdown of coherent oscillations at intermediate driving. Referring to our results with the single-population model, we hypothesized that this was caused by the large discrepancy between the natural frequencies of the fast and slow populations. Choosing the membrane time constants to be 2 ms for the fast population and 10 ms for the slow population, we recovered frequency control. While the connectivity fraction <inline-formula><alternatives><mml:math id="inf68"><mml:mi>p</mml:mi></mml:math><tex-math id="inft68">\begin{document}$p$\end{document}</tex-math></alternatives></inline-formula> did not affect controllability in this model, it did change the maximum frequency of the network (<xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1D</xref>).</p><p>Extending our spiking model to the full eight populations of our final rate model (i.e. dividing the inhibitory population into 3 separate populations and including an excitatory population), we again observed stable oscillations with left–right alternation, head-to-tail propagation, and controllable frequency with constant phase lag. As with the rate model, we varied the strength and modularity of the excitatory connections (<xref ref-type="fig" rid="fig8">Figure 8D, E</xref>). As in the rate model, increasing excitatory connection strength increased the maximum frequency (<xref ref-type="fig" rid="fig8">Figure 8D</xref>). Rather than a loss of controllability at intermediate frequencies as in the rate model, however, the range of possible frequencies was instead reduced via an increase in the lowest frequency achieved by the network, suggesting that the fast population dominates the dynamics in the spiking network. Moreover, in contrast to the rate model, there was no change in maximum frequency upon increasing the modularity among excitatory units (<xref ref-type="fig" rid="fig8">Figure 8E</xref>), suggesting a possible saturation effect whereby the fast population already dominates the large-frequency dynamics of the network even at low degrees of modularity. Although this spiking network model responded somewhat differently than the rate models to certain parameter changes, the fact that rhythmogenesis and frequency control emerge from this model without fine-tuning supports the conclusion that network-level interactions driven by cell-type-specific connectivity patterns are sufficient for producing locomotor behavior in a more biophysically detailed model.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>In this study, we began by postulating that cell-type-specific connectivity alone could be sufficient for producing the main phenomenological features of the spinal locomotor circuit, without requiring dynamical single-cell properties. We found that coordinated locomotion could be achieved in an inhibition-dominated network in which connectivity is determined by desired phase relationships and variable-speed control is implemented by recruitment of frequency-selective populations. Further, while structured excitatory connections were not necessary for producing coordinated locomotion or frequency control, they were useful for increasing peak locomotor frequency, albeit at the cost of losing some control at intermediate frequencies. Together, this family of models shows that network-level interactions are sufficient to generate coordinated, variable-speed locomotion. It further provides new interpretations of intersegmental excitatory and inhibitory connectivity, as well as the basic, recruitment-based mechanism of speed control.</p><p>A main conclusion of our models is the importance of intersegmental, inhibition-dominated connections for achieving coordinated locomotion, where patterns of ipsilateral and contralateral inhibition are established by desired phase relationships. Similarly, a very recent network-level model based on the mouse locomotor circuit has proposed that these are key features for obtaining coordinated locomotion in that context as well (<xref ref-type="bibr" rid="bib28">Komi et al., 2024</xref>). In addition, a recent study found that patterning recurrent neural network on the locomotor circuitry of <italic>C. elegans</italic> produced a system that required fewer parameters and less training data than general multi-layer perceptron models for controlling a swimming agent (<xref ref-type="bibr" rid="bib4">Bhattasali et al., 2022</xref>). The congruence of these results—all of which rely on emergent dynamics driven by cell-type-specific connectivity patterns to generate rhythm, without requiring complex intracellular dynamics—suggests that network-level interactions are likely key drivers of locomotor dynamics across species and fit cross-species observations of spinal interneuron diversity. However, while these results suggest that intrinsic cellular mechanisms are not necessary to generate coordinated locomotor rhythms, they are certainly sufficient in certain circumstances, as demonstrated by previous lesion and pharmacological studies (<xref ref-type="bibr" rid="bib21">Grillner and Kozlov, 2021</xref>).</p><p>Another conclusion of our models is that both projection strength and modularity among fast and slow excitatory units increase the maximum possible frequency, but at the cost of losing some control at intermediate frequencies. Recent studies in zebrafish suggest the possibility that the spinal circuit may overcome this limitation by having multiple subtypes of excitatory interneurons with different degrees of modularity. Specifically, V2a neurons with descending-only axons exhibit a greater degree of speed-dependent recruitment (suggesting a higher level of modularity), while those with bifurcating axons exhibit less (<xref ref-type="bibr" rid="bib1">Agha et al., 2024</xref>). Moreover, V2a neurons with bifurcating axons fire more reliably, compared to more sparsely firing descending-only V2a neurons, and they form stronger connections to motor neurons (<xref ref-type="bibr" rid="bib33">Menelaou and McLean, 2019</xref>; <xref ref-type="bibr" rid="bib1">Agha et al., 2024</xref>), consistent with a hierarchical organization distinguishing interneuron rhythmogenesis from motor neuron recruitment. Including motor neurons and these distinct subtypes into a model and testing their effects will be an interesting direction for future work.</p><p>Given that the models that we have presented favor simplicity over realism, attempting to capture as much phenomenology as possible with a minimal number of tunable parameters, they are undoubtedly missing features that may be important for describing more-nuanced functional aspects of locomotion in aquatic vertebrates. For instance, we did not include in our model variations in intersegmental projection distances for dI6 and V0d neurons related to speed (<xref ref-type="bibr" rid="bib45">Satou et al., 2020</xref>), nor did we include excitatory commissural interneuron classes, including V0v (<xref ref-type="bibr" rid="bib24">Kawano et al., 2022</xref>) and V3 interneurons (<xref ref-type="bibr" rid="bib5">Böhm et al., 2022</xref>). Moreover, other recent models of the locomotor circuit in zebrafish have highlighted the importance of electrical synapses for rapidly initiating swim bouts and characterizing early stages of development (<xref ref-type="bibr" rid="bib41">Roussel et al., 2020</xref>; <xref ref-type="bibr" rid="bib42">Roussel et al., 2021</xref>; <xref ref-type="bibr" rid="bib25">Kim and Riecke, 2023</xref>). Including these components would be a worthwhile extension of the models presented here. Finally, investigating the ways in which the circuit-level rhythm genesis of our model might work together with and complement mechanisms based on intracellular dynamics, as assumed in classical models, will be an important direction for future work.</p><p>A somewhat unique aspect of our approach has been to develop a <italic>hierarchy of models</italic> to describe the same neural circuit at varying levels of detail. (See also the related approach in <xref ref-type="bibr" rid="bib42">Roussel et al., 2021</xref>, which developed a series of models describing the same circuit at different stages in development.) Having such a family of models that fit within the same modeling framework enabled us to (1) use the higher-level models to better motivate the choices made in our lower-level models and (2) draw connections between models at different levels to gain additional insight into the functional roles of particular populations. Following this approach, we thus obtained greater insight into the neural mechanisms underlying behavior than would be possible from any one model individually. We expect that this general approach could be useful more broadly for characterizing neural circuits and their relation to behavior.</p></sec><sec id="s4" sec-type="methods"><title>Methods</title><sec id="s4-1"><title>Simulation details</title><p>The multi-segment model has 30 segments and 2 sides (left and right), for a total of 60 hemi-segments. Each hemi-segment contains one unit corresponding to each neuron type. In the one-population model, there is only one inhibitory neuron type; in the two-population model, there are both fast and slow types of inhibitory neurons; in the eight-population model, there is a fast and slow type of each of excitatory, ascending ipsilateral inhibitory, descending ipsilateral inhibitory, and contralateral inhibitory neuron type.</p><p>The state of each unit is described by its firing rate as a function of time. The time course is calculated by <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>, where <inline-formula><alternatives><mml:math id="inf69"><mml:msub><mml:mi>h</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft69">\begin{document}$h_{i}$\end{document}</tex-math></alternatives></inline-formula> is the activity of unit <inline-formula><alternatives><mml:math id="inf70"><mml:mi>i</mml:mi></mml:math><tex-math id="inft70">\begin{document}$i$\end{document}</tex-math></alternatives></inline-formula>, and <inline-formula><alternatives><mml:math id="inf71"><mml:mo stretchy="false">[</mml:mo><mml:mo>⋅</mml:mo><mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>ReLU</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="inft71">\begin{document}$[\cdot]_{+}=\text{ReLU}()$\end{document}</tex-math></alternatives></inline-formula> is the rectified-linear function. The membrane time constants are set to 1 ms (10 ms) for the fast (slow) module, or 1 ms in models with no speed modules.</p><p>The numerical simulation was performed using Euler’s method with timestep equal to 0.1 ms. For all simulations considered in this work, the simulation was run for 600 ms (or 6000 timesteps). The firing rate of each unit is set to a small random rate sampled uniformly from [0, 0.01] at <inline-formula><alternatives><mml:math id="inf72"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><tex-math id="inft72">\begin{document}$t=0$\end{document}</tex-math></alternatives></inline-formula> in order to break symmetry.</p><p>For the one-population model, there were no synaptic time delays included. In the two- and eight-population models, synaptic time delays are equal to:<disp-formula id="equ4"><label>(4)</label><alternatives><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>τ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>∗</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math><tex-math id="t4">\begin{document}$$\displaystyle \newcommand {\ba}{\be } \newcommand {\ea}{ \ee} \tau_{delay} * (1+ \Delta_S)$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <inline-formula><alternatives><mml:math id="inf73"><mml:msub><mml:mi>τ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft73">\begin{document}$\tau_{delay}$\end{document}</tex-math></alternatives></inline-formula> is the base delay amount, and <inline-formula><alternatives><mml:math id="inf74"><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft74">\begin{document}$\Delta_{S}$\end{document}</tex-math></alternatives></inline-formula> is the distance (measured in number of segments) between the pair of units which the connection is between (<inline-formula><alternatives><mml:math id="inf75"><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft75">\begin{document}$\Delta_{S}$\end{document}</tex-math></alternatives></inline-formula> = 0 when the units are in the same segment). For the two- and eight-population models, <inline-formula><alternatives><mml:math id="inf76"><mml:msub><mml:mi>τ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft76">\begin{document}$\tau_{delay}$\end{document}</tex-math></alternatives></inline-formula> is set to 0.2 ms for the fast population and 0.5 ms for the slow population, matching roughly the experimentally measured axonal conduction velocities detailed in <xref ref-type="bibr" rid="bib33">Menelaou and McLean, 2019</xref>. Note that the synaptic time delays are determined by the identity of the source unit, not the target unit.</p><p>Units in the model are driven by a constant tonic input. This drive is varied separately for the fast and slow populations. In addition, each unit receives recurrent input from the other units according to the interneuron connectivity <inline-formula><alternatives><mml:math id="inf77"><mml:msub><mml:mi>W</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft77">\begin{document}$W_{ij}$\end{document}</tex-math></alternatives></inline-formula>, which represents the strength of the connection from unit <inline-formula><alternatives><mml:math id="inf78"><mml:mi>j</mml:mi></mml:math><tex-math id="inft78">\begin{document}$j$\end{document}</tex-math></alternatives></inline-formula> to <inline-formula><alternatives><mml:math id="inf79"><mml:mi>i</mml:mi></mml:math><tex-math id="inft79">\begin{document}$i$\end{document}</tex-math></alternatives></inline-formula>. The connectivity matrices, <inline-formula><alternatives><mml:math id="inf80"><mml:msub><mml:mi>W</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft80">\begin{document}$W_{ij}$\end{document}</tex-math></alternatives></inline-formula>, are shown in <xref ref-type="fig" rid="fig1">Figures 1B</xref>, <xref ref-type="fig" rid="fig2">2B</xref> and <xref ref-type="fig" rid="fig4">4B</xref>.</p><p>The base value of inhibitory projections is set to –0.5. The base strength for the excitatory connections is set to <inline-formula><alternatives><mml:math id="inf81"><mml:mn>0.5</mml:mn><mml:msub><mml:mi>f</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft81">\begin{document}$0.5f_{E}$\end{document}</tex-math></alternatives></inline-formula>, where the multiplicative factor <inline-formula><alternatives><mml:math id="inf82"><mml:msub><mml:mi>f</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft82">\begin{document}$f_{E}$\end{document}</tex-math></alternatives></inline-formula> takes a value between 0 and 1 and determines the strength of excitation relative to inhibition. Except when this parameter is explicitly varied (see <xref ref-type="fig" rid="fig6">Figure 6</xref>), we set <inline-formula><alternatives><mml:math id="inf83"><mml:msub><mml:mi>f</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.4</mml:mn></mml:math><tex-math id="inft83">\begin{document}$f_{E}=0.4$\end{document}</tex-math></alternatives></inline-formula>.</p><p>In the two- and eight-population models, we introduce the speed mixing factor, <inline-formula><alternatives><mml:math id="inf84"><mml:msub><mml:mi>f</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>s</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft84">\begin{document}$f_{sm}$\end{document}</tex-math></alternatives></inline-formula>. The connection strengths for all fast-to-fast and slow-to-slow connections were multiplied by <inline-formula><alternatives><mml:math id="inf85"><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>s</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="inft85">\begin{document}$(1-f_{sm})$\end{document}</tex-math></alternatives></inline-formula>, whereas all fast-to-slow and slow-to-fast connection strengths were multiplied by <inline-formula><alternatives><mml:math id="inf86"><mml:msub><mml:mi>f</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>s</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft86">\begin{document}$f_{sm}$\end{document}</tex-math></alternatives></inline-formula>. This generates a modularity of <inline-formula><alternatives><mml:math id="inf87"><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>f</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>s</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft87">\begin{document}$m=1-2f_{sm}$\end{document}</tex-math></alternatives></inline-formula>. In the case of the eight-population model, we can apply a global speed mixing factor <inline-formula><alternatives><mml:math id="inf88"><mml:msub><mml:mi>f</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>s</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft88">\begin{document}$f_{sm}$\end{document}</tex-math></alternatives></inline-formula> or a separate speed mixing factor for the excitatory population <inline-formula><alternatives><mml:math id="inf89"><mml:msub><mml:mi>f</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>s</mml:mi><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft89">\begin{document}$f_{sm,E}$\end{document}</tex-math></alternatives></inline-formula> and for the inhibitory population <inline-formula><alternatives><mml:math id="inf90"><mml:msub><mml:mi>f</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>s</mml:mi><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft90">\begin{document}$f_{sm,I}$\end{document}</tex-math></alternatives></inline-formula>. The results of varying these parameters are shown in <xref ref-type="fig" rid="fig6">Figure 6</xref>.</p><p>Ablation was introduced as an overall factor, <inline-formula><alternatives><mml:math id="inf91"><mml:msub><mml:mi>f</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft91">\begin{document}$f_{A}$\end{document}</tex-math></alternatives></inline-formula>, that multiplied the connection strengths of all connections sourced from the ablated population. This then implies that<disp-formula id="equ5"><label>(5)</label><alternatives><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">%</mml:mi><mml:mtext> ablation</mml:mtext><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mn>100</mml:mn><mml:mi mathvariant="normal">%</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mstyle></mml:math><tex-math id="t5">\begin{document}$$\displaystyle \newcommand {\ba}{\be } \newcommand {\ea}{ \ee} \% \text{ ablation} = (1 - f_{A}) \times 100 \% \, .$$\end{document}</tex-math></alternatives></disp-formula></p></sec><sec id="s4-2"><title>Analysis methods</title><p>The output of the simulation is a collection of time series giving the firing rate of each unit as a function of time. By inspection, it was clear that the time series settled into a sensible oscillation after an initialization period. To ensure the observations corresponded to the stable oscillatory mode, all analysis was performed on the time series from <italic>t</italic> = 100 ms to <italic>t</italic> = 600 ms (i.e. we cut out the first 100 ms).</p><p>For each unit’s firing rate time series, <inline-formula><alternatives><mml:math id="inf92"><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="inft92">\begin{document}$r(t)$\end{document}</tex-math></alternatives></inline-formula>, the amplitude is defined as the difference between the maximum and minimum values of the time series. That is<disp-formula id="equ6"><label>(6)</label><alternatives><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mtext>max</mml:mtext><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mtext>min</mml:mtext><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mstyle></mml:math><tex-math id="t6">\begin{document}$$\displaystyle \newcommand {\ba}{\be } \newcommand {\ea}{ \ee} A = \text{max}_{t} r(t) - \text{min}_{t} r(t) \, .$$\end{document}</tex-math></alternatives></disp-formula></p><p>The amplitude of the simulation is then defined as the mean amplitude across all units (or, if amplitude is reported for a particular population, across all units within that population). Errors are given by the standard deviation in amplitude across all units.</p><p>To extract the frequency of the time series <inline-formula><alternatives><mml:math id="inf93"><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="inft93">\begin{document}$r(t)$\end{document}</tex-math></alternatives></inline-formula>, we calculated the period of each time series. To find the period, we considered the autocorrelation spectrum defined by:<disp-formula id="equ7"><label>(7)</label><alternatives><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math><tex-math id="t7">\begin{document}$$\displaystyle \newcommand {\ba}{\be } \newcommand {\ea}{ \ee} C(k) = \sum_{t} r(t) r(t-k)$$\end{document}</tex-math></alternatives></disp-formula></p><p>Here, <inline-formula><alternatives><mml:math id="inf94"><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><tex-math id="inft94">\begin{document}$r(t)=0$\end{document}</tex-math></alternatives></inline-formula> whenever <inline-formula><alternatives><mml:math id="inf95"><mml:mi>t</mml:mi></mml:math><tex-math id="inft95">\begin{document}$t$\end{document}</tex-math></alternatives></inline-formula> is outside the domain <inline-formula><alternatives><mml:math id="inf96"><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>100</mml:mn><mml:mtext>ms</mml:mtext><mml:mo>,</mml:mo><mml:mn>600</mml:mn><mml:mtext>ms</mml:mtext><mml:mo stretchy="false">]</mml:mo></mml:math><tex-math id="inft96">\begin{document}$t\in[100\text{ms},600\text{ms}]$\end{document}</tex-math></alternatives></inline-formula>. In all cases, the maximum autocorrelation occurs at <inline-formula><alternatives><mml:math id="inf97"><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><tex-math id="inft97">\begin{document}$k=0$\end{document}</tex-math></alternatives></inline-formula>. In cases with a single dominant frequency as <inline-formula><alternatives><mml:math id="inf98"><mml:mi>k</mml:mi></mml:math><tex-math id="inft98">\begin{document}$k$\end{document}</tex-math></alternatives></inline-formula> increases away from zero, the autocorrelation drops to global minimum (which we define as <inline-formula><alternatives><mml:math id="inf99"><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:math><tex-math id="inft99">\begin{document}$k=k_{\text{min}}$\end{document}</tex-math></alternatives></inline-formula>) then rises to a local maximum at a value of <inline-formula><alternatives><mml:math id="inf100"><mml:mi>k</mml:mi></mml:math><tex-math id="inft100">\begin{document}$k$\end{document}</tex-math></alternatives></inline-formula> equal to the period (see <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>). This is then followed by a series of local minima and maxima of lesser size. Crucially, this local maximum can be isolated as the global maximum if we only consider <inline-formula><alternatives><mml:math id="inf101"><mml:mi>k</mml:mi><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:math><tex-math id="inft101">\begin{document}$k \gt k_{\text{min}}$\end{document}</tex-math></alternatives></inline-formula>. Hence, we define the period of <inline-formula><alternatives><mml:math id="inf102"><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="inft102">\begin{document}$r(t)$\end{document}</tex-math></alternatives></inline-formula> by<disp-formula id="equ8"><label>(8)</label><alternatives><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mtext>argmax</mml:mtext><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>k</mml:mi><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:math><tex-math id="t8">\begin{document}$$\displaystyle \newcommand {\ba}{\be } \newcommand {\ea}{ \ee} T = \text{argmax}_{k \gt k_{\text{min}}} C(k) ,$$\end{document}</tex-math></alternatives></disp-formula></p><p>and we define the frequency of <inline-formula><alternatives><mml:math id="inf103"><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="inft103">\begin{document}$r(t)$\end{document}</tex-math></alternatives></inline-formula> by <inline-formula><alternatives><mml:math id="inf104"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:math><tex-math id="inft104">\begin{document}$f=1/T$\end{document}</tex-math></alternatives></inline-formula>. From there, frequencies of the different unit types were averaged within each hemi-segment, weighted by the amplitude. This amplitude-averaged frequency was then used to compute an unweighted mean frequency and standard deviation across all hemi-segments.</p><p>We calculate the phase <inline-formula><alternatives><mml:math id="inf105"><mml:mi>ϕ</mml:mi></mml:math><tex-math id="inft105">\begin{document}$\phi$\end{document}</tex-math></alternatives></inline-formula> of <inline-formula><alternatives><mml:math id="inf106"><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="inft106">\begin{document}$r(t)$\end{document}</tex-math></alternatives></inline-formula> as<disp-formula id="equ9"><label>(9)</label><alternatives><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac><mml:mtext>arg</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>r</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:math><tex-math id="t9">\begin{document}$$\displaystyle \newcommand {\ba}{\be } \newcommand {\ea}{ \ee} \phi = \frac{1}{2\pi} \text{arg}\left(\tilde{r}(\nu)\right)$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <inline-formula><alternatives><mml:math id="inf107"><mml:mtext>arg</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="inft107">\begin{document}$\text{arg}(z)$\end{document}</tex-math></alternatives></inline-formula> gives the argument (or phase) of the complex number <inline-formula><alternatives><mml:math id="inf108"><mml:mi>z</mml:mi></mml:math><tex-math id="inft108">\begin{document}$z$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf109"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>r</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="inft109">\begin{document}$\tilde{r}(\nu)$\end{document}</tex-math></alternatives></inline-formula> is the Fourier coefficient of <inline-formula><alternatives><mml:math id="inf110"><mml:mi>r</mml:mi></mml:math><tex-math id="inft110">\begin{document}$r$\end{document}</tex-math></alternatives></inline-formula> at the measured frequency, <inline-formula><alternatives><mml:math id="inf111"><mml:mi>ν</mml:mi></mml:math><tex-math id="inft111">\begin{document}$\nu$\end{document}</tex-math></alternatives></inline-formula>. Notice that we have normalized our phases to be in the range <inline-formula><alternatives><mml:math id="inf112"><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:math><tex-math id="inft112">\begin{document}$(-1/2,1/2]$\end{document}</tex-math></alternatives></inline-formula> instead of <inline-formula><alternatives><mml:math id="inf113"><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:math><tex-math id="inft113">\begin{document}$(-\pi,\pi]$\end{document}</tex-math></alternatives></inline-formula>. The phase difference <inline-formula><alternatives><mml:math id="inf114"><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft114">\begin{document}$\Delta\phi_{ij}$\end{document}</tex-math></alternatives></inline-formula> between phases <inline-formula><alternatives><mml:math id="inf115"><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft115">\begin{document}$\phi_{i}$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf116"><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft116">\begin{document}$\phi_{j}$\end{document}</tex-math></alternatives></inline-formula> is calculated with<disp-formula id="equ10"><label>(10)</label><alternatives><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac><mml:mtext>arg</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>i</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mstyle></mml:math><tex-math id="t10">\begin{document}$$\displaystyle \newcommand {\ba}{\be } \newcommand {\ea}{ \ee} \Delta \phi_{ij} = \frac{1}{2\pi} \text{arg}\left(e^{2\pi i(\phi_i-\phi_j)}\right)\, ,$$\end{document}</tex-math></alternatives></disp-formula></p><p>to avoid erroneously large phase differences for phases near <inline-formula><alternatives><mml:math id="inf117"><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:math><tex-math id="inft117">\begin{document}$-\frac{1}{2}$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf118"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:math><tex-math id="inft118">\begin{document}$\frac{1}{2}$\end{document}</tex-math></alternatives></inline-formula>. Each phase difference at each location is averaged via a standard amplitude-weighted mean. A circular mean and circular standard deviation are used to then average the amplitude-averaged phase differences across all hemi-segments.</p></sec><sec id="s4-3"><title>Failures of coherent oscillation</title><p>Two issues arise that can prevent the extraction of a single well-defined frequency from a completed simulation: (1) There are multiple dominant frequencies in the time series for some units, or (2) the frequencies do not agree between the fast and slow populations.</p><p>In the case of having multiple dominant frequencies, the autocorrelation spectrum no longer follows the easily interpretable shape described above. Rather, the time series and autocorrelation appear like the example in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2E, F</xref>. A key observation is that the global minimum coincides with the first local minimum only in cases with a single dominant frequency. Therefore, to systematically find those time series with multiple dominant frequencies, we compare the frequency found using the <italic>global</italic> minimum as <inline-formula><alternatives><mml:math id="inf119"><mml:msub><mml:mi>k</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:math><tex-math id="inft119">\begin{document}$k_{\text{min}}$\end{document}</tex-math></alternatives></inline-formula> with the frequency found using the first <italic>local</italic> minimum as <inline-formula><alternatives><mml:math id="inf120"><mml:msub><mml:mi>k</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:math><tex-math id="inft120">\begin{document}$k_{\text{min}}$\end{document}</tex-math></alternatives></inline-formula>.</p><p>In some cases (especially at high modularity), a well-defined frequency occurs within the fast population that differs significantly from a well-defined frequency within the slow population. This also demonstrates a failure for the system to oscillate coherently.</p><p>To systematically determine whether a simulation resulted in a well-defined frequency, we compare four frequency values:</p><list list-type="order" id="list1"><list-item><p>The mean over the fast population of frequencies found using the global minimum.</p></list-item><list-item><p>The mean over the slow population of frequencies found using the global minimum.</p></list-item><list-item><p>The mean over the fast population of frequencies found using the first local minimum.</p></list-item><list-item><p>The mean over the slow population of frequencies found using the first local minimum.</p></list-item></list><p>Only if all values agree (to within a small tolerance) do we consider the frequency well-defined for the whole population.</p></sec><sec id="s4-4"><title>Spiking model implementation</title><p>The spiking models were implemented using the Brian 2 software package (<xref ref-type="bibr" rid="bib52">Stimberg et al., 2019</xref>).</p><p>Each spiking model is derived from the corresponding rate model by replacing each unit of the rate model with <inline-formula><alternatives><mml:math id="inf121"><mml:mi>n</mml:mi></mml:math><tex-math id="inft121">\begin{document}$n$\end{document}</tex-math></alternatives></inline-formula> current-based, LIF neurons. The spiking threshold was set to <inline-formula><alternatives><mml:math id="inf122"><mml:msub><mml:mi>V</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>50</mml:mn><mml:mtext> mV</mml:mtext></mml:math><tex-math id="inft122">\begin{document}$V_{t}=50\text{ mV}$\end{document}</tex-math></alternatives></inline-formula> and the reset potential was set to <inline-formula><alternatives><mml:math id="inf123"><mml:msub><mml:mi>V</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mtext> mV</mml:mtext></mml:math><tex-math id="inft123">\begin{document}$V_{r}=0\text{ mV}$\end{document}</tex-math></alternatives></inline-formula>. No refractory period was set for the LIF neurons.</p><p>For a connection in the rate model from unit <inline-formula><alternatives><mml:math id="inf124"><mml:mi>i</mml:mi></mml:math><tex-math id="inft124">\begin{document}$i$\end{document}</tex-math></alternatives></inline-formula> to unit <inline-formula><alternatives><mml:math id="inf125"><mml:mi>j</mml:mi></mml:math><tex-math id="inft125">\begin{document}$j$\end{document}</tex-math></alternatives></inline-formula> with non-vanishing weight <inline-formula><alternatives><mml:math id="inf126"><mml:msub><mml:mi>W</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft126">\begin{document}$W_{ij}$\end{document}</tex-math></alternatives></inline-formula>, a fraction <inline-formula><alternatives><mml:math id="inf127"><mml:mi>p</mml:mi></mml:math><tex-math id="inft127">\begin{document}$p$\end{document}</tex-math></alternatives></inline-formula> of all possible connections from neurons in unit <inline-formula><alternatives><mml:math id="inf128"><mml:mi>i</mml:mi></mml:math><tex-math id="inft128">\begin{document}$i$\end{document}</tex-math></alternatives></inline-formula> to neurons in unit <inline-formula><alternatives><mml:math id="inf129"><mml:mi>j</mml:mi></mml:math><tex-math id="inft129">\begin{document}$j$\end{document}</tex-math></alternatives></inline-formula> are added to the spiking model. The strengths of these connections are given by<disp-formula id="equ11"><alternatives><mml:math id="m11"><mml:mrow><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mtext>spiking</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mn>10</mml:mn><mml:mo>⁢</mml:mo><mml:mtext> ms</mml:mtext></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfrac><mml:mo>⁢</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>⋅</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math><tex-math id="t11">\begin{document}$$\displaystyle W_{\text{spiking}}=W_{ij}(V_{t}-V_{r})\frac{10\text{ ms}}{\tau_{j}}\frac{1}{n\cdot p}\,.$$\end{document}</tex-math></alternatives></disp-formula></p><p>Our models employed delta function synapses, so that the currents due to recurrent connections were sums of weighted delta functions.</p><p>In place of a tonic external drive, each neuron in the spiking model receives independent EI-balanced Poisson noise. These external spikes are given a weight of <inline-formula><alternatives><mml:math id="inf130"><mml:mi>d</mml:mi><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mo>±</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mn>10</mml:mn></mml:mfrac></mml:math><tex-math id="inft130">\begin{document}$dv=\pm\frac{V_{t}-V_{r}}{10}$\end{document}</tex-math></alternatives></inline-formula>. The rate of the Poisson noise was chosen to promote a target firing rate in an isolated LIF neuron. Given a target rate <inline-formula><alternatives><mml:math id="inf131"><mml:msub><mml:mi>ν</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft131">\begin{document}$\nu_{t}$\end{document}</tex-math></alternatives></inline-formula>, we find the corresponding Poisson rate <inline-formula><alternatives><mml:math id="inf132"><mml:msub><mml:mi>ν</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft132">\begin{document}$\nu_{p}$\end{document}</tex-math></alternatives></inline-formula> by numerically solving the following equation (adapted from Equation 8.54 in <xref ref-type="bibr" rid="bib16">Gerstner et al., 2014</xref>):<disp-formula id="equ12"><label>(11)</label><alternatives><mml:math id="m12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>ν</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:mi>τ</mml:mi><mml:msqrt><mml:mi>π</mml:mi></mml:msqrt><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>x</mml:mi></mml:mrow></mml:msubsup><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mtext>erf</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>u</mml:mi></mml:mstyle></mml:math><tex-math id="t12">\begin{document}$$\displaystyle \newcommand {\ba}{\be } \newcommand {\ea}{ \ee} \frac{1}{\nu_t} = \tau \sqrt{\pi} \int_0^{x} \text{exp}\left(u^2\right)\left(1+\text{erf}(u)\right) du$$\end{document}</tex-math></alternatives></disp-formula></p><p>with<disp-formula id="equ13"><label>(12)</label><alternatives><mml:math id="m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mi>d</mml:mi><mml:mi>v</mml:mi><mml:msqrt><mml:mn>2</mml:mn><mml:mi>τ</mml:mi><mml:msub><mml:mi>ν</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:msqrt></mml:mrow></mml:mfrac><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mstyle></mml:math><tex-math id="t13">\begin{document}$$\displaystyle \newcommand {\ba}{\be } \newcommand {\ea}{ \ee} x = \frac{V_t}{dv\sqrt{2\tau\nu_p}} \,.$$\end{document}</tex-math></alternatives></disp-formula></p><p>Here, erf is the error function. Target rates were chosen to be 100 Hz times the corresponding dimensionless tonic drive value.</p><p>All simulations were run with a 1-ns timestep for 600 ms total, and the spikes of every neuron were recorded.</p></sec><sec id="s4-5"><title>Detecting frequency in spiking network simulations</title><p>To extract the frequency of firing rate oscillations in the spiking models, we calculated the firing rate of each unit in 5-ms time bins by averaging the spike counts of all neurons in the unit. From these rates, an autocorrelation spectrum for each unit was calculated. When calculating the autocorrelation spectra, we discarded the initial 150 ms of the recording to avoid activity before the network settles into its stable oscillatory mode.</p><p>The rates and autocorrelation spectra for each unit are noisier than those measured in the rate model. This poses a possible challenge to our automatic frequency extraction pipeline by introducing or shifting the local minima and maxima of the autocorrelation spectra. To deal with this noise, we took an amplitude-weighted average of the autocorrelation spectrum to generate a global autocorrelation spectrum. To ensure that the shape of this spectrum is reasonable, frequencies are calculated from every peak and compared. The frequencies we report use the average of these frequency measurements. In addition, these frequencies were compared against the frequencies calculated from the fast and slow populations and using the local minimum method described above.</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Formal analysis, Writing – original draft</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Formal analysis</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Writing – original draft</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Formal analysis, Writing – original draft</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-106658-mdarchecklist1-v1.docx" mimetype="application" mime-subtype="docx"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>This is a computational study, so no data have been generated for this manuscript. Modeling code to accompany this work is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/fwandler/ZFswim">https://github.com/fwandler/ZFswim</ext-link> (copy archived at <xref ref-type="bibr" rid="bib53">Wandler, 2025</xref>).</p></sec><ack id="ack"><title>Acknowledgements</title><p>We are grateful for discussions with Martha Bagnall. This work was supported by the National Institutes of Health BRAIN Initiative (U01-NS136458).</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Agha</surname><given-names>MA</given-names></name><name><surname>Kishore</surname><given-names>S</given-names></name><name><surname>McLean</surname><given-names>DL</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Cell-type-specific origins of locomotor rhythmicity at different speeds in larval zebrafish</article-title><source>eLife</source><volume>13</volume><elocation-id>e94349</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.94349.2</pub-id><pub-id pub-id-type="pmid">39287613</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alaynick</surname><given-names>WA</given-names></name><name><surname>Jessell</surname><given-names>TM</given-names></name><name><surname>Pfaff</surname><given-names>SL</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>SnapShot: spinal cord development</article-title><source>Cell</source><volume>146</volume><elocation-id>178</elocation-id><pub-id pub-id-type="doi">10.1016/j.cell.2011.06.038</pub-id><pub-id pub-id-type="pmid">21729788</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ausborn</surname><given-names>J</given-names></name><name><surname>Shevtsova</surname><given-names>NA</given-names></name><name><surname>Danner</surname><given-names>SM</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Computational modeling of spinal locomotor circuitry in the age of molecular genetics</article-title><source>International Journal of Molecular Sciences</source><volume>22</volume><elocation-id>6835</elocation-id><pub-id pub-id-type="doi">10.3390/ijms22136835</pub-id><pub-id pub-id-type="pmid">34202085</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bhattasali</surname><given-names>N</given-names></name><name><surname>Zador</surname><given-names>AM</given-names></name><name><surname>Engel</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2022">2022</year><chapter-title>Neural circuit architectural priors for embodied control</chapter-title><person-group person-group-type="editor"><name><surname>Koyejo</surname><given-names>S</given-names></name><name><surname>Mohamed</surname><given-names>S</given-names></name><name><surname>Agarwal</surname><given-names>A</given-names></name><name><surname>Belgrave</surname><given-names>D</given-names></name><name><surname>Cho</surname><given-names>K</given-names></name><name><surname>Oh</surname><given-names>A</given-names></name></person-group><source>Advances in Neural Information Processing Systems</source><publisher-name>Curran Associates, Inc</publisher-name><fpage>12744</fpage><lpage>12759</lpage></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Böhm</surname><given-names>UL</given-names></name><name><surname>Kimura</surname><given-names>Y</given-names></name><name><surname>Kawashima</surname><given-names>T</given-names></name><name><surname>Ahrens</surname><given-names>MB</given-names></name><name><surname>Higashijima</surname><given-names>S-I</given-names></name><name><surname>Engert</surname><given-names>F</given-names></name><name><surname>Cohen</surname><given-names>AE</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Voltage imaging identifies spinal circuits that modulate locomotor adaptation in zebrafish</article-title><source>Neuron</source><volume>110</volume><fpage>1211</fpage><lpage>1222</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2022.01.001</pub-id><pub-id pub-id-type="pmid">35104451</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bonnot</surname><given-names>A</given-names></name><name><surname>Whelan</surname><given-names>PJ</given-names></name><name><surname>Mentis</surname><given-names>GZ</given-names></name><name><surname>O’Donovan</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Spatiotemporal pattern of motoneuron activation in the rostral lumbar and the sacral segments during locomotor-like activity in the neonatal mouse spinal cord</article-title><source>The Journal of Neuroscience</source><volume>22</volume><elocation-id>RC203</elocation-id><pub-id pub-id-type="doi">10.1523/JNEUROSCI.22-03-j0001.2002</pub-id><pub-id pub-id-type="pmid">11826149</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname><given-names>TG</given-names></name><name><surname>Sherrington</surname><given-names>CS</given-names></name></person-group><year iso-8601-date="1911">1911</year><article-title>The intrinsic factors in the act of progression in the mammal</article-title><source>Proceedings of the Royal Society of London. Series B, Containing Papers of a Biological Character</source><volume>84</volume><fpage>308</fpage><lpage>319</lpage><pub-id pub-id-type="doi">10.1098/rspb.1911.0077</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buchanan</surname><given-names>JT</given-names></name><name><surname>McPherson</surname><given-names>DR</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>The neuronal network for locomotion in the lamprey spinal cord: evidence for the involvement of commissural interneurons</article-title><source>Journal of Physiology, Paris</source><volume>89</volume><fpage>221</fpage><lpage>233</lpage><pub-id pub-id-type="doi">10.1016/0928-4257(96)83638-2</pub-id><pub-id pub-id-type="pmid">8861820</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Callahan</surname><given-names>RA</given-names></name><name><surname>Roberts</surname><given-names>R</given-names></name><name><surname>Sengupta</surname><given-names>M</given-names></name><name><surname>Kimura</surname><given-names>Y</given-names></name><name><surname>Higashijima</surname><given-names>S-I</given-names></name><name><surname>Bagnall</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Spinal V2b neurons reveal a role for ipsilateral inhibition in speed control</article-title><source>eLife</source><volume>8</volume><elocation-id>e47837</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.47837</pub-id><pub-id pub-id-type="pmid">31355747</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cazalets</surname><given-names>J-R</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Metachronal propagation of motoneurone burst activation in isolated spinal cord of newborn rat</article-title><source>The Journal of Physiology</source><volume>568</volume><fpage>583</fpage><lpage>597</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.2005.086850</pub-id><pub-id pub-id-type="pmid">16081478</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cohen</surname><given-names>AH</given-names></name><name><surname>Ermentrout</surname><given-names>GB</given-names></name><name><surname>Kiemel</surname><given-names>T</given-names></name><name><surname>Kopell</surname><given-names>N</given-names></name><name><surname>Sigvardt</surname><given-names>KA</given-names></name><name><surname>Williams</surname><given-names>TL</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Modelling of intersegmental coordination in the lamprey central pattern generator for locomotion</article-title><source>Trends in Neurosciences</source><volume>15</volume><fpage>434</fpage><lpage>438</lpage><pub-id pub-id-type="doi">10.1016/0166-2236(92)90006-t</pub-id><pub-id pub-id-type="pmid">1281350</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cuellar</surname><given-names>CA</given-names></name><name><surname>Tapia</surname><given-names>JA</given-names></name><name><surname>Juárez</surname><given-names>V</given-names></name><name><surname>Quevedo</surname><given-names>J</given-names></name><name><surname>Linares</surname><given-names>P</given-names></name><name><surname>Martínez</surname><given-names>L</given-names></name><name><surname>Manjarrez</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Propagation of sinusoidal electrical waves along the spinal cord during a fictive motor task</article-title><source>The Journal of Neuroscience</source><volume>29</volume><fpage>798</fpage><lpage>810</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3408-08.2009</pub-id><pub-id pub-id-type="pmid">19158305</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Curto</surname><given-names>C</given-names></name><name><surname>Morrison</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Graph rules for recurrent neural network dynamics</article-title><source>Notices of the American Mathematical Society</source><volume>70</volume><elocation-id>1</elocation-id><pub-id pub-id-type="doi">10.1090/noti2661</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dale</surname><given-names>N</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Experimentally derived model for the locomotor pattern generator in the Xenopus embryo</article-title><source>The Journal of Physiology</source><volume>489 ( Pt 2)</volume><fpage>489</fpage><lpage>510</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.1995.sp021067</pub-id><pub-id pub-id-type="pmid">8847642</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eklöf-Ljunggren</surname><given-names>E</given-names></name><name><surname>Haupt</surname><given-names>S</given-names></name><name><surname>Ausborn</surname><given-names>J</given-names></name><name><surname>Dehnisch</surname><given-names>I</given-names></name><name><surname>Uhlén</surname><given-names>P</given-names></name><name><surname>Higashijima</surname><given-names>S</given-names></name><name><surname>El Manira</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Origin of excitation underlying locomotion in the spinal circuit of zebrafish</article-title><source>PNAS</source><volume>109</volume><fpage>5511</fpage><lpage>5516</lpage><pub-id pub-id-type="doi">10.1073/pnas.1115377109</pub-id><pub-id pub-id-type="pmid">22431619</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gerstner</surname><given-names>W</given-names></name><name><surname>Kistler</surname><given-names>WM</given-names></name><name><surname>Naud</surname><given-names>R</given-names></name><name><surname>Paninski</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2014">2014</year><source>Neuronal Dynamics: From Single Neurons to Networks and Models of Cognition</source><publisher-name>Cambridge University Press</publisher-name><pub-id pub-id-type="doi">10.1017/CBO9781107447615</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goulding</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Circuits controlling vertebrate locomotion: moving in a new direction</article-title><source>Nature Reviews. Neuroscience</source><volume>10</volume><fpage>507</fpage><lpage>518</lpage><pub-id pub-id-type="doi">10.1038/nrn2608</pub-id><pub-id pub-id-type="pmid">19543221</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grillner</surname><given-names>S</given-names></name><name><surname>Wallén</surname><given-names>P</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>Central pattern generators for locomotion, with special reference to vertebrates</article-title><source>Annual Review of Neuroscience</source><volume>8</volume><fpage>233</fpage><lpage>261</lpage><pub-id pub-id-type="doi">10.1146/annurev.ne.08.030185.001313</pub-id><pub-id pub-id-type="pmid">2984978</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Grillner</surname><given-names>S</given-names></name><name><surname>Kozlov</surname><given-names>A</given-names></name><name><surname>Dario</surname><given-names>P</given-names></name><name><surname>Stefanini</surname><given-names>C</given-names></name><name><surname>Menciassi</surname><given-names>A</given-names></name><name><surname>Lansner</surname><given-names>A</given-names></name><name><surname>Hellgren Kotaleski</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2007">2007</year><chapter-title>Modeling a vertebrate motor system: pattern generation, steering and control of body orientation</chapter-title><person-group person-group-type="editor"><name><surname>Cisek</surname><given-names>P</given-names></name><name><surname>Drew</surname><given-names>T</given-names></name><name><surname>Kalaska</surname><given-names>JF</given-names></name></person-group><source>Computational Neuroscience: Theoretical Insights into Brain Function</source><publisher-name>Elsevier</publisher-name><fpage>221</fpage><lpage>234</lpage><pub-id pub-id-type="doi">10.1016/S0079-6123(06)65014-0</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grillner</surname><given-names>S</given-names></name><name><surname>El Manira</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The intrinsic operation of the networks that make us locomote</article-title><source>Current Opinion in Neurobiology</source><volume>31</volume><fpage>244</fpage><lpage>249</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2015.01.003</pub-id><pub-id pub-id-type="pmid">25599926</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grillner</surname><given-names>S</given-names></name><name><surname>Kozlov</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>The CPGs for limbed locomotion-facts and fiction</article-title><source>International Journal of Molecular Sciences</source><volume>22</volume><elocation-id>5882</elocation-id><pub-id pub-id-type="doi">10.3390/ijms22115882</pub-id><pub-id pub-id-type="pmid">34070932</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Higashijima</surname><given-names>S</given-names></name><name><surname>Masino</surname><given-names>MA</given-names></name><name><surname>Mandel</surname><given-names>G</given-names></name><name><surname>Fetcho</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Engrailed-1 expression marks a primitive class of inhibitory spinal interneuron</article-title><source>The Journal of Neuroscience</source><volume>24</volume><fpage>5827</fpage><lpage>5839</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.5342-03.2004</pub-id><pub-id pub-id-type="pmid">15215305</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ivanenko</surname><given-names>YP</given-names></name><name><surname>Poppele</surname><given-names>RE</given-names></name><name><surname>Lacquaniti</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Spinal cord maps of spatiotemporal alpha-motoneuron activation in humans walking at different speeds</article-title><source>Journal of Neurophysiology</source><volume>95</volume><fpage>602</fpage><lpage>618</lpage><pub-id pub-id-type="doi">10.1152/jn.00767.2005</pub-id><pub-id pub-id-type="pmid">16282202</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kawano</surname><given-names>K</given-names></name><name><surname>Kato</surname><given-names>K</given-names></name><name><surname>Sugioka</surname><given-names>T</given-names></name><name><surname>Kimura</surname><given-names>Y</given-names></name><name><surname>Tanimoto</surname><given-names>M</given-names></name><name><surname>Higashijima</surname><given-names>S-I</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Long descending commissural V0v neurons ensure coordinated swimming movements along the body axis in larval zebrafish</article-title><source>Scientific Reports</source><volume>12</volume><elocation-id>4348</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-022-08283-0</pub-id><pub-id pub-id-type="pmid">35288598</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>LU</given-names></name><name><surname>Riecke</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Intersegmental coordination of the central pattern generator via interleaved electrical and chemical synapses in zebrafish spinal cord</article-title><source>Journal of Computational Neuroscience</source><volume>51</volume><fpage>129</fpage><lpage>147</lpage><pub-id pub-id-type="doi">10.1007/s10827-022-00837-5</pub-id><pub-id pub-id-type="pmid">36229719</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kimura</surname><given-names>Y</given-names></name><name><surname>Higashijima</surname><given-names>S-I</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Regulation of locomotor speed and selection of active sets of neurons by V1 neurons</article-title><source>Nature Communications</source><volume>10</volume><elocation-id>2268</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-019-09871-x</pub-id><pub-id pub-id-type="pmid">31118414</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kishore</surname><given-names>S</given-names></name><name><surname>Cadoff</surname><given-names>EB</given-names></name><name><surname>Agha</surname><given-names>MA</given-names></name><name><surname>McLean</surname><given-names>DL</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Orderly compartmental mapping of premotor inhibition in the developing zebrafish spinal cord</article-title><source>Science</source><volume>370</volume><fpage>431</fpage><lpage>436</lpage><pub-id pub-id-type="doi">10.1126/science.abb4608</pub-id><pub-id pub-id-type="pmid">33093104</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Komi</surname><given-names>S</given-names></name><name><surname>Winther</surname><given-names>A</given-names></name><name><surname>Houser</surname><given-names>GA</given-names></name><name><surname>Topilko</surname><given-names>T</given-names></name><name><surname>Sørensen</surname><given-names>RJF</given-names></name><name><surname>Larsen</surname><given-names>SD</given-names></name><name><surname>Adamsson Bonfils</surname><given-names>MC</given-names></name><name><surname>Li</surname><given-names>G</given-names></name><name><surname>Berg</surname><given-names>RW</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Spatial and Network Principles behind Neural Generation of Locomotion</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2024.10.03.616472</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lindén</surname><given-names>H</given-names></name><name><surname>Petersen</surname><given-names>PC</given-names></name><name><surname>Vestergaard</surname><given-names>M</given-names></name><name><surname>Berg</surname><given-names>RW</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Movement is governed by rotational neural dynamics in spinal motor networks</article-title><source>Nature</source><volume>610</volume><fpage>526</fpage><lpage>531</lpage><pub-id pub-id-type="doi">10.1038/s41586-022-05293-w</pub-id><pub-id pub-id-type="pmid">36224394</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McLean</surname><given-names>DL</given-names></name><name><surname>Masino</surname><given-names>MA</given-names></name><name><surname>Koh</surname><given-names>IYY</given-names></name><name><surname>Lindquist</surname><given-names>WB</given-names></name><name><surname>Fetcho</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Continuous shifts in the active set of spinal interneurons during changes in locomotor speed</article-title><source>Nature Neuroscience</source><volume>11</volume><fpage>1419</fpage><lpage>1429</lpage><pub-id pub-id-type="doi">10.1038/nn.2225</pub-id><pub-id pub-id-type="pmid">18997790</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McLean</surname><given-names>DL</given-names></name><name><surname>Fetcho</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Movement, technology and discovery in the zebrafish</article-title><source>Current Opinion in Neurobiology</source><volume>21</volume><fpage>110</fpage><lpage>115</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2010.09.011</pub-id><pub-id pub-id-type="pmid">20970321</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Menelaou</surname><given-names>E</given-names></name><name><surname>VanDunk</surname><given-names>C</given-names></name><name><surname>McLean</surname><given-names>DL</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Differences in the morphology of spinal V2a neurons reflect their recruitment order during swimming in larval zebrafish</article-title><source>The Journal of Comparative Neurology</source><volume>522</volume><fpage>1232</fpage><lpage>1248</lpage><pub-id pub-id-type="doi">10.1002/cne.23465</pub-id><pub-id pub-id-type="pmid">24114934</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Menelaou</surname><given-names>E</given-names></name><name><surname>McLean</surname><given-names>DL</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Hierarchical control of locomotion by distinct types of spinal V2a interneurons in zebrafish</article-title><source>Nature Communications</source><volume>10</volume><elocation-id>4197</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-019-12240-3</pub-id><pub-id pub-id-type="pmid">31519892</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Menelaou</surname><given-names>E</given-names></name><name><surname>Kishore</surname><given-names>S</given-names></name><name><surname>McLean</surname><given-names>DL</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Mixed synapses reconcile violations of the size principle in zebrafish spinal cord</article-title><source>eLife</source><volume>11</volume><elocation-id>e64063</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.64063</pub-id><pub-id pub-id-type="pmid">36166290</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moult</surname><given-names>PR</given-names></name><name><surname>Cottrell</surname><given-names>GA</given-names></name><name><surname>Li</surname><given-names>WC</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Fast silencing reveals a lost role for reciprocal inhibition in locomotion</article-title><source>Neuron</source><volume>77</volume><fpage>129</fpage><lpage>140</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2012.10.040</pub-id><pub-id pub-id-type="pmid">23312521</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murray</surname><given-names>JM</given-names></name><name><surname>Escola</surname><given-names>GS</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Learning multiple variable-speed sequences in striatum via cortical tutoring</article-title><source>eLife</source><volume>6</volume><elocation-id>e26084</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.26084</pub-id><pub-id pub-id-type="pmid">28481200</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Picton</surname><given-names>LD</given-names></name><name><surname>Björnfors</surname><given-names>ER</given-names></name><name><surname>Fontanel</surname><given-names>P</given-names></name><name><surname>Pallucchi</surname><given-names>I</given-names></name><name><surname>Bertuzzi</surname><given-names>M</given-names></name><name><surname>El Manira</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Developmental switch in the function of inhibitory commissural V0d interneurons in zebrafish</article-title><source>Current Biology</source><volume>32</volume><fpage>3515</fpage><lpage>3528</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2022.06.059</pub-id><pub-id pub-id-type="pmid">35853456</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pujala</surname><given-names>A</given-names></name><name><surname>Koyama</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Chronology-based architecture of descending circuits that underlie the development of locomotor repertoire after birth</article-title><source>eLife</source><volume>8</volume><elocation-id>e42135</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.42135</pub-id><pub-id pub-id-type="pmid">30801247</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rancic</surname><given-names>V</given-names></name><name><surname>Ballanyi</surname><given-names>K</given-names></name><name><surname>Gosgnach</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Mapping the dynamic recruitment of spinal neurons during fictive locomotion</article-title><source>The Journal of Neuroscience</source><volume>40</volume><fpage>9692</fpage><lpage>9700</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1885-20.2020</pub-id><pub-id pub-id-type="pmid">33188068</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rancic</surname><given-names>V</given-names></name><name><surname>Gosgnach</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Recent insights into the rhythmogenic core of the locomotor CPG</article-title><source>International Journal of Molecular Sciences</source><volume>22</volume><elocation-id>1394</elocation-id><pub-id pub-id-type="doi">10.3390/ijms22031394</pub-id><pub-id pub-id-type="pmid">33573259</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roussel</surname><given-names>Y</given-names></name><name><surname>Paradis</surname><given-names>M</given-names></name><name><surname>Gaudreau</surname><given-names>SF</given-names></name><name><surname>Lindsey</surname><given-names>BW</given-names></name><name><surname>Bui</surname><given-names>TV</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Spatiotemporal transition in the role of synaptic inhibition to the tail beat rhythm of developing larval zebrafish</article-title><source>eNeuro</source><volume>7</volume><elocation-id>ENEURO.0508-18.2020</elocation-id><pub-id pub-id-type="doi">10.1523/ENEURO.0508-18.2020</pub-id><pub-id pub-id-type="pmid">32005749</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roussel</surname><given-names>Y</given-names></name><name><surname>Gaudreau</surname><given-names>SF</given-names></name><name><surname>Kacer</surname><given-names>ER</given-names></name><name><surname>Sengupta</surname><given-names>M</given-names></name><name><surname>Bui</surname><given-names>TV</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Modeling spinal locomotor circuits for movements in developing zebrafish</article-title><source>eLife</source><volume>10</volume><elocation-id>e67453</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.67453</pub-id><pub-id pub-id-type="pmid">34473059</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saltiel</surname><given-names>P</given-names></name><name><surname>d’Avella</surname><given-names>A</given-names></name><name><surname>Wyler-Duda</surname><given-names>K</given-names></name><name><surname>Bizzi</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Synergy temporal sequences and topography in the spinal cord: evidence for a traveling wave in frog locomotion</article-title><source>Brain Structure &amp; Function</source><volume>221</volume><fpage>3869</fpage><lpage>3890</lpage><pub-id pub-id-type="doi">10.1007/s00429-015-1133-5</pub-id><pub-id pub-id-type="pmid">26501407</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Samsonovich</surname><given-names>A</given-names></name><name><surname>McNaughton</surname><given-names>BL</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Path integration and cognitive mapping in a continuous attractor neural network model</article-title><source>The Journal of Neuroscience</source><volume>17</volume><fpage>5900</fpage><lpage>5920</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.17-15-05900.1997</pub-id><pub-id pub-id-type="pmid">9221787</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Satou</surname><given-names>C</given-names></name><name><surname>Sugioka</surname><given-names>T</given-names></name><name><surname>Uemura</surname><given-names>Y</given-names></name><name><surname>Shimazaki</surname><given-names>T</given-names></name><name><surname>Zmarz</surname><given-names>P</given-names></name><name><surname>Kimura</surname><given-names>Y</given-names></name><name><surname>Higashijima</surname><given-names>S-I</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Functional diversity of glycinergic commissural inhibitory neurons in larval zebrafish</article-title><source>Cell Reports</source><volume>30</volume><fpage>3036</fpage><lpage>3050</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2020.02.015</pub-id><pub-id pub-id-type="pmid">32130905</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sengupta</surname><given-names>M</given-names></name><name><surname>Daliparthi</surname><given-names>V</given-names></name><name><surname>Roussel</surname><given-names>Y</given-names></name><name><surname>Bui</surname><given-names>TV</given-names></name><name><surname>Bagnall</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Spinal V1 neurons inhibit motor targets locally and sensory targets distally</article-title><source>Current Biology</source><volume>31</volume><fpage>3820</fpage><lpage>3833</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2021.06.053</pub-id><pub-id pub-id-type="pmid">34289387</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sengupta</surname><given-names>M</given-names></name><name><surname>Bagnall</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Spinal interneurons: diversity and connectivity in motor control</article-title><source>Annual Review of Neuroscience</source><volume>46</volume><fpage>79</fpage><lpage>99</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-083122-025325</pub-id><pub-id pub-id-type="pmid">36854318</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sengupta</surname><given-names>M</given-names></name><name><surname>Bertram</surname><given-names>A</given-names></name><name><surname>Zhu</surname><given-names>SI</given-names></name><name><surname>Goodhill</surname><given-names>GJ</given-names></name><name><surname>Bagnall</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2025">2025</year><article-title>V2b neurons act via multiple targets to produce in phase inhibition during locomotion</article-title><source>The Journal of Neuroscience</source><volume>45</volume><elocation-id>e1530242025</elocation-id><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1530-24.2025</pub-id><pub-id pub-id-type="pmid">40506243</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sigvardt</surname><given-names>KA</given-names></name><name><surname>Miller</surname><given-names>WL</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Analysis and modeling of the locomotor central pattern generator as a network of coupled oscillators</article-title><source>Annals of the New York Academy of Sciences</source><volume>860</volume><fpage>250</fpage><lpage>265</lpage><pub-id pub-id-type="doi">10.1111/j.1749-6632.1998.tb09054.x</pub-id><pub-id pub-id-type="pmid">9928317</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skinner</surname><given-names>FK</given-names></name><name><surname>Mulloney</surname><given-names>B</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Intersegmental coordination in invertebrates and vertebrates</article-title><source>Current Opinion in Neurobiology</source><volume>8</volume><fpage>725</fpage><lpage>732</lpage><pub-id pub-id-type="doi">10.1016/s0959-4388(98)80114-1</pub-id><pub-id pub-id-type="pmid">9914235</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>J</given-names></name><name><surname>Pallucchi</surname><given-names>I</given-names></name><name><surname>Ausborn</surname><given-names>J</given-names></name><name><surname>Ampatzis</surname><given-names>K</given-names></name><name><surname>Bertuzzi</surname><given-names>M</given-names></name><name><surname>Fontanel</surname><given-names>P</given-names></name><name><surname>Picton</surname><given-names>LD</given-names></name><name><surname>El Manira</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Multiple rhythm-generating circuits act in tandem with pacemaker properties to control the start and speed of locomotion</article-title><source>Neuron</source><volume>105</volume><fpage>1048</fpage><lpage>1061</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2019.12.030</pub-id><pub-id pub-id-type="pmid">31982322</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stimberg</surname><given-names>M</given-names></name><name><surname>Brette</surname><given-names>R</given-names></name><name><surname>Goodman</surname><given-names>DF</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Brian 2, an intuitive and efficient neural simulator</article-title><source>eLife</source><volume>8</volume><elocation-id>e47314</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.47314</pub-id><pub-id pub-id-type="pmid">31429824</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Wandler</surname><given-names>FD</given-names></name></person-group><year iso-8601-date="2025">2025</year><data-title>ZFswim</data-title><version designator="swh:1:rev:8ba7a68f6774d09025d600e0b7c6a484ac0be9cd">swh:1:rev:8ba7a68f6774d09025d600e0b7c6a484ac0be9cd</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:73e4bbca0d6976514e934084fa8758ad0c30ad50;origin=https://github.com/fwandler/ZFswim;visit=swh:1:snp:7af60a822b3978f29e11607fb68d0b964577e8bb;anchor=swh:1:rev:8ba7a68f6774d09025d600e0b7c6a484ac0be9cd">https://archive.softwareheritage.org/swh:1:dir:73e4bbca0d6976514e934084fa8758ad0c30ad50;origin=https://github.com/fwandler/ZFswim;visit=swh:1:snp:7af60a822b3978f29e11607fb68d0b964577e8bb;anchor=swh:1:rev:8ba7a68f6774d09025d600e0b7c6a484ac0be9cd</ext-link></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yakovenko</surname><given-names>S</given-names></name><name><surname>Mushahwar</surname><given-names>V</given-names></name><name><surname>VanderHorst</surname><given-names>V</given-names></name><name><surname>Holstege</surname><given-names>G</given-names></name><name><surname>Prochazka</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Spatiotemporal activation of lumbosacral motoneurons in the locomotor step cycle</article-title><source>Journal of Neurophysiology</source><volume>87</volume><fpage>1542</fpage><lpage>1553</lpage><pub-id pub-id-type="doi">10.1152/jn.00479.2001</pub-id><pub-id pub-id-type="pmid">11877525</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>K</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Representation of spatial orientation by the intrinsic dynamics of the head-direction cell ensemble: a theory</article-title><source>The Journal of Neuroscience</source><volume>16</volume><fpage>2112</fpage><lpage>2126</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.16-06-02112.1996</pub-id><pub-id pub-id-type="pmid">8604055</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.106658.3.sa0</article-id><title-group><article-title>eLife Assessment</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Thirumalai</surname><given-names>Vatsala</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution>National Centre for Biological Sciences</institution><country>India</country></aff></contrib></contrib-group><kwd-group kwd-group-type="evidence-strength"><kwd>Convincing</kwd></kwd-group><kwd-group kwd-group-type="claim-importance"><kwd>Valuable</kwd></kwd-group></front-stub><body><p>In this <bold>valuable</bold> study, Wandler et al. provide <bold>convincing</bold> theoretical evidence for alternate mechanisms of rhythm generation by CPGs. Their model shows that cell-type-specific connectivity and an inhibitory drive could underlie rhythm generation. Excitatory input could act to enhance the frequency range of these rhythms. This modeling study could motivate further experimental investigation of these mechanisms to understand CPG rhythmogenesis.</p></body></sub-article><sub-article article-type="referee-report" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.106658.3.sa1</article-id><title-group><article-title>Reviewer #1 (Public review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>This study explores the connectivity patterns that could lead to fast and slow undulating swim patterns in larval zebrafish using a simplified theoretical framework. The authors show that a pattern of connectivity based only on inhibition is sufficient to produce realistic patterns with a single frequency. Two such networks couple with inhibition but with distinct time constants can produce a range of frequencies. Adding excitatory connections further increases the range of obtainable frequencies, albeit at the expense of sudden transitions in mid-frequency range.</p><p>Strengths:</p><p>(1) This is an eloquent approach to answering the question of how spinal locomotor circuits generate coordinated activity using a theoretical approach based on moving bump models of brain activity.</p><p>(2) The models make specific predictions on patterns of connectivity while discounting the role of connectivity strength or neuronal intrinsic properties in shaping the pattern.</p><p>(3) The models also propose that there is an important association between cell-type-specific intersegmental patterns and the recruitment of speed-selective subpopulations of interneurons.</p><p>(4) Having a hierarchy of models creates a compelling argument for explaining rhythmicity at the network level. Each model builds on the last and reveals a new perspective on how network dynamics can control rhythmicity. I liked that each model can be used to probe questions in the next/previous model.</p><p>Comments on revisions:</p><p>I am very happy to see the simplified biophysical model supporting the original findings. The authors have done an excellent job addressing my comments.</p><p>Just a small note, please change <italic>C. elegans</italic> to <italic>C. elegans</italic>.</p></body></sub-article><sub-article article-type="referee-report" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.106658.3.sa2</article-id><title-group><article-title>Reviewer #2 (Public review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>The authors aimed to show that connectivity patterns within spinal circuits composed of specific excitatory and inhibitory connectivity and with varying degrees of modularity could achieve tail beats at various frequencies as well as proper left-right coordination and rostrocaudal propagation speeds.</p><p>Strengths:</p><p>The model is simple and the connectivity patterns explored are well supported by the literature</p><p>The conclusions are intuitive and support many experimental studies on zebrafish spinal circuits for swimming. The simulations provide strong support for the sufficiency of connectivity patterns to produce and control many hallmark features of swimming in zebrafish</p><p>Weaknesses:</p><p>The authors have addressed my previous concerns well. I have no further concerns.</p></body></sub-article><sub-article article-type="referee-report" id="sa3"><front-stub><article-id pub-id-type="doi">10.7554/eLife.106658.3.sa3</article-id><title-group><article-title>Reviewer #3 (Public review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>Central pattern generator (CPG) circuits underly rhythmic motor behaviors. Till date, it is thought that these CPG networks are rather local and multiple CPG circuits are serially connected to allow locomotion across the entire body. Distributed CPG networks that incorporate long-range connections have not been proposed although such connectivity has been experimentally shown for several different spinal populations. In this manuscript, the authors use this existing literature on long-range spinal interneuron connectivity to build a new computational model that reproduces basic features of locomotion like left-right alternation, rostrocaudal propagation and independent control of frequency and amplitude. Interestingly, the authors show that a model solely based on inhibitory neurons can recapitulate these basic locomotor features. Excitatory sources were then added that increased the dynamic range of frequencies generated. Finally, the authors were also able to reproduce experimentally observed consequences of cell-type-specific ablations showing that local and long range, cell-type-specific connectivity could be sufficient for generating locomotion.</p><p>Strengths:</p><p>This work is novel, providing an interesting alternative of distributed CPGs to the local networks traditionally predicted. It shows cell type-specific network connectivity is as important if not more than intrinsic cell properties for rhythmogenesis and that inhibition plays a crucial role in shaping locomotor features. Given the importance of local CPGs in understanding motor control, this alternative concept will be of broad interest to the larger motor control field including invertebrate and vertebrate species.</p><p>Weaknesses:</p><p>The main weaknesses were addressed in the revision.</p></body></sub-article><sub-article article-type="author-comment" id="sa4"><front-stub><article-id pub-id-type="doi">10.7554/eLife.106658.3.sa4</article-id><title-group><article-title>Author response</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Wandler</surname><given-names>F David</given-names></name><role specific-use="author">Author</role><aff><institution>University of Oregon</institution><addr-line><named-content content-type="city">Eugene</named-content></addr-line><country>United States</country></aff></contrib><contrib contrib-type="author"><name><surname>Lemberger</surname><given-names>Benjamin K</given-names></name><role specific-use="author">Author</role><aff><institution>University of Oregon</institution><addr-line><named-content content-type="city">Eugene</named-content></addr-line><country>United States</country></aff></contrib><contrib contrib-type="author"><name><surname>McLean</surname><given-names>David L</given-names></name><role specific-use="author">Author</role><aff><institution>University of Edinburgh</institution><addr-line><named-content content-type="city">Edinburgh</named-content></addr-line><country>United Kingdom</country></aff></contrib><contrib contrib-type="author"><name><surname>Murray</surname><given-names>James M</given-names></name><role specific-use="author">Author</role><aff><institution>University of Oregon</institution><addr-line><named-content content-type="city">Eugene</named-content></addr-line><country>United States</country></aff></contrib></contrib-group></front-stub><body><p>The following is the authors’ response to the original reviews.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #1 (Public review):</bold></p><p>(1)How is this simplified model representative of what is observed biologically? A bump model does not naturally produce oscillations. How would the dynamics of a rhythm generator interact with this simplistic model?</p></disp-quote><p>Bump models naturally produce sequential activity, and can be engineered to repeat this sequential activity periodically (Zhang, 1996; Samsonovich and McNaughton, 1997; Murray and Escola, 2017). This is the basis for the oscillatory behavior in the model presented here. As we describe in our paper, such a model is consistent with numerous neurobiological observations about cell-type-specific connectivity patterns. The reviewer is, however, correct to point out that our model does not incorporate other key neurobiological features--in particular, intracellular dynamical properties--that have been shown to play important roles in rhythm generation. Our aim in this work is to establish a circuit-level mechanism for rhythm generation, complementary to classical models that rely on intracellular dynamics for rhythm generation. Whether and how these mechanisms work together is something that we plan to explore in future work, and we have added a sentence to the Discussion to this effect.</p><disp-quote content-type="editor-comment"><p>(2) Would this theoretical construct survive being expressed in a biophysical model? It seems that it should, but even a simple biological model with the basic patterns of connectivity shown here would greatly increase confidence in the biological plausibility of the theory.</p></disp-quote><p>We thank the reviewer for pointing out this way to strengthen our paper. We implemented the connectivity developed in the rate models in a spiking neuron model which used EI-balanced Poisson noise as input drive. We found that we could reproduce all the main results of our analysis. In particular, with a realistic number of neurons, we observed swimming activity characterized by (i) left-right alternation, (ii) rostal-caudal propagation, and (iii) variable speed control with constant phase lag. The spiking model demonstrates that the connectivity-motif based mechanisms for rhythmogenesis that we propose are robust in a biophysical setting.</p><p>We included these results in the updated manuscript in a new Results subsection titled “Robustness in a biophysical model.”</p><disp-quote content-type="editor-comment"><p>(3) How stable is this model in its output patterns? Is it robust to noise? Does noise, in fact, smooth out the abrupt transitions in frequency in the middle range?</p></disp-quote><p>The newly added spiking model implementation of the network demonstrates that the core mechanisms of our models are robust to noise, since the connectivity is randomly chosen and the input drive is Poisson noise.</p><p>To test the effect of noise as it is parametrically varied, we also added noise directly to the rate models in the form of white noise input to each unit. Namely, the rate model was adapted to obey the stochastic differential equation<disp-formula id="sa4equ1"><alternatives><mml:math id="sa4m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>τ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>σ</mml:mi><mml:msub><mml:mi>ξ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:msub></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t14">\begin{document}$$\displaystyle  \tau_i \frac{dr_i(t)}{dt} = -r_i(t) + \left[ \sum_j W_{ij} r_j(t - \Delta_{ij}) + D_i + \sigma\xi_t \right]_+$$\end{document}</tex-math></alternatives></disp-formula></p><p>Here <inline-formula><alternatives><mml:math id="sa4m2"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>x</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft133">\begin{document}$xi_t$\end{document}</tex-math></alternatives></inline-formula> is a standard Gaussian white noise and <inline-formula><alternatives><mml:math id="sa4m3"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>σ</mml:mi></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft134">\begin{document}$\sigma$\end{document}</tex-math></alternatives></inline-formula> sets the strength of the noise. We found that the swimming patterns were robust at all frequencies up to <inline-formula><alternatives><mml:math id="sa4m4"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft135">\begin{document}$\sigma = 0.05$\end{document}</tex-math></alternatives></inline-formula>. Above this level, coherent oscillations started to break down for some swim frequencies. To investigate whether the noise smoothed out abrupt transitions, we swept through different values of noise and modularity of excitatory connections. The results showed very minor improvement in controllability (see figure below), but this was not significant enough to include in the manuscript.</p><fig id="sa4fig1" position="float"><label>Author response image 1.</label><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-106658-sa4-fig1-v1.tif"/></fig><disp-quote content-type="editor-comment"><p>(4) All figure captions are inadequate. They should have enough information for the reader to understand the figure and the point that was meant to be conveyed. For example, Figure 1 does not explain what the red dot is, what is black, what is white, or what the gradations of gray are. Or even if this is a representative connectivity of one node, or if this shows all the connections? The authors should not leave the reader guessing.</p></disp-quote><p>All figure captions have been updated to enhance clarity and address these concerns.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #2 (Public review):</bold></p><p>(1) Figure 1A, if I interpret Figure 1B correctly, should there not be long descending projections as well that don't seem to be illustrated?</p></disp-quote><p>Thank you for highlighting this potential point of confusion. The diagram in question was only intended to be a rough schematic of the types of connections present in the model. We have added additional descending connections as requested</p><disp-quote content-type="editor-comment"><p>(2)Page 5, It would be good to define what is meant by slow and fast here, as this definition changes with age in zebrafish (what developmental age)?</p></disp-quote><p>We have updated the manuscript to include the sentence: “These values were chosen to coincide with observed ranges from larval zebrafish.” with appropriate citation.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #3 (Public review):</bold></p><p>(1) The authors describe a single unit as a neuron, be it excitatory or inhibitory, and the output of the simulation is the firing rate of these neurons. Experimentally and in other modeling studies, motor neurons are incorporated in the model, and the output of the network is based on motor neuron firing rate, not the interneurons themselves. Why did the authors choose to build the model this way?</p></disp-quote><p>We chose to leave out the motor neurons from our models for a few reasons. While motor neurons read out the rhythmic activity generated by the interneurons and may provide some feedback, they are not required for rhythmogenesis. In fact, interneuron activity (especially in the excitatory V2a neurons (Agha et al., 2024)) is highly correlated with the ventral root bursts within the same segment. This suggests that motor neurons are primarily a local readout of the rhythmic activity of interneurons; therefore, the rhythmic swimming activity can be deduced directly from the interneurons themselves.</p><p>Moreover, there is a lack of experimental observation of the connectivity between all the cell types considered in our model and motor neurons. Hence, it was unclear how we should include them in the model. To address this, we are currently developing a data-driven approach that will determine the proper connectivity between the motor neurons and the interneurons, including intrasegmental connections.</p><disp-quote content-type="editor-comment"><p>(2) In the single population model (Figure 1), the authors use ipsilateral inhibitory connections that are long-range in an ascending direction. Experimentally, these connections have been shown to be local, while long-range ipsilateral connections have been shown to be descending. What were the reasons the authors chose this connectivity? Do the authors think local ascending inhibitions contribute to rostrocaudal propagation, and how?</p></disp-quote><p>The long-range ascending ipsilateral inhibitory connections arises from a limitation of our modeling framework. The V1 neurons that provide these connections have been shown experimentally to fire later than other neurons (especially descending V2a neurons) within the same hemisegment (Jay et al., J Neurosci, 2023); however, our model can only produce synchronized local activity. Hence, we replace local phase offsets with spatial offsets to produce correctly structured recurrent phasic inputs. We are currently investigating a data-driven method for determining intrasegmental connectivity which should be able to produce the local phase offset and address this concern; however, this is beyond the scope of the current paper.</p><disp-quote content-type="editor-comment"><p>(3) In the two-population model, the authors show independent control of frequency and rhythm, as has been reported experimentally. However, in these previous experimental studies, frequency and amplitude are regulated by different neurons, suggesting different networks dedicated to frequency and amplitude control. However, in the current model, the same population with the same connections can contribute to frequency or amplitude depending on relative tonic drive. Can the authors please address these differences either by changes in the model or by adding to the Discussion?</p></disp-quote><p>Our prior experimental results that suggested a separation of frequency and amplitude control circuits focus on motor neuron recruitment, instead of interneuron activity (Jay et al., J Neurosci 2023; Menelaou and McLean, Nat Commun 2019). To avoid potential confusion about amplitudes of interneurons vs. of motor neurons, we have removed the results from Figure 3 about control of amplitude in the 2-population model, instead focusing this figure on the control of frequency via speed-module recruitment. For the same reason, we have removed the panel showing the effects of targeted ablations on interneuron amplitudes in Figure 7. We have kept the result about amplitude control in our Supplemental Figure S2 for the 8-population model, but we try to make it clear in the text that any relationship between interneuron amplitude and motor neuron amplitude would depend on how motor neurons are modeled, which we do not pursue in this work.</p><disp-quote content-type="editor-comment"><p>(4) It would be helpful to add a paragraph in the Discussion on how these results could be applicable to other model systems beyond zebrafish. Cell intrinsic rhythmogenesis is a popular concept in the field, and these results show an interesting and novel alternative. It would help to know if there is any experimental evidence suggesting such network-based propagation in other systems, invertebrates, or vertebrates.</p></disp-quote><p>We have expanded a paragraph in the Discussion to address these questions. In particular, we highlight how a recent study of mouse locomotor circuits produced a model with similar key features (Komi et al., 2024). These authors made direct use of experimentally determined connectivity structure and cell-type distributions, which informed a model that produced purely network-based rhythmogenesis. We also point out that inhibition-dominated connectivity has been used for understanding oscillatory behavior in neural circuits outside the context of motor control (Zhang, 1996; Samsonovich and McNaughton, 1997; Murray and Escola, 2017). Finally, we address a study that used the cell-type specific connectivity within the <italic>C. elegans</italic> locomotor circuit as the architecture for an artificial motor control system and found that the resulting system could more efficiently learn motor control tasks than general machine learning architectures (Bhattasali et al. 2022). Like our model, the Komi et al. and Bhattasali et al. models generate rhythm via structured connectivity motifs rather than via intracellular dynamical properties, suggesting that these may be a key mechanism underlying locomotion across species.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #1 (Recommendations for the authors):</bold></p><p>(1) Express this modeling construct in a simple biophysical model.</p></disp-quote><p>See the new Results subsection titled “Robustness in a biophysical model.”</p><disp-quote content-type="editor-comment"><p>(2) Please cite the classic models of Kopell, Ermentrout, Williams, Sigvardt etc., especially where you say &quot;classic models&quot;.</p></disp-quote><p>We have added relevant citations including the mentioned authors.</p><disp-quote content-type="editor-comment"><p>(3) &quot;Rhythmogenesis remain incompletely understood&quot; changed to &quot;Rhythmogenesis remains incompletely understood&quot;.</p></disp-quote><p>We chose not to make this change since the ‘remain’ refers to the plural ‘core mechanisms’ not the singular ‘rhythmogenesis’.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #3 (Recommendations for the authors):</bold></p><p>(1) The figures are well made; however, it would help to add more details to the figure legends. For example, what neuron's firing rate is shown in Figure 1C? What is the red dot in 1B? Figures 3E,F,G: what is being plotted? Mean and SD? Blue dot in Figure 5C?</p></disp-quote><p>All figure captions have been updated to enhance clarity and address these concerns.</p><disp-quote content-type="editor-comment"><p>(2) A, B text missing in Figure 7.</p></disp-quote><p>We have revised this figure and its caption; please see our response to Comment 3 above.</p><disp-quote content-type="editor-comment"><p>(3) It would be nice to see the tonic drive pattern that is fed to the model for each case, along with the different firing rates in the figures. It would help understand how the tonic drive is changed to rhythmic activity.</p></disp-quote><p>The tonic drive in the rate models is implemented as a constant excitatory input that is uniform across all units within the same speed-population. There is no patterning in time or location to this drive.</p><p>References</p><p>(1) Moneeza A Agha, Sandeep Kishore, and David L McLean. Cell-type-specific origins of locomotor rhythmicity at different speeds in larval zebrafish. eLife, July 2024</p><p>(2) Nikhil Bhattasali, Anthony M Zador, and Tatiana Engel. Neural circuit architectural priors for embodied control. In S. Koyejo, S. Mohamed, A. Agarwal, D. Belgrave, K. Cho, and A. Oh, editors, Advances in Neural Information Processing Systems, volume 35, pages 12744–12759. Curran Associates, Inc, 2022.</p><p>(3) Salif Komi, August Winther, Grace A. Houser, Roar Jakob Sørensen, Silas Dalum Larsen, Madelaine C. Adamssom Bonfils, Guanghui Li, and Rune W. Berg. Spatial and network principles behind neural generation of locomotion. bioRxiv, 2024</p><p>(4) James M Murray and G Sean Escola. Learning multiple variable-speed sequences in striatum via cortical tutoring. eLife, 6:e26084, May 2017.</p><p>(5) Alexei Samsonovich and Bruce L McNaughton. Path integration and cognitive mapping in a continuous attractor neural network model. Journal of Neuroscience, 17(15):5900–5920, 1997.</p><p>(6) K Zhang. Representation of spatial orientation by the intrinsic dynamics of the head-direction cell ensemble: a theory. Journal of Neuroscience, 16(6):2112–2126, 1996.</p></body></sub-article></article>