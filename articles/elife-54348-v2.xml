<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">54348</article-id><article-id pub-id-type="doi">10.7554/eLife.54348</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Evolutionary Biology</subject></subj-group></article-categories><title-group><article-title>Topological constraints in early multicellularity favor reproductive division of labor</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" id="author-169523"><name><surname>Yanni</surname><given-names>David</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib2">‡</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-169524"><name><surname>Jacobeen</surname><given-names>Shane</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib2">‡</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-169525"><name><surname>Márquez-Zacarías</surname><given-names>Pedro</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-58573"><name><surname>Weitz</surname><given-names>Joshua S</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-169522"><name><surname>Ratcliff</surname><given-names>William C</given-names></name><email>william.ratcliff@gatech.edu</email><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-167941"><name><surname>Yunker</surname><given-names>Peter J</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8471-4171</contrib-id><email>peter.yunker@gatech.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>School of Physics, Georgia Institute of Technology</institution><addr-line><named-content content-type="city">Atlanta</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution>Interdisciplinary Graduate Program in Quantitative Biosciences, Georgia Institute of Technology</institution><addr-line><named-content content-type="city">Atlanta</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution>School of Biological Sciences, Georgia Institute of Technology</institution><addr-line><named-content content-type="city">Atlanta</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Goldstein</surname><given-names>Raymond E</given-names></name><role>Reviewing Editor</role><aff><institution>University of Cambridge</institution><country>United Kingdom</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Tautz</surname><given-names>Diethard</given-names></name><role>Senior Editor</role><aff><institution>Max-Planck Institute for Evolutionary Biology</institution><country>Germany</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn><fn fn-type="con" id="equal-contrib2"><label>‡</label><p>These authors also contributed equally to this work</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>17</day><month>09</month><year>2020</year></pub-date><pub-date pub-type="collection"><year>2020</year></pub-date><volume>9</volume><elocation-id>e54348</elocation-id><history><date date-type="received" iso-8601-date="2019-12-11"><day>11</day><month>12</month><year>2019</year></date><date date-type="accepted" iso-8601-date="2020-09-17"><day>17</day><month>09</month><year>2020</year></date></history><permissions><copyright-statement>© 2020, Yanni et al</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>Yanni et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-54348-v2.pdf"/><related-article ext-link-type="doi" id="ra1" related-article-type="commentary" xlink:href="10.7554/eLife.63328"/><abstract><p>Reproductive division of labor (e.g. germ-soma specialization) is a hallmark of the evolution of multicellularity, signifying the emergence of a new type of individual and facilitating the evolution of increased organismal complexity. A large body of work from evolutionary biology, economics, and ecology has shown that specialization is beneficial when further division of labor produces an accelerating increase in absolute productivity (i.e. productivity is a convex function of specialization). Here we show that reproductive specialization is qualitatively different from classical models of resource sharing, and can evolve even when the benefits of specialization are saturating (i.e. productivity is a concave function of specialization). Through analytical theory and evolutionary individual-based simulations, we demonstrate that reproductive specialization is strongly favored in sparse networks of cellular interactions that reflect the morphology of early, simple multicellular organisms, highlighting the importance of restricted social interactions in the evolution of reproductive specialization.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>reproductive specialization</kwd><kwd>evolution</kwd><kwd>topology</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>IOS-1656549</award-id><principal-award-recipient><name><surname>Ratcliff</surname><given-names>William C</given-names></name><name><surname>Yunker</surname><given-names>Peter J</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>GM138030</award-id><principal-award-recipient><name><surname>Ratcliff</surname><given-names>William C</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>BMAT-2003721</award-id><principal-award-recipient><name><surname>Yunker</surname><given-names>Peter J</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Mathematical modeling shows that reproductive specialization is strongly favored in sparse networks of cellular interactions that reflect the morphology of early multicellular organisms, even when benefits of specialization are saturating.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>The evolution of multicellularity set the stage for unprecedented increases in organismal complexity (<xref ref-type="bibr" rid="bib65">Szathmáry and Smith, 1995</xref>; <xref ref-type="bibr" rid="bib34">Knoll, 2011</xref>). A key factor in the remarkable success of multicellular strategies is the ability to take advantage of within-organism specialization through cellular differentiation (<xref ref-type="bibr" rid="bib53">Queller and Strassmann, 2009</xref>; <xref ref-type="bibr" rid="bib10">Brunet and King, 2017</xref>; <xref ref-type="bibr" rid="bib13">Cavalier-Smith, 2017</xref>). Reproductive specialization, which includes both the creation of a specialized germ line during ontogeny (as in animals and volvocine green algae) and functional differentiation into reproductive and non-reproductive tissues (as in plants, green and red macroalgae, and fungi), may be especially important (<xref ref-type="bibr" rid="bib17">Cooper and West, 2018</xref>; <xref ref-type="bibr" rid="bib43">Michod et al., 2006</xref>; <xref ref-type="bibr" rid="bib30">Ispolatov et al., 2012</xref>; <xref ref-type="bibr" rid="bib63">Solari et al., 2013</xref>; <xref ref-type="bibr" rid="bib44">Michod, 2007</xref>; <xref ref-type="bibr" rid="bib71">West et al., 2015</xref>). Reproductive specialization is an unambiguous indication that biological individuality rests firmly at the level of the multicellular organism (<xref ref-type="bibr" rid="bib41">Michod, 1999</xref>; <xref ref-type="bibr" rid="bib24">Folse and Roughgarden, 2010</xref>), and is thought to play an important role in spurring the evolution of further complexity by inhibiting within-organism (cell-level) evolution (<xref ref-type="bibr" rid="bib11">Buss, 1988</xref>) and limiting reversion to unicellularity (<xref ref-type="bibr" rid="bib36">Libby and Ratcliff, 2014</xref>). Despite the central importance of reproductive specialization, its origin and further evolution during the transition to multicellularity remain poorly understood (<xref ref-type="bibr" rid="bib40">McShea, 2000</xref>).</p><p>The origin of specialization has long been of interest to evolutionary biologists, ecologists, and economists. A large body of theory from these fields shows that specialization pays off only when it increases total productivity, compared to the case where each individual simply produces what they need (<xref ref-type="bibr" rid="bib65">Szathmáry and Smith, 1995</xref>; <xref ref-type="bibr" rid="bib62">Smith and Szathmáry, 1997</xref>; <xref ref-type="bibr" rid="bib25">Goldsby et al., 2012</xref>; <xref ref-type="bibr" rid="bib18">Corning and Szathmáry, 2015</xref>; <xref ref-type="bibr" rid="bib29">Hidalgo and Hausmann, 2009</xref>; <xref ref-type="bibr" rid="bib8">Boza et al., 2014</xref>; <xref ref-type="bibr" rid="bib67">Taborsky et al., 2016</xref>; <xref ref-type="bibr" rid="bib50">Page et al., 2006</xref>; <xref ref-type="bibr" rid="bib59">Rueffler et al., 2012</xref>; <xref ref-type="bibr" rid="bib66">Szekely et al., 2013</xref>; <xref ref-type="bibr" rid="bib23">Findlay, 2008</xref>; <xref ref-type="bibr" rid="bib2">Amado et al., 2018</xref>). Certain types of trading arrangements maximize the benefits of specialization; highly reciprocal interactions, which facilitate exchange between complementary specialists, amplify cooperation (<xref ref-type="bibr" rid="bib1">Allen et al., 2017</xref>; <xref ref-type="bibr" rid="bib51">Pavlogiannis et al., 2018</xref>). Still, previous work finds that even when groups grow in an ideal spatial arrangement, increased specialization and trade is only favored by natural selection when productivity increases as an accelerating function of the degree of specialization (i.e., productivity is a convex, or super-linear, function of the degree of specialization). Conversely, saturating functional returns (i.e. productivity is a concave, or sub-linear, function of the degree of specialization) should inhibit the evolution of specialization (<xref ref-type="bibr" rid="bib17">Cooper and West, 2018</xref>; <xref ref-type="bibr" rid="bib43">Michod et al., 2006</xref>; <xref ref-type="bibr" rid="bib30">Ispolatov et al., 2012</xref>; <xref ref-type="bibr" rid="bib63">Solari et al., 2013</xref>; <xref ref-type="bibr" rid="bib44">Michod, 2007</xref>; <xref ref-type="bibr" rid="bib71">West et al., 2015</xref>).</p><p>Reproductive specialization differs from classical models of trade in several key respects. Trade between germ (reproductive) and somatic (non-reproductive) cells is intrinsically asymmetric, because the cooperative action, multicellular replication, is not a product that is shared evenly. Selection acts primarily on the fitness of the multicellular group as a whole (<xref ref-type="bibr" rid="bib24">Folse and Roughgarden, 2010</xref>). As a result, optimal specialization can result in behaviors that reduce the short-term fitness of some cells within the multicellular group (<xref ref-type="bibr" rid="bib43">Michod et al., 2006</xref>; <xref ref-type="bibr" rid="bib44">Michod, 2007</xref>), often manifest as reproductive altruism.</p><p>Understanding the evolution of cell-cell trade, a classic form of social evolution (<xref ref-type="bibr" rid="bib33">Kirk, 2005</xref>), requires understanding the extent of between-cell interactions. Network theory has proven to be an exceptionally powerful and versatile technique for analyzing social dynamics (<xref ref-type="bibr" rid="bib72">Wey et al., 2008</xref>; <xref ref-type="bibr" rid="bib37">Lieberman et al., 2005</xref>), and indeed, is uniquely well suited to understanding the evolution of early multicellular organisms. When cells adhere through permanent bonds, sparse network-like bodies (i.e. filaments and trees) often result (<xref ref-type="bibr" rid="bib2">Amado et al., 2018</xref>). This mode of group formation is not only common today among simple multicellular organisms (<xref ref-type="bibr" rid="bib69">Umen, 2014</xref>; <xref ref-type="bibr" rid="bib14">Claessen et al., 2014</xref>), but is the dominant mode of group formation in the lineages evolving complex multicellularity (i.e. plants, red algae, brown algae, and fungi, but not animals).</p><p>In this paper, we develop and investigate a model for how the network topology of early multicellular organisms affects the evolution of reproductive specialization. We find that under a broad class of sparse networks, complete functional specialization can be adaptive even when returns from dividing labor are saturating (i.e. concave/sub linear). Sparse networks impose constraints on who can share with whom, which counterintuitively increases the benefit of specialization (<xref ref-type="bibr" rid="bib40">McShea, 2000</xref>). By dividing labor, multicellular groups can capitalize on high between-cell variance in behavior, ultimately increasing group-level reproduction. Further, we consider group morphologies that naturally arise from simple biophysical mechanisms and show that these morphologies strongly promote reproductive specialization. Our results show that reproductive specialization can evolve under a far broader set of conditions than previously thought, lowering a key barrier to major evolutionary transitions.</p><sec id="s1-1"><title>Model</title><p>Reproductive specialization can be modeled as the separation of two key fitness parameters, those related to either viability or fecundity, into separate cells within the multicellular organism (<xref ref-type="bibr" rid="bib42">Michod, 2006</xref>; <xref ref-type="bibr" rid="bib24">Folse and Roughgarden, 2010</xref>). The dichotomy of viability versus fecundity was originally used by <xref ref-type="bibr" rid="bib42">Michod, 2006</xref> to partition components of cellular fitness into actions that contribute to keeping a cell alive (viability), and actions that directly contribute to reproduction (fecundity). Multicellular organisms often have evolved to divide labor along these two lines (i.e. reproduction by germ cells and survival provided by somatic cells), while their unicellular ancestors had to do both. We define viability as activities keeping the cell alive (e.g. investing in cellular homeostasis or behaviors that improve survival), and fecundity as activities involved in cellular reproduction.</p><p>At the cellular level, there appears to be a fundamental asymmetry in how viability effort and fecundity effort can be shared among cells: while multicellular organisms readily evolve differentiated cells that are completely reliant on helper cells (i.e. glial cells that support neurons in animals or companion cells that support sieve tube cells in plants), no cell can directly share its ability to reproduce. To better understand the intuition behind this, consider a cell that elongates prior to fission. This cell must grow to approximately twice its original length. Two cells cannot elongate by 50% and then combine their efforts; elongation is an intrinsically single cell effort. We thus use a model in which viability can be shared across connected cells, but fecundity cannot be shared (note, in order to test the sensitivity of our predictions to this assumption, in a later section we will consider the more general case in which viability and fecundity can both be shared, but by different amounts).</p><p>We consider a model of multicellular groups composed of clonal cells that each invest resources into viability and fecundity. Because there is no within-group genetic variation, within-group evolution is not possible, though selection can act on group-level fitness differences. Specifically, we consider the pattern of cellular investment in fecundity and viability, and their sharing of these resources with neighboring cells within the group, to be the result of a heritable developmental program. Thus, selection is able to act on the multicellular fitness consequences of different patterns of cellular behavior within the group. We let <italic>v</italic> denote each cell’s investment into viability, and <italic>b</italic> denote each cell’s investment into fecundity. Each cell's total investment is constrained so that <inline-formula><mml:math id="inf1"><mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. However, a cell's return on its investment is in general nonlinear. Here, we let <italic>α</italic> represent the ‘return on investment exponent': by tuning <italic>α</italic> above and below 1.0, we can simulate conditions with accelerating and saturating (i.e. convex and concave, or super- and sub-linear) returns on investment, respectively. We let <inline-formula><mml:math id="inf2"><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf3"><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math></inline-formula> represent a cell’s return on viability and fecundity investments, respectively. Following <xref ref-type="bibr" rid="bib42">Michod, 2006</xref>; <xref ref-type="bibr" rid="bib46">Michod and Roze, 1997</xref>, we calculate a cell’s reproductive output as a multiplicative function of <inline-formula><mml:math id="inf4"><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf5"><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math></inline-formula> (thus, both functions must be positive for a cell to grow). A single cell’s reproduction rate is <inline-formula><mml:math id="inf6"><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi>v</mml:mi><mml:mi>α</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mi>α</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. At the group level, fitness is the total contribution of all cells in the group toward the production of new groups (i.e. group level reproduction). The group level fitness is thus the sum of <inline-formula><mml:math id="inf7"><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> over all cells.</p><p>Finally, cells may share the products of their investment in viability with other cells to whom they are connected.For a given group, the details about who may share with whom, and how much, is encoded in a weighted adjacency matrix <inline-formula><mml:math id="inf8"><mml:mi mathvariant="bold">𝐜</mml:mi></mml:math></inline-formula>. The element <inline-formula><mml:math id="inf9"><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> defines what proportion of viability returns cell <italic>i</italic> shares with cell <italic>j</italic>. Cells cannot give away all of their viability returns, as they would no longer be viable; mathematically, we count a cell among its neighbors and thus ensure that they always ‘share’ a positive portion of viability returns with themselves, so that <inline-formula><mml:math id="inf10"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Furthermore, since a cell cannot share more viability returns than the total it possesses, we have <inline-formula><mml:math id="inf11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> for a group of <italic>N</italic> cells. For the networks we consider, each cell takes a fraction <italic>β</italic> of its viability returns and shares that fraction equally among all of its <inline-formula><mml:math id="inf12"><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> neighbors (including itself), and keeps the rest of its returns <inline-formula><mml:math id="inf13"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:math></inline-formula> for itself. Therefore cell <italic>i</italic> keeps a total fraction of <inline-formula><mml:math id="inf14"><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mi>β</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:math></inline-formula> of its returns for itself and gives <inline-formula><mml:math id="inf15"><mml:mfrac><mml:mi>β</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac></mml:math></inline-formula> to each of its non-self neighbors. In other words, <inline-formula><mml:math id="inf16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mi>β</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf17"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mi>β</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:math></inline-formula> if cells <italic>i</italic> and <italic>j</italic> are connected, and <inline-formula><mml:math id="inf18"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> if cells <italic>i</italic> and <italic>j</italic> are not connected. This means the total amount of returns kept by cell <italic>i</italic> depends on <italic>both</italic> the network topology and <italic>β</italic>. When <inline-formula><mml:math id="inf19"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> there is no sharing, and when <inline-formula><mml:math id="inf20"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> cells share everything equally among all connections and themselves. We refer to <italic>β</italic> as interaction strength. A given group topology (unweighted adjacency matrix) and <italic>β</italic> completely specify <inline-formula><mml:math id="inf21"><mml:mi mathvariant="bold">𝐜</mml:mi></mml:math></inline-formula>.</p><p>Within a group of <italic>N</italic> cells, the overall returns on viability that a given cell enjoys, then, comprises its own returns as well as whatever is shared with it by other members of the group. This can be written as <inline-formula><mml:math id="inf22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, or equivalently, <inline-formula><mml:math id="inf23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. Note that this is a column sum, since it describes the total <italic>incoming</italic> viability returns a cell receives as a result of its own effort and trade with neighboring cells. Therefore, we write the group level reproduction rate (i.e. the group fitness) for a group of <italic>N</italic> cells as<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>W</mml:mi></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mover><mml:mi>b</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>W</mml:mi></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mover><mml:mi>b</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>v</mml:mi><mml:mi>j</mml:mi><mml:mi>α</mml:mi></mml:msubsup><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>W</mml:mi></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>v</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where all three of the above equations are equivalent. We investigate evolutionary outcomes under this definition of group level fitness for groups with different topologies (who shares with whom), and in scenarios with various return on investment exponents <italic>α</italic>.</p></sec></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Fixed resource sharing</title><p>We first consider cases wherein cells within a group share across fixed intercellular interactions. In each case we vary the return on investment exponent, <italic>α</italic>, between 0.5 and 1.5, and the interaction strength, <italic>β</italic>, between 0.0 and 1.0, both in increments of 0.1. For each combination of topology, <italic>α</italic>, and <italic>β</italic>, the group investment strategy (<inline-formula><mml:math id="inf24"><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> for all <italic>i</italic>) was allowed to evolve for 1000 generations.</p><p>We begin with simple topologies: groups with no connections and groups that are maximally connected. They represent, respectively, the case in which all cells within the group are autonomous and the case in which every cell interacts with all others (i.e. a ‘well-mixed’ group). In the absence of interactions, cells cannot benefit from functions performed by others and therefore must perform both functions <italic>v</italic> and <italic>b</italic>; hence specialization is not favored, and does not evolve. In the fully connected case, a high degree of specialization is observed for many values of <italic>α</italic> and <italic>β</italic> (<xref ref-type="fig" rid="fig1">Figure 1a</xref>). Consistent with classic results (<xref ref-type="bibr" rid="bib17">Cooper and West, 2018</xref>; <xref ref-type="bibr" rid="bib43">Michod et al., 2006</xref>; <xref ref-type="bibr" rid="bib30">Ispolatov et al., 2012</xref>; <xref ref-type="bibr" rid="bib63">Solari et al., 2013</xref>; <xref ref-type="bibr" rid="bib44">Michod, 2007</xref>; <xref ref-type="bibr" rid="bib71">West et al., 2015</xref>), specialization is only achieved in the fully connected case for <inline-formula><mml:math id="inf25"><mml:mrow><mml:mi>α</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Schematic of topology for a simplified ten cell group (first row), and mean specialization as a function of specialization power <italic>α</italic> and interaction strength <italic>β</italic> across the entire population.</title><p>(<bold>A</bold>) When each cell in the group is connected to all others, specialization is favored only when <inline-formula><mml:math id="inf26"><mml:mrow><mml:mi>α</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. (<bold>B</bold>) For the nearest neighbor topology, specialization is favorable for a wider range of parameters, including for some values of <inline-formula><mml:math id="inf27"><mml:mrow><mml:mi>α</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Specifically, specialization is advantageous when <inline-formula><mml:math id="inf28"><mml:mrow><mml:mi>α</mml:mi><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. (<bold>C</bold>) Connecting alternating specialists creates a bipartite graph which maximizes the benefits of specialization and the range of parameters for which it is advantageous. In this case, specialization is favorable wherever <inline-formula><mml:math id="inf29"><mml:mrow><mml:mi>α</mml:mi><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mrow><mml:mn>5</mml:mn><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. The red curves represent analytical predictions for <inline-formula><mml:math id="inf30"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>, the lowest value of <italic>α</italic> for which complete generalization is disfavored, and the orange vertical lines are at <inline-formula><mml:math id="inf31"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> to guide the eye. While analysis shows that <italic>some</italic> degree of specialization must occur in the regime upward and to the right of the red curves, simulations reveal that when complete generalization is disfavored complete specialization <italic>is</italic> favored in these networks.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54348-fig1-v2.tif"/></fig><p>Next, we consider a simple sparse network in which each cell within a group is connected to only two other cells, forming a complete ring (<xref ref-type="fig" rid="fig1">Figure 1b</xref>); we refer to this as the neighbor network. Surprisingly, preventing trade between most cells encourages division of labor. We find that specialization evolves even when <inline-formula><mml:math id="inf32"><mml:mrow><mml:mi>α</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1.0</mml:mn></mml:mrow></mml:math></inline-formula>, that is, when the returns on investment are saturating or concave. In our simulations, this topology leads to alternating specialists in viability and fecundity (<xref ref-type="fig" rid="fig1">Figure 1b</xref>). Analytically, we find that this topology always favors at least some degree of specialization whenever <inline-formula><mml:math id="inf33"><mml:mrow><mml:mi>α</mml:mi><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>.</p><p>We next study a network with cells that can be separated into two disjoint sub-groups, where every edge of the network connects a cell in one sub-group to a cell in the other sub-group and no within sub-group connections exist, that is, a bipartite graph (<xref ref-type="fig" rid="fig1">Figure 1c</xref>). We refer to the specific network structure in <xref ref-type="fig" rid="fig1">Figure 1c</xref> as the ‘balanced bipartite’ network. We find that specialization evolves even when <inline-formula><mml:math id="inf34"><mml:mrow><mml:mi>α</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1.0</mml:mn></mml:mrow></mml:math></inline-formula>, similar to the neighbor network. However, we find that specialization evolves for a wider range of <italic>α</italic> and <italic>β</italic> values for the balanced bipartite network than for the neighbor network.</p><p>We can analytically determine under what conditions complete generalization is optimal. The complete generalist investment strategy is where every cell in the group invests equally into viability and fecundity, defined as: <inline-formula><mml:math id="inf35"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula> for all <italic>i</italic>. For these simple topologies, the complete generalist strategy is either a maximum or a saddle point, depending on the values of <italic>α</italic> and <italic>β</italic>. Complete generalization is only favored when the Hessian evaluated at the generalist investment strategy <inline-formula><mml:math id="inf36"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">|</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is negative definite, that is, all of its eigenvalues are negative. The largest eigenvalues of the Hessian for the complete, neighbor, and balanced bipartite networks are <inline-formula><mml:math id="inf37"><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf38"><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mfrac><mml:mn>4</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf39"><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, respectively. When <italic>α</italic> and <italic>β</italic> are chosen so that the largest eigenvalue becomes non-negative, complete generalization cannot maximize group fitness.</p><p>While we have not analytically shown where the fitness maximum occurs in cases where the generalist strategy becomes a saddle point, evolutionary simulations (<xref ref-type="fig" rid="fig1">Figure 1</xref>) suggest that when complete generalization is not a fitness maximum, a high degree of (or even complete) specialization typically <italic>does</italic> maximize fitness.</p><p>In all cases in which complete specialization is achieved in evolutionary simulations, <inline-formula><mml:math id="inf40"><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> terms for viability specialists go to zero, as they cannot reproduce on their own. Furthermore, the fecundity specialists are entirely reliant on the viability specialists for their survival; if viability sharing were suddenly prevented, their <inline-formula><mml:math id="inf41"><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> terms would also be zero. This amounts to complete reproductive specialization (<xref ref-type="bibr" rid="bib17">Cooper and West, 2018</xref>; <xref ref-type="bibr" rid="bib33">Kirk, 2005</xref>; <xref ref-type="bibr" rid="bib42">Michod, 2006</xref>).</p></sec><sec id="s2-2"><title>Evolving resource sharing</title><p>Until now, sharing has been included in every intercellular interaction within groups. Here, we consider the case in which there is initially no sharing, and sharing must evolve along with specialization. These simulations begin with no resource sharing (i.e. <inline-formula><mml:math id="inf42"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>); during every round, each group in the population has a 2% chance that a mutation will impact its developmental program, and the <italic>β</italic> value for one of its cells will change. The new <italic>β</italic> value is chosen from a truncated Gaussian with standard deviation of 10% of the mean, centered on the current value. Whatever is not retained is shared equally across all interactions, including the self term.</p><p>Evolutionary simulation results are similar to those from the fixed-sharing model (<xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref>). Saturating specialization (i.e. specialization despite a concave return function) still occurs for the neighbor and balanced bipartite topologies. Thus, for both fixed and evolved resource sharing, we observe specialization for the largest range of parameters (including <inline-formula><mml:math id="inf43"><mml:mrow><mml:mi>α</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) not when the group is maximally connected, but rather when connections are fairly sparse. Therefore, a sparse group topology constitutes a cooperation-prone physical substrate that can favor the evolution of cellular.</p><p>As an example of the benefit of evolving sharing, consider that the maximum fitness according to <xref ref-type="disp-formula" rid="equ14">Equation 1</xref> for a group of <italic>N</italic> disconnected cells scales as <inline-formula><mml:math id="inf44"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. On the other hand, for the balanced bipartite network with a complete specialization strategy (i.e. <inline-formula><mml:math id="inf45"><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>), the fitness scales as <inline-formula><mml:math id="inf46"><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>. The ratio of these fitnesses is <inline-formula><mml:math id="inf47"><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, where the approximation is for large <italic>N</italic>. So for larger groups and when <inline-formula><mml:math id="inf48"><mml:mrow><mml:mi>α</mml:mi><mml:mo>&gt;</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></inline-formula>, if a group can evolve resource sharing (i.e. letting <inline-formula><mml:math id="inf49"><mml:mrow><mml:mi>β</mml:mi><mml:mo>→</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and adopting the specialist investment strategy) its maximum fitness will increase.</p></sec><sec id="s2-3"><title>Benefit of specialization</title><p>We now consider a simple example to highlight why specialization can be adaptive despite saturating (i.e., concave) returns from trade. Consider groups of four cells, connected via the nearest-neighbor topology (i.e. in a ring). We directly calculate the group-level fitness of generalists and specialists for two scenarios: <inline-formula><mml:math id="inf50"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf51"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> by summing the contributions of each cell within these groups (<xref ref-type="fig" rid="fig2">Figure 2</xref>). In this simple scenario, reproductive specialization strongly increases group fitness (33% for <inline-formula><mml:math id="inf52"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and 16% for <inline-formula><mml:math id="inf53"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:math></inline-formula>).</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>To explore how specialization can be favored by the nearest-neighbor topology, we compare the fitness of a four member system when cells are (<bold>A</bold>) generalists and (<bold>B</bold>) specialists.</title><p>We first consider the case of linear functional returns (<inline-formula><mml:math id="inf54"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>). For the case of generalists (A), each cell receives as much viability as it shares, and all nodes contribute equally to the fitness of the group. Therefore, the fitness of the group is <inline-formula><mml:math id="inf55"><mml:mrow><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>⋅</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⋅</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. For the case of specialists, however, the viability specialist cells (blue) have <inline-formula><mml:math id="inf56"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, while the fecundity specialist cells have nonzero <inline-formula><mml:math id="inf57"><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> due to the fact that they receive <inline-formula><mml:math id="inf58"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:math></inline-formula> of each viability specialist’s output. Thus the fitness of the group is <inline-formula><mml:math id="inf59"><mml:mrow><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⋅</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>4</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula>. Thus, fitness is higher for the group of specialists, so specialization is favored. For <inline-formula><mml:math id="inf60"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:math></inline-formula>, the fitness of generalists is 1.15, and the fitness of specialists is 1.33. Thus, even though the returns on investment are saturating (i.e. concave), specialization is favored.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54348-fig2-v2.tif"/></fig><p>The benefit of specialization in neighbor networks increases with group size. For a ring of size <italic>N</italic>, fitness under the specialist strategy <inline-formula><mml:math id="inf61"><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is <inline-formula><mml:math id="inf62"><mml:mrow><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mi>β</mml:mi><mml:mn>3</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. For a ring of generalists the fitness is <inline-formula><mml:math id="inf63"><mml:mrow><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. Therefore, whenever <inline-formula><mml:math id="inf64"><mml:mrow><mml:mi>α</mml:mi><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, the ring of complete specialists enjoys a greater fitness than the ring of complete generalists. Again, note that complete generalization becomes disfavored when <inline-formula><mml:math id="inf65"><mml:mrow><mml:mi>α</mml:mi><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, so there <italic>is</italic> a narrow regime where <inline-formula><mml:math id="inf66"><mml:mrow><mml:mfrac><mml:mn>3</mml:mn><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mi>α</mml:mi><mml:mo>&lt;</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> during which neither complete generalization nor complete specialization is optimal. Numerical optimization and evolutionary simulations suggest that even in this region, however, the specialization score of the optimal strategy is large (<xref ref-type="fig" rid="fig1">Figure 1</xref>).</p></sec><sec id="s2-4"><title>Effect of sparsity</title><p>Surprisingly, saturating specialization appears to be the rule, rather than the exception, for sparsely connected graphs. We investigated Erdős-Rényi random graphs with varying degrees of connectivity to systematically examine the relationship between sparsity and the value of <italic>α</italic> at which specialization is favored. We find that many randomly assembled graphs obtain maximum fitness through complete reproductive specialization even when <italic>α</italic> is below 1 (<xref ref-type="fig" rid="fig3">Figure 3b,c</xref>). It is only at the extremes of sparsity and connectivity (near the fully connected or fully unconnected points) that generalists maintain superior fitness for all values of <inline-formula><mml:math id="inf67"><mml:mrow><mml:mi>α</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. We further show that this general trend is independent of the size of a group; saturating specialization is favorable for groups of size <inline-formula><mml:math id="inf68"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf69"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf70"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula>. When network connectivity is at its minimum, the group consists solely of isolated cells that cannot interact. Under these conditions generalists are favored. Similarly, at maximum connectivity every cell interacts with every other cell. Under these conditions generalists are favored unless <inline-formula><mml:math id="inf71"><mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. However, when connectivity is small but not zero, specialization arises most readily. We conjecture that the troughs in <xref ref-type="fig" rid="fig3">Figure 3b</xref>, where specialization occurs for the lowest values of <italic>α</italic>, occur when connectivity is just large enough so that the existence of a spanning tree is more likely than not.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Sparsity encourages specialization.</title><p>Heat maps showing conditions that favor specialists (white) and generalists (black) for nearest neighbor topologies (<bold>A</bold>, left) and randomly generated graphs with the same connectivity as nearest neighbor topologies (<bold>A</bold>, right). Specialization is adaptive on a neighbor network for <inline-formula><mml:math id="inf72"><mml:mrow><mml:mi>α</mml:mi><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>; random networks with the same mean connectivity as the nearest neighbor topology behave similarly. (<bold>B</bold>) The sparsity of a random graph affects how likely it is to favor specialization. We numerically maximize fitness for random graphs of size <inline-formula><mml:math id="inf73"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula> (left), <inline-formula><mml:math id="inf74"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula> (middle), and <inline-formula><mml:math id="inf75"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula> (right) at different levels of sparsity, and subsequently measure the specialization <inline-formula><mml:math id="inf76"><mml:mi class="ltx_font_mathcaligraphic">𝒮</mml:mi></mml:math></inline-formula> of the fitness maximizing investment strategy. The horizontal axis is the fraction of possible connections present ranging from 0 (none) to 1 (all). The vertical axis is the specialization power <italic>α</italic>, and the colormap shows mean specialization.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54348-fig3-v2.tif"/></fig></sec><sec id="s2-5"><title>Filaments and trees</title><p>Sparse topologies like the neighbor network configuration have significant biological relevance, and direct ties to early multicellularity. The first step in the evolution of multicellularity is the formation of groups of cells (<xref ref-type="bibr" rid="bib65">Szathmáry and Smith, 1995</xref>; <xref ref-type="bibr" rid="bib33">Kirk, 2005</xref>; <xref ref-type="bibr" rid="bib73">Willensdorfer, 2008</xref>; <xref ref-type="bibr" rid="bib7">Bonner, 1998</xref>; <xref ref-type="bibr" rid="bib21">Fairclough et al., 2010</xref>). Simple groups readily arise through incomplete cell division, forming either simple filaments (<xref ref-type="fig" rid="fig4">Figure 4a</xref>) or tree-like morphologies (<xref ref-type="fig" rid="fig4">Figure 4b</xref>; <xref ref-type="bibr" rid="bib4">Bengtson et al., 2017b</xref>; <xref ref-type="bibr" rid="bib20">Droser and Gehling, 2008</xref>; <xref ref-type="bibr" rid="bib5">Berman-Frank et al., 2007</xref>; <xref ref-type="bibr" rid="bib54">Ratcliff et al., 2012</xref>). Filament topologies have been widely observed in independently-evolved simple multicellular organisms, from ancient fossils of early red algae (<xref ref-type="bibr" rid="bib12">Butterfield, 2000</xref>; <xref ref-type="fig" rid="fig4">Figure 4a</xref>) to extant multicellular bacteria (<xref ref-type="bibr" rid="bib14">Claessen et al., 2014</xref>) and algae (<xref ref-type="bibr" rid="bib69">Umen, 2014</xref>). Branching multicellular phenotypes have also been observed to readily evolve from baker’s yeast (<xref ref-type="bibr" rid="bib56">Ratcliff et al., 2015</xref>; <xref ref-type="fig" rid="fig4">Figure 4b</xref>), and are reminiscent of ancient fungus-like structures (<xref ref-type="bibr" rid="bib3">Bengtson et al., 2017a</xref>) and early multicellular fossils of unknown phylogenetic position from the early Ediacaran (<xref ref-type="bibr" rid="bib20">Droser and Gehling, 2008</xref>).</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Simple multicellular organisms with sparse topologies.</title><p>We show two examples of simple multicellular organisms with linear and branched topologies. The image in (<bold>A</bold>) is a fossilized rhodophyte specimen of <italic>Bangiomorpha pubescens</italic>, courtesy of Prof. Nicholas Butterfield (see e.g. <xref ref-type="bibr" rid="bib12">Butterfield, 2000</xref>); the image in (<bold>B</bold>) is a confocal image of ‘snowflake yeast’ showing cell volumes in blue and cell-cell connections in green; the image in (C) is an epifluorescence image of individual yeast cells from a planktonic culture, with the same staining technique as in (B). Scale bars in pictures = 10 µm. Panels include cartoons depicting simplified topologies. Topologically similar to the two-neighbor configuration, these configurations yield similar simulation results. Specialization is plotted as a function of <italic>α</italic>. Solid (A) and blue (B) vertical lines (A and B) indicate analytical solutions for the transition point where the Hessian evaluated at <inline-formula><mml:math id="inf77"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mover><mml:mn>1</mml:mn><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> stops being negative definite, that is, <inline-formula><mml:math id="inf78"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>; dotted lines indicate roughly where the simulation curves cross specialization of 0.5, that is, the 'true' transition value of <italic>α</italic> where specialization becomes favored. (<bold>C</bold>) In contrast, for a well-mixed group with fully connected topology, <inline-formula><mml:math id="inf79"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>α</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, indicating specialization only occurs when there are accelerating returns on investment. (<bold>D</bold>) To further explore trees and filaments we analytically solved for <inline-formula><mml:math id="inf80"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> for various types of trees and filaments of different sizes. <inline-formula><mml:math id="inf81"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> is plotted versus group size for several topologies. This is a proxy measure of how amenable a network structure is to specialization.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54348-fig4-v2.tif"/><attrib>Prof. Butterfield has granted permission to distribute the image in panel A under the terms of a Creative Commons Attribution license [<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>]; further reproduction of this image should adhere to the terms of the CC BY 4.0 license with an attribution to Prof. Butterfield.</attrib></fig><p>Simulations of populations of groups with filamentous and branched topologies reveal that specialization is indeed favored in the sub-linear regime (<xref ref-type="fig" rid="fig4">Figure 4a and b</xref>) ; conversely, sub-linear specialization is never observed for fully connected topologies (<xref ref-type="fig" rid="fig4">Figure 4c</xref>). While the generalist strategy is never a critical point for these networks (which have <inline-formula><mml:math id="inf82"><mml:mrow><mml:mi mathvariant="bold">𝐜</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi mathvariant="bold">𝐜</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, see Materials and methods), we conjecture that there is a nearby critical point which maximizes fitness at small values of <italic>α</italic> and becomes unstable at larger values of <italic>α</italic>. We introduce a new metric, <inline-formula><mml:math id="inf83"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>, defined as the value of <italic>α</italic> such that the largest (least negative) eigenvalue of the Hessian evaluated at the complete generalist strategy is zero when <inline-formula><mml:math id="inf84"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. For topologies in which each member has the same number of neighbors, <inline-formula><mml:math id="inf85"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> is a critical value at which generalization is no longer an optimal strategy. However, even for groups where the number of neighbors for each cell varies, we can still use <inline-formula><mml:math id="inf86"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> as a proxy for how amenable a topology is to saturating specialization. The smaller <inline-formula><mml:math id="inf87"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>, the more specialization is likely to be favored. We plot vertical lines where <inline-formula><mml:math id="inf88"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> (solid lines in <xref ref-type="fig" rid="fig4">﻿Figure 4(a)</xref> <xref ref-type="fig" rid="fig4">Figure 4(b)</xref>), and dotted lines to indicate roughly where the simulation curves cross specialization of 0.5. These results show that, for these topologies, <inline-formula><mml:math id="inf89"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> acts as an effective metric for how amenable a network is to saturating specialization. This metric <inline-formula><mml:math id="inf90"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> only depends on topology and can in principle be calculated analytically given any network. We examined the value of <inline-formula><mml:math id="inf91"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> as filaments and a variety of tree-like structures grow larger, and find that specialization becomes more strongly favored (<xref ref-type="fig" rid="fig4">Figure 4D</xref> ). While group size has no effect on specialization for some topologies, like the neighbor network, filaments and trees all see a decrease in <inline-formula><mml:math id="inf92"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> as group size increases; <inline-formula><mml:math id="inf93"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> eventually plateaus once groups are larger than a few tens of cells. Simple and easily accessible routes to multicellular group formation can readily evolve in response to selection for organismal size (<xref ref-type="bibr" rid="bib54">Ratcliff et al., 2012</xref>), and this process may also strongly favor the evolution of cellular differentiation (<xref ref-type="bibr" rid="bib38">McCarthy and Enquist, 2005</xref>; <xref ref-type="bibr" rid="bib28">Heim et al., 2017</xref>; <xref ref-type="bibr" rid="bib39">McClain and Boyer, 2009</xref>; <xref ref-type="bibr" rid="bib7">Bonner, 1998</xref>).</p></sec><sec id="s2-6"><title>Mean field model</title><p>Finally, to capture some general principles underlying this phenomenon, we consider a mean-field model with <italic>N</italic> cells (<italic>N &gt;&gt; 1</italic>), each of which is connected to <italic>z</italic> other cells. For simplicity we consider the case in which <inline-formula><mml:math id="inf94"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf95"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. We pick <inline-formula><mml:math id="inf96"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> as at this point, if the fitness of specialists is greater than that of generalists, specialization will be favored for at least some values of <inline-formula><mml:math id="inf97"><mml:mrow><mml:mi>α</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. If the fitness of generalists is greater than or equal to that of specialists, specialization will only be favored if <inline-formula><mml:math id="inf98"><mml:mrow><mml:mi>α</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>For generalists, the fitness is simply <inline-formula><mml:math id="inf99"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, as each cell has <inline-formula><mml:math id="inf100"><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf101"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> (before and after sharing). Viability specialists produce <inline-formula><mml:math id="inf102"><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf103"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, while fecundity specialists produce <inline-formula><mml:math id="inf104"><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf105"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Viability specialists then share <inline-formula><mml:math id="inf106"><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> with each of their <italic>z</italic> neighbors. After sharing, fecundity specialists receive <inline-formula><mml:math id="inf107"><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> from each of their viability specialist neighbors. But how many of their neighbors are viability specialists? We label the fraction of cells connected to fecundity specialists that are viability specialists <italic>f</italic>, that is, <italic>f</italic> is the mean number of viability specialists connected to each fecundity specialist divided by <italic>z</italic>, averaged over all fecundity specialists. For a bipartite graph, <inline-formula><mml:math id="inf108"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>; for a randomly connected graph on which half of cells are viability specialists and half of cells are fecundity specialists, <inline-formula><mml:math id="inf109"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>. Group fitness is thus:<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>z</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf110"><mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the average viability returns each fecundity specialist has received after sharing, which is multiplied by the amount of fecundity each fecundity specialist has (1) and the number of fecundity specialists (<inline-formula><mml:math id="inf111"><mml:mrow><mml:mi>N</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>). Writing <inline-formula><mml:math id="inf112"><mml:msub><mml:mi>W</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:math></inline-formula> in terms of <inline-formula><mml:math id="inf113"><mml:msub><mml:mi>W</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math></inline-formula>:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Specialists will be favored if the ratio <inline-formula><mml:math id="inf114"><mml:mrow><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. This will be true if: <disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mrow><mml:mi>z</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>which reduces to:<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>&gt;</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This inequality implies that specialization will only be favored if fecundity specialists are preferentially connected to viability specialists, that is, if <inline-formula><mml:math id="inf115"><mml:mrow><mml:mi>f</mml:mi><mml:mo>&gt;</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>. Further, for a fully connected network <inline-formula><mml:math id="inf116"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, so this inequality is never satisfied, that is, specialists cannot have larger fitness than generalists for <inline-formula><mml:math id="inf117"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and fully connected topologies, as classically predicted.</p><p>Further, <italic>f</italic> cannot be more than 1, so if the threshold from the inequality in <xref ref-type="disp-formula" rid="equ23">Equation 5</xref> is greater than or equal to 1, specialization cannot be favored for <inline-formula><mml:math id="inf118"><mml:mrow><mml:mi>α</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Thus, specialization for <inline-formula><mml:math id="inf119"><mml:mrow><mml:mi>α</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> is only possible if:<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>which reduces to: <inline-formula><mml:math id="inf120"><mml:mrow><mml:mi>z</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. This again reproduces a classic result: specialization for <inline-formula><mml:math id="inf121"><mml:mrow><mml:mi>α</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> is not possible for disconnected cells.</p><p>This analysis allows us to interrogate specific cases. For example, if <inline-formula><mml:math id="inf122"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>, <italic>f</italic> must be greater than 2/3, while if <inline-formula><mml:math id="inf123"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>, <italic>f</italic> must only be greater than 5/8. Can such networks be constructed? The answer will depend on both the number of cells and how they are connected. Ultimately, the question of if a graph can be made with particular values of <italic>f</italic> and <italic>z</italic> is a graph coloring problem, and beyond the scope of this manuscript. However, this inequality presents a useful heuristic which can be used to determine if specialization is favored by measuring just a few properties of the graph.</p><sec id="s2-6-1"><title>Effect of varying ratios of specialists</title><p>We now allow the fraction of fecundity specialists to be <italic>X</italic> (rather than forcing <inline-formula><mml:math id="inf124"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>). For generalists, the group fitness is unchanged, <inline-formula><mml:math id="inf125"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, while for specialists the group fitness is:<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>z</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>X</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Writing <inline-formula><mml:math id="inf126"><mml:msub><mml:mi>W</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:math></inline-formula> in terms of <inline-formula><mml:math id="inf127"><mml:msub><mml:mi>W</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math></inline-formula> gives:<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>X</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Specialists will be favored if the ratio <inline-formula><mml:math id="inf128"><mml:mrow><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. This will be true if: <disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mrow><mml:mi>z</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>X</mml:mi><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>X</mml:mi><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Compared to the threshold value of <italic>f</italic> when <inline-formula><mml:math id="inf129"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, if <inline-formula><mml:math id="inf130"><mml:mrow><mml:mi>X</mml:mi><mml:mo>&gt;</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, that is, more than half of cells are fecundity specialists, the value of <italic>f</italic> necessary for specialization to be favored is lower. If <inline-formula><mml:math id="inf131"><mml:mrow><mml:mi>X</mml:mi><mml:mo>&lt;</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, the threshold value of <italic>f</italic> is higher than if <inline-formula><mml:math id="inf132"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>. In other words, 1:2 is different from 2:1, and they both are different from 1:1. Once again, the question of if a particular configuration can be created–and how–is a graph coloring problem beyond the scope of this manuscript. However, this mean field heuristic gives us some information about how to expect graphs with different ratios of specialists to generalists to behave.</p><p>We again ask what must be true for <italic>f</italic> to be less than 1 (if <inline-formula><mml:math id="inf133"><mml:mrow><mml:mi>f</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, specialization will not be favored). Thus, specialization is only possible if:<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>X</mml:mi><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>which reduces to:<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>&gt;</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>4</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>For a mean field model, specialization with <inline-formula><mml:math id="inf134"><mml:mrow><mml:mi>α</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> is impossible if fewer than one fourth of cells are fecundity specialists. We stress here that this is a mean field model, and does not apply to scenarios in which cells have a wide range of values of <italic>z</italic>. If such networks do or do not favor specialization for <inline-formula><mml:math id="inf135"><mml:mrow><mml:mi>α</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> will again be a graph coloring problem.</p></sec></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>During the evolution of multicellularity, formerly autonomous unicellular organisms evolve into functionally-integrated parts of a new higher level organism (<xref ref-type="bibr" rid="bib71">West et al., 2015</xref>; <xref ref-type="bibr" rid="bib45">Michod and Nedelcu, 2003</xref>). Evolutionary game theory (<xref ref-type="bibr" rid="bib18">Corning and Szathmáry, 2015</xref>; <xref ref-type="bibr" rid="bib48">Nash, 1950</xref>; <xref ref-type="bibr" rid="bib61">Smith, 1988</xref>) argues that functional specialization should only evolve when increased investment in trade increases reproductive output. Conventionally, this requires returns from specialization to be accelerating, that is, convex or super-linear (<xref ref-type="bibr" rid="bib65">Szathmáry and Smith, 1995</xref>; <xref ref-type="bibr" rid="bib62">Smith and Szathmáry, 1997</xref>; <xref ref-type="bibr" rid="bib25">Goldsby et al., 2012</xref>; <xref ref-type="bibr" rid="bib18">Corning and Szathmáry, 2015</xref>; <xref ref-type="bibr" rid="bib8">Boza et al., 2014</xref>; <xref ref-type="bibr" rid="bib67">Taborsky et al., 2016</xref>; <xref ref-type="bibr" rid="bib50">Page et al., 2006</xref>; <xref ref-type="bibr" rid="bib59">Rueffler et al., 2012</xref>; <xref ref-type="bibr" rid="bib66">Szekely et al., 2013</xref>). While this idea is intuitive, it is, in the case of fixed group topology, also overly restrictive. In this paper, we explore how social interactions within groups, measured by their network topology, affect the evolution of reproductive specialization. Indeed, when all cells within groups interact (with equal interaction strength), returns on investment must be an accelerating, that is, convex, function of investment for specialization to evolve (<xref ref-type="fig" rid="fig1">Figure 1a</xref>; <xref ref-type="bibr" rid="bib65">Szathmáry and Smith, 1995</xref>; <xref ref-type="bibr" rid="bib62">Smith and Szathmáry, 1997</xref>; <xref ref-type="bibr" rid="bib18">Corning and Szathmáry, 2015</xref>; <xref ref-type="bibr" rid="bib17">Cooper and West, 2018</xref>). Yet for a broad class of sparsely connected networks, complete specialization can evolve even when the viability and fecundity return on investment curves are saturating, that is, concave (<xref ref-type="fig" rid="fig3">Figure 3</xref>).</p><p>To understand how specialization can be favored despite concave return on investment (ROI) curves, consider Jensen's inequality. Jensen's inequality states that for a convex function <inline-formula><mml:math id="inf136"><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf137"><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, that is, the average value of <inline-formula><mml:math id="inf138"><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf139"><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:math></inline-formula>, is larger than <inline-formula><mml:math id="inf140"><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf141"><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:math></inline-formula> is the average value of <italic>x</italic>. A corollary of Jensen's inequality is that the opposite is true for concave functions, that is, for a concave function <inline-formula><mml:math id="inf142"><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf143"><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Jensen’s inequality guarantees that for concave ROI functions generalists produce more total viability and fecundity than specialists, and that for convex ROI functions specialists produce more total viability and fecundity than generalists.</p><p>Crucially, however, Jensen's inequality does not connect ROI convexity/concavity to group fitness. Jensen’s inequality relates the degree of specialization to the average viability and average fecundity produced, but does not itself say anything about group fitness, which is the product of viability and fecundity averaged across all cells. For fully connected topologies (i.e. <xref ref-type="fig" rid="fig4">Figure 4c</xref>), greater absolute productivity proportionally increases group fitness, and differentiation can only evolve with accelerating benefits of specialization. This is not the case for topologically structured organisms, where fitness also depends on how complementary specialist cells are connected. Natural selection acts on realized productivity, that is, average <inline-formula><mml:math id="inf144"><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula>; mutations that increase average <italic>v</italic> or average <italic>b</italic> without increasing average <inline-formula><mml:math id="inf145"><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula> are not adaptive. The importance of connecting complementary specialists has long been appreciated in other contexts, such as metabolic cross-feeding, for which it has been shown that the spatial arrangement of unlike specialists plays a key role in determining their productivity (and thus fitness) (<xref ref-type="bibr" rid="bib15">Co et al., 2020</xref>). Indeed, While Jensen's inequality ensures that generalists will produce more viability and fecundity than specialists given a concave ROI function, specialization can still increase the fitness of topologically structured groups by increasing realized productivity.</p><p>Rather than being unusual, networks favoring specialization readily arise as a consequence of physical processes structuring simple cellular groups (<xref ref-type="bibr" rid="bib1">Allen et al., 2017</xref>). For example, septin defects during cell division create multicellular groups with simple graph structures (<xref ref-type="fig" rid="fig4">Figure 4a and b</xref>), where cells are connected only to parents and offspring (<xref ref-type="bibr" rid="bib4">Bengtson et al., 2017b</xref>; <xref ref-type="bibr" rid="bib20">Droser and Gehling, 2008</xref>; <xref ref-type="bibr" rid="bib54">Ratcliff et al., 2012</xref>; <xref ref-type="bibr" rid="bib55">Ratcliff et al., 2013</xref>). If cells share resources only with physically-attached neighbors, then the physical topology of the group describes its interaction topology, and these sparse networks strongly favor reproductive specialization. Finally, we note that the primary benefit of sparsity is that sparse networks are likely to be at least somewhat bipartite. The more bipartite-like a network is, the less effort is wasted, and the easier it is for specialization to be favored.</p><p>Disentangling the evolutionary underpinnings of ancient events is notoriously difficult. Still, it is worth examining the independent origins of complex multicellularity, which are independent runs of parallel natural experiments in extreme sociality. Complex multicellularity (large multicellular organisms with considerable cellular differentiation) has evolved in at least five eukaryotic lineages, once each in the animals (<xref ref-type="bibr" rid="bib32">King, 2004</xref>), land plants (<xref ref-type="bibr" rid="bib31">Kenrick and Crane, 1997</xref>), and brown algae (<xref ref-type="bibr" rid="bib60">Silberfeld et al., 2010</xref>), two or three times in the red algae (<xref ref-type="bibr" rid="bib16">Cock and Collén, 2015</xref>; <xref ref-type="bibr" rid="bib75">Yoon et al., 2006</xref>), and 8–11 times in fungi (<xref ref-type="bibr" rid="bib47">Nagy et al., 2018</xref>). In all cases other than animals, these organisms form multicellular bodies via permanent cell-cell bonds, creating long-lasting highly structured cellular networks. Both fossil and phylogenetic evidence suggests that early multicellular organisms in these lineages were considerably less complex, growing as relatively simple graph structures. For example, 1.2 billion year old red algae formed linear filaments of cells (<xref ref-type="bibr" rid="bib12">Butterfield, 2000</xref>), basal multicellular charophyte algae formed circular sheets of cells radiating from a common center (<xref ref-type="bibr" rid="bib31">Kenrick and Crane, 1997</xref>), the ancestor of the brown algae likely formed a branched haplostichous thallus that was either filamentous or pseudoparenchymatous (<xref ref-type="bibr" rid="bib60">Silberfeld et al., 2010</xref>), and hyphal fungi are primarily composed of linear chains of cells. Much less is known about the topology of animals prior to the evolution of cellular specialization. One hypothesis is that early metazoans resembled extant colonial choanoflagellates (<xref ref-type="bibr" rid="bib22">Fairclough et al., 2013</xref>), the closest-living protistan relatives of the animals (<xref ref-type="bibr" rid="bib21">Fairclough et al., 2010</xref>). Extant colony-forming choanoflagellates have evolved a variety of multicellular structures with sparse cellular topologies and permanent cell-cell bonds. For example, many species form branched, tree-like structures (<xref ref-type="bibr" rid="bib35">Leadbeater, 2015</xref>), <italic>Choanoeca flexa</italic> grows as a sheet of cells (<xref ref-type="bibr" rid="bib9">Brunet et al., 2019</xref>), and <italic>Salpingoceca rosetta</italic> can form either linear chains or rosettes in which the cells are connected via cytoplasmic bridges formed through incomplete cytokinesis (<xref ref-type="bibr" rid="bib19">Dayel et al., 2011</xref>). While these growth forms are quite diverse, they all share characteristics (i.e. permanent cellular bonds and sparse topologies) that promote the evolution of cellular differentiation.</p><p>The main differences between our work and previous investigations of the effect of group topology on specialization is that we consider the productivity of groups as a whole, not the cells within them, and we consider situations of highly asymmetric sharing. Our approach is general, and can be applied to other systems of trade and specialization, so long as (1) only the aggregate productivity of the group (and not the particles within it) is maximized, (2) the productivity of each particle within the group is a multiplicative function of returns on investment into two (or more) tasks, and (3) there is an asymmetry in how products of those investments are shared. While in this work we have focused on reproductive division of labor, a process in which fecundity returns are not shared at all, we show in the supplement that as long as sharing of two goods is sufficiently asymmetric, specialization with saturating returns on investment can still be adaptive (<xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2</xref>).</p><p>Finally, we note that alternative paths to specialization likely exist. For example, cells at different positions in a group may experience different local environments, which may produce cells with varied fecundity-viability trade-offs. A previous paper demonstrated that the evolution of specialization is favored if these ‘positional effects’ result in an initially heterogeneous population of cell types (<xref ref-type="bibr" rid="bib68">Tverskoi et al., 2018</xref>). However, these positional effects were considered for the case of well-mixed groups (i.e. completely connected network topologies). We thus anticipate that future work examining the relationship between cellular interaction topology and cellular heterogeneity (as well as a wide range of complex and varied relationships between viability, fecundity, and multicellular fitness) will provide unique insight into the origin and diversity of multicellular forms.</p><sec id="s3-1"><title>Conclusion</title><p>We explored the evolution of reproductive specialization in multicellular groups with various cellular interaction topologies. Our results demonstrate that group topological structure can play a key role in the evolution of reproductive division of labor. Indeed, within a broad class of sparsely connected networks, specialization is favored even when the returns from cooperation are saturating (i.e. concave); this result is in direct contrast to the prevailing view that accelerating (i.e. convex), returns are required for natural selection to favor increased specialization (<xref ref-type="bibr" rid="bib17">Cooper and West, 2018</xref>; <xref ref-type="bibr" rid="bib43">Michod et al., 2006</xref>; <xref ref-type="bibr" rid="bib30">Ispolatov et al., 2012</xref>; <xref ref-type="bibr" rid="bib63">Solari et al., 2013</xref>; <xref ref-type="bibr" rid="bib44">Michod, 2007</xref>; <xref ref-type="bibr" rid="bib71">West et al., 2015</xref>). Our results underscore the central importance of life history trade-offs in the origin of reproductive specialization (<xref ref-type="bibr" rid="bib43">Michod et al., 2006</xref>; <xref ref-type="bibr" rid="bib44">Michod, 2007</xref>; <xref ref-type="bibr" rid="bib27">Hammerschmidt et al., 2014</xref>; <xref ref-type="bibr" rid="bib70">van Gestel and Tarnita, 2017</xref>; <xref ref-type="bibr" rid="bib49">Noh et al., 2018</xref>), and support the emerging consensus that evolutionary transitions in individuality are not necessarily highly constrained (<xref ref-type="bibr" rid="bib54">Ratcliff et al., 2012</xref>; <xref ref-type="bibr" rid="bib57">Ratcliff et al., 2017</xref>; <xref ref-type="bibr" rid="bib21">Fairclough et al., 2010</xref>; <xref ref-type="bibr" rid="bib10">Brunet and King, 2017</xref>; <xref ref-type="bibr" rid="bib52">Pennisi, 2018</xref>; <xref ref-type="bibr" rid="bib6">Black et al., 2019</xref>; <xref ref-type="bibr" rid="bib58">Rose et al., 2020</xref>; <xref ref-type="bibr" rid="bib70">van Gestel and Tarnita, 2017</xref>; <xref ref-type="bibr" rid="bib6">Black et al., 2019</xref>; <xref ref-type="bibr" rid="bib64">Staps et al., 2019</xref>; <xref ref-type="bibr" rid="bib26">Grosberg and Strathmann, 2007</xref>).</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Analysis</title><p>The gradient of the fitness with respect to the group investment strategy <inline-formula><mml:math id="inf146"><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>, is<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>e</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mi>α</mml:mi></mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em">(</mml:mo></mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>−</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em">)</mml:mo></mml:mrow></mml:mstyle></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf147"><mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula> is a unit vector in the <inline-formula><mml:math id="inf148"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> direction. First notice that if <inline-formula><mml:math id="inf149"><mml:mrow><mml:mi mathvariant="bold">𝐜</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold">𝐜</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf150"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mover><mml:mn>1</mml:mn><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> where <inline-formula><mml:math id="inf151"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mn>1</mml:mn><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is a vector of ones, then the gradient is zero. This strategy, <inline-formula><mml:math id="inf152"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mover><mml:mn>1</mml:mn><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, corresponds to the ‘generalist’ strategy, where every cell invests equally into both tasks. Second, notice that if <inline-formula><mml:math id="inf153"><mml:mrow><mml:mi mathvariant="bold">𝐜</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi mathvariant="bold">𝐜</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> then the gradient is <italic>not</italic> zero under the generalist strategy, so at least some degree of specialization must be necessary to maximize fitness. To determine the stability of this solution we examine <inline-formula><mml:math id="inf154"><mml:msup><mml:mi mathvariant="bold">𝐇</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>, the Hessian (see SI <xref ref-type="disp-formula" rid="equ16">Equation 3</xref>) evaluated at the generalist critical point. If <inline-formula><mml:math id="inf155"><mml:msup><mml:mi mathvariant="bold">𝐇</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> is negative definite, then the generalist strategy is a fitness maximum and is therefore an optimal strategy. If, on the other hand, <inline-formula><mml:math id="inf156"><mml:msup><mml:mi mathvariant="bold">𝐇</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> has both positive and negative eigenvalues then the generalist strategy lies at a saddle point within the fitness landscape, and therefore the optimal strategy must be somewhere else in (or on the boundary of) the domain (i.e. <inline-formula><mml:math id="inf157"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for all <inline-formula><mml:math id="inf158"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>). Finally, note that <inline-formula><mml:math id="inf159"><mml:msup><mml:mi mathvariant="bold">𝐇</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> is never positive definite since <inline-formula><mml:math id="inf160"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mn>1</mml:mn><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is always an eigenvector with negative eigenvalue (when <inline-formula><mml:math id="inf161"><mml:mrow><mml:mi mathvariant="bold">𝐜</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold">𝐜</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>).</p><p>We also use the zero crossing of the largest eigenvalue of <inline-formula><mml:math id="inf162"><mml:msup><mml:mi mathvariant="bold">𝐇</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> evaluated at <inline-formula><mml:math id="inf163"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mover><mml:mn>1</mml:mn><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf164"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> as an overall measure of how amenable a network is to specialization, even when <inline-formula><mml:math id="inf165"><mml:mrow><mml:mi mathvariant="bold">𝐜</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi mathvariant="bold">𝐜</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s4-2"><title>Evolutionary simulations</title><p>Our evolutionary simulations maintain the same overall structure as the Wright-Fisher model: a discrete-time Markov chain framework with fitness-weighted multinomial sampling between generations and constant population size. Therefore we refer to them as Wright-Fisher evolutionary simulations. We initialize a population of <inline-formula><mml:math id="inf166"><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">𝒩</mml:mi><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula> groups, each of group size <inline-formula><mml:math id="inf167"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>, with uniform random investment strategies. We then let them evolve for 1000 generations, selecting offspring according to the relative fitness of each group (see <xref ref-type="disp-formula" rid="equ14">Equation 1</xref>). At each generation, there is a 2% chance for a mutation to a given group’s investment strategy <inline-formula><mml:math id="inf168"><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>. If a mutation occurs, a new investment strategy is selected from a truncated multivariate gaussian distribution centered at the current (pre-mutation) investment strategy and with standard deviation equal to <inline-formula><mml:math id="inf169"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>10</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>. After mutations each group’s fitness is calculated according to <xref ref-type="disp-formula" rid="equ14">Equation 1</xref>, and the population is ranked according to fitness. Finally, <inline-formula><mml:math id="inf170"><mml:mi class="ltx_font_mathcaligraphic">𝒩</mml:mi></mml:math></inline-formula> groups are selected (with replacement) to populate the next generation, according to a multinomial distribution weighted by the groups’ fitness ranks.</p></sec><sec id="s4-3"><title>Measuring specialization</title><p>To quantify the degree of specialization associated with a given group’s optimal investment strategy—the one which maximizes the fitness—we introduce the following metric, which we refer to simply as ‘Specialization’:<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mrow><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">𝒮</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>2</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Specialization ranges from 0 (for groups consisting of cells investing equally in functions <italic>v</italic> and <italic>b</italic>) to 1 for groups consisting of cells investing exclusively in either function.</p></sec><sec id="s4-4"><title>Code availability</title><p>All evolutionary simulations and other computations associated with this work are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/dyanni3/topologicalConstraintsSpecialization">github.com/dyanni3/topologicalConstraintsSpecialization</ext-link> (<xref ref-type="bibr" rid="bib74">Yanni, 2020</xref>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/topologicalConstraintsSpecialization">https://github.com/elifesciences-publications/topologicalConstraintsSpecialization</ext-link>).</p></sec></sec></body><back><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Data curation, Software, Formal analysis, Validation, Investigation, Methodology, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Methodology, Writing - original draft</p></fn><fn fn-type="con" id="con3"><p>Visualization, Methodology, Writing - review and editing</p></fn><fn fn-type="con" id="con4"><p>Supervision, Methodology, Writing - review and editing</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Resources, Supervision, Writing - original draft, Project administration, Writing - review and editing</p></fn><fn fn-type="con" id="con6"><p>Conceptualization, Resources, Supervision, Funding acquisition, Methodology, Writing - original draft, Project administration, Writing - review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-54348-transrepform-v2.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All evolutionary simulations and other computations associated with this work are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/dyanni3/topologicalConstraintsSpecialization">https://github.com/dyanni3/topologicalConstraintsSpecialization</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/topologicalConstraintsSpecialization">https://github.com/elifesciences-publications/topologicalConstraintsSpecialization</ext-link>); all parameters used in the current study are specified so all simulations can be repeated exactly.</p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Allen</surname> <given-names>B</given-names></name><name><surname>Lippner</surname> <given-names>G</given-names></name><name><surname>Chen</surname> <given-names>YT</given-names></name><name><surname>Fotouhi</surname> <given-names>B</given-names></name><name><surname>Momeni</surname> <given-names>N</given-names></name><name><surname>Yau</surname> <given-names>ST</given-names></name><name><surname>Nowak</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Evolutionary dynamics on any population structure</article-title><source>Nature</source><volume>544</volume><fpage>227</fpage><lpage>230</lpage><pub-id pub-id-type="doi">10.1038/nature21723</pub-id><pub-id pub-id-type="pmid">28355181</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amado</surname> <given-names>A</given-names></name><name><surname>Batista</surname> <given-names>C</given-names></name><name><surname>Campos</surname> <given-names>PRA</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A theoretical approach to the size-complexity rule</article-title><source>Evolution</source><volume>72</volume><fpage>18</fpage><lpage>29</lpage><pub-id pub-id-type="doi">10.1111/evo.13392</pub-id><pub-id pub-id-type="pmid">29120033</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bengtson</surname> <given-names>S</given-names></name><name><surname>Rasmussen</surname> <given-names>B</given-names></name><name><surname>Ivarsson</surname> <given-names>M</given-names></name><name><surname>Muhling</surname> <given-names>J</given-names></name><name><surname>Broman</surname> <given-names>C</given-names></name><name><surname>Marone</surname> <given-names>F</given-names></name><name><surname>Stampanoni</surname> <given-names>M</given-names></name><name><surname>Bekker</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2017">2017a</year><article-title>Fungus-like mycelial fossils in 2.4-billion-year-old vesicular basalt</article-title><source>Nature Ecology &amp; Evolution</source><volume>1</volume><elocation-id>141</elocation-id><pub-id pub-id-type="doi">10.1038/s41559-017-0141</pub-id><pub-id pub-id-type="pmid">28812648</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bengtson</surname> <given-names>S</given-names></name><name><surname>Sallstedt</surname> <given-names>T</given-names></name><name><surname>Belivanova</surname> <given-names>V</given-names></name><name><surname>Whitehouse</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2017">2017b</year><article-title>Three-dimensional preservation of cellular and subcellular structures suggests 1.6 billion-year-old crown-group red algae</article-title><source>PLOS Biology</source><volume>15</volume><elocation-id>e2000735</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.2000735</pub-id><pub-id pub-id-type="pmid">28291791</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berman-Frank</surname> <given-names>I</given-names></name><name><surname>Quigg</surname> <given-names>A</given-names></name><name><surname>Finkel</surname> <given-names>ZV</given-names></name><name><surname>Irwin</surname> <given-names>AJ</given-names></name><name><surname>Haramaty</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Nitrogen-fixation strategies and fe requirements in cyanobacteria</article-title><source>Limnology and Oceanography</source><volume>52</volume><fpage>2260</fpage><lpage>2269</lpage><pub-id pub-id-type="doi">10.4319/lo.2007.52.5.2260</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Black</surname> <given-names>AJ</given-names></name><name><surname>Bourrat</surname> <given-names>P</given-names></name><name><surname>Rainey</surname> <given-names>PB</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Ecological scaffolding and the evolution of individuality: the transition from cells to multicellular life</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/656660</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bonner</surname> <given-names>JT</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>The origins of multicellularity</article-title><source>Integrative Biology: Issues, News, and Reviews</source><volume>1</volume><fpage>27</fpage><lpage>36</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1520-6602(1998)1:1&lt;27::AID-INBI4&gt;3.0.CO;2-6</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boza</surname> <given-names>G</given-names></name><name><surname>Szilágyi</surname> <given-names>A</given-names></name><name><surname>Kun</surname> <given-names>Á</given-names></name><name><surname>Santos</surname> <given-names>M</given-names></name><name><surname>Szathmáry</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Evolution of the division of labor between genes and enzymes in the RNA world</article-title><source>PLOS Computational Biology</source><volume>10</volume><elocation-id>e1003936</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003936</pub-id><pub-id pub-id-type="pmid">25474573</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brunet</surname> <given-names>T</given-names></name><name><surname>Larson</surname> <given-names>BT</given-names></name><name><surname>Linden</surname> <given-names>TA</given-names></name><name><surname>Vermeij</surname> <given-names>MJA</given-names></name><name><surname>McDonald</surname> <given-names>K</given-names></name><name><surname>King</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Light-regulated collective contractility in a multicellular choanoflagellate</article-title><source>Science</source><volume>366</volume><fpage>326</fpage><lpage>334</lpage><pub-id pub-id-type="doi">10.1126/science.aay2346</pub-id><pub-id pub-id-type="pmid">31624206</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brunet</surname> <given-names>T</given-names></name><name><surname>King</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>The origin of animal multicellularity and cell differentiation</article-title><source>Developmental Cell</source><volume>43</volume><fpage>124</fpage><lpage>140</lpage><pub-id pub-id-type="doi">10.1016/j.devcel.2017.09.016</pub-id><pub-id pub-id-type="pmid">29065305</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Buss</surname> <given-names>LW</given-names></name></person-group><year iso-8601-date="1988">1988</year><source>The Evolution of Individuality</source><publisher-name>Princeton University Press</publisher-name><pub-id pub-id-type="doi">10.1007/BF00130062</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Butterfield</surname> <given-names>NJ</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title><italic>Bangiomorpha pubescens</italic> n. gen., n. sp.: implications for the evolution of sex, multicellularity, and the Mesoproterozoic/Neoproterozoic radiation of eukaryotes</article-title><source>Paleobiology</source><volume>26</volume><fpage>386</fpage><lpage>404</lpage><pub-id pub-id-type="doi">10.1666/0094-8373(2000)026&lt;0386:BPNGNS&gt;2.0.CO;2</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cavalier-Smith</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Origin of animal multicellularity: precursors, causes, consequences-the choanoflagellate/sponge transition, neurogenesis and the cambrian explosion</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>372</volume><elocation-id>20150476</elocation-id><pub-id pub-id-type="doi">10.1098/rstb.2015.0476</pub-id><pub-id pub-id-type="pmid">27994119</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Claessen</surname> <given-names>D</given-names></name><name><surname>Rozen</surname> <given-names>DE</given-names></name><name><surname>Kuipers</surname> <given-names>OP</given-names></name><name><surname>Søgaard-Andersen</surname> <given-names>L</given-names></name><name><surname>van Wezel</surname> <given-names>GP</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Bacterial solutions to multicellularity: a tale of biofilms, filaments and fruiting bodies</article-title><source>Nature Reviews Microbiology</source><volume>12</volume><fpage>115</fpage><lpage>124</lpage><pub-id pub-id-type="doi">10.1038/nrmicro3178</pub-id><pub-id pub-id-type="pmid">24384602</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Co</surname> <given-names>AD</given-names></name><name><surname>Vliet</surname> <given-names>Svan</given-names></name><name><surname>Kiviet</surname> <given-names>DJ</given-names></name><name><surname>Schlegel</surname> <given-names>S</given-names></name><name><surname>Ackermann</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Short-range interactions govern the dynamics and functions of microbial communities</article-title><source>Nature Ecology</source><volume>4</volume><fpage>366</fpage><lpage>375</lpage><pub-id pub-id-type="doi">10.1038/s41559-019-1080-2</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Cock</surname> <given-names>JM</given-names></name><name><surname>Collén</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2015">2015</year><chapter-title>Independent emergence of complex multicellularity in the brown and red algae</chapter-title><person-group person-group-type="editor"><name><surname>Ruiz-Trillo</surname> <given-names>I</given-names></name><name><surname>Nedelcu</surname> <given-names>A</given-names></name></person-group><source>Evolutionary Transitions to Multicellular Life</source><publisher-name>Springer</publisher-name><fpage>335</fpage><lpage>361</lpage><pub-id pub-id-type="doi">10.1007/978-94-017-9642-2_16</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cooper</surname> <given-names>GA</given-names></name><name><surname>West</surname> <given-names>SA</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Division of labour and the evolution of extreme specialization</article-title><source>Nature Ecology &amp; Evolution</source><volume>2</volume><fpage>1161</fpage><lpage>1167</lpage><pub-id pub-id-type="doi">10.1038/s41559-018-0564-9</pub-id><pub-id pub-id-type="pmid">29807994</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Corning</surname> <given-names>PA</given-names></name><name><surname>Szathmáry</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>&quot;Synergistic selection&quot;: a Darwinian frame for the evolution of complexity</article-title><source>Journal of Theoretical Biology</source><volume>371</volume><fpage>45</fpage><lpage>58</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2015.02.002</pub-id><pub-id pub-id-type="pmid">25681798</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dayel</surname> <given-names>MJ</given-names></name><name><surname>Alegado</surname> <given-names>RA</given-names></name><name><surname>Fairclough</surname> <given-names>SR</given-names></name><name><surname>Levin</surname> <given-names>TC</given-names></name><name><surname>Nichols</surname> <given-names>SA</given-names></name><name><surname>McDonald</surname> <given-names>K</given-names></name><name><surname>King</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Cell differentiation and morphogenesis in the colony-forming choanoflagellate <italic>Salpingoeca rosetta</italic></article-title><source>Developmental Biology</source><volume>357</volume><fpage>73</fpage><lpage>82</lpage><pub-id pub-id-type="doi">10.1016/j.ydbio.2011.06.003</pub-id><pub-id pub-id-type="pmid">21699890</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Droser</surname> <given-names>ML</given-names></name><name><surname>Gehling</surname> <given-names>JG</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Synchronous aggregate growth in an abundant new ediacaran tubular organism</article-title><source>Science</source><volume>319</volume><fpage>1660</fpage><lpage>1662</lpage><pub-id pub-id-type="doi">10.1126/science.1152595</pub-id><pub-id pub-id-type="pmid">18356525</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fairclough</surname> <given-names>SR</given-names></name><name><surname>Dayel</surname> <given-names>MJ</given-names></name><name><surname>King</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Multicellular development in a choanoflagellate</article-title><source>Current Biology</source><volume>20</volume><fpage>R875</fpage><lpage>R876</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2010.09.014</pub-id><pub-id pub-id-type="pmid">20971426</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fairclough</surname> <given-names>SR</given-names></name><name><surname>Chen</surname> <given-names>Z</given-names></name><name><surname>Kramer</surname> <given-names>E</given-names></name><name><surname>Zeng</surname> <given-names>Q</given-names></name><name><surname>Young</surname> <given-names>S</given-names></name><name><surname>Robertson</surname> <given-names>HM</given-names></name><name><surname>Begovic</surname> <given-names>E</given-names></name><name><surname>Richter</surname> <given-names>DJ</given-names></name><name><surname>Russ</surname> <given-names>C</given-names></name><name><surname>Westbrook</surname> <given-names>MJ</given-names></name><name><surname>Manning</surname> <given-names>G</given-names></name><name><surname>Lang</surname> <given-names>BF</given-names></name><name><surname>Haas</surname> <given-names>B</given-names></name><name><surname>Nusbaum</surname> <given-names>C</given-names></name><name><surname>King</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Premetazoan genome evolution and the regulation of cell differentiation in the choanoflagellate <italic>Salpingoeca rosetta</italic></article-title><source>Genome Biology</source><volume>14</volume><elocation-id>R15</elocation-id><pub-id pub-id-type="doi">10.1186/gb-2013-14-2-r15</pub-id><pub-id pub-id-type="pmid">23419129</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Findlay</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Comparative advantage</article-title><source>The New Palgrave Dictionary of Economics</source><volume>1–8</volume><fpage>924</fpage><lpage>929</lpage><pub-id pub-id-type="doi">10.1057/978-1-349-95121-5</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Folse</surname> <given-names>HJ</given-names></name><name><surname>Roughgarden</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>What is an individual organism? A multilevel selection perspective</article-title><source>The Quarterly Review of Biology</source><volume>85</volume><fpage>447</fpage><lpage>472</lpage><pub-id pub-id-type="doi">10.1086/656905</pub-id><pub-id pub-id-type="pmid">21243964</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldsby</surname> <given-names>HJ</given-names></name><name><surname>Dornhaus</surname> <given-names>A</given-names></name><name><surname>Kerr</surname> <given-names>B</given-names></name><name><surname>Ofria</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Task-switching costs promote the evolution of division of labor and shifts in individuality</article-title><source>PNAS</source><volume>109</volume><fpage>13686</fpage><lpage>13691</lpage><pub-id pub-id-type="doi">10.1073/pnas.1202233109</pub-id><pub-id pub-id-type="pmid">22872867</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grosberg</surname> <given-names>RK</given-names></name><name><surname>Strathmann</surname> <given-names>RR</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>The evolution of multicellularity: a minor major transition?</article-title><source>Annual Review of Ecology, Evolution, and Systematics</source><volume>38</volume><fpage>621</fpage><lpage>654</lpage><pub-id pub-id-type="doi">10.1146/annurev.ecolsys.36.102403.114735</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hammerschmidt</surname> <given-names>K</given-names></name><name><surname>Rose</surname> <given-names>CJ</given-names></name><name><surname>Kerr</surname> <given-names>B</given-names></name><name><surname>Rainey</surname> <given-names>PB</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Life cycles, fitness decoupling and the evolution of multicellularity</article-title><source>Nature</source><volume>515</volume><fpage>75</fpage><lpage>79</lpage><pub-id pub-id-type="doi">10.1038/nature13884</pub-id><pub-id pub-id-type="pmid">25373677</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heim</surname> <given-names>NA</given-names></name><name><surname>Payne</surname> <given-names>JL</given-names></name><name><surname>Finnegan</surname> <given-names>S</given-names></name><name><surname>Knope</surname> <given-names>ML</given-names></name><name><surname>Kowalewski</surname> <given-names>M</given-names></name><name><surname>Lyons</surname> <given-names>SK</given-names></name><name><surname>McShea</surname> <given-names>DW</given-names></name><name><surname>Novack-Gottshall</surname> <given-names>PM</given-names></name><name><surname>Smith</surname> <given-names>FA</given-names></name><name><surname>Wang</surname> <given-names>SC</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Hierarchical complexity and the size limits of life</article-title><source>Proceedings of the Royal Society B: Biological Sciences</source><volume>284</volume><elocation-id>20171039</elocation-id><pub-id pub-id-type="doi">10.1098/rspb.2017.1039</pub-id><pub-id pub-id-type="pmid">28637850</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hidalgo</surname> <given-names>CA</given-names></name><name><surname>Hausmann</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>The building blocks of economic complexity</article-title><source>PNAS</source><volume>106</volume><fpage>10570</fpage><lpage>10575</lpage><pub-id pub-id-type="doi">10.1073/pnas.0900943106</pub-id><pub-id pub-id-type="pmid">19549871</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ispolatov</surname> <given-names>I</given-names></name><name><surname>Ackermann</surname> <given-names>M</given-names></name><name><surname>Doebeli</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Division of labour and the evolution of multicellularity</article-title><source>Proceedings of the Royal Society B: Biological Sciences</source><volume>279</volume><fpage>1768</fpage><lpage>1776</lpage><pub-id pub-id-type="doi">10.1098/rspb.2011.1999</pub-id><pub-id pub-id-type="pmid">22158952</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kenrick</surname> <given-names>P</given-names></name><name><surname>Crane</surname> <given-names>PR</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>The origin and early evolution of plants on land</article-title><source>Nature</source><volume>389</volume><fpage>33</fpage><lpage>39</lpage><pub-id pub-id-type="doi">10.1038/37918</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>King</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>The unicellular ancestry of animal development</article-title><source>Developmental Cell</source><volume>7</volume><fpage>313</fpage><lpage>325</lpage><pub-id pub-id-type="doi">10.1016/j.devcel.2004.08.010</pub-id><pub-id pub-id-type="pmid">15363407</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kirk</surname> <given-names>DL</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>A twelve-step program for evolving multicellularity and a division of labor</article-title><source>BioEssays</source><volume>27</volume><fpage>299</fpage><lpage>310</lpage><pub-id pub-id-type="doi">10.1002/bies.20197</pub-id><pub-id pub-id-type="pmid">15714559</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Knoll</surname> <given-names>AH</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The multiple origins of complex multicellularity</article-title><source>Annual Review of Earth and Planetary Sciences</source><volume>39</volume><fpage>217</fpage><lpage>239</lpage><pub-id pub-id-type="doi">10.1146/annurev.earth.031208.100209</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Leadbeater</surname> <given-names>BSC</given-names></name></person-group><year iso-8601-date="2015">2015</year><source>The Choanoflagellates: Evolution, Biology and Ecology</source><publisher-name>Cambridge University Press</publisher-name><pub-id pub-id-type="doi">10.1017/CBO9781139051125</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Libby</surname> <given-names>E</given-names></name><name><surname>Ratcliff</surname> <given-names>WC</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Ratcheting the evolution of multicellularity</article-title><source>Science</source><volume>346</volume><fpage>426</fpage><lpage>427</lpage><pub-id pub-id-type="doi">10.1126/science.1262053</pub-id><pub-id pub-id-type="pmid">25342789</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lieberman</surname> <given-names>E</given-names></name><name><surname>Hauert</surname> <given-names>C</given-names></name><name><surname>Nowak</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Evolutionary dynamics on graphs</article-title><source>Nature</source><volume>433</volume><fpage>312</fpage><lpage>316</lpage><pub-id pub-id-type="doi">10.1038/nature03204</pub-id><pub-id pub-id-type="pmid">15662424</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McCarthy</surname> <given-names>M</given-names></name><name><surname>Enquist</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Organismal size, metabolism and the evolution of complexity in metazoans</article-title><source>Evolutionary Ecology Research</source><volume>7</volume><fpage>681</fpage><lpage>696</lpage></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McClain</surname> <given-names>CR</given-names></name><name><surname>Boyer</surname> <given-names>AG</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Biodiversity and body size are linked across metazoans</article-title><source>Proceedings of the Royal Society B: Biological Sciences</source><volume>276</volume><fpage>2209</fpage><lpage>2215</lpage><pub-id pub-id-type="doi">10.1098/rspb.2009.0245</pub-id><pub-id pub-id-type="pmid">19324730</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McShea</surname> <given-names>DW</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Functional complexity in organisms: parts as proxies</article-title><source>Biology &amp; Philosophy</source><volume>15</volume><fpage>641</fpage><lpage>668</lpage><pub-id pub-id-type="doi">10.1023/A:1006695908715</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Michod</surname> <given-names>RE</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Darwinian dynamics: evolutionary transitions in fitness and individuality</article-title><source>Complexity</source><volume>5</volume><fpage>42</fpage><lpage>43</lpage><pub-id pub-id-type="doi">10.1086/393531</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Michod</surname> <given-names>RE</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>On the transfer of fitness from the cell to the multicellular organism</article-title><source>Biology &amp; Philosophy</source><volume>20</volume><fpage>967</fpage><lpage>987</lpage><pub-id pub-id-type="doi">10.1007/s10539-005-9018-2</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Michod</surname> <given-names>RE</given-names></name><name><surname>Viossat</surname> <given-names>Y</given-names></name><name><surname>Solari</surname> <given-names>CA</given-names></name><name><surname>Hurand</surname> <given-names>M</given-names></name><name><surname>Nedelcu</surname> <given-names>AM</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Life-history evolution and the origin of multicellularity</article-title><source>Journal of Theoretical Biology</source><volume>239</volume><fpage>257</fpage><lpage>272</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2005.08.043</pub-id><pub-id pub-id-type="pmid">16288782</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Michod</surname> <given-names>RE</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Evolution of individuality during the transition from unicellular to multicellular life</article-title><source>PNAS</source><volume>104 Suppl 1</volume><fpage>8613</fpage><lpage>8618</lpage><pub-id pub-id-type="doi">10.1073/pnas.0701489104</pub-id><pub-id pub-id-type="pmid">17494748</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Michod</surname> <given-names>RE</given-names></name><name><surname>Nedelcu</surname> <given-names>AM</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>On the reorganization of fitness during evolutionary transitions in individuality</article-title><source>Integrative and Comparative Biology</source><volume>43</volume><fpage>64</fpage><lpage>73</lpage><pub-id pub-id-type="doi">10.1093/icb/43.1.64</pub-id><pub-id pub-id-type="pmid">21680410</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Michod</surname> <given-names>RE</given-names></name><name><surname>Roze</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Transitions in individuality</article-title><source>Proceedings of the Royal Society of London. Series B: Biological Sciences</source><volume>264</volume><fpage>853</fpage><lpage>857</lpage><pub-id pub-id-type="doi">10.1098/rspb.1997.0119</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nagy</surname> <given-names>LG</given-names></name><name><surname>Kovács</surname> <given-names>GM</given-names></name><name><surname>Krizsán</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Complex multicellularity in fungi: evolutionary convergence, single origin, or both?</article-title><source>Biological Reviews</source><volume>93</volume><fpage>1778</fpage><lpage>1794</lpage><pub-id pub-id-type="doi">10.1111/brv.12418</pub-id><pub-id pub-id-type="pmid">29675836</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nash</surname> <given-names>JF</given-names></name></person-group><year iso-8601-date="1950">1950</year><article-title>Equilibrium points in N-Person games</article-title><source>PNAS</source><volume>36</volume><fpage>48</fpage><lpage>49</lpage><pub-id pub-id-type="doi">10.1073/pnas.36.1.48</pub-id><pub-id pub-id-type="pmid">16588946</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Noh</surname> <given-names>S</given-names></name><name><surname>Geist</surname> <given-names>KS</given-names></name><name><surname>Tian</surname> <given-names>X</given-names></name><name><surname>Strassmann</surname> <given-names>JE</given-names></name><name><surname>Queller</surname> <given-names>DC</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Genetic signatures of microbial altruism and cheating in social amoebas in the wild</article-title><source>PNAS</source><volume>115</volume><fpage>3096</fpage><lpage>3101</lpage><pub-id pub-id-type="doi">10.1073/pnas.1720324115</pub-id><pub-id pub-id-type="pmid">29507206</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Page</surname> <given-names>RE</given-names></name><name><surname>Scheiner</surname> <given-names>R</given-names></name><name><surname>Erber</surname> <given-names>J</given-names></name><name><surname>Amdam</surname> <given-names>GV</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>8. the development and evolution of division of labor and foraging specialization in a social insect (Apis mellifera L.)</article-title><source>Current Topics in Developmental Biology</source><volume>74</volume><fpage>253</fpage><lpage>286</lpage><pub-id pub-id-type="doi">10.1016/S0070-2153(06)74008-X</pub-id><pub-id pub-id-type="pmid">16860670</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pavlogiannis</surname> <given-names>A</given-names></name><name><surname>Tkadlec</surname> <given-names>J</given-names></name><name><surname>Chatterjee</surname> <given-names>K</given-names></name><name><surname>Nowak</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Construction of arbitrarily strong amplifiers of natural selection using evolutionary graph theory</article-title><source>Communications Biology</source><volume>1</volume><elocation-id>71</elocation-id><pub-id pub-id-type="doi">10.1038/s42003-018-0078-7</pub-id><pub-id pub-id-type="pmid">30271952</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pennisi</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>The power of many</article-title><source>Science</source><volume>360</volume><fpage>1388</fpage><lpage>1391</lpage><pub-id pub-id-type="doi">10.1126/science.360.6396.1388</pub-id><pub-id pub-id-type="pmid">29954962</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Queller</surname> <given-names>DC</given-names></name><name><surname>Strassmann</surname> <given-names>JE</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Beyond society: the evolution of organismality</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>364</volume><fpage>3143</fpage><lpage>3155</lpage><pub-id pub-id-type="doi">10.1098/rstb.2009.0095</pub-id><pub-id pub-id-type="pmid">19805423</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ratcliff</surname> <given-names>WC</given-names></name><name><surname>Denison</surname> <given-names>RF</given-names></name><name><surname>Borrello</surname> <given-names>M</given-names></name><name><surname>Travisano</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Experimental evolution of multicellularity</article-title><source>PNAS</source><volume>109</volume><fpage>1595</fpage><lpage>1600</lpage><pub-id pub-id-type="doi">10.1073/pnas.1115323109</pub-id><pub-id pub-id-type="pmid">22307617</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ratcliff</surname> <given-names>WC</given-names></name><name><surname>Pentz</surname> <given-names>JT</given-names></name><name><surname>Travisano</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Tempo and mode of multicellular adaptation in experimentally evolved <italic>Saccharomyces cerevisiae</italic></article-title><source>Evolution</source><volume>67</volume><fpage>1573</fpage><lpage>1581</lpage><pub-id pub-id-type="doi">10.1111/evo.12101</pub-id><pub-id pub-id-type="pmid">23730752</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ratcliff</surname> <given-names>WC</given-names></name><name><surname>Fankhauser</surname> <given-names>JD</given-names></name><name><surname>Rogers</surname> <given-names>DW</given-names></name><name><surname>Greig</surname> <given-names>D</given-names></name><name><surname>Travisano</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Origins of multicellular evolvability in snowflake yeast</article-title><source>Nature Communications</source><volume>6</volume><elocation-id>6102</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms7102</pub-id><pub-id pub-id-type="pmid">25600558</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ratcliff</surname> <given-names>WC</given-names></name><name><surname>Herron</surname> <given-names>M</given-names></name><name><surname>Conlin</surname> <given-names>PL</given-names></name><name><surname>Libby</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Nascent life cycles and the emergence of higher-level individuality</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>372</volume><elocation-id>20160420</elocation-id><pub-id pub-id-type="doi">10.1098/rstb.2016.0420</pub-id><pub-id pub-id-type="pmid">29061893</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rose</surname> <given-names>CJ</given-names></name><name><surname>Hammerschmidt</surname> <given-names>K</given-names></name><name><surname>Pichugin</surname> <given-names>Y</given-names></name><name><surname>Rainey</surname> <given-names>PB</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Meta-population structure and the evolutionary transition to multicellularity</article-title><source>Ecology Letters</source><volume>23</volume><fpage>1380</fpage><lpage>1390</lpage><pub-id pub-id-type="doi">10.1111/ele.13570</pub-id><pub-id pub-id-type="pmid">32643307</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rueffler</surname> <given-names>C</given-names></name><name><surname>Hermisson</surname> <given-names>J</given-names></name><name><surname>Wagner</surname> <given-names>GP</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Evolution of functional specialization and division of labor</article-title><source>PNAS</source><volume>109</volume><fpage>E326</fpage><lpage>E335</lpage><pub-id pub-id-type="doi">10.1073/pnas.1110521109</pub-id><pub-id pub-id-type="pmid">22308336</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Silberfeld</surname> <given-names>T</given-names></name><name><surname>Leigh</surname> <given-names>JW</given-names></name><name><surname>Verbruggen</surname> <given-names>H</given-names></name><name><surname>Cruaud</surname> <given-names>C</given-names></name><name><surname>de Reviers</surname> <given-names>B</given-names></name><name><surname>Rousseau</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>A multi-locus time-calibrated phylogeny of the Brown algae (Heterokonta, Ochrophyta, phaeophyceae): Investigating the evolutionary nature of the &quot;brown algal crown radiation&quot;</article-title><source>Molecular Phylogenetics and Evolution</source><volume>56</volume><fpage>659</fpage><lpage>674</lpage><pub-id pub-id-type="doi">10.1016/j.ympev.2010.04.020</pub-id><pub-id pub-id-type="pmid">20412862</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Smith</surname> <given-names>JM</given-names></name></person-group><year iso-8601-date="1988">1988</year><source>Evolution and the Theory of Games</source><publisher-loc>Boston, MA</publisher-loc><publisher-name>Springer</publisher-name><pub-id pub-id-type="doi">10.1007/978-1-4684-7862-4_22</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Smith</surname> <given-names>J</given-names></name><name><surname>Szathmáry</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="1997">1997</year><source>The Major Transitions in Evolution</source><publisher-name>OUP Oxford Press</publisher-name><pub-id pub-id-type="doi">10.1098/rstb.2016.0175</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Solari</surname> <given-names>CA</given-names></name><name><surname>Kessler</surname> <given-names>JO</given-names></name><name><surname>Goldstein</surname> <given-names>RE</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A general allometric and life-history model for cellular differentiation in the transition to multicellularity</article-title><source>The American Naturalist</source><volume>181</volume><fpage>369</fpage><lpage>380</lpage><pub-id pub-id-type="doi">10.1086/669151</pub-id><pub-id pub-id-type="pmid">23448886</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Staps</surname> <given-names>M</given-names></name><name><surname>van Gestel</surname> <given-names>J</given-names></name><name><surname>Tarnita</surname> <given-names>CE</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Emergence of diverse life cycles and life histories at the origin of multicellularity</article-title><source>Nature Ecology &amp; Evolution</source><volume>3</volume><fpage>1197</fpage><lpage>1205</lpage><pub-id pub-id-type="doi">10.1038/s41559-019-0940-0</pub-id><pub-id pub-id-type="pmid">31285576</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Szathmáry</surname> <given-names>E</given-names></name><name><surname>Smith</surname> <given-names>JM</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>The major evolutionary transitions</article-title><source>Nature</source><volume>374</volume><fpage>227</fpage><lpage>232</lpage><pub-id pub-id-type="doi">10.1038/374227a0</pub-id><pub-id pub-id-type="pmid">7885442</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Szekely</surname> <given-names>P</given-names></name><name><surname>Sheftel</surname> <given-names>H</given-names></name><name><surname>Mayo</surname> <given-names>A</given-names></name><name><surname>Alon</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Evolutionary tradeoffs between economy and effectiveness in biological homeostasis systems</article-title><source>PLOS Computational Biology</source><volume>9</volume><elocation-id>e1003163</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003163</pub-id><pub-id pub-id-type="pmid">23950698</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taborsky</surname> <given-names>M</given-names></name><name><surname>Frommen</surname> <given-names>JG</given-names></name><name><surname>Riehl</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Correlated pay-offs are key to cooperation</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>371</volume><elocation-id>20150084</elocation-id><pub-id pub-id-type="doi">10.1098/rstb.2015.0084</pub-id><pub-id pub-id-type="pmid">26729924</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tverskoi</surname> <given-names>D</given-names></name><name><surname>Makarenkov</surname> <given-names>V</given-names></name><name><surname>Aleskerov</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Modeling functional specialization of a cell colony under different fecundity and viability rates and resource constraint</article-title><source>PLOS ONE</source><volume>13</volume><elocation-id>e0201446</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0201446</pub-id><pub-id pub-id-type="pmid">30089142</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Umen</surname> <given-names>JG</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Green algae and the origins of multicellularity in the plant kingdom</article-title><source>Cold Spring Harbor Perspectives in Biology</source><volume>6</volume><elocation-id>a016170</elocation-id><pub-id pub-id-type="doi">10.1101/cshperspect.a016170</pub-id><pub-id pub-id-type="pmid">25324214</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Gestel</surname> <given-names>J</given-names></name><name><surname>Tarnita</surname> <given-names>CE</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>On the origin of biological construction, with a focus on multicellularity</article-title><source>PNAS</source><volume>114</volume><fpage>11018</fpage><lpage>11026</lpage><pub-id pub-id-type="doi">10.1073/pnas.1704631114</pub-id><pub-id pub-id-type="pmid">28973893</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>West</surname> <given-names>SA</given-names></name><name><surname>Fisher</surname> <given-names>RM</given-names></name><name><surname>Gardner</surname> <given-names>A</given-names></name><name><surname>Kiers</surname> <given-names>ET</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Major evolutionary transitions in individuality</article-title><source>PNAS</source><volume>112</volume><fpage>10112</fpage><lpage>10119</lpage><pub-id pub-id-type="doi">10.1073/pnas.1421402112</pub-id><pub-id pub-id-type="pmid">25964342</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wey</surname> <given-names>T</given-names></name><name><surname>Blumstein</surname> <given-names>DT</given-names></name><name><surname>Shen</surname> <given-names>W</given-names></name><name><surname>Jordán</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Social network analysis of animal behaviour: a promising tool for the study of sociality</article-title><source>Animal Behaviour</source><volume>75</volume><fpage>333</fpage><lpage>344</lpage><pub-id pub-id-type="doi">10.1016/j.anbehav.2007.06.020</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Willensdorfer</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Organism size promotes the evolution of specialized cells in multicellular digital organisms</article-title><source>Journal of Evolutionary Biology</source><volume>21</volume><fpage>104</fpage><lpage>110</lpage><pub-id pub-id-type="doi">10.1111/j.1420-9101.2007.01466.x</pub-id><pub-id pub-id-type="pmid">18036158</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Yanni</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>topologicalConstraintsSpecialization</data-title><source>GitHub</source><version designator="555fc97">555fc97</version><ext-link ext-link-type="uri" xlink:href="https://github.com/dyanni3/topologicalConstraintsSpecialization">https://github.com/dyanni3/topologicalConstraintsSpecialization</ext-link></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yoon</surname> <given-names>HS</given-names></name><name><surname>Muller</surname> <given-names>KM</given-names></name><name><surname>Sheath</surname> <given-names>RG</given-names></name><name><surname>Ott</surname> <given-names>FD</given-names></name><name><surname>Bhattacharya</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Defining the major lineages of red algae (RHODOPHYTA)1</article-title><source>Journal of Phycology</source><volume>42</volume><fpage>482</fpage><lpage>492</lpage><pub-id pub-id-type="doi">10.1111/j.1529-8817.2006.00210.x</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><boxed-text><sec id="s8" sec-type="appendix"><title>Analysis</title><p>As described in the main text, the fitness for a group of <inline-formula><mml:math id="inf171"><mml:mi>N</mml:mi></mml:math></inline-formula> individuals is defined as<disp-formula id="equ14"><label>(1)</label><mml:math id="m14"><mml:mrow><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mi>α</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>j</mml:mi><mml:mi>α</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>and the gradient of the fitness with respect to the group investment strategy <inline-formula><mml:math id="inf172"><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>, is<disp-formula id="equ15"><label>(2)</label><mml:math id="m15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mover><mml:mi>e</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf173"><mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula> is a unit vector in the <inline-formula><mml:math id="inf174"><mml:msup><mml:mi>k</mml:mi><mml:mtext>th</mml:mtext></mml:msup></mml:math></inline-formula> direction.</p><sec id="s8-1"><title>Hessian</title><p>The Hessian <inline-formula><mml:math id="inf175"><mml:mfrac><mml:mrow><mml:msup><mml:mo>∂</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>⁡</mml:mo><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">ℓ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:math></inline-formula> is<disp-formula id="equ16"><label>(3)</label><mml:math id="m16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>−</mml:mo><mml:msup><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mtd><mml:mtd><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>ℓ</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd/></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mtd><mml:mtd><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>ℓ</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mstyle><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Of particular interest for us is the value of the Hessian at the generalist strategy when <inline-formula><mml:math id="inf176"><mml:mrow><mml:mi mathvariant="bold">𝐜</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold">𝐜</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>. In that case<disp-formula id="equ17"><label>(4)</label><mml:math id="m17"><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="bold">𝐇</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="210%" minsize="210%">[</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold">𝐚</mml:mi></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold">𝐈</mml:mi></mml:mrow></mml:mrow><mml:mo maxsize="210%" minsize="210%">]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf177"><mml:mi mathvariant="bold">𝐚</mml:mi></mml:math></inline-formula> is the row-normalized adjacency matrix of the network. If <inline-formula><mml:math id="inf178"><mml:mi mathvariant="bold">𝐀</mml:mi></mml:math></inline-formula> is the network’s adjacency matrix then <disp-formula id="equ18"><mml:math id="m18"><mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The case when <inline-formula><mml:math id="inf179"><mml:mrow><mml:mi mathvariant="bold">𝐜</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold">𝐜</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula></p><p>As noted above, when <inline-formula><mml:math id="inf180"><mml:mrow><mml:mi mathvariant="bold">𝐜</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold">𝐜</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, the generalist strategy is always a critical point where <inline-formula><mml:math id="inf181"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. To determine the stability of this solution we examine <inline-formula><mml:math id="inf182"><mml:msup><mml:mi mathvariant="bold">𝐇</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ17">Equation 4</xref>). If <inline-formula><mml:math id="inf183"><mml:msup><mml:mi mathvariant="bold">𝐇</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> is negative definite, then the generalist strategy is a fitness maximum and is therefore an optimal strategy. If, on the other hand, <inline-formula><mml:math id="inf184"><mml:msup><mml:mi mathvariant="bold">𝐇</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> has both positive and negative eigenvalues then the generalist strategy lies at a saddle point within the fitness landscape, and therefore the optimal strategy must be somewhere else in (or on the boundary of) the domain (i.e. <inline-formula><mml:math id="inf185"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for all <inline-formula><mml:math id="inf186"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>). Finally, note that <inline-formula><mml:math id="inf187"><mml:msup><mml:mi mathvariant="bold">𝐇</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> is never positive definite (when <inline-formula><mml:math id="inf188"><mml:mrow><mml:mi mathvariant="bold">𝐜</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold">𝐜</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>). Consider <inline-formula><mml:math id="inf189"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mover><mml:mn>1</mml:mn><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>:<disp-formula id="equ19"><mml:math id="m19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left center" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mover><mml:mn>1</mml:mn><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">[</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mi>β</mml:mi><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mn>1</mml:mn><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mi>β</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mn>1</mml:mn><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">]</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msup><mml:mrow><mml:mover><mml:mn>1</mml:mn><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">[</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mi>β</mml:mi><mml:mrow><mml:mover><mml:mn>1</mml:mn><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mi>β</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mover><mml:mn>1</mml:mn><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">]</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msup><mml:mrow><mml:mover><mml:mn>1</mml:mn><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mover><mml:mn>1</mml:mn><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Note <inline-formula><mml:math id="inf190"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mover><mml:mn>1</mml:mn><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mover><mml:mn>1</mml:mn><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> since <inline-formula><mml:math id="inf191"><mml:mi mathvariant="bold">𝐚</mml:mi></mml:math></inline-formula> is row-normalized. Furthermore, <inline-formula><mml:math id="inf192"><mml:mrow><mml:mi>α</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, so <inline-formula><mml:math id="inf193"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mn>1</mml:mn><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is always an eigenvector of <inline-formula><mml:math id="inf194"><mml:msup><mml:mi mathvariant="bold">𝐇</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> with a negative eigenvalue.</p><p>We can next ask, under what conditions is <inline-formula><mml:math id="inf195"><mml:msup><mml:mi mathvariant="bold">𝐇</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> negative definite? This will depend on the group topology, the nonlinear returns on investment <inline-formula><mml:math id="inf196"><mml:mi>α</mml:mi></mml:math></inline-formula>, and the interaction strength <inline-formula><mml:math id="inf197"><mml:mi>β</mml:mi></mml:math></inline-formula>. We examine three cases: the neighbor graph, the balanced bipartite graph, and the complete graph.</p><table-wrap id="app1table1" position="float"><label>Appendix 1—table 1.</label><caption><title>Largest eigenvalue of the Hessian evaluated at the generalist critical point as a function of <inline-formula><mml:math id="inf198"><mml:mi>α</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf199"><mml:mi>β</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf200"><mml:mi>N</mml:mi></mml:math></inline-formula> for three topologies.</title><p>When the group size <inline-formula><mml:math id="inf201"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>, the balanced bipartite graph coincides with the neighbor graph, and indeed the eigenvalues agree. Similarly, when <inline-formula><mml:math id="inf202"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> the balanced bipartite graph coincides with the complete graph and the eigenvalues agree. The interesting domain of <inline-formula><mml:math id="inf203"><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:math></inline-formula> is <inline-formula><mml:math id="inf204"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, so for the complete graph <inline-formula><mml:math id="inf205"><mml:msup><mml:mi mathvariant="bold">𝐇</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> is always negative definite. However, the balanced bipartite and neighbor graphs show regions where the generalist strategy is <italic>not</italic> stable.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Topology</th><th>Largest eigenvalue</th></tr></thead><tbody><tr><td>neighbor graph</td><td><inline-formula><mml:math id="inf206"><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mfrac><mml:mn>4</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td>balanced bipartite graph</td><td><inline-formula><mml:math id="inf207"><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td>complete graph</td><td><inline-formula><mml:math id="inf208"><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr></tbody></table></table-wrap><p>When <inline-formula><mml:math id="inf209"><mml:mrow><mml:mi mathvariant="bold">𝐜</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold">𝐜</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, the matrix <inline-formula><mml:math id="inf210"><mml:msup><mml:mi mathvariant="bold">𝐇</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> is a special type of matrix called a circulant matrix, with well known properties. Its eigenvalues are given by the discrete Fourier transform of its first row. The <inline-formula><mml:math id="inf211"><mml:msup><mml:mi>k</mml:mi><mml:mi>th</mml:mi></mml:msup></mml:math></inline-formula> eigenvalue is<disp-formula id="equ20"><mml:math id="m20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mstyle></mml:mrow></mml:msup></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>For the ring topology with <inline-formula><mml:math id="inf212"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>, for example<disp-formula id="equ21"><mml:math id="m21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>α</mml:mi><mml:mi>β</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>α</mml:mi><mml:mi>β</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mn>5</mml:mn></mml:mfrac><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>α</mml:mi><mml:mi>β</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mn>9</mml:mn><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mn>5</mml:mn></mml:mfrac><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>which has its maximum when <inline-formula><mml:math id="inf213"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>, <disp-formula id="equ22"><mml:math id="m22"><mml:mrow><mml:mrow><mml:mrow><mml:munder><mml:mi>max</mml:mi><mml:mi>k</mml:mi></mml:munder><mml:mo>⁡</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:mfrac></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The maximum eigenvalue for the balanced bipartite and complete graphs can be computed similarly.</p></sec></sec><sec id="s9" sec-type="appendix"><title>Evolution of resource sharing</title><p>Here we model the co-evolution of sharing and specialization. We start with generalists that do not share at all. We then allow the amount of sharing and the degree of specialization to evolve. As described in the main text, during every round, each group in the population has a 2% chance that one if its cells will mutate and change how much ‘viability’ it shares. When this occurs, the fraction of its output to retain is chosen from a Gaussian with standard deviation of 10% centered on the current value. Whatever is not retained is shared equally across its interactions. The degree of specialization evolves as in simulations described in the main text.</p><p>Results are shown in <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref>, for neighbor topologies, balanced bipartite topologies, and for a complete network.</p><fig id="app1fig1" position="float"><label>Appendix 1—figure 1.</label><caption><title>Evolution of resource sharing.</title><p>(<bold>A</bold>) Initially, individuals do not share resources; however, they may evolve to do so via random mutations. Here, the mean specialization of the fittest of 100 groups each with 10 cells after 100,000 steps is plotted as a function of specialization power. Error bars are standard deviations across 10 replicates. Blue is the fully connected network, red is the neighbor network, and green is the balanced bipartite topology. (<bold>B-D</bold>) The final distribution of specialization values for individual cells in fully connected (<bold>B</bold>), nearest-neighbor (<bold>C</bold>), and balanced bipartite topologies (<bold>D</bold>). The color of cells in B-D represents their degree of specialization, as indicated in the scale bar.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54348-app1-fig1-v2.tif"/></fig></sec><sec id="s10" sec-type="appendix"><title>General case of sharing two resources</title><p>We have so far focused on reproductive specialization, wherein the returns from one type of task (reproduction) are completely unshared while returns from another task (viability) are shared according to some functional interaction strength <inline-formula><mml:math id="inf214"><mml:mi>β</mml:mi></mml:math></inline-formula>. Here, we generalize somewhat to consider the returns from two arbitrary tasks which may each be shared to some extent, given by functional interaction strengths <inline-formula><mml:math id="inf215"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. For notational continuity we will continue to refer to the investment in those tasks as <inline-formula><mml:math id="inf216"><mml:mi>b</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf217"><mml:mi>v</mml:mi></mml:math></inline-formula>, and for tractability we will continue to assume that <inline-formula><mml:math id="inf218"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and that there is a single topology governing who can trade with whom within the group. Of course, further generalizations could be made — e.g. each task could experience different returns on investment, there could be an arbitrary number of tasks, the availability of trading partners could differ between tasks, etc. However, we hope to show by this relatively modest generalization that there is nothing unique to <italic>reproductive</italic> tasks whose fruits are totally unshared that leads to specialization under regimes of sublinear return on investment.</p><p>The fitness function is modified so that<disp-formula id="equ23"><label>(5)</label><mml:math id="m23"><mml:mrow><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo maxsize="120%" minsize="120%">(</mml:mo><mml:mrow><mml:mmultiscripts><mml:mi mathvariant="bold">𝐜</mml:mi><mml:mn>𝟏</mml:mn><mml:none/><mml:none/><mml:mi>T</mml:mi></mml:mmultiscripts><mml:mo>⋅</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>α</mml:mi></mml:msup></mml:mrow><mml:mo maxsize="120%" minsize="120%">)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mrow><mml:mo maxsize="120%" minsize="120%">(</mml:mo><mml:mrow><mml:mmultiscripts><mml:mi mathvariant="bold">𝐜</mml:mi><mml:mn>𝟐</mml:mn><mml:none/><mml:none/><mml:mi>T</mml:mi></mml:mmultiscripts><mml:mo>⋅</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>α</mml:mi></mml:msup></mml:mrow><mml:mo maxsize="120%" minsize="120%">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>which yields the following Hessian at the generalist critical point (for the neighbor, balanced bipartite, and complete networks)<disp-formula id="equ24"><mml:math id="m24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em">(</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>⋅</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mrow><mml:mn mathvariant="bold">2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mtext>T</mml:mtext></mml:mrow></mml:msup><mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>⋅</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mrow><mml:mn mathvariant="bold">2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mtext>T</mml:mtext></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:mrow><mml:mover><mml:mn>1</mml:mn><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>⋅</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mrow><mml:mn mathvariant="bold">2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mtext>T</mml:mtext></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:mrow><mml:mover><mml:mn>1</mml:mn><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>where<disp-formula id="equ25"><label>(6)</label><mml:math id="m25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mn mathvariant="bold">1</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ26"><label>(7)</label><mml:math id="m26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mn mathvariant="bold">2</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>and,<disp-formula id="equ27"><mml:math id="m27"><mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where, as above, <inline-formula><mml:math id="inf219"><mml:mi mathvariant="bold">𝐀</mml:mi></mml:math></inline-formula> is the graph’s adjacency matrix (including self loops).</p><p>We see that for a given topology the adjacency matrix is fixed, so that <inline-formula><mml:math id="inf220"><mml:msub><mml:mi mathvariant="bold">𝐜</mml:mi><mml:mn>𝟏</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf221"><mml:msub><mml:mi mathvariant="bold">𝐜</mml:mi><mml:mn>𝟐</mml:mn></mml:msub></mml:math></inline-formula> differ only in their functional interaction strengths <inline-formula><mml:math id="inf222"><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf223"><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>. Therefore the maximum fitness strategy, specified by the vector <inline-formula><mml:math id="inf224"><mml:msup><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>, for a given group will depend under our model on the following parameters:<disp-formula id="equ28"><mml:math id="m28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mo stretchy="false">→</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">j</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi>β</mml:mi><mml:mrow><mml:msub><mml:mi/><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mtext> </mml:mtext><mml:mo stretchy="false">→</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">F</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mspace width="thinmathspace"/><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi>β</mml:mi><mml:mrow><mml:msub><mml:mi/><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mtext> </mml:mtext><mml:mo stretchy="false">→</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">F</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi>α</mml:mi><mml:mtext> </mml:mtext><mml:mo stretchy="false">→</mml:mo><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">z</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">q</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mtext> </mml:mtext><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We demonstrate the effect of these parameters on the optimal strategy by finding the minimum value of <inline-formula><mml:math id="inf225"><mml:mi>α</mml:mi></mml:math></inline-formula> for which specialization becomes favored, which we denote <inline-formula><mml:math id="inf226"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>, for a given pair <inline-formula><mml:math id="inf227"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and given topology. The results are shown in <xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2</xref>.</p><fig id="app1fig2" position="float"><label>Appendix 1—figure 2.</label><caption><title>Effect of sharing two resources.</title><p>When two resources are shared to different degrees, specified by <inline-formula><mml:math id="inf228"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, specialization is sometimes favored under conditions of sublinear returns on investment <inline-formula><mml:math id="inf229"><mml:mrow><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>&lt;</mml:mo><mml:mn>1.0</mml:mn></mml:mrow></mml:math></inline-formula>. Interestingly, specialization is favored when one resource is shared liberally while the other resource is shared sparingly (though it is not necessary to have one resource remain totally unshared).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54348-app1-fig2-v2.tif"/></fig></sec><sec id="s11" sec-type="appendix"><title>Jensen’s inequality and sparse topologies and asymmetric sharing</title><p>To understand how average fitness decouples from average <inline-formula><mml:math id="inf230"><mml:mi>v</mml:mi></mml:math></inline-formula> and average <inline-formula><mml:math id="inf231"><mml:mi>b</mml:mi></mml:math></inline-formula> for sparse topologies and asymmetric sharing, consider a ring of four cells in three different configurations: one that alternates between viability and fecundity specialists, one in which like-specialists are connected to each other, and one in which all cells are generalists (pictured below). For simplicity, we will set <inline-formula><mml:math id="inf232"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, and we will initially consider the case when <inline-formula><mml:math id="inf233"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. When <inline-formula><mml:math id="inf234"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, Jensen's inequality tells us that generalists and specialists will be equally productive. Classically, this would suggest that specialists and generalists should have the same fitness.</p><p>And, indeed, all three cases have the same average v and the same average b (Â½ for each). However, the average fitnesses are all different.</p><p>Next, we consider the same three configurations, but with <inline-formula><mml:math id="inf235"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:math></inline-formula>. Jensen's inequality tells us that for this value of <inline-formula><mml:math id="inf236"><mml:mi>α</mml:mi></mml:math></inline-formula>, generalists should have a higher average v and average b. Indeed, the average v and b is higher for generalists than for specialists: 0.536 versus 0.5. However, the average fitness of generalists, 0.287, is still lower than the average fitness of alternating specialists, 0.333.</p><p>These examples show that Jensen's inequality still holds, and still correctly tells us which configuration has the highest average v and average b. However, average v and average b are no longer directly proportional to average fitness. Therefore Jensen's inequality does not directly inform average fitness, and we should not expect convex ROI functions to be required for specialists to be favored.</p></sec><sec id="s12" sec-type="appendix"><title>Star graphs</title><p>Let <inline-formula><mml:math id="inf237"><mml:msub><mml:mi>W</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math></inline-formula> be the fitness for the star shaped network group of generalists (<inline-formula><mml:math id="inf238"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf239"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) and <inline-formula><mml:math id="inf240"><mml:msub><mml:mi>W</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> be the fitness of specialists (all of the points of the star get <inline-formula><mml:math id="inf241"><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf242"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and the central point gets <inline-formula><mml:math id="inf243"><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf244"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>).</p><p>Next assume there are <inline-formula><mml:math id="inf245"><mml:mi>N</mml:mi></mml:math></inline-formula> cells on the points of the star and 1 cell in the center of the star. We then have:<disp-formula id="equ29"><label>(8)</label><mml:math id="m29"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></disp-formula>as the only individual with nonzero fitness is the central individual (all others have <inline-formula><mml:math id="inf246"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>). The central individual’s fecundity returns are <inline-formula><mml:math id="inf247"><mml:mrow><mml:msup><mml:mn>1</mml:mn><mml:mi>α</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, and it’s own viability returns are 0. However, the central individual gets shared <inline-formula><mml:math id="inf248"><mml:mfrac><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:math></inline-formula> of each of the <inline-formula><mml:math id="inf249"><mml:mi>N</mml:mi></mml:math></inline-formula> other individuals’ viability returns (which are <inline-formula><mml:math id="inf250"><mml:mrow><mml:msup><mml:mn>1</mml:mn><mml:mi>α</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> each).</p><p>Next, for generalists, we have<disp-formula id="equ30"><label>(9)</label><mml:math id="m30"><mml:mrow><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mi>β</mml:mi><mml:mi>N</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mfrac><mml:mi>β</mml:mi><mml:mi>N</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>-</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mfrac><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The term on the left of <xref ref-type="disp-formula" rid="equ30">Equation 9</xref> comes from the fact that there are <inline-formula><mml:math id="inf251"><mml:mi>N</mml:mi></mml:math></inline-formula> individuals each sharing <inline-formula><mml:math id="inf252"><mml:mfrac><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:math></inline-formula> of their viability returns (which is <inline-formula><mml:math id="inf253"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>α</mml:mi></mml:msup></mml:math></inline-formula> each) with themselves, and are getting <inline-formula><mml:math id="inf254"><mml:mfrac><mml:mi>β</mml:mi><mml:mi>N</mml:mi></mml:mfrac></mml:math></inline-formula> of the central individual’s <inline-formula><mml:math id="inf255"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>α</mml:mi></mml:msup></mml:math></inline-formula> viability returns shared with them. Additionally, they are getting <inline-formula><mml:math id="inf256"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:math></inline-formula> of their own viability returns (withheld from sharing). Finally, each of their fecundity returns is <inline-formula><mml:math id="inf257"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>α</mml:mi></mml:msup></mml:math></inline-formula>.</p><p>The term on the right of <xref ref-type="disp-formula" rid="equ30">Equation 9</xref> represents the contribution to the group fitness of the single central individual. That individual gets <inline-formula><mml:math id="inf258"><mml:mrow><mml:mfrac><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>*</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>α</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> of viability returns shared to it <inline-formula><mml:math id="inf259"><mml:mi>N</mml:mi></mml:math></inline-formula> times, and it also shares with itself and keeps a portion of its returns for itself. And it has a fecundity return of <inline-formula><mml:math id="inf260"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>α</mml:mi></mml:msup></mml:math></inline-formula>.</p></sec><sec id="s13" sec-type="appendix"><title>Star topologies in the limit of large N</title><p>We first examine <xref ref-type="disp-formula" rid="equ30">Equation 9</xref> in the limit where <inline-formula><mml:math id="inf261"><mml:mrow><mml:mi>N</mml:mi><mml:mo>≫</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ31"><label>(10)</label><mml:math id="m31"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mfrac><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>which reduces to<disp-formula id="equ32"><label>(11)</label><mml:math id="m32"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>and finally<disp-formula id="equ33"><label>(12)</label><mml:math id="m33"><mml:mrow><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>To understand if generalists or specialists are favored we examine the ratio of generalist to specialist fitness <inline-formula><mml:math id="inf262"><mml:mfrac><mml:msub><mml:mi>W</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:msub><mml:mi>W</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mfrac></mml:math></inline-formula>.<disp-formula id="equ34"><label>(13)</label><mml:math id="m34"><mml:mrow><mml:mrow><mml:mfrac><mml:msub><mml:mi>W</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:msub><mml:mi>W</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mi>β</mml:mi><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This means <inline-formula><mml:math id="inf263"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> if <inline-formula><mml:math id="inf264"><mml:mrow><mml:mi>β</mml:mi><mml:mo>&gt;</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. Since <inline-formula><mml:math id="inf265"><mml:mi>β</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf266"><mml:mi>α</mml:mi></mml:math></inline-formula> are both bounded between 0 and 1, this is never achievable. Therefore, at large <inline-formula><mml:math id="inf267"><mml:mi>N</mml:mi></mml:math></inline-formula>, specialists are always favored.</p></sec><sec id="s14" sec-type="appendix"><title>Star topologies in general</title><p>Alternately, if do not assume <inline-formula><mml:math id="inf268"><mml:mi>N</mml:mi></mml:math></inline-formula> is large, but set <inline-formula><mml:math id="inf269"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> for simplicity, we can solve for the largest <inline-formula><mml:math id="inf270"><mml:mi>α</mml:mi></mml:math></inline-formula> which would yield equal fitness to generalists and specialists:<disp-formula id="equ35"><label>(14)</label><mml:math id="m35"><mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></sec><sec id="s15" sec-type="appendix"><title>Rings with even and odd numbers of cells</title><p>In the main text we plot <inline-formula><mml:math id="inf271"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> for ring graphs with even numbers of cells. We made this choice as specialization is slightly frustrated when there are odd numbers of cells. Rings with odd numbers of cells must have at least one location at which like specialists are connected, thus slightly increasing the value of <inline-formula><mml:math id="inf272"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> compared to a ring with an even number of cells (<xref ref-type="fig" rid="app1fig3">Appendix 1—figure 3</xref>). However, as the size of the graph increases, a single frustrated pairing matters less and less, and the value of <inline-formula><mml:math id="inf273"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> for rings with odd numbers and large N appears to approach the value of <inline-formula><mml:math id="inf274"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> for rings with even numbers of cells.</p><fig id="app1fig3" position="float"><label>Appendix 1—figure 3.</label><caption><title>Rings with odd numbers of cells are frustrated.</title><p><inline-formula><mml:math id="inf275"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> plotted versus the number of cells in the ring, for rings with even and odd numbers of cells.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54348-app1-fig3-v2.tif"/></fig></sec></boxed-text></app></app-group></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.54348.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Goldstein</surname><given-names>Raymond E</given-names></name><role>Reviewing Editor</role><aff><institution>University of Cambridge</institution><country>United Kingdom</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Bourrat</surname><given-names>Pierrick</given-names> </name><role>Reviewer</role><aff><institution>MacQuarie University</institution><country>Australia</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>The evolution of germ-soma differentiation is one of the most fundamental questions in evolutionary biology, and the present paper investigates the consequences of altering one of the most basic assumptions: the traditional (symmetric) division of labor that has been studied from biology to economics. The authors consider a diversity of network structures and fitness functions and they find that sparser networks lead to higher levels of specialization.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Topological constraints in early multicellularity favor reproductive division of labor&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by two peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Diethard Tautz as the Senior Editor. The following individual involved in review of your submission has agreed to reveal their identity: Pierrick Bourrat (Reviewer #2).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>This is a very interesting paper on the evolution of germ-soma differentiation in which the authors consider the topology of interactions between the cells that make up the whole. They find that classical considerations about the convexity or concavity of certain functions characterizing the advantages of specialization no longer hold when the network topology is nontrivial. And such topologies are indeed found in nature. The reviewers were generally very supportive of the work but raised a number of points that need to be addressed in a revised manuscript.</p><p>Essential revisions:</p><p>1) The authors use a notion of fitness in which clonal cells can have different fitnesses, or more accurately, clonal groups can have different fitness. We know that there are some precedents in the literature, but this notion of fitness does not correspond to the notion of fitness one can associate with natural selection. To illustrate why, consider the following plant example. Take a single genet with two ramets in two environmental patches, one rich and one poor. Each ramet might adopt a very different developmental strategy from the other, considering the ecological constraints it is subjected to. These two strategies would nevertheless not be heritable in the sense that two offspring ramets put in the same environmental patch would develop the same developmental strategies (excluding noise). Thus, the differential success of each ramet is not an evolutionary success that can be associated with natural selection. This is a case analogous to the one presented by the authors. The notion of fitness they refer to seems to be rather the notion of realized fitness. This has no implications for the author's results per se but instead leads to an interpretation in which natural selection is not at work for explaining the division of labor in situations of concavity.</p><p>2) Related to the previous point, there seems to be a tension between, on the one hand, the claim that a concave function can lead to an increase in reproductive specialization, and on the other hand, claims that it has something to do with fitness. Fitness is about expected values, and in a situation of concave function, two or more cells specializing would yield a lower collective fitness than when not specializing. From a purely analytical point of view (i.e., Fisher's fundamental theorem), this seems impossible. So my question to the authors is whether there is not hidden somewhere a convex function, which is the relevant one for the evolutionary dynamics observed. Otherwise, what is the ecological explanation of such a result? There must be some ecological constraints that give rise to this phenomenon, and it would be good to know what the authors think they are.</p><p>3) There are well-known cases presented in the population genetics literature in which Fisher's fundamental theorem seems violated, but this is because of the environment (including the social environment) changes over time, such as frequency-dependent effects on an individual's success. We wonder if the results of the authors could not related to this literature in some way.</p><p>4) The model description is a bit abstract and occasionally hard to follow. It would be great to have fecundity and viability defined, and even better to have some real biological example of what returns on viability might mean and how they might be shared (I don't find the filamentous fungi example informative, at least not in the way it is written). That would also help the reader understand why there are returns on viability but not on fecundity. That the v<sub>i</sub> vector is the &quot;group investment strategy&quot; also comes as a surprise and takes a bit for the reader to put it all together. Similarly, the existence of both a general adjancecy matrix and of a special case one that uses the <italic>β</italic>, is somewhat confusing the way it's described. If the authors anyway only work with the special case of equal sharing with the non-self neighbors then why not define the 1-<italic>β</italic>+<italic>β</italic>/ni quantities as c<sub>ij</sub> when they appear in the text, and then write a fourth eqn for W in [1] that explicitly uses the <italic>β</italic>. That would certainly help the reader a lot.</p><p>5) Results subsection “Fixed resource sharing” first paragraph, we may be getting confused, but how can you vary <italic>β</italic> in the case when, as is now written, individual i &quot;shares equally among interaction and self terms&quot;? Doesn't this mean that <italic>β</italic> = 1?</p><p>6) “We conjecture that the troughs in Figure 3C, where specialization occurs for the lowest values of, occur when connectivity is just large enough so that a spanning tree is more likely to connect all individuals in the group than not”, we don't fully understand that conjecture: do the authors simply mean that the troughs occur when the random graph becomes connected with probability &gt; 50%? (A spanning tree connects all individuals by definition.)</p><p>7) The authors suggest sparsity is the main determinant of whether a network supports reproductive specialization. But, their examples in 1B and 1C (where a ring is sparser than the bipartite network) to us suggest that it is not so much about &quot;sparsity&quot; as it is about &quot;bipartiteness&quot; – or how easy it is to subdivide the nodes into two classes such that most edges go between these two classes (that's what you'd want for specialization anyway, we guess), and that sparse graphs simply have a tendency to be close to bipartite. We suspect that a ring graph with an odd number of vertices will be less conducive to specialization (although you could still alternate germ/soma cells except at one point), and that a star graph where there is one node of degree n-1 and all the others have degree 1 may be an example of a sparse graph where evolving specialization is not so easy (because for this graph it's not clear how to divide the vertices into germ and soma).</p><p>8) Related to the previous point: we would be interested if the authors have considered what happens when the optimal strategy is not 1:1 but, say, 1:2. Does that make specialization more difficult? Here we think that, with a few additional simulations, the authors could add a lot to the paper in terms of the ability to connect properties of the graph (beyond comparing some explicit topologies and random graphs of varying sparsity) to its ability to support the evolution of reproductive specialization.</p><p>9) Finally, it would be nice to see how the different specialists are distributed on these networks (at least when the specialization is equal to 1). One can infer it, but we think it would visually help the reader to get the gist of how the model works very quickly.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.54348.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) The authors use a notion of fitness in which clonal cells can have different fitnesses, or more accurately, clonal groups can have different fitness. We know that there are some precedents in the literature, but this notion of fitness does not correspond to the notion of fitness one can associate with natural selection. To illustrate why, consider the following plant example. Take a single genet with two ramets in two environmental patches, one rich and one poor. Each ramet might adopt a very different developmental strategy from the other, considering the ecological constraints it is subjected to. These two strategies would nevertheless not be heritable in the sense that two offspring ramets put in the same environmental patch would develop the same developmental strategies (excluding noise). Thus, the differential success of each ramet is not an evolutionary success that can be associated with natural selection. This is a case analogous to the one presented by the authors. The notion of fitness they refer to seems to be rather the notion of realized fitness. This has no implications for the author's results per se but instead leads to an interpretation in which natural selection is not at work for explaining the division of labor in situations of concavity.</p></disp-quote><p>Thank you for the thought-provoking comment. We are not completely sure if we understand your point correctly (and if not, we are happy to continue the discussion), but we are using the concept of fitness in the standard sense. While cells within groups can have different numbers of surviving offspring, in our simplified modeling world, selection does not act on these differences. Instead, we assume that the cells within each group are clonal, and that there can be genetic differences between groups. These genetic differences are responsible for cellular behavior, namely the extent to which they specialize in viability or fecundity tasks. Selection acts at the group level, in a way that is simply proportional to cellular productivity within these groups. Thus, selection acts between groups on differences in group fitness, which is caused by heritable variation in cellular behaviors underlying differentiation that vary between the groups.</p><p>However, we appreciate the reviewer’s point. We previously described mutations as affecting individual cells, which would of course mean that groups are no longer clonal. It is more accurate to say that in our simulation model, mutations change the pattern of specialization and sharing at different positions in the group, which we think of as being driven by a heritable developmental program. As with our analytical results, selection only acts on group-level fitness. When model parameters favor specialization, we see initially uniform groups in which every cell is a generalist gradually evolve developmental programs featuring complete reproductive specialization, providing a simulation test of our analytical results. We have thus revised and clarified the description of these simulations. We also stopped referring to the “fitness” of individual cells in the paper, since it is potentially confusing, instead describing the direct consequences of cellular specialization on their productivity (each cell’s 𝑣 ∗ 𝑏).</p><p>In addition to the changes noted in the paragraph above, we modified the model description to read:</p><p>“We consider a model of multicellular groups composed of clonal cells that each invest resources into viability and fecundity. Because there is no within-group genetic variation, within-group evolution is not possible, though selection can act on group-level fitness differences. Specifically, we consider the pattern of cellular investment in fecundity and viability, and their sharing of these resources with neighboring cells within the group, to be the result of a heritable developmental program. Thus, selection is able to act on the multicellular fitness consequences of different patterns of cellular behavior within the group.”</p><p>We modified the simulation description to read:</p><p>“These simulations begin with no resource sharing (i.e., 𝛽 = 0); during every round, each group in the population has a 2% chance that a mutation will impact its developmental program, and the 𝛽 value for one of its cells will change.”</p><disp-quote content-type="editor-comment"><p>2) Related to the previous point, there seems to be a tension between, on the one hand, the claim that a concave function can lead to an increase in reproductive specialization, and on the other hand, claims that it has something to do with fitness. Fitness is about expected values, and in a situation of concave function, two or more cells specializing would yield a lower collective fitness than when not specializing. From a purely analytical point of view (i.e., Fisher's fundamental theorem), this seems impossible. So my question to the authors is whether there is not hidden somewhere a convex function, which is the relevant one for the evolutionary dynamics observed. Otherwise, what is the ecological explanation of such a result? There must be some ecological constraints that give rise to this phenomenon, and it would be good to know what the authors think they are.</p></disp-quote><p>Thank you again for this question. We believe the reviewers have found a very important point that lacked clarity in the previous version of our manuscript. We appreciate the deep question regarding the presence of a hidden convexity. To be frank, we were surprised by this result at first as well. However, this surprise stems from the fact that the mathematical rule connecting specialization and the second derivative of the return on investment (ROI) function does not apply to asymmetric trade on sparse networks.</p><p>The following response explains the logic underlying this result and shows why there are no hidden convexities in our model. We apologize for its length, but since it is central to the paper we wanted to make the math absolutely clear.</p><p>In our model we make the simple assumption that group fitness is directly proportional to the sum of cellular productivity (each cell’s 𝑣 ∗ 𝑏) within the group. We see this as having the simplest biological interpretation, groups that generate a larger number of cells can make more progeny (i.e., more groups), all else equal. As a result, while holding the number of cells per group constant, the group with the highest fitness will be composed of cells with the highest average fitness.</p><p>To understand why a hidden convexity need not be present here, we will first discuss the mathematical rule that typically connects specialization and the second derivative of the ROI function: Jensen’s inequality. Jensen’s inequality states that for a convex function F(x), the average value of 𝐹(𝑥), ⟨𝐹(𝑥)⟩, is larger than 𝐹(⟨𝑥⟩), where ⟨𝑥⟩ is the average value of 𝑥. In other words, ⟨𝐹(𝑥)⟩ &gt; 𝐹(⟨𝑥⟩). A corollary of Jensen’s inequality is that the opposite is true for concave functions, i.e., for a concave function 𝐺(𝑥), ⟨𝐺(𝑥)⟩ &lt; 𝐺(⟨𝑥⟩). We assume this is the rule the reviewers refer to when they say “in a situation of concave function, two or more cells specializing would yield a lower collective fitness than when not specializing.”</p><p>For the traditional case of fully connected topologies and symmetric sharing, Jensen’s inequality provides a mathematical connection between a group’s fitness and its degree of specialization. With fully connected topologies, each cell shares its returns on 𝑣 and 𝑏 equally with all cells. As a result, all cells end up with 𝑣 equal to the average 𝑣 and 𝑏 equal to the average 𝑏. As a result, each cell’s 𝑣 ∗ 𝑏 is thus the average of 𝑣 multiplied by the average of 𝑏. Thus, group fitness is directly proportional to average 𝑣 and average 𝑏. Jensen’s inequality guarantees that for convex ROI functions, the average v produced by specialists (⟨𝐹(𝑥)⟩) is higher than the average 𝑣 produced by generalists (𝐹(⟨𝑥⟩)). The same is true for 𝑏. Since specialists must have larger average 𝑣 and 𝑏 than generalists, group fitness must be higher as well. The same argument holds in reverse for concave functions, i.e., if the ROI function is concave, the average 𝑣 and average 𝑏 are lower for specialists than for generalists so group fitness is lower, too. Thus, for fully connected topologies and symmetric sharing, Jensen’s inequality allows one to connect group fitness to average 𝑣 and average 𝑏.</p><p>Crucially, however, the connection between ROI convexity/concavity and fitness is indirect. Jensen’s inequality directly relates the degree of specialization to the average 𝑣 and average 𝑏; Jensen’s inequality does not itself say anything about group fitness. Group fitness is proportional to the average of the product 𝑣 ∗ 𝑏, which does not have to be directly proportional to average 𝑣 or average 𝑏 (even though for fully connected topologies and symmetric sharing ⟨𝑣𝑏⟩ is directly proportional to ⟨𝑣⟩ and ⟨𝑏⟩).</p><p>That Jensen’s inequality connects the degree of specialization to average 𝑣 and average 𝑏, but not group fitness is a crucial distinction. Jensen’s inequality is a mathematical truism, and cannot be violated. Indeed, for any concave ROI function, generalists will produce more 𝑣 and 𝑏 than specialists. This fact is just as true for sparse topologies and asymmetric sharing as it is for fully connected topologies and symmetric sharing. However, for sparse topologies and asymmetric sharing, group fitness is not directly proportional to average 𝑣 and average 𝑏; instead, group fitness strongly depends on network structure as well.</p><p>To understand how group fitness decouples from average 𝑣 and average 𝑏 for sparse topologies and asymmetric sharing, consider a ring of four cells in three different configurations: one that alternates between viability and fecundity specialists, one in which like-specialists are connected to each other, and one in which all cells are generalists (pictured in <xref ref-type="fig" rid="sa2fig1">Author response image 1</xref>; red cells are viability specialists, blue cells are fecundity specialists, and purple cells are generalists). For simplicity, we will set 𝛽 = 1, and we will initially consider the case when 𝛼 = 1. When 𝛼 = 1, Jensen’s inequality tells us that generalists and specialists will be equally productive. Classically, this would suggest that specialists and generalists should have the same fitness.</p><fig id="sa2fig1"><label>Author response image 1.</label><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54348-resp-fig1-v2.tif"/></fig><p>And, indeed, all three cases have the same average 𝑣 and the same average 𝑏 (½ for each). However, the group fitnesses are all different. Note, depending on the configuration, ⟨𝑣⟩⟨𝑏⟩ can be greater than, less than, or equal to ⟨𝑣𝑏⟩.Next, we consider the same three configurations, but with 𝛼 = 0.9. Jensen’s inequality tells us that for this value of 𝛼, generalists should have a higher average 𝑣 and average 𝑏. Indeed, the average 𝑣 and 𝑏 is higher for generalists than for specialists: 0.536 versus 0.5. However, the group fitness of generalists, 1.15, is still lower than the group fitness of alternating specialists (i.e., leftmost configuration in the schematic in <xref ref-type="fig" rid="sa2fig1">Author response image 1</xref>), 1.333.</p><p>These examples show that Jensen’s inequality still holds, and still correctly tells us which configuration has the highest average 𝑣 and average 𝑏. However, average 𝑣 and average 𝑏 are no longer directly proportional to group fitness. Therefore, Jensen’s inequality does not directly inform group fitness, and we should not expect convex ROI functions to be required for specialists to be favored.</p><p>Ultimately, the difference between the classic fully connected topologies and the asymmetric sharing / sparse topologies we consider is the ability of viability specialists to preferentially share viability to fecundity specialists. In fully connected topologies, some of the potential benefit from specialization is wasted. Consider the case where viability specialists share viability with other viability specialists: this is entirely unhelpful, two viability specialists (with 0 fecundity) that help each other survive still both have zero fitness. When the return on investment function is linear (and the graph is fully connected), the effect of sharing with the same cell type (as opposed to a complementary cell type) exactly cancels out the benefits of specializing; trade is only beneficial once the return on investment function becomes convex. In this case, specialists make enough extra <italic>v</italic> and <italic>b</italic> that groups of specialists do better than groups of generalists.</p><p>Again, these results were surprising. To help establish intuition for the role of preferentially connecting unlike specialists, we developed a mean field model. Based on the average number of connections per cell, this model determines the fraction of connections that must be between unlike specialists for the network to support specialization with concave ROI. We find that if unlike specialists are preferentially connected, specialization despite concave ROI should be expected for a wide range of networks. These results are similar to our simulations of randomly generated graphs (see Figure 3 in the main text), in which we also observed specialization for a wide range of parameters. Combined, these observations suggest that specialization, despite concave ROI, does not require precisely designed topologies, but is a general principle applicable to many different network structures. We agree that this was not clear in the original manuscript, and have added this model to the main text as described below.</p><p>We added Discussion paragraphs on Jensen’s inequality:</p><p>“To understand how specialization can be favored despite concave return on investment (ROI) curves, consider Jensen’s inequality. […] With asymmetric sharing and sparse topologies, Jensen’s inequality still informs the average viability and fecundity produced, but does not directly inform the group fitness.”</p><p>We also added a mean field model to help the reader develop intuition for these results:</p><p>“Mean field model</p><p>Finally, to capture some general principles underlying this phenomenon, we consider a mean-field model with &lt;inline-graphic mime-subtype=&quot;png&quot; mimetype=&quot;image&quot; xlink:href=&quot;media/image1.png&quot; /&gt; cells, each of which is connected to &lt;inline-graphic mime-subtype=&quot;png&quot; mimetype=&quot;image&quot; xlink:href=&quot;media/image2.png&quot; /&gt; other cells. […]However, this inequality presents a useful heuristic which can be used to determine if specialization is favored by measuring just a few properties of the graph.”</p><p>We also added a Discussion paragraph on directed/wasted effort:</p><p>“Finally, we note that the primary benefit of sparsity is that sparse networks are likely to be at least somewhat bipartite. The more bipartite-like a network is, the less effort is wasted, and the easier it is for specialization to be favored.”</p><p>Finally we added a section on the four cell network:</p><p>“Jensen's inequality and sparse topologies and asymmetric sharing</p><p>To understand how average fitness decouples from average 𝑣 and average 𝑏 for sparse topologies and asymmetric sharing, consider a ring of four cells in three different configurations: one that alternates between viability and fecundity specialists, one in which like-specialists are connected to each other, and one in which all cells are generalists. […] Therefore, Jensen’s inequality does not directly inform average fitness, and we should not expect convex ROI functions to be required for specialists to be favored.”</p><disp-quote content-type="editor-comment"><p>3) There are well-known cases presented in the population genetics literature in which Fisher's fundamental theorem seems violated, but this is because of the environment (including the social environment) changes over time, such as frequency-dependent effects on an individual's success. We wonder if the results of the authors could not related to this literature in some way.</p></disp-quote><p>This question seems to be related to the central issue raised above – is there a hidden feature in the model that makes specialization beneficial <italic>despite</italic> a concave investment function (i.e., by adding convexity somewhere or introducing some frequency-dependent or environmental effect)? Above, we explained the logic of why specialization can be favored despite concave investment functions.</p><p>Also, to be clear, we don’t see our work as violating Fisher’s fundamental theorem, which states that selection will increase the mean fitness of a population at a rate proportional to the genetic variation in fitness in the population. Because our groups are clonal, all the genetic variation in our population occurs between groups, not within groups, and selection is acting only on group-level fitness. Thus, Fisher’s fundamental theorem is at a limit within groups (as there is no within-group genetic variation, there is no within-group evolution).</p><disp-quote content-type="editor-comment"><p>4) The model description is a bit abstract and occasionally hard to follow. It would be great to have fecundity and viability defined, and even better to have some real biological example of what returns on viability might mean and how they might be shared (I don't find the filamentous fungi example informative, at least not in the way it is written). That would also help the reader understand why there are returns on viability but not on fecundity. That the v<sub>i</sub> vector is the &quot;group investment strategy&quot; also comes as a surprise and takes a bit for the reader to put it all together. Similarly, the existence of both a general adjancecy matrix and of a special case one that uses the <italic>β</italic>, is somewhat confusing the way it's described. If the authors anyway only work with the special case of equal sharing with the non-self neighbors then why not define the 1-<italic>β</italic>+<italic>β</italic>/ni quantities as c<sub>ij</sub> when they appear in the text, and then write a fourth eqn for W in [1] that explicitly uses the <italic>β</italic>. That would certainly help the reader a lot.</p></disp-quote><p>These are great points, and we agree that it is crucial that the model and its biological meaning are clear to the reader.</p><p>The dichotomy of viability vs. fecundity was originally used by Michod to partition components of cellular fitness into actions that contribute to keeping a cell alive (viability), and actions that directly contribute to reproduction (fecundity). The intuition underlying this is that multicellular organisms often have evolved to divide labor along these two lines (i.e., reproduction of the organism by germ cells and survival provided by somatic cells), while their unicellular ancestors had to do both. We define viability as an activity (Michod uses the term “effort”) that keeps the cell alive (e.g., investing in cellular homeostasis or behaviors that improve survival), and fecundity more narrowly as effort involved in cellular reproduction itself. At the cellular level, there appears to be a fundamental asymmetry in how viability effort and fecundity effort can be shared among cells: while multicellular organisms readily evolve differentiated cells that are completely reliant on helper cells for survival (i.e., glial cells that support neurons in animals or companion cells that support sieve tube cells in plants), no cell can directly share its ability to reproduce. To better understand the intuition behind this, consider a cell that elongates prior to fission. This cell must grow to approximately twice its original length. Two cells cannot elongate by 50% and then combine their efforts; elongation is an intrinsically single cell effort.</p><p>While we believe this was also Michod’s interpretation of “reproductive effort”, this concept, like many in biology, is subject to interpretation. While it is clear the cellular behaviors underlying replication cannot be shared, resources required for reproduction could have been provided by another cell. Fortunately, our main conclusions are general and can accommodate various definitions of reproductive effort, which include sharing. While we present the simplest case (no sharing of reproductive effort) to help explain our paper’s central idea as clearly as possible, we do not need to forbid sharing of reproductive effort in order for specialization to evolve with concave ROI functions. As long as there is a significant asymmetry in how much 𝑣 and 𝑏 are shared, specialization with concave ROI functions will evolve. We explore this generalization in Figure 2. Because much of the effort involved in reproduction is, by its nature, unshareable, we believe that asymmetry in sharing between 𝑣 and 𝑏 is a general feature of multicellular systems. Of course, our results are far more general than the evolution of multicellularity, and should apply to many systems in which entities trade along networks (biological, economic, etc.). We have updated the description in the text of how cells can share viability, illustrating the general point with additional examples.</p><p>Finally, we have updated our description of the model to clarify the roles of 𝛽 and 𝑐<sub>𝑖𝑗</sub>.</p><p>We modified the “Model” section to read:</p><p>“Reproductive specialization can be modeled as the separation of two key fitness parameters, those related to either viability or fecundity, into separate cells within the multicellular organism (13,35). […]Thus, selection is able to act on the multicellular fitness consequences of different patterns of cellular behavior within the group.”</p><p>And added clarifying statements like:</p><p>“In other words, 𝑐<sub>𝑖𝑖</sub> = 1 − 𝛽, 𝑐<sub>𝑖𝑗</sub> = 𝛽/𝑛<sub>𝑖</sub> if cells 𝑖 and 𝑗 are connected, and 𝑐<sub>𝑖𝑗</sub> = 0 if cells 𝑖 and 𝑗 are not connected.”</p><disp-quote content-type="editor-comment"><p>5) Results subsection “Fixed resource sharing” first paragraph, we may be getting confused, but how can you vary <italic>β</italic> in the case when, as is now written, individual i &quot;shares equally among interaction and self terms&quot;? Doesn't this mean that <italic>β</italic> = 1?</p></disp-quote><p>We do not allow cells to give all of their viability returns away, as this would result in cells that are not viable. Cells keep (1 − 𝛽) of their viability returns, and designate <italic>β</italic> of their viability returns for sharing. They then split their viability returns designated for sharing into 𝑁 + 1 equally sized portions, give one portion to each of their 𝑁 neighbors, and keep one portion for themselves. In other words, the <italic>β</italic> portion that is designated “for sharing” is not all given away, but is split equally among the connected cells and the cell itself. We have updated the explanation accordingly.</p><p>We removed the sentence “Individual 𝑖 shares 𝑣<sub>𝑖</sub><sup>𝛼</sup> equally among interaction and self terms.” that was on line 146. The model was explained in the previous section, so this statement was ultimately redundant and unclear. Instead, we modified the model explanation to read:</p><p>“Cells cannot give away all of their viability returns, as they would no longer be viable; mathematically, we count a cell among its neighbors and thus ensure that they always “share” a positive portion of viability returns with themselves, so that 𝑐<sub>𝑖𝑖</sub> &gt; 0.”</p><p>And</p><p>“…and when 𝛽 = 1 cells share everything equally among all connections and themselves.”</p><disp-quote content-type="editor-comment"><p>6) “We conjecture that the troughs in Figure 3C, where specialization occurs for the lowest values of, occur when connectivity is just large enough so that a spanning tree is more likely to connect all individuals in the group than not”, we don't fully understand that conjecture: do the authors simply mean that the troughs occur when the random graph becomes connected with probability &gt; 50%? (A spanning tree connects all individuals by definition.)</p></disp-quote><p>The reviewers are correct that a spanning tree connects all individuals. We were attempting to state this fact using technical language that would be clear to experts (50% probability that a spanning tree was present) as well as with more general language accessible to non-experts (50% probability that all individuals connected). We have updated this statement to be clear to all.</p><p>We modified this statement to read:</p><p>“We conjecture that the troughs in Figure 3B, where specialization occurs for the lowest values of 𝛼, occur when connectivity is just large enough so that the existence of a spanning tree is more likely than not.”</p><disp-quote content-type="editor-comment"><p>7) The authors suggest sparsity is the main determinant of whether a network supports reproductive specialization. But, their examples in 1B and 1C (where a ring is sparser than the bipartite network) to us suggest that it is not so much about &quot;sparsity&quot; as it is about &quot;bipartiteness&quot; – or how easy it is to subdivide the nodes into two classes such that most edges go between these two classes (that's what you'd want for specialization anyway, we guess), and that sparse graphs simply have a tendency to be close to bipartite. We suspect that a ring graph with an odd number of vertices will be less conducive to specialization (although you could still alternate germ/soma cells except at one point), and that a star graph where there is one node of degree n-1 and all the others have degree 1 may be an example of a sparse graph where evolving specialization is not so easy (because for this graph it's not clear how to divide the vertices into germ and soma).</p></disp-quote><p>Thank you for this point, with which we largely agree; “bipartiteness” is more important than sparsity. Sparsity is important for two reasons. First, as the reviewers suggest, sparse graphs tend to be close to bipartite. Second, sparse topologies are common in nature. Thus, sparsity may be a common natural route to being somewhat close to bipartite. We have modified the text to make this point clear. However, as will be highlighted by our discussion below, additional features of the graph, such as connectivity, can play a role in determining if specialization is favored as well.</p><p>We also appreciate the star graph suggestion, which is a very interesting topology. This graph is also relevant to understanding the evolution of asymmetric investment in germ and somatic cells, as is common in among independently-evolved multicellular organisms, like animals, plants, and volvocine green algae. Hopefully after clarifying our model in response to previous questions it is now clear that the star graph can strongly favor specialization. We now work this example in detail in the supplement. Briefly, we will discuss a five cell star here.</p><fig id="sa2fig2"><label>Author response image 2.</label><caption><title>Cartoon image generalists (a) and specialists (b) in a five cell star graph topology.</title><p>Wright-Fisher simulations of five cell star topologies for a range of 𝛼 and 𝛽 values.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54348-resp-fig2-v2.tif"/></fig><p>If the central cell were a viability specialist, specialists would have a lower fitness than generalists. However, if the central cell is a fecundity specialist, then the four surrounding viability specialists provide the central cell with enough viability to make this configuration favored. In fact, for large groups (𝑁 &gt; &gt; 1), specialists are always favored – for any 𝛽 and any 𝛼. For the five cell examples shown above, specialists are favored for <italic>α</italic> values as low as 0.222; a heat map relating degree of specialization to 𝛼 and 𝛽 is shown in <xref ref-type="fig" rid="sa2fig3">Author response image 3</xref>.</p><p>Finally, the reviewers are correct about rings with even and odd numbers of cells. The effect is small, but it is true that specialization is frustrated in rings with odd numbers of cells. In fact, we cut a discussion of this phenomenon from our manuscript as we worried that it would be a distraction. However, it is now clear that its absence in fact raises questions, so we have restored it.</p><fig id="sa2fig3"><label>Author response image 3.</label><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54348-resp-fig3-v2.tif"/></fig><p>Here, 𝛼<sup>∗</sup>, the lowest value of 𝛼 for which specialization is favored, is plotted versus the number of cells in the ring, for rings with even and odd numbers of cells.As discussed above, we added a Discussion paragraph that reads:</p><p>“Finally, we note that the primary benefit of sparsity is that sparse networks are likely to be at least somewhat bipartite. The more bipartite-like a network is, the less effort is wasted, and the easier it is for specialization to be favored.”</p><p>We added a section analytically working out when specialists and generalists are favored for star topologies with various N, 𝛼, and 𝛽.</p><p>We added a section discussing even and odd numbered rings.</p><disp-quote content-type="editor-comment"><p>8) Related to the previous point: we would be interested if the authors have considered what happens when the optimal strategy is not 1:1 but, say, 1:2. Does that make specialization more difficult? Here we think that, with a few additional simulations, the authors could add a lot to the paper in terms of the ability to connect properties of the graph (beyond comparing some explicit topologies and random graphs of varying sparsity) to its ability to support the evolution of reproductive specialization.</p></disp-quote><p>Thank you for this interesting suggestion. First, we return to the mean field model introduced in comment 2, but now allow the fraction of fecundity specialists to be 𝑋 (rather than forcing 𝑋 = ½). The model itself is presented in detail in the text changes below; here, we summarize the results.</p><p>Our mean field model suggests that a larger proportion of fecundity specialists makes concave specialization easier to achieve. Further, we find that concave specialization is only possible if more than one fourth of cells are fecundity specialists.</p><p>We stress here that this is a mean field model, and does not apply to scenarios like the star network, in which cells have very different individual values of 𝑧. If such networks do or do not favor specialization for 𝛼 &lt; 1 will again be a graph coloring problem.</p><p>We added a section on varying ratios of specialists:</p><p>“Effect of varying ratios of specialists</p><p>We now allow the fraction of fecundity specialists to be 𝑋 (rather than forcing 𝑋 = 1/2). […] If such networks do or do not favor specialization for 𝛼 &lt; 1 will again be a graph coloring problem.”</p><disp-quote content-type="editor-comment"><p>9) Finally, it would be nice to see how the different specialists are distributed on these networks (at least when the specialization is equal to 1). One can infer it, but we think it would visually help the reader to get the gist of how the model works very quickly.</p></disp-quote><p>We have visualized investment in different tasks on fully connected, ring, and bipartite graphs. We agree that these images are instructive for the reader.</p><p>In <xref ref-type="fig" rid="sa2fig4">Author response image 4</xref> is an image of specialists in a nearest neighbor topology:</p><fig id="sa2fig4"><label>Author response image 4.</label><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54348-resp-fig4-v2.tif"/></fig><p>In <xref ref-type="fig" rid="sa2fig5">Author response image 5</xref> for the bipartite network, complete specialization happens readily:</p><fig id="sa2fig5"><label>Author response image 5.</label><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54348-resp-fig5-v2.tif"/></fig><p><xref ref-type="fig" rid="sa2fig6">Author response image 6</xref> for the complete network, generalists dominate with some fluctuations:</p><fig id="sa2fig6"><label>Author response image 6.</label><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54348-resp-fig6-v2.tif"/></fig><p>We modified Figure 1 to incorporate these images:</p><fig id="sa2fig7"><label>Author response image 7.</label><caption><title>Evolution of resource sharing.</title><p>(<bold>a</bold>) Initially, individuals do not share resources; however, they may evolve to do so via random mutations. Here, the mean specialization of the fittest of 100 groups each with 10 cells after 100,000 steps is plotted as a function of specialization power. Error bars are standard deviations across 10 replicates. Blue is the fully connected network, red is the neighbor network, and green is the balanced bipartite topology. (<bold>b-d</bold>) The final distribution of specialization values for individual cells in fully connected (<bold>b</bold>), nearest-neighbor (<bold>c</bold>), and balanced bipartite topologies (<bold>d</bold>). The color of cells in b-d represents their degree of specialization, as indicated in the scale bar.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54348-resp-fig7-v2.tif"/></fig></body></sub-article></article>