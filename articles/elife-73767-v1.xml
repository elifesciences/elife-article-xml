<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.2"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">73767</article-id><article-id pub-id-type="doi">10.7554/eLife.73767</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Evolutionary Biology</subject></subj-group></article-categories><title-group><article-title>Modeling the spatiotemporal spread of beneficial alleles using ancient genomes</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-252846"><name><surname>Muktupavela</surname><given-names>Rasa A</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-5590-5948</contrib-id><email>rasa.muktupavela@gmail.com</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-253736"><name><surname>Petr</surname><given-names>Martin</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4879-8421</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-253739"><name><surname>Ségurel</surname><given-names>Laure</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7339-0976</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-253740"><name><surname>Korneliussen</surname><given-names>Thorfinn</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-8412"><name><surname>Novembre</surname><given-names>John</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-5345-0214</contrib-id><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund5"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-214108"><name><surname>Racimo</surname><given-names>Fernando</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5025-2607</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund6"/><xref ref-type="other" rid="fund7"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf2"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03hz8wd80</institution-id><institution>Lundbeck GeoGenetics Centre, GLOBE Institute, Faculty of Health</institution></institution-wrap><addr-line><named-content content-type="city">Copenhagen</named-content></addr-line><country>Denmark</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/029brtt94</institution-id><institution>UMR5558 Biométrie et Biologie Evolutive, CNRS - Université Lyon 1</institution></institution-wrap><addr-line><named-content content-type="city">Villeurbanne</named-content></addr-line><country>France</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/024mw5h28</institution-id><institution>Department of Human Genetics, University of Chicago</institution></institution-wrap><addr-line><named-content content-type="city">Chicago</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Andrés</surname><given-names>Aida M</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02jx3x895</institution-id><institution>University College London</institution></institution-wrap><country>United Kingdom</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Perry</surname><given-names>George H</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04p491231</institution-id><institution>Pennsylvania State University</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><pub-date publication-format="electronic" date-type="publication"><day>20</day><month>12</month><year>2022</year></pub-date><pub-date pub-type="collection"><year>2022</year></pub-date><volume>11</volume><elocation-id>e73767</elocation-id><history><date date-type="received" iso-8601-date="2021-09-09"><day>09</day><month>09</month><year>2021</year></date><date date-type="accepted" iso-8601-date="2022-11-21"><day>21</day><month>11</month><year>2022</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at bioRxiv.</event-desc><date date-type="preprint" iso-8601-date="2021-07-22"><day>22</day><month>07</month><year>2021</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2021.07.21.453231"/></event></pub-history><permissions><copyright-statement>© 2022, Muktupavela et al</copyright-statement><copyright-year>2022</copyright-year><copyright-holder>Muktupavela et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-73767-v1.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-73767-figures-v1.pdf"/><abstract><p>Ancient genome sequencing technologies now provide the opportunity to study natural selection in unprecedented detail. Rather than making inferences from indirect footprints left by selection in present-day genomes, we can directly observe whether a given allele was present or absent in a particular region of the world at almost any period of human history within the last 10,000 years. Methods for studying selection using ancient genomes often rely on partitioning individuals into discrete time periods or regions of the world. However, a complete understanding of natural selection requires more nuanced statistical methods which can explicitly model allele frequency changes in a continuum across space and time. Here we introduce a method for inferring the spread of a beneficial allele across a landscape using two-dimensional partial differential equations. Unlike previous approaches, our framework can handle time-stamped ancient samples, as well as genotype likelihoods and pseudohaploid sequences from low-coverage genomes. We apply the method to a panel of published ancient West Eurasian genomes to produce dynamic maps showcasing the inferred spread of candidate beneficial alleles over time and space. We also provide estimates for the strength of selection and diffusion rate for each of these alleles. Finally, we highlight possible avenues of improvement for accurately tracing the spread of beneficial alleles in more complex scenarios.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>ancient DNA</kwd><kwd>lactase persistence</kwd><kwd>evolution</kwd><kwd>natural selection</kwd><kwd>spatiotemporal inference</kwd><kwd>diffusion</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100008398</institution-id><institution>Villum Fonden</institution></institution-wrap></funding-source><award-id>00025300</award-id><principal-award-recipient><name><surname>Muktupavela</surname><given-names>Rasa A</given-names></name><name><surname>Racimo</surname><given-names>Fernando</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003554</institution-id><institution>Lundbeckfonden</institution></institution-wrap></funding-source><award-id>R302-2018-2155</award-id><principal-award-recipient><name><surname>Petr</surname><given-names>Martin</given-names></name><name><surname>Racimo</surname><given-names>Fernando</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100009708</institution-id><institution>Novo Nordisk Fonden</institution></institution-wrap></funding-source><award-id>NNF18SA0035006</award-id><principal-award-recipient><name><surname>Petr</surname><given-names>Martin</given-names></name><name><surname>Racimo</surname><given-names>Fernando</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002808</institution-id><institution>Carlsbergfondet</institution></institution-wrap></funding-source><award-id>CF19-0712</award-id><principal-award-recipient><name><surname>Korneliussen</surname><given-names>Thorfinn</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>R01 GM132383</award-id><principal-award-recipient><name><surname>Novembre</surname><given-names>John</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100009708</institution-id><institution>Novo Nordisk Fonden</institution></institution-wrap></funding-source><award-id>NNF22OC0076816</award-id><principal-award-recipient><name><surname>Racimo</surname><given-names>Fernando</given-names></name></principal-award-recipient></award-group><award-group id="fund7"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000781</institution-id><institution>European Research Council</institution></institution-wrap></funding-source><award-id>951385</award-id><principal-award-recipient><name><surname>Racimo</surname><given-names>Fernando</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A new method for inferring the spatiotemporal dynamics governing the spread of an advantageous mutation using ancient DNA.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Understanding the dynamics of the spread of a beneficial allele through a population is one of the fundamental problems in population genetics (<xref ref-type="bibr" rid="bib24">Ewens, 2012</xref>). We are often interested in knowing the location where an allele first arose and the way in which it spread through a population, but this is often unknown, particularly in natural, non-experimental settings where genetic sampling is scarce and uneven.</p><p>Patterns of genetic variation can be used to estimate how strongly natural selection has affected the trajectory of an allele and to fit the parameters of the selection process. The problem of estimating the age of a beneficial allele, for example, has yielded a rich methodological literature (<xref ref-type="bibr" rid="bib82">Slatkin and Rannala, 2000</xref>), and recent methods have exploited fine-scale haplotype information to produce highly accurate age estimates (<xref ref-type="bibr" rid="bib56">Mathieson and McVean, 2014</xref>; <xref ref-type="bibr" rid="bib71">Platt et al., 2019</xref>; <xref ref-type="bibr" rid="bib1">Albers and McVean, 2020</xref>). In contrast, efforts to infer the geographic origins of beneficial mutations are scarcer. These include <xref ref-type="bibr" rid="bib63">Novembre et al., 2005</xref>, who developed a maximum likelihood method to model the origin and spread of a beneficial mutation and applied it to the <italic>CCR5</italic>-Δ32 allele, which was, at the time, considered to have been under positive selection (<xref ref-type="bibr" rid="bib85">Stephens et al., 1998</xref>; <xref ref-type="bibr" rid="bib78">Sabeti et al., 2005</xref>; <xref ref-type="bibr" rid="bib64">Novembre and Han, 2012</xref>). Similarly, <xref ref-type="bibr" rid="bib40">Itan et al., 2009</xref> developed an approximate Bayesian computation (ABC) approach using demic simulations, in order to find the geographic and temporal origins of a beneficial allele, based on present-day allele frequency patterns.</p><p>As ancient genome sequences become more readily available, they are increasingly being used to understand the process of natural selection (see reviews in <xref ref-type="bibr" rid="bib52">Malaspinas et al., 2012</xref>; <xref ref-type="bibr" rid="bib20">Dehasque et al., 2020</xref>). However, few studies have used ancient genomes to fit spatial dynamic models of the spread of an allele over a landscape. Most spatiotemporal analyses that included ancient genomes have used descriptive modeling in order to learn the spatiotemporal covariance structure of allele frequencies (<xref ref-type="bibr" rid="bib81">Segurel et al., 2020</xref>) or hidden ancestry clusters (<xref ref-type="bibr" rid="bib74">Racimo et al., 2020b</xref>), and then used that structure to hindcast these patterns onto a continuous temporally evolving landscape. In contrast to descriptive approaches, dynamic models have the power to infer interpretable parameters from genomic data and perhaps reveal the ultimate causes for these patterns (<xref ref-type="bibr" rid="bib90">Wikle et al., 2019</xref>).</p><p>Dynamic models can also contribute to ongoing debates about the past trajectories of phenotypically important loci. For example, the geographic origin of the rs4988235(T) allele—upstream of the <italic>LCT</italic> gene and associated with adult lactase persistence in most of Western Eurasia (<xref ref-type="bibr" rid="bib22">Enattah et al., 2002</xref>)—remains elusive, as is the way in which it spread (an extensive review can be found in <xref ref-type="bibr" rid="bib80">Ségurel and Bon, 2017</xref>). The allele has been found in different populations, with frequencies ranging from 5% up to almost 100%, and its selection coefficient has been estimated to be among the highest in human populations (<xref ref-type="bibr" rid="bib6">Bersaglieri et al., 2004</xref>; <xref ref-type="bibr" rid="bib23">Enattah et al., 2008</xref>; <xref ref-type="bibr" rid="bib88">Tishkoff et al., 2007</xref>). However, the exact causes for its adaptive advantage are contested (<xref ref-type="bibr" rid="bib87">Szpak et al., 2019</xref>), and it has been suggested that the selection pressures acting on the allele may have been different in different parts of the continent (<xref ref-type="bibr" rid="bib29">Gerbault et al., 2009</xref>). Ancient DNA evidence shows that the allele was rare in Europe during the Neolithic (<xref ref-type="bibr" rid="bib11">Burger et al., 2007</xref>; <xref ref-type="bibr" rid="bib28">Gamba et al., 2014</xref>; <xref ref-type="bibr" rid="bib2">Allentoft et al., 2015</xref>; <xref ref-type="bibr" rid="bib57">Mathieson et al., 2015</xref>) and only became common in Northern Europe after the Iron Age, suggesting a rise in frequency during this period, perhaps mediated by gene flow from regions east of the Baltic where this allele was more common during the onset of the Bronze Age (<xref ref-type="bibr" rid="bib47">Krüttli et al., 2014</xref>; <xref ref-type="bibr" rid="bib55">Margaryan et al., 2020</xref>). <xref ref-type="bibr" rid="bib40">Itan et al., 2009</xref> deployed their ABC approach to model the spatial spread of the rs4988235(T) allele and estimated that it was first under selection among farmers around 7500 years ago possibly between the Central Balkans and Central Europe. Others have postulated a steppe origin for the allele (<xref ref-type="bibr" rid="bib2">Allentoft et al., 2015</xref>), given that the rise in frequency appears to have occurred during and after the Bronze Age migration of steppe peoples into Western Eurasia (<xref ref-type="bibr" rid="bib31">Haak et al., 2015</xref>; <xref ref-type="bibr" rid="bib2">Allentoft et al., 2015</xref>). However, the allele is at low frequency in genomes of Bronze Age individuals associated with Corded Ware and Bell Beaker assemblages in Central Europe who have high steppe ancestry (<xref ref-type="bibr" rid="bib57">Mathieson et al., 2015</xref>; <xref ref-type="bibr" rid="bib55">Margaryan et al., 2020</xref>), complicating the story further (<xref ref-type="bibr" rid="bib80">Ségurel and Bon, 2017</xref>).</p><p>The origins and spread dynamics of large-effect pigmentation-associated SNPs in ancient Eurasians have also been intensely studied (<xref ref-type="bibr" rid="bib42">Ju and Mathieson, 2020</xref>). Major loci of large effect on skin, eye, and hair pigmentation have been documented as having been under recent positive selection in Western Eurasian history (<xref ref-type="bibr" rid="bib89">Voight et al., 2006</xref>; <xref ref-type="bibr" rid="bib79">Sabeti et al., 2007</xref>; <xref ref-type="bibr" rid="bib70">Pickrell et al., 2009</xref>; <xref ref-type="bibr" rid="bib48">Lao et al., 2007</xref>; <xref ref-type="bibr" rid="bib57">Mathieson et al., 2015</xref>; <xref ref-type="bibr" rid="bib3">Alonso et al., 2008</xref>; <xref ref-type="bibr" rid="bib38">Hudjashov et al., 2013</xref>). These include genes <italic>SLC45A2</italic>, <italic>OCA2</italic>, <italic>HERC2</italic>, <italic>SLC24A5,</italic> and <italic>TYR</italic>. While there is extensive evidence supporting the adaptive significance of these alleles, debates around their exact origins and spread are largely driven by comparisons of allele frequency estimates in population groups, which are almost always discretized in time and/or space. Among these, selection at the <italic>TYR</italic> locus is thought to have occurred particularly recently, over the last 5000 years (<xref ref-type="bibr" rid="bib86">Stern et al., 2019</xref>), driven by a recent mutation (<xref ref-type="bibr" rid="bib1">Albers and McVean, 2020</xref>) that may have spread rapidly in Western Eurasia.</p><p>Here, we develop a method to model the spread of a recently selected allele across both space and time, avoiding artificial discretization schemes to more rigorously assess the evidence for or against a particular dispersal process. We begin with the model proposed by <xref ref-type="bibr" rid="bib63">Novembre et al., 2005</xref> and adapt it in order to handle ancient low-coverage genomic data and explore more complex models that allow for both diffusion and advection (i.e., directional transport) in the distribution of allele frequencies over space, as well as for a change in these parameters at different periods of time. We apply the method to alleles in two of the aforementioned loci in the human genome, which have been reported to have strong evidence for recent positive selection: <italic>LCT/MCM6</italic> and <italic>TYR</italic>. We focus on Western Eurasia during the Holocene, where ancient genomes are most densely sampled, and infer parameters relevant to the spread of these alleles, including selection, diffusion and advection coefficients.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Summary of model</title><p>We based our statistical inference framework on a model proposed by <xref ref-type="bibr" rid="bib63">Novembre et al., 2005</xref> to fit allele frequencies in two dimensions to present-day genotype data spread over a densely sampled map. We extend this model in several ways:</p><list list-type="bullet"><list-item><p>We incorporate temporally sampled data (ancient genomes) to better resolve changes in frequency distributions over time.</p></list-item><list-item><p>We make use of genotype likelihoods and pseudohaploid genotypes to incorporate low-coverage data into the inference framework.</p></list-item><list-item><p>We permit more general dynamics by including advection parameters.</p></list-item><list-item><p>We allow the selection, advection, and diffusion parameters to be different in different periods of time. Specifically, to reflect changes in population dynamics and mobility before and after the Bronze Age (<xref ref-type="bibr" rid="bib51">Loog et al., 2017</xref>; <xref ref-type="bibr" rid="bib73">Racimo et al., 2020a</xref>), we partitioned the model fit into two time periods: before and after 5000 years BP.</p></list-item></list><p>We explored the performance of two different spread models, which are extensions of the original model by <xref ref-type="bibr" rid="bib63">Novembre et al., 2005</xref>, hereby called model A. This is a diffusion model containing a selection coefficient <inline-formula><mml:math id="inf1"><mml:mi>s</mml:mi></mml:math></inline-formula> (determining the rate of local allele frequency growth) and a single diffusion term (<inline-formula><mml:math id="inf2"><mml:mi>σ</mml:mi></mml:math></inline-formula>). A more general diffusion model—hereby model B—allows for two distinct diffusion parameters for latitudinal (<inline-formula><mml:math id="inf3"><mml:msub><mml:mi>σ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula>) and longitudinal (<inline-formula><mml:math id="inf4"><mml:msub><mml:mi>σ</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula>) spread. Finally, model C is even more general and includes two advection terms (<italic>v</italic><sub><italic>x</italic></sub> and <italic>v</italic><sub><italic>y</italic></sub>), allowing the center of mass of the allele’s frequency to diverge from its origin over time. The incorporation of advection is meant to account for the fact that population displacements and expansions could have led to allele frequency dynamics that are poorly explained by diffusion alone.</p><p>In order to establish a starting time point for our diffusion process, we used previously published allele age estimates obtained from a nonparametric approach leveraging the patterns of haplotype concordance and discordance around the mutation of interest (<xref ref-type="bibr" rid="bib1">Albers and McVean, 2020</xref>). In the case of the allele in the <italic>LCT/MCM6</italic> region, we also used age estimates based on an approximate Bayesian computation approach (<xref ref-type="bibr" rid="bib40">Itan et al., 2009</xref>).</p></sec><sec id="s2-2"><title>Performance on deterministic simulations</title><p>To characterize the accuracy of our inference method under different parameter choices, we first generated deterministic simulations from several types of diffusion models. First, we produced an allele frequency surface map with a specified set of parameters from which we drew 1040 samples matching the ages, locations, and genotype calling format (diploid vs. pseudohaploid) of the 1040 genomes that we analyze below when studying the rs1042602(A) allele.</p><p>We generated six different simulations with different diffusion coefficients and afterward ran our method assuming model B. The results (simulations B1−B6) are summarized in <xref ref-type="fig" rid="fig1">Figure 1</xref>, <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplements 1</xref>–<xref ref-type="fig" rid="fig1s5">5</xref>, and <xref ref-type="table" rid="app2table1">Appendix 2—table 1</xref>. Overall, the model is more accurate at correctly inferring the parameters for the time period before 5000 years BP (<xref ref-type="fig" rid="fig1">Figure 1b</xref>), with decreased performance when longitudinal diffusion is high (<xref ref-type="fig" rid="fig1s5">Figure 1—figure supplement 5</xref>).</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Comparison of true and inferred allele frequency dynamics for simulation B5.</title><p>(<bold>a</bold>) Comparison of true and inferred allele frequency dynamics for a simulation with diffusion and no advection (B5). The green dot corresponds to the origin of the allele. The parameter values used to generate the frequency surface maps are summarized in <xref ref-type="table" rid="app2table1">Appendix 2—table 1</xref>. (<bold>b</bold>) Comparison of true parameter values and model estimates. Whiskers represent 95% confidence intervals.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig1-v1.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Comparison of true and inferred allele frequency dynamics for simulation B1.</title><p>(<bold>a</bold>) Comparison of true and inferred allele frequency dynamics for simulation B1. The green dot corresponds to the origin of the allele. The parameter values used to generate the frequency surface maps are summarized in <xref ref-type="table" rid="app2table1">Appendix 2—table 1</xref>. (<bold>b</bold>) Comparison of true parameter values and model estimates. Whiskers represent 95% confidence intervals.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig1-figsupp1-v1.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 2.</label><caption><title>Comparison of true and inferred allele frequency dynamics for simulation B2.</title><p>(<bold>a</bold>) Comparison of true and inferred allele frequency dynamics for simulation B2. The green dot corresponds to the origin of the allele. The parameter values used to generate the frequency surface maps are summarized in <xref ref-type="table" rid="app2table1">Appendix 2—table 1</xref>. (<bold>b</bold>) Comparison of true parameter values and model estimates. Whiskers represent 95% confidence intervals.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig1-figsupp2-v1.tif"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 3.</label><caption><title>Comparison of true and inferred allele frequency dynamics for simulation B3.</title><p>(<bold>a</bold>) Comparison of true and inferred allele frequency dynamics for simulation B3. The green dot corresponds to the origin of the allele. The parameter values used to generate the frequency surface maps are summarized in <xref ref-type="table" rid="app2table1">Appendix 2—table 1</xref>. (<bold>b</bold>) Comparison of true parameter values and model estimates. Whiskers represent 95% confidence intervals.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig1-figsupp3-v1.tif"/></fig><fig id="fig1s4" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 4.</label><caption><title>Comparison of true and inferred allele frequency dynamics for simulation B4.</title><p>(<bold>a</bold>) Comparison of true and inferred allele frequency dynamics for simulation B4. The green dot corresponds to the origin of the allele. The parameter values used to generate the frequency surface maps are summarized in <xref ref-type="table" rid="app2table1">Appendix 2—table 1</xref>. (<bold>b</bold>) Comparison of true parameter values and model estimates. Whiskers represent 95% confidence intervals.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig1-figsupp4-v1.tif"/></fig><fig id="fig1s5" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 5.</label><caption><title>Comparison of true and inferred allele frequency dynamics for simulation B6.</title><p>(<bold>a</bold>) Comparison of true and inferred allele frequency dynamics for simulation B6. The green dot corresponds to the origin of the allele. The parameter values used to generate the frequency surface maps are summarized in <xref ref-type="table" rid="app2table1">Appendix 2—table 1</xref>. (<bold>b</bold>) Comparison of true parameter values and model estimates. Whiskers represent 95% confidence intervals.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig1-figsupp5-v1.tif"/></fig><fig id="fig1s6" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 6.</label><caption><title>Comparison of true allele frequency dynamics for simulation B1 and those inferred by the model C.</title><p>(<bold>a</bold>) Comparison of true allele frequency dynamics for simulation B1 and those inferred by the model C. The green dot shows the origin of the derived allele and the cross represents the location of the first individual that carried it. (<bold>b</bold>) Comparison of true parameter values and model estimates. Whiskers represent 95% confidence intervals.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig1-figsupp6-v1.tif"/></fig><fig id="fig1s7" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 7.</label><caption><title>Comparison of true allele frequency dynamics for simulation B4 and those inferred by the model C.</title><p>(<bold>a</bold>) Comparison of true allele frequency dynamics for simulation B4 and those inferred by the model C. The green dot corresponds to the origin of the allele, and the cross represents the first sample having the derived variant. (<bold>b</bold>) Comparison of true parameter values and model estimates. Whiskers represent 95% confidence intervals.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig1-figsupp7-v1.tif"/></fig></fig-group><p>Next, we investigated the performance of model C, which includes advection coefficients. We generated four different simulations including advection (simulations C1−C4: <xref ref-type="fig" rid="fig2">Figure 2</xref>, <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplements 1</xref>–<xref ref-type="fig" rid="fig1s3">3</xref>, and <xref ref-type="table" rid="app2table2">Appendix 2—table 2</xref>). We found that our method is generally able to estimate the selection coefficient accurately. However, in some of the simulations, we found discrepancies between the estimated and true diffusion and advection coefficients, often occurring because of a misestimated origin forcing the other parameters to adjust in order to better fit the allele frequency distribution in later stages of the allele’s spread (<xref ref-type="fig" rid="fig2">Figure 2</xref>). Despite the disparities between the true and inferred parameter values, the resulting surface plots become very similar as we approach the present, suggesting that different combinations of parameters can produce similar present-day allele frequency distributions.</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Comparison of true and inferred allele frequency dynamics for simulation C4.</title><p>(<bold>a</bold>) Comparison of true and inferred allele frequency dynamics for one of the simulations including advection (C4). The green dot corresponds to the origin of the allele. The parameter values used to generate the frequency surface maps are summarized in <xref ref-type="table" rid="app2table2">Appendix 2—table 2</xref>. (<bold>b</bold>) Comparison of true parameter values and model estimates. Whiskers represent 95% confidence intervals.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig2-v1.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Comparison of true and inferred allele frequency dynamics for simulation C1.</title><p>(<bold>a</bold>) Comparison of true and inferred allele frequency dynamics for one of the simulations including advection (C1). The green dot corresponds to the origin of the allele. The parameter values used to generate the frequency surface maps are summarized in <xref ref-type="table" rid="app2table2">Appendix 2—table 2</xref>. (<bold>b</bold>) Comparison of true parameter values and model estimates. Whiskers represent 95% confidence intervals.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig2-figsupp1-v1.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Comparison of true and inferred allele frequency dynamics for simulation C2.</title><p>(<bold>a</bold>) Comparison of true and inferred allele frequency dynamics for one of the simulations including advection (C2). The green dot corresponds to the origin of the allele. The parameter values used to generate the frequency surface maps are summarized in <xref ref-type="table" rid="app2table2">Appendix 2—table 2</xref>. (<bold>b</bold>) Comparison of true parameter values and model estimates. Whiskers represent 95% confidence intervals.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig2-figsupp2-v1.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 3.</label><caption><title>Comparison of true and inferred allele frequency dynamics for simulation C3.</title><p>(<bold>a</bold>) Comparison of true and inferred allele frequency dynamics for one of the simulations including advection (C3). The green dot corresponds to the origin of the allele. The parameter values used to generate the frequency surface maps are summarized in <xref ref-type="table" rid="app2table2">Appendix 2—table 2</xref>. (<bold>b</bold>) Comparison of true parameter values and model estimates. Whiskers represent 95% confidence intervals.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig2-figsupp3-v1.tif"/></fig></fig-group></sec><sec id="s2-3"><title>Advection model applied to non-advection simulations</title><p>We assessed model performance when we apply model C, which includes advection coefficient estimates, to simulations generated without advection (see <xref ref-type="fig" rid="fig1s6">Figure 1—figure supplements 6</xref> and <xref ref-type="fig" rid="fig1s7">7</xref>). We can observe that the advection coefficients are inferred to be non-zero (<xref ref-type="fig" rid="fig1s6">Figure 1—figure supplements 6b</xref> and <xref ref-type="fig" rid="fig1s7">7b</xref>); however, the inferred allele frequency dynamic plots closely resemble the ones obtained with true parameter values (<xref ref-type="fig" rid="fig1s6">Figure 1—figure supplements 6a</xref> and <xref ref-type="fig" rid="fig1s7">7a</xref>). This shows that complex interactions between the diffusion and advection coefficients can result in similar outcomes even when only diffusion is considered in the model.</p><p>The inference of the origin of the allele also differs when we compare results when using models B and C. In order to understand better how the model estimates the allele origin, we highlighted the first individual in simulations B1 and B4 that contains the derived allele. We can see that in the case of simulation B1 the inferred origin of the allele is close to the first observance of the derived allele in the model that includes advection. In contrast when the advection is not included, the origin of the allele is inferred to be closer to where it is initially rising in frequency (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplements 1a</xref> and <xref ref-type="fig" rid="fig1s4">4a</xref>). However, this is not always the case. For instance, if we look at the results from the advection model on simulation B4, we can see that the origin of the allele is inferred relatively far from the sample known to have carried the first instance of the derived allele. Therefore, if there is a relatively large interval between the time when the allele originated and when the first ancient genomes are available, the beneficial allele can spread widely, but as this spread is not captured by any of the data points, inference of the precise origin of the selected allele is nearly impossible.</p></sec><sec id="s2-4"><title>Impact of sample clustering on parameter estimates</title><p>We evaluated the impact of different sampling and clustering schemes on our inferences that could potentially arise by aggregating aDNA data from studies with different sampling schemes. We used a deterministic simulation to create three different degrees of clustering, which we will refer to as ‘homogeneous,’ ‘intermediate,’ or ‘extreme’ by varying the area from which we sample individuals to be used in our inferences (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). Additionally, we also tested the impact of biased temporal sampling in the periods before and after 5000 years BP by oversampling in the ancient period (75%/25%), equally sampling in the two periods (50%/50%), and oversampling in the recent period (25%/75%). Because we evaluated this temporal bias for each of the three spatial clustering sampling scenarios, this resulted in a total of nine different sampling scenarios. We note that the third ‘extreme’ spatial clustering scenario is completely unrealistic and one would not expect inferences of any degree of accuracy from it, but we believe it gives a good idea of the behavior of our method in the limiting case of extremely restricted spatial sampling.</p><p>A comparison of allele frequency maps generated using true parameter values and using parameter estimates from the different sampling schemes is shown in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplements 2</xref>–<xref ref-type="fig" rid="fig3s9">9</xref>. In <xref ref-type="fig" rid="fig3">Figure 3</xref> we show the allele frequency map generated using the ‘intermediate 75%/25%’ clustering scheme. Parameter estimates used to generate all these figures are summarized in <xref ref-type="table" rid="app2table3">Appendix 2—table 3</xref>. Overall we can see that the allele frequency maps inferred from these scenarios closely resemble the maps generated using the true parameter values, despite the challenges in finding accurate values for the individual point estimates of some of the parameters, highlighting that various combinations of diffusion and advection coefficients can produce similar underlying frequency maps (as discussed in the section ‘Performance on deterministic simulations’). This suggests that the joint spatiotemporal information encoded in the inferred maps (not just the individual parameters estimates) should be used in interpreting model outputs, particularly when it comes to the advection and diffusion parameters. The selection coefficient estimates are inferred highly accurately, regardless of the sampling scheme chosen, and lie close to the true value, with only a slight underestimation in the time period after 5000 years BP (with the exception of the ‘extreme 25%/75%’).</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Comparison of true allele frequency map and map generated using ‘intermediate 75%/25%’ clustering scheme.</title><p>Left: allele frequency map generated using true parameter values. Right: allele frequency map generated using parameter estimates for ‘intermediate 75%/25%’ clustering scheme. Parameter values used to generate the maps are summarized in <xref ref-type="table" rid="app2table3">Appendix 2—table 3</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Examples of spatial sampling scenarios for each of the three clustering schemes.</title><p>We chose five locations and increasingly restricted the area where we allowed the individuals to be sampled. (<bold>a</bold>) Map showing homogeneous sampling scheme in which we did not impose any spatial restrictions of individuals sampled. (<bold>b</bold>) Intermediate sampling scheme with the region restricted to 7° in each cardinal direction from each of the chosen locations. (<bold>c</bold>) Extreme sampling scheme with the sampling region restricted to 2° in each cardinal direction from the chosen locations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig3-figsupp1-v1.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Allele frequency map generated using true parameter values and using parameter estimates for ‘homogeneous 75%/25%’ clustering scheme.</title><p>Left: allele frequency map generated using true parameter values. Right: allele frequency map generated using parameter estimates for ‘homogeneous 75%/25%’ clustering scheme. Parameter values used to generate the maps are summarized in <xref ref-type="table" rid="app2table3">Appendix 2—table 3</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig3-figsupp2-v1.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 3.</label><caption><title>Allele frequency map generated using true parameter values and using parameter estimates for ‘homogeneous 50%/50%’ clustering scheme.</title><p>Left: allele frequency map generated using true parameter values. Right: allele frequency map generated using parameter estimates for ‘homogeneous 50%/50%’ clustering scheme. Parameter values used to generate the maps are summarized in <xref ref-type="table" rid="app2table3">Appendix 2—table 3</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig3-figsupp3-v1.tif"/></fig><fig id="fig3s4" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 4.</label><caption><title>Allele frequency map generated using true parameter values and using parameter estimates for ‘homogeneous 25%/75%’ clustering scheme.</title><p>Left: allele frequency map generated using true parameter values. Right: allele frequency map generated using parameter estimates for ‘homogeneous 25%/75%’ clustering scheme. Parameter values used to generate the maps are summarized in <xref ref-type="table" rid="app2table3">Appendix 2—table 3</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig3-figsupp4-v1.tif"/></fig><fig id="fig3s5" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 5.</label><caption><title>Allele frequency map generated using true parameter values and using parameter estimates for ‘intermediate 50%/50%’ clustering scheme.</title><p>Left: allele frequency map generated using true parameter values. Right: allele frequency map generated using parameter estimates for ‘intermediate 50%/50%’ clustering scheme. Parameter values used to generate the maps are summarzsed in <xref ref-type="table" rid="app2table3">Appendix 2—table 3</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig3-figsupp5-v1.tif"/></fig><fig id="fig3s6" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 6.</label><caption><title>Allele frequency map generated using true parameter values and using parameter estimates for ‘intermediate 25%/75%’ clustering scheme.</title><p>Left: allele frequency map generated using true parameter values. Right: allele frequency map generated using parameter estimates for ‘intermediate 25%/75%’ clustering scheme. Parameter values used to generate the maps are summarized in <xref ref-type="table" rid="app2table3">Appendix 2—table 3</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig3-figsupp6-v1.tif"/></fig><fig id="fig3s7" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 7.</label><caption><title>Allele frequency map generated using true parameter values and using parameter estimates for ‘extreme 75%/25%’ clustering scheme.</title><p>Left: allele frequency map generated using true parameter values. Right: allele frequency map generated using parameter estimates for ‘extreme 75%/25%’ clustering scheme. Parameter values used to generate the maps are summarzsed in <xref ref-type="table" rid="app2table3">Appendix 2—table 3</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig3-figsupp7-v1.tif"/></fig><fig id="fig3s8" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 8.</label><caption><title>Allele frequency map generated using true parameter values and using parameter estimates for ‘extreme 50%/50%’ clustering scheme.</title><p>Left: allele frequency map generated using true parameter values. Right: allele frequency map generated using parameter estimates for ‘extreme 50%/50%’ clustering scheme. Parameter values used to generate the maps are summarized in <xref ref-type="table" rid="app2table3">Appendix 2—table 3</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig3-figsupp8-v1.tif"/></fig><fig id="fig3s9" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 9.</label><caption><title>Allele frequency map generated using true parameter values and using parameter estimates for ‘extreme 25%/75%’ clustering scheme.</title><p>Left: allele frequency map generated using true parameter values. Right: allele frequency map generated using parameter estimates for ‘extreme 25%/75%’ clustering scheme. Parameter values used to generate the maps are summarized in <xref ref-type="table" rid="app2table3">Appendix 2—table 3</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig3-figsupp9-v1.tif"/></fig></fig-group></sec><sec id="s2-5"><title>Spatially explicit forward simulations</title><p>In addition to drawing simulated samples from a diffusion model, we used SLiM (<xref ref-type="bibr" rid="bib33">Haller and Messer, 2019</xref>) to perform spatially explicit individual-based forward-in-time simulations of selection acting on a beneficial allele by leveraging an R interface for spatial population genetics now implemented in the R package <italic>slendr</italic> (<xref ref-type="bibr" rid="bib69">Petr, 2021</xref>).</p><p>We introduced a single beneficial additive mutation in a single individual and let it evolve across the European landscape. Before applying our method on the simulated data, we sampled 1040 individuals whose ages were log-uniformly distributed to ensure that there were more samples closer to the present, as in the real data. We transformed the diploid genotypes to pseudohaploid genotypes by assigning a heterozygous individual an equal probability of carrying the ancestral or the derived genotype. The parameter values estimated by our model to the simulations described in this section are summarized in <xref ref-type="table" rid="app2table4">Appendix 2—table 4</xref>.</p><p>We can see that the origin of the allele inferred by the model closely corresponds to the first observation of the derived allele in the simulation (<xref ref-type="fig" rid="fig4">Figure 4</xref>). The inferred selection coefficient is only slightly higher than the true value from the simulation (0.0366 vs. 0.030). In general, the model accurately captures the spread of the allele centered in Central Europe, though we observe some discrepancies due to differences between the model assumed in the simulation (which, e.g., accounts for local clustering of individuals, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>), and that assumed by our diffusion-based inference.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Comparison of an individual-based simulation and allele frequency dynamics inferred by the diffusion model.</title><p>(<bold>A</bold>) Individual-based simulation of an allele that arose in Central Europe 15,000 years ago with a selection coefficient of 0.03. Each dot represents a genotype from a simulated genome. To avoid overplotting, only 1000 out of the total 20,000 individuals in the simulation in each time point are shown for each genotype category. (<bold>B</bold>) Allele frequency dynamics inferred by the diffusion model on the individual-based simulation to the left, after randomly sampling 1040 individuals from the simulation and performing pseudohaploid genotype sampling on them. The ages of sampled individuals were log-uniformly distributed. The estimated parameter values of the fitted model are shown in <xref ref-type="table" rid="app2table4">Appendix 2—table 4</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig4-v1.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Distribution of individuals across the map under neutrality, showing the tendency of individuals to cluster together.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig4-figsupp1-v1.tif"/></fig></fig-group></sec><sec id="s2-6"><title>Dynamics of the rs4988235(T) allele</title><p>Having tested the performance of our method on simulated data, we set out to infer the allele frequency dynamics of the rs4988235(T) allele (associated with adult lactase persistence) in ancient Western Eurasia. For our analysis, we used a genotype dataset compiled by <xref ref-type="bibr" rid="bib81">Segurel et al., 2020</xref>, which amounts to 1434 genotypes from ancient Eurasian genomes individuals, and a set of 36,659 genotypes from present-day Western and Central Eurasian genomes (Ségurel and Bon, 2017; <xref ref-type="bibr" rid="bib36">Heyer et al., 2011</xref>; <xref ref-type="bibr" rid="bib53">Marchi et al., 2018</xref>; <xref ref-type="bibr" rid="bib50">Liebert et al., 2017</xref>; <xref ref-type="bibr" rid="bib27">Gallego Romero et al., 2012</xref>; <xref ref-type="bibr" rid="bib41">Itan et al., 2010</xref>; <xref ref-type="bibr" rid="bib16">Charati et al., 2019</xref>). After filtering out individuals falling outside of the range of the geographic boundaries considered in this study, we retained 1332 ancient individuals. The locations of ancient and present-day individuals used in the analysis to trace the spread of rs4988235(T) are shown in <xref ref-type="fig" rid="fig5">Figure 5</xref>.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Locations of samples used to model the spread of the rs4988235(T) allele.</title><p>The upper panel shows the spatiotemporal locations of ancient individuals, and the bottom panel represents the locations of present-day individuals.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig5-v1.tif"/></fig><p>We used a two-period scheme by allowing the model to have two sets of estimates for the selection coefficient and the diffusion and advection coefficients in two different periods of time: before and after 5000 years ago, reflecting the change in population dynamics and mobility before and after the Bronze Age transition (<xref ref-type="bibr" rid="bib51">Loog et al., 2017</xref>; <xref ref-type="bibr" rid="bib73">Racimo et al., 2020a</xref>). We used two allele age estimates as input: a relatively young one (7441 years ago) obtained by using the estimated start of selection onset from <xref ref-type="bibr" rid="bib40">Itan et al., 2009</xref> (though we note this is necessarily a lower bound of the age of mutation origin), and a relatively old one (20,106 years ago) obtained from the age estimate from <xref ref-type="bibr" rid="bib1">Albers and McVean, 2020</xref>. The results obtained for fitting the model on rs4988235(T) are summarized in <xref ref-type="table" rid="app2table5">Appendix 2—table 5</xref> and <xref ref-type="table" rid="app2table6">Appendix 2—table 6</xref>, and in <xref ref-type="fig" rid="fig6">Figure 6b</xref> (younger age) and <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref> (older age).</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Allele frequency dynamics of rs4988235(T).</title><p>(<bold>a</bold>) Top: pseudohaploid genotypes of ancient samples at the rs4988235 SNP in different periods. Yellow corresponds to the rs4988235(T) allele. Bottom: allele frequencies of present-day samples represented as pie charts. The size of the pie charts corresponds to the number of available sequences in each region. (<bold>b</bold>) Inferred allele frequency dynamics of rs4988235(T). The green dot indicates the inferred geographic origin of the allele.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig6-v1.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Inferred frequency dynamics of rs4988235(T) using the allele age that was inferred in <xref ref-type="bibr" rid="bib1">Albers and McVean, 2020</xref>.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig6-figsupp1-v1.tif"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 2.</label><caption><title>Inferred frequency dynamics of rs4988235(T) when the origin of the allele is moved 10° west from the original estimate.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig6-figsupp2-v1.tif"/></fig><fig id="fig6s3" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 3.</label><caption><title>Inferred frequency dynamics of rs4988235(T) when the origin of the allele is moved 10° east from the original estimate.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig6-figsupp3-v1.tif"/></fig><fig id="fig6s4" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 4.</label><caption><title>Inferred frequency dynamics of rs4988235(T) when the origin of the allele is moved 10° north from the original estimate.</title><p>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig6-figsupp4-v1.tif"/></fig><fig id="fig6s5" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 5.</label><caption><title>Inferred frequency dynamics of rs4988235(T) when the origin of the allele is moved 10° south from the original estimate.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig6-figsupp5-v1.tif"/></fig><fig id="fig6s6" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 6.</label><caption><title>Inferred frequency dynamics of rs4988235(T) forcing the geographic origin of the allele to be at the location inferred in <xref ref-type="bibr" rid="bib40">Itan et al., 2009</xref>.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig6-figsupp6-v1.tif"/></fig><fig id="fig6s7" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 7.</label><caption><title>Inferred frequency dynamics of rs4988235(T) assuming the allele age to be the lower end of the 95% credible interval for the start of selection onset inferred in <xref ref-type="bibr" rid="bib40">Itan et al., 2009</xref>.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig6-figsupp7-v1.tif"/></fig><fig id="fig6s8" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 8.</label><caption><title>Inferred frequency dynamics of rs4988235(T) assuming the allele age to be the higher end of the 95% credible interval for the start of selection onset inferred in <xref ref-type="bibr" rid="bib40">Itan et al., 2009</xref>.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig6-figsupp8-v1.tif"/></fig><fig id="fig6s9" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 9.</label><caption><title>Log-likelihood values for model runs using different ages of the rs4988235(T) allele as input, with the age inferred by <xref ref-type="bibr" rid="bib40">Itan et al., 2009</xref> we use as fixed input highlighted in red.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig6-figsupp9-v1.tif"/></fig></fig-group><p>Assuming the mutation age estimate is equivalent to the start of selection onset from <xref ref-type="bibr" rid="bib40">Itan et al., 2009</xref>, the origin of the allele is estimated to be north of the Caucasus, around what is now southwestern Russia and eastern Ukraine (<xref ref-type="fig" rid="fig6">Figure 6b</xref>). Given that this age is relatively young, our method fits a very strong selection coefficient (<inline-formula><mml:math id="inf5"><mml:mrow><mml:mi/><mml:mo>≈</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula>) during the first period in order to accommodate the early presence of the allele in various points throughout Eastern Europe, and a weaker (but still strong) selection coefficient (<inline-formula><mml:math id="inf6"><mml:mrow><mml:mi/><mml:mo>≈</mml:mo><mml:mn>0.03</mml:mn></mml:mrow></mml:math></inline-formula>) in the second period. We also estimate stronger diffusion in the second period than in the first, to accommodate the rapid expansion of the allele throughout Western Europe, and a net westward advection parameter, indicating movement of the allele frequency’s center of mass to the west as we approach the present.</p><p>Assuming the older age estimate from <xref ref-type="bibr" rid="bib1">Albers and McVean, 2020</xref>, the origin of the allele is estimated to be in the northeast of Europe (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>), which is at a much higher latitude than the first occurrence of the allele, in Ukraine. Due to the deterministic nature of the model, the frequency is implicitly imposed to expand in a region where there are no actual observed instances of the allele. The model compensates for this by placing the origin in an area with a lower density of available aDNA data and thus avoiding an overlap of the increasing allele frequencies with individuals who do not carry the derived rs4988235(T) allele (see <xref ref-type="fig" rid="fig6">Figure 6a</xref>). As the model expands rapidly in the southern direction (<xref ref-type="table" rid="app2table6">Appendix 2—table 6</xref>) it eventually reaches the sample carrying the derived variant in Ukraine.</p></sec><sec id="s2-7"><title>Dynamics of the rs1042602(A) allele</title><p>Next, we investigated the spatiotemporal dynamics of the spread of an allele at a pigmentation-associated SNP in the <italic>TYR</italic> locus (rs1042602(A)), which has been reported to be under recent selection in Western Eurasian history (<xref ref-type="bibr" rid="bib86">Stern et al., 2019</xref>). For this purpose, we applied our method to the Allen Ancient DNA Resource data (<xref ref-type="bibr" rid="bib77">Reich and Mallick, 2019</xref>), which contains randomly sampled pseudohaploid genotypes from 1513 published ancient Eurasian genomes (listed in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>), from which we extracted those that had genotype information at this locus in Western Eurasia. We merged this dataset with diploid genotype information from high-coverage present-day West Eurasian genomes from the Human Genome Diversity Panel (HGDP) (<xref ref-type="bibr" rid="bib5">Bergström et al., 2020</xref>), which resulted in a total of 1040 individuals with genotype information at rs1042602, which were used as input to our analysis. Geographic locations of individuals in the final dataset are shown in <xref ref-type="fig" rid="fig7">Figure 7</xref>.</p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Spatiotemporal sampling locations of sequences used to model the rs1042602(A) allele in Western Eurasia.</title><p>Upper panel: ancient individuals dated as older than 10,000 years ago. Middle panel: ancient individuals dated as younger than 10,000 years ago. Bottom panel: present-day individuals from the Human Genome Diversity Panel (HGDP).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig7-v1.tif"/></fig><p>Similarly to our analysis of the spread of the allele in rs4988235(T), we inferred the dynamics of the rs1042602(A) allele separately for the time periods before and after 5000 years BP and assuming the age of the allele to be 26,361 years (<xref ref-type="bibr" rid="bib1">Albers and McVean, 2020</xref>). The inferred parameters for both time periods are summarized in <xref ref-type="table" rid="app2table7">Appendix 2—table 7</xref>, and the allele frequency surface maps generated using these parameters are shown in <xref ref-type="fig" rid="fig8">Figure 8b</xref>. The origin of the rs1042602(A) corresponds closely to the region where the allele initially starts to segregate in the time period between 7500 and 10,000 years BP as seen in <xref ref-type="fig" rid="fig8">Figure 8a</xref>. Estimates of the selection coefficient for both time periods (0.0221 and 0.0102 for the period before and after 5000 years BP, respectively) suggest that selection acting on the allele has decreased after 5000 years BP.</p><fig-group><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Allele frequency dynamics of rs1042602(A).</title><p>(<bold>a</bold>) Top: pseudohaploid genotypes of ancient samples of the rs1042602 in different periods. Yellow corresponds to the A allele. Bottom: diploid genotypes of present-day samples. (<bold>b</bold>) Inferred allele frequency dynamics of rs1042602(A). The green dot corresponds to the inferred geographic origin of the allele.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig8-v1.tif"/></fig><fig id="fig8s1" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 1.</label><caption><title>Inferred frequency dynamics of rs1042602(A) when the origin of the allele is moved 10° east from the original estimate.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig8-figsupp1-v1.tif"/></fig><fig id="fig8s2" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 2.</label><caption><title>Inferred frequency dynamics of rs1042602(A) when the origin of the allele is moved 10° north from the original estimate.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig8-figsupp2-v1.tif"/></fig><fig id="fig8s3" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 3.</label><caption><title>Inferred frequency dynamics of rs1042602(A) when the origin of the allele is moved 10° south from the original estimate.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig8-figsupp3-v1.tif"/></fig><fig id="fig8s4" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 4.</label><caption><title>Inferred frequency dynamics of rs1042602(A) assuming the allele age to be the lower end of the 95% confidence interval for the allele age inferred in <xref ref-type="bibr" rid="bib1">Albers and McVean, 2020</xref>.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig8-figsupp4-v1.tif"/></fig><fig id="fig8s5" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 5.</label><caption><title>Frequency dynamics of rs1042602(A) assuming the allele age to be the higher end of the 95% confidence interval for the allele age inferred in <xref ref-type="bibr" rid="bib1">Albers and McVean, 2020</xref>.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig8-figsupp5-v1.tif"/></fig><fig id="fig8s6" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 6.</label><caption><title>Log-likelihood values for model runs using different ages of the rs1042602(A) allele as input, with the age inferred by <xref ref-type="bibr" rid="bib1">Albers and McVean, 2020</xref> we use as fixed input highlighted in red.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-fig8-figsupp6-v1.tif"/></fig></fig-group></sec><sec id="s2-8"><title>Robustness of parameters to the inferred geographic origin of allele</title><p>We carried out an analysis to characterize how sensitive the selection, diffusion, and advection parameters are to changes in the assumed geographic origin of the allele. For the rs4988235(T) allele, we forced the origin of the allele to be 10° away from our inferred origin in each cardinal direction, while assuming the allele age is equal to the inferred start of selection onset from <xref ref-type="bibr" rid="bib40">Itan et al., 2009</xref> (<xref ref-type="table" rid="app2table8">Appendix 2—table 8</xref>). In <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplements 2</xref>–<xref ref-type="fig" rid="fig6s5">5</xref>, we can see the allele frequency dynamics of these four scenarios, respectively. We also forced the allele origin to be at the geographic origin estimated in <xref ref-type="bibr" rid="bib40">Itan et al., 2009</xref> (<xref ref-type="fig" rid="fig6s6">Figure 6—figure supplement 6</xref>, <xref ref-type="table" rid="app2table9">Appendix 2—table 9</xref>), which is westward of our estimate. In all five cases during the period prior 5000 years BP, the allele is inferred to expand in the direction of the first sample that is observed to carry the rs4988235(T) allele and is located in Ukraine. During the time period after 5000 years BP, the patterns produced by the model are rather similar, although the parameters associated with diffusion and advection differ, in order to account for the different starting conditions.</p><p>We also investigated how the results are affected when the estimated geographic origin of the rs1042602(A) allele is moved with respect to the initial estimate. We set the allele to be 10° east, 10° north, and 10° south of the original estimate as shown in <xref ref-type="fig" rid="fig8s1">Figure 8—figure supplements 1</xref>–<xref ref-type="fig" rid="fig8s3">3</xref>, respectively (for parameter estimates see <xref ref-type="table" rid="app2table10">Appendix 2—table 10</xref>). We did not look at a scenario in which the origin of the allele is moved to the west since it would either end up in the Black Sea or more westward than 10°. The selection coefficient remains similar to the original estimate throughout all three scenarios. The way the allele spreads across the landscape is also similar in all cases and, as in the case of rs4988235(T), the model accounts for the different origins of the allele by adjusting the diffusion and advection coefficients in the time period after 5000 years BP.</p></sec><sec id="s2-9"><title>Robustness of parameters to the assumed age of the allele</title><p>In order to investigate how sensitive our inferences are to the point estimates of allele ages we obtained from the literature (<xref ref-type="bibr" rid="bib1">Albers and McVean, 2020</xref>; <xref ref-type="bibr" rid="bib40">Itan et al., 2009</xref>), we also fitted our model using the upper and lower ends of the 95% confidence intervals or credible intervals for each age estimate (depending on whether the inference procedure in the literature was via a maximum likelihood or a Bayesian approach). For the rs4988235(T) allele, the reported credible intervals for the (<xref ref-type="bibr" rid="bib40">Itan et al., 2009</xref>) age are 8683 and 6256 years BP. For the rs1042602(A) allele, the reported confidence intervals for the age are 27,315 and 25,424 years BP (<xref ref-type="bibr" rid="bib1">Albers and McVean, 2020</xref>).</p><p>When refitting the model for the rs4988235(T) allele, we found that the inferred selection coefficient is slightly lower when the allele age is assumed to be at the lower bound of the 95% credible interval (0.0867 vs. 0.0993 before 5000 years BP and 0.0321 vs. 0.0328 after 5000 years BP) and slightly higher when assumed to be at the upper bound (0.0994 vs. 0.0993 before 5000 years BP and 0.0572 vs. 0.0328 after 5000 years BP) (<xref ref-type="table" rid="app2table5">Appendix 2—table 5</xref> and <xref ref-type="fig" rid="fig6s7">Figure 6—figure supplements 7</xref> and <xref ref-type="fig" rid="fig6s8">8</xref>). This occurs because the selection intensity must be higher or lower when there is more or less time, respectively, for the allele to reach the allele frequencies observed in the data. In the case of the rs1042602(A) allele, this only affects the earlier time period (<xref ref-type="table" rid="app2table7">Appendix 2—table 7</xref>). The rs4988235(T) allele’s geographic distribution in the more recent time periods is also less extended geographically when the age is assumed to be young. The inferred geographic origin of both alleles slightly differs under different assumed ages (<xref ref-type="fig" rid="fig8s4">Figure 8—figure supplements 4</xref> and <xref ref-type="fig" rid="fig8s5">5</xref>).</p><p>In addition, we assessed the likelihood of the best-fitted models with varying the ages of the rs4988235(T) and rs1042602(A) alleles (<xref ref-type="fig" rid="fig6s9">Figure 6—figure supplement 9</xref> and <xref ref-type="fig" rid="fig8s6">Figure 8—figure supplement 6</xref>, respectively). We can see that in the case of rs4988235(T) allele the allele age used in this study (7441 years) gives the most likely solution among the explored ages. In case of the rs1042602(A) allele, we found that there are multiple nearly equally likely ages when looking at ages at least as old as 15,000 years.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>A spatially explicit framework for allele frequency diffusion can provide new insights into the dynamics of selected variants across a landscape. We have shown that under the conditions of strong, recent selection, our method can infer selection and dispersal parameters using a combination of ancient and present-day human genomic data. However, when allowing for advection, the inferred location tends to become less accurate. This suggests that migration events early in the dispersal of the selected allele could create difficulties in finding the true allele origin if net directional movement (i.e., via major migratory processes) had a large effect in this dispersal. This issue could be alleviated with the inclusion of more ancient genomes around the time of the origin of the mutation, perhaps in combination with a more fine-scaled division into periods where advection may have occurred in different directions.</p><p>The inferred geographic origin of the rs4988235(T) allele reflects the best guess of our framework given the constraints provided by its input, namely, the previously inferred age of the allele and the observed instances of this allele throughout Western Eurasia. We are also assuming that the allele must have arisen somewhere within the bounding box of our studied map. When assuming a relatively young allele age (7441 years ago, equal to the start of selection onset in <xref ref-type="bibr" rid="bib40">Itan et al., 2009</xref>), the origin of the allele is placed north of the Caucasus, perhaps among steppe populations that inhabited the area at this time (<xref ref-type="bibr" rid="bib31">Haak et al., 2015</xref>; <xref ref-type="bibr" rid="bib2">Allentoft et al., 2015</xref>). This origin is further east than the geographic origin estimate from <xref ref-type="bibr" rid="bib40">Itan et al., 2009</xref>, likely reflecting additional ancient DNA information that is available to us, and indicates an early presence of the allele in Eastern Europe. When assuming a relatively old allele age (20,106 years ago, <xref ref-type="bibr" rid="bib1">Albers and McVean, 2020</xref>), the age is placed in Northeast Europe, perhaps among Eastern hunter-gatherer groups that inhabited the region in the early Holocene. We note that the number of available genomes for Eastern and Northeastern Europe during the early Holocene is scarce, so the uncertainty of the exact location of this origin is relatively high. Regardless of the assumed age, we estimate a net westward displacement of the allele frequency’s center of mass, and a rapid diffusion, particularly in the period after 5000 years ago.</p><p>Various studies have estimated the selection coefficient for the rs4988235(T) allele, and these range from as low as 0.014 to as high as 0.19 (<xref ref-type="bibr" rid="bib23">Enattah et al., 2008</xref>; <xref ref-type="bibr" rid="bib58">Mathieson and Mathieson, 2018</xref>; <xref ref-type="bibr" rid="bib59">Mathieson, 2020</xref>; <xref ref-type="bibr" rid="bib86">Stern et al., 2019</xref>; <xref ref-type="bibr" rid="bib12">Burger et al., 2020</xref>; <xref ref-type="bibr" rid="bib68">Peter et al., 2012</xref>; <xref ref-type="bibr" rid="bib29">Gerbault et al., 2009</xref>; <xref ref-type="bibr" rid="bib40">Itan et al., 2009</xref>; <xref ref-type="bibr" rid="bib6">Bersaglieri et al., 2004</xref>). Recent papers incorporating ancient DNA estimate the selection coefficient to be as low as 0 (in certain regions of Southern Europe) and as high as 0.06 (<xref ref-type="bibr" rid="bib58">Mathieson and Mathieson, 2018</xref>; <xref ref-type="bibr" rid="bib59">Mathieson, 2020</xref>; <xref ref-type="bibr" rid="bib12">Burger et al., 2020</xref>). It is also likely that the selection coefficient was different for different regions of Europe, perhaps due to varying cultural practices (<xref ref-type="bibr" rid="bib59">Mathieson, 2020</xref>). In our case, the estimated selection coefficient during the first period—before 5000 years ago—depends strongly on the assumed allele age (s = 0.0993 vs. s = 0.0285). As in the case of the geographic origin, these estimates should be taken with caution as the number of available allele observations in the early Holocene is fairly low. The estimates for the second period—after 5000 years ago—are more robust to the assumed age: s = 0.0328 (95% CI: 0.0327–0.0329) if we assume the younger allele age (7441 years ago) and s = 0.0255 (95% CI: 0.0252–0.0258) if we assume the older allele age (20,106 years ago). These estimates are also within the range of previous estimates.</p><p>In the case of the rs1042602(A) allele, our estimated selection coefficients of 0.0221 (95% CI: 0.0216–0.0227) and 0.0102 (95% CI: 0.0083–0.0120) for the time periods before and after 5000 years BP, respectively, are generally in agreement with previous results. <xref ref-type="bibr" rid="bib91">Wilde et al., 2014</xref> used a forward simulation approach to infer a point estimate of 0.026. Another study using an approximate Bayesian computation framework (<xref ref-type="bibr" rid="bib61">Nakagome et al., 2019</xref>) estimated the strength of selection acting on rs1042602 to be 0.013 (0.002–0.029). Although both studies utilized ancient DNA data, the estimates were obtained without explicitly modeling the spatial dimension of the selection process.</p><p>Our estimates of the longitudinal advection parameter are negative for both the SNPs in the <italic>TYR</italic> and <italic>LCT</italic> loci: the mutation origins are always to the east of the center of mass of the allele frequency distribution seen in present-day data. This perhaps reflects common migratory processes, like the large-scale Neolithic and Bronze Age population movements from east to west, affecting the allele frequencies at these loci across the Eurasian landscape (<xref ref-type="bibr" rid="bib2">Allentoft et al., 2015</xref>; <xref ref-type="bibr" rid="bib31">Haak et al., 2015</xref>). As a form of regularization, we kept the range of explored values for the advection parameters to be small (−2.5–2.5 km per generation), while allowing the diffusion parameters to be explored over a much wider range of values. In certain cases, like the second period of the rs4988235(T) spread when the allele age is assumed to be young (<xref ref-type="table" rid="app2table5">Appendix 2—table 5</xref>), we find that the advection parameters are fitted at the boundary of the explored range, because the allele needs to spread very fast across the landscape to fit the data.</p><p>A future improvement to our method could include other forms of regularization that better account for the joint behavior of the advection and diffusion processes, or the use of priors for these parameters under a Bayesian setting, which could be informed by realistic assumptions about the movement of individuals on a landscape. Bayesian parameter fitting would likely provide a more robust understanding of the uncertainty of the estimates as well as an opportunity to formally compare different models using Bayes factors, although at the cost of an increase of computational intensity.</p><p>When investigating the robustness of the geographic origin of both rs4988235(T) and rs1042602(A), we found that parameters related to the beneficial allele’s expansion change in response to different assumed origins of the allele. The resulting allele frequency surface plots, however, appear very similar throughout the later stages of the process, showing that the model tends to adjust the diffusion and advection coefficients in a way such that the allele will end up expanding into the same areas regardless of the origin.</p><p>As we apply these methods to longer time scales and broader geographic areas, the assumptions of spatiotemporal homogeneity of the parameters seem less plausible. There may be cases where the allele may have been distributed over a wide geographic area but remained at low frequencies for an extended period of time, complicating the attempts to pinpoint the allele’s origin. In our study, we estimated diffusion and selection coefficients separately for two time periods before and after 5000 years ago to account for changes in mobility during the Bronze Age, but this approach may still be hindered by uneven sampling, especially when the allele in question exists at very low frequencies. Notably, our results for the spread of the rs4988235(T) allele during the older time period should be interpreted with caution, since they may be affected by sparse sampling in the early Holocene.</p><p>Potential future extensions of our method could incorporate geographic features and historical migration events that create spatially or temporally varying moderators of gene flow. An example of this type of processes is the retreat of glaciers after the last Glacial maximum, which allowed migration of humans into Scandinavia (<xref ref-type="bibr" rid="bib30">Günther et al., 2018</xref>). These changing geographic features could lead to changes in the rate of advection or diffusion across time or space. They could also serve to put more environmentally aware constraints on the geographic origin of the allele, given that it cannot have existed in regions uninhabitable by humans, and to extend our analyses beyond the narrow confines of the Western Eurasian map chosen for this study. One could also envision incorporating variation in population densities over time or known migration processes in the time frames and regions of interest. These might have facilitated rapid, long-range dispersal of beneficial alleles (<xref ref-type="bibr" rid="bib8">Bradburd et al., 2016</xref>; <xref ref-type="bibr" rid="bib32">Hallatschek and Fisher, 2014</xref>) or caused allelic surfing on the wave of range expansions (<xref ref-type="bibr" rid="bib44">Klopfstein et al., 2006</xref>). Additional information like this could come, for example, from previously inferred spatiotemporal demographic processes (e.g. <xref ref-type="bibr" rid="bib74">Racimo et al., 2020b</xref>).</p><p>As described above, our model only accounts for diffusion in two directions. Further extension of our model could therefore incorporate anisotropic diffusion (<xref ref-type="bibr" rid="bib66">Othmer et al., 1988</xref>; <xref ref-type="bibr" rid="bib67">Painter and Hillen, 2018</xref>). Another possibility could be the introduction of stochastic process components in order to convert the partial differential equations into stochastic differential equations (<xref ref-type="bibr" rid="bib10">Brown et al., 2000</xref>). Stochastic components could serve to induce spatial autocorrelation and capture local patterns of allele frequency covariance in space that might not be well modeled by the deterministic partial differential equations (PDEs) (<xref ref-type="bibr" rid="bib18">Cressie and Wikle, 2015</xref>). They could also serve to induce stochasticity in allele frequency changes over time as a consequence of genetic drift (<xref ref-type="bibr" rid="bib19">Crow and Kimura, 1970</xref>), allowing one to model the dynamics of more weakly selected variants, where drift plays an important role. Eventually, one could perhaps combine information across loci to jointly model the spatiotemporal frequency surfaces at multiple loci associated with the same trait. This could help clarify the dynamics of polygenic adaptation and negative selection on complex traits (<xref ref-type="bibr" rid="bib39">Irving-Pease et al., 2021</xref>), and perhaps hindcast the genetic value of traits across a landscape.</p><p>The availability of hundreds of ancient genomes (<xref ref-type="bibr" rid="bib54">Marciniak and Perry, 2017</xref>) and the increasing interest in spatiotemporal method development (<xref ref-type="bibr" rid="bib9">Bradburd and Ralph, 2019</xref>), such as the one described in this article, will likely lead researchers to posit new questions and hypotheses about the behavior of natural selection. In the case of a beneficial allele spreading on a landscape, new ontologies and vocabulary for describing positive selection in time and space will be needed. Abundant terms exist to classify the initial conditions and dynamics of a selective sweep in a single population (hard sweep, multiple-origin soft sweep, single-origin soft sweep, partial sweep) (<xref ref-type="bibr" rid="bib34">Hermisson and Pennings, 2005</xref>; <xref ref-type="bibr" rid="bib72">Pritchard and Di Rienzo, 2010</xref>; <xref ref-type="bibr" rid="bib35">Hermisson et al., 2017</xref>). In contrast, there is a lack of vocabulary for distinguishing between a scenario of strong selection that is locally constrained in space from a scenario of widespread selection extended over a landscape, or a model of neutral diffusion in space followed by parallel non-neutral increases in frequency at multiple locations. For example, <xref ref-type="bibr" rid="bib75">Ralph and Coop, 2010</xref> showed how multiple localized hard sweeps may be seen as a soft sweep at a larger population-wide scale. Existing vocabulary for spatiotemporal genetic processes is clearly not enough, limiting the types of questions or hypotheses we can pose about them.</p><p>Population genetic models that explicitly account for space and time are an important area of future methodological development (<xref ref-type="bibr" rid="bib9">Bradburd and Ralph, 2019</xref>). We believe that methods such as the one described in this study show great promise at broadening the horizon of our understanding of natural selection across space and time in humans and other species. As in the case of demographic reconstruction (<xref ref-type="bibr" rid="bib76">Ray and Excoffier, 2009</xref>), spatiotemporal information can greatly help improve our knowledge of how natural selection operated in the past.</p></sec><sec id="s4" sec-type="methods"><title>Methods</title><sec id="s4-1"><title>The model</title><p>To describe the allele frequency dynamics in time and space, we first begin by using a deterministic model based on a two-dimensional PDE (<xref ref-type="bibr" rid="bib26">Fisher, 1937</xref>; <xref ref-type="bibr" rid="bib45">Kolmogorov et al., 1937</xref>; <xref ref-type="bibr" rid="bib63">Novembre et al., 2005</xref>). This PDE represents the distribution <inline-formula><mml:math id="inf7"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of the allele frequency across a two-dimensional (<inline-formula><mml:math id="inf8"><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:math></inline-formula>) landscape at time <inline-formula><mml:math id="inf9"><mml:mi>t</mml:mi></mml:math></inline-formula>:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mrow><mml:mrow><mml:mi>γ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf10"><mml:mi>σ</mml:mi></mml:math></inline-formula> is the diffusion coefficient, <inline-formula><mml:math id="inf11"><mml:mi>s</mml:mi></mml:math></inline-formula> is the selection coefficient, and <inline-formula><mml:math id="inf12"><mml:mi>d</mml:mi></mml:math></inline-formula> is the dominance coefficient (<xref ref-type="bibr" rid="bib63">Novembre et al., 2005</xref>). We assumed an additive model and fixed <inline-formula><mml:math id="inf13"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> in all analyses below. We call this ‘model A,’ but we also evaluated the fit of our data under more complex models that are more flexible, and are described below.</p><p>Model B is a more general diffusion-reaction model, which incorporates distinct diffusion terms in the longitudinal and latitudinal directions (<inline-formula><mml:math id="inf14"><mml:msub><mml:mi>σ</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf15"><mml:msub><mml:mi>σ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula>, respectively):<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mo>∂</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>⁡</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mo>∂</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>⁡</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>γ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Model C is a generalization of model B that incorporates advection terms in the longitudinal and latitudinal directions (see, e.g. <xref ref-type="bibr" rid="bib14">Cantrell and Cosner, 2004</xref> for a motivation of this type of model in the context of spatial ecology):<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mo>∂</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>⁡</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mo>∂</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>⁡</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>γ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Here, <italic>v</italic><sub><italic>x</italic></sub> and <italic>v</italic><sub><italic>y</italic></sub> represent the coefficients for advective velocity along the longitude and latitude respectively.</p><p>In Appendix 1, we motivate the construction of these equations using model C as an example and show that <xref ref-type="disp-formula" rid="equ4">Equation 4</xref> can be obtained by taking an infinitesimal limit of a random walk on a two-dimensional lattice, after including a reaction term due to selection. Models A and B are then shown to be special cases of model C.</p><p>For evaluating the likelihood of the observed data, we use a binomial genotype sampling model. Let <inline-formula><mml:math id="inf16"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> be the genotype of individual <inline-formula><mml:math id="inf17"><mml:mi>i</mml:mi></mml:math></inline-formula> at the locus of interest, let <italic>a</italic><sub><italic>i</italic></sub> be the number of reads carrying ancestral alleles, and let <italic>d</italic><sub><italic>i</italic></sub> be the number of reads carry derived reads. Let <inline-formula><mml:math id="inf18"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> be the coordinates of the location from which individual <inline-formula><mml:math id="inf19"><mml:mi>i</mml:mi></mml:math></inline-formula> was sampled, and <italic>t</italic><sub><italic>i</italic></sub> its estimated age (e.g., from radiocarbon dating). Then, the likelihood for individual <inline-formula><mml:math id="inf20"><mml:mi>i</mml:mi></mml:math></inline-formula> can be computed as follows:<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:munderover><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf21"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the solution to one of the partial differential equations described above (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>, <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>, or <xref ref-type="disp-formula" rid="equ4">Equation 4</xref>, depending on the process model chosen), evaluated at location <inline-formula><mml:math id="inf22"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and time <italic>t</italic><sub><italic>i</italic></sub>. In turn, <inline-formula><mml:math id="inf23"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the likelihood for genotype <inline-formula><mml:math id="inf24"><mml:mi>i</mml:mi></mml:math></inline-formula>. Furthermore, <inline-formula><mml:math id="inf25"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is a binomial distribution, where <inline-formula><mml:math id="inf26"><mml:mi>n</mml:mi></mml:math></inline-formula> represents the ploidy level, which in this case is 2:<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mfrac linethickness="0pt"><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>h</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Then, the likelihood of the entire data can be computed as<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mtext mathvariant="bold">d</mml:mtext></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mtext mathvariant="bold">a</mml:mtext></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where M is the total number of individuals for which we have data, d is the vector containing the derived read count for each individual, and a is the vector containing the ancestral read count for each individual. We computed genotype likelihoods directly on the BAM file read data using the SAMtools genotype model (<xref ref-type="bibr" rid="bib49">Li, 2011</xref>) implemented in the software ANGSD (<xref ref-type="bibr" rid="bib46">Korneliussen et al., 2014</xref>).</p><p>When only randomly sampled pseudohaploid allele counts are available, we used a Bernoulli sampling likelihood (conditional on the genotype <italic>g</italic><sub><italic>i</italic></sub>) on the right-hand side of <xref ref-type="disp-formula" rid="equ6">Equation 6</xref> instead. Briefly, assuming that the probability of an individual having genotype <inline-formula><mml:math id="inf27"><mml:mi>g</mml:mi></mml:math></inline-formula> at a particular locus given the underlying allele frequency <inline-formula><mml:math id="inf28"><mml:mi>p</mml:mi></mml:math></inline-formula> follows a binomial distribution and that the probability of sampling a read given the genotype of an individual follows a Bernoulli distribution with probability of success <inline-formula><mml:math id="inf29"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:math></inline-formula>, then the probability of sampling a read given the genotype follows a Bernoulli distribution with probability of success <inline-formula><mml:math id="inf30"><mml:mi>p</mml:mi></mml:math></inline-formula>.</p></sec><sec id="s4-2"><title>Map</title><p>We restricted the geographic area explored by our model fit to be between 30°N to 75°N, and between 10°W and 80°E. For numerical calculations, we used a grid constructed using a resolution of approximately one grid cell per latitude and longitude. We used Harvesine functions in order to transform the distance from degrees to kilometers between two geographic points. The diffusion of the allele frequency was disallowed in the map regions where the topology is negative (i.e., regions under water), based on ETOPO5 data (<xref ref-type="bibr" rid="bib62">NOAA, National Geophysical Data Center, B. C, 1988</xref>). For this reason, we added land bridges between the European mainland and Sardinia, and between the mainland and Great Britain, in order to allow the allele to diffuse in these regions (see <xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1</xref>).</p></sec><sec id="s4-3"><title>Parameter search</title><p>Parameter optimization was done via maximum likelihood estimation with a two-layer optimization set-up. The first layer consists of a simulated annealing approach (<xref ref-type="bibr" rid="bib4">Bélisle, 1992</xref>) starting from 50 random points in the parameter space. The initial 50 points are sampled using Latin hypercube sampling to ensure an even spread across the parameter space. The output of this fit was then fed to the L-BFGS-B algorithm to refine the parameter estimates around the obtained maximum and obtain confidence intervals for the selection, diffusion and advection parameters (<xref ref-type="bibr" rid="bib13">Byrd et al., 1995</xref>).</p><p>The parameters optimized were:</p><list list-type="bullet"><list-item><p>The selection coefficient (<inline-formula><mml:math id="inf31"><mml:mi>s</mml:mi></mml:math></inline-formula>), restricted to the range 0.001–0.1.</p></list-item><list-item><p>Two dispersal parameters <inline-formula><mml:math id="inf32"><mml:msub><mml:mi>σ</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf33"><mml:msub><mml:mi>σ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula> in the longitudinal and latitudinal directions, respectively, restricted to the range of 1–100 square kilometers per generation.</p></list-item><list-item><p>The longitudinal and latitudinal advection coefficients <italic>v</italic><sub><italic>x</italic></sub> and <italic>v</italic><sub><italic>y</italic></sub>, respectively. As a form of regularization, we set the range of explored values to be narrowly centered around zero: –2.5 to 2.5 kilometers per generation.</p></list-item><list-item><p>The geographic origin of the allele, which is randomly initialized to be any of the 28 spatial points shown in <xref ref-type="fig" rid="app2fig2">Appendix 2—figure 2</xref> at the start of the optimization process.</p></list-item></list><p>We chose to construct our method in a way that uses the age of the allele as an input parameter rather than estimating it. We do this since there are multiple equally possible solutions with various combinations of allele age and selection coefficient values as shown in <xref ref-type="fig" rid="app2fig3">Appendix 2—figure 3</xref>. The latitude and longitude are discretized in our model in order to solve the differential equations numerically, thus the origin of a mutation is measured in terms of discrete units. For this reason, when using the L-BFGS-B algorithm, we fixed the previously estimated origin of the allele and did not explore it during this second optimization layer. For numerical calculations, we used the Livermore Solver for Ordinary Differential Equations (<xref ref-type="bibr" rid="bib37">Hindmarsh, 1983</xref>) implemented in R package ‘deSolve’ (<xref ref-type="bibr" rid="bib83">Soetaert et al., 2010</xref>), which is a general-purpose solver that can handle both stiff and nonstiff systems. In case of stiff problems, the solver uses a Jacobian matrix. Absorbing boundary conditions were used at the boundaries of the map. For visualization purposes, we masked the allele frequencies from areas with negative topology (i.e., areas covered by large bodies of water). Time was measured in generations, assuming 29 years per generation. During the optimization, we scaled the time and the parameters by a factor of 10, which allowed us to decrease the execution time of the model.</p><p>We initialized the grid by setting the initial allele frequency to be <italic>p</italic><sub>0</sub> in a grid cell where the allele originates and 0 elsewhere. <italic>p</italic><sub>0</sub> was calculated as <inline-formula><mml:math id="inf34"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>*</mml:mo><mml:mi>D</mml:mi><mml:mo>*</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf35"><mml:mi>D</mml:mi></mml:math></inline-formula> is the population density and is equal to 2.5 inhabitants per square kilometer, which is the estimated population density in Europe in 1000 BC (<xref ref-type="bibr" rid="bib17">Colin McEvedy, 1978</xref>; <xref ref-type="bibr" rid="bib63">Novembre et al., 2005</xref>). In the equation, <inline-formula><mml:math id="inf36"><mml:mi>D</mml:mi></mml:math></inline-formula> is multiplied by 2 because we assume that the allele originated in a single chromosome in a diploid individual. <inline-formula><mml:math id="inf37"><mml:mi>A</mml:mi></mml:math></inline-formula> is the area in square kilometers of the grid cell where the allele emerged.</p><p>Asymptotic 95% confidence intervals for a given parameter <inline-formula><mml:math id="inf38"><mml:msub><mml:mi>θ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> were calculated using equation<disp-formula id="equ8"><mml:math id="m8"><mml:mrow><mml:mrow><mml:mover><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>±</mml:mo><mml:mn>1.96</mml:mn><mml:msqrt><mml:mo stretchy="false">(</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:msqrt></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf39"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is an estimate of the observed Fisher information matrix (<xref ref-type="bibr" rid="bib25">Fisher, 1922</xref>; <xref ref-type="bibr" rid="bib21">Efron and Hastie, 2016</xref>; <xref ref-type="bibr" rid="bib15">Casella and Berger, 2001</xref>).</p></sec><sec id="s4-4"><title>Implementation</title><p>The above-described model was implemented in R version 3.6. To numerically solve the differential equations and obtain maximum likelihood estimates, we used the libraries <italic>deSolve</italic> (<xref ref-type="bibr" rid="bib83">Soetaert et al., 2010</xref>), <italic>ReacTran</italic> (<xref ref-type="bibr" rid="bib84">Soetaert and Meysman, 2012</xref>), and <italic>bbmle</italic> (<xref ref-type="bibr" rid="bib7">Bolker, 2020</xref>). Scripts containing the code used in this article are available on GitHub: <ext-link ext-link-type="uri" xlink:href="https://github.com/RasaMukti/stepadna">https://github.com/RasaMukti/stepadna</ext-link>, (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:8f71fa11f0316162937e47e32f43ceddad8f8332;origin=https://github.com/RasaMukti/stepadna;visit=swh:1:snp:d9b4d676338244c557777ef5c2a70ff0df2b68c0;anchor=swh:1:rev:d024767648d873f329a8e17fcaf6034c99157120">swh:1:rev:d024767648d873f329a8e17fcaf6034c99157120</ext-link>; <xref ref-type="bibr" rid="bib60">Muktupavela, 2021</xref>).</p></sec><sec id="s4-5"><title>Individual-based simulations</title><p>For the individual-based spatiotemporal forward simulations, we first defined a spatial boundary for a population spread across a broad geographic region of Europe. In order to ensure a reasonably uniform distribution of individuals across this spatial range throughout the course of the simulation, we set the maximum distance for spatial competition and mating choice between individuals to 250 km (translated, on a SLiM level, to the interaction parameter <italic>maxDistance</italic>), and the standard deviation of the normal distribution governing the spread of offspring from their parents at 25 km (leveraged in SLiM’s <italic>modifyChild</italic>() callback function) (<xref ref-type="bibr" rid="bib33">Haller and Messer, 2019</xref>). We note that we have chosen the values of these parameters merely to ensure a uniform spread of individuals across a simulated landscape. They are not intended to represent realistic estimates for these parameters at any time in human history.</p><p>After defining the spatial context of the simulations and ensuring the uniform spread of individuals across their population boundary, we introduced a single beneficial additive mutation in a single individual. In order to test how accurately our model can infer the parameters of interest, we simulated a scenario in which the allele appeared in Central Europe 15,000 years ago with the selection coefficient of the beneficial mutation set to 0.03. Over the course of the simulation, we tracked the position of each individual that ever lived together with its location on a two-dimensional map, as well as its genotype (i.e., zero, one, or two copies of the beneficial allele). We then used this complete information about the spatial distribution of the beneficial allele in each time point to study the accuracy of our model in inferring the parameters of interest.</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Software, Formal analysis, Visualization, Writing – original draft</p></fn><fn fn-type="con" id="con2"><p>Formal analysis, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Supervision, Writing – review and editing</p></fn><fn fn-type="con" id="con4"><p>Supervision, Writing – review and editing</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Supervision, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con6"><p>Conceptualization, Resources, Supervision, Funding acquisition, Methodology, Writing – original draft, Project administration, Writing – review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media xlink:href="elife-73767-transrepform1-v1.pdf" mimetype="application" mime-subtype="pdf"/></supplementary-material><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Publications that produced data included in the Allen Ancient DNA Resource, compiled by the Reich Lab.</title></caption><media xlink:href="elife-73767-supp1-v1.docx" mimetype="application" mime-subtype="docx"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>The current manuscript is a computational study, therefore no data have been generated for this manuscript. Software code along with publicly available data used for this study are deposited to GitHub: <ext-link ext-link-type="uri" xlink:href="https://github.com/RasaMukti/stepadna/tree/main/reproducibles">https://github.com/RasaMukti/stepadna/tree/main/reproducibles</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:8f71fa11f0316162937e47e32f43ceddad8f8332;origin=https://github.com/RasaMukti/stepadna;visit=swh:1:snp:d9b4d676338244c557777ef5c2a70ff0df2b68c0;anchor=swh:1:rev:d024767648d873f329a8e17fcaf6034c99157120">swh:1:rev:d024767648d873f329a8e17fcaf6034c99157120</ext-link>).</p><p>The following previously published datasets were used:</p><p><element-citation publication-type="data" specific-use="references" id="dataset1"><person-group person-group-type="author"><name><surname>Reich</surname><given-names>D</given-names></name><name><surname>Mallick</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>Allen Ancient DNA Resource (AADR)</data-title><source>Allen Ancient DNA</source><pub-id pub-id-type="accession" xlink:href="https://reich.hms.harvard.edu/allen-ancient-dna-resource-aadr-downloadable-genotypes-present-day-and-ancient-dna-data">AADR</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset2"><person-group person-group-type="author"><name><surname>Bergström</surname><given-names>A</given-names></name><name><surname>McCarthy</surname><given-names>SA</given-names></name><name><surname>Hui</surname><given-names>R</given-names></name><name><surname>Almarri</surname><given-names>MA</given-names></name><name><surname>Ayub</surname><given-names>Q</given-names></name><name><surname>Danecek</surname><given-names>P</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Felkel</surname><given-names>S</given-names></name><name><surname>Hallast</surname><given-names>P</given-names></name><name><surname>Kamm</surname><given-names>J</given-names></name><name><surname>Blanché</surname><given-names>H</given-names></name><name><surname>Deleuze</surname><given-names>JF</given-names></name><name><surname>Cann</surname><given-names>H</given-names></name><name><surname>Mallick</surname><given-names>S</given-names></name><name><surname>Reich</surname><given-names>D</given-names></name><name><surname>Sandhu</surname><given-names>MS</given-names></name><name><surname>Skoglund</surname><given-names>P</given-names></name><name><surname>Scally</surname><given-names>A</given-names></name><name><surname>Xue</surname><given-names>Y</given-names></name><name><surname>Durbin</surname><given-names>R</given-names></name><name><surname>Tyler-Smith</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>Human Genome Diversity Panel</data-title><source>EMBL-EBI</source><pub-id pub-id-type="accession" xlink:href="http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/HGDP/">HGDP</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>We thank Graham Gower, Evan Irving-Pease, Montgomery Slatkin, the members of the Racimo group, and two anonymous reviewers for helpful comments and advice. FR and RM were funded by a Villum Fonden Young Investigator award to FR (project no. 00025300). FR was also supported by a Novo Nordisk Fonden Ascending Investigator Award (NF22OC0076816) and a ERC Synergy grant (ID 951385). Additionally, MP and FR were supported by a Lundbeckfonden grant (R302-2018-2155) and a Novo Nordisk Fonden grant (NNF18SA0035006) to the GeoGenetics Centre. TSK was funded by a Carlsberg grant (CF19-0712). JN was funded by NIH grant R01 GM132383.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Albers</surname><given-names>PK</given-names></name><name><surname>McVean</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Dating genomic variants and shared ancestry in population-scale sequencing data</article-title><source>PLOS Biology</source><volume>18</volume><elocation-id>e3000586</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.3000586</pub-id><pub-id pub-id-type="pmid">31951611</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Allentoft</surname><given-names>ME</given-names></name><name><surname>Sikora</surname><given-names>M</given-names></name><name><surname>Sjögren</surname><given-names>K-G</given-names></name><name><surname>Rasmussen</surname><given-names>S</given-names></name><name><surname>Rasmussen</surname><given-names>M</given-names></name><name><surname>Stenderup</surname><given-names>J</given-names></name><name><surname>Damgaard</surname><given-names>PB</given-names></name><name><surname>Schroeder</surname><given-names>H</given-names></name><name><surname>Ahlström</surname><given-names>T</given-names></name><name><surname>Vinner</surname><given-names>L</given-names></name><name><surname>Malaspinas</surname><given-names>A-S</given-names></name><name><surname>Margaryan</surname><given-names>A</given-names></name><name><surname>Higham</surname><given-names>T</given-names></name><name><surname>Chivall</surname><given-names>D</given-names></name><name><surname>Lynnerup</surname><given-names>N</given-names></name><name><surname>Harvig</surname><given-names>L</given-names></name><name><surname>Baron</surname><given-names>J</given-names></name><name><surname>Della Casa</surname><given-names>P</given-names></name><name><surname>Dąbrowski</surname><given-names>P</given-names></name><name><surname>Duffy</surname><given-names>PR</given-names></name><name><surname>Ebel</surname><given-names>AV</given-names></name><name><surname>Epimakhov</surname><given-names>A</given-names></name><name><surname>Frei</surname><given-names>K</given-names></name><name><surname>Furmanek</surname><given-names>M</given-names></name><name><surname>Gralak</surname><given-names>T</given-names></name><name><surname>Gromov</surname><given-names>A</given-names></name><name><surname>Gronkiewicz</surname><given-names>S</given-names></name><name><surname>Grupe</surname><given-names>G</given-names></name><name><surname>Hajdu</surname><given-names>T</given-names></name><name><surname>Jarysz</surname><given-names>R</given-names></name><name><surname>Khartanovich</surname><given-names>V</given-names></name><name><surname>Khokhlov</surname><given-names>A</given-names></name><name><surname>Kiss</surname><given-names>V</given-names></name><name><surname>Kolář</surname><given-names>J</given-names></name><name><surname>Kriiska</surname><given-names>A</given-names></name><name><surname>Lasak</surname><given-names>I</given-names></name><name><surname>Longhi</surname><given-names>C</given-names></name><name><surname>McGlynn</surname><given-names>G</given-names></name><name><surname>Merkevicius</surname><given-names>A</given-names></name><name><surname>Merkyte</surname><given-names>I</given-names></name><name><surname>Metspalu</surname><given-names>M</given-names></name><name><surname>Mkrtchyan</surname><given-names>R</given-names></name><name><surname>Moiseyev</surname><given-names>V</given-names></name><name><surname>Paja</surname><given-names>L</given-names></name><name><surname>Pálfi</surname><given-names>G</given-names></name><name><surname>Pokutta</surname><given-names>D</given-names></name><name><surname>Pospieszny</surname><given-names>Ł</given-names></name><name><surname>Price</surname><given-names>TD</given-names></name><name><surname>Saag</surname><given-names>L</given-names></name><name><surname>Sablin</surname><given-names>M</given-names></name><name><surname>Shishlina</surname><given-names>N</given-names></name><name><surname>Smrčka</surname><given-names>V</given-names></name><name><surname>Soenov</surname><given-names>VI</given-names></name><name><surname>Szeverényi</surname><given-names>V</given-names></name><name><surname>Tóth</surname><given-names>G</given-names></name><name><surname>Trifanova</surname><given-names>SV</given-names></name><name><surname>Varul</surname><given-names>L</given-names></name><name><surname>Vicze</surname><given-names>M</given-names></name><name><surname>Yepiskoposyan</surname><given-names>L</given-names></name><name><surname>Zhitenev</surname><given-names>V</given-names></name><name><surname>Orlando</surname><given-names>L</given-names></name><name><surname>Sicheritz-Pontén</surname><given-names>T</given-names></name><name><surname>Brunak</surname><given-names>S</given-names></name><name><surname>Nielsen</surname><given-names>R</given-names></name><name><surname>Kristiansen</surname><given-names>K</given-names></name><name><surname>Willerslev</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Population genomics of bronze age Eurasia</article-title><source>Nature</source><volume>522</volume><fpage>167</fpage><lpage>172</lpage><pub-id pub-id-type="doi">10.1038/nature14507</pub-id><pub-id pub-id-type="pmid">26062507</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alonso</surname><given-names>S</given-names></name><name><surname>Izagirre</surname><given-names>N</given-names></name><name><surname>Smith-Zubiaga</surname><given-names>I</given-names></name><name><surname>Gardeazabal</surname><given-names>J</given-names></name><name><surname>Díaz-Ramón</surname><given-names>JL</given-names></name><name><surname>Díaz-Pérez</surname><given-names>JL</given-names></name><name><surname>Zelenika</surname><given-names>D</given-names></name><name><surname>Boyano</surname><given-names>MD</given-names></name><name><surname>Smit</surname><given-names>N</given-names></name><name><surname>de la Rúa</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Complex signatures of selection for the melanogenic loci Tyr, TYRP1 and DCT in humans</article-title><source>BMC Evolutionary Biology</source><volume>8</volume><fpage>1</fpage><lpage>14</lpage><pub-id pub-id-type="doi">10.1186/1471-2148-8-74</pub-id><pub-id pub-id-type="pmid">18312627</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bélisle</surname><given-names>CJP</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Convergence theorems for a class of simulated annealing algorithms on rd</article-title><source>Journal of Applied Probability</source><volume>29</volume><fpage>885</fpage><lpage>895</lpage><pub-id pub-id-type="doi">10.2307/3214721</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bergström</surname><given-names>A</given-names></name><name><surname>McCarthy</surname><given-names>SA</given-names></name><name><surname>Hui</surname><given-names>R</given-names></name><name><surname>Almarri</surname><given-names>MA</given-names></name><name><surname>Ayub</surname><given-names>Q</given-names></name><name><surname>Danecek</surname><given-names>P</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Felkel</surname><given-names>S</given-names></name><name><surname>Hallast</surname><given-names>P</given-names></name><name><surname>Kamm</surname><given-names>J</given-names></name><name><surname>Blanché</surname><given-names>H</given-names></name><name><surname>Deleuze</surname><given-names>J-F</given-names></name><name><surname>Cann</surname><given-names>H</given-names></name><name><surname>Mallick</surname><given-names>S</given-names></name><name><surname>Reich</surname><given-names>D</given-names></name><name><surname>Sandhu</surname><given-names>MS</given-names></name><name><surname>Skoglund</surname><given-names>P</given-names></name><name><surname>Scally</surname><given-names>A</given-names></name><name><surname>Xue</surname><given-names>Y</given-names></name><name><surname>Durbin</surname><given-names>R</given-names></name><name><surname>Tyler-Smith</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Insights into human genetic variation and population history from 929 diverse genomes</article-title><source>Science</source><volume>367</volume><elocation-id>eaay5012</elocation-id><pub-id pub-id-type="doi">10.1126/science.aay5012</pub-id><pub-id pub-id-type="pmid">32193295</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bersaglieri</surname><given-names>T</given-names></name><name><surname>Sabeti</surname><given-names>PC</given-names></name><name><surname>Patterson</surname><given-names>N</given-names></name><name><surname>Vanderploeg</surname><given-names>T</given-names></name><name><surname>Schaffner</surname><given-names>SF</given-names></name><name><surname>Drake</surname><given-names>JA</given-names></name><name><surname>Rhodes</surname><given-names>M</given-names></name><name><surname>Reich</surname><given-names>DE</given-names></name><name><surname>Hirschhorn</surname><given-names>JN</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Genetic signatures of strong recent positive selection at the lactase gene</article-title><source>American Journal of Human Genetics</source><volume>74</volume><fpage>1111</fpage><lpage>1120</lpage><pub-id pub-id-type="doi">10.1086/421051</pub-id><pub-id pub-id-type="pmid">15114531</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Bolker</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>Bbmle: tools for general maximum likelihood estimation</data-title><version designator="1.0.23.1">1.0.23.1</version><source>R Package</source><ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=bbmle">https://CRAN.R-project.org/package=bbmle</ext-link></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bradburd</surname><given-names>GS</given-names></name><name><surname>Ralph</surname><given-names>PL</given-names></name><name><surname>Coop</surname><given-names>GM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>A spatial framework for understanding population structure and admixture</article-title><source>PLOS Genetics</source><volume>12</volume><elocation-id>e1005703</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1005703</pub-id><pub-id pub-id-type="pmid">26771578</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bradburd</surname><given-names>GS</given-names></name><name><surname>Ralph</surname><given-names>PL</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Spatial population genetics: it’s about time</article-title><source>Annual Review of Ecology, Evolution, and Systematics</source><volume>50</volume><fpage>427</fpage><lpage>449</lpage><pub-id pub-id-type="doi">10.1146/annurev-ecolsys-110316-022659</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname><given-names>PE</given-names></name><name><surname>Roberts</surname><given-names>GO</given-names></name><name><surname>Karesen</surname><given-names>KF</given-names></name><name><surname>Tonellato</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Blur-generated non-separable space-time models</article-title><source>Journal of the Royal Statistical Society</source><volume>62</volume><fpage>847</fpage><lpage>860</lpage><pub-id pub-id-type="doi">10.1111/1467-9868.00269</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burger</surname><given-names>J</given-names></name><name><surname>Kirchner</surname><given-names>M</given-names></name><name><surname>Bramanti</surname><given-names>B</given-names></name><name><surname>Haak</surname><given-names>W</given-names></name><name><surname>Thomas</surname><given-names>MG</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Absence of the lactase-persistence-associated allele in early neolithic europeans</article-title><source>PNAS</source><volume>104</volume><fpage>3736</fpage><lpage>3741</lpage><pub-id pub-id-type="doi">10.1073/pnas.0607187104</pub-id><pub-id pub-id-type="pmid">17360422</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burger</surname><given-names>J</given-names></name><name><surname>Link</surname><given-names>V</given-names></name><name><surname>Blöcher</surname><given-names>J</given-names></name><name><surname>Schulz</surname><given-names>A</given-names></name><name><surname>Sell</surname><given-names>C</given-names></name><name><surname>Pochon</surname><given-names>Z</given-names></name><name><surname>Diekmann</surname><given-names>Y</given-names></name><name><surname>Žegarac</surname><given-names>A</given-names></name><name><surname>Hofmanová</surname><given-names>Z</given-names></name><name><surname>Winkelbach</surname><given-names>L</given-names></name><name><surname>Reyna-Blanco</surname><given-names>CS</given-names></name><name><surname>Bieker</surname><given-names>V</given-names></name><name><surname>Orschiedt</surname><given-names>J</given-names></name><name><surname>Brinker</surname><given-names>U</given-names></name><name><surname>Scheu</surname><given-names>A</given-names></name><name><surname>Leuenberger</surname><given-names>C</given-names></name><name><surname>Bertino</surname><given-names>TS</given-names></name><name><surname>Bollongino</surname><given-names>R</given-names></name><name><surname>Lidke</surname><given-names>G</given-names></name><name><surname>Stefanović</surname><given-names>S</given-names></name><name><surname>Jantzen</surname><given-names>D</given-names></name><name><surname>Kaiser</surname><given-names>E</given-names></name><name><surname>Terberger</surname><given-names>T</given-names></name><name><surname>Thomas</surname><given-names>MG</given-names></name><name><surname>Veeramah</surname><given-names>KR</given-names></name><name><surname>Wegmann</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Low prevalence of lactase persistence in bronze age europe indicates ongoing strong selection over the last 3,000 years</article-title><source>Current Biology</source><volume>30</volume><fpage>4307</fpage><lpage>4315</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2020.08.033</pub-id><pub-id pub-id-type="pmid">32888485</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Byrd</surname><given-names>RH</given-names></name><name><surname>Lu</surname><given-names>P</given-names></name><name><surname>Nocedal</surname><given-names>J</given-names></name><name><surname>Zhu</surname><given-names>C</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>A limited memory algorithm for bound constrained optimization</article-title><source>SIAM Journal on Scientific Computing</source><volume>16</volume><fpage>1190</fpage><lpage>1208</lpage><pub-id pub-id-type="doi">10.1137/0916069</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Cantrell</surname><given-names>RS</given-names></name><name><surname>Cosner</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2004">2004</year><source>Spatial Ecology via Reaction‐Diffusion Equations</source><publisher-name>John Wiley &amp; Sons</publisher-name><pub-id pub-id-type="doi">10.1002/0470871296</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Casella</surname><given-names>G</given-names></name><name><surname>Berger</surname><given-names>RL</given-names></name></person-group><year iso-8601-date="2001">2001</year><source>Statistical Inference</source><edition>Second</edition><publisher-loc>Belmont, USA</publisher-loc><publisher-name>Cengage Learning</publisher-name></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Charati</surname><given-names>H</given-names></name><name><surname>Peng</surname><given-names>MS</given-names></name><name><surname>Chen</surname><given-names>W</given-names></name><name><surname>Yang</surname><given-names>XY</given-names></name><name><surname>Jabbari Ori</surname><given-names>R</given-names></name><name><surname>Aghajanpour-Mir</surname><given-names>M</given-names></name><name><surname>Esmailizadeh</surname><given-names>A</given-names></name><name><surname>Zhang</surname><given-names>YP</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The evolutionary genetics of lactase persistence in seven ethnic groups across the iranian plateau</article-title><source>Human Genomics</source><volume>13</volume><elocation-id>7</elocation-id><pub-id pub-id-type="doi">10.1186/s40246-019-0195-5</pub-id><pub-id pub-id-type="pmid">30744699</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Colin McEvedy</surname><given-names>RJ</given-names></name></person-group><year iso-8601-date="1978">1978</year><source>Atlas of World Population History</source><publisher-loc>Great Britain</publisher-loc><publisher-name>Penguin Books Lyd. and Allen Lane</publisher-name></element-citation></ref><ref id="bib18"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Cressie</surname><given-names>N</given-names></name><name><surname>Wikle</surname><given-names>CK</given-names></name></person-group><year iso-8601-date="2015">2015</year><source>Statistics for Spatio-Temporal Data</source><publisher-loc>Hoboken, New Jersey, USA</publisher-loc><publisher-name>John Wiley &amp; Sons</publisher-name><pub-id pub-id-type="doi">10.1111/j.1538-4632.2012.00859.x</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Crow</surname><given-names>JF</given-names></name><name><surname>Kimura</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1970">1970</year><source>An Introduction to Population Genetics Theory</source><publisher-name>Burgess Publishing Company</publisher-name></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dehasque</surname><given-names>M</given-names></name><name><surname>Ávila-Arcos</surname><given-names>MC</given-names></name><name><surname>Díez-Del-Molino</surname><given-names>D</given-names></name><name><surname>Fumagalli</surname><given-names>M</given-names></name><name><surname>Guschanski</surname><given-names>K</given-names></name><name><surname>Lorenzen</surname><given-names>ED</given-names></name><name><surname>Malaspinas</surname><given-names>A-S</given-names></name><name><surname>Marques-Bonet</surname><given-names>T</given-names></name><name><surname>Martin</surname><given-names>MD</given-names></name><name><surname>Murray</surname><given-names>GGR</given-names></name><name><surname>Papadopulos</surname><given-names>AST</given-names></name><name><surname>Therkildsen</surname><given-names>NO</given-names></name><name><surname>Wegmann</surname><given-names>D</given-names></name><name><surname>Dalén</surname><given-names>L</given-names></name><name><surname>Foote</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Inference of natural selection from ancient DNA</article-title><source>Evolution Letters</source><volume>4</volume><fpage>94</fpage><lpage>108</lpage><pub-id pub-id-type="doi">10.1002/evl3.165</pub-id><pub-id pub-id-type="pmid">32313686</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Efron</surname><given-names>B</given-names></name><name><surname>Hastie</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2016">2016</year><source>Computer Age Statistical Inference</source><publisher-name>Cambridge University Press</publisher-name><pub-id pub-id-type="doi">10.1017/CBO9781316576533</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Enattah</surname><given-names>NS</given-names></name><name><surname>Sahi</surname><given-names>T</given-names></name><name><surname>Savilahti</surname><given-names>E</given-names></name><name><surname>Terwilliger</surname><given-names>JD</given-names></name><name><surname>Peltonen</surname><given-names>L</given-names></name><name><surname>Järvelä</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Identification of a variant associated with adult-type hypolactasia</article-title><source>Nature Genetics</source><volume>30</volume><fpage>233</fpage><lpage>237</lpage><pub-id pub-id-type="doi">10.1038/ng826</pub-id><pub-id pub-id-type="pmid">11788828</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Enattah</surname><given-names>NS</given-names></name><name><surname>Jensen</surname><given-names>TGK</given-names></name><name><surname>Nielsen</surname><given-names>M</given-names></name><name><surname>Lewinski</surname><given-names>R</given-names></name><name><surname>Kuokkanen</surname><given-names>M</given-names></name><name><surname>Rasinpera</surname><given-names>H</given-names></name><name><surname>El-Shanti</surname><given-names>H</given-names></name><name><surname>Seo</surname><given-names>JK</given-names></name><name><surname>Alifrangis</surname><given-names>M</given-names></name><name><surname>Khalil</surname><given-names>IF</given-names></name><name><surname>Natah</surname><given-names>A</given-names></name><name><surname>Ali</surname><given-names>A</given-names></name><name><surname>Natah</surname><given-names>S</given-names></name><name><surname>Comas</surname><given-names>D</given-names></name><name><surname>Mehdi</surname><given-names>SQ</given-names></name><name><surname>Groop</surname><given-names>L</given-names></name><name><surname>Vestergaard</surname><given-names>EM</given-names></name><name><surname>Imtiaz</surname><given-names>F</given-names></name><name><surname>Rashed</surname><given-names>MS</given-names></name><name><surname>Meyer</surname><given-names>B</given-names></name><name><surname>Troelsen</surname><given-names>J</given-names></name><name><surname>Peltonen</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Independent introduction of two lactase-persistence alleles into human populations reflects different history of adaptation to milk culture</article-title><source>American Journal of Human Genetics</source><volume>82</volume><fpage>57</fpage><lpage>72</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2007.09.012</pub-id><pub-id pub-id-type="pmid">18179885</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Ewens</surname><given-names>WJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><source>Mathematical Population Genetics 1: Theoretical Introduction</source><publisher-name>Springer Science &amp; Business Media</publisher-name><pub-id pub-id-type="doi">10.1007/978-0-387-21822-9</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fisher</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="1922">1922</year><article-title>On the mathematical foundations of theoretical statistics</article-title><source>Philosophical Transactions of the Royal Society of London. Series A, Containing Papers of A Mathematical or Physical Character</source><volume>222</volume><fpage>309</fpage><lpage>368</lpage><pub-id pub-id-type="doi">10.1098/rsta.1922.0009</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fisher</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="1937">1937</year><article-title>The wave of advance of advantageous genes</article-title><source>Annals of Eugenics</source><volume>7</volume><fpage>355</fpage><lpage>369</lpage><pub-id pub-id-type="doi">10.1111/j.1469-1809.1937.tb02153.x</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gallego Romero</surname><given-names>I</given-names></name><name><surname>Basu Mallick</surname><given-names>C</given-names></name><name><surname>Liebert</surname><given-names>A</given-names></name><name><surname>Crivellaro</surname><given-names>F</given-names></name><name><surname>Chaubey</surname><given-names>G</given-names></name><name><surname>Itan</surname><given-names>Y</given-names></name><name><surname>Metspalu</surname><given-names>M</given-names></name><name><surname>Eaaswarkhanth</surname><given-names>M</given-names></name><name><surname>Pitchappan</surname><given-names>R</given-names></name><name><surname>Villems</surname><given-names>R</given-names></name><name><surname>Reich</surname><given-names>D</given-names></name><name><surname>Singh</surname><given-names>L</given-names></name><name><surname>Thangaraj</surname><given-names>K</given-names></name><name><surname>Thomas</surname><given-names>MG</given-names></name><name><surname>Swallow</surname><given-names>DM</given-names></name><name><surname>Mirazón Lahr</surname><given-names>M</given-names></name><name><surname>Kivisild</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Herders of Indian and European cattle share their predominant allele for lactase persistence</article-title><source>Molecular Biology and Evolution</source><volume>29</volume><fpage>249</fpage><lpage>260</lpage><pub-id pub-id-type="doi">10.1093/molbev/msr190</pub-id><pub-id pub-id-type="pmid">21836184</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gamba</surname><given-names>C</given-names></name><name><surname>Jones</surname><given-names>ER</given-names></name><name><surname>Teasdale</surname><given-names>MD</given-names></name><name><surname>McLaughlin</surname><given-names>RL</given-names></name><name><surname>Gonzalez-Fortes</surname><given-names>G</given-names></name><name><surname>Mattiangeli</surname><given-names>V</given-names></name><name><surname>Domboróczki</surname><given-names>L</given-names></name><name><surname>Kővári</surname><given-names>I</given-names></name><name><surname>Pap</surname><given-names>I</given-names></name><name><surname>Anders</surname><given-names>A</given-names></name><name><surname>Whittle</surname><given-names>A</given-names></name><name><surname>Dani</surname><given-names>J</given-names></name><name><surname>Raczky</surname><given-names>P</given-names></name><name><surname>Higham</surname><given-names>TFG</given-names></name><name><surname>Hofreiter</surname><given-names>M</given-names></name><name><surname>Bradley</surname><given-names>DG</given-names></name><name><surname>Pinhasi</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Genome flux and stasis in a five millennium transect of European prehistory</article-title><source>Nature Communications</source><volume>5</volume><fpage>1</fpage><lpage>9</lpage><pub-id pub-id-type="doi">10.1038/ncomms6257</pub-id><pub-id pub-id-type="pmid">25334030</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gerbault</surname><given-names>P</given-names></name><name><surname>Moret</surname><given-names>C</given-names></name><name><surname>Currat</surname><given-names>M</given-names></name><name><surname>Sanchez-Mazas</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Impact of selection and demography on the diffusion of lactase persistence</article-title><source>PLOS ONE</source><volume>4</volume><elocation-id>e6369</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0006369</pub-id><pub-id pub-id-type="pmid">19629189</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Günther</surname><given-names>T</given-names></name><name><surname>Malmström</surname><given-names>H</given-names></name><name><surname>Svensson</surname><given-names>EM</given-names></name><name><surname>Omrak</surname><given-names>A</given-names></name><name><surname>Sánchez-Quinto</surname><given-names>F</given-names></name><name><surname>Kılınç</surname><given-names>GM</given-names></name><name><surname>Krzewińska</surname><given-names>M</given-names></name><name><surname>Eriksson</surname><given-names>G</given-names></name><name><surname>Fraser</surname><given-names>M</given-names></name><name><surname>Edlund</surname><given-names>H</given-names></name><name><surname>Munters</surname><given-names>AR</given-names></name><name><surname>Coutinho</surname><given-names>A</given-names></name><name><surname>Simões</surname><given-names>LG</given-names></name><name><surname>Vicente</surname><given-names>M</given-names></name><name><surname>Sjölander</surname><given-names>A</given-names></name><name><surname>Jansen Sellevold</surname><given-names>B</given-names></name><name><surname>Jørgensen</surname><given-names>R</given-names></name><name><surname>Claes</surname><given-names>P</given-names></name><name><surname>Shriver</surname><given-names>MD</given-names></name><name><surname>Valdiosera</surname><given-names>C</given-names></name><name><surname>Netea</surname><given-names>MG</given-names></name><name><surname>Apel</surname><given-names>J</given-names></name><name><surname>Lidén</surname><given-names>K</given-names></name><name><surname>Skar</surname><given-names>B</given-names></name><name><surname>Storå</surname><given-names>J</given-names></name><name><surname>Götherström</surname><given-names>A</given-names></name><name><surname>Jakobsson</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Population genomics of mesolithic Scandinavia: investigating early postglacial migration routes and high-latitude adaptation</article-title><source>PLOS Biology</source><volume>16</volume><elocation-id>e2003703</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.2003703</pub-id><pub-id pub-id-type="pmid">29315301</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haak</surname><given-names>W</given-names></name><name><surname>Lazaridis</surname><given-names>I</given-names></name><name><surname>Patterson</surname><given-names>N</given-names></name><name><surname>Rohland</surname><given-names>N</given-names></name><name><surname>Mallick</surname><given-names>S</given-names></name><name><surname>Llamas</surname><given-names>B</given-names></name><name><surname>Brandt</surname><given-names>G</given-names></name><name><surname>Nordenfelt</surname><given-names>S</given-names></name><name><surname>Harney</surname><given-names>E</given-names></name><name><surname>Stewardson</surname><given-names>K</given-names></name><name><surname>Fu</surname><given-names>Q</given-names></name><name><surname>Mittnik</surname><given-names>A</given-names></name><name><surname>Bánffy</surname><given-names>E</given-names></name><name><surname>Economou</surname><given-names>C</given-names></name><name><surname>Francken</surname><given-names>M</given-names></name><name><surname>Friederich</surname><given-names>S</given-names></name><name><surname>Pena</surname><given-names>RG</given-names></name><name><surname>Hallgren</surname><given-names>F</given-names></name><name><surname>Khartanovich</surname><given-names>V</given-names></name><name><surname>Khokhlov</surname><given-names>A</given-names></name><name><surname>Kunst</surname><given-names>M</given-names></name><name><surname>Kuznetsov</surname><given-names>P</given-names></name><name><surname>Meller</surname><given-names>H</given-names></name><name><surname>Mochalov</surname><given-names>O</given-names></name><name><surname>Moiseyev</surname><given-names>V</given-names></name><name><surname>Nicklisch</surname><given-names>N</given-names></name><name><surname>Pichler</surname><given-names>SL</given-names></name><name><surname>Risch</surname><given-names>R</given-names></name><name><surname>Rojo Guerra</surname><given-names>MA</given-names></name><name><surname>Roth</surname><given-names>C</given-names></name><name><surname>Szécsényi-Nagy</surname><given-names>A</given-names></name><name><surname>Wahl</surname><given-names>J</given-names></name><name><surname>Meyer</surname><given-names>M</given-names></name><name><surname>Krause</surname><given-names>J</given-names></name><name><surname>Brown</surname><given-names>D</given-names></name><name><surname>Anthony</surname><given-names>D</given-names></name><name><surname>Cooper</surname><given-names>A</given-names></name><name><surname>Alt</surname><given-names>KW</given-names></name><name><surname>Reich</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Massive migration from the steppe was a source for Indo-European languages in Europe</article-title><source>Nature</source><volume>522</volume><fpage>207</fpage><lpage>211</lpage><pub-id pub-id-type="doi">10.1038/nature14317</pub-id><pub-id pub-id-type="pmid">25731166</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hallatschek</surname><given-names>O</given-names></name><name><surname>Fisher</surname><given-names>DS</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Acceleration of evolutionary spread by long-range dispersal</article-title><source>PNAS</source><volume>111</volume><fpage>E4911</fpage><lpage>E4919</lpage><pub-id pub-id-type="doi">10.1073/pnas.1404663111</pub-id><pub-id pub-id-type="pmid">25368183</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haller</surname><given-names>BC</given-names></name><name><surname>Messer</surname><given-names>PW</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Slim 3: forward genetic simulations beyond the Wright-Fisher model</article-title><source>Molecular Biology and Evolution</source><volume>36</volume><fpage>632</fpage><lpage>637</lpage><pub-id pub-id-type="doi">10.1093/molbev/msy228</pub-id><pub-id pub-id-type="pmid">30517680</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hermisson</surname><given-names>J.</given-names></name><name><surname>Pennings</surname><given-names>PS</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Soft sweeps: molecular population genetics of adaptation from standing genetic variation</article-title><source>Genetics</source><volume>169</volume><fpage>2335</fpage><lpage>2352</lpage><pub-id pub-id-type="doi">10.1534/genetics.104.036947</pub-id><pub-id pub-id-type="pmid">15716498</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hermisson</surname><given-names>J</given-names></name><name><surname>Pennings</surname><given-names>PS</given-names></name><name><surname>Kelley</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Soft sweeps and beyond: understanding the patterns and probabilities of selection footprints under rapid adaptation</article-title><source>Methods in Ecology and Evolution</source><volume>8</volume><fpage>700</fpage><lpage>716</lpage><pub-id pub-id-type="doi">10.1111/2041-210X.12808</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heyer</surname><given-names>E</given-names></name><name><surname>Brazier</surname><given-names>L</given-names></name><name><surname>Ségurel</surname><given-names>L</given-names></name><name><surname>Hegay</surname><given-names>T</given-names></name><name><surname>Austerlitz</surname><given-names>F</given-names></name><name><surname>Quintana-Murci</surname><given-names>L</given-names></name><name><surname>Georges</surname><given-names>M</given-names></name><name><surname>Pasquet</surname><given-names>P</given-names></name><name><surname>Veuille</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Lactase persistence in central Asia: phenotype, genotype, and evolution</article-title><source>Human Biology</source><volume>83</volume><fpage>379</fpage><lpage>392</lpage><pub-id pub-id-type="doi">10.3378/027.083.0304</pub-id><pub-id pub-id-type="pmid">21740154</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hindmarsh</surname><given-names>AC</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>ODEPACK, A systematized collection of ODE solvers</article-title><source>Scientific Computing</source><volume>1</volume><fpage>55</fpage><lpage>64</lpage><pub-id pub-id-type="doi">10.12691/ajmo-4-1-1</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hudjashov</surname><given-names>G</given-names></name><name><surname>Villems</surname><given-names>R</given-names></name><name><surname>Kivisild</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Global patterns of diversity and selection in human tyrosinase gene</article-title><source>PLOS ONE</source><volume>8</volume><elocation-id>e74307</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0074307</pub-id><pub-id pub-id-type="pmid">24040225</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Irving-Pease</surname><given-names>EK</given-names></name><name><surname>Muktupavela</surname><given-names>R</given-names></name><name><surname>Dannemann</surname><given-names>M</given-names></name><name><surname>Racimo</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Quantitative human paleogenetics: what can ancient DNA tell us about complex trait evolution?</article-title><source>Frontiers in Genetics</source><volume>12</volume><elocation-id>703541</elocation-id><pub-id pub-id-type="doi">10.3389/fgene.2021.703541</pub-id><pub-id pub-id-type="pmid">34422004</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Itan</surname><given-names>Y</given-names></name><name><surname>Powell</surname><given-names>A</given-names></name><name><surname>Beaumont</surname><given-names>MA</given-names></name><name><surname>Burger</surname><given-names>J</given-names></name><name><surname>Thomas</surname><given-names>MG</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>The origins of lactase persistence in europe</article-title><source>PLOS Computational Biology</source><volume>5</volume><elocation-id>e1000491</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000491</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Itan</surname><given-names>Y</given-names></name><name><surname>Jones</surname><given-names>BL</given-names></name><name><surname>Ingram</surname><given-names>CJE</given-names></name><name><surname>Swallow</surname><given-names>DM</given-names></name><name><surname>Thomas</surname><given-names>MG</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>A worldwide correlation of lactase persistence phenotype and genotypes</article-title><source>BMC Evolutionary Biology</source><volume>10</volume><elocation-id>36</elocation-id><pub-id pub-id-type="doi">10.1186/1471-2148-10-36</pub-id><pub-id pub-id-type="pmid">20144208</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ju</surname><given-names>D</given-names></name><name><surname>Mathieson</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>The evolution of skin pigmentation associated variation in West Eurasia</article-title><source>PNAS</source><volume>118</volume><elocation-id>e2009227118</elocation-id><pub-id pub-id-type="doi">10.1073/pnas.2009227118</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Karlin</surname><given-names>S</given-names></name><name><surname>Taylor</surname><given-names>H</given-names></name></person-group><year iso-8601-date="1975">1975</year><source>A First Course in Stochastic Processes</source><edition>Second</edition><publisher-loc>New York</publisher-loc><publisher-name>Academic Press</publisher-name><pub-id pub-id-type="doi">10.1016/C2009-1-28569-8</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klopfstein</surname><given-names>S</given-names></name><name><surname>Currat</surname><given-names>M</given-names></name><name><surname>Excoffier</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>The fate of mutations surfing on the wave of a range expansion</article-title><source>Molecular Biology and Evolution</source><volume>23</volume><fpage>482</fpage><lpage>490</lpage><pub-id pub-id-type="doi">10.1093/molbev/msj057</pub-id><pub-id pub-id-type="pmid">16280540</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kolmogorov</surname><given-names>A</given-names></name><name><surname>Petrovskii</surname><given-names>I</given-names></name><name><surname>Piskunov</surname><given-names>N</given-names></name></person-group><year iso-8601-date="1937">1937</year><article-title>A study of the diffusion equation with increase in the amount of substance, and its application to A biological problem</article-title><source>Byull</source><volume>1</volume><fpage>1</fpage><lpage>26</lpage><pub-id pub-id-type="doi">10.1007/978-94-011-3030-1_38</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Korneliussen</surname><given-names>TS</given-names></name><name><surname>Albrechtsen</surname><given-names>A</given-names></name><name><surname>Nielsen</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>ANGSD: analysis of next generation sequencing data</article-title><source>BMC Bioinformatics</source><volume>15</volume><elocation-id>356</elocation-id><pub-id pub-id-type="doi">10.1186/s12859-014-0356-4</pub-id><pub-id pub-id-type="pmid">25420514</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krüttli</surname><given-names>A</given-names></name><name><surname>Bouwman</surname><given-names>A</given-names></name><name><surname>Akgül</surname><given-names>G</given-names></name><name><surname>Della Casa</surname><given-names>P</given-names></name><name><surname>Rühli</surname><given-names>F</given-names></name><name><surname>Warinner</surname><given-names>C</given-names></name><name><surname>Gilbert</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Ancient DNA analysis reveals high frequency of European lactase persistence allele (t-13910) in medieval central Europe</article-title><source>PLOS ONE</source><volume>9</volume><elocation-id>e86251</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0086251</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lao</surname><given-names>O</given-names></name><name><surname>de Gruijter</surname><given-names>JM</given-names></name><name><surname>van Duijn</surname><given-names>K</given-names></name><name><surname>Navarro</surname><given-names>A</given-names></name><name><surname>Kayser</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Signatures of positive selection in genes associated with human skin pigmentation as revealed from analyses of single nucleotide polymorphisms</article-title><source>Annals of Human Genetics</source><volume>71</volume><fpage>354</fpage><lpage>369</lpage><pub-id pub-id-type="doi">10.1111/j.1469-1809.2006.00341.x</pub-id><pub-id pub-id-type="pmid">17233754</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data</article-title><source>Bioinformatics</source><volume>27</volume><fpage>2987</fpage><lpage>2993</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btr509</pub-id><pub-id pub-id-type="pmid">21903627</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liebert</surname><given-names>A</given-names></name><name><surname>López</surname><given-names>S</given-names></name><name><surname>Jones</surname><given-names>BL</given-names></name><name><surname>Montalva</surname><given-names>N</given-names></name><name><surname>Gerbault</surname><given-names>P</given-names></name><name><surname>Lau</surname><given-names>W</given-names></name><name><surname>Thomas</surname><given-names>MG</given-names></name><name><surname>Bradman</surname><given-names>N</given-names></name><name><surname>Maniatis</surname><given-names>N</given-names></name><name><surname>Swallow</surname><given-names>DM</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>World-Wide distributions of lactase persistence alleles and the complex effects of recombination and selection</article-title><source>Human Genetics</source><volume>136</volume><fpage>1445</fpage><lpage>1453</lpage><pub-id pub-id-type="doi">10.1007/s00439-017-1847-y</pub-id><pub-id pub-id-type="pmid">29063188</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Loog</surname><given-names>L</given-names></name><name><surname>Mirazón Lahr</surname><given-names>M</given-names></name><name><surname>Kovacevic</surname><given-names>M</given-names></name><name><surname>Manica</surname><given-names>A</given-names></name><name><surname>Eriksson</surname><given-names>A</given-names></name><name><surname>Thomas</surname><given-names>MG</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Estimating mobility using sparse data: application to human genetic variation</article-title><source>PNAS</source><volume>114</volume><fpage>12213</fpage><lpage>12218</lpage><pub-id pub-id-type="doi">10.1073/pnas.1703642114</pub-id><pub-id pub-id-type="pmid">29087301</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Malaspinas</surname><given-names>AS</given-names></name><name><surname>Malaspinas</surname><given-names>O</given-names></name><name><surname>Evans</surname><given-names>SN</given-names></name><name><surname>Slatkin</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Estimating allele age and selection coefficient from time-serial data</article-title><source>Genetics</source><volume>192</volume><fpage>599</fpage><lpage>607</lpage><pub-id pub-id-type="doi">10.1534/genetics.112.140939</pub-id><pub-id pub-id-type="pmid">22851647</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marchi</surname><given-names>N</given-names></name><name><surname>Mennecier</surname><given-names>P</given-names></name><name><surname>Georges</surname><given-names>M</given-names></name><name><surname>Lafosse</surname><given-names>S</given-names></name><name><surname>Hegay</surname><given-names>T</given-names></name><name><surname>Dorzhu</surname><given-names>C</given-names></name><name><surname>Chichlo</surname><given-names>B</given-names></name><name><surname>Ségurel</surname><given-names>L</given-names></name><name><surname>Heyer</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Close inbreeding and low genetic diversity in inner Asian human populations despite geographical exogamy</article-title><source>Scientific Reports</source><volume>8</volume><elocation-id>9397</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-018-27047-3</pub-id><pub-id pub-id-type="pmid">29925873</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marciniak</surname><given-names>S</given-names></name><name><surname>Perry</surname><given-names>GH</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Harnessing ancient genomes to study the history of human adaptation</article-title><source>Nature Reviews. Genetics</source><volume>18</volume><fpage>659</fpage><lpage>674</lpage><pub-id pub-id-type="doi">10.1038/nrg.2017.65</pub-id><pub-id pub-id-type="pmid">28890534</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Margaryan</surname><given-names>A</given-names></name><name><surname>Lawson</surname><given-names>DJ</given-names></name><name><surname>Sikora</surname><given-names>M</given-names></name><name><surname>Racimo</surname><given-names>F</given-names></name><name><surname>Rasmussen</surname><given-names>S</given-names></name><name><surname>Moltke</surname><given-names>I</given-names></name><name><surname>Cassidy</surname><given-names>LM</given-names></name><name><surname>Jørsboe</surname><given-names>E</given-names></name><name><surname>Ingason</surname><given-names>A</given-names></name><name><surname>Pedersen</surname><given-names>MW</given-names></name><name><surname>Korneliussen</surname><given-names>T</given-names></name><name><surname>Wilhelmson</surname><given-names>H</given-names></name><name><surname>Buś</surname><given-names>MM</given-names></name><name><surname>de Barros Damgaard</surname><given-names>P</given-names></name><name><surname>Martiniano</surname><given-names>R</given-names></name><name><surname>Renaud</surname><given-names>G</given-names></name><name><surname>Bhérer</surname><given-names>C</given-names></name><name><surname>Moreno-Mayar</surname><given-names>JV</given-names></name><name><surname>Fotakis</surname><given-names>AK</given-names></name><name><surname>Allen</surname><given-names>M</given-names></name><name><surname>Allmäe</surname><given-names>R</given-names></name><name><surname>Molak</surname><given-names>M</given-names></name><name><surname>Cappellini</surname><given-names>E</given-names></name><name><surname>Scorrano</surname><given-names>G</given-names></name><name><surname>McColl</surname><given-names>H</given-names></name><name><surname>Buzhilova</surname><given-names>A</given-names></name><name><surname>Fox</surname><given-names>A</given-names></name><name><surname>Albrechtsen</surname><given-names>A</given-names></name><name><surname>Schütz</surname><given-names>B</given-names></name><name><surname>Skar</surname><given-names>B</given-names></name><name><surname>Arcini</surname><given-names>C</given-names></name><name><surname>Falys</surname><given-names>C</given-names></name><name><surname>Jonson</surname><given-names>CH</given-names></name><name><surname>Błaszczyk</surname><given-names>D</given-names></name><name><surname>Pezhemsky</surname><given-names>D</given-names></name><name><surname>Turner-Walker</surname><given-names>G</given-names></name><name><surname>Gestsdóttir</surname><given-names>H</given-names></name><name><surname>Lundstrøm</surname><given-names>I</given-names></name><name><surname>Gustin</surname><given-names>I</given-names></name><name><surname>Mainland</surname><given-names>I</given-names></name><name><surname>Potekhina</surname><given-names>I</given-names></name><name><surname>Muntoni</surname><given-names>IM</given-names></name><name><surname>Cheng</surname><given-names>J</given-names></name><name><surname>Stenderup</surname><given-names>J</given-names></name><name><surname>Ma</surname><given-names>J</given-names></name><name><surname>Gibson</surname><given-names>J</given-names></name><name><surname>Peets</surname><given-names>J</given-names></name><name><surname>Gustafsson</surname><given-names>J</given-names></name><name><surname>Iversen</surname><given-names>KH</given-names></name><name><surname>Simpson</surname><given-names>L</given-names></name><name><surname>Strand</surname><given-names>L</given-names></name><name><surname>Loe</surname><given-names>L</given-names></name><name><surname>Sikora</surname><given-names>M</given-names></name><name><surname>Florek</surname><given-names>M</given-names></name><name><surname>Vretemark</surname><given-names>M</given-names></name><name><surname>Redknap</surname><given-names>M</given-names></name><name><surname>Bajka</surname><given-names>M</given-names></name><name><surname>Pushkina</surname><given-names>T</given-names></name><name><surname>Søvsø</surname><given-names>M</given-names></name><name><surname>Grigoreva</surname><given-names>N</given-names></name><name><surname>Christensen</surname><given-names>T</given-names></name><name><surname>Kastholm</surname><given-names>O</given-names></name><name><surname>Uldum</surname><given-names>O</given-names></name><name><surname>Favia</surname><given-names>P</given-names></name><name><surname>Holck</surname><given-names>P</given-names></name><name><surname>Sten</surname><given-names>S</given-names></name><name><surname>Arge</surname><given-names>SV</given-names></name><name><surname>Ellingvåg</surname><given-names>S</given-names></name><name><surname>Moiseyev</surname><given-names>V</given-names></name><name><surname>Bogdanowicz</surname><given-names>W</given-names></name><name><surname>Magnusson</surname><given-names>Y</given-names></name><name><surname>Orlando</surname><given-names>L</given-names></name><name><surname>Pentz</surname><given-names>P</given-names></name><name><surname>Jessen</surname><given-names>MD</given-names></name><name><surname>Pedersen</surname><given-names>A</given-names></name><name><surname>Collard</surname><given-names>M</given-names></name><name><surname>Bradley</surname><given-names>DG</given-names></name><name><surname>Jørkov</surname><given-names>ML</given-names></name><name><surname>Arneborg</surname><given-names>J</given-names></name><name><surname>Lynnerup</surname><given-names>N</given-names></name><name><surname>Price</surname><given-names>N</given-names></name><name><surname>Gilbert</surname><given-names>MTP</given-names></name><name><surname>Allentoft</surname><given-names>ME</given-names></name><name><surname>Bill</surname><given-names>J</given-names></name><name><surname>Sindbæk</surname><given-names>SM</given-names></name><name><surname>Hedeager</surname><given-names>L</given-names></name><name><surname>Kristiansen</surname><given-names>K</given-names></name><name><surname>Nielsen</surname><given-names>R</given-names></name><name><surname>Werge</surname><given-names>T</given-names></name><name><surname>Willerslev</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Population genomics of the Viking world</article-title><source>Nature</source><volume>585</volume><fpage>390</fpage><lpage>396</lpage><pub-id pub-id-type="doi">10.1038/s41586-020-2688-8</pub-id><pub-id pub-id-type="pmid">32939067</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mathieson</surname><given-names>I.</given-names></name><name><surname>McVean</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Demography and the age of rare variants</article-title><source>PLOS Genetics</source><volume>10</volume><elocation-id>e1004528</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1004528</pub-id><pub-id pub-id-type="pmid">25101869</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mathieson</surname><given-names>Iain</given-names></name><name><surname>Lazaridis</surname><given-names>I</given-names></name><name><surname>Rohland</surname><given-names>N</given-names></name><name><surname>Mallick</surname><given-names>S</given-names></name><name><surname>Patterson</surname><given-names>N</given-names></name><name><surname>Roodenberg</surname><given-names>SA</given-names></name><name><surname>Harney</surname><given-names>E</given-names></name><name><surname>Stewardson</surname><given-names>K</given-names></name><name><surname>Fernandes</surname><given-names>D</given-names></name><name><surname>Novak</surname><given-names>M</given-names></name><name><surname>Sirak</surname><given-names>K</given-names></name><name><surname>Gamba</surname><given-names>C</given-names></name><name><surname>Jones</surname><given-names>ER</given-names></name><name><surname>Llamas</surname><given-names>B</given-names></name><name><surname>Dryomov</surname><given-names>S</given-names></name><name><surname>Pickrell</surname><given-names>J</given-names></name><name><surname>Arsuaga</surname><given-names>JL</given-names></name><name><surname>de Castro</surname><given-names>JMB</given-names></name><name><surname>Carbonell</surname><given-names>E</given-names></name><name><surname>Gerritsen</surname><given-names>F</given-names></name><name><surname>Khokhlov</surname><given-names>A</given-names></name><name><surname>Kuznetsov</surname><given-names>P</given-names></name><name><surname>Lozano</surname><given-names>M</given-names></name><name><surname>Meller</surname><given-names>H</given-names></name><name><surname>Mochalov</surname><given-names>O</given-names></name><name><surname>Moiseyev</surname><given-names>V</given-names></name><name><surname>Guerra</surname><given-names>MAR</given-names></name><name><surname>Roodenberg</surname><given-names>J</given-names></name><name><surname>Vergès</surname><given-names>JM</given-names></name><name><surname>Krause</surname><given-names>J</given-names></name><name><surname>Cooper</surname><given-names>A</given-names></name><name><surname>Alt</surname><given-names>KW</given-names></name><name><surname>Brown</surname><given-names>D</given-names></name><name><surname>Anthony</surname><given-names>D</given-names></name><name><surname>Lalueza-Fox</surname><given-names>C</given-names></name><name><surname>Haak</surname><given-names>W</given-names></name><name><surname>Pinhasi</surname><given-names>R</given-names></name><name><surname>Reich</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Genome-Wide patterns of selection in 230 ancient Eurasians</article-title><source>Nature</source><volume>528</volume><fpage>499</fpage><lpage>503</lpage><pub-id pub-id-type="doi">10.1038/nature16152</pub-id><pub-id pub-id-type="pmid">26595274</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mathieson</surname><given-names>S</given-names></name><name><surname>Mathieson</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Fads1 and the timing of human adaptation to agriculture</article-title><source>Molecular Biology and Evolution</source><volume>35</volume><fpage>2957</fpage><lpage>2970</lpage><pub-id pub-id-type="doi">10.1093/molbev/msy180</pub-id><pub-id pub-id-type="pmid">30272210</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Mathieson</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Estimating Time-Varying Selection Coefficients from Time Series Data of Allele Frequencies</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2020.11.17.387761</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Muktupavela</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>Stepadna</data-title><version designator="swh:1:rev:d024767648d873f329a8e17fcaf6034c99157120">swh:1:rev:d024767648d873f329a8e17fcaf6034c99157120</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:8f71fa11f0316162937e47e32f43ceddad8f8332;origin=https://github.com/RasaMukti/stepadna;visit=swh:1:snp:d9b4d676338244c557777ef5c2a70ff0df2b68c0;anchor=swh:1:rev:d024767648d873f329a8e17fcaf6034c99157120">https://archive.softwareheritage.org/swh:1:dir:8f71fa11f0316162937e47e32f43ceddad8f8332;origin=https://github.com/RasaMukti/stepadna;visit=swh:1:snp:d9b4d676338244c557777ef5c2a70ff0df2b68c0;anchor=swh:1:rev:d024767648d873f329a8e17fcaf6034c99157120</ext-link></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nakagome</surname><given-names>S</given-names></name><name><surname>Hudson</surname><given-names>RR</given-names></name><name><surname>Di Rienzo</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Inferring the model and onset of natural selection under varying population size from the site frequency spectrum and haplotype structure</article-title><source>Proceedings. Biological Sciences</source><volume>286</volume><elocation-id>20182541</elocation-id><pub-id pub-id-type="doi">10.1098/rspb.2018.2541</pub-id><pub-id pub-id-type="pmid">30963935</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="book"><person-group person-group-type="author"><collab>NOAA, National Geophysical Data Center, B. C</collab></person-group><year iso-8601-date="1988">1988</year><source>Data Announcement 88-MGG-02,, Digital Relief of the Surface of the Earth</source><publisher-loc>Publisher</publisher-loc><publisher-name>U.S. Department of Commerce</publisher-name></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Novembre</surname><given-names>J</given-names></name><name><surname>Galvani</surname><given-names>AP</given-names></name><name><surname>Slatkin</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>The geographic spread of the CCR5 delta32 HIV-resistance allele</article-title><source>PLOS Biology</source><volume>3</volume><elocation-id>11</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.0030339</pub-id><pub-id pub-id-type="pmid">16216086</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Novembre</surname><given-names>J</given-names></name><name><surname>Han</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Human population structure and the adaptive response to pathogen-induced selection pressures</article-title><source>Philosophical Transactions of the Royal Society of London. Series B, Biological Sciences</source><volume>367</volume><fpage>878</fpage><lpage>886</lpage><pub-id pub-id-type="doi">10.1098/rstb.2011.0305</pub-id><pub-id pub-id-type="pmid">22312055</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Okubo</surname><given-names>A</given-names></name></person-group><year iso-8601-date="1980">1980</year><chapter-title>Diffusion and ecological problems: mathematical models</chapter-title><person-group person-group-type="editor"><name><surname>Andersson</surname><given-names>S</given-names></name></person-group><source>Biomathematics</source><publisher-loc>Berlin, Heidelberg &amp; New York</publisher-loc><publisher-name>Springer-Verlag</publisher-name><fpage>254</fpage><lpage>272</lpage><pub-id pub-id-type="doi">10.1016/B978-0-444-50273-5.X5025-3</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Othmer</surname><given-names>HG</given-names></name><name><surname>Dunbar</surname><given-names>SR</given-names></name><name><surname>Alt</surname><given-names>W</given-names></name></person-group><year iso-8601-date="1988">1988</year><article-title>Models of dispersal in biological systems</article-title><source>Journal of Mathematical Biology</source><volume>26</volume><fpage>263</fpage><lpage>298</lpage><pub-id pub-id-type="doi">10.1007/BF00277392</pub-id><pub-id pub-id-type="pmid">3411255</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Painter</surname><given-names>KJ</given-names></name><name><surname>Hillen</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>From random walks to fully anisotropic diffusion models for cell and animal movement</article-title><source>In Cell Movement</source><volume>786</volume><fpage>103</fpage><lpage>141</lpage><pub-id pub-id-type="doi">10.1007/978-3-319-96842-1_5</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peter</surname><given-names>BM</given-names></name><name><surname>Huerta-Sanchez</surname><given-names>E</given-names></name><name><surname>Nielsen</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Distinguishing between selective sweeps from standing variation and from a de novo mutation</article-title><source>PLOS Genetics</source><volume>8</volume><elocation-id>e1003011</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1003011</pub-id><pub-id pub-id-type="pmid">23071458</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Petr</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>Bodkan/slendr</data-title><version designator="0.4.0">0.4.0</version><source>Github</source><ext-link ext-link-type="uri" xlink:href="https://github.com/bodkan/slendr/">https://github.com/bodkan/slendr/</ext-link></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pickrell</surname><given-names>JK</given-names></name><name><surname>Coop</surname><given-names>G</given-names></name><name><surname>Novembre</surname><given-names>J</given-names></name><name><surname>Kudaravalli</surname><given-names>S</given-names></name><name><surname>Li</surname><given-names>JZ</given-names></name><name><surname>Absher</surname><given-names>D</given-names></name><name><surname>Srinivasan</surname><given-names>BS</given-names></name><name><surname>Barsh</surname><given-names>GS</given-names></name><name><surname>Myers</surname><given-names>RM</given-names></name><name><surname>Feldman</surname><given-names>MW</given-names></name><name><surname>Pritchard</surname><given-names>JK</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Signals of recent positive selection in a worldwide sample of human populations</article-title><source>Genome Research</source><volume>19</volume><fpage>826</fpage><lpage>837</lpage><pub-id pub-id-type="doi">10.1101/gr.087577.108</pub-id><pub-id pub-id-type="pmid">19307593</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Platt</surname><given-names>A</given-names></name><name><surname>Pivirotto</surname><given-names>A</given-names></name><name><surname>Knoblauch</surname><given-names>J</given-names></name><name><surname>Hey</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>An estimator of first coalescent time reveals selection on young variants and large heterogeneity in rare allele ages among human populations</article-title><source>PLOS Genetics</source><volume>15</volume><elocation-id>e1008340</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1008340</pub-id><pub-id pub-id-type="pmid">31425500</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pritchard</surname><given-names>JK</given-names></name><name><surname>Di Rienzo</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Adaptation-not by sweeps alone</article-title><source>Nature Reviews. Genetics</source><volume>11</volume><fpage>665</fpage><lpage>667</lpage><pub-id pub-id-type="doi">10.1038/nrg2880</pub-id><pub-id pub-id-type="pmid">20838407</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Racimo</surname><given-names>F</given-names></name><name><surname>Sikora</surname><given-names>M</given-names></name><name><surname>Vander Linden</surname><given-names>M</given-names></name><name><surname>Schroeder</surname><given-names>H</given-names></name><name><surname>Lalueza-Fox</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2020">2020a</year><article-title>Beyond broad strokes: sociocultural insights from the study of ancient genomes</article-title><source>Nature Reviews. Genetics</source><volume>21</volume><fpage>355</fpage><lpage>366</lpage><pub-id pub-id-type="doi">10.1038/s41576-020-0218-z</pub-id><pub-id pub-id-type="pmid">32127690</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Racimo</surname><given-names>F</given-names></name><name><surname>Woodbridge</surname><given-names>J</given-names></name><name><surname>Fyfe</surname><given-names>RM</given-names></name><name><surname>Sikora</surname><given-names>M</given-names></name><name><surname>Sjögren</surname><given-names>KG</given-names></name><name><surname>Kristiansen</surname><given-names>K</given-names></name><name><surname>Vander Linden</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2020">2020b</year><article-title>The spatiotemporal spread of human migrations during the european holocene</article-title><source>PNAS</source><volume>117</volume><fpage>8989</fpage><lpage>9000</lpage><pub-id pub-id-type="doi">10.1073/pnas.1920051117</pub-id><pub-id pub-id-type="pmid">32238559</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ralph</surname><given-names>P</given-names></name><name><surname>Coop</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Parallel adaptation: one or many waves of advance of an advantageous allele?</article-title><source>Genetics</source><volume>186</volume><fpage>647</fpage><lpage>668</lpage><pub-id pub-id-type="doi">10.1534/genetics.110.119594</pub-id><pub-id pub-id-type="pmid">20660645</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ray</surname><given-names>N</given-names></name><name><surname>Excoffier</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Inferring past demography using spatially explicit population genetic models</article-title><source>Human Biology</source><volume>81</volume><fpage>141</fpage><lpage>157</lpage><pub-id pub-id-type="doi">10.3378/027.081.0303</pub-id><pub-id pub-id-type="pmid">19943741</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Reich</surname><given-names>D</given-names></name><name><surname>Mallick</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>Allen ancient dna resource (aadr): downloadable genotypes of present-day and ancient dna data</data-title><version designator="V54.1">V54.1</version><source>AADR</source><ext-link ext-link-type="uri" xlink:href="https://reich.hms.harvard.edu/allen-ancient-dna-resource-aadr-downloadable-genotypes-present-day-and-ancient-dna-data">https://reich.hms.harvard.edu/allen-ancient-dna-resource-aadr-downloadable-genotypes-present-day-and-ancient-dna-data</ext-link></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sabeti</surname><given-names>PC</given-names></name><name><surname>Walsh</surname><given-names>E</given-names></name><name><surname>Schaffner</surname><given-names>SF</given-names></name><name><surname>Varilly</surname><given-names>P</given-names></name><name><surname>Fry</surname><given-names>B</given-names></name><name><surname>Hutcheson</surname><given-names>HB</given-names></name><name><surname>Cullen</surname><given-names>M</given-names></name><name><surname>Mikkelsen</surname><given-names>TS</given-names></name><name><surname>Roy</surname><given-names>J</given-names></name><name><surname>Patterson</surname><given-names>N</given-names></name><name><surname>Cooper</surname><given-names>R</given-names></name><name><surname>Reich</surname><given-names>D</given-names></name><name><surname>Altshuler</surname><given-names>D</given-names></name><name><surname>O’Brien</surname><given-names>S</given-names></name><name><surname>Lander</surname><given-names>ES</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>The case for selection at CCR5-delta32</article-title><source>PLOS Biology</source><volume>3</volume><elocation-id>e378</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.0030378</pub-id><pub-id pub-id-type="pmid">16248677</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sabeti</surname><given-names>PC</given-names></name><name><surname>Varilly</surname><given-names>P</given-names></name><name><surname>Fry</surname><given-names>B</given-names></name><name><surname>Lohmueller</surname><given-names>J</given-names></name><name><surname>Hostetter</surname><given-names>E</given-names></name><name><surname>Cotsapas</surname><given-names>C</given-names></name><name><surname>Xie</surname><given-names>X</given-names></name><name><surname>Byrne</surname><given-names>EH</given-names></name><name><surname>McCarroll</surname><given-names>SA</given-names></name><name><surname>Gaudet</surname><given-names>R</given-names></name><name><surname>Schaffner</surname><given-names>SF</given-names></name><name><surname>Lander</surname><given-names>ES</given-names></name><collab>International HapMap Consortium</collab><name><surname>Frazer</surname><given-names>KA</given-names></name><name><surname>Ballinger</surname><given-names>DG</given-names></name><name><surname>Cox</surname><given-names>DR</given-names></name><name><surname>Hinds</surname><given-names>DA</given-names></name><name><surname>Stuve</surname><given-names>LL</given-names></name><name><surname>Gibbs</surname><given-names>RA</given-names></name><name><surname>Belmont</surname><given-names>JW</given-names></name><name><surname>Boudreau</surname><given-names>A</given-names></name><name><surname>Hardenbol</surname><given-names>P</given-names></name><name><surname>Leal</surname><given-names>SM</given-names></name><name><surname>Pasternak</surname><given-names>S</given-names></name><name><surname>Wheeler</surname><given-names>DA</given-names></name><name><surname>Willis</surname><given-names>TD</given-names></name><name><surname>Yu</surname><given-names>F</given-names></name><name><surname>Yang</surname><given-names>H</given-names></name><name><surname>Zeng</surname><given-names>C</given-names></name><name><surname>Gao</surname><given-names>Y</given-names></name><name><surname>Hu</surname><given-names>H</given-names></name><name><surname>Hu</surname><given-names>W</given-names></name><name><surname>Li</surname><given-names>C</given-names></name><name><surname>Lin</surname><given-names>W</given-names></name><name><surname>Liu</surname><given-names>S</given-names></name><name><surname>Pan</surname><given-names>H</given-names></name><name><surname>Tang</surname><given-names>X</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Wang</surname><given-names>W</given-names></name><name><surname>Yu</surname><given-names>J</given-names></name><name><surname>Zhang</surname><given-names>B</given-names></name><name><surname>Zhang</surname><given-names>Q</given-names></name><name><surname>Zhao</surname><given-names>H</given-names></name><name><surname>Zhao</surname><given-names>H</given-names></name><name><surname>Zhou</surname><given-names>J</given-names></name><name><surname>Gabriel</surname><given-names>SB</given-names></name><name><surname>Barry</surname><given-names>R</given-names></name><name><surname>Blumenstiel</surname><given-names>B</given-names></name><name><surname>Camargo</surname><given-names>A</given-names></name><name><surname>Defelice</surname><given-names>M</given-names></name><name><surname>Faggart</surname><given-names>M</given-names></name><name><surname>Goyette</surname><given-names>M</given-names></name><name><surname>Gupta</surname><given-names>S</given-names></name><name><surname>Moore</surname><given-names>J</given-names></name><name><surname>Nguyen</surname><given-names>H</given-names></name><name><surname>Onofrio</surname><given-names>RC</given-names></name><name><surname>Parkin</surname><given-names>M</given-names></name><name><surname>Roy</surname><given-names>J</given-names></name><name><surname>Stahl</surname><given-names>E</given-names></name><name><surname>Winchester</surname><given-names>E</given-names></name><name><surname>Ziaugra</surname><given-names>L</given-names></name><name><surname>Altshuler</surname><given-names>D</given-names></name><name><surname>Shen</surname><given-names>Y</given-names></name><name><surname>Yao</surname><given-names>Z</given-names></name><name><surname>Huang</surname><given-names>W</given-names></name><name><surname>Chu</surname><given-names>X</given-names></name><name><surname>He</surname><given-names>Y</given-names></name><name><surname>Jin</surname><given-names>L</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name><name><surname>Shen</surname><given-names>Y</given-names></name><name><surname>Sun</surname><given-names>W</given-names></name><name><surname>Wang</surname><given-names>H</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Xiong</surname><given-names>X</given-names></name><name><surname>Xu</surname><given-names>L</given-names></name><name><surname>Waye</surname><given-names>MMY</given-names></name><name><surname>Tsui</surname><given-names>SKW</given-names></name><name><surname>Xue</surname><given-names>H</given-names></name><name><surname>Wong</surname><given-names>JT-F</given-names></name><name><surname>Galver</surname><given-names>LM</given-names></name><name><surname>Fan</surname><given-names>J-B</given-names></name><name><surname>Gunderson</surname><given-names>K</given-names></name><name><surname>Murray</surname><given-names>SS</given-names></name><name><surname>Oliphant</surname><given-names>AR</given-names></name><name><surname>Chee</surname><given-names>MS</given-names></name><name><surname>Montpetit</surname><given-names>A</given-names></name><name><surname>Chagnon</surname><given-names>F</given-names></name><name><surname>Ferretti</surname><given-names>V</given-names></name><name><surname>Leboeuf</surname><given-names>M</given-names></name><name><surname>Olivier</surname><given-names>J-F</given-names></name><name><surname>Phillips</surname><given-names>MS</given-names></name><name><surname>Roumy</surname><given-names>S</given-names></name><name><surname>Sallée</surname><given-names>C</given-names></name><name><surname>Verner</surname><given-names>A</given-names></name><name><surname>Hudson</surname><given-names>TJ</given-names></name><name><surname>Kwok</surname><given-names>P-Y</given-names></name><name><surname>Cai</surname><given-names>D</given-names></name><name><surname>Koboldt</surname><given-names>DC</given-names></name><name><surname>Miller</surname><given-names>RD</given-names></name><name><surname>Pawlikowska</surname><given-names>L</given-names></name><name><surname>Taillon-Miller</surname><given-names>P</given-names></name><name><surname>Xiao</surname><given-names>M</given-names></name><name><surname>Tsui</surname><given-names>L-C</given-names></name><name><surname>Mak</surname><given-names>W</given-names></name><name><surname>Song</surname><given-names>YQ</given-names></name><name><surname>Tam</surname><given-names>PKH</given-names></name><name><surname>Nakamura</surname><given-names>Y</given-names></name><name><surname>Kawaguchi</surname><given-names>T</given-names></name><name><surname>Kitamoto</surname><given-names>T</given-names></name><name><surname>Morizono</surname><given-names>T</given-names></name><name><surname>Nagashima</surname><given-names>A</given-names></name><name><surname>Ohnishi</surname><given-names>Y</given-names></name><name><surname>Sekine</surname><given-names>A</given-names></name><name><surname>Tanaka</surname><given-names>T</given-names></name><name><surname>Tsunoda</surname><given-names>T</given-names></name><name><surname>Deloukas</surname><given-names>P</given-names></name><name><surname>Bird</surname><given-names>CP</given-names></name><name><surname>Delgado</surname><given-names>M</given-names></name><name><surname>Dermitzakis</surname><given-names>ET</given-names></name><name><surname>Gwilliam</surname><given-names>R</given-names></name><name><surname>Hunt</surname><given-names>S</given-names></name><name><surname>Morrison</surname><given-names>J</given-names></name><name><surname>Powell</surname><given-names>D</given-names></name><name><surname>Stranger</surname><given-names>BE</given-names></name><name><surname>Whittaker</surname><given-names>P</given-names></name><name><surname>Bentley</surname><given-names>DR</given-names></name><name><surname>Daly</surname><given-names>MJ</given-names></name><name><surname>de Bakker</surname><given-names>PIW</given-names></name><name><surname>Barrett</surname><given-names>J</given-names></name><name><surname>Chretien</surname><given-names>YR</given-names></name><name><surname>Maller</surname><given-names>J</given-names></name><name><surname>McCarroll</surname><given-names>S</given-names></name><name><surname>Patterson</surname><given-names>N</given-names></name><name><surname>Pe’er</surname><given-names>I</given-names></name><name><surname>Price</surname><given-names>A</given-names></name><name><surname>Purcell</surname><given-names>S</given-names></name><name><surname>Richter</surname><given-names>DJ</given-names></name><name><surname>Sabeti</surname><given-names>P</given-names></name><name><surname>Saxena</surname><given-names>R</given-names></name><name><surname>Schaffner</surname><given-names>SF</given-names></name><name><surname>Sham</surname><given-names>PC</given-names></name><name><surname>Varilly</surname><given-names>P</given-names></name><name><surname>Altshuler</surname><given-names>D</given-names></name><name><surname>Stein</surname><given-names>LD</given-names></name><name><surname>Krishnan</surname><given-names>L</given-names></name><name><surname>Smith</surname><given-names>AV</given-names></name><name><surname>Tello-Ruiz</surname><given-names>MK</given-names></name><name><surname>Thorisson</surname><given-names>GA</given-names></name><name><surname>Chakravarti</surname><given-names>A</given-names></name><name><surname>Chen</surname><given-names>PE</given-names></name><name><surname>Cutler</surname><given-names>DJ</given-names></name><name><surname>Kashuk</surname><given-names>CS</given-names></name><name><surname>Lin</surname><given-names>S</given-names></name><name><surname>Abecasis</surname><given-names>GR</given-names></name><name><surname>Guan</surname><given-names>W</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Munro</surname><given-names>HM</given-names></name><name><surname>Qin</surname><given-names>ZS</given-names></name><name><surname>Thomas</surname><given-names>DJ</given-names></name><name><surname>McVean</surname><given-names>G</given-names></name><name><surname>Auton</surname><given-names>A</given-names></name><name><surname>Bottolo</surname><given-names>L</given-names></name><name><surname>Cardin</surname><given-names>N</given-names></name><name><surname>Eyheramendy</surname><given-names>S</given-names></name><name><surname>Freeman</surname><given-names>C</given-names></name><name><surname>Marchini</surname><given-names>J</given-names></name><name><surname>Myers</surname><given-names>S</given-names></name><name><surname>Spencer</surname><given-names>C</given-names></name><name><surname>Stephens</surname><given-names>M</given-names></name><name><surname>Donnelly</surname><given-names>P</given-names></name><name><surname>Cardon</surname><given-names>LR</given-names></name><name><surname>Clarke</surname><given-names>G</given-names></name><name><surname>Evans</surname><given-names>DM</given-names></name><name><surname>Morris</surname><given-names>AP</given-names></name><name><surname>Weir</surname><given-names>BS</given-names></name><name><surname>Tsunoda</surname><given-names>T</given-names></name><name><surname>Johnson</surname><given-names>TA</given-names></name><name><surname>Mullikin</surname><given-names>JC</given-names></name><name><surname>Sherry</surname><given-names>ST</given-names></name><name><surname>Feolo</surname><given-names>M</given-names></name><name><surname>Skol</surname><given-names>A</given-names></name><name><surname>Zhang</surname><given-names>H</given-names></name><name><surname>Zeng</surname><given-names>C</given-names></name><name><surname>Zhao</surname><given-names>H</given-names></name><name><surname>Matsuda</surname><given-names>I</given-names></name><name><surname>Fukushima</surname><given-names>Y</given-names></name><name><surname>Macer</surname><given-names>DR</given-names></name><name><surname>Suda</surname><given-names>E</given-names></name><name><surname>Rotimi</surname><given-names>CN</given-names></name><name><surname>Adebamowo</surname><given-names>CA</given-names></name><name><surname>Ajayi</surname><given-names>I</given-names></name><name><surname>Aniagwu</surname><given-names>T</given-names></name><name><surname>Marshall</surname><given-names>PA</given-names></name><name><surname>Nkwodimmah</surname><given-names>C</given-names></name><name><surname>Royal</surname><given-names>CDM</given-names></name><name><surname>Leppert</surname><given-names>MF</given-names></name><name><surname>Dixon</surname><given-names>M</given-names></name><name><surname>Peiffer</surname><given-names>A</given-names></name><name><surname>Qiu</surname><given-names>R</given-names></name><name><surname>Kent</surname><given-names>A</given-names></name><name><surname>Kato</surname><given-names>K</given-names></name><name><surname>Niikawa</surname><given-names>N</given-names></name><name><surname>Adewole</surname><given-names>IF</given-names></name><name><surname>Knoppers</surname><given-names>BM</given-names></name><name><surname>Foster</surname><given-names>MW</given-names></name><name><surname>Clayton</surname><given-names>EW</given-names></name><name><surname>Watkin</surname><given-names>J</given-names></name><name><surname>Gibbs</surname><given-names>RA</given-names></name><name><surname>Belmont</surname><given-names>JW</given-names></name><name><surname>Muzny</surname><given-names>D</given-names></name><name><surname>Nazareth</surname><given-names>L</given-names></name><name><surname>Sodergren</surname><given-names>E</given-names></name><name><surname>Weinstock</surname><given-names>GM</given-names></name><name><surname>Wheeler</surname><given-names>DA</given-names></name><name><surname>Yakub</surname><given-names>I</given-names></name><name><surname>Gabriel</surname><given-names>SB</given-names></name><name><surname>Onofrio</surname><given-names>RC</given-names></name><name><surname>Richter</surname><given-names>DJ</given-names></name><name><surname>Ziaugra</surname><given-names>L</given-names></name><name><surname>Birren</surname><given-names>BW</given-names></name><name><surname>Daly</surname><given-names>MJ</given-names></name><name><surname>Altshuler</surname><given-names>D</given-names></name><name><surname>Wilson</surname><given-names>RK</given-names></name><name><surname>Fulton</surname><given-names>LL</given-names></name><name><surname>Rogers</surname><given-names>J</given-names></name><name><surname>Burton</surname><given-names>J</given-names></name><name><surname>Carter</surname><given-names>NP</given-names></name><name><surname>Clee</surname><given-names>CM</given-names></name><name><surname>Griffiths</surname><given-names>M</given-names></name><name><surname>Jones</surname><given-names>MC</given-names></name><name><surname>McLay</surname><given-names>K</given-names></name><name><surname>Plumb</surname><given-names>RW</given-names></name><name><surname>Ross</surname><given-names>MT</given-names></name><name><surname>Sims</surname><given-names>SK</given-names></name><name><surname>Willey</surname><given-names>DL</given-names></name><name><surname>Chen</surname><given-names>Z</given-names></name><name><surname>Han</surname><given-names>H</given-names></name><name><surname>Kang</surname><given-names>L</given-names></name><name><surname>Godbout</surname><given-names>M</given-names></name><name><surname>Wallenburg</surname><given-names>JC</given-names></name><name><surname>L’Archevêque</surname><given-names>P</given-names></name><name><surname>Bellemare</surname><given-names>G</given-names></name><name><surname>Saeki</surname><given-names>K</given-names></name><name><surname>Wang</surname><given-names>H</given-names></name><name><surname>An</surname><given-names>D</given-names></name><name><surname>Fu</surname><given-names>H</given-names></name><name><surname>Li</surname><given-names>Q</given-names></name><name><surname>Wang</surname><given-names>Z</given-names></name><name><surname>Wang</surname><given-names>R</given-names></name><name><surname>Holden</surname><given-names>AL</given-names></name><name><surname>Brooks</surname><given-names>LD</given-names></name><name><surname>McEwen</surname><given-names>JE</given-names></name><name><surname>Guyer</surname><given-names>MS</given-names></name><name><surname>Wang</surname><given-names>VO</given-names></name><name><surname>Peterson</surname><given-names>JL</given-names></name><name><surname>Shi</surname><given-names>M</given-names></name><name><surname>Spiegel</surname><given-names>J</given-names></name><name><surname>Sung</surname><given-names>LM</given-names></name><name><surname>Zacharia</surname><given-names>LF</given-names></name><name><surname>Collins</surname><given-names>FS</given-names></name><name><surname>Kennedy</surname><given-names>K</given-names></name><name><surname>Jamieson</surname><given-names>R</given-names></name><name><surname>Stewart</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Genome-Wide detection and characterization of positive selection in human populations</article-title><source>Nature</source><volume>449</volume><fpage>913</fpage><lpage>918</lpage><pub-id pub-id-type="doi">10.1038/nature06250</pub-id><pub-id pub-id-type="pmid">17943131</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ségurel</surname><given-names>L</given-names></name><name><surname>Bon</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>On the evolution of lactase persistence in humans</article-title><source>Annual Review of Genomics and Human Genetics</source><volume>18</volume><fpage>297</fpage><lpage>319</lpage><pub-id pub-id-type="doi">10.1146/annurev-genom-091416-035340</pub-id><pub-id pub-id-type="pmid">28426286</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Segurel</surname><given-names>L</given-names></name><name><surname>Guarino-Vignon</surname><given-names>P</given-names></name><name><surname>Marchi</surname><given-names>N</given-names></name><name><surname>Lafosse</surname><given-names>S</given-names></name><name><surname>Laurent</surname><given-names>R</given-names></name><name><surname>Bon</surname><given-names>C</given-names></name><name><surname>Fabre</surname><given-names>A</given-names></name><name><surname>Hegay</surname><given-names>T</given-names></name><name><surname>Heyer</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Why and when was lactase persistence selected for? insights from central Asian herders and ancient DNA</article-title><source>PLOS Biology</source><volume>18</volume><elocation-id>e3000742</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.3000742</pub-id><pub-id pub-id-type="pmid">32511234</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Slatkin</surname><given-names>M</given-names></name><name><surname>Rannala</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Estimating allele age</article-title><source>Annual Review of Genomics and Human Genetics</source><volume>1</volume><fpage>225</fpage><lpage>249</lpage><pub-id pub-id-type="doi">10.1146/annurev.genom.1.1.225</pub-id><pub-id pub-id-type="pmid">11701630</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soetaert</surname><given-names>K</given-names></name><name><surname>Petzoldt</surname><given-names>T</given-names></name><name><surname>Setzer</surname><given-names>RW</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Solving differential equations in R: package desolve</article-title><source>Journal of Statistical Software</source><volume>33</volume><fpage>1</fpage><lpage>25</lpage><pub-id pub-id-type="doi">10.18637/jss.v033.i09</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soetaert</surname><given-names>K</given-names></name><name><surname>Meysman</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Reactive transport in aquatic ecosystems: rapid model prototyping in the open source software R</article-title><source>Environmental Modelling &amp; Software</source><volume>32</volume><fpage>49</fpage><lpage>60</lpage><pub-id pub-id-type="doi">10.1016/j.envsoft.2011.08.011</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stephens</surname><given-names>JC</given-names></name><name><surname>Reich</surname><given-names>DE</given-names></name><name><surname>Goldstein</surname><given-names>DB</given-names></name><name><surname>Shin</surname><given-names>HD</given-names></name><name><surname>Smith</surname><given-names>MW</given-names></name><name><surname>Carrington</surname><given-names>M</given-names></name><name><surname>Winkler</surname><given-names>C</given-names></name><name><surname>Huttley</surname><given-names>GA</given-names></name><name><surname>Allikmets</surname><given-names>R</given-names></name><name><surname>Schriml</surname><given-names>L</given-names></name><name><surname>Gerrard</surname><given-names>B</given-names></name><name><surname>Malasky</surname><given-names>M</given-names></name><name><surname>Ramos</surname><given-names>MD</given-names></name><name><surname>Morlot</surname><given-names>S</given-names></name><name><surname>Tzetis</surname><given-names>M</given-names></name><name><surname>Oddoux</surname><given-names>C</given-names></name><name><surname>di Giovine</surname><given-names>FS</given-names></name><name><surname>Nasioulas</surname><given-names>G</given-names></name><name><surname>Chandler</surname><given-names>D</given-names></name><name><surname>Aseev</surname><given-names>M</given-names></name><name><surname>Hanson</surname><given-names>M</given-names></name><name><surname>Kalaydjieva</surname><given-names>L</given-names></name><name><surname>Glavac</surname><given-names>D</given-names></name><name><surname>Gasparini</surname><given-names>P</given-names></name><name><surname>Kanavakis</surname><given-names>E</given-names></name><name><surname>Claustres</surname><given-names>M</given-names></name><name><surname>Kambouris</surname><given-names>M</given-names></name><name><surname>Ostrer</surname><given-names>H</given-names></name><name><surname>Duff</surname><given-names>G</given-names></name><name><surname>Baranov</surname><given-names>V</given-names></name><name><surname>Sibul</surname><given-names>H</given-names></name><name><surname>Metspalu</surname><given-names>A</given-names></name><name><surname>Goldman</surname><given-names>D</given-names></name><name><surname>Martin</surname><given-names>N</given-names></name><name><surname>Duffy</surname><given-names>D</given-names></name><name><surname>Schmidtke</surname><given-names>J</given-names></name><name><surname>Estivill</surname><given-names>X</given-names></name><name><surname>O’Brien</surname><given-names>SJ</given-names></name><name><surname>Dean</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Dating the origin of the CCR5-delta32 AIDS-resistance allele by the coalescence of haplotypes</article-title><source>American Journal of Human Genetics</source><volume>62</volume><fpage>1507</fpage><lpage>1515</lpage><pub-id pub-id-type="doi">10.1086/301867</pub-id><pub-id pub-id-type="pmid">9585595</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stern</surname><given-names>AJ</given-names></name><name><surname>Wilton</surname><given-names>PR</given-names></name><name><surname>Nielsen</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>An approximate full-likelihood method for inferring selection and allele frequency trajectories from DNA sequence data</article-title><source>PLOS Genetics</source><volume>15</volume><elocation-id>e1008384</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1008384</pub-id><pub-id pub-id-type="pmid">31518343</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Szpak</surname><given-names>M</given-names></name><name><surname>Xue</surname><given-names>Y</given-names></name><name><surname>Ayub</surname><given-names>Q</given-names></name><name><surname>Tyler-Smith</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>How well do we understand the basis of classic selective sweeps in humans?</article-title><source>FEBS Letters</source><volume>593</volume><fpage>1431</fpage><lpage>1448</lpage><pub-id pub-id-type="doi">10.1002/1873-3468.13447</pub-id><pub-id pub-id-type="pmid">31116407</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tishkoff</surname><given-names>SA</given-names></name><name><surname>Reed</surname><given-names>FA</given-names></name><name><surname>Ranciaro</surname><given-names>A</given-names></name><name><surname>Voight</surname><given-names>BF</given-names></name><name><surname>Babbitt</surname><given-names>CC</given-names></name><name><surname>Silverman</surname><given-names>JS</given-names></name><name><surname>Powell</surname><given-names>K</given-names></name><name><surname>Mortensen</surname><given-names>HM</given-names></name><name><surname>Hirbo</surname><given-names>JB</given-names></name><name><surname>Osman</surname><given-names>M</given-names></name><name><surname>Ibrahim</surname><given-names>M</given-names></name><name><surname>Omar</surname><given-names>SA</given-names></name><name><surname>Lema</surname><given-names>G</given-names></name><name><surname>Nyambo</surname><given-names>TB</given-names></name><name><surname>Ghori</surname><given-names>J</given-names></name><name><surname>Bumpstead</surname><given-names>S</given-names></name><name><surname>Pritchard</surname><given-names>JK</given-names></name><name><surname>Wray</surname><given-names>GA</given-names></name><name><surname>Deloukas</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Convergent adaptation of human lactase persistence in Africa and Europe</article-title><source>Nature Genetics</source><volume>39</volume><fpage>31</fpage><lpage>40</lpage><pub-id pub-id-type="doi">10.1038/ng1946</pub-id><pub-id pub-id-type="pmid">17159977</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Voight</surname><given-names>BF</given-names></name><name><surname>Kudaravalli</surname><given-names>S</given-names></name><name><surname>Wen</surname><given-names>X</given-names></name><name><surname>Pritchard</surname><given-names>JK</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>A map of recent positive selection in the human genome</article-title><source>PLOS Biology</source><volume>4</volume><elocation-id>e72</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.0040072</pub-id><pub-id pub-id-type="pmid">16494531</pub-id></element-citation></ref><ref id="bib90"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Wikle</surname><given-names>CK</given-names></name><name><surname>Zammit-Mangion</surname><given-names>A</given-names></name><name><surname>Cressie</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2019">2019</year><source>Spatio-Temporal Statistics with R</source><publisher-loc>Boca Raton, Florida : CRC Press</publisher-loc><publisher-name>CRC Press</publisher-name><pub-id pub-id-type="doi">10.1201/9781351769723</pub-id></element-citation></ref><ref id="bib91"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilde</surname><given-names>S</given-names></name><name><surname>Timpson</surname><given-names>A</given-names></name><name><surname>Kirsanow</surname><given-names>K</given-names></name><name><surname>Kaiser</surname><given-names>E</given-names></name><name><surname>Kayser</surname><given-names>M</given-names></name><name><surname>Unterländer</surname><given-names>M</given-names></name><name><surname>Hollfelder</surname><given-names>N</given-names></name><name><surname>Potekhina</surname><given-names>ID</given-names></name><name><surname>Schier</surname><given-names>W</given-names></name><name><surname>Thomas</surname><given-names>MG</given-names></name><name><surname>Burger</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Direct evidence for positive selection of skin, hair, and eye pigmentation in europeans during the last 5,000 Y</article-title><source>PNAS</source><volume>111</volume><fpage>4832</fpage><lpage>4837</lpage><pub-id pub-id-type="doi">10.1073/pnas.1316513111</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><p>Here, we motivate the construction of model C as a large-scale limit of a random walk model on a lattice (<xref ref-type="bibr" rid="bib43">Karlin and Taylor, 1975</xref>; <xref ref-type="bibr" rid="bib14">Cantrell and Cosner, 2004</xref>). We think of the allele frequency as a variable <inline-formula><mml:math id="inf40"><mml:mi>p</mml:mi></mml:math></inline-formula> that can increase in magnitude due to its inherent advantage (selection), spread across a landscape (diffusion) or move directionally as a consequence of migration (advection). We imagine a lattice composed of small square cells of size <inline-formula><mml:math id="inf41"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula> x <inline-formula><mml:math id="inf42"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:math></inline-formula>, where a certain amount of allele frequency <inline-formula><mml:math id="inf43"><mml:mi>p</mml:mi></mml:math></inline-formula> can occur at a given time point <inline-formula><mml:math id="inf44"><mml:mi>t</mml:mi></mml:math></inline-formula>. At each small time step (of duration <inline-formula><mml:math id="inf45"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>), inflow and outflow of p can occur in the x-direction with probability h or in the y-direction with probability 1h, and the magnitude of these flows depend on the amount of <inline-formula><mml:math id="inf46"><mml:mi>p</mml:mi></mml:math></inline-formula> present in neighboring cells. If flow of p is along the x-axis, it does so in the positive direction with probability <inline-formula><mml:math id="inf47"><mml:mi>α</mml:mi></mml:math></inline-formula> and in the negative direction with probability <inline-formula><mml:math id="inf48"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:math></inline-formula>. If flow of p is along the y-axis, it does so in the positive direction with probability <inline-formula><mml:math id="inf49"><mml:mi>β</mml:mi></mml:math></inline-formula> and in the negative direction with probability <inline-formula><mml:math id="inf50"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:math></inline-formula>. The allele frequency can also increase in magnitude locally via a function <inline-formula><mml:math id="inf51"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> that depends on its dominance (d), selection coefficient (s) and current magnitude (<inline-formula><mml:math id="inf52"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>). Then, we obtain:<disp-formula id="equ9"><label>(8)</label><mml:math id="m9"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow/><mml:mi>γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mi>h</mml:mi><mml:mi>α</mml:mi><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>β</mml:mi><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We can also write this as:<disp-formula id="equ10"><label>(9)</label><mml:math id="m10"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow/><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>−</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:mi>h</mml:mi><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>If we divide both sides by <inline-formula><mml:math id="inf53"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> and take the limit of infinitesimally small <inline-formula><mml:math id="inf54"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf55"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf56"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>, while assuming that, in this limit, <inline-formula><mml:math id="inf57"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula> and <inline-formula><mml:math id="inf58"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula> are finite (<xref ref-type="bibr" rid="bib65">Okubo, 1980</xref>), we obtain:<disp-formula id="equ11"><label>(10)</label><mml:math id="m11"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>h</mml:mi><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf59"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf60"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf61"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf62"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>.</p><p>If we let <inline-formula><mml:math id="inf63"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf64"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf65"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf66"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, then we obtain <xref ref-type="disp-formula" rid="equ4">Equation 4</xref>. Thus, we can see that the squared diffusion coefficient <inline-formula><mml:math id="inf67"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> depends on the square of the length of the cells in the x-axis relative to the duration of a time step (<inline-formula><mml:math id="inf68"><mml:msub><mml:mi>λ</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula>), and on the probability that flows occurs in the x-axis at a given time step (<inline-formula><mml:math id="inf69"><mml:mi>h</mml:mi></mml:math></inline-formula>). Similarly, the squared diffusion coefficient <inline-formula><mml:math id="inf70"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> depends on the square of the length of the cells in the y-axis relative to the duration of a time step (<inline-formula><mml:math id="inf71"><mml:msub><mml:mi>λ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula>), and on the probability that flows occurs in the y-axis at a given time step (<inline-formula><mml:math id="inf72"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:math></inline-formula>). The advection coefficient <italic>v</italic><sub><italic>x</italic></sub> depends on the advective velocity along the x-axis (<italic>u</italic><sub><italic>x</italic></sub>) as well as on the probability of flow occurring along the x-axis (<inline-formula><mml:math id="inf73"><mml:mi>h</mml:mi></mml:math></inline-formula>) and the directional bias <inline-formula><mml:math id="inf74"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, which depends on the probability that flow occurs in the positive x-direction (<inline-formula><mml:math id="inf75"><mml:mi>α</mml:mi></mml:math></inline-formula>). Finally, the advection coefficient <italic>v</italic><sub><italic>y</italic></sub> depends on the advective velocity along the y-axis (<italic>u</italic><sub><italic>y</italic></sub>), as well as on the probability of flow occurring along the y-axis (<inline-formula><mml:math id="inf76"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:math></inline-formula>) and the directional bias <inline-formula><mml:math id="inf77"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, which depends on the probability that flow occurs in the positive y-direction (<inline-formula><mml:math id="inf78"><mml:mi>β</mml:mi></mml:math></inline-formula>).</p><p>We can recover model B as a special case of model C if we fix <inline-formula><mml:math id="inf79"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula>, assuming isotropy in the two directions, so that <inline-formula><mml:math id="inf80"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. We can also recover model A if we additionally fix <inline-formula><mml:math id="inf81"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula>.</p></app><app id="appendix-2"><title>Appendix 2</title><fig id="app2fig1" position="float"><label>Appendix 2—figure 1.</label><caption><title>Maps showing areas where diffusion in the model is allowed (green) and where it is forbidden (blue).</title><p>(<bold>a</bold>) Map without land bridges. (<bold>b</bold>) Map containing land bridges indicated with red circles.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-app2-fig1-v1.tif"/></fig><fig id="app2fig2" position="float"><label>Appendix 2—figure 2.</label><caption><title>Geographic locations for points used as potential origins of the allele at the initialization of the simulated annealing optimization algorithm.</title><p>Note that, after initialization, the algorithm can continuously explore any points on the map grid that are not necessarily included in this point set.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-app2-fig2-v1.tif"/></fig><fig id="app2fig3" position="float"><label>Appendix 2—figure 3.</label><caption><title>Log-likelihood as a function of selection coefficient and age of the allele.</title><p>Dark blue regions correspond to optimal solutions.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-73767-app2-fig3-v1.tif"/></fig><table-wrap id="app2table1" position="float"><label>Appendix 2—table 1.</label><caption><title>Parameter values used to generate simulations using numerical solutions to <xref ref-type="disp-formula" rid="equ3">Equation 3</xref> compared to parameter estimates assuming model B.</title><p>The age of the allele was set to 29,000 years in all simulations. Columns named ‘long’ and ‘lat’ indicate the longitude and latitude of the geographic origin of the allele, respectively.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom" rowspan="2" colspan="2">Simulation</th><th align="center" valign="bottom"><inline-formula><mml:math id="inf82"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th align="center" valign="bottom"><inline-formula><mml:math id="inf83"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (km<sup>2</sup>/gen)</th><th align="center" valign="bottom"><inline-formula><mml:math id="inf84"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (km<sup>2</sup>/gen)</th><th align="center" valign="bottom">Long</th><th align="center" valign="bottom">Lat</th></tr><tr><th align="center" valign="bottom">True/pred (95% CI)</th><th align="center" valign="bottom">True/pred (95% CI)</th><th align="center" valign="bottom">True/pred (95% CI)</th><th align="center" valign="bottom">True/pred</th><th align="center" valign="bottom">True/pred</th></tr></thead><tbody><tr><td align="left" valign="bottom" rowspan="2">B1</td><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.02/0.0192 (0.0187 to 0.0196)</td><td align="center" valign="bottom">10/15.244 (2.5042 to 27.9828)</td><td align="center" valign="bottom">20/16.963 (11.9263 to 21.9993)</td><td align="center" valign="bottom">25/24</td><td align="center" valign="bottom">52/52</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.02/0.0027 (0 to 0.0074)</td><td align="center" valign="bottom">10/8.805 (0.5631 to 17.0468)</td><td align="center" valign="bottom">20/97.432 (97.2566 to 97.6081)</td><td align="center" valign="bottom">–</td><td align="center" valign="bottom">–</td></tr><tr><td align="left" valign="bottom" rowspan="2">B2</td><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.02/0.0193 (0.0189 to 0.0198)</td><td align="center" valign="bottom">10/15.348 (0 to 95.5192)</td><td align="center" valign="bottom">30/20.427 (0 to 51.514)</td><td align="center" valign="bottom">25/25</td><td align="center" valign="bottom">52/51</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.02/0.001 (0 to 0.0059)</td><td align="center" valign="bottom">10/10.015 (1.6837 to 18.3472)</td><td align="center" valign="bottom">30/100 (99.9933 to 100.0067)</td><td align="center" valign="bottom">–</td><td align="center" valign="bottom">–</td></tr><tr><td align="left" valign="bottom" rowspan="2">B3</td><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.02/0.0196 (0.0191 to 0.02)</td><td align="center" valign="bottom">10/8.149 (6.1551 to 10.143)</td><td align="center" valign="bottom">40/49.432 (0 to 135.9428)</td><td align="center" valign="bottom">25/24</td><td align="center" valign="bottom">52/51</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.02/0.0265 (0.0145 to 0.0386)</td><td align="center" valign="bottom">10/7.855 (0 to 19.751)</td><td align="center" valign="bottom">40/100 (99.9933 to 100.0067)</td><td align="center" valign="bottom">–</td><td align="center" valign="bottom">–</td></tr><tr><td align="left" valign="bottom" rowspan="2">B4</td><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.02/0.0188 (0.0188 to 0.0188)</td><td align="center" valign="bottom">20/19.037 (19.0311 to 19.0435)</td><td align="center" valign="bottom">10/19.254 (19.2439 to 19.2638)</td><td align="center" valign="bottom">25/25</td><td align="center" valign="bottom">52/51</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.02/0.0142 (0.0111 to 0.0173)</td><td align="center" valign="bottom">20/17.354 (4.4083 to 30.2991)</td><td align="center" valign="bottom">10/1.489 (0 to 18.5993)</td><td align="center" valign="bottom">–</td><td align="center" valign="bottom">–</td></tr><tr><td align="left" valign="bottom" rowspan="2">B5</td><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.02/0.0196 (0.019 to 0.0202)</td><td align="center" valign="bottom">30/26.409 (11.1997 to 41.6184)</td><td align="center" valign="bottom">10/11.429 (7.1825 to 15.6759)</td><td align="center" valign="bottom">25/27</td><td align="center" valign="bottom">52/51</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.02/0.0215 (0.0183 to 0.0246)</td><td align="center" valign="bottom">30/14.3 (0 to 68.176)</td><td align="center" valign="bottom">10/1.554 (0 to 16.5985)</td><td align="center" valign="bottom">–</td><td align="center" valign="bottom">–</td></tr><tr><td align="left" valign="bottom" rowspan="2">B6</td><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.02/0.0199 (0.0192 to 0.0206)</td><td align="center" valign="bottom">40/85.415 (41.6058 to 129.2248)</td><td align="center" valign="bottom">10/9.02 (7.2853 to 10.7538)</td><td align="center" valign="bottom">25/6</td><td align="center" valign="bottom">52/51</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.02/0.0163 (0.0112 to 0.0213)</td><td align="center" valign="bottom">40/10.403 (0 to 22.533)</td><td align="center" valign="bottom">10/22.623 (12.0841 to 33.1614)</td><td align="center" valign="bottom">–</td><td align="center" valign="bottom">–</td></tr></tbody></table></table-wrap><table-wrap id="app2table2" position="float"><label>Appendix 2—table 2.</label><caption><title>Parameter values used to generate simulations using numerical solutions to <xref ref-type="disp-formula" rid="equ4">Equation 4</xref>, compared to parameter estimates assuming model C.</title><p>The age of the allele was set to 29,000 years in all simulations. Columns named ‘long’ and ‘lat’ indicate the longitude and latitude of the geographic origin of the allele, respectively.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom" rowspan="2" colspan="2">Simulation</th><th align="center" valign="bottom"><inline-formula><mml:math id="inf85"><mml:mi>s</mml:mi></mml:math></inline-formula></th><th align="center" valign="bottom"><inline-formula><mml:math id="inf86"><mml:msub><mml:mi>σ</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula>(km<sup>2</sup>/gen)</th><th align="center" valign="bottom"><inline-formula><mml:math id="inf87"><mml:msub><mml:mi>σ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula>(km<sup>2</sup>/gen)</th><th align="center" valign="bottom"><italic>v</italic><sub><italic>x</italic></sub> (km/gen)</th><th align="center" valign="bottom"><italic>v</italic><sub><italic>y</italic></sub> (km/gen)</th><th align="center" valign="bottom">Long</th><th align="center" valign="bottom">Lat</th></tr><tr><th align="center" valign="bottom">True/pred (95% CI)</th><th align="center" valign="bottom">True/pred (95% CI)</th><th align="center" valign="bottom">True/pred (95% CI)</th><th align="center" valign="bottom">True/pred (95% CI)</th><th align="center" valign="bottom">True/pred (95% CI)</th><th align="center" valign="bottom">True/pred</th><th align="center" valign="bottom">True/pred</th></tr></thead><tbody><tr><td align="left" valign="bottom" rowspan="2">C1</td><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.02/0.0189 (0.0188 to 0.0189)</td><td align="center" valign="bottom">20/52.246 (52.2051 to 52.2872)</td><td align="center" valign="bottom">20/16.373 (16.332 to 16.4139)</td><td align="center" valign="bottom">-2/-1.675 (-1.6771 to -1.6722)</td><td align="center" valign="bottom">-2/-2.067 (-2.0702 to -2.0639)</td><td align="center" valign="bottom">25/4</td><td align="center" valign="bottom">52/45</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.02/0.0231 (0.023 to 0.0233)</td><td align="center" valign="bottom">20/11.086 (10.9286 to 11.2441)</td><td align="center" valign="bottom">20/15.606 (15.3659 to 15.8467)</td><td align="center" valign="bottom">-2/0.399 (0.3946 to 0.4037)</td><td align="center" valign="bottom">-2/-2.491 (-2.5458 to -2.436)</td><td align="center" valign="bottom">–</td><td align="center" valign="bottom">–</td></tr><tr><td align="left" valign="bottom" rowspan="2">C2</td><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.02/0.0185 (0.0176 to 0.0195)</td><td align="center" valign="bottom">10/19.434 (5.6736 to 33.1952)</td><td align="center" valign="bottom">20/18.727 (4.8938 to 32.5605)</td><td align="center" valign="bottom">-1.2/1.579 (1.2671 to 1.8905)</td><td align="center" valign="bottom">1.9/-0.801 (-1.1684 to -0.4331)</td><td align="center" valign="bottom">25/-6</td><td align="center" valign="bottom">52/38</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.02/0.0205 (0.0175–0.0234)</td><td align="center" valign="bottom">10/38.144 (10.3123 to 65.9749)</td><td align="center" valign="bottom">20/51.094 (14.0489 to 88.1388)</td><td align="center" valign="bottom">-1.2/-1.299 (-2.7247 to 0.1266)</td><td align="center" valign="bottom">1.9/2.493 (2.4929 to 2.4933)</td><td align="center" valign="bottom">–</td><td align="center" valign="bottom">–</td></tr><tr><td align="left" valign="bottom" rowspan="2">C3</td><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.02/0.0255 (0.0254–0.0256)</td><td align="center" valign="bottom">30/59.237 (59.1269 to 59.347)</td><td align="center" valign="bottom">10/6.604 (6.5991 to 6.6087)</td><td align="center" valign="bottom">1.8/2.195 (2.1918 to 2.1985)</td><td align="center" valign="bottom">-0.8/0.438 (0.4381 to 0.4387)</td><td align="center" valign="bottom">25/65</td><td align="center" valign="bottom">52/66</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.02/0.0079 (0– 0.0165)</td><td align="center" valign="bottom">30/86.511 (0 to 194.0772)</td><td align="center" valign="bottom">10/40.693 (24.3946 to 56.9905)</td><td align="center" valign="bottom">1.8/-2.498 (-2.4983 to -2.498)</td><td align="center" valign="bottom">-0.8/-0.014 (-3.4481 to 3.4204)</td><td align="center" valign="bottom">–</td><td align="center" valign="bottom">–</td></tr><tr><td align="left" valign="bottom" rowspan="2">C4</td><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.02/0.0197 (0.0191–0.0204)</td><td align="center" valign="bottom">10/19.647 (14.975 to 24.3197)</td><td align="center" valign="bottom">10/13.585 (0 to 27.2936)</td><td align="center" valign="bottom">1.2/-0.054 (-0.0968 to -0.0111)</td><td align="center" valign="bottom">1/0.72 (0.4278 to 1.0124)</td><td align="center" valign="bottom">25/44</td><td align="center" valign="bottom">52/50</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.02/0.0137 (0.0046–0.0229)</td><td align="center" valign="bottom">10/14.151 (0 to 32.1031)</td><td align="center" valign="bottom">10/4.093 (0 to 49.4651)</td><td align="center" valign="bottom">1.2/0.8 (-3.4903 to 5.0895)</td><td align="center" valign="bottom">1/2.434 (2.4299 to 2.4387)</td><td align="center" valign="bottom">–</td><td align="center" valign="bottom">–</td></tr></tbody></table></table-wrap><table-wrap id="app2table3" position="float"><label>Appendix 2—table 3.</label><caption><title>Parameter value estimates for each of the nine clustering schemes and true parameter values used to generate the deterministic simulation.</title><p>The age of the allele was set to 17,400 years. Columns named ‘long’ and ‘lat’ indicate the longitude and latitude of the geographic origin of the allele, respectively.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom" colspan="2">Sampling scheme</th><th align="center" valign="bottom"><inline-formula><mml:math id="inf88"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (95% CI)</th><th align="center" valign="bottom"><inline-formula><mml:math id="inf89"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>(km2/gen) (95% CI)</th><th align="center" valign="bottom"><inline-formula><mml:math id="inf90"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>(km2/gen) (95% CI)</th><th align="center" valign="bottom"><inline-formula><mml:math id="inf91"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>(km/gen) (95% CI)</th><th align="center" valign="bottom"><inline-formula><mml:math id="inf92"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>(km/gen)(95% CI)</th><th align="center" valign="bottom">Long</th><th align="center" valign="bottom">Lat</th></tr></thead><tbody><tr><td align="left" valign="bottom" rowspan="2">Homogeneous 75%/25%</td><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.0385 (0.0364 to 0.0406)</td><td align="center" valign="bottom">24.592 (14.9174 to 34.2675)</td><td align="center" valign="bottom">16.194 (4.8309 to 27.5568)</td><td align="center" valign="bottom">-1.209 (-1.6947 to -0.7229)</td><td align="center" valign="bottom">-1.555 (-2.0804 to -1.0294)</td><td align="center" valign="bottom" rowspan="2">44</td><td align="center" valign="bottom" rowspan="2">48</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.0261 (0.0201 to 0.0321)</td><td align="center" valign="bottom">45.725 (19.0071 to 72.4437)</td><td align="center" valign="bottom">11.95 (0.0000 to 27.2152)</td><td align="center" valign="bottom">2.499 (2.4993 to 2.4996)</td><td align="center" valign="bottom">-0.905 (-2.3876–0.5783)</td></tr><tr><td align="left" valign="bottom" rowspan="2">Homogeneous 50%/50%</td><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.0379 (0.0364 to 0.0394)</td><td align="center" valign="bottom">23.071 (0.0000 to 66.2585)</td><td align="center" valign="bottom">11.455 (0.0000 to 26.4585)</td><td align="center" valign="bottom">-0.827 (-3.2669 to 1.6124)</td><td align="center" valign="bottom">-0.934 (-1.5199 to -0.3476)</td><td align="center" valign="bottom" rowspan="2">46</td><td align="center" valign="bottom" rowspan="2">51</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">33.944 (0.0292 to 0.0385)</td><td align="center" valign="bottom">33.944 (13.1707 to 54.7167)</td><td align="center" valign="bottom">6.183 (0.0000 to 13.3805)</td><td align="center" valign="bottom">0.478 (-0.5529 to 1.5089)</td><td align="center" valign="bottom">0.315 (-0.1828–0.8127)</td></tr><tr><td align="left" valign="bottom" rowspan="2">Homogeneous 25%/75%</td><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.0379 (0.0364 to 0.0394)</td><td align="center" valign="bottom">22.619 (14.8534 to 30.3839)</td><td align="center" valign="bottom">13.588 (6.1189 to 21.0574)</td><td align="center" valign="bottom">-1.4 (-1.9213 to -0.8782)</td><td align="center" valign="bottom">-1.021 (-1.4258 to -0.6161)</td><td align="center" valign="bottom" rowspan="2">46</td><td align="center" valign="bottom" rowspan="2">50</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.0322 (0.0257 to 0.0388)</td><td align="center" valign="bottom">70.446 (24.6065 to 116.2854)</td><td align="center" valign="bottom">3.786 (0.0000 to 21.6379)</td><td align="center" valign="bottom">2.499 (2.4984 to 2.4987)</td><td align="center" valign="bottom">-0.99 (-2.0881 to 0.1079)</td></tr><tr><td align="left" valign="bottom" rowspan="2">Intermediate 75%/25%</td><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.0378 (0.0378 to 0.0378)</td><td align="center" valign="bottom">20.905 (20.904 to 20.9065)</td><td align="center" valign="bottom">14.583 (14.5818 to 14.5844)</td><td align="center" valign="bottom">-1.069 (-1.0687 to -1.0684)</td><td align="center" valign="bottom">-0.547 (-0.5468 to -0.5467)</td><td align="center" valign="bottom" rowspan="2">44</td><td align="center" valign="bottom" rowspan="2">52</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.0342 (0.0276 to 0.0407)</td><td align="center" valign="bottom">70.405 (29.0665 to 111.7428)</td><td align="center" valign="bottom">1.936 (0.0000 to 18.9234)</td><td align="center" valign="bottom">2.5 (2.4995 to 2.4998)</td><td align="center" valign="bottom">-1.865 (-3.0637 to -0.6655)</td></tr><tr><td align="left" valign="bottom" rowspan="2">Intermediate 50%/50%</td><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.0379 (0.0378–0.0379)</td><td align="center" valign="bottom">93.136 (93.0316 to 93.2406)</td><td align="center" valign="bottom">10.99 (10.9808 to 10.9994)</td><td align="center" valign="bottom">1.103 (1.1009 to 1.1048)</td><td align="center" valign="bottom">0.695 (0.6939–0.6954)</td><td align="center" valign="bottom" rowspan="2">34</td><td align="center" valign="bottom" rowspan="2">57</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.0327 (0.0288–0.0367)</td><td align="center" valign="bottom">22.409 (0.0000 to 69.8122)</td><td align="center" valign="bottom">18.11 (7.9198 to 28.2994)</td><td align="center" valign="bottom">2.496 (2.4962 to 2.4965)</td><td align="center" valign="bottom">-2.499 (-2.4992 to -2.4989)</td></tr><tr><td align="left" valign="bottom" rowspan="2">Intermediate 25%/75%</td><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.0386 (0.0371–0.0402)</td><td align="center" valign="bottom">21.385 (14.0301 to 28.7407)</td><td align="center" valign="bottom">12.335 (3.3756 to 21.2943)</td><td align="center" valign="bottom">-1.028 (-1.4606 to -0.5956)</td><td align="center" valign="bottom">-1.307 (-1.7696 to -0.845)</td><td align="center" valign="bottom" rowspan="2">43</td><td align="center" valign="bottom" rowspan="2">49</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.0295 (0.026–0.0329)</td><td align="center" valign="bottom">21.197 (6.0797 to 36.3142)</td><td align="center" valign="bottom">11.318 (2.651 to 19.9851)</td><td align="center" valign="bottom">2.5 (2.4997 to 2.5000)</td><td align="center" valign="bottom">-0.757 (-1.391 to -0.123)</td></tr><tr><td align="left" valign="bottom" rowspan="2">Extreme 75%/25%</td><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.0362 (0.0336–0.0389)</td><td align="center" valign="bottom">33.07 (0.0000 to 78.1418)</td><td align="center" valign="bottom">26.744 (0.0000 to 155.2413)</td><td align="center" valign="bottom">-0.087 (-0.3579 to 0.1832)</td><td align="center" valign="bottom">-2.001 (-4.7547–0.7524)</td><td align="center" valign="bottom" rowspan="2">39</td><td align="center" valign="bottom" rowspan="2">46</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.0299 (0.0266–0.0332)</td><td align="center" valign="bottom">16.702 (0.0000 to 40.5995)</td><td align="center" valign="bottom">3.048 (0.0000 to 13.034)</td><td align="center" valign="bottom">2.197 (0.8463 to 3.5479)</td><td align="center" valign="bottom">-2.499 (-2.4995 to -2.4992)</td></tr><tr><td align="left" valign="bottom" rowspan="2">Extreme 50%/50%</td><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.0392 (0.0369–0.0416)</td><td align="center" valign="bottom">95.472 (95.2997 to 95.6441)</td><td align="center" valign="bottom">11.22 (5.3235 to 17.1167)</td><td align="center" valign="bottom">1.633 (-2.5434 to 5.8102)</td><td align="center" valign="bottom">0.258 (0.0818–0.434)</td><td align="center" valign="bottom" rowspan="2">36</td><td align="center" valign="bottom" rowspan="2">57</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.0355 (0.0314–0.0396)</td><td align="center" valign="bottom">11.756 (10.3763 to 13.1361)</td><td align="center" valign="bottom">11.817 (10.1474 to 13.4863)</td><td align="center" valign="bottom">2.5 (2.2069 to 2.7928)</td><td align="center" valign="bottom">-0.362 (-0.4325 to -0.2919)</td></tr><tr><td align="left" valign="bottom" rowspan="2">Extreme 25%/75%</td><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.047 (0.047–0.047)</td><td align="center" valign="bottom">7.909 (7.9075 to 7.9106)</td><td align="center" valign="bottom">5.941 (5.9403 to 5.942)</td><td align="center" valign="bottom">0.454 (0.4537 to 0.4538)</td><td align="center" valign="bottom">-2.273 (-2.2732 to -2.2729)</td><td align="center" valign="bottom" rowspan="2">34</td><td align="center" valign="bottom" rowspan="2">38</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.0434 (0.0385–0.0483)</td><td align="center" valign="bottom">40.097 (33.7903 to 46.4034)</td><td align="center" valign="bottom">12.118 (5.781 to 18.4555)</td><td align="center" valign="bottom">2.5 (1.6706 to 3.3285)</td><td align="center" valign="bottom">-1.435 (-2.3958 to -0.4736)</td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">True parameter values</td><td align="center" valign="bottom">0.04</td><td align="center" valign="bottom">25</td><td align="center" valign="bottom">10</td><td align="center" valign="bottom">1.8</td><td align="center" valign="bottom">-0.8</td><td align="center" valign="bottom">25</td><td align="center" valign="bottom">52</td></tr></tbody></table></table-wrap><table-wrap id="app2table4" position="float"><label>Appendix 2—table 4.</label><caption><title>Parameter values estimated using model C for the forward simulation created using SLiM.</title><p>Columns named ‘long’ and ‘lat’indicate the longitude and latitude of the geographic origin of the allele, respectively.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"><inline-formula><mml:math id="inf93"><mml:mi>s</mml:mi></mml:math></inline-formula>(95% CI)</th><th align="left" valign="bottom"><inline-formula><mml:math id="inf94"><mml:msub><mml:mi>σ</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula>(km<sup>2</sup>/gen) (95% CI)</th><th align="left" valign="bottom"><inline-formula><mml:math id="inf95"><mml:msub><mml:mi>σ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula>(km<sup>2</sup>/gen)</th><th align="char" char="." valign="bottom"><italic>v</italic><sub><italic>x</italic></sub>(km/gen)(95% CI)</th><th align="left" valign="bottom"><italic>v</italic><sub>y</sub>(km/gen)(95% CI)</th><th align="left" valign="bottom">Long</th><th align="left" valign="bottom">Lat</th><th align="left" valign="bottom">Allele age (years)</th></tr></thead><tbody><tr><td align="char" char="." valign="bottom">0.0366 (0.0357 to 0.0375)</td><td align="char" char="." valign="bottom">58.583 (49.1983 to 67.9669)</td><td align="char" char="." valign="bottom">63.733 (3.6601 to 123.8056)</td><td align="char" char="." valign="bottom">-0.436 (-0.8077to -0.0649)</td><td align="char" char="." valign="bottom">-1.564 (-3.0915 to -0.0355)</td><td align="char" char="." valign="bottom">15</td><td align="char" char="." valign="bottom">47</td><td align="char" char="." valign="bottom">15,000</td></tr></tbody></table></table-wrap><table-wrap id="app2table5" position="float"><label>Appendix 2—table 5.</label><caption><title>Summary of parameter estimates for rs4988235(T).</title><p>The upper two rows correspond to results obtained assuming the allele age to be the point estimate of the start of selection onset from <xref ref-type="bibr" rid="bib40">Itan et al., 2009</xref>: 7441 years ago. The middle two rows and the bottom two rows show results assuming the age to be either the lower or the higher ends of the age’s 95% confidence interval from <xref ref-type="bibr" rid="bib40">Itan et al., 2009</xref>. Columns named ‘long’ and ‘Lat’ indicate the longitude and latitude of the geographic origin of the allele, respectively.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"/><th align="center" valign="bottom"><inline-formula><mml:math id="inf96"><mml:mi>s</mml:mi></mml:math></inline-formula>(95% CI)</th><th align="center" valign="bottom"><inline-formula><mml:math id="inf97"><mml:msub><mml:mi>σ</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula>(km<sup>2</sup>/gen) (95% CI)</th><th align="center" valign="bottom"><inline-formula><mml:math id="inf98"><mml:msub><mml:mi>σ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula>(km<sup>2</sup>/gen) (95% CI)</th><th align="center" valign="bottom"><italic>v</italic><sub><italic>x</italic></sub> (km/gen) (95% CI)</th><th align="center" valign="bottom"><italic>v</italic><sub><italic>y</italic></sub> (km/gen) (95% CI)</th><th align="center" valign="bottom">Long</th><th align="center" valign="bottom">Lat</th><th align="center" valign="bottom">Allele age (years)</th></tr></thead><tbody><tr><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.0993 (0.0993 to 0.0993)</td><td align="center" valign="bottom">20.293 (15.5643 to 25.0226)</td><td align="center" valign="bottom">15.642 (9.9963 to 21.2871)</td><td align="center" valign="bottom">-0.575 (-0.8055 to -0.3446)</td><td align="center" valign="bottom">0.435 (0.319–0.5512)</td><td align="center" valign="bottom" rowspan="2">43</td><td align="center" valign="bottom" rowspan="2">51</td><td align="center" valign="bottom" rowspan="2">7441</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.0328 (0.0327 to 0.0329)</td><td align="center" valign="bottom">94.901 (94.2585 to 95.5435)</td><td align="center" valign="bottom">85.612 (84.6975 to 86.526)</td><td align="center" valign="bottom">-1.211 (-1.2197 to -1.2019)</td><td align="center" valign="bottom">-2.5 (-2.5136 to -2.4855)</td></tr><tr><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.0867 (0.0866 to 0.0867)</td><td align="center" valign="bottom">24.27 (24.2658 to 24.2734)</td><td align="center" valign="bottom">28.328 (28.3234 to 28.3326)</td><td align="center" valign="bottom">-0.398 (-0.3985 to -0.3984)</td><td align="center" valign="bottom">-2.055 (-2.0562 to -2.0547)</td><td align="center" valign="bottom" rowspan="2">35</td><td align="center" valign="bottom" rowspan="2">46</td><td align="center" valign="bottom" rowspan="2">8683</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.0321 (0.0319–0.0323)</td><td align="center" valign="bottom">97.325 (97.1434–97.5061)</td><td align="center" valign="bottom">87.416 (85.6745 to 89.1578)</td><td align="center" valign="bottom">-2.5 (-2.5 to -2.4997)</td><td align="center" valign="bottom">-2.389 (-2.3935 to -2.3845)</td></tr><tr><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.0994 (0.0994–0.0994)</td><td align="center" valign="bottom">22.92 (15.0004–30.8397)</td><td align="center" valign="bottom">17.884 (13.8709 to 21.8967)</td><td align="center" valign="bottom">0.327 (0.1726 to 0.4818)</td><td align="center" valign="bottom">-0.295 (-0.3678 to -0.2229)</td><td align="center" valign="bottom" rowspan="2">35</td><td align="center" valign="bottom" rowspan="2">49</td><td align="center" valign="bottom" rowspan="2">6256</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.0572 (0.057–0.0574)</td><td align="center" valign="bottom">95.014 (93.6242–96.4032)</td><td align="center" valign="bottom">85.249 (82.9662 to 87.5322)</td><td align="center" valign="bottom">-2.499 (-2.4992 to -2.4989)</td><td align="center" valign="bottom">-1.679 (-1.7919 to -1.5658)</td></tr></tbody></table></table-wrap><table-wrap id="app2table6" position="float"><label>Appendix 2—table 6.</label><caption><title>Parameter estimates for rs4988235(T) using the allele age inferred in <xref ref-type="bibr" rid="bib1">Albers and McVean, 2020</xref>.</title><p>Columns named ‘long’ and ‘lat’ indicate the longitude and latitude of the geographic origin of the allele, respectively.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"/><th align="center" valign="bottom"><inline-formula><mml:math id="inf99"><mml:mi>s</mml:mi></mml:math></inline-formula>(95% CI)</th><th align="center" valign="bottom"><inline-formula><mml:math id="inf100"><mml:msub><mml:mi>σ</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula>(km<sup>2</sup>/gen) (95% CI)</th><th align="center" valign="bottom"><inline-formula><mml:math id="inf101"><mml:msub><mml:mi>σ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula>(km<sup>2</sup>/gen) (95% CI)</th><th align="center" valign="bottom"><italic>v</italic><sub><italic>x</italic></sub> (km/gen) (95% CI)</th><th align="center" valign="bottom"><italic>v</italic><sub><italic>y</italic></sub> (km/gen) (95% CI)</th><th align="center" valign="bottom">Long</th><th align="center" valign="bottom">Lat</th><th align="center" valign="bottom">Allele age (years)</th></tr></thead><tbody><tr><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.0285 (0.0285 to 0.0285)</td><td align="center" valign="bottom">1.25 (1.2492 to 1.25)</td><td align="center" valign="bottom">44.619 (44.5944 to 44.6445)</td><td align="center" valign="bottom">-0.177 (-0.1773 to -0.1771)</td><td align="center" valign="bottom">1.925 (1.9247 to 1.9262)</td><td align="center" valign="bottom" rowspan="2">32</td><td align="center" valign="bottom" rowspan="2">66</td><td align="center" valign="bottom" rowspan="2">20,106</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.0255 (0.0252 to 0.0258)</td><td align="center" valign="bottom">92.545 (91.6963 to 93.3941)</td><td align="center" valign="bottom">87.545 (85.3525 to 89.7369)</td><td align="center" valign="bottom">-2.499 (-2.4992 to -2.4989)</td><td align="center" valign="bottom">-2.271 (-2.4127 to -2.1297)</td></tr></tbody></table></table-wrap><table-wrap id="app2table7" position="float"><label>Appendix 2—table 7.</label><caption><title>Summary of parameter estimates for rs1042602(A).</title><p>Upper two rows correspond to model fit when allele age is set to be the point estimate <xref ref-type="bibr" rid="bib1">Albers and McVean, 2020</xref>: 26,367 years ago. The middle two rows and the bottom two rows show results assuming the age to be either the lower or the higher ends of the allele age’s 95% confidence interval from <xref ref-type="bibr" rid="bib1">Albers and McVean, 2020</xref>. Columns named ‘long’ and ‘lat’ indicate the longitude and latitude of the geographic origin of the allele, respectively.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"/><th align="center" valign="bottom"><inline-formula><mml:math id="inf102"><mml:mi>s</mml:mi></mml:math></inline-formula> (95% CI)</th><th align="center" valign="bottom">σ<sub>x</sub>(km<sup>2</sup>/gen) (95% CI)</th><th align="center" valign="bottom">σ<sub>y</sub> (km<sup>2</sup>/gen) (95% CI)<break/></th><th align="center" valign="bottom"><italic>v</italic><sub><italic>x</italic></sub>(km/gen) (95% CI)</th><th align="center" valign="bottom"><italic>v</italic><sub>y</sub>(km/gen) (95% CI)</th><th align="center" valign="bottom">Long</th><th align="center" valign="bottom">Lat</th><th align="center" valign="bottom">Allele age (years)</th></tr></thead><tbody><tr><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.0221 (0.0216 to 0.0227)</td><td align="center" valign="bottom">71.668 (24.7274 to 118.6092)</td><td align="center" valign="bottom">50.434 (25.6535 to 75.2136)</td><td align="center" valign="bottom">-2.268 (-3.006 to -1.5304)</td><td align="center" valign="bottom">-0.486 (-0.8661 to -0.1053)</td><td align="center" valign="bottom" rowspan="2">44</td><td align="center" valign="bottom" rowspan="2">43</td><td align="center" valign="bottom" rowspan="2">26,367</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.0102 (0.0083 to 0.012)</td><td align="center" valign="bottom">69.25 (14.0247 to 124.4756)</td><td align="center" valign="bottom">95.281 (95.1087 to 95.453)</td><td align="center" valign="bottom">0.849 (-0.0783 to 1.7769)</td><td align="center" valign="bottom">-0.503 (-0.929 to -0.076)</td></tr><tr><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.0214 (0.0205 to 0.0223)</td><td align="center" valign="bottom">57.914 (0 to 131.3177)</td><td align="center" valign="bottom">83.846 (0 to 246.6688)</td><td align="center" valign="bottom">-2.111 (-2.8784 to -1.3429)</td><td align="center" valign="bottom">1.305 (-0.8411 to 3.4519)</td><td align="center" valign="bottom" rowspan="2">46</td><td align="center" valign="bottom" rowspan="2">51</td><td align="center" valign="bottom" rowspan="2">27,315</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.01 (0.0078 to 0.0121)</td><td align="center" valign="bottom">88.218 (0 to 190.105)</td><td align="center" valign="bottom">96.216 (96.0422 to 96.3898)</td><td align="center" valign="bottom">1.19 (-0.7489 to 3.1293)</td><td align="center" valign="bottom">-0.88 (-2.0897 to 0.3299)</td></tr><tr><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.023 (0.023 to 0.0231)</td><td align="center" valign="bottom">75.857 (75.8065 to 75.9071)</td><td align="center" valign="bottom">48.992 (48.9166 to 49.0674)</td><td align="center" valign="bottom">-2.362 (-2.3655 to -2.3593)</td><td align="center" valign="bottom">-0.837 (-0.8371 to -0.8362)</td><td align="center" valign="bottom" rowspan="2">43</td><td align="center" valign="bottom" rowspan="2">42</td><td align="center" valign="bottom" rowspan="2">25,424</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.0099 (0.0085 to 0.0112)</td><td align="center" valign="bottom">72.847 (67.7991 to 77.8949)</td><td align="center" valign="bottom">92.867 (75.4925 to 110.2412)</td><td align="center" valign="bottom">0.497 (0.2717 to 0.7214)</td><td align="center" valign="bottom">-0.685 (-0.8076 to -0.5628)</td></tr></tbody></table></table-wrap><table-wrap id="app2table8" position="float"><label>Appendix 2—table 8.</label><caption><title>Summary of parameter estimates for rs4988235(T) when the origin of the allele is forced to be at different points in the map (top panel corresponds to the original fit for the geographic position).</title><p>In all cases, the estimated age of allele that was inputted into the model is 7441 years ago. Columns named ‘long’ and ‘lat’ indicate the longitude and latitude of the geographic origin of the allele, respectively.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"/><th align="center" valign="bottom"><inline-formula><mml:math id="inf103"><mml:mi>s</mml:mi></mml:math></inline-formula>(95% CI)</th><th align="center" valign="bottom"><inline-formula><mml:math id="inf104"><mml:msub><mml:mi>σ</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula>(km<sup>2</sup>/gen) (95% CI)</th><th align="center" valign="bottom"><inline-formula><mml:math id="inf105"><mml:msub><mml:mi>σ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula>(km<sup>2</sup>/gen) (95% CI)</th><th align="center" valign="bottom"><italic>v</italic><sub><italic>x</italic></sub> (km/gen) (95% CI)</th><th align="center" valign="bottom"><italic>v</italic><sub><italic>y</italic></sub> (km/gen) (95% CI)</th><th align="center" valign="bottom">Long</th><th align="center" valign="bottom">Lat</th></tr></thead><tbody><tr><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.0993 (0.0993 to 0.0993)</td><td align="center" valign="bottom">20.293 (15.5643 to 25.0226)</td><td align="center" valign="bottom">15.642 (9.9963 to 21.2871)</td><td align="center" valign="bottom">-0.575 (-0.8055 to -0.3446)</td><td align="center" valign="bottom">0.435 (0.319 to 0.5512)</td><td align="center" valign="bottom" rowspan="2">43</td><td align="center" valign="bottom" rowspan="2">51</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.0328 (0.0327 to 0.0329)</td><td align="center" valign="bottom">94.901 (94.2585 to 95.5435)</td><td align="center" valign="bottom">85.612 (84.6975 to 86.526)</td><td align="center" valign="bottom">-1.211 (-1.2197 to -1.2019)</td><td align="center" valign="bottom">-2.5 (-2.5136 to -2.4855)</td></tr><tr><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.0985 (0.0985 to 0.0985)</td><td align="center" valign="bottom">3.103 (3.1027 to 3.1031)</td><td align="center" valign="bottom">44.876 (44.8747 to 44.8768)</td><td align="center" valign="bottom">0.354 (0.3537–0.3537)</td><td align="center" valign="bottom">-0.663 (-0.6634 to -0.6633)</td><td align="center" valign="bottom" rowspan="2">33</td><td align="center" valign="bottom" rowspan="2">51</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.0413 (0.0411 to 0.0415)</td><td align="center" valign="bottom">96.029 (95.8493 to 96.2087)</td><td align="center" valign="bottom">85.711 (83.6634 to 87.7594)</td><td align="center" valign="bottom">-2.5 (-2.5002 to -2.4998)</td><td align="center" valign="bottom">-1.318 (-1.46 to -1.1764)</td></tr><tr><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.0979 (0.0978 to 0.0979)</td><td align="center" valign="bottom">70.388 (70.3697 to 70.4065)</td><td align="center" valign="bottom">2.628 (2.6271 to 2.6286)</td><td align="center" valign="bottom">-2.328 (-2.3286 to -2.3276)</td><td align="center" valign="bottom">1.216 (1.2159–1.2164)</td><td align="center" valign="bottom" rowspan="2">53</td><td align="center" valign="bottom" rowspan="2">51</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.0376 (0.0374 to 0.0377)</td><td align="center" valign="bottom">3.705 (1.9497 to 5.4607)</td><td align="center" valign="bottom">77.019 (74.9065– to 79.1311)</td><td align="center" valign="bottom">-2.413 (-2.4174 to -2.4084)</td><td align="center" valign="bottom">-2.5 (-2.4999 to -2.4995)</td></tr><tr><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.0991 (0.0991 to 0.0992)</td><td align="center" valign="bottom">1.218 (1.218 to 1.2183)</td><td align="center" valign="bottom">15.127 (15.1256 to 15.1287)</td><td align="center" valign="bottom">-0.781 (-0.781 to -0.7807)</td><td align="center" valign="bottom">2.452 (2.452 to 2.4526)</td><td align="center" valign="bottom" rowspan="2">43</td><td align="center" valign="bottom" rowspan="2">61</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.0359 (0.0357 to 0.0361)</td><td align="center" valign="bottom">96.836 (96.6538 to 97.0183)</td><td align="center" valign="bottom">86.616 (83.9434 to 89.2891)</td><td align="center" valign="bottom">-2.499 (-2.4994 to -2.499)</td><td align="center" valign="bottom">-2.219 (-2.3368 to -2.1009)</td></tr><tr><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.0999 (0.0999 to 0.0999)</td><td align="center" valign="bottom">27.442 (27.4385 to 27.4464)</td><td align="center" valign="bottom">11.879 (11.8781 to 11.8801)</td><td align="center" valign="bottom">-1.582 (-1.5824 to -1.582)</td><td align="center" valign="bottom">-1.638 (-1.6382 to -1.638)</td><td align="center" valign="bottom" rowspan="2">43</td><td align="center" valign="bottom" rowspan="2">41</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.0355 (0.0353 to 0.0357)</td><td align="center" valign="bottom">97.044 (96.8637 to 97.2236)</td><td align="center" valign="bottom">86.223 (83.4533 to 88.992)</td><td align="center" valign="bottom">-2.499 (-2.4996 to -2.4992)</td><td align="center" valign="bottom">-2.148 (-2.2811 to -2.0141)</td></tr></tbody></table></table-wrap><table-wrap id="app2table9" position="float"><label>Appendix 2—table 9.</label><caption><title>Parameter estimates for rs4988235(T) using the geographic origin of the allele inferred in <xref ref-type="bibr" rid="bib40">Itan et al., 2009</xref>.</title><p>Columns named ‘long’ and ‘lat’ indicate the longitude and latitude of the geographic origin of the allele, respectively.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"/><th align="center" valign="bottom"><inline-formula><mml:math id="inf106"><mml:mi>s</mml:mi></mml:math></inline-formula>(95% CI)</th><th align="center" valign="bottom"><inline-formula><mml:math id="inf107"><mml:msub><mml:mi>σ</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula>(km<sup>2</sup>/gen) (95% CI)</th><th align="center" valign="bottom"><inline-formula><mml:math id="inf108"><mml:msub><mml:mi>σ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula>(km<sup>2</sup>/gen) (95% CI)</th><th align="center" valign="bottom"><italic>v</italic><sub><italic>x</italic></sub> (km/gen) (95% CI)</th><th align="center" valign="bottom"><italic>v</italic><sub><italic>y</italic></sub> (km/gen) (95% CI)</th><th align="center" valign="bottom">Long</th><th align="center" valign="bottom">Lat</th><th align="center" valign="bottom">Allele age (years)</th></tr></thead><tbody><tr><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.0989 (0.0989 to 0.0989)</td><td align="center" valign="bottom">9.341 (9.3402 to 9.341)</td><td align="center" valign="bottom">3.264 (3.2635 to 3.2643)</td><td align="center" valign="bottom">2.338 (2.3379 to 2.3381)</td><td align="center" valign="bottom">-0.21 (-0.2098 to -0.2098)</td><td align="center" valign="bottom" rowspan="2">13</td><td align="center" valign="bottom" rowspan="2">48</td><td align="center" valign="bottom" rowspan="2">7441</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.0358 (0.0357 to 0.036)</td><td align="center" valign="bottom">97.086 (96.9059 to 97.2657)</td><td align="center" valign="bottom">87.043 (85.1968 to 88.8895)</td><td align="center" valign="bottom">-2.434 (-2.4385 to -2.4294)</td><td align="center" valign="bottom">-2.499 (-2.4994 to -2.499)</td></tr></tbody></table></table-wrap><table-wrap id="app2table10" position="float"><label>Appendix 2—table 10.</label><caption><title>Summary of parameter estimates for rs1042602(A) when the origin of the allele is forced to be at different points in the map (top panel corresponds to the original fit for the geographic position).</title><p>In all cases, the estimated age of allele that was inputted into the model is 26,367 years ago. Columns named ‘long’ and ‘lat’ indicate the longitude and latitude of the geographic origin of the allele, respectively.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"/><th align="center" valign="bottom"><inline-formula><mml:math id="inf109"><mml:mi>s</mml:mi></mml:math></inline-formula>(95% CI)</th><th align="center" valign="bottom"><inline-formula><mml:math id="inf110"><mml:msub><mml:mi>σ</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula>(km<sup>2</sup>/gen) (95% CI)</th><th align="center" valign="bottom"><inline-formula><mml:math id="inf111"><mml:msub><mml:mi>σ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula>(km<sup>2</sup>/gen) (95% CI)</th><th align="center" valign="bottom"><italic>v</italic><sub><italic>x</italic></sub> (km/gen) (95% CI)</th><th align="center" valign="bottom"><italic>v</italic><sub><italic>y</italic></sub> (km/gen) (95% CI)</th><th align="center" valign="bottom">Long</th><th align="center" valign="bottom">Lat</th></tr></thead><tbody><tr><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.0221 (0.0216 to 0.0227)</td><td align="center" valign="bottom">71.668 (24.7274 to 118.6092)</td><td align="center" valign="bottom">50.434 (25.6535 to 75.2136)</td><td align="center" valign="bottom">-2.268 (-3.006 to -1.5304)</td><td align="center" valign="bottom">-0.486 (-0.8661 to -0.1053)</td><td align="center" valign="bottom" rowspan="2">44</td><td align="center" valign="bottom" rowspan="2">43</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.0102 (0.0083 to 0.012)</td><td align="center" valign="bottom">69.25 (14.0247 to 124.4756)</td><td align="center" valign="bottom">95.281 (95.1087 to 95.453)</td><td align="center" valign="bottom">0.849 (-0.0783 to 1.7769)</td><td align="center" valign="bottom">-0.503 (-0.929 to -0.076)</td></tr><tr><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.0227 (0.0223 to 0.0231)</td><td align="center" valign="bottom">42.745 (33.6354 to 51.8541)</td><td align="center" valign="bottom">96.993 (96.8183 to 97.1683)</td><td align="center" valign="bottom">-2.437 (-2.4412 to -2.4324)</td><td align="center" valign="bottom">-0.266 (-0.4848 to -0.0468)</td><td align="center" valign="bottom" rowspan="2">54</td><td align="center" valign="bottom" rowspan="2">43</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.0095 (0.007 to 0.0119)</td><td align="center" valign="bottom">93.477 (7.6582 to 179.2965)</td><td align="center" valign="bottom">99.634 (0 to 205.4586)</td><td align="center" valign="bottom">-2.499 (-3.2101 to -1.7873)</td><td align="center" valign="bottom">2.057 (-0.7888 to 4.903)</td></tr><tr><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.0221 (0.0221 to 0.0221)</td><td align="center" valign="bottom">47.691 (47.6686 to 47.7127)</td><td align="center" valign="bottom">71.367 (71.336 to 71.3986)</td><td align="center" valign="bottom">-2.164 (-2.1652 to -2.1637)</td><td align="center" valign="bottom">1.839 (1.8387 to 1.8392)</td><td align="center" valign="bottom" rowspan="2">44</td><td align="center" valign="bottom" rowspan="2">53</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.0112 (0.0093 to 0.0131)</td><td align="center" valign="bottom">87.959 (0 to 215.8939)</td><td align="center" valign="bottom">88.951 (25.5422 to 152.3589)</td><td align="center" valign="bottom">2.108 (-0.2061 to 4.4227)</td><td align="center" valign="bottom">-2.237 (-5.7828 to 1.3083)</td></tr><tr><td align="left" valign="bottom">Sample age &gt;5000</td><td align="center" valign="bottom">0.0219 (0.0209 to 0.0229)</td><td align="center" valign="bottom">73.106 (38.1699 to 108.043)</td><td align="center" valign="bottom">76.835 (24.0025 to 129.6684)</td><td align="center" valign="bottom">-2.429 (-2.4335 to -2.4248)</td><td align="center" valign="bottom">-1.474 (-2.8769 to -0.0706)</td><td align="center" valign="bottom" rowspan="2">44</td><td align="center" valign="bottom" rowspan="2">33</td></tr><tr><td align="left" valign="bottom">Sample age &lt;5000</td><td align="center" valign="bottom">0.0102(0.0083 to 0.0121)</td><td align="center" valign="bottom">88.216 (0 to 192.1057)</td><td align="center" valign="bottom">95.401 (95.2283 to 95.573)</td><td align="center" valign="bottom">0.871 (-0.2474 to 1.9893)</td><td align="center" valign="bottom">-1.026 (-2.6161 to 0.564)</td></tr></tbody></table></table-wrap></app></app-group></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.73767.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Andrés</surname><given-names>Aida M</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02jx3x895</institution-id><institution>University College London</institution></institution-wrap><country>United Kingdom</country></aff></contrib></contrib-group><related-object id="sa0ro1" object-id-type="id" object-id="10.1101/2021.07.21.453231" link-type="continued-by" xlink:href="https://sciety.org/articles/activity/10.1101/2021.07.21.453231"/></front-stub><body><p>This is an important manuscript that presents an elegant framework to infer the dynamics of beneficial alleles over time and space. The authors present a new method and show, convincingly, its utility and great potential to reconstruct the evolutionary history of beneficial alleles. The method is also applied to loci that likely mediated human genetic adaptations, contributing to our understanding of human recent evolution. The work will be of broad interest to evolutionary biologists who seek to understand the dynamics of beneficial mutations in populations.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.73767.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Andrés</surname><given-names>Aida M</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02jx3x895</institution-id><institution>University College London</institution></institution-wrap><country>United Kingdom</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Alves</surname><given-names>Isabel</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03gnr7b55</institution-id><institution>l'institut du thorax, INSERM/CNRS, University of Nantes</institution></institution-wrap><country>France</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Eriksson</surname><given-names>Anders</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03z77qz90</institution-id><institution>Institute of Genomics, University of Tartu</institution></institution-wrap><country>Estonia</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>Our editorial process produces two outputs: (i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2021.07.21.453231">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2021.07.21.453231v3">the preprint</ext-link> for the benefit of readers; (ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Modelling the spatiotemporal spread of beneficial alleles using ancient genomes&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 2 peer reviewers, and the evaluation has been overseen by a Reviewing Editor and George Perry as the Senior Editor. The following individuals involved in review of your submission have agreed to reveal their identity: Isabel Alves (Reviewer #1); Anders Eriksson (Reviewer #2).</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>The reviewers and editor found the manuscript elegant and interesting and appreciate the novelty and promise of your new method. They also value your new inferences on two important targets of positive selection in humans. You will find the individual reviews below, to be addressed individually. Here we provide a summary of the desired revisions, to assist you in the revision process.</p><p>1) We believe that the manuscript needs a more systematic test for the sensitivity of the method to 1) misspecification of the age of the aDNA samples, and 2) the geographic location/clustering of the samples. This could be done for example by exploring the effect of these factors on the accuracy of the parameter estimates.</p><p>2) Related, we believe that further discussion is needed on the extent to which differences observed across time periods (e.g. before and after 5000 BP) reflect particularities of the alleles (e.g. selection), populations (e.g mobility) or the density of the samples across time and space.</p><p>3) Where models are applied to specific loci, results are often reported in the text without enough quantitative information and we think that clearer and more detailed information about the inferences must be presented in the text. As an example, where the model is run for different allele age estimates the (approximate maximum) likelihoods of parameter estimates for the different scenarios should be clearly shown in the text.</p><p>4) We believe that the authors should clarify some of their choices for the method. We would like to see a discussion of whether the method may be suitable for treating allele age as a free parameter, or whether it is possible (and superior) to report Bayesian posterior distributions for the parameters and Bayes factors to compare the fit of different models to the data.</p><p>5) The loci studied represent unusual cases of very strong positive selection in particular geographic areas. We would welcome more discussion regarding the extent to which the current version of the method can be applied to other alleles, to other geographic regions and even to other species.</p><p>6) Finally, the reviewers raised issues regarding the presentation of the numerical implementation that we hope that the authors can easily address.</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>I very much appreciated reading this manuscript and the effort of the authors in developing such an exciting tool. However, I still have some concerns about the accuracy and the meaning of the estimates.</p><p>1) We know that ancient DNA samples are clustered in time and space because they are an aggregate of samples coming from different studies often with different scopes in terms of time and geographical area covered. What's the impact of having clustered samples in the parameter estimates? The authors comment on that a little bit when comparing the accuracy tests performed with the deterministic vs forward in time simulations. However, I think a more systematic analysis of different sampling schemes would help clarifying the robustness of the parameter inference. Moreover, I think this would greatly help understanding the differences in behavior of the statistical method before and after 5000 BP. Indeed the authors allow the model parameters to differ across different time periods (before and after 5000 BP) but it is not clear whether differences in the estimates reflect any particularity of the populations (e.g mobility) or they just reflect differences in the density of the samples across time and space.</p><p>2) How would the method perform if simulations would be performed without advection (numerical solution to equation 3) but parameter estimates would be inferred from a model C, which includes advection ?</p><p>3) Finally and more of a general question: what's the point of estimating the geographical origin of an allele if there are no samples dated from around the same time as the assumed allele age? I have the feeling this can be easily misinterpreted but maybe I am missing something. The authors discuss this (lines 199-210) when discussing the results obtained for the dynamics of the rs4988235(T) for the two assumed allele ages but it is not clear to me if the estimate for the local of origin is actually meaningful under similar situations. I wonder if with simulation one could try to understand what the method is retrieving…</p><p>With respect to the presentation of the work I found that the manuscript is globally well explained but there are some parts a bit difficult to follow:</p><p>1) it should be clearly stated in the main that the age of the allele is provided as input and not inferred contrarily to the geographical origin of the allele and the value used to perform the inference should also be provided in the corresponding part of the main text.</p><p>2) The comparison of the results for the two ages assumed for the rs4988235(T) mutation (Itan et al. 2009 and Albers and McVean 2020), mainly between lines 199-210, is very confusing. From Figure 5a it seems there is no information on the allele for the time period between the allele age inferred by Itan et al. 2009 and Albers and McVean 2020. However, from the text it is not clearly stated whether there is or not information. If there is no information at all how does the algorithm infer an origin in Northeastern Europe?</p><p>3) It would also help to follow the results if the authors would clearly state in the main text (lines: 212-230) the age of the allele assumed for the rs1042602(A).</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>Given the ability to of the model to sample at any point in space and time, it would have been very interesting to test the model under actual geographical and temporal distributions of data, such as the Allen Ancient DNA Resource used for one of the empirical investigations, perhaps even taking the observed pattern of missingness in the data into account.</p><p>I would recommend using latitude and longitude systematically throughout the manuscript instead of mixing x, y, latitude, longitude.</p><p>In the methods: Please fix the typo in Eq (9). Also please clarify which boundary conditions where used, and how the equations were solved numerically (using Eq. (8) or (9)?), including how boundary conditions were implemented.</p><p>L437: &quot; the left-hand side of equation 5&quot;. This doesn't look right, do you mean the right-hand side of Eq. (6)?</p><p>[Editors' note: further revisions were suggested prior to acceptance, as described below.]</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>It is now the second time I review the manuscript &quot;Modelling the spatiotemporal spread of beneficial alleles using ancient genomes&quot; by Muktupavela et al. and I am glad to see that the authors addressed most of the reviewers' concerns. There is now a more systemic assessment of the advantages/limitations of the method which I truly believe to be crucial for future implementations. That being said, I would like to recommend this manuscript for publication.</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>The authors have made substantial improvements to the manuscript, and is ready for acceptance except for one remaining point:</p><p>Contrary to what the authors claim in their rebuttal, Eqs (8) and (9) in Appendix 1 still contain errors.</p><p>First, p(x+\δ x,y,t) and p(x+\δ x,y,t) appears twice on line 827.</p><p>Second, the coefficients of p(x,y,t) on both sides of Eq (9) sum to -1, which is correct. The term should therefore be absent (have coefficient zero) in Eq (8).</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.73767.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Reviewer #1 (Recommendations for the authors):</p><p>I very much appreciated reading this manuscript and the effort of the authors in developing such an exciting tool. However, I still have some concerns about the accuracy and the meaning of the estimates.</p><p>1) We know that ancient DNA samples are clustered in time and space because they are an aggregate of samples coming from different studies often with different scopes in terms of time and geographical area covered. What's the impact of having clustered samples in the parameter estimates? The authors comment on that a little bit when comparing the accuracy tests performed with the deterministic vs forward in time simulations. However, I think a more systematic analysis of different sampling schemes would help clarifying the robustness of the parameter inference. Moreover, I think this would greatly help understanding the differences in behavior of the statistical method before and after 5000 BP. Indeed the authors allow the model parameters to differ across different time periods (before and after 5000 BP) but it is not clear whether differences in the estimates reflect any particularity of the populations (e.g mobility) or they just reflect differences in the density of the samples across time and space.</p></disp-quote><p>We thank the reviewer for highlighting the importance of taking into account clustering effects that could potentially arise by aggregating aDNA data from studies with different sampling schemes. To elaborate on this issue in more detail, we have included a new analysis (chapter “Impact of sample clustering on parameter estimates” in the manuscript) of the expected impact of different sampling and clustering schemes on our inferences. We used a deterministic simulation to create three different degrees of clustering which we will refer to as “homogeneous”, “intermediate” or “extreme” by varying the area from which we sample individuals to be used in our inferences, now included as Figure 3—figure supplement 1 in the paper. Additionally, we also tested the impact of biased temporal sampling in the periods before and after 5000 year BP by oversampling in the ancient period (75%/25%), equal sampling in the two periods (50%/50%), and oversampling in the recent period (25%/75%). Because we evaluated this temporal bias for each of the three spatial clustering sampling scenarios, this resulted in a total of 9 different sampling scenarios. We note that the third “extreme” spatial clustering scenario is completely unrealistic and one would not expect inferences of any degree of accuracy from it, but we believe it gives a good idea of the behaviour of our method in the limit case of extremely restricted spatial sampling.</p><p>A comparison of allele frequency maps generated using true parameter values and using parameter estimates from the different sampling schemes are shown in the manuscript Figure 3—figure supplements 2-9. In Figure 3—figure supplement 6 and Figure 3 in the manuscript we show the allele frequency map generated using the “intermediate 75%/25%” clustering scheme. Parameter estimates used to generate all these figures are summarised in Appendix 2–Table 3 in the manuscript. Overall we can see that the allele frequency maps inferred from these scenarios closely resemble the maps generated using the true parameter values, despite the challenges in finding accurate values for the individual point estimates of some of the parameters, highlighting that various combinations of diffusion and advection coefficients can produce similar underlying frequency maps (as discussed in the manuscript section “Performance on deterministic simulations”). This suggests that the joint spatiotemporal information encoded in the inferred maps (not just the individual parameters estimates) should be used in interpreting model outputs, particularly when it comes to the advection and diffusion parameters. The selection coefficient estimates are inferred highly accurately, regardless of the sampling scheme chosen, and lie close to the true value, with only a slight underestimation in the time period after 5000 years BP (with the exception of “extreme 25%/75%”).</p><disp-quote content-type="editor-comment"><p>2) How would the method perform if simulations would be performed without advection (numerical solution to equation 3) but parameter estimates would be inferred from a model C, which includes advection ?</p></disp-quote><p>The following text was added to the main text as section “Advection model application to non-advection simulations”.</p><p>“We assessed the performance of the model C, which includes advection coefficient estimates on simulations generated without advection (results shown in Figure 1—figure supplement 6 and Figure 1—figure supplement 7). We can observe that the advection coefficients are inferred to be non-zero (Figure 1—figure supplement 6b and Figure 1—figure supplement 7b), however the inferred maps of spatial allele frequency dynamics closely resemble the ones obtained with true parameter values (Figure 1—figure supplement 6a and Figure 1—figure supplement 7a). This shows that complex interactions between the diffusion and advection coefficients can result in similar outcomes even when only diffusion is considered in the model.</p><p>The inference of the origin of the allele also differs when we compare the results for using model B and model C. In order to understand better how the model estimates the allele origin, we highlighted the first individual in simulations B1 and B4 that carries the derived allele. We can see that in the case of simulation B1 the inferred origin of the allele is close to the first observance of the derived allele in the model which includes advection. In contrast, when the advection is not included, the origin of the allele is inferred to be closer to where it is initially rising in frequency (Figure 1—figure supplement 1a and Figure 1—figure supplement 4a). However, this is not always the case. For instance, if we look at the results from the advection model on simulation B4, we can see that the origin of the allele is inferred relatively far from the sample known to have carried the first instance of the derived allele. Therefore, if there is a relatively large interval between the time when the allele originated and when the first ancient genomes are available, the beneficial allele can spread widely, but as this spread is not captured by any of the data points, inference of the precise origin of the selected allele is nearly impossible.”</p><disp-quote content-type="editor-comment"><p>3) Finally and more of a general question: what's the point of estimating the geographical origin of an allele if there are no samples dated from around the same time as the assumed allele age? I have the feeling this can be easily misinterpreted but maybe I am missing something. The authors discuss this (lines 199-210) when discussing the results obtained for the dynamics of the rs4988235(T) for the two assumed allele ages but it is not clear to me if the estimate for the local of origin is actually meaningful under similar situations. I wonder if with simulation one could try to understand what the method is retrieving…</p></disp-quote><p>Indeed, inference about spatio-temporal dynamics of an allele in a time period which is not covered by any ancient samples whatsoever makes little sense beyond making extremely broad conclusions (such as, perhaps, to get an idea where it is very unlikely to have originated). Specifically, our new results described above show that in situations when the advection is disallowed in the model, the allele origin tends to be inferred to lie within the region of highest allele frequencies. When the advection is considered, the model infers the origin of the allele to be in close proximity to the very first carrier of the derived in the data set of available sequenced genomes. In other words, in the absence of any useful information, difficulties may arise when inferring this parameter when the age of the allele is much larger than the age of the oldest sample in the data set.</p><disp-quote content-type="editor-comment"><p>With respect to the presentation of the work I found that the manuscript is globally well explained but there are some parts a bit difficult to follow:</p><p>1) it should be clearly stated in the main that the age of the allele is provided as input and not inferred contrarily to the geographical origin of the allele and the value used to perform the inference should also be provided in the corresponding part of the main text.</p></disp-quote><p>On lines 124-128 we mention that we use previously published allele age estimates as starting points for the diffusion process.</p><p>We mention the exact age estimates of the rs4988235(T) allele that we use as input on lines 239-240 under the section “Dynamics of the rs4988235(T) allele”.</p><p>The allele age estimate for the rs1042602(A) allele has now been added on line 275. Thank you for bringing up this issue.</p><disp-quote content-type="editor-comment"><p>2) The comparison of the results for the two ages assumed for the rs4988235(T) mutation (Itan et al. 2009 and Albers and McVean 2020), mainly between lines 199-210, is very confusing. From Figure 5a it seems there is no information on the allele for the time period between the allele age inferred by Itan et al. 2009 and Albers and McVean 2020. However, from the text it is not clearly stated whether there is or not information. If there is no information at all how does the algorithm infer an origin in Northeastern Europe?</p></disp-quote><p>We rephrased lines 252-260. We hope that the information regarding the inference of the Northeastern European origin is now conveyed more clearly.</p><p>“Assuming the older age estimate from Albers and McVean (2020), the origin of the allele is estimated to be in the Northeast of Europe (Figure 6—figure supplement 1), which is at a much higher latitude than the first occurrence of the allele, in Ukraine. Due to the deterministic nature of the model, the frequency is implicitly imposed to expand in a region where there are no actual observed instances of the allele. The model compensates for this by placing the origin in an area with a lower density of available aDNA data and thus avoiding an overlap of the increasing allele frequencies with individuals who do not carry the derived rs4988235(T) allele (see Figure 5a). As the model expands rapidly in the southern direction (Appendix 2–Table 6) it eventually reaches the sample carrying the derived variant in Ukraine.”</p><disp-quote content-type="editor-comment"><p>3) It would also help to follow the results if the authors would clearly state in the main text (lines: 212-230) the age of the allele assumed for the rs1042602(A).</p></disp-quote><p>We have now added in the main text the age of the rs1042602(A) allele in the line 275.</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>Given the ability to of the model to sample at any point in space and time, it would have been very interesting to test the model under actual geographical and temporal distributions of data, such as the Allen Ancient DNA Resource used for one of the empirical investigations, perhaps even taking the observed pattern of missingness in the data into account.</p></disp-quote><p>In the paragraph on lines 130-134 we describe a simulation scheme in which we sampled individuals from the diffusion allele frequency maps to match the locations and ages of the individuals from the Reich lab ancient DNA data and the HGDP panel.</p><disp-quote content-type="editor-comment"><p>I would recommend using latitude and longitude systematically throughout the manuscript instead of mixing x, y, latitude, longitude.</p></disp-quote><p>Thank you for pointing this out, in the new version of the text, we now always refer to geographic coordinates exclusively as longitude and latitude.</p><disp-quote content-type="editor-comment"><p>In the methods: Please fix the typo in Eq (9). Also please clarify which boundary conditions where used, and how the equations were solved numerically (using Eq. (8) or (9)?), including how boundary conditions were implemented.</p></disp-quote><p>The following explanation was added in the chapter “Parameter search” in lines 539-544.</p><p>“For numerical calculations we used the Livermore Solver for Ordinary Differential Equations (Hindmarsh, 1983) implemented in R package “deSolve” (Soetaert et al., 2010), which is a general purpose solver that can handle both stiff and nonstiff systems. In case of stiff problems the solver uses a Jacobian matrix.</p><p>Absorbing boundary conditions were used at the boundaries of the map. For visualisation purposes we masked the allele frequencies estimated in areas with negative topology (i.e. areas covered by large bodies of water).”</p><disp-quote content-type="editor-comment"><p>L437: &quot; the left-hand side of equation 5&quot;. This doesn't look right, do you mean the right-hand side of Eq. (6)?</p></disp-quote><p>Thank you for pointing out the typo. The line has now been corrected.</p><p>[Editors' note: further revisions were suggested prior to acceptance, as described below.]</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>The authors have made substantial improvements to the manuscript, and is ready for acceptance except for one remaining point:</p><p>Contrary to what the authors claim in their rebuttal, Eqs (8) and (9) in Appendix 1 still contain errors.</p><p>First, p(x+\δ x,y,t) and p(x+\δ x,y,t) appears twice on line 827.</p><p>Second, the coefficients of p(x,y,t) on both sides of Eq (9) sum to -1, which is correct. The term should therefore be absent (have coefficient zero) in Eq (8).</p></disp-quote><p>Thank you for the comments and my apologies for the inconvenience caused by our previous response regarding this. We now recognize the error and have corrected it by removing the term p(x,y,t) from the equation (8).</p></body></sub-article></article>