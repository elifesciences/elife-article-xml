<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN"  "JATS-archivearticle1-3-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">86837</article-id><article-id pub-id-type="doi">10.7554/eLife.86837</article-id><article-id pub-id-type="doi" specific-use="version">10.7554/eLife.86837.4</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>A theory of hippocampal theta correlations accounting for extrinsic and intrinsic sequences</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-306344"><name><surname>Yiu</surname><given-names>Yuk-Hoi</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1997-9277</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-306343"><name><surname>Leibold</surname><given-names>Christian</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4859-8000</contrib-id><email>christian.leibold@biologie.uni-freiburg.de</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0245cg223</institution-id><institution>Fakultät für Biologie &amp; Bernstein Center Freiburg Albert-Ludwigs-Universität Freiburg</institution></institution-wrap><addr-line><named-content content-type="city">Freiburg</named-content></addr-line><country>Germany</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05591te55</institution-id><institution>Graduate School of Systemic Neurosciences, Ludwig-Maximilians-Universität München</institution></institution-wrap><addr-line><named-content content-type="city">Munich</named-content></addr-line><country>Germany</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0245cg223</institution-id><institution>BrainLinks-BrainTools, Albert-Ludwigs-Universität Freiburg</institution></institution-wrap><addr-line><named-content content-type="city">Freiburg</named-content></addr-line><country>Germany</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Bathellier</surname><given-names>Brice</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02feahw73</institution-id><institution>CNRS</institution></institution-wrap><country>France</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Poirazi</surname><given-names>Panayiota</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/052rphn09</institution-id><institution>Foundation for Research and Technology Hellas</institution></institution-wrap><country>Greece</country></aff></contrib></contrib-group><pub-date publication-format="electronic" date-type="publication"><day>04</day><month>10</month><year>2023</year></pub-date><volume>12</volume><elocation-id>RP86837</elocation-id><history><date date-type="sent-for-review" iso-8601-date="2023-03-02"><day>02</day><month>03</month><year>2023</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint.</event-desc><date date-type="preprint" iso-8601-date="2023-02-05"><day>05</day><month>02</month><year>2023</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.02.05.527133"/></event><event><event-desc>This manuscript was published as a reviewed preprint.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2023-05-17"><day>17</day><month>05</month><year>2023</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.86837.1"/></event><event><event-desc>The reviewed preprint was revised.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2023-08-14"><day>14</day><month>08</month><year>2023</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.86837.2"/></event><event><event-desc>The reviewed preprint was revised.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2023-09-18"><day>18</day><month>09</month><year>2023</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.86837.3"/></event></pub-history><permissions><copyright-statement>© 2023, Yiu and Leibold</copyright-statement><copyright-year>2023</copyright-year><copyright-holder>Yiu and Leibold</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-86837-v1.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-86837-figures-v1.pdf"/><abstract><p>Hippocampal place cell sequences have been hypothesized to serve as diverse purposes as the induction of synaptic plasticity, formation and consolidation of long-term memories, or navigation and planning. During spatial behaviors of rodents, sequential firing of place cells at the theta timescale (known as theta sequences) encodes running trajectories, which can be considered as one-dimensional behavioral sequences of traversed locations. In a two-dimensional space, however, each single location can be visited along arbitrary one-dimensional running trajectories. Thus, a place cell will generally take part in multiple different theta sequences, raising questions about how this two-dimensional topology can be reconciled with the idea of hippocampal sequences underlying memory of (one-dimensional) episodes. Here, we propose a computational model of cornu ammonis 3 (CA3) and dentate gyrus (DG), where sensorimotor input drives the direction-dependent (extrinsic) theta sequences within CA3 reflecting the two-dimensional spatial topology, whereas the intrahippocampal CA3-DG projections concurrently produce intrinsic sequences that are independent of the specific running trajectory. Consistent with experimental data, intrinsic theta sequences are less prominent, but can nevertheless be detected during theta activity, thereby serving as running-direction independent landmark cues. We hypothesize that the intrinsic sequences largely reflect replay and preplay activity during non-theta states.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>hippocampus</kwd><kwd>phase precession</kwd><kwd>place fields</kwd><kwd>theta sequences</kwd><kwd>computaitonal model</kwd><kwd>dentate gyrus</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001659</institution-id><institution>Deutsche Forschungsgemeinschaft</institution></institution-wrap></funding-source><award-id>LE2250/13-1</award-id><principal-award-recipient><name><surname>Leibold</surname><given-names>Christian</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001659</institution-id><institution>Deutsche Forschungsgemeinschaft</institution></institution-wrap></funding-source><award-id>INST 39/963-1 FUGG</award-id><principal-award-recipient><name><surname>Leibold</surname><given-names>Christian</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A spiking neural network model explains how hippocampal theta sequences in two-dimensional arenas can arise from a combination of sensory-motor inputs, short-term synaptic plasticity, and intrinsic connectivity.</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>publishing-route</meta-name><meta-value>prc</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>As a rat navigates in an environment, place cells fire sequentially during one theta cycle (∼100 ms) and form time-compressed representations of behavioral experiences (<xref ref-type="bibr" rid="bib62">Skaggs et al., 1996</xref>), called theta sequences. Theta sequences were proposed to be driven by extrinsic (extrahippocampal) sensorimotor input (<xref ref-type="bibr" rid="bib18">Foster and Wilson, 2007</xref>; <xref ref-type="bibr" rid="bib28">Huxter et al., 2008</xref>; <xref ref-type="bibr" rid="bib54">Romani and Tsodyks, 2015</xref>; <xref ref-type="bibr" rid="bib71">Yiu et al., 2022</xref>), since they are played out in the direction of travel during locomotion and, hence, represent current behavioral trajectories. In contrast, various types of hippocampal sequences have also been proposed to arise from intrinsic hippocampal connectivity. Non-local activation of place sequences during immobile periods was observed in replay of past locations after the space has been explored (<xref ref-type="bibr" rid="bib61">Skaggs and McNaughton, 1996</xref>; <xref ref-type="bibr" rid="bib35">Lee and Wilson, 2002</xref>) as well as in preplay (<xref ref-type="bibr" rid="bib13">Dragoi and Tonegawa, 2011</xref>) of prospective locations before the animal explores a novel environment. In addition, some CA3 place cells exhibit out-of-field firing at reward locations (<xref ref-type="bibr" rid="bib56">Sasaki et al., 2018</xref>). These remote activations of place cells reflect the underlying circuit connectivity rather than the actual location and movement of the animal. Furthermore, a subset of CA3 cell pairs shows rigid theta correlations with peak lags that are independent of the traversal order of their place fields (<xref ref-type="bibr" rid="bib71">Yiu et al., 2022</xref>), suggesting the existence of hard-wired sequences <italic>even</italic> when sensorimotor drive is present. Such intrinsic sequences that are driven by intrahippocampal connectivity (<xref ref-type="bibr" rid="bib67">Tsodyks et al., 1996</xref>), although less predominantly observed during theta (<xref ref-type="bibr" rid="bib71">Yiu et al., 2022</xref>), are generally interpreted as reflecting spatial memories or planning (<xref ref-type="bibr" rid="bib32">Kay et al., 2020</xref>).</p><p>Existing models for theta sequences are, however, either fully extrinsic or intrinsic. The former often employ short-term plasticity (<xref ref-type="bibr" rid="bib54">Romani and Tsodyks, 2015</xref>; <xref ref-type="bibr" rid="bib66">Thurley et al., 2008</xref>), which creates synaptic couplings that are temporally stronger along the instantaneous forward direction. In contrast, intrinsic models, such as the <xref ref-type="bibr" rid="bib67">Tsodyks et al., 1996</xref> model, use a fixed asymmetrical weight matrix pre-designed to align with one movement trajectory (for review see <xref ref-type="bibr" rid="bib44">Maurer and McNaughton, 2007</xref>; <xref ref-type="bibr" rid="bib30">Jaramillo and Kempter, 2017</xref>). Neither of these models alone can explain the simultaneous presence of rigid and flexible correlations in theta sequences. Here we present a network model that accounts for both types of correlations by separating their generation into two anatomically distinct layers: CA3 and dentate gyrus (DG). Extrinsic sequences are generated in the CA3 layer by short-term synaptic plasticity mechanisms, while the intrinsic sequences are evoked by the CA3-DG feedback loop with fixed asymmetrical weights, as inspired by the experimental evidence that lesions of DG abolish non-local activation of CA3 place cells (<xref ref-type="bibr" rid="bib56">Sasaki et al., 2018</xref>) and CA3 theta correlations (<xref ref-type="bibr" rid="bib3">Ahmadi et al., 2022</xref>).</p><p>In this paper, we present a model for theta correlations that unifies both extrinsic and intrinsic mechanisms. Extrinsic and intrinsic sequences can propagate simultaneously in separate directions, along the movement trajectory and the pre-designed CA3-DG feedback loops, respectively. As a result, spike correlations display directionality as the two sequences cross each other at various angles: The more parallel they are, the stronger the correlation. Our simulations are in quantitative agreement with directionality properties found in experimental data (<xref ref-type="bibr" rid="bib71">Yiu et al., 2022</xref>) and propose that rigid correlation structure can serve as a stable temporal pattern, which is recognizable across multiple movement directions. This temporal ‘landmark’ pattern allows spatial encoding even if sensory-motor experience is lacking and may reflect the mechanistic basis for replay in non-theta states.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Dependence of theta sequences on heading directions: Extrinsic and intrinsic sequences</title><p>Theta-scale correlations of place cells have been explained by previous models using two different types of network mechanisms, intrinsic and extrinsic ones. For <italic>intrinsic</italic> models spike correlations are explained by only the recurrent connectivity of the neuronal network (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). For <italic>extrinsic</italic> models, the spike correlation is defined by sensory-motor parameters such as movements (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). We first illustrate how these mechanisms work for two exemplary representatives of these two major model classes.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Phase precession depends on running direction in intrinsic models but not extrinsic models.</title><p>(<bold>A</bold>) Left: Schematic illustration of the intrinsic <xref ref-type="bibr" rid="bib67">Tsodyks et al., 1996</xref> model. When the animal runs through a series of place fields (solid circles) in 1-D, the place cells fire action potentials in sequence at the theta timescale (spike raster with corresponding colors). Recurrent connectivity is pre-configured and asymmetrical (connection strengths indicated by arrow sizes). Right: Cross-correlation function between the red and magenta cell, which remains the same for both running directions. (<bold>B</bold>) Left: Schematic illustration of the extrinsic <xref ref-type="bibr" rid="bib54">Romani and Tsodyks, 2015</xref> model. Recurrent connections behind the animal are temporarily depressed by short-term plasticity, and thereby, become movement-dependent. Right: Cross-correlation flips sign in the opposite running direction. (<bold>C</bold>) Simulated trajectories (duration 2 s) in a 2-d environment (80×80 cm) with speed 20 cm/s in left and right (left column), diagonal (middle), and up and down (right) directions. (<bold>D–F</bold>) Simulation results from the intrinsic model (with fixed asymmetrical connectivity inspired by the <xref ref-type="bibr" rid="bib67">Tsodyks et al., 1996</xref> model). Place cells only project synapses to their right neighbors. (<bold>D</bold>) Spike raster plots of place cells along the orange (left panel) and light green (right panel) trajectories (colors defined in C). Theta sequence order remains the same in the reversed running direction. Black line indicates animal position. (<bold>E</bold>) Phase-position relation for the spikes colored in C. Linear-circular regression (gray line) parameters are indicated on top. Positions of the animal at the first and last spike are normalized to 0 and 1, respectively. (<bold>F</bold>) Averaged cross-correlation of all cell pairs separated by 4 cm along the trajectory. Reversal of running direction does not flip the sign of the peak lags. (<bold>G–I</bold>) Same as D-F, but for the extrinsic model (spike-based variant of <xref ref-type="bibr" rid="bib54">Romani and Tsodyks, 2015</xref> model). Correlation peaks flip after reversal of running direction.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-86837-fig1-v1.tif"/></fig><p>For intrinsic models, we refer to the <xref ref-type="bibr" rid="bib67">Tsodyks et al., 1996</xref> model where phase precession is generated by the fixed asymmetrical connectivity between place cells. Spike phases of the place cells ahead of the animal decrease as the excitatory drive is gradually increasing, but only along the direction in which the connection strength is asymmetrically stronger (e.g. rightward in <xref ref-type="fig" rid="fig1">Figure 1A</xref>), called the <italic>asymmetry direction</italic>. Here we simulate a network of CA3 place cells with fixed asymmetrical connectivity (see Methods section: CA3 recurrent connections) as suggested in the <xref ref-type="bibr" rid="bib67">Tsodyks et al., 1996</xref> model and applied our model to behavioral running trajectories in a 2-d open space (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). Phase precession and spike correlations (<xref ref-type="fig" rid="fig1">Figure 1D–E</xref>) are compared for opposite running directions. In our simulations, all place cells project excitatory synapses to their counterparts with rightward neighboring place fields. Phase precession therefore is determined by how closely the running direction matches the asymmetry direction imposed by the intrinsic connections. The closer the trajectory angle aligns with this asymmetry direction, the more negative is the slope of phase precession (<xref ref-type="fig" rid="fig1">Figure 1E</xref>). Since in this case, the theta sequence only propagates rightwards as place cells are sequentially activated from left to right, the signs of spike correlations between cell pairs remain invariant to the movement direction (<xref ref-type="fig" rid="fig1">Figure 1F</xref>, see Methods section: Cross-correlation analysis). Intrinsic models thus cannot explain experimentally observed directional independence of phase precession and directional dependence of theta spike correlations (<xref ref-type="bibr" rid="bib28">Huxter et al., 2008</xref>).</p><p>Our example of an extrinsic model is based on our spiking simulations of the originally rate-based model by <xref ref-type="bibr" rid="bib54">Romani and Tsodyks, 2015</xref>, where phase precession was explained by symmetric recurrent connections that undergo running direction-dependent attenuation by short-term synaptic depression (STD): place fields with centers behind the current animal position on the trajectory thereby received largely reduced recurrent input resulting in recurrently driven theta sequences to play out only in forward direction (see Methods section: CA3 recurrent connections). We simulated our spiking variant of the <xref ref-type="bibr" rid="bib54">Romani and Tsodyks, 2015</xref> model with the same trajectories as the intrinsic model (<xref ref-type="fig" rid="fig1">Figure 1G–I</xref>), and recovered direction-independent phase precession (<xref ref-type="fig" rid="fig1">Figure 1H</xref>). Since now, the theta sequences are played out in the same direction as the movement, theta spike correlations are symmetrically reversed (<xref ref-type="fig" rid="fig1">Figure 1I</xref>) as shown experimentally in CA1 neurons (<xref ref-type="bibr" rid="bib28">Huxter et al., 2008</xref>; <xref ref-type="bibr" rid="bib71">Yiu et al., 2022</xref>).</p><p>In area CA3, however, theta spike correlations are neither solely extrinsic (<xref ref-type="bibr" rid="bib71">Yiu et al., 2022</xref>; <xref ref-type="bibr" rid="bib32">Kay et al., 2020</xref>), since phase precession properties change in relation to running directions, nor are they solely intrinsic since reversal of correlation is still observed in most of the sequences (<xref ref-type="bibr" rid="bib28">Huxter et al., 2008</xref>; <xref ref-type="bibr" rid="bib71">Yiu et al., 2022</xref>). We therefore propose a new theory of phase precession for CA3 incorporating both intrinsic and extrinsic factors.</p></sec><sec id="s2-2"><title>Directional sensory input</title><p>To, however, fully explain directional properties of theta phase precession and theta spike correlations by a model, also directional modulations of firing rates (<xref ref-type="bibr" rid="bib71">Yiu et al., 2022</xref>) need to be taken into account.</p><p>We therefore included both directional and positional modulation of the sensory input to the model place cells (<xref ref-type="fig" rid="fig2">Figure 2A–B</xref>) with randomized preferred heading directions (see Methods section: Spatial input). The sensory input is assumed to arise from MEC, and hence, it is also theta-modulated and phase-shifted by <inline-formula><mml:math id="inf1"><mml:msup><mml:mn>70</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:math></inline-formula> with respected to the peak of theta cycle (<xref ref-type="bibr" rid="bib49">Mizuseki et al., 2009</xref>). Furthermore, since the precession slope observed in the <xref ref-type="bibr" rid="bib54">Romani and Tsodyks, 2015</xref> model is limited (-1.13 radians per field size, see <xref ref-type="fig" rid="fig1">Figure 1H</xref>) as compared to the experimental reports (-4.44 radians (<xref ref-type="bibr" rid="bib71">Yiu et al., 2022</xref>) and about -2.0 radians (<xref ref-type="bibr" rid="bib23">Harris et al., 2002</xref>) per field size), we introduced short-term synaptic facilitation (STF) to the sensory input (<xref ref-type="bibr" rid="bib4">Berretta and Jones, 1996</xref>; <xref ref-type="bibr" rid="bib66">Thurley et al., 2008</xref>) generating temporally asymmetric depolarization as suggested by intracellular recordings in vivo (<xref ref-type="bibr" rid="bib24">Harvey et al., 2009</xref>; <xref ref-type="fig" rid="fig2">Figure 2B</xref>). STF amplifies the sensory current at the later part of the field, thus creating phase precession with steeper slopes thereby extending the phase range (see Methods section: Spatial input). Finally, we designated the synaptic weights to be stronger between place cells with similar preferred heading directions (<xref ref-type="fig" rid="fig2">Figure 2C</xref>) as has been proposed (<xref ref-type="bibr" rid="bib5">Brunel and Trullier, 1998</xref>) as a result of Hebbian plasticity applied to directional firing fields.</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Directional input gives rise to spikes at lower theta phase.</title><p>(<bold>A</bold>) Directional input component of an example place cell. (<bold>B</bold>) Total sensory input as the sum of directional and positional drive of an example place cell for the animal running along (red dashed line, left) and opposite (blue dashed line, right) the preferred heading direction of the cell, respectively named as <italic>best</italic> and <italic>worst</italic> direction. The sensory input is modelled by oscillatory currents arriving with +70° phase shift relative to theta peaks (gray vertical lines). Place fields are defined by a 5 cm rectangular envelope. Solid lines depict the input current including short-term synaptic facilitation. (<bold>C</bold>) Synaptic weights (<inline-formula><mml:math id="inf2"><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, color) from the place cell at the center (the darkest dot) to its neighbors in the 2-d environment. Each dot is a place field center in 2-d space. Arrows depict their preferred heading directions. (<bold>D</bold>) Spike raster plot sorted by visiting order of the place fields along the trajectory. Spikes of the cells with best and worst direction are colored in red and blue, respectively. (<bold>E</bold>) Phase position plots for the cells with best and worst direction from D (labels as in <xref ref-type="fig" rid="fig1">Figure 1E</xref>). The mean phase is marked as horizontal gray bar. (<bold>F</bold>) Example place cell centers with best (&lt;30° different from the trajectory; red) and worst (&gt;150°; blue) directions relative to the rightward trajectory (gray line). Only centers of cells that fire more than 5 spikes are shown. (<bold>G</bold>) Slopes and onsets of phase precession of the population from (<bold>F</bold>). Marginal slope and onset distributions are plotted on top and right, respectively. Note higher phase onset in the worst-direction case. (<bold>H</bold>) Spike phase distributions. Higher directional inputs generate lower spike phases. (<bold>I</bold>) Average spike correlation between all pairs with 4 cm of horizontal distance difference when the animal runs rightwards and leftwards. Peak lags are flipped as expected from an extrinsic model.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-86837-fig2-v1.tif"/></fig><p>A simulation of the place cell network was performed for a rightward trajectory through the arena based on our variant of the extrinsic <xref ref-type="bibr" rid="bib54">Romani and Tsodyks, 2015</xref> model (<xref ref-type="fig" rid="fig2">Figure 2D</xref>). We focus on two sets of place cells, one for which the trajectory aligns with the preferred heading direction of the field (red, denoted as <italic>best</italic> direction) and one for which the trajectory runs opposite the preferred heading direction (denoted as <italic>worst</italic> direction; <xref ref-type="fig" rid="fig2">Figure 2F</xref>). Phase precession has a lower onset and marginal spike phase along best direction than along the worst (<xref ref-type="fig" rid="fig2">Figure 2G–H</xref>), which is consistent with experimental data (<xref ref-type="bibr" rid="bib71">Yiu et al., 2022</xref> report mean spike phases ± SEM for best and worst direction of 1.61 ± 0.02 and 2.22 ± 0.03 in radians respectively), reflects that larger depolarizations generally yield shorter latencies. Directionality of the input, although it yields lower spike phases through higher depolarization, does not affect spike pair correlations, which remains solely extrinsic (<xref ref-type="fig" rid="fig2">Figure 2I</xref>). Thus, even though rate directionality and directional bias in recurrent connectivity can render phase precession directionally dependent, they are not sufficient to account for intrinsic sequences.</p></sec><sec id="s2-3"><title>Generation of intrinsic sequences by the DG-CA3 recurrent network</title><p>To explain the expression of intrinsic sequences in CA3, we propose them to be generated by the interaction of two networks, CA3 and DG (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). DG is a good candidate region to be involved in phase precession, since lesions of it were shown to reduce prospective spiking (<xref ref-type="bibr" rid="bib56">Sasaki et al., 2018</xref>) and to lower the onset phase of phase precession (<xref ref-type="bibr" rid="bib3">Ahmadi et al., 2022</xref>). In our model, the neurons in DG receive excitatory synaptic inputs from CA3 place cells (putatively via hilar mossy cells) and project back to the CA3 cells with place field centers at a different location (<xref ref-type="disp-formula" rid="equ18">Equation 3</xref>) to induce propagation of intrinsic sequences along a specific spatial direction. The CA3 cells at the target location of DG input are then activated and evoke higher depolarization in cells with place fields at the next DG target locations through the feedback. This scheme produces a rigid sequence whose activation order is independent of the movement direction. The connection pattern of DG-CA3 projections (for brevity, we also refer to it as ‘DG loop’ in the subsequent text) could be determined by pre-existing network structure or past experience through associative learning, or both.</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>DG-CA3 loop introduces directionality of theta sequences.</title><p>(<bold>A</bold>) Illustration of synaptic connections from CA3 place cells to DG and vice versa. DG layer mirrors the place cell population in CA3 and redirects the CA3 inputs back to different locations. Here, DG cells project into CA3 place cells with fields 4 cm displaced to the right of the pre-synaptic CA3 cells. <inline-formula><mml:math id="inf3"><mml:msub><mml:mi>θ</mml:mi><mml:mi>DG</mml:mi></mml:msub></mml:math></inline-formula> denotes the angular difference between the DG projection direction and the animal’s movement direction. (<bold>B</bold>) Spike raster plots sorted by cell indices along the trajectory (2 s duration) from x=-20 cm to x=20 cm. Cells with best and worst angles are marked by red and blue colors, respectively. (<bold>C</bold>) Phase-position plots as is <xref ref-type="fig" rid="fig2">Figure 2E</xref>. (<bold>D</bold>) Distributions of precession slopes, onsets and spike phases as in <xref ref-type="fig" rid="fig2">Figure 2G–H</xref>. (<bold>E–H</bold>) Same as A-D, but with DG cells projecting opposite to the animal’s movement direction (<inline-formula><mml:math id="inf4"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>DG</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>180</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>). In F, cyan and yellow shaded regions indicate the examples of forward sequence induced by the movement (extrinsic), and backward sequence induced by the DG recurrence (intrinsic), respectively. (<bold>I</bold>) Average spike correlations for <inline-formula><mml:math id="inf5"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>DG</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf6"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>DG</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>180</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> for pairs separated by 4 cm along the trajectory. Note that for <inline-formula><mml:math id="inf7"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>DG</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>180</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, there is a relative excess of spike-pairs with positive lags. (<bold>J</bold>) Left: Intrinsicity and extrinsicity (see Methods) for all pairs from the populations with best (red) and worst (blue) direction. Pair correlations above and below the identity line are classified as intrinsic and extrinsic, respectively. Numbers are the ratios of extrinsically to intrinsically correlated field pairs. Note that the red best direction pairs are more extrinsic than the blue worst direction pairs due to higher sensory input. Middle: Ex/Intrinsicity of pairs with similar (&lt;30°) and dissimilar (&gt;150°) preferred heading angles. Pairs with similar preferred heading angle s are more intrinsic due to stronger DG-CA3 recurrence. Right: Cumulative distribution of the differences between extrinsicity and intrinsicity. Dissimilar and best direction pairs have higher bias to extrinsicity than similar and worst direction pairs, respectively.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-86837-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Effects of STF and STD time constants on theta sequences.</title><p>(<bold>A</bold>) Left: Spike raster plot of the CA3 place cells along the trajectory at = <inline-formula><mml:math id="inf8"><mml:msup><mml:mi>τ</mml:mi><mml:mi>F</mml:mi></mml:msup></mml:math></inline-formula> 250ms (top row), 100ms (middle) and 2000ms (bottom). Conventions follow <xref ref-type="fig" rid="fig3">Figure 3B</xref>. Decreasing <inline-formula><mml:math id="inf9"><mml:msup><mml:mi>τ</mml:mi><mml:mi>F</mml:mi></mml:msup></mml:math></inline-formula> allows faster recovery time of the sensory input to its resting value,<inline-formula><mml:math id="inf10"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mn>0</mml:mn><mml:mi>F</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> thus reducing the amount of depolarization and firing rate, as compared to = <inline-formula><mml:math id="inf11"><mml:msup><mml:mi>τ</mml:mi><mml:mi>F</mml:mi></mml:msup></mml:math></inline-formula> 500ms used in <xref ref-type="fig" rid="fig3">Figure 3</xref>. However, the temporal order of theta sequences remains unchanged. Right: Distribution of slopes and onsets of phase precession in the best and worst directions, following the conventions of <xref ref-type="fig" rid="fig3">Figure 3D</xref>. At = <inline-formula><mml:math id="inf12"><mml:msup><mml:mi>τ</mml:mi><mml:mi>F</mml:mi></mml:msup></mml:math></inline-formula> 100ms, the place cells do not generate enough spikes (spike count ≤ 5) for the analysis. (<bold>B</bold>) Increasing the amount of sensory input <inline-formula><mml:math id="inf13"><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> by 60% (from 6.5 in <xref ref-type="fig" rid="fig3">Figure 3</xref> to 10.5 here) can restore the firing activity and theta sequences at <inline-formula><mml:math id="inf14"><mml:msup><mml:mi>τ</mml:mi><mml:mi>F</mml:mi></mml:msup></mml:math></inline-formula>= 100ms. (<bold>C</bold>) Changing the STD time constant <inline-formula><mml:math id="inf15"><mml:msup><mml:mi>τ</mml:mi><mml:mi>D</mml:mi></mml:msup></mml:math></inline-formula> does not noticeably affect the temporal structure of theta sequences and the distribution of phase precession slopes and onsets.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-86837-fig3-figsupp1-v1.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Effects of running speed on theta sequences.</title><p>(<bold>A</bold>) Left: Spike raster plot of the CA3 place cells along the trajectory at running speed v=20 cm/s (top row), 40cm/s (middle) and 100cm/s (bottom). Conventions follow <xref ref-type="fig" rid="fig3">Figure 3B</xref>. As place cells are traversed at increasing velocities, their firing rate decreases due to insufficient depolarization. Right: Distribution of slopes and onsets of phase precession in the best and worst directions, following the conventions of <xref ref-type="fig" rid="fig3">Figure 3D</xref>. Only the distribution for running speed at 20 cm/s is shown. At running speed 40 cm/s and 100 cm/s, the place cells do not generate enough spikes (spike count ≤ 5) for the analysis. (<bold>B</bold>) Theta sequences at high running speed (100 cm/s) could be produced by a larger place field size (width of box-shaped input is increased to 15 cm compared to 5 cm in <xref ref-type="fig" rid="fig3">Figure 3</xref>) and longer DG projection (<inline-formula><mml:math id="inf16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>=12 cm compared to 4 cm in <xref ref-type="fig" rid="fig3">Figure 3</xref>). Phase precession slopes and onsets are lower than in (<bold>A</bold>). (<bold>C</bold>) Increasing theta frequency to 12 Hz can recover the decrease of phase precession slope and onset from the high running speed (<xref ref-type="bibr" rid="bib53">Rivas et al., 1996</xref>; <xref ref-type="bibr" rid="bib43">Maurer et al., 2005</xref>). Model parameters are the same as <xref ref-type="fig" rid="fig3">Figure 3</xref> in the main text unless specified at the bottom right of the raster plots.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-86837-fig3-figsupp2-v1.tif"/></fig></fig-group><p><xref ref-type="fig" rid="fig3">Figure 3</xref>, provides schematic illustrations, for a DG layer that either only projects CA3 activity to their rightward neighbours (<inline-formula><mml:math id="inf17"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>DG</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, <xref ref-type="fig" rid="fig3">Figure 3A</xref>) or only to their leftward neighbors (<inline-formula><mml:math id="inf18"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>DG</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>180</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, <xref ref-type="fig" rid="fig3">Figure 3E</xref>). Simulations for both cases (<inline-formula><mml:math id="inf19"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>DG</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf20"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>DG</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>180</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>) assume a rightward trajectory. Apart from the addition of the DG layer, the model architecture and parameters of CA3 layer are the same as in <xref ref-type="fig" rid="fig2">Figure 2</xref> (including best and worst direction in place field firing rate), which only generates extrinsic sequences through STD in the CA3 recurrent synaptic connections. DG-loop connectivity is additionally modulated by firing rate directionality of the CA3 place fields. Fields with similar preferred heading directions are more strongly connected via the loop than those with opposite preferred heading directions (see Methods section: DG layer).</p><p>We found that, when the simulated animal is running in the same direction as the DG-CA3 projection, phase precession starts from a higher phase (<xref ref-type="fig" rid="fig3">Figure 3C–D</xref>) due to the forward activation of place cells through DG layer (recovering the effect of asymmetric connectivity in the original <xref ref-type="bibr" rid="bib67">Tsodyks et al., 1996</xref> model), as compared to the model without DG layer (<xref ref-type="fig" rid="fig2">Figure 2G–H</xref>). Spike phases in best direction remain lower than along the worst direction (<xref ref-type="fig" rid="fig3">Figure 3D</xref>). When, however, the animal is running against the DG-CA3 projection (<xref ref-type="fig" rid="fig3">Figure 3E</xref>), extrinsic sequences are still present in forward direction, evoked by the movement of the animal, but the intrinsic sequences are played out backward as determined by the direction of fixed recurrence (see cyan and yellow shaded regions in <xref ref-type="fig" rid="fig3">Figure 3F</xref>). The latter is reflected by the higher phase at the end of the phase position plots (<xref ref-type="fig" rid="fig3">Figure 3G</xref>) which leads to flatter precession slopes and decreases the fraction of phase precession (slope &lt;0) of all traversal trials (<xref ref-type="fig" rid="fig3">Figure 3H</xref>). A closer look into pair correlation reveals that for trajectories opposite to the DG-loop projection (<inline-formula><mml:math id="inf21"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>DG</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>180</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>), spike probability is added to positive time lags (<xref ref-type="fig" rid="fig3">Figure 3I</xref>). Therefore, introducing fixed recurrence through DG loops elicits both extrinsic and intrinsic sequences and qualitatively changes theta sequences.</p><p>To quantify the degrees of extrinsic and intrinsic sequence firing in a way allowing comparison to experimental reports, we use the measures <italic>extrinsicity</italic> and <italic>intrinsicity</italic> (<xref ref-type="bibr" rid="bib71">Yiu et al., 2022</xref>) that are based on pairs of place cells with overlapping place fields (see Methods section: Extrinsicity and intrinsicity, and Discussion). In our simulation, extrinsically and intrinsically driven cell pairs are both present in the population (<xref ref-type="fig" rid="fig3">Figure 3J</xref>), indicating a coexistence of extrinsic and intrinsic sequences. Our model reproduces a greater extrinsicity for cell pair activity when running direction aligns with both best place field directions as compared to when it aligns to both worst field directions, since along the best direction, cells receive more sensory depolarization, and thus, the movement-dependent extrinsic sequences are more activated. The model also explains, why pairs with similar preferred heading directions may be less extrinsic than pairs with approximately opposite preferred heading direction (dissimilar pairs), since the DG loop preferentially connects CA3 place cells with similar preferred heading directions. Both of the results follow the same trend as found in experimental data (<xref ref-type="bibr" rid="bib71">Yiu et al., 2022</xref> report ratios of extrinsically to intrinsically correlated CA3 field pairs of 1.57 for both-best directions, 0.41 for both-worst directions, 0.87 for similar pairs and 2.43 for dissimilar pairs).</p><p>Thus, by introducing feedback excitation via the DG layer, intrinsic sequences are able to propagate in fixed directions on top of the movement-dependent extrinsic sequences. Theta sequence directionality is reflected through the change in spike correlation, which varies as a function of the difference between the direction of DG feedback and movement direction. The combination of extrinsic and intrinsic theta sequence activity is robust regarding changes of the parameters of short-term synaptic plasticity (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>), as well as running speed (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>), as long as place fields are wide enough to allow spikes in sufficiently many theta cycles.</p></sec><sec id="s2-4"><title>Lesion of DG reduces theta compression and phase precession range</title><p>One prediction of the DG-loop model, consistent with findings from DG lesion experiments (<xref ref-type="bibr" rid="bib3">Ahmadi et al., 2022</xref>), is that DG would contribute to the temporal organization of spike sequences in CA3. To verify this hypothesis also in the model, we implemented a lesion of DG by disabling activity in the DG layer. To compensate for reduced excitatory drive caused by the lesion, we then increased probability of release of the sensory inputs thereby increasing the initial input amplitudes but removing short-term synaptic facilitation (<xref ref-type="fig" rid="fig4">Figure 4A</xref>).</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>DG lesion reduces theta compression and phase precession range.</title><p>DG recurrence is turned off to simulate the lesion condition. (<bold>A</bold>) Positional sensory inputs into a place cell in lesion (purple) and control (green) cases. The control case is identical to <xref ref-type="fig" rid="fig3">Figure 3</xref>. In the lesion case, DG input is compensated by increased sensory input with increased probability of synaptic release, hence reduced short-term synaptic facilitation. (<bold>B</bold>) Theta compression, that is correlation between peak correlation lag and distance of field centers in the control case. Each dot represents a field pair. Linear-circular regression line is indicated in black. Note that the sign of regression slope (<inline-formula><mml:math id="inf22"><mml:mi>a</mml:mi></mml:math></inline-formula> in radians/cm) is determined by the directions of DG loop (negative in <inline-formula><mml:math id="inf23"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>DG</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>180</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>). (<bold>C</bold>) same as B, but for the lesion case. Theta compression is reduced as compared to the control condition. (<bold>D</bold>) Top: Distribution of spike phase during phase precession in all active (spike count &gt; 5) cells in control and lesion case. Bottom: Distribution of phase precession range for all active cells.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-86837-fig4-v1.tif"/></fig><p>We found that a DG lesion would reduce theta compression in sequence activity. Theta compression (<xref ref-type="bibr" rid="bib12">Dragoi and Buzsáki, 2006</xref>) refers to the compression of seconds-long behavioural experience of place-field crossing into a neural representation of spike sequences at a shorter (theta) timescale. To quantify the strength of theta compression, we plotted the pair correlation lags versus the distance between the centers of two fields (abbreviated as ‘lags’ and ‘pair distance’ respectively), after simulating a rightward trajectory (<xref ref-type="fig" rid="fig4">Figure 4B–C</xref>). The magnitude of the linear-circular regression slope <inline-formula><mml:math id="inf24"><mml:mi>a</mml:mi></mml:math></inline-formula> measures how much theta phase encodes a certain interval in space, and therefore, the strength of theta compression. As a result, theta compression is reduced for the DG-lesioned case (<inline-formula><mml:math id="inf25"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>0.053</mml:mn></mml:mrow></mml:math></inline-formula> radians/cm for both <inline-formula><mml:math id="inf26"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>DG</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf27"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>DG</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>180</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>), as compared to the control case (<inline-formula><mml:math id="inf28"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>0.183</mml:mn></mml:mrow></mml:math></inline-formula> radians/cm for <inline-formula><mml:math id="inf29"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>DG</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf30"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.059</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> radians/cm for <inline-formula><mml:math id="inf31"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>DG</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>180</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>) reproducing the finding (<xref ref-type="bibr" rid="bib3">Ahmadi et al., 2022</xref>) that spatial encoding via theta sequences crucially depends on intact DG and suggesting that the loss of DG inputs could be compensated for by the increase of release probability in the spared afferent synapses from the MEC. The DG lesion also reduces the spike phase and phase range of phase precession (<xref ref-type="fig" rid="fig4">Figure 4D</xref>), which indicates the participation of DG loops in high-phase spiking. Both weaker phase precession and theta compression stress the important role of DG in temporal organization of CA3 sequences.</p></sec><sec id="s2-5"><title>Theta sequences in 2-d and out-of-field firing</title><p>So far, the model was only evaluated on bidirectional linear tracks, where running directions completely overlapped with the orientation of the DG loop connectivity. Now, we extend our analysis to 2-d space by examining oblique trajectories which cross the orientation of DG-loop projection at certain angles.</p><p>We first arrange the DG-loop connections such that the DG-loop orientation crosses a rightward trajectory at 45° and 225° (<xref ref-type="fig" rid="fig5">Figure 5A–F</xref>). Similar to the cases of <inline-formula><mml:math id="inf32"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>DG</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf33"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>DG</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>180</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3">Figure 3D and H</xref>), precession slopes are steeper and onsets higher when the trajectory direction aligns more with the orientation of the DG-loop, but with a smaller effect size for oblique crossings (<xref ref-type="fig" rid="fig5">Figure 5A and C</xref>) since DG-loop connectivity area only overlaps with part of the trajectory near the intersection. We further resolve the precession slope, onset and marginal phase for each place cell into 2-d maps (<xref ref-type="fig" rid="fig5">Figure 5B and D</xref>). Intrinsic sequences with a higher marginal spike phase can be clearly seen along the belt of DG-loop projections and are even extended to the outside of trajectory predicting ‘off-track’ spikes at high phases. Depending on the alignment between movement direction and DG-loop orientation, the slope becomes either more negative (<inline-formula><mml:math id="inf34"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>DG</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>45</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>) or more positive (<inline-formula><mml:math id="inf35"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>DG</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>225</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>). Analysis of extrinsicity and intrinsicity was conducted for all field pairs and confirmed the same trend as in <xref ref-type="fig" rid="fig3">Figure 3</xref> that best and dissimilar pairs are more extrinsic than worst and similar pairs, respectively (<xref ref-type="fig" rid="fig5">Figure 5E</xref>). As a quantitative prediction, we computed the angle differences between field centers of cell pairs for the extrinsic and intrinsic populations, and observe that place field center differences in extrinsically correlated field pairs are mostly oriented horizontally (along the running direction) while place field center differences from intrinsically correlated field pairs are oriented along the DG-loop orientation <inline-formula><mml:math id="inf36"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>DG</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>45</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, as by design (<xref ref-type="fig" rid="fig5">Figure 5F</xref>).</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Intrinsic sequences lead to direction dependent 2-d phase precession and out-of-field firing (<bold>A</bold>) Left: Schematic illustration of DG-loop projection being tilted by 45° relative to the trajectory.</title><p>Right: Distributions of phase precession onsets and slopes from the place cells along the trajectory as in <xref ref-type="fig" rid="fig2">Figure 2G</xref>. (<bold>B</bold>) Slopes (left), onsets (middle) and mean spike phases (right) of phase precession from the place cells as a function of field center. High spike phases and onsets occur along the DG-loop orientation where intrinsic spiking dominates and yield out-of-field firing (see the extrusions from horizontal dot clouds) with late onsets and phases. (<bold>C–D</bold>) Same as A-B, but DG-loop projection is at 225° relative to trajectory direction. (<bold>D</bold>) For DG loops pointing opposite to the sensorimotor drive, prospective firing along the DG loop yields less steep precession slopes and lower onset. (<bold>E</bold>) Extrinsicity and intrinsicity of all place field pairs along the trajectory as in <xref ref-type="fig" rid="fig3">Figure 3J</xref>. Some pairs are totally extrinsic (Ex = 1) because DG projection is absent at those parts of the trajectory. (<bold>F</bold>) Density of field pairs with extrinsic/intrinsic correlation as a function of the orientation of field center difference vector relative to the x axis. Intrinsic fields peak at 45°. (<bold>G</bold>) Same as A-D, but DG-loop orientations are perpendicular to the trajectory direction at 90° (top) and 270°. Prospective spikes from intrinsic sequences are initiated in the perpendicular directions. (<bold>H</bold>) Same as E, but with higher Ex-In ratios. (<bold>I</bold>) Field pairs with intrinsic correlations are at ±90°.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-86837-fig5-v1.tif"/></fig><p>The analysis above is repeated for the geometric configurations that DG-loop connectivity is minimally interacting with the place cell activity induced by movement, that is when DG-loop orientation and the movement direction are perpendicular to each other (<inline-formula><mml:math id="inf37"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>DG</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>90</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf38"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>DG</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>270</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, <xref ref-type="fig" rid="fig5">Figure 5G</xref>). Similar effects as in <xref ref-type="fig" rid="fig5">Figure 5B and D</xref> on precession slope, onset and marginal phases are also observed in the 2-d map, except that the effects are further restricted to the intersection area in the middle. Also, the whole population has become more extrinsic as compared to the 45° and 225° cases (<xref ref-type="fig" rid="fig5">Figure 5H</xref>, see the numbers for extrinsic-intrinsic ratios) due to the smaller overlapping area between DG-loop projection and the trajectory. Lastly, the pair center difference orientation confirms that field pairs with extrinsic correlations follow the trajectory direction while those with intrinsic correlation are biased towards the DG-loop orientations (90°).</p><p>The results demonstrate the distinct roles of extrinsic and intrinsic sequences in 2-d spatial encoding. The former represents trajectory direction while the latter the associative memory towards specific locations. They can be played out at the same time separately in different directions and only interact with each other when they overlap. The interaction is reflected in directional dependence of phase precession properties, most notably the higher spike phases from the DG-CA3 recurrent input, as well as increased intrinsicity of pair correlation and extended firing fields along the orientation of the DG-loop projections. Intrinsic sequences also triggered out-of-field firing (<xref ref-type="fig" rid="fig5">Figure 5B, D and G</xref>) at late theta phases. In this case, the DG-loop connects to cells with remote place fields. These cells could even display multiple separated place fields, with high spike phases indicating the target location of the intrinsic sequence.</p></sec><sec id="s2-6"><title>Topology-free mechanisms of extrinsic phase precession</title><p>A well-known problem of phase precession models based on recurrent connectivity that applies to both, the original intrinsic <xref ref-type="bibr" rid="bib67">Tsodyks et al., 1996</xref> and <xref ref-type="bibr" rid="bib54">Romani and Tsodyks, 2015</xref> model, is that they do not explain how the topological connectivity matrix (in our case <inline-formula><mml:math id="inf39"><mml:msup><mml:mi>W</mml:mi><mml:mi>CA3</mml:mi></mml:msup></mml:math></inline-formula>) is generated (<xref ref-type="bibr" rid="bib39">Lisman and Redish, 2009</xref>; <xref ref-type="bibr" rid="bib30">Jaramillo and Kempter, 2017</xref>). Extrinsic theta sequences in a first exposure to a novel environment should therefore be missing. Although <xref ref-type="bibr" rid="bib17">Feng et al., 2015</xref> find that theta sequences on a first exposure of a novel linear track are indeed much weaker (maybe only reflecting intrinsic sequences), their results nevertheless indicate a very fast learning time scale that is hard to reconcile with recurrent learning of a full spatial topology (particularly the generalization to 2-d). Also their result might be hampered by place field plasticity that biases the decoder towards backward-shifted place maps of later trials (<xref ref-type="bibr" rid="bib50">Parra-Barrero and Cheng, 2023</xref>). We therefore explored, whether extrinsic 2-d sequences could also be generated by a model that is not relying on 2-d topology in the recurrent weights. To this end, we disabled the CA3 recurrence and compensated the missing level of excitation by an increased strength of the spatial input and the DG loops (see Methods section: Parameters of the models). Our simulations show that extrinsic sequences can still be generated by spatial input alone (<xref ref-type="fig" rid="fig6">Figure 6A</xref>), relying only on the short-term facilitation mechanism. Simulating CA3 activity with lesioned DG similarly abolishes the temporal organization of theta sequence and reduces the phase range (<xref ref-type="fig" rid="fig6">Figure 6B</xref>). The results demonstrate that the temporal order of extrinsic sequences could be coordinated solely by sensorimotor drive and does not necessarily require CA3 recurrence.</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Extrinsically driven theta correlations can be temporally organized by sensorimotor drive alone without CA3-CA3 recurrence.</title><p>Simulations were performed without CA3-CA3 recurrence but with stronger spatial input. (<bold>A</bold>) Same as <xref ref-type="fig" rid="fig3">Figure 3</xref>. Extrinsically driven theta correlations and phase precession are still present. (<bold>B</bold>) Same as <xref ref-type="fig" rid="fig4">Figure 4</xref>. DG is still integral to the theta compression in a network model without CA3-CA3 recurrence.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-86837-fig6-v1.tif"/></fig></sec><sec id="s2-7"><title>Functional role of intrinsic sequences</title><p>While the function of extrinsic theta sequences in encoding the actual trajectory of an animal (connecting the recent past, present and near future locations) is obvious, the potential role of the less readily apparent intrinsic sequences is not straight forward. Simulations of trajectories in 2-d (<xref ref-type="fig" rid="fig5">Figure 5</xref>) suggest intrinsic activity may serve a role to identify certain location-direction pairs independent of the current trajectory. Here, we follow this idea by evaluating the hypothesis that the intrinsic sequences signal a stable ‘landmark’ (location/direction pair) cue by a temporal code that is invariant to different directions of approach.</p><p>To test our hypothesis, we constructed a downstream readout neuron that would reliably identify the presence of the intrinsic sequence independently of the animal’s running direction, whereas it would not be able to do so for only extrinsic sequences. To this end, we trained the synaptic weights using the tempotron learning rule (<xref ref-type="bibr" rid="bib20">Gütig and Sompolinsky, 2006</xref>), which is able to implement binary classification based on temporal relations of input spike patterns (see Methods section: Tempotron). Two tempotrons were trained to recognize the spike patterns from the place cells, one taking input from a model with DG-loop connectivity at <inline-formula><mml:math id="inf40"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>DG</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, and one without DG-loop connectivity to serve as a control only having access to extrinsic sequences (<xref ref-type="fig" rid="fig7">Figure 7A</xref>). Non-moving spatial inputs were applied to the CA3 place cells at the centers of with-loop and no-loop populations and their spike patterns in subsequent theta cycle were used as training patterns, mimicking a situation in which network activity is evoked without sensory-motor input as, for example in a offline situation before the animal walks or maybe even has seen the environment. The training patterns have only (+) labels, which the tempotrons are trained to recognize by firing a spike (<xref ref-type="fig" rid="fig7">Figure 7B</xref>). We then test the tempotrons with spike patterns induced by the animal running on different trajectories through the trained location with running directions varying between 0° to 360° (<xref ref-type="fig" rid="fig7">Figure 7C</xref>). All spikes in each training and testing pattern are individually jittered by adding a noise term <inline-formula><mml:math id="inf41"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> for 100 times, producing 100 samples for each pattern. The tempotron is said to successfully recognize the sequence of a trajectory direction if any of the theta cycles throughout the trajectory elicits a spike, that is while running, the readout cell would evaluate the place cell sequence in every theta cycle for information on the trained landmark.</p><fig-group><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Intrinsic sequences provide a stable landmark for positional decoding using a tempotron.</title><p>(<bold>A</bold>) Top: Two tempotrons are trained for place cell populations within the top (with DG loop; blue) and bottom (no DG loop; red) squares, to recognize the presence of the corresponding sequence activities. DG-loop rightward projection is indicated by blue arrow and only exists in the blue square. Non-moving spatial inputs are applied to the CA3 network centered at the two locations (marked by black crosses) to evoke spike sequences for training. Bottom: Resulting spikes of the place cell network zoomed in to the subset of field centers from x=-10 to x=10 for y=+20 (with-loop, top raster plot) and y=-20 (no-loop, bottom). Each theta cycle is one (+) training pattern, which the tempotron is trained to detect by eliciting a spike. (<bold>B</bold>) Example training pattern with spikes of place cells from x=-10 to x=10 (in each rectangular row) fixed at different values of y. Only one theta cycle is shown. Each place cell delivers spikes to the dendrite of the tempotron, producing post-synaptic potentials (PSPs) at the soma (line plot at the bottom). Synaptic weights are adapted by the tempotron learning rule such that PSPs can cross the threshold (gray line) and fire for the detection of the sequence. After the tempotron has fired, the PSPs will be shunted. (<bold>C</bold>) Sequence detection is tested while the simulated animal ran on a trajectory with varying direction (<inline-formula><mml:math id="inf42"><mml:mi>φ</mml:mi></mml:math></inline-formula>) from 0° to 360° with a 15° increment to detect the presence of the sequence. (<bold>D</bold>) Detection accuracies (ACC) for with-loop (red line) and no-loop (blue) input populations. Note that the tempotron cannot detect the no-loop sequences when tested on trajectories at various angles. (<bold>E</bold>) Detection of the intrinsic sequence for a trajectory <inline-formula><mml:math id="inf43"><mml:mrow><mml:mi>φ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>180</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> for the DG-loop condition. Spike raster is shown for every two horizontal rows of place cells in the arena and color-coded by the synaptic weights (see color bar on the right). Tempotron soma potential is shown at the bottom for each pattern. (<bold>F</bold>) Same as E, but for no-loop inputs. The tempotron remains silent.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-86837-fig7-v1.tif"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 1.</label><caption><title>Decoding of positional landmarks using tempotrons in a network model without CA3-CA3 recurrence.</title><p>Figure labels are the same as in <xref ref-type="fig" rid="fig7">Figure 7</xref>. Compared to the parameters in <xref ref-type="fig" rid="fig7">Figure 7</xref>, here CA3-CA3 weights were disabled (<inline-formula><mml:math id="inf44"><mml:mrow><mml:msup><mml:mi>B</mml:mi><mml:mi>dir</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), but spatial input was increased during testing (<inline-formula><mml:math id="inf45"><mml:mrow><mml:msup><mml:mi>A</mml:mi><mml:mi>dir</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>14</mml:mn></mml:mrow></mml:math></inline-formula>,,<inline-formula><mml:math id="inf46"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mn>0</mml:mn><mml:mi>F</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.25</mml:mn></mml:mrow></mml:math></inline-formula> <inline-formula><mml:math id="inf47"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mi>F</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:math></inline-formula>) and DG-loop strengths were increased (<inline-formula><mml:math id="inf48"><mml:mrow><mml:msup><mml:mi>B</mml:mi><mml:mi>DG</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>5500</mml:mn></mml:mrow></mml:math></inline-formula>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-86837-fig7-figsupp1-v1.tif"/></fig></fig-group><p>We found that the tempotron trained on the intrinsic sequence from the DG loop is able to recognize the sequence patterns produced for all running directions, while the tempotron trained without a DG-loop fails to identify the extrinsic sequences most of the time (see accuracies in <xref ref-type="fig" rid="fig7">Figure 7D</xref>). The reason is that the spike patterns induced by intrinsic sequences remain similar to the training pattern despite being approached in other directions (see sequential contributions in <xref ref-type="fig" rid="fig7">Figure 7E</xref>), while spike patterns for the no-loop condition are different between training and testing (<xref ref-type="fig" rid="fig7">Figure 7F</xref>). The distinction is further illustrated in <xref ref-type="fig" rid="fig8">Figure 8</xref>, where 2-d maps of spike time gradients in one theta cycle are plotted with respect to running direction/training condition. Sequences always contain components that propagate along the projection direction of DG loop, while, without such a loop, they only propagate along the running direction. Moreover, during training, the no-loop condition evokes concentric waves, reflecting the 2-d topology of the recurrent weights. Similar results were also achieved without CA3-CA3 recurrence (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref> and <xref ref-type="fig" rid="fig8">Figure 8C</xref>).</p><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Illustration of spike time gradients in one theta cycle (500–600 ms) with and without DG loop.</title><p>(<bold>A</bold>) Time gradients with a DG loop projecting to the rightward direction (<inline-formula><mml:math id="inf49"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>). Each arrow is located at a CA3 place field center. The arrow direction indicates the spike time gradient, equivalently the ‘travelling direction’ of sequence activity, which is calculated as the sum of the directions to the 8 neighbouring field centers, weighted by the difference between their mean spike times in one theta cycle. Arrow direction is color-coded according to the color wheel. Black cross marks the instantaneous position of the animal. The first column shows the training condition when a non-moving spatial stimulus is applied. The three columns on the right show the testing condition when the rat is running in various directions. The sequence mostly propagates rightwards, following the DG-loop direction even when the animal runs in different directions. (<bold>B</bold>) Same as A without a DG loop. Sequences propagate outward from the animal position as a concentric travelling wave during training. During testing, spike time gradients follow the running direction. (<bold>C</bold>) Same as A, using the network model without CA3 recurrence. As in <xref ref-type="fig" rid="fig6">Figure 6</xref>, the extrinsic sequence is driven solely by the STF mechanism of the spatial input. Intrinsic sequences in this model still remain invariant to running directions and function as spatial landmarks.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-86837-fig8-v1.tif"/></fig><p>Our results show that intrinsic sequences can provide a stable correlation signal which allows reliable decoding of locations through temporal correlations. The intrinsic temporal code remains detectable even when mixed with extrinsic sequences.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We presented a model of hippocampal theta sequences in 2-d environments, suggesting that both extrinsic and intrinsic mechanisms are required to explain experimental reports that phase precession and spike timing correlations are non-homogeneous across running directions. Although phase precession already becomes directional by including direction-dependent sensory input into a purely extrinsic model, directionality of spike timing correlations cannot be explained by such a model. We, however, demonstrated that the correlation preference could be implemented by fixed recurrent loops via a model DG layer. We further supported the model assumptions by showing that DG lesions plus compensatory sensory drive can abolish the theta compression effect in CA3 spiking activity (<xref ref-type="bibr" rid="bib3">Ahmadi et al., 2022</xref>). By employing a spike-based temporal pattern decoder (tempotron), we showed that the intrinsic sequences could function as stable signatures that act as anchors of the spatial code.</p><p>Early intrinsic models (<xref ref-type="bibr" rid="bib67">Tsodyks et al., 1996</xref>) were challenged owing to their inability to generate phase precession in backward travel (<xref ref-type="fig" rid="fig1">Figure 1E</xref>, also see <xref ref-type="bibr" rid="bib8">Cei et al., 2014</xref>), as well as the predominantly extrinsic correlations observed in CA1 (<xref ref-type="bibr" rid="bib28">Huxter et al., 2008</xref>). In our hybrid model, phase precession still occurs during backward travel (<inline-formula><mml:math id="inf50"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>180</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>) but at a lower probability as indicated by the larger fraction of positive phase-position slopes (<xref ref-type="fig" rid="fig3">Figure 3H</xref>). Also, extrinsic sequences still dominate over intrinsic sequences as indicated by the majority of field pairs being extrinsic (<xref ref-type="fig" rid="fig3">Figure 3J</xref>). Both the reduced expression of phase precession in reverse runs and the dominance of extrinsic sequences are in accordance with the experimental data (<xref ref-type="bibr" rid="bib71">Yiu et al., 2022</xref>).</p><p>The mixture of extrinsic and intrinsic mechanisms in our theory, naturally gives rise to the directionality of spike correlations and phase distributions. As the trajectory aligns itself with the DG loops, the ratio of intrinsic to extrinsic sequences increases. As a result, spike correlations become more rigid and the phase distribution is shifted upward due to the accumulated synaptic transmission delay from the reverberating activity between CA3 and DG populations. Adding directional sensory input activates extrinsic sequences in the best direction more strongly, and hence, leads to an association between best-angle (worst-angle) pairs and extrinsicity (intrinsicity). These predictions of our model are corroborated by past reports of higher spike phases in the non-preferred arm of a T-maze (<xref ref-type="bibr" rid="bib32">Kay et al., 2020</xref>) as well as the association of rigid correlations with upward shifts in spike phases and an increase in worst-angle pairs (<xref ref-type="bibr" rid="bib71">Yiu et al., 2022</xref>). The experimental distinction between extrinsic and intrinsic components in theta sequences has so far only been achieved in pairs of place cells, owing to the limited number of simultaneously recorded place cells with overlapping fields. Our model predicts that similar distinctions should also be observable in higher-order statistics, obtained from overlapping fields of a larger number of cells. Instead of correlation lags, we suggest to use temporal pattern detection methods (e.g. <xref ref-type="bibr" rid="bib9">Chenani et al., 2019</xref>) to unveil the respective sequence contributions.</p><p>Since intrinsic sequences can also propagate outside the trajectory (out-of-field firing in <xref ref-type="fig" rid="fig5">Figure 5</xref>) and activate place cells non-locally, our model predicts direction-dependent expansion of place fields, or even multiple place fields, with the intrinsic sequence’s target location exhibiting late spike phases and higher phase precession onsets. Remote activation during locomotion has already been observed in a previous study (<xref ref-type="bibr" rid="bib56">Sasaki et al., 2018</xref>) where CA3 place cells preferentially firing at one arm of the maze were also activated at reward locations at other arms. In our model, only short-range intrinsic connectivity was considered, thus, place field boundaries expand locally but in a skewed manner matching the sequence direction. Skewness of place fields has been reported by a number of studies (<xref ref-type="bibr" rid="bib45">Mehta et al., 1997</xref>; <xref ref-type="bibr" rid="bib60">Shen et al., 1997</xref>; <xref ref-type="bibr" rid="bib46">Mehta et al., 2000</xref>; <xref ref-type="bibr" rid="bib16">Ekstrom et al., 2001</xref>; <xref ref-type="bibr" rid="bib36">Lee et al., 2004</xref>; <xref ref-type="bibr" rid="bib7">Burke et al., 2008</xref>; <xref ref-type="bibr" rid="bib8">Cei et al., 2014</xref>; <xref ref-type="bibr" rid="bib55">Roth et al., 2012</xref>; <xref ref-type="bibr" rid="bib11">Dong et al., 2021</xref>) showing place fields to be asymmetrically expanded opposite to the direction of travel. This effect was connected to plasticity as it develops after repeated traversal, and due to its dependence on NMDA receptor activation (<xref ref-type="bibr" rid="bib16">Ekstrom et al., 2001</xref>; <xref ref-type="bibr" rid="bib7">Burke et al., 2008</xref>; <xref ref-type="bibr" rid="bib60">Shen et al., 1997</xref>). These plasticity studies show that the hippocampal place code is shaped by intrinsic synaptic computations including temporal activation patterns in theta sequences (<xref ref-type="bibr" rid="bib17">Feng et al., 2015</xref>). Apart from being conducted on linear tracks and not 2-d environments, most of this work focused on CA1 and associated Schaffer collateral plasticity. Yet some prior studies (<xref ref-type="bibr" rid="bib36">Lee et al., 2004</xref>; <xref ref-type="bibr" rid="bib55">Roth et al., 2012</xref>) did show that place fields in CA3 were more skewed than in CA1, which our model would explain by CA3 expressing more intrinsic sequences than CA1 consistent with prior experimental observations (<xref ref-type="bibr" rid="bib71">Yiu et al., 2022</xref> reported ratios of extrinsically to intrinsically driven cell pairs of 1.44 in CA1 and 1.23 in CA3).</p><p>A further prediction of hard-wired DG loops is that the resulting activity patterns (intrinsic sequences) should not remap under conditions of global or partial remapping (<xref ref-type="bibr" rid="bib38">Leutgeb et al., 2004</xref>). Instead the same intrinsic sequence components should be observable in multiple environments, however, they might only be seen in a small fraction and thus this prediction is potentially hard to test.</p><p>The back-projection from CA3 to DG is a crucial anatomical prerequisite of our model, but was rarely explored compared to the feed-forward inputs via the perforant pathway. The proposed CA3-DG recurrent structure of this model, albeit simplified, is consistent with the anatomical evidence. Pyramidal cells in CA3 innervate the mossy cells at the DG hilus (<xref ref-type="bibr" rid="bib57">Scharfman, 1994</xref>; <xref ref-type="bibr" rid="bib59">Scharfman, 2016</xref>), which then project to granule cells through both excitatory and inhibitory pathways (<xref ref-type="bibr" rid="bib26">Hsu et al., 2016</xref>; <xref ref-type="bibr" rid="bib58">Scharfman, 1995</xref>; <xref ref-type="bibr" rid="bib34">Larimer and Strowbridge, 2008</xref>; <xref ref-type="bibr" rid="bib63">Soriano and Frotscher, 1994</xref>), and subsequently back to CA3 pyramidal cells. An optogenetic study (<xref ref-type="bibr" rid="bib26">Hsu et al., 2016</xref>) showed that the net effect of mossy cells on granule cells was predominantly inhibitory, suggesting that the DG ensembles excited by mossy cell synaptic drive are sparsified by suppressing unwanted out-of-ensemble activity. Indeed, past studies showed that reliable excitatory effect could be observed when granule cells were depolarized (<xref ref-type="bibr" rid="bib58">Scharfman, 1995</xref>) and when they received back-propagation of sharp wave bursts from CA3 population (<xref ref-type="bibr" rid="bib51">Penttonen et al., 1998</xref>). This indicates that the excitatory recurrent pathway from CA3 via DG exists and might allow activity reverberation between two layers. While our model, owing to its simplicity and generality does not require any DG specific pathways and would work equally well with any other anatomical interpretation of the CA3 feedback, we hypothesize the intrinsic feedback connectivity to arise via the DG, particularly because DG lesions were shown to eliminate the coordinated temporal structure of CA3 activity and to be instrumental to sequence organization (<xref ref-type="fig" rid="fig4">Figure 4</xref> and <xref ref-type="bibr" rid="bib3">Ahmadi et al., 2022</xref>).</p><p>Our model assumed a connectivity pattern in the DG loops, in which neurons activate the neighbours along a specific direction, as inspired by Hebb’s phase sequences (<xref ref-type="bibr" rid="bib25">Hebb, 1949</xref>) and, hence, replay of the loop would activate a spatially plausible virtual trajectory. The loop connectivity could either arise from previous learning, or might be present already beforehand (<xref ref-type="bibr" rid="bib14">Dragoi and Tonegawa, 2013</xref>), with spatial topology inherited by associating 2-d sensory features to cell ensembles in the loop (<xref ref-type="bibr" rid="bib37">Leibold, 2020</xref>). The resulting topology can exhibit discontinuous long-range jumps to other locations (<xref ref-type="bibr" rid="bib56">Sasaki et al., 2018</xref>) or consist of a discrete set of (behaviorally relevant) locations (<xref ref-type="bibr" rid="bib52">Pfeiffer, 2022</xref>).</p><p>Different from other phase precession models, we also included heading direction as part of the sensory input, as inspired by past literature that CA1 (<xref ref-type="bibr" rid="bib42">Markus et al., 1995</xref>; <xref ref-type="bibr" rid="bib2">Acharya et al., 2016</xref>; <xref ref-type="bibr" rid="bib64">Stefanini et al., 2020</xref>), CA3 (<xref ref-type="bibr" rid="bib40">Mankin et al., 2019</xref>), and DG place cells (<xref ref-type="bibr" rid="bib64">Stefanini et al., 2020</xref>) exhibit directional selectivity in firing rates, potentially inherited from the upstream head-direction cells in the medial entorhinal cortex (<xref ref-type="bibr" rid="bib19">Giocomo et al., 2014</xref>) and postsubiculum (<xref ref-type="bibr" rid="bib65">Taube et al., 1990</xref>). As a result, the directional drive immediately translates to phase directionality in theta sequences, partly contributing to the upward shift of the phase distribution in the worst angles. Such phase directionality arises naturally from the intracellular dynamics of a spike-based model, where stronger depolarization causes earlier spiking. This phase-rate dependence has already been used in previous models (<xref ref-type="bibr" rid="bib23">Harris et al., 2002</xref>; <xref ref-type="bibr" rid="bib47">Mehta et al., 2002</xref>; <xref ref-type="bibr" rid="bib66">Thurley et al., 2008</xref>), where the increasing depolarization within place fields directly relates to decreasing spike phases. The causal effect of firing rate on spike phases, however, was disputed by <xref ref-type="bibr" rid="bib27">Huxter et al., 2003</xref> as they showed that precession slopes and spike phases remained the same between high- and low-spiking runs, suggesting that the phase is not single-handedly determined by firing rate. In our model, firing rate is determined by both low-phase spiking from sensory input and high-phase spike arrivals of DG-CA3 loops, both producing opposing effects on the phase distribution. Thus, depending on the strength and geometry of the DG-CA3 connectivity, spike phases are not fully determined by firing rate.</p><p>By using a tempotron to decode the spike patterns, we show that the spike patterns of intrinsic sequences can serve as a stable landmark which remains decodable across multiple running directions. The invariant temporal patterns could serve as anchors of spatial memories in a novel environment, since place fields only stabilize after the animal becomes familiar with the environment (<xref ref-type="bibr" rid="bib70">Wilson and McNaughton, 1993</xref>). The pre-existing sequence motifs, even at times when the spikes of the neurons are not spatially tuned to a location, can still encode the position based on their temporal relations alone. The idea has previously been spelled out (<xref ref-type="bibr" rid="bib10">Cheng, 2013</xref>) and numerically verified (<xref ref-type="bibr" rid="bib37">Leibold, 2020</xref>; <xref ref-type="bibr" rid="bib50">Parra-Barrero and Cheng, 2023</xref>) with multiple fixed sequences that form a decodable spatial representation.</p><p>Intrinsic sequences may thus act as a scaffold around which a new spatial code can be built for new but similar behavioral contexts, where similarity could for example be identified by a salient feature. Once the behavioral context of a situation changes, new intrinsic sequences would be observable. These intrinsic landmarks need to be stable across time, as shown for some dentate gyrus representations (<xref ref-type="bibr" rid="bib22">Hainmueller and Bartos, 2018</xref>). We speculate that offline sequences observed during replay and preplay (for review see <xref ref-type="bibr" rid="bib6">Buhry et al., 2011</xref>; <xref ref-type="bibr" rid="bib15">Dragoi and Tonegawa, 2014</xref>), would correspond to the intrinsic activity patterns and indicate the context expectation of an animal (which can be detected by a tempotron). The functional roles of intrinsic sequences may thus not be limited to spatial memories. While, in the spatial domain, intrinsic sequences could be interpreted as spatial trajectories (<xref ref-type="bibr" rid="bib32">Kay et al., 2020</xref>; <xref ref-type="bibr" rid="bib56">Sasaki et al., 2018</xref>), virtual non-spatial trajectories could represent working memories contents (<xref ref-type="bibr" rid="bib31">Jensen et al., 1996</xref>) available for general decision making processes.</p></sec><sec id="s4" sec-type="methods"><title>Methods</title><table-wrap id="keyresource" position="anchor"><label>Key resources table</label><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Reagent type (species) or resource</th><th align="left" valign="bottom">Designation</th><th align="left" valign="bottom">Source or reference</th><th align="left" valign="bottom">Identifiers</th><th align="left" valign="bottom">Additional information</th></tr></thead><tbody><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">Python</td><td align="left" valign="bottom">Python Software Foundation</td><td align="left" valign="bottom"><ext-link ext-link-type="uri" xlink:href="https://www.python.org/">https://www.python.org/</ext-link> <break/>RRID:<ext-link ext-link-type="uri" xlink:href="https://identifiers.org/RRID/RRID:SCR_008394">SCR_008394</ext-link></td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">Linear-circular regression</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib33">Kempter et al., 2012</xref></td><td align="left" valign="bottom"/><td align="left" valign="bottom">The algorithm is customized to our analyses</td></tr><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">Tempotron</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib20">Gütig and Sompolinsky, 2006</xref></td><td align="left" valign="bottom"/><td align="left" valign="bottom">The algorithm is customized to our analyses</td></tr></tbody></table></table-wrap><sec id="s4-1"><title>Neuronal model</title><p>Generation of neuronal action potentials is modelled according to <xref ref-type="bibr" rid="bib29">Izhikevich, 2003</xref>. The soma potential <inline-formula><mml:math id="inf51"><mml:mi>v</mml:mi></mml:math></inline-formula> and the adaptation variable <inline-formula><mml:math id="inf52"><mml:mi>u</mml:mi></mml:math></inline-formula> of unit <inline-formula><mml:math id="inf53"><mml:mi>i</mml:mi></mml:math></inline-formula> at time <inline-formula><mml:math id="inf54"><mml:mi>t</mml:mi></mml:math></inline-formula> (in ms) follows the equations:<disp-formula id="equ1"><mml:math id="m1"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0.04</mml:mn><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>140</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ2"><mml:math id="m2"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mover><mml:mi>u</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ3"><mml:math id="m3"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Any time <inline-formula><mml:math id="inf55"><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> crosses the threshold 30 mV from below, we register a spike for the neuron and reset the soma potential by <inline-formula><mml:math id="inf56"><mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>←</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:math></inline-formula> and the adaptation variable by <inline-formula><mml:math id="inf57"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">←</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. For the excitatory pyramidal place cells, we use parameters <inline-formula><mml:math id="inf58"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>0.035</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf59"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf60"><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>60</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> mV, <inline-formula><mml:math id="inf61"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math></inline-formula>, which provides the neuron with burst firing characteristics. For the inhibitory interneurons, the parameters were <inline-formula><mml:math id="inf62"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>0.02</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf63"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>0.25</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf64"><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>65</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> mV, and <inline-formula><mml:math id="inf65"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>, which corresponds to fast spiking patterns. <inline-formula><mml:math id="inf66"><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the total sum of recurrent <inline-formula><mml:math id="inf67"><mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mi>R</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, sensory <inline-formula><mml:math id="inf68"><mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mi>S</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and oscillatory theta input<disp-formula id="equ4"><mml:math id="m4"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>7</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>100</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We chose to use the phenomenological spike generation model of <xref ref-type="bibr" rid="bib29">Izhikevich, 2003</xref>, since it allows to adjust burst firing properties with only few parameters that efficiently emulate the bifurcation structure of spike generation. Synaptic integration below threshold is not affected by the spike generation model and will thus be treated by conventional synaptic models.</p></sec><sec id="s4-2"><title>Spatial input</title><p>The place field centers <inline-formula><mml:math id="inf69"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>A</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">[</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>A</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>A</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> of <inline-formula><mml:math id="inf70"><mml:mrow><mml:mrow><mml:mn>80</mml:mn><mml:mo>×</mml:mo><mml:mn>80</mml:mn></mml:mrow><mml:mo>=</mml:mo><mml:mn>6400</mml:mn></mml:mrow></mml:math></inline-formula> excitatory CA3 cells equally tile the 80 by 80 cm square arena. Place cell firing rates are modelled direction-sensitive, with preferred heading directions <inline-formula><mml:math id="inf71"><mml:msubsup><mml:mi>ψ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> semi-randomized among each 2×2 tile of place cells by randomly rotating a set of four equally spaced direction angles by a uniformly distributed angle <inline-formula><mml:math id="inf72"><mml:mi>ξ</mml:mi></mml:math></inline-formula>, that is<disp-formula id="equ5"><mml:math id="m5"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">[</mml:mo></mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>A</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>A</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>A</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>A</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">[</mml:mo></mml:mrow><mml:msup><mml:mn>0</mml:mn><mml:mrow><mml:mo>∘</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mn>90</mml:mn><mml:mrow><mml:mo>∘</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mn>180</mml:mn><mml:mrow><mml:mo>∘</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mn>270</mml:mn><mml:mrow><mml:mo>∘</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>ξ</mml:mi><mml:mspace width="1em"/><mml:mi>mod</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:msup><mml:mn>360</mml:mn><mml:mrow><mml:mo>∘</mml:mo></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The sensory input <inline-formula><mml:math id="inf73"><mml:mrow><mml:msubsup><mml:mi>J</mml:mi><mml:mi>i</mml:mi><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> into the <inline-formula><mml:math id="inf74"><mml:mi>i</mml:mi></mml:math></inline-formula>-th neuron depends on the instantaneous position, <inline-formula><mml:math id="inf75"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">[</mml:mo></mml:mrow><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, and heading direction <inline-formula><mml:math id="inf76"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of the animal as<disp-formula id="equ6"><mml:math id="m6"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>J</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>A</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>E</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mtext>if</mml:mtext><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>A</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow><mml:mo>≦</mml:mo><mml:mn>5</mml:mn><mml:mtext> </mml:mtext><mml:mtext>cm</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mtext>if</mml:mtext><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>A</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>5</mml:mn><mml:mtext> </mml:mtext><mml:mtext>cm</mml:mtext></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula><disp-formula id="equ7"><mml:math id="m7"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>A</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msup><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mi>ψ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mi>ψ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ8"><mml:math id="m8"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>100</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msup><mml:mn>70</mml:mn><mml:mo>∘</mml:mo></mml:msup><mml:mfrac><mml:mi>π</mml:mi><mml:msup><mml:mn>180</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf77"><mml:msup><mml:mi mathvariant="normal">A</mml:mi><mml:mi>pos</mml:mi></mml:msup></mml:math></inline-formula> is the amplitude of positional tuning and <inline-formula><mml:math id="inf78"><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> computes the Euclidean distance between two positions. The positional tuning curve is implemented as a rectangular box function, where the place cell only receives sensory input if the animal is within 5 cm from the field center. Directional tuning is implemented as an additional amplitude gain <inline-formula><mml:math id="inf79"><mml:msup><mml:mi mathvariant="normal">A</mml:mi><mml:mi>dir</mml:mi></mml:msup></mml:math></inline-formula> to the positional current depending on the circular difference between the animal’s heading and the neuron’s preferred heading direction <inline-formula><mml:math id="inf80"><mml:msubsup><mml:mi>ψ</mml:mi><mml:mi>i</mml:mi><mml:mi>CA3</mml:mi></mml:msubsup></mml:math></inline-formula>. The sensory input is assumed to be modulated by theta oscillations from medial entorhinal cortex (MEC) <inline-formula><mml:math id="inf81"><mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mi>MEC</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with a phase shift of 70° (<xref ref-type="bibr" rid="bib49">Mizuseki et al., 2009</xref>).</p><p>The sensory input <inline-formula><mml:math id="inf82"><mml:msup><mml:mi>J</mml:mi><mml:mi>S</mml:mi></mml:msup></mml:math></inline-formula> is subsequently transformed to the input current <inline-formula><mml:math id="inf83"><mml:msup><mml:mi>I</mml:mi><mml:mi>S</mml:mi></mml:msup></mml:math></inline-formula> via short-term facilitation (STF)<disp-formula id="equ9"><mml:math id="m9"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mrow><mml:mover><mml:mi>s</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msup></mml:mfrac><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi></mml:mrow><mml:mi>F</mml:mi></mml:msup><mml:msubsup><mml:mi>J</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ10"><mml:math id="m10"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>I</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>J</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">[</mml:mo></mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">]</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where the facilitation variable <inline-formula><mml:math id="inf84"><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>F</mml:mi></mml:msubsup></mml:math></inline-formula> decays to <inline-formula><mml:math id="inf85"><mml:msubsup><mml:mi mathvariant="normal">S</mml:mi><mml:mn>0</mml:mn><mml:mi>F</mml:mi></mml:msubsup></mml:math></inline-formula> with a time constant <inline-formula><mml:math id="inf86"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>500</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and increases to <inline-formula><mml:math id="inf87"><mml:msubsup><mml:mi mathvariant="normal">S</mml:mi><mml:mn>1</mml:mn><mml:mi>F</mml:mi></mml:msubsup></mml:math></inline-formula> when the sensory input <inline-formula><mml:math id="inf88"><mml:msubsup><mml:mi>J</mml:mi><mml:mi>i</mml:mi><mml:mi>S</mml:mi></mml:msubsup></mml:math></inline-formula> is present. The time constant <inline-formula><mml:math id="inf89"><mml:msup><mml:mi>τ</mml:mi><mml:mi>F</mml:mi></mml:msup></mml:math></inline-formula> of facilitation of neocortical synapses was in the range suggested by <xref ref-type="bibr" rid="bib69">Tsodyks et al., 1998</xref> following previous experimental reports (<xref ref-type="bibr" rid="bib48">Mejías and Torres, 2008</xref>; <xref ref-type="bibr" rid="bib73">Zucker and Regehr, 2002</xref>). <inline-formula><mml:math id="inf90"><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mi>F</mml:mi></mml:msup></mml:math></inline-formula> controls the strength of the STF. The facilitation variable is squared to include non-linear interactions in presynaptic calcium dynamics. As a result, facilitated sensory input <inline-formula><mml:math id="inf91"><mml:msubsup><mml:mi>I</mml:mi><mml:mi>i</mml:mi><mml:mi>S</mml:mi></mml:msubsup></mml:math></inline-formula> increases over time and becomes stronger in the later part of the field, thus effectively generating a spatially graded input strength.</p><p>Note that only the CA3 place cells receive the sensory input. <inline-formula><mml:math id="inf92"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mi>i</mml:mi><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is not applied to the place cells in DG and all of the inhibitory interneurons.</p></sec><sec id="s4-3"><title>CA3 recurrent connections</title><p>Place cells in CA3 connect with each other by excitatory synapses. The excitatory synaptic current <inline-formula><mml:math id="inf93"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mi>i</mml:mi><mml:mi>E</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is conductance-based, and follows the equations:<disp-formula id="equ11"><label>(1)</label><mml:math id="m11"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mrow><mml:mover><mml:mi>g</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msup></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>D</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ12"><label>(2)</label><mml:math id="m12"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>I</mml:mi><mml:mi>i</mml:mi><mml:mi>E</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">[</mml:mo></mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mi>E</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">]</mml:mo></mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The conductance <inline-formula><mml:math id="inf94"><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mi>E</mml:mi></mml:msubsup></mml:math></inline-formula> of a post-synaptic cell <inline-formula><mml:math id="inf95"><mml:mi>i</mml:mi></mml:math></inline-formula> is increased by the spike arrivals at times <inline-formula><mml:math id="inf96"><mml:msubsup><mml:mi>t</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> from the pre-synaptic cell <inline-formula><mml:math id="inf97"><mml:mi>j</mml:mi></mml:math></inline-formula>, and decay with a time constant <inline-formula><mml:math id="inf98"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>12</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. <inline-formula><mml:math id="inf99"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mn>400</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> is the number of presynaptic place cells, <inline-formula><mml:math id="inf100"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>is the reversal potential of the excitatory synapses and <inline-formula><mml:math id="inf101"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the synaptic transmission delay.</p><p>The synaptic weights <inline-formula><mml:math id="inf102"><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> from cell <inline-formula><mml:math id="inf103"><mml:mi>j</mml:mi></mml:math></inline-formula> to cell <italic>i</italic> depend on the distance between place cell centers and on the similarity of their preferred heading angles, i.e.,<disp-formula id="equ13"><mml:math id="m13"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msup><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>A</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>A</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf104"><mml:msup><mml:mi>B</mml:mi><mml:mi>pos</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf105"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> correspond to the maximum strength and width of the location-specific interaction, respectively. <inline-formula><mml:math id="inf106"><mml:msup><mml:mi>B</mml:mi><mml:mi>dir</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf107"><mml:msup><mml:mi>K</mml:mi><mml:mi>CA3</mml:mi></mml:msup></mml:math></inline-formula> control the maximum strength and the concentration of the directional dependence, respectively. <inline-formula><mml:math id="inf108"><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> models the rightward asymmetry of the cell connections, which was only turned on when we simulated the 2-d variant of <xref ref-type="bibr" rid="bib67">Tsodyks et al., 1996</xref> model in <xref ref-type="fig" rid="fig1">Figure 1C–F</xref> and otherwise turned off in the rest of our analysis.<disp-formula id="equ14"><mml:math id="m14"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">O</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:mo>,</mml:mo></mml:mrow><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="1em"/><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi>x</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>A</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>A</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">O</mml:mi><mml:mi mathvariant="normal">F</mml:mi><mml:mi mathvariant="normal">F</mml:mi><mml:mo>,</mml:mo></mml:mrow><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>Furthermore, the recurrent synaptic conductances underwent short-term synaptic depression (STD), as was proposed in <xref ref-type="bibr" rid="bib54">Romani and Tsodyks, 2015</xref> to serve as sequence generator in 2-d space. The mechanism penalizes the recurrent input into the place cells behind the animal. As a result, the differential recurrence strengths translate to a gradient of spike phases and produces extrinsic sequences in the direction of travel. We model the STD by the variable <inline-formula><mml:math id="inf109"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>D</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> which represents the available synaptic resource and follows the dynamics:<disp-formula id="equ15"><mml:math id="m15"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mrow><mml:mover><mml:mi>s</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msup></mml:mfrac><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msup><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf110"><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>D</mml:mi></mml:msubsup></mml:math></inline-formula> recovers to 1 with a time constant <inline-formula><mml:math id="inf111"><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mi>D</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>500</mml:mn></mml:mrow></mml:math></inline-formula> ms and is depleted by a fraction <inline-formula><mml:math id="inf112"><mml:msup><mml:mi>U</mml:mi><mml:mi>D</mml:mi></mml:msup></mml:math></inline-formula> every time a spike occurs. The recovery time constant is comparable to experimentally obtained values of cortical neurons (200–800 ms in <xref ref-type="bibr" rid="bib68">Tsodyks and Markram, 1997</xref>; <xref ref-type="bibr" rid="bib41">Markram et al., 1998</xref>; <xref ref-type="bibr" rid="bib1">Abbott et al., 1997</xref>; <xref ref-type="bibr" rid="bib73">Zucker and Regehr, 2002</xref>) and previous modelling work (450–800 ms in <xref ref-type="bibr" rid="bib54">Romani and Tsodyks, 2015</xref>; <xref ref-type="bibr" rid="bib21">Haga and Fukai, 2018</xref>; <xref ref-type="bibr" rid="bib68">Tsodyks and Markram, 1997</xref>; <xref ref-type="bibr" rid="bib69">Tsodyks et al., 1998</xref>). The STD only applies to synaptic connections when presynaptic cells are CA3 place cells. <inline-formula><mml:math id="inf113"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>D</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is fixed at 1 when the pre-synaptic cells are inhibitory interneurons or DG place cells.</p></sec><sec id="s4-4"><title>DG layer</title><p>We simulated <inline-formula><mml:math id="inf114"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>DG</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>40</mml:mn><mml:mo>×</mml:mo><mml:mn>40</mml:mn></mml:mrow><mml:mo>=</mml:mo><mml:mn>1600</mml:mn></mml:mrow></mml:math></inline-formula> place cells in the DG layer, with place field centers equally tiling the environment. The DG cells do not receive sensory input. Their positional (<inline-formula><mml:math id="inf115"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mi>DG</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>i</mml:mi><mml:mi>DG</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>) and directional (<inline-formula><mml:math id="inf116"><mml:msubsup><mml:mi>ψ</mml:mi><mml:mi>i</mml:mi><mml:mi>DG</mml:mi></mml:msubsup></mml:math></inline-formula>) tunings are determining synaptic strengths to and from the CA3 layer. The directional tuning is semi-randomized as described for CA3. The synaptic current dynamics follow <xref ref-type="disp-formula" rid="equ11 equ12">Equations (1) and (2)</xref>. Excitatory synaptic weights from CA3 place cells to DG place cells are defined as<disp-formula id="equ16"><mml:math id="m16"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:mn>3</mml:mn><mml:mo>−</mml:mo><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>A</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mspace width="thinmathspace"/><mml:msup><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:msup><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>A</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>which are dependent on the differences in the place field centers and preferred heading angles between the CA3 and DG populations. The variable <inline-formula><mml:math id="inf117"><mml:msubsup><mml:mi>C</mml:mi><mml:mi>j</mml:mi><mml:mi>CA3</mml:mi></mml:msubsup></mml:math></inline-formula> strengthens outgoing connections from CA3 place cells on the path corresponding to the intrinsic sequence by choosing<disp-formula id="equ17"><mml:math id="m17"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>A</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf118"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> varies with the intrinsic path direction <inline-formula><mml:math id="inf119"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> as <inline-formula><mml:math id="inf120"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>The excitatory synaptic strengths from DG to CA3 are chosen such that DG cells project back to CA3 cells with place field centers shifted by a vector <inline-formula><mml:math id="inf121"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>4</mml:mn><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> of fixed length of 4 cm along the intrinsic path, that is<disp-formula id="equ18"><label>(3)</label><mml:math id="m18"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">G</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:msup><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ψ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>ψ</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The model has no synaptic connections between DG excitatory neurons.</p></sec><sec id="s4-5"><title>Inhibitory synapses</title><p>The model additionally contains <inline-formula><mml:math id="inf122"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>250</mml:mn></mml:mrow></mml:math></inline-formula> inhibitory interneurons (denoted as Inh) each for the CA3 and the DG layer. They provide inhibitory feedback separately to the excitatory cells within each layer (CA3-Inh-CA3 and DG-Inh-DG). The dynamics of their synaptic currents mirrors the excitatory synapses, that is<disp-formula id="equ19"><mml:math id="m19"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mrow><mml:mover><mml:mi>g</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>I</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msup></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>−</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msubsup><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ20"><mml:math id="m20"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>I</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">[</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">]</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>with <inline-formula><mml:math id="inf123"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf124"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>80</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. CA3 and DG have all-to-all connections to their inhibitory populations with uniformly randomized strengths, i.e. <inline-formula><mml:math id="inf125"><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>-</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mi>X</mml:mi><mml:mo>-</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:mi>ξ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> , with <inline-formula><mml:math id="inf126"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="script">U</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is the maximum synaptic strength, and the notation X-Y corresponds to Inh-CA3 and Inh-DG connections. There is no synaptic connection between inter-neurons, that is <inline-formula><mml:math id="inf127"><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mi>Inh</mml:mi><mml:mo>-</mml:mo><mml:mi>Inh</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>The total recurrent current entering each excitatory neuron is thus the sum of the excitatory and inhibitory current:<disp-formula id="equ21"><mml:math id="m21"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p></sec><sec id="s4-6"><title>Excitatory synapses to interneurons</title><p>Interneurons only receive all-to-all excitatory currents from their respective layer. Those currents are modelled according to <xref ref-type="disp-formula" rid="equ11 equ12">Equations 1; 2</xref>. The synaptic weights are constant and denoted by <inline-formula><mml:math id="inf128"><mml:msubsup><mml:mi>W</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mi>CA3</mml:mi><mml:mo>-</mml:mo><mml:mi>Inh</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf129"><mml:msubsup><mml:mi>W</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mi>DG</mml:mi><mml:mo>-</mml:mo><mml:mi>Inh</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>.</p></sec><sec id="s4-7"><title>Parameters of the models</title><p>Model parameters that are adjusted in different analyses are listed in <xref ref-type="table" rid="table1">Table 1</xref>. The values of the synaptic weights and spatial input were chosen to allow for a large range of phase precession and stability of the network activity. For the analyses including the DG layer, weights are adjusted to allow coexistence of extrinsic and intrinsic sequences.</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Model parameters used in simulations according to Figure panels.</title><p>In, Ex, C. and L. refer to intrinsic, extrinsic, control and lesion respectively.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Name \Figure</th><th align="left" valign="bottom">1 (In)</th><th align="left" valign="bottom">1 (Ex)</th><th align="left" valign="bottom">2</th><th align="left" valign="bottom">3</th><th align="left" valign="bottom">4 (C.)</th><th align="left" valign="bottom">4 (L.)</th><th align="left" valign="bottom">5</th><th align="left" valign="bottom">6A</th><th align="left" valign="bottom">6B (C.)</th><th align="left" valign="bottom">6B (L.)</th><th align="left" valign="bottom">7</th></tr></thead><tbody><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf130"><mml:msup><mml:mi>A</mml:mi><mml:mi>pos</mml:mi></mml:msup></mml:math></inline-formula></td><td align="char" char="." valign="bottom">7.5</td><td align="char" char="." valign="bottom">9.0</td><td align="char" char="." valign="bottom" colspan="5">6.5</td><td align="char" char="." valign="bottom">9.5</td><td align="char" char="." valign="bottom" colspan="2">7.5</td><td align="char" char="." valign="bottom">6.5</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf131"><mml:msup><mml:mi>A</mml:mi><mml:mi>dir</mml:mi></mml:msup></mml:math></inline-formula></td><td align="char" char="." valign="bottom" colspan="2">0</td><td align="char" char="." valign="bottom" colspan="5">6</td><td align="char" char="." valign="bottom">9</td><td align="char" char="." valign="bottom" colspan="2">8</td><td align="char" char="." valign="bottom">6</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf132"><mml:msubsup><mml:mi>S</mml:mi><mml:mn>0</mml:mn><mml:mi>F</mml:mi></mml:msubsup></mml:math></inline-formula></td><td align="char" char="." valign="bottom" colspan="2">1</td><td align="char" char="." valign="bottom" colspan="3">0</td><td align="char" char="." valign="bottom">1.25</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">0.25</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1.25</td><td align="char" char="." valign="bottom">0</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf133"><mml:msubsup><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mi>F</mml:mi></mml:msubsup></mml:math></inline-formula></td><td align="char" char="." valign="bottom" colspan="2">1</td><td align="char" char="." valign="bottom" colspan="3">2</td><td align="char" char="." valign="bottom">1.25</td><td align="char" char="." valign="bottom">2</td><td align="char" char="." valign="bottom">1.5</td><td align="char" char="." valign="bottom">2</td><td align="char" char="." valign="bottom">1.25</td><td align="char" char="." valign="bottom">2</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf134"><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mi>F</mml:mi></mml:msup></mml:math></inline-formula></td><td align="char" char="." valign="bottom" colspan="2">0</td><td align="char" char="." valign="bottom" colspan="3">0.001</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom" colspan="3">0.001</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">0.001</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf135"><mml:msup><mml:mi>B</mml:mi><mml:mi>pos</mml:mi></mml:msup></mml:math></inline-formula></td><td align="char" char="." valign="bottom" colspan="2">1100</td><td align="char" char="." valign="bottom" colspan="9">0</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf136"><mml:msup><mml:mi>B</mml:mi><mml:mi>dir</mml:mi></mml:msup></mml:math></inline-formula></td><td align="char" char="." valign="bottom" colspan="2">0</td><td align="char" char="." valign="bottom">2000</td><td align="char" char="." valign="bottom" colspan="3">1500</td><td align="char" char="." valign="bottom">2000</td><td align="char" char="." valign="bottom" colspan="3">0</td><td align="char" char="." valign="bottom">1500</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf137"><mml:msup><mml:mi>K</mml:mi><mml:mi>CA3</mml:mi></mml:msup></mml:math></inline-formula></td><td align="char" char="." valign="bottom" colspan="2">0</td><td align="char" char="." valign="bottom" colspan="9">1</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf138"><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">ON</td><td align="left" valign="bottom" colspan="10">OFF</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf139"><mml:msup><mml:mi>U</mml:mi><mml:mi>D</mml:mi></mml:msup></mml:math></inline-formula></td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">0.9</td><td align="char" char="." valign="bottom" colspan="9">0.7</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf140"><mml:msub><mml:mi>N</mml:mi><mml:mi>DG</mml:mi></mml:msub></mml:math></inline-formula></td><td align="char" char="." valign="bottom" colspan="3">0</td><td align="char" char="." valign="bottom" colspan="8">40×40 = 1600</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf141"><mml:msup><mml:mi>B</mml:mi><mml:mi>DG</mml:mi></mml:msup></mml:math></inline-formula></td><td align="char" char="." valign="bottom" colspan="3">0</td><td align="char" char="." valign="bottom" colspan="2">3000</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom" colspan="2">4000</td><td align="char" char="." valign="bottom">4000</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">4000</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf142"><mml:msup><mml:mi>K</mml:mi><mml:mi>DG</mml:mi></mml:msup></mml:math></inline-formula></td><td align="char" char="." valign="bottom" colspan="3">0</td><td align="char" char="." valign="bottom" colspan="8">1</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf143"><mml:msub><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:math></inline-formula></td><td align="char" char="." valign="bottom" colspan="2">0</td><td align="char" char="." valign="bottom" colspan="9">250</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf144"><mml:msubsup><mml:mi>W</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mi>CA3</mml:mi><mml:mo>-</mml:mo><mml:mi>Inh</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula></td><td align="char" char="." valign="bottom" colspan="2">0</td><td align="char" char="." valign="bottom" colspan="9">50</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf145"><mml:msubsup><mml:mi>W</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mi>Inh</mml:mi><mml:mo>-</mml:mo><mml:mi>CA3</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula></td><td align="char" char="." valign="bottom" colspan="2">0</td><td align="char" char="." valign="bottom" colspan="9">5</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf146"><mml:msubsup><mml:mi>W</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mi>DG</mml:mi><mml:mo>-</mml:mo><mml:mi>Inh</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula></td><td align="char" char="." valign="bottom" colspan="3">0</td><td align="char" char="." valign="bottom" colspan="8">350</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf147"><mml:msubsup><mml:mi>W</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mi>Inh</mml:mi><mml:mo>-</mml:mo><mml:mi>DG</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula></td><td align="char" char="." valign="bottom" colspan="3">0</td><td align="char" char="." valign="bottom" colspan="8">35</td></tr></tbody></table></table-wrap></sec><sec id="s4-8"><title>Cross-correlation analysis</title><p>Cross-correlation represents the probability that a spike of one place cell would occur following a certain time lag from the spike of the another cell. Cross-correlation is always empirically computed as a histogram of time lags between spike pairs with a resolution of 5ms in a window of 200ms. Throughout the present study, the direction of a time lag is designated as the lag of the first encountered cell relative to the next cell along the trajectory, except in <xref ref-type="fig" rid="fig1">Figure 1</xref>, where the direction of time lag follows the cell order along the <inline-formula><mml:math id="inf148"><mml:msup><mml:mn>0</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="inf149"><mml:msup><mml:mn>45</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:math></inline-formula>, and <inline-formula><mml:math id="inf150"><mml:msup><mml:mn>90</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:math></inline-formula> trajectory in each comparison group, and in <xref ref-type="fig" rid="fig2">Figure 2</xref>, where the time lag direction is from left to right cells.</p><p>Correlation lag is derived by band-pass (4–12 Hz) filtering the cross-correlation histogram and applying a Hilbert transform on the filtered signal. The phase of the analytic signal at time lag 0 is the correlation lag.</p></sec><sec id="s4-9"><title>Extrinsicity and intrinsicity</title><p>We apply quantitative measures for the extrinsic or intrinsic nature of cross-correlations in a pair of place fields following <xref ref-type="bibr" rid="bib71">Yiu et al., 2022</xref>. We compare the cross-correlation histograms of a field pair for a running direction along the DG loop (<inline-formula><mml:math id="inf151"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) and opposite to the loop (<inline-formula><mml:math id="inf152"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mn>180</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>). Extrinsicity (Ex) is computed as the Pearson’s correlation (<inline-formula><mml:math id="inf153"><mml:mi>r</mml:mi></mml:math></inline-formula>) between two cross-correlation histograms, and intrinsicity (In) between the histogram of <inline-formula><mml:math id="inf154"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and the horizontally flipped histogram of <inline-formula><mml:math id="inf155"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mn>180</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>. The Pearson’s correlation is then transformed (<inline-formula><mml:math id="inf156"><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>) to be in the range of 0 and 1. An extrinsic correlation would give an extrinsicity near 1, since the effect of DG loop is minimal and correlation histograms are similar in both <inline-formula><mml:math id="inf157"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf158"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mn>180</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> directions. A pair of place fields with intrinsic correlation would see cross-correlation horizontally flipped in the <inline-formula><mml:math id="inf159"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mn>180</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> condition due to the large effect of DG loop, and hence, give an intrinsicity near 1. We classify a pair as extrinsic if its extrinsicity exceeds intrinsicity, and vice versa.</p></sec><sec id="s4-10"><title>Tempotron</title><p>A tempotron is a neuronally inspired classifier (readout neuron) whose dendritic synaptic weights can be adapted to recognize temporal patterns of spikes arriving at the afferents (for details, see <xref ref-type="bibr" rid="bib20">Gütig and Sompolinsky, 2006</xref>). Briefly, the soma potential of the tempotron follows the equations<disp-formula id="equ22"><mml:math id="m22"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:munder><mml:mi>K</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ23"><mml:math id="m23"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>τ</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>−</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <italic>w</italic><sub><italic>i</italic></sub> is the adaptable weight of the afferent fiber conveying spikes from place cell <inline-formula><mml:math id="inf160"><mml:mi>i</mml:mi></mml:math></inline-formula> to the tempotron. <inline-formula><mml:math id="inf161"><mml:mrow><mml:mi>K</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is a post-synaptic potential (PSP) kernel with decay and rising time constants of <inline-formula><mml:math id="inf162"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf163"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1.25</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> respectively. <italic>V</italic><sub>0</sub> is a factor which normalizes the PSP kernel to 1. A spike is said to occur if <inline-formula><mml:math id="inf164"><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> crosses the firing threshold <inline-formula><mml:math id="inf165"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">Θ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> from below. After threshold crossing, the afferents will be shunted and spike arrivals will not evoke more PSPs for the rest of the pattern. A pattern is defined as the set of spike times of all the pre-synaptic place cells in a theta cycle (100 ms).</p><p>The weight <italic>w</italic><sub><italic>i</italic></sub> follows the update rule<disp-formula id="equ24"><mml:math id="m24"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msubsup><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mi>K</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ25"><mml:math id="m25"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="2em"/><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">a</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mspace linebreak="newline"/><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="2em"/><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">a</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <italic>t</italic><sub><italic>max</italic></sub> is the time at the peak of the soma potential <inline-formula><mml:math id="inf166"><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The learning rule assigns credit to the afferents based on spike timing. Spike times closer to the peak are considered to have higher contribution to the tempotron firing, hence their afferents are incremented by a larger step. After training, spike times with similar temporal correlations as the (+) patterns would be able to evoke enough PSP in the tempotron’s soma and elicit a spike as a positive response of binary classification, while those similar to (-) patterns would not elicit a spike from the tempotron.</p><p>We trained the tempotrons to identify the spike patterns of place cells at locations with and without intrinsic connectivity separately. To this end, we modified our network such that DG loops are present at the upper half of the arena, spanning the space from x=-20cm to x=+20 cm at y=+20 cm in direction <inline-formula><mml:math id="inf167"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, while the loop is absent in the lower half of the arena.</p><p>During training, we applied ‘non-moving’ spatial inputs to the CA3 place cells at the with-loop (0 cm, 20 cm) and no-loop (0 cm, –20 cm) locations for 1 s, as if the animal were standing still at the locations, evoking the activities representing the two location cues. For computational efficiency, we restricted our analysis to the populations of CA3 place cells within the 20 cm squared boxes centered at the two locations. Each population contains 400 pre-synaptic cells, forming the input space for the tempotron. The spikes from the with-loop population will train the first tempotron and those from the no-loop population will train the second tempotron. Prior to training, the input spikes are sub-divided to 10 patterns based on their theta cycles. Each pattern has a window of 100 ms. We added noise to the patterns by jittering the spikes with Gaussian noise <inline-formula><mml:math id="inf168"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mo>∼</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> for 100 times. As a result, each tempotron receives 10×100 = 1,000 training patterns from the activity evoked by the location. All training patterns are (+) patterns and there is no (-) pattern.</p><p>After training, trajectories (20 cm long, 1 s duration) with running directions from 0° to 360° with 15° increment were simulated to cross each of the locations. The trajectories produce a mix of extrinsic and intrinsic sequences in the with-loop population and only extrinsic sequences in the no-loop population. The patterns evoked by the running trajectories were separately applied to the tempotrons. The input spikes for testing were also subdivided into theta cycles and jittered in the same manner as during training, forming 1000 testing patterns for each running direction. A sequence is said to be correctly identified if the tempotron fires at at least 1 out of 10 theta cycles along the trajectory. The accuracy rate for each running direction of trajectory is computed across the 100 jittered realizations.</p></sec><sec id="s4-11"><title>Code availability</title><p>We used Python 3 for simulations and visualization. The codes are available from a github repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/yyhhoi/directionalnet">https://github.com/yyhhoi/directionalnet</ext-link>, copy archived at <xref ref-type="bibr" rid="bib72">Yiu, 2023</xref>).</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Supervision, Funding acquisition, Writing - original draft, Writing - review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-86837-mdarchecklist1-v1.pdf" mimetype="application" mime-subtype="pdf"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>The current manuscript is a computational study, so no data have been generated for this manuscript. We used Python 3 for simulations and visualization. The codes are available from <ext-link ext-link-type="uri" xlink:href="https://github.com/yyhhoi/directionalnet">https://github.com/yyhhoi/directionalnet</ext-link> (copy archived at <xref ref-type="bibr" rid="bib72">Yiu, 2023</xref>).</p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abbott</surname><given-names>LF</given-names></name><name><surname>Varela</surname><given-names>JA</given-names></name><name><surname>Sen</surname><given-names>K</given-names></name><name><surname>Nelson</surname><given-names>SB</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Synaptic depression and cortical gain control</article-title><source>Science</source><volume>275</volume><fpage>220</fpage><lpage>224</lpage><pub-id pub-id-type="doi">10.1126/science.275.5297.221</pub-id><pub-id pub-id-type="pmid">8985017</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Acharya</surname><given-names>L</given-names></name><name><surname>Aghajan</surname><given-names>ZM</given-names></name><name><surname>Vuong</surname><given-names>C</given-names></name><name><surname>Moore</surname><given-names>JJ</given-names></name><name><surname>Mehta</surname><given-names>MR</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Causal influence of visual cues on Hippocampal Directional selectivity</article-title><source>Cell</source><volume>164</volume><fpage>197</fpage><lpage>207</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.12.015</pub-id><pub-id pub-id-type="pmid">26709045</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Ahmadi</surname><given-names>S</given-names></name><name><surname>Sasaki</surname><given-names>T</given-names></name><name><surname>Sabariego</surname><given-names>M</given-names></name><name><surname>Leibold</surname><given-names>C</given-names></name><name><surname>Leutgeb</surname><given-names>S</given-names></name><name><surname>Leutgeb</surname><given-names>JK</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Distinct Roles of Dentate Gyrus and Medial Entorhinal Cortex Inputs for Phase Precession and Temporal Correlations in the Hippocampal CA3 Area</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2022.06.07.491859</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berretta</surname><given-names>N</given-names></name><name><surname>Jones</surname><given-names>RS</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Tonic facilitation of glutamate release by presynaptic N-methyl-D-aspartate autoreceptors in the entorhinal cortex</article-title><source>Neuroscience</source><volume>75</volume><fpage>339</fpage><lpage>344</lpage><pub-id pub-id-type="doi">10.1016/0306-4522(96)00301-6</pub-id><pub-id pub-id-type="pmid">8931000</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brunel</surname><given-names>N</given-names></name><name><surname>Trullier</surname><given-names>O</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Plasticity of directional place fields in a model of rodent CA3</article-title><source>Hippocampus</source><volume>8</volume><fpage>651</fpage><lpage>665</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1098-1063(1998)8:6&lt;651::AID-HIPO8&gt;3.0.CO;2-L</pub-id><pub-id pub-id-type="pmid">9882023</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buhry</surname><given-names>L</given-names></name><name><surname>Azizi</surname><given-names>AH</given-names></name><name><surname>Cheng</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Reactivation, replay, and preplay: how it might all fit together</article-title><source>Neural Plasticity</source><volume>2011</volume><elocation-id>203462</elocation-id><pub-id pub-id-type="doi">10.1155/2011/203462</pub-id><pub-id pub-id-type="pmid">21918724</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burke</surname><given-names>SN</given-names></name><name><surname>Maurer</surname><given-names>AP</given-names></name><name><surname>Yang</surname><given-names>Z</given-names></name><name><surname>Navratilova</surname><given-names>Z</given-names></name><name><surname>Barnes</surname><given-names>CA</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Glutamate receptor-mediated restoration of experience-dependent place field expansion plasticity in aged rats</article-title><source>Behavioral Neuroscience</source><volume>122</volume><fpage>535</fpage><lpage>548</lpage><pub-id pub-id-type="doi">10.1037/0735-7044.122.3.535</pub-id><pub-id pub-id-type="pmid">18513124</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cei</surname><given-names>A</given-names></name><name><surname>Girardeau</surname><given-names>G</given-names></name><name><surname>Drieu</surname><given-names>C</given-names></name><name><surname>Kanbi</surname><given-names>KE</given-names></name><name><surname>Zugaro</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Reversed theta sequences of hippocampal cell assemblies during backward travel</article-title><source>Nature Neuroscience</source><volume>17</volume><fpage>719</fpage><lpage>724</lpage><pub-id pub-id-type="doi">10.1038/nn.3698</pub-id><pub-id pub-id-type="pmid">24667574</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chenani</surname><given-names>A</given-names></name><name><surname>Sabariego</surname><given-names>M</given-names></name><name><surname>Schlesiger</surname><given-names>MI</given-names></name><name><surname>Leutgeb</surname><given-names>JK</given-names></name><name><surname>Leutgeb</surname><given-names>S</given-names></name><name><surname>Leibold</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Hippocampal CA1 replay becomes less prominent but more rigid without inputs from medial entorhinal cortex</article-title><source>Nature Communications</source><volume>10</volume><elocation-id>1341</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-019-09280-0</pub-id><pub-id pub-id-type="pmid">30902981</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cheng</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The CRISP theory of hippocampal function in episodic memory</article-title><source>Frontiers in Neural Circuits</source><volume>7</volume><elocation-id>88</elocation-id><pub-id pub-id-type="doi">10.3389/fncir.2013.00088</pub-id><pub-id pub-id-type="pmid">23653597</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dong</surname><given-names>C</given-names></name><name><surname>Madar</surname><given-names>AD</given-names></name><name><surname>Sheffield</surname><given-names>MEJ</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Distinct place cell dynamics in CA1 and CA3 encode experience in new environments</article-title><source>Nature Communications</source><volume>12</volume><elocation-id>2977</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-021-23260-3</pub-id><pub-id pub-id-type="pmid">34016996</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dragoi</surname><given-names>G</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Temporal encoding of place sequences by hippocampal cell assemblies</article-title><source>Neuron</source><volume>50</volume><fpage>145</fpage><lpage>157</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2006.02.023</pub-id><pub-id pub-id-type="pmid">16600862</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dragoi</surname><given-names>G</given-names></name><name><surname>Tonegawa</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Preplay of future place cell sequences by hippocampal cellular assemblies</article-title><source>Nature</source><volume>469</volume><fpage>397</fpage><lpage>401</lpage><pub-id pub-id-type="doi">10.1038/nature09633</pub-id><pub-id pub-id-type="pmid">21179088</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dragoi</surname><given-names>G</given-names></name><name><surname>Tonegawa</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Distinct preplay of multiple novel spatial experiences in the rat</article-title><source>PNAS</source><volume>110</volume><fpage>9100</fpage><lpage>9105</lpage><pub-id pub-id-type="doi">10.1073/pnas.1306031110</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dragoi</surname><given-names>G</given-names></name><name><surname>Tonegawa</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Selection of preconfigured cell assemblies for representation of novel spatial experiences</article-title><source>Philosophical Transactions of the Royal Society of London. Series B, Biological Sciences</source><volume>369</volume><elocation-id>20120522</elocation-id><pub-id pub-id-type="doi">10.1098/rstb.2012.0522</pub-id><pub-id pub-id-type="pmid">24366134</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ekstrom</surname><given-names>AD</given-names></name><name><surname>Meltzer</surname><given-names>J</given-names></name><name><surname>McNaughton</surname><given-names>BL</given-names></name><name><surname>Barnes</surname><given-names>CA</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>NMDA receptor antagonism blocks experience-dependent expansion of hippocampal “place fields.”</article-title><source>Neuron</source><volume>31</volume><fpage>631</fpage><lpage>638</lpage><pub-id pub-id-type="doi">10.1016/s0896-6273(01)00401-9</pub-id><pub-id pub-id-type="pmid">11545721</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feng</surname><given-names>T</given-names></name><name><surname>Silva</surname><given-names>D</given-names></name><name><surname>Foster</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Dissociation between the experience-dependent development of hippocampal theta sequences and single-trial phase precession</article-title><source>The Journal of Neuroscience</source><volume>35</volume><fpage>4890</fpage><lpage>4902</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2614-14.2015</pub-id><pub-id pub-id-type="pmid">25810520</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foster</surname><given-names>DJ</given-names></name><name><surname>Wilson</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Hippocampal theta sequences</article-title><source>Hippocampus</source><volume>17</volume><fpage>1093</fpage><lpage>1099</lpage><pub-id pub-id-type="doi">10.1002/hipo.20345</pub-id><pub-id pub-id-type="pmid">17663452</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Giocomo</surname><given-names>LM</given-names></name><name><surname>Stensola</surname><given-names>T</given-names></name><name><surname>Bonnevie</surname><given-names>T</given-names></name><name><surname>Van Cauter</surname><given-names>T</given-names></name><name><surname>Moser</surname><given-names>M-B</given-names></name><name><surname>Moser</surname><given-names>EI</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Topography of head direction cells in medial entorhinal cortex</article-title><source>Current Biology</source><volume>24</volume><fpage>252</fpage><lpage>262</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2013.12.002</pub-id><pub-id pub-id-type="pmid">24440398</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gütig</surname><given-names>R</given-names></name><name><surname>Sompolinsky</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>The tempotron: a neuron that learns spike timing-based decisions</article-title><source>Nature Neuroscience</source><volume>9</volume><fpage>420</fpage><lpage>428</lpage><pub-id pub-id-type="doi">10.1038/nn1643</pub-id><pub-id pub-id-type="pmid">16474393</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haga</surname><given-names>T</given-names></name><name><surname>Fukai</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Recurrent network model for learning goal-directed sequences through reverse replay</article-title><source>eLife</source><volume>7</volume><elocation-id>e34171</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.34171</pub-id><pub-id pub-id-type="pmid">29969098</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hainmueller</surname><given-names>T</given-names></name><name><surname>Bartos</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Parallel emergence of stable and dynamic memory engrams in the hippocampus</article-title><source>Nature</source><volume>558</volume><fpage>292</fpage><lpage>296</lpage><pub-id pub-id-type="doi">10.1038/s41586-018-0191-2</pub-id><pub-id pub-id-type="pmid">29875406</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harris</surname><given-names>KD</given-names></name><name><surname>Henze</surname><given-names>DA</given-names></name><name><surname>Hirase</surname><given-names>H</given-names></name><name><surname>Leinekugel</surname><given-names>X</given-names></name><name><surname>Dragoi</surname><given-names>G</given-names></name><name><surname>Czurkó</surname><given-names>A</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Spike train dynamics predicts theta-related phase precession in hippocampal pyramidal cells</article-title><source>Nature</source><volume>417</volume><fpage>738</fpage><lpage>741</lpage><pub-id pub-id-type="doi">10.1038/nature00808</pub-id><pub-id pub-id-type="pmid">12066184</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harvey</surname><given-names>CD</given-names></name><name><surname>Collman</surname><given-names>F</given-names></name><name><surname>Dombeck</surname><given-names>DA</given-names></name><name><surname>Tank</surname><given-names>DW</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Intracellular dynamics of hippocampal place cells during virtual navigation</article-title><source>Nature</source><volume>461</volume><fpage>941</fpage><lpage>946</lpage><pub-id pub-id-type="doi">10.1038/nature08499</pub-id><pub-id pub-id-type="pmid">19829374</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Hebb</surname><given-names>DO</given-names></name></person-group><year iso-8601-date="1949">1949</year><source>The Organization of Behavior: A Neuropsychological Theory</source><publisher-loc>New York</publisher-loc><publisher-name>Wiley</publisher-name></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hsu</surname><given-names>TT</given-names></name><name><surname>Lee</surname><given-names>CT</given-names></name><name><surname>Tai</surname><given-names>MH</given-names></name><name><surname>Lien</surname><given-names>CC</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Differential recruitment of dentate Gyrus Interneuron Types by Commissural Versus Perforant Pathways</article-title><source>Cerebral Cortex</source><volume>26</volume><fpage>2715</fpage><lpage>2727</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhv127</pub-id><pub-id pub-id-type="pmid">26045570</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huxter</surname><given-names>J</given-names></name><name><surname>Burgess</surname><given-names>N</given-names></name><name><surname>O’Keefe</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Independent rate and temporal coding in hippocampal pyramidal cells</article-title><source>Nature</source><volume>425</volume><fpage>828</fpage><lpage>832</lpage><pub-id pub-id-type="doi">10.1038/nature02058</pub-id><pub-id pub-id-type="pmid">14574410</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huxter</surname><given-names>JR</given-names></name><name><surname>Senior</surname><given-names>TJ</given-names></name><name><surname>Allen</surname><given-names>K</given-names></name><name><surname>Csicsvari</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Theta phase–specific codes for two-dimensional position, trajectory and heading in the hippocampus</article-title><source>Nature Neuroscience</source><volume>11</volume><fpage>587</fpage><lpage>594</lpage><pub-id pub-id-type="doi">10.1038/nn.2106</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Izhikevich</surname><given-names>EM</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Simple model of spiking neurons</article-title><source>IEEE Transactions on Neural Networks</source><volume>14</volume><fpage>1569</fpage><lpage>1572</lpage><pub-id pub-id-type="doi">10.1109/TNN.2003.820440</pub-id><pub-id pub-id-type="pmid">18244602</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jaramillo</surname><given-names>J</given-names></name><name><surname>Kempter</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Phase precession: a neural code underlying episodic memory?</article-title><source>Current Opinion in Neurobiology</source><volume>43</volume><fpage>130</fpage><lpage>138</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2017.02.006</pub-id><pub-id pub-id-type="pmid">28390862</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jensen</surname><given-names>O</given-names></name><name><surname>Idiart</surname><given-names>MA</given-names></name><name><surname>Lisman</surname><given-names>JE</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Physiologically realistic formation of autoassociative memory in networks with theta/gamma oscillations: role of fast NMDA channels</article-title><source>Learning &amp; Memory</source><volume>3</volume><fpage>243</fpage><lpage>256</lpage><pub-id pub-id-type="doi">10.1101/lm.3.2-3.243</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kay</surname><given-names>K</given-names></name><name><surname>Chung</surname><given-names>JE</given-names></name><name><surname>Sosa</surname><given-names>M</given-names></name><name><surname>Schor</surname><given-names>JS</given-names></name><name><surname>Karlsson</surname><given-names>MP</given-names></name><name><surname>Larkin</surname><given-names>MC</given-names></name><name><surname>Liu</surname><given-names>DF</given-names></name><name><surname>Frank</surname><given-names>LM</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Constant sub-second cycling between representations of possible futures in the Hippocampus</article-title><source>Cell</source><volume>180</volume><fpage>552</fpage><lpage>567</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2020.01.014</pub-id><pub-id pub-id-type="pmid">32004462</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kempter</surname><given-names>R</given-names></name><name><surname>Leibold</surname><given-names>C</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name><name><surname>Diba</surname><given-names>K</given-names></name><name><surname>Schmidt</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Quantifying circular-linear associations: hippocampal phase precession</article-title><source>Journal of Neuroscience Methods</source><volume>207</volume><fpage>113</fpage><lpage>124</lpage><pub-id pub-id-type="doi">10.1016/j.jneumeth.2012.03.007</pub-id><pub-id pub-id-type="pmid">22487609</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Larimer</surname><given-names>P</given-names></name><name><surname>Strowbridge</surname><given-names>BW</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Nonrandom local circuits in the dentate gyrus</article-title><source>The Journal of Neuroscience</source><volume>28</volume><fpage>12212</fpage><lpage>12223</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3612-08.2008</pub-id><pub-id pub-id-type="pmid">19020015</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>AK</given-names></name><name><surname>Wilson</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Memory of sequential experience in the hippocampus during slow wave sleep</article-title><source>Neuron</source><volume>36</volume><fpage>1183</fpage><lpage>1194</lpage><pub-id pub-id-type="doi">10.1016/s0896-6273(02)01096-6</pub-id><pub-id pub-id-type="pmid">12495631</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>I</given-names></name><name><surname>Rao</surname><given-names>G</given-names></name><name><surname>Knierim</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>A double dissociation between hippocampal subfields: differential time course of CA3 and CA1 place cells for processing changed environments</article-title><source>Neuron</source><volume>42</volume><fpage>803</fpage><lpage>815</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2004.05.010</pub-id><pub-id pub-id-type="pmid">15182719</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leibold</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>A model for navigation in unknown environments based on A reservoir of hippocampal sequences</article-title><source>Neural Networks</source><volume>124</volume><fpage>328</fpage><lpage>342</lpage><pub-id pub-id-type="doi">10.1016/j.neunet.2020.01.014</pub-id><pub-id pub-id-type="pmid">32036230</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leutgeb</surname><given-names>S</given-names></name><name><surname>Leutgeb</surname><given-names>JK</given-names></name><name><surname>Treves</surname><given-names>A</given-names></name><name><surname>Moser</surname><given-names>MB</given-names></name><name><surname>Moser</surname><given-names>EI</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Distinct ensemble codes in hippocampal areas CA3 and CA1</article-title><source>Science</source><volume>305</volume><fpage>1295</fpage><lpage>1298</lpage><pub-id pub-id-type="doi">10.1126/science.1100265</pub-id><pub-id pub-id-type="pmid">15272123</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lisman</surname><given-names>J</given-names></name><name><surname>Redish</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Prediction, sequences and the hippocampus</article-title><source>Philosophical Transactions of the Royal Society of London. Series B, Biological Sciences</source><volume>364</volume><fpage>1193</fpage><lpage>1201</lpage><pub-id pub-id-type="doi">10.1098/rstb.2008.0316</pub-id><pub-id pub-id-type="pmid">19528000</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mankin</surname><given-names>EA</given-names></name><name><surname>Thurley</surname><given-names>K</given-names></name><name><surname>Chenani</surname><given-names>A</given-names></name><name><surname>Haas</surname><given-names>OV</given-names></name><name><surname>Debs</surname><given-names>L</given-names></name><name><surname>Henke</surname><given-names>J</given-names></name><name><surname>Galinato</surname><given-names>M</given-names></name><name><surname>Leutgeb</surname><given-names>JK</given-names></name><name><surname>Leutgeb</surname><given-names>S</given-names></name><name><surname>Leibold</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The hippocampal code for space in Mongolian gerbils</article-title><source>Hippocampus</source><volume>29</volume><fpage>787</fpage><lpage>801</lpage><pub-id pub-id-type="doi">10.1002/hipo.23075</pub-id><pub-id pub-id-type="pmid">30746805</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Markram</surname><given-names>H</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Tsodyks</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Differential signaling via the same axon of neocortical pyramidal neurons</article-title><source>PNAS</source><volume>95</volume><fpage>5323</fpage><lpage>5328</lpage><pub-id pub-id-type="doi">10.1073/pnas.95.9.5323</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Markus</surname><given-names>EJ</given-names></name><name><surname>Qin</surname><given-names>YL</given-names></name><name><surname>Leonard</surname><given-names>B</given-names></name><name><surname>Skaggs</surname><given-names>WE</given-names></name><name><surname>McNaughton</surname><given-names>BL</given-names></name><name><surname>Barnes</surname><given-names>CA</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Interactions between location and task affect the spatial and directional firing of hippocampal neurons</article-title><source>The Journal of Neuroscience</source><volume>15</volume><fpage>7079</fpage><lpage>7094</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.15-11-07079.1995</pub-id><pub-id pub-id-type="pmid">7472463</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maurer</surname><given-names>AP</given-names></name><name><surname>Vanrhoads</surname><given-names>SR</given-names></name><name><surname>Sutherland</surname><given-names>GR</given-names></name><name><surname>Lipa</surname><given-names>P</given-names></name><name><surname>McNaughton</surname><given-names>BL</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Self-motion and the origin of differential spatial scaling along the septo-temporal axis of the hippocampus</article-title><source>Hippocampus</source><volume>15</volume><fpage>841</fpage><lpage>852</lpage><pub-id pub-id-type="doi">10.1002/hipo.20114</pub-id><pub-id pub-id-type="pmid">16145692</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maurer</surname><given-names>AP</given-names></name><name><surname>McNaughton</surname><given-names>BL</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Network and intrinsic cellular mechanisms underlying theta phase precession of hippocampal neurons</article-title><source>Trends in Neurosciences</source><volume>30</volume><fpage>325</fpage><lpage>333</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2007.05.002</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mehta</surname><given-names>MR</given-names></name><name><surname>Barnes</surname><given-names>CA</given-names></name><name><surname>McNaughton</surname><given-names>BL</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Experience-dependent, asymmetric expansion of hippocampal place fields</article-title><source>PNAS</source><volume>94</volume><fpage>8918</fpage><lpage>8921</lpage><pub-id pub-id-type="doi">10.1073/pnas.94.16.8918</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mehta</surname><given-names>MR</given-names></name><name><surname>Quirk</surname><given-names>MC</given-names></name><name><surname>Wilson</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Experience-dependent asymmetric shape of hippocampal receptive fields</article-title><source>Neuron</source><volume>25</volume><fpage>707</fpage><lpage>715</lpage><pub-id pub-id-type="doi">10.1016/s0896-6273(00)81072-7</pub-id><pub-id pub-id-type="pmid">10774737</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mehta</surname><given-names>MR</given-names></name><name><surname>Lee</surname><given-names>AK</given-names></name><name><surname>Wilson</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Role of experience and oscillations in transforming a rate code into a temporal code</article-title><source>Nature</source><volume>417</volume><fpage>741</fpage><lpage>746</lpage><pub-id pub-id-type="doi">10.1038/nature00807</pub-id><pub-id pub-id-type="pmid">12066185</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mejías</surname><given-names>JF</given-names></name><name><surname>Torres</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>The role of synaptic facilitation in spike coincidence detection</article-title><source>Journal of Computational Neuroscience</source><volume>24</volume><fpage>222</fpage><lpage>234</lpage><pub-id pub-id-type="doi">10.1007/s10827-007-0052-8</pub-id><pub-id pub-id-type="pmid">17674172</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mizuseki</surname><given-names>K</given-names></name><name><surname>Sirota</surname><given-names>A</given-names></name><name><surname>Pastalkova</surname><given-names>E</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Theta oscillations provide temporal windows for local circuit computation in the entorhinal-hippocampal loop</article-title><source>Neuron</source><volume>64</volume><fpage>267</fpage><lpage>280</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2009.08.037</pub-id><pub-id pub-id-type="pmid">19874793</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parra-Barrero</surname><given-names>E</given-names></name><name><surname>Cheng</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Learning to predict future locations with internally generated theta sequences</article-title><source>PLOS Computational Biology</source><volume>19</volume><elocation-id>e1011101</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1011101</pub-id><pub-id pub-id-type="pmid">37172053</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Penttonen</surname><given-names>M</given-names></name><name><surname>Kamondi</surname><given-names>A</given-names></name><name><surname>Sik</surname><given-names>A</given-names></name><name><surname>Acsády</surname><given-names>L</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Feed-forward and feed-back activation of the dentate gyrus in vivo during dentate spikes and sharp wave bursts</article-title><source>Hippocampus</source><volume>7</volume><fpage>437</fpage><lpage>450</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1098-1063(1997)7:4&lt;437::AID-HIPO9&gt;3.0.CO;2-F</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pfeiffer</surname><given-names>BE</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Spatial learning drives Rapid Goal representation in Hippocampal ripples without place field Accumulation or Goal-Oriented Theta Sequences</article-title><source>The Journal of Neuroscience</source><volume>42</volume><fpage>3975</fpage><lpage>3988</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2479-21.2022</pub-id><pub-id pub-id-type="pmid">35396328</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rivas</surname><given-names>J</given-names></name><name><surname>Gaztelu</surname><given-names>JM</given-names></name><name><surname>García-Austt</surname><given-names>E</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Changes in hippocampal cell discharge patterns and theta rhythm spectral properties as a function of walking velocity in the guinea pig</article-title><source>Experimental Brain Research</source><volume>108</volume><fpage>113</fpage><lpage>118</lpage><pub-id pub-id-type="doi">10.1007/BF00242908</pub-id><pub-id pub-id-type="pmid">8721159</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Romani</surname><given-names>S</given-names></name><name><surname>Tsodyks</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Short-term plasticity based network model of place cells dynamics</article-title><source>Hippocampus</source><volume>25</volume><fpage>94</fpage><lpage>105</lpage><pub-id pub-id-type="doi">10.1002/hipo.22355</pub-id><pub-id pub-id-type="pmid">25155013</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roth</surname><given-names>ED</given-names></name><name><surname>Yu</surname><given-names>X</given-names></name><name><surname>Rao</surname><given-names>G</given-names></name><name><surname>Knierim</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Functional differences in the backward shifts of CA1 and CA3 place fields in novel and familiar environments</article-title><source>PLOS ONE</source><volume>7</volume><elocation-id>e36035</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0036035</pub-id><pub-id pub-id-type="pmid">22558316</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sasaki</surname><given-names>T</given-names></name><name><surname>Piatti</surname><given-names>VC</given-names></name><name><surname>Hwaun</surname><given-names>E</given-names></name><name><surname>Ahmadi</surname><given-names>S</given-names></name><name><surname>Lisman</surname><given-names>JE</given-names></name><name><surname>Leutgeb</surname><given-names>S</given-names></name><name><surname>Leutgeb</surname><given-names>JK</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Dentate network activity is necessary for spatial working memory by supporting CA3 sharp-wave ripple generation and prospective firing of CA3 neurons</article-title><source>Nature Neuroscience</source><volume>21</volume><fpage>258</fpage><lpage>269</lpage><pub-id pub-id-type="doi">10.1038/s41593-017-0061-5</pub-id><pub-id pub-id-type="pmid">29335604</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scharfman</surname><given-names>HE</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Evidence from simultaneous intracellular recordings in rat hippocampal slices that area CA3 pyramidal cells innervate dentate hilar mossy cells</article-title><source>Journal of Neurophysiology</source><volume>72</volume><fpage>2167</fpage><lpage>2180</lpage><pub-id pub-id-type="doi">10.1152/jn.1994.72.5.2167</pub-id><pub-id pub-id-type="pmid">7884451</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scharfman</surname><given-names>HE</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Electrophysiological evidence that dentate hilar mossy cells are excitatory and innervate both granule cells and interneurons</article-title><source>Journal of Neurophysiology</source><volume>74</volume><fpage>179</fpage><lpage>194</lpage><pub-id pub-id-type="doi">10.1152/jn.1995.74.1.179</pub-id><pub-id pub-id-type="pmid">7472322</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scharfman</surname><given-names>HE</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The enigmatic mossy cell of the dentate gyrus</article-title><source>Nature Reviews. Neuroscience</source><volume>17</volume><fpage>562</fpage><lpage>575</lpage><pub-id pub-id-type="doi">10.1038/nrn.2016.87</pub-id><pub-id pub-id-type="pmid">27466143</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shen</surname><given-names>J</given-names></name><name><surname>Barnes</surname><given-names>CA</given-names></name><name><surname>McNaughton</surname><given-names>BL</given-names></name><name><surname>Skaggs</surname><given-names>WE</given-names></name><name><surname>Weaver</surname><given-names>KL</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>The effect of aging on experience-dependent plasticity of hippocampal place cells</article-title><source>The Journal of Neuroscience</source><volume>17</volume><fpage>6769</fpage><lpage>6782</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.17-17-06769.1997</pub-id><pub-id pub-id-type="pmid">9254688</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skaggs</surname><given-names>WE</given-names></name><name><surname>McNaughton</surname><given-names>BL</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Replay of neuronal firing sequences in rat hippocampus during sleep following spatial experience</article-title><source>Science</source><volume>271</volume><fpage>1870</fpage><lpage>1873</lpage><pub-id pub-id-type="doi">10.1126/science.271.5257.1870</pub-id><pub-id pub-id-type="pmid">8596957</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skaggs</surname><given-names>WE</given-names></name><name><surname>McNaughton</surname><given-names>BL</given-names></name><name><surname>Wilson</surname><given-names>MA</given-names></name><name><surname>Barnes</surname><given-names>CA</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Theta phase precession in hippocampal neuronal populations and the compression of temporal sequences</article-title><source>Hippocampus</source><volume>6</volume><fpage>149</fpage><lpage>172</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1098-1063(1996)6:2&lt;149::AID-HIPO6&gt;3.0.CO;2-K</pub-id><pub-id pub-id-type="pmid">8797016</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soriano</surname><given-names>E</given-names></name><name><surname>Frotscher</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Mossy cells of the rat fascia dentata are glutamate-immunoreactive</article-title><source>Hippocampus</source><volume>4</volume><fpage>65</fpage><lpage>69</lpage><pub-id pub-id-type="doi">10.1002/hipo.450040108</pub-id><pub-id pub-id-type="pmid">7914798</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stefanini</surname><given-names>F</given-names></name><name><surname>Kushnir</surname><given-names>L</given-names></name><name><surname>Jimenez</surname><given-names>JC</given-names></name><name><surname>Jennings</surname><given-names>JH</given-names></name><name><surname>Woods</surname><given-names>NI</given-names></name><name><surname>Stuber</surname><given-names>GD</given-names></name><name><surname>Kheirbek</surname><given-names>MA</given-names></name><name><surname>Hen</surname><given-names>R</given-names></name><name><surname>Fusi</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>A distributed Neural Code in the dentate Gyrus and in CA1</article-title><source>Neuron</source><volume>107</volume><fpage>703</fpage><lpage>716</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2020.05.022</pub-id><pub-id pub-id-type="pmid">32521223</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taube</surname><given-names>JS</given-names></name><name><surname>Muller</surname><given-names>RU</given-names></name><name><surname>Ranck</surname><given-names>JB</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Head-direction cells recorded from the postsubiculum in freely moving rats. I. Description and quantitative analysis</article-title><source>The Journal of Neuroscience</source><volume>10</volume><fpage>420</fpage><lpage>435</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.10-02-00420.1990</pub-id><pub-id pub-id-type="pmid">2303851</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thurley</surname><given-names>K</given-names></name><name><surname>Leibold</surname><given-names>C</given-names></name><name><surname>Gundlfinger</surname><given-names>A</given-names></name><name><surname>Schmitz</surname><given-names>D</given-names></name><name><surname>Kempter</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Phase precession through synaptic facilitation</article-title><source>Neural Computation</source><volume>20</volume><fpage>1285</fpage><lpage>1324</lpage><pub-id pub-id-type="doi">10.1162/neco.2008.07-06-292</pub-id><pub-id pub-id-type="pmid">18085985</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsodyks</surname><given-names>MV</given-names></name><name><surname>Skaggs</surname><given-names>WE</given-names></name><name><surname>Sejnowski</surname><given-names>TJ</given-names></name><name><surname>McNaughton</surname><given-names>BL</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Population dynamics and theta rhythm phase precession of hippocampal place cell firing: A spiking neuron model</article-title><source>Hippocampus</source><volume>6</volume><fpage>271</fpage><lpage>280</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1098-1063(1996)6:3&lt;271::AID-HIPO5&gt;3.0.CO;2-Q</pub-id><pub-id pub-id-type="pmid">8841826</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsodyks</surname><given-names>MV</given-names></name><name><surname>Markram</surname><given-names>H</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>The neural code between neocortical pyramidal neurons depends on neurotransmitter release probability</article-title><source>PNAS</source><volume>94</volume><fpage>719</fpage><lpage>723</lpage><pub-id pub-id-type="doi">10.1073/pnas.94.2.719</pub-id><pub-id pub-id-type="pmid">9012851</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsodyks</surname><given-names>M</given-names></name><name><surname>Pawelzik</surname><given-names>K</given-names></name><name><surname>Markram</surname><given-names>H</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Neural networks with dynamic synapses</article-title><source>Neural Computation</source><volume>10</volume><fpage>821</fpage><lpage>835</lpage><pub-id pub-id-type="doi">10.1162/089976698300017502</pub-id><pub-id pub-id-type="pmid">9573407</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname><given-names>MA</given-names></name><name><surname>McNaughton</surname><given-names>BL</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Dynamics of the hippocampal ensemble code for space</article-title><source>Science</source><volume>261</volume><fpage>1055</fpage><lpage>1058</lpage><pub-id pub-id-type="doi">10.1126/science.8351520</pub-id><pub-id pub-id-type="pmid">8351520</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yiu</surname><given-names>YH</given-names></name><name><surname>Leutgeb</surname><given-names>JK</given-names></name><name><surname>Leibold</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Directional tuning of phase precession properties in the Hippocampus</article-title><source>The Journal of Neuroscience</source><volume>42</volume><fpage>2282</fpage><lpage>2297</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1569-21.2021</pub-id><pub-id pub-id-type="pmid">35110389</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Yiu</surname><given-names>YH</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>Directionalnet</data-title><version designator="swh:1:rev:7d87577ddb437b0c5941a29fae1b2f1bed909b33">swh:1:rev:7d87577ddb437b0c5941a29fae1b2f1bed909b33</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:fc7e003de3035b1738384de92550691dc47192b0;origin=https://github.com/yyhhoi/directionalnet;visit=swh:1:snp:e48933641593f2607bf458b9c564be6f773d2abf;anchor=swh:1:rev:7d87577ddb437b0c5941a29fae1b2f1bed909b33">https://archive.softwareheritage.org/swh:1:dir:fc7e003de3035b1738384de92550691dc47192b0;origin=https://github.com/yyhhoi/directionalnet;visit=swh:1:snp:e48933641593f2607bf458b9c564be6f773d2abf;anchor=swh:1:rev:7d87577ddb437b0c5941a29fae1b2f1bed909b33</ext-link></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zucker</surname><given-names>RS</given-names></name><name><surname>Regehr</surname><given-names>WG</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Short-term synaptic plasticity</article-title><source>Annual Review of Physiology</source><volume>64</volume><fpage>355</fpage><lpage>405</lpage><pub-id pub-id-type="doi">10.1146/annurev.physiol.64.092501.114547</pub-id><pub-id pub-id-type="pmid">11826273</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.86837.4.sa0</article-id><title-group><article-title>eLife assessment</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Bathellier</surname><given-names>Brice</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution>CNRS</institution><country>France</country></aff></contrib></contrib-group><kwd-group kwd-group-type="evidence-strength"><kwd>Convincing</kwd></kwd-group><kwd-group kwd-group-type="claim-importance"><kwd>Important</kwd></kwd-group></front-stub><body><p>This <bold>important</bold> work presents an interesting perspective for the generation and interpretation of phase precession in the hippocampal formation. Through numerical simulations and comparison to experiments, the study provides a <bold>convincing</bold> theoretical framework explaining the segregation of sequences reflecting navigation and sequences reflecting internal dynamics in the DG-CA3 loop. This study will be of interest for researchers in the spatial navigation and computational neuroscience fields.</p></body></sub-article><sub-article article-type="referee-report" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.86837.4.sa1</article-id><title-group><article-title>Reviewer #1 (Public Review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>In the manuscript entitled &quot;A theory of hippocampal theta correlations&quot;, the authors propose a new mechanism for phase precession and theta-time scale generation, as well as their interpretation in terms of navigation and neural coding. The authors propose the existence of extrinsic and intrinsic sequences during exploration, which may have complementary functions. These two types of sequences depend on external input and network interactions, but differ on the extent to which they depend on movement direction. Moreover, the authors propose a novel interpretation for intrinsic sequences, namely to signal a landmark cue that is independent of direction of traversal. Finally, a readout neuron can be trained to distinguish extrinsic from intrinsic sequences.</p><p>The study puts forward novel computational ideas related to neural coding, partly based on previous work from the authors, including published (Leibold, 2020, Yiu et al., 2022) and unpublished (Ahmedi et al., 2022. bioRxiv) work. The manuscript will contribute to the understanding of the mechanisms behind phase precession, as well as to how we interpret hippocampal temporal coding for navigation and memory.</p></body></sub-article><sub-article article-type="referee-report" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.86837.4.sa2</article-id><title-group><article-title>Reviewer #2 (Public Review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Place cells fire sequentially during hippocampal theta oscillations, forming a spatial representation of behavioral experiences in a temporally-compressed manner. The firing sequences during theta cycles are widely considered as essential assemblies for learning, memory, and planning. Many theoretical studies have investigated the mechanism of hippocampal theta firing sequences; however, they are either entirely extrinsic or intrinsic. In other words, they attribute the theta sequences to external sensorimotor drives or focus exclusively on the inherent firing patterns facilitated by the recurrent network architectures. Both types of theories are inadequate for explaining the complexity of the phenomena, particularly considering the observations in a previous paper by the authors: theta sequences independent of animal movement trajectories may occur simultaneously with sensorimotor inputs (Yiu et al., 2022).</p><p>In this manuscript, the authors concentrate on the CA3 area of the hippocampus and develop a model that accounts for both mechanisms. Specifically, the model generates extrinsic sequences through the short-term facilitation of CA3 cell activities, and intrinsic sequences via recurrent projections from the dentate gyrus. The model demonstrates how the phase precession of place cells in theta sequences is modulated by running direction and the recurrent DG-CA3 network architecture. To evaluate the extent to which firing sequences are induced by sensorimotor inputs and recurrent network architecture, the authors use the Pearson correlation coefficient to measure the &quot;intrinsicity&quot; and &quot;extrinsicity&quot; of spike pairs in their simulations.</p><p>I find this research topic to be both important and interesting, and I appreciate the clarity of the paper. The idea of combining intrinsic and extrinsic mechanisms for theta sequences is novel, and the model effectively incorporates two crucial phenomena: phase precession and directionality of theta sequences. I particularly commend the authors' efforts to integrate previous theories into their model and conduct a systematic comparison. This is exactly what our community needs: not only the development of new models, but also understanding the critical relationships between different models.</p></body></sub-article><sub-article article-type="author-comment" id="sa3"><front-stub><article-id pub-id-type="doi">10.7554/eLife.86837.4.sa3</article-id><title-group><article-title>Author Response</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Yiu</surname><given-names>Yuk-Hoi</given-names></name><role specific-use="author">Author</role><aff><institution>University of Freiburg</institution><addr-line><named-content content-type="city">Freiburg</named-content></addr-line><country>Germany</country></aff></contrib><contrib contrib-type="author"><name><surname>Leibold</surname><given-names>Christian</given-names></name><role specific-use="author">Author</role><aff><institution>University of Freiburg</institution><addr-line><named-content content-type="city">Freiburg</named-content></addr-line><country>Germany</country></aff></contrib></contrib-group></front-stub><body><p>The following is the authors’ response to the previous review</p><p>In response to the additional concerns voiced by Reviewer# 2, we have conducted control simulations. The outcomes are summarized in the new supplements to Figure 3. They show that the model is robust under changes of short-term plasticity parameters and running speed.</p><p>Below, we give a point-by-point response to the remaining comments of the editors and reviewers.</p><disp-quote content-type="editor-comment"><p>Editorial Assessment: This important work presents an interesting perspective for the generation and interpretation of phase precession in the hippocampal formation. Through numerical simulations and comparison to experiments, the study provides a convincing theoretical framework explaining the segregation of sequences reflecting navigation and sequences reflecting internal dynamics in the DG-CA3 loop. This study will be of interest for researchers in the spatial navigation and computational neuroscience fields.</p></disp-quote><p>We would like to thank the Editors very much for this positive assessment of our work!</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #1</bold></p><p>In the manuscript entitled ”A theory of hippocampal theta correlations”, the authors propose a new mechanism for phase precession and theta-time scale generation, as well as their interpretation in terms of navigation and neural coding. The authors propose the existence of extrinsic and intrinsic sequences during exploration, which may have complementary functions. These two types of sequences depend on external input and network interactions, but differ on the extent to which they depend on movement direction. Moreover, the authors propose a novel interpretation for intrinsic sequences, namely to signal a landmark cue that is independent of direction of traversal. Finally, a readout neuron can be trained to distinguish extrinsic from intrinsic sequences.</p><list list-type="bullet"><list-item><p>The study puts forward novel computational ideas related to neural coding, partly based on previous work from the authors, including published (Leibold, 2020, Yiu et al., 2022) and unpublished (Ahmedi et al., 2022. bioRxiv) work. The manuscript will contribute to the understanding of the mechanisms behind phase precession, as well as to how we interpret hippocampal temporal coding for navigation and memory.</p></list-item></list><p>I am very pleased to have seen major improvements in the manuscript regarding (i) a clarification of the concepts of extrinsic and intrinsic mechanisms, and (ii) overall arrangement of Figures but also (iii) expanding on some important concepts such as the role of experience in determining the asymmetric connectivity that is necessary for intrinsic models of sequence generation.</p></disp-quote><p>We are delighted to have been able to amend the Reviewer’s concerns voiced after the initial submission. We are very grateful for their many good suggestions that allowed us to make important additions to the revised manuscript.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #2</bold></p><list list-type="bullet"><list-item><p>Place cells fire sequentially during hippocampal theta oscillations, forming a spatial representation of behavioral experiences in a temporally-compressed manner. The firing sequences during theta cycles are widely considered as essential assemblies for learning, memory, and planning. Many theoretical studies have investigated the mechanism of hippocampal theta firing sequences; however, they are either entirely extrinsic or intrinsic. In other words, they attribute the theta sequences to external sensorimotor drives or focus exclusively on the inherent firing patterns facilitated by the recurrent network architectures. Both types of theories are inadequate for explaining the complexity of the phenomena, particularly considering the observations in a previous paper by the authors: theta sequences independent of animal movement trajectories may occur simultaneously with sensorimotor inputs (Yiu et al., 2022).</p></list-item></list><p>In this manuscript, the authors concentrate on the CA3 area of the hippocampus and develop a model that accounts for both mechanisms. Specifically, the model generates extrinsic sequences through the short-term facilitation of CA3 cell activities, and intrinsic sequences via recurrent projections from the dentate gyrus. The model demonstrates how the phase precession of place cells in theta sequences is modulated by running direction and the recurrent DG-CA3 network architecture. To evaluate the extent to which firing sequences are induced by sensorimotor inputs and recurrent network architecture, the authors use the Pearson correlation coefficient to measure the ”intrinsicity” and ”extrinsicity” of spike pairs in their simulations.</p><p>I find this research topic to be both important and interesting, and I appreciate the clarity of the paper. The idea of combining intrinsic and extrinsic mechanisms for theta sequences is novel, and the model effectively incorporates two crucial phenomena: phase precession and directionality of theta sequences. I particularly commend the authors’ efforts to integrate previous theories into their model and conduct a systematic comparison. This is exactly what our community needs: not only the development of new models, but also understanding the critical relationships between different models.</p></disp-quote><p>We also would like to express our gratitude to Reviewer 2 for their numerous constructive criticisms that led to a very much improved revised manuscript!</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #2</bold></p><p>1. The choice of timescale parameters for input facilitation and synaptic depression is still not fully justified in my opinion. The authors themselves mention that previous experiments suggest wide ranges for both timescales. Given that the generation of intrinsic and extrinsic sequences in their model is primarily driven by these two mechanisms, their chosen timescales should significantly impact the simulation results. I urge the authors to discuss the potential effects of selecting different sets of timescales and the possible limitations of the current selection of 500ms for both.</p><p>For instance, the authors state in the caption of Fig 1 that all simulated rat trajectories were set at a speed of 20cm/s, which is a rat’s walking speed. However, the running speed of rats can exceed 3m/s. In this case, none of the CA3 cells in the model would produce any extrinsic sequences since the animal would traverse the place fields much more rapidly, preventing the sensorimotor input from increasing as it does in the model.</p></disp-quote><p>The reviewer raised the valid point that our simulations may be sensitive to the short-term plasticity time constants and running speeds. We therefore conducted new simulations illustrated in Figure 3—figure supplements 1 and 2.</p><p>In agreement with the reviewer’s assertion, using the current model parameters, a higher running speed would not elicit extrinsic sequences due to the lack of depolarization from spatial input (Figure 3—figure supplement 2A). However, an increase of running speed also requires sensory inputs to be available on a larger spatial scale (width of the spatial input box in our case). Parra-Barrero et al., eLife 10:e70296 and Parra-Barrero &amp; Cheng 2023, PLOS Comput. Bio. 19:e1011101, e.g., showed that place field sizes become larger under higher running speeds and consequently lengthen the theta sequences. With such modification, along with a longer DG projection length (|r|), we were able to recover the theta sequence at a higher speed (100 cm/s), using the same STD and STF time constants (Figure 3—figure supplement 2B). Furthermore, it has been shown that theta frequency increases with running speed (e.g., Rivas et al., 1996, Exp Brain Res 108:113-8). In our analysis, a higher theta frequency (12Hz instead of 10Hz) is also able to counteract the effect of running speed and leads to control-level like phase precession (Figure 3—figure supplement 2C).</p><p>Consistent with this finding, the original study of Romani &amp; Tsodyks 2015, Hippocampus 25:94-105, found a fourfold increase of speed (from 0.05 to 0.2 fraction of the track per second) to not affect phase-position relations (with UD = 0.8 and 800ms STD time constant), likely due to the large place field sizes covering 1/3 of the track. Thus, phase precession may only be affected by high speeds in narrow place fields in which activity would only be present for few theta cycles thus naturally having limited capacity for phase coding.</p><p>We further refrain from increasing the running speed beyond 1m/s (e.g. 3m/s as suggested by the reviewer), as the typical running speed of a rat in an 80cm square environment is between 20-40cm/s (Mankin et al. 2012, PNAS, 109:19462-19467). Even on linear tracks, reported running speeds hardly exceed 120 cm/s (e.g. Ahmed and Mehta, 2018, J Neurosci 32:73737383; Schmidt et al., 2009 J Neurosci 29:13232-13241). To our knowledge phase precession for speeds above 1.2 m/s has not been reported so far at all, certainly also owing to experimental challenges. We, however, would speculate that beyond 120 cm/s phase precession could be meaningful in large environmental enclosures with wide place cells. Thus a version of our input model with very large place field sizes should generally be able to also cover very high running speeds.</p><p>To conclude, STD and STF time constants do not need to be in a precise range to accommodate the behavioural time scales if the sensory input changes on accordingly larger spatial scales.</p><p>Following up on the reviewer’s additional concern, we also checked the effect of time constants on the theta sequences (while keeping the running speed unchanged). Decreasing the time constant of STF (τF) to 100ms would degrade the theta sequence due to a lack of depolarization, as sensory input reverts to its resting value (=0) too fast, but at 250ms, the temporal correlation of theta sequences is largely maintained (Figure 3—figure supplement 1A). However, such effects can be compensated for by an increase in sensory input which promotes input facilitation (Figure 3—figure supplement 1B). Further increasing τF does not significantly affect theta sequences as the sensory input amplitude have asymptotically reached their target values (Figure 3—figure supplement 1A bottom). The temporal correlation of theta sequences is not sensitive to the change in the time constant of STD (τD) (Figure 3—figure supplement 1C), possibly because the synaptic resource of the place cells behind the animal is reliably depleted by strong depolarization despite a fast recovery time (τD=100ms).</p><p>Since the relation between running speed and theta sequences has been thoroughly studied in Parra-Barrero et al. 2021 and Parra-Barrero &amp; Cheng 2023, and the precise range of STD and STF time scales does not play a critical role in the temporal structure of theta sequence, we refrain from substantially revising the manuscript and only briefly add these points after Figure 3.</p><disp-quote content-type="editor-comment"><p>1. This is a point I overlooked in the initial review. The synaptic depression fraction UD is set at 0.9 or 0.7, implying that the synaptic coupling weight between CA3 excitatory cells (and CA3 to DG) is almost entirely depleted within a few hundred milliseconds. To my limited neuroscience knowledge, I am not aware of any experimental results that corroborate this potentially bold setup, and I urge the authors to provide relevant experimental and theoretical references if they exist.</p><p>Most crucially, I find this setup biased towards supporting the authors’ theory for intrinsic sequences because it essentially eliminates the possibility of any CA3 cell producing an effective output to other neurons after it fires. Hence, I question whether the simulation results would be much less clean if a more moderate depression factor UD were utilized.</p></disp-quote><p>We thank the reviewer for giving us the opportunity to further clarify. (1) Probabilties of synaptic release (here called UD for consistency with the original work by Romani and Tsodyks), can attain a very wide range and indeed achieve values up to 0.9 (for review see e.g. Dobrunz LE, Stevens CF, 1997, Neuron, 18: 995-1008). (2) Contrary to the reviewer’s impression, a higher UD (0.7-0.9 in our case) would bias the simulation towards even more extrinsicity. Larger UD produces steeper phase precession in extrinsic sequences, because it (temporarily) generates an even stronger asymmetrical connectivity. (3) The extreme value of 0.9 was only used in Figure 1 to best illustrate the original Romani and Tsodyks 2015 idea. (4) Our simulations without recurrent synaptic connections (Figure 6) do not even require short-term synaptic depression. In view of these arguments we refrained from making further additions to the paper and refer the critical reader to this comment.</p><disp-quote content-type="editor-comment"><list list-type="bullet"><list-item><p>I have a few final suggestions for the authors in the hopes of further improving the manuscript for the neuroscience community:</p></list-item></list><list list-type="bullet"><list-item><p>line 62: sensorimotor input is present or ABSENT?</p></list-item></list></disp-quote><p>Intrinsic activity signatures are found ”EVEN when sensorimotor feedback is present”, as one may assume that this input may be able to completely override the intrinsic patterns.</p><disp-quote content-type="editor-comment"><list list-type="bullet"><list-item><p>line 76: played out. colloquial, consider rewriting/explaining</p></list-item></list></disp-quote><p>We use ”evoked” now.</p><disp-quote content-type="editor-comment"><list list-type="bullet"><list-item><p>line 104: second part of motivation for Izhikevich-type model is wordy, and grammatically incorrect.</p></list-item></list></disp-quote><p>We have shortened the sentence.</p><disp-quote content-type="editor-comment"><list list-type="bullet"><list-item><p>on potential limitations of the model lines 116-120: is the use of a box an important assumption, as opposed to a more graded function, exponential or gaussian?</p></list-item></list></disp-quote><p>Using-spike based input, it is not straight-forward how to implement a graded input. One way would be to employ a stochastic point process with graded firing probability. We, however, chose to use a nonlinear facilitation function (see below).</p><disp-quote content-type="editor-comment"><list list-type="bullet"><list-item><p>line 124 (equation) and 129-130: How crucial is the non-linearity in the synaptic variable for the results? This is a strong assumption, as the nonlinearity is the dominant effect (as opposed to a correction/perturbation). Are there any other contributions for this ramp of activity due to sensory input?</p></list-item></list></disp-quote><p>We found results to fit best with a non-linear facilitation function (see above), and, as argued in the manuscript, facilitation indeed acts non-linearly owing to the calcium-dependence of synaptic release. We have added a comment to the Methods section explaining that we use facilitation to generate a graded spatial input.</p><disp-quote content-type="editor-comment"><list list-type="bullet"><list-item><p>line 187: ’...neglecting gamma activity in the model.’ I suggest removing this part of the sentence, unless you motivate why gamma would be relevant and the conditions for its generation.</p></list-item></list></disp-quote><p>We have followed the reviewer’s suggestion.</p></body></sub-article></article>