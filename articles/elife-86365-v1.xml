<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">86365</article-id><article-id pub-id-type="doi">10.7554/eLife.86365</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>BrainPy, a flexible, integrative, efficient, and extensible framework for general-purpose brain dynamics programming</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-304257"><name><surname>Wang</surname><given-names>Chaoming</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-307856"><name><surname>Zhang</surname><given-names>Tianqiu</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-307857"><name><surname>Chen</surname><given-names>Xiaoyu</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-348088"><name><surname>He</surname><given-names>Sichao</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-307858"><name><surname>Li</surname><given-names>Shangyang</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-126841"><name><surname>Wu</surname><given-names>Si</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9650-6935</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><institution content-type="dept">School of Psychological and Cognitive Sciences</institution>, <institution>Peking University</institution>, <addr-line><named-content content-type="city">Beijing</named-content></addr-line>, <country>China</country></aff><aff id="aff2"><institution>Beijing Jiaotong University</institution>, <addr-line><named-content content-type="city">Beijing</named-content></addr-line>, <country>China</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor" id="author-82268"><name><surname>Stimberg</surname><given-names>Marcel</given-names></name><role>Reviewing editor</role><aff><institution>Institut de la Vision</institution>, <country>France</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><label>*</label>For correspondence: <email>siwu@pku.edu.cn</email> (SW);</corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>22</day><month>12</month><year>2023</year></pub-date><volume>12</volume><elocation-id>e86365</elocation-id><history><date date-type="received"><day>21</day><month>01</month><year>2023</year></date><date date-type="accepted"><day>20</day><month>12</month><year>2023</year></date></history><permissions><copyright-statement>Â© 2023, Wang et al</copyright-statement><copyright-year>2023</copyright-year><copyright-holder>Wang et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link> permitting unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-86365-v1.pdf"/><abstract><p>Elucidating the intricate neural mechanisms underlying brain functions requires integrative brain dynamics modeling. To facilitate this process, it is crucial to develop a general-purpose programming framework that allows users to freely define neural models across multiple scales, efficiently simulate, train, and analyze model dynamics, and conveniently incorporate new modeling approaches. In response to this need, we present BrainPy. BrainPy leverages the advanced just-in-time (JIT) compilation capabilities of JAX and XLA to provide a powerful infrastructure tailored for brain dynamics programming. It offers an integrated platform for building, simulating, training, and analyzing brain dynamics models. Models defined in BrainPy can be JIT compiled into binary instructions for various devices, including Central Processing Unit (CPU), Graphics Processing Unit (GPU), and Tensor Processing Unit (TPU), which ensures high running performance comparable to native C or CUDA. Additionally, BrainPy features an extensible architecture that allows for easy expansion of new infrastructure, utilities, and machine-learning approaches. This flexibility enables researchers to incorporate cutting-edge techniques and adapt the framework to their specific needs</p></abstract><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100007937</institution-id><institution>Peking University</institution></institution-wrap></funding-source><award-id>2021ZD0200204</award-id><principal-award-recipient><name><surname>Wu</surname><given-names>Si</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group></article-meta></front><back><sec id="s1" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interest</title><fn fn-type="conflict" id="conf1"><p>The authors declare that no competing interests exist.</p></fn></fn-group></sec><sec id="s2" sec-type="supplementary-material"><title>Additional Files</title><sec id="s3" sec-type="data-availability"><title>Data availability</title><p>BrainPy is distributed via the pypi package index (https://pypi.org/project/brainpy/) and is publicly released on GitHub (https://github.com/brainpy/BrainPy/) under the license of GNU General Public License v3.0. Its documentation is hosted on the free documentation hosting platform Read the Docs (https://brainpy.readthedocs.io/). Rich examples and illustrations of BrainPy are publicly available at the website of https://brainpy-examples.readthedocs.io/. The source codes of these examples are available at https://github.com/brainpy/examples/. All the codes to reproduce the results in the paper can be found at the following GitHub repository: https://github.com/brainpy/brainpy-paper-reproducibility/.</p><p>The following previously published datasets were used:</p><p><element-citation id="dataset1" publication-type="data" specific-use="references"><person-group person-group-type="author"><collab>Markov NT</collab><collab>et al</collab></person-group><year iso-8601-date="2012">2012</year><source>A Weighted and Directed Interareal Connectivity Matrix for Macaque Cerebral Cortex</source><ext-link ext-link-type="uri" xlink:href="https://core-nets.org/download/a-weighted-and-directed-interareal-connectivity-matrix-for-macaque-cerebral-cortex-cereb-cortex-2014-jan24117-36-epub-2012-sep-25/?tmstv=1698302028">https://core-nets.org/download/a-weighted-and-directed-interareal-connectivity-matrix-for-macaque-cerebral-cortex-cereb-cortex-2014-jan24117-36-epub-2012-sep-25/?tmstv=1698302028</ext-link><comment>https://core-nets.org, A weighted and directed interareal connectivity matrix for macaque cerebral cortex. Cereb Cortex. 2014 Jan;24(1):17-36. Epub 2012 Sep 25</comment></element-citation></p></sec></sec></back></article>