<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN"  "JATS-archivearticle1-3-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">101111</article-id><article-id pub-id-type="doi">10.7554/eLife.101111</article-id><article-id pub-id-type="doi" specific-use="version">10.7554/eLife.101111.3</article-id><article-version article-version-type="publication-state">version of record</article-version><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>A deep learning approach for the analysis of birdsong</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><name><surname>Koch</surname><given-names>Therese MI</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5327-3219</contrib-id><email>therese.koch1@gmail.com</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Marks</surname><given-names>Ethan S</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0009-0004-4415-9889</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Roberts</surname><given-names>Todd F</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0967-6598</contrib-id><email>todd.roberts@utsouthwestern.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05byvp690</institution-id><institution>Department of Neuroscience, UT Southwestern Medical Center</institution></institution-wrap><addr-line><named-content content-type="city">Dallas</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Goldberg</surname><given-names>Jesse H</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05bnh6r87</institution-id><institution>Cornell University</institution></institution-wrap><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>King</surname><given-names>Andrew J</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/052gg0110</institution-id><institution>University of Oxford</institution></institution-wrap><country>United Kingdom</country></aff></contrib></contrib-group><pub-date publication-format="electronic" date-type="publication"><day>18</day><month>11</month><year>2025</year></pub-date><volume>13</volume><elocation-id>RP101111</elocation-id><history><date date-type="sent-for-review" iso-8601-date="2024-07-09"><day>09</day><month>07</month><year>2024</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint.</event-desc><date date-type="preprint" iso-8601-date="2024-08-24"><day>24</day><month>08</month><year>2024</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2024.05.10.593561"/></event><event><event-desc>This manuscript was published as a reviewed preprint.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2024-09-12"><day>12</day><month>09</month><year>2024</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.101111.1"/></event><event><event-desc>The reviewed preprint was revised.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2025-10-01"><day>01</day><month>10</month><year>2025</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.101111.2"/></event></pub-history><permissions><copyright-statement>© 2024, Koch et al</copyright-statement><copyright-year>2024</copyright-year><copyright-holder>Koch et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-101111-v1.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-101111-figures-v1.pdf"/><abstract><p>Deep learning tools for behavior analysis have enabled important insights and discoveries in neuroscience. Yet, they often compromise interpretability and generalizability for performance, making quantitative comparisons across datasets difficult. We developed a novel deep learning-based behavior analysis pipeline, Avian Vocalization Network (AVN), for zebra finch learned vocalizations - the most widely studied vocal learning model species. AVN annotates songs with high accuracy, generalizing across multiple animal colonies without re-training, and generates a comprehensive set of interpretable features describing song syntax, timing, and acoustic properties. We use this feature set to compare song phenotypes across research groups and experiments and to predict a bird’s stage in song development. Additionally, we have developed a novel method to measure song imitation that requires no training data for new comparisons and outperforms existing similarity scoring methods in its sensitivity and agreement with expert human judgements. These tools are available through the open-source AVN python package and graphical application, making them accessible to researchers without prior coding experience. Altogether, this behavior analysis toolkit stands to accelerate the study of vocal behavior by standardizing phenotype and learning outcome mapping, thus helping scientists better link behavior to the underlying neural processes.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>zebra finch</kwd><kwd>behavioral analaysis</kwd><kwd>birdsong</kwd><kwd>deep learning</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Other</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01cwqze88</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>R01 DC020333</award-id><principal-award-recipient><name><surname>Roberts</surname><given-names>Todd F</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05byvp690</institution-id><institution>The University of Texas Southwestern Medical Center</institution></institution-wrap></funding-source><award-id>Neural Scientist Training Program</award-id><principal-award-recipient><name><surname>Koch</surname><given-names>Therese MI</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="ror">https://ror.org/049emcs32</institution-id><institution>The University of Texas at Dallas</institution></institution-wrap></funding-source><award-id>UTSW Green Fellow's Program</award-id><principal-award-recipient><name><surname>Marks</surname><given-names>Ethan S</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>An open-source deep learning toolkit performs accurate annotation and similarity scoring of zebra finch song, along with comprehensive feature extraction, enabling consistent, interpretable comparisons of vocal phenotypes across research groups.</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>publishing-route</meta-name><meta-value>prc</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>A deep understanding of animal behavior is fundamental to a deep understanding of the brain. However, an accurate, quantitative description of animal behavior, particularly in ethologically relevant contexts, remains a substantial challenge in neuroscience research. In recent years, careful observation of motor and vocal behaviors is increasingly being replaced with machine learning and deep-learning-based approaches. These tools allow researchers to consider much greater volumes of data than was previously possible and uncover patterns in animal behavior that are undetectable to humans and have led to important insights into ethologically relevant behaviors and the effects of experimental interventions thereupon (<xref ref-type="bibr" rid="bib48">Wiltschko et al., 2020</xref>; <xref ref-type="bibr" rid="bib14">Hsu and Yttri, 2021</xref>; <xref ref-type="bibr" rid="bib1">Alam et al., 2024</xref>). However, this increased power often comes at the expense of interpretability and generalizability.</p><p>An increasing number of supervised deep learning methods are being developed for the automated annotation of animal vocalization behavior (<xref ref-type="bibr" rid="bib39">Steinfath et al., 2021</xref>; <xref ref-type="bibr" rid="bib5">Cohen et al., 2022</xref>; <xref ref-type="bibr" rid="bib12">Gu et al., 2023</xref>; <xref ref-type="bibr" rid="bib4">Coffey et al., 2019</xref>), and unsupervised methods for dimensionality reduction and analysis (<xref ref-type="bibr" rid="bib1">Alam et al., 2024</xref>; <xref ref-type="bibr" rid="bib10">Goffinet et al., 2021</xref>; <xref ref-type="bibr" rid="bib3">Brudner et al., 2023</xref>; <xref ref-type="bibr" rid="bib34">Sainburg et al., 2020</xref>; <xref ref-type="bibr" rid="bib32">Roeser, 2023</xref>). While unsupervised approaches are very powerful and have been shown to explain more variance in vocalization repertoires than hand-selected acoustic features (<xref ref-type="bibr" rid="bib10">Goffinet et al., 2021</xref>), the features that they generate are notoriously difficult to interpret and specific to the exact dataset from which they were derived (<xref ref-type="bibr" rid="bib1">Alam et al., 2024</xref>; <xref ref-type="bibr" rid="bib10">Goffinet et al., 2021</xref>; <xref ref-type="bibr" rid="bib3">Brudner et al., 2023</xref>). As a result, unsupervised data-driven methods, while allowing detailed comparison of individuals within the same data set, make it more difficult to compare the nature and severity of vocal phenotypes across experiments and research groups.</p><p>To truly maximize the benefits of machine learning and deep learning methods for behavior analysis, their power must be balanced with interpretability and generalizability. This can be achieved by combining automated annotation with a carefully selected set of meaningful features, thereby creating a common feature space for the comparison of behavioral phenotypes across research groups, experimental conditions, and studies. For speed, ease of use, and standardization, the annotations should be generated without the need for any training data or hyperparameter setting for new individuals or recording conditions. The features should be consistent across recording conditions, allowing direct, meaningful comparisons between research groups. The feature set should be comprehensive, describing multiple aspects of the behavior. Finally, the features should be interpretable, allowing researchers to form concrete hypotheses about how different manipulations will affect specific features and use observed feature values to guide future experimental design.</p><p>We have developed an analysis pipeline called <italic>Avian Vocalization Network (AVN</italic>) which satisfies these criteria for zebra finch song analysis. Zebra finches are the most popular animal model for the study of vocal learning. They learn to sing a single, highly stereotyped song by memorizing the song of an adult tutor, then refining their vocalizations to match this song template during a sensorimotor learning period early in development (<xref ref-type="fig" rid="fig1">Figure 1a</xref>); a process which bears many parallels to human speech learning (<xref ref-type="bibr" rid="bib7">Doupe and Kuhl, 1999</xref>). Typical zebra finch songs consist of a variable number of introductory notes, followed by multiple repetitions of a motif, composed of 3–10 unique syllable types produced in a stereotyped sequence. Traditionally, zebra finch song has been analyzed by segmenting the song into syllables, then manually labeling syllables based on visual inspection of their spectrograms (<xref ref-type="bibr" rid="bib22">Lachlan et al., 2016</xref>; <xref ref-type="bibr" rid="bib42">Tchernichovski and Nottebohm, 1998</xref>; <xref ref-type="bibr" rid="bib36">Scharff and Nottebohm, 1991</xref>). This process is very labor-intensive, which limits the number of songs that can be considered at a time. Manual syllable labeling and motif identification can also be subjective and therefore susceptible to experimenter bias, as motif composition and syllable types can be somewhat ambiguous, particularly in young birds with immature song and in birds with experimentally disrupted songs.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Overview of AVN song analysis pipeline.</title><p>(<bold>a</bold>) Schematic timeline of zebra finch song learning. (<bold>b</bold>) Overview of AVN song analysis pipeline. Spectrograms of songs are automatically segmented into syllables, then syllables are labeled. The raw spectrograms are used to calculate features describing the rhythm of a bird’s song, the segmentations are used to calculate syllable-level timing features, and the labeled syllables are used to calculate syntax-related features and acoustic features of a bird’s song. (<bold>c</bold>). Birds from different research groups, with multiple different song phenotypes can all be processed by the AVN pipeline, generating a matrix of directly comparable, interpretable features, which can be used for downstream analyses including phenotype comparisons, tracking the emergence of a phenotype over time, investigating song development, and detecting individual outlier birds with atypical song phenotypes.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-101111-fig1-v1.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>AVN graphical application examples.</title><p>Screenshots of the AVN graphical application, showing (<bold>a</bold>) how syllable labels can be generated from a table of syllable segmentations, including visual inspection of labels overlaid on a spectrogram, (<bold>b</bold>) how the complete AVN feature set can be generated from a table of labeled syllables with a single click, and (<bold>c</bold>) how users can adjust different hyperparameters pertaining to spectrogram generation of feature calculations, with all hyperparameters clearly explained. Hyperparameters can also be saved and loaded from files, to encourage reproducibility of analyses.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-101111-fig1-figsupp1-v1.tif"/></fig></fig-group><p>We tested and compared two deep-learning approaches for syllable segmentation, which don’t require any additional training data or hyperparameter setting for new birds. These were WhisperSeg (<xref ref-type="bibr" rid="bib13">Gu et al., 2024</xref>) and a novel application of Tweetynet (<xref ref-type="bibr" rid="bib5">Cohen et al., 2022</xref>). We then applied unsupervised dimensionality reduction and clustering methods to assign labels to these automatically segmented syllables, as in <xref ref-type="bibr" rid="bib34">Sainburg et al., 2020</xref>, and used thorough validation approaches to examine how these unsupervised methods perform when combined with the segmentation approaches. Finally, we use the resulting annotated songs to calculate a set of 55 interpretable features which describe the syntax, timing, and acoustic properties of a set of songs (<xref ref-type="fig" rid="fig1">Figure 1b</xref>). We show that the automated annotation performs consistently well across multiple zebra finch colonies, and that the feature set can be used to glean mechanistic insights from the comparison of vocal phenotypes, and to predict a bird’s stage in song development (<xref ref-type="fig" rid="fig1">Figure 1c</xref>). We also developed a new method to compare two birds’ syllable repertoires to measure song learning, which outperforms existing song similarity scoring methods on multiple key metrics. The complete pipeline is available as an open-source Python package and as an application with a graphical user interface, allowing researchers with no prior coding experience to easily annotate their songs, calculate the feature set, and calculate song similarity scores (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>).</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Comparing deep learning methods for fully automated syllable segmentation</title><p>To accurately segment and label zebra finch songs without the need for any individual-specific training data or hyperparameter tuning, we tested and compared two different deep-learning-based approaches for syllable segmentation. Traditionally, zebra finch song is segmented based on an amplitude threshold (<xref ref-type="bibr" rid="bib34">Sainburg et al., 2020</xref>; <xref ref-type="bibr" rid="bib19">Koumura and Okanoya, 2016</xref>). The best value for this amplitude threshold depends heavily on recording conditions and background noise levels, and setting this threshold often requires careful trial and error by a human annotator. Amplitude-based segmentation methods also cannot distinguish between song syllables and noises, like wing flaps or other non-vocal artifacts, which can contaminate downstream analyses. Instead of relying on amplitude alone, we compared two deep learning models, TweetyNet (<xref ref-type="bibr" rid="bib5">Cohen et al., 2022</xref>) and WhisperSeg (<xref ref-type="bibr" rid="bib13">Gu et al., 2024</xref>), which take the full spectral content of the audio into account when performing segmentation.</p><p>We tested these two segmentation methods with a dataset of over 1,000 manually annotated songs from 35 adult zebra finches, including birds with typical song production, isolate birds raised without a song tutor, and birds with disrupted song production due to knockdown of the transcription factor FoxP1 (FP1) in the song nucleus HVC (<xref ref-type="bibr" rid="bib9">Garcia-Oscos et al., 2021</xref>). The annotation consists of manual correction of amplitude-segmented syllables and assignment of syllable labels based on the appearance of the spectrograms by expert annotators. TweetyNet was designed to simultaneously segment and label syllable types by assigning syllable labels to short spectrogram frames. This application requires re-training for each individual bird, so we instead trained TweetyNet to label spectrogram frames as simply containing vocalizations, silence, or noise. We trained it with 34 of the 35 birds in the dataset and evaluated segmentation accuracy with the remaining bird, repeating this once for each bird in the dataset. This novel approach allows the model to learn an abstract notion of vocalization vs. non-vocalization that generalizes well to new individuals not included in training. The WhisperSeg model is already trained for segmentation of new individuals, so we used the existing standard model to segment each of our birds. Segmentation accuracy was evaluated against expert human annotations by calculating the precision, recall, and F1 scores of syllable onset detections within 10 ms of a syllable onset in the manual annotations.</p><p>WhisperSeg shows the best performance, with a mean F1 score of 0.882 (± SEM 0.02), compared to TweetyNet’s score of 0.824 (± SEM 0.03) and a simple amplitude segmentation algorithm (RMSE) with a mean score of 0.593 (± SEM 0.02; <xref ref-type="fig" rid="fig2">Figure 2a</xref>). WhisperSeg’s precise onset times were also more consistent with expert human annotations than both other methods (median absolute time difference of 1.75 ms for WhisperSeg, 2.22 ms for TweetyNet, and 3.81 ms for RMSE; <xref ref-type="fig" rid="fig2">Figure 2b</xref>). All three methods performed similarly for the typical, isolate, and FP1 KD birds (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1a–f</xref>). As a further test of the generalization of these methods, we applied them to a dataset of manually annotated songs from 25 birds from the Rockefeller University Field Research Center Song Library (<xref ref-type="bibr" rid="bib44">Tchernichovski et al., 2021</xref>). Using the pre-trained WhisperSeg model and a TweetyNet model trained on all 35 birds from the UTSW colony and none from the Rockefeller Song Library, each of these models yielded very similar segmentation accuracy scores to those obtained with the UTSW colony (<xref ref-type="fig" rid="fig2">Figure 2a and c</xref>; <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplements 1</xref>–<xref ref-type="fig" rid="fig2s2">2</xref>).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Automated syllable annotation metrics.</title><p>(<bold>a</bold>) F1 scores for syllable onset detections within 10 ms of a syllable onset in the manual annotations of each bird (n=35 from UTSW and n=25 from Rockefeller) across segmentation methods. (<bold>b</bold>) Distribution of time differences between predicted syllable onsets and their best matches in the manual annotation, across segmentation methods. Distributions include all matched syllables across all 35 birds from the UT Southwestern colony (UTSW) and (<bold>c</bold>) 25 from Rockefeller. (<bold>d</bold>) Example spectrogram of a typical adult zebra finch. The song was segmented with WhisperSeg and labeled using UMAP and HDBSCAN clustering. Colored rectangles reflect the labels of each syllable. (<bold>e</bold>) Example UMAP plot of 3131 syllables from the same bird as in <bold>d </bold>and<bold> f</bold>. Each point represents one syllable segmented with WhisperSeg, and colors reflect the AVN label of each syllable. (<bold>f</bold>) Example confusion matrix for the bird depicted in<bold> d </bold>and <italic><bold>e</bold></italic>. The matrix shows the percentage of syllables bearing each manual annotation label which fall into each of the possible AVN labels. (<bold>g</bold>) V-measure scores for AVN syllable labels compared to manual annotations for each bird (n=35 from UTSW and n=25 from Rockefeller), across segmentation methods.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-101111-fig2-v1.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Syllable onset detection accuracy across methods.</title><p>(<bold>a–c</bold>) The precision, recall, and F1 scores for syllable onset predictions within 10 ms of a syllable onset in the manual annotation for each bird (n=20 typical birds, 8 isolate birds, and 7 FP1 KD birds) across segmentation methods. (<bold>e, f</bold>) The precision, recall, and F1 scores for syllable offset predictions within 20 ms of a syllable offset in the manual annotation for each bird (n=20 typical birds, 8 isolate birds, and 7 FP1 KD birds) across segmentation methods. (<bold>g</bold>) Distribution of time differences between predicted syllable offsets and their best matches in the manual annotation, across segmentation methods. Distributions include all matched syllables across all 35 birds from UTSW.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-101111-fig2-figsupp1-v1.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Syllable offset detection accuracy for Rockefeller song library birds.</title><p>(<bold>a–c</bold>) The precision, recall, and F1 scores for syllable offset predictions within 20 ms of a syllable offset in the manual annotation for each bird (n=25 typical birds from the Rockefeller song library) across segmentation methods. (<bold>d</bold>) Distribution of time differences between predicted syllable offsets and their best matches in the manual annotation, across segmentation methods. Distributions include all matched syllables across all 25 birds from Rockefeller.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-101111-fig2-figsupp2-v1.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 3.</label><caption><title>Additional AVN labeling examples.</title><p>(<bold>a, d</bold>) Example UMAP plot of syllables from a typical adult zebra finch. Each point represents a syllable, colored according to their AVN label. (<bold>b. e</bold>) Confusion matrix showing the proportion of syllables bearing each manual annotation label which fall into each of the possible AVN labels for an example typical adult zebra finch. AVN label 1000 refers to syllables which were not segmented correctly by WhisperSeg, and therefore don’t carry an AVN label. Hand label ‘x’ refers to ‘syllables’ which were segmented by WhisperSeg, but don’t have a counterpart in the manual annotation. (<bold>c, f</bold>) Example spectrogram of a song bout produced by a typical adult zebra finch, with overlaid AVN syllable labels.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-101111-fig2-figsupp3-v1.tif"/></fig><fig id="fig2s4" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 4.</label><caption><title>AVN labeling consistency.</title><p>(<bold>a, b</bold>) Four replicate UMAP embeddings with different random initializations, and the corresponding clustering validation for each of two different birds. (<bold>c</bold>) The standard deviation of v-measure scores for each bird (n=35, 20 typical birds, 8 isolate birds, and 7 FP1 KD birds from the UTSW colony) across 30 different random initializations for UMAP dimensionality reduction and HDBSCAN clustering. Despite the stochasticity inherent in UMAP embeddings, the clustering and accuracy of the clustering is very consistent within each bird.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-101111-fig2-figsupp4-v1.tif"/></fig><fig id="fig2s5" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 5.</label><caption><title>Syllable labeling metrics across bird conditions.</title><p>(<bold>a–c</bold>) The homogeneity, completeness, and v-measures scores for AVN labels compared to manual annotations for each bird (n=20 typical birds, 8 isolate birds, and 7 FP1 KD birds), across segmentation methods.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-101111-fig2-figsupp5-v1.tif"/></fig></fig-group></sec><sec id="s2-2"><title>Accurate, fully unsupervised syllable labeling</title><p>Next, we assign syllable labels to these segmented units. To achieve this, we first performed UMAP dimensionality reduction (<xref ref-type="bibr" rid="bib26">McInnes et al., 2018</xref>) on spectrograms of the segmented syllables, then performed hierarchical density-based clustering (HDBSCAN; <xref ref-type="bibr" rid="bib25">McInnes and Healy, 2017</xref>) on the syllables’ UMAP embeddings, as in <xref ref-type="bibr" rid="bib34">Sainburg et al., 2020</xref>. We calculated the UMAP embeddings of all segmented syllables for each of the 35 birds in our dataset using manual segmentations, WhisperSeg, or TweetyNet segmentations. In all cases, we found that the syllables formed multiple dense clusters, which corresponded well to manually annotated syllable labels (<xref ref-type="fig" rid="fig2">Figure 2d–g</xref>; <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>).</p><p>Using manual segmentation yielded the best agreement with manual labels (mean v-measure score = 0.87 +- 0.01), which is to be expected, as no discrepancies are introduced during segmentation (<xref ref-type="fig" rid="fig2">Figure 2g</xref>). When clustered, WhisperSeg’s segments yielded better agreement with manual labels than TweetyNet’s (WhisperSeg mean v-measure = 0.80 +- 0.02, TweetyNet’s mean v-measure = 0.77 +– 0.02). We observe similar performance on our second dataset of 25 typical adult zebra finches from the Rockefeller Song Library, suggesting that these methods generalize well across colonies and recording environments (<xref ref-type="fig" rid="fig2">Figure 2g</xref>). UMAP embeddings have an inherent stochasticity, meaning that running this embedding and clustering multiple times on the same dataset will result in slight changes to the embeddings and labels across runs. To measure the degree of these changes, we calculated the v-measure score for clustering labels for each of 30 different random initializations of the UMAP embedding for each of 25 birds from the UTSW colony and found negligible variation in the v-measure score across runs (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>).</p><p>Most of the errors in TweetyNet’s syllable labeling stem from inconsistencies in syllable segmentation. For example, if two syllables with labels ‘a’ and ‘b’ in the manual annotation are segmented sometimes as separate syllables and sometimes as a merged syllable ‘ab’, the clustering is likely to find 3 different syllables clusters: one for ‘a’, one for ‘b’, and one for the combined ‘ab’. Because of how we align syllables across segmentations for validation, syllable ‘b’ will sometimes carry one cluster label and sometimes carry the missing segment label, whereas syllable ‘a’ can carry two different clustering labels: one for ‘a’ and one for the ‘ab’ segmentation. This scenario would result in a lower completeness score (a measure of the extent to which syllables with the same manual annotation also carry the same cluster label) without any impact on the homogeneity score (a measure of the extent to which syllables with the same cluster label carry the same manual annotation). Consistent with this, Tweetynet segmentation results in higher homogeneity scores for typical birds than WhisperSeg, but lower completeness scores (<xref ref-type="fig" rid="fig2s5">Figure 2—figure supplement 5</xref>).</p><p>In cases where it is somewhat ambiguous as to whether syllables should be segmented separately (‘a’ and ‘b’) vs. merged (‘ab’), WhisperSeg is much more likely to merge them than is Tweetynet, resulting in a lower homogeneity score when the manual annotation has the syllables segmented separately. However, WhisperSeg will be more consistent in its choice to merge or split than Tweetynet within the same bird, which accounts for WhisperSeg’s higher completeness score (<xref ref-type="fig" rid="fig2s5">Figure 2—figure supplement 5</xref>). WhisperSeg’s internal consistency in this regard also results in less artifactual inflation of downstream syntax and syllable duration variability metrics, making it the better overall choice for syllable segmentation in the context of AVN.</p><p>Altogether, we conclude that WhisperSeg followed by UMAP-HDBSCAN clustering produces the most accurate syllable labels. These will be referred to as AVN labels henceforth in this manuscript. AVN labels are produced without the need for any per-bird parameter tuning or model training. This approach not only saves experimenters time when analyzing many birds but also reduces the potential for experimenter bias during song annotation. AVN labeling generalizes well across multiple zebra finch colonies, suggesting that it can be easily adopted by new research groups without the need for extensive additional validation. Thus, we hope it can serve as a standard for song annotations when manual annotation is not required.</p></sec><sec id="s2-3"><title>Analyzing song syntax</title><p>The automatically generated AVN labels can be used to visualize and quantify a bird’s song syntax. Typical zebra finches produce syllables in a very predictable order, where the syllable type that a bird will sing can be reliably predicted based on the immediately preceding syllable type (<xref ref-type="bibr" rid="bib36">Scharff and Nottebohm, 1991</xref>; <xref ref-type="bibr" rid="bib15">Hyland Bruno and Tchernichovski, 2019</xref>). Many studies have found that manipulations of the neural circuitry underlying song learning and production can disrupt a bird’s syntax, leading to more variable sequences (<xref ref-type="bibr" rid="bib36">Scharff and Nottebohm, 1991</xref>; <xref ref-type="bibr" rid="bib9">Garcia-Oscos et al., 2021</xref>; <xref ref-type="bibr" rid="bib49">Xiao et al., 2021</xref>; <xref ref-type="bibr" rid="bib41">Tanaka et al., 2016</xref>). Methods used to quantify these syntax disruptions vary across papers and research groups, making it impossible to directly compare the severity of disruptions. We propose a comprehensive suite of features to describe a bird’s song syntax, which can all be calculated using the AVN Python package and AVN graphical application.</p><p>First, we developed a new song syntax visualization, called a <italic>syntax raster plot,</italic> which lets researchers view many song bouts’ syllable sequences simultaneously (<xref ref-type="fig" rid="fig3">Figure 3a</xref>). We can also visualize syntax using a transition matrix, which gives the probability of a syllable type being produced, given the preceding syllable type (<xref ref-type="fig" rid="fig3">Figure 3b</xref>). We quantify the stereotypy of a bird’s syntax by calculating the entropy rate of the transition matrix and find a strong correlation (<italic>r</italic>=0.89, p&lt;0.05) between entropy rates calculated using AVN labels and manual annotations, showing that our AVN labels are sufficiently reliable to describe a bird’s syntax stereotypy (<xref ref-type="fig" rid="fig3">Figure 3c</xref>). We also find the same statistical relationship between groups as with manual annotations, namely that birds with FP1 KD and isolate birds have significantly higher entropy rates than typical birds (One-way ANOVA F(2, 32)=15.05, Tukey HSD p-adj FP1 vs. typical &lt;0.005, p-adj isolate vs. typical &lt;0.005; <xref ref-type="fig" rid="fig3">Figure 3d</xref>; <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1a–d</xref>). Multiple studies have also found that neural song-circuit manipulations can induce a ‘stutter’ in birds, that is increase the rate of syllable repetitions in their songs (<xref ref-type="bibr" rid="bib35">Sánchez-Valpuesta et al., 2019</xref>; <xref ref-type="bibr" rid="bib31">Norton et al., 2019</xref>; <xref ref-type="bibr" rid="bib20">Kubikova et al., 2014</xref>), so we’ve introduced two additional metrics to specifically look at the rate of syllable repetitions in a bird’s song; the mean number of times a syllable is produced in a row each time it is sung (repetition bout length), and the CV of the number of syllable repetitions (CV repetition bout length; <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1e–f</xref>).</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Song syntax and timing analysis with AVN.</title><p>(<bold>a</bold>) Example syntax raster plot for a typical adult zebra finch made with AVN labels. Each row represents a song bout, and each colored block represents a syllable, colored according to its AVN label. (<bold>b</bold>) Example transition matrix from the bird featured in <bold>a</bold>. Each cell gives the probability of the bird producing the ‘following syllable’, given that they just produced a syllable with the ‘preceding syllable’ label. (<bold>c</bold>) Correlation between normalized entropy rate scores calculated for each bird using manual annotations or AVN labels (n=35 birds from UTSW, <italic>r</italic>=0.89, p&lt;0.005). (<bold>d</bold>) Comparison of normalized entropy rates calculated with AVN labels across typical (n=20), isolate (n=8), and FP1 KD (n=7) adult zebra finches (One-Way ANOVA F(2, 32)=15.05, p&lt;0.005, Tukey HSD * indicates p-adj &lt;0.005). (<bold>e</bold>) Schematic representing the generation of rhythm spectrograms. The amplitude trace of each song file is calculated, then the spectrum of the first derivative of the amplitude trace is computed. The spectra of multiple song files are concatenated to form a rhythm spectrogram, with bout index on the x-axis and frequency along the y axis. The example rhythm spectrograms show the expected banding structure of a typical adult zebra finch, and the less structured rhythm of a typical juvenile zebra finch (50 dph). (<bold>f</bold>) Comparison of rhythm spectrum entropies across typical (n=20), isolate (n=8), FP1 KD (n=7) adult zebra finches (&gt;90 dph), and juvenile zebra finches (n=11, 50-51 dph; One-Way ANOVA F(3, 43)=17.0, p&lt;0.05, Tukey HSD * indicates p-adj &lt;0.05).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-101111-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Additional syntax examples and metrics.</title><p>(<bold>a, b</bold>) Example Syntax Raster plot for (<bold>a</bold>) an example FP1 KD zebra finch with disrupted syntax, and (<bold>b</bold>) a typical adult zebra finch with stereotyped syntax, made using AVN labels. (<bold>c, d</bold>) Transition matrix of an example (<bold>c</bold>) FP1 KD zebra finch with disrupted syntax, and (<bold>d</bold>) a typical adult zebra finch with stereotyped syntax, made using AVN labels. Cells represent the probability of the bird producing a ‘following syllable’ with a particular label, given that the last syllable produced belonged to the type ‘preceding syllable’. (<bold>e</bold>) Mean repetition bout lengths (number of times a syllable is produced in a row each time it is sung) for the syllable type with the highest mean repetition bout length per bird (n=20 typical birds, 8 isolate birds, and 7 FP1 KD birds; One-Way ANOVA F(2, 32)=1.09, p=0.35). (<bold>f</bold>) Coefficient of variation of repetition bout length for the syllable type with the highest mean repetition bout length per bird (n=20 typical birds, 8 isolate birds, and 7 FP1 KD birds; One-Way ANOVA F(2, 32)=4.65, p&lt;0.05). * indicates Tukey HSD p-adj&lt;0.05<italic>.</italic></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-101111-fig3-figsupp1-v1.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Syllable and gap duration entropy.</title><p>(<bold>a</bold>) Correlation between the syllable duration distribution entropies calculated using AVN labels or manual annotation (n=35 birds, <italic>r</italic>=0.85, p&lt;0.005). (<bold>b</bold>) Example syllable duration distribution calculated using manual annotations or WhisperSeg segmentations of syllables from a typical adult zebra finch. (<bold>c</bold>) Correlation between the short silent gap duration distribution entropies calculated using AVN labels or manual annotation (n=35 birds, <italic>r</italic>=0.88, p&lt;0.005). (<bold>d</bold>) Example silent gap duration distribution calculated using manual annotations for WhisperSeg Segmentations of syllables from a typical adult zebra finch. (<bold>e</bold>) Comparison of syllable duration entropies across typical (n=20), isolate (n=8), and FP1 KD (n=7) adult zebra finches (&gt;90 dph) and juvenile zebra finches (n=11, 50–51 dph; One-Way ANOVA F(3, 43)=17.43, p&lt;0.005). * indicates Tukey HSD p-adj&lt;0.05. (<bold>f</bold>) Comparison of silent gap duration entropies across typical (n=20), isolate (n=8), and FP1 KD (n=7) adult zebra finches (&gt;90 dph) and juvenile zebra finches (n=11, 50–51 dph; One-Way ANOVA F(3, 43)=8.03, p&lt;0.005). * indicates Tukey HSD p-adj&lt;0.05.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-101111-fig3-figsupp2-v1.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 3.</label><caption><title>Additional rhythm spectrogram examples.</title><p>(<bold>a, b</bold>) Example rhythm spectrogram for (<bold>a</bold>) a typical adult zebra finch and (<bold>b</bold>) a typical juvenile zebra finch (50 dph). Cyan points indicate the frequency band with the highest power in each song file’s rhythm spectrum. These frequencies are used to calculate the rhythm spectrogram peak frequency CVs, as in<bold> c</bold>. (<bold>c</bold>) CV of the peak frequency across song files in a bird’s rhythm spectrogram for typical (n=20), isolate (n=8), and FP1 KD (n=7) adult zebra finches (&gt;90 dph) and juvenile zebra finches (n=11, 50–51 dph; One-Way ANOVA F(3, 43)=8.26, p&lt;0.005). * indicates Tukey HSD p-adj&lt;0.05. (<bold>d</bold>) Additional example rhythm spectrograms from three typical adult zebra finches (&gt;90 dph) and (<bold>e</bold>) three juvenile zebra finches (50–51 dph).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-101111-fig3-figsupp3-v1.tif"/></fig></fig-group></sec><sec id="s2-4"><title>Analyzing song timing</title><p>Song timing can refer to the durations of individual syllables and gaps, or to the rhythmic patterns of a song bout. We have developed and validated multiple metrics to describe song timing at each of those scales, which can easily be calculated using the AVN Python package or graphical application. First, we look at the timing of individual syllables and gaps by plotting the distribution of their durations based on our WhisperSeg segmentations. Typical mature zebra finches have very stereotyped syllable durations across renditions of the same syllable type, which result in a distribution of syllable durations consisting of multiple narrow peaks, each corresponding to a different syllable type (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>). Immature birds, on the other hand, have very variable syllable durations and tend to have a single broad peak and long positive tail in their syllable duration distributions (<xref ref-type="bibr" rid="bib2">Aronov et al., 2011</xref>; <xref ref-type="bibr" rid="bib11">Goldberg and Fee, 2011</xref>). We observe these same patterns using our WhisperSeg segmentations when we apply them to our dataset of 35 mature birds, and an additional 11 juvenile birds aged 50–51 days post-hatch (dph). We quantify the maturity of a bird’s syllable timing by calculating the entropy of their syllable duration distribution, which will approach 1 when density is evenly spread across syllable durations (as in juvenile birds), and approach 0 when density is concentrated in a narrow range of syllable durations, as was done in (<xref ref-type="bibr" rid="bib11">Goldberg and Fee, 2011</xref>). Indeed, using our WhisperSeg segmentation, we find that juvenile birds have significantly higher syllable duration entropies than adult birds (F(3, 43)=17.43, p&lt;0.005, Tukey HSD p-adj juvenile vs. typical adult &lt;0.05; <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>). The syllable duration entropy values that we obtain with WhisperSeg segmentation are also highly correlated with those scores that we obtain from manual segmentation (<italic>r</italic>=0.85, p&lt;0.05; <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>), further indicating that our automated segmentation is sufficiently accurate for downstream analyses.</p><p>In addition to syllable level timing, we have implemented multiple metrics describing a song’s rhythm at the bout level based on the ‘rhythm spectrogram’ first proposed in <xref ref-type="bibr" rid="bib33">Saar and Mitra, 2008</xref>. A rhythm spectrum is constructed by taking the Fourier transform of the derivative of the amplitude trace of a song. If the song consists of multiple motifs with a consistent rhythm, the song’s amplitude will have a repeating fluctuation pattern, which will be reflected in its spectrum. By calculating the ‘rhythm spectrum’ of multiple bouts, then concatenating them into a rhythm spectrogram, we can get a clear impression of a bird’s overall rhythmicity, and the consistency of that rhythm across song bouts (<xref ref-type="fig" rid="fig3">Figure 3e</xref>). We quantify the strength of this rhythm by computing the Wiener Entropy of the mean rhythm spectrum, and we quantify the consistency of the rhythm across bouts by calculating the coefficient of variation of the peak frequency across each bout in the rhythm spectrogram (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>). We find that juvenile birds have significantly higher rhythm spectrum entropies (<xref ref-type="fig" rid="fig3">Figure 3f</xref>, One-Way ANOVA F(3, 43)=17.0, Tukey HSD juvenile vs. typical adult p-adj &lt;0.005) and higher peak frequency CVs than adult birds (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>, One-Way ANOVA F(3, 43)=8.23, Tukey HSD juvenile vs. typical adult p-adj &lt;0.05). Although the FP1 KD birds’ syllable duration entropies are squarely in line with typical adults (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2e</xref>, Tukey HSD FP1 KD vs typical adult p-adj=0.53), their rhythm spectrum entropies (<xref ref-type="fig" rid="fig3">Figure 3f</xref>) and gap duration entropies (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2f</xref>) are significantly higher (Tukey HSD FP1 KD vs. typical adult p-adj &lt;0.05). This is consistent with our earlier finding that the FP1 KD birds have more variable syllable sequencing and highlights the complementary nature of these metrics. When considered together, they provide a comprehensive description of a bird’s song production.</p></sec><sec id="s2-5"><title>Comparing song disruptions with AVN features</title><p>In addition to syntax and timing features, AVN can also calculate a suite of acoustic features, including goodness of pitch, mean frequency, frequency modulation, amplitude modulation, entropy, amplitude, and pitch. This feature set is well established for describing zebra finch song, thanks to the Sound Analysis Pro application (<xref ref-type="bibr" rid="bib43">Tchernichovski et al., 2000</xref>). These features are calculated for each frame of a spectrogram, but to facilitate comparisons between birds, we take the mean value of each feature for every syllable rendition, then compute the overall mean value and the coefficient of variation across renditions of the same syllable type. We then select the syllable types with the minimum, median, and maximum values with respect to each feature to represent the overall acoustic properties of a bird’s song. This results in a total of 48 acoustic features for each bird. When combined with our 3 syntax-related features and 4 timing-related features, we are left with a complete set of 55 features to describe all major aspects of a bird’s song production. This feature set represents an extremely valuable resource for comparing experimental groups, for tracking song phenotypes over time, or for detecting birds with atypical song production.</p><p>To showcase the AVN feature set’s potential for comparing birds across experiments and research groups, we calculated this feature set for 53 typical adult zebra finches, 16 isolate-reared zebra finches, and 7 FP1 KD zebra finches from the UTSW colony; 25 typical adult zebra finches from the Rockefeller Song Library (<xref ref-type="bibr" rid="bib44">Tchernichovski et al., 2021</xref>) and 4-sham deafened birds and 5 early-deafened birds from Hokkaido University, originally recorded for (<xref ref-type="bibr" rid="bib28">Mori and Wada, 2015</xref>). We fit a Linear Discriminant Analysis (LDA) model to a dataset containing only typical and isolate zebra finches. LDA finds the linear combination of features that best separates groups of points (in this case, typical vs. isolate birds’ AVN features), allowing us to identify which features are most informative for discriminating between these groups. This allows us to calculate an ‘isolate score’ for every bird, based on the LD1 value (<xref ref-type="fig" rid="fig4">Figure 4a</xref>). We achieved a 95% classification accuracy between these two groups (<xref ref-type="fig" rid="fig4">Figure 4a</xref>), with the most important features being higher syntax entropy rates, higher syllable duration variance, and higher rhythm entropies for isolates compared to typical birds (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). We repeated this process for typical hearing and deaf birds and achieved a 99% classification accuracy (<xref ref-type="fig" rid="fig4">Figure 4b</xref>), with the most important features being higher mean frequency variance, lower absolute mean frequency, and higher syllable duration variance for deaf birds compared to hearing birds (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>).</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Song phenotypes classification with AVN features.</title><p>(<bold>a</bold>) Linear discriminant values for multiple groups of birds generated from a model trained to discriminate between typical and isolate zebra finches (n=16 isolate birds, 7 FP1 KD birds, 5 deaf birds, 4 sham deafening birds, 53 typical zebra finches from the UTSW colony, and 25 typical zebra finches from Rockefeller). (<bold>b</bold>) Linear discriminant values for multiple groups of birds generated from a model trained to discriminate between typical and deaf zebra finches. Same birds as in <bold>a</bold>. (<bold>c</bold>) Confusion matrix indicating the LDA model’s classification of typical, deaf, isolate, and FP1 KD birds from aa model trained to discriminate between typical, deaf, and isolate birds. Scores for typical, deaf, and isolate birds were obtained using leave-one-out cross-validation, and FP1 KD scores were obtained using a model fit to all typical, deaf, and isolate birds. (<bold>d</bold>) Plot of the linear discriminant coordinates of isolate (n=16), typical (n=78), and FP1 KD birds (n=7) for a model trained to discriminate between typical, deaf, and isolate birds. FP1 KD birds overlap most with isolate birds in this LDA space, indicating that their song production most closely resembles that of isolates.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-101111-fig4-v1.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Song phenotype classification model feature importances.</title><p>(<bold>a</bold>) Feature weights of a LDA model fit to discriminate between typical and isolate zebra finches. Features with positive weights tend to have higher values for isolate birds, and features with negative weights tend to have higher values for typical birds. (<bold>b</bold>) Feature weights of an LDA model fit to discriminate between typical and deaf zebra finches. Features with positive weights tend to have higher values for deaf birds, and features with negative weights tend to have higher values for typical birds. (<bold>c</bold>) Feature weights for an LDA model trained to discriminate between typical, isolate, and deaf zebra finches. Each column reflects the feature weights for binary classification between the named group and both other groups combined. Features are ordered according to their total absolute weights.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-101111-fig4-figsupp1-v1.tif"/></fig></fig-group><p>Finally, we fit an LDA model to a dataset containing typical, isolate, and deaf zebra finches and used this model to assess which of these groups the FP1 KD birds most closely resemble. Previous work suggests that FP1 KD in the song nucleus HVC impairs tutor song memory formation while leaving song motor learning intact (<xref ref-type="bibr" rid="bib9">Garcia-Oscos et al., 2021</xref>). Thus, we would expect the FP1 KD birds’ songs to most closely resemble those of isolates, who have no tutor song memory but do have access to auditory feedback of their own vocalizations, and to not resemble deaf birds who have neither tutor song memories nor access to auditory feedback. Indeed, we find that 5/7 FP1 KD birds are classified as isolates by the LDA classifier, with the other 2/7 being classified as typical birds (<xref ref-type="fig" rid="fig4">Figure 4c and d</xref>). This supports our hypothesis about the nature of the song disruption in FP1 KD birds and highlights the utility of a common feature set for comparing song phenotypes. We hope that the ease of calculation and completeness of this feature set will facilitate phenotypic comparisons across the field of songbird neuroscience, particularly as the field grows in its ability to conduct genetic manipulations of the neural circuits involved in different aspects of song learning and production.</p></sec><sec id="s2-6"><title>Tracking song development with AVN features</title><p>To further showcase the potential of these AVN features for zebra finch song analysis, we also used them to track song development. We calculated the AVN feature sets for 14 birds from UTSW and 5 birds from Duke University (<xref ref-type="bibr" rid="bib3">Brudner et al., 2023</xref>) at multiple time points during song development, ranging from 46 dph to 102 dph. We fit a Generalized Additive Model (GAM) to predict a bird’s age based on its AVN features and find that we achieve the most accurate age predictions with a model that considers a bird’s syllable duration entropy, their syntax entropy, absolute syllable durations, and the variability of goodness of pitch, syllable duration, and Wiener entropy across renditions (<xref ref-type="fig" rid="fig5">Figure 5</xref>). When trained with data from all but one bird and tested on the remaining bird, this model can predict a bird’s age within 7 dph for 50% of age points, and within 11 dph for 75% of age points. Its performance is best for younger birds, with prediction accuracy dropping considerably for birds over 80 dph, which is expected as song changes slow with age and eventually stabilize when birds reach around 90 dph. This could be a powerful tool to measure whether an experimental manipulation causes a bird’s song maturity to systematically lead or lag their true biological age, and which song features are most responsible for this effect, particularly as this method doesn’t require typical mature song from each subject bird to make its estimate, unlike <xref ref-type="bibr" rid="bib10">Goffinet et al., 2021</xref>; <xref ref-type="bibr" rid="bib3">Brudner et al., 2023</xref>, for instance.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Age prediction with AVN features.</title><p>(<bold>a</bold>) Generalized additive model’s age predictions vs. true ages for 103 days of song recordings across 19 individual birds. Model predictions were generated using leave-one-bird-out cross-validation. The gray line indicates where points would lie if the model were perfectly accurate. (<bold>b</bold>) Partial dependence functions for each feature in the GAM model. The values of each feature along the x-axis map onto learned contributions to the age prediction along the y-axis. The GAM model’s prediction is the sum of these age contributions based on each day of song’s feature values, plus an intercept term.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-101111-fig5-v1.tif"/></fig></sec><sec id="s2-7"><title>Measuring song imitation</title><p>So far, we’ve demonstrated how AVN’s features can be used to describe and compare adult and juvenile song production across experiments and research groups. While these features are sufficient to predict a bird’s song learning stage and to detect abnormalities in experimental groups, they don’t directly reflect song learning success. Zebra finches learn song by imitating an adult tutor, and this song learning is typically assessed by comparing a pupil bird’s song to its tutor’s, with higher similarity reflecting more successful learning (<xref ref-type="bibr" rid="bib43">Tchernichovski et al., 2000</xref>, but see <xref ref-type="bibr" rid="bib44">Tchernichovski et al., 2021</xref>). Many methods for zebra finch song similarity scoring currently exist; however, they all require either the manual identification of pupil and/or tutor motifs (<xref ref-type="bibr" rid="bib43">Tchernichovski et al., 2000</xref>; <xref ref-type="bibr" rid="bib23">Mandelblat-Cerf and Fee, 2014</xref>; <xref ref-type="bibr" rid="bib21">Lachlan, 2007</xref>), which limits the number of renditions that can be considered and has the potential to introduce experimenter bias, or require retraining or re-calibration when applied to new tutor-pupil pairs (<xref ref-type="bibr" rid="bib10">Goffinet et al., 2021</xref>; <xref ref-type="bibr" rid="bib27">Mets and Brainard, 2018</xref>), which makes it impossible to directly compare learning outcomes across experiments.</p><p>To overcome these limitations, we have developed a novel similarity scoring system that doesn’t require any manual motif identification, or any retraining or re-calibration for new tutor-pupil comparisons. Our approach involves a deep convolutional neural network that is trained with a dataset of over 16,000 manually annotated syllables from 21 adult zebra finches from the UTSW colony. These syllables are presented to the model in triplets, consisting of a randomly selected ‘anchor’ syllable, a ‘positive’ syllable which belongs to the same type as the anchor, and a ‘negative’ syllable, which belongs to a different syllable type. The model learns to map spectrograms of syllables to an eight-dimensional embedding space, such that the anchor syllable’s embedding is closer to the positive’s embedding than to the negative’s. We use the trained network to compute the syllable embeddings for hundreds of syllables produced by a pupil bird and by its tutor and measure the similarity between their songs by calculating the Maximum Mean Discrepancy (MMD) between their syllable distributions (<xref ref-type="fig" rid="fig6">Figure 6a</xref>). Deep convolutional networks trained with triplet loss have been shown to be useful data compression steps before further downstream tasks are applied on their output, particularly in contexts where the data consists of many discrete classes (syllable types), and relatively few samples per class (renditions of each syllable type; <xref ref-type="bibr" rid="bib45">Thakur et al., 2019</xref>; <xref ref-type="bibr" rid="bib37">Schroff et al., 2015</xref>).</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Illustration and validation of AVN’s song similarity scoring method.</title><p>(<bold>a</bold>) Schematic of the similarity scoring method. A deep convolutional neural network is used to embed syllables in an 8-dimensional space, where each syllable is a single point, and similar syllables are embedded close together. The first two principal components of the eight-dimensional space are used for visualization purposes only here. The syllable embedding distributions for two random subsets of syllables produced by the same pupil on the same day have a high degree of overlap. The empirical distributions of all syllables from a pupil and his song tutor are less similar than a pupil compared to himself, but still much more similar than a pupil and a random unrelated bird. (<bold>b</bold>) Maximum Mean Discrepancy (MMD) dissimilarity score distribution for comparisons between a pupil and itself (n=30 comparisons for UTSW, n=25 for Rockefeller), a pupil and its tutor (n=30 comparisons for UTSW, n=25 for Rockefeller), two pupils who share the same tutor (aka pupil vs. ‘Sibling’ comparisons, n=58 comparisons for UTSW, n=64 for Rockefeller), and between two pupils who don’t share song tutor (aka pupil vs. unrelated bird, n=90 comparisons for UTSW, n=75 for Rockefeller). Calculated with a dataset of 30 typical tutor-pupil pairs from UTSW and 25 from Rockefeller. (<bold>c</bold>) Correlation between MMD dissimilarity scores and human expert judgements of song similarity for 14 tutor-pupil comparisons from the UTSW colony (<italic>r</italic>=–0.80, p&lt;0.005). (<bold>d</bold>) Tutor-pupil MMD dissimilarity scores for typical pupils from the UTSW colony (n=30), typical pupils from the Rockefeller Song Library (n=25), and FP1 KD pupils from the UTSW colony (n=7) (One-Way ANOVA F(2, 57)=9.57, p&lt;0.005. * Indicates Tukey HSD post hoc p-adj&lt;0.05). (<bold>e</bold>) MMD Dissimilarity score between birds at various age points across development, compared to their mature song recorded when the bird is over 90 dph. Each point represents one comparison (n=91 comparisons across 11 birds). Gray line is an exponential function fit to the data to emphasize the slowing of song maturation as birds approach maturity.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-101111-fig6-v1.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Comparison of embedding and distance metric methods for similarity scoring.</title><p>(<bold>a–d</bold>) Dissimilarity score distributions for comparisons between a pupil and itself (n=30 comparisons), a pupil and its tutor (n=30 comparisons), two pupils who share the same tutor (aka pupil vs. ‘Sibling’, n=58 comparisons), and between two pupils who don’t share a tutor (aka pupil vs. unrelated bird, n=90 comparisons). Calculated with a dataset of 30 typical tutor-pupil pairs from the UTSW colony using different combinations of VAE or Triplet loss for dimensionality reduction and EMD or MMD for dissimilarity calculations. (<bold>e</bold>) Contrast index values for pupil vs. self and pupil vs. unrelated bird comparisons for 30 birds from UTSW across different dimensionality reduction and dissimilarity calculation methods. (<bold>f</bold>) Tutor contrast index values for pupil vs. tutor and pupil vs. unrelated bird comparisons for 30 birds from UTSW across different dimensionality reduction and dissimilarity calculation methods.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-101111-fig6-figsupp1-v1.tif"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 2.</label><caption><title>Additional similarity scoring validation.</title><p>(<bold>a</bold>) MMD dissimilarity score distributions for comparisons between a pupil and itself (n=5 comparisons), a pupil and its tutor (n=5 comparisons), two pupils which share the same tutor (aka pupil vs. ‘Sibling’, n=14 comparisons), and between two pupils who don’t share a tutor (aka pupil vs. unrelated bird, n=15 comparisons). Calculated with a dataset of 5 FP1 KD pupils from the UTSW colony, and an additional 30 typical pupils for the ‘Sibling’ and ‘unrelated’ comparisons. (<bold>b</bold>) Correlation between Sound Analysis Pro 2011 % similarity scores and human expert judgements of song similarity for 14 tutor-pupil pairs from UTSW (<italic>r=</italic>0.32, p=0.23). (<bold>c</bold>) Contrast index values for pupil vs. self and pupil vs. unrelated bird comparisons for 30 birds from UTSW and 25 birds from Rockefeller (t-test, p=0.47). (<bold>d</bold>) Tutor contrast index values for pupils vs. tutor and pupil vs. unrelated bird comparisons for 30 birds from UTSW and 25 birds from Rockefeller (t-test, p=0.06).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-101111-fig6-figsupp2-v1.tif"/></fig><fig id="fig6s3" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 3.</label><caption><title>Similarity scoring deep neural network architecture.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-101111-fig6-figsupp3-v1.tif"/></fig></fig-group><p>This process of learning a low-dimensional representation of syllables, then calculating repertoire similarity by comparing distributions of syllables in the low-dimensional space was inspired by <xref ref-type="bibr" rid="bib27">Mets and Brainard, 2018</xref>, and is conceptually similar to the method proposed in <xref ref-type="bibr" rid="bib10">Goffinet et al., 2021</xref>, who use a variational autoencoder (VAE) to compute their syllable embeddings, followed by MMD to score syllable distribution similarity. As such, we’ve compared the similarity scoring results we obtain with our triplet loss model and MMD to <xref ref-type="bibr" rid="bib10">Goffinet et al., 2021</xref>’s VAE and MMD, as well as each of these methods combined with another empirical distribution comparison metric: Earth Mover’s Distance (EMD).</p><p>We first validated these approaches with a dataset of 30 typical tutor-pupil pairs from the UTSW colony segmented using WhisperSeg, none of whom share a song tutor with any of the birds used to train the triplet loss model or VAE. The triplet loss model and VAE consistently yielded higher MMD and EMD dissimilarity scores between a pupil and unrelated bird, compared to a pupil vs. another bird with the same tutor (a ‘sibling’) and a pupil vs. its tutor, as expected (<xref ref-type="fig" rid="fig6">Figure 6b</xref>; <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1a–d</xref>). To more quantitatively compare the sensitivity of each of these approaches in distinguishing different types of relationships between typical zebra finches, we computed a contrast index and tutor contrast index score for each pupil bird. The contrast index represents the difference in dissimilarity score between two subsets of syllables from the same pupil bird, and between the syllables of the given pupil bird and three randomly selected unrelated birds. We find that the VAE with MMD yields the highest contrast index score (contrast index = 0.967 + SEM 0.009), and triplet loss with MMD as a close second (contrast index = 0.938 + SEM 0.015; <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1e</xref>). Notably, all the methods result in much higher average contrast index scores than Sound Analysis Pro (<xref ref-type="bibr" rid="bib43">Tchernichovski et al., 2000</xref>; contrast index = 0.156) and (<xref ref-type="bibr" rid="bib23">Mandelblat-Cerf and Fee, 2014</xref>; contrast index = 0.41).</p><p>Traditional contrast index doesn’t paint a complete picture of the reliability of a method for similarity scoring, however. Typically, similarity scores are computed between a pupil bird and its tutor to measure the pupil’s song learning success. In cases of successful song learning, there will be a high degree of similarity between a pupil’s song and their tutor’s, but these will still be much more different than two subsets of a pupil’s song compared to each other, as is used to calculate contrast index. A useful similarity scoring method must therefore have sufficient sensitivity among higher dissimilarity comparisons to distinguish between imitated song (a pupil vs. tutor comparison) and non-imitated song (a pupil vs. an unrelated bird). This is precisely what is measured by the tutor contrast index, which was highest for the triplet loss model and MMD (tutor contrast index = 0.316 + SEM 0.035; <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1f</xref>). Therefore, our triplet loss model combined with MMD is the most sensitive method for evaluating song learning.</p><p>The triplet loss model with MMD dissimilarity scores shows the same pattern and absolute range of scores for pupil vs. self, pupil vs. tutor, pupil vs. ‘sibling’, and pupil vs. unrelated bird comparisons for the UTSW dataset and for a dataset of 25 tutor-pupil pairs from the Rockefeller Song Library, despite these birds being recorded under different conditions from any of the birds used in model training (<xref ref-type="fig" rid="fig6">Figure 6b</xref>; <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>). This shows that the trained model generalizes well to birds from other research groups without the need for any additional fine-tuning and thus can serve as a standard approach for the field. This approach also yields similarly high contrast indices and tutor contrast indices for both the UTSW and Rockefeller datasets (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>, UTSW mean contrast index = 0.938 + SEM 0.015, Rockefeller mean contrast index = 0.920 + SEM 0.020, t-test p=0.47; UTSW mean tutor contrast index = 0.316 + SEM 0.035, Rockefeller mean tutor contrast index = 0.407 + SEM 0.031, t-test p=0.06). MMD scores produced by this model also agree better with expert human judgements of song similarity than do %similarity scores calculated with Sound Analysis Pro (<xref ref-type="fig" rid="fig6">Figure 6c</xref>; MMD vs. human expert absolute <italic>r</italic>=0.80, <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2b</xref>, SAP %similarity vs. human expert absolute <italic>r</italic>=0.33).</p><p>Using this method, we find that FP1 KD pupils have significantly higher MMD dissimilarity to tutor scores when compared to typical birds from either UTSW or Rockefeller (<xref ref-type="fig" rid="fig6">Figure 6d</xref>; One-Way ANOVA F(2, 57)=9.6, Tukey HSD FP1 KD vs typical UTSW p-adj&lt;0.005, FP1 KD vs typical Rockefeller p-adj&lt;0.005), showing that this method can be used to assess song learning outcomes in experimentally manipulated birds. We also used the model to look at how a bird’s song changes over development, by comparing song at multiple age points to a bird’s mature song. As expected, we find that birds gradually become more similar to their mature song over the course of development, and that the rate of this change slows as birds approach maturity (<xref ref-type="fig" rid="fig6">Figure 6e</xref>). Altogether, these tests showcase that this method (triplet loss model embedding with MMD) is more reliable at assessing tutor-pupil song similarity than existing methods, while also not requiring any manual motif identification or dataset-specific fine-tuning. As a result, as with the AVN acoustic, timing, and syntax features, its scores are directly comparable across research groups, facilitating the quantitative comparison of song learning outcomes across studies.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Here, we have presented the AVN song analysis pipeline, which performs highly accurate syllable segmentation and syllable labeling. We have shown that this approach yields consistently high performance across multiple zebra finch colonies, suggesting that it can standardize and simplify large-scale behavioral annotation across research groups, without the need for additional training or fine-tuning. The AVN labels are used to calculate syntax features which agree well with manual annotations, and which are sufficient to discriminate between typical birds and birds with known genetic disruptions. The AVN segmentations and raw song files are used to calculate timing features, which again are consistent across colonies and which reflect a bird’s stage in song development. Standard acoustic features are also calculated for each AVN syllable type, which can be used to describe the overall acoustic properties of a bird’s song.</p><p>To showcase the utility of these song features, we presented how they can be used to compare multiple different song phenotypes, to test our hypothesis that the songs of FP1 KD birds would more closely resemble isolate birds’ compared to typical or deaf birds’ songs (<xref ref-type="bibr" rid="bib9">Garcia-Oscos et al., 2021</xref>). We also showed how these features can be used to create an interpretable model to predict a bird’s age within 7 days while their song is rapidly evolving from immature subsong to stable adult song. As more research groups use the AVN feature set to describe their birds’ song phenotypes, these analyses will only become more sensitive and powerful. Ultimately, we hope that these song features can be used to establish a comprehensive map of song phenotypes, which more closely link abnormal song phenotypes with the neural circuit dysfunctions underlying them.</p><p>Finally, we developed a novel similarity scoring system that outperforms existing methods in its sensitivity and fidelity to expert human judgements of song similarity, all without requiring any manual song annotation. Again, we expect this to be an invaluable tool for describing the nature and severity of song learning phenotypes in experimentally manipulated birds, where existing similarity scoring methods perform particularly poorly.</p><p>AVN is available to researchers as an open-source Python package and as a graphical application. The Python package allows researchers with some coding experience to take full advantage of the flexibility of these tools and integrate this pipeline into their data collection and processing workflows, while the application allows other researchers to easily annotate their songs and calculate AVN features with minimal coding, in a highly reproducible fashion.</p><p>Altogether, we see this pipeline as an example of the integration of deep learning tools and expertly curated features to automated behavior analysis without compromising the interpretability or generalizability of results. This feature set and annotation approach was designed with zebra finches in mind, but should be easily adaptable to other species with discrete syllables that can be clustered according to their acoustic features, such as Bengalese finches and Canaries, for example <xref ref-type="bibr" rid="bib34">Sainburg et al., 2020</xref>. These species have more complex syllable sequencing than zebra finches and would therefore also benefit from additional syntax and timing features specific to their species. Additionally, while we’ve strived for a comprehensive set of features, it is possible that our 55-feature set will fail to reflect certain interesting song phenotypes that haven’t yet been observed. We hope that the open-source nature and extensive documentation of the AVN pipeline will allow and encourage researchers to contribute additional song features to the pipeline as they encounter such cases where the current feature set may be insufficient.</p></sec><sec id="s4" sec-type="methods"><title>Methods</title><p>The AVN documentation, AVN-GUI, and code necessary to produce all figures in this manuscript can be found through the following links:</p><list list-type="simple" id="list1"><list-item><p>AVN documentation:<ext-link ext-link-type="uri" xlink:href="https://avn.readthedocs.io/en/latest/index.html"> </ext-link><ext-link ext-link-type="uri" xlink:href="https://avn.readthedocs.io/en/latest/index.html">https://avn.readthedocs.io/en/latest/index.html</ext-link></p></list-item><list-item><p>AVN-GUI: <ext-link ext-link-type="uri" xlink:href="https://avn.readthedocs.io/en/latest/AVN_GUI.html">https://avn.readthedocs.io/en/latest/AVN_GUI.html</ext-link></p></list-item><list-item><p>Code for figures:<ext-link ext-link-type="uri" xlink:href="https://github.com/theresekoch/AVN_paper"> </ext-link><ext-link ext-link-type="uri" xlink:href="https://github.com/theresekoch/AVN_paper">https://github.com/theresekoch/AVN_paper</ext-link>, copy archived at <xref ref-type="bibr" rid="bib17">Koch, 2025a</xref></p></list-item><list-item><p>Model training: <ext-link ext-link-type="uri" xlink:href="https://github.com/theresekoch/Triplet_loss_model_training">https://github.com/theresekoch/Triplet_loss_model_training</ext-link> (<xref ref-type="bibr" rid="bib18">Koch, 2025b</xref>)</p></list-item></list><sec id="s4-1"><title>Animals</title><p>Experiments described in this study were conducted using male zebra finches. All procedures were performed in accordance with protocols approved by Animal Care and Use Committee at UT Southwestern Medical Center, protocol number 2016–101562 G.</p></sec><sec id="s4-2"><title>Data acquisition</title><p>A complete list of birds and the analyses in which they were included can be found in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>.</p><sec id="s4-2-1"><title>UTSW dataset</title><p>Many birds included in this study were previously recorded and analyzed in <xref ref-type="bibr" rid="bib9">Garcia-Oscos et al., 2021</xref>. This includes seven birds which were injected with a pscAAV-GFP-shFoxP1 virus before exposure to a song tutor, leading to disrupted songs (referred to as FP1 KD birds in this manuscript and FP1-KD SE in <xref ref-type="bibr" rid="bib9">Garcia-Oscos et al., 2021</xref>). Eight birds were included in this group in the previous paper. One was omitted from this manuscript because it exhibited completely typical song, likely due to weak viral expression. A further 10 birds which were injected with a control virus before exposure to a song tutor (Ctrl SE in <xref ref-type="bibr" rid="bib9">Garcia-Oscos et al., 2021</xref>), and 10 which were injected with the pscAAV-GFP-shFoxP1 after tutor song exposure (FP1-KD BI in <xref ref-type="bibr" rid="bib9">Garcia-Oscos et al., 2021</xref>) are included in the current study. Both of these groups exhibit species-typical song production and are included in the ‘typical’ group in this study. Finally, 8 additional birds which were raised in isolation from an adult song model until they were at least 90 days post-hatch (‘Full isolates’ in the FP1 paper and ‘Isolates’ in the current study) were included in this study, for a total of 35 birds. See <xref ref-type="bibr" rid="bib9">Garcia-Oscos et al., 2021</xref> for more information on viral injections and rearing conditions.</p><p>An additional 8 adult isolate birds, 37 typically reared adult birds, and 10 juvenile birds were recorded for this study. For isolated birds, fathers were removed from breeding cages before the young reached 12 dph. These young remained housed with their mother and siblings in a room containing only other isolate breeding cages, until they were weaned between 40 and 60 dph, at which point they were housed individually, with auditory but no visual access to other isolate reared males. Typically, reared and juvenile birds were raised in our main colony room which contained about 55 breeding pairs. They had unlimited access to their father’s song in their home cages, until they were weaned between 40 and 60 dph, at which point they were housed in group cages with other males.</p><p>Recordings were obtained by individually housing birds in sound-attenuating chambers. They were continuously recorded using Sound Analysis Pro 2011 (<xref ref-type="bibr" rid="bib43">Tchernichovski et al., 2000</xref>). All birds were placed on a 14 hr:10 hr day:night cycle and provided ad libitum access to food, water, and grit. All procedures were performed in accordance with protocols approved by the Animal Care and Use Committee at UT Southwestern Medical Center.</p></sec><sec id="s4-2-2"><title>Additional song data</title><p>In addition to the birds recorded at UTSW, this study includes recordings of 25 pupils and 6 tutors from the Rockefeller University Field Research Center Song Library (<xref ref-type="bibr" rid="bib44">Tchernichovski et al., 2021</xref>), 5 juvenile birds from Duke University (<xref ref-type="bibr" rid="bib3">Brudner et al., 2023</xref>), and 5 early deafened and 4 sham deafened birds from Hokkaido University (<xref ref-type="bibr" rid="bib28">Mori and Wada, 2015</xref>). See citations for more information on rearing and recording conditions.</p></sec><sec id="s4-2-3"><title>Manual song annotation</title><p>A random subset of 30 song files from a single day of recording was annotated for each of 35 adult birds from UTSW, and 15 song files were annotated for each of 25 adult birds from the Rockefeller Song Library. Manual annotation was performed using the <italic>evsonganaly</italic> application in MATLAB (<xref ref-type="bibr" rid="bib46">Tumer and Brainard, 2007</xref>), and involved (1) amplitude threshold syllable segmentation with a threshold selected for each song file based on visual inspection of the amplitude trace and spectrogram, (2) manual correction of erroneous syllable onsets or offsets, and (3) assignment of syllable labels to each syllable based on visual inspection of the spectrogram. All annotations were prepared by one of two expert annotators. These annotators consulted with each other in cases of ambiguous syllable segmentation or labeling and used the same existing set of labeled songs as a reference. Both annotators agreed to adopt the more conservative approach of splitting syllables into smaller segments in cases of ambiguous segmentation and assigning different syllable labels in cases of ambiguous labeling.</p><p>For all applications except training TweetyNet (<xref ref-type="bibr" rid="bib5">Cohen et al., 2022</xref>), segments that reflect cage noise were dropped from the annotations based on visual inspection of the spectrograms. A second set of annotations was made which retained noise segments, labeling them as such, with all syllables and calls labeled as simply ‘vocalizations’ for the purpose of training TweetyNet.</p></sec></sec><sec id="s4-3"><title>Segmentation</title><sec id="s4-3-1"><title>Amplitude segmentation</title><p>Amplitude segmentation was performed using the ‘RMSEDerivative’ class in the AVN Python package’s segmentation module. Each song file is bandpass filtered between 200 Hz and 9000 Hz, then the root mean square energy (RMSE) of each audio frame is computed with a hop length of 512 samples and a frame length of 2048 samples. The RMSE values of each song file are normalized, then the RMSE’s first derivative is compared against user-specified thresholds. A syllable onset is identified as a positive crossing of the ‘onset’ threshold. Syllable offsets tend to be marked by more gradual changes in RMSE compared to syllable onsets, making it difficult to identify them consistently. To mitigate this, we perform onset to onset segmentation with this method, meaning each segment included a song syllable and the silent gap that immediately followed it. If a syllable onset is not followed by another onset within 300 ms (as in the end of a song bout), the offset is set as the first negative crossing of an ‘offset’ threshold after the syllable onset.</p><p>In keeping with the TweetyNet and WhisperSeg segmentation methods which don’t require per-bird parameter adjustments, the same ‘onset’ and ‘offset’ thresholds were used for all birds in the dataset. These thresholds were selected using AVN’s segmentation.Utils.threshold_optimization_many_birds() function, which compares the F1 scores relative to manual segmentation obtained with multiple different threshold values to identify the threshold value that results in the lowest mean F1 score across all 35 UTSW birds used for amplitude segmentation validation. The same thresholds selected based on the UTSW birds were used to segment the 25 Rockefeller Song Library birds, as a test of the generalization of this method without the need for manual segmentations.</p></sec><sec id="s4-3-2"><title>TweetyNet</title><p>The <italic>vak</italic> Python package was used to prepare datasets for, train, and generate segmentation predictions with the TweetyNet model (<xref ref-type="bibr" rid="bib5">Cohen et al., 2022</xref>). TweetyNet is a deep neural network consisting of a block of convolutional layers followed by a bidirectional long short-term memory (LSTM) layer. The model takes a 1 s spectrogram of song as input, and labels each frame within that spectrogram. TweetyNet was designed for simultaneous syllable labeling and segmentation, in which case it would label each frame of the spectrogram with a syllable label or as silence. However, to make this model generalize to new birds without any additional training data, we instead trained TweetyNet to label each frame as a vocalization, silence, or noise (common sources of noise include the bird hopping around its cage and flapping its wings), rather than a more specific syllable type. When trained with such data from many birds, it can learn to distinguish vocalizations from noise and silence in a sufficiently general manner that the model can be applied to previously unseen individuals.</p><p>Manually annotated song files with label classes ‘noise’ and ‘vocalization’ were used to train TweetyNet in a leave-one-out cross-validation scheme, meaning the model was trained with data from all but one bird and tested on the withheld bird for each of the 35 birds in the UTSW dataset. A model trained with data from all 35 UTSW birds was used to segment the 25 validation birds from the Rockefeller Song Library dataset, to test the model’s ability to generalize to new colonies. Full model training and prediction procedures can be found in this paper’s accompanying GitHub repository. For more information on the TweetyNet model itself, see <xref ref-type="bibr" rid="bib5">Cohen et al., 2022</xref>.</p></sec><sec id="s4-3-3"><title>WhisperSeg</title><p>WhisperSeg is an instance of the Whisper Transformer model which was pre-trained for automatic human speech recognition and fine-tuned for animal voice activity detection with a multi-species animal vocalization dataset (<xref ref-type="bibr" rid="bib12">Gu et al., 2023</xref>). It takes a spectrogram representation of up to 2.5 s of song as input and outputs the indices of vocalization onsets and offsets in the spectrogram. These indices are then converted to timestamps, and a consistent labeling scheme for an entire song file is achieved through a ‘majority-vote’ post-processing step across overlapping 2.5 s song segments. Syllable segmentation was performed using the <italic>whisperseg-large-ms-ct2</italic> model, with hyperparameters optimized for zebra finch song segmentation, based on <xref ref-type="bibr" rid="bib12">Gu et al., 2023</xref>. This was done using scripts shared in this paper’s accompanying GitHub repository, which must be installed separately from AVN according to the instructions provided in the repository. For more information on the WhisperSeg model and its training, see <xref ref-type="bibr" rid="bib12">Gu et al., 2023</xref>.</p></sec><sec id="s4-3-4"><title>Validation</title><p>Segmentation methods were compared on the basis of their precision, recall, and F1 scores relative to manual annotations.<disp-formula id="equ1"><alternatives><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtext>Precision</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mtext>True Positives</mml:mtext><mml:mrow><mml:mtext>True Positives</mml:mtext><mml:mo>+</mml:mo><mml:mtext>False Positives</mml:mtext></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t1">\begin{document}$$\displaystyle \text{Precision} = \frac{\text{True Positives}}{\text{True Positives} + \text{False Positives}}$$\end{document}</tex-math></alternatives></disp-formula><disp-formula id="equ2"><alternatives><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtext>Recall</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mtext>True Positives</mml:mtext><mml:mrow><mml:mtext>True Positives</mml:mtext><mml:mo>+</mml:mo><mml:mtext>False Negatives</mml:mtext></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t2">\begin{document}$$\displaystyle \text{Recall}= \frac{\text{True Positives}}{\text{True Positives} +\text{False Negatives}}$$\end{document}</tex-math></alternatives></disp-formula><disp-formula id="equ3"><alternatives><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtext>F1</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mtext>True Positives</mml:mtext><mml:mrow><mml:mtext>True Positives</mml:mtext><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mtext>False Positives + False Negatives</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t3">\begin{document}$$\displaystyle \text{F1} = \frac{\text{True Positives}}{\text{True Positives}+\frac{1}{2}\left (\text{False Positives + False Negatives}\right)}$$\end{document}</tex-math></alternatives></disp-formula></p><p>where a true positive is a syllable onset in the automatic segmentation that is within 10 ms of a syllable onset in the manual annotation, a false positive is a syllable onset in the automatic segmentation that doesn’t match with a syllable onset in the manual annotation within 10 ms, and a false negative is a syllable onset that is present in the manual annotation which doesn’t match with an automatic segmentation onset within 10 ms. When determining onset alignments, we ensure that each syllable onset in the manual annotation can only ‘match’ with a single syllable onset in the automatic segmentation, and vis-versa. This was done using AVN’s ‘segmentation.Metrics.calc_F1()` function. Across all three metrics, scores closer to 1 indicate better agreement between automatic and manual segmentations. These same features were calculated for syllable offsets as well, but with an allowance of 20 ms rather than 10 ms, to account for the greater variability in exact offset segmentation across all methods tested.</p><p>To further examine the temporal precision of each method relative to manual annotation, we also calculated the time difference in milliseconds between matched syllable onsets and offsets between automatic segmentations and manual annotations. This was done using AVN’s ‘segmentation.Metrics.get_time_delta_df()’ function.</p></sec></sec><sec id="s4-4"><title>Labeling</title><sec id="s4-4-1"><title>UMAP dimensionality reduction</title><p>UMAP dimensionality reduction (<xref ref-type="bibr" rid="bib26">McInnes et al., 2018</xref>) is performed on spectrograms of syllables, prior to HDBSCAN clustering for label assignment (<xref ref-type="bibr" rid="bib25">McInnes and Healy, 2017</xref>). First, spectrograms of each segmented syllable are produced. The audio is first bandpass filtered between 500 Hz and 15 KHz, then amplitude normalized independently for each syllable rendition. The short-term Fourier transform of the normalized audio for each syllable is computed with a window length of 512 samples and a hop length of 128 samples. The resulting amplitude spectrogram is converted to decibels using the librosa ‘amplitude_to_db()’ function (<xref ref-type="bibr" rid="bib24">McFee et al., 2023</xref>). The db-scaled spectrogram is then padded to match the dimensions of the longest syllable in a given bird’s dataset, or clipped to 870 ms if it exceeds that duration. This limit is very generous, and only ever applies to segmentation errors, but it is necessary to avoid memory issues during UMAP computation. Normalized spectrograms are then flattened from an array to a single long vector, and the vectors corresponding to each spectrogram are concatenated into an array separately for each bird. This spectrogram array is used to calculate the UMAP embeddings of each syllable using the UMAP Python package’s ‘UMAP()’ function. This approach is based on <xref ref-type="bibr" rid="bib34">Sainburg et al., 2020</xref>.</p><p>At a high level, UMAP dimensionality reduction involves constructing a graphical representation of the syllable set, where each syllable spectrogram can be thought of as a point in high dimensional space which is connected to other syllables near it by edges. These edges are weighted based on the distance between points and the local density of those data points. The high-dimensional graph is then projected into lower dimensions in a way that best preserves its overall structure.</p><p>UMAP dimensionality reduction can be a useful initial step when attempting to cluster high-dimensional data points because many clustering algorithms, especially density-based clustering algorithms such as HDBSCAN, can suffer from the ‘curse of dimensionality’. When clustering spectrograms directly, each pixel in the spectrogram is a dimension, meaning each spectrogram exists as a point in a space with thousands of dimensions. In such a high-dimensional space, points will be very sparsely distributed, even if the spectrograms appear largely very similar. As a result, it is very difficult to detect regions of higher point density to serve as the basis of clusters. Reducing the dimensionality of the dataset forces points closer together, such that regions of high density separated by lower density can be more easily detected. UMAP is particularly adept at emphasizing local clusters in high-dimensional data because of how its initial embedding graph is constructed.</p><p>UMAP parameters were selected based on suggestions in the UMAP-learn documentation for clustering using UMAP embeddings and based on visual inspection of plots and labeling outcomes compared to manual annotations for birds from the UTSW dataset.</p></sec><sec id="s4-4-2"><title>HDBSCAN clustering</title><p>The ‘Hierarchical Density-based Spatial Clustering of Applications with Noise’ (HDBSCAN) clustering algorithm (<xref ref-type="bibr" rid="bib25">McInnes and Healy, 2017</xref>) was applied to the UMAP embeddings of syllable spectrograms for each bird independently, in order to assign syllable labels. This method was selected based on the results in <xref ref-type="bibr" rid="bib34">Sainburg et al., 2020</xref> for clustering Bengalese finch syllables, a species closely related to zebra finches.</p><p>Essentially, HDBSCAN works by calculating the ‘mutual reachability’ distance between points in the UMAP space, based on the distance between them and their local densities. These mutual reachability distances serve as edges connecting nodes (points representing individual song syllables) in a graph, which are then pruned to obtain a minimum spanning tree (a graph using the minimum number of total edges to connect all points). The minimum spanning tree is then converted to a hierarchy by sorting the edges on the basis of their mutual reachability scores. Clusters of points are identified by defining a minimum cluster size and selecting the clusters that persist over the longest span of the hierarchy. As with the UMAP parameters, the same HDBSCAN hyperparameter set was used for all birds. The hyperparameter values were selected based on v-measure scores and visual inspection of confusion matrices for WhisperSeg segments compared to manual annotations for birds from the UTSW colony.</p></sec><sec id="s4-4-3"><title>Validation</title><p>Syllable labeling was assessed by comparing automatically assigned syllable labels to manual annotations. Automatically labeled segments first had to be aligned to the manual annotations to identify pairs of labels in the automatic clustering and manual annotation that referred to the same vocalization. This was done using the same method described in the <italic>Segmentation Validation</italic> section, in which syllable onsets are uniquely matched to their closest counterpart across segmentation methods, this time up to a maximum distance of 100 ms. False positive syllable detections (i.e. syllable present in the automatic segmentation without a manual annotation counterpart) are assigned to their own manual annotation category (‘x’), and false negative syllable detections (i.e. syllables present in the manual annotation without an automatic segmentation counterpart) are assigned to their own cluster (‘1000’) for the purposes of visualization and quantification.</p><p>Once syllables have been aligned between automatic segmentation and manual annotations, the HDBSCAN cluster labels are compared to manual labels for each bird to construct a confusion matrix, which gives the number of syllables in each HDBSCAN cluster that carry each of the possible manual labels. The confusion matrix values can then be used to compute homogeneity, completeness, and v-measure scores, to evaluate the correspondence between HDBSCAN labels and manual annotations for each bird. Homogeneity measures the extent to which syllables with the same AVN label also carry the same manual annotation label, completeness measures the extent to which syllables with the same manual annotation label also carry the same AVN label, and the V-measure is the harmonic mean of these two scores.<disp-formula id="equ4"><alternatives><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtext>Homogeneity </mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>H</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>manual labels</mml:mtext><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mtext>clusters</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mtext>H</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mtext>manual labels</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t4">\begin{document}$$\displaystyle \text{Homogeneity }=\frac{\text{H}\left (\text{manual labels}\,|\,\text{clusters}\right)}{\text{H}\left (\text{manual labels}\right)}$$\end{document}</tex-math></alternatives></disp-formula><disp-formula id="equ5"><alternatives><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtext>Completeness</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>H</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>clusters</mml:mtext><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mtext>manual labels</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mtext>H</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mtext>clusters</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t5">\begin{document}$$\displaystyle \text{Completeness}=\frac{\text{H}\left (\text{clusters}\,|\,\text{manual labels}\right)}{\text{H}\left (\text{clusters}\right)}$$\end{document}</tex-math></alternatives></disp-formula><disp-formula id="equ6"><alternatives><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtext>V-measure</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mtext>Homogeneity</mml:mtext><mml:mo>×</mml:mo><mml:mtext>Completeness</mml:mtext></mml:mrow><mml:mrow><mml:mtext>Homogeneity</mml:mtext><mml:mo>+</mml:mo><mml:mtext>Completeness</mml:mtext></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t6">\begin{document}$$\displaystyle \text{V-measure}=\frac{2 \times \text{Homogeneity}\times \text{Completeness}}{\text{Homogeneity} + \text{Completeness}}$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <inline-formula><alternatives><mml:math id="inf1"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>manual labels</mml:mtext><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mtext>clusters</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft1">\begin{document}$H\left (\text{manual labels}\,|\,\text{clusters}\right)$\end{document}</tex-math></alternatives></inline-formula> is the conditional entropy of the manual labels given the cluster labels, <inline-formula><alternatives><mml:math id="inf2"><mml:mi>H</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mtext>manual labels</mml:mtext></mml:mrow></mml:mfenced></mml:math><tex-math id="inft2">\begin{document}$H\left (\text{manual labels}\right)$\end{document}</tex-math></alternatives></inline-formula> is the entropy of the manual labels, and vis-versa. In all cases, a higher score indicates better correspondence between clusters and manual labels, with a maximum possible score of 1 and minimum score of 0.</p><p>As UMAP embeddings are inherently stochastic, the subsequent HDBSCAN labels can vary over repeated runs with the exact same syllable dataset, depending on the random initialization of the UMAP embedding. To examine how consistent the labels are across different random UMAP initializations, we calculated the v-measure scores for 35 birds from the UTSW colony across 30 different random initializations and calculated the standard deviation of the v-measure scores for each bird, as a measure of the outcome variability due to UMAP’s stochasticity.</p></sec></sec><sec id="s4-5"><title>Syntax features</title><sec id="s4-5-1"><title>Syntax raster plot</title><p>Beginning with a table of all AVN labels, syllables that are preceded and followed by a period of silence longer than 200 ms are removed, as they likely reflect calls produced outside of song. Song bouts are then identified as sequences of at least two syllables that are separated by silent gaps no longer than 200 ms. These bouts are aligned based on a user-specified alignment syllable, such that the first instance of the alignment syllable is in the same position across all bouts. This alignment is important as bouts typically begin with a variable number of introductory notes, which will obscure patterns in syllable sequence across bouts when they are not aligned to the first non-introductory note syllable. After alignment, bouts are ordered such that bouts with similar sequences after the alignment syllable are together in the final plot, which also helps emphasize patterns across bouts. This is done using AVN’s syntax. Syntax_Data.make_syntax_raster() function. See avn’s documentation for additional information and examples.</p></sec><sec id="s4-5-2"><title>Syllable transition matrix</title><p>As with syntax raster plots, syllables that are preceded and followed by more than 200 ms of silence are dropped from the AVN labels as they likely reflect calls produced outside of song. Silent gaps longer than 200 ms and file bounds are then added as states to the AVN label sequence. All syllable transitions between AVN labels are then counted, including transitions to and from periods of over 200 ms of silence; meaningful transitions as they reflect the beginnings or ends of song bouts. Transitions to and from file bounds are ignored, as these are artifacts of the recording and don’t reflect meaningful behavioral states. The transition counts are then divided by the total number of renditions of the first syllable type in the transition to get the conditional probability of the second syllable, given the first syllable. This is done using AVN’s syntax.Syntax_Data.make_transition_matrix() function.</p></sec><sec id="s4-5-3"><title>Syntax entropy rate</title><p>Syntax stereotypy is quantified using the entropy rate of the syllable transition matrix.  <disp-formula id="equ7"><alternatives><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtext>entropy rate = </mml:mtext><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>log</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t7">\begin{document}$$\displaystyle  \text{entropy rate = }- \sum _{\mathrm{i},\mathrm{k}}\mathrm{\pi }_{i}p_{i,k}\log _{2} \left (p_{i,k}\right)$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <inline-formula><alternatives><mml:math id="inf3"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft3">\begin{document}$p_{i,k}$\end{document}</tex-math></alternatives></inline-formula> is the probability of transitioning from initial syllable type <italic>i</italic> to following syllable type <italic>k</italic>, and <inline-formula><alternatives><mml:math id="inf4"><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft4">\begin{document}$\pi _{i}$\end{document}</tex-math></alternatives></inline-formula> the probability of syllable type <italic>i</italic> occurring, regardless of what syllable precedes or follows it. An entropy rate approaching 0 indicates that all transitions are highly predictable. The maximum possible entropy rate score is <inline-formula><alternatives><mml:math id="inf5"><mml:msub><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfenced></mml:math><tex-math id="inft5">\begin{document}$log_{2}\left (N\right)$\end{document}</tex-math></alternatives></inline-formula> where <italic>N</italic> is the number of syllable types in the bird’s repertoire plus one to account for silence as a possible state. To directly compare scores between birds without being biased by the number of syllable types in their song (a feature which depends strongly on the number of syllable types present in their tutor’s song), we divide the entropy rate score by <inline-formula><alternatives><mml:math id="inf6"><mml:msub><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfenced></mml:math><tex-math id="inft6">\begin{document}$log_{2}\left (N\right)$\end{document}</tex-math></alternatives></inline-formula> such that it is now bounded between 0 and 1. This is done using AVN’s syntax.Syntax_Data.get_entropy_rate() function.</p></sec><sec id="s4-5-4"><title>Repetition bouts</title><p>A repetition bout refers to every instance in which a syllable is produced, either a single time or multiple times in a row. For example, in the syllable sequence <italic>abcaaabc</italic>, syllable <italic>a</italic> has two repetition bouts, one of length one, meaning the syllable was produced without being repeated, and one of length 3, meaning the syllable was produced three times in a row. The number and length of repetition bouts are calculated for each syllable type in a bird’s repertoire. The mean repetition bout length and coefficient of variation (CV) of repetition bout length are then calculated for each syllable type.</p><p>To facilitate comparisons across birds, which have different numbers of syllable types, the mean repetition bout length and CV of repetition bout length for the syllable type with the highest mean repetition bout length are selected to represent the bird’s overall tendency to repeat syllables, excluding syllable types that reflect putative calls or introductory notes. Typical zebra finches often repeat calls or introductory notes, but rarely repeat song syllables, so looking at the repetition of song syllables is more informative when detecting or comparing birds with abnormal syntax. That said, in certain experiments, repetition bout features of calls or introductory notes may be of greater interest, in which case they can also be specifically identified using AVN.</p><p>An AVN syllable type is considered a putative introductory note if it (1) is no less than 5% less likely to be transitioned to from silence than the syllable type most commonly transitioned to from silence, meaning it tends to occur at the start of a vocalization bout and (2) it has a single dominant transition to a syllable type other than itself which is not silence, meaning that after a number of repetitions, it is eventually followed by a predictable next syllable type, which should reflect the start of a motif. These criteria were determined based on inspection of the syntax properties of introductory notes in manual song annotations. An AVN syllable type is considered a putative call if it is (1) not a putative introductory note and (2) produced in a bout of one or two syllables preceded and followed by at least 200 ms of silence in more than ⅓ of all utterances. This criterion was again determined based on visual inspection of manual song annotations.</p></sec></sec><sec id="s4-6"><title>Song timing features</title><sec id="s4-6-1"><title>Syllable and gap duration entropy</title><p>A syllable duration distribution is constructed based on the segment durations output by WhisperSeg for each bird. A histogram of the <inline-formula><alternatives><mml:math id="inf7"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mi>log</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft7">\begin{document}$\log _{10}$\end{document}</tex-math></alternatives></inline-formula> of syllable durations is calculated, with 50 evenly spaced bins ranging from –2.5 to 0. As in <xref ref-type="bibr" rid="bib11">Goldberg and Fee, 2011</xref>, the log of syllable durations is used because the syllable duration distributions of juvenile birds are roughly exponential and therefore linear in log space. Histograms are normalized to produce a probability density function across syllable durations. The entropy of this distribution is then calculated as<disp-formula id="equ8"><alternatives><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtext>Entropy</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>N</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t8">\begin{document}$$\displaystyle  \text{Entropy}=\frac{\sum _{i = 1}^{N}p_{i} \log \left (p_{i}\right)}{\log \left (N\right)}$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <inline-formula><alternatives><mml:math id="inf8"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft8">\begin{document}$p_{i}$\end{document}</tex-math></alternatives></inline-formula> is the density the <italic>i</italic>th bin in the histogram, and <italic>N</italic> is the total number of bins (50, in this case). The resulting entropy can range from 0 to 1, with higher scores indicating less predictable syllable durations, consistent with the songs of immature birds.</p><p>Entropy is calculated similarly for silent gap durations, where gap durations are defined as the time difference between a syllable offset and the immediately following syllable onset, up to a maximum duration of 200 ms. A log transform was not applied to gap durations before constructing a histogram with 20 10 ms bins.</p></sec><sec id="s4-6-2"><title>Rhythm spectrograms</title><p>Rhythm spectrograms are a visualization of the strength and stereotypy of rhythmic patterns in a bird’s song, generated by concatenating the rhythm spectra of multiple song bouts, as first proposed in <xref ref-type="bibr" rid="bib33">Saar and Mitra, 2008</xref>. A song bout’s rhythm spectrum is the spectrum of the first derivative of its amplitude. If a song’s amplitude has consistent repeating fluctuation patterns (as we expect for a bout composed of multiple repetitions of the same stereotyped motif), then its spectrum will exhibit harmonic banding patterns. If, by contrast, there are no repeating rhythms in the song’s amplitude, the rhythm spectrum will have a more even spread of energy across frequency bands. To detect these harmonic patterns more easily in the rhythm spectrogram, all rhythm spectrograms are plotted as the rolling average of 10 song bouts, smoothing out some bout-to-bout variation in the spectra to make harmonic bands more obvious.</p><p>To ensure consistent dimensions and resolution across song bouts, the rhythm spectrum is calculated for segments of song of a fixed duration, rather than complete song bouts. This also eliminates the need for any segmentation and labeling of song files to identify bouts, making this timing analysis method completely independent of possible segmentation and labeling errors. Each .wav file is broken into multiple 3-s-long frames, with a hop length of 0.2 s. The three frames with the highest total amplitude (i.e. the three windows containing the most vocalizations) from each file have their rhythm spectra calculated, and the mean of their spectra is taken as the rhythm spectrum for that file. Because of this windowing system, only files at least 3+3 ×0.2 s in duration can be windowed this way, so shorter .wav files are ignored.</p><p>The derivative of the amplitude of each frame is centered at 0 by subtracting the mean value, then multiplied by a Hanning window to reduce spectral leakage when calculating the spectrum. The transformed amplitude derivative is then padded to a total length of 100000 frames, resulting in a smoother spectrum with more interpolated values. A bandpass filter is then applied, keeping only frequency components above 1 Hz and below 500 Hz, as these are the frequencies consistent with typical zebra finch motif and syllable periods. Finally, the real component of the Fourier transform is calculated, constituting the frame’s ‘rhythm spectrum’. Only portions of the rhythm spectrum corresponding to frequencies between 0 and 30 Hz are included in rhythm spectrograms and downstream feature calculations, as this is the range with the strongest harmonic banding for typical zebra finches. This is all done using AVN’s avn.timing.RhythmAnlysis.make_rhythm_spectrogram() function.</p></sec><sec id="s4-6-3"><title>Rhythm spectrum entropy</title><p>We quantify the strength of the harmonic content of a bird’s rhythm spectrum (i.e. the strength of its rhythm) by calculating the Wiener Entropy of the mean rhythm spectrum across bouts. Wiener entropy is a common acoustic feature used to assess the harmonic nature of zebra finch syllables, with scores near 0 reflecting signals with little harmonic structure, and scores ranging to negative infinity for signals with more harmonic structure.<disp-formula id="equ9"><alternatives><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtext>rhythm spectrum entropy =</mml:mtext><mml:mfrac><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mtext>rhythm spectrum</mml:mtext><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mtext>rhythm spectrum</mml:mtext><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t9">\begin{document}$$\displaystyle  \text{rhythm spectrum entropy =}\frac{\sum \limits_{n = 0}^{N}\log \left (\text{rhythm spectrum}^{2}\right)}{N - \log \left (\sum \limits_{n=0}^{N}\text{rhythm spectrum}^{2}/N\right)}$$\end{document}</tex-math></alternatives></disp-formula></p><p>This is calculated using AVN’s avn.timing.RhythmAnalysis.calc_rhythm_spectrogram_entropy() function.</p></sec><sec id="s4-6-4"><title>Peak frequency variability</title><p>Whereas the rhythm spectrum entropy measures the overall strength of the rhythms in a set of songs, the peak frequency variability reflects the consistency of the rhythm across multiple song renditions. The exact spacing of the harmonics in a rhythm spectrogram depends on the shape of the amplitude trace of the bird’s motif. It isn’t obvious how different motifs and motif lengths affect the banding pattern of the rhythm spectrogram, so it doesn’t make sense to compare the appearance of different birds’ rhythm spectra beyond the prominence of harmonic bands. Likewise, the frequency of the harmonic band with the highest magnitude doesn’t carry any special meaning. However, in a very stereotyped bird, that harmonic band will be consistent across songs. If the bird sings its song slightly faster or slower, the band can shift slightly in the frequency domain. So, we measure a bird’s rhythm stereotypy by looking at the variability of the frequency with the highest magnitude across song files (the peak frequency).</p><p>In practice, the frequency band with the highest energy can jump between harmonic bands across files, even while the overall timing is largely unchanged, so to truly capture fluctuations in the underlying rhythms in a bird’s song, we restrict the range of ‘peak frequency’ values to a 3 Hz band about the median peak frequency across bouts. The CV of the peak frequency within this range is calculated as the peak frequency variability. This is done using AVN’s avn.timing.RhythmAnalysis.calc_peak_freq_cv() function.</p></sec></sec><sec id="s4-7"><title>Acoustic features</title><p>Goodness of pitch, Mean Frequency, Wiener Entropy, Amplitude, Amplitude Modulation, Frequency Modulation, and Pitch were all calculated using AVN in Python, with implementations based on the Sound Analysis Tools for MATLAB (<xref ref-type="bibr" rid="bib43">Tchernichovski et al., 2000</xref>). Each of these features is calculated for each frame in a spectrogram, resulting in a time series of values. We summarize these time series of varying lengths by taking the mean value of each feature for each AVN segmented syllable. We then calculate the mean and coefficient of variation of the mean feature values for each syllable type according to their AVN labels. As each bird has a different number of syllable types, we need to further summarize these features so that we have a consistent set of values for comparisons across individuals. To do this, we take the syllable type with the minimum, maximum, and median mean value and CV for each feature. This results in six values summarizing the variability and absolute values of each feature for each bird. Across seven acoustic features plus syllable duration, this results in a total set of 48 features.</p></sec><sec id="s4-8"><title>Linear discriminant analysis</title><p>We fit three different linear discriminant analysis models in this paper. One to discriminate between typical zebra finches and isolate zebra finches, one to discriminate between typical zebra finches and deaf zebra finches, and one to discriminate between all three groups at once. For each of these models, L1 regularization was used to reduce the number of features considered in the model. This improves both the generalization of the model and its interpretability by focusing on just a subset of the most informative features. L1 feature selection was performed considering all AVN features from each bird, excluding amplitude and amplitude-modulation features, as these were found to vary according to recording conditions. Once the feature set was reduced, classification accuracy of the models was tested using a stratified k-fold cross-validation approach. Classification accuracy is the fraction of data points in the withheld test set which were correctly classified. Plotted LDA values and feature weights were obtained from a model trained with the complete dataset. This was all done using the scikit-learn Python package (<xref ref-type="bibr" rid="bib8">Fabian Pedregosa et al., 2011</xref>).</p></sec><sec id="s4-9"><title>Age prediction generalized additive model</title><p>The full AVN feature set was calculated for 19 individual birds across 103 age points, using songs produced within the first 4 hr after lights on. Juvenile birds have been shown to have more variable songs in the early morning (<xref ref-type="bibr" rid="bib3">Brudner et al., 2023</xref>), which exaggerates the difference between immature and mature song and improves the model’s ability to predict a bird’s age, compared to features calculated with a full day of songs, or songs produced in the afternoon.</p><p>Before fitting a Generalized Additive Model (GAM) for age prediction, we pruned our feature set to include only the most informative features. We first excluded all amplitude and amplitude-modulation features, as these were strongly affected by recording conditions and differed between colonies. We then calculated the mutual information between each remaining feature and age, considering 43 age points from 12 individual birds. We automatically excluded all features with a mutual information score lower than 0.05 (20/44 features). We further refined this feature set by performing forward feature selection with our 43 age point dataset. This means we iteratively added individual features to the model based on which additional feature resulted in the lowest mean squared error (MSE) predictions in a bird-fold cross-validation. We then selected the feature set with the lowest overall MSE, further reducing our feature set to just seven features.</p><p>A GAM model with the seven selected features was used to predict bird ages in a leave-one-bird-out (aka bird-fold) cross-validation scheme. Here, we included the 43 age points from 12 individual birds used for feature selection, plus an additional test set of 60 age points from 7 individual birds. We saw no significant difference in model performance between this test set and the dataset used for feature selection, so we pooled results across these groups.</p><p>To investigate the contribution of each feature to the overall model, we fit a model with all birds in the dataset and used the pyGAM Python package (<xref ref-type="bibr" rid="bib38">Servén et al., 2018</xref>) to extract the partial dependence functions for each feature.</p></sec><sec id="s4-10"><title>Similarity scoring</title><sec id="s4-10-1"><title>Data preparation</title><p>Spectrograms of manually segmented and labeled syllables from 21 adult zebra finches from the UTSW colony were used for model training. All validation was performed with spectrograms of WhisperSeg segmented syllables from a test set of 30 tutor-pupil pairs from UTSW and 25 tutor-pupil pairs from the Rockefeller Song Library (<xref ref-type="bibr" rid="bib44">Tchernichovski et al., 2021</xref>), none of which were included in training. For the triplet loss model, these spectrograms were normalized for amplitude, then clipped or padded to a uniform duration of 180 ms. To reduce computational costs, all frequency bands below 2 kHz and above 6 kHz are discarded. For the variational autoencoder model, spectrograms were computed for each syllable then interpolated to consistent time and frequency representations; 128 frequency bands ranging from 400 Hz to 10 kHz, and 128 time bins. Syllables longer than 300 ms were discarded. Short syllables were stretched in time by a factor of <inline-formula><alternatives><mml:math id="inf9"><mml:mo>√</mml:mo><mml:mfrac><mml:mrow><mml:mn>300</mml:mn><mml:mi>m</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:math><tex-math id="inft9">\begin{document}$\sqrt \frac{300ms}{t}$\end{document}</tex-math></alternatives></inline-formula>, then symmetrically zero-padded to a size of 128 time bins, such that all syllables’ spectrograms had the same dimensions.</p></sec><sec id="s4-10-2"><title>Triplet loss model architecture</title><p>The proposed neural network model is composed of five convolutional layers alternating with four ‘Multiscale Analysis Modules’ (MAMs), followed by a global pooling layer and three fully connected linear layers (<xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3</xref>). This architecture is based on the model proposed in <xref ref-type="bibr" rid="bib45">Thakur et al., 2019</xref>, which was used for species classification with field recordings of bird, frog, and toad vocalizations. The first convolutional layer consists of 32 3x3 kernels, with the 4 subsequent convolutional layers consisting of 64 3x3 kernels with a stride length of 2 along the frequency axis, resulting in downsampling by a factor of 2 along that dimension. Each MAM is composed of four parallel strands, each processing the data at different scales. The first strand consists of a single convolutional layer with 32 1x1 kernels, the second, third, and fourth strands start with a 32 filter 1x1 kernel convolutional layer, followed by a convolutional layer with 32 3x3, 5x5, and 7x7 kernels, respectively. The output of each of these strands is concatenated channel-wise, resulting in a 128-channel representation of the data which is passed to the next layer. This parallel strand organization allows the model to perform feature extraction at multiple different scales without increasing the depth of the model, saving computational cost and limiting potential overfitting. This approach was first proposed in <xref ref-type="bibr" rid="bib40">Szegedy et al., 2015</xref>. The ReLU activation function is used after every layer (<xref ref-type="bibr" rid="bib29">Nair and Hinton, 2010</xref>). The output of the final linear layer is an 8-dimensional vector, which represents an input syllable’s embedding. These vectors are normalized to have a length of 1, such that all embeddings lie on a unit eight-dimensional hypersphere.</p></sec><sec id="s4-10-3"><title>Triplet loss model training</title><p>The model is trained using dynamic triplet loss with triplet mining. Triplet loss involves presenting the model with batches of triplets, where each triplet consists of an anchor, a positive, and negative syllable. The anchor and positive syllables carry the same manual annotation label from the same bird, and the anchor and negative syllables carry different labels, either from the same bird or from an unrelated bird. The loss function to be minimized is:<disp-formula id="equ10"><alternatives><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtext>Loss = </mml:mtext><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mo movablelimits="true" form="prefix">max</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t10">\begin{document}$$\displaystyle  \text{Loss = }\sum _{i = 1}^{N}\max \left (\left |\left |f\left (A_{i}\right) - f\left (P_{i}\right)\right |\right |_{2} - \left |\left |f\left (A_{i}\right) - f\left (N_{i}\right)\right |\right |_{2} + \mathrm{\alpha }, 0\right)$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <italic>N</italic> is the total number of possible triplets in training, <inline-formula><alternatives><mml:math id="inf10"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft10">\begin{document}$f\left (A_{i}\right)$\end{document}</tex-math></alternatives></inline-formula> is the embedding of the anchor in triplet <italic>i</italic>, <inline-formula><alternatives><mml:math id="inf11"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft11">\begin{document}$f(P_i)$\end{document}</tex-math></alternatives></inline-formula> is the embedding of the positive, <inline-formula><alternatives><mml:math id="inf12"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft12">\begin{document}$f(N_i)$\end{document}</tex-math></alternatives></inline-formula> is the embedding of the negative, and α is a margin parameter. If the positive is closer to the anchor than the negative by at least α, the loss for that triplet is 0.</p><p>During training, many randomly sampled triplets will already yield a loss of 0, and therefore will not lead to any change in the model. As a result, such triplets are not presented to the model during training. The remaining triplets that result in a positive loss value can be divided into two groups: hard triplets and semi-hard triplets. Hard triplets are cases where <inline-formula><alternatives><mml:math id="inf13"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>−</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>−</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>N</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft13">\begin{document}$||\, f\left (A\right)\, -\, f\left (P\right)\, ||\, \gt \, ||\, f\left (A\right)\, -\, f\left (N\right)\, ||$\end{document}</tex-math></alternatives></inline-formula>, and semi-hard triplets are cases where <inline-formula><alternatives><mml:math id="inf14"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>−</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>&lt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>−</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>N</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft14">\begin{document}$ ||\, f\left (A\right)\, -\, f\left (P\right)\, ||\, \lt \, ||\, f\left (A\right)\, -\, f\left (N\right)\, ||$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf15"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>−</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>−</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>−</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>N</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mi>α</mml:mi></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft15">\begin{document}$||\, f\left (A\right)\, -\, f\left (P\right)\, ||\, -\, ||\, f\left (A\right)\, -\, f\left (N\right)\, ||\, \gt \alpha $\end{document}</tex-math></alternatives></inline-formula>. Hard triplets result in higher loss values and, therefore, larger model weight updates, which can result in unstable training. Previous studies have shown that, as a result, training with semi-hard triplets alone can lead to faster and more stable model convergence (<xref ref-type="bibr" rid="bib37">Schroff et al., 2015</xref>). We found that we achieved the best model performance when training with a ratio of 75 semi-hard triplets: 25 hard triplets, so this ratio was used to train the final model. A forward pass of the model is performed for each mini-batch in training to determine the ‘hardness’ of all possible triplets from that batch. Triplets are then sampled according to the specified ratio of semi-hard to hard triplets and are presented to the model for training.</p><p>Our approach is said to be <italic>dynamic</italic> triplet loss because the value of the margin parameter <inline-formula><alternatives><mml:math id="inf16"><mml:mi>α</mml:mi></mml:math><tex-math id="inft16">\begin{document}$\alpha $\end{document}</tex-math></alternatives></inline-formula> is updated dynamically over the course of training. The value is initially set to 0.1 and increased stepwise by 0.2 every time a training epoch had fewer than 2500 hard or semi-hard triplets per batch on average, up to a maximum value of 0.7. This allows the model to begin learning an easier task, of separating syllables of different classes by a smaller margin. As the margin increases, the task gradually becomes more difficult, leading to more stable model convergence compared to starting with a higher margin value. Each time the margin parameter is increased, triplets that previously resulted in a loss of 0 can become semi-hard triplets, meaning the set of triplets presented to the model also expands over the course of training. The initial margin value, maximum margin value, margin step size, and non-zero triplet threshold were all determined empirically. The weight optimization was performed with the Adam optimizer, with weight decay of 0.0001 (<xref ref-type="bibr" rid="bib16">Kingma and Ba, 2014</xref>).</p><p>Ultimately, this dynamic triplet loss training constitutes a form of deep metric learning, where high-dimensional inputs (e.g. spectrograms of syllables) are mapped onto a lower-dimensional space where the similarity between samples is proportional to the distance between them. Training with triplets is advantageous in a context where the total amount of labeled training data is limited, as the number of possible triplets is proportional to the cube of the number of training samples.</p></sec><sec id="s4-10-4"><title>VAE</title><p>In addition to using this triplet loss model, we also calculated similarity score using syllable embeddings generated by a variational autoencoder (VAE) model, as described in <xref ref-type="bibr" rid="bib10">Goffinet et al., 2021</xref>. Briefly, using the <italic>autoencoded-vocal-analysis</italic> Python package (<xref ref-type="bibr" rid="bib10">Goffinet et al., 2021</xref>), we trained the base VAE model with an eight-dimensional latent embedding using syllable spectrograms from the 21 UTSW zebra finches used to train the triplet loss model.</p></sec><sec id="s4-10-5"><title>EMD</title><p>Syllable embeddings were obtained by running a forward pass of the trained triplet loss or VAE model with all segmented syllables that an individual bird produced on a given day. This results in a set of thousands of syllables in the 8-dimensional embedding space. Two bird songs are compared by calculating the Earth Mover’s Distance (EMD) between their syllable embeddings using the PyEMD package (<xref ref-type="bibr" rid="bib6">Doran, 2014</xref>). If one were to imagine the syllable embedding empirical distributions as piles of dirt, the earth mover’s distance is the minimum cost of moving the earth from one distribution to match the other, where cost is defined as the amount of dirt moved multiplied by the distance over which it is moved. This value can range from 0 for identical distributions to positive infinity for distributions that are infinitely far apart. As our triplet loss model’s embedding space is limited to points lying on a unit radius 8-dimensional hypersphere, the maximum possible value for EMD is 1.41 for distributions that are each concentrated on a single point, maximally separated within the constraints of the embedding space.</p><p>The EMD score considers many song renditions from each bird being compared, allowing a better overall comparison of the similarity between two birds’ song production as compared to multiple pairwise comparisons between renditions. One limitation of EMD, however, is that it is completely agnostic to syllable sequencing, so a pupil that imitated all syllables from his tutor but sings them in a completely different order will have a similar EMD score to a pupil that imitated all syllables from a tutor and produces them in the same order. That said, there is new evidence that zebra finches recognize songs independently of syllable order, raising questions about the importance of syllable order in song perception (<xref ref-type="bibr" rid="bib30">Ning et al., 2023</xref>). The EMD score is also symmetrical, meaning that the presence of syllables in the tutor’s song that weren’t imitated by the pupil will have the same impact on the EMD score as new, improvised syllables present in the pupil’s song but not in the tutor’s song.</p></sec><sec id="s4-10-6"><title>MMD</title><p>In addition to EMD, we calculate the dissimilarity between distributions of embedded syllables using maximum mean discrepancy (MMD), as in <xref ref-type="bibr" rid="bib10">Goffinet et al., 2021</xref>. MMD compares two distributions of syllables by computing the squared distance between their mean features mapped in a reproducing kernel Hilbert space (RKHS) using a Gaussian radial basis function (RBF) kernel, with a kernel bandwidth equal to half the median pairwise distance between 1000 randomly sampled syllable embeddings from our validation dataset. The result is a measure of the dissimilarity between distributions, where a larger score indicates greater dissimilarity between the two syllable distributions. As with EMD, this is a symmetrical score that doesn’t consider the syllable sequencing similarity between the two birds being compared.</p></sec><sec id="s4-10-7"><title>Similarity scores across comparison types</title><p>To validate the performance of our models and EMD or MMD scores for similarity scoring, we compute EMD and MMD scores between a pupil and itself, a pupil and its tutor, pupil and a ‘sibling’, and a pupil and an unrelated bird. For comparisons between a pupil and itself, embeddings of all recorded syllables from a day of song are computed. If the bird has fewer than 4000 syllables in this dataset, the dataset is randomly split in half and the two halves are compared. If a bird has more than 4000 syllables, two sets of 2000 syllables are randomly sampled and compared. For comparisons between a pupil and its tutor, up to 4000 syllables are sampled from each of the tutor and the pupil and compared. In the case of pupil and ‘sibling’ comparisons, a sibling is defined as another bird sharing the same song tutor. We expect that typical zebra finches that learned from the same tutor will have similar songs, but that these will generally be less similar than a pupil compared to its tutor directly. Each pupil is compared to up to three ‘siblings’, depending on availability in our dataset. Finally, each pupil is compared to three randomly selected pupils who don’t share their song tutor. For each of these comparisons, up to 4000 syllables are randomly sampled from each bird as well, to help reduce the compute time for EMD and MMD.</p></sec><sec id="s4-10-8"><title>Contrast index</title><p>As in <xref ref-type="bibr" rid="bib23">Mandelblat-Cerf and Fee, 2014</xref>, contrast index is calculated as:<disp-formula id="equ11"><alternatives><mml:math id="m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtext>Contrast Index</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mtext>self similarity - cross similarity</mml:mtext><mml:mtext>self similarity + cross similarity</mml:mtext></mml:mfrac></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t11">\begin{document}$$\displaystyle \text{Contrast Index}=\frac{\text{self similarity - cross similarity}}{\text{self similarity + cross similarity}}$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <italic>self-similarity</italic> is the EMD or MMD score between pupil and itself, calculated as described in the previous section, and <italic>cross similarity</italic> is the mean similarity between a pupil and 3 unrelated birds, again calculated as described in the previous section. As EMD and MMD are <italic>dissimilarity</italic> scores, rather than similarity scores, more negative values reflect better contrast between comparisons, so we report the absolute value for ease of comparison to existing similarity scoring methods.</p></sec><sec id="s4-10-9"><title>Tutor contrast index</title><p>Similarly to the contrast index score, the tutor contrast index is calculated as:<disp-formula id="equ12"><alternatives><mml:math id="m12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t12">\begin{document}$$\displaystyle  \rm Tutor\,Contrast\,Index =\frac{tutor\,similarity - cross\,similarity}{tutor\,similarity + cross\,similarity}$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <italic>tutor similarity</italic> is the EMD or MMD score between a pupil and its tutor, calculated as described previously, and <italic>cross similarity</italic> is the mean similarity between a pupil and three unrelated birds. As with the contrast index, absolute values are reported, with higher values indicating larger contrast in score between a pupil vs. tutor comparison and pupil vs. unrelated bird comparison for a given pupil bird.</p></sec><sec id="s4-10-10"><title>Expert human similarity scores</title><p>A panel of 11 expert human annotators was each presented with 126 pairs of spectrograms and was instructed to rate their similarity on a scale from 1 (not similar) to 10 (very similar). The spectrograms were generated using Sound Analysis Pro 2011 (<xref ref-type="bibr" rid="bib43">Tchernichovski et al., 2000</xref>), began at the beginning of a song bout, and included at least one full motif when motif structure was present. Raters were presented with 4 pupil-tutor spectrogram pairs per pupil, 8 comparisons between a tutor and itself to ensure that raters were using the full rating scale, and 10 duplicated tutor-pupil comparisons to ensure that the scorers were internally consistent. No individual scorer differed from the mean score by more than an average of 2 standard deviations, none differed by more than 2 points on the duplicated comparisons, and all but one made use of the full scale (this scorer never assigned a perfect 10/10 score, so their scores were rescaled such that they spanned the full range). Similarity scores for each tutor-pupil pair were obtained by taking the mean similarity score across their 4 spectrogram pairs, across all scorers. The full scoring set is available at <ext-link ext-link-type="uri" xlink:href="https://forms.gle/9TDu1fwGGYXWKhgB6">https://forms.gle/9TDu1fwGGYXWKhgB6</ext-link>. These scores were previously generated for and published in <xref ref-type="bibr" rid="bib9">Garcia-Oscos et al., 2021</xref>. Of the birds evaluated, 15 were also in the similarity scoring validation set, so the correlation between these 15 birds’ mean human similarity scores and tutor-pupil EMD and MMD scores was used to evaluate the agreement between methods.</p><p>For comparison to the expert human similarity scores, Sound Analysis Pro 2011 % similarity scores were calculated for the same set of 15 pupils. A representative motif from the tutor song was selected and compared to between 30 and 60 motif renditions from the pupil bird when the pupil was over 90 dph, using the asymmetric time-courses similarity tool. The final reported scores are the mean % similarity across all comparisons for a given pupil.</p></sec><sec id="s4-10-11"><title>Comparisons to mature song</title><p>For the six birds from UTSW and five birds from Duke University (<xref ref-type="bibr" rid="bib3">Brudner et al., 2023</xref>) from which we had recordings at 90-100d ph and earlier time points, we computed the MMD between their juvenile and adult songs. For each bird, 4000 WhisperSeg segmented syllables were sampled from a full day of song recordings when the birds were between 90 and 100 dph, to serve as the mature song distribution. Up to 4000 WhisperSeg segmented syllables were sampled from each day of available recordings prior to or shortly following the mature song date for comparison. MMD scores were calculated using embeddings from the triplet loss model as described previously. As the scores appeared to follow an exponential pattern, where the rate of song dissimilarity change slowed over development, we fit an exponential function to the data using the scipy.optimize curve_fit() function (<xref ref-type="bibr" rid="bib47">Virtanen et al., 2020</xref>), and plotted this function alongside the data.</p></sec></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Funding acquisition, Validation, Investigation, Visualization, Methodology, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Software, Validation, Visualization, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Supervision, Funding acquisition, Project administration, Writing – review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>Experiments described in this study were conducted using male zebra finches. All procedures were performed in accordance with protocols approved by Animal Care and Use Committee at UT Southwestern Medical Center, protocol number 2016-101562-G.</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-101111-mdarchecklist1-v1.docx" mimetype="application" mime-subtype="docx"/></supplementary-material><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Subject bird list.</title></caption><media xlink:href="elife-101111-supp1-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>Song recordings and annotations for all birds recorded at UTSW are available through the Texas Data Repository (<ext-link ext-link-type="uri" xlink:href="https://dataverse.tdl.org/dataverse/avn">https://dataverse.tdl.org/dataverse/avn</ext-link>). Song recordings from the Rockefeller University Song Library are available at <ext-link ext-link-type="uri" xlink:href="http://ofer.hunter.cuny.edu/songs">http://ofer.hunter.cuny.edu/songs</ext-link>. Annotations of songs from select birds in the Rockefeller Song Library were generated for this publication and are available through the Texas Data Repository (<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.18738/T8/DN0SIV">https://doi.org/10.18738/T8/DN0SIV</ext-link>). Recordings of juvenile birds from Duke University are available at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7924/r4j38x43h">https://doi.org/10.7924/r4j38x43h</ext-link>. Recordings of early-deafened zebra finches are available upon request from Dr. Kazuhiro Wada. The AVN documentation, AVN-GUI, and code necessary to produce all figures in this manuscript can be found through the following links: AVN documentation: <ext-link ext-link-type="uri" xlink:href="https://avn.readthedocs.io/en/latest/index.html">https://avn.readthedocs.io/en/latest/index.html</ext-link>; AVN-GUI: <ext-link ext-link-type="uri" xlink:href="https://avn.readthedocs.io/en/latest/AVN_GUI.html">https://avn.readthedocs.io/en/latest/AVN_GUI.html</ext-link>; Code for figures: <ext-link ext-link-type="uri" xlink:href="https://github.com/theresekoch/AVN_paper">https://github.com/theresekoch/AVN_paper</ext-link> (copy archived at <xref ref-type="bibr" rid="bib17">Koch, 2025a</xref>); Model training: <ext-link ext-link-type="uri" xlink:href="https://github.com/theresekoch/Triplet_loss_model_training">https://github.com/theresekoch/Triplet_loss_model_training</ext-link> (<xref ref-type="bibr" rid="bib18">Koch, 2025b</xref>).</p><p>The following datasets were generated:</p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset1"><person-group person-group-type="author"><name><surname>Koch</surname><given-names>TMI</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>Labeled Zebra Finch Songs</data-title><source>Texas Data Repository</source><pub-id pub-id-type="doi">10.18738/T8/SAWMUN</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset2"><person-group person-group-type="author"><name><surname>Koch</surname><given-names>TMI</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>Labels for Rockefeller Song Library Birds</data-title><source>Texas Data Repository</source><pub-id pub-id-type="doi">10.18738/T8/DN0SIV</pub-id></element-citation></p><p>The following previously published dataset was used:</p><p><element-citation publication-type="data" specific-use="references" id="dataset3"><person-group person-group-type="author"><name><surname>Brudner</surname><given-names>S</given-names></name><name><surname>Pearson</surname><given-names>J</given-names></name><name><surname>Mooney</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>Data from: Juvenile zebra finch syllables for data-driven analysis of development</data-title><source>Duke Research Data Repository</source><pub-id pub-id-type="doi">10.7924/r4j38x43h</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>We thank Fayha Zia for help with manual syllable labeling, Drs. Chihito Mori and Kazuhiro Wada for sharing recordings of early-deafened zebra finches, Drs.Ofer Tchernichovski and Erich Jarvis for publicly sharing the Rockefeller University Field Research Center Song Library, and Dr. Richard Mooney for publicly sharing recordings of juvenile zebra finches across development. We thank Drs. Tyler Lee and Daisuke Hattori for their valuable feedback and suggestions on AVN’s design and validation. We also thank Luis Garcia, Andrea Guerrero, and all members of the Roberts Lab for bird care support and their generous feedback on this work. This research was supported by the US National Institutes of Health R01 DC020333 to TFR. TMIK was supported by a Neural Scientist Training Program Fellowship from the UT Southwestern O’Donnell Brain Institute. ESM was supported by the UTD/UTSW Green Fellowship.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alam</surname><given-names>D</given-names></name><name><surname>Zia</surname><given-names>F</given-names></name><name><surname>Roberts</surname><given-names>TF</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>The hidden fitness of the male zebra finch courtship song</article-title><source>Nature</source><volume>628</volume><fpage>117</fpage><lpage>121</lpage><pub-id pub-id-type="doi">10.1038/s41586-024-07207-4</pub-id><pub-id pub-id-type="pmid">38509376</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aronov</surname><given-names>D</given-names></name><name><surname>Veit</surname><given-names>L</given-names></name><name><surname>Goldberg</surname><given-names>JH</given-names></name><name><surname>Fee</surname><given-names>MS</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Two distinct modes of forebrain circuit dynamics underlie temporal patterning in the vocalizations of young songbirds</article-title><source>The Journal of Neuroscience</source><volume>31</volume><fpage>16353</fpage><lpage>16368</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3009-11.2011</pub-id><pub-id pub-id-type="pmid">22072687</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brudner</surname><given-names>S</given-names></name><name><surname>Pearson</surname><given-names>J</given-names></name><name><surname>Mooney</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Generative models of birdsong learning link circadian fluctuations in song variability to changes in performance</article-title><source>PLOS Computational Biology</source><volume>19</volume><elocation-id>e1011051</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1011051</pub-id><pub-id pub-id-type="pmid">37126511</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Coffey</surname><given-names>KR</given-names></name><name><surname>Marx</surname><given-names>RE</given-names></name><name><surname>Neumaier</surname><given-names>JF</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>DeepSqueak: a deep learning-based system for detection and analysis of ultrasonic vocalizations</article-title><source>Neuropsychopharmacology</source><volume>44</volume><fpage>859</fpage><lpage>868</lpage><pub-id pub-id-type="doi">10.1038/s41386-018-0303-6</pub-id><pub-id pub-id-type="pmid">30610191</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cohen</surname><given-names>Y</given-names></name><name><surname>Nicholson</surname><given-names>DA</given-names></name><name><surname>Sanchioni</surname><given-names>A</given-names></name><name><surname>Mallaber</surname><given-names>EK</given-names></name><name><surname>Skidanova</surname><given-names>V</given-names></name><name><surname>Gardner</surname><given-names>TJ</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Automated annotation of birdsong with a neural network that segments spectrograms</article-title><source>eLife</source><volume>11</volume><elocation-id>e63853</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.63853</pub-id><pub-id pub-id-type="pmid">35050849</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Doran</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2014">2014</year><data-title>PyEMD: earth mover’s distance for python</data-title><version designator="f88bdbe">f88bdbe</version><source>Github</source><ext-link ext-link-type="uri" xlink:href="https://github.com/garydoranjr/pyemd">https://github.com/garydoranjr/pyemd</ext-link></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doupe</surname><given-names>AJ</given-names></name><name><surname>Kuhl</surname><given-names>PK</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Birdsong and human speech: common themes and mechanisms</article-title><source>Annual Review of Neuroscience</source><volume>22</volume><fpage>567</fpage><lpage>631</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.22.1.567</pub-id><pub-id pub-id-type="pmid">10202549</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fabian Pedregosa</surname><given-names>GV</given-names></name><name><surname>Gramfort</surname><given-names>A</given-names></name><name><surname>Michel</surname><given-names>V</given-names></name><name><surname>Thirion</surname><given-names>B</given-names></name><name><surname>Grisel</surname><given-names>O</given-names></name><name><surname>Blondel</surname><given-names>M</given-names></name><name><surname>Prettenhofer</surname><given-names>P</given-names></name><name><surname>Weiss</surname><given-names>R</given-names></name><name><surname>Dubourg</surname><given-names>V</given-names></name><name><surname>Vanderplas</surname><given-names>J</given-names></name><name><surname>Passos</surname><given-names>A</given-names></name><name><surname>Cournapeau</surname><given-names>D</given-names></name><name><surname>Brucher</surname><given-names>M</given-names></name><name><surname>Perrot</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Édouard Duchesnay, Scikit-learn: machine learning in python</article-title><source>Journal of Machine Learning Research</source><volume>12</volume><fpage>2825</fpage><lpage>2830</lpage></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garcia-Oscos</surname><given-names>F</given-names></name><name><surname>Koch</surname><given-names>TMI</given-names></name><name><surname>Pancholi</surname><given-names>H</given-names></name><name><surname>Trusel</surname><given-names>M</given-names></name><name><surname>Daliparthi</surname><given-names>V</given-names></name><name><surname>Co</surname><given-names>M</given-names></name><name><surname>Park</surname><given-names>SE</given-names></name><name><surname>Ayhan</surname><given-names>F</given-names></name><name><surname>Alam</surname><given-names>DH</given-names></name><name><surname>Holdway</surname><given-names>JE</given-names></name><name><surname>Konopka</surname><given-names>G</given-names></name><name><surname>Roberts</surname><given-names>TF</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Autism-linked gene FoxP1 selectively regulates the cultural transmission of learned vocalizations</article-title><source>Science Advances</source><volume>7</volume><elocation-id>eabd2827</elocation-id><pub-id pub-id-type="doi">10.1126/sciadv.abd2827</pub-id><pub-id pub-id-type="pmid">33536209</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goffinet</surname><given-names>J</given-names></name><name><surname>Brudner</surname><given-names>S</given-names></name><name><surname>Mooney</surname><given-names>R</given-names></name><name><surname>Pearson</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Low-dimensional learned feature spaces quantify individual and group differences in vocal repertoires</article-title><source>eLife</source><volume>10</volume><elocation-id>e67855</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.67855</pub-id><pub-id pub-id-type="pmid">33988503</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldberg</surname><given-names>JH</given-names></name><name><surname>Fee</surname><given-names>MS</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Vocal babbling in songbirds requires the basal ganglia-recipient motor thalamus but not the basal ganglia</article-title><source>Journal of Neurophysiology</source><volume>105</volume><fpage>2729</fpage><lpage>2739</lpage><pub-id pub-id-type="doi">10.1152/jn.00823.2010</pub-id><pub-id pub-id-type="pmid">21430276</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Gu</surname><given-names>N</given-names></name><name><surname>Lee</surname><given-names>K</given-names></name><name><surname>Basha</surname><given-names>M</given-names></name><name><surname>Ram</surname><given-names>SK</given-names></name><name><surname>You</surname><given-names>G</given-names></name><name><surname>Hahnloser</surname><given-names>RHR</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Positive Transfer of the Whisper Speech Transformer to Human and Animal Voice Activity Detection</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2023.09.30.560270</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Gu</surname><given-names>N</given-names></name><name><surname>Lee</surname><given-names>K</given-names></name><name><surname>Basha</surname><given-names>M</given-names></name><name><surname>Ram</surname><given-names>SK</given-names></name><name><surname>You</surname><given-names>G</given-names></name><name><surname>Hahnloser</surname><given-names>RHR</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Positive Transfer of the Whisper Speech Transformer to Human and Animal Voice Activity Detection</article-title><conf-name>ICASSP 2024 - 2024 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</conf-name><pub-id pub-id-type="doi">10.1109/ICASSP48485.2024.10447620</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hsu</surname><given-names>AI</given-names></name><name><surname>Yttri</surname><given-names>EA</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>B-SOiD, an open-source unsupervised algorithm for identification and fast prediction of behaviors</article-title><source>Nature Communications</source><volume>12</volume><elocation-id>5188</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-021-25420-x</pub-id><pub-id pub-id-type="pmid">34465784</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hyland Bruno</surname><given-names>J</given-names></name><name><surname>Tchernichovski</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Regularities in zebra finch song beyond the repeated motif</article-title><source>Behavioural Processes</source><volume>163</volume><fpage>53</fpage><lpage>59</lpage><pub-id pub-id-type="doi">10.1016/j.beproc.2017.11.001</pub-id><pub-id pub-id-type="pmid">29122641</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Kingma</surname><given-names>D</given-names></name><name><surname>Ba</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Adam: A Method for Stochastic Optimization</article-title><conf-name>International Conference on Learning Representations</conf-name></element-citation></ref><ref id="bib17"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Koch</surname><given-names>TMI</given-names></name></person-group><year iso-8601-date="2025">2025a</year><data-title>AVN_paper</data-title><version designator="swh:1:rev:9fb6b4d9f512e274ed8d18919ffdc0a85e2f8eea">swh:1:rev:9fb6b4d9f512e274ed8d18919ffdc0a85e2f8eea</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:990f39743883d3448ec0d654d919161eac97417b;origin=https://github.com/theresekoch/AVN_paper;visit=swh:1:snp:f9d82426cd09777039214cce6c27fa4d81c53edc;anchor=swh:1:rev:9fb6b4d9f512e274ed8d18919ffdc0a85e2f8eea">https://archive.softwareheritage.org/swh:1:dir:990f39743883d3448ec0d654d919161eac97417b;origin=https://github.com/theresekoch/AVN_paper;visit=swh:1:snp:f9d82426cd09777039214cce6c27fa4d81c53edc;anchor=swh:1:rev:9fb6b4d9f512e274ed8d18919ffdc0a85e2f8eea</ext-link></element-citation></ref><ref id="bib18"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Koch</surname><given-names>TMI</given-names></name></person-group><year iso-8601-date="2025">2025b</year><data-title>Triplet_loss_model_training</data-title><version designator="621255d">621255d</version><source>Github</source><ext-link ext-link-type="uri" xlink:href="https://github.com/theresekoch/Triplet_loss_model_training">https://github.com/theresekoch/Triplet_loss_model_training</ext-link></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koumura</surname><given-names>T</given-names></name><name><surname>Okanoya</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Automatic recognition of element classes and boundaries in the birdsong with variable sequences</article-title><source>PLOS ONE</source><volume>11</volume><elocation-id>e0159188</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0159188</pub-id><pub-id pub-id-type="pmid">27442240</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kubikova</surname><given-names>L</given-names></name><name><surname>Bosikova</surname><given-names>E</given-names></name><name><surname>Cvikova</surname><given-names>M</given-names></name><name><surname>Lukacova</surname><given-names>K</given-names></name><name><surname>Scharff</surname><given-names>C</given-names></name><name><surname>Jarvis</surname><given-names>ED</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Basal ganglia function, stuttering, sequencing, and repair in adult songbirds</article-title><source>Scientific Reports</source><volume>4</volume><elocation-id>6590</elocation-id><pub-id pub-id-type="doi">10.1038/srep06590</pub-id><pub-id pub-id-type="pmid">25307086</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Lachlan</surname><given-names>RF</given-names></name></person-group><year iso-8601-date="2007">2007</year><data-title>Luscinia: a bioacoustics analysis computer program</data-title><version designator="1.0">1.0</version><source>Sourceforge</source><ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/luscinia/">https://sourceforge.net/projects/luscinia/</ext-link></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lachlan</surname><given-names>RF</given-names></name><name><surname>van Heijningen</surname><given-names>CAA</given-names></name><name><surname>Ter Haar</surname><given-names>SM</given-names></name><name><surname>Ten Cate</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Zebra finch song phonology and syntactical structure across populations and continents-a computational comparison</article-title><source>Frontiers in Psychology</source><volume>7</volume><elocation-id>980</elocation-id><pub-id pub-id-type="doi">10.3389/fpsyg.2016.00980</pub-id><pub-id pub-id-type="pmid">27458396</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mandelblat-Cerf</surname><given-names>Y</given-names></name><name><surname>Fee</surname><given-names>MS</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>An automated procedure for evaluating song imitation</article-title><source>PLOS ONE</source><volume>9</volume><elocation-id>e96484</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0096484</pub-id><pub-id pub-id-type="pmid">24809510</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>McFee</surname><given-names>B</given-names></name><name><surname>McVicar</surname><given-names>M</given-names></name><name><surname>Faronbi</surname><given-names>D</given-names></name><name><surname>Roman</surname><given-names>I</given-names></name><name><surname>Gover</surname><given-names>M</given-names></name><name><surname>Balke</surname><given-names>S</given-names></name><name><surname>Seyfarth</surname><given-names>S</given-names></name><name><surname>Malek</surname><given-names>A</given-names></name><name><surname>Raffel</surname><given-names>C</given-names></name><name><surname>Lostanlen</surname><given-names>V</given-names></name><name><surname>Lee</surname><given-names>D</given-names></name><name><surname>Cwitkowitz</surname><given-names>F</given-names></name><name><surname>Zalkow</surname><given-names>F</given-names></name><name><surname>Oriol</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>Librosa/librosa</data-title><version designator="0.10.1">0.10.1</version><source>Zenodo</source><ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.7746972">https://doi.org/10.5281/zenodo.7746972</ext-link></element-citation></ref><ref id="bib25"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>McInnes</surname><given-names>L</given-names></name><name><surname>Healy</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Accelerated hierarchical density based clustering</article-title><conf-name>2017 IEEE International Conference on Data Mining Workshops (ICDMW)</conf-name><conf-loc>New Orleans, LA</conf-loc><pub-id pub-id-type="doi">10.1109/ICDMW.2017.12</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>McInnes</surname><given-names>L</given-names></name><name><surname>Healy</surname><given-names>J</given-names></name><name><surname>Saul</surname><given-names>N</given-names></name><name><surname>Großberger</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>UMAP: uniform manifold approximation and projection for dimension reduction</article-title><source>arXiv</source><pub-id pub-id-type="doi">10.48550/arXiv.1802.03426</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mets</surname><given-names>DG</given-names></name><name><surname>Brainard</surname><given-names>MS</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>An automated approach to the quantitation of vocalizations and vocal learning in the songbird</article-title><source>PLOS Computational Biology</source><volume>14</volume><elocation-id>e1006437</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006437</pub-id><pub-id pub-id-type="pmid">30169523</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mori</surname><given-names>C</given-names></name><name><surname>Wada</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Audition-independent vocal crystallization associated with intrinsic developmental gene expression dynamics</article-title><source>The Journal of Neuroscience</source><volume>35</volume><fpage>878</fpage><lpage>889</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1804-14.2015</pub-id><pub-id pub-id-type="pmid">25609608</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Nair</surname><given-names>V</given-names></name><name><surname>Hinton</surname><given-names>GE</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Rectified linear units improve restricted boltzmann machines</article-title><conf-name>Proceedings of the 27th International Conference on International Conference on Machine Learning</conf-name><fpage>807</fpage><lpage>814</lpage></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ning</surname><given-names>Z-Y</given-names></name><name><surname>Honing</surname><given-names>H</given-names></name><name><surname>Ten Cate</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Zebra finches (Taeniopygia guttata) demonstrate cognitive flexibility in using phonology and sequence of syllables in auditory discrimination</article-title><source>Animal Cognition</source><volume>26</volume><fpage>1161</fpage><lpage>1175</lpage><pub-id pub-id-type="doi">10.1007/s10071-023-01763-4</pub-id><pub-id pub-id-type="pmid">36934374</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Norton</surname><given-names>P</given-names></name><name><surname>Barschke</surname><given-names>P</given-names></name><name><surname>Scharff</surname><given-names>C</given-names></name><name><surname>Mendoza</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Differential song deficits after lentivirus-mediated knockdown of FoxP1, FoxP2, or FoxP4 in area X of juvenile zebra finches</article-title><source>The Journal of Neuroscience</source><volume>39</volume><fpage>9782</fpage><lpage>9796</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1250-19.2019</pub-id><pub-id pub-id-type="pmid">31641053</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Roeser</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2023">2023</year><source>The Songbird Lateral Habenula Projects to Dopaminergic Midbrain and Is Important for Normal Vocal Development</source><publisher-name>Cold Spring Harbor Laboratory</publisher-name><pub-id pub-id-type="doi">10.7554/eLife.90392</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saar</surname><given-names>S</given-names></name><name><surname>Mitra</surname><given-names>PP</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>A technique for characterizing the development of rhythms in bird song</article-title><source>PLOS ONE</source><volume>3</volume><elocation-id>e1461</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0001461</pub-id><pub-id pub-id-type="pmid">18213370</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sainburg</surname><given-names>T</given-names></name><name><surname>Thielk</surname><given-names>M</given-names></name><name><surname>Gentner</surname><given-names>TQ</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Finding, visualizing, and quantifying latent structure across diverse animal vocal repertoires</article-title><source>PLOS Computational Biology</source><volume>16</volume><elocation-id>e1008228</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1008228</pub-id><pub-id pub-id-type="pmid">33057332</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sánchez-Valpuesta</surname><given-names>M</given-names></name><name><surname>Suzuki</surname><given-names>Y</given-names></name><name><surname>Shibata</surname><given-names>Y</given-names></name><name><surname>Toji</surname><given-names>N</given-names></name><name><surname>Ji</surname><given-names>Y</given-names></name><name><surname>Afrin</surname><given-names>N</given-names></name><name><surname>Asogwa</surname><given-names>CN</given-names></name><name><surname>Kojima</surname><given-names>I</given-names></name><name><surname>Mizuguchi</surname><given-names>D</given-names></name><name><surname>Kojima</surname><given-names>S</given-names></name><name><surname>Okanoya</surname><given-names>K</given-names></name><name><surname>Okado</surname><given-names>H</given-names></name><name><surname>Kobayashi</surname><given-names>K</given-names></name><name><surname>Wada</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Corticobasal ganglia projecting neurons are required for juvenile vocal learning but not for adult vocal plasticity in songbirds</article-title><source>PNAS</source><volume>116</volume><fpage>22833</fpage><lpage>22843</lpage><pub-id pub-id-type="doi">10.1073/pnas.1913575116</pub-id><pub-id pub-id-type="pmid">31636217</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scharff</surname><given-names>C</given-names></name><name><surname>Nottebohm</surname><given-names>F</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>A comparative study of the behavioral deficits following lesions of various parts of the zebra finch song system: implications for vocal learning</article-title><source>The Journal of Neuroscience</source><volume>11</volume><fpage>2896</fpage><lpage>2913</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.11-09-02896.1991</pub-id><pub-id pub-id-type="pmid">1880555</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Schroff</surname><given-names>F</given-names></name><name><surname>Kalenichenko</surname><given-names>D</given-names></name><name><surname>Philbin</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>FaceNet: A unified embedding for face recognition and clustering</article-title><conf-name>2015 IEEE Conference on Computer Vision and Pattern Recognition (CVPR)</conf-name><conf-loc>Boston, MA, USA</conf-loc><pub-id pub-id-type="doi">10.1109/CVPR.2015.7298682</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Servén</surname><given-names>D</given-names></name><name><surname>Brummitt</surname><given-names>C</given-names></name><name><surname>Abedi</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>PyGAM</data-title><version designator="v0.5.1">v0.5.1</version><source>Zenodo</source><ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.1213536">https://doi.org/10.5281/zenodo.1213536</ext-link></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steinfath</surname><given-names>E</given-names></name><name><surname>Palacios-Muñoz</surname><given-names>A</given-names></name><name><surname>Rottschäfer</surname><given-names>JR</given-names></name><name><surname>Yuezak</surname><given-names>D</given-names></name><name><surname>Clemens</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Fast and accurate annotation of acoustic signals with deep neural networks</article-title><source>eLife</source><volume>10</volume><elocation-id>e68837</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.68837</pub-id><pub-id pub-id-type="pmid">34723794</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Szegedy</surname><given-names>C</given-names></name><name><surname>Wei</surname><given-names>L</given-names></name><name><surname>Sermanet</surname><given-names>P</given-names></name><name><surname>Reed</surname><given-names>S</given-names></name><name><surname>Anguelov</surname><given-names>D</given-names></name><name><surname>Erhan</surname><given-names>D</given-names></name><name><surname>Vanhoucke</surname><given-names>V</given-names></name><name><surname>Rabinovich</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Going deeper with convolutions</article-title><conf-name>2015 IEEE Conference on Computer Vision and Pattern Recognition (CVPR)</conf-name><fpage>1</fpage><lpage>9</lpage><pub-id pub-id-type="doi">10.1109/CVPR.2015.7298594</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tanaka</surname><given-names>M</given-names></name><name><surname>Singh Alvarado</surname><given-names>J</given-names></name><name><surname>Murugan</surname><given-names>M</given-names></name><name><surname>Mooney</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Focal expression of mutant huntingtin in the songbird basal ganglia disrupts cortico-basal ganglia networks and vocal sequences</article-title><source>PNAS</source><volume>113</volume><fpage>E1720</fpage><lpage>E7</lpage><pub-id pub-id-type="doi">10.1073/pnas.1523754113</pub-id><pub-id pub-id-type="pmid">26951661</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tchernichovski</surname><given-names>O</given-names></name><name><surname>Nottebohm</surname><given-names>F</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Social inhibition of song imitation among sibling male zebra finches</article-title><source>PNAS</source><volume>95</volume><fpage>8951</fpage><lpage>8956</lpage><pub-id pub-id-type="doi">10.1073/pnas.95.15.8951</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tchernichovski</surname><given-names>O</given-names></name><name><surname>Nottebohm</surname><given-names>F</given-names></name><name><surname>Ho</surname><given-names>C</given-names></name><name><surname>Pesaran</surname><given-names>B</given-names></name><name><surname>Mitra</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>A procedure for an automated measurement of song similarity</article-title><source>Animal Behaviour</source><volume>59</volume><fpage>1167</fpage><lpage>1176</lpage><pub-id pub-id-type="doi">10.1006/anbe.1999.1416</pub-id><pub-id pub-id-type="pmid">10877896</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tchernichovski</surname><given-names>O</given-names></name><name><surname>Eisenberg-Edidin</surname><given-names>S</given-names></name><name><surname>Jarvis</surname><given-names>ED</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Balanced imitation sustains song culture in zebra finches</article-title><source>Nature Communications</source><volume>12</volume><elocation-id>2562</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-021-22852-3</pub-id><pub-id pub-id-type="pmid">33963187</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thakur</surname><given-names>A</given-names></name><name><surname>Thapar</surname><given-names>D</given-names></name><name><surname>Rajan</surname><given-names>P</given-names></name><name><surname>Nigam</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Deep metric learning for bioacoustic classification: Overcoming training data scarcity using dynamic triplet loss</article-title><source>The Journal of the Acoustical Society of America</source><volume>146</volume><elocation-id>534</elocation-id><pub-id pub-id-type="doi">10.1121/1.5118245</pub-id><pub-id pub-id-type="pmid">31370640</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tumer</surname><given-names>EC</given-names></name><name><surname>Brainard</surname><given-names>MS</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Performance variability enables adaptive plasticity of “crystallized” adult birdsong</article-title><source>Nature</source><volume>450</volume><fpage>1240</fpage><lpage>1244</lpage><pub-id pub-id-type="doi">10.1038/nature06390</pub-id><pub-id pub-id-type="pmid">18097411</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Virtanen</surname><given-names>P</given-names></name><name><surname>Gommers</surname><given-names>R</given-names></name><name><surname>Oliphant</surname><given-names>TE</given-names></name><name><surname>Haberland</surname><given-names>M</given-names></name><name><surname>Reddy</surname><given-names>T</given-names></name><name><surname>Cournapeau</surname><given-names>D</given-names></name><name><surname>Burovski</surname><given-names>E</given-names></name><name><surname>Peterson</surname><given-names>P</given-names></name><name><surname>Weckesser</surname><given-names>W</given-names></name><name><surname>Bright</surname><given-names>J</given-names></name><name><surname>van der Walt</surname><given-names>SJ</given-names></name><name><surname>Brett</surname><given-names>M</given-names></name><name><surname>Wilson</surname><given-names>J</given-names></name><name><surname>Millman</surname><given-names>KJ</given-names></name><name><surname>Mayorov</surname><given-names>N</given-names></name><name><surname>Nelson</surname><given-names>ARJ</given-names></name><name><surname>Jones</surname><given-names>E</given-names></name><name><surname>Kern</surname><given-names>R</given-names></name><name><surname>Larson</surname><given-names>E</given-names></name><name><surname>Carey</surname><given-names>CJ</given-names></name><name><surname>Polat</surname><given-names>İ</given-names></name><name><surname>Feng</surname><given-names>Y</given-names></name><name><surname>Moore</surname><given-names>EW</given-names></name><name><surname>VanderPlas</surname><given-names>J</given-names></name><name><surname>Laxalde</surname><given-names>D</given-names></name><name><surname>Perktold</surname><given-names>J</given-names></name><name><surname>Cimrman</surname><given-names>R</given-names></name><name><surname>Henriksen</surname><given-names>I</given-names></name><name><surname>Quintero</surname><given-names>EA</given-names></name><name><surname>Harris</surname><given-names>CR</given-names></name><name><surname>Archibald</surname><given-names>AM</given-names></name><name><surname>Ribeiro</surname><given-names>AH</given-names></name><name><surname>Pedregosa</surname><given-names>F</given-names></name><name><surname>van Mulbregt</surname><given-names>P</given-names></name><name><surname>Vijaykumar</surname><given-names>A</given-names></name><name><surname>Bardelli</surname><given-names>AP</given-names></name><name><surname>Rothberg</surname><given-names>A</given-names></name><name><surname>Hilboll</surname><given-names>A</given-names></name><name><surname>Kloeckner</surname><given-names>A</given-names></name><name><surname>Scopatz</surname><given-names>A</given-names></name><name><surname>Lee</surname><given-names>A</given-names></name><name><surname>Rokem</surname><given-names>A</given-names></name><name><surname>Woods</surname><given-names>CN</given-names></name><name><surname>Fulton</surname><given-names>C</given-names></name><name><surname>Masson</surname><given-names>C</given-names></name><name><surname>Häggström</surname><given-names>C</given-names></name><name><surname>Fitzgerald</surname><given-names>C</given-names></name><name><surname>Nicholson</surname><given-names>DA</given-names></name><name><surname>Hagen</surname><given-names>DR</given-names></name><name><surname>Pasechnik</surname><given-names>DV</given-names></name><name><surname>Olivetti</surname><given-names>E</given-names></name><name><surname>Martin</surname><given-names>E</given-names></name><name><surname>Wieser</surname><given-names>E</given-names></name><name><surname>Silva</surname><given-names>F</given-names></name><name><surname>Lenders</surname><given-names>F</given-names></name><name><surname>Wilhelm</surname><given-names>F</given-names></name><name><surname>Young</surname><given-names>G</given-names></name><name><surname>Price</surname><given-names>GA</given-names></name><name><surname>Ingold</surname><given-names>GL</given-names></name><name><surname>Allen</surname><given-names>GE</given-names></name><name><surname>Lee</surname><given-names>GR</given-names></name><name><surname>Audren</surname><given-names>H</given-names></name><name><surname>Probst</surname><given-names>I</given-names></name><name><surname>Dietrich</surname><given-names>JP</given-names></name><name><surname>Silterra</surname><given-names>J</given-names></name><name><surname>Webber</surname><given-names>JT</given-names></name><name><surname>Slavič</surname><given-names>J</given-names></name><name><surname>Nothman</surname><given-names>J</given-names></name><name><surname>Buchner</surname><given-names>J</given-names></name><name><surname>Kulick</surname><given-names>J</given-names></name><name><surname>Schönberger</surname><given-names>JL</given-names></name><name><surname>de Miranda Cardoso</surname><given-names>JV</given-names></name><name><surname>Reimer</surname><given-names>J</given-names></name><name><surname>Harrington</surname><given-names>J</given-names></name><name><surname>Rodríguez</surname><given-names>JLC</given-names></name><name><surname>Nunez-Iglesias</surname><given-names>J</given-names></name><name><surname>Kuczynski</surname><given-names>J</given-names></name><name><surname>Tritz</surname><given-names>K</given-names></name><name><surname>Thoma</surname><given-names>M</given-names></name><name><surname>Newville</surname><given-names>M</given-names></name><name><surname>Kümmerer</surname><given-names>M</given-names></name><name><surname>Bolingbroke</surname><given-names>M</given-names></name><name><surname>Tartre</surname><given-names>M</given-names></name><name><surname>Pak</surname><given-names>M</given-names></name><name><surname>Smith</surname><given-names>NJ</given-names></name><name><surname>Nowaczyk</surname><given-names>N</given-names></name><name><surname>Shebanov</surname><given-names>N</given-names></name><name><surname>Pavlyk</surname><given-names>O</given-names></name><name><surname>Brodtkorb</surname><given-names>PA</given-names></name><name><surname>Lee</surname><given-names>P</given-names></name><name><surname>McGibbon</surname><given-names>RT</given-names></name><name><surname>Feldbauer</surname><given-names>R</given-names></name><name><surname>Lewis</surname><given-names>S</given-names></name><name><surname>Tygier</surname><given-names>S</given-names></name><name><surname>Sievert</surname><given-names>S</given-names></name><name><surname>Vigna</surname><given-names>S</given-names></name><name><surname>Peterson</surname><given-names>S</given-names></name><name><surname>More</surname><given-names>S</given-names></name><name><surname>Pudlik</surname><given-names>T</given-names></name><name><surname>Oshima</surname><given-names>T</given-names></name><name><surname>Pingel</surname><given-names>TJ</given-names></name><name><surname>Robitaille</surname><given-names>TP</given-names></name><name><surname>Spura</surname><given-names>T</given-names></name><name><surname>Jones</surname><given-names>TR</given-names></name><name><surname>Cera</surname><given-names>T</given-names></name><name><surname>Leslie</surname><given-names>T</given-names></name><name><surname>Zito</surname><given-names>T</given-names></name><name><surname>Krauss</surname><given-names>T</given-names></name><name><surname>Upadhyay</surname><given-names>U</given-names></name><name><surname>Halchenko</surname><given-names>YO</given-names></name><name><surname>Vázquez-Baeza</surname><given-names>Y</given-names></name><collab>SciPy 1.0 Contributors</collab></person-group><year iso-8601-date="2020">2020</year><article-title>SciPy 1.0: fundamental algorithms for scientific computing in Python</article-title><source>Nature Methods</source><volume>17</volume><fpage>261</fpage><lpage>272</lpage><pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id><pub-id pub-id-type="pmid">32015543</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wiltschko</surname><given-names>AB</given-names></name><name><surname>Tsukahara</surname><given-names>T</given-names></name><name><surname>Zeine</surname><given-names>A</given-names></name><name><surname>Anyoha</surname><given-names>R</given-names></name><name><surname>Gillis</surname><given-names>WF</given-names></name><name><surname>Markowitz</surname><given-names>JE</given-names></name><name><surname>Peterson</surname><given-names>RE</given-names></name><name><surname>Katon</surname><given-names>J</given-names></name><name><surname>Johnson</surname><given-names>MJ</given-names></name><name><surname>Datta</surname><given-names>SR</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Revealing the structure of pharmacobehavioral space through motion sequencing</article-title><source>Nature Neuroscience</source><volume>23</volume><fpage>1433</fpage><lpage>1443</lpage><pub-id pub-id-type="doi">10.1038/s41593-020-00706-3</pub-id><pub-id pub-id-type="pmid">32958923</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xiao</surname><given-names>L</given-names></name><name><surname>Merullo</surname><given-names>DP</given-names></name><name><surname>Koch</surname><given-names>TMI</given-names></name><name><surname>Cao</surname><given-names>M</given-names></name><name><surname>Co</surname><given-names>M</given-names></name><name><surname>Kulkarni</surname><given-names>A</given-names></name><name><surname>Konopka</surname><given-names>G</given-names></name><name><surname>Roberts</surname><given-names>TF</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Expression of FoxP2 in the basal ganglia regulates vocal motor sequences in the adult songbird</article-title><source>Nature Communications</source><volume>12</volume><elocation-id>2617</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-021-22918-2</pub-id><pub-id pub-id-type="pmid">33976169</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.101111.3.sa0</article-id><title-group><article-title>eLife Assessment</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Goldberg</surname><given-names>Jesse H</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution>Cornell University</institution><country>United States</country></aff></contrib></contrib-group><kwd-group kwd-group-type="evidence-strength"><kwd>Convincing</kwd></kwd-group><kwd-group kwd-group-type="claim-importance"><kwd>Useful</kwd></kwd-group></front-stub><body><p>This work introduces a new Python package, Avian Vocalization Analysis (AVN) that provides several key analysis pipelines for birdsong research. This tool is likely to prove <bold>useful</bold> to researchers in neuroscience and beyond, as demonstrated by <bold>convincing</bold> experiments using a wide range of publicly available birdsong data.</p></body></sub-article><sub-article article-type="referee-report" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.101111.3.sa1</article-id><title-group><article-title>Reviewer #2 (Public review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>In this work, the authors present a new Python software package, Avian Vocalization Network (AVN) aimed at facilitating the analysis of birdsong, especially the song of the zebra finch, the most common songbird model in neuroscience. The package handles some of the most common (and some more advanced) song analyses, including segmentation, syllable classification, featurization of song, calculation of tutor-pupil similarity, and age prediction, with a view toward making the entire process friendlier to experimentalists with limited coding experience working in the field.</p><p>For many years, Sound Analysis Pro has served as a standard in the songbird field, the first package to extensively automate songbird analysis and facilitate the computation of acoustic features that have helped define the field. More recently, the increasing popularity of Python as a language, along with the emergence of new machine learning methods, has resulted in a number of new software tools, including the vocalpy ecosystem for audio processing, TweetyNet (for segmentation), t-SNE and UMAP (for visualization), and autoencoder-based approaches for embedding.</p><p>As with any software package, this one necessarily makes a number of design choices, which may or may not fit the needs of all users. Those who prefer a more automated pipeline with fewer knobs to turn may appreciate AVN in cases where the existing recipes fit their needs, while those who require more customization and flexibility may require a more bespoke (and thus code-intensive) approach.</p><p>Strengths:</p><p>The AVN package overlaps several of these earlier efforts, albeit with a focus on more traditional featurization that many experimentalists may find more interpretable than deep learning-based approaches. Among the strengths of the paper are its clarity in explaining the several analyses it facilitates, along with high-quality experiments across multiple public datasets collected from different research groups. As a software package, it is open source, installable via the pip Python package manager, and features high-quality documentation, as well as tutorials. For experimentalists who wish to replicate any of the analyses from the paper, the package is likely to be a useful time saver.</p><p>Weaknesses:</p><p>I think the potential limitations of the work are predominantly on the software end, with one or two quibbles about the methods.</p><p>First, the software: It's important to note that the package is trying to do many things, of which it is likely to do several well and a few comprehensively. Rather than a package that presents a number of new analyses or a new analysis framework, it is more a codification of recipes, some of which are reimplementations of existing work (SAP features), some of which are essentially wrappers around other work (interfacing with WhisperSeg segmentations), and some of which are new (similarity scoring). All of this has value, but in my estimation, it has less value as part of a standalone package and potentially much more as part of an ecosystem like vocalpy that is undergoing continuous development and has long-term support. While the code is well-documented, including web-based documentation for both the core package and the GUI, the latter is available only on Windows, which might limit the scope of adoption.</p><p>That is to say, whether AVN is adopted by the field in the medium term will have much more to do with the quality of its maintenance and responsiveness to users than any particular feature, but I believe that many of the analysis recipes that the authors have carefully worked out may find their way into other code and workflows.</p><p>In the revised version of the paper, the authors have expanded their case for the design choices made in AVN and remain committed to maintaining the tool. Given the low cost for users in trying new methods and the work the authors have put into further reducing this overhead via documentation, those curious about the package are likely best served by simply downloading it and giving it a try on their own data.</p><p>Second, two notes about new analysis approaches:</p><p>(1) The authors propose a new means of measuring tutor-pupil similarity based on first learning a latent space of syllables via a self-supervised learning (SSL) scheme and then using the earth mover's distance (EMD) to calculate transport costs between the distributions of tutors' and pupils' syllables. While, to my knowledge, this exact method has not previously been proposed in birdsong, I suspect it is unlikely to differ substantially from the approach of autoencoding followed by MMD used in the Goffinet et al. paper. That is, SSL, like the autoencoder, is a latent space learning approach, and EMD, like MMD, is an integral probability metric that measures discrepancies between two distributions. (Indeed, the two are very closely related: <ext-link ext-link-type="uri" xlink:href="https://stats.stackexchange.com/questions/400180/earth-movers-distance-and-maximum-mean-discrepency">https://stats.stackexchange.com/questions/400180/earth-movers-distance-and-maximum-mean-discrepency</ext-link>) Without further experiments, it is hard to tell whether these two approaches differ meaningfully. Likewise, while the authors have trained on a large corpus of syllables to define their latent space in a way that generalizes to new birds, it is unclear why such an approach would not work with other latent space learning methods.</p><p>Update: The authors now provide an extensive comparison with the Goffinet et al. paper and also consider differences between MMD and EMD. This comparison both adds value to the original paper and provides useful benchmarking for others looking to develop latent space comparison methods.</p><p>(2) The authors propose a new method for maturity scoring by training a model (a generalized additive model) to predict the age of the bird based on a selected subset of acoustic features. This is distinct from the &quot;predicted age&quot; approach of Brudner, Pearson, and Mooney, which predicts based on a latent representation rather than specific features, and the GAM nicely segregates the contribution of each. As such, this approach may be preferred by many users who appreciate its interpretability.</p><p>In summary, my view is that this is a nice paper detailing a well-executed piece of software whose future impact will be determined by the degree of support and maintenance it receives from others over the near and medium term.</p></body></sub-article><sub-article article-type="referee-report" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.101111.3.sa2</article-id><title-group><article-title>Reviewer #3 (Public review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>This paper introduces the Avian Vocalization Network (AVN), a novel birdsong analysis pipeline using deep learning. By automating vocal annotation tasks, the AVN generates interpretable song features and song similarity scores on novel datasets without retraining. The performance of the network is solid and is comparable to that of human annotators.</p><p>The authors have improved the manuscript in several aspects, such as the comparison with the Goffinet work. Overall, the AVN feature set could become a useful tool for evaluating birdsongs. But the authors also chose not to address a certain number of criticisms, and some issues remain poorly addressed, and the work is not reproducible at this stage. With a little effort, these issues could get resolved in my view. I will just pick on four issues that I think can be easily addressed:</p><p>(1) Limitation of feature set: They claim that AVN satisfies the criteria (line 60) of &quot;creating a common feature space for the comparison of behavioural phenotypes ...&quot;(line 51), but then on LDA analysis, explained on line 910 they say &quot;excluding amplitude and amplitude modulation features as they were found to vary&quot;. Since their feature set is not stable and not truly 'common' to all tasks, this limitation needs addressing in the discussion (that some features seem to vary undesirably, and they need exclusion based on some criteria to be defined).</p><p>(2) Missing information on classification training loss: The Authors insist that their triplet loss is not related to classification, and they brush off my request for more information. In their rebuttal, they write: 'The loss function is related to the relative distance between embeddings of syllables with the same or different labels, not the classification of syllables as same or different.' Perplexingly, however, in the revised paper, authors speak themselves of 'classes', in Line 1004: this allows the model to begin learning an easier task, of separating syllables of different classes by a smaller margin.' So it seems the authors actually agree with me that there is an underlying classification task. I am therefore going to make it a bit more explicit here what I'm asking for, hoping this will better resonate with them.</p><p>In line 984 they define their loss function and in lines 994-996 they define 'hard' and 'semi-hard' triplets. Authors then train a system to minimize the loss with a ratio of 75 percent semi-hard triplets and 25 percent hard triplets and a final weighing parameter value alpha=0.7. What I'm asking for is this 'classification' loss their trained model achieves, or in other words, the fraction of triplets that end up producing a loss, either of the 'hard' or 'semi-hard' type. For example, if their model manages to separate all 'possible triplets' by a margin of at least alpha, then the loss would be zero. If the model achieves to separate all triplets except one, then the loss would correspond to the amount by which the separation differences between the anchor and the positive vs negative samples exceeds alpha. So, an important number to provide in the paper is the fraction of triplets that incur a nonzero loss, i.e., the fraction of semi-hard triplets. And another important quantity is the fraction of hard triplets, i.e. the fraction of triplets that would incur a loss if alpha were set to zero, or, in other words, the triplets for which the negative sample is closer to the anchor than the positive sample. By the way, I assume this latter fraction of hard cases will be zero - that their model does not confuse any positive and negative training samples...</p><p>Note: the quantification chosen by the authors termed 'contrast index' is interesting, but it is a derived quantity, it is not the quantity authors chose to optimize during training. If authors were to report both the training loss achieved and the 'contrast index', follow-up work could be benchmarked against both these quantities. If for example, a follow-up model achieves smaller loss but worse contrast, then the loss is not a good placeholder measure for optimizing contrast. Alternatively, follow-up work could focus on the contrast index as training objective, obliterating the need for the triplet loss as an intermediate step (I don't buy the authors' argument that such an optimization would be infeasible).</p><p>(3) Reproducibility: they explain the way they train the CNN with triplet loss to produce the embeddings, but we're missing both actual scripts on GitHub to train and inference from scratch, and model weights, or even hyper parameters they used. Authors only provide the architecture, and I don't think that's enough to be considered replicable in today's standards. I would suggest they release complete model checkpoint weights for the result they report, the exact data splits, the hyper parameters they used and training and testing code, so that one can very easily verify their claims and apply their methods to other datasets. Note: for example, the code to extract the embeddings is incomplete (the function definition of single_bird_extract_embeddings cannot be found on GitHub) and the model weights they used are missing.</p><p>(4) With regards to the age prediction model, the authors should specify that this model is mainly useful for comparisons across studies but less so for precise evaluation of the effects of a treatment within a study. Namely, the effect on song of a treatment is best assessed by comparison to within-subject past song, and by comparison to age-matched control birds (ideally siblings) raised in identical conditions, rather than to invoke a generic model trained on other birds and from different colonies and breeding conditions as authors propose to do. In other words, to introduce a generic model for evaluation of song maturity introduces measurement noise in terms of the additional birds and their variable conditions, which can hinder precise assessment of treatment effects. Note that to state that in past work such maturity models were used is not a good justification, scientifically speaking.</p><p>Finally, the authors write that methods for syllable segmentation have not been systematically compared but the whisperseg work they use did such a comparison. So the authors should revise their novelty claim of being the first to compare syllable segmentation methods.</p></body></sub-article><sub-article article-type="author-comment" id="sa3"><front-stub><article-id pub-id-type="doi">10.7554/eLife.101111.3.sa3</article-id><title-group><article-title>Author response</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Koch</surname><given-names>Therese MI</given-names></name><role specific-use="author">Author</role><aff><institution>The University of Texas Southwestern Medical Center</institution><addr-line><named-content content-type="city">Dallas</named-content></addr-line><country>United States</country></aff></contrib><contrib contrib-type="author"><name><surname>Marks</surname><given-names>Ethan S</given-names></name><role specific-use="author">Author</role><aff><institution>The University of Texas Southwestern Medical Center</institution><addr-line><named-content content-type="city">Dallas</named-content></addr-line><country>United States</country></aff></contrib><contrib contrib-type="author"><name><surname>Roberts</surname><given-names>Todd F</given-names></name><role specific-use="author">Author</role><aff><institution>Department of Neuroscience, UT Southwestern Medical Center</institution><addr-line><named-content content-type="city">Dallas</named-content></addr-line><country>United States</country></aff></contrib></contrib-group></front-stub><body><p>The following is the authors’ response to the original reviews.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #1 (Public Review):</bold></p><p>Summary:</p><p>This paper applies methods for segmentation, annotation, and visualization of acoustic analysis to zebra finch song. The paper shows that these methods can be used to predict the stage of song development and to quantify acoustic similarity. The methods are solid and are likely to provide a useful tool for scientists aiming to label large datasets of zebra finch vocalizations. The paper has two main parts: (1) establishing a pipeline/ package for analyzing zebra finch birdsong and (2) a method for measuring song imitation.</p><p>Strengths:</p><p>It is useful to see existing methods for syllable segmentation compared to new datasets.</p><p>It is useful, but not surprising, that these methods can be used to predict developmental stage, which is strongly associated with syllable temporal structure.</p><p>It is useful to confirm that these methods can identify abnormalities in deafened and isolated songs.</p><p>Weaknesses:</p><p>For the first part, the implementation seems to be a wrapper on existing techniques. For instance, the first section talks about syllable segmentation; they made a comparison between whisperseg (Gu et al, 2024), tweetynet (Cohen et al, 2022), and amplitude thresholding. They found that whisperseg performed the best, and they included it in the pipeline. They then used whisperseg to analyze syllable duration distributions and rhythm of birds of different ages and confirmed past findings on this developmental process (e.g. Aronov et al, 2011). Next, based on the segmentation, they assign labels by performing UMAP and HDBScan on the spectrogram (nothing new; that's what people have been doing). Then, based on the labels, they claimed they developed a 'new' visualization - syntax raster (line 180). That was done by Sainburg et. al. 2020 in Figure 12E and also in Cohen et al, 2020 - so the claim to have developed 'a new song syntax visualization' is confusing. The rest of the paper is about analyzing the finch data based on AVN features (which are essentially acoustic features already in the classic literature).</p></disp-quote><p>First, we would like to thank this reviewer for their kind comments and feedback on this manuscript. It is true that many of the components of this song analysis pipeline are not entirely novel in isolation. Our real contribution here is bringing them together in a way that allows other researchers to seamlessly apply automated syllable segmentation, clustering, and downstream analyses to their data. That said, our approach to training TweetyNet for syllable segmentation is novel. We trained TweetyNet to recognize vocalizations vs. silence across multiple birds, such that it can generalize to new individual birds, whereas Tweetynet had only ever been used to annotate song syllables from birds included in its training set previously. Our validation of TweetyNet and WhisperSeg in combination with UMAP and HDBSCAN clustering is also novel, providing valuable information about how these systems interact, and how reliable the completely automatically generated labels are for downstream analysis. We have added a couple sentences to the introduction to emphasize the novelty of this approach and validation.</p><p>Our syntax raster visualization does resemble Figure 12E in Sainburg et al. 2020, however it differs in a few important ways, which we believe warrant its consideration as a novel visualization method. First, Sainburg et al. represent the labels across bouts in real time; their position along the x axis reflects the time at which each syllable is produced relative to the start of the bout. By contrast, our visualization considers only the index of syllables within a bout (ie. First syllable vs. second syllable etc) without consideration of the true durations of each syllable or the silent gaps between them. This makes it much easier to detect syntax patterns across bouts, as the added variability of syllable timing is removed. Considering only the sequence of syllables rather than their timing also allows us to more easily align bouts according to the first syllable of a motif, further emphasizing the presence or absence of repeating syllable sequences without interference from the more variable introductory notes at the start of a motif. Finally, instead of plotting all bouts in the order in which they were produced, our visualization orders bouts such that bouts with the same sequence of syllables will be plotted together, which again serves to emphasize the most common syllable sequences that the bird produces. These additional processing steps mean that our syntax raster plot has much starker contrast between birds with stereotyped syntax and birds with more variable syntax, as compared to the more minimally processed visualization in Sainburg et al. 2020. There doesn’t appear to be any similar visualizations in Cohen et al. 2020.</p><disp-quote content-type="editor-comment"><p>The second part may be something new, but there are opportunities to improve the benchmarking. It is about the pupil-tutor imitation analysis. They introduce a convolutional neural network that takes triplets as an input (each tripled is essentially 3 images stacked together such that you have anchor, positive, negative), Anchor is a reference spectrogram from, say finch A; positive means a different spectrogram with the same label as anchor from finch A, and negative means a spectrogram not related to A or different syllable label from A. The network is then trained to produce a low-dimensional embedding by ensuring the embedding distance between anchor and positive is less than anchor and negative by a certain margin. Based on the embedding, they then made use of earth mover distance to quantify the similarity in the syllable distribution among finches. They then compared their approach performance with that of sound analysis pro (SAP) and a variant of SAP. A more natural comparison, which they didn't include, is with the VAE approach by Goffinet et al. In this paper (<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7554/eLife.67855">https://doi.org/10.7554/eLife.67855</ext-link>, Fig 7), they also attempted to perform an analysis on the tutor pupil song.</p></disp-quote><p>We thank the reviewer for this suggestion. We have included a comparison of our triplet loss embedding model to the VAE model proposed in Goffinet et al. 2021. We also included comparisons of similarity scoring using each of these embedding models combined with either earth mover’s distance (EMD) or maximum mean discrepancy (MMD) to calculate the similarity of the embeddings, as was done in Goffinet et al. 2021. As discussed in the updated results section of the paper and shown in the new Figure 6–figure supplement 1, the Triplet loss model with MMD performs best for evaluating song learning on new birds, not included in model training. We’ve updated the main text of the paper to reflect this switch from EMD to MMD for the primary similarity scoring approach.</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Public Review):</p><p>Summary:</p><p>In this work, the authors present a new Python software package, Avian Vocalization Network (AVN) aimed at facilitating the analysis of birdsong, especially the song of the zebra finch, the most common songbird model in neuroscience. The package handles some of the most common (and some more advanced) song analyses, including segmentation, syllable classification, featurization of song, calculation of tutor-pupil similarity, and age prediction, with a view toward making the entire process friendlier to experimentalists working in the field.</p><p>For many years, Sound Analysis Pro has served as a standard in the songbird field, the first package to extensively automate songbird analysis and facilitate the computation of acoustic features that have helped define the field. More recently, the increasing popularity of Python as a language, along with the emergence of new machine learning methods, has resulted in a number of new software tools, including the vocalpy ecosystem for audio processing, TweetyNet (for segmentation), t-SNE and UMAP (for visualization), and autoencoder-based approaches for embedding.</p><p>Strengths:</p><p>The AVN package overlaps several of these earlier efforts, albeit with a focus on more traditional featurization that many experimentalists may find more interpretable than deep learning-based approaches. Among the strengths of the paper are its clarity in explaining the several analyses it facilitates, along with high-quality experiments across multiple public datasets collected from different research groups. As a software package, it is open source, installable via the pip Python package manager, and features high-quality documentation, as well as tutorials. For experimentalists who wish to replicate any of the analyses from the paper, the package is likely to be a useful time saver.</p><p>Weaknesses:</p><p>I think the potential limitations of the work are predominantly on the software end, with one or two quibbles about the methods.</p><p>First, the software: it's important to note that the package is trying to do many things, of which it is likely to do several well and few comprehensively. Rather than a package that presents a number of new analyses or a new analysis framework, it is more a codification of recipes, some of which are reimplementations of existing work (SAP features), some of which are essentially wrappers around other work (interfacing with WhisperSeg segmentations), and some of which are new (similarity scoring). All of this has value, but in my estimation, it has less value as part of a standalone package and potentially much more as part of an ecosystem like vocalpy that is undergoing continuous development and has long-term support.</p></disp-quote><p>We appreciate this reviewer’s comments and concerns about the structure of the AVN package and its long-term maintenance. We have considered incorporating AVN into the VocalPy ecosystem but have chosen not to for a few key reasons. (1) AVN was designed with ease of use for experimenters with limited coding experience top of mind. VocalPy provides excellent resources for researchers with some familiarity with object-oriented programming to manage and analyze their datasets; however, we believe it may be challenging for users without such experience to adopt VocalPy quickly. AVN’s ‘recipe’ approach, as you put it, is very easily accessible to new users, and allows users with intermediate coding experience to easily navigate the source code to gain a deeper understanding of the methodology. AVN also consistently outputs processed data in familiar formats (tables in .csv files which can be opened in excel), in an effort to make it more accessible to new users, something which would be challenging to reconcile with VocalPy’s emphasis on their `dataset`classes. (2) AVN and VocalPy differ in their underlying goals and philosophies when it comes to flexibility vs. standardization of analysis pipelines. VocalPy is designed to facilitate mixing-and-matching of different spectrogram generation, segmentation, annotation etc. approaches, so that researchers can design and implement their own custom analysis pipelines. This flexibility is useful in many cases. For instance, it could allow researchers who have very different noise filtering and annotation needs, like those working with field recordings versus acoustic chamber recordings, to analyze their data using this platform. However, when it comes to comparisons across zebra finch research labs, this flexibility comes at the expense of direct comparison and integration of song features across research groups. This is the context in which AVN is most useful. It presents a single approach to song segmentation, labeling, and featurization that has been shown to generalize well across research groups, and which allows direct comparisons of the resulting features. AVN’s single, extensively validated, standard pipeline approach is fundamentally incompatible with VocalPy’s emphasis on flexibility. We are excited to see how VocalPy continues to evolve in the future, and recognize the value that both AVN and VocalPy bring to the songbird research community, each with their own distinct strengths, weaknesses, and ideal use cases.</p><disp-quote content-type="editor-comment"><p>While the code is well-documented, including web-based documentation for both the core package and the GUI, the latter is available only on Windows, which might limit the scope of adoption.</p></disp-quote><p>We thank the reviewer for their kind words about AVN’s documentation. We recognize that the GUI’s exclusive availability on Windows is a limitation, and we would be happy to collaborate with other researchers and developers in the future to build a Mac compatible version, should the demand present itself. That said, the python package works on all operating systems, so non-Windows users still have the ability to use AVN that way.</p><disp-quote content-type="editor-comment"><p>That is to say, whether AVN is adopted by the field in the medium term will have much more to do with the quality of its maintenance and responsiveness to users than any particular feature, but I believe that many of the analysis recipes that the authors have carefully worked out may find their way into other code and workflows.</p><p>Second, two notes about new analysis approaches:</p><p>(1) The authors propose a new means of measuring tutor-pupil similarity based on first learning a latent space of syllables via a self-supervised learning (SSL) scheme and then using the earth mover's distance (EMD) to calculate transport costs between the distributions of tutors' and pupils' syllables. While to my knowledge this exact method has not previously been proposed in birdsong, I suspect it is unlikely to differ substantially from the approach of autoencoding followed by MMD used in the Goffinet et al. paper. That is, SSL, like the autoencoder, is a latent space learning approach, and EMD, like MMD, is an integral probability metric that measures discrepancies between two distributions. (Indeed, the two are very closely related: <ext-link ext-link-type="uri" xlink:href="https://stats.stackexchange.com/questions/400180/earth-movers-distance-and-maximum-mean-discrepency">https://stats.stackexchange.com/questions/400180/earth-movers-distance-and-maximum-mean-discrepency</ext-link>) Without further experiments, it is hard to tell whether these two approaches differ meaningfully. Likewise, while the authors have trained on a large corpus of syllables to define their latent space in a way that generalizes to new birds, it is unclear why such an approach would not work with other latent space learning methods.</p></disp-quote><p>We recognize the similarities between these approaches and have included comparisons of the VAE and MMD as in the Goffinet paper to our triplet loss model and EMD. As discussed in the updated results section of the paper and shown in the new Figure 6–figure supplement 1, the Triplet loss model with MMD performs best for evaluating song learning on new birds, not included in model training. We’ve updated the main text of the paper to reflect this switch from EMD to MMD for the primary similarity scoring approach.</p><disp-quote content-type="editor-comment"><p>(2) The authors propose a new method for maturity scoring by training a model (a generalized additive model) to predict the age of the bird based on a selected subset of acoustic features. This is distinct from the &quot;predicted age&quot; approach of Brudner, Pearson, and Mooney, which predicts based on a latent representation rather than specific features, and the GAM nicely segregates the contribution of each. As such, this approach may be preferred by many users who appreciate its interpretability.</p><p>In summary, my view is that this is a nice paper detailing a well-executed piece of software whose future impact will be determined by the degree of support and maintenance it receives from others over the near and medium term.</p><p><bold>Reviewer #3 (Public Review):</bold></p><p>Summary:</p><p>The authors invent song and syllable discrimination tasks they use to train deep networks. These networks they then use as a basis for routine song analysis and song evaluation tasks. For the analysis, they consider both data from their own colony and from another colony the network has not seen during training. They validate the analysis scores of the network against expert human annotators, achieving a correlation of 80-90%.</p><p>Strengths:</p><p>(1) Robust Validation and Generalizability: The authors demonstrate a good performance of the AVN across various datasets, including individuals exhibiting deviant behavior. This extensive validation underscores the system's usefulness and broad applicability to zebra finch song analysis, establishing it as a potentially valuable tool for researchers in the field.</p><p>(2) Comprehensive and Standardized Feature Analysis: AVN integrates a comprehensive set of interpretable features commonly used in the study of bird songs. By standardizing the feature extraction method, the AVN facilitates comparative research, allowing for consistent interpretation and comparison of vocal behavior across studies.</p><p>(3) Automation and Ease of Use. By being fully automated, the method is straightforward to apply and should introduce barely an adoption threshold to other labs.</p><p>(4) Human experts were recruited to perform extensive annotations (of vocal segments and of song similarity scores). These annotations released as public datasets are potentially very valuable.</p><p>Weaknesses:</p><p>(1) Poorly motivated tasks. The approach is poorly motivated and many assumptions come across as arbitrary. For example, the authors implicitly assume that the task of birdsong comparison is best achieved by a system that optimally discriminates between typical, deaf, and isolated songs. Similarly, the authors assume that song development is best tracked using a system that optimally estimates the age of a bird given its song. My issue is that these are fake tasks since clearly, researchers will know whether a bird is an isolated or a deaf bird, and they will also know the age of a bird, so no machine learning is needed to solve these tasks. Yet, the authors imagine that solving these placeholder tasks will somehow help with measuring important aspects of vocal behavior.</p></disp-quote><p>We appreciate this reviewer’s concerns and apologize for not providing sufficiently clear rationale for the inclusion of our phenotype classifier and age regression models in the original manuscript. These tasks are not intended to be taken as a final, ultimate culmination of the AVN pipeline. Rather, we consider the carefully engineered 55-interpretable feature set to be AVN’s final output, and these analyses serve merely as examples of how that feature set can be applied. That said, each of these models do have valid experimental use cases that we believe are important and would like to bring to the attention of the reviewer.</p><p>For one, we showed how the LDA model that can discriminate between typical, deaf, and isolate birds’ songs not only allows us to evaluate which features are most important for discriminating between these groups, but also allows comparison of the FoxP1 knock-down (FP1 KD) birds to each of these phenotypes. Based on previous work (Garcia-Oscos et al. 2021), we hypothesized that FP1 KD in these birds specifically impaired tutor song memory formation while sparing a bird’s ability to refine their own vocalizations through auditory feedback. Thus, we would expect their songs to resemble those of isolate birds, who lack a tutor song memory, but not to resemble deaf birds who lack a tutor song memory and auditory feedback of their own vocalizations to guide learning. The LDA model allowed us to make this comparison quantitatively for the first time and confirm our hypothesis that FP1 KD birds’ songs are indeed most like isolates’. In the future, as more research groups publish their birds’ AVN feature sets, we hope to be able to make even more fine-grained comparisons between different groups of birds, either using LDA or other similar interpretable classifiers.</p><p>The age prediction model also has valid real-world use cases. For instance, one might imagine an experimental manipulation that is hypothesized to accelerate or slow song maturation in juvenile birds. This age prediction model could be applied to the AVN feature sets of birds having undergone such a manipulation to determine whether their predicted ages systematically lead or lag their true biological ages, and which song features are most responsible for this difference. We didn’t have access to data for any such birds for inclusion in this paper, but we hope that others in the future will be able to take inspiration from our methodology and use this or a similar age regression model with AVN features in their research. We have added a couple lines to the ‘Comparing Song Disruptions with AVN Features’ and ‘Tracking Song Development with AVN Features’ sections of the results to make this more clear.</p><disp-quote content-type="editor-comment"><p>Along similar lines, authors assume that a good measure of similarity is one that optimally performs repeated syllable detection (i.e. to discriminate same syllable pairs from different pairs). The authors need to explain why they think these placeholder tasks are good and why no better task can be defined that more closely captures what researchers want to measure. Note: the standard tasks for self-supervised learning are next word or masked word prediction, why are these not used here?</p></disp-quote><p>This reviewer appears to have misunderstood our similarity scoring embedding model and our rationale for using it. We will explain it in more depth here and have added a paragraph to the ‘Measuring Song Imitation’ section of the results explaining this rationale more briefly.</p><p>First, nowhere are we training a model to discriminate between same and different syllable pairs. The triplet loss network is trained to embed syllables in an 8-dimensional space such that syllables with the same label are closer together than syllables with different labels. The loss function is related to the relative distance between embeddings of syllables with the same or different labels, not the classification of syllables as same or different. This approach was chosen because it has repeatedly been shown to be a useful data compression step (Schorff et al. 2015, Thakur et al. 2019) before further downstream tasks are applied on its output, particularly in contexts where there is little data per class (syllable label). For example, Schorff et al. 2015 trained a deep convolutional neural network with triplet loss to embed images of human faces from the same individual closer together than images of different individuals in a 128dimensional space. They then used this model to compute 128-dimensional representations of additional face images, not included in training, which were used for individual facial recognition (this is a same vs. different category classifier), and facial clustering, achieving better performance than the previous state of the art. The triplet loss function results in a model that can generate useful embeddings of previously unseen categories, like new individuals’ faces, or new zebra finches’ syllables, which can then be used in downstream analyses. This meaningful, lower dimensional space allows comparisons of distributions of syllables across birds, as in Brainard and Mets 2008, and Goffinet et al. 2021.</p><p>Next word and masked word prediction are indeed common self-supervised learning tasks for models working with text data, or other data with meaningful sequential organization. That is not the case for our zebra finch syllables, where every bird’s syllable sequence depends only on its tutor’s sequence, and there is no evidence for strong universal syllable sequencing rules (James et al. 2020). Rather, our embedding model is an example of a computer vision task, as it deals with sets of two-dimensional images (spectrograms), not sequences of categorical variables (like text). It is also not, strictly speaking, a selfsupervised learning task, as it does require syllable labels to generate the triplets. A common selfsupervised approach for dimensionality reduction in a computer vision task such as this one would be to train an autoencoder to compress images to a lower dimensional space, then faithfully reconstruct them from the compressed representation. This has been done using a variational autoencoder trained on zebra finch syllables in Goffinet et al. 2021. In keeping with the suggestions from reviewers #1 and #2, we have included a comparison of our triplet loss model with the Goffinet et al. VAE approach in the revised manuscript.</p><disp-quote content-type="editor-comment"><p>(2) The machine learning methodology lacks rigor. The aims of the machine learning pipeline are extremely vague and keep changing like a moving target. Mainly, the deep networks are trained on some tasks but then authors evaluate their performance on different, disconnected tasks. For example, they train both the birdsong comparison method (L263+) and the song similarity method (L318+) on classification tasks. However, they evaluate the former method (LDA) on classification accuracy, but the latter (8-dim embeddings) using a contrast index. In machine learning, usually, a useful task is first defined, then the system is trained on it and then tested on a held-out dataset. If the sensitivity index is important, why does it not serve as a cost function for training?</p></disp-quote><p>Again, this reviewer seems not to understand our similarity scoring methodology. Our similarity scoring model is not trained on a classification task, but rather on an embedding task. It learns to embed spectrograms of syllables in an 8-dimensional space such that syllables with the same label are closer together than syllables with different labels. We could report the loss values for this embedding task on our training and validation datasets, but these wouldn’t have any clear relevance to the downstream task of syllable distribution comparison where we are using the model’s embeddings. We report the contrast index as this has direct relevance to the actual application of the model and allows comparisons to other similarity scoring methods, something that the triplet loss values wouldn’t allow.</p><p>The triplet loss method was chosen because it has been shown to yield useful low-dimensional representations of data, even in cases where there is limited labeled training data (Thakur et al. 2019). While we have one of the largest manually annotated datasets of zebra finch songs, it is still quite small by industry deep learning standards, which is why we chose a method that would perform well given the size of our dataset. Training a model on a contrast index directly would be extremely computationally intensive and require many more pairs of birds with known relationships than we currently have access to. It could be an interesting approach to take in the future, but one that would be unlikely to perform well with a dataset size typical to songbird research.</p><disp-quote content-type="editor-comment"><p>Also, usually, in solid machine learning work, diverse methods are compared against each other to identify their relative strengths. The paper contains almost none of this, e.g. authors examined only one clustering method (HDBSCAN).</p></disp-quote><p>We did compare multiple methods for syllable segmentation (WhisperSeg, TweetyNet, and Amplitude thresholding) as this hadn’t been done previously. We chose not to perform extensive comparison of different clustering methods as Sainburg et al. 2020 already did so and we felt no need to reduplicate this effort. We encourage this reviewer to refer to Sainburg et al.’s excellent work for comparisons of multiple clustering methods applied to zebra finch song syllables.</p><disp-quote content-type="editor-comment"><p>(3) Performance issues. The authors want to 'simplify large-scale behavioral analysis' but it seems they want to do that at a high cost. (Gu et al 2023) achieved syllable scores above 0.99 for adults, which is much larger than the average score of 0.88 achieved here (L121). Similarly, the syllable scores in (Cohen et al 2022) are above 94% (their error rates are below 6%, albeit in Bengalese finches, not zebra finches), which is also better than here. Why is the performance of AVN so low? The low scores of AVN argue in favor of some human labeling and training on each bird.</p></disp-quote><p>Firstly, the syllable error rate scores reported in Cohen et al. 2022 are calculated very differently than the F1 scores we report here and are based on a model trained with data from the same bird as was used in testing, unlike our more general segmentation approach where the model was tested on different birds than were used in training. Thus, the scores reported in Cohen et al. and the F1 scores that we report cannot be compared.</p><p>The discrepancy between the F1<sub>seg</sub> scores reported in Gu et al. 2023 and the segmentation F1 scores that we report are likely due to differences in the underlying datasets. Our UTSW recordings tend to have higher levels of both stationary and non-stationary background noise, which make segmentation more challenging. The recordings from Rockefeller were less contaminated by background noise, and they resulted in slightly higher F1 scores. That said, we believe that the primary factor accounting for this difference in scores with Gu et al. 2023 is the granularity of our ‘ground truth’ syllable segments. In our case, if there was never any ambiguity as to whether vocal elements should be segmented into two short syllables with a very short gap between them or merged into a single longer syllable, we chose to split them. WhisperSeg had a strong tendency to merge the vocal elements in ambiguous cases such as these. This results in a higher rate of false negative syllable onset detections, reflected in the low recall scores achieved by WhisperSeg (see Figure 2–figure supplement 1b), but still very high precision scores (Figure 2–figure supplement 1a). While WhisperSeg did frequently merge these syllables in a way that differed from our ground truth segmentation, it did so consistently, meaning it had little impact on downstream measures of syntax entropy (Figure 3c) or syllable duration entropy (Figure 3–figure supplement 2a). It is for that reason that, despite a lower F1 score, we still consider AVN’s automatically generated annotations to be sufficiently accurate for downstream analyses.</p><p>Should researchers require a higher degree of accuracy and precision with their annotations (for example, to detect very subtle changes in song before and after an acute manipulation) we suggest they turn toward one of the existing tools for supervised song annotation, such as TweetyNet.</p><disp-quote content-type="editor-comment"><p>(4) Texas bias. It is true that comparability across datasets is enhanced when everyone uses the same code. However, the authors' proposal essentially is to replace the bias between labs with a bias towards birds in Texas. The comparison with Rockefeller birds is nice, but it amounts to merely N=1. If birds in Japanese or European labs have evolved different song repertoires, the AVN might not capture the associated song features in these labs well.</p></disp-quote><p>We appreciate the author’s concern about a bias toward birds from the UTSW colony. However, this paper shows that despite training (for the similarity scoring) and hyperparameter fitting (for the HDBSCAN clustering) on the UTSW birds, AVN performs as well if not better on birds from Rockefeller than from UTSW. To our knowledge, there are no publicly available datasets of annotated zebra finch songs from labs in Europe or in Asia but we would be happy to validate AVN on such datasets, should they become available. Furthermore, there is no evidence to suggest that there is dramatic drift in zebra finch vocal repertoire between continents which would necessitate such additional validation. While we didn’t have manual annotations for this dataset (which would allow validation of our segmentation and labeling methods), we did apply AVN to recordings shared with us by the Wada lab in Japan, where visual inspection of the resulting annotations suggested comparable accuracy to the UTSW and Rockefeller datasets.</p><disp-quote content-type="editor-comment"><p>(5) The paper lacks an analysis of the balance between labor requirement, generalizability, and optimal performance. For tasks such as segmentation and labeling, fine-tuning for each new dataset could potentially enhance the model's accuracy and performance without compromising comparability. E.g. How many hours does it take to annotate hundred song motifs? How much would the performance of AVN increase if the network were to be retrained on these? The paper should be written in more neutral terms, letting researchers reach their own conclusions about how much manual labor they want to put into their data.</p></disp-quote><p>With standardization and ease of use in mind, we designed AVN specifically to perform fully automated syllable annotation and downstream feature calculations. We believe that we have demonstrated in this manuscript that our fully automated approach is sufficiently reliable for downstream analyses across multiple zebra finch colonies. That said, if researchers require an even higher degree of annotation precision and accuracy, they can turn toward one of the existing methods for supervised song annotation, such as TweetyNet. Incorporating human annotations for each bird processed by AVN is likely to improve its performance, but this would require significant changes to AVN’s methodology, and is outside the scope of our current efforts.</p><disp-quote content-type="editor-comment"><p>(6) Full automation may not be everyone's wish. For example, given the highly stereotyped zebra finch songs, it is conceivable that some syllables are consistently mis-segmented or misclassified. Researchers may want to be able to correct such errors, which essentially amounts to fine-tuning AVN. Conceivably, researchers may want to retrain a network like the AVN on their own birds, to obtain a more fine-grained discriminative method.</p></disp-quote><p>Other methods exist for supervised or human-in-the-loop annotation of zebra finch songs, such as TweetyNet and DAN (Alam et al. 2023). We invite researchers who require a higher degree of accuracy than AVN can provide to explore these alternative approaches for song annotation. Incorporating human feedback into AVN was never the goal of our pipeline, would require significant changes to AVN’s design and is outside the scope of this manuscript.</p><disp-quote content-type="editor-comment"><p>(7) The analysis is restricted to song syllables and fails to include calls. No rationale is given for the omission of calls. Also, it is not clear how the analysis deals with repeated syllables in a motif, whether they are treated as two-syllable types or one.</p></disp-quote><p>It is true that we don’t currently have any dedicated features to describe calls. This could be a useful addition to AVN in the future.</p><p>What a human expert inspecting a spectrogram would typically call ‘repeated syllables’ in a bout are almost always assigned the same syllable label by the UMAP+HDBSCAN clustering. The syntax analysis module includes features examining the rate of syllable repetitions across syllable types, as mentioned in lines 222-226 of the revised manuscript. See <ext-link ext-link-type="uri" xlink:href="https://avn.readthedocs.io/en/latest/syntax_analysis_demo.html#Syllable-Repetitions">https://avn.readthedocs.io/en/latest/syntax_analysis_demo.html#Syllable-Repetitions</ext-link> for further details.</p><disp-quote content-type="editor-comment"><p>(8) It seems not all human annotations have been released and the instruction sets given to experts (how to segment syllables and score songs) are not disclosed. It may well be that the differences in performance between (Gu et al 2023) and (Cohen et al 2022) are due to differences in segmentation tasks, which is why these tasks given to experts need to be clearly spelled out. Also, the downloadable files contain merely labels but no identifier of the expert. The data should be released in such a way that lets other labs adopt their labeling method and cross-check their own labeling accuracy.</p></disp-quote><p>All human annotations used in this manuscript have indeed been released as part of the accompanying dataset. Syllable annotations are not provided for all pupils and tutors used to validate the similarity scoring, as annotations are not necessary for similarity comparisons. We have expanded our description of our annotation guidelines in the methods section of the revised manuscript. All the annotations were generated by one of two annotators. The second annotator always consulted with the first annotator in cases of ambiguous syllable segmentation or labeling, to ensure that they had consistent annotation styles. Unfortunately, we haven’t retained records about which birds were annotated by which of the two annotators, so we cannot share this information along with the dataset. The data is currently available in a format that should allow other research groups to use our annotations either to train their own annotation systems or check the performance of their existing systems on our annotations.</p><disp-quote content-type="editor-comment"><p>(9) The failure modes are not described. What segmentation errors did they encounter, and what syllable classification errors? It is important to describe the errors to be expected when using the method.</p></disp-quote><p>As we discussed in our response to this reviewer’s point (3), WhisperSeg has a tendency to merge syllables when the gap between them is very short, which explains its lower recall score compared to its precision on our dataset (Figure 2–figure supplement 1). In rare cases, WhisperSeg also fails to recognize syllables entirely, again impacting its precision score. TweetyNet hardly ever completely ignores syllables, but it does tend to occasionally merge syllables together or over-segment them. Whereas WhisperSeg does this very consistently for the same syllable types within the same bird, TweetyNet merges or splits syllables more inconsistently. This inconsistent merging and splitting has a larger effect on syllable labeling, as manifested in the lower clustering v-measure scores we obtain with TweetyNet compared to WhisperSeg segmentations. TweetyNet also has much lower precision than WhisperSeg, largely because TweetyNet often recognizes background noises (like wing flaps or hopping) as syllables whereas WhisperSeg hardly ever segments non-vocal sounds.</p><p>Many errors in syllable labeling stem from differences in syllable segmentation. For example, if two syllables with labels ‘a’ and ‘b’ in the manual annotation are sometimes segmented as two syllables, but sometimes merged into a single syllable, the clustering is likely to find 3 different syllable types; one corresponding to ‘a’, one corresponding to ‘b’ and one corresponding to ‘ab’ merged. Because of how we align syllables across segmentation schemes for the v-measure calculation, this will look like syllable ‘b’ always has a consistent cluster label (or is missing a label entirely), but syllable ‘a’ can carry two different cluster labels, depending on the segmentation. In certain cases, even in the absence of segmentation errors, a group of syllables bearing the same manual annotation label may be split into 2 or 3 clusters (it is extremely rare for a single manual annotation group to be split into more than 3 clusters). In these cases, it is difficult to conclusively say whether the clustering represents an error, or if it actually captured some meaningful systematic difference between syllables that was missed by the annotator. Finally, sometimes rare syllable types with their own distinct labels in the manual annotation are merged into a single cluster. Most labeling errors can be explained by this kind of merging or splitting of groups relative to the manual annotation, not to occasional mis-classifications of one manual label type as another.</p><p>For examples of these types of errors, we encourage this reviewer and readers to refer to the example confusion matrices in figure 2f and Figure 2–figure supplement 3b&amp;e. We also added two paragraphs to the end of the ‘Accurate, fully unsupervised syllable labeling’ section of the Results in the revised manuscript.</p><disp-quote content-type="editor-comment"><p>(10) Usage of Different Dimensionality Reduction Methods: The pipeline uses two different dimensionality reduction techniques for labeling and similarity comparison - both based on the understanding of the distribution of data in lower-dimensional spaces. However, the reasons for choosing different methods for different tasks are not articulated, nor is there a comparison of their efficacy.</p></disp-quote><p>We apologize for not making this distinction sufficiently clear in the manuscript and have added a paragraph to the ‘Measuring Song Imitation’ section of the Results explaining the rational for using an embedding model for similarity scoring.</p><p>We chose to use UMAP for syllable labeling because it is a common embedding methodology to precede hierarchical clustering and has been shown to result in reliable syllable labels for birdsong in the past (Sainburg et al. 2020). However, it is not appropriate for similarity scoring, because comparing EMD or MMD scores between birds requires that all the birds’ syllable distributions exist within the same shared embedding space. This can be achieved by using the same triplet loss-trained neural network model to embed syllables from all birds. This cannot be achieved with UMAP because all birds whose scores are being compared would need to be embedded in the same UMAP space, as distances between points cannot be compared across UMAPs. In practice, this would mean that every time a new tutor-pupil pair needs to be scored, their syllables would need to be added to a matrix with all previously compared birds’ syllables, a new UMAP would need to be computed, and new EMD or MMD scores between all bird pairs would need to be calculated using their new UMAP embeddings. This is very computationally expensive and quickly becomes unfeasible without dedicated high power computing infrastructure. It also means that similarity scores couldn’t be compared across papers without recomputing everything each time, whereas EMD and MMD scores obtained with triplet loss embeddings can be compared, provided they use the same trained model (which we provide as part of AVN) to embed their syllables in a common latent space.</p><disp-quote content-type="editor-comment"><p>(11) Reproducibility: are the measurements reproducible? Systems like UMAP always find a new embedding given some fixed input, so the output tends to fluctuate.</p></disp-quote><p>There is indeed a stochastic element to UMAP embeddings which will result in different embeddings and therefore different syllable labels across repeated runs with the same input. We observed that v-measures scores were quite consistent within birds across repeated runs of the UMAP, and have added an additional supplementary figure to the revised manuscript showing this (Figure 2–figure supplement 4).</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #1 (Recommendations For The Authors):</bold></p><p>(1) Benchmark their similarity score to the method used by Goffinet et al, 2021 from the Pearson group. Such a comparison would be really interesting and useful.</p></disp-quote><p>This has been added to the paper.</p><disp-quote content-type="editor-comment"><p>(2) Please clarify exactly what is new and what is applied from existing methods to help the reader see the novelty of the paper.</p></disp-quote><p>We have added more emphasis on the novel aspects of our pipeline to the paper’s introduction.</p><disp-quote content-type="editor-comment"><p>Minor:</p><p>It's unclear if AVN is appropriate as the paper deals only with zebra finch song - the scope is more limited than advertised.</p></disp-quote><p>We assume this is in reference to ‘Birdsong’ in the paper’s title and ‘Avian’ in Avian Vocalization Network. There is a brief discussion of how these methods are likely to perform on other commonly studied songbird species at the end of the discussion section.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #2 (Recommendations For The Authors):</bold></p><p>A few points for the authors to consider that might strengthen or inform the paper:</p><p>(1) In the public review, I detailed some ways in which the SSL+EMD approach is unlikely to be appreciably distinct from the VAE+MMD approach -- in fact, one could mix and match here. It would strengthen the authors' claim if they showed via experiments that their method outperforms VAE+MMD, but in the absence of that, a discussion of the relation between the two is probably warranted.</p></disp-quote><p>This comparison has been added to the paper.</p><disp-quote content-type="editor-comment"><p>(2) ll. 305-310: This loss of accuracy near the edge is expected on general Bayesian grounds. Any regression approach should learn to estimate the conditional mean of the age distribution given the data, so ages estimated from data will be pulled inward toward the location of most training data. This bias is somewhat mitigated in the Brudner paper by a more flexible model, but it's a general (and expected) feature of the approach.</p><p>(3) While the online AVA documentation looks good, it might benefit from a page on design philosophy that lays out how the various modules fit together - something between the tutorials and the nitty-gritty API. That way, users would be able to get a sense of where they should look if they want to harness pieces of functionality beyond the tutorials.</p></disp-quote><p>Thank you for this suggestion. We will add a page on AVN’s design philosophy to the online documentation.</p><disp-quote content-type="editor-comment"><p>(4) While the manuscript does compare AVN to packages like TweetyNet and AVA that share some functionality, it doesn't really mention what's been going on with the vocalpy ecosystem, where the maintainers have been doing a lot to standardize data processing, integrate tools, etc. I would suggest a few words about how AVN might integrate with these efforts.</p></disp-quote><p>We thank the reviewer for this suggestion.</p><disp-quote content-type="editor-comment"><p>(5) ll. 333-336: It would be helpful to provide a citation to some of the self-supervised learning literature this procedure is based on. Some citations are provided in methods, but the general approach is worth citing, in my opinion.</p></disp-quote><p>We have added a paragraph to the results section with more background on self-supervised learning for dimensionality reduction, particularly in the context of similarity scoring.</p><disp-quote content-type="editor-comment"><p>(6) One software concern for medium-term maintenance: AVN docs say to use Python 3.8, and GitHub says the package is 3.9 compatible. I also saw in the toml file that 3.10 and above are not supported. It's worth noting that Python 3.9 reaches its end of life in October 2025, so some dependencies may have to be altered or changed for the package to be viable going forward.</p></disp-quote><p>Thank you for this comment. We will continue to maintain AVN and update its dependencies as needed.</p><disp-quote content-type="editor-comment"><p>Minor points:</p><p>(1) It might be good to note that WhisperSeg is a different install from AVN. May be hard for novice users, though there's a web interface that's available.</p></disp-quote><p>We’ve added a line to the methods section making this clear.</p><disp-quote content-type="editor-comment"><p>(2) Figure 6b: Some text in the y-axis labels is overlapping here.</p></disp-quote><p>This has been fixed. Thank you for bringing it to our attention.</p><disp-quote content-type="editor-comment"><p>(3) The name of the Python language is always capitalized.</p></disp-quote><p>We’ve fixed this capitalization error throughout the manuscript. Thank you.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #3 (Recommendations For The Authors):</bold></p><p>(1) I recommend that the authors improve the motivation of the chosen tasks and data or choose new tasks that more clearly speak to the optimizations they want to perform.</p></disp-quote><p>We have included more details about the motivation for our LDA classification analysis, age prediction model and embedding model for similarity scoring in the results of the revised manuscript, as discussed in more detail in the above responses to this reviewer. Thank you for these suggestions.</p><disp-quote content-type="editor-comment"><p>(2) They need to rigorously report the (classification) scores on the test datasets: these are the scores associated with the cost function used during training.</p></disp-quote><p>Based on this reviewer’s ‘Weaknesses: 3’ comment in the public reviews, we believe that they are referring to a classification score for the triplet loss model. As we explained in response to that comment, this is not a classification task, therefor there is no classification score to report. The loss function used to train the model was a triplet loss function. While we could report these values, they are not informative for how well this approach would perform in a similarity scoring context, as explained above. As such, we prefer to include contrast index and tutor contrast index scores to compare the models’ performance for similarity score, as these are directly relevant to the task and are established in the field for said task.</p><disp-quote content-type="editor-comment"><p>(3) They need to explain the reasons for the poor performance (or report on the inconsistencies with previous work) and why they prefer a fully automated system rather than one that needs some fine-tuning on bird-specific data.</p></disp-quote><p>We’ve addressed this comment in the public response to this reviewer’s weakness points 3, 5, and 6.</p><disp-quote content-type="editor-comment"><p>(4) They should consider applying their method to data from Japanese and European labs.</p></disp-quote><p>We’ve addressed this comment in the public response to this reviewer’s weakness point 4.</p><disp-quote content-type="editor-comment"><p>(5) The need to document the failure modes and report all details about the human annotations.</p></disp-quote><p>We’ve added additional description of the failure modes for our segmentation and labeling approaches in the results section of the revised manuscript.</p><disp-quote content-type="editor-comment"><p>Details:</p><p>The introduction is very vague, it fails to make a clear case of what the problem is and what the approach is. It reads a bit like an advertisement for machine learning: we are given a hammer and are looking for a nail.</p></disp-quote><p>We thank the reviewer for this viewpoint; however, we disagree and have decided to keep our Introduction largely unchanged.</p><disp-quote content-type="editor-comment"><p>L46 That interpretability is needed to maximize the benefits of machine learning is wrong, see self-driving cars and chat GPT.</p></disp-quote><p>This line states that ‘To truly maximize the benefits of machine learning and deep learning methods for behavior analysis, their power must be balanced with interpretability and generalizability’. We firmly believe that interpretability is critically important when using machine learning tools to gain a deeper scientific understanding of data, including animal behavior data in a neuroscience context. We believe that the introduction and discussion of this paper already provide strong evidence for this claim.</p><disp-quote content-type="editor-comment"><p>L64 What about zebra finches that repeat a syllable in the motif, how are repetitions dealt with by AVN?</p></disp-quote><p>This is already described in the results section in lines 222-226, and in the methods in the ‘Syntax Features: Repetition Bouts’ section.</p><disp-quote content-type="editor-comment"><p>L107 Say a bit more here, what exactly has been annotated?</p></disp-quote><p>We’ve added a sentence in the introduction to clarify this. Line 113-115.</p><disp-quote content-type="editor-comment"><p>L112 Define spectrogram frames. Do these always fully or sometimes partially contain a vocalization?</p></disp-quote><p>Spectrogram frames are individual time bins used to compute the spectrogram using a short-term Fourier transform. As described in the ‘Methods; Labeling : UMAP Dimensionality Reduction” section, our spectrograms are computed using ‘The short term Fourier transform of the normalized audio for each syllable […] with a window length of 512 samples and a hop length of 128 samples’. Given that the song files have a standard sampling rate of 44.1kHz, this means each time bin represents 11.6ms of song data, with successive frames advancing in time by 2.9ms. These contain only a small fraction of a vocalization.</p><disp-quote content-type="editor-comment"><p>L122 The reported TweetyNet score of 0.824 is lower than the one reported in Figure 2a.</p></disp-quote><p>The center line in the box plot in Figure 2a represents the median of the distribution of TweetyNet vmeasure scores. Given that there are a couple outlying birds with very low scores, the mean (0.824 as reported in the text of the results section) is lower than the median. This is not an error.</p><disp-quote content-type="editor-comment"><p>L155 Some of the differences in performance are very small, reporting of the P value might be necessary.</p></disp-quote><p>These methods are unlikely to statistically significantly differ in their validation scores. This doesn’t mean that we cannot use the mean/median values reported to justify favoring one method over another. This is why we’ve chosen not to report p-values here.</p><disp-quote content-type="editor-comment"><p>L161 The authors have not really tested more than a single clustering method, failing to show a serious attempt to achieve good performance.</p></disp-quote><p>We’ve addressed this comment in the public response to this reviewer’s weakness point 2.</p><disp-quote content-type="editor-comment"><p>L186 Did isolate birds produce stereotyped syllables that can be clustered?</p></disp-quote><p>Yes, they did. The validation for clustering of isolate bird songs can be found in Figure 2–figure supplement 4.</p><disp-quote content-type="editor-comment"><p>Fig. 3e: How were the multiple bouts aligned?</p></disp-quote><p>This is described in lines 857-876 in the ‘Methods: Song Timing Features: Rhythm Spectrograms” section of the paper.</p><disp-quote content-type="editor-comment"><p>L199 There is a space missing in front of (n=8).</p></disp-quote><p>Thank you for bringing this to our attention. It’s been corrected in the updated manuscript.</p><disp-quote content-type="editor-comment"><p>L268 Define classification accuracy.</p></disp-quote><p>We’ve added a sentence in lines 953-954 of the methods section defining classification accuracy.</p><disp-quote content-type="editor-comment"><p>L325 How many motifs need to be identified, why does this need to be done manually? There are semiautomated methods that can allow scaling, these should be cited here. Also, the mention of bias here should be removed in favor of a more extensive discussion on the experimenter bias (traditionally vs Texas bias in this paper).</p></disp-quote><p>All of the methods cited in this line have graphical user interfaces that require users to select a file containing song and manually highlight the start and end each motif to be compared. The exact number of motifs required varies depending on the specific context (e.g. more examples are needed to detect more subtle differences or changes in song similarity) but it is fairly standard for reviewers to score 30 – 100 pairs of motifs.</p><p>We’ve discussed the tradeoffs between full automation and supervised or human-in-the loop methods in response to this reviewer’s public comment ‘weakness #5 and 6’. Briefly, AVN’s aim is to standardize song analysis, to allow direct comparisons between song features and similarity scores across research groups. We believe, as explained in the paper, that this can be best achieve by having different research groups use the same deep learning models, which perform consistently well across those groups. Introducing semi-automated methods would defeat this benefit of AVN.</p><p>We’ve also addressed the question of ‘Texas bias’ in response to their reviewer’s public comment ‘Weakness #4’.</p><disp-quote content-type="editor-comment"><p>L340 How is EMD applied? Syllables are points in 8-dim space, but now suddenly authors talk about distributions without explaining how they got from points to distributions. Same in L925.</p></disp-quote><p>We apologize for the confusion here. The syllable points in the 8-d space are collectively an empirical distribution, not a probability distribution. We referred to them simply as ‘distributions’ to limit technical jargon in the results of the paper, but have changed this to more precise language in the revised manuscript.</p><disp-quote content-type="editor-comment"><p>L351 Why do authors now use 'contrast index' to measure performance and no longer 'classification accuracy'?</p></disp-quote><p>We’ve addressed this comment in the public response to this reviewer’s weakness points 1 and 2.</p><disp-quote content-type="editor-comment"><p>Figure 6 What is the confusion matrix, i.e. how well can the model identify pupil-pupil pairings from pupiltutor and from pupil-unrelated pairings? I guess that would amount to something like classification accuracy.</p></disp-quote><p>There is no model classifying comparisons as pupil-pupil vs. pupil-tutor etc. These comparisons exist only to show the behavior of the similarity scoring approach, which consists of a dissimilarity measure (MMD or EMD) applied to low dimensional representations of syllable generated by the triplet loss model or VAE. This was clarified further in our public response to this reviewer’s weakness points 1 and 2.</p><disp-quote content-type="editor-comment"><p>L487 What are 'song files', and what do they contain?</p></disp-quote><p>‘Song files’ are .wav files containing recordings of zebra finch song. They typically contain a single song bout, but they can include multiple song bouts if they are produced close together, or incomplete song bouts if the introductory notes were very soft or the bouts were very long (&gt;30s from the start of the file). Details of these recordings are provided in the ‘Methods: Data Acquisition: UTSW Dataset’ section of the manuscript.</p><disp-quote content-type="editor-comment"><p>L497 Calls were only labelled for tweetynet but not for other tasks.</p></disp-quote><p>That is correct. The rationale for this is provided in the ‘Methods: Manual Song Annotation’ section of the manuscript.</p><disp-quote content-type="editor-comment"><p>L637 There is a contradiction (can something be assigned to the 'own manual annotation category' when the same sentence states that this is done 'without manual annotation'?)</p></disp-quote><p>We believe there is confusion here between automated annotation and validation. Any bird can be automatically annotated without the need for any existing manual annotations for that individual bird. However, manual labels are required to compare automatically generated annotations against for validation of the method.</p><disp-quote content-type="editor-comment"><p>L970 Spectograms of what? (what is the beginning of a song bout, L972).</p></disp-quote><p>The beginning of a song bout is the first introductory note produced by a bird after a period without vocalizations. This is standard.</p></body></sub-article></article>