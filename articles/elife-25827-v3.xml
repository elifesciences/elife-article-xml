<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">25827</article-id><article-id pub-id-type="doi">10.7554/eLife.25827</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Synaptic input sequence discrimination on behavioral timescales mediated by reaction-diffusion chemistry in dendrites</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-9195"><name><surname>Bhalla</surname><given-names>Upinder Singh</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1722-5188</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="other" rid="par-1"/><xref ref-type="other" rid="par-2"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>National Centre for Biological Sciences, Tata Institute of Fundamental Research</institution>, <addr-line><named-content content-type="city">Bangalore</named-content></addr-line>, <country>India</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Skinner</surname><given-names>Frances K</given-names></name><role>Reviewing editor</role><aff><institution>University Health Network</institution>, <country>Canada</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><email>bhalla@ncbs.res.in</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>19</day><month>04</month><year>2017</year></pub-date><pub-date pub-type="collection"><year>2017</year></pub-date><volume>6</volume><elocation-id>e25827</elocation-id><history><date date-type="received"><day>07</day><month>02</month><year>2017</year></date><date date-type="accepted"><day>17</day><month>04</month><year>2017</year></date></history><permissions><copyright-statement>© 2017, Bhalla et al</copyright-statement><copyright-year>2017</copyright-year><copyright-holder>Bhalla et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-25827-v3.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.25827.001</object-id><p>Sequences of events are ubiquitous in sensory, motor, and cognitive function. Key computational operations, including pattern recognition, event prediction, and plasticity, involve neural discrimination of spatio-temporal sequences. Here, we show that synaptically-driven reaction-diffusion pathways on dendrites can perform sequence discrimination on behaviorally relevant time-scales. We used abstract signaling models to show that selectivity arises when inputs at successive locations are aligned with, and amplified by, propagating chemical waves triggered by previous inputs. We incorporated biological detail using sequential synaptic input onto spines in morphologically, electrically, and chemically detailed pyramidal neuronal models based on rat data. Again, sequences were recognized, and local channel modulation downstream of putative sequence-triggered signaling could elicit changes in neuronal firing. We predict that dendritic sequence-recognition zones occupy 5 to 30 microns and recognize time-intervals of 0.2 to 5 s. We suggest that this mechanism provides highly parallel and selective neural computation in a functionally important time range.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.25827.001">http://dx.doi.org/10.7554/eLife.25827.001</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author Keywords</title><kwd>signaling</kwd><kwd>pattern recognition</kwd><kwd>multiscale model</kwd><kwd>MAPK</kwd><kwd>CICR</kwd><kwd>reaction-diffusion</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research Organism</title><kwd>Rat</kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100005879</institution-id><institution>National Centre for Biological Sciences</institution></institution-wrap></funding-source><award-id>Plan 4142</award-id><principal-award-recipient><name><surname>Bhalla</surname><given-names>Upinder Singh</given-names></name></principal-award-recipient></award-group><award-group id="par-2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001409</institution-id><institution>Department of Science and Technology, Ministry of Science and Technology</institution></institution-wrap></funding-source><award-id>SR/CSI/66/2013</award-id><principal-award-recipient><name><surname>Bhalla</surname><given-names>Upinder Singh</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.5</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>The powerful computational operation of sequence recognition on behavioral timescales of approximately 1 s may emerge from synaptic activity-triggered build-up of biochemical waves in short 20 micron zones on dendrites.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Activity sequences have long been recognized as a fundamental constituent of neural processing. Lorente de No suggested that reverberatory activity sequences in small networks could sustain activity (<xref ref-type="bibr" rid="bib36">Lorente de No, 1938</xref>). Hebb's idea of cell assemblies suggested that ensembles of cells encoded a particular neuronal concept, but also that there was sequential activation within the group of cells forming the assembly (<xref ref-type="bibr" rid="bib20">Hebb, 1949</xref>).</p><p>Many sensory systems process sequential stimuli, and these are typically mapped to ensembles of sequentially active neurons (<xref ref-type="bibr" rid="bib8">Bouchard and Brainard, 2016</xref>; <xref ref-type="bibr" rid="bib10">Broome et al., 2006</xref>; <xref ref-type="bibr" rid="bib11">Carrillo-Reid et al., 2015</xref>). Deeper in the brain, hippocampal place cells represent a higher-order cognitive map of space, yet here too sequences occur when the animal moves through spatial locations represented by the place cells (<xref ref-type="bibr" rid="bib56">Wilson and McNaughton, 1994</xref>). The hippocampus exhibits other forms of sequential activity in the form of fast replay events (<xref ref-type="bibr" rid="bib22">Jadhav et al., 2012</xref>; <xref ref-type="bibr" rid="bib56">Wilson and McNaughton, 1994</xref>) and stimulus-bridging activity that emerges during associative learning (<xref ref-type="bibr" rid="bib37">MacDonald et al., 2011</xref>) and trace conditioning (<xref ref-type="bibr" rid="bib40">Modi et al., 2014</xref>). Thus, there are numerous neural correlates both of sequences, and of processing steps that recognize them.</p><p>The idea of synfire chains examines conditions for self-sustaining sequential activity to occur in multiple layers of a network (<xref ref-type="bibr" rid="bib1">Abeles, 1982</xref>). This is non-trivial, as excessive activation can lead to runaway epileptiform activity, whereas insufficient activation causes decay of the activity wave (<xref ref-type="bibr" rid="bib27">Kumar et al., 2008</xref>; <xref ref-type="bibr" rid="bib39">Mehring et al., 2003</xref>). Neural networks that can recognize such sequences are well-established. For example, events may be run through a delay line, so that the oldest event is delayed more, the next event less, and so on, so that they all arrive at the neural network at the same time. Thus, the time-sequence is flattened in time and classical attractor networks can recognize patterns in the sequence (<xref ref-type="bibr" rid="bib52">Tank and Hopfield, 1987</xref>). Time-varying attractor networks have also been shown to be able to implement and recognize sequences (<xref ref-type="bibr" rid="bib31">Lee, 2002</xref>). Time-invariance is a desirable feature of sequence recognition circuits, since the same order of events may take place at different speeds. Recursive networks using supervised learning, and short-term synaptic plasticity have been shown to be implement time-invariance (<xref ref-type="bibr" rid="bib3">Barak and Tsodyks, 2006</xref>; <xref ref-type="bibr" rid="bib17">Goudar and Buonomano, 2015</xref>; <xref ref-type="bibr" rid="bib28">Laje and Buonomano, 2013</xref>).</p><p>While networks can carry out sequence recognition, they make limited use of the rich dynamics of biological neurons. The theory of Hierarchical Temporal Memory builds on the idea of sequence-recognizing neurons and networks as a way to perform complex temporal computation (<xref ref-type="bibr" rid="bib15">George and Hawkins, 2009</xref>; <xref ref-type="bibr" rid="bib19">Hawkins and Ahmad, 2016</xref>). Even the ability to recognize simultaneous closely-localized synaptic input has interesting computational implications (<xref ref-type="bibr" rid="bib19">Hawkins and Ahmad, 2016</xref>), The current study extends this to patterns of input both in time and space.</p><p>One of the first biophysical proposals for subcellular sequence recognition was made by Rall, who showed theoretically that synaptic events propagate down the dendritic tree with a small delay. By timing synaptic inputs to coincide with this delay, Rall predicted that ordered input should yield a larger response than reversed input (<xref ref-type="bibr" rid="bib45">Rall, 1964</xref>). A stronger version of this mechanism was experimentally demonstrated by <xref ref-type="bibr" rid="bib9">Branco et al. (2010)</xref> who used glutamate uncaging to provide sequential input along a pyramidal neuron dendrite. They showed that NMDA receptor amplification of 'inward' sequences (distal to proximal) gave rise to about 40% larger somatic depolarization than 'outward' sequences, for rapid (~40 ms) sequences. However, many interesting neural sequences occur at slower time-scales.</p><p>At least three attributes should converge for single neurons to achieve and report sequence recognition in the noisy context of neural activity. First, the neurons should recognize inputs coming in the correct order in space and time. Second, the selectivity for the correct input over scrambled input and background noise should be strong enough for there to be reliable discrimination. Third, recognized sequences should trigger activity changes either by way of changed firing, or by way of plasticity. In the current study, we use theory and reaction-diffusion modeling to show how the first condition may be achieved, and develop detailed multi-scale models to address the second and third.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>As the setting for this study, we considered a network in which ensembles of neurons are active in sequence, for example, place cells in the hippocampus as an animal moves along a linear track (<xref ref-type="fig" rid="fig1">Figure 1</xref>). We assumed that a single neuron from each of these ensembles projects onto a given postsynaptic cell, which is the focus of our analysis. The projections are ordered such that they converge onto a succession of spines located on a short stretch of dendrite on this cell, in the same spatial and temporal order as the activation of the ensembles. We ignored all other network context. We first treated this system in the abstract, as sequentially ordered activation of segments of a one-dimensional reaction-diffusion system with abstract chemistry. We asked if the reaction system could discriminate sequential from scrambled input. We then mapped the discrimination mechanism to a signaling pathway modeled as mass-action reaction-diffusion chemistry in a similar cylindrical geometry, but ornamented with dendritic spines. We then tested discrimination when we embedded mass-action chemistry into a morphologically and electrically detailed neuronal model receiving sequential input on a series of synapses, through ligand-gated ion channels. Finally, we asked if ion channel modulation by sequence discrimination chemistry in small dendritic zones, could affect neuronal firing.<fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.25827.002</object-id><label>Figure 1.</label><caption><title>Sequential activity, from behavior to dendrite.</title><p>Top: Linear arena in which a rat moves, with indicated locations of 5 place cells (color coded green, yellow, orange, red, and maroon in order.). The place cells are representatives of 5 neuronal ensembles (colored clouds), each active in one of the five locations on the arena. The neuronal ensembles each send a single axonal projection in spatial order to a small dendritic segment on a postsynaptic neuron, with an average spacing <italic>S</italic> between connected spines. Note that spines need not be immediately adjacent to each other. Below, buildup of reactant following input activity with the appropriate timing, corresponding to the rat moving at a speed which the dendritic chemistry recognizes.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.25827.002">http://dx.doi.org/10.7554/eLife.25827.002</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-25827-fig1-v3"/></fig></p><sec id="s2-1"><title>Abstract reaction-diffusion systems support sequence recognition</title><p>We first analyzed the requirements for chemical reaction-diffusion systems to achieve selectivity for spatially and temporally ordered inputs. In doing these calculations, we utilized 'spherical cow' models of chemistry: highly reduced formulations with just two diffusive state variables A and B, interpreted as molecules undergoing 1-dimensional diffusion (<xref ref-type="fig" rid="fig2">Figure 2A,B</xref>). The reaction system received input from a third molecule, designated as Ca (<xref ref-type="fig" rid="fig2">Figure 2A,B</xref>). In all cases, molecule B inhibited A.<fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.25827.003</object-id><label>Figure 2.</label><caption><title>Responses and sequence selectivity of four abstract models involving molecules A and B.</title><p>Columns are the respective models. (<bold>A</bold>) Model equations. (<bold>B</bold>) Model schematics. Arrows indicate excitation, plungers indicate inhibition. In the FHN model, A has a fast self-excitation and a slow self-inhibition. In the Switch model, we indicate a multiplicative inhibition of A by an arrow from B onto the self-inhibition arrow of A. (<bold>C</bold>) Response of point (non-spatial) model to a 1 s wide Gaussian input of Ca<sup>2+</sup> (red dot) and a steady pulse of Ca<sup>2+</sup> (green line). Input amplitudes: 1, 10, 0.4, and 1 respectively. (<bold>D-G</bold>) Response of molecule A in one-dimensional reaction-diffusion form of model to sequential input at five locations. (<bold>D</bold>) Time-course of response at five locations to ordered input. Locations are color-coded in the sequential order blue, green, red, cyan, purple. (<bold>E</bold>) Time-course of response at five locations to scrambled input. Note that the FHN and Switch models have much lower responses to scrambled as compared to ordered input. The Neg. FF model has a lower response at two of its locations. (<bold>F, G</bold>) Snapshot of spatial profile of response to ordered (<bold>F</bold>) and scrambled (<bold>G</bold>) input. Snapshot is at time 18.4, 14.2, 16.3 and 18.4 s respectively.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.25827.003">http://dx.doi.org/10.7554/eLife.25827.003</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-25827-fig2-v3"/></fig></p><p>The abstract models were initially formulated to implement reaction-diffusion wave propagation at a speed that matched the arrival of sequential input. We implemented two models with this property: the FitzHugh-Nagumo form, which is a known stimulus-triggered, oscillating, and propagating wave system (<xref ref-type="bibr" rid="bib13">Fitzhugh, 1961</xref>; <xref ref-type="bibr" rid="bib41">Nagumo et al., 1962</xref>); and a bistable reaction-diffusion system, which again is a known substrate for propagating waves (<xref ref-type="bibr" rid="bib24">Keener and Sneyd, 1998</xref>). To the bistable switch system, we added inhibitory feedback to restore the switch to baseline after a delay. In addition to these models with complex dynamics, we implemented a system with feedback inhibition, and a system with feedforward inhibition. These simpler models were designed to test if inhibitory feedback or feedforward systems, coupled with diffusion, could achieve selectivity in the absence of an amplifying positive feedback process.</p><p>Our criterion for sequence recognition was that ordered inputs should elicit high total activity of a signaling molecule A, whereas scrambled inputs should elicit low levels of activity. Total activity here means the sum of activity of A over the duration and spatial extent of the stimulus.</p><p>To investigate the temporal responses of these 'reaction' systems, we first delivered impulse (red dot) and step-function (green line) input to non-spatial versions of the models (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). Each model exhibited a large impulse response. Two of the models (feedforward inhibition and state-switching) exhibited only a transient response to the sustained input. The negative feedback model, as expected, had a transient strong response followed by a shallow sustained response. The FitzHugh-Nagumo model, again as expected, oscillated.</p><p>We then implemented 1-dimensional reaction-diffusion versions of these models (<xref ref-type="fig" rid="fig2">Figure 2</xref>, methods). We delivered Ca<sup>2+</sup> stimuli at five equally spaced points on the reaction system. Each Ca<sup>2+</sup> stimulus followed a Gaussian time-profile:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mi>h</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mo>−</mml:mo><mml:mi>t</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mtext> </mml:mtext><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Here, <italic>phase</italic> defines the timing of each input, <italic>t</italic> is time, and <italic>width</italic> is the duration of the Ca<sup>2+</sup> pulse.</p><p>The only difference between the sequential and scrambled stimuli was their order ([0,1,2,3,4] and [2,1,4,3,0], respectively (methods)).</p><p>The results of these simulations are compared in <xref ref-type="fig" rid="fig2">Figure 2D–G</xref>. First, we found that the simple feedback inhibition model showed no input sequence-dependent difference in total activity. This can be seen in terms of time-response at the five stimulus points (<xref ref-type="fig" rid="fig2">Figure 2D,E</xref>), and also in terms of spatial profile of A at the end of the stimulus (<xref ref-type="fig" rid="fig2">Figure 2F,G</xref>, <xref ref-type="other" rid="media1">Video 1</xref>).<media content-type="glencoe play-in-place height-250 width-310" id="media1" mime-subtype="mp4" mimetype="video" xlink:href="elife-25827-media1.mp4"><object-id pub-id-type="doi">10.7554/eLife.25827.004</object-id><label>Video 1.</label><caption><title>Time-and-space series of response of negative feedback model to sequential (blue) and scrambled (red) input.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.25827.004">http://dx.doi.org/10.7554/eLife.25827.004</ext-link></p></caption></media></p><p>Then, we observed that the feedforward inhibition model showed a small amount of selectivity (<xref ref-type="fig" rid="fig2">Figure 2D–G</xref>). This arose because the A response was diminished at two of the input points when the input was scrambled (<xref ref-type="other" rid="media2">Video 2</xref>).<media content-type="glencoe play-in-place height-250 width-310" id="media2" mime-subtype="mp4" mimetype="video" xlink:href="elife-25827-media2.mp4"><object-id pub-id-type="doi">10.7554/eLife.25827.005</object-id><label>Video 2.</label><caption><title>Time-and-space series of response of negative feedforward model to sequential (blue) and scrambled (red) input.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.25827.005">http://dx.doi.org/10.7554/eLife.25827.005</ext-link></p></caption></media></p><p>The FitzHugh-Nagumo (FHN) model was strongly selective, with a large buildup of response only when the input was sequential (<xref ref-type="fig" rid="fig2">Figure 2</xref> third column, <xref ref-type="other" rid="media3">Video 3</xref>). We interpret this as arising when the propagating wave from the FHN equation arrived at successive input points just when the input was also present.<media content-type="glencoe play-in-place height-250 width-310" id="media3" mime-subtype="mp4" mimetype="video" xlink:href="elife-25827-media3.mp4"><object-id pub-id-type="doi">10.7554/eLife.25827.006</object-id><label>Video 3.</label><caption><title>Time-and-space series of response of FitzHuge-Nagumo model to sequential (blue) and scrambled (red) input.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.25827.006">http://dx.doi.org/10.7554/eLife.25827.006</ext-link></p></caption></media></p><p>The switching model was the most selective (<xref ref-type="fig" rid="fig2">Figure 2</xref> last column, <xref ref-type="other" rid="media4">Video 4</xref>). This was because it built up to a large, sustained response lasting several seconds, provided the successive inputs were in the same position as the diffusively propagating activity of A.<media content-type="glencoe play-in-place height-250 width-310" id="media4" mime-subtype="mp4" mimetype="video" xlink:href="elife-25827-media4.mp4"><object-id pub-id-type="doi">10.7554/eLife.25827.007</object-id><label>Video 4.</label><caption><title>Time-and-space series of response of bistable switch model to sequential (blue) and scrambled (red) input.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.25827.007">http://dx.doi.org/10.7554/eLife.25827.007</ext-link></p></caption></media></p><p>Thus, this set of simulations showed that several reaction-diffusion like systems were capable of sequence selectivity. Strong selectivity emerged from a supralinear buildup of responses when diffusively propagating activity was aligned with successive inputs, and suppression due to inhibition when the alignment was off.</p></sec><sec id="s2-2"><title>Reaction systems select for distinct speeds and length-scales of sequential input</title><p>We next asked how the different reaction systems were tuned to different spatial and temporal intervals. We devised a scalar metric, Q, of the degree of sequential ordering of stimuli, as a first step. We plotted the ordinal position of the input against the ordinal value of its arrival time. Thus, a perfect sequence would arrive at positions [0,1,2,3,4] at times [0,1,2,3,4]. We used the quantity<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>as the measure of how ordered the sequence was. Here, <italic>m</italic> = slope and <italic>R</italic> = regression coefficient of best-fit line. <italic>R<sup>2</sup></italic> provides a measure of linearity of the sequence, and <italic>m</italic> assigns it a magnitude and sign. With this measure, the sequence [0,1,2,3,4] has Q = 1; [4,3,2,1,0] has Q = −1, and [4,0,2,1,3] has Q = −0.001. Examples of regression plots used to generate Q for different sequences are presented in <xref ref-type="fig" rid="fig3">Figure 3A,B</xref>.<fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.25827.008</object-id><label>Figure 3.</label><caption><title>Sequence selectivity for different models.</title><p>(<bold>A, B</bold>) Regression plots for sample sequences. (<bold>A</bold>) Perfect forward sequence [0,1,2,3,4] (red, Q = 1) and reverse sequence [4,3,2,1,0] (blue, Q = −1). (<bold>B</bold>) Scrambled sequence [4,0,2,1,3] (red, Q = −0.001) and [0,1,3,2,4] (blue, Q = 0.729). (<bold>C, E, G, I</bold>) Scatter plots of chemical system selectivity (measured as total activation of molecule A over time and space) against Q. There are 5! = 120 points, each being the outcome of a single simulation with a different sequence. In each plot the blue cross is the perfect forward sequence (whose timeseries is shown in <xref ref-type="fig" rid="fig2">Figure 2D</xref>), and the red cross is the scrambled sequence [2,1,4,3,0], whose timeseries is shown in <xref ref-type="fig" rid="fig2">Figure 2E</xref>. (<bold>D, F, H, J</bold>) Matrix of selectivity as a function of total length of stimulus zone and interval time between successive stimuli. In each plot, the asterisk is placed on the matrix entry obtained from the spacing and interval parameters used for the scatter plot to its left. In other words, the selectivity value for that matrix entry is obtained from <xref ref-type="disp-formula" rid="equ3">Equation 3</xref> using the <italic>Atot</italic> scores from the scatter plot. (<bold>C,D</bold>) Feedback model. This shows no selectivity. (<bold>E, F</bold>) Inhibitory feedforward model. Scatter plot in E represents calculations performed at time/distance values of (3 s, 4 mm). This shows low selectivity, as seen by slightly higher <italic>Atot</italic> for Q values of +1 and −1. (<bold>G,H</bold>) FitzHugh-Nagumo, scatter plot at (2 s, 2 mm). The model is selective in a narrow, diagonal range of time and distance. Its score is somewhat reduced because of the high baseline of <italic>Atot</italic>. (<bold>I,J</bold>) Switching model, scatter plot at (3 s, 4 mm). This is highly selective over a wide range of time and distance. Only the perfect forward and reverse sequences have high values of <italic>Atot</italic>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.25827.008">http://dx.doi.org/10.7554/eLife.25827.008</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-25827-fig3-v3"/></fig></p><p>We then compared our reaction readout A with the metric Q, to see how well each of our four reaction systems could discriminate sequence order (<xref ref-type="fig" rid="fig3">Figure 3C,E,G,I</xref>). Here, we ran simulations with each of the possible permuted input sequences. In each run, we summed the level of A over all five stimulus points, and from the time of the first stimulus till the end of the run, in order to obtain a cumulative estimate of the response. This total A value (<italic>Atot</italic>) was plotted against the Q metric for each of these permuted sequences (<xref ref-type="fig" rid="fig3">Figure 3C,E,G,I</xref>). If the chemical system was highly selective, we expected that only one or two points in the scatter plot should have a high value of <italic>Atot</italic>, and these should be the points with Q around +1 or −1. Chemical systems that did not exhibit sequence discrimination should have similar values of <italic>Atot</italic> for all sequences.</p><p>The results were as expected from the individual runs from <xref ref-type="fig" rid="fig2">Figure 2</xref>. Specifically, the inhibitory feedback system had poor tuning, there was a small amount of selectivity for the feedforward inhibition case, and strong selectivity for the FitzHugh-Nagumo and switching cases. Each of these outcomes had been observed in <xref ref-type="fig" rid="fig2">Figure 2</xref> for just the sequential and a single scrambled stimulus, and in <xref ref-type="fig" rid="fig3">Figure 3</xref> we found that it generalized to the entire set of sequence permutations. Note that the modeled reaction-diffusion system was spatially symmetric and did not distinguish between forward and backward sequences. An analysis of symmetry breaking arising from incorporation of biological detail is out of the scope of the current paper.</p><p>We next asked how selective each reaction system became, when the inputs were delivered at different time and space intervals. The time and space intervals were specified as parameters for each simulation run. We devised a metric for reaction network sequence selectivity, based on a comparison of responses to sequential vs. scrambled inputs:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Provided the system responds more strongly to sequential input than to any other order, <italic>selectivity</italic> should be in the range from zero (unselective) to one (highly selective). <italic>Asequential</italic> is <italic>Atot</italic> for the sequential stimulus, <italic>mean(Atot)</italic> is the mean of <italic>Atot</italic> over all permutations of the stimulus order, and <italic>max(Atot)</italic> is the maximum value of <italic>Atot</italic> for all permutations of stimulus order.</p><p>To compute <italic>Selectivity</italic>, we carried out simulations of the model for all possible non-repeating patterns of input, and obtained <italic>Atot</italic> in each case (<xref ref-type="fig" rid="fig3">Figure 3</xref>, first column). <italic>Selectivity</italic> was then estimated as per <xref ref-type="disp-formula" rid="equ3">Equation 3</xref>. We repeated these calculations for each point in the matrix of timing and spacing values, to obtain a grid of <italic>selectivity</italic> values (<xref ref-type="fig" rid="fig3">Figure 3D,F,H,J</xref>). As already seen from <xref ref-type="fig" rid="fig2">Figure 2</xref>, the feedback inhibition model had low selectivity in all cases. The feedforward inhibition model showed a diagonal band of weak selectivity such that rapid stimuli in close proximity as well as slower stimuli at greater distances were preferred. The FitzHugh-Nagumo case was much more strongly selective, but also had a similar diagonal band. In both these cases we interpret this as there being an intrinsic propagation speed of the chemical activity wave, and if the inputs were timed and spaced accordingly, the response built up. The switching model was strongly selective, and had a large diffuse zone of strong selectivity centred around (2 s, 4 μm).</p><p>Thus, each of the three sequence-selective reaction systems had a preferred range of stimulus timing and spacing, but the FHN and switch forms had much higher selectivity.</p></sec><sec id="s2-3"><title>Sequence speed selectivity scales with reaction rates and diffusion constants</title><p>As a further analysis on our abstract models, we asked how sequence speed selectivity scaled with rates and diffusion parameters. This scaling is important because it determines the spatial extent of the sequence selective zones that we propose to exist in the dendritic tree. It is also important as it defines the time-scales of sequential events that may be recognized by such reaction-diffusion mechanisms.</p><p>We first tested the most straightforward assumption, that sequence propagation speed was proportional to chemical rate and diffusion constants. To do this, we scaled all rates and the diffusion constants by the same factor, and reduced the stimulus width by the same factor. We ran the same grid of stimulus space and time intervals as above. As expected, scaling all the chemical and diffusion rates also scaled the sequence speed to which the network had the strongest response. As the rates were increased, the best tuning was at shorter time intervals but roughly the same spatial intervals. (<xref ref-type="fig" rid="fig4">Figure 4A–E</xref>). However, different stimulus strengths were needed to obtain strong tuning in these runs. We therefore also examined dependence of tuning on stimulus strength, and observed that the tuning zone also depended on stimulus strength (<xref ref-type="fig" rid="fig4">Figure 4F,G</xref>). This is because the selectivity occurs when the stimulus is strong enough that the ordered sequence leads to pathway activation, but not so strong that the stimulus overrides the inhibitory reactions and produces indiscriminate activation. To better understand the range of sequence selectivity, we varied each of the parameters of the model one at a time with respect to the reference model. We carried out this 1-dimensional parameter sensitivity sweep for the FHN and switching models (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplements 1</xref> and <xref ref-type="fig" rid="fig4s2">2</xref>). In each case we computed <italic>Asequential</italic> (blue traces), and compared it to <italic>mean(Atot)</italic> averaged over 12 input patterns, 11 of which were scrambled (green traces, methods). We also computed sequence <italic>selectivity</italic> as per <xref ref-type="disp-formula" rid="equ3">Equation 3</xref> (red traces). We found that selectivity was robust to some parameters, such as diffusion constants, but fragile (range ~20%) with respect to some rate constants and stimulus amplitude. These models were intended to be illustrative and to explore the properties of sequence-selective systems. Hence, we did not optimize the models for robustness.<fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.25827.009</object-id><label>Figure 4.</label><caption><title>Sequence tuning ranges in space and time.</title><p>(<bold>A-D</bold>) tuning for rates of 1, 2, 3 and 4 times basal, respectively. (<bold>E</bold>) Plot of speed of sequence as a function of the rate scale factor. (<bold>F, G</bold>) Preferred space/time of tuning shifts with stimulus amplitude. (<bold>F</bold>) 90% basal. (<bold>G</bold>) 110% basal.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.25827.009">http://dx.doi.org/10.7554/eLife.25827.009</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-25827-fig4-v3"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.25827.010</object-id><label>Figure 4—figure supplement 1.</label><caption><title>Parameter sensitivity for FHN (FitzHugh-Nagumo) reaction-diffusion model.</title><p>In each plot, the blue trace is the summed concentration of A for the sequential stimulus, and the green plot is the mean of summed A over all permutations of the stimulus. A is summed over time since start of stimulus till end of simulation, and also summed over all five stimulus points. In each plot, the red trace is the selectivity metric (<xref ref-type="disp-formula" rid="equ3">Equation 3</xref>). Note that the selectivity is largest when the ratio of blue to green traces is largest. Because of the high baseline in the FHN model, as seen in the blue and green traces, the selectivity (red traces) remains under 0.5. In each plot the x axis is scale factor of selected parameter with respect to the default model. Panel (<bold>A</bold>) Stimulus amplitude. (<bold>B</bold>) stimulus width. (<bold>C</bold>) Diffusion constant of molecule A. (<bold>D</bold>) Diffusion constant of molecule B. (<bold>E</bold>) rate constant for ‘t’ variable in FHN equations. (<bold>F</bold>) rate constant a. (<bold>G</bold>) rate constant b. (<bold>H</bold>) Offset term for variable A. (<bold>I</bold>) Offset term for variable B. Most parameters give good tuning for a range of ±10% around reference (1.0), but k_a is still more sensitive.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.25827.010">http://dx.doi.org/10.7554/eLife.25827.010</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-25827-fig4-figsupp1-v3"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.25827.011</object-id><label>Figure 4—figure supplement 2.</label><caption><title>Parameter sensitivity for switch (Propagating bistable switch) reaction-diffusion model.</title><p>Plot traces are as in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>. Panel (<bold>A</bold>) Stimulus amplitude. (<bold>B</bold>) stimulus width. (<bold>C</bold>) Diffusion constant of molecule A. (<bold>D</bold>) Diffusion constant of molecule B. (<bold>E-L</bold>) Rate constants used in model. The model was sensitive to stimulus amplitude, and the rate terms k1a, k2a and k4a, and less sensitive for the rest. We classified sensitive parameters as those where selectivity fell below 0.5 for a parameter range of ±10% or less.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.25827.011">http://dx.doi.org/10.7554/eLife.25827.011</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-25827-fig4-figsupp2-v3"/></fig></fig-group></p><p>Thus, by varying rates for reactions and diffusion, we were able to achieve good sequence selectivity over a broad range of time-intervals (0.5–4 s between stimuli) and spatial intervals (2–6 μm between stimuli).</p></sec><sec id="s2-4"><title>Mass-action reaction-diffusion system based on MAPK feedback discriminates sequences</title><p>We next asked if above design principles for sequence selectivity could be applied to a mass-action reaction-diffusion system. We based our mass-action model on a published, reduced model of MAPK feedback and bistability (<xref ref-type="bibr" rid="bib6">Bhalla, 2011</xref>). The model already exhibited the switch-like turnon behavior of our abstract 'switch' model. The other key aspect of the abstract model was delayed turnoff of activity. There are several known inhibitory feedback turnoff mechanisms for the MAPK pathway (<xref ref-type="bibr" rid="bib29">Lake et al., 2016</xref>). We therefore added a MAPK-activated protein phosphatase to cause delayed turnoff of the kinase. The other changes we made to the published MAPK model were (a) to remove the synaptic signaling leading to receptor turnover in the spine and (b) to add diffusible CaM as a Ca<sup>2+</sup> buffer. With the exception of active PKC, Raf, and the ion channels, all molecules were diffusible. The model schematic is shown in <xref ref-type="fig" rid="fig5">Figure 5A</xref>, and the full model specification is presented in supplementary material. This model formulation is a semi-quantitative map to the far more detailed and tightly constrained models of this pathway in the literature (<xref ref-type="bibr" rid="bib4">Bhalla and Iyengar, 1999</xref>; <xref ref-type="bibr" rid="bib47">Resat et al., 2003</xref>). Ca<sup>2+</sup> stimuli were delivered in the PSD and diffused into the dendrite (Methods). Model responses to brief (1 s) and square step function (100 s) Ca<sup>2+</sup> inputs are shown in <xref ref-type="fig" rid="fig5">Figure 5B,C</xref>, both measured in the dendrite. As expected, there is a strong switch-like turnon to Ca<sup>2+</sup> stimuli, followed by delayed inhibition. We ran this model in a cylindrical geometry ornamented with spines at ~1.1 μm intervals (Materials and methods, <xref ref-type="fig" rid="fig5">Figure 5D</xref>). We provided sequential and scrambled Ca<sup>2+</sup> input to 5 of the spines separated by ~3 μm each, and observed good sequence selectivity (<xref ref-type="fig" rid="fig5">Figure 5E,F</xref>).<fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.25827.012</object-id><label>Figure 5.</label><caption><title>Mass action model of a MAPK switch exhibits sequence selectivity.</title><p>(<bold>A</bold>) Schematic of model chemistry. Black arrows indicate binding or activation reactions, plunger indicates inhibition, and bent arrow indicates enzyme activity. Broad cyan arrows indicate diffusion of Ca<sup>2+</sup> and CaM between PSD, spine head, and dendrite. CaM buffers the incoming Ca<sup>2+</sup> from the PSD. (<bold>B</bold>) Ca<sup>2+</sup> responses seen at the dendrite, to input delivered at PSD. PSD stimulus was two pulses of 1 s, 160 mM Ca<sup>2+</sup>, separated by 50 s. After a delay of 100 s, a step of 160 mM Ca<sup>2+</sup> was delivered for 50 s. (<bold>C</bold>) MAPK-P response to the Ca<sup>2+</sup> stimulus. Note strong inhibition of the response to the second pulse, and rapid decline of response to the 50 step stimulus. (<bold>D</bold>) Geometry of 1-D reaction-diffusion model, with 49 spines. Dendrite diameter was 1 μm and length was 60 μm. The five stimulated spines are in red, each identified by a color coded number. (<bold>E</bold>) Response of system to sequential input [0,1,2,3,4] on indicated spines spaced ~3 μm apart, at intervals of 3 s. Each input was delivered to the PSD of the stimulated spine, at 160 μM, for 2.9 s. MAPK-P was recorded from the dendrite subdivision attached to each of the stimulated spines. Plot colors indicate stimulated spine from D. (<bold>F</bold>) Response to scrambled input, in the order [4,0,3,1,2]. The response to scrambled input had a smaller amplitude and lasted for a shorter time. Plot colors are as per spine numbers in D.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.25827.012">http://dx.doi.org/10.7554/eLife.25827.012</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-25827-fig5-v3"/></fig></p><p>Thus, we showed that a mass-action reaction-diffusion system exhibited sequence selectivity when it had switch-like turnon with delayed turnoff by negative feedback. This configuration had been predicted by the abstract models.</p></sec><sec id="s2-5"><title>Sequence selectivity works in a biologically detailed multiscale neuronal model with noisy input</title><p>We then asked whether biochemical sequence recognition would 'work' in the more complex context of active neurons receiving background activity in a network. We brought in biological detail at the following levels: (a) Model neuron morphology based on anatomical reconstructions (&gt;3000 segments), including &gt;5700 spines spaced at ~1 μm. (b) Voltage-gated ion channels distributed throughout the cell, based on published models. (c) Background glutamatergic Poisson synaptic input at 0.1 Hz on all spines. (d) Background GABAergic synaptic input with an 8 Hz theta modulation on proximal dendritic compartments. Due to the background synaptic input, the model exhibited theta-modulated sub-threshold oscillations, with spiking activity at ~1 Hz (<xref ref-type="fig" rid="fig6">Figure 6B</xref>). (e) Stimuli in the form of spike trains arriving on AMPA and NMDA receptors on subsets of spines. (f) Ca<sup>2+</sup> dynamics following synaptic ion flux, including diffusion between spine and dendrite, and buffering by calmodulin, in all spines and dendrites (<xref ref-type="other" rid="media5">Video 5</xref>). (g) The reduced MAPK model described above, was distributed throughout the dendritic tree in ~6000 diffusive compartments (<xref ref-type="fig" rid="fig6">Figure 6A</xref>). (h) Chemical calculations in the spines were carried out using a stochastic method (Gillespie Stochastic Systems Algorithm, methods) for the runs used to calculate selectivity.<fig-group><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.25827.013</object-id><label>Figure 6.</label><caption><title>Sequence selectivity in detailed electrical+chemical signaling model.</title><p>(<bold>A</bold>) Morphology of model. Dendrite diameters are scaled up by 2, and spine diameters and lengths by four for visualization. Stimulus was given in four zones on the cell, indicated in red and by diameters scaled up by 10x. (<bold>B</bold>) Example somatic intracellular potential and spike train of model neuron. (<bold>C</bold>) Ca<sup>2+</sup> responses to Poisson synaptic volley at mean rate 20 Hz, measured in PSD (blue), spine head (green) and dendrite (red). (<bold>D</bold>) Sequence selectivity in the distal apical zone. Heavy solid lines are P-MAPK-P levels under the stimulated spines, for sequential input. Strong buildup occurs for three of the spines. Dashed lines are corresponding MAPK-P levels for scrambled input. Only the sequential input responses lead to build up. (<bold>E-G</bold>) Matrix of sequence selectivity in basal dendrite zone, for different input spacing in time and space. Three different runs are shown, with the same morphology but different random number seeds for the background and stimulus synaptic input. (<bold>H</bold>) Selectivity in proximal oblique dendrite zone, using 40% larger spine dimensions. (<bold>I</bold>) Selectivity in distal apical dendrite using 20% larger spines. (<bold>J</bold>) Selectivity matrix in proximal primary apical dendrite shows no sequence selectivity even with 40% larger spines.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.25827.013">http://dx.doi.org/10.7554/eLife.25827.013</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-25827-fig6-v3"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.25827.014</object-id><label>Figure 6—figure supplement 1.</label><caption><title>In each plot, the blue trace is the summed concentration of MAPK-P for the sequential stimulus, and the green plot is the mean of summed MAPK-P over 12 permutations of the stimulus.</title><p>MAPK-P is summed over time since start of stimulus till end of simulation, and also summed over all five stimulus points. In each plot, the red trace is the selectivity metric (<xref ref-type="disp-formula" rid="equ3">Equation 3</xref>, Materials and methods). (<bold>A</bold>) Stimulus spike rate. (<bold>B</bold>) Spatial density of LCa channel over basal and apical dendrites. Somatic LCa was held uniform at 40 S/m^2. (<bold>C</bold>) Diffusion constant for Ca<sup>2+</sup>. (<bold>D</bold>) Forward rate constant for Ca<sup>2+</sup> activation of Raf, which acts as input to the signaling pathway.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.25827.014">http://dx.doi.org/10.7554/eLife.25827.014</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-25827-fig6-figsupp1-v3"/></fig></fig-group><media content-type="glencoe play-in-place height-250 width-310" id="media5" mime-subtype="mp4" mimetype="video" xlink:href="elife-25827-media5.mp4"><object-id pub-id-type="doi">10.7554/eLife.25827.015</object-id><label>Video 5.</label><caption><title>Calcium influx into spines and dendrites due to random background and sequential stimulation in detailed single-neuron model.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.25827.015">http://dx.doi.org/10.7554/eLife.25827.015</ext-link></p></caption></media></p><p>We first ran a direct comparison of a sequential input train [0,1,2,3,4] compared with a scrambled train with sequence [4,0,3,1,2]. We picked time and space intervals of (3 s, 4 μm) based on preliminary calculations for tuning. We delivered the input sequence on a basal dendritic branch (<xref ref-type="fig" rid="fig6">Figure 6A</xref>). We selected a set of 5 spines, spaced at ~3 μm. Each spine was stimulated with a Poisson spike burst lasting 2 s at 20 Hz on the AMPA and NMDA receptors. With these parameters, the [Ca<sup>2+</sup>] reached ~40 μM in the PSD, ~35 μM in the spine head, and ~1 μM in the region of dendrite immediately below the stimulated spine (e.g., <xref ref-type="fig" rid="fig6">Figure 6C</xref>). Similar Ca<sup>2+</sup> levels were obtained when stimuli were delivered in other regions of the dendrite. The exception was the primary apical dendrite, in which dendritic Ca<sup>2+</sup> only reached ~0.5 μM. This is an expected outcome of diluting out the Ca<sup>2+</sup> arriving from the spine, since the diameter of the primary dendrite was ~2 μm as compared to ~1.0 μm in the other stimulus regions. With these parameters, we observed strong selectivity in MAPK activity for sequential stimuli as compared to scrambled in the basal dendrite (<xref ref-type="fig" rid="fig6">Figure 6D</xref>, solid lines for sequential vs. dashed for scrambled).</p><p>We then asked how this multiscale model responded to a range of time and space intervals in each of the stimulated zones. Because the calculations were expensive, we used a modified version of the selectivity metric (<xref ref-type="disp-formula" rid="equ3">Equation 3</xref>) in which we computed outcomes of only 12 stimulus patterns rather than the exhaustive 120 possible permutations (Materials and methods). In each case, we used MAPK-P in place of the molecule ‘A’ for calculating selectivity (<xref ref-type="disp-formula" rid="equ3">Equation 3</xref>). For efficiency, we delivered the stimulus patterns simultaneously in the 4 zones of the cell (<xref ref-type="fig" rid="fig6">Figure 6A</xref>). Similar tuning was observed in test simulations where stimuli were delivered only in a single zone.</p><p>We observed strong sequence selectivity in the basal dendrite zone, for a restricted range of space and time intervals, as expected from the earlier calculations (<xref ref-type="fig" rid="fig6">Figure 6E–G</xref>). We repeated the calculations using different random seeds to generate different background and stimulus spiking input to the model neuron. We found that the responses of individual runs, and hence selectivity, were somewhat noisy (<xref ref-type="fig" rid="fig6">Figure 6E–G</xref>).</p><p>We next investigated whether the response selectivity was manifested in different regions of the cell. We found that there were indeed strongly sequence selective responses in oblique dendrites and distal apical dendritic regions, but these required stronger stimuli (<xref ref-type="fig" rid="fig6">Figure 6H,I</xref>; <xref ref-type="other" rid="media6">Videos 6</xref> and <xref ref-type="other" rid="media7">7</xref>). In these runs, we had to increase the diameters of spine heads and spine shafts by 40% and 20% respectively to obtain sufficient dendritic Ca<sup>2+</sup> influx, and hence selectivity. The reference spine models had a shaft of 1 µm length x 0.2 µm diameter, and a head of length and diameter 0.5 µm. We did not observe sequence recognition in the primary apical dendrite (<xref ref-type="fig" rid="fig6">Figure 6J</xref>). Even the strongest stimuli applied in this location elicited only small Ca<sup>2+</sup> elevations, with weak downstream MAPK responses, and no pattern selectivity.<media content-type="glencoe play-in-place height-250 width-310" id="media6" mime-subtype="mp4" mimetype="video" xlink:href="elife-25827-media6.mp4"><object-id pub-id-type="doi">10.7554/eLife.25827.016</object-id><label>Video 6.</label><caption><title>MAPK-P activity in apical dendrite zone following sequential synaptic input.</title><p>Note high and sustained buildup of MAPK-P activity in a small zone of ~25 microns.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.25827.016">http://dx.doi.org/10.7554/eLife.25827.016</ext-link></p></caption></media><media content-type="glencoe play-in-place height-250 width-310" id="media7" mime-subtype="mp4" mimetype="video" xlink:href="elife-25827-media7.mp4"><object-id pub-id-type="doi">10.7554/eLife.25827.017</object-id><label>Video 7.</label><caption><title>MAPK-P activity in apical dendrite zone following scrambled synaptic input.</title><p>Note that the activity is low and short-lasting.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.25827.017">http://dx.doi.org/10.7554/eLife.25827.017</ext-link></p></caption></media></p><p>We performed a limited parameter sensitivity analysis for the detailed cell model, focusing on biophysical and biochemical parameters involved in triggering or responding to Ca<sup>2+</sup>. We chose these parameters since stimulus range had been one of the most sensitive parameters for the abstract models. We individually varied stimulus strength, L-type Ca<sup>2+</sup> channel density, Ca<sup>2+</sup> diffusion, and the activation of Raf by Ca<sup>2+</sup>. Each of these runs was performed with distinct random seeds and stochasticity in spike-trains and in chemical kinetics in spines. Even though we had not fine-tuned the model for robustness, we found that the model retained selectivity (at least 50% of best selectivity) over a factor of ~2 or more for all parameters except the Raf affinity for Ca<sup>2+</sup> (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). The latter parameter could be varied by ±15% about its reference. While this list is not exhaustive, it does suggest that the sequence selectivity of the detailed model is fairly robust, and somewhat more so than the abstract models.</p><p>Thus, we showed that intracellular signaling pathways exhibited selectivity for ordered synaptic input, even when considerable morphological and electrical detail and noisy input were incorporated. Selectivity became noisier with this additional detail, and different zones of the cell required different synaptic efficacies to achieve selectivity. With the current parameters the selectivity was on the time-scale of seconds, with successive inputs spaced apart by a few microns.</p></sec><sec id="s2-6"><title>Sequence-signaling triggered channel modulation may influence cellular firing</title><p>There are multiple possible outcomes of local sequential activity-triggered chemical signaling. These include synaptic plasticity, dendrite remodeling, and electrical changes through channel modulation. For the purposes of the current study, we focused on the third, namely channel modulation leading to changes in electrical activity, since this defines how the neuron may report the presence of a sequence to other cells in the neuronal network. Similar brief, strong synaptic input on small sections of distal dendrites has been reported to cause strong changes in activity of striatal spiny neurons by triggering a transition to an ‘up’ state (<xref ref-type="bibr" rid="bib43">Plotkin et al., 2011</xref>).</p><p>We utilized the same morphologically detailed pyramidal neuron model as above, and asked if local channel modulations over the length scale of about 20 μm could alter somatic spiking. We assumed that MAPK activity, or other signaling events downstream of sequence selective chemistry, could perform channel modulation through phosphorylation or triggering of channel insertion. For example, MAPK phosphorylates and modulates KA (<xref ref-type="bibr" rid="bib57">Yuan et al., 2002</xref>) Kir6.2 (<xref ref-type="bibr" rid="bib33">Lin and Chai, 2008</xref>), and Na(v) 1.7channels (<xref ref-type="bibr" rid="bib51">Stamboulian et al., 2010</xref>). MAPK is also implicated in control of trafficking of AMPA receptors (<xref ref-type="bibr" rid="bib25">Keifer et al., 2007</xref>). We did not simulate these modulation events explicitly since the computations were very lengthy and we wished to perform many repeats to estimate the distribution of the firing rates following channel modulation. Instead we ran just the electrical cell model for an initial settling period of 1 s, and then used the simulation script to modify the selected channel conductance to represent its modulation. Following this we ran the model for another 3 s in each case. We applied these channel modulations to the same four regions of the cell which we had tested for sequence discrimination. We examined modulation of KA, Na, nonselective leak, NMDAR and AMPAR channels.</p><p>We estimated the statistics of firing following these modulatory changes through repeated simulations of the control condition (100 repeats) and each modulation condition (40 repeats), each with different random number seeds. We found that modulation of the Na channel, and increase in nonselective leak conductance in the apical and primary dendrites could increase firing rates by large factors (<xref ref-type="fig" rid="fig7">Figure 7A,B</xref>).<fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.25827.018</object-id><label>Figure 7.</label><caption><title>Firing rate changes in response to channel modulation in small zones on the dendritic tree.</title><p>Error bars are standard deviation. (<bold>A</bold>) Modulation of Na current. (<bold>B</bold>) Adding nonselective Leak current. (<bold>C</bold>) Modulation of GluR in the presence of the same synaptic input as was used as a stimulus for the sequential input. (<bold>D</bold>) Schematic of convergence of inputs from different ensembles onto one dendritic zone. The numbered clouds represent input ensembles from which a single neuron projects to the indicated location on the dendrite.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.25827.018">http://dx.doi.org/10.7554/eLife.25827.018</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-25827-fig7-v3"/></fig></p><p>In initial runs, modulation of NMDA and AMPA receptors had no effect. This was because the random background synaptic input to these receptors was low, at 0.1 Hz. Since the receptors were activated at this low rate, their effect on cell firing was minimal. However, in these calculations, we had omitted the synaptic input that triggered the chemical cascades. Based on the time-course of build-up of MAPK-P (<xref ref-type="fig" rid="fig5">Figure 5E</xref>, <xref ref-type="fig" rid="fig6">Figure 6D</xref>), the MAPK-P activity was already high by the time of the last synaptic burst in the sequence of inputs. We therefore repeated the calculations, and additionally incorporated a single burst of synaptic input to the NMDA and AMPA receptors for the same duration and frequency as in the full multiscale cell model (<xref ref-type="fig" rid="fig6">Figure 6</xref>).</p><p>With this change, we found that a 10x increase in AMPAR conductance in the 20 μm zone in the apical dendrite led to a doubling in cell firing (<xref ref-type="fig" rid="fig7">Figure 7C</xref>). A similar manipulation in the primary dendrite led to a shallower increase, about 1.5x.</p><p>Thus, chemical signaling, even in rather small regions of the apical dendrite, may lead to a rapid change in cell firing by local channel modulation. However, large channel modulations were needed to elicit sufficiently large (e.g., 50%) changes in in firing rate that could be detected over the noisy background.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We postulate that recursive sequence recognition is a fundamental computational operation in the brain, and that this operation may be implemented by neurons able to recognize spatially and temporally sequential input on behavioral time-scales (seconds). In this study, we have examined three key parts of such a hypothesis. (1) At the chemical level, we have examined a set of abstract rate equations coupled by linear diffusion, and identified key motifs that support sequence recognition. (2) At the dendrite level, we have shown that these abstract principles of reaction-diffusion mediated sequence recognition carry over to much more detailed and biologically motivated neuronal models. These models are multiscale composite models, and explore the length-scales and physiological detail relevant to the current hypothesis. (3) At the cell level, we have shown that local, 20 μm channel modulation can elicit changes in somatic spiking. 20 μm is within the range of our predicted sequence-activated signaling that could lead to channel modulation by phosphorylation or insertion.</p><p>We envision a network configuration where at the input level, there are ensembles of neurons that are active in a defined sequence in some sensory, motor or other context. We focus our analysis on a specific postsynaptic neuron, which receives a projection from each of the preceding ensembles, such that each synapse is located within a few μm of the next.</p><sec id="s3-1"><title>Firing change, synaptic plasticity, and morphological change may result from biochemical sequence recognition</title><p>There are several synaptically activated pathways that may fit the profile of state switching with feedback inhibition. Based on our abstract models (<xref ref-type="fig" rid="fig2">Figure 2</xref>), these are candidates for implementing sequence selectivity. These include four major kinases (PKA, PKC, MAPK, CaMKII) and a variety of second-messenger and metabotropic pathways (<xref ref-type="bibr" rid="bib4">Bhalla and Iyengar, 1999</xref>; <xref ref-type="bibr" rid="bib26">Kim et al., 2011</xref>; <xref ref-type="bibr" rid="bib34">Lisman and Zhabotinsky, 2001</xref>). Thus, though we illustrate our findings using the MAPK pathway, we suggest that other mechanisms may also apply. Biochemical events have multiple outcomes on cell physiology, and even with the one example of MAPK pathway output we suggest that these may (at least) include firing rate changes, plasticity, and morphological change.</p><p>On the rapid time-scale of seconds, MAPK modulates multiple ion channels in the cell. These include KA (<xref ref-type="bibr" rid="bib57">Yuan et al., 2002</xref>), Kir6.2 (<xref ref-type="bibr" rid="bib33">Lin and Chai, 2008</xref>), Na(v)1.7 channels (<xref ref-type="bibr" rid="bib51">Stamboulian et al., 2010</xref>), and MAPK also influences trafficking of AMPA receptors (<xref ref-type="bibr" rid="bib25">Keifer et al., 2007</xref>). As analyzed in <xref ref-type="fig" rid="fig7">Figure 7</xref>, modulation of some of these target channels can lead to immediate changes in cell firing. While the amount of modulation required for an effect is quite large in some cases, we stress that these were proof-of-principle calculations. A more exhaustive calculation would require better cellular physiology including more channel types, full multiscale calculations of the biochemistry leading up to channel modulation, and multiple simultaneous targets. Similar small length-scale events have been shown to affect cellular firing in striatal neurons (<xref ref-type="bibr" rid="bib43">Plotkin et al., 2011</xref>), suggesting that this outcome of sequence selection may also be plausible. It has also been shown that local signaling can lead to changes in dendritic excitability, again modulating cell-wide firing (<xref ref-type="bibr" rid="bib42">Narayanan and Johnston, 2010</xref>).</p><p>On a slightly longer time-scale, MAPK is upstream of numerous plasticity events (<xref ref-type="bibr" rid="bib50">Smolen et al., 2006</xref>). These include phosphorylation and insertion of receptors (<xref ref-type="bibr" rid="bib25">Keifer et al., 2007</xref>), modulation of dendritic protein synthesis (<xref ref-type="bibr" rid="bib54">Tsokas et al., 2007</xref>), and transcriptional control (<xref ref-type="bibr" rid="bib48">Rosenblum et al., 2002</xref>). The computational outcome of synaptic plasticity has been extensively analyzed, but to our knowledge there are no learning rules that factor in sequential activity. It is intriguing to note that our analysis of dendrite-based local chemical activation has parallels with the phenomenon of synaptic tagging (<xref ref-type="bibr" rid="bib14">Frey and Morris, 1997</xref>). In both cases, synaptic input can amplify events in nearby, weakly-stimulated synapses. We speculate that sequence recognition and its conversion to plasticity events may share mechanisms with synaptic tagging.</p><p>Finally, MAPK activation is known to play a role in learning-associated morphological change in neurons (<xref ref-type="bibr" rid="bib55">Tyler et al., 2002</xref>). This raises the possibility that its activation through sequence-selectivity rules may lead to addition of new synapses, or reconfiguration of dendrite geometry and spine placement. Such changes would affect the same reaction-diffusion events that underlie sequence selectivity, leading to interesting multiscale feedback dynamics.</p></sec><sec id="s3-2"><title>Sequence recognition confers substantial computational capabilities on single cells</title><p>Our model of sequence recognition in the neuron implements a potentially powerful form of cellular computation, leading to multiple possible outcomes as discussed above. It is interesting to estimate how much computation this represents. For simplicity, we consider computation in terms of immediate firing rate changes (discussed above), though plasticity and morphological change are also computational outcomes.</p><p>If we take a 5-stage sequence, a perfect sequence recognizer would distinguish 1 from 5! possible sequences, or 1 in 120. Longer sequences would have exponentially steeper discrimination ratios, but this places increasingly stringent constraints on network connectivity due to the requirement of having the inputs close to each other. Based on our simulations, biochemical reactions in the presence of noisy input are not as clean in their sequence selectivity as the abstract models (<xref ref-type="fig" rid="fig6">Figure 6</xref> vs. <xref ref-type="fig" rid="fig3">Figure 3</xref>) but nevertheless do achieve good discrimination. In addition to being able to discriminate an ordered sequence from among many others, it is desirable that there be a large difference in chemical signal amplitude between ordered and scrambled sequences. <xref ref-type="fig" rid="fig2">Figures 2</xref>, <xref ref-type="fig" rid="fig3">3</xref> and <xref ref-type="fig" rid="fig5">5</xref> suggest that ratios in the range of 1:5 may be achievable, and 1:2 should be common.</p><p>Next, we estimate how many such sequence recognition blocks there might be in a neuron. For this analysis, we draw on the results of the biochemical calculations for an estimate of a sequence recognition zone, of ~10 μm (<xref ref-type="fig" rid="fig6">Figure 6</xref>), and the result that sequence discrimination should happen over most of the dendritic tree except for the trunk of the primary apical dendrite (<xref ref-type="fig" rid="fig6">Figure 6J</xref>). Say the set of spines occupies 10 μm. The most conservative calculation requires that these blocks do not overlap, so in a pyramidal neuron with about 10000 μm of dendritic length we have ~1000 blocks. If we permit blocks to slide by one input at a time, there are five times as many sequence recognition blocks, i.e., ~5000. If the sequence lasts 10 s, a single block performs 0.1 sequence recognitions per second. Thus, the neuron may perform 500 sequence discriminations each second. Calcium-induced Calcium release (CICR) based sequence logic (discussed below) is much faster, and may be able to increase this by a factor of 10. It is out of scope of the current study to estimate how many of the 500 possible sequential inputs would be active and in order at any given instant, but it is clear that the outcome of such sequence discrimination across the cell would be much more selective than a simple sum of the synaptic inputs that underlie the sequences. Leaving aside the plasticity effects, the readout of these sequence discriminations could be an ongoing modulation of cellular firing.</p><p>A still more speculative calculation suggests that single-neuron sequence recognition may provide a way to handle the combinatorial explosion of possible input sequences. Assume that sequential inputs converge to 10 μm stretches of dendrite, having spine spacing <italic>σ</italic> = 0.5 μm. Assume that the sequence-recognition biochemistry tolerates a spatial slop of ±1.5 μm, or ±3 synapses, for each input. Then there are ~7 possible synaptic inputs for each stage of the sequence, and the overall block of 5 inputs may receive 7<sup>5</sup>, or ~17000 sequences of length 5. Using our calculation above, each neuron has ~5000 blocks, and so can recognize ~8.5×10<sup>7</sup> sequences. Thus, with many assumptions about connectivity and sparsity, this mechanism of single-neuron sequence recognition suggests that single neurons may recognize very large numbers of input patterns through the combinatorics of synaptic convergence.</p><p>The key distinction between these two calculations is that the first indicates the computational capacity of a neuron, whereas the second considers the diversity of inputs it can act upon. Overall, our study suggests that sequence computation in the time domain, coupled with the combinatorics of spatially organized input along dendrites, result in extremely parallel and efficient computation at the single-neuron level.</p></sec><sec id="s3-3"><title>Single-cell sequence recognition may act on a continuum of timescales</title><p>Neural activity sequences occur at a range of timescales. A striking example of this is the mapping of behaviorally-driven place-cell sequences (seconds) to rapid, 100 ms time-scale replay sequences (<xref ref-type="bibr" rid="bib56">Wilson and McNaughton, 1994</xref>). The distinctive aspect of our current analysis is that it works for slow behavioral time-scales of seconds, which is typically challenging for electrical network computations (but see [<xref ref-type="bibr" rid="bib3">Barak and Tsodyks, 2006</xref>; <xref ref-type="bibr" rid="bib17">Goudar and Buonomano, 2015</xref>]). Our analysis suggests that chemical mechanisms can also support faster sequence recognition on the same length-scales (<xref ref-type="fig" rid="fig4">Figure 4</xref>). One way this might be implemented in the cell could be a faster kinase cascade than MAPK, such as PKA or PKC (<xref ref-type="bibr" rid="bib5">Bhalla, 2002</xref>). Another might be local CICR, which has already been proposed to support propagating wave activity in dendrites (<xref ref-type="bibr" rid="bib18">Hagenston et al., 2008</xref>; <xref ref-type="bibr" rid="bib23">Kapur et al., 2001</xref>; <xref ref-type="bibr" rid="bib30">Larkum et al., 2003</xref>; <xref ref-type="bibr" rid="bib32">Lee et al., 2016</xref>; <xref ref-type="bibr" rid="bib44">Plotkin et al., 2013</xref>; <xref ref-type="bibr" rid="bib49">Ross, 2012</xref>) These have faster dynamics, of the order of 100 μm/s. Further, dendritic Ca<sup>2+</sup> imaging suggests that the length-scale of dendritic CICR is similar (~10–20 μm) to that envisaged for sequence recognition in our study (<xref ref-type="bibr" rid="bib18">Hagenston et al., 2008</xref>; <xref ref-type="bibr" rid="bib23">Kapur et al., 2001</xref>; <xref ref-type="bibr" rid="bib30">Larkum et al., 2003</xref>). Simulation studies have previously suggested that CICR may be a mechanism for integration of inputs and resulting in graded, persistent activity (<xref ref-type="bibr" rid="bib35">Loewenstein and Sompolinsky, 2003</xref>). This study has some parallels with our analysis, in particular the presence of a propagating wavefront of chemical (Ca<sup>2+</sup>) activation. However, in the earlier CICR model the wavefront propagation was modulated by the summed synaptic input to the neuron rather than local and specific sequential synaptic input, which is the basis of our study.</p><p>Individual chemical implementations of sequence recognition in our study operate over a range of about 2–5 μm and 1.5–4 s (<xref ref-type="fig" rid="fig4">Figures 4</xref> and <xref ref-type="fig" rid="fig6">6</xref>). While this is fairly robust as seen from a parameter sensitivity viewpoint, it falls far short of time-invariance. Rate modulation or stimulus amplitude may shift this to some extent (<xref ref-type="fig" rid="fig4">Figure 4</xref>) but a given cell, in a given state of modulation or activity, will recognize sequences only within a relatively small range. One possible way to extend the range is to have multiple chemical pathways each carry out sequence discrimination in parallel. It would be interesting to see how the chemistry of multiple sequence recognizers may interact. Alternatively, time-invariance may not be a feature of single neurons, but may arise in a network where different neurons recognize different time-ranges. Different cell-types with different chemical mechanisms for sequence-recognition would be likely to operate in substantially different time regimes. It is interesting to speculate that there may be useful computational implications of having different cells ‘tuned’ to different sequence speeds.</p><p>Still faster sequence recognition (~40 ms) has been demonstrated in the electrical domain, where forward sequences can be discriminated from backward (<xref ref-type="bibr" rid="bib9">Branco et al., 2010</xref>). This electrical mechanism has been shown to have ~40% discrimination between forward and backward patterns, rather than the strong selectivity among permutations of patterns shown by our chemical system. Thus this form of electrical sequence recognition is likely to operate in different network contexts than our proposed chemical recognition mechanism.</p><p>Together, we suggest that chemical and CICR-based sequence recognition may span the range of timescales from 200 ms to 10 s. It is interesting to speculate that these may coexist, thus permitting the same segment of dendrite to recognize slow behaviorally-driven sequences and also much faster replays of the same sequence.</p></sec><sec id="s3-4"><title>Sequence recognition is testable</title><p>Our hypothesis of single-cell sequence recognition is readily testable using current technology. Its chemical basis may be examined in brain-slice using local agonist application or sequential glutamate uncaging followed by microscopic readouts of activity reporters for candidate pathways. Such experiments have already been done to examine CICR triggered by synaptic inputs converging to adjacent synapses (<xref ref-type="bibr" rid="bib18">Hagenston et al., 2008</xref>; <xref ref-type="bibr" rid="bib44">Plotkin et al., 2013</xref>). These show that there is indeed a buildup of Ca<sup>2+</sup> along small, 20 μm stretches of dendrite, under suitable stimulus conditions. If local biochemical signaling leads to changes in cellular firing-rate (e.g., <xref ref-type="fig" rid="fig7">Figure 7</xref>, [<xref ref-type="bibr" rid="bib43">Plotkin et al., 2011</xref>]), then sequential uncaging along with patch recordings should report these. Further, pharmacological experiments in the slice would readily be able to tease apart possible mechanisms.</p><p>Another implication of the proposed reaction-diffusion mechanism for sequence recognition is that it suggests mechanisms for coupling genetic polymorphisms and mutations to a specific aspect of neuronal computation. For example, small changes in reaction rates may shift the preferred timescale of recognized sequences (<xref ref-type="fig" rid="fig4">Figure 4</xref>), but large changes may eliminate tuning altogether. It would be interesting to see if there is a correlation between specific dendritic signaling genes and psychophysical measures of sequence computation.</p><p>In summary, we propose a novel computational function of single neurons, to recognize slow sequences on behavioral timescales, and to exploit combinatorics of input projections to carry out such recognition in a massively parallel manner. We have used simulations of abstract chemistry and detailed multiscale neuronal physiology to understand implications and constraints for such computation to occur. We suggest that this multiscale cellular signaling process may underlie computationally powerful sequence recognition mediated by single neurons.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><p>All modeling was carried out using MOOSE, the Multiscale Object-Oriented Simulation Environment (<xref ref-type="bibr" rid="bib46">Ray and Bhalla, 2008</xref>). MOOSE is freely available, open source, and licensed under the GNU Public License version 3. It can be downloaded from moose.ncbs.res.in and GitHub <ext-link ext-link-type="uri" xlink:href="https://github.com/BhallaLab/moose">https://github.com/BhallaLab/moose</ext-link> (<xref ref-type="bibr" rid="bib7">Bhalla et al., 2016</xref>). MOOSE utilizes the GNU Scientific Library (GSL) Runge-Kutta-Fehlberg fifth order method for chemical computations, and a custom-written branching 1-D diffusion solver using the backward Euler (implicit) method. Stochastic chemical calculations were carried out using a custom-written optimized version of the Gillespie Stochastic Systems Algorithm. Pseudo-random numbers were generated by the Mersenne twister (<xref ref-type="bibr" rid="bib38">Matsumoto and Nishimura, 1998</xref>). Electrical computations utilized a custom version of the branched nerve equation solution methods described by Hines (<xref ref-type="bibr" rid="bib21">Hines, 1984</xref>). This has been validated by comparison with other simulators (<xref ref-type="bibr" rid="bib16">Gleeson et al., 2010</xref>). Interfaces between chemical and electrical signaling components of the model utilized adaptor classes in MOOSE, which average over spatial and temporal discretization differences between the two methods. For example, electrical calculations (yielding Ca<sup>2+</sup> values) utilize a much smaller timestep (~50 μs; 5 μm) but typically employ a larger spatial step than chemical calculations (~1 ms, 1 μm). The adaptors synchronized the chemical and electrical models every millisecond using first-order corrections to each model system. Electrical model morphologies were either geometrical (cylindrical) or derived from published cell reconstructions available on NeuroMorpho.org (<xref ref-type="bibr" rid="bib2">Ascoli et al., 2007</xref>; <xref ref-type="bibr" rid="bib12">Dougherty et al., 2012</xref>). Spines were positioned along dendrites using Poisson statistics with a specified mean spacing between spines (1 μm in the full cell model). Spines were modeled as a cylindrical head (0.5 μm length and diameter) on a cylindrical shaft (1 μm length, 0.2 μm diameter). In some simulations the spine dimensions were scaled up by 20% or 40%. Channel kinetics were derived from <xref ref-type="bibr" rid="bib53">Traub et al. (1991)</xref>. Analysis and plotting was done using Python, NumPy, and MatPlotLib. Simulations were carried out on a variety of Linux workstations, and large calculations were carried out on Linux clusters. Figure generation code for <xref ref-type="fig" rid="fig2">Figures 2</xref>, <xref ref-type="fig" rid="fig5">5</xref> and <xref ref-type="fig" rid="fig6">6</xref> is available as supplementary material.</p><p>Abstract reaction-diffusion calculations (<xref ref-type="fig" rid="fig2">Figures 2</xref>–<xref ref-type="fig" rid="fig4">4</xref>) were carried out in a 1-dimensional geometry with spatial discretization of 1 μm. In order to represent reactions occurring in a spatially restricted region in or under dendritic spines, the reaction systems were active only in five equally spaced 1 μm patches, but diffusion took place throughout the 100 μm length of the model.</p><p>Selectivity calculations were performed according to <xref ref-type="disp-formula" rid="equ3">Equation 3</xref>. In this equation, <italic>Atot</italic> is computed for each permutation of the sequence. This is expensive as there are 120 permutations for a sequence of length 5. Therefore exhaustive permutations were only performed for <xref ref-type="fig" rid="fig3">Figures 3</xref> and <xref ref-type="fig" rid="fig4">4</xref>. In order to generate sequence selectivity matrices for <xref ref-type="fig" rid="fig6">Figure 6</xref> and for all the sensitivity analyses, we took every tenth permutation (including the first one, [0,1,2,3,4]), for a total of 12 permutations. The order of permutations was as generated by the Python library call <italic>itertools.permutations</italic>. The resultant sequences were: [0,1,2,3,4], [0,2,4,1,3], [0,4,2,1,3], [1,2,0,3,4 , 1,3,4,0,2 , 2,0,3,1,4 , 2,3,0,1,4 , 2,4,3,0,1 , 3,1,2,0,4 , 3,4,0,1,2 , 4,0,3,1,2 , 4,2,1,0,3]. Here [0,1,2,3,4] means that synapse 0 fires first, then synapse 1, then synapse two and so on. In <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref> we modified <xref ref-type="disp-formula" rid="equ3">Equation 3</xref> slightly by computing <italic>Asequential</italic> as the mean of 5 runs with the same, sequential stimuli. This was done because the stochastic spiking and chemical calculations introduced considerable variability in the estimate of <italic>Asequential</italic>. In this figure the <italic>mean(Atot)</italic> term in <xref ref-type="disp-formula" rid="equ3">Equation 3</xref> took this mean value of <italic>Asequential</italic>, and <italic>Atot</italic> for the other 11 permutations, as the set over which the mean was computed.</p><p>Chemical models are available in the supplementary material in tabular form and as GENESIS/kkit files, and will be hosted on <ext-link ext-link-type="uri" xlink:href="http://doqcs.ncbs.res.in">http://doqcs.ncbs.res.in</ext-link> and ModelDB. Electrical models are available in supplementary material in tabular form and as MOOSE scripts. The morphology file is from NeuroMorpho.org (<xref ref-type="bibr" rid="bib2">Ascoli et al., 2007</xref>; <xref ref-type="bibr" rid="bib12">Dougherty et al., 2012</xref>) and attached in the supplementary material as the file VHC-neuron.CNG.swc.</p></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>I acknowledge funding support from NCBS/TIFR and the Department of Science and Technology grant SR/CSI/66/2013 under the Cognitive Science Research Initiative. Large simulations were carried out in the NCBS Supercomputing facility. I acknowledge Arvind Kumar and Sahil Moza for comments on the project.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>USB: Reviewing editor, <italic>eLife</italic></p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>USB, Conceptualization, Resources, Data curation, Software, Formal analysis, Supervision, Funding acquisition, Validation, Investigation, Visualization, Methodology, Writing—original draft, Project administration, Writing—review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="SD1-data"><object-id pub-id-type="doi">10.7554/eLife.25827.019</object-id><label>Source code 1.</label><caption><title>This set of source files is provided to illustrate generation of numerical portions of <xref ref-type="fig" rid="fig2">Figure 2</xref>, <xref ref-type="fig" rid="fig5">Figure 5</xref>, and <xref ref-type="fig" rid="fig6">Figure 6</xref>.</title><p>The contents of the zip file include a README.txt, which has the file information and running instructions. In addition, it has script files for various parts of the figures, as well as model specification files for the chemical channel, and morphological parameters. Files include:</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.25827.019">http://dx.doi.org/10.7554/eLife.25827.019</ext-link></p></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-25827-code1-v3.zip"/></supplementary-material><supplementary-material id="SD2-data"><object-id pub-id-type="doi">10.7554/eLife.25827.020</object-id><label>Supplementary file 1.</label><caption><title>The supplementary data file specifies chemical reactions and parameters for the MAPK model.</title><p>It also specifies channel equations and parameters for the full cell model used in <xref ref-type="fig" rid="fig6">Figures 6</xref> and <xref ref-type="fig" rid="fig7">7</xref>. Finally, it specifies the channel distributions in the full cell model.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.25827.020">http://dx.doi.org/10.7554/eLife.25827.020</ext-link></p></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-25827-supp1-v3.docx"/></supplementary-material><sec id="s7" sec-type="datasets"><title>Major datasets</title><p>The following previously published dataset was used:</p><p><related-object content-type="generated-dataset" id="data-ro1" source-id="http://neuromorpho.org/neuron_info.jsp?neuron_name=VHC-neuron" source-id-type="uri"><collab>Ascoli GA</collab><x>,</x> <collab>Donohue DE</collab><x>,</x> <collab>Halavi M</collab><x>,</x> <year>2007</year><x>,</x><source>NeuroMorpho.org</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="http://neuromorpho.org/neuron_info.jsp?neuron_name=VHC-neuron">http://neuromorpho.org/neuron_info.jsp?neuron_name=VHC-neuron</ext-link><x>,</x> <comment>Publicly available at NeuroMorpho.org (accession no: NMO_09573)</comment></related-object></p></sec></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Abeles</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1982">1982</year><source>Local Cortical Circuits: An Electrophysiological Study</source><publisher-loc>Berlin</publisher-loc><publisher-name>Springer</publisher-name></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ascoli</surname><given-names>GA</given-names></name><name><surname>Donohue</surname><given-names>DE</given-names></name><name><surname>Halavi</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>NeuroMorpho.Org: a central resource for neuronal morphologies</article-title><source>Journal of Neuroscience</source><volume>27</volume><fpage>9247</fpage><lpage>9251</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2055-07.2007</pub-id><pub-id pub-id-type="pmid">17728438</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barak</surname><given-names>O</given-names></name><name><surname>Tsodyks</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Recognition by variance: learning rules for spatiotemporal patterns</article-title><source>Neural Computation</source><volume>18</volume><fpage>2343</fpage><lpage>2358</lpage><pub-id pub-id-type="doi">10.1162/neco.2006.18.10.2343</pub-id><pub-id pub-id-type="pmid">16907629</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bhalla</surname><given-names>US</given-names></name><name><surname>Iyengar</surname><given-names>R</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Emergent properties of networks of biological signaling pathways</article-title><source>Science</source><volume>283</volume><fpage>381</fpage><lpage>387</lpage><pub-id pub-id-type="doi">10.1126/science.283.5400.381</pub-id><pub-id pub-id-type="pmid">9888852</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bhalla</surname><given-names>US</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Mechanisms for temporal tuning and filtering by postsynaptic signaling pathways</article-title><source>Biophysical Journal</source><volume>83</volume><fpage>740</fpage><lpage>752</lpage><pub-id pub-id-type="doi">10.1016/S0006-3495(02)75205-3</pub-id><pub-id pub-id-type="pmid">12124261</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bhalla</surname><given-names>US</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Multiscale interactions between chemical and electric signaling in LTP induction, LTP reversal and dendritic excitability</article-title><source>Neural Networks</source><volume>24</volume><fpage>943</fpage><lpage>949</lpage><pub-id pub-id-type="doi">10.1016/j.neunet.2011.05.001</pub-id><pub-id pub-id-type="pmid">21616637</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Bhalla</surname><given-names>US</given-names></name><name><surname>Ray</surname><given-names>S</given-names></name><name><surname>HarshaRani</surname><given-names>GV</given-names></name><name><surname>Singh</surname><given-names>D</given-names></name><name><surname>Dudani</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2016">2016</year><data-title>MOOSE simulator</data-title><source>GitHub</source><version>e5ac4a0</version><uri xlink:href="https://github.com/BhallaLab/moose">https://github.com/BhallaLab/moose</uri></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bouchard</surname><given-names>KE</given-names></name><name><surname>Brainard</surname><given-names>MS</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Auditory-induced neural dynamics in sensory-motor circuitry predict learned temporal and sequential statistics of birdsong</article-title><source>PNAS</source><volume>113</volume><fpage>9641</fpage><lpage>9646</lpage><pub-id pub-id-type="doi">10.1073/pnas.1606725113</pub-id><pub-id pub-id-type="pmid">27506786</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Branco</surname><given-names>T</given-names></name><name><surname>Clark</surname><given-names>BA</given-names></name><name><surname>Häusser</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Dendritic discrimination of temporal input sequences in cortical neurons</article-title><source>Science</source><volume>329</volume><fpage>1671</fpage><lpage>1675</lpage><pub-id pub-id-type="doi">10.1126/science.1189664</pub-id><pub-id pub-id-type="pmid">20705816</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Broome</surname><given-names>BM</given-names></name><name><surname>Jayaraman</surname><given-names>V</given-names></name><name><surname>Laurent</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Encoding and decoding of overlapping odor sequences</article-title><source>Neuron</source><volume>51</volume><fpage>467</fpage><lpage>482</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2006.07.018</pub-id><pub-id pub-id-type="pmid">16908412</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carrillo-Reid</surname><given-names>L</given-names></name><name><surname>Miller</surname><given-names>JE</given-names></name><name><surname>Hamm</surname><given-names>JP</given-names></name><name><surname>Jackson</surname><given-names>J</given-names></name><name><surname>Yuste</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Endogenous sequential cortical activity evoked by visual stimuli</article-title><source>Journal of Neuroscience</source><volume>35</volume><fpage>8813</fpage><lpage>8828</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.5214-14.2015</pub-id><pub-id pub-id-type="pmid">26063915</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dougherty</surname><given-names>KA</given-names></name><name><surname>Islam</surname><given-names>T</given-names></name><name><surname>Johnston</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Intrinsic excitability of CA1 pyramidal neurones from the rat dorsal and ventral Hippocampus</article-title><source>The Journal of Physiology</source><volume>590</volume><fpage>5707</fpage><lpage>5722</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.2012.242693</pub-id><pub-id pub-id-type="pmid">22988138</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fitzhugh</surname><given-names>R</given-names></name></person-group><year iso-8601-date="1961">1961</year><article-title>Impulses and physiological States in Theoretical models of Nerve membrane</article-title><source>Biophysical Journal</source><volume>1</volume><fpage>445</fpage><lpage>466</lpage><pub-id pub-id-type="doi">10.1016/S0006-3495(61)86902-6</pub-id><pub-id pub-id-type="pmid">19431309</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frey</surname><given-names>U</given-names></name><name><surname>Morris</surname><given-names>RG</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Synaptic tagging and long-term potentiation</article-title><source>Nature</source><volume>385</volume><fpage>533</fpage><lpage>536</lpage><pub-id pub-id-type="doi">10.1038/385533a0</pub-id><pub-id pub-id-type="pmid">9020359</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>George</surname><given-names>D</given-names></name><name><surname>Hawkins</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Towards a mathematical theory of cortical micro-circuits</article-title><source>PLoS Computational Biology</source><volume>5</volume><elocation-id>e1000532</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000532</pub-id><pub-id pub-id-type="pmid">19816557</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gleeson</surname><given-names>P</given-names></name><name><surname>Crook</surname><given-names>S</given-names></name><name><surname>Cannon</surname><given-names>RC</given-names></name><name><surname>Hines</surname><given-names>ML</given-names></name><name><surname>Billings</surname><given-names>GO</given-names></name><name><surname>Farinella</surname><given-names>M</given-names></name><name><surname>Morse</surname><given-names>TM</given-names></name><name><surname>Davison</surname><given-names>AP</given-names></name><name><surname>Ray</surname><given-names>S</given-names></name><name><surname>Bhalla</surname><given-names>US</given-names></name><name><surname>Barnes</surname><given-names>SR</given-names></name><name><surname>Dimitrova</surname><given-names>YD</given-names></name><name><surname>Silver</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>NeuroML: a language for describing data driven models of neurons and networks with a high degree of biological detail</article-title><source>PLoS Computational Biology</source><volume>6</volume><elocation-id>e1000815</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000815</pub-id><pub-id pub-id-type="pmid">20585541</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goudar</surname><given-names>V</given-names></name><name><surname>Buonomano</surname><given-names>DV</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A model of order-selectivity based on dynamic changes in the balance of excitation and inhibition produced by short-term synaptic plasticity</article-title><source>Journal of Neurophysiology</source><volume>113</volume><fpage>509</fpage><lpage>523</lpage><pub-id pub-id-type="doi">10.1152/jn.00568.2014</pub-id><pub-id pub-id-type="pmid">25339707</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hagenston</surname><given-names>AM</given-names></name><name><surname>Fitzpatrick</surname><given-names>JS</given-names></name><name><surname>Yeckel</surname><given-names>MF</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>MGluR-mediated calcium waves that invade the soma regulate firing in layer V medial prefrontal cortical pyramidal neurons</article-title><source>Cerebral Cortex</source><volume>18</volume><fpage>407</fpage><lpage>423</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhm075</pub-id><pub-id pub-id-type="pmid">17573372</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hawkins</surname><given-names>J</given-names></name><name><surname>Ahmad</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Why neurons have thousands of Synapses, a Theory of sequence memory in Neocortex</article-title><source>Frontiers in Neural Circuits</source><volume>10</volume><pub-id pub-id-type="doi">10.3389/fncir.2016.00023</pub-id><pub-id pub-id-type="pmid">27065813</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Hebb</surname><given-names>DO</given-names></name></person-group><year iso-8601-date="1949">1949</year><source>The Organization of Behavior</source><publisher-name>Wiley</publisher-name></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hines</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1984">1984</year><article-title>Efficient computation of branched nerve equations</article-title><source>International Journal of Bio-Medical Computing</source><volume>15</volume><fpage>69</fpage><lpage>76</lpage><pub-id pub-id-type="doi">10.1016/0020-7101(84)90008-4</pub-id><pub-id pub-id-type="pmid">6698635</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jadhav</surname><given-names>SP</given-names></name><name><surname>Kemere</surname><given-names>C</given-names></name><name><surname>German</surname><given-names>PW</given-names></name><name><surname>Frank</surname><given-names>LM</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Awake hippocampal sharp-wave ripples support spatial memory</article-title><source>Science</source><volume>336</volume><fpage>1454</fpage><lpage>1458</lpage><pub-id pub-id-type="doi">10.1126/science.1217230</pub-id><pub-id pub-id-type="pmid">22555434</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kapur</surname><given-names>A</given-names></name><name><surname>Yeckel</surname><given-names>M</given-names></name><name><surname>Johnston</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Hippocampal mossy fiber activity evokes Ca2+ release in CA3 pyramidal neurons via a metabotropic glutamate receptor pathway</article-title><source>Neuroscience</source><volume>107</volume><fpage>59</fpage><lpage>69</lpage><pub-id pub-id-type="doi">10.1016/S0306-4522(01)00293-7</pub-id><pub-id pub-id-type="pmid">11744247</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Keener</surname><given-names>J</given-names></name><name><surname>Sneyd</surname><given-names>J</given-names></name></person-group><year iso-8601-date="1998">1998</year><source>Mathematical Physiology</source><publisher-loc>New York</publisher-loc><publisher-name>Springer</publisher-name></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keifer</surname><given-names>J</given-names></name><name><surname>Zheng</surname><given-names>ZQ</given-names></name><name><surname>Zhu</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>MAPK signaling pathways mediate AMPA receptor trafficking in an in vitro model of classical conditioning</article-title><source>Journal of Neurophysiology</source><volume>97</volume><fpage>2067</fpage><lpage>2074</lpage><pub-id pub-id-type="doi">10.1152/jn.01154.2006</pub-id><pub-id pub-id-type="pmid">17202235</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>M</given-names></name><name><surname>Park</surname><given-names>AJ</given-names></name><name><surname>Havekes</surname><given-names>R</given-names></name><name><surname>Chay</surname><given-names>A</given-names></name><name><surname>Guercio</surname><given-names>LA</given-names></name><name><surname>Oliveira</surname><given-names>RF</given-names></name><name><surname>Abel</surname><given-names>T</given-names></name><name><surname>Blackwell</surname><given-names>KT</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Colocalization of protein kinase A with adenylyl cyclase enhances protein kinase A activity during induction of long-lasting long-term-potentiation</article-title><source>PLoS Computational Biology</source><volume>7</volume><elocation-id>e1002084</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002084</pub-id><pub-id pub-id-type="pmid">21738458</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kumar</surname><given-names>A</given-names></name><name><surname>Rotter</surname><given-names>S</given-names></name><name><surname>Aertsen</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Conditions for propagating synchronous spiking and asynchronous firing rates in a cortical network model</article-title><source>Journal of Neuroscience</source><volume>28</volume><fpage>5268</fpage><lpage>5280</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2542-07.2008</pub-id><pub-id pub-id-type="pmid">18480283</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laje</surname><given-names>R</given-names></name><name><surname>Buonomano</surname><given-names>DV</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Robust timing and motor patterns by taming Chaos in recurrent neural networks</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>925</fpage><lpage>933</lpage><pub-id pub-id-type="doi">10.1038/nn.3405</pub-id><pub-id pub-id-type="pmid">23708144</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lake</surname><given-names>D</given-names></name><name><surname>Corrêa</surname><given-names>SA</given-names></name><name><surname>Müller</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Negative feedback regulation of the ERK1/2 MAPK pathway</article-title><source>Cellular and Molecular Life Sciences</source><volume>73</volume><fpage>4397</fpage><lpage>4413</lpage><pub-id pub-id-type="doi">10.1007/s00018-016-2297-8</pub-id><pub-id pub-id-type="pmid">27342992</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Larkum</surname><given-names>ME</given-names></name><name><surname>Watanabe</surname><given-names>S</given-names></name><name><surname>Nakamura</surname><given-names>T</given-names></name><name><surname>Lasser-Ross</surname><given-names>N</given-names></name><name><surname>Ross</surname><given-names>WN</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Synaptically activated Ca2+ waves in layer 2/3 and layer 5 rat neocortical pyramidal neurons</article-title><source>The Journal of Physiology</source><volume>549</volume><fpage>471</fpage><lpage>488</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.2002.037614</pub-id><pub-id pub-id-type="pmid">12692172</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>DL</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Pattern sequence recognition using a time-varying Hopfield network</article-title><source>IEEE Transactions on Neural Networks</source><volume>13</volume><fpage>330</fpage><lpage>342</lpage><pub-id pub-id-type="doi">10.1109/72.991419</pub-id><pub-id pub-id-type="pmid">18244435</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>KF</given-names></name><name><surname>Soares</surname><given-names>C</given-names></name><name><surname>Thivierge</surname><given-names>JP</given-names></name><name><surname>Béïque</surname><given-names>JC</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Correlated synaptic inputs drive dendritic calcium amplification and Cooperative plasticity during Clustered Synapse Development</article-title><source>Neuron</source><volume>89</volume><fpage>784</fpage><lpage>799</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.01.012</pub-id><pub-id pub-id-type="pmid">26853305</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>YF</given-names></name><name><surname>Chai</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Functional modulation of the ATP-sensitive potassium channel by extracellular signal-regulated kinase-mediated phosphorylation</article-title><source>Neuroscience</source><volume>152</volume><fpage>371</fpage><lpage>380</lpage><pub-id pub-id-type="doi">10.1016/j.neuroscience.2008.01.003</pub-id><pub-id pub-id-type="pmid">18280666</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lisman</surname><given-names>JE</given-names></name><name><surname>Zhabotinsky</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>A model of synaptic memory: a CaMKII/PP1 switch that potentiates transmission by organizing an AMPA receptor anchoring assembly</article-title><source>Neuron</source><volume>31</volume><fpage>191</fpage><lpage>201</lpage><pub-id pub-id-type="pmid">11502252</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Loewenstein</surname><given-names>Y</given-names></name><name><surname>Sompolinsky</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Temporal integration by calcium dynamics in a model neuron</article-title><source>Nature Neuroscience</source><volume>6</volume><fpage>961</fpage><lpage>967</lpage><pub-id pub-id-type="doi">10.1038/nn1109</pub-id><pub-id pub-id-type="pmid">12937421</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lorente de No</surname><given-names>R</given-names></name></person-group><year iso-8601-date="1938">1938</year><article-title>Analysis of the activity of the chains of internuncial neurons</article-title><source>Journal of Neurophysiology</source><volume>1</volume><fpage>195</fpage><lpage>206</lpage></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>MacDonald</surname><given-names>CJ</given-names></name><name><surname>Lepage</surname><given-names>KQ</given-names></name><name><surname>Eden</surname><given-names>UT</given-names></name><name><surname>Eichenbaum</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Hippocampal &quot;time cells&quot; bridge the gap in memory for discontiguous events</article-title><source>Neuron</source><volume>71</volume><fpage>737</fpage><lpage>749</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2011.07.012</pub-id><pub-id pub-id-type="pmid">21867888</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matsumoto</surname><given-names>M</given-names></name><name><surname>Nishimura</surname><given-names>T</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Mersenne twister: a 623-dimensionally equidistributed uniform pseudo-random number generator</article-title><source>ACM Transactions on Modeling and Computer Simulation</source><volume>8</volume><fpage>3</fpage><lpage>30</lpage><pub-id pub-id-type="doi">10.1145/272991.272995</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mehring</surname><given-names>C</given-names></name><name><surname>Hehl</surname><given-names>U</given-names></name><name><surname>Kubo</surname><given-names>M</given-names></name><name><surname>Diesmann</surname><given-names>M</given-names></name><name><surname>Aertsen</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Activity dynamics and propagation of synchronous spiking in locally connected random networks</article-title><source>Biological Cybernetics</source><volume>88</volume><fpage>395</fpage><lpage>408</lpage><pub-id pub-id-type="doi">10.1007/s00422-002-0384-4</pub-id><pub-id pub-id-type="pmid">12750902</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Modi</surname><given-names>MN</given-names></name><name><surname>Dhawale</surname><given-names>AK</given-names></name><name><surname>Bhalla</surname><given-names>US</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>CA1 cell activity sequences emerge after reorganization of network correlation structure during associative learning</article-title><source>eLife</source><volume>3</volume><elocation-id>e01982</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.01982</pub-id><pub-id pub-id-type="pmid">24668171</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nagumo</surname><given-names>J</given-names></name><name><surname>Arimoto</surname><given-names>S</given-names></name><name><surname>Yoshizawa</surname><given-names>S</given-names></name></person-group><year iso-8601-date="1962">1962</year><article-title>An active pulse transmission line simulating nerve axon</article-title><source>Proceedings of the IRE</source><volume>50</volume><fpage>2061</fpage><lpage>2070</lpage><pub-id pub-id-type="doi">10.1109/JRPROC.1962.288235</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Narayanan</surname><given-names>R</given-names></name><name><surname>Johnston</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>The h current is a candidate mechanism for regulating the sliding modification threshold in a BCM-like synaptic learning rule</article-title><source>Journal of Neurophysiology</source><volume>104</volume><fpage>1020</fpage><lpage>1033</lpage><pub-id pub-id-type="doi">10.1152/jn.01129.2009</pub-id><pub-id pub-id-type="pmid">20554832</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Plotkin</surname><given-names>JL</given-names></name><name><surname>Day</surname><given-names>M</given-names></name><name><surname>Surmeier</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Synaptically driven state transitions in distal dendrites of striatal spiny neurons</article-title><source>Nature Neuroscience</source><volume>14</volume><fpage>881</fpage><lpage>888</lpage><pub-id pub-id-type="doi">10.1038/nn.2848</pub-id><pub-id pub-id-type="pmid">21666674</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Plotkin</surname><given-names>JL</given-names></name><name><surname>Shen</surname><given-names>W</given-names></name><name><surname>Rafalovich</surname><given-names>I</given-names></name><name><surname>Sebel</surname><given-names>LE</given-names></name><name><surname>Day</surname><given-names>M</given-names></name><name><surname>Chan</surname><given-names>CS</given-names></name><name><surname>Surmeier</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Regulation of dendritic calcium release in striatal spiny projection neurons</article-title><source>Journal of Neurophysiology</source><volume>110</volume><fpage>2325</fpage><lpage>2336</lpage><pub-id pub-id-type="doi">10.1152/jn.00422.2013</pub-id><pub-id pub-id-type="pmid">23966676</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Rall</surname><given-names>W</given-names></name></person-group><year iso-8601-date="1964">1964</year><chapter-title>Theoretical significance of dendritic trees for neuronal input-output relations</chapter-title><person-group person-group-type="editor"><name><surname>R.Reiss</surname></name></person-group><source>Neural Theory and Modeling</source><publisher-loc>Stanford, CA</publisher-loc><publisher-name>Stanford Univ. Press</publisher-name><fpage>73</fpage><lpage>97</lpage></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ray</surname><given-names>S</given-names></name><name><surname>Bhalla</surname><given-names>US</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>PyMOOSE: interoperable scripting in Python for MOOSE</article-title><source>Frontiers in Neuroinformatics</source><volume>2</volume><elocation-id>6</elocation-id><pub-id pub-id-type="doi">10.3389/neuro.11.006.2008</pub-id><pub-id pub-id-type="pmid">19129924</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Resat</surname><given-names>H</given-names></name><name><surname>Ewald</surname><given-names>JA</given-names></name><name><surname>Dixon</surname><given-names>DA</given-names></name><name><surname>Wiley</surname><given-names>HS</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>An integrated model of epidermal growth factor receptor trafficking and signal transduction</article-title><source>Biophysical Journal</source><volume>85</volume><fpage>730</fpage><lpage>743</lpage><pub-id pub-id-type="doi">10.1016/S0006-3495(03)74516-0</pub-id><pub-id pub-id-type="pmid">12885624</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosenblum</surname><given-names>K</given-names></name><name><surname>Futter</surname><given-names>M</given-names></name><name><surname>Voss</surname><given-names>K</given-names></name><name><surname>Erent</surname><given-names>M</given-names></name><name><surname>Skehel</surname><given-names>PA</given-names></name><name><surname>French</surname><given-names>P</given-names></name><name><surname>Obosi</surname><given-names>L</given-names></name><name><surname>Jones</surname><given-names>MW</given-names></name><name><surname>Bliss</surname><given-names>TV</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>The role of extracellular regulated kinases I/II in late-phase long-term potentiation</article-title><source>Journal of Neuroscience</source><volume>22</volume><fpage>5432</fpage><lpage>5441</lpage><pub-id pub-id-type="pmid">12097495</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ross</surname><given-names>WN</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Understanding calcium waves and sparks in central neurons</article-title><source>Nature Reviews Neuroscience</source><volume>13</volume><fpage>157</fpage><lpage>168</lpage><pub-id pub-id-type="doi">10.1038/nrn3168</pub-id><pub-id pub-id-type="pmid">22314443</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smolen</surname><given-names>P</given-names></name><name><surname>Baxter</surname><given-names>DA</given-names></name><name><surname>Byrne</surname><given-names>JH</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>A model of the roles of essential kinases in the induction and expression of late long-term potentiation</article-title><source>Biophysical Journal</source><volume>90</volume><fpage>2760</fpage><lpage>2775</lpage><pub-id pub-id-type="doi">10.1529/biophysj.105.072470</pub-id><pub-id pub-id-type="pmid">16415049</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stamboulian</surname><given-names>S</given-names></name><name><surname>Choi</surname><given-names>JS</given-names></name><name><surname>Ahn</surname><given-names>HS</given-names></name><name><surname>Chang</surname><given-names>YW</given-names></name><name><surname>Tyrrell</surname><given-names>L</given-names></name><name><surname>Black</surname><given-names>JA</given-names></name><name><surname>Waxman</surname><given-names>SG</given-names></name><name><surname>Dib-Hajj</surname><given-names>SD</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>ERK1/2 mitogen-activated protein kinase phosphorylates sodium channel na(v)1.7 and alters its gating properties</article-title><source>Journal of Neuroscience</source><volume>30</volume><fpage>1637</fpage><lpage>1647</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4872-09.2010</pub-id><pub-id pub-id-type="pmid">20130174</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tank</surname><given-names>DW</given-names></name><name><surname>Hopfield</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Neural computation by concentrating information in time</article-title><source>PNAS</source><volume>84</volume><fpage>1896</fpage><lpage>1900</lpage><pub-id pub-id-type="doi">10.1073/pnas.84.7.1896</pub-id><pub-id pub-id-type="pmid">3470765</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Traub</surname><given-names>RD</given-names></name><name><surname>Wong</surname><given-names>RK</given-names></name><name><surname>Miles</surname><given-names>R</given-names></name><name><surname>Michelson</surname><given-names>H</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>A model of a CA3 hippocampal pyramidal neuron incorporating voltage-clamp data on intrinsic conductances</article-title><source>Journal of Neurophysiology</source><volume>66</volume><fpage>635</fpage><lpage>650</lpage><pub-id pub-id-type="pmid">1663538</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsokas</surname><given-names>P</given-names></name><name><surname>Ma</surname><given-names>T</given-names></name><name><surname>Iyengar</surname><given-names>R</given-names></name><name><surname>Landau</surname><given-names>EM</given-names></name><name><surname>Blitzer</surname><given-names>RD</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Mitogen-activated protein kinase upregulates the dendritic translation machinery in long-term potentiation by controlling the mammalian target of rapamycin pathway</article-title><source>Journal of Neuroscience</source><volume>27</volume><fpage>5885</fpage><lpage>5894</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4548-06.2007</pub-id><pub-id pub-id-type="pmid">17537959</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tyler</surname><given-names>WJ</given-names></name><name><surname>Alonso</surname><given-names>M</given-names></name><name><surname>Bramham</surname><given-names>CR</given-names></name><name><surname>Pozzo-Miller</surname><given-names>LD</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>From acquisition to consolidation: on the role of brain-derived neurotrophic factor signaling in hippocampal-dependent learning</article-title><source>Learning &amp; Memory</source><volume>9</volume><fpage>224</fpage><lpage>237</lpage><pub-id pub-id-type="doi">10.1101/lm.51202</pub-id><pub-id pub-id-type="pmid">12359832</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname><given-names>MA</given-names></name><name><surname>McNaughton</surname><given-names>BL</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Reactivation of hippocampal ensemble memories during sleep</article-title><source>Science</source><volume>265</volume><fpage>676</fpage><lpage>679</lpage><pub-id pub-id-type="doi">10.1126/science.8036517</pub-id><pub-id pub-id-type="pmid">8036517</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yuan</surname><given-names>LL</given-names></name><name><surname>Adams</surname><given-names>JP</given-names></name><name><surname>Swank</surname><given-names>M</given-names></name><name><surname>Sweatt</surname><given-names>JD</given-names></name><name><surname>Johnston</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Protein kinase modulation of dendritic K+ channels in Hippocampus involves a mitogen-activated protein kinase pathway</article-title><source>Journal of Neuroscience</source><volume>22</volume><fpage>4860</fpage><lpage>4868</lpage><pub-id pub-id-type="pmid">12077183</pub-id></element-citation></ref></ref-list></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.25827.023</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Skinner</surname><given-names>Frances K</given-names></name><role>Reviewing editor</role><aff><institution>University Health Network</institution>, <country>Canada</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Synaptic input sequence discrimination on behavioral time-scales mediated by reaction-diffusion chemistry in dendrites&quot; for consideration by <italic>eLife</italic>. Your article has been favorably evaluated by Timothy Behrens (Senior Editor) and three reviewers, one of whom, Frances K Skinner (Reviewer #1), is a member of our Board of Reviewing Editors. The following individuals involved in review of your submission have agreed to reveal their identity: Paul Smolen (Reviewer #2) and Kim T Blackwell (Reviewer #3).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>While all of the reviewers felt that this was interesting and significant work, there was a clear consensus that several aspects of the paper were unclear and thus subsequently confusing.</p><p>Overall, it was felt that the author needed to expand on his explanations and descriptions in several places. The specific points that need expansion, revision and further explanations in the paper are:</p><p>1) the 4 models</p><p>2) Q equation has issues</p><p>3) sensitivity of the results</p><p>Besides this, the reviewers have various issues in their comments (details that seem to need fixing) that should be responded to (see below).</p><p><italic>Reviewer #1:</italic> </p><p>This is an interesting theoretical, computational study that considers sequence discrimination at the level of the single cell (rather than networks) including slower timescales (hundreds and milliseconds and slower). Reaction-diffusion modeling and detailed multi-scale models are used to show attributes of recognizing input in the correct order and over scrambled input and background noise, as well as showing an effect on firing.</p><p>While interesting, the manuscript could be more fully explained and expanded in several places to help the reader fully grasp the situation. Also, various details seemed a bit strange to me, and further discussion on some points seem warranted. Specifics are:</p><p>1) The author gives the context of place cells (<xref ref-type="fig" rid="fig1">Figure 1</xref>), but it would be helpful to explain this a bit further I think. That is, each neuronal ensemble sends a projection to a dendritic segment etc. Should this be considered as a particular postsynaptic cell? Should the network context be ignored, is this on multiple segments of a given cell, cells in a network, or does it matter in the context, etc.? I realize that the focus is on the single cell, and perhaps it doesn't really matter overall for the work, but some consideration/description of this would be helpful to the reader in setting the envisioned context. This would be further helpful in the Discussion when timescales are estimated and discussed.</p><p>2) For <xref ref-type="fig" rid="fig2">Figure 2</xref>, the author could expand on his 4 models and molecules A and B and Ca – that is, a schematic of the overall relationship would be helpful. Perhaps some sort of simple MAPK pathway (generic as for the 4 models) could be illustrated? The author says &quot;The results were as expected&quot; (subsection “Reaction systems select for distinct speeds and length-scales of sequential input”) in referring to <xref ref-type="fig" rid="fig7">Figure 7</xref> – expand on why this is please. <xref ref-type="fig" rid="fig3">Figure 3</xref> process not quite clear to me – left x-axis 'sequence score' is obtained how? The color on the right is Q, right? – please label.</p><p>It was not immediately obvious to me how a Q of -0.001 would be obtained for the sequence given – please explain and/or demonstrate/illustrate more fully.</p><p>2-6 μm spatial intervals given in text but in figures, the high Q values (color) are at tens of μm – I think that I am missing something or perhaps confused.</p><p>3) Multi-compartment model details are specified as taken from mostly from Traub et al. 1991, but the reference is not listed in the bibliography. Potassium reversal potential of -15 mV seems a bit depolarized, and I assume 60 mV for resting is a typo (-60 mV?). 1 ohm.m2 is 1000mS/cm2 for Rm, and seems rather high? The values in <xref ref-type="fig" rid="fig7">Figure 7</xref> to see effect in firing are even larger by a lot which is perhaps a bit concerning?</p><p>4) Does it matter that there is no Ih in the model, which is well-known to be non-uniformly distributed in pyramidal dendrites. Would this be expected to affect the results?</p><p>5) Subsection “Sequence speed selectivity scales with reaction rates and diffusion constants” – &quot;As expected, we found that as the rates were increased…&quot;. Why? As there was not a complete explanation for the 4 models, this 'expectation' suffers here too.</p><p><italic>Reviewer #2:</italic> </p><p>This is an interesting paper dealing with an important topic in computational neuroscience, sequence discrimination. But some important points need to be addressed. I am asking for a little extra work – not an exhaustive analysis – in only one of my comments, comment 1, given that parameter sensitivity analysis is a common, substantial concern in all modeling studies.</p><p>1) Some parameter sensitivity analysis should be done for some of the key results. For example, in <xref ref-type="fig" rid="fig2">Figure 2</xref>, rightmost column, it appears that parameter values may be &quot;tuned&quot; to be close to bistability, so that stimuli can give relatively long, but eventually declining, response plateaus. Although, the numbers in the equations above do look pretty generic. Similarly, for <xref ref-type="fig" rid="fig2">Figures 2C and 2D</xref>, and other figures that show strong sequence selectivity, how dependent is this selectivity on values of rate constants and other parameters? I'm not asking for an exhaustive analysis, but some degree of analysis and discussion of sensitivity should be given for a few of the key results. For example the sensitivity of the results of <xref ref-type="fig" rid="fig6">Figure 6G</xref>, which presents selectivity for the most realistic model, should be discussed.</p><p>2) The selectivity criterion in Equation 3 cannot be correct as defined. The quantity Q, from Equation 2, is only related to the input, not the response, so Eq. 3 is also not related to the response. But of course selectivity, as plotted in the right column of <xref ref-type="fig" rid="fig3">Figure 3</xref> and later, is related to the response. In Eq. 3, should Q be simply replaced by the average or maximum of the variable A, and in later cases should A be replaced by MAPK-P?</p><p>3) In the subsection “Sequence speed selectivity scales with reaction rates and diffusion constants” the author describes how by varying rates he can achieve good sequence selectivity over a broad range of time intervals, and in the Introduction it is noted that such time-invariance is a &quot;desirable feature&quot;. But, for a single neuron or dendrite, the rate constants are presumably fixed, or at least do not vary in anticipation of stimulus time scales? So, I don't see how to get time invariance in a single neuron. So then, how does the author envision getting time invariance in a real neural network? Does he envision different neurons in the network will have different parameters so that they will respond to different time scales? These issues should be addressed in the Discussion.</p><p>4) For the channel modulations that underlie the simulations of <xref ref-type="fig" rid="fig7">Figure 7</xref>, it is never discussed whether these modulations would result from activation of the MAPK signaling pathway simulated in the rest of the paper. The channel modulations are imposed ad hoc. It would be good to connect these portions of the paper, if not by simulations of MAPK effects on channels, then at least by discussing to what extent some or all of these modulations are thought to be downstream of MAPK activation and are a plausible readout or result of the sequentially amplified activation of the MAPK pathway simulated previously.</p><p>5) In the Discussion, large numbers are given for how many sequence discriminations a neuron can perform per second and how many sequences a neuron can discriminate. But I am skeptical of these estimates because no discussion is given of what it means operationally for a neuron, a cell, to &quot;discriminate&quot; a sequence. It seems to me that a change in electrical firing rate or spike timing is needed to say a neuron has discriminated a sequence. Or, a change in synaptic plasticity. A transient biochemical response in a dendrite, just by itself, doesn't seem to me sufficient to constitute &quot;discrimination&quot; by the neuron. These caveats should be noted and discussed.</p><p>6) In the Methods, it is stated with regard to the simulations of <xref ref-type="fig" rid="fig7">Figure 7</xref> that we ran the model for 1 second to let the cell settle, before modulating channels. But clarification is needed since 1 second is not enough to allow simulated biochemical pathways to come to equilibrium in the models. Especially in the realistic simulations of <xref ref-type="fig" rid="fig6">Figure 6</xref>, how much simulated time was allowed from when biochemical variables were initialized to when stimuli were given.</p><p>7) <xref ref-type="fig" rid="fig4">Figure 4F and 4G</xref> is a particular instance of the sensitivity issue in comment 1. Here a 20% change in stimulus amplitude leads to a very large change in the selectivity pattern. Is this sensitivity of pattern to stimulus amplitude typical for the models?</p><p><italic>Reviewer #3:</italic> </p><p>The research addresses the important problem of pattern recognition by neurons. Specifically, what mechanisms allow a neuron to discriminate sequence a-b-c from c-b-a, where a, b, c are each a different synaptic input. The ability to discriminate temporal pattern is more difficult than discriminating which synaptic inputs are present. This issue has been addressed in specialized, direction selective cells, but the more general problem has not been investigated. A major strength of the manuscript is that the authors use both a simple, analytical model as well as biophysically and biochemically realistic neuron models to demonstrate principles underlying the results and to demonstrate the plausibility of neurons in tissue accomplishing temporal discrimination. Using the simple models, the author analyzes and presents the critical factors constraining sequence specificity. By using realistic model, the author demonstrates that sequence specificity can be implemented by neurons in tissue, since these simulations include background synaptic inputs, including theta modulated GABA input. For the most part the results are quite clear. There are only two aspects that need better exposition.</p><p>1) Though the difference in selectivity is apparent in <xref ref-type="fig" rid="fig3">Figure 3</xref>, it is not clear what exactly is being plotted. I understand using R^2, which gives values between 1 (i.e., good) -1 (i.e., bad) for Q if m=1, but I don't understand why add the term m into Q Equation 2. In addition, why does Equation 3 use Q as the selectivity measure. The first time I read this page, I thought that Q was the selectivity measure. Then, I realized that Q was just a convenient way to obtain a monotonic x axis value, and that the important information was in a graph of A versus Q. But then Equation 3 claims to plot a selectivity value which is a function of Q, not A. A more detailed illustration of how values in <xref ref-type="fig" rid="fig3">Figure 3</xref> are obtained (one value from right side graph and one value from left side graph) would be quite helpful. Also, where does the temporal interval come into this equation?</p><p>2) The results in the subsection “Local dendritic channel modulations may influence cellular firing”, describing the effect of channel modulation need a bit more explanation. In particular, it is quite surprising that an increase in leak conductance would increase firing rate. Since leak channels are typically potassium channels, I would expect an increase in leak conductance to not only make the cell less sensitive to depolarizing current, but also hyperpolarize the branch a bit, unless Eleak is rather depolarized. An intuitive explanation for this result would be helpful. Also, I don't understand how these manipulations are related to sequence discrimination. Wouldn't these channel modulations change firing rate for all sequences? Or perhaps the neuron can better discriminate the correct from incorrect sequence?</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.25827.024</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p><italic>While all of the reviewers felt that this was interesting and significant work, there was a clear consensus that several aspects of the paper were unclear and thus subsequently confusing.</italic> </p><p><italic>Overall, it was felt that the author needed to expand on his explanations and descriptions in several places. The specific points that need expansion, revision and further explanations in the paper are:</italic> </p><p><italic>1) the 4 models</italic> </p><p><italic>2) Q equation has issues</italic> </p><p><italic>3) sensitivity of the results</italic> </p><p>I thank the editor and reviewers for their thoughtful comments. I have addressed all the points brought up. Briefly,</p><p>1) I have added schematics and text to explain the structure and derivation of the 4 models.</p><p>2) I have fixed a regrettable mistake in Equation 3, where I had a different meaning for the Q symbol from Equation 2.</p><p>3) I have performed parameter sensitivity analyses for the abstract and detailed models, and presented these in supplementary figures.</p><p>In addition, I have gone through the other comments by the reviewers and made numerous revisions to address these.</p><p><italic>Besides this, the reviewers have various issues in their comments (details that seem to need fixing) that should be responded to (see below).</italic> </p><p><italic>Reviewer #1:</italic> </p><p><italic>[…] While interesting, the manuscript could be more fully explained and expanded in several places to help the reader fully grasp the situation. Also, various details seemed a bit strange to me, and further discussion on some points seem warranted. Specifics are:</italic> </p><p><italic>1) The author gives the context of place cells (<xref ref-type="fig" rid="fig1">Figure 1</xref>), but it would be helpful to explain this a bit further I think. That is, each neuronal ensemble sends a projection to a dendritic segment etc. Should this be considered as a particular postsynaptic cell? Should the network context be ignored, is this on multiple segments of a given cell, cells in a network, or does it matter in the context, etc.? I realize that the focus is on the single cell, and perhaps it doesn't really matter overall for the work, but some consideration/description of this would be helpful to the reader in setting the envisioned context. This would be further helpful in the Discussion when timescales are estimated and discussed.</italic> </p><p>Thank you for pointing this out. I have rewritten the introductory paragraph and added extra explanatory words in the figure legend to clarify these points.</p><p>“We assumed that a single neuron from each of these ensembles projects onto a given postsynaptic cell, which is the focus of our analysis. The projections are ordered such that they converge onto a succession of spines located on a short stretch of dendrite on this cell, in the same spatial and temporal order as the activation of the ensembles. We ignored all other network context.”</p><p>I have also updated the Discussion section:</p><p>“We envision a network configuration where at the input level, there are ensembles of neurons that are active in a defined sequence in some sensory, motor or other context. We focus our analysis on a specific postsynaptic neuron, which receives a projection from each of the preceding ensembles, such that each synapse is located within a few microns of the next.”</p><p><italic>2) For <xref ref-type="fig" rid="fig2">Figure 2</xref>, the author could expand on his 4 models and molecules A and B and Ca – that is, a schematic of the overall relationship would be helpful. Perhaps some sort of simple MAPK pathway (generic as for the 4 models) could be illustrated?</italic> </p><p>In <xref ref-type="fig" rid="fig2">Figure 2, I</xref> have added a new row of panels (B) with schematics for the four models. I have updated the figure legend to explain these schematics.</p><p><italic>The author says &quot;The results were as expected&quot; (subsection “Reaction systems select for distinct speeds and length-scales of sequential input”) in referring to <xref ref-type="fig" rid="fig7">Figure 7</xref> – expand on why this is please.</italic> </p><p>I have expanded on this as follows: “If the chemical system is highly selective, we expect that only one or two points in the scatter plot should have a high value of <italic>Atot</italic>, and these should be the points with Q around +1 or -1. […] Each of these outcomes had been observed in <xref ref-type="fig" rid="fig2">Figure 2</xref> for just the sequential and a single scrambled stimulus, and in <xref ref-type="fig" rid="fig3">Figure 3</xref> we found that it generalized to the entire set of sequence permutations.”</p><p><italic><xref ref-type="fig" rid="fig3">Figure 3</xref> process not quite clear to me – left x-axis 'sequence score' is obtained how? The color on the right is Q, right? – please label.</italic> </p><p>I apologize for lack of clarity around Equation 3 and this figure. The left x axis is Q and the color on the right is the selectivity, from Equation 3. This is now corrected on the figure and in the text.</p><p><italic>It was not immediately obvious to me how a Q of -0.001 would be obtained for the sequence given – please explain and/or demonstrate/illustrate more fully.</italic> </p><p>I have introduced new panels A and B in <xref ref-type="fig" rid="fig3">Figure 3</xref> to illustrate the computation of Q.</p><p><italic>2-6 μm spatial intervals given in text but in figures, the high Q values (color) are at tens of μm – I think that I am missing something or perhaps confused.</italic> </p><p>This was indeed confusing, as a result of my using the total activated length rather than the spatial intervals between synapses, for just this figure. I have corrected it in the new <xref ref-type="fig" rid="fig3">Figure 3</xref> and <xref ref-type="fig" rid="fig4">Figure 4</xref>.</p><p><italic>3) Multi-compartment model details are specified as taken from mostly from Traub et al. 1991, but the reference is not listed in the bibliography.</italic> </p><p>Fixed.</p><p><italic>Potassium reversal potential of -15 mV seems a bit depolarized, and I assume 60 mV for resting is a typo (-60 mV?).</italic> </p><p>Reversal potential is as per Traub 1991, but I agree it is a bit depolarized. I didn’t want to get into reconfigurations of the channel properties for the current study so I left it as is.</p><p>Corrected resting potential to -60 mV.</p><p><italic>1 ohm.m2 is 1000mS/cm2 for Rm, and seems rather high?</italic> </p><p>This is 10,000 ohm.cm^2, or 0.1 mS/cm^2, which is what Traub used. I understand that this is a fairly typical value.</p><p><italic>The values in <xref ref-type="fig" rid="fig7">Figure 7</xref> to see effect in firing are even larger by a lot which is perhaps a bit concerning?</italic> </p><p>This is indeed an important point. In the revision I have strengthened the point that the required modulations are large. From the Discussion:</p><p>“While the amount of modulation required for an effect is quite large in some cases, we stress that these were proof-of-principle calculations. […] Similar small length-scale events have been shown to affect cellular firing in striatal neurons (Plotkin et al., 2011), suggesting that this outcome of sequence selection may also be plausible.”</p><p><italic>4) Does it matter that there is no Ih in the model, which is well-known to be non-uniformly distributed in pyramidal dendrites. Would this be expected to affect the results?</italic> </p><p>I don’t think the absence of Ih affects the results. For the purposes of sequence recognition, the biggest impact would be if Ca<sup>2+</sup> dynamics were to be affected, since Ca<sup>2+</sup> is the input to the signaling pathways. This may indeed occur from Ih regulation of local excitability. However, in the revision, I have explored parameter sensitivity to four Ca<sup>2+</sup> related parameters (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). In particular, LCa density could be varied from 0 to 10 S/m^2 without much effect on the selectivity. Given that even a Ca<sup>2+</sup> channel isn’t having much effect, I feel that the omission of Ih is unlikely to change the core results.</p><p><italic>5) Subsection “Sequence speed selectivity scales with reaction rates and diffusion constants” – &quot;As expected, we found that as the rates were increased…&quot;. Why? As there was not a complete explanation for the 4 models, this 'expectation' suffers here too.</italic> </p><p>I have added a couple of lines to explain this. Additionally, as discussed above, the four models are explained in much more detail and with new figure panels.</p><p>“As expected, scaling all the chemical and diffusion rates also scaled the sequence speed to which the network had the strongest response. As the rates were increased, the best tuning was at shorter time intervals but roughly the same spatial intervals.”</p><p><italic>Reviewer #2:</italic> </p><p><italic>This is an interesting paper dealing with an important topic in computational neuroscience, sequence discrimination. But some important points need to be addressed. I am asking for a little extra work – not an exhaustive analysis – in only one of my comments, comment 1, given that parameter sensitivity analysis is a common, substantial concern in all modeling studies.</italic> </p><p>Thank you. I have now done some parameter sensitivity analysis as indicated below.</p><p><italic>1) Some parameter sensitivity analysis should be done for some of the key results. For example, in <xref ref-type="fig" rid="fig2">Figure 2</xref>, rightmost column, it appears that parameter values may be &quot;tuned&quot; to be close to bistability, so that stimuli can give relatively long, but eventually declining, response plateaus.</italic> </p><p>The ‘switch’ model in the rightmost column is in fact a one-shot, that is, a switch with a delayed turnoff. This is now shown in the schematic in <xref ref-type="fig" rid="fig2">Figure 2B</xref>, and also in the new text explaining how the abstract models were developed:</p><p>“To the bistable switch system we added inhibitory feedback to restore the switch to baseline after a delay.”</p><p><italic>Although, the numbers in the equations above do look pretty generic. Similarly, for <xref ref-type="fig" rid="fig2">Figures 2C and 2D</xref>, and other figures that show strong sequence selectivity, how dependent is this selectivity on values of rate constants and other parameters? I'm not asking for an exhaustive analysis, but some degree of analysis and discussion of sensitivity should be given for a few of the key results. For example the sensitivity of the results of <xref ref-type="fig" rid="fig6">Figure 6G</xref>, which presents selectivity for the most realistic model, should be discussed.</italic> </p><p>Thank you for bringing this up, it is a matter that is important and is now systematically addressed. These are in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplements 1</xref> and 2 and are described in the following new paragraph:</p><p>“To better understand the range of sequence selectivity, we varied each of the parameters of the model one at a time with respect to the reference model. […] These models were intended to be illustrative and to explore the properties of sequence-selective systems. Hence we did not optimize the models for robustness.”</p><p>I have also done a smaller parameter sweep for the full cell model, which is not exhaustive because there are a large number of parameters and it would be slow to do a sweep for all parameters (~12 CPU hours each run * 12 sequences * 4 technical repeats * (6 to 8) values per parameter):</p><p>“We performed a limited parameter sensitivity analysis for the detailed cell model, focusing on biophysical and biochemical parameters involved in triggering or responding to Ca<sup>2+</sup>. […] While this list is not exhaustive, it does suggest that the sequence selectivity of the detailed model is fairly robust, and somewhat more so than the abstract models.”</p><p><italic>2) The selectivity criterion in Equation 3 cannot be correct as defined. The quantity Q, from Equation 2, is only related to the input, not the response, so Eq. 3 is also not related to the response. But of course selectivity, as plotted in the right column of <xref ref-type="fig" rid="fig3">Figure 3</xref> and later, is related to the response. In Eq. 3, should Q be simply replaced by the average or maximum of the variable A, and in later cases should A be replaced by MAPK-P?</italic> </p><p>I am sorry about this mistake. I had mistakenly used Q to refer to the variable now called Atot in the text. The reviewer correctly identifies A as the variable in question, and MAPK-P in later figures.</p><p>“<italic>Selectivity = (Asequential – mean(Atot))/max(Atot)</italic> Equation 3”</p><p><italic>3) In the subsection “Sequence speed selectivity scales with reaction rates and diffusion constants” the author describes how by varying rates he can achieve good sequence selectivity over a broad range of time intervals, and in the Introduction it is noted that such time-invariance is a &quot;desirable feature&quot;. But, for a single neuron or dendrite, the rate constants are presumably fixed, or at least do not vary in anticipation of stimulus time scales? So, I don't see how to get time invariance in a single neuron. So then, how does the author envision getting time invariance in a real neural network? Does he envision different neurons in the network will have different parameters so that they will respond to different time scales? These issues should be addressed in the Discussion.</italic> </p><p>In the Discussion I have added the following paragraph under the heading “Single-cell sequence recognition may act on a continuum of timescales”:</p><p>“Individual chemical implementations of sequence recognition in our study operate over a range of about 2-5 microns and 1.5-4 seconds (<xref ref-type="fig" rid="fig4">Figure 4</xref>, <xref ref-type="fig" rid="fig6">6</xref>). […] It is interesting to speculate that there may be useful computational implications of having different cells ‘tuned’ to different sequence speeds.”</p><p><italic>4) For the channel modulations that underlie the simulations of <xref ref-type="fig" rid="fig7">Figure 7</xref>, it is never discussed whether these modulations would result from activation of the MAPK signaling pathway simulated in the rest of the paper. The channel modulations are imposed ad hoc. It would be good to connect these portions of the paper, if not by simulations of MAPK effects on channels, then at least by discussing to what extent some or all of these modulations are thought to be downstream of MAPK activation and are a plausible readout or result of the sequentially amplified activation of the MAPK pathway simulated previously.</italic> </p><p>I thank the reviewer for this useful suggestion to improve the linkage between the chemical events and the electrical events. I have added text to explain how the simulations were run and how MAPK or other signaling may be upstream of these channel modulations.</p><p>“We assumed that MAPK activity, or other signaling events downstream of sequence selective chemistry, could perform channel modulation through phosphorylation or triggering of channel insertion. […] Instead we ran just the electrical cell model for an initial settling period of 1 second, and then used the simulation script to modify the selected channel conductance to represent its modulation. Following this we ran the model for another 3 seconds in each case.”</p><p><italic>5) In the Discussion, large numbers are given for how many sequence discriminations a neuron can perform per second and how many sequences a neuron can discriminate. But I am skeptical of these estimates because no discussion is given of what it means operationally for a neuron, a cell, to &quot;discriminate&quot; a sequence. It seems to me that a change in electrical firing rate or spike timing is needed to say a neuron has discriminated a sequence. Or, a change in synaptic plasticity. A transient biochemical response in a dendrite, just by itself, doesn't seem to me sufficient to constitute &quot;discrimination&quot; by the neuron. These caveats should be noted and discussed.</italic> </p><p>I agree that this discussion should have been related more clearly to the analysis in <xref ref-type="fig" rid="fig7">Figure 7</xref>, and to other possible downstream effects of sequence recognition. In order to address this, I have moved the Discussion section “Plasticity is a likely target…” to the first part of the Discussion, and I have renamed and substantially expanded this section to indicate the kinds of outcome one may get from sequence recognition chemistry. It is now headed “Firing change, synaptic plasticity and morphological change may result from biochemical sequence recognition”. This leads into the discussion on “Sequence recognition confers substantial computational capabilities on single cells”. I have further added the following lines to put it in context:</p><p>“For simplicity, we consider computation in terms of immediate firing rate changes (discussed above), though plasticity and morphological change are also computational outcomes.”</p><p><italic>6) In the Methods, it is stated with regard to the simulations of <xref ref-type="fig" rid="fig7">Figure 7</xref> that we ran the model for 1 second to let the cell settle, before modulating channels. But clarification is needed since 1 second is not enough to allow simulated biochemical pathways to come to equilibrium in the models. Especially in the realistic simulations of <xref ref-type="fig" rid="fig6">Figure 6</xref>, how much simulated time was allowed from when biochemical variables were initialized to when stimuli were given.</italic> </p><p>I agree that this was not explained sufficiently. In the main text I have added a paragraph to explain the procedure:</p><p>“We did not simulate these modulation events explicitly since the computations were very lengthy and we wished to perform many repeats to estimate the distribution of the firing rates following channel modulation. Instead we ran just the electrical cell model for an initial settling period of 1 second, and then used the simulation script to modify the selected channel conductance to represent its modulation. Following this we ran the model for another 3 seconds in each case.”</p><p><italic>7) <xref ref-type="fig" rid="fig4">Figure 4F and 4G</xref> is a particular instance of the sensitivity issue in comment 1. Here a 20% change in stimulus amplitude leads to a very large change in the selectivity pattern. Is this sensitivity of pattern to stimulus amplitude typical for the models?</italic> </p><p>Please see response to comment 1. Yes, several parameters are quite sensitive.</p><p>“We found that selectivity was robust to some parameters, such as diffusion constants, but fragile (range ~20%) with respect to some rate constants and stimulus amplitude. These models were intended to be illustrative and to explore the properties of sequence-selective systems. Hence we did not optimize the models for robustness.”</p><p><italic>Reviewer #3:</italic> </p><p><italic>[…] 1) Though the difference in selectivity is apparent in <xref ref-type="fig" rid="fig3">Figure 3</xref>, it is not clear what exactly is being plotted. I understand using R^2, which gives values between 1 (i.e., good) -1 (i.e., bad) for Q if m=1, but I don't understand why add the term m into Q Equation 2.</italic> </p><p>I apologize for several points of confusion in this section. To address this, I have added two plots to <xref ref-type="fig" rid="fig3">Figure 3</xref> to illustrate how the metric Q works. I have also added some text:</p><p>“<italic>R<sup><xref ref-type="bibr" rid="bib2">2</xref></sup></italic> provides a measure of linearity of the sequence, and <italic>m</italic> assigns it a magnitude and sign. With this measure, the sequence [0,1,2,3,4] has Q = 1; [4,3,2,1,0] has Q = -1, and [4,0,2,1,3] has Q = -0.001. Examples of regression plots used to generate Q for different sequences are presented in <xref ref-type="fig" rid="fig3">Figure 3A, B</xref>.”</p><p><italic>In addition, why does Equation 3 use Q as the selectivity measure. The first time I read this page, I thought that Q was the selectivity measure. Then, I realized that Q was just a convenient way to obtain a monotonic x axis value, and that the important information was in a graph of A versus Q. But then Equation 3 claims to plot a selectivity value which is a function of Q, not A.</italic> </p><p>This was an error on my part, and I had used the term Q incorrectly in Equation 3. It is now fixed:</p><p><italic>“Selectivity = (Asequential – mean(Atot))/max(Atot)</italic> Equation 3”</p><p>Provided the system responds more strongly to sequential input than to any other order, <italic>selectivity</italic> should be in the range from zero (unselective) to one (highly selective). <italic>Asequential</italic> is <italic>Atot</italic> for the sequential stimulus, <italic>mean(Atot)</italic> is the mean of <italic>Atot</italic> over all permutations of the stimulus order, and <italic>max(Atot)</italic> is the maximum value of <italic>Atot</italic> for all permutations of stimulus order.”</p><p><italic>A more detailed illustration of how values in <xref ref-type="fig" rid="fig3">Figure 3</xref> are obtained (one value from right side graph and one value from left side graph) would be quite helpful.</italic> </p><p>I now indicate (using asterisks), which point on the right hand heatmap plot comes from the left hand graph, in <xref ref-type="fig" rid="fig3">Figure 3. I</xref> also specify (using crosses) which of the points on the left hand panel in <xref ref-type="fig" rid="fig3">Figure 3</xref> comes from the examples in <xref ref-type="fig" rid="fig2">Figure 2</xref>.</p><p><italic>Also, where does the temporal interval come into this equation?</italic> </p><p>For Equation 2 I state: “We plotted the ordinal position of the input against the ordinal value of its arrival time.” So, temporal interval is factored out.</p><p>In Equation 3, the temporal and spatial intervals must be supplied to the simulation as control parameters. I have added the line:</p><p>“The time and space intervals were specified as parameters for each simulation run.”</p><p><italic>2) The results in the subsection “Local dendritic channel modulations may influence cellular firing”, describing the effect of channel modulation need a bit more explanation. In particular, it is quite surprising that an increase in leak conductance would increase firing rate. Since leak channels are typically potassium channels, I would expect an increase in leak conductance to not only make the cell less sensitive to depolarizing current, but also hyperpolarize the branch a bit, unless Eleak is rather depolarized. An intuitive explanation for this result would be helpful.</italic> </p><p>Thank you for pointing out this source of confusion. I had implemented the leak conductance as a nonselective cation current leak, which reverses close to 0 mV. I now state this explicitly in the text and figure legend. In preliminary calculations I had also played with modulating Ih, the HCN channel, but since its voltage-dependent effects were not incorporated into the cell model I didn’t pursue this.</p><p><italic>Also, I don't understand how these manipulations are related to sequence discrimination. Wouldn't these channel modulations change firing rate for all sequences? Or perhaps the neuron can better discriminate the correct from incorrect sequence?</italic> </p><p>This is an important point that other reviewers have also brought up. I now have new paragraphs in the main text and in the Discussion to explain the intended link between the chemical events of sequence discrimination, and the channel modulation. These are detailed above.</p></body></sub-article></article>