<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.2" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">63753</article-id><article-id pub-id-type="doi">10.7554/eLife.63753</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Evolutionary Biology</subject></subj-group></article-categories><title-group><article-title>Determining the probability of hemiplasy in the presence of incomplete lineage sorting and introgression</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-183823"><name><surname>Hibbins</surname><given-names>Mark S</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4651-3704</contrib-id><email>mhibbins@iu.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-185001"><name><surname>Gibson</surname><given-names>Matthew JS</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7855-1628</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-23178"><name><surname>Hahn</surname><given-names>Matthew W</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-5731-8808</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>Department of Biology, Indiana University</institution><addr-line><named-content content-type="city">Bloomington</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution>Department of Computer Science, Indiana University</institution><addr-line><named-content content-type="city">Bloomington</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Rokas</surname><given-names>Antonis</given-names></name><role>Reviewing Editor</role><aff><institution>Vanderbilt University</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Wittkopp</surname><given-names>Patricia J</given-names></name><role>Senior Editor</role><aff><institution>University of Michigan</institution><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>21</day><month>12</month><year>2020</year></pub-date><pub-date pub-type="collection"><year>2020</year></pub-date><volume>9</volume><elocation-id>e63753</elocation-id><history><date date-type="received" iso-8601-date="2020-10-06"><day>06</day><month>10</month><year>2020</year></date><date date-type="accepted" iso-8601-date="2020-12-18"><day>18</day><month>12</month><year>2020</year></date></history><permissions><copyright-statement>© 2020, Hibbins et al</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>Hibbins et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-63753-v3.pdf"/><abstract><p>The incongruence of character states with phylogenetic relationships is often interpreted as evidence of convergent evolution. However, trait evolution along discordant gene trees can also generate these incongruences – a phenomenon known as hemiplasy. Classic comparative methods do not account for discordance, resulting in incorrect inferences about the number, timing, and direction of trait transitions. Biological sources of discordance include incomplete lineage sorting (ILS) and introgression, but only ILS has received theoretical consideration in the context of hemiplasy. Here, we present a model that shows introgression makes hemiplasy more likely, such that methods that account for ILS alone will be conservative. We also present a method and software (<italic>HeIST</italic>) for making statistical inferences about the probability of hemiplasy and homoplasy in large datasets that contain both ILS and introgression. We apply our methods to two empirical datasets, finding that hemiplasy is likely to contribute to the observed trait incongruences in both.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>introgression</kwd><kwd>convergent evolution</kwd><kwd>phylogenetics</kwd><kwd>comparative methods</kwd><kwd>gene tree discordance</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>DEB-1936187</award-id><principal-award-recipient><name><surname>Hahn</surname><given-names>Matthew W</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Introgression makes hemiplasy more likely, and the probability of hemiplasy incorporating incomplete lineage sorting (ILS) and introgression can be estimated using the presented simulation software.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Convergent evolution of the same phenotype in distantly related species provides some of the most compelling evidence for natural selection. Comparative inferences of convergence require that the species history is known (<xref ref-type="bibr" rid="bib14">Felsenstein, 1985</xref>). Comparative methods applied to such histories implicitly assume that the loci underlying convergent traits also follow the species tree. However, gene trees at individual loci can disagree with each other and with the species tree, a phenomenon known as gene tree discordance. While genomic data allow us to overcome many technical sources of discordance (<xref ref-type="bibr" rid="bib10">Delsuc et al., 2005</xref>; <xref ref-type="bibr" rid="bib11">Dunn et al., 2008</xref>; <xref ref-type="bibr" rid="bib48">Misof et al., 2014</xref>), discordance also has biological causes (<xref ref-type="bibr" rid="bib9">Degnan and Rosenberg, 2009</xref>), and remains a common feature of phylogenomic datasets (<xref ref-type="bibr" rid="bib57">Pollard et al., 2006</xref>; <xref ref-type="bibr" rid="bib17">Fontaine et al., 2015</xref>; <xref ref-type="bibr" rid="bib55">Pease et al., 2016</xref>; <xref ref-type="bibr" rid="bib51">Novikova et al., 2016</xref>; <xref ref-type="bibr" rid="bib73">Wu et al., 2018</xref>; <xref ref-type="bibr" rid="bib69">Vanderpool et al., 2020</xref>).</p><p>Gene tree discordance can have multiple sources, including biological causes such as incomplete lineage sorting (ILS), introgression, and horizontal gene transfer, and technical causes such as hidden paralogy or errors in gene tree inference (<xref ref-type="bibr" rid="bib62">Schrempf and Szöllősi, 2020</xref>). Here, we focus primarily on the first two biological causes: ILS and introgression. Looking backwards in time, ILS is the failure of lineages to coalesce within a population before reaching the next most recent ancestral population. The probability of discordance due to ILS is a classic result of the multispecies coalescent, and depends on the population size and the length of time in which coalescence can occur (<xref ref-type="bibr" rid="bib25">Hudson, 1983</xref>; <xref ref-type="bibr" rid="bib53">Pamilo and Nei, 1988</xref>). More recently, the classic multispecies coalescent model has been extended to include introgression (a term we use to encompass hybridization and subsequent gene flow), in a framework called the ‘multispecies network coalescent’ (<xref ref-type="bibr" rid="bib74">Yu et al., 2012</xref>; <xref ref-type="bibr" rid="bib75">Yu et al., 2014</xref>; <xref ref-type="bibr" rid="bib71">Wen et al., 2016</xref>). In this model, species relationships are modeled as a network, with introgression represented by horizontal reticulation edges. Individual loci probabilistically follow or do not follow the reticulation edge, after which they sort according to the multispecies coalescent process (i.e. with ILS). A major advantage of this approach is that ILS and introgression can be modeled simultaneously (reviewed in <xref ref-type="bibr" rid="bib8">Degnan, 2018</xref>), allowing for more detailed study of the consequences of discordance.</p><p>Importantly, discordant gene trees can lead to the appearance of apparently convergent traits. This is because discordant gene trees have internal branches that do not exist in the species tree. If a mutation occurs along such a branch at a locus controlling trait variation, it may produce a pattern of character states that is incongruent with the species tree. Incongruent trait patterns are the basis for inferences of convergent evolution (‘homoplasy’), and thus this phenomenon has become known as hemiplasy (<xref ref-type="bibr" rid="bib3">Avise and Robinson, 2008</xref>). Since hemiplasy can produce the same kinds of trait incongruence as homoplasy, failing to account for gene tree discordance can generate misleading inferences about convergence (<xref ref-type="bibr" rid="bib44">Mendes and Hahn, 2016</xref>; <xref ref-type="bibr" rid="bib42">Mendes et al., 2016</xref>). Studies in systems with widespread discordance have found that hemiplasy is a likely explanation for many patterns of incongruence (<xref ref-type="bibr" rid="bib7">Copetti et al., 2017</xref>; <xref ref-type="bibr" rid="bib73">Wu et al., 2018</xref>; <xref ref-type="bibr" rid="bib20">Guerrero and Hahn, 2018</xref>).</p><p>The problem of hemiplasy makes it clear that robust inferences about the evolution of traits must account for gene tree discordance (<xref ref-type="bibr" rid="bib22">Hahn and Nakhleh, 2016</xref>). Recent work has provided expressions for the probabilities of hemiplasy and homoplasy (<xref ref-type="bibr" rid="bib20">Guerrero and Hahn, 2018</xref>), allowing for an assessment of whether a single transition (hemiplasy) or two transitions (homoplasy) is more likely to explain trait incongruence. This model shows that the most important factors contributing to a high risk of hemiplasy relative to homoplasy are a short internal branch on the species tree (which increases the rate of gene tree discordance), and a low mutation rate (which reduces the probability of the multiple independent transitions needed for homoplasy). However, applying this model in present form to empirical phylogenetic data faces two major limitations. First, incomplete lineage sorting is the only source of gene tree discordance considered, excluding scenarios with gene flow. Second, the model is limited to evolution along a three-taxon tree, restricting calculations for the exact probability of hemiplasy in larger clades.</p><p>With genomic data now available for many species, it has become clear that introgression is a common phenomenon (<xref ref-type="bibr" rid="bib40">Mallet et al., 2016</xref>). Introgression leads to different patterns of gene tree discordance than expected under ILS alone – specifically, minority gene tree topologies supporting a history of introgression are expected to become more common than those produced via ILS alone. These differences form the conceptual basis for common tests of introgression using genomic data (<xref ref-type="bibr" rid="bib60">Reich et al., 2009</xref>; <xref ref-type="bibr" rid="bib19">Green et al., 2010</xref>; <xref ref-type="bibr" rid="bib12">Durand et al., 2011</xref>; <xref ref-type="bibr" rid="bib54">Patterson et al., 2012</xref>; <xref ref-type="bibr" rid="bib56">Pease and Hahn, 2015</xref>). Introgression also affects the expected coalescence times between pairs of species (<xref ref-type="bibr" rid="bib29">Joly et al., 2009</xref>; <xref ref-type="bibr" rid="bib6">Brandvain et al., 2014</xref>; <xref ref-type="bibr" rid="bib24">Hibbins and Hahn, 2019</xref>; <xref ref-type="bibr" rid="bib21">Hahn and Hibbins, 2019</xref>). Pairs of species that have exchanged genes will have lower levels of sequence divergence, and therefore longer shared internal branches, at introgressed loci than expected under ILS alone. These differences in the frequency and branch lengths of genealogies produced by introgression should meaningfully affect the probability of hemiplasy. Therefore, it is important that both sources of gene tree discordance be accounted for in models of trait evolution.</p><p>For trees with more than three taxa, the number of possible gene trees and mutational configurations that could explain a particular pattern of trait incongruence increases dramatically. To illustrate this problem, we consider two cases of empirical incongruence of a binary trait. First, consider the case of New Guinea lizards that have evolved green blood from a red-blooded ancestor (<xref ref-type="fig" rid="fig1">Figure 1A</xref>; <xref ref-type="bibr" rid="bib61">Rodriguez et al., 2018</xref>). A clade of 15 taxa contains both the green-blooded species and red-blooded species (the ancestral state). Given the phylogenetic distribution of the six green-blooded species—and no consideration of gene tree discordance—four independent transitions are necessary to explain this incongruence (<xref ref-type="fig" rid="fig1">Figure 1</xref>). However, the internal branches on this tree are short and discordance is likely. Individual loci could therefore group the green-blooded taxa into as few as one and as many as six separate clades. Depending on the history at loci affecting blood color, the distribution of green-blooded taxa could therefore be explained by anywhere from one to six mutations, and even more if we consider back-mutations. The one-mutation case represents a single transition due to hemiplasy along a branch that does not exist in the species tree, while the two- and three-mutation cases represent a combination of hemiplasy and homoplasy. The problem becomes even more complex when introgression occurs in the phylogeny, because each reticulation event introduces a new set of gene trees formed from the coalescent process at introgressed loci (<xref ref-type="bibr" rid="bib24">Hibbins and Hahn, 2019</xref>). One such example is the origin of a chromosomal inversion spanning a gene involved in wing coloration in the <italic>Heliconius erato/sara</italic> clade of butterflies (<xref ref-type="fig" rid="fig1">Figure 1B</xref>; <xref ref-type="bibr" rid="bib13">Edelman et al., 2019</xref>). Overall, the huge number of possible gene trees (&gt;213 trillion for 15 lizard species; <xref ref-type="bibr" rid="bib15">Felsenstein, 2004</xref>) and the large number of possible mutational events on these trees makes it infeasible to derive an explicit mathematical solution to address questions about hemiplasy in many empirical systems.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Two empirical examples of apparent convergence in character states that could potentially be explained by hemiplasy.</title><p>(<bold>A</bold>) Maximum-likelihood species tree of the clade including green-blooded lizards and an outgroup, constructed from the concatenation of 3220 ultra-conserved elements (data from <xref ref-type="bibr" rid="bib61">Rodriguez et al., 2018</xref>). Branch lengths in substitutions per site; nodes labeled with site concordance factors. (<bold>B</bold>) Coalescent network of <italic>Heliconius erato/sara</italic> clade, processed from the network constructed for the clade in <xref ref-type="bibr" rid="bib13">Edelman et al., 2019</xref>. Branch lengths in units of 2<italic>N</italic> generations; rate, direction, and approximate timing of introgression events indicated by vertical arrows. In both trees, taxa with derived characters are colored, and the most parsimonious transitions from ancestral to derived states are labeled with circles.</p><p><supplementary-material id="fig1sdata1"><label>Figure 1—source data 1.</label><caption><title>Input file given to <italic>HeIST</italic> for the lizard analysis, using the tree and character states shown in <xref ref-type="fig" rid="fig1">Figure 1A</xref>.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-63753-fig1-data1-v3.zip"/></supplementary-material></p><p><supplementary-material id="fig1sdata2"><label>Figure 1—source data 2.</label><caption><title>Input file given to <italic>HeIST</italic> for the butterfly analysis, using the tree, character states, and introgression events shown in <xref ref-type="fig" rid="fig1">Figure 1B</xref>.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-63753-fig1-data2-v3.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63753-fig1-v3.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Full 43-species maximum-likelihood lizard phylogeny constructed by <italic>RAxML</italic>, with branch lengths in units of substitutions per site.</title><p>The 15-species subclade containing green-blooded species is highlighted in gray. Node labels correspond to the IDs in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>-Table 1 (below). This tree, and its associated site concordance factors in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>-Table 1, were used to obtain the linear formula for unit conversion in the regression module of HeIST.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63753-fig1-figsupp1-v3.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 2.</label><caption><title>Phylogeny of green-blooded lizards and an outgroup inferred from 3220 UCE gene trees using <italic>ASTRAL</italic> (data from <xref ref-type="bibr" rid="bib61">Rodriguez et al., 2018</xref>).</title><p>Internal branch lengths are shown in coalescent units of 2N generations, with arbitrary tip lengths of 1 coalescent unit. Taxa with green blood are labeled in green.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63753-fig1-figsupp2-v3.tif"/></fig></fig-group><p>Here, we make two steps toward addressing these problems. First, we derive expressions for the probabilities of hemiplasy and homoplasy under the multispecies network coalescent for three taxa. Our results show that hemiplasy becomes increasingly likely relative to homoplasy as introgression occurs at a higher rate and at a more recent time relative to speciation. We also show how this pattern is influenced by the direction of introgression. These results highlight the need to account for both ILS and introgression in order to understand the origins of a trait incongruence. Second, we present a tool called <italic>HeIST</italic> (<italic>He</italic>miplasy <italic>I</italic>nference <italic>S</italic>imulation <italic>T</italic>ool) that uses coalescent simulation to dissect patterns of hemiplasy and homoplasy in larger phylogenies. This tool provides an estimate of the most likely number of transitions giving rise to observed incongruence of binary traits, and accounts for both ILS and introgression. Lastly, we apply <italic>HeIST</italic> to two empirical cases of apparent convergence in a binary trait, finding that hemiplasy is likely to contribute to the observed trait incongruences.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>A model for the probability of hemiplasy under the multispecies network coalescent</title><p>To study the effects of introgression on the probability of hemiplasy, we combine concepts from two previously published models: the ‘parent tree’ framework of <xref ref-type="bibr" rid="bib24">Hibbins and Hahn, 2019</xref>, and the model of binary-trait evolution presented in <xref ref-type="bibr" rid="bib20">Guerrero and Hahn, 2018</xref> (see <xref ref-type="bibr" rid="bib70">Wang et al., 2020</xref> for an alternative way to extend the model to incorporate introgression). Consider a rooted three-taxon tree with the topology ((A,B), C). We define <italic>t</italic><sub>1</sub> as the time of speciation between lineages A and B in units of 2<italic>N</italic> generations, and <italic>t</italic><sub>2</sub> as the time of speciation between C and the ancestor of A and B. We also imagine an instantaneous introgression event between species B and C at time <italic>t</italic><sub>m</sub>, which can be in either direction (C → B or B → C). We define the total probability of a locus following an introgressed history as <italic>δ</italic>, with <italic>δ</italic><sub>2</sub> denoting the probability of C → B introgression, and <italic>δ</italic><sub>3</sub> the probability of B → C introgression. Introgression in both directions at an individual locus is not allowed in our model. However, a single introgression event in both directions can be modeled by allowing different directions at different loci. The history described here is represented by the phylogenetic network shown in <xref ref-type="fig" rid="fig2">Figure 2</xref> (top). Other introgression scenarios can be accommodated by our model (see Discussion), but will not be considered here.</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>A phylogenetic network (top) can be split into a set of parent trees (bottom) representing the possible histories at individual loci.</title><p>The probability that a locus is described by a particular parent tree depends on the probability of introgression (arrow labels). The horizontal ‘tube’ shown in the phylogenetic network does not depict introgression over a continuous time interval, but rather shows the timing of introgression (<italic>t</italic><sub>m</sub>) in an instantaneous pulse, while allowing for coalescence to be visualized for loci that follow a history of introgression.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63753-fig2-v3.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Each parent tree in our model generates four gene trees: one generated from lineage sorting (Panels <bold>A</bold> and <bold>E</bold>), and three equally likely trees generated from incomplete lineage sorting (panels <bold>B-D, F–H</bold>).</title><p>Top row shows the trees generated from parent tree 1; the bottom row shows the trees for parent tree 2.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63753-fig2-figsupp1-v3.tif"/></fig></fig-group><p>To make it easier to track the history of different gene trees, we imagine that a phylogenetic network can be split into a set of ‘parent trees’ which describe the history at individual loci (<xref ref-type="bibr" rid="bib45">Meng and Kubatko, 2009</xref>; <xref ref-type="bibr" rid="bib37">Liu et al., 2014</xref>; <xref ref-type="bibr" rid="bib24">Hibbins and Hahn, 2019</xref>; <xref ref-type="fig" rid="fig2">Figure 2</xref>, bottom). Within each of these parent trees, which describe either the species history or the history of introgression, gene trees sort under the multispecies coalescent process. Loci follow the species history, referred to as parent tree 1, with probability 1 – (<italic>δ</italic><sub>2</sub> + <italic>δ</italic><sub>3</sub>). With C → B introgression, some loci will follow the alternative history within parent tree 2, with probability <italic>δ</italic><sub>2</sub>. In parent tree 2, species B and C are sister and share a ‘speciation’ time of <italic>t</italic><sub>m</sub>. B → C introgression causes loci to follow parent tree 3 with probability <italic>δ</italic><sub>3</sub>; in this history, lineages B and C are sister and split at time <italic>t</italic><sub>m</sub>, while the split time of A and the ancestor of B/C is reduced to <italic>t</italic><sub>1</sub>. This reduction in the second split time in parent tree 3 occurs because the presence of loci from lineage B in lineage C allows C to trace its ancestry through B going back in time. Since B is more closely related to A than C, this allows C to coalesce with A at an earlier time (<xref ref-type="fig" rid="fig2">Figure 2</xref>). Each introgression event is modeled as a discrete and instantaneous ‘pulse’ that generates its own parent tree, and in our model we consider a single introgression event for simplicity. However, multiple events or introgression over a continuous time interval can be modeled by introducing multiple pulses with different directions, timings, or probabilities. Each such event introduces its own parent tree and set of gene trees.</p><p>Each parent tree can produce four gene trees under the multispecies coalescent process: one tree from lineage sorting, and three equally probable trees from incomplete lineage sorting (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). In other words, introgression always involves ILS, as these are not mutually exclusive histories. Each of these possible gene trees has five branches along which mutations can occur: three tip branches, an internal branch, and an ancestral branch. A subset of these possible gene trees within each parent tree can lead to hemiplasy, while homoplasy can happen in any gene tree (<xref ref-type="fig" rid="fig3">Figure 3</xref>). <xref ref-type="bibr" rid="bib20">Guerrero and Hahn, 2018</xref> provide exact expectations for the probability of a mutation on each branch of each genealogy in an ILS-only model. Before extending this framework to incorporate introgression, the ILS-only model will be briefly described here, using a slightly updated notation that will make it easier to include the effects of introgression.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>The possible paths to homoplasy and hemiplasy under the multispecies network coalescent.</title><p>Homoplasy can happen on any gene tree, as long as there are two independent mutations on tip branches (panel <bold>A</bold>). Homoplasy can also happen via a mutation in the ancestor of all three species, followed by a reversal (not shown). All cases of hemiplasy require a transition on the internal branch of a gene tree with the topology ((B,C),A). In parent tree 1 (panel <bold>B</bold>), only one such possible gene tree exists (shown in gray; <italic>BC</italic><sub>1</sub>). In both parent trees 2 and 3 (panels <bold>C</bold> and <bold>D</bold> respectively), there are two possible gene trees with this topology. These gene trees differ in internal branch lengths, depending on the parent tree of origin and whether the tree is the result of lineage sorting (<italic>BC</italic>1<sub>2</sub> and <italic>BC</italic>1<sub>3</sub>) or incomplete lineage sorting (<italic>BC</italic>2<sub>2</sub> and <italic>BC</italic>2<sub>3</sub>) within introgressed histories.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63753-fig3-v3.tif"/></fig><p>Consider a binary trait that is incongruent with the described species tree, where species B and C have the derived state and A has the ancestral state. We denote <italic>λ</italic><sub>1</sub>, <italic>λ</italic><sub>2</sub>, and <italic>λ</italic><sub>3</sub> as the tip branches in any topology leading to species A, B, and C respectively; <italic>λ</italic><sub>4</sub> denotes the internal branch of any topology, and <italic>λ</italic><sub>5</sub> the branch subtending the root. The notation <italic>ν(λ</italic>, <italic>τ</italic>) represents the probability of a mutation on branch <italic>λ</italic><sub>i</sub> in genealogy <italic>τ</italic>, where <italic>τ</italic> represents any of the four gene trees from any of the three parent trees. The rates of 0 → 1 and 1 → 0 mutations are assumed to be equal, and the rate among lineages is assumed to be constant. Finally, to describe individual genealogies, we use the notation <italic>XY</italic><sub>i=1,2,3</sub>, where <italic>X</italic> and <italic>Y</italic> denote the sister taxa, and the subscript <italic>i</italic> denotes the parent-tree of origin. In cases where a tree topology can be produced by either lineage sorting or ILS, a non-subscripted 1 or 2 is used, respectively. Under the ILS-only model, hemiplasy can only occur through a substitution on branch <italic>λ</italic><sub>4</sub> of genealogy <italic>BC</italic><sub>1</sub> (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1C</xref>, <xref ref-type="fig" rid="fig3">Figure 3B</xref>). This occurs with the following probability:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>B</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>ν</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo> </mml:mo><mml:mo>≠</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mrow/></mml:munderover><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mi>ν</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>(<xref ref-type="bibr" rid="bib20">Guerrero and Hahn, 2018</xref>). <xref ref-type="disp-formula" rid="equ9">Equation 1</xref> has three components: the probability of observing genealogy <italic>BC</italic><sub>1</sub>, the probability that a mutation happens on the internal branch of that genealogy, and the probability that no other mutations occur. See section 1 of the Appendix for the full expressions for each mutation probability.</p><p>Now consider the phylogenetic network described earlier and shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>. At an introgressed locus, the parent tree topology is ((B,C), A), but could be either parent tree 2 or 3. Within each of these parent trees, there are two possible gene trees that share this topology: one produced by lineage sorting (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1E</xref>, <xref ref-type="fig" rid="fig3">Figure 3C</xref>) and one produced by ILS where B and C are still the first to coalesce (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1F</xref>, <xref ref-type="fig" rid="fig3">Figure 3C</xref>). While these trees have the same topology, their expected frequencies and internal branch lengths differ. These quantities also differ depending on the direction of introgression at the locus, that is whether the history follows parent tree 2 or 3.</p><p>We first consider the C → B direction of introgression, and genealogy <italic>BC</italic>1<sub>2</sub>, which is the result of lineage sorting within parent tree 2. This gives:<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo> </mml:mo><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>ν</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo> </mml:mo><mml:mo>≠</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mrow/></mml:munderover><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mi>ν</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>While <xref ref-type="disp-formula" rid="equ10">Equation 2</xref> has the same three core components as <xref ref-type="disp-formula" rid="equ9">Equation 1</xref>, there are several important differences. First, the gene tree probability is the probability of lineage sorting within parent tree 2, which differs from the probability of ILS within parent tree 1. Second, the lower bound of coalescence is <italic>t</italic><sub>m</sub> rather than <italic>t</italic><sub>1</sub>, resulting in a higher probability of lineage sorting in parent tree 2 as compared to parent tree 1. Third, because B and C coalesce more quickly in this tree, they share a longer internal branch, which means the probability of mutation on that branch is higher (see section 1 of the Appendix).</p><p>ILS within parent tree two produces gene tree <italic>BC</italic>2<sub>2</sub>, in which B and C are the first to coalesce in the common ancestor of all three species. The probability of hemiplasy in this case is:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>ν</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo> </mml:mo><mml:mo>≠</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mrow/></mml:munderover><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mi>ν</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>In <xref ref-type="disp-formula" rid="equ11">Equation 3</xref>, the gene tree probability represents ILS in parent tree 2. This probability is lower than its equivalent in parent tree 1, again because <italic>t</italic><sub>m</sub> is the lower bound for coalescence. Since the upper bound to coalescence is the same (<italic>t</italic><sub>2</sub>), the probability of a mutation on the internal branch of this gene tree is the same as for <italic>BC</italic><sub>1</sub> (the ILS topology within parent tree 1). To get the overall probability of hemiplasy due to both ILS and introgression when there is gene flow from C → B, we weight the probability from each gene tree (<xref ref-type="disp-formula" rid="equ9 equ10 equ11">Equations 1-3)</xref> by the admixture proportion, giving the following:<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mtext>C </mml:mtext><mml:mo>→</mml:mo><mml:mtext> B</mml:mtext></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>B</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mo> </mml:mo></mml:mrow></mml:math></disp-formula></p><p>From <xref ref-type="disp-formula" rid="equ12">Equation 4</xref>, we can see that introgression will increase the probability of hemiplasy over ILS alone (<xref ref-type="disp-formula" rid="equ9">Equation 1</xref>) whenever the probability of hemiplasy from parent tree two is higher than from parent tree 1 (i.e. <inline-formula><mml:math id="inf1"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>B</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>). This is true whenever <italic>t</italic><sub>2</sub> &gt;<italic>t</italic><sub>m</sub> (see section 2 of the Appendix), which is by definition always true in this model.</p><p>Finally, we consider the probability of hemiplasy when introgression is in the direction B → C (represented by admixture fraction <italic>δ</italic><sub>3</sub>). As mentioned previously, this direction of introgression results in an upper bound to coalescence of <italic>t</italic><sub>1</sub> rather than <italic>t</italic><sub>2</sub>. This is the primary difference between the directions of introgression, affecting both the expected gene tree frequencies and mutation probabilities (compare to <xref ref-type="disp-formula" rid="equ10 equ11">Equations 2 and 3)</xref>:<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo> </mml:mo><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>ν</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo> </mml:mo><mml:mo>≠</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mrow/></mml:munderover><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mi>ν</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula>and<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>ν</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo> </mml:mo><mml:mo>≠</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mrow/></mml:munderover><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mi>ν</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>For the general probability of hemiplasy, including both directions of introgression, we now have:<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mspace width="thickmathspace"/><mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mspace width="thickmathspace"/></mml:mrow></mml:mrow><mml:mo stretchy="false">→</mml:mo><mml:mrow><mml:mrow><mml:mspace width="thickmathspace"/><mml:mi mathvariant="normal">B</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mspace width="thickmathspace"/><mml:mi mathvariant="normal">B</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">→</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mspace width="thickmathspace"/></mml:mrow></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mspace width="thickmathspace"/><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:msub><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mspace width="thickmathspace"/><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:msub><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:msub><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mspace width="thickmathspace"/><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:msub><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Finally, we consider the probability of homoplasy. As described in <xref ref-type="bibr" rid="bib20">Guerrero and Hahn, 2018</xref>, there are two possible paths to homoplasy for a three-taxon tree where taxa B and C carry the derived state. The first is parallel 0 → one mutations on branches <italic>λ</italic><sub>2</sub> and <italic>λ</italic><sub>3</sub> (<xref ref-type="fig" rid="fig3">Figure 3A</xref>), and the second is a 0 → one mutation on branch <italic>λ</italic><sub>5</sub> followed by a 1 → 0 reversal on branch <italic>λ</italic><sub>1</sub>. Both these paths to homoplasy can happen on any possible genealogy, because every topology contains independent tip branches leading to species B and C, as well as an internal branch ancestral to all three species. This gives the following:<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow/></mml:munderover><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>τ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>ν</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>ν</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:munderover><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mrow/></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mtext> </mml:mtext><mml:mi>ν</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>ν</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>ν</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:munderover><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn></mml:mrow><mml:mrow/></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mtext> </mml:mtext><mml:mi>ν</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where τ denotes the set of all possible gene trees. (Note that the sum inside <xref ref-type="disp-formula" rid="equ16">Equation 8</xref> is multiplied by <inline-formula><mml:math id="inf2"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>τ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> in the main text of <xref ref-type="bibr" rid="bib20">Guerrero and Hahn, 2018</xref>. This is a typo in that paper, but the results presented from their model use the correct expression, <inline-formula><mml:math id="inf3"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>τ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.) This formulation can also be applied to the extended model with introgression, with the understanding that τ now also includes the gene trees produced by parent trees 2 and 3. Each gene tree used in this summation will have a different set of mutation probabilities, which are detailed in section 1 of the Appendix.</p><p>To understand the analytical effect of introgression on the relative risks of hemiplasy and homoplasy, we plotted the ratio <inline-formula><mml:math id="inf4"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> over a realistic range of admixture proportions, timings, and directions (<xref ref-type="fig" rid="fig4">Figure 4</xref>). The values of <italic>t</italic><sub>1</sub> and <italic>t</italic><sub>2</sub> were held constant at 1 and 3.5 coalescent units, respectively, with a population-scaled mutation rate of <italic>θ</italic> = 0.002. These settings ensured a constant contribution of incomplete lineage sorting to the risk of hemiplasy, leading to a baseline ratio of hemiplasy to homoplasy, <inline-formula><mml:math id="inf5"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, of 0.818 with no introgression. We varied the admixture proportion from 0 to 10%, and the value of <italic>t</italic><sub>m</sub> from 0.99 (just after the most recent speciation) to 0.01, for three different direction conditions: C → B only, B → C only, and equal rates in both directions.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>The probability of hemiplasy relative to homoplasy (contours) as a function of the admixture proportion (x-axis), the time between speciation and introgression (y-axis), and the direction of introgression (panels).</title><p>The contours delineate the factor difference between hemiplasy and homoplasy; for instance, a contour value of 2.0 means hemiplasy is twice as probable as homoplasy in that area of parameter space. At x = 0 in each panel, <italic>P</italic><sub>e</sub>/<italic>P</italic><sub>o</sub> = 0.818. (<bold>A</bold>) Equal rates of introgression in both directions. (<bold>B</bold>) Introgression in only the C → B direction. (<bold>C</bold>) Introgression in only the B → C direction.</p><p><supplementary-material id="fig4sdata1"><label>Figure 4—source data 1.</label><caption><title>Data used to generate the contour plots in <xref ref-type="fig" rid="fig4">Figure 4</xref>.</title><p>The value of <italic>P<sub>e</sub></italic>/<italic>P</italic><sub>o</sub> is reported for each parameter combination. Data for each panel is in separate tabs.</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-63753-fig4-data1-v3.xlsx"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63753-fig4-v3.tif"/></fig></sec><sec id="s2-2"><title>Introgression makes hemiplasy more likely than incomplete lineage sorting alone</title><p>Using our model for the probability of hemiplasy and of homoplasy, we examined the ratio <italic>P</italic><sub>e</sub>/<italic>P</italic><sub>o</sub> over a range of different introgression scenarios. This ratio summarizes how much more probable hemiplasy is than homoplasy for a given area of parameter space; for example, a value of <italic>P</italic><sub>e</sub>/<italic>P</italic><sub>o</sub> = 2 means hemiplasy is twice as likely as homoplasy. We find that the probability of hemiplasy relative to homoplasy increases as a function of the admixture proportion and how recently introgression occurs relative to speciation (<xref ref-type="fig" rid="fig4">Figure 4</xref>). As mentioned in the Introduction, there are several possible reasons for these observed trends. The strongest effect on <italic>P</italic><sub>e</sub>/<italic>P</italic><sub>o</sub> comes from the admixture proportion: a higher proportion means more loci evolving under parent trees 2 and 3, which means higher frequencies of the genealogies where hemiplasy is possible (i.e. <italic>BC</italic>1<sub>2</sub>, <italic>BC</italic>2<sub>2</sub>, <italic>BC</italic>1<sub>3,</sub><italic>BC</italic>2<sub>3</sub>). The range of simulated admixture proportions from 0 to 10% was meant to capture a biologically plausible range of values, although rates of introgression can sometimes be much higher than this (e.g. <xref ref-type="bibr" rid="bib17">Fontaine et al., 2015</xref>). Even in this modest range, the effect on the probability of hemiplasy can be substantial. We found that an admixture proportion of 5% results in hemiplasy being anywhere from 1.5 to 4 times more likely than homoplasy (depending on the timing and direction of introgression; <xref ref-type="fig" rid="fig4">Figure 4</xref>). Given the baseline value of <italic>P</italic><sub>e</sub>/<italic>P</italic><sub>o</sub> with no introgression for our chosen parameters (0.818), this represents at minimum a doubling of the probability of hemiplasy relative to homoplasy.</p><p>The effect of the timing of introgression is more complicated, as it manifests in multiple ways. First, more recent introgression increases the values of <italic>t</italic><sub>2</sub> – <italic>t</italic><sub>m</sub> and <italic>t</italic><sub>1</sub> – <italic>t</italic><sub>m</sub>, which in turn increases the degree of lineage sorting in parent trees 2 and 3, respectively. This leads to a higher frequency of gene trees where hemiplasy is possible. Second, the expected length of the internal branches in these two genealogies increases as introgression becomes more recent, which leads to a higher probability of mutations occurring on these branches. Third, since the total height of each tree is being held constant, more recent introgression reduces the lengths of the tip branches leading to species B and C. This reduces the probability of homoplasy due to parallel substitutions, again making hemiplasy relatively more likely. Finally, the strength of the effect of the timing of introgression increases with the admixture proportion, since it is a property of introgressed loci; in other words, the values of of <italic>t</italic><sub>2</sub> – <italic>t</italic><sub>m</sub> and <italic>t</italic><sub>1</sub> – <italic>t</italic><sub>m</sub> do not matter unless loci follow a history of introgression.</p><p>The direction of introgression affects the relationship between the admixture proportion, the timing of introgression, and hemiplasy risk (<xref ref-type="fig" rid="fig4">Figure 4B and C</xref>). While hemiplasy becomes more likely than homoplasy with increased admixture in either direction, <italic>P</italic><sub>e</sub>/<italic>P</italic><sub>o</sub> is lower in any given part of parameter space for B → C introgression (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). This is because the bounds of coalescence for parent tree 3 are <italic>t</italic><sub>1</sub> and <italic>t</italic><sub>m</sub>, which are always closer in time than <italic>t<sub>2</sub></italic> and <italic>t</italic><sub>m</sub> (<xref ref-type="fig" rid="fig2">Figure 2</xref>). The smaller internal branch in parent tree 3 leads to a higher rate of ILS, in addition to a shorter internal gene tree branch (and lower mutation probability) on genealogies that undergo lineage sorting in these histories. Finally, the timing of introgression has a stronger effect on <italic>P</italic><sub>e</sub>/<italic>P</italic><sub>o</sub> in the B → C direction (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). This is likely because parent tree 3 is truncated relative to parent tree 2 (see <xref ref-type="fig" rid="fig2">Figure 2</xref>), and so the difference <italic>t</italic><sub>1</sub> – <italic>t</italic><sub>m</sub> makes up a proportionally larger part of the tree height.</p></sec><sec id="s2-3"><title><italic>HeIST</italic>: <italic>He</italic>miplasy <italic>I</italic>nference <italic>S</italic>imulation <italic>T</italic>ool</title><p>As described above, it is possible to infer the most likely number of transitions for an incongruent trait while accounting for discordance in a rooted tree with three taxa. However, similar calculations are computationally difficult for larger numbers of taxa. Here, we present a tool built on top of the coalescent simulator <italic>ms</italic> (<xref ref-type="bibr" rid="bib26">Hudson, 2002</xref>) and sequence simulator <italic>Seq-Gen</italic> (<xref ref-type="bibr" rid="bib58">Rambaut and Grassly, 1997</xref>) that provides an intuitive way to interrogate the parameter space of larger trees. Our tool, dubbed <italic>HeIST</italic>, takes a phylogenetic tree (including an option to specify introgression events) with observed character states as input and returns a simulated distribution of the number of transitions necessary to explain those character states. Introgression events must be specified as an instantaneous ‘pulse’ from one lineage to another, but we allow flexibility with respect to the timing of that pulse, as well as the rate, direction, and the lineages involved. The input phylogeny must be in coalescent units, but we also include a tool for converting trees given in units of substitutions per site to coalescent units, as long as branches are also associated with concordance factors (see section entitled ‘Inferring the tip branch lengths of a phylogeny in coalescent units’ below).</p><p><italic>HeIST</italic> uses <italic>ms</italic> to simulate a large number of gene trees from the specified species tree or species network, and then simulates the evolution of a single nucleotide site along each of these gene trees using <italic>Seq-Gen</italic>. Loci where the simulated nucleotide states (transformed into 0/1 characters representing ancestral and derived states) match the character states observed on the species tree are taken as replicate simulations of the evolution of the trait being studied. In these ‘focal’ cases, <italic>HeIST</italic> counts the number of mutations that occurred along the gene tree in each simulation. It also returns information on the frequency of tip vs. internal branch mutations, transition vs. reversal mutations, the distribution of gene tree topologies, and whether gene trees originate from the species branching history or introgression history. Finally, it returns a summary of how much hemiplasy is likely to contribute to observed character states, using Fitch parsimony (<xref ref-type="bibr" rid="bib16">Fitch, 1971</xref>) to obtain a homoplasy-only baseline for comparison. <italic>HeIST</italic> is implemented in Python 3 and the package/source code are freely available from <ext-link ext-link-type="uri" xlink:href="https://github.com/mhibbins/HeIST">https://github.com/mhibbins/HeIST</ext-link>.</p></sec><sec id="s2-4"><title><italic>HeIST</italic> effectively captures the effects of ILS and introgression on hemiplasy risk</title><p>To evaluate the performance of <italic>HeIST</italic>, we simulated across nine conditions with increasing expected probabilities of hemiplasy, across five different trait mutation rates. The results, shown in <xref ref-type="fig" rid="fig5">Figure 5</xref>, confirm the theoretical predictions shown in <xref ref-type="fig" rid="fig4">Figure 4</xref>: the probability of hemiplasy increases as a function of decreasing internal branch length (ILS1-ILS3), increasing probability of introgression (INT1-INT3), and more recent introgression (INT4-INT6). The effect of the timing of introgression is weaker than the effect of the introgression rate, also in line with theoretical expectations. These results held true for both the probability conditional on observing the specified trait pattern (<xref ref-type="fig" rid="fig5">Figure 5A</xref>) and the raw probability (<xref ref-type="fig" rid="fig5">Figure 5B</xref>).</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Probabilities of hemiplasy estimated from <italic>HeIST</italic> across nine simulated conditions.</title><p>ILS1-ILS3 decrease the internal branch length of the species tree; INT1-INT3 introduce introgression between derived taxa with increasing probability; INT4-INT6 make introgression more recent while holding the probability constant. See <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref> for the exact parameters used in each condition. Panel <bold>A</bold> shows the probability conditional on observing the trait pattern, whereas panel <bold>B</bold> shows the raw probability out of 100,000 simulations.</p><p><supplementary-material id="fig5sdata1"><label>Figure 5—source data 1.</label><caption><title>Data used to generate <xref ref-type="fig" rid="fig5">Figure 5</xref>.</title><p><italic>condition</italic>: the simulation condition. <italic>hemi_count</italic>: the count of trees where a single mutation was observed. <italic>homo_count:</italic> the count of trees where two mutations were observed. <italic>cond_hemi: hemi_count</italic> divided by the sum of <italic>hemi_count</italic> and <italic>homo_count. raw_hemi: hemi_count</italic> divided by the total number of simulated trees. <italic>cond_homo: homo_count</italic> divided by the sum of <italic>hemi_count</italic> and <italic>homo_count. raw_homo: homo_count</italic> divided by the total number of simulated trees. <italic>pepo: cond_hemi</italic> divided by <italic>cond_homo</italic>.</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-63753-fig5-data1-v3.xlsx"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63753-fig5-v3.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Parameters used for benchmarking simulations in HeIST.</title><p>Nodes and reticulations are labeled with the timing of the split in units of 2N generations. Branch lengths are visually adjusted in each condition to show how the parameters change, but they are not to scale. Species sharing the derived character are shown in red.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63753-fig5-figsupp1-v3.tif"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 2.</label><caption><title>Mismatch between simulated (blue boxes) and theoretical (red diamonds) raw probabilities of hemiplasy across simulated conditions, using a mutation rate per 2N generations of 0.05.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63753-fig5-figsupp2-v3.tif"/></fig><fig id="fig5s3" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 3.</label><caption><title>Degree of mismatch between simulated and theoretical values of the raw probability of hemiplasy for our nine simulated conditions (colors) across five mutation rates (x-axis).</title><p>In the y-axis, the mean-squared error between the simulated and theoretical value is normalized by the mean simulated value to make the error comparable across simulation conditions.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63753-fig5-figsupp3-v3.tif"/></fig><fig id="fig5s4" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 4.</label><caption><title>Parameters used for simulations demonstrating trade-offs in introgression parameters in HeIST.</title><p>Nodes and reticulations are labeled with the timing of the split in units of 2N generations. Branch lengths are visually adjusted in each condition to show how the parameters change, but they are not to scale. Species sharing the derived character are shown in red.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63753-fig5-figsupp4-v3.tif"/></fig><fig id="fig5s5" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 5.</label><caption><title>Trade-offs of different network parameters in HeIST.</title><p>(<bold>A</bold>) The expected probability of the gene tree that causes hemiplasy for each simulated condition shown in <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>. (<bold>B</bold>) The probability of hemiplasy conditional on observing the incongruent trait pattern, estimated from 100 replicate simulations of each condition in HeIST using a mutation rate per 2N generations of 0.05.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63753-fig5-figsupp5-v3.tif"/></fig><fig id="fig5s6" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 6.</label><caption><title>Effect of phylogenetic inference, branch length unit conversion, and smoothing on estimated probabilities of hemiplasy in HeIST.</title><p>Species sharing the derived state are highlighted in red. Panel <bold>A</bold> shows the true tree in units of 2N generations, with estimated conditional probabilities for each number of mutations. For panels <bold>B</bold> and <bold>C</bold>, gene trees were simulated from the tree in panel A and used to build a phylogeny with <italic>RAxML</italic>, which was then giving to the unit conversion module in HeIST. In panel B, smoothing was done by redistributing branch lengths, while in panel C it was done by extending the tip branches. Note the length scale is different in panels B and C than in panel A. The ancestral branch leading to the ingroup clade (all taxa except taxon 1) was originally inferred to be a polytomy in <italic>RAxML</italic> but has been assigned a very short internal branch in the trees in panels B and C.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63753-fig5-figsupp6-v3.tif"/></fig></fig-group><p>While the change in the probability of hemiplasy is broadly consistent with theoretical expectations, the probabilities estimated from <italic>HeIST</italic> consistently underestimated the exact values predicted from theory by a small amount (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>). We suspect this is due to the occurrence of multiple hits on the same branch of a gene tree, which are not accounted for in our theoretical model. Reversals on branches where hemiplasy can occur would slightly reduce the number of observed hemiplasy cases, leading to the observed underestimation. Consistent with our hypothesis, the mean-normalized mean squared error between simulated and expected values is lower for both lower mutation rates and simulated conditions with a shorter internal branch (<xref ref-type="fig" rid="fig5s3">Figure 5—figure supplement 3</xref>). Overall, the mismatch between simulations and theory appears to be negligible for lower, more realistic trait mutation rates, so we do not believe this will be a concern for most empirical applications.</p><p>When the parameters of a phylogenetic network are estimated from empirical data, it is possible that many different parameter combinations may be equally likely, especially when only a subset of features are used to fit the model. However, these combinations may differentially affect the probability of hemiplasy: for instance, if the frequency of gene trees is used to fit the network model, but the length of gene tree branches is ignored. To investigate this, we applied <italic>HeIST</italic> to five simulated conditions in which the probability and recency of introgression were increased, while the frequency of the discordant gene tree that could cause hemiplasy was held constant (<xref ref-type="fig" rid="fig5s4">Figure 5—figure supplement 4</xref>). We found that, despite a constant gene tree probability, the conditional probability of hemiplasy increased in each successive condition as introgression became more recent and frequent (<xref ref-type="fig" rid="fig5s5">Figure 5—figure supplement 5</xref>). These results to some extent merely serve to reinforce the notion that introgression has an effect on hemiplasy above and beyond the effect of ILS alone: by lengthening the branch on the discordant tree that hemiplastic mutations can occur on, introgression has a larger effect than ILS alone. But even when network models that include introgression are used, the estimated effects on hemiplasy will be conservative if parameters are estimated using gene tree frequencies alone.</p><p>To evaluate the effects of using <italic>HeIST</italic> on real data, we compared results using the ‘true’ species tree (<xref ref-type="fig" rid="fig5s6">Figure 5—figure supplement 6A</xref>) to those obtained from estimating the species tree with branch lengths using simulated DNA data. This data was run through a pipeline involving estimating a phylogeny using <italic>RAxML</italic>, converting branch lengths to coalescent units, and smoothing (<xref ref-type="fig" rid="fig5s6">Figure 5—figure supplement 6B and C</xref>). In all cases, the tree was comprised of eight taxa with no introgression, with three incongruent taxa sharing a hypothetical derived character with a mutation rate of 0.05 per 2<italic>N</italic> generations. Regardless of whether the ‘extend’ or ‘redistribute’ method was used for smoothing, the overall effect of estimating the tree from sequence data was to lengthen both internal and tip branch lengths, reducing the conditional probability of hemiplasy relative to when the true tree was used (see <xref ref-type="fig" rid="fig5s6">Figure 5—figure supplement 6</xref> for exact probabilities). These results suggest that when our unit-conversion approach and smoothing are applied to empirical datasets, the resulting probability estimates will be conservative with respect to the hypothesis of hemiplasy.</p></sec><sec id="s2-5"><title>The distribution of green-blooded New Guinea lizards is likely to have arisen from fewer than four transitions</title><p>We investigated the most likely number of transitions to green blood from a red-blooded ancestor in New Guinea lizards of the genus <italic>Prasinohaema</italic> (<xref ref-type="bibr" rid="bib61">Rodriguez et al., 2018</xref>). Phylogenies constructed using <italic>RAxML</italic> (<xref ref-type="fig" rid="fig1">Figure 1</xref>, <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>) and <italic>ASTRAL</italic> (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>) recover the phylogeny published by <xref ref-type="bibr" rid="bib61">Rodriguez et al., 2018</xref>, including the placement of green-blooded species, and also confirm the existence of very short internal branches. In line with this observation, site concordance factors estimated from UCEs indicate very high rates of discordance in this clade, with some approaching a star tree (i.e. all topologies having frequencies of 33%) (<xref ref-type="fig" rid="fig1">Figure 1</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>). This strongly suggests that the apparent convergent evolution of the green blood phenotype has been affected by hemiplasy.</p><p>We used <italic>HeIST</italic> with the 15-taxon subclade containing six green-blooded species to determine the most likely number of trait transitions. Using our branch length unit conversion tool <italic>subs2coal</italic>, we obtained a best fit line of <inline-formula><mml:math id="inf6"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mn>0.3038</mml:mn><mml:mo>+</mml:mo><mml:mn>157.03</mml:mn><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula> with an adjusted <italic>R<sup>2</sup></italic> of 0.554 (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1A</xref>). This formula was used to predict the tip branch lengths of the lizard phylogeny in coalescent units, for input to <italic>HeIST</italic> (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>). This analysis was repeated using two different outgroups, which differed in their distance from the focal subclade. The results were essentially the same using both outgroups; here, we present probabilities using the closer outgroup, <italic>Scincella lateralis</italic>. After simulating 10<sup>10</sup> loci from the lizard phylogeny using <italic>HeIST</italic>, we obtained 2042 loci with a distribution of derived states that matched the empirical distribution of green-blooded species. It is important to note that this number is expected to be a very small proportion of the total number of simulated loci. This occurs because it is necessary to simulate trait histories randomly, but we use only the ones that match the observed distribution. Due to the enormous space of possibilities, the probability of any single trait distribution will be very low, especially with large numbers of taxa and high rates of trait incongruence.</p><p>With four independent transitions required without discordance, there are three possible scenarios that involve at least one hemiplastic transition (<xref ref-type="fig" rid="fig6">Figure 6A</xref>). The first is a hemiplasy-only scenario, in which all green-blooded species are grouped into a single monophyletic clade in a gene tree, and a single transition in the ancestor of this clade explains the observed distribution (<xref ref-type="fig" rid="fig6">Figure 6A</xref>, left). Out of 2042 focal loci, 726 (35.5%) correspond to this hemiplasy-only case. In the second case, the green-blooded species may be grouped into one or two clades in a gene tree, and there are two independent transitions—at least one of which must involve a discordant ancestral branch (<xref ref-type="fig" rid="fig6">Figure 6A</xref>, mid-left). Since there are still multiple independent transitions, this case represents a combination of hemiplasy and homoplasy, but exactly which mutations on which branches are hemiplasy vs. homoplasy will depend on the gene tree topology. Of 2042 focal cases, 1316 (64.5%), correspond to this scenario. In the third case, the green-blooded species are grouped into as many as three clades, with three independent transitions, at least one of which must be hemiplastic (<xref ref-type="fig" rid="fig6">Figure 6A</xref>, mid-right). Finally, the green-blooded species may be grouped into four clades, with four independent transitions, as in the species tree (<xref ref-type="fig" rid="fig6">Figure 6A</xref>, right). We observed no instances of the latter two cases out of 2042 focal loci. These results strongly support the conclusion that, due to hemiplasy, the green-blooded phenotype arose from one or two independent transitions, rather than four.</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Probable histories for (<bold>A</bold>) the origin of green blood in New Guinea lizards and (<bold>B</bold>) the chromosomal inversion spanning the gene <italic>cortex</italic> in <italic>Heliconius</italic>, calculated using <italic>HeIST</italic>.</title><p>Trees depict the maximum number of clades expected for gene tree topologies under each scenario, with green-blooded clades in green and inversion clades in blue. Branches with proposed ancestral-to-derived transitions are labeled with stars. Exactly which species are sorted into these clades can vary, meaning many possible gene trees exist for each of the depicted scenarios. Correspondingly, any of the labeled hypothetical mutations could represent hemiplasy or homoplasy (except in the case of a single mutation, which must be hemiplasy), depending on the gene tree topology. Reported probabilities are based on 10<sup>10</sup> simulated trees for New Guinea lizards and 10<sup>7</sup> trees for <italic>Heliconius</italic>, with probabilities conditional on matching the empirical trait distributions. Panel <bold>C</bold> shows what proportion of gene trees originate from a history of introgression vs. the species tree for the results summarized in panel B (blue) as compared to what would be expected based on the inferred network in <xref ref-type="fig" rid="fig1">Figure 1</xref> (black).</p><p><supplementary-material id="fig6sdata1"><label>Figure 6—source data 1.</label><caption><title>Output file from the <italic>HeIST</italic> lizard analysis, from which the probabilities are reported in <xref ref-type="fig" rid="fig6">Figure 6A</xref>.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-63753-fig6-data1-v3.zip"/></supplementary-material></p><p><supplementary-material id="fig6sdata2"><label>Figure 6—source data 2.</label><caption><title>Output file from the <italic>HeIST</italic> butterfly analysis, from which probabilities are reported in <xref ref-type="fig" rid="fig6">Figure 6B and C</xref>.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-63753-fig6-data2-v3.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63753-fig6-v3.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Regression of internal branch lengths in substitutions per site (x-axis) against the same branch estimated in coalescent units using concordance factors (y-axis) for the 43-species lizard phylogeny (panel <bold>A</bold>) and the 6-species Heliconius phylogeny (panel <bold>B</bold>).</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63753-fig6-figsupp1-v3.tif"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 2.</label><caption><title>Ultrametric phylogeny of green-blooded lizards, with branch lengths in units of 2N generations and green-blooded taxa labeled in green.</title><p>This tree was generated from the phylogeny in <xref ref-type="fig" rid="fig1">Figure 1</xref> in the main text using our regression approach for unit conversion, followed by a smoothing step. Gene trees were simulated from this tree within HeIST.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63753-fig6-figsupp2-v3.tif"/></fig></fig-group><p>In all 2042 simulated focal cases, the gene trees on which mutations arose grouped the green-blooded species as monophyletic, regardless of the number of mutations that occurred on the tree. In addition, almost all these monophyletic clades share the same structure, containing two subclades: one containing <italic>P. semoni</italic>, <italic>P. prehensicauda</italic>, <italic>P. flavipes</italic>, and <italic>P. sp nov 1</italic>; another containing <italic>P. virens</italic> and <italic>P. sp nov 2</italic>. It is important to note that the frequency of monophyletic groupings is not expected to reflect the overall distribution of gene trees, but rather the distribution conditional on observing the trait incongruence of interest. These observations make our estimated probabilities easy to interpret: if there was one mutation, it happened in the ancestor of the green-blooded clade; if there were two mutations, they most likely occurred in the ancestors of the two subclades.</p><p>Following the logic of ‘phyloGWAS’ (<xref ref-type="bibr" rid="bib55">Pease et al., 2016</xref>), we checked biallelic sites in the UCE alignment and topologies from the UCE gene trees for a monophyletic clade of green-blooded lizards in order to identify regions potentially associated with variation in blood color. However, both the gene tree and UCE datasets contained missing samples, which made it difficult to confidently identify truly monophyletic clades. On average, approximately nine taxa were unrepresented in the tips of individual gene trees, and approximately 10 were not assigned a base at individual sites in UCEs. The identity of the missing taxa varied across sites and trees, but often included species inside the 15-taxon subclade containing the green-blooded species, which made it more difficult to consistently polarize and compare patterns of monophyly. In the small proportion of gene trees and UCE sites where information was available for all taxa, we did not find any monophyletic groupings of green-blooded species.</p></sec><sec id="s2-6"><title>A chromosomal inversion in the <italic>Heliconius erato</italic>/<italic>sara</italic> clade likely has a single origin</title><p>In addition to the analysis of green-blooded lizards, we also investigated the origins of a chromosomal inversion in the <italic>Heliconius erato/sara</italic> clade (<xref ref-type="bibr" rid="bib13">Edelman et al., 2019</xref>). This inversion spans the gene <italic>cortex</italic>, which is known to influence wing patterning and coloration across butterflies (<xref ref-type="bibr" rid="bib31">Joron et al., 2006</xref>; <xref ref-type="bibr" rid="bib50">Nadeau et al., 2016</xref>). While parsimony applied to the species phylogeny would suggest two independent origins of the inversion (<xref ref-type="fig" rid="fig1">Figure 1B</xref>), there is clear evidence in <xref ref-type="bibr" rid="bib13">Edelman et al., 2019</xref> of both incomplete lineage sorting and introgression among the clades sharing the inversion, implicating a role for hemiplasy.</p><p>We inferred branch lengths in coalescent units for the phylogenetic network of these species given in <xref ref-type="bibr" rid="bib13">Edelman et al., 2019</xref>. Using our unit conversion tool, we obtained a best-fit line of <inline-formula><mml:math id="inf7"><mml:mrow><mml:mi>y</mml:mi><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mo>−</mml:mo><mml:mn>1.815</mml:mn><mml:mo> </mml:mo><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:mn>302.49</mml:mn><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula> with an adjusted <italic>R<sup>2</sup></italic> of 0.98 (though as a note of caution with the <italic>R<sup>2</sup></italic>, this regression contained only five data points; see <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1B</xref>). The predicted branch leading to the outgroup was extremely long (~40<italic>N</italic> generations), so the tree was smoothed using the ‘extend’ method without the outgroup, and the outgroup was re-added post-smoothing at a length proportional to the original network. The two most highly supported introgression events in the inferred phylogenetic network were then added to the coalescent tree with their previously inferred direction, rate, and approximate timing, before being given to <italic>HeIST</italic> as input (<xref ref-type="fig" rid="fig1">Figure 1B</xref>).</p><p>Using <italic>HeIST</italic>, we found that a single origin of the inversion was most likely, representing 660 of 923 (71.5%) focal cases (<xref ref-type="fig" rid="fig6">Figure 6B</xref>, left). The scenario involving two mutations was less likely, but was still found in 253 of 923 cases (27.4%) (<xref ref-type="fig" rid="fig6">Figure 6B</xref>, right). We also observed a small number (3/923, 0.32%) of focal cases with three independent transitions. Overall, our results support the original findings of <xref ref-type="bibr" rid="bib13">Edelman et al., 2019</xref> that the inversion likely arose once and then was shared between lineages via introgression.</p><p>Out of 923 simulated loci matching the trait pattern, we found that 413 originated from an introgressed history. This proportion (0.447) is substantially higher than the sum of introgression probabilities specified in the input (0.201), which suggests that introgression contributes more to the probability of observing the trait incongruence than would be expected by chance. In addition, as in the lizard simulations, we found that almost every simulated focal tree (913/923, 98.9%) grouped the <italic>Heliconius</italic> species that share the inversion as monophyletic. However, there is more variation in the structure of the subclades than there was in the lizards. Nevertheless, we can infer from this that two-mutation cases are most likely to arise as independent mutations in the ancestors of two subclades that are part of a larger monophyletic group.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Phenotypic convergence among species can provide important evidence for natural selection. The molecular variation underlying this convergence can arise through independent mutations at the molecular level (<xref ref-type="bibr" rid="bib67">Storz, 2016</xref>). However, it has recently become clear that such cases of ‘true’ convergence need to be distinguished from cases of apparent convergence due to hemiplasy (<xref ref-type="bibr" rid="bib22">Hahn and Nakhleh, 2016</xref>). Some effort has been made in this regard, through the use of coalescent simulation, summary statistics, and updated comparative approaches (<xref ref-type="bibr" rid="bib55">Pease et al., 2016</xref>; <xref ref-type="bibr" rid="bib7">Copetti et al., 2017</xref>; <xref ref-type="bibr" rid="bib20">Guerrero and Hahn, 2018</xref>; <xref ref-type="bibr" rid="bib73">Wu et al., 2018</xref>). However, these approaches often assume incomplete lineage sorting as the only source of discordance, and cannot explicitly resolve the number of transitions required to explain a trait distribution while accounting for discordance. More recently, <xref ref-type="bibr" rid="bib4">Bastide et al., 2018</xref> and <xref ref-type="bibr" rid="bib32">Karimi et al., 2020</xref> developed extensions to comparative methods that allow quantitative trait likelihoods to be calculated on phylogenetic networks. However, while phylogenetic network inference methods are often robust to the effects of ILS (<xref ref-type="bibr" rid="bib64">Solís-Lemus and Ané, 2016</xref>; <xref ref-type="bibr" rid="bib72">Wen et al., 2018</xref>), the estimated networks themselves do not contain the necessary information to simultaneously capture the effects of ILS and introgression on trait probabilities (<xref ref-type="bibr" rid="bib43">Mendes et al., 2018</xref>).</p><p>Here, we take two important steps toward addressing these problems by: (1) studying the effect of introgression on the risk of hemiplasy under the multispecies network coalescent model and (2) providing a tool that can infer the most probable number of transitions given a phylogenetic distribution of binary traits. We find that introgression increases the risk of hemiplasy over ILS alone, and uncover likely hemiplastic origins for the evolution of green blood from a red-blooded ancestor in New Guinea lizards, and a chromosomal inversion spanning a gene important for wing coloration in <italic>Heliconius</italic>. While our work has important implications for studies of trait evolution, it also carries numerous limitations and simplifying assumptions, which suggest logical next steps for further work. Below we discuss these implications, assumptions, and future directions.</p><sec id="s3-1"><title>The probability of hemiplasy due to introgression</title><p>A multitude of studies have revealed the potential role of introgression in shaping phenotypic convergence and adaptation (e.g. <xref ref-type="bibr" rid="bib23">Heliconius Genome Consortium, 2012</xref>; <xref ref-type="bibr" rid="bib28">Huerta-Sánchez et al., 2014</xref>; <xref ref-type="bibr" rid="bib30">Jones et al., 2018</xref>; <xref ref-type="bibr" rid="bib49">Mullen et al., 2020</xref>). However, such studies rarely consider how introgression could lead to false inferences of convergence, due to hemiplasy at both the molecular and phenotypic levels, if left unaccounted for. Our model results show that both ILS and introgression must be accounted for in order to make robust inferences of convergent evolution.</p><p>Our model for the probability of hemiplasy with introgression, combining concepts from two previously published models, also shares most of their assumptions. First, we have assumed the simplest possible introgression scenario, involving a single pair of species and with introgression occurring instantaneously at some point in the past. However, much more complex introgression scenarios are possible, including introgression between multiple species pairs, involving ancestral populations (and internal branches), at multiple time points in the past, or continuously over a period of time. Horizontal gene transfer, which is more common in prokaryotes, would also require networks that contain reticulation edges spanning very long periods of time. It is not always clear how the probability of hemiplasy would be affected under these alternative introgression scenarios. For example, we assume that the taxa sharing the derived state are also the ones involved in introgression, but introgression between other species pairs could alter patterns of discordance and therefore affect the hemiplasy risk, albeit less directly. Many of these scenarios could be incorporated into the general MSNC framework as additional parent trees, but with more complex histories this may become mathematically intractable even in the three-taxon case; our hemiplasy inference tool, <italic>HeIST</italic>, is designed to ameliorate this issue. Despite these limitations, we can generally expect that introgression will increase the overall risk of hemiplasy whenever rates of introgression are higher between pairs of species that also share the derived state for an incongruent trait. This is because what truly matters is the generation of gene tree topologies with internal branches where hemiplastic transitions can occur; the increased variance in coalescence times under more complex introgression scenarios, while affecting mutation probabilities, should have a comparatively minor effect (<xref ref-type="fig" rid="fig4">Figure 4</xref>).</p><p>We also assume that the coalescence times and gene tree frequencies of loci underlying trait variation follow neutral expectations, even though alleles controlling trait variation are often under some form of selection. Directional selection on such variation will reduce <italic>N</italic><sub>e</sub> relative to neutral expectations, which will decrease the rate of incomplete lineage sorting and consequently hemiplasy due to ILS. Of course, the amount of ILS used in our simulations is not taken directly from neutral expectations, but rather is estimated from real data. Therefore, the effects of selection on traits of interest will only be manifest if they are greater than the general effects of linked selection across the regions used to estimate discordance (<xref ref-type="bibr" rid="bib33">Kern and Hahn, 2018</xref>). On the other hand, introgressed alleles can lead to hemiplasy even in cases where there is no ILS. In fact, directional selection would also make it more likely that introgressed loci have a discordant topology, as it reduces ILS within parent trees 2 and 3. Alternatively, balancing selection can maintain ancestral polymorphism and increase rates of discordance due to ILS. This will also increase the risk of hemiplasy (e.g. <xref ref-type="bibr" rid="bib17">Fontaine et al., 2015</xref>; <xref ref-type="bibr" rid="bib34">Lamichhaney et al., 2016</xref>; <xref ref-type="bibr" rid="bib52">Palesch et al., 2018</xref>).</p></sec><sec id="s3-2"><title>Considerations for the inference tool <italic>HeIST</italic></title><p>While the software we introduce here allows for multiple novel types of inferences, it also has several limitations that are important to address. Errors common to all phylogenetic methods can be introduced into the user-specified species tree/network at several steps, including errors in ortholog identification, tree topology, concordance factors, and branch lengths (via both the conversion to coalescent units and tree smoothing). The process of smoothing the coalescent tree should introduce predictable biases in branch length estimates. When using <italic>ete3</italic>’s method for redistributing branch lengths, internal branches that are very short may have their length increased; conversely, long external branches may be shortened. The lengthening of internal branches decreases the overall rate of discordance, and makes inferences about hemiplasy from <italic>HeIST</italic> conservative. Similarly, when smoothing is done using our function for extending tip branch lengths, the probability of independent mutations on those tip branches (i.e. homoplasy) is increased, again making hemiplasy inferences conservative. The results presented in <xref ref-type="fig" rid="fig5s6">Figure 5—figure supplement 6</xref> capture the overall effects of errors in phylogeny estimation, branch length prediction, and smoothing.</p><p>Errors in inference may affect our approach to branch length unit conversion in several ways. If concordance factors are underestimates—for instance, due to errors in gene tree reconstruction—then the branch lengths in coalescent units will also be underestimates of their true values. The result would be simulations with more ILS and discordance than actually occurred. In cases where there are concerns about branch length estimates, we suggest running <italic>HeIST</italic> across multiple values; for tip branches, the option exists within <italic>HeIST</italic> to use the lower and upper bounds of the prediction interval in addition to the predictions themselves. In addition, if there are tip branch lengths in the original tree that fall outside the range of internal branch length values, the predicted value of those tip branches in coalescent units may be less reliable, since it requires extrapolation beyond the range of datapoints used to fit the regression. Lastly, we note that <xref ref-type="bibr" rid="bib4">Bastide et al., 2018</xref> propose an approach to estimating coalescent tip branch lengths on a network using the method of least-squares between pairwise genetic distances and network pairwise distances. We expect this approach to have very similar performance to ours, since linear regression is done using least-squares and pairwise genetic distances should be highly correlated with concordance factors.</p><p>There are also several practical points to consider when applying <italic>HeIST</italic> to empirical data. When researchers have questions about hemiplasy involving either very large phylogenies or very low mutation rates, only a small number of simulated trees may match the incongruent pattern found in real data. The large number of simulations required may not be computationally feasible, although careful pruning of species that do not affect inferences of hemiplasy may greatly reduce this limitation. By default, <italic>HeIST</italic> will prune the input phylogeny to include the smallest subclade that contains all the taxa with the derived state, plus a specified outgroup. In addition, while <italic>HeIST</italic> can simulate phylogenies with introgression, it requires that the timing, direction, and rate of each introgression event is provided. To obtain this information, we recommend using a phylogenetic network-based approach such as PhyloNet (<xref ref-type="bibr" rid="bib72">Wen et al., 2018</xref>), SNaQ (<xref ref-type="bibr" rid="bib64">Solís-Lemus and Ané, 2016</xref>), or the SpeciesNetwork (<xref ref-type="bibr" rid="bib76">Zhang et al., 2018a</xref>) package within BEAST2 (<xref ref-type="bibr" rid="bib5">Bouckaert et al., 2019</xref>).</p><p>Finally, an issue that concerns both our theoretical work and <italic>HeIST</italic> is the specification of the mutation rate. In both cases, we assume that the rates of 0 → 1 and 1 → 0 transitions are equivalent, and that these rates are constant across the tree under study. Violations of these assumptions will certainly influence the probabilities of hemiplasy and homoplasy, although it is unlikely that underlying mutation rates will vary substantially among closely related lineages (<xref ref-type="bibr" rid="bib39">Lynch, 2010</xref>). More importantly, these rates represent the mutation rate among character states, and may not always be the same as nucleotide mutation rates. We have assumed in the results presented here that transitions between character states are controlled by a single site, and therefore that the nucleotide mutation rate is a good approximation of the trait mutation rate. However, the degree to which this is true will depend on the genetic architecture underlying a trait. For example, transitions in floral color are often underlain by loss-of-function mutations, and many mutational targets can potentially lead to the same phenotypic changes (<xref ref-type="bibr" rid="bib59">Rausher, 2008</xref>; <xref ref-type="bibr" rid="bib63">Smith and Rausher, 2011</xref>). In such cases, the rate of trait transitions can potentially be many times higher than the nucleotide mutation rate, with homoplasy becoming more probable as a result. In contrast, trait transitions can also require multiple molecular changes, the order of which may be constrained by pleiotropy and epistasis. Such changes underlie, for instance, high-altitude adaptation of hemoglobin in mammals (<xref ref-type="bibr" rid="bib66">Storz et al., 2009</xref>; <xref ref-type="bibr" rid="bib68">Tufts et al., 2015</xref>). In these cases, the rate of trait transitions may be many times lower than the nucleotide mutation rate, with hemiplasy becoming more probable as a result.</p></sec><sec id="s3-3"><title>Evolution of green-blooded lizards and the H<italic>eliconious</italic> inversion</title><p>In our analysis of lizards in the genus <italic>Prasinohaema</italic>, we found strong support for one or two independent origins of green blood from a red-blooded ancestor, with two origins being the most likely. This contrasts with analyses that do not account for gene tree discordance, in which four transitions is the best explanation. In <italic>Heliconius</italic>, we found support for a single origin of a chromosomal inversion, in contrast to methods that do not account for discordance. Both these results strongly suggest that hemiplasy has played a role in the evolution of these traits.</p><p>Applications of <italic>HeIST</italic> to these clades involves some system-specific assumptions, the first of which relates to the genetic architecture of the traits under study. For the lizard analysis, it invokes the potentially strong assumption that the green-blooded phenotype is achievable by a single mutation. While the physiological mechanism for this phenotype is well-understood (<xref ref-type="bibr" rid="bib2">Austin and Jessing, 1994</xref>), the genetic architecture underlying the transition from a red-blooded ancestor is not. As discussed in the previous section, this architecture will affect the choice of <italic>θ</italic> used as the trait evolutionary rate in our simulations. Since the genetic architecture is unknown, our choice of <italic>θ</italic> was based on what is typically observed for nucleotide mutations in vertebrate systems (<xref ref-type="bibr" rid="bib39">Lynch, 2010</xref>). For the <italic>Heliconius</italic> inversion, the architecture is more clear-cut, since chromosomal inversions are a single mutational event by definition. While the per-generation rate of de novo chromosomal inversions is not known for many systems, it is certain to be lower than the rate for nucleotide mutations per-site. Nucleotide <italic>θ</italic> is estimated at 0.02–0.03 for <italic>H. melpomene</italic> (<xref ref-type="bibr" rid="bib41">Martin et al., 2016</xref>), and averages around 0.01 in invertebrates (<xref ref-type="bibr" rid="bib39">Lynch, 2010</xref>). Our choice of <italic>θ</italic> for the inversion was one order of magnitude lower than these estimates.</p><p>Another key assumption is that the estimated gene trees and concordance factors are accurate, as is the regression approach for converting branch length units. The observed <italic>R</italic><sup>2</sup> of 0.554 for the unit-conversion in the lizard dataset might be interpreted as surprisingly low given that it is a regression of the same quantity measured in two different units. This value likely reflects uncertainty generated in several steps of our analysis, including the estimation of branch lengths in the maximum-likelihood species tree, and the procedure of randomly sampling quartets to estimate sCFs used by <italic>IQ-TREE</italic>. In <italic>Heliconius</italic>, the <italic>R</italic><sup>2</sup> was much higher at 0.98, but with only five data points there was limited information about the true relationship. Nonetheless, we observed the expected positive correlation in both cases, and a sufficient amount of variation is explained to ensure that tip branches estimated in coalescent units are proportionally similar to those in the maximum-likelihood tree, suggesting that the regression approach works well as an approximation. In addition, the regression line on the lizard data appears to slightly over-estimate very short branch lengths in coalescent units, making our inferences of hemiplasy conservative.</p></sec><sec id="s3-4"><title>Conclusions</title><p>A major question in the study of convergent evolution is whether phenotypic convergence is underlain by convergent changes at the molecular level (<xref ref-type="bibr" rid="bib67">Storz, 2016</xref>). The work presented here is concerned primarily with such molecular changes, and the results of our empirical analyses highlight how apparently convergent phenotypes can arise from a single molecular change. Such shared changes come about as a result of gene tree discordance due to ILS, introgression, or some combination of the two. Given that these phenomena are common in phylogenomic datasets (<xref ref-type="bibr" rid="bib57">Pollard et al., 2006</xref>; <xref ref-type="bibr" rid="bib17">Fontaine et al., 2015</xref>; <xref ref-type="bibr" rid="bib55">Pease et al., 2016</xref>; <xref ref-type="bibr" rid="bib51">Novikova et al., 2016</xref>; <xref ref-type="bibr" rid="bib73">Wu et al., 2018</xref>), perhaps it should be less surprising that phylogenetically incongruent traits often have a common genetic basis.</p><p>Finally, while the tools presented here may help to rule out cases of molecular convergence, the observation of a single molecular origin for a trait does not rule out the occurrence of convergent adaptation in general. Parallel selective pressures from the environment on the same molecular variation may be regarded as one of many possible modes of convergent evolution (<xref ref-type="bibr" rid="bib35">Lee and Coop, 2017</xref>). In studying novel phenotypes such as green blood or wing patterning and coloration, there is still tremendous interest in understanding the ecological pressures that may have led to the independent fixation of single, ancestral changes along multiple lineages. In general, integrative approaches combining modern phylogenomics with an ecological context will pave the way toward an improved understanding of the nature of convergent evolution.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Accuracy of <italic>HeIST</italic></title><p>To confirm that <italic>HeIST</italic> accurately counts mutation events, and is consistent with our theoretical findings, we evaluated its performance under nine simulated conditions with increasing levels of expected hemiplasy. All simulated conditions involve a four-taxon tree with the topology (((4,3),2),1). Species 4 and 2 carry the derived state for a hypothetical binary character. The split of species one from the ancestor of 4, 3, and 2 occurs at 8<italic>N</italic> generations in the past. The first three simulated conditions contain no introgression, and progressively decrease the length of the internal branch subtending species 4 and 3. The total tree height was held constant. The simulated internal branch lengths were 2<italic>N</italic>, 1.5<italic>N</italic>, and <italic>N</italic> generations for conditions <italic>ILS1</italic>, <italic>ILS2</italic>, and <italic>ILS3</italic> respectively. The subsequent six conditions maintain the <italic>ILS3</italic> condition for branch lengths, with the addition of an introgression event from species 2 into species 4. For conditions <italic>INT1</italic>, <italic>INT2</italic>, and <italic>INT3</italic>, the timing of introgression was held constant at 0.6<italic>N</italic> generations, while the introgression probability was set to 0.01, 0.05, and 0.1, respectively. For conditions <italic>INT4</italic>, <italic>INT5</italic>, and <italic>INT6</italic>, the introgression probability was held constant at 0.1, while the timing of introgression was reduced to 0.4<italic>N</italic>, 0.2<italic>N</italic>, and 0.1<italic>N</italic>, respectively. The parameters used for each condition are summarized in <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>.</p><p>We performed two sets of simulations: (1) 100 replicates of each condition, consisting of 100,000 gene trees each, with a constant mutation rate of 0.05 per 2<italic>N</italic> generations; (2) 20 replicates of each condition, for each of five different mutation rates per 2<italic>N</italic> generations (0.0005, 0.0025, 0.005, 0.025, 0.05), each consisting of 1,000,000 gene trees. For each combination of parameters, we estimated the probability of hemiplasy conditional on observing the specified trait pattern, and the raw probability of hemiplasy out of the total number of replicates. For the latter simulation set, we estimated the mean-squared error (MSE) using the simulated values as observations and the expected value from theory as the true mean. These MSE values were divided by the simulated mean to compare error across conditions with different ranges of expected values.</p><p>Trade-offs among parameters mean that many combinations of estimated network parameters may be equally consistent with patterns in subsets of the observed data. To investigate possible effects on the probability of hemiplasy, we evaluated the performance of <italic>HeIST</italic> under five additional simulation conditions (<xref ref-type="fig" rid="fig5s4">Figure 5—figure supplement 4</xref>). In each successive condition, the probability of introgression was increased, while the timing of introgression was made more recent. The length of the internal branch in the species tree was also increased such that the expected frequency of the discordant gene tree that causes hemiplasy remained approximately constant (<xref ref-type="fig" rid="fig5s5">Figure 5—figure supplement 5A</xref>). These simulations used the same tree topology, derived taxa, split time of the ancestral population, and mutation rate as the first set of benchmarking simulations. Condition 1 used the same parameters as <italic>ILS1</italic>. Conditions 2–5 used the following sets of parameters, respectively: 2.08<italic>N</italic>, 2.32<italic>N</italic>, 2.6<italic>N</italic>, 2.8<italic>N</italic> generations for the length of the internal branch; 0.01, 0.025, 0.04, 0.05 for the probability of introgression; 0.4<italic>N</italic>, 0.3<italic>N</italic>, 0.2<italic>N</italic>, 0.1<italic>N</italic> generations for the timing of introgression (<xref ref-type="fig" rid="fig5s4">Figure 5—figure supplement 4</xref>). For each condition, we performed 100 replicate simulations of 100,000 gene trees each in <italic>HeIST</italic>, and estimated the probability of hemiplasy conditional on observing the trait pattern.</p></sec><sec id="s4-2"><title>Inferring the tip branch lengths of a phylogeny in coalescent units</title><p>Inferences made under the multispecies coalescent require branch lengths specified in coalescent units. However, most standard methods for building phylogenies infer branches in units of substitutions per site. Units of absolute time inferred from substitution rates using molecular clock approaches can be converted into coalescent units, provided that the generation time and effective population size are known. However, these parameters are sometimes not available or accurate for a given system. As an alternative, estimates of gene tree discordance can be used to estimate internal branch lengths in coalescent units, but these provide no information about the lengths of tip branches. For example, the species tree inference software <italic>ASTRAL</italic> (<xref ref-type="bibr" rid="bib77">Zhang et al., 2018b</xref>) does not infer tip branch lengths, while the software <italic>MP-EST</italic> (<xref ref-type="bibr" rid="bib36">Liu et al., 2010</xref>) adds branches of length nine for every tip. These tip lengths are necessary to make accurate inferences about hemiplasy and homoplasy from empirical data, since they affect the probability of mutation on tip branches.</p><p>To ameliorate this problem, we have applied a simple regression approach for inferring tip lengths in coalescent units (see <xref ref-type="bibr" rid="bib4">Bastide et al., 2018</xref> for an alternative method). Our approach makes use of concordance factors: estimates of the fraction of concordant loci with respect to a particular branch in a species tree. Concordance factors come in two flavors: gene concordance factors (gCFs) (<xref ref-type="bibr" rid="bib18">Gadagkar et al., 2005</xref>; <xref ref-type="bibr" rid="bib1">Ané et al., 2007</xref>), which estimate the concordance of gene tree topologies, and site concordance factors (sCFs) (<xref ref-type="bibr" rid="bib46">Minh et al., 2020a</xref>), which do the same for parsimony-informative sites. In general, concordance factors estimated from quartets provide an estimate of <inline-formula><mml:math id="inf8"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac bevelled="true"><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, where <italic>T</italic> is the length of the internal branch in coalescent units. With concordance factors given on the internal branches of a tree that has lengths in substitutions per site, the aforementioned formula can be used to obtain estimates of those same branch lengths in units of 2<italic>N</italic> generations. A regression of the internal branch length estimates in both units can then be used to obtain a formula for unit conversion between them. <italic>HeIST</italic> uses this formula to predict the tip branch lengths of the tree in coalescent units. To partially account for uncertainty introduced during tip branch length prediction, <italic>HeIST</italic> can also be run using the lower or upper bounds of the prediction 95% confidence interval as the inferred tip lengths, in addition to the predictions themselves. As a final step in this process, the tree in coalescent units is smoothed, as <italic>ms</italic> requires the input tree to be ultrametric. <italic>HeIST</italic> has two options for how to perform this smoothing. The first redistributes the tree branch lengths so that the distance from the root to each tip is the same; this is done using the convert_to_ultrametric() function in the Python library <italic>ete3</italic> (<xref ref-type="bibr" rid="bib27">Huerta-Cepas et al., 2016</xref>). The second extends the lengths of tip branches while preserving internal branch lengths; this function is coded within <italic>HeIST</italic>, but was borrowed from a commented block in <italic>ete3</italic>’s source code.</p><p>To investigate the potential bias introduced to results from <italic>HeIST</italic> by either phylogenetic inference, the branch regression approach, or subsequent smoothing, we compared the outputs of <italic>HeIST</italic> run from an eight-taxon test tree with known branch lengths. To generate realistic datasets, we first simulated 3000 gene trees from the known species tree using <italic>ms</italic>, and then simulated 1 Kb of sequence from each locus with <italic>θ</italic> = 0.001 using <italic>Seq-Gen</italic>. These loci were concatenated into a single 3 Mb alignment, which was given to <italic>RAxML</italic> version 8.2.12 (<xref ref-type="bibr" rid="bib65">Stamatakis, 2014</xref>) using the GTR substitution model with rate heterogeneity to infer a species tree in units of substitutions per site. This inferred tree and the concatenated alignment were given to <italic>IQ-TREE</italic> version 2.0 (<xref ref-type="bibr" rid="bib47">Minh et al., 2020b</xref>) to infer site concordance factors. This substitution tree with nodes labeled with concordance factors was given as input to <italic>HeIST</italic>, where our branch regression approach was applied. We tested both methods for tree smoothing from this input. We estimated the probability of each number of mutations conditional on observing the incongruent site pattern, and results from this analysis were compared to those obtained using the ‘true’ test tree (<xref ref-type="fig" rid="fig5s6">Figure 5—figure supplement 6</xref>).</p><p>Our regression approach is implemented in <italic>HeIST</italic> and can be run as part of the overall hemiplasy analysis, or separately using the module ‘<italic>subs2coal</italic>’.</p></sec><sec id="s4-3"><title>Empirical applications of <italic>HeIST</italic></title><p>We applied <italic>HeIST</italic> to two empirical case studies where hemiplasy appeared to be a plausible explanation for observed trait incongruences. The first is a dataset of New Guinea lizards (<xref ref-type="bibr" rid="bib61">Rodriguez et al., 2018</xref>). As described in the Introduction, the genus <italic>Prasinohaema</italic> contains six species that have evolved green blood from a red-blooded ancestor (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). Previous analyses of the species tree built from thousands of loci inferred that four independent transitions are necessary to explain the phylogenetic distribution of green-blooded species (<xref ref-type="bibr" rid="bib61">Rodriguez et al., 2018</xref>). This conclusion is the same using any standard phylogenetic comparative method, whether ancestral state reconstruction is carried out using maximum likelihood (<xref ref-type="bibr" rid="bib61">Rodriguez et al., 2018</xref>) or Fitch parsimony (this study). However, the phylogeny for this clade contains many short branches (<xref ref-type="fig" rid="fig1">Figure 1</xref>), suggesting that a scenario involving at least some hemiplasy (in this case, 1–3 mutations) may be preferred over homoplasy-only scenarios when discordance is accounted for.</p><p>To address this question, we used the original dataset of <xref ref-type="bibr" rid="bib61">Rodriguez et al., 2018</xref>, consisting of 3220 ultra-conserved elements (UCEs) totalling approximately 1.3 Mb for 43 species. We then down-sampled these species to 15 taxa in the clade including the green-blooded species and an outgroup (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). We constructed a concatenated maximum likelihood species tree, in addition to gene trees for each UCE, using <italic>RAxML</italic> version 8.2.12 (<xref ref-type="bibr" rid="bib65">Stamatakis, 2014</xref>). To verify the species tree topology for the 15-taxon subclade, we also constructed a tree with <italic>ASTRAL-III</italic> version 5.6.3 (<xref ref-type="bibr" rid="bib76">Zhang et al., 2018a</xref>). Site and gene concordance factors were calculated for this tree using <italic>IQ-TREE</italic> version 2.0 (<xref ref-type="bibr" rid="bib46">Minh et al., 2020a</xref>; <xref ref-type="bibr" rid="bib47">Minh et al., 2020b</xref>). To obtain the phylogeny in coalescent units, we employed the regression approach described above for unit conversion as implemented in <italic>HeIST</italic>. The ‘extend’ method was used for tree smoothing. We then used <italic>HeIST</italic> to simulate 10<sup>10</sup> loci from the lizard subclade containing green-blooded species, with a population-scaled mutation rate (<italic>θ</italic>) of 0.0005 per 2<italic>N</italic> generations. While specific parameter estimates are not available for this system, our choice of <italic>θ</italic> reflects broad estimates of <italic>N</italic><sub>e</sub> and µ on the order of 10<sup>5</sup>–10<sup>6</sup> (<xref ref-type="bibr" rid="bib38">Lynch, 2006</xref>) and 10<sup>−8</sup> – 10<sup>−9</sup> per-base per-generation (<xref ref-type="bibr" rid="bib39">Lynch, 2010</xref>), respectively, in vertebrates (see Discussion). This analysis was performed for each of two outgroups: <italic>Lygosoma sp</italic>, which is sister to 40 species in the 43-species phylogeny, and <italic>Scincella lateralis</italic>, which is sister to the 15-taxon clade containing the green-blooded species. We also calculated <italic>D</italic>-statistics (<xref ref-type="bibr" rid="bib19">Green et al., 2010</xref>) for 12 trios involving green-blooded taxa, finding no strong evidence of introgression (block bootstrap significance tests, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>-Tables 2 and 3). Therefore, our simulations did not include any introgression events.</p><p>The second empirical case study involves the origins of a chromosomal inversion spanning a gene important for wing coloration in <italic>Heliconius</italic> butterflies (<xref ref-type="bibr" rid="bib13">Edelman et al., 2019</xref>). The derived inversion arrangement is shared by four taxa, grouped into two subclades in the <italic>erato/sara</italic> group of <italic>Heliconius</italic>. Fitch parsimony suggests two independent origins, but a combination of short internal branches and introgression between the ancestral populations sharing the inversion (<xref ref-type="bibr" rid="bib13">Edelman et al., 2019</xref>) strongly suggests a role for hemiplasy. We obtained the phylogenetic network—that is, the species tree with reticulation edges—inferred in units of substitutions per site, in addition to gene concordance factors, from the authors. As our regression approach for conversion to coalescent units cannot be used on phylogenetic networks directly, we used the species tree embedded in the network with concordance factors as input to <italic>subs2coal</italic>. The two most strongly supported introgression events were then added back onto the smoothed network in coalescent units, using the inferred rates and directions, with approximate timings based on the location of the events in the original network and our requirement that these events be instantaneous ‘pulses.’ From this input (shown in <xref ref-type="fig" rid="fig1">Figure 1B</xref>), we simulated 10<sup>7</sup> gene trees in <italic>HeIST</italic> using a mutation rate of 0.0005 per 2<italic>N</italic> generations. That our choice of <italic>θ</italic> for this system is the same as in our lizard analysis is just a coincidence: it reflects a trade-off between the generally higher effective population size for insects (<xref ref-type="bibr" rid="bib38">Lynch, 2006</xref>) and the lower mutation rate expected for chromosomal inversions; see Discussion. We also performed the same simulations without specifying the introgression events to obtain an ILS-only estimate of the probability of hemiplasy.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank Rafael Guerrero, Leonie Moyle, and Ben Fulton for helpful comments and advice, as well as three anonymous reviewers, the associate editor, and Chris Austin for suggestions that helped improve this work. We also thank Zachary Rodriguez for sharing the lizard data and Nate Edelman for sharing the <italic>Heliconius</italic> phylogenetic network. This work was supported by National Science Foundation grant DEB-1936187.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing - original draft, Project administration, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Data curation, Software, Validation, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Supervision, Funding acquisition, Validation, Writing - original draft, Project administration, Writing - review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Table 1: Site concordance factors from IQtree.</title><p>'ID’: the ID of the internalbranch in the full lizard phylogeny, as labeled in <xref ref-type="fig" rid="fig1s1">Figure 1 —figure supplement 1</xref>. 'sCF’: the value of the site concordance factor for the branch, averaged over 100 randomly sampled quartets.'sDF1’ and'sDF2’: the site discordance factors for the first and second most common discordant site patterns at each branch, respectively.'sN’: the average number of informative sites averaged across the sampled quartets at each branch.'Length’ is the length of the internal branch in substitutions per site. -Table 2: Trios involving green-blooded species which were evaluated for evidence of introgression using D statistics. Species are listed in the order P1, P2, P3, where an excess of shared P1/P3 or P2/P3 alleles would indicate evidence of introgression. Lygosoma sp was used as the outgroup for each trio. Table 3: D statistic results for the 12 trios listed in Table 1, estimated from the concatenated alignment of ultra-conserved elements (UCEs). Significance was evaluated for each trio by bootstrap-sampling the UCEs to generate a null distribution of alignments, and asking how often the bootstrap distribution of 1000 D statistics was at least as extreme as the observed value.</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-63753-supp1-v3.xlsx"/></supplementary-material><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-63753-transrepform-v3.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>Availability of the lizard genomic data and Heliconius phylogenetic network is detailed in the Acknowledgements section of the source manuscript. Source code and test cases for our software HeIST are freely available from the GitHub repository. Source data files have been provided for Figures 1, 4, 5, and 6. The Appendix details all the mutation rate parameters of our mathematical model.</p><p>The following previously published datasets were used:</p><p><element-citation id="dataset1" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Rodriguez</surname><given-names>ZB</given-names></name><name><surname>Perkins</surname><given-names>SL</given-names></name><name><surname>Austin</surname><given-names>CC</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>Raw sequencing reads from ultraconserved elements of Australasian skinks</data-title><source>NCBI BioProject</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJNA420910">PRJNA420910</pub-id></element-citation></p><p><element-citation id="dataset2" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Edelman</surname><given-names>NB</given-names></name><name><surname>Frandsen</surname><given-names>PF</given-names></name><name><surname>Miyagi</surname><given-names>M</given-names></name><name><surname>Clavijo</surname><given-names>B</given-names></name><name><surname>Davey</surname><given-names>J</given-names></name><name><surname>Dikow</surname><given-names>RB</given-names></name><collab>Van Belleghem SM</collab><name><surname>Patterson</surname><given-names>N</given-names></name><name><surname>Neafsey</surname><given-names>DE</given-names></name><name><surname>Richard</surname><given-names>C</given-names></name><name><surname>Kumar</surname><given-names>S</given-names></name><name><surname>Moreira</surname><given-names>GRP</given-names></name><name><surname>Salazar</surname><given-names>C</given-names></name><name><surname>Chouteau</surname><given-names>M</given-names></name><name><surname>Counterman</surname><given-names>B</given-names></name><name><surname>Papa</surname><given-names>R</given-names></name><name><surname>Blaxter</surname><given-names>M</given-names></name><name><surname>Reed</surname><given-names>RD</given-names></name><name><surname>Dasmahapatra</surname><given-names>KK</given-names></name><name><surname>Kronforst</surname><given-names>M</given-names></name><name><surname>Joron</surname><given-names>M</given-names></name><name><surname>Jiggins</surname><given-names>CD</given-names></name><name><surname>McMillan</surname><given-names>WO</given-names></name><collab>Di Palma F</collab><name><surname>Blumberg</surname><given-names>AJ</given-names></name><name><surname>Wakeley</surname><given-names>J</given-names></name><name><surname>Jaffe</surname><given-names>D</given-names></name><name><surname>Mallet</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>Data from: Genomic architecture and introgression shape a butterfly radiation</data-title><source>Dryad Digital Repository</source><pub-id assigning-authority="Dryad" pub-id-type="doi">10.5061/dryad.b7bj832</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ané</surname> <given-names>C</given-names></name><name><surname>Larget</surname> <given-names>B</given-names></name><name><surname>Baum</surname> <given-names>DA</given-names></name><name><surname>Smith</surname> <given-names>SD</given-names></name><name><surname>Rokas</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Bayesian estimation of concordance among gene trees</article-title><source>Molecular Biology and Evolution</source><volume>24</volume><fpage>412</fpage><lpage>426</lpage><pub-id pub-id-type="doi">10.1093/molbev/msl170</pub-id><pub-id pub-id-type="pmid">17095535</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Austin</surname> <given-names>CC</given-names></name><name><surname>Jessing</surname> <given-names>KW</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Green-blood pigmentation in lizards</article-title><source>Comparative Biochemistry and Physiology Part A: Physiology</source><volume>109</volume><fpage>619</fpage><lpage>626</lpage><pub-id pub-id-type="doi">10.1016/0300-9629(94)90201-1</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Avise</surname> <given-names>JC</given-names></name><name><surname>Robinson</surname> <given-names>TJ</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Hemiplasy: a new term in the lexicon of phylogenetics</article-title><source>Systematic Biology</source><volume>57</volume><fpage>503</fpage><lpage>507</lpage><pub-id pub-id-type="doi">10.1080/10635150802164587</pub-id><pub-id pub-id-type="pmid">18570042</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bastide</surname> <given-names>P</given-names></name><name><surname>Solís-Lemus</surname> <given-names>C</given-names></name><name><surname>Kriebel</surname> <given-names>R</given-names></name><name><surname>William Sparks</surname> <given-names>K</given-names></name><name><surname>Ané</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Phylogenetic comparative methods on phylogenetic networks with reticulations</article-title><source>Systematic Biology</source><volume>67</volume><fpage>800</fpage><lpage>820</lpage><pub-id pub-id-type="doi">10.1093/sysbio/syy033</pub-id><pub-id pub-id-type="pmid">29701821</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bouckaert</surname> <given-names>R</given-names></name><name><surname>Vaughan</surname> <given-names>TG</given-names></name><name><surname>Barido-Sottani</surname> <given-names>J</given-names></name><name><surname>Duchêne</surname> <given-names>S</given-names></name><name><surname>Fourment</surname> <given-names>M</given-names></name><name><surname>Gavryushkina</surname> <given-names>A</given-names></name><name><surname>Heled</surname> <given-names>J</given-names></name><name><surname>Jones</surname> <given-names>G</given-names></name><name><surname>Kühnert</surname> <given-names>D</given-names></name><name><surname>De Maio</surname> <given-names>N</given-names></name><name><surname>Matschiner</surname> <given-names>M</given-names></name><name><surname>Mendes</surname> <given-names>FK</given-names></name><name><surname>Müller</surname> <given-names>NF</given-names></name><name><surname>Ogilvie</surname> <given-names>HA</given-names></name><name><surname>du Plessis</surname> <given-names>L</given-names></name><name><surname>Popinga</surname> <given-names>A</given-names></name><name><surname>Rambaut</surname> <given-names>A</given-names></name><name><surname>Rasmussen</surname> <given-names>D</given-names></name><name><surname>Siveroni</surname> <given-names>I</given-names></name><name><surname>Suchard</surname> <given-names>MA</given-names></name><name><surname>Wu</surname> <given-names>CH</given-names></name><name><surname>Xie</surname> <given-names>D</given-names></name><name><surname>Zhang</surname> <given-names>C</given-names></name><name><surname>Stadler</surname> <given-names>T</given-names></name><name><surname>Drummond</surname> <given-names>AJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>BEAST 2.5: an advanced software platform for Bayesian evolutionary analysis</article-title><source>PLOS Computational Biology</source><volume>15</volume><elocation-id>e1006650</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006650</pub-id><pub-id pub-id-type="pmid">30958812</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brandvain</surname> <given-names>Y</given-names></name><name><surname>Kenney</surname> <given-names>AM</given-names></name><name><surname>Flagel</surname> <given-names>L</given-names></name><name><surname>Coop</surname> <given-names>G</given-names></name><name><surname>Sweigart</surname> <given-names>AL</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Speciation and introgression between <italic>Mimulus nasutus</italic> and <italic>Mimulus guttatus</italic></article-title><source>PLOS Genetics</source><volume>10</volume><elocation-id>e1004410</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1004410</pub-id><pub-id pub-id-type="pmid">24967630</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Copetti</surname> <given-names>D</given-names></name><name><surname>Búrquez</surname> <given-names>A</given-names></name><name><surname>Bustamante</surname> <given-names>E</given-names></name><name><surname>Charboneau</surname> <given-names>JLM</given-names></name><name><surname>Childs</surname> <given-names>KL</given-names></name><name><surname>Eguiarte</surname> <given-names>LE</given-names></name><name><surname>Lee</surname> <given-names>S</given-names></name><name><surname>Liu</surname> <given-names>TL</given-names></name><name><surname>McMahon</surname> <given-names>MM</given-names></name><name><surname>Whiteman</surname> <given-names>NK</given-names></name><name><surname>Wing</surname> <given-names>RA</given-names></name><name><surname>Wojciechowski</surname> <given-names>MF</given-names></name><name><surname>Sanderson</surname> <given-names>MJ</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Extensive gene tree discordance and hemiplasy shaped the genomes of North American columnar cacti</article-title><source>PNAS</source><volume>114</volume><fpage>12003</fpage><lpage>12008</lpage><pub-id pub-id-type="doi">10.1073/pnas.1706367114</pub-id><pub-id pub-id-type="pmid">29078296</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Degnan</surname> <given-names>JH</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Modeling hybridization under the network multispecies coalescent</article-title><source>Systematic Biology</source><volume>67</volume><fpage>786</fpage><lpage>799</lpage><pub-id pub-id-type="doi">10.1093/sysbio/syy040</pub-id><pub-id pub-id-type="pmid">29846734</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Degnan</surname> <given-names>JH</given-names></name><name><surname>Rosenberg</surname> <given-names>NA</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Gene tree discordance, phylogenetic inference and the multispecies coalescent</article-title><source>Trends in Ecology &amp; Evolution</source><volume>24</volume><fpage>332</fpage><lpage>340</lpage><pub-id pub-id-type="doi">10.1016/j.tree.2009.01.009</pub-id><pub-id pub-id-type="pmid">19307040</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Delsuc</surname> <given-names>F</given-names></name><name><surname>Brinkmann</surname> <given-names>H</given-names></name><name><surname>Philippe</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Phylogenomics and the reconstruction of the tree of life</article-title><source>Nature Reviews Genetics</source><volume>6</volume><fpage>361</fpage><lpage>375</lpage><pub-id pub-id-type="doi">10.1038/nrg1603</pub-id><pub-id pub-id-type="pmid">15861208</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dunn</surname> <given-names>CW</given-names></name><name><surname>Hejnol</surname> <given-names>A</given-names></name><name><surname>Matus</surname> <given-names>DQ</given-names></name><name><surname>Pang</surname> <given-names>K</given-names></name><name><surname>Browne</surname> <given-names>WE</given-names></name><name><surname>Smith</surname> <given-names>SA</given-names></name><name><surname>Seaver</surname> <given-names>E</given-names></name><name><surname>Rouse</surname> <given-names>GW</given-names></name><name><surname>Obst</surname> <given-names>M</given-names></name><name><surname>Edgecombe</surname> <given-names>GD</given-names></name><name><surname>Sørensen</surname> <given-names>MV</given-names></name><name><surname>Haddock</surname> <given-names>SH</given-names></name><name><surname>Schmidt-Rhaesa</surname> <given-names>A</given-names></name><name><surname>Okusu</surname> <given-names>A</given-names></name><name><surname>Kristensen</surname> <given-names>RM</given-names></name><name><surname>Wheeler</surname> <given-names>WC</given-names></name><name><surname>Martindale</surname> <given-names>MQ</given-names></name><name><surname>Giribet</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Broad phylogenomic sampling improves resolution of the animal tree of life</article-title><source>Nature</source><volume>452</volume><fpage>745</fpage><lpage>749</lpage><pub-id pub-id-type="doi">10.1038/nature06614</pub-id><pub-id pub-id-type="pmid">18322464</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Durand</surname> <given-names>EY</given-names></name><name><surname>Patterson</surname> <given-names>N</given-names></name><name><surname>Reich</surname> <given-names>D</given-names></name><name><surname>Slatkin</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Testing for ancient admixture between closely related populations</article-title><source>Molecular Biology and Evolution</source><volume>28</volume><fpage>2239</fpage><lpage>2252</lpage><pub-id pub-id-type="doi">10.1093/molbev/msr048</pub-id><pub-id pub-id-type="pmid">21325092</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Edelman</surname> <given-names>NB</given-names></name><name><surname>Frandsen</surname> <given-names>PB</given-names></name><name><surname>Miyagi</surname> <given-names>M</given-names></name><name><surname>Clavijo</surname> <given-names>B</given-names></name><name><surname>Davey</surname> <given-names>J</given-names></name><name><surname>Dikow</surname> <given-names>RB</given-names></name><name><surname>García-Accinelli</surname> <given-names>G</given-names></name><name><surname>Van Belleghem</surname> <given-names>SM</given-names></name><name><surname>Patterson</surname> <given-names>N</given-names></name><name><surname>Neafsey</surname> <given-names>DE</given-names></name><name><surname>Challis</surname> <given-names>R</given-names></name><name><surname>Kumar</surname> <given-names>S</given-names></name><name><surname>Moreira</surname> <given-names>GRP</given-names></name><name><surname>Salazar</surname> <given-names>C</given-names></name><name><surname>Chouteau</surname> <given-names>M</given-names></name><name><surname>Counterman</surname> <given-names>BA</given-names></name><name><surname>Papa</surname> <given-names>R</given-names></name><name><surname>Blaxter</surname> <given-names>M</given-names></name><name><surname>Reed</surname> <given-names>RD</given-names></name><name><surname>Dasmahapatra</surname> <given-names>KK</given-names></name><name><surname>Kronforst</surname> <given-names>M</given-names></name><name><surname>Joron</surname> <given-names>M</given-names></name><name><surname>Jiggins</surname> <given-names>CD</given-names></name><name><surname>McMillan</surname> <given-names>WO</given-names></name><name><surname>Di Palma</surname> <given-names>F</given-names></name><name><surname>Blumberg</surname> <given-names>AJ</given-names></name><name><surname>Wakeley</surname> <given-names>J</given-names></name><name><surname>Jaffe</surname> <given-names>D</given-names></name><name><surname>Mallet</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Genomic architecture and introgression shape a butterfly radiation</article-title><source>Science</source><volume>366</volume><fpage>594</fpage><lpage>599</lpage><pub-id pub-id-type="doi">10.1126/science.aaw2090</pub-id><pub-id pub-id-type="pmid">31672890</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Felsenstein</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>Phylogenies and the comparative method</article-title><source>The American Naturalist</source><volume>125</volume><fpage>1</fpage><lpage>15</lpage><pub-id pub-id-type="doi">10.1086/284325</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Felsenstein</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2004">2004</year><source>Inferring Phylogenies</source><publisher-name>Sinauer Associates</publisher-name></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fitch</surname> <given-names>WM</given-names></name></person-group><year iso-8601-date="1971">1971</year><article-title>Toward defining the course of evolution: minimum change for a specific tree topology</article-title><source>Systematic Zoology</source><volume>20</volume><fpage>406</fpage><lpage>416</lpage><pub-id pub-id-type="doi">10.2307/2412116</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fontaine</surname> <given-names>MC</given-names></name><name><surname>Pease</surname> <given-names>JB</given-names></name><name><surname>Steele</surname> <given-names>A</given-names></name><name><surname>Waterhouse</surname> <given-names>RM</given-names></name><name><surname>Neafsey</surname> <given-names>DE</given-names></name><name><surname>Sharakhov</surname> <given-names>IV</given-names></name><name><surname>Jiang</surname> <given-names>X</given-names></name><name><surname>Hall</surname> <given-names>AB</given-names></name><name><surname>Catteruccia</surname> <given-names>F</given-names></name><name><surname>Kakani</surname> <given-names>E</given-names></name><name><surname>Mitchell</surname> <given-names>SN</given-names></name><name><surname>Wu</surname> <given-names>YC</given-names></name><name><surname>Smith</surname> <given-names>HA</given-names></name><name><surname>Love</surname> <given-names>RR</given-names></name><name><surname>Lawniczak</surname> <given-names>MK</given-names></name><name><surname>Slotman</surname> <given-names>MA</given-names></name><name><surname>Emrich</surname> <given-names>SJ</given-names></name><name><surname>Hahn</surname> <given-names>MW</given-names></name><name><surname>Besansky</surname> <given-names>NJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Extensive introgression in a malaria vector species complex revealed by phylogenomics</article-title><source>Science</source><volume>347</volume><elocation-id>1258524</elocation-id><pub-id pub-id-type="doi">10.1126/science.1258524</pub-id><pub-id pub-id-type="pmid">25431491</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gadagkar</surname> <given-names>SR</given-names></name><name><surname>Rosenberg</surname> <given-names>MS</given-names></name><name><surname>Kumar</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Inferring species phylogenies from multiple genes: concatenated sequence tree versus consensus gene tree</article-title><source>Journal of Experimental Zoology Part B: Molecular and Developmental Evolution</source><volume>304B</volume><fpage>64</fpage><lpage>74</lpage><pub-id pub-id-type="doi">10.1002/jez.b.21026</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Green</surname> <given-names>RE</given-names></name><name><surname>Krause</surname> <given-names>J</given-names></name><name><surname>Briggs</surname> <given-names>AW</given-names></name><name><surname>Maricic</surname> <given-names>T</given-names></name><name><surname>Stenzel</surname> <given-names>U</given-names></name><name><surname>Kircher</surname> <given-names>M</given-names></name><name><surname>Patterson</surname> <given-names>N</given-names></name><name><surname>Li</surname> <given-names>H</given-names></name><name><surname>Zhai</surname> <given-names>W</given-names></name><name><surname>Fritz</surname> <given-names>MH</given-names></name><name><surname>Hansen</surname> <given-names>NF</given-names></name><name><surname>Durand</surname> <given-names>EY</given-names></name><name><surname>Malaspinas</surname> <given-names>AS</given-names></name><name><surname>Jensen</surname> <given-names>JD</given-names></name><name><surname>Marques-Bonet</surname> <given-names>T</given-names></name><name><surname>Alkan</surname> <given-names>C</given-names></name><name><surname>Prüfer</surname> <given-names>K</given-names></name><name><surname>Meyer</surname> <given-names>M</given-names></name><name><surname>Burbano</surname> <given-names>HA</given-names></name><name><surname>Good</surname> <given-names>JM</given-names></name><name><surname>Schultz</surname> <given-names>R</given-names></name><name><surname>Aximu-Petri</surname> <given-names>A</given-names></name><name><surname>Butthof</surname> <given-names>A</given-names></name><name><surname>Höber</surname> <given-names>B</given-names></name><name><surname>Höffner</surname> <given-names>B</given-names></name><name><surname>Siegemund</surname> <given-names>M</given-names></name><name><surname>Weihmann</surname> <given-names>A</given-names></name><name><surname>Nusbaum</surname> <given-names>C</given-names></name><name><surname>Lander</surname> <given-names>ES</given-names></name><name><surname>Russ</surname> <given-names>C</given-names></name><name><surname>Novod</surname> <given-names>N</given-names></name><name><surname>Affourtit</surname> <given-names>J</given-names></name><name><surname>Egholm</surname> <given-names>M</given-names></name><name><surname>Verna</surname> <given-names>C</given-names></name><name><surname>Rudan</surname> <given-names>P</given-names></name><name><surname>Brajkovic</surname> <given-names>D</given-names></name><name><surname>Kucan</surname> <given-names>Ž</given-names></name><name><surname>Gušic</surname> <given-names>I</given-names></name><name><surname>Doronichev</surname> <given-names>VB</given-names></name><name><surname>Golovanova</surname> <given-names>LV</given-names></name><name><surname>Lalueza-Fox</surname> <given-names>C</given-names></name><name><surname>de la Rasilla</surname> <given-names>M</given-names></name><name><surname>Fortea</surname> <given-names>J</given-names></name><name><surname>Rosas</surname> <given-names>A</given-names></name><name><surname>Schmitz</surname> <given-names>RW</given-names></name><name><surname>Johnson</surname> <given-names>PLF</given-names></name><name><surname>Eichler</surname> <given-names>EE</given-names></name><name><surname>Falush</surname> <given-names>D</given-names></name><name><surname>Birney</surname> <given-names>E</given-names></name><name><surname>Mullikin</surname> <given-names>JC</given-names></name><name><surname>Slatkin</surname> <given-names>M</given-names></name><name><surname>Nielsen</surname> <given-names>R</given-names></name><name><surname>Kelso</surname> <given-names>J</given-names></name><name><surname>Lachmann</surname> <given-names>M</given-names></name><name><surname>Reich</surname> <given-names>D</given-names></name><name><surname>Pääbo</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>A draft sequence of the Neandertal genome</article-title><source>Science</source><volume>328</volume><fpage>710</fpage><lpage>722</lpage><pub-id pub-id-type="doi">10.1126/science.1188021</pub-id><pub-id pub-id-type="pmid">20448178</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guerrero</surname> <given-names>RF</given-names></name><name><surname>Hahn</surname> <given-names>MW</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Quantifying the risk of hemiplasy in phylogenetic inference</article-title><source>PNAS</source><volume>115</volume><fpage>12787</fpage><lpage>12792</lpage><pub-id pub-id-type="doi">10.1073/pnas.1811268115</pub-id><pub-id pub-id-type="pmid">30482861</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hahn</surname> <given-names>MW</given-names></name><name><surname>Hibbins</surname> <given-names>MS</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>A three-sample test for introgression</article-title><source>Molecular Biology and Evolution</source><volume>36</volume><fpage>2878</fpage><lpage>2882</lpage><pub-id pub-id-type="doi">10.1093/molbev/msz178</pub-id><pub-id pub-id-type="pmid">31373630</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hahn</surname> <given-names>MW</given-names></name><name><surname>Nakhleh</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Irrational exuberance for resolved species trees</article-title><source>Evolution</source><volume>70</volume><fpage>7</fpage><lpage>17</lpage><pub-id pub-id-type="doi">10.1111/evo.12832</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><collab>Heliconius Genome Consortium</collab></person-group><year iso-8601-date="2012">2012</year><article-title>Butterfly genome reveals promiscuous exchange of mimicry adaptations among species</article-title><source>Nature</source><volume>487</volume><fpage>94</fpage><lpage>98</lpage><pub-id pub-id-type="doi">10.1038/nature11041</pub-id><pub-id pub-id-type="pmid">22722851</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hibbins</surname> <given-names>MS</given-names></name><name><surname>Hahn</surname> <given-names>MW</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The timing and direction of introgression under the multispecies network coalescent</article-title><source>Genetics</source><volume>211</volume><fpage>1059</fpage><lpage>1073</lpage><pub-id pub-id-type="doi">10.1534/genetics.118.301831</pub-id><pub-id pub-id-type="pmid">30670542</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hudson</surname> <given-names>RR</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>Testing the constant-rate neutral allele model with protein sequence data</article-title><source>Evolution</source><volume>37</volume><fpage>203</fpage><lpage>217</lpage><pub-id pub-id-type="doi">10.1111/j.1558-5646.1983.tb05528.x</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hudson</surname> <given-names>RR</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Generating samples under a Wright-Fisher neutral model of genetic variation</article-title><source>Bioinformatics</source><volume>18</volume><fpage>337</fpage><lpage>338</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/18.2.337</pub-id><pub-id pub-id-type="pmid">11847089</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huerta-Cepas</surname> <given-names>J</given-names></name><name><surname>Serra</surname> <given-names>F</given-names></name><name><surname>Bork</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>ETE 3: reconstruction, analysis, and visualization of phylogenomic data</article-title><source>Molecular Biology and Evolution</source><volume>33</volume><fpage>1635</fpage><lpage>1638</lpage><pub-id pub-id-type="doi">10.1093/molbev/msw046</pub-id><pub-id pub-id-type="pmid">26921390</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huerta-Sánchez</surname> <given-names>E</given-names></name><name><surname>Jin</surname> <given-names>X</given-names></name><name><surname>Asan</surname></name> <name><surname>Bianba</surname> <given-names>Z</given-names></name><name><surname>Peter</surname> <given-names>BM</given-names></name><name><surname>Vinckenbosch</surname> <given-names>N</given-names></name><name><surname>Liang</surname> <given-names>Y</given-names></name><name><surname>Yi</surname> <given-names>X</given-names></name><name><surname>He</surname> <given-names>M</given-names></name><name><surname>Somel</surname> <given-names>M</given-names></name><name><surname>Ni</surname> <given-names>P</given-names></name><name><surname>Wang</surname> <given-names>B</given-names></name><name><surname>Ou</surname> <given-names>X</given-names></name><name><surname>Huasang</surname></name> <name><surname>Luosang</surname> <given-names>J</given-names></name><name><surname>Cuo</surname> <given-names>ZX</given-names></name><name><surname>Li</surname> <given-names>K</given-names></name><name><surname>Gao</surname> <given-names>G</given-names></name><name><surname>Yin</surname> <given-names>Y</given-names></name><name><surname>Wang</surname> <given-names>W</given-names></name><name><surname>Zhang</surname> <given-names>X</given-names></name><name><surname>Xu</surname> <given-names>X</given-names></name><name><surname>Yang</surname> <given-names>H</given-names></name><name><surname>Li</surname> <given-names>Y</given-names></name><name><surname>Wang</surname> <given-names>J</given-names></name><name><surname>Wang</surname> <given-names>J</given-names></name><name><surname>Nielsen</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Altitude adaptation in Tibetans caused by introgression of Denisovan-like DNA</article-title><source>Nature</source><volume>512</volume><fpage>194</fpage><lpage>197</lpage><pub-id pub-id-type="doi">10.1038/nature13408</pub-id><pub-id pub-id-type="pmid">25043035</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Joly</surname> <given-names>S</given-names></name><name><surname>McLenachan</surname> <given-names>PA</given-names></name><name><surname>Lockhart</surname> <given-names>PJ</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>A statistical approach for distinguishing hybridization and incomplete lineage sorting</article-title><source>The American Naturalist</source><volume>174</volume><fpage>E54</fpage><lpage>E70</lpage><pub-id pub-id-type="doi">10.1086/600082</pub-id><pub-id pub-id-type="pmid">19519219</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname> <given-names>MR</given-names></name><name><surname>Mills</surname> <given-names>LS</given-names></name><name><surname>Alves</surname> <given-names>PC</given-names></name><name><surname>Callahan</surname> <given-names>CM</given-names></name><name><surname>Alves</surname> <given-names>JM</given-names></name><name><surname>Lafferty</surname> <given-names>DJR</given-names></name><name><surname>Jiggins</surname> <given-names>FM</given-names></name><name><surname>Jensen</surname> <given-names>JD</given-names></name><name><surname>Melo-Ferreira</surname> <given-names>J</given-names></name><name><surname>Good</surname> <given-names>JM</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Adaptive introgression underlies polymorphic seasonal camouflage in snowshoe hares</article-title><source>Science</source><volume>360</volume><fpage>1355</fpage><lpage>1358</lpage><pub-id pub-id-type="doi">10.1126/science.aar5273</pub-id><pub-id pub-id-type="pmid">29930138</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Joron</surname> <given-names>M</given-names></name><name><surname>Papa</surname> <given-names>R</given-names></name><name><surname>Beltrán</surname> <given-names>M</given-names></name><name><surname>Chamberlain</surname> <given-names>N</given-names></name><name><surname>Mavárez</surname> <given-names>J</given-names></name><name><surname>Baxter</surname> <given-names>S</given-names></name><name><surname>Abanto</surname> <given-names>M</given-names></name><name><surname>Bermingham</surname> <given-names>E</given-names></name><name><surname>Humphray</surname> <given-names>SJ</given-names></name><name><surname>Rogers</surname> <given-names>J</given-names></name><name><surname>Beasley</surname> <given-names>H</given-names></name><name><surname>Barlow</surname> <given-names>K</given-names></name><name><surname>ffrench-Constant</surname> <given-names>RH</given-names></name><name><surname>Mallet</surname> <given-names>J</given-names></name><name><surname>McMillan</surname> <given-names>WO</given-names></name><name><surname>Jiggins</surname> <given-names>CD</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>A conserved supergene locus controls colour pattern diversity in <italic>Heliconius</italic> butterflies</article-title><source>PLOS Biology</source><volume>4</volume><elocation-id>e303</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.0040303</pub-id><pub-id pub-id-type="pmid">17002517</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karimi</surname> <given-names>N</given-names></name><name><surname>Grover</surname> <given-names>CE</given-names></name><name><surname>Gallagher</surname> <given-names>JP</given-names></name><name><surname>Wendel</surname> <given-names>JF</given-names></name><name><surname>Ané</surname> <given-names>C</given-names></name><name><surname>Baum</surname> <given-names>DA</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Reticulate evolution helps explain apparent homoplasy in floral biology and pollination in baobabs (<italic>Adansonia</italic>; Bombacoideae; Malvaceae)</article-title><source>Systematic Biology</source><volume>69</volume><fpage>462</fpage><lpage>478</lpage><pub-id pub-id-type="doi">10.1093/sysbio/syz073</pub-id><pub-id pub-id-type="pmid">31693158</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kern</surname> <given-names>AD</given-names></name><name><surname>Hahn</surname> <given-names>MW</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>The neutral theory in light of natural selection</article-title><source>Molecular Biology and Evolution</source><volume>35</volume><fpage>1366</fpage><lpage>1371</lpage><pub-id pub-id-type="doi">10.1093/molbev/msy092</pub-id><pub-id pub-id-type="pmid">29722831</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lamichhaney</surname> <given-names>S</given-names></name><name><surname>Han</surname> <given-names>F</given-names></name><name><surname>Berglund</surname> <given-names>J</given-names></name><name><surname>Wang</surname> <given-names>C</given-names></name><name><surname>Almén</surname> <given-names>MS</given-names></name><name><surname>Webster</surname> <given-names>MT</given-names></name><name><surname>Grant</surname> <given-names>BR</given-names></name><name><surname>Grant</surname> <given-names>PR</given-names></name><name><surname>Andersson</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>A beak size locus in Darwin's finches facilitated character displacement during a drought</article-title><source>Science</source><volume>352</volume><fpage>470</fpage><lpage>474</lpage><pub-id pub-id-type="doi">10.1126/science.aad8786</pub-id><pub-id pub-id-type="pmid">27102486</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname> <given-names>KM</given-names></name><name><surname>Coop</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Distinguishing among modes of convergent adaptation using population genomic data</article-title><source>Genetics</source><volume>207(4)</volume><fpage>1591</fpage><lpage>1619</lpage><pub-id pub-id-type="doi">10.1534/genetics.117.300417</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname> <given-names>L</given-names></name><name><surname>Yu</surname> <given-names>L</given-names></name><name><surname>Edwards</surname> <given-names>SV</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>A maximum pseudo-likelihood approach for estimating species trees under the coalescent model</article-title><source>BMC Evolutionary Biology</source><volume>10</volume><elocation-id>302</elocation-id><pub-id pub-id-type="doi">10.1186/1471-2148-10-302</pub-id><pub-id pub-id-type="pmid">20937096</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname> <given-names>KJ</given-names></name><name><surname>Dai</surname> <given-names>J</given-names></name><name><surname>Truong</surname> <given-names>K</given-names></name><name><surname>Song</surname> <given-names>Y</given-names></name><name><surname>Kohn</surname> <given-names>MH</given-names></name><name><surname>Nakhleh</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>An HMM-based comparative genomic framework for detecting introgression in eukaryotes</article-title><source>PLOS Computational Biology</source><volume>10</volume><elocation-id>e1003649</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003649</pub-id><pub-id pub-id-type="pmid">24922281</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lynch</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>The origins of eukaryotic gene structure</article-title><source>Molecular Biology and Evolution</source><volume>23</volume><fpage>450</fpage><lpage>468</lpage><pub-id pub-id-type="doi">10.1093/molbev/msj050</pub-id><pub-id pub-id-type="pmid">16280547</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lynch</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Evolution of the mutation rate</article-title><source>Trends in Genetics</source><volume>26</volume><fpage>345</fpage><lpage>352</lpage><pub-id pub-id-type="doi">10.1016/j.tig.2010.05.003</pub-id><pub-id pub-id-type="pmid">20594608</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mallet</surname> <given-names>J</given-names></name><name><surname>Besansky</surname> <given-names>N</given-names></name><name><surname>Hahn</surname> <given-names>MW</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>How reticulated are species?</article-title><source>BioEssays</source><volume>38</volume><fpage>140</fpage><lpage>149</lpage><pub-id pub-id-type="doi">10.1002/bies.201500149</pub-id><pub-id pub-id-type="pmid">26709836</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martin</surname> <given-names>SH</given-names></name><name><surname>Möst</surname> <given-names>M</given-names></name><name><surname>Palmer</surname> <given-names>WJ</given-names></name><name><surname>Salazar</surname> <given-names>C</given-names></name><name><surname>McMillan</surname> <given-names>WO</given-names></name><name><surname>Jiggins</surname> <given-names>FM</given-names></name><name><surname>Jiggins</surname> <given-names>CD</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Natural selection and genetic diversity in the butterfly <italic>Heliconius melpomene</italic></article-title><source>Genetics</source><volume>203</volume><fpage>525</fpage><lpage>541</lpage><pub-id pub-id-type="doi">10.1534/genetics.115.183285</pub-id><pub-id pub-id-type="pmid">27017626</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mendes</surname> <given-names>FK</given-names></name><name><surname>Hahn</surname> <given-names>Y</given-names></name><name><surname>Hahn</surname> <given-names>MW</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Gene tree discordance can generate patterns of diminishing convergence over time</article-title><source>Molecular Biology and Evolution</source><volume>33</volume><fpage>3299</fpage><lpage>3307</lpage><pub-id pub-id-type="doi">10.1093/molbev/msw197</pub-id><pub-id pub-id-type="pmid">27634870</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mendes</surname> <given-names>FK</given-names></name><name><surname>Fuentes-González</surname> <given-names>JA</given-names></name><name><surname>Schraiber</surname> <given-names>JG</given-names></name><name><surname>Hahn</surname> <given-names>MW</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A multispecies coalescent model for quantitative traits</article-title><source>eLife</source><volume>7</volume><elocation-id>e36482</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.36482</pub-id><pub-id pub-id-type="pmid">29969096</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mendes</surname> <given-names>FK</given-names></name><name><surname>Hahn</surname> <given-names>MW</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Gene tree discordance causes apparent substitution rate variation</article-title><source>Systematic Biology</source><volume>65</volume><fpage>711</fpage><lpage>721</lpage><pub-id pub-id-type="doi">10.1093/sysbio/syw018</pub-id><pub-id pub-id-type="pmid">26927960</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meng</surname> <given-names>C</given-names></name><name><surname>Kubatko</surname> <given-names>LS</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Detecting hybrid speciation in the presence of incomplete lineage sorting using gene tree incongruence: a model</article-title><source>Theoretical Population Biology</source><volume>75</volume><fpage>35</fpage><lpage>45</lpage><pub-id pub-id-type="doi">10.1016/j.tpb.2008.10.004</pub-id><pub-id pub-id-type="pmid">19038278</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Minh</surname> <given-names>BQ</given-names></name><name><surname>Hahn</surname> <given-names>MW</given-names></name><name><surname>Lanfear</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2020">2020a</year><article-title>New methods to calculate concordance factors for phylogenomic datasets</article-title><source>Molecular Biology and Evolution</source><volume>37</volume><fpage>2727</fpage><lpage>2733</lpage><pub-id pub-id-type="doi">10.1093/molbev/msaa106</pub-id><pub-id pub-id-type="pmid">32365179</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Minh</surname> <given-names>BQ</given-names></name><name><surname>Schmidt</surname> <given-names>HA</given-names></name><name><surname>Chernomor</surname> <given-names>O</given-names></name><name><surname>Schrempf</surname> <given-names>D</given-names></name><name><surname>Woodhams</surname> <given-names>MD</given-names></name><name><surname>von Haeseler</surname> <given-names>A</given-names></name><name><surname>Lanfear</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2020">2020b</year><article-title>IQ-TREE 2: new models and efficient methods for phylogenetic inference in the genomic era</article-title><source>Molecular Biology and Evolution</source><volume>37</volume><fpage>1530</fpage><lpage>1534</lpage><pub-id pub-id-type="doi">10.1093/molbev/msaa015</pub-id><pub-id pub-id-type="pmid">32011700</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Misof</surname> <given-names>B</given-names></name><name><surname>Liu</surname> <given-names>S</given-names></name><name><surname>Meusemann</surname> <given-names>K</given-names></name><name><surname>Peters</surname> <given-names>RS</given-names></name><name><surname>Donath</surname> <given-names>A</given-names></name><name><surname>Mayer</surname> <given-names>C</given-names></name><name><surname>Frandsen</surname> <given-names>PB</given-names></name><name><surname>Ware</surname> <given-names>J</given-names></name><name><surname>Flouri</surname> <given-names>T</given-names></name><name><surname>Beutel</surname> <given-names>RG</given-names></name><name><surname>Niehuis</surname> <given-names>O</given-names></name><name><surname>Petersen</surname> <given-names>M</given-names></name><name><surname>Izquierdo-Carrasco</surname> <given-names>F</given-names></name><name><surname>Wappler</surname> <given-names>T</given-names></name><name><surname>Rust</surname> <given-names>J</given-names></name><name><surname>Aberer</surname> <given-names>AJ</given-names></name><name><surname>Aspöck</surname> <given-names>U</given-names></name><name><surname>Aspöck</surname> <given-names>H</given-names></name><name><surname>Bartel</surname> <given-names>D</given-names></name><name><surname>Blanke</surname> <given-names>A</given-names></name><name><surname>Berger</surname> <given-names>S</given-names></name><name><surname>Böhm</surname> <given-names>A</given-names></name><name><surname>Buckley</surname> <given-names>TR</given-names></name><name><surname>Calcott</surname> <given-names>B</given-names></name><name><surname>Chen</surname> <given-names>J</given-names></name><name><surname>Friedrich</surname> <given-names>F</given-names></name><name><surname>Fukui</surname> <given-names>M</given-names></name><name><surname>Fujita</surname> <given-names>M</given-names></name><name><surname>Greve</surname> <given-names>C</given-names></name><name><surname>Grobe</surname> <given-names>P</given-names></name><name><surname>Gu</surname> <given-names>S</given-names></name><name><surname>Huang</surname> <given-names>Y</given-names></name><name><surname>Jermiin</surname> <given-names>LS</given-names></name><name><surname>Kawahara</surname> <given-names>AY</given-names></name><name><surname>Krogmann</surname> <given-names>L</given-names></name><name><surname>Kubiak</surname> <given-names>M</given-names></name><name><surname>Lanfear</surname> <given-names>R</given-names></name><name><surname>Letsch</surname> <given-names>H</given-names></name><name><surname>Li</surname> <given-names>Y</given-names></name><name><surname>Li</surname> <given-names>Z</given-names></name><name><surname>Li</surname> <given-names>J</given-names></name><name><surname>Lu</surname> <given-names>H</given-names></name><name><surname>Machida</surname> <given-names>R</given-names></name><name><surname>Mashimo</surname> <given-names>Y</given-names></name><name><surname>Kapli</surname> <given-names>P</given-names></name><name><surname>McKenna</surname> <given-names>DD</given-names></name><name><surname>Meng</surname> <given-names>G</given-names></name><name><surname>Nakagaki</surname> <given-names>Y</given-names></name><name><surname>Navarrete-Heredia</surname> <given-names>JL</given-names></name><name><surname>Ott</surname> <given-names>M</given-names></name><name><surname>Ou</surname> <given-names>Y</given-names></name><name><surname>Pass</surname> <given-names>G</given-names></name><name><surname>Podsiadlowski</surname> <given-names>L</given-names></name><name><surname>Pohl</surname> <given-names>H</given-names></name><name><surname>von Reumont</surname> <given-names>BM</given-names></name><name><surname>Schütte</surname> <given-names>K</given-names></name><name><surname>Sekiya</surname> <given-names>K</given-names></name><name><surname>Shimizu</surname> <given-names>S</given-names></name><name><surname>Slipinski</surname> <given-names>A</given-names></name><name><surname>Stamatakis</surname> <given-names>A</given-names></name><name><surname>Song</surname> <given-names>W</given-names></name><name><surname>Su</surname> <given-names>X</given-names></name><name><surname>Szucsich</surname> <given-names>NU</given-names></name><name><surname>Tan</surname> <given-names>M</given-names></name><name><surname>Tan</surname> <given-names>X</given-names></name><name><surname>Tang</surname> <given-names>M</given-names></name><name><surname>Tang</surname> <given-names>J</given-names></name><name><surname>Timelthaler</surname> <given-names>G</given-names></name><name><surname>Tomizuka</surname> <given-names>S</given-names></name><name><surname>Trautwein</surname> <given-names>M</given-names></name><name><surname>Tong</surname> <given-names>X</given-names></name><name><surname>Uchifune</surname> <given-names>T</given-names></name><name><surname>Walzl</surname> <given-names>MG</given-names></name><name><surname>Wiegmann</surname> <given-names>BM</given-names></name><name><surname>Wilbrandt</surname> <given-names>J</given-names></name><name><surname>Wipfler</surname> <given-names>B</given-names></name><name><surname>Wong</surname> <given-names>TK</given-names></name><name><surname>Wu</surname> <given-names>Q</given-names></name><name><surname>Wu</surname> <given-names>G</given-names></name><name><surname>Xie</surname> <given-names>Y</given-names></name><name><surname>Yang</surname> <given-names>S</given-names></name><name><surname>Yang</surname> <given-names>Q</given-names></name><name><surname>Yeates</surname> <given-names>DK</given-names></name><name><surname>Yoshizawa</surname> <given-names>K</given-names></name><name><surname>Zhang</surname> <given-names>Q</given-names></name><name><surname>Zhang</surname> <given-names>R</given-names></name><name><surname>Zhang</surname> <given-names>W</given-names></name><name><surname>Zhang</surname> <given-names>Y</given-names></name><name><surname>Zhao</surname> <given-names>J</given-names></name><name><surname>Zhou</surname> <given-names>C</given-names></name><name><surname>Zhou</surname> <given-names>L</given-names></name><name><surname>Ziesmann</surname> <given-names>T</given-names></name><name><surname>Zou</surname> <given-names>S</given-names></name><name><surname>Li</surname> <given-names>Y</given-names></name><name><surname>Xu</surname> <given-names>X</given-names></name><name><surname>Zhang</surname> <given-names>Y</given-names></name><name><surname>Yang</surname> <given-names>H</given-names></name><name><surname>Wang</surname> <given-names>J</given-names></name><name><surname>Wang</surname> <given-names>J</given-names></name><name><surname>Kjer</surname> <given-names>KM</given-names></name><name><surname>Zhou</surname> <given-names>X</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Phylogenomics resolves the timing and pattern of insect evolution</article-title><source>Science</source><volume>346</volume><fpage>763</fpage><lpage>767</lpage><pub-id pub-id-type="doi">10.1126/science.1257570</pub-id><pub-id pub-id-type="pmid">25378627</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mullen</surname> <given-names>SP</given-names></name><name><surname>VanKuren</surname> <given-names>NW</given-names></name><name><surname>Zhang</surname> <given-names>W</given-names></name><name><surname>Nallu</surname> <given-names>S</given-names></name><name><surname>Kristiansen</surname> <given-names>EB</given-names></name><name><surname>Wuyun</surname> <given-names>Q</given-names></name><name><surname>Liu</surname> <given-names>K</given-names></name><name><surname>Hill</surname> <given-names>RI</given-names></name><name><surname>Briscoe</surname> <given-names>AD</given-names></name><name><surname>Kronforst</surname> <given-names>MR</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Disentangling population history and character evolution among hybridizing lineages</article-title><source>Molecular Biology and Evolution</source><volume>37</volume><fpage>1295</fpage><lpage>1305</lpage><pub-id pub-id-type="doi">10.1093/molbev/msaa004</pub-id><pub-id pub-id-type="pmid">31930401</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nadeau</surname> <given-names>NJ</given-names></name><name><surname>Pardo-Diaz</surname> <given-names>C</given-names></name><name><surname>Whibley</surname> <given-names>A</given-names></name><name><surname>Supple</surname> <given-names>MA</given-names></name><name><surname>Saenko</surname> <given-names>SV</given-names></name><name><surname>Wallbank</surname> <given-names>RW</given-names></name><name><surname>Wu</surname> <given-names>GC</given-names></name><name><surname>Maroja</surname> <given-names>L</given-names></name><name><surname>Ferguson</surname> <given-names>L</given-names></name><name><surname>Hanly</surname> <given-names>JJ</given-names></name><name><surname>Hines</surname> <given-names>H</given-names></name><name><surname>Salazar</surname> <given-names>C</given-names></name><name><surname>Merrill</surname> <given-names>RM</given-names></name><name><surname>Dowling</surname> <given-names>AJ</given-names></name><name><surname>ffrench-Constant</surname> <given-names>RH</given-names></name><name><surname>Llaurens</surname> <given-names>V</given-names></name><name><surname>Joron</surname> <given-names>M</given-names></name><name><surname>McMillan</surname> <given-names>WO</given-names></name><name><surname>Jiggins</surname> <given-names>CD</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The gene <italic>cortex</italic> controls mimicry and crypsis in butterflies and moths</article-title><source>Nature</source><volume>534</volume><fpage>106</fpage><lpage>110</lpage><pub-id pub-id-type="doi">10.1038/nature17961</pub-id><pub-id pub-id-type="pmid">27251285</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Novikova</surname> <given-names>PY</given-names></name><name><surname>Hohmann</surname> <given-names>N</given-names></name><name><surname>Nizhynska</surname> <given-names>V</given-names></name><name><surname>Tsuchimatsu</surname> <given-names>T</given-names></name><name><surname>Ali</surname> <given-names>J</given-names></name><name><surname>Muir</surname> <given-names>G</given-names></name><name><surname>Guggisberg</surname> <given-names>A</given-names></name><name><surname>Paape</surname> <given-names>T</given-names></name><name><surname>Schmid</surname> <given-names>K</given-names></name><name><surname>Fedorenko</surname> <given-names>OM</given-names></name><name><surname>Holm</surname> <given-names>S</given-names></name><name><surname>Säll</surname> <given-names>T</given-names></name><name><surname>Schlötterer</surname> <given-names>C</given-names></name><name><surname>Marhold</surname> <given-names>K</given-names></name><name><surname>Widmer</surname> <given-names>A</given-names></name><name><surname>Sese</surname> <given-names>J</given-names></name><name><surname>Shimizu</surname> <given-names>KK</given-names></name><name><surname>Weigel</surname> <given-names>D</given-names></name><name><surname>Krämer</surname> <given-names>U</given-names></name><name><surname>Koch</surname> <given-names>MA</given-names></name><name><surname>Nordborg</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Sequencing of the genus <italic>Arabidopsis</italic> identifies a complex history of nonbifurcating speciation and abundant trans-specific polymorphism</article-title><source>Nature Genetics</source><volume>48</volume><fpage>1077</fpage><lpage>1082</lpage><pub-id pub-id-type="doi">10.1038/ng.3617</pub-id><pub-id pub-id-type="pmid">27428747</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Palesch</surname> <given-names>D</given-names></name><name><surname>Bosinger</surname> <given-names>SE</given-names></name><name><surname>Tharp</surname> <given-names>GK</given-names></name><name><surname>Vanderford</surname> <given-names>TH</given-names></name><name><surname>Paiardini</surname> <given-names>M</given-names></name><name><surname>Chahroudi</surname> <given-names>A</given-names></name><name><surname>Johnson</surname> <given-names>ZP</given-names></name><name><surname>Kirchhoff</surname> <given-names>F</given-names></name><name><surname>Hahn</surname> <given-names>BH</given-names></name><name><surname>Norgren</surname> <given-names>RB</given-names></name><name><surname>Patel</surname> <given-names>NB</given-names></name><name><surname>Sodora</surname> <given-names>DL</given-names></name><name><surname>Dawoud</surname> <given-names>RA</given-names></name><name><surname>Stewart</surname> <given-names>CB</given-names></name><name><surname>Seepo</surname> <given-names>SM</given-names></name><name><surname>Harris</surname> <given-names>RA</given-names></name><name><surname>Liu</surname> <given-names>Y</given-names></name><name><surname>Raveendran</surname> <given-names>M</given-names></name><name><surname>Han</surname> <given-names>Y</given-names></name><name><surname>English</surname> <given-names>A</given-names></name><name><surname>Thomas</surname> <given-names>GWC</given-names></name><name><surname>Hahn</surname> <given-names>MW</given-names></name><name><surname>Pipes</surname> <given-names>L</given-names></name><name><surname>Mason</surname> <given-names>CE</given-names></name><name><surname>Muzny</surname> <given-names>DM</given-names></name><name><surname>Gibbs</surname> <given-names>RA</given-names></name><name><surname>Sauter</surname> <given-names>D</given-names></name><name><surname>Worley</surname> <given-names>K</given-names></name><name><surname>Rogers</surname> <given-names>J</given-names></name><name><surname>Silvestri</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Sooty mangabey genome sequence provides insight into AIDS resistance in a natural SIV host</article-title><source>Nature</source><volume>553</volume><fpage>77</fpage><lpage>81</lpage><pub-id pub-id-type="doi">10.1038/nature25140</pub-id><pub-id pub-id-type="pmid">29300007</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pamilo</surname> <given-names>P</given-names></name><name><surname>Nei</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1988">1988</year><article-title>Relationships between gene trees and species trees</article-title><source>Molecular Biology and Evolution</source><volume>5</volume><fpage>568</fpage><lpage>583</lpage><pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a040517</pub-id><pub-id pub-id-type="pmid">3193878</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patterson</surname> <given-names>N</given-names></name><name><surname>Moorjani</surname> <given-names>P</given-names></name><name><surname>Luo</surname> <given-names>Y</given-names></name><name><surname>Mallick</surname> <given-names>S</given-names></name><name><surname>Rohland</surname> <given-names>N</given-names></name><name><surname>Zhan</surname> <given-names>Y</given-names></name><name><surname>Genschoreck</surname> <given-names>T</given-names></name><name><surname>Webster</surname> <given-names>T</given-names></name><name><surname>Reich</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Ancient admixture in human history</article-title><source>Genetics</source><volume>192</volume><fpage>1065</fpage><lpage>1093</lpage><pub-id pub-id-type="doi">10.1534/genetics.112.145037</pub-id><pub-id pub-id-type="pmid">22960212</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pease</surname> <given-names>JB</given-names></name><name><surname>Haak</surname> <given-names>DC</given-names></name><name><surname>Hahn</surname> <given-names>MW</given-names></name><name><surname>Moyle</surname> <given-names>LC</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Phylogenomics reveals three sources of adaptive variation during a rapid radiation</article-title><source>PLOS Biology</source><volume>14</volume><elocation-id>e1002379</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1002379</pub-id><pub-id pub-id-type="pmid">26871574</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pease</surname> <given-names>JB</given-names></name><name><surname>Hahn</surname> <given-names>MW</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Detection and polarization of introgression in a five-taxon phylogeny</article-title><source>Systematic Biology</source><volume>64</volume><fpage>651</fpage><lpage>662</lpage><pub-id pub-id-type="doi">10.1093/sysbio/syv023</pub-id><pub-id pub-id-type="pmid">25888025</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pollard</surname> <given-names>DA</given-names></name><name><surname>Iyer</surname> <given-names>VN</given-names></name><name><surname>Moses</surname> <given-names>AM</given-names></name><name><surname>Eisen</surname> <given-names>MB</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Widespread discordance of gene trees with species tree in <italic>Drosophila</italic>: evidence for incomplete lineage sorting</article-title><source>PLOS Genetics</source><volume>2</volume><elocation-id>e173</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.0020173</pub-id><pub-id pub-id-type="pmid">17132051</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rambaut</surname> <given-names>A</given-names></name><name><surname>Grassly</surname> <given-names>NC</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Seq-Gen: an application for the Monte Carlo simulation of DNA sequence evolution along phylogenetic trees</article-title><source>Bioinformatics</source><volume>13</volume><fpage>235</fpage><lpage>238</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/13.3.235</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rausher</surname> <given-names>MD</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Evolutionary transitions in floral color</article-title><source>International Journal of Plant Sciences</source><volume>169</volume><fpage>7</fpage><lpage>21</lpage><pub-id pub-id-type="doi">10.1086/523358</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reich</surname> <given-names>D</given-names></name><name><surname>Thangaraj</surname> <given-names>K</given-names></name><name><surname>Patterson</surname> <given-names>N</given-names></name><name><surname>Price</surname> <given-names>AL</given-names></name><name><surname>Singh</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Reconstructing indian population history</article-title><source>Nature</source><volume>461</volume><fpage>489</fpage><lpage>494</lpage><pub-id pub-id-type="doi">10.1038/nature08365</pub-id><pub-id pub-id-type="pmid">19779445</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rodriguez</surname> <given-names>ZB</given-names></name><name><surname>Perkins</surname> <given-names>SL</given-names></name><name><surname>Austin</surname> <given-names>CC</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Multiple origins of green blood in New Guinea lizards</article-title><source>Science Advances</source><volume>4</volume><elocation-id>eaao5017</elocation-id><pub-id pub-id-type="doi">10.1126/sciadv.aao5017</pub-id><pub-id pub-id-type="pmid">29774232</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Schrempf</surname> <given-names>D</given-names></name><name><surname>Szöllősi</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2020">2020</year><chapter-title>The sources of phylogenetic conflicts</chapter-title><person-group person-group-type="editor"><name><surname>Celine</surname> <given-names>S</given-names></name><name><surname>Delsuc</surname> <given-names>F</given-names></name><name><surname>Nicolas</surname> <given-names>G</given-names></name></person-group><source>Phylogenetics in the Genomic Era</source><publisher-name>Self published</publisher-name><fpage>3.1:1 </fpage><lpage>3.1:23</lpage></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname> <given-names>SD</given-names></name><name><surname>Rausher</surname> <given-names>MD</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Gene loss and parallel evolution contribute to species difference in flower color</article-title><source>Molecular Biology and Evolution</source><volume>28</volume><fpage>2799</fpage><lpage>2810</lpage><pub-id pub-id-type="doi">10.1093/molbev/msr109</pub-id><pub-id pub-id-type="pmid">21551271</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Solís-Lemus</surname> <given-names>C</given-names></name><name><surname>Ané</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Inferring phylogenetic networks with maximum pseudolikelihood under incomplete lineage sorting</article-title><source>PLOS Genetics</source><volume>12</volume><elocation-id>e1005896</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1005896</pub-id><pub-id pub-id-type="pmid">26950302</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stamatakis</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>RAxML version 8: a tool for phylogenetic analysis and post-analysis of large phylogenies</article-title><source>Bioinformatics</source><volume>30</volume><fpage>1312</fpage><lpage>1313</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btu033</pub-id><pub-id pub-id-type="pmid">24451623</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Storz</surname> <given-names>JF</given-names></name><name><surname>Runck</surname> <given-names>AM</given-names></name><name><surname>Sabatino</surname> <given-names>SJ</given-names></name><name><surname>Kelly</surname> <given-names>JK</given-names></name><name><surname>Ferrand</surname> <given-names>N</given-names></name><name><surname>Moriyama</surname> <given-names>H</given-names></name><name><surname>Weber</surname> <given-names>RE</given-names></name><name><surname>Fago</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Evolutionary and functional insights into the mechanism underlying high-altitude adaptation of deer mouse hemoglobin</article-title><source>PNAS</source><volume>106</volume><fpage>14450</fpage><lpage>14455</lpage><pub-id pub-id-type="doi">10.1073/pnas.0905224106</pub-id><pub-id pub-id-type="pmid">19667207</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Storz</surname> <given-names>JF</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Causes of molecular convergence and parallelism in protein evolution</article-title><source>Nature Reviews Genetics</source><volume>17</volume><fpage>239</fpage><lpage>250</lpage><pub-id pub-id-type="doi">10.1038/nrg.2016.11</pub-id><pub-id pub-id-type="pmid">26972590</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tufts</surname> <given-names>DM</given-names></name><name><surname>Natarajan</surname> <given-names>C</given-names></name><name><surname>Revsbech</surname> <given-names>IG</given-names></name><name><surname>Projecto-Garcia</surname> <given-names>J</given-names></name><name><surname>Hoffmann</surname> <given-names>FG</given-names></name><name><surname>Weber</surname> <given-names>RE</given-names></name><name><surname>Fago</surname> <given-names>A</given-names></name><name><surname>Moriyama</surname> <given-names>H</given-names></name><name><surname>Storz</surname> <given-names>JF</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Epistasis constrains mutational pathways of hemoglobin adaptation in high-altitude pikas</article-title><source>Molecular Biology and Evolution</source><volume>32</volume><fpage>287</fpage><lpage>298</lpage><pub-id pub-id-type="doi">10.1093/molbev/msu311</pub-id><pub-id pub-id-type="pmid">25415962</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vanderpool</surname> <given-names>D</given-names></name><name><surname>Minh</surname> <given-names>BQ</given-names></name><name><surname>Lanfear</surname> <given-names>R</given-names></name><name><surname>Hughes</surname> <given-names>D</given-names></name><name><surname>Murali</surname> <given-names>S</given-names></name><name><surname>Harris</surname> <given-names>RA</given-names></name><name><surname>Raveendran</surname> <given-names>M</given-names></name><name><surname>Muzny</surname> <given-names>DM</given-names></name><name><surname>Hibbins</surname> <given-names>MS</given-names></name><name><surname>Williamson</surname> <given-names>RJ</given-names></name><name><surname>Gibbs</surname> <given-names>RA</given-names></name><name><surname>Worley</surname> <given-names>KC</given-names></name><name><surname>Rogers</surname> <given-names>J</given-names></name><name><surname>Hahn</surname> <given-names>MW</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Primate phylogenomics uncovers multiple rapid radiations and ancient interspecific introgression</article-title><source>PLOS Biology</source><volume>18</volume><elocation-id>e3000954</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.3000954</pub-id><pub-id pub-id-type="pmid">33270638</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Wang</surname> <given-names>Y</given-names></name><name><surname>Cao</surname> <given-names>Z</given-names></name><name><surname>Ogilvie</surname> <given-names>HW</given-names></name><name><surname>Nakhleh</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Phylogenomic assessment of the role of hybridization and introgression in trait evolution</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2020.09.16.300343</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wen</surname> <given-names>D</given-names></name><name><surname>Yu</surname> <given-names>Y</given-names></name><name><surname>Nakhleh</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Bayesian inference of reticulate phylogenies under the multispecies network coalescent</article-title><source>PLOS Genetics</source><volume>12</volume><elocation-id>e1006006</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1006006</pub-id><pub-id pub-id-type="pmid">27144273</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wen</surname> <given-names>D</given-names></name><name><surname>Yu</surname> <given-names>Y</given-names></name><name><surname>Zhu</surname> <given-names>J</given-names></name><name><surname>Nakhleh</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Inferring phylogenetic networks using PhyloNet</article-title><source>Systematic Biology</source><volume>67</volume><fpage>735</fpage><lpage>740</lpage><pub-id pub-id-type="doi">10.1093/sysbio/syy015</pub-id><pub-id pub-id-type="pmid">29514307</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname> <given-names>M</given-names></name><name><surname>Kostyun</surname> <given-names>JL</given-names></name><name><surname>Hahn</surname> <given-names>MW</given-names></name><name><surname>Moyle</surname> <given-names>LC</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Dissecting the basis of novel trait evolution in a radiation with widespread phylogenetic discordance</article-title><source>Molecular Ecology</source><volume>27</volume><fpage>3301</fpage><lpage>3316</lpage><pub-id pub-id-type="doi">10.1111/mec.14780</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname> <given-names>Y</given-names></name><name><surname>Degnan</surname> <given-names>JH</given-names></name><name><surname>Nakhleh</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The probability of a gene tree topology within a phylogenetic network with applications to hybridization detection</article-title><source>PLOS Genetics</source><volume>8</volume><elocation-id>e1002660</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1002660</pub-id><pub-id pub-id-type="pmid">22536161</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname> <given-names>Y</given-names></name><name><surname>Dong</surname> <given-names>J</given-names></name><name><surname>Liu</surname> <given-names>KJ</given-names></name><name><surname>Nakhleh</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Maximum likelihood inference of reticulate evolutionary histories</article-title><source>PNAS</source><volume>111</volume><fpage>16448</fpage><lpage>16453</lpage><pub-id pub-id-type="doi">10.1073/pnas.1407950111</pub-id><pub-id pub-id-type="pmid">25368173</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname> <given-names>C</given-names></name><name><surname>Ogilvie</surname> <given-names>HA</given-names></name><name><surname>Drummond</surname> <given-names>AJ</given-names></name><name><surname>Stadler</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2018">2018a</year><article-title>Bayesian inference of species networks from multilocus sequence data</article-title><source>Molecular Biology and Evolution</source><volume>35</volume><fpage>504</fpage><lpage>517</lpage><pub-id pub-id-type="doi">10.1093/molbev/msx307</pub-id><pub-id pub-id-type="pmid">29220490</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname> <given-names>C</given-names></name><name><surname>Rabiee</surname> <given-names>M</given-names></name><name><surname>Sayyari</surname> <given-names>E</given-names></name><name><surname>Mirarab</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018b</year><article-title>ASTRAL-III: polynomial time species tree reconstruction from partially resolved gene trees</article-title><source>BMC Bioinformatics</source><volume>19</volume><elocation-id>153</elocation-id><pub-id pub-id-type="doi">10.1186/s12859-018-2129-y</pub-id><pub-id pub-id-type="pmid">29745866</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><boxed-text><sec id="s8" sec-type="appendix"><title>1 Mutation probabilities on genealogies</title><p>Each of the twelve possible genealogies under our parent tree model has a set of five branch lengths along which mutations can occur. <inline-formula><mml:math id="inf9"><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf10"><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf11"><mml:msub><mml:mi>λ</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> denote the tip branches leading to species A, B, and C respectively; <inline-formula><mml:math id="inf12"><mml:msub><mml:mi>λ</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math></inline-formula> denotes the internal branch, and <inline-formula><mml:math id="inf13"><mml:msub><mml:mi>λ</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:math></inline-formula> denotes the ancestral branch. As described in the supplement of <xref ref-type="bibr" rid="bib20">Guerrero and Hahn, 2018</xref>, the mutation probability on each of these branches has the general form <inline-formula><mml:math id="inf14"><mml:mrow><mml:mrow><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, where µ is the mutation probability per <inline-formula><mml:math id="inf15"><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> generations, x is the random variable for the branch length, and f(x) is the probability density function for x. We begin with the mutation probabilities for parent tree 1, which are found in the supplement of Guerrero and Hahn, and will be re-written here to be consistent with notation. In the following notation, parent tree 1 will be denoted as &quot;pt1&quot;. Since many of the genealogies are identical in length, the mutation probabilities on their branches can be written with general expressions. We first consider the genealogies <inline-formula><mml:math id="inf16"><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mn>2</mml:mn><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf17"><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf18"><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, which are all produced via incomplete lineage sorting in parent tree 1, and share the following set of mutation probabilities:<disp-formula id="equ9"><label>(1)</label><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi mathvariant="normal">Λ</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ10"><label>(2)</label><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi mathvariant="normal">Λ</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>3</mml:mn><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ11"><label>(3)</label><mml:math id="m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mfrac><mml:mn>1</mml:mn><mml:mi mathvariant="normal">Λ</mml:mi></mml:mfrac><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mn>3</mml:mn><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mi>y</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ12"><label>(4)</label><mml:math id="m12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi mathvariant="normal">Λ</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>3</mml:mn><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>In each of the above, <inline-formula><mml:math id="inf19"><mml:mrow><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mfrac><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is the probability of coalescence of A, B, and C in their ancestral population. <italic>t</italic><sub>3</sub> denotes the total height of the tree, i.e. the time at the base of the tree. The difference between <italic>t</italic><sub>3</sub> and <italic>t</italic><sub>2</sub> determines the duration of the ancestral population of all three taxa, before speciation occurs. <xref ref-type="disp-formula" rid="equ9">Equations 1</xref> through four each represent the mutation probabilities for multiple branches, which are as follows:<disp-formula id="equ13"><label>(5)</label><mml:math id="m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mn>2</mml:mn><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ14"><label>(6)</label><mml:math id="m14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mn>2</mml:mn><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mn>2</mml:mn><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ15"><label>(7)</label><mml:math id="m15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mn>2</mml:mn><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ16"><label>(8)</label><mml:math id="m16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mn>2</mml:mn><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The gene tree produced by lineage sorting in parent tree 1, <inline-formula><mml:math id="inf20"><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mn>1</mml:mn><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, has a different set of mutation probabilities, since the branches have different expected lengths. These are:<disp-formula id="equ17"><label>(9)</label><mml:math id="m17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ18"><label>(10)</label><mml:math id="m18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ19"><label>(11)</label><mml:math id="m19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>y</mml:mi><mml:mo>+</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ20"><label>(12)</label><mml:math id="m20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Now we consider introgression, starting with parent tree 2. Many of the mutation probabilities are symmetrical with parent tree 1 and therefore remain the same, and the remainder have the same general form with different parameters. For the ILS genealogies <inline-formula><mml:math id="inf21"><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf22"><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf23"><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <xref ref-type="disp-formula" rid="equ9 equ10">Equations 1 and 2</xref> have the time of A-B speciation (<italic>t</italic><sub>1</sub>) replaced with the timing of B-C introgression (<italic>t</italic><sub><italic>m</italic></sub>). This gives:<disp-formula id="equ21"><label>(13)</label><mml:math id="m21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mn>2</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi mathvariant="normal">Λ</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ22"><label>(14)</label><mml:math id="m22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mn>2</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi mathvariant="normal">Λ</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>3</mml:mn><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ23"><label>(15)</label><mml:math id="m23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mn>2</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ24"><label>(16)</label><mml:math id="m24"><mml:mrow><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>These correspond to the following branch mutation probabilities:<disp-formula id="equ25"><label>(17)</label><mml:math id="m25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mn>2</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>2</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ26"><label>(18)</label><mml:math id="m26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mn>2</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>2</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>2</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ27"><label>(19)</label><mml:math id="m27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mn>2</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>2</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ28"><label>(20)</label><mml:math id="m28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mn>2</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>2</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>For the genealogy produced by lineage sorting in parent tree 2, <inline-formula><mml:math id="inf24"><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, we have:<disp-formula id="equ29"><label>(21)</label><mml:math id="m29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ30"><label>(22)</label><mml:math id="m30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ31"><label>(23)</label><mml:math id="m31"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>y</mml:mi><mml:mo>+</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ32"><label>(24)</label><mml:math id="m32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Finally, we consider parent tree 3. The mutation probabilities have the same formulation as parent tree 2, with two key changes: since parent tree 3 is shorter (<xref ref-type="fig" rid="fig2">Figure 2</xref> of main text), <italic>t</italic><sub>2</sub> is replaced by <italic>t</italic><sub>1</sub>. This also applies to the value of <inline-formula><mml:math id="inf25"><mml:mi mathvariant="normal">Λ</mml:mi></mml:math></inline-formula>, which we will denote for parent tree 3 as <inline-formula><mml:math id="inf26"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Λ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mfrac><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. For the ILS genealogies <inline-formula><mml:math id="inf27"><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf28"><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf29"><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, this gives:<disp-formula id="equ33"><label>(25)</label><mml:math id="m33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mn>3</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi mathvariant="normal">Λ</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ34"><label>(26)</label><mml:math id="m34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mn>3</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi mathvariant="normal">Λ</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>3</mml:mn><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ35"><label>(27)</label><mml:math id="m35"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mn>3</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi mathvariant="normal">Λ</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mn>3</mml:mn><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mi>y</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ36"><label>(28)</label><mml:math id="m36"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mn>3</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi mathvariant="normal">Λ</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>3</mml:mn><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Where:<disp-formula id="equ37"><label>(29)</label><mml:math id="m37"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mn>3</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>2</mml:mn><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ38"><label>(30)</label><mml:math id="m38"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mn>3</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>2</mml:mn><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>2</mml:mn><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ39"><label>(31)</label><mml:math id="m39"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mn>3</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>2</mml:mn><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ40"><label>(32)</label><mml:math id="m40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mn>3</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>2</mml:mn><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Finally, for the genealogy <inline-formula><mml:math id="inf30"><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, the mutation probabilities are as follows:<disp-formula id="equ41"><label>(33)</label><mml:math id="m41"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ42"><label>(34)</label><mml:math id="m42"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ43"><label>(35)</label><mml:math id="m43"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>y</mml:mi><mml:mo>+</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ44"><label>(36)</label><mml:math id="m44"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula></p></sec><sec id="s9" sec-type="appendix"><title>2 When does introgression makes hemiplasy more likely than ILS alone?</title><p>The probability of hemiplasy with <inline-formula><mml:math id="inf31"><mml:mrow><mml:mi>C</mml:mi><mml:mo>→</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math></inline-formula> introgression is<disp-formula id="equ45"><label>(37)</label><mml:math id="m45"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>From this, it can be seen that introgression makes hemiplasy more likely than ILS alone when:<disp-formula id="equ46"><label>(38)</label><mml:math id="m46"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>&gt;</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>When is this true? Substituting the relevant expressions from the main text gives:<disp-formula id="equ47"><label>(39)</label><mml:math id="m47"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>2</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo></mml:mrow></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>2</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>&gt;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo></mml:mrow></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ48"><label>(40)</label><mml:math id="m48"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo></mml:mrow></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>2</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo></mml:mrow></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>2</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The mutation probabilities on the right side of the inequality are equal since they are on the same topology with the same branch lengths. Therefore, <xref ref-type="disp-formula" rid="equ48">Equation 40</xref> can simplified:<disp-formula id="equ49"><label>(41)</label><mml:math id="m49"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>As the most conservative case, let us assume a hybrid speciation scenario where <italic>t</italic><sub>1</sub> = <italic>t</italic><sub><italic>m</italic></sub>. This represents the most conservative introgression scenario, since <xref ref-type="fig" rid="fig4">Figure 4</xref> in the main text shows that more recent introgression makes hemiplasy more likely. In this case, the right side of the inequality simplifies to 0, leaving<disp-formula id="equ50"><label>(42)</label><mml:math id="m50"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>This is true whenever <inline-formula><mml:math id="inf32"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, which is true by definition in this model. Therefore, introgression always makes hemiplasy more likely than ILS alone.</p></sec></boxed-text></app></app-group></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.63753.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Rokas</surname><given-names>Antonis</given-names></name><role>Reviewing Editor</role><aff><institution>Vanderbilt University</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>Hibbins and co-authors examine how evolution of binary traits along gene trees that are discordant with the species tree due to incomplete lineage sorting and introgression can generate misleading results for our understanding of the occurrence of homoplasy in cases of convergent evolution. The effects of hemiplasy in trait evolution are well known in the field but have been rarely tested, especially in the context of introgression. The authors show that introgression makes hemiplasy more likely through simulation analyses, develop a software to account for the probability of hemiplasy and homoplasy, and demonstrate its utility using two empirical examples.</p><p><bold>Decision letter after peer review:</bold></p><p>[Editors’ note: the authors submitted for reconsideration following the decision after peer review. What follows is the decision letter after the first round of review.]</p><p>Thank you for submitting your work entitled &quot;Determining the probability of hemiplasy in the presence of incomplete lineage sorting and introgression&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, one of whom is a member of our Board of Reviewing Editors, and the evaluation has been overseen by a Senior Editor. The following individual involved in review of your submission has agreed to reveal their identity: Claudia Solis-Lemus (Reviewer #3).</p><p>Based on discussions between the reviewers, the Reviewing Editor, and the Senior Editor, and the individual reviews below, we regret to inform you that your work will not be considered further for publication in <italic>eLife</italic>. As you will see from the reviewers' comments below, there was considerable disagreement between reviewers about the novelty and rigor of this work. One of the reviewers felt that the novelty of this work did not meet the bar for <italic>eLife</italic> and two of the reviewers felt that the rigor of this work was not yet sufficient for publication. It was also noted that the revisions requested are not trivial and their outcome not predictable. However, some of the reviewers also felt that <italic>eLife</italic> would be an appropriate venue for this work (if you were able to address the substantial criticisms raised). Given all this, and assuming you are able to address the major issues, <italic>eLife</italic> would be open to considering a re-submission of this work. Please note that this re-submitted article would be treated as a new submission.</p><p>The reviewers appreciated that incorporation of ILS+gene flow to the study of hemiplasy would be an important step forward (although, as stated above, they debated how considerable this advance would be). The main concerns of the study were:</p><p>1) The example data set used (of the green-blooded lizards) lacks evidence of introgression. It will be essential for the authors to use an example that has evidence of both ILS and introgression. Furthermore, the example should clearly illustrate the advantage of the new ILS+introgression method developed by the authors over the standard ILS-only method.</p><p>2) The authors should benchmark their approach. To do this, the authors could simulate under a known history, then infer the network under the best available approaches, then use their method to show the variability in the <italic>HeIST</italic> inference. The authors should similarly allow for uncertainty to propagate in real data.</p><p>3) The consequences of the ad-hoc approach to inferring tip lengths should be carefully investigated.</p><p>4) Partition the probability of hemiplasy into that attributable to ILS vs Introgression components. Again, bench-marking of these analyses will be necessary.</p><p>5) The manuscript's novelty would need to be made more accessible to the broad audience of <italic>eLife</italic> (the reviewers made several suggestions for doing so, e.g., explaining hemiplasy more, incorporating discussion of LGT / HGT, etc.).</p><p><italic>Reviewer #1:</italic></p><p>In this manuscript, Hibbins and co-authors examined how evolution of binary traits along discordant gene trees due to ILS and introgression can generate misleading results for our understanding of the occurrence of homoplasy in cases of convergent evolution. The effects of hemiplasy in trait evolution are well known in the field but have been rarely tested, especially in the context of introgression. The authors have shown that introgression makes hemiplasy more likely through their simulation and also developed the software package to account for the probability of hemiplasy and homoplasy. The authors then apply their tool to explore the evolution of blood color in empirical lizard data and find that the hemiplasy is more likely to explain the previously observed trait incongruence. The manuscript is well written and clear and the algorithm is state-of-art, and it will be of valuable information for the research community studying trait evolution in a variety of organisms.</p><p>1) The authors examined the effects of ILS and introgression, but there are other types of the incongruence such as HGT or hidden paralogy that have not mentioned in the manuscript. It will be great to bring these, especially HGT, into the context of this work, acknowledge that they can do cause gene trees to deviate from species trees, and discuss if this method can also handle traits evolved through paralogs or HGT.</p><p>2) The model shows that the most important factors contributing to a high risk of hemiplasy relative to homoplasy are short internal branches. Can you quantify this by <italic>HeIST</italic>? For example, you can simulate a same topology with different scales of internal branch lengths to quantify the distribution of the level of hemiplasy. It would be of great of interest to explore at what scale the hemiplasy should be the most likely.</p><p>3) While the green-blooded lizard example is certainly interesting, it is not one that has evidence of introgression, so it's at best a &quot;null&quot; example. The authors should use an example of a data set that has evidence of introgression – seems strange that this is their example of choice when the rest of their paper is about integrating both ILS and introgression. Ideally, the authors would find an example whose genetic basis is known so that hemiplasy can be validated by examining the phylogeny of the locus giving rise to the trait. I realize that this may be challenging but the authors' arguments about the likelihood of hemiplasy in the green-blooded lizards are substantially weakened by the fact that the genetic basis of the green-blood trait is not known (and therefore the authors cannot be 100% certain that there was hemiplasy involved).</p><p><italic>Reviewer #2:</italic></p><p>This research has been interested in the potential confusion between &quot;hemiplasy&quot; (a shared trait found in disparate lineages due to ILS and/or introgression), and homosplasmy (a shared trait found in disparate lineages due to independent substitutions). Building on previous work which calculated the relative probability of hemiplasmy under ILS, this work includes introgression as a potential source of hemiplasmy. After presenting some maths for the three taxon case, the authors present a useful helper program &quot;<italic>HeIST</italic>&quot; to use ms to simulate this scenario so that inference can be made for tress with more than three taxa. Because their model is coalescent and requires tip length in coalescent units (which coalescent tree inference methods do not infer), they propose an ad-hoc method in which they regress internal branch length in coalescent units (based on concordance factors) on branch length in substitutions and use this regression to predict coalescent tip branch length from the number of substitutions per site. Finally, the authors use this method to revisit claims of repeated independent evolution of green blood in lizards.</p><p>The work is clearly explained. The math in this paper is largely solid, resulting in intuitive and believable results, and would be at home in a theoretical oriented journal like TPB. The simulation framework is the sort of solid ad-hoc simulation expected from empirical papers rather than a &quot;method-development paper&quot;. The empirical example is interesting, but does not suit the method. The authors due a great job of listing the many caveats associated with their approach.</p><p>Biggest concerns: There is ample opportunity to strengthen this manuscript. Here I highlight the areas which require the most attention. I believe a seriously improved manuscript could be a valuable contribution to a more specialized journal.</p><p>1) The relationship between the theory and the data analysis is incredibly weak, and I don't believe this work is publishable with such a disconnect between theory and analysis. The theoretical advance is to incorporate introgression in previous models of the risk of hemiplasy. However, (as far as I can tell) the authors do not model introgression in their inference. As such, it this data set is not well-suited for the methodological development. A data set with introgression would help show why this method is necessary, and will highlight the challenges that arise in applying the method to data that motivated it.</p><p>2) Evaluation of model performance. In the Discussion the authors note the many ways that their method can fail. Most of which follow from &quot;garbage in garbage out&quot;, if introgression rates and timing, tree inference and timing etc is off, the method will be off too. A stronger method paper would incorporate the imperfection in our ability to know these parameters when presenting a model whose accuracy depends on them. Likewise, the simple regression seems to perform relatively poorly here, and will likely do even worse in the face of gene flow. As such, it would be worthwhile to show how sensitive inference is to mi specified tip lengths. Both of these concerns will have different effects over a range of biological scenarios, so a broad exploration of performance is required.</p><p><italic>Reviewer #3:</italic></p><p>The authors present a novel approach to study convergent traits under both ILS and introgression. They make the distinction between homoplasy and hemiplasy, and study the theoretical probabilities of both scenarios under a multispecies coalescent model on a 3-taxon network. In addition, they produce an open-source software to calculate probabilities of hemiplasy and homoplasy via simulations on larger trees or networks.</p><p>The manuscript is extremely well-written, clear and easy to follow. Everything is well-explained. In addition, the material is extremely relevant for the scientific community, and the authors justify every step of their methodology in a transparent manner.</p><p>The only major comment is that for someone not familiar already with the concept of hemiplasy, it took me a little bit to understand the distinction to homoplasy. I understand that the authors are building on Guerrero and Hahn, 2018, so having read this paper seems like a prerequisite. However, the authors make a huge effort to make this manuscript self-contained by including a short summary of the findings in Guerrero and Hahn, 2018. I would add perhaps a bit more of the description between hemiplasy and homoplasy found in Guerrero and Hahn (for example, Figure 1) for those readers who might still need a bit more explanation to build intuition</p><p>[Editors’ note: further revisions were suggested prior to acceptance, as described below.]</p><p>Thank you for submitting your article &quot;Determining the probability of hemiplasy in the presence of incomplete lineage sorting and introgression&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, one of whom is a member of our Board of Reviewing Editors, and the evaluation has been overseen by Patricia Wittkopp as the Senior Editor. The reviewers have opted to remain anonymous.</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>Hibbins and co-authors examine how evolution of binary traits along gene trees that are discordant with the species tree due to incomplete lineage sorting and introgression can generate misleading results for our understanding of the occurrence of homoplasy in cases of convergent evolution. The effects of hemiplasy in trait evolution are well known in the field but have been rarely tested, especially in the context of introgression. The authors show that introgression makes hemiplasy more likely through simulation analyses, develop a software to account for the probability of hemiplasy and homoplasy, and demonstrate its utility using two empirical examples.</p><p>Revisions:</p><p>We greatly appreciate the substantive responses to the previous round of comments. We have a couple of additional requests:</p><p>1) Biological values for parameters in the empirical example should be provided in the text. i.e. include Ne and mu, rather than there compound parameter, theta, and the parameter choices should be better explained and justified. This is important for evaluation of the results – for example, we are surprised that these lizard and butterflies would have the same value of theta.</p><p>2) Evaluation of the performance of <italic>HeIST</italic> based inference should include realistic trade-offs in the estimation of population mutation rates, introgression time, introgression proportion, and split time. Our sense is that any attempt to estimate these parameters from real data would involve some correlations in their inferred values, so it would be good to know how this would impact inference.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.63753.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p>[Editors’ note: the authors resubmitted a revised version of the paper for consideration. What follows is the authors’ response to the first round of review.]</p><disp-quote content-type="editor-comment"><p>The reviewers appreciated that incorporation of ILS+gene flow to the study of hemiplasy would be an important step forward (although, as stated above, they debated how considerable this advance would be). The main concerns of the study were:</p><p>1) The example data set used (of the green-blooded lizards) lacks evidence of introgression. It will be essential for the authors to use an example that has evidence of both ILS and introgression. Furthermore, the example should clearly illustrate the advantage of the new ILS+introgression method developed by the authors over the standard ILS-only method.</p></disp-quote><p>We have analyzed a new empirical case study involving a chromosomal inversion in <italic>Heliconius</italic>, using data originally published by Edelman et al., 2019. The clade in which this inversion arose has clear evidence of both ILS and introgression, and analyses by Edelman et al. suggested a role for introgression specifically in the origin of the inversion. The results of our analysis confirm their finding that a single origin of the inversion is most likely. See responses below for more specific details.</p><disp-quote content-type="editor-comment"><p>2) The authors should benchmark their approach. To do this, the authors could simulate under a known history, then infer the network under the best available approaches, then use their method to show the variability in the HeIST inference. The authors should similarly allow for uncertainty to propagate in real data.</p></disp-quote><p>We have performed several new analyses and made updates to <italic>HeIST</italic> to address concerns about accuracy and incorporating uncertainty. See responses to reviewers below for detailed comments.</p><disp-quote content-type="editor-comment"><p>3) The consequences of the ad-hoc approach to inferring tip lengths should be carefully investigated.</p></disp-quote><p>We have performed a new analysis of the bias introduced by our approach. Overall, the effect is to artificially increase tree branch lengths, which leads to conservative estimates of the probability of hemiplasy. See below for details.</p><disp-quote content-type="editor-comment"><p>4) Partition the probability of hemiplasy into that attributable to ILS vs Introgression components. Again, bench-marking of these analyses will be necessary.</p></disp-quote><p><italic>HeIST</italic> now returns a summary of how many focal cases originate from an introgressed history vs. the species history. In addition, users can analyze the same tree in <italic>HeIST</italic> with or without introgression events specified in order to quantify their contribution to overall hemiplasy risk; we do this in our new benchmarking simulations.</p><disp-quote content-type="editor-comment"><p>5) The manuscript's novelty would need to be made more accessible to the broad audience of eLife (the reviewers made several suggestions for doing so, e.g., explaining hemiplasy more, incorporating discussion of LGT / HGT, etc.).</p></disp-quote><p>We have made substantial revisions to the text to address these concerns. See detailed comments below.</p><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>In this manuscript, Hibbins and co-authors examined how evolution of binary traits along discordant gene trees due to ILS and introgression can generate misleading results for our understanding of the occurrence of homoplasy in cases of convergent evolution. The effects of hemiplasy in trait evolution are well known in the field but have been rarely tested, especially in the context of introgression. The authors have shown that introgression makes hemiplasy more likely through their simulation and also developed the software package to account for the probability of hemiplasy and homoplasy. The authors then apply their tool to explore the evolution of blood color in empirical lizard data and find that the hemiplasy is more likely to explain the previously observed trait incongruence. The manuscript is well written and clear and the algorithm is state-of-art, and it will be of valuable information for the research community studying trait evolution in a variety of organisms.</p><p>1) The authors examined the effects of ILS and introgression, but there are other types of the incongruence such as HGT or hidden paralogy that have not mentioned in the manuscript. It will be great to bring these, especially HGT, into the context of this work, acknowledge that they can do cause gene trees to deviate from species trees, and discuss if this method can also handle traits evolved through paralogs or HGT.</p></disp-quote><p>We have made changes to the Introduction and Discussion to address these concerns. In particular, we make it clear that HGT is included in our definition of introgression. While hidden paralogy does lead to incongruence in the inferred gene tree, it is caused by an error in ortholog identification. Therefore, the true history of traits following such trees will not be discordant with the species tree. We have also clarified this point. The text now reads:</p><p>“Gene tree discordance can have multiple sources, including biological causes such as incomplete lineage sorting (ILS), introgression, and horizontal gene transfer, and technical causes such as hidden paralogy or errors in gene tree inference…” (Introduction)</p><p>“Horizontal gene transfer, which is more common in prokaryotes, would also require networks that contain reticulation edges spanning very long periods of time” (Discussion)</p><p>“Errors common to all phylogenetic methods can be introduced into the user-specified species tree/network at several steps, including errors in ortholog identification…” (Discussion)</p><disp-quote content-type="editor-comment"><p>2) The model shows that the most important factors contributing to a high risk of hemiplasy relative to homoplasy are short internal branches. Can you quantify this by HeIST? For example, you can simulate a same topology with different scales of internal branch lengths to quantify the distribution of the level of hemiplasy. It would be of great of interest to explore at what scale the hemiplasy should be the most likely.</p></disp-quote><p>As part of our new set of benchmarking simulations in <italic>HeIST</italic>, we have included three ILS conditions in which the internal branch length is progressively decreased while other aspects of the tree are held constant. This led to a substantial increase in both the raw probability of hemiplasy, and the probability conditional on observing the specified trait distribution. Figure 5 and describe these new results:</p><p>“To evaluate the performance of <italic>HeIST</italic>, we simulated across nine conditions with increasing expected probabilities of hemiplasy, across five different trait mutation rates. The results, shown in Figure 5, confirm the theoretical predictions shown in Figure 4: the probability of hemiplasy increases as a function of decreasing internal branch length (ILS1-ILS3), increasing rate of introgression (INT1-INT3), and more recent introgression (INT4-INT6). The effect of the timing of introgression is weaker than the effect of the introgression rate, also in line with theoretical expectations. These results held true for both the probability conditional on observing the specified trait pattern (Figure 5A) and the raw probability (Figure 5B).”</p><disp-quote content-type="editor-comment"><p>3) While the green-blooded lizard example is certainly interesting, it is not one that has evidence of introgression, so it's at best a &quot;null&quot; example. The authors should use an example of a data set that has evidence of introgression – seems strange that this is their example of choice when the rest of their paper is about integrating both ILS and introgression. Ideally, the authors would find an example whose genetic basis is known so that hemiplasy can be validated by examining the phylogeny of the locus giving rise to the trait. I realize that this may be challenging but the authors' arguments about the likelihood of hemiplasy in the green-blooded lizards are substantially weakened by the fact that the genetic basis of the green-blood trait is not known (and therefore the authors cannot be 100% certain that there was hemiplasy involved).</p></disp-quote><p>As mentioned above, we have included a new analysis of a chromosomal inversion in the <italic>Heliconius erato/sara</italic> clade. While this trait is not a phenotype in the strict sense, the inversion arrangement contains a gene underlying important wing phenotypes. Patterns of gene tree discordance and introgression inferred in Edelman et al., 2019, are clearly suggestive of a hemiplastic origin via introgression, and our analysis in <italic>HeIST</italic> confirms that a single origin of the inversion is most likely. See Figures 1B, 6B, and the new section of the Results entitled “A chromosomal inversion in the <italic>Heliconius erato</italic>/<italic>sara</italic> clade likely has a single origin” for further details.</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>[…]</p><p>Biggest concerns: There is ample opportunity to strengthen this manuscript. Here I highlight the areas which require the most attention. I believe a seriously improved manuscript could be a valuable contribution to a more specialized journal.</p><p>1) The relationship between the theory and the data analysis is incredibly weak, and I don't believe this work is publishable with such a disconnect between theory and analysis. The theoretical advance is to incorporate introgression in previous models of the risk of hemiplasy. However, (as far as I can tell) the authors do not model introgression in their inference. As such, it this data set is not well-suited for the methodological development. A data set with introgression would help show why this method is necessary, and will highlight the challenges that arise in applying the method to data that motivated it.</p></disp-quote><p>We have included a new analysis of a <italic>Heliconius</italic> dataset with introgression (see responses to reviewer 1 for details), in addition to performing extensive test simulations over multiple introgression conditions (see comments below), to address these concerns. We think that the analysis of this dataset does help to show why our method is necessary, and we thank the reviewer for the suggestion.</p><disp-quote content-type="editor-comment"><p>2) Evaluation of model performance. In the Discussion the authors note the many ways that their method can fail. Most of which follow from &quot;garbage in garbage out&quot;, if introgression rates and timing, tree inference and timing etc is off, the method will be off too. A stronger method paper would incorporate the imperfection in our ability to know these parameters when presenting a model whose accuracy depends on them. Likewise, the simple regression seems to perform relatively poorly here, and will likely do even worse in the face of gene flow. As such, it would be worthwhile to show how sensitive inference is to mi specified tip lengths. Both of these concerns will have different effects over a range of biological scenarios, so a broad exploration of performance is required.</p></disp-quote><p>We have performed several new analyses that we believe quantify the effects of various kinds of uncertainty on the accuracy of inferences in <italic>HeIST</italic>:</p><p>First, we have performed a new set of extensive benchmarking simulations, across nine different simulated conditions (six involving introgression) and five different mutation rates. While primarily intended to demonstrate how variation in true parameters affects the probability of hemiplasy, they can also be interpreted as showing the expected deviation in the probability of hemiplasy if parameters are mis-specified. See Figure 5—figure supplement 4, the new Materials and methods section entitled “Accuracy of <italic>HeIST</italic>”, and the new Results section entitled “<italic>HeIST</italic> effectively captures the effects of ILS and introgression on hemiplasy risk” for a detailed description of these simulations and results.</p><p>Second, we have included an analysis that examines how a typical pipeline for generating an input to <italic>HeIST</italic> from an empirical phylogeny can lead to inaccurate inferences. This involved simulating data from a known tree, building a new tree from the simulated data in <italic>RAxML</italic>, estimating site concordance factors, and using that information as input to our regression module followed by tree smoothing. Overall, the effect is to increase both internal and tip branch lengths relative to the known tree, which makes hemiplasy inferences more conservative. See Figure 5—figure supplement 6, the new Materials and methods section entitled “Inferring the tip branch lengths of a phylogeny in coalescent units”and the same new Results section as above for an overview of the simulations and results.</p><p>Finally, we have now updated <italic>HeIST</italic> so that it can also use the upper and lower bounds of the 95% confidence interval of predicted tip branch lengths, in addition to the predictions themselves. This allows users to quantify the uncertainty in their results due to mis-specified branch lengths.</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>The authors present a novel approach to study convergent traits under both ILS and introgression. They make the distinction between homoplasy and hemiplasy, and study the theoretical probabilities of both scenarios under a multispecies coalescent model on a 3-taxon network. In addition, they produce an open-source software to calculate probabilities of hemiplasy and homoplasy via simulations on larger trees or networks.</p><p>The manuscript is extremely well-written, clear and easy to follow. Everything is well-explained. In addition, the material is extremely relevant for the scientific community, and the authors justify every step of their methodology in a transparent manner.</p><p>The only major comment is that for someone not familiar already with the concept of hemiplasy, it took me a little bit to understand the distinction to homoplasy. I understand that the authors are building on Guerrero and Hahn, 2018, so having read this paper seems like a prerequisite. However, the authors make a huge effort to make this manuscript self-contained by including a short summary of the findings in Guerrero and Hahn, 2018. I would add perhaps a bit more of the description between hemiplasy and homoplasy found in Guerrero and Hahn (for example, Figure 1) for those readers who might still need a bit more explanation to build intuition</p></disp-quote><p>We have added a new panel to Figure 3 to provide a visual contrast of homoplasy and hemiplasy, as well as updating the caption of the figure to help describe the distinction in more detail:</p><p>“Homoplasy can happen on any gene tree, as long as there are two independent mutations on tip branches (panel A). Homoplasy can also happen via a mutation in the ancestor of all three species, followed by a reversal”</p><p>[Editors’ note: what follows is the authors’ response to the second round of review.]</p><disp-quote content-type="editor-comment"><p>Revisions:</p><p>We greatly appreciate the substantive responses to the previous round of comments. We have a couple of additional requests:</p><p>1) Biological values for parameters in the empirical example should be provided in the text. i.e. include Ne and mu, rather than there compound parameter, theta, and the parameter choices should be better explained and justified. This is important for evaluation of the results – for example, we are surprised that these lizard and butterflies would have the same value of theta.</p></disp-quote><p>We have added clarifying statements to the Materials and methods section to justify our choices of parameters:</p><p>“While specific parameter estimates are not available for this system, our choice of θ reflects broad estimates of N<sub>e</sub> and µ on the order of 10<sup>5</sup> – 10<sup>6</sup> (Lynch, 2006) and 10<sup>-8</sup> – 10<sup>-9</sup> per-base per-generation (Lynch 2010), respectively, in vertebrates (see Discussion).”</p><p>“That our choice of θ for this system is the same as in our lizard analysis is just a coincidence: it reflects a trade-off between the generally higher effective population size for insects (Lynch, 2006) and the lower mutation rate expected for chromosomal inversions; see Discussion.”</p><disp-quote content-type="editor-comment"><p>2) Evaluation of the performance of HeIST based inference should include realistic trade-offs in the estimation of population mutation rates, introgression time, introgression proportion, and split time. Our sense is that any attempt to estimate these parameters from real data would involve some correlations in their inferred values, so it would be good to know how this would impact inference.</p></disp-quote><p>We acknowledge that parameter inference for phylogenetic networks is often difficult and that many different sets of parameters may be consistent with patterns in observed data. To address this concern, we have performed a new set of simulations across five conditions in which the probability and recency of introgression were increased while holding constant the probability of the gene tree leading to hemiplasy. We found an effect of the timing of introgression on the probability of hemiplasy that is independent of the rate of discordance, emphasizing that parameter inference should be done using gene trees with branch lengths.</p><p>This analysis is described in new paragraphs in the Materials and methods and Results. New Figure 5—figure supplements 4 and 5 visualize the choice of parameters and simulation results, respectively. The new paragraph in the Results reads:</p><p>“When the parameters of a phylogenetic network are estimated from empirical data, it is possible that many different parameter combinations may be equally likely, especially when only a subset of features are used to fit the model. However, these combinations may differentially affect the probability of hemiplasy: for instance, if the frequency of gene trees is used to fit the network model, but the length of gene tree branches is ignored. To investigate this, we applied <italic>HeIST</italic> to five simulated conditions in which the probability and recency of introgression were increased while the frequency of the discordant gene tree that could cause hemiplasy was held constant (Figure 5—figure supplement 4). We found that, despite a constant gene tree probability, the conditional probability of hemiplasy increased in each successive condition as introgression became more recent and frequent (Figure 5—figure supplement 5). These results to some extent merely serve to reinforce the notion that introgression has an effect on hemiplasy above and beyond the effect of ILS alone: by lengthening the branch on the discordant tree that hemiplastic mutations can occur on, introgression has a larger effect than ILS alone. But even when network models that include introgression are used, the estimated effects on hemiplasy will be conservative if parameters are estimating using gene tree frequencies alone.”</p></body></sub-article></article>