<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN"  "JATS-archivearticle1-3-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">90606</article-id><article-id pub-id-type="doi">10.7554/eLife.90606</article-id><article-id pub-id-type="doi" specific-use="version">10.7554/eLife.90606.3</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Structural Biology and Molecular Biophysics</subject></subj-group></article-categories><title-group><article-title>Automated multiconformer model building for X-ray crystallography and cryo-EM</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-254332"><name><surname>Wankowicz</surname><given-names>Stephanie A</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4225-7459</contrib-id><email>mullane.stephanie@gmail.com</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-325475"><name><surname>Ravikumar</surname><given-names>Ashraya</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-325476"><name><surname>Sharma</surname><given-names>Shivani</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-325477"><name><surname>Riley</surname><given-names>Blake</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="pa1">†</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-325478"><name><surname>Raju</surname><given-names>Akshay</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-254334"><name><surname>Hogan</surname><given-names>Daniel W</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3375-408X</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-366034"><name><surname>Flowers</surname><given-names>Jessica</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-254335"><name><surname>van den Bedem</surname><given-names>Henry</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-241019"><name><surname>Keedy</surname><given-names>Daniel A</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9184-7586</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-239260"><name><surname>Fraser</surname><given-names>James S</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5080-2859</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con10"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/043mz5j54</institution-id><institution>Department of Bioengineering and Therapeutic Sciences, University of California, San Francisco</institution></institution-wrap><addr-line><named-content content-type="city">San Francisco</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01gdjt538</institution-id><institution>Structural Biology Initiative, CUNY Advanced Science Research Center</institution></institution-wrap><addr-line><named-content content-type="city">New York</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00453a208</institution-id><institution>Ph.D. Program in Biology, The Graduate Center, City University of New York</institution></institution-wrap><addr-line><named-content content-type="city">New York</named-content></addr-line><country>United States</country></aff><aff id="aff4"><label>4</label><institution>Atomwise Inc</institution><addr-line><named-content content-type="city">San Francisco</named-content></addr-line><country>United States</country></aff><aff id="aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00wmhkr98</institution-id><institution>Department of Chemistry and Biochemistry, City College of New York</institution></institution-wrap><addr-line><named-content content-type="city">New York</named-content></addr-line><country>United States</country></aff><aff id="aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00453a208</institution-id><institution>Ph.D. Programs in Biochemistry, Biology and Chemistry, The Graduate Center, City University of New York</institution></institution-wrap><addr-line><named-content content-type="city">New York</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Stockbridge</surname><given-names>Randy B</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00jmfr291</institution-id><institution>University of Michigan–Ann Arbor</institution></institution-wrap><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Cui</surname><given-names>Qiang</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05qwgg493</institution-id><institution>Boston University</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><author-notes><fn fn-type="present-address" id="pa1"><label>†</label><p>Replay, San Diego, United States</p></fn></author-notes><pub-date publication-format="electronic" date-type="publication"><day>21</day><month>06</month><year>2024</year></pub-date><volume>12</volume><elocation-id>RP90606</elocation-id><history><date date-type="sent-for-review" iso-8601-date="2023-07-05"><day>05</day><month>07</month><year>2023</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint.</event-desc><date date-type="preprint" iso-8601-date="2023-06-28"><day>28</day><month>06</month><year>2023</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.06.28.546963"/></event><event><event-desc>This manuscript was published as a reviewed preprint.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2023-09-05"><day>05</day><month>09</month><year>2023</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.90606.1"/></event><event><event-desc>The reviewed preprint was revised.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2024-05-14"><day>14</day><month>05</month><year>2024</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.90606.2"/></event></pub-history><permissions><copyright-statement>© 2023, Wankowicz et al</copyright-statement><copyright-year>2023</copyright-year><copyright-holder>Wankowicz et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-90606-v1.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-90606-figures-v1.pdf"/><abstract><p>In their folded state, biomolecules exchange between multiple conformational states that are crucial for their function. Traditional structural biology methods, such as X-ray crystallography and cryogenic electron microscopy (cryo-EM), produce density maps that are ensemble averages, reflecting molecules in various conformations. Yet, most models derived from these maps explicitly represent only a single conformation, overlooking the complexity of biomolecular structures. To accurately reflect the diversity of biomolecular forms, there is a pressing need to shift toward modeling structural ensembles that mirror the experimental data. However, the challenge of distinguishing signal from noise complicates manual efforts to create these models. In response, we introduce the latest enhancements to qFit, an automated computational strategy designed to incorporate protein conformational heterogeneity into models built into density maps. These algorithmic improvements in qFit are substantiated by superior R<sub>free</sub> and geometry metrics across a wide range of proteins. Importantly, unlike more complex multicopy ensemble models, the multiconformer models produced by qFit can be manually modified in most major model building software (e.g., Coot) and fit can be further improved by refinement using standard pipelines (e.g., Phenix, Refmac, Buster). By reducing the barrier of creating multiconformer models, qFit can foster the development of new hypotheses about the relationship between macromolecular conformational dynamics and function.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>structural biology</kwd><kwd>conformational heterogeneity</kwd><kwd>cryo-EM</kwd><kwd>protein dynamics</kwd><kwd>X-ray crystallography</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>GM145238</award-id><principal-award-recipient><name><surname>Fraser</surname><given-names>James S</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>GM133769</award-id><principal-award-recipient><name><surname>Keedy</surname><given-names>Daniel A</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100014989</institution-id><institution>Chan Zuckerberg Initiative</institution></institution-wrap></funding-source><award-id>EOSS5</award-id><principal-award-recipient><name><surname>Fraser</surname><given-names>James S</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Creating structural models with multiple conformations of proteins improves the fit of the model to experimental data X-ray crystallography and improve the model geometry.</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>publishing-route</meta-name><meta-value>prc</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Macromolecular X-ray crystallography and single-particle electron microscopy (cryo-EM) can provide valuable information on macromolecular conformational ensembles. These experiments cannot capture all conformations present in solution as many would disrupt the ability to obtain crystals or align classifiable particles (<xref ref-type="bibr" rid="bib11">Cheng, 2015</xref>). However, careful modeling from high-resolution X-ray crystallography and cryo-EM data can reveal widespread conformational heterogeneity, particularly for protein side chains and local backbone regions (<xref ref-type="bibr" rid="bib58">Smith et al., 1986</xref>; <xref ref-type="bibr" rid="bib31">Herzik et al., 2017</xref>). Such discrete, local conformational heterogeneity is significant for many biological functions, including macromolecular binding, catalysis, and allostery (<xref ref-type="bibr" rid="bib38">Keedy et al., 2018</xref>; <xref ref-type="bibr" rid="bib67">Wankowicz et al., 2022</xref>; <xref ref-type="bibr" rid="bib77">Yabukarski et al., 2022</xref>).</p><p>While the underlying data from X-ray diffraction and cryo-EM experiments contains information on temporal and spatial averages of tens of thousands to billions of protein copies, conventional structural modeling and refinement procedures fail to capture much of this valuable information. Most depositions in the Protein Data Bank reflect only an averaged, single ground state set of atomic coordinates (<xref ref-type="bibr" rid="bib24">Furnham et al., 2006</xref>), ignoring weak but potentially biologically rich signals encoding alternative conformations sampled by distinct copies of the protein in the experiment.</p><p>Ideally, we would accurately model the complete ensemble of protein conformations reflected in experimental data (<xref ref-type="bibr" rid="bib22">Fraser et al., 2020</xref>). The two ways to model the conformational heterogeneity present in the sample are to create ensembles or use alternative conformations (multiconformers) (<xref ref-type="bibr" rid="bib74">Woldeyes et al., 2014</xref>). The PDB ‘ensemble’ format encodes multiple complete copies of the entire system in different models within a single file. Ensemble refinement approaches are implemented in phenix.ensemble_refinement (<xref ref-type="bibr" rid="bib9">Burnley et al., 2012</xref>) and Vagabond (<xref ref-type="bibr" rid="bib26">Ginn, 2021</xref>). In contrast, multiconformers extend the conventional single-structure model by encoding each individual conformation using a distinct ‘alternative location indicator (altloc)’ within a single model. Altlocs are assigned distinct letters and can range from single atoms to a large number of connected or non-connected residues. Refinement and validation programs treat atoms sharing the same altloc as having the ability to interact with each other and with atoms lacking an altloc. In contrast, atoms with different altlocs cannot interact. By representing the underlying heterogeneity through discrete conformations with labeled altlocs, multiconformer models encode the distribution of states that contribute to the density map. Multiconformer models are notably easier to modify and more interpretable in software like Coot (<xref ref-type="bibr" rid="bib20">Emsley et al., 2010</xref>), unlike ensemble methods that generate multiple complete protein copies (<xref ref-type="bibr" rid="bib9">Burnley et al., 2012</xref>; <xref ref-type="bibr" rid="bib54">Ploscariu et al., 2021</xref>; <xref ref-type="bibr" rid="bib8">Burling and Brünger, 1994</xref>).</p><p>However, many factors make manually creating multiconformer models difficult and time-consuming. Interpreting weak density is complicated by noise arising from many sources, including crystal imperfections, radiation damage, and poor modeling (<xref ref-type="bibr" rid="bib71">Weichenberger et al., 2015</xref>; <xref ref-type="bibr" rid="bib35">Kabsch, 2010</xref>; <xref ref-type="bibr" rid="bib36">Karplus and Diederichs, 2012</xref>) in X-ray crystallography, and errors in particle alignment and classification, poor modeling of beam-induced motion, and imperfect Detector Quantum Efficiency in high-resolution cryo-EM (<xref ref-type="bibr" rid="bib27">Glaeser, 2019</xref>). These factors make visually distinguishing signals in Coot (<xref ref-type="bibr" rid="bib20">Emsley et al., 2010</xref>) or other visualization software very difficult, especially when genuine low-occupancy signals overlap. Additionally, in X-ray crystallography, this process is iterative. Each time a new alternative conformation is placed, the resulting improvement in phases can impact the entire electron density map, often requiring adjustments to previously modeled regions. The difficulty of this process can lead to burnout and human bias, where parts of the protein are carefully modeled as multiconformers, whereas other regions remain modeled as single conformers. Despite these complications, multiconformer modeling can be implemented manually or using software such as FLEXR (<xref ref-type="bibr" rid="bib59">Stachowski and Fischer, 2023</xref>) or qFit, as described below.</p><p>To enable more routine and impartial multiconformer modeling, we have previously developed qFit (<xref ref-type="bibr" rid="bib37">Keedy et al., 2015</xref>; <xref ref-type="bibr" rid="bib55">Riley et al., 2021</xref>; <xref ref-type="bibr" rid="bib63">van den Bedem et al., 2009</xref>). This program leverages the ensemble-rich experimental data from density maps that are better than 2.0 Å resolution to automatically generate parsimonious multiconformer models (<xref ref-type="bibr" rid="bib37">Keedy et al., 2015</xref>; <xref ref-type="bibr" rid="bib55">Riley et al., 2021</xref>). As input, qFit takes a refined single-conformer structure and either a high-resolution X-ray or cryo-EM map as input, and then leverages powerful optimization algorithms to identify alternative protein (<xref ref-type="bibr" rid="bib37">Keedy et al., 2015</xref>; <xref ref-type="bibr" rid="bib55">Riley et al., 2021</xref>) or ligand (<xref ref-type="bibr" rid="bib64">van Zundert et al., 2018</xref>) conformations.</p><p>Here, we present updates to qFit including algorithmic changes to protein conformation selection based on Bayesian information criteria (BIC), B-factor sampling, and updated cryo-EM scoring. Collectively, these advances enable the unsupervised generation of multiconformer models that routinely improve R<sub>free</sub> and model geometry metrics over single-conformer X-ray structures derived from high-resolution data across a diverse test set. We further demonstrate that qFit can identify alternative side-chain conformations in high-resolution cryo-EM datasets. With the improvements in model quality outlined here, qFit can now increasingly be used for finalizing high-resolution models to derive ensemble-function insights.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Overview of qFit protein algorithm</title><p>qFit protein is a tool that automatically identifies alternative conformations based on a high-resolution density map (generally better than ~2 Å) and a well-refined single-conformer structure (generally R<sub>free</sub> below 20%). For X-ray maps, we recommend using a composite omit map as input to minimize model bias (<xref ref-type="bibr" rid="bib61">Terwilliger et al., 2008</xref>). For cryo-EM modeling applications, equivalent metrics of map and model quality are still developing, rendering the use of qFit for cryo-EM more exploratory.</p><p>Since our previous paper, we have made several modifications to the code, both algorithmically (e.g., scoring now includes BIC, and sampling of B-factors) and computationally (improving the efficiency and reliability of the code). All code and associated documentation can be found in the qFit GitHub repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/ExcitedStates/qfit-3.0">https://github.com/ExcitedStates/qfit-3.0</ext-link>, copy archived at <xref ref-type="bibr" rid="bib70">Wankowicz et al., 2024</xref>). The version of qFit associated with this article is 2024.2 and is available at SBGrid (<ext-link ext-link-type="uri" xlink:href="https://sbgrid.org/">https://sbgrid.org/</ext-link>; <xref ref-type="bibr" rid="bib46">Morin et al., 2013</xref>).</p><sec id="s2-1-1"><title>qFit residue</title><p>For each residue, qFit samples backbone conformations, side-chain dihedral angles, and B-factors (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). Using mixed quadratic programming (MIQP) and BIC, we select a parsimonious multiconformer for each residue. The details of each component of this procedure are outlined below. The sampling and scoring of residues can be run in parallel using Python multiprocessing.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Programmatic flow of qFit protein algorithm.</title><p>(<bold>A</bold>) qFit residue algorithm, demonstrated by Tyr118 in the E46Q mutant structure of the photoactive yellow protein from <italic>Halorhodospira halophila</italic> (PDB: 1OTA) (<xref ref-type="bibr" rid="bib4">Anderson et al., 2004</xref>). The 2mFo‐DFc composite omit density map contoured at 1 σ is shown as a blue mesh. (<bold>A.1</bold>) <italic>Backbone sampling:</italic> for each residue, qFit performs a collective translation of backbone atom (N, C, Cα, O) coordinates. (<bold>A.2</bold>) <italic>Aromatic angle sampling:</italic> for aromatic residues (His, Tyr, Phe, Trp), qFit takes the conformations from the backbone step and samples the Cα-Cβ-Cγ angle. (<bold>A.3</bold>) <italic>Dihedral angle sampling:</italic> since Tyr has two χ angles, qFit starts by taking the output conformers from the aromatic angle sampling step and exhaustively samples the χ1 angle, scoring the best conformations based on QP/B-factor/mixed-integer quadratic programming (MIQP) scoring. qFit then uses these best conformations as input to sample the remaining χ angles in the Tyr residue. Since the only angle left to be sampled is the χ2 angle, qFit rotates about the terminal ring of the Tyr and then scores the conformations that best fit the density. (<bold>A.4</bold>) <italic>Final qFit residue scoring:</italic> once we reach the terminal ring (all sampling steps have occurred), we perform QP and B-factor sampling, followed by MIQP with Bayesian information criteria (BIC) selection. MIQP with BIC selection removes a redundant overlapping conformation, resulting in two distinct conformations of this Tyr residue. This model is then output as the residue multiconformer. (<bold>B</bold>) qFit segment algorithm, demonstrated by Tyr118 in PDB: 1OTA. After identifying all optimal conformations for each individual residue, qFit works to connect the protein back together. (<bold>B.1</bold>) <italic>qFit segment:</italic> moving linearly along the protein sequence, qFit identifies ’segments' of residues with multiple backbone conformations. Here, Ser117 (i) and Tyr118 (i + 1) have multiple backbone conformations. qFit segment enumerates each possible combination of alternate conformations between these two residues, creating four possible combinations. The optimal combination of conformations is then determined by the QP/MIQP scoring, leading to one combination being culled. (<bold>B.2</bold>) <italic>qFit relabel:</italic> qFit uses Monte Carlo optimization with a steric model to assign altloc labels to spatially coupled alternative conformers. In this example, Ser117 and the neighboring Gln32 initially have clashing altloc B conformers. However, relabeling swaps the A and B labels of Gln32 to relieve this clash. (<bold>B.3</bold>) <italic>qFit refinement:</italic> we then refine the occupancies, coordinates, and B-factors of the raw qFit output file to produce a final qFit model. qFit improves overall fit to data relative to deposited structures.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90606-fig1-v1.tif"/></fig></sec><sec id="s2-1-2"><title>Backbone sampling</title><p>The qFit process begins with sampling backbone conformations (<xref ref-type="fig" rid="fig1">Figure 1A.1</xref>). We first strip all hydrogens. For each residue, we perform a collective translation of backbone atom (N, C, Cα, O) coordinates. If the model has anisotropic B-factors, this translation is guided by the anisotropic B-factors of the Cβ. If anisotropic B-factors are absent, the translation of coordinates occurs in the Cα-Cβ, C-N, and (Cβ-Cα × C-N) directions. Each translation takes place in steps of 0.1 Å along each coordinate axis, extending to 0.3 Å, resulting in 9 (if isotropic) or 81 (if anisotropic) distinct backbone conformations for further analysis. For Gly and Ala, this is the only sampling that occurs.</p></sec><sec id="s2-1-3"><title>Aromatic angle sampling</title><p>For aromatic residues (His, Tyr, Phe, Trp), qFit takes the conformations from the backbone step (above) and builds part of the side chain out to Cγ (start of the aromatic ring) based on the input model coordinates (<xref ref-type="fig" rid="fig1">Figure 1A.2</xref>). Then, we alter the Cα-Cβ-Cγ angle (‘the aromatic angle’) in steps of ±3.75°, extending to ±7.5°, creating five partial side-chain conformations per backbone conformation. For non-aromatic residues, there is no sampling of this angle. These conformers provide variability in the placement of the aromatic ring prior to dihedral angle sampling.</p></sec><sec id="s2-1-4"><title>Dihedral angle sampling</title><p>The following steps occur for each χdihedral angle for every residue (<xref ref-type="fig" rid="fig1">Figure 1A.3</xref>). For the first dihedral angle (χ1), the input is the sampled backbone conformations (or for aromatic residues the backbone and ‘aromatic angle’ conformers described above). We sample around the χ1 dihedral angle by enumerating a conformation every 6° for 24° on each side of an idealized rotamer (<xref ref-type="bibr" rid="bib76">Xie et al., 2020</xref>) angle. rotamer ± around each rotamer. For proline, we sample the exo and endo conformations of the pyrrolidine ring, by ± 24° in steps of 6°. We then eliminate conformations that clash with other parts of the same sampled conformation of heavy atoms (based on hard spheres) or are redundant (using an all-atom root-mean-square deviation [RMSD] threshold of 0.01  Å).</p><p>These sampled conformations are then subjected to a quadratic programming (QP) optimization (<xref ref-type="bibr" rid="bib3">Agrawal et al., 2018</xref>), which identifies the set of conformations whose weighted calculated density best fits the experimental electron density. The output of QP typically yields 5–15 conformations that best explain the density.</p><p>Next, qFit samples the B-factors of the conformers. The input atomic B-factors are multiplied by a factor ranging from 0.5 to 1.5 in increments of 0.2. The resulting 50–150 conformation/B-factor combinations are subjected to a mixed-integer quadratic programming (MIQP) optimization. The MIQP algorithm incorporates two additional constraints relative to QP: a cardinality term, which limits the maximum number of conformations to 5, and a threshold term, which stipulates that no individual conformation can have an occupancy weight below 0.2. In qFit, MIQP then outputs up to five conformations.</p><p>For residues with subsequent dihedral angles, the conformations selected by the MIQP procedure at the χ(n-1) angle serve as the starting conformers for sampling the χ(n) angle. For residues with only one dihedral angle (Ser, Cys, Thr, Val, Pro), we proceed directly to scoring χ1.</p></sec><sec id="s2-1-5"><title>Final qFit residue scoring</title><p>Upon reaching the terminal dihedral angle, we perform the optimization steps outlined above (QP/MIQP), but instead of relying only on the optimization algorithm to decide on the number of conformations to output, we also consider the model complexity (<xref ref-type="fig" rid="fig1">Figure 1A.4</xref>). qFit runs the MIQP step five times with a cardinality term ranging from 1 to 5. Taking each output, we calculate the BIC. The BIC provides a numerical value of the tradeoff between the difference between the calculated and experimental density (residual sum of squares) and the number of parameters (k). The number of parameters (k) is defined by the following: number of conformers * number of atoms * 4 (representing the x, y, z coordinates and B-factor). A heuristic scaling factor of 0.95 accounts for the fact that the coordinate parameters are not independent due to chemical constraints between atoms during sampling.<disp-formula id="equ1"><mml:math id="m1"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mi>B</mml:mi><mml:mi>I</mml:mi><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mi>I</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mi>I</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mn>4</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>r</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi><mml:mi>u</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>s</mml:mi><mml:mi>q</mml:mi><mml:mi>u</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>v</mml:mi><mml:mi>o</mml:mi><mml:mi>x</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>p</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>qFit then outputs the set of conformations with the lowest BIC value, concluding the qFit residue routine.</p></sec><sec id="s2-1-6"><title>Connecting residues together into a multiconformer model</title><p>After the sampling and scoring of each individual residue, qFit considers the entire protein together. First, we use MIQP and BIC to select the best-fitting conformations among connected residues, ensuring that neighboring backbone conformations have the same occupancy. Second, we label the alternative conformers while being aware of clashes.</p></sec><sec id="s2-1-7"><title>qFit segment</title><p>After identifying the optimal conformations for each residue in parallel, qFit reconnects the backbone atoms (<xref ref-type="fig" rid="fig1">Figure 1B.1</xref>). Moving from N- to C-terminus along the protein, we identify ‘segments' of residues with multiple backbone conformations, delimited on each end by a residue with a single backbone conformation. The main reason for this step is to find a harmonious set of occupancies for adjacent residues in a segment. Within each segment, qFit creates fragments of three residues, enumerating all possible combinations of conformations in those residues, and selects the final combination of conformations and their relative occupancies using the optimization algorithms outlined above. The BIC is modified for qFit segment such that k equals the number of conformations. qFit then moves along the protein, enumerating and selecting optimal combinations of fragment conformations until reaching the end of the segment.</p></sec><sec id="s2-1-8"><title>qFit relabel</title><p>Next, qFit determines the correct altloc labeling (A, B, C, D, E) of coupled alternative conformers using Monte Carlo optimization with a simple steric model of heavy atoms to prevent spatially adjacent conformers from sterically clashing (<xref ref-type="fig" rid="fig1">Figure 1B.2</xref>). There is also an option (‘qFit segment only’) to input a multiconformer model and run only the qFit segment and relabel procedures. This procedure can be especially helpful after manually adding or deleting conformations in Coot (<xref ref-type="bibr" rid="bib20">Emsley et al., 2010</xref>). Running ‘qFit segment only’ will adjust the occupancy of the remaining conformations and correct the labeling of alternative conformations. This labeling step is not parallelized.</p></sec><sec id="s2-1-9"><title>qFit refinement</title><p>The raw output of qFit (a multiconfomer model) should then be refined. We provide scripts for a refinement procedure with Phenix (<xref ref-type="bibr" rid="bib1">Afonine et al., 2012</xref>), where we iteratively refine the occupancy, coordinates, and B-factors, removing conformations with occupancies under 10%. Once the model is stable (has no conformations with occupancies less than 10%), we perform a final round of refinement which optimizes the placements of ordered water molecules (‘Methods’). We then apply a mosaic bulk solvent (<italic>phenix.mosaic</italic>) to the final model, which allows for partial bulk solvent occupancy (<xref ref-type="bibr" rid="bib2">Afonine et al., 2024</xref>). This refinement protocol outputs a final ‘qFit model’. This model can then be examined and edited in Coot (<xref ref-type="bibr" rid="bib20">Emsley et al., 2010</xref>) or other visualization software, and further refined using software such as Phenix.refine, Refmac, or Buster as the modeler sees fit.</p><p>To evaluate the impact of qFit algorithmic and code improvements, we collated a dataset of single-chain, unliganded, high-resolution (1.2–1.5 Å) protein X-ray crystallography structures from the PDB (<xref ref-type="bibr" rid="bib5">Berman et al., 2000</xref>). We clustered these structures at a sequence identity threshold of 30% and selected the highest resolution structure per cluster. Finally, we ensured that the datasets ran without error through the qFit pipeline, including refinement with Phenix, resulting in 144 diverse structures (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>).</p><p>Each deposited structure was initially re-refined using <italic>phenix.refine</italic> (‘Methods’) to eliminate differences from the original refinement protocols. The resulting re-refined model, which we refer to as the ‘deposited model<italic>’</italic>, was used as the input for qFit. Next, we ran qFit protein using the default parameters and refinement protocol to produce the ‘qFit model’.</p><p>To evaluate the crystallographic modeling differences between the <italic>deposited</italic> and <italic>qFit</italic> models, we compared the R<sub>free</sub> values as an indicator of overall model/data agreement. The qFit model has a lower (improved) R<sub>free</sub> value for 76% (109/144) of structures (<xref ref-type="fig" rid="fig2">Figure 2A</xref>, <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2A</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>). On average, there is an absolute decrease of R<sub>free</sub> value by 0.6% (median deposited models R<sub>free</sub>: 18.1%, median qFit models R<sub>free</sub>: 17.5%), which is in line with theoretical expectations for the increase in model complexity created by qFit (<xref ref-type="bibr" rid="bib33">Holton et al., 2014</xref>; <xref ref-type="bibr" rid="bib65">Vitkup et al., 2002</xref>). R<sub>free</sub> is a valuable metric for monitoring overfitting, which is an important concern when increasing model parameters as is done in multiconformer modeling. An additional check on overfitting comes from monitoring R-gap, calculated as the difference between R<sub>work</sub> and R<sub>free</sub>. qFit models have similar R-gap values compared to deposited models (mean: 3.0% for both models). Collectively, these results indicate that qFit improves the quality of most models without overfitting (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2B</xref>).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Multiconformer models created by qFit are better models than deposited single-conformer models.</title><p>(<bold>A</bold>) The distribution of R<sub>free</sub> value in deposited models versus qFit models. The qFit R<sub>free</sub> values improve in 73% of structures.(<bold>B</bold>) qFit identifies new alternative conformations adjacent to the RNA binding motif in the <italic>Pyrococcus horikoshii</italic> fibrillarin pre-rRNA processing protein (PDB: 1G8A). (Left) qFit multiconformer model with the region in the right panel highlighted in green and the adjacent RNA binding motif highlighted in red. Key domains in the fibrillarin protein are also annotated in blue. (Right) Comparison of the deposited versus qFit model in a region with several conformationally heterogeneous residues. qFit identified new rotamers for Leu58 (tp) and Met175 (ttp and mtp) (<xref ref-type="bibr" rid="bib44">Lovell et al., 2000</xref>) and significantly different alternative conformations within the original rotameric well for Phe69. (<bold>C</bold>) The differences in the number of alternative conformations per residue in deposited models versus qFit models. qFit adds at least one additional alternative conformation in 31.7% of residues (n = 9998). (<bold>D</bold>) The distribution of rotamer assignment agreement between the deposited and qFit models for different (sub)sets of residues. (Left) All residues (n = 42,626). (Right) Only residues with alternative conformations in the deposited model (n = 970). See main text for definitions of categories.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90606-fig2-v1.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Flow diagram of the selection of the test set PDBs.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90606-fig2-figsupp1-v1.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>R<sub>free</sub> and R-gap distributions.</title><p>(<bold>A</bold>) Distribution of difference of R<sub>free</sub> between deposited and qFit models. The median difference in R<sub>free</sub> is 0.6%. Median deposited models R<sub>free</sub>: 18.1%, median qFit models R<sub>free</sub>: 17.5%. (<bold>B</bold>) Distribution of R-gap values between deposited and qFit models (median deposited model: 3.0%, median qFit model: 3.0%). (<bold>C</bold>) Distribution of R<sub>free</sub> value in PDB deposited models versus re-refined deposited models. In this article, deposited models refer to the re-refined deposited models.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90606-fig2-figsupp2-v1.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 3.</label><caption><title>Examples of rotamer state categories.</title><p>Meshes represent 2Fo-Fc density at 1 σ. Green and yellow sticks represent deposited conformer(s). Blue and magenta sticks represent qFit conformer(s). (<bold>A</bold>) Same: the entire set of rotamers identified in the deposited and qFit models are the same (PDB: 1BN6, His199). (<bold>B</bold>) Additional rotamer(s) in the qFit model: deposited and qFit models share at least one rotamer, and at least one additional rotamer was identified in the qFit model (PDB: 3CX2, Glu165). (<bold>C</bold>) Additional rotamer(s) in the deposited model: deposited and qFit models share at least one rotamer, and at least one additional rotamer was identified in the deposited model (PDB: 4P48, Ser6). (<bold>D</bold>) Consistent and different: deposited and qFit models share at least one rotamer, and at least one unique additional rotamer was identified in both the deposited model and the qFit model (PDB: 3HP4, Arg81). (<bold>E</bold>) Different: the rotamers in the deposited and qFit models are all different (PDB: 1BN6, Glu110).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90606-fig2-figsupp3-v1.tif"/></fig></fig-group><p>Despite this general trend of improved models, 24% of the qFit models have worse R<sub>free</sub> than the deposited models (n = 35). The majority of these structures had a deposited model R<sub>free</sub> of over 20%. These high R<sub>free</sub> values are notable because our re-refinement procedure generally improved R<sub>free</sub> relative to the originally deposited model, particularly for structures with higher starting R<sub>free</sub> (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2C</xref>). Since qFit builds off of the input structure and the map quality relies on model phases, accurately detecting alternative conformers depends heavily on the agreement between input model and data. This trend reinforced the idea that poor modeling in a deposited model, which serves as input to qFit, will result in poor performance of qFit. It further suggests that qFit is best employed at a late stage of modeling, after the single-structure model is of sufficient quality that it would be deposited in the PDB.</p><p>As an example of how qFit can uncover previously unnoticed conformational heterogeneity, we examined differences in conformations in the deposited versus qFit models of the <italic>Pyrococcus horikoshii</italic> fibrillarin pre-rRNA processing protein (PDB: 1G8A) (<xref ref-type="bibr" rid="bib56">Rodriguez-Corona et al., 2015</xref>). We focused on the residues adjacent to the RNA binding motif. Among these residues, qFit identified well-justified alternative conformations for residues Leu58, Phe69, and Met175, including new rotamers for Leu58 and Met175, that were not present in the deposited model (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). Beyond detecting alternative conformers in each of these residues, the qFit labeling process identified potential coupled motions between the alternative conformers. For example, when Leu58 is in the ‘up’ position (altloc A), Phe69 is also in the ‘up’ position (altloc A). It is possible that this coupled motion plays a role in RNA binding, a hypothesis that may merit further investigation.</p></sec></sec><sec id="s2-2"><title>qFit recovers alternative conformations of deposited models and discovers new ones</title><p>As qFit mainly alters structures by adding alternative conformations, we examined the differences in the number of alternative conformations between the deposited models and qFit models. Only 2.9% of residues in the deposited models were multiconformers (two or more alternative conformations, n = 970). In contrast, 40.7% (n = 11,049) of residues in the qFit models were multiconformers (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). The vast majority (92.5%) of multiconformer residues in the qFit models have only two alternative conformations; only 2.4% of residues have more than two alternative conformations.</p><p>Alternative conformations come in a few varieties. First and most obvious are alternative conformations that represent drastic changes in coordinates, most commonly in the form of rotameric changes. Most alternative conformations found in deposited models fall into this category. Second are more subtle changes in side-chain and backbone coordinates to represent heterogeneity within a rotameric state. This behavior is exemplified by the Tyr residue in <xref ref-type="fig" rid="fig1">Figure 1A</xref>. Third is even more subtle changes in coordinates to avoid strain because of the alternative conformations of neighboring residues (<xref ref-type="bibr" rid="bib52">Phenix, 2023</xref>). This category is essentially imperceptible to visual inspection as the atom centers are nearly superimposable, but is important to avoid outlier bond geometry because of adjacent residues having larger displacements.</p><p>To quantify how often qFit models new rotameric states, we analyzed the qFit models with <italic>phenix.rotalyze</italic>, which outputs the rotamer state for each conformer (Methods; <xref ref-type="bibr" rid="bib48">Orengo et al., 1997</xref>; <xref ref-type="bibr" rid="bib44">Lovell et al., 2000</xref>). We classified the agreement between the deposited and qFit models into five categories (<xref ref-type="fig" rid="fig2">Figure 2D</xref>, <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>). The first category contains residues that have the same rotameric state(s) in both models. This category entails most single-conformer and multiconformer residues with agreement between the two models. Moreover, residues that have multiple conformations in the same rotamer in the qFit model (for the reasons described above) generally populated the same rotamer as found in single-conformer residues in the deposited models. Overall this category, ‘Consistent’, represents 93.7% of residues (n = 42,626) in the dataset.</p><p>The second and third categories deal with imbalance in alternative conformations that populate distinct rotamers. Since the original premise of qFit was to discover unmodeled alternative conformations, it is unsurprising that many residues in qFit models populate additional rotameric states that are absent in the deposited model. This category, <italic>Additional Rotamer(s) in qFit model</italic>, represents 2.38% of residues (n = 1082). In contrast, only two residues (0.06% of the dataset) are classified in the converse category, <italic>Additional Rotamer(s) in deposited model</italic>.</p><p>The final two categories cover disagreements in rotamer assignments. There are many cases where we observe only partial agreement between alternative conformers modeled in both the deposited and qFit models. These multiconformer residues share at least one common rotamer, but also populate alternative rotamers that are distinct between the two models. This behavior generally occurs in longer residues where subtle differences at higher χ angles leads to distinct rotameric assignments. This category, <italic>Consistent &amp; Different Rotamers</italic>, represents 0.82% of residues (n = 373). The final category, <italic>Different</italic>, covers both multiconformer and single-conformer residues where there are no shared rotamer states between the two models. One reason this category occurs is for similar reasons as the <italic>Consistent &amp; Different</italic> category: differences in terminal χ angles in weak density lead to distinct rotamer assignments. Another contributor to this category is single conformers, generally in the deposited model, modeled into density that qFit interprets as multiconformer. Often the rotamer modeled by the single conformer fits an ‘average’ rather than the two distinct minima fit by the multiconformer model. <italic>Different</italic> rotamer assignments represent 3.04% of residues (n = 1384). While the analyses above include all residues, focusing on residues that were modeled in as multiconformers in the deposited models (n = 970) reveals a large increase in the <italic>Different</italic> and <italic>Consistent &amp; Different Rotamers</italic> categories, to 14.88% (n = 144) and 27.68% (n = 268) of residues, respectively. This increase highlights the sensitivity of the rotamer assignments and motivates benchmarking qFit on ‘true positive’ synthetic data in addition to deposited multiconformers.</p><p>Collectively, these analyses revealed that qFit identifies the majority of deposited alternative conformations and discovers new ones. Discrepancies between manually modeled and qFit alternative conformations predominantly result from weak density at terminal χ angles. When considered with the improvements in R<sub>free</sub>, these results indicate that qFit is detecting more of the true underlying conformational heterogeneity that exists in crystallographic data.</p></sec><sec id="s2-3"><title>qFit improves multiple side-chain model geometry metrics</title><p>Although qFit improves the agreement of model to data by the addition of alternative conformations, we questioned whether this improvement comes at the cost of degrading model geometry. On one hand, the absence of geometric constraints in qFit backbone residue sampling and the connections made during qFit segment may result in worse geometry. On the other hand, placing additional alternative conformers may alleviate strain in the model that can result from fitting a single conformer into density that should be supported by multiple conformers (<xref ref-type="bibr" rid="bib26">Ginn, 2021</xref>; <xref ref-type="bibr" rid="bib59">Stachowski and Fischer, 2023</xref>; <xref ref-type="bibr" rid="bib52">Phenix, 2023</xref>).</p><p>To validate geometry, we used MolProbity to evaluate the deposited and qFit models. MolProbity compares input models with idealized values and then provides component scores for various geometric and steric features that are summarized in an overall ‘MolProbity score’ (<xref ref-type="bibr" rid="bib72">Williams et al., 2018</xref>). Component scores that examine all atoms (bond angle/length, clashscore) or side-chain atoms (rotamers) account for all alternative conformers. In contrast, scores that evaluate the backbone (Ramachandran, Cβ deviations) are reported for single-conformer residues or using only altloc A for multiconformer residues. Therefore, the overall MolProbity score includes some of the contributions of alternative conformations, but also misses the potential impact on some other aspects. In the future, we aim to explore updated metrics that consider all alternative conformations.</p><p>Compared to deposited models, qFit models had improved MolProbity scores (1.27 median deposited vs. 1.09 median qFit, p=0.006 from two-sided <italic>t</italic>-test; <xref ref-type="fig" rid="fig3">Figure 3A</xref>), which indicated that overall qFit improves the geometry while also usually improving fit to data. To further understand which parts of the model geometry were different (if any) between the deposited and qFit models, we explored the individual component scores and observed multiple component scores that improved in the qFit models. This included considerable improvements in bond lengths and angles in the qFit models (RMSD between idealized values for bond lengths: 0.010 Å median deposited vs. 0.007 Å median qFit, p=0.021 from two-sided <italic>t</italic>-test; RMSD between idealized values for bond angles: 1.30° median deposited vs. 0.91° median qFit, p=3.79e-16 from two-sided <italic>t</italic>-test; <xref ref-type="fig" rid="fig3">Figure 3B and C</xref>). We suspect that the primary factor behind this improvement was the incorporation of multiconformers, rather than straining a single conformer, to explain the density. To visualize an example of these differences, we investigated Met189 from PDB: 1V8F. In the deposited model, this residue has Sδ-Cε bond lengths of 1.596 Å, which are significantly shorter than the idealized lengths of 1.791 ± 0.025 Å (<xref ref-type="bibr" rid="bib72">Williams et al., 2018</xref>). qFit adds an additional conformation, both explaining previously unmodeled density and bringing the Sδ-Cε bond lengths much closer to the expected values: 1.790 Å (alternative conformer A) and 1.794 Å (alternative conformer B) for the two conformations (<xref ref-type="fig" rid="fig3">Figure 3E</xref>). This multiconformer residue with improved geometry is consistent with the hypothesis that qFit is alleviating strained geometry by modeling multiple conformations.</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>qFit improves some geometry metrics compared to deposited structures.</title><p>(<bold>A</bold>) Model MolProbity score (deposited model: 1.27 (median) [0.94–0.16] (interquartile range), qFit model: 1.09 (median) [0.90–1.30] (interquartile range)), p-value = 0.006 from two-sided <italic>t</italic>-test. (<bold>B</bold>) Model averaged root-mean-square deviation (RMSD) (Å) of idealized versus model bond lengths (deposited model: 0.010 [0.0070–0.015], qFit model: 0.0073 [0.005–0.011]), p-value = 0.002 from two-sided <italic>t</italic>-test. (<bold>C</bold>) Model averaged RMSD (Å) of idealized versus model bond angles (deposited model: 1.30 [1.14–1.57], qFit model: 0.91 [0.77–1.13]), p-value = 3.79e-16 from two-sided <italic>t</italic>-test. (<bold>D</bold>). Model clashscore (deposited model: 2.50 [1.30–5.92], qFit model: 1.80 [1.31–3.73]), p-value = 0.0028 from two-sided <italic>t</italic>-test. (<bold>E</bold>). Example of qFit (right, blue, and magenta) fixing bond length by appropriately modeling in a second conformation. Meshes represent 2Fo-Fc density at 1 σ. Met189 from deposited structure (PDB: 1VF8; left, green) has a Sδ-Cε bond length of 1.596 Å (7.8 σ from idealized length of 1.791 Å) (<xref ref-type="bibr" rid="bib72">Williams et al., 2018</xref>). qFit models two alternative conformations, filling in unmodeled density, and fixing the Sδ-Cε bond length (1.790 Å for alternative conformation A and 1.794 Å for alternative conformation B). (<bold>F</bold>) Example of qFit (right, blue, and magenta) fixing a clash between Met83 and Leu81 from deposited structure (PDB: 6HEQ). Meshes represent density at 1 σ. In the deposited model (left, green), Met83 is not correctly fitted into density and is clashing with Leu81 (closest contact: 3.0 Å). qFit corrects this by improving the fit of Met83, leading to the closest contact being 3.8 Å.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90606-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Deposited versus qFit model geometry.</title><p>(<bold>A</bold>) Count of number of Cβ deviation (&gt;0.25 Å) per model (deposited model: 0.0 median [interquartile range: 0.0–0.0], qFit model: 0.0 median [interquartile range: 0.0–0.0]), p-value = 0.37 from two-sided <italic>t</italic>-test. (<bold>B</bold>) Median count of number of rotamer outliers per model (deposited model: 0.94 [0.00–2.12], qFit model: 0.81 [0.35–1.60]), p-value = 0.73 from two-sided <italic>t</italic>-test. (<bold>C</bold>) Percent of Ramachandran favored per model: deposited model (97.70 [96.90–98.93], qFit model: 98.0 [97.05–98.97]), p-value = 0.77 from two-sided <italic>t</italic>-test. (<bold>D</bold>) Percent of Ramachandran outliers per model (deposited model 0.0 [0.0–0.0], qFit model: 0.0 [0.0–0.0]), p-value = 0.57 from two-sided <italic>t</italic>-test.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90606-fig3-figsupp1-v1.tif"/></fig></fig-group><p>Additionally, qFit models have improved clashscores (2.50 median deposited, 1.80 median qFit, p=0.0028 from two-sided <italic>t</italic>-test; <xref ref-type="fig" rid="fig3">Figure 3D</xref>). We hypothesized that this was due to a mixture of modeling of alternative conformers and improved fit of single-conformer residues which are re-sampled and refined during the qFit procedure. We looked at the qFit modeling differences in a cluster of Met and Leu residues in PDB: 6HEQ, which had one of the largest changes in clashscores between the deposited and qFit models. We observed that qFit fixes the positioning of Met83, preventing the clash with both conformers of Leu81 and improving the local fit to density (<xref ref-type="fig" rid="fig3">Figure 3F</xref>).</p><p>We observed almost equivalent rotamer scores, favored Ramachandran values, and C-beta values (median number of rotamer outliers: 0.94 deposited vs. 0.800 qFit; percentage of Ramachandran favored: 97.7% deposited vs. 97.8% qFit; median value of clashscore: 2.50 deposited vs. 1.78 qFit) (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). Overall, the MolProbity scores suggest that qFit improved the model geometry, aligning with improved model/data agreement.</p></sec><sec id="s2-4"><title>Simulated data demonstrates qFit is appropriate for high-resolution data</title><p>In the previous sections, we established that qFit has the potential to improve R<sub>free</sub> and some geometry metrics relative to deposited structures. However, the vast majority of the residues in these deposited structures are modeled exclusively as single conformers. This homogeneity in single-conformation models limited our ability to assess how well qFit can recapitulate existing alternative conformers across a wide resolution range. To address this question, we generated artificial structure factors using an ultra-high-resolution structure (0.77 Å) of the SARS-CoV-2 Nsp3 macrodomain (PDB: 7KR0) (<xref ref-type="bibr" rid="bib57">Schuller et al., 2021</xref>). This model had a high proportion of residues (47%) manually modeled as alternative conformations and did not employ qFit during model building or refinement, making it an ideal comparison structure. We refer to this structure as the ‘ground truth 7KR0 model’ and evaluated how well its alternative conformations were recapitulated by qFit as resolution was artificially worsened across synthetic datasets.</p><p>To create the dataset for resolution dependence, we used the ground truth 7KR0 model, including all alternative conformations, and generated artificial structure factors with a high-resolution limit ranging from 0.8 to 3.0 Å (in increments of 0.1 Å). We then added random noise to the structure factors that increased as resolution worsened (‘Methods’; <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1A, B</xref>). To create a single-conformer model appropriate for input to qFit, we removed all alternative conformations from the ground truth model, maintaining all single conformations and altloc A. Next, we refined this single-conformer model against the synthetic datasets. Finally, we used the refined single-conformer model as input for qFit.</p><p>We then turned to evaluate the fidelity of qFit in recapitulating the ground truth 7KR0 model. For each residue, we first classified the residue as being a multiconformer or single conformer. Due to many residues in both the ground truth and qFit models having alternative conformations that nearly overlap each other, we categorize residues as multiconformer only if they possess at least two alternative conformers with a side-chain heavy-atom RMSD greater than 0.5 Å. From this cutoff, 50 out of the 169 residues (30%) in the ground truth model are classified as multiconformers.</p><p>Next, we define each residue as having an agreement between the outputted qFit model and the ground truth 7KR0 model. If all qFit modeled conformers are within 0.5 Å of the deposited 7KR0 model, we classify it as a match. If not, we classify it as no match. A ‘multiconformer match’ has agreement between multiconformers across ground truth and qFit models; a ‘single conformer match’ has agreement between single conformers in the ground truth and qFit models. Generally, a ‘multiconformer no match’ has extra or distinct conformations in the qFit model; a ‘single conformer no match’ has at least one alternative conformation in the ground truth model that is not present in the qFit model or discordant single-conformer conformations.</p><p>We observed that qFit is consistently strong at capturing single-conformer residues (single conformer match) across resolutions. We did observe a drop off of detecting alternative conformations (multiconformer match) beyond resolutions of ~1.8–2.0 Å (<xref ref-type="fig" rid="fig4">Figure 4B</xref>, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1C</xref>). This behavior is exemplified by Glu114, which is multiconformer in the ground truth model (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). At high resolution (1.0 Å), qFit correctly models the alternative conformation and this residue is categorized as a multiconformer match. However, as resolution gets worse, qFit begins to mismodel this residue. At 1.8 Å resolution, qFit still models two alternative conformations and has a good fit to density; however, the secondary conformer has an RMSD greater than 0.5 Å away from the ground truth model; consequently, this residue is now categorized as a multiconformer no match. Finally, at 2.8 Å resolution, qFit only models a single conformer, moving the residue to the single conformer no match category.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>qFit performs best at high resolution of input dataset.</title><p>(<bold>A</bold>) Ground truth model residues are shown as green and yellow sticks; qFit model residues are shown as magenta, cyan, and gray. Meshes represent density at 1 σ. Multiconformer match: residue is multiconformer in qFit model with root-mean-square deviation (RMSD) &lt; 0.5 Å from ground truth residue. qFit models two distinct alternate conformations which recapitulate the ground truth residue’s alternate conformations. Multiconformer no match: residue is multiconformer in qFit model with RMSD &gt; 0.5 Å from ground truth residue. The example on the left has two alternate conformations in the ground truth. qFit models only one of them correctly. The example on the right is a single-conformation residue in ground truth but qFit models three alternate conformations. Single conformer match: residue is single-conformer in qFit model with RMSD &lt; 0.5 Å from ground truth residue. Both ground truth model and qFit model have one distinct conformation and they align well. Single conformer no match: residue is single conformer in qFit model with RMSD &gt; 0.5 Å from ground truth residue. The example on the left has two alternative conformations in the ground truth residue but only one conformation in the qFit residue. In the example on the right, the single conformer modeled by qFit does not align with the ground truth single conformer. (<bold>B</bold>) Proportion of all residues in the qFit models of 7KR0 that are modeled as multiconformer match (orange), single conformer match (blue), multiconformer no match (green), and single conformer no match (red) as a function of resolution of input synthetic data from the 7KR0 dataset. The shaded region denotes the 95% confidence interval. (<bold>C</bold>) Glu114 in the 7KR0 dataset modeled by qFit (cyan and magenta) compared to the ground truth structure (green and yellow) at different synthetic resolutions. Meshes represent density at 1 σ. (<bold>D</bold>) The fraction of residues in the qFit models of the qFit test dataset with a Q-score within 0.01 to that of the ground truth model as a function of resolution. In multiconformer residues, Q-score for every alternative conformation is calculated separately. Q-scores of residues (or) conformers which have matching occupancy (range) are compared. Occupancies of conformers were binned into three classes: occupancy equal to 1 (blue), 1 &gt; occupancy ≥ 0.5 (orange) and occupancy &lt; 0.5 (green).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90606-fig4-v1.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Synthetic dataset generation and validation.</title><p>(<bold>A</bold>) Protocol for generating synthetic structure factors at various resolutions starting from the ground truth model. For the 7KR0 dataset, all the steps starting from random shaking of coordinates were done 10 times for each resolution. For the larger test dataset, all steps were only done once. (<bold>B</bold>) A visualization of synthetic maps generated for the models at varying resolution. The loss in detail of density is clearly visible with worsening resolution. (<bold>C</bold>) Proportion of all residues in qFit models which have been modeled as multiconformers in the 7KR0 dataset as a function of resolution. The shaded region around the line indicates the spread across 10 runs at every resolution step. (<bold>D</bold>) Proportion of all residues in the qFit models of qFit test dataset which are modeled as multiconformer match (orange), single conformer match (blue), multiconformer no match (green), and single conformer no match as a function of resolution of input data. The shaded region around the lines indicates the spread across the qFit test dataset which consists of 103 proteins.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90606-fig4-figsupp1-v1.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 2.</label><caption><title>Synthetic dataset statistics breakdown.</title><p>(<bold>A</bold>) The distribution of root-mean-square deviation (RMSD) between qFit residues and corresponding ground truth residues (qFit test set) whenever the RMSD is higher than the 0.5 Å cutoff, resulting in the qFit residues being classified as multiconformer no match. (<bold>B</bold>) The propensity of each residue type to be modeled with high RMSD from the ground truth (qFit test set), resulting in being classified as multiconformer no match. This propensity of a residue type x is calculated as the ratio between (i) proportion of residue type x among all the residues with a high RMSD and (ii) proportion of residue type x in the entire dataset. (<bold>C</bold>) The distribution of RMSD between qFit residues and corresponding ground truth residues (qFit test set) whenever the RMSD is higher than the 0.5 Å cutoff, resulting in the qFit residues being classified as single conformer no match. (<bold>D</bold>) The propensity of each residue type to be modeled with high RMSD from the ground truth (qFit test set), resulting in being classified as single conformer no match.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90606-fig4-figsupp2-v1.tif"/></fig><fig id="fig4s3" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 3.</label><caption><title>Comparison of R<sub>free</sub> statistic and occupancy across synthetic dataset.</title><p>(<bold>A</bold>) R<sub>work</sub> (blue) and R<sub>free</sub> (orange) distribution of the input model from the qFit test dataset. These correspond to the models obtained after refining against F<sub>noisy</sub> structure factors (see <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). The shaded region around the lines indicates the spread (standard deviation) across the qFit test dataset. (<bold>B</bold>) Fraction of correctly modeled qFit residues (match multiconformer + match single conformer) as a function of input model R<sub>free</sub> for all structures in the qFit test dataset at 1.6 Å resolution (input R<sub>free</sub> range: 0.17–0.25, n = 103). The shaded region denotes the 95% confidence interval. (<bold>C</bold>) The fraction of residues in the qFit models of the 7KR0 dataset with a Q-score within 0.01 of that of the ground truth model as a function of resolution. In multiconformer residues, Q-score for every alternate conformer is calculated separately. Q-scores of residues (or) conformations which have matching occupancy (range) are compared. Occupancy of conformations were binned into three classes: occupancy equal to 1 (blue), 1 &gt; occupancy ≥ 0.5 (orange), and occupancy &lt;0.5 (green).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90606-fig4-figsupp3-v1.tif"/></fig></fig-group></sec><sec id="s2-5"><title>Simulated multiconformer data illustrate the convergence of qFit</title><p>Next, we tested the ability of qFit to detect alternative conformations over a larger, more diverse dataset. We generated artificial structure factors for the qFit models with improved R<sub>free</sub> values over the deposited values from the previous sections (n = 109). Although this dataset is more diverse, it has a notable weakness relative to the 7KR0 dataset test: the 7KR0 alternative conformations were modeled manually, whereas the larger dataset has alternative conformations modeled by qFit. Therefore, this second synthetic dataset assesses convergence of the qFit models across resolution.</p><p>Using these qFit models as ground truth models, we generated structure factors, performed refinement of single-conformer models, and ran qFit over the resolution range of 1.0–3.0 Å (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1A</xref>). We observed a similar fall-off of multiconformer match residues around 2.0 Å (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1D</xref>). Importantly, this dataset indicates that qFit still models single conformers well at lower resolutions. We also observe a trend of increased no match multiconformers/single conformers for longer residues that are just outside the 0.5 Å RMSD cutoff (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>). We did not observe a relationship between input model R<sub>free</sub> and the number of correctly modeled conformers, but it is difficult to tell whether our synthetic noise procedures properly capture the dependence of qFit performance on input model/data agreement (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3A and B</xref>).</p><p>We then assessed the agreement between individual conformers and the map. To do this, we used the Q-score (<xref ref-type="bibr" rid="bib53">Pintilie et al., 2020</xref>), which compares the map profile of an atom with an ideal Gaussian distribution that would be observed if the atom perfectly fits into the density. Across the test dataset, residues that qFit models as single conformers have an almost equivalent Q-score to the ground truth model even at lower resolutions (<xref ref-type="fig" rid="fig4">Figure 4D</xref>). The primary alternative conformations in qFit models (occupancy between 0.5 and 1.0) and lower-occupancy alternative conformations (occupancy &lt; 0.5) display Q-scores that are very close to the equivalent ‘ground truth model’ alternative conformations until a resolution of about 1.8 Å. At lower resolutions, there is a dramatic fall-off in model/map agreement for these alternative conformers. These trends were also observed with the 7KR0 dataset (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3C</xref>). Overall, these analyses on both the 7KR0 and larger synthetic datasets confirm that qFit will best detect alternative conformations with high-resolution (1.8–2.0 Å or better) data.</p></sec><sec id="s2-6"><title>qFit models alternative conformers in cryo-EM density maps</title><p>As single-particle cryo-EM is increasingly producing high-resolution (better than 2 Å) reconstructions where alternative conformers can be detected (<xref ref-type="bibr" rid="bib47">Nakane et al., 2020</xref>; <xref ref-type="bibr" rid="bib76">Xie et al., 2020</xref>), we wanted to improve and test the ability of qFit to model alternative conformations guided by cryo-EM maps. While a previous version of qFit introduced cryo-EM compatibility (<xref ref-type="bibr" rid="bib55">Riley et al., 2021</xref>), we had not optimized the approach to work with cryo-EM maps and models. qFit can now be run in ‘EM mode’ which uses electron structure factors, improves the treatment of solvent background levels, and reduces the default maximum number of alternative conformations (cardinality) (‘Methods’).</p><p>To benchmark our ability to model alternative conformations in high-resolution cryo-EM structures, we initially gathered a dataset of 22 structures with a depositor-provided resolution better than 2 Å (Fourier shell correlation [FSC] at 0.143). However, only eight of these structures have a resolution better than 2 Å (FSC at 0.143) when calculated by the Electron Microscopy Data Bank (EMDB) (<xref ref-type="bibr" rid="bib12">Chiu et al., 2021</xref>). Some of the original 22 structures did not have FSC curves in EMDB (n = 6) due to a lack of data, and others had an EMDB calculated resolution worse than 2 Å (n = 8) (<xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>). The absence of standardized maps for determining cryo-EM structure resolution complicated our selection of structures for qFit analysis.</p><p>We downloaded the eight models with resolution better than 2 Å from the PDB and their corresponding maps from EMDB. Using the default parameters of <italic>phenix.autosharpen</italic>, we sharpened all maps and re-refined each structure (<italic>phenix.real_space_refine</italic>) against its sharpened map. qFit was run with the ‘EM’ flag and the output model was refined using the qFit real space refinement script (‘Methods’).</p><p>Across the first asymmetric unit of the eight models, 8.21% (n = 64) of residues in the deposited model had at least two alternative conformers in the deposited structure compared with 39.6% (n = 266) in the qFit model. To determine whether qFit could recapitulate the modeling of alternative conformers from deposited structures, we compared the high-resolution apoferritin deposited model (PDB: 7A4M, resolution: 1.22 Å) with the qFit model using the same criteria outlined in the resolution dependence section above (RMSD within 0.5 Å). qFit correctly models 77% of residues in the first asymmetric unit. This includes Arg22, which has two alternative conformations in the deposited model. qFit was able to recapitulate both alternative conformations (<xref ref-type="fig" rid="fig5">Figure 5A</xref>), highlighting that qFit can detect manually modeled alternative conformations in cryo-EM maps. In addition, qFit detected several unmodeled alternative conformers that were visually confirmed (<xref ref-type="fig" rid="fig5">Figure 5B–D</xref>).</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>qFit identifies alternative conformations in high-resolution cryo-EM models.</title><p>Meshes represent density at 1 σ, with blue volumes representing density at 0.5 σ. Green and yellow sticks represent deposited conformation(s). Cyan and magenta sticks represent qFit conformations. Occupancy is labeled based on each conformer. (<bold>A</bold>) qFit recapitulated the deposited alternative conformations of Arg22 (chain A) in apoferritin (PDB: 7A4M, resolution: 1.22 Å). (<bold>B</bold>) qFit identified a previously unmodeled alternative conformation of Glu14 (chain A) in apoferritin (PDB: 7A4M, resolution: 1.22 Å). (<bold>C</bold>) qFit identified a previously unmodeled alternative conformation of Lys49 (chain A) in a different structure of apoferritin (PDB: 6Z9E, resolution: 1.55 Å). (<bold>D</bold>) qFit identified a previously unmodeled alternative conformation of Gln403 (chain A) in adeno-associated virus (PDB: 7KFR, resolution: 1.56 Å).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90606-fig5-v1.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>qFit improes some geometry metrics in cryo-EM models.</title><p>(<bold>A</bold>) MolProbity score (deposited model: 1.49 (median) [1.40–1.61] (interquartile range), qFit model: 1.59 (median) [1.39–1.92] (interquartile range)). (<bold>B</bold>) Model average of RMSD of model bond length from idealized bond length (Å) (deposited model: 0.00 [0.00–0.01], qFit model: 0.00 [0.00–0.00]). (<bold>C</bold>) Model average of RMSD of model bond angle from idealized bond angle (Å) (deposited model: 0.00 [0.00–0.11], qFit model: 0.00 [0.00–0.01]). (<bold>D</bold>) Number of residues with clashscore (deposited model: 3.15 [2.74–4.39], qFit model: 8.45 [3.22–10.17]). (<bold>E</bold>) Number of Cβ deviation (&gt;0.25 Å) per model (deposited model: 0.02 [0.00–0.02], qFit model: 0.00 [0.00–0.00]). (<bold>F</bold>) Number of rotamer outliers per model (deposited model: 2.0 [2.0–2.0], qFit model: 2.0 [1.0–3.0]). (<bold>G</bold>) Percent of Ramachandran favored per model (deposited model: 97.6 [96.9–98.9], qFit model: 98.3 [96.7–98.7]).(<bold>H</bold>) Percent of Ramachandran outliers per model (deposited model: 0.0 [0.0–0.0], qFit model: 0.0 [0.0–0.0]).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90606-fig5-figsupp1-v1.tif"/></fig></fig-group><p>As with the X-ray models, we wanted to determine how qFit changes the model geometry. Similar to the X-ray models, we observed that qFit improves bond lengths and angles, and similar Cβ deviations. Unlike the observations in the X-ray dataset, qFit does increase (worsen) the MolProbity score, likely coming from high clashscore of most structures, highlighting a future improvement in the algorithm (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>).</p><p>While we have made significant progress in modeling alternative conformations in cryo-EM data, the lack of consistent map handling, validation, and metrics with cryo-EM structures and maps is a major impediment to further development. Even among this select group of structures, there were varying levels of experimental and computational map details on EMDB and in manuscripts (<xref ref-type="bibr" rid="bib47">Nakane et al., 2020</xref>; <xref ref-type="bibr" rid="bib76">Xie et al., 2020</xref>; <xref ref-type="bibr" rid="bib78">Yip et al., 2020</xref>), including information on masking, handling of bulk solvent, and local resolution. Our approach depends on sampling and scoring based on resolution. While there is an accepted formula for calculating resolution (FSC at 0.143), the maps to calculate these are not consistent, leading to differences in resolution as we observed between the deposited versus EMDB calculated resolutions. Further, resolution can vary across a single model, and metrics for such local resolutions are not always widely available. Additionally, the handling of background bulk solvent values varies widely, from masking to flattening these values. New methods for cryo-EM ensemble modeling will benefit from ongoing efforts to standardize the storage of raw, meta, and processed data (<xref ref-type="bibr" rid="bib40">Kleywegt et al., 2024</xref>).</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Structural biology plays a vital role in understanding the complex connection between protein structure and function. However, since proteins exist as ensembles, structural biology modeling approaches need to adapt accordingly. X-ray crystallography and cryo-EM data hold significant information on these ensembles that is often ignored. qFit offers a solution by leveraging powerful optimization algorithms to transform well-modeled single-conformer models into multiconformer models. Here we demonstrate that qFit can uncover widespread conformational heterogeneity that better represents the true underlying conformational ensemble data as demonstrated by lower R<sub>free</sub> values. Further, we determine that qFit can reliably pick up on alternative conformers that were modeled manually, highlighting that qFit could be used as a tool to significantly speed up modeling of high-resolution structures.</p><p>This automation in modeling is needed especially in light of advances in data collection automation and fast detectors. These tools have revolutionized the field of X-ray crystallography, enabling high-temperature datasets, time-resolved experiments, and high-throughput data collection (<xref ref-type="bibr" rid="bib75">Wolff et al., 2022</xref>; <xref ref-type="bibr" rid="bib14">Dasgupta et al., 2019</xref>; <xref ref-type="bibr" rid="bib13">Correy et al., 2022</xref>; <xref ref-type="bibr" rid="bib45">Mehlman et al., 2022</xref>; <xref ref-type="bibr" rid="bib19">Ebrahim et al., 2021</xref>). With the ability to capture different conformations, there is a growing demand for methods that can detect protein alternative conformers to extract as much biological information as possible. This is highlighted in massive ligand-soaking campaigns (<xref ref-type="bibr" rid="bib57">Schuller et al., 2021</xref>; <xref ref-type="bibr" rid="bib25">Gahbauer et al., 2023</xref>; <xref ref-type="bibr" rid="bib18">Douangamath et al., 2020</xref>; <xref ref-type="bibr" rid="bib29">Günther et al., 2021</xref>), where there are often hundreds of structures with different ligands to parse. qFit provides a key tool to help extract the most out of these structures by improving the models and providing a better jumping-off point to determine how ligand binding impacts the protein. However, our data here show that not only does qFit need a high-resolution map to be able to detect signal from noise, it also requires a very well-modeled structure as input.</p><p>While both throughput and resolution are currently lower for cryo-EM, recent high-resolution maps have observable conformational heterogeneity (<xref ref-type="bibr" rid="bib47">Nakane et al., 2020</xref>; <xref ref-type="bibr" rid="bib78">Yip et al., 2020</xref>). Current classification approaches do not allow sorting based on signals as small as alternative side-chain conformations (<xref ref-type="bibr" rid="bib80">Zhong et al., 2021</xref>; <xref ref-type="bibr" rid="bib10">Chen and Ludtke, 2021</xref>; <xref ref-type="bibr" rid="bib39">Kinman et al., 2023</xref>), necessitating approaches like qFit for modeling. We see great potential in combining qFit with classification approaches to understand conformational heterogeneity at different scales. In the future, qFit can likely be applied more widely to EM maps in regions with high local resolution (<xref ref-type="bibr" rid="bib60">Terashi et al., 2022</xref>). In addition, we will also incorporate modeling of nucleic acids, with an emphasis on automating refinement of alternative base positions in high-resolution ribosome structures in future work (<xref ref-type="bibr" rid="bib43">Li et al., 2020</xref>; <xref ref-type="bibr" rid="bib23">Fromm et al., 2023</xref>; <xref ref-type="bibr" rid="bib32">Hintze et al., 2017</xref>). However, we encountered many difficulties in applying qFit to EM data relative to the more established X-ray data. In particular, there are still disparities in how maps are sharpened and how masks are used to exclude noise or lower experimental signals, such as solvent (<xref ref-type="bibr" rid="bib66">Wang et al., 2022</xref>; <xref ref-type="bibr" rid="bib42">Lawson et al., 2021</xref>), making it very challenging to evaluate whether models, especially multiconformer or ensemble models, have improved fit to the data. We suggest strengthening guidelines for reporting computational processing and improving validation tools to gauge agreement between models and cryo-EM maps (<xref ref-type="bibr" rid="bib66">Wang et al., 2022</xref>; <xref ref-type="bibr" rid="bib42">Lawson et al., 2021</xref>; <xref ref-type="bibr" rid="bib7">Burley et al., 2022</xref>).</p><p>We envision many other future improvements that will further enhance the quality and accuracy of multiconformer models for both X-ray crystallography and cryo-EM. Simulations have demonstrated that subpar modeling of the macromolecule(s) and surrounding solvent is a major potential avenue to further reduce R-factors (<xref ref-type="bibr" rid="bib33">Holton et al., 2014</xref>; <xref ref-type="bibr" rid="bib65">Vitkup et al., 2002</xref>). To accurately account for water molecules in multiconformer models, partially occupied water molecules must be identified and labeled in connection with protein atoms. Automated detection and refinement of partial-occupancy waters should help improve fit to experimental data (<xref ref-type="bibr" rid="bib71">Weichenberger et al., 2015</xref>) and provide additional insights into hydrogen-bond patterns and the influence of solvent on alternative conformations (<xref ref-type="bibr" rid="bib71">Weichenberger et al., 2015</xref>).</p><p>Additionally, while qFit models have overall improved geometry in some respects relative to single-conformer models, we still have room for improvement for fixing backbone metrics (Ramachandran and Cβ deviations). The geometry improvements are likely mostly due to single-conformer models having strained conformations that fit the ‘mean’ conformation rather than multiple partially overlapping conformations. Further gains in both accuracy and geometry quality will emerge with better sampling of backbone conformations (<xref ref-type="bibr" rid="bib37">Keedy et al., 2015</xref>). Such improvements are important because splitting the backbone, where appropriate, can result in detection of biologically important side-chain alternative conformations (<xref ref-type="bibr" rid="bib15">Davis et al., 2006</xref>). Notably, the recently described FLEXR approach, which leverages Ringer and Coot to model alternative side chains into density peaks, illustrates that many gains can be made with side-chain focused modeling alone (<xref ref-type="bibr" rid="bib59">Stachowski and Fischer, 2023</xref>). However, further improvements to backbone modeling, including larger-scale motions such as alternative loop conformations (<xref ref-type="bibr" rid="bib6">Biel et al., 2017</xref>) or coordinated larger-scale shifts of secondary-structural elements (<xref ref-type="bibr" rid="bib16">Deis et al., 2014</xref>; <xref ref-type="bibr" rid="bib21">Fraser et al., 2011</xref>), will likely yield even higher-quality multiconformer models.</p><p>Lastly, experimental and computational advancements in structural biology have increased the focus on ensemble-based models (<xref ref-type="bibr" rid="bib26">Ginn, 2021</xref>; <xref ref-type="bibr" rid="bib55">Riley et al., 2021</xref>; <xref ref-type="bibr" rid="bib10">Chen and Ludtke, 2021</xref>; <xref ref-type="bibr" rid="bib39">Kinman et al., 2023</xref>; <xref ref-type="bibr" rid="bib51">Pearce and Gros, 2021</xref>). But the current data format for structural models (PDB, mmCIF) does not allow for more complex representation of ensembles. qFit is compatible with manual modification and further refinement as long as the subsequent software uses the PDB standard altloc column, as is common in most popular modeling and refinement programs. The models can therefore generally also be deposited in the PDB using the standard deposition and validation process. However, to even more appropriately capture the many aspects of ensembles, we would ideally like to have multiple nested ensembles representing both larger and local conformational changes, or to be able to show how two different backbone conformations can each be ‘parents’ to different side-chain conformations (<xref ref-type="bibr" rid="bib68">Wankowicz and Fraser, 2024</xref>). Currently, neither the PDB nor CIF format allows for this type of representation (<xref ref-type="bibr" rid="bib30">Hancock et al., 2022</xref>; <xref ref-type="bibr" rid="bib50">Pearce et al., 2017</xref>; <xref ref-type="bibr" rid="bib62">Vallat et al., 2023</xref>).</p><p>In summary, qFit drastically reduces the time and effort required to create multiconformer models from X-ray and cryo-EM data, thereby lowering the barrier to generating new hypotheses about the relationship between conformational ensembles and biological function (<xref ref-type="bibr" rid="bib38">Keedy et al., 2018</xref>; <xref ref-type="bibr" rid="bib67">Wankowicz et al., 2022</xref>; <xref ref-type="bibr" rid="bib49">Otten et al., 2018</xref>; <xref ref-type="bibr" rid="bib79">Zaragoza et al., 2023</xref>). Additionally, qFit can provide key data to bridge to the next frontier of structure prediction. While AlphaFold (<xref ref-type="bibr" rid="bib34">Jumper et al., 2021</xref>) has achieved stunning success in predicting protein structure by training against single-conformation models, future improvements to structure prediction might be gained by more accurately modeling the extent of conformational heterogeneity (<xref ref-type="bibr" rid="bib41">Lane, 2023</xref>).</p></sec><sec id="s4" sec-type="methods"><title>Methods</title><sec id="s4-1"><title>Generating and running the qFit test set</title><p>To test the impact of algorithmic changes in qFit, we created a dataset of 144 high-resolution (1.2–1.5 Å) X-ray crystallography structures deposited in the PDB (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>). These were single-chain protein structures (in the asymmetric unit and at the level of biological assembly) and contained no ligands or mutations. The maximum sequence identity between any two structures was set as 30%. Based on CATH classification (<xref ref-type="bibr" rid="bib48">Orengo et al., 1997</xref>), the resultant entries represented 72 folds (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>). The structures represented 24 space groups. All these structures were re-refined as described in ‘Initial refinement protocol’. These re-refined models are referred to as deposited models. To create multiconformer models, we input the re-refined structures in qFit protein, followed by the post qFit refinement protocol. These multiconformer models are referred to as qFit models.</p></sec><sec id="s4-2"><title>Initial refinement protocol</title><p>All structures from the PDB were re-refined using <italic>phenix.refine</italic> with the following parameters:</p><list list-type="simple"><list-item><p><italic>refinement.refine.strategy=*individual_sites *individual_adp *occupancies</italic></p></list-item><list-item><p><italic>refinement.output.serial=5</italic></p></list-item><list-item><p><italic>refinement.main.number_of_macro_cycles=5</italic></p></list-item><list-item><p><italic>refinement.main.nqh_flips = False</italic></p></list-item><list-item><p><italic>refinement.output.write_maps = False</italic></p></list-item><list-item><p><italic>refinement.hydrogens.refine=riding</italic></p></list-item><list-item><p><italic>refinement.main.ordered_solvent = True</italic></p></list-item><list-item><p><italic>refinement.target_weights.optimize_xyz_weight = true</italic></p></list-item><list-item><p><italic>refinement.target_weights.optimize_adp_weight = true</italic></p></list-item></list><p>The re-refined models were used as the input for subsequent qFit models.</p><sec id="s4-2-1"><title>Running qFit</title><p>For this analysis, qFit was run using the following command from qFit version 2023.1.</p></sec><sec id="s4-2-2"><title>X-ray</title><p><italic>qfit_protein composite_omit_map.mtz -l 2FOFCWT,PH2FOFCWT rerefine_pdb.pdb</italic>.</p></sec><sec id="s4-2-3"><title>Cryo-EM</title><p><italic>qfit_protein sharpened_map.ccp4 rerefine_cryo-EM.pdb -r &lt;resolution&gt; -em -n 10 -s 5</italic>.</p></sec></sec><sec id="s4-3"><title>qFit new features</title><sec id="s4-3-1"><title>Parallelization of large maps</title><p>Often, cryo-EM maps are very large and reach memory limits using Python multiprocessing. Multiprocessing is used to model multiple residues independently in parallel. We have now implemented a new scheme to divide the density map into portions centered around each residue of interest and feed those portions of the map into our parallelization.</p></sec><sec id="s4-3-2"><title>B-factor sampling</title><p>To sample B-factors along with atomic coordinates at each step of qFit residue, we first perform one round of quadratic programming to reduce the number of conformations. For all remaining conformations, the input B-factor of each atom in the residue is multiplied by 0.5–1.5 in increments of 0.2. All conformations with sampled B-factors and coordinates are inputs for MIQP.</p></sec><sec id="s4-3-3"><title>Bayesian information criteria</title><p>BIC was implemented in the final selection of residue and segment conformations. BIC is defined as the real space residual correlation coefficient penalized by the number of parameters (k):</p><list list-type="simple"><list-item><p><italic>BIC = n * np.log(rss / n)+k * np.log(n) * 0.95</italic></p></list-item><list-item><p><italic>rss = residual sum of squares</italic></p></list-item><list-item><p><italic>n = number of datapoints</italic></p></list-item><list-item><p>In qFit residue, k is defined as</p></list-item><list-item><p><italic>k = 4 * number of atoms * number of conformations</italic></p></list-item><list-item><p>In qFit segment, k is defined as</p></list-item><list-item><p><italic>k = number of conformations</italic></p></list-item></list><p>BIC is calculated for each candidate cardinality (1–5). We then choose the set of conformations with the lowest BIC as the final conformations for the residue or segment under consideration.</p></sec><sec id="s4-3-4"><title>Iterative optimization algorithm with non-convex problems</title><p>Due to our exhaustive sampling, there are times when the MIQP optimization algorithm fails to find a non-convex solution. To address this limitation, we have implemented a procedure that iteratively removes solutions one-by-one based on the two solutions with the closest RMSD until MIQP identifies a solution.</p></sec><sec id="s4-3-5"><title>Implementation of open-source QP/MIQP algorithms</title><p>qFit previously relied on IBM CPLEX to score conformations. While this is free to academics, it is not open source. We have switched to CVXPY, an open-source QP and MIQP solver (<xref ref-type="bibr" rid="bib3">Agrawal et al., 2018</xref>; <xref ref-type="bibr" rid="bib17">Diamond and Boyd, 2016</xref>).</p></sec><sec id="s4-3-6"><title>Occupancy constraints</title><p>To help refine segments (i.e., sets of residues with alternative conformations flanked by residues with only a single conformation) during X-ray refinement, we now output a restraint file at the end of the qFit protein run for X-ray refinement. This restraint file enables ‘group occupancy refinement’ for residues in a segment with the same alternative conformation. In group occupancy refinement, all residues within the group are refined to the same occupancy, reducing the free parameters to fit.</p></sec><sec id="s4-3-7"><title>Finalizing qFit models with iterative refinement</title><p>We iteratively run five macrocycles of refinement followed by a script that removes any conformations with occupancy less than 0.10. This script also renormalizes the occupancies of any remaining conformations in that segment, ensuring that the occupancy sums to 1. This procedure ends when no conformations have a refined occupancy of less than 0.10 or after 50 total rounds of refinement (whichever comes first). Afterward, we perform one final refinement where we release the occupancy constraints on the segments, turn on automated solvent picking, and optimize B-factors (specified as ADP parameters in Phenix) and coordinate weights.</p></sec><sec id="s4-3-8"><title>Cryo-EM</title><p>To improve the detection of alternative conformations in cryo-EM structures, we made some key updates to part of the qFit algorithm. All of these updates to the algorithm will turn on with the <italic>-em</italic> flag. First, we now use electron scattering factors when calculating the modeled electron density. Second, we have removed bulk solvent electron density values (set at 0.3 in X-ray qFit protein). We also restricted the occupancy threshold cardinality to be 0.3 (compared to 0.2 in X-ray qFit protein) to reduce misplaced conformations.</p></sec><sec id="s4-3-9"><title>Q-score</title><p>We implemented the option for users to use Q-scores to determine whether qFit should be run on a residue or not. This option is off by default. To utilize this feature, first generate Q-scores by using the <italic>mapq.py</italic> script, which is included in the Q-score command-line interface package (<ext-link ext-link-type="uri" xlink:href="https://github.com/gregdp/mapq">https://github.com/gregdp/mapq</ext-link>, copy archived at <xref ref-type="bibr" rid="bib28">gregdp, 2023</xref>). qFit takes in a text file of Q-scores by using the <italic>–qscore</italic> option in <italic>qFit_protein</italic>. By default, all residues with a Q-score of less than 0.7 are not modeled as multiconformers, but are considered in qFit segment. Users can also adjust this level by using the <italic>–qscore_cutoff</italic> option in qFit protein.</p></sec><sec id="s4-3-10"><title>qFit-segment-only runs</title><p>qFit can be used as a tool along with iterative model building and refinement. If a user manually removes or adds additional conformations using Coot (<xref ref-type="bibr" rid="bib20">Emsley et al., 2010</xref>) or similar software, this can disrupt the occupancy sum of the residue and the connectivity of the backbone. To alleviate such problems, we developed an option (<italic>qfit_protein –only-segment</italic>) to facilitate manual model adjustment after running qFit. This procedure generates connected backbones with consistent occupancies for coupled neighboring conformers.</p><p>For example, suppose residue n has four alternative backbone conformations (A, B, C, D) and residue n+1 has two alternative conformations (A, B). In that case, this procedure will create C and D conformers for residue n+1 by duplicating its A and B conformers. This duplication continues until we reach the end of a segment so that all backbones have the same number of alternative conformations (A, B, C, D) and are, therefore, properly connected. Subsequent crystallographic refinement of this model (see ‘Post-qFit refinement script’ above) will cause the duplicated conformations to diverge slightly and will behave as expected without introducing geometry errors.</p></sec></sec><sec id="s4-4"><title>Analysis metrics</title><p>Scripts for all metrics can be found in the scripts folder in the qFit GitHub repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/ExcitedStates/qfit-3.0">https://github.com/ExcitedStates/qfit-3.0</ext-link>, copy archived at <xref ref-type="bibr" rid="bib70">Wankowicz et al., 2024</xref>). Our scripts for running qFit protein on an SGE-based server and all scripts for figures can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/fraser-lab/qFit_biological_testset/tree/main">https://github.com/fraser-lab/qFit_biological_testset/tree/main</ext-link> (copy archived at <xref ref-type="bibr" rid="bib69">Wankowicz and Ravikumar, 2024</xref>).</p><sec id="s4-4-1"><title>R-values</title><p>R-values were obtained after the final round of refinement for the re-refined deposited models (<italic>deposited_rerefine.sh</italic>) and for the qFit models after the iterative refinementscript (<italic>qfit_final_xray_refine.sh</italic>).</p></sec><sec id="s4-4-2"><title>B-factors</title><p>For each residue, we calculate an occupancy weighted B-factor (each heavy atom B-factor is weighted by its occupancy). For each heavy atom, we calculate the weighted using the following formula:</p><list list-type="simple"><list-item><p><italic>Occupancy Weighted B-factor=Occupancy *(4*pi/B-factor)</italic><sup>1.5</sup></p></list-item></list></sec><sec id="s4-4-3"><title>Rotamers</title><p>The rotamer name for each alternative conformation was determined by <italic>phenix.rotalyze (</italic><xref ref-type="bibr" rid="bib72">Williams et al., 2018</xref>) while manually relaxing the outlier criteria to 0.1%. Rotamers were compared on a residue-by-residue basis. To compare rotamers, we only consider the first two χ dihedral angles. Each residue was classified into four categories: same, additional rotamer in qFit model, additional rotamer in the deposited model, or different.</p></sec></sec><sec id="s4-5"><title>Generating synthetic data for resolution dependence</title><p>To generate artificial electron density data at increasingly poorer resolutions, we first increased the B-factors of all atoms of the ground truth model by 1 Å<sup>2</sup> for every 0.1 Å reduction in resolution and placed the models in a P1 box. We randomly shook the coordinates using the <italic>shake</italic> argument in <italic>phenix.pdbtools</italic> with root-mean-square error of shaking given as 0.2 * desired resolution of synthetic data. We generated structure factors (F<sub>shake</sub>) for each of these shaken models from 0.8 Å to 3.0 Å in increments of 0.1 Å using the <italic>phenix.fmodel</italic> command-line function (with bulk solvent parameters k_sol = 0.4, b_sol = 45, and 5% R-free flags). We then added noise to the structure factors as follows:</p><list list-type="simple"><list-item><p><italic>F</italic><sub><italic>noisy</italic></sub> <italic>= F</italic><sub><italic>shake</italic></sub> <italic>+ (sqrt(F</italic><sub><italic>shake</italic></sub><italic>) * random number from normal distribution * resolution of model</italic> * 0.5)</p></list-item></list><p>The scaling factors of 0.2 and 0.5 for shake RMSD and noise addition were determined by trying out different values and identifying the values which gave the lowest R<sub>free</sub> over the resolution range after refining the model against the generated structure factors. The addition of noise to F<sub>shake</sub> was done using the <italic>sftools</italic> command in CCP4 (<xref ref-type="bibr" rid="bib73">Winn et al., 2011</xref>). Then, the ground truth model with adjusted B-factors was stripped of alternative conformations (if any) at every residue position. The resulting single-conformer model was refined with the F<sub>noisy</sub> structure factors (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>).</p><p>The final refined model was given as input to qFit and the composite omit map was obtained for the F<sub>noisy</sub> structure factors. The multiconformer model given by qFit was refined with <italic>phenix.refine</italic> as explained in the post-qFit refinement script section. Since there is some randomness involved in simulating noise in the synthetic datasets, at each resolution, we generate 10 synthetic datasets and apply the qFit protocol to each one. The same steps of data synthesis were followed for the larger qFit test dataset containing 103 models, except that one set of structure factors was generated for each model at each resolution instead of 10 as in the 7KR0 dataset.</p></sec><sec id="s4-6"><title>Match classifications for synthetic data</title><p>Match multiconformer residues were those with at least two alternative conformations and an RMSD of less than 0.5 Å between the ground truth and qFit model conformations (e.g., qFit model altloc A has an RMSD of less than 0.5 Å to ground truth model altloc A or B, and qFit model altloc B has an RMSD of less than 0.5 Å to the other ground truth model altloc A or B) (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). No match multiconformer residues have at least two alternative conformations in the qFit model, but fewer conformations in the ground truth model (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). Alternatively, for a no match multiconformer residue, if the ground truth model residue is also multiconformer, then the RMSD between at least one of the conformations of qFit residue and ground truth residue is more than 0.5 Å (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). A match single conformer residue is when both the ground truth and qFit model have a single conformer and they have an RMSD of less than 0.5 Å (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). A no match single conformer residue is when the qFit model has a single conformer but the ground truth model has more than one alternative conformer or both models have a single conformer but they have an RMSD greater than 0.5 Å (<xref ref-type="fig" rid="fig4">Figure 4A</xref>).</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>The work in this publication does not overlap with Henry van den Bedem's role at Atomwise Inc, and there is no conflict of interest</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Software, Formal analysis, Supervision, Visualization, Methodology, Writing – original draft, Project administration, Writing – review and editing, Data curation</p></fn><fn fn-type="con" id="con2"><p>Data curation, Formal analysis, Visualization, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Formal analysis</p></fn><fn fn-type="con" id="con4"><p>Software, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con5"><p>Formal analysis, Visualization, Writing – review and editing</p></fn><fn fn-type="con" id="con6"><p>Software, Methodology</p></fn><fn fn-type="con" id="con7"><p>Software</p></fn><fn fn-type="con" id="con8"><p>Conceptualization, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con9"><p>Supervision, Funding acquisition, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con10"><p>Supervision, Funding acquisition, Writing – original draft, Writing – review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>High-resolution X-ray crystallography dataset information including PDB, R-free/R-work.</title></caption><media xlink:href="elife-90606-supp1-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="supp2"><label>Supplementary file 2.</label><caption><title>High-resolution cryo-EM dataset information including resolution, geometry information.</title></caption><media xlink:href="elife-90606-supp2-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-90606-mdarchecklist1-v1.docx" mimetype="application" mime-subtype="docx"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>All qFit models for the PDBs discussed in this paper are included in Zenodo deposition <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.10936292">https://doi.org/10.5281/zenodo.10936292</ext-link>. Code can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/ExcitedStates/qfit-3.0">https://github.com/ExcitedStates/qfit-3.0</ext-link> (copy archived at <xref ref-type="bibr" rid="bib70">Wankowicz et al., 2024</xref>).</p><p>The following dataset was generated:</p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset1"><person-group person-group-type="author"><name><surname>Wankowicz</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>Uncovering Protein Ensembles: Automated Multiconformer Model Building for X-ray Crystallography and Cryo-EM</data-title><source>Zenodo</source><pub-id pub-id-type="doi">10.5281/zenodo.10936291</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>This work was supported by a National Institutes of Health (NIH) grant GM145238 and 1125 Chan Zuckerberg Initiative Essential Open Software grant to JSF and NIH R35 1126 GM133769 to DAK. We thank Christopher Williams and Vincent Chen for help with 1127 interpretations of MolProbity score ideal side-chain geometry.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Afonine</surname><given-names>PV</given-names></name><name><surname>Grosse-Kunstleve</surname><given-names>RW</given-names></name><name><surname>Echols</surname><given-names>N</given-names></name><name><surname>Headd</surname><given-names>JJ</given-names></name><name><surname>Moriarty</surname><given-names>NW</given-names></name><name><surname>Mustyakimov</surname><given-names>M</given-names></name><name><surname>Terwilliger</surname><given-names>TC</given-names></name><name><surname>Urzhumtsev</surname><given-names>A</given-names></name><name><surname>Zwart</surname><given-names>PH</given-names></name><name><surname>Adams</surname><given-names>PD</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Towards automated crystallographic structure refinement with phenix.refine</article-title><source>Acta Crystallographica. Section D, Biological Crystallography</source><volume>68</volume><fpage>352</fpage><lpage>367</lpage><pub-id pub-id-type="doi">10.1107/S0907444912001308</pub-id><pub-id pub-id-type="pmid">22505256</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Afonine</surname><given-names>PV</given-names></name><name><surname>Adams</surname><given-names>PD</given-names></name><name><surname>Sobolev</surname><given-names>OV</given-names></name><name><surname>Urzhumtsev</surname><given-names>AG</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Accounting for nonuniformity of bulk-solvent: a mosaic model</article-title><source>Protein Science</source><volume>33</volume><elocation-id>e4909</elocation-id><pub-id pub-id-type="doi">10.1002/pro.4909</pub-id><pub-id pub-id-type="pmid">38358136</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Agrawal</surname><given-names>A</given-names></name><name><surname>Verschueren</surname><given-names>R</given-names></name><name><surname>Diamond</surname><given-names>S</given-names></name><name><surname>Boyd</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A rewriting system for convex optimization problems</article-title><source>Journal of Control and Decision</source><volume>5</volume><fpage>42</fpage><lpage>60</lpage><pub-id pub-id-type="doi">10.1080/23307706.2017.1397554</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anderson</surname><given-names>S</given-names></name><name><surname>Crosson</surname><given-names>S</given-names></name><name><surname>Moffat</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Short hydrogen bonds in photoactive yellow protein</article-title><source>Acta Crystallographica. Section D, Biological Crystallography</source><volume>60</volume><fpage>1008</fpage><lpage>1016</lpage><pub-id pub-id-type="doi">10.1107/S090744490400616X</pub-id><pub-id pub-id-type="pmid">15159559</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berman</surname><given-names>HM</given-names></name><name><surname>Westbrook</surname><given-names>J</given-names></name><name><surname>Feng</surname><given-names>Z</given-names></name><name><surname>Gilliland</surname><given-names>G</given-names></name><name><surname>Bhat</surname><given-names>TN</given-names></name><name><surname>Weissig</surname><given-names>H</given-names></name><name><surname>Shindyalov</surname><given-names>IN</given-names></name><name><surname>Bourne</surname><given-names>PE</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>The protein data bank</article-title><source>Nucleic Acids Research</source><volume>28</volume><fpage>235</fpage><lpage>242</lpage><pub-id pub-id-type="doi">10.1093/nar/28.1.235</pub-id><pub-id pub-id-type="pmid">10592235</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Biel</surname><given-names>JT</given-names></name><name><surname>Thompson</surname><given-names>MC</given-names></name><name><surname>Cunningham</surname><given-names>CN</given-names></name><name><surname>Corn</surname><given-names>JE</given-names></name><name><surname>Fraser</surname><given-names>JS</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Flexibility and Design: conformational heterogeneity along the evolutionary trajectory of a redesigned ubiquitin</article-title><source>Structure</source><volume>25</volume><fpage>739</fpage><lpage>749</lpage><pub-id pub-id-type="doi">10.1016/j.str.2017.03.009</pub-id><pub-id pub-id-type="pmid">28416112</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burley</surname><given-names>SK</given-names></name><name><surname>Berman</surname><given-names>HM</given-names></name><name><surname>Chiu</surname><given-names>W</given-names></name><name><surname>Dai</surname><given-names>W</given-names></name><name><surname>Flatt</surname><given-names>JW</given-names></name><name><surname>Hudson</surname><given-names>BP</given-names></name><name><surname>Kaelber</surname><given-names>JT</given-names></name><name><surname>Khare</surname><given-names>SD</given-names></name><name><surname>Kulczyk</surname><given-names>AW</given-names></name><name><surname>Lawson</surname><given-names>CL</given-names></name><name><surname>Pintilie</surname><given-names>GD</given-names></name><name><surname>Sali</surname><given-names>A</given-names></name><name><surname>Vallat</surname><given-names>B</given-names></name><name><surname>Westbrook</surname><given-names>JD</given-names></name><name><surname>Young</surname><given-names>JY</given-names></name><name><surname>Zardecki</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Electron microscopy holdings of the Protein data bank: the impact of the resolution revolution, new validation tools, and implications for the future</article-title><source>Biophysical Reviews</source><volume>14</volume><fpage>1281</fpage><lpage>1301</lpage><pub-id pub-id-type="doi">10.1007/s12551-022-01013-w</pub-id><pub-id pub-id-type="pmid">36474933</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burling</surname><given-names>FT</given-names></name><name><surname>Brünger</surname><given-names>AT</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Thermal motion and conformational disorder in protein crystal structures: comparison of multi‐conformer and time‐averaging models</article-title><source>Israel Journal of Chemistry</source><volume>34</volume><fpage>165</fpage><lpage>175</lpage><pub-id pub-id-type="doi">10.1002/ijch.199400022</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burnley</surname><given-names>BT</given-names></name><name><surname>Afonine</surname><given-names>PV</given-names></name><name><surname>Adams</surname><given-names>PD</given-names></name><name><surname>Gros</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Modelling dynamics in protein crystal structures by ensemble refinement</article-title><source>eLife</source><volume>1</volume><elocation-id>e00311</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.00311</pub-id><pub-id pub-id-type="pmid">23251785</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>M</given-names></name><name><surname>Ludtke</surname><given-names>SJ</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Deep learning-based mixed-dimensional gaussian mixture model for characterizing variability in cryo-EM</article-title><source>Nature Methods</source><volume>18</volume><fpage>930</fpage><lpage>936</lpage><pub-id pub-id-type="doi">10.1038/s41592-021-01220-5</pub-id><pub-id pub-id-type="pmid">34326541</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cheng</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Single-particle cryo-EM at crystallographic resolution</article-title><source>Cell</source><volume>161</volume><fpage>450</fpage><lpage>457</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.03.049</pub-id><pub-id pub-id-type="pmid">25910205</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chiu</surname><given-names>W</given-names></name><name><surname>Schmid</surname><given-names>MF</given-names></name><name><surname>Pintilie</surname><given-names>GD</given-names></name><name><surname>Lawson</surname><given-names>CL</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Evolution of standardization and dissemination of cryo-EM structures and data jointly by the community, PDB, and EMDB</article-title><source>The Journal of Biological Chemistry</source><volume>296</volume><elocation-id>100560</elocation-id><pub-id pub-id-type="doi">10.1016/j.jbc.2021.100560</pub-id><pub-id pub-id-type="pmid">33744287</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Correy</surname><given-names>GJ</given-names></name><name><surname>Kneller</surname><given-names>DW</given-names></name><name><surname>Phillips</surname><given-names>G</given-names></name><name><surname>Pant</surname><given-names>S</given-names></name><name><surname>Russi</surname><given-names>S</given-names></name><name><surname>Cohen</surname><given-names>AE</given-names></name><name><surname>Meigs</surname><given-names>G</given-names></name><name><surname>Holton</surname><given-names>JM</given-names></name><name><surname>Gahbauer</surname><given-names>S</given-names></name><name><surname>Thompson</surname><given-names>MC</given-names></name><name><surname>Ashworth</surname><given-names>A</given-names></name><name><surname>Coates</surname><given-names>L</given-names></name><name><surname>Kovalevsky</surname><given-names>A</given-names></name><name><surname>Meilleur</surname><given-names>F</given-names></name><name><surname>Fraser</surname><given-names>JS</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>The mechanisms of catalysis and ligand binding for the SARS-CoV-2 NSP3 macrodomain from neutron and x-ray diffraction at room temperature</article-title><source>Science Advances</source><volume>8</volume><elocation-id>eabo5083</elocation-id><pub-id pub-id-type="doi">10.1126/sciadv.abo5083</pub-id><pub-id pub-id-type="pmid">35622909</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dasgupta</surname><given-names>M</given-names></name><name><surname>Budday</surname><given-names>D</given-names></name><name><surname>de Oliveira</surname><given-names>SHP</given-names></name><name><surname>Madzelan</surname><given-names>P</given-names></name><name><surname>Marchany-Rivera</surname><given-names>D</given-names></name><name><surname>Seravalli</surname><given-names>J</given-names></name><name><surname>Hayes</surname><given-names>B</given-names></name><name><surname>Sierra</surname><given-names>RG</given-names></name><name><surname>Boutet</surname><given-names>S</given-names></name><name><surname>Hunter</surname><given-names>MS</given-names></name><name><surname>Alonso-Mori</surname><given-names>R</given-names></name><name><surname>Batyuk</surname><given-names>A</given-names></name><name><surname>Wierman</surname><given-names>J</given-names></name><name><surname>Lyubimov</surname><given-names>A</given-names></name><name><surname>Brewster</surname><given-names>AS</given-names></name><name><surname>Sauter</surname><given-names>NK</given-names></name><name><surname>Applegate</surname><given-names>GA</given-names></name><name><surname>Tiwari</surname><given-names>VK</given-names></name><name><surname>Berkowitz</surname><given-names>DB</given-names></name><name><surname>Thompson</surname><given-names>MC</given-names></name><name><surname>Cohen</surname><given-names>AE</given-names></name><name><surname>Fraser</surname><given-names>JS</given-names></name><name><surname>Wall</surname><given-names>ME</given-names></name><name><surname>van den Bedem</surname><given-names>H</given-names></name><name><surname>Wilson</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Mix-and-inject XFEL crystallography reveals gated conformational dynamics during enzyme catalysis</article-title><source>PNAS</source><volume>116</volume><fpage>25634</fpage><lpage>25640</lpage><pub-id pub-id-type="doi">10.1073/pnas.1901864116</pub-id><pub-id pub-id-type="pmid">31801874</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davis</surname><given-names>IW</given-names></name><name><surname>Arendall</surname><given-names>WB</given-names></name><name><surname>Richardson</surname><given-names>DC</given-names></name><name><surname>Richardson</surname><given-names>JS</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>The backrub motion: how protein backbone shrugs when a sidechain dances</article-title><source>Structure</source><volume>14</volume><fpage>265</fpage><lpage>274</lpage><pub-id pub-id-type="doi">10.1016/j.str.2005.10.007</pub-id><pub-id pub-id-type="pmid">16472746</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deis</surname><given-names>LN</given-names></name><name><surname>Pemble</surname><given-names>CW</given-names></name><name><surname>Qi</surname><given-names>Y</given-names></name><name><surname>Hagarman</surname><given-names>A</given-names></name><name><surname>Richardson</surname><given-names>DC</given-names></name><name><surname>Richardson</surname><given-names>JS</given-names></name><name><surname>Oas</surname><given-names>TG</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Multiscale conformational heterogeneity in staphylococcal protein a: possible determinant of functional plasticity</article-title><source>Structure</source><volume>22</volume><fpage>1467</fpage><lpage>1477</lpage><pub-id pub-id-type="doi">10.1016/j.str.2014.08.014</pub-id><pub-id pub-id-type="pmid">25295398</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Diamond</surname><given-names>S</given-names></name><name><surname>Boyd</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>CVXPY: a python-embedded modeling language for convex optimization</article-title><source>Journal of Machine Learning Research</source><volume>17</volume><elocation-id>83</elocation-id><pub-id pub-id-type="pmid">27375369</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Douangamath</surname><given-names>A</given-names></name><name><surname>Fearon</surname><given-names>D</given-names></name><name><surname>Gehrtz</surname><given-names>P</given-names></name><name><surname>Krojer</surname><given-names>T</given-names></name><name><surname>Lukacik</surname><given-names>P</given-names></name><name><surname>Owen</surname><given-names>CD</given-names></name><name><surname>Resnick</surname><given-names>E</given-names></name><name><surname>Strain-Damerell</surname><given-names>C</given-names></name><name><surname>Aimon</surname><given-names>A</given-names></name><name><surname>Ábrányi-Balogh</surname><given-names>P</given-names></name><name><surname>Brandão-Neto</surname><given-names>J</given-names></name><name><surname>Carbery</surname><given-names>A</given-names></name><name><surname>Davison</surname><given-names>G</given-names></name><name><surname>Dias</surname><given-names>A</given-names></name><name><surname>Downes</surname><given-names>TD</given-names></name><name><surname>Dunnett</surname><given-names>L</given-names></name><name><surname>Fairhead</surname><given-names>M</given-names></name><name><surname>Firth</surname><given-names>JD</given-names></name><name><surname>Jones</surname><given-names>SP</given-names></name><name><surname>Keeley</surname><given-names>A</given-names></name><name><surname>Keserü</surname><given-names>GM</given-names></name><name><surname>Klein</surname><given-names>HF</given-names></name><name><surname>Martin</surname><given-names>MP</given-names></name><name><surname>Noble</surname><given-names>MEM</given-names></name><name><surname>O’Brien</surname><given-names>P</given-names></name><name><surname>Powell</surname><given-names>A</given-names></name><name><surname>Reddi</surname><given-names>RN</given-names></name><name><surname>Skyner</surname><given-names>R</given-names></name><name><surname>Snee</surname><given-names>M</given-names></name><name><surname>Waring</surname><given-names>MJ</given-names></name><name><surname>Wild</surname><given-names>C</given-names></name><name><surname>London</surname><given-names>N</given-names></name><name><surname>von Delft</surname><given-names>F</given-names></name><name><surname>Walsh</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Crystallographic and electrophilic fragment screening of the SARS-CoV-2 main protease</article-title><source>Nature Communications</source><volume>11</volume><elocation-id>5047</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-020-18709-w</pub-id><pub-id pub-id-type="pmid">33028810</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Ebrahim</surname><given-names>A</given-names></name><name><surname>Riley</surname><given-names>BT</given-names></name><name><surname>Kumaran</surname><given-names>D</given-names></name><name><surname>Andi</surname><given-names>B</given-names></name><name><surname>Fuchs</surname><given-names>MR</given-names></name><name><surname>McSweeney</surname><given-names>S</given-names></name><name><surname>Keedy</surname><given-names>DA</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>The Temperature-Dependent Conformational Ensemble of SARS-CoV-2 Main Protease (Mpro)</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.05.03.437411</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Emsley</surname><given-names>P</given-names></name><name><surname>Lohkamp</surname><given-names>B</given-names></name><name><surname>Scott</surname><given-names>WG</given-names></name><name><surname>Cowtan</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Features and development of Coot</article-title><source>Acta Crystallographica. Section D, Biological Crystallography</source><volume>66</volume><fpage>486</fpage><lpage>501</lpage><pub-id pub-id-type="doi">10.1107/S0907444910007493</pub-id><pub-id pub-id-type="pmid">20383002</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fraser</surname><given-names>JS</given-names></name><name><surname>van den Bedem</surname><given-names>H</given-names></name><name><surname>Samelson</surname><given-names>AJ</given-names></name><name><surname>Lang</surname><given-names>PT</given-names></name><name><surname>Holton</surname><given-names>JM</given-names></name><name><surname>Echols</surname><given-names>N</given-names></name><name><surname>Alber</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Accessing protein conformational ensembles using room-temperature X-ray crystallography</article-title><source>PNAS</source><volume>108</volume><fpage>16247</fpage><lpage>16252</lpage><pub-id pub-id-type="doi">10.1073/pnas.1111325108</pub-id><pub-id pub-id-type="pmid">21918110</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fraser</surname><given-names>JS</given-names></name><name><surname>Lindorff-Larsen</surname><given-names>K</given-names></name><name><surname>Bonomi</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>What will computational modeling approaches have to say in the era of atomistic cryo-EM data?</article-title><source>Journal of Chemical Information and Modeling</source><volume>60</volume><fpage>2410</fpage><lpage>2412</lpage><pub-id pub-id-type="doi">10.1021/acs.jcim.0c00123</pub-id><pub-id pub-id-type="pmid">32090567</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fromm</surname><given-names>SA</given-names></name><name><surname>O’Connor</surname><given-names>KM</given-names></name><name><surname>Purdy</surname><given-names>M</given-names></name><name><surname>Bhatt</surname><given-names>PR</given-names></name><name><surname>Loughran</surname><given-names>G</given-names></name><name><surname>Atkins</surname><given-names>JF</given-names></name><name><surname>Jomaa</surname><given-names>A</given-names></name><name><surname>Mattei</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>The translating bacterial ribosome at 1.55 Å resolution generated by cryo-EM imaging services</article-title><source>Nature Communications</source><volume>14</volume><elocation-id>1095</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-023-36742-3</pub-id><pub-id pub-id-type="pmid">36841832</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Furnham</surname><given-names>N</given-names></name><name><surname>Blundell</surname><given-names>TL</given-names></name><name><surname>DePristo</surname><given-names>MA</given-names></name><name><surname>Terwilliger</surname><given-names>TC</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Is one solution good enough?</article-title><source>Nature Structural &amp; Molecular Biology</source><volume>13</volume><fpage>184</fpage><lpage>185</lpage><pub-id pub-id-type="doi">10.1038/nsmb0306-184</pub-id><pub-id pub-id-type="pmid">16518382</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gahbauer</surname><given-names>S</given-names></name><name><surname>Correy</surname><given-names>GJ</given-names></name><name><surname>Schuller</surname><given-names>M</given-names></name><name><surname>Ferla</surname><given-names>MP</given-names></name><name><surname>Doruk</surname><given-names>YU</given-names></name><name><surname>Rachman</surname><given-names>M</given-names></name><name><surname>Wu</surname><given-names>T</given-names></name><name><surname>Diolaiti</surname><given-names>M</given-names></name><name><surname>Wang</surname><given-names>S</given-names></name><name><surname>Neitz</surname><given-names>RJ</given-names></name><name><surname>Fearon</surname><given-names>D</given-names></name><name><surname>Radchenko</surname><given-names>DS</given-names></name><name><surname>Moroz</surname><given-names>YS</given-names></name><name><surname>Irwin</surname><given-names>JJ</given-names></name><name><surname>Renslo</surname><given-names>AR</given-names></name><name><surname>Taylor</surname><given-names>JC</given-names></name><name><surname>Gestwicki</surname><given-names>JE</given-names></name><name><surname>von Delft</surname><given-names>F</given-names></name><name><surname>Ashworth</surname><given-names>A</given-names></name><name><surname>Ahel</surname><given-names>I</given-names></name><name><surname>Shoichet</surname><given-names>BK</given-names></name><name><surname>Fraser</surname><given-names>JS</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Iterative computational design and crystallographic screening identifies potent inhibitors targeting the Nsp3 macrodomain of SARS-CoV-2</article-title><source>PNAS</source><volume>120</volume><elocation-id>e2212931120</elocation-id><pub-id pub-id-type="doi">10.1073/pnas.2212931120</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ginn</surname><given-names>HM</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Vagabond: bond-based parametrization reduces overfitting for refinement of proteins</article-title><source>Acta Crystallographica. Section D, Structural Biology</source><volume>77</volume><fpage>424</fpage><lpage>437</lpage><pub-id pub-id-type="doi">10.1107/S2059798321000826</pub-id><pub-id pub-id-type="pmid">33825703</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Glaeser</surname><given-names>RM</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>How good can single-particle cryo-EM become? what remains before it approaches its physical limits?</article-title><source>Annual Review of Biophysics</source><volume>48</volume><fpage>45</fpage><lpage>61</lpage><pub-id pub-id-type="doi">10.1146/annurev-biophys-070317-032828</pub-id><pub-id pub-id-type="pmid">30786229</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="software"><person-group person-group-type="author"><collab>gregdp</collab></person-group><year iso-8601-date="2023">2023</year><data-title>Mapq</data-title><version designator="swh:1:rev:6532bb8c1bcb84e43c1ef9292d73fdcd4c83f5b3">swh:1:rev:6532bb8c1bcb84e43c1ef9292d73fdcd4c83f5b3</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:eeb4396bc29fa20d9dfa9a957bf3dfec3f21e867;origin=https://github.com/gregdp/mapq;visit=swh:1:snp:13607d794dfb86a056e7a1ea72c17c8e1007ca17;anchor=swh:1:rev:6532bb8c1bcb84e43c1ef9292d73fdcd4c83f5b3">https://archive.softwareheritage.org/swh:1:dir:eeb4396bc29fa20d9dfa9a957bf3dfec3f21e867;origin=https://github.com/gregdp/mapq;visit=swh:1:snp:13607d794dfb86a056e7a1ea72c17c8e1007ca17;anchor=swh:1:rev:6532bb8c1bcb84e43c1ef9292d73fdcd4c83f5b3</ext-link></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Günther</surname><given-names>S</given-names></name><name><surname>Reinke</surname><given-names>PYA</given-names></name><name><surname>Fernández-García</surname><given-names>Y</given-names></name><name><surname>Lieske</surname><given-names>J</given-names></name><name><surname>Lane</surname><given-names>TJ</given-names></name><name><surname>Ginn</surname><given-names>HM</given-names></name><name><surname>Koua</surname><given-names>FHM</given-names></name><name><surname>Ehrt</surname><given-names>C</given-names></name><name><surname>Ewert</surname><given-names>W</given-names></name><name><surname>Oberthuer</surname><given-names>D</given-names></name><name><surname>Yefanov</surname><given-names>O</given-names></name><name><surname>Meier</surname><given-names>S</given-names></name><name><surname>Lorenzen</surname><given-names>K</given-names></name><name><surname>Krichel</surname><given-names>B</given-names></name><name><surname>Kopicki</surname><given-names>J-D</given-names></name><name><surname>Gelisio</surname><given-names>L</given-names></name><name><surname>Brehm</surname><given-names>W</given-names></name><name><surname>Dunkel</surname><given-names>I</given-names></name><name><surname>Seychell</surname><given-names>B</given-names></name><name><surname>Gieseler</surname><given-names>H</given-names></name><name><surname>Norton-Baker</surname><given-names>B</given-names></name><name><surname>Escudero-Pérez</surname><given-names>B</given-names></name><name><surname>Domaracky</surname><given-names>M</given-names></name><name><surname>Saouane</surname><given-names>S</given-names></name><name><surname>Tolstikova</surname><given-names>A</given-names></name><name><surname>White</surname><given-names>TA</given-names></name><name><surname>Hänle</surname><given-names>A</given-names></name><name><surname>Groessler</surname><given-names>M</given-names></name><name><surname>Fleckenstein</surname><given-names>H</given-names></name><name><surname>Trost</surname><given-names>F</given-names></name><name><surname>Galchenkova</surname><given-names>M</given-names></name><name><surname>Gevorkov</surname><given-names>Y</given-names></name><name><surname>Li</surname><given-names>C</given-names></name><name><surname>Awel</surname><given-names>S</given-names></name><name><surname>Peck</surname><given-names>A</given-names></name><name><surname>Barthelmess</surname><given-names>M</given-names></name><name><surname>Schlünzen</surname><given-names>F</given-names></name><name><surname>Lourdu Xavier</surname><given-names>P</given-names></name><name><surname>Werner</surname><given-names>N</given-names></name><name><surname>Andaleeb</surname><given-names>H</given-names></name><name><surname>Ullah</surname><given-names>N</given-names></name><name><surname>Falke</surname><given-names>S</given-names></name><name><surname>Srinivasan</surname><given-names>V</given-names></name><name><surname>França</surname><given-names>BA</given-names></name><name><surname>Schwinzer</surname><given-names>M</given-names></name><name><surname>Brognaro</surname><given-names>H</given-names></name><name><surname>Rogers</surname><given-names>C</given-names></name><name><surname>Melo</surname><given-names>D</given-names></name><name><surname>Zaitseva-Doyle</surname><given-names>JJ</given-names></name><name><surname>Knoska</surname><given-names>J</given-names></name><name><surname>Peña-Murillo</surname><given-names>GE</given-names></name><name><surname>Mashhour</surname><given-names>AR</given-names></name><name><surname>Hennicke</surname><given-names>V</given-names></name><name><surname>Fischer</surname><given-names>P</given-names></name><name><surname>Hakanpää</surname><given-names>J</given-names></name><name><surname>Meyer</surname><given-names>J</given-names></name><name><surname>Gribbon</surname><given-names>P</given-names></name><name><surname>Ellinger</surname><given-names>B</given-names></name><name><surname>Kuzikov</surname><given-names>M</given-names></name><name><surname>Wolf</surname><given-names>M</given-names></name><name><surname>Beccari</surname><given-names>AR</given-names></name><name><surname>Bourenkov</surname><given-names>G</given-names></name><name><surname>von Stetten</surname><given-names>D</given-names></name><name><surname>Pompidor</surname><given-names>G</given-names></name><name><surname>Bento</surname><given-names>I</given-names></name><name><surname>Panneerselvam</surname><given-names>S</given-names></name><name><surname>Karpics</surname><given-names>I</given-names></name><name><surname>Schneider</surname><given-names>TR</given-names></name><name><surname>Garcia-Alai</surname><given-names>MM</given-names></name><name><surname>Niebling</surname><given-names>S</given-names></name><name><surname>Günther</surname><given-names>C</given-names></name><name><surname>Schmidt</surname><given-names>C</given-names></name><name><surname>Schubert</surname><given-names>R</given-names></name><name><surname>Han</surname><given-names>H</given-names></name><name><surname>Boger</surname><given-names>J</given-names></name><name><surname>Monteiro</surname><given-names>DCF</given-names></name><name><surname>Zhang</surname><given-names>L</given-names></name><name><surname>Sun</surname><given-names>X</given-names></name><name><surname>Pletzer-Zelgert</surname><given-names>J</given-names></name><name><surname>Wollenhaupt</surname><given-names>J</given-names></name><name><surname>Feiler</surname><given-names>CG</given-names></name><name><surname>Weiss</surname><given-names>MS</given-names></name><name><surname>Schulz</surname><given-names>E-C</given-names></name><name><surname>Mehrabi</surname><given-names>P</given-names></name><name><surname>Karničar</surname><given-names>K</given-names></name><name><surname>Usenik</surname><given-names>A</given-names></name><name><surname>Loboda</surname><given-names>J</given-names></name><name><surname>Tidow</surname><given-names>H</given-names></name><name><surname>Chari</surname><given-names>A</given-names></name><name><surname>Hilgenfeld</surname><given-names>R</given-names></name><name><surname>Uetrecht</surname><given-names>C</given-names></name><name><surname>Cox</surname><given-names>R</given-names></name><name><surname>Zaliani</surname><given-names>A</given-names></name><name><surname>Beck</surname><given-names>T</given-names></name><name><surname>Rarey</surname><given-names>M</given-names></name><name><surname>Günther</surname><given-names>S</given-names></name><name><surname>Turk</surname><given-names>D</given-names></name><name><surname>Hinrichs</surname><given-names>W</given-names></name><name><surname>Chapman</surname><given-names>HN</given-names></name><name><surname>Pearson</surname><given-names>AR</given-names></name><name><surname>Betzel</surname><given-names>C</given-names></name><name><surname>Meents</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>X-ray screening identifies active site and allosteric inhibitors of SARS-CoV-2 main protease</article-title><source>Science</source><volume>372</volume><fpage>642</fpage><lpage>646</lpage><pub-id pub-id-type="doi">10.1126/science.abf7945</pub-id><pub-id pub-id-type="pmid">33811162</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hancock</surname><given-names>M</given-names></name><name><surname>Peulen</surname><given-names>TO</given-names></name><name><surname>Webb</surname><given-names>B</given-names></name><name><surname>Poon</surname><given-names>B</given-names></name><name><surname>Fraser</surname><given-names>JS</given-names></name><name><surname>Adams</surname><given-names>P</given-names></name><name><surname>Sali</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Integration of software tools for integrative modeling of biomolecular systems</article-title><source>Journal of Structural Biology</source><volume>214</volume><elocation-id>107841</elocation-id><pub-id pub-id-type="doi">10.1016/j.jsb.2022.107841</pub-id><pub-id pub-id-type="pmid">35149213</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Herzik</surname><given-names>MA</given-names></name><name><surname>Wu</surname><given-names>M</given-names></name><name><surname>Lander</surname><given-names>GC</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Achieving better-than-3-Å resolution by single-particle cryo-EM at 200 keV</article-title><source>Nature Methods</source><volume>14</volume><fpage>1075</fpage><lpage>1078</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4461</pub-id><pub-id pub-id-type="pmid">28991891</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hintze</surname><given-names>BJ</given-names></name><name><surname>Richardson</surname><given-names>JS</given-names></name><name><surname>Richardson</surname><given-names>DC</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Mismodeled purines: implicit alternates and hidden hoogsteens</article-title><source>Acta Crystallographica. Section D, Structural Biology</source><volume>73</volume><fpage>852</fpage><lpage>859</lpage><pub-id pub-id-type="doi">10.1107/S2059798317013729</pub-id><pub-id pub-id-type="pmid">28994414</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Holton</surname><given-names>JM</given-names></name><name><surname>Classen</surname><given-names>S</given-names></name><name><surname>Frankel</surname><given-names>KA</given-names></name><name><surname>Tainer</surname><given-names>JA</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The R-factor gap in macromolecular crystallography: an untapped potential for insights on accurate structures</article-title><source>The FEBS Journal</source><volume>281</volume><fpage>4046</fpage><lpage>4060</lpage><pub-id pub-id-type="doi">10.1111/febs.12922</pub-id><pub-id pub-id-type="pmid">25040949</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jumper</surname><given-names>J</given-names></name><name><surname>Evans</surname><given-names>R</given-names></name><name><surname>Pritzel</surname><given-names>A</given-names></name><name><surname>Green</surname><given-names>T</given-names></name><name><surname>Figurnov</surname><given-names>M</given-names></name><name><surname>Ronneberger</surname><given-names>O</given-names></name><name><surname>Tunyasuvunakool</surname><given-names>K</given-names></name><name><surname>Bates</surname><given-names>R</given-names></name><name><surname>Žídek</surname><given-names>A</given-names></name><name><surname>Potapenko</surname><given-names>A</given-names></name><name><surname>Bridgland</surname><given-names>A</given-names></name><name><surname>Meyer</surname><given-names>C</given-names></name><name><surname>Kohl</surname><given-names>SAA</given-names></name><name><surname>Ballard</surname><given-names>AJ</given-names></name><name><surname>Cowie</surname><given-names>A</given-names></name><name><surname>Romera-Paredes</surname><given-names>B</given-names></name><name><surname>Nikolov</surname><given-names>S</given-names></name><name><surname>Jain</surname><given-names>R</given-names></name><name><surname>Adler</surname><given-names>J</given-names></name><name><surname>Back</surname><given-names>T</given-names></name><name><surname>Petersen</surname><given-names>S</given-names></name><name><surname>Reiman</surname><given-names>D</given-names></name><name><surname>Clancy</surname><given-names>E</given-names></name><name><surname>Zielinski</surname><given-names>M</given-names></name><name><surname>Steinegger</surname><given-names>M</given-names></name><name><surname>Pacholska</surname><given-names>M</given-names></name><name><surname>Berghammer</surname><given-names>T</given-names></name><name><surname>Bodenstein</surname><given-names>S</given-names></name><name><surname>Silver</surname><given-names>D</given-names></name><name><surname>Vinyals</surname><given-names>O</given-names></name><name><surname>Senior</surname><given-names>AW</given-names></name><name><surname>Kavukcuoglu</surname><given-names>K</given-names></name><name><surname>Kohli</surname><given-names>P</given-names></name><name><surname>Hassabis</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Highly accurate protein structure prediction with AlphaFold</article-title><source>Nature</source><volume>596</volume><fpage>583</fpage><lpage>589</lpage><pub-id pub-id-type="doi">10.1038/s41586-021-03819-2</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kabsch</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>XDS</article-title><source>Acta Crystallographica. Section D, Biological Crystallography</source><volume>66</volume><fpage>125</fpage><lpage>132</lpage><pub-id pub-id-type="doi">10.1107/S0907444909047337</pub-id><pub-id pub-id-type="pmid">20124692</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karplus</surname><given-names>PA</given-names></name><name><surname>Diederichs</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Linking crystallographic model and data quality</article-title><source>Science</source><volume>336</volume><fpage>1030</fpage><lpage>1033</lpage><pub-id pub-id-type="doi">10.1126/science.1218231</pub-id><pub-id pub-id-type="pmid">22628654</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keedy</surname><given-names>DA</given-names></name><name><surname>Fraser</surname><given-names>JS</given-names></name><name><surname>van den Bedem</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Exposing hidden alternative backbone conformations in X-ray crystallography using qFit</article-title><source>PLOS Computational Biology</source><volume>11</volume><elocation-id>e1004507</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004507</pub-id><pub-id pub-id-type="pmid">26506617</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keedy</surname><given-names>DA</given-names></name><name><surname>Hill</surname><given-names>ZB</given-names></name><name><surname>Biel</surname><given-names>JT</given-names></name><name><surname>Kang</surname><given-names>E</given-names></name><name><surname>Rettenmaier</surname><given-names>TJ</given-names></name><name><surname>Brandão-Neto</surname><given-names>J</given-names></name><name><surname>Pearce</surname><given-names>NM</given-names></name><name><surname>von Delft</surname><given-names>F</given-names></name><name><surname>Wells</surname><given-names>JA</given-names></name><name><surname>Fraser</surname><given-names>JS</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>An expanded allosteric network in PTP1B by multitemperature crystallography, fragment screening, and covalent tethering</article-title><source>eLife</source><volume>7</volume><elocation-id>e36307</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.36307</pub-id><pub-id pub-id-type="pmid">29877794</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kinman</surname><given-names>LF</given-names></name><name><surname>Powell</surname><given-names>BM</given-names></name><name><surname>Zhong</surname><given-names>ED</given-names></name><name><surname>Berger</surname><given-names>B</given-names></name><name><surname>Davis</surname><given-names>JH</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Uncovering structural ensembles from single-particle cryo-EM data using cryoDRGN</article-title><source>Nature Protocols</source><volume>18</volume><fpage>319</fpage><lpage>339</lpage><pub-id pub-id-type="doi">10.1038/s41596-022-00763-x</pub-id><pub-id pub-id-type="pmid">36376590</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kleywegt</surname><given-names>GJ</given-names></name><name><surname>Adams</surname><given-names>PD</given-names></name><name><surname>Butcher</surname><given-names>SJ</given-names></name><name><surname>Lawson</surname><given-names>CL</given-names></name><name><surname>Rohou</surname><given-names>A</given-names></name><name><surname>Rosenthal</surname><given-names>PB</given-names></name><name><surname>Subramaniam</surname><given-names>S</given-names></name><name><surname>Topf</surname><given-names>M</given-names></name><name><surname>Abbott</surname><given-names>S</given-names></name><name><surname>Baldwin</surname><given-names>PR</given-names></name><name><surname>Berrisford</surname><given-names>JM</given-names></name><name><surname>Bricogne</surname><given-names>G</given-names></name><name><surname>Choudhary</surname><given-names>P</given-names></name><name><surname>Croll</surname><given-names>TI</given-names></name><name><surname>Danev</surname><given-names>R</given-names></name><name><surname>Ganesan</surname><given-names>SJ</given-names></name><name><surname>Grant</surname><given-names>T</given-names></name><name><surname>Gutmanas</surname><given-names>A</given-names></name><name><surname>Henderson</surname><given-names>R</given-names></name><name><surname>Heymann</surname><given-names>JB</given-names></name><name><surname>Huiskonen</surname><given-names>JT</given-names></name><name><surname>Istrate</surname><given-names>A</given-names></name><name><surname>Kato</surname><given-names>T</given-names></name><name><surname>Lander</surname><given-names>GC</given-names></name><name><surname>Lok</surname><given-names>SM</given-names></name><name><surname>Ludtke</surname><given-names>SJ</given-names></name><name><surname>Murshudov</surname><given-names>GN</given-names></name><name><surname>Pye</surname><given-names>R</given-names></name><name><surname>Pintilie</surname><given-names>GD</given-names></name><name><surname>Richardson</surname><given-names>JS</given-names></name><name><surname>Sachse</surname><given-names>C</given-names></name><name><surname>Salih</surname><given-names>O</given-names></name><name><surname>Scheres</surname><given-names>SHW</given-names></name><name><surname>Schroeder</surname><given-names>GF</given-names></name><name><surname>Sorzano</surname><given-names>COS</given-names></name><name><surname>Stagg</surname><given-names>SM</given-names></name><name><surname>Wang</surname><given-names>Z</given-names></name><name><surname>Warshamanage</surname><given-names>R</given-names></name><name><surname>Westbrook</surname><given-names>JD</given-names></name><name><surname>Winn</surname><given-names>MD</given-names></name><name><surname>Young</surname><given-names>JY</given-names></name><name><surname>Burley</surname><given-names>SK</given-names></name><name><surname>Hoch</surname><given-names>JC</given-names></name><name><surname>Kurisu</surname><given-names>G</given-names></name><name><surname>Morris</surname><given-names>K</given-names></name><name><surname>Patwardhan</surname><given-names>A</given-names></name><name><surname>Velankar</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Community recommendations on cryoEM data archiving and validation</article-title><source>IUCrJ</source><volume>11</volume><fpage>140</fpage><lpage>151</lpage><pub-id pub-id-type="doi">10.1107/S2052252524001246</pub-id><pub-id pub-id-type="pmid">38358351</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lane</surname><given-names>TJ</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Protein structure prediction has reached the single-structure frontier</article-title><source>Nature Methods</source><volume>20</volume><fpage>170</fpage><lpage>173</lpage><pub-id pub-id-type="doi">10.1038/s41592-022-01760-4</pub-id><pub-id pub-id-type="pmid">36639584</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lawson</surname><given-names>CL</given-names></name><name><surname>Kryshtafovych</surname><given-names>A</given-names></name><name><surname>Adams</surname><given-names>PD</given-names></name><name><surname>Afonine</surname><given-names>PV</given-names></name><name><surname>Baker</surname><given-names>ML</given-names></name><name><surname>Barad</surname><given-names>BA</given-names></name><name><surname>Bond</surname><given-names>P</given-names></name><name><surname>Burnley</surname><given-names>T</given-names></name><name><surname>Cao</surname><given-names>R</given-names></name><name><surname>Cheng</surname><given-names>J</given-names></name><name><surname>Chojnowski</surname><given-names>G</given-names></name><name><surname>Cowtan</surname><given-names>K</given-names></name><name><surname>Dill</surname><given-names>KA</given-names></name><name><surname>DiMaio</surname><given-names>F</given-names></name><name><surname>Farrell</surname><given-names>DP</given-names></name><name><surname>Fraser</surname><given-names>JS</given-names></name><name><surname>Herzik</surname><given-names>MA</given-names><suffix>Jr</suffix></name><name><surname>Hoh</surname><given-names>SW</given-names></name><name><surname>Hou</surname><given-names>J</given-names></name><name><surname>Hung</surname><given-names>L-W</given-names></name><name><surname>Igaev</surname><given-names>M</given-names></name><name><surname>Joseph</surname><given-names>AP</given-names></name><name><surname>Kihara</surname><given-names>D</given-names></name><name><surname>Kumar</surname><given-names>D</given-names></name><name><surname>Mittal</surname><given-names>S</given-names></name><name><surname>Monastyrskyy</surname><given-names>B</given-names></name><name><surname>Olek</surname><given-names>M</given-names></name><name><surname>Palmer</surname><given-names>CM</given-names></name><name><surname>Patwardhan</surname><given-names>A</given-names></name><name><surname>Perez</surname><given-names>A</given-names></name><name><surname>Pfab</surname><given-names>J</given-names></name><name><surname>Pintilie</surname><given-names>GD</given-names></name><name><surname>Richardson</surname><given-names>JS</given-names></name><name><surname>Rosenthal</surname><given-names>PB</given-names></name><name><surname>Sarkar</surname><given-names>D</given-names></name><name><surname>Schäfer</surname><given-names>LU</given-names></name><name><surname>Schmid</surname><given-names>MF</given-names></name><name><surname>Schröder</surname><given-names>GF</given-names></name><name><surname>Shekhar</surname><given-names>M</given-names></name><name><surname>Si</surname><given-names>D</given-names></name><name><surname>Singharoy</surname><given-names>A</given-names></name><name><surname>Terashi</surname><given-names>G</given-names></name><name><surname>Terwilliger</surname><given-names>TC</given-names></name><name><surname>Vaiana</surname><given-names>A</given-names></name><name><surname>Wang</surname><given-names>L</given-names></name><name><surname>Wang</surname><given-names>Z</given-names></name><name><surname>Wankowicz</surname><given-names>SA</given-names></name><name><surname>Williams</surname><given-names>CJ</given-names></name><name><surname>Winn</surname><given-names>M</given-names></name><name><surname>Wu</surname><given-names>T</given-names></name><name><surname>Yu</surname><given-names>X</given-names></name><name><surname>Zhang</surname><given-names>K</given-names></name><name><surname>Berman</surname><given-names>HM</given-names></name><name><surname>Chiu</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Cryo-EM model validation recommendations based on outcomes of the 2019 EMDataResource challenge</article-title><source>Nature Methods</source><volume>18</volume><fpage>156</fpage><lpage>164</lpage><pub-id pub-id-type="doi">10.1038/s41592-020-01051-w</pub-id><pub-id pub-id-type="pmid">33542514</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Q</given-names></name><name><surname>Pellegrino</surname><given-names>J</given-names></name><name><surname>Lee</surname><given-names>DJ</given-names></name><name><surname>Tran</surname><given-names>AA</given-names></name><name><surname>Chaires</surname><given-names>HA</given-names></name><name><surname>Wang</surname><given-names>R</given-names></name><name><surname>Park</surname><given-names>JE</given-names></name><name><surname>Ji</surname><given-names>K</given-names></name><name><surname>Chow</surname><given-names>D</given-names></name><name><surname>Zhang</surname><given-names>N</given-names></name><name><surname>Brilot</surname><given-names>AF</given-names></name><name><surname>Biel</surname><given-names>JT</given-names></name><name><surname>van Zundert</surname><given-names>G</given-names></name><name><surname>Borrelli</surname><given-names>K</given-names></name><name><surname>Shinabarger</surname><given-names>D</given-names></name><name><surname>Wolfe</surname><given-names>C</given-names></name><name><surname>Murray</surname><given-names>B</given-names></name><name><surname>Jacobson</surname><given-names>MP</given-names></name><name><surname>Mühle</surname><given-names>E</given-names></name><name><surname>Chesneau</surname><given-names>O</given-names></name><name><surname>Fraser</surname><given-names>JS</given-names></name><name><surname>Seiple</surname><given-names>IB</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Synthetic group a streptogramin antibiotics that overcome vat resistance</article-title><source>Nature</source><volume>586</volume><fpage>145</fpage><lpage>150</lpage><pub-id pub-id-type="doi">10.1038/s41586-020-2761-3</pub-id><pub-id pub-id-type="pmid">32968273</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lovell</surname><given-names>SC</given-names></name><name><surname>Word</surname><given-names>JM</given-names></name><name><surname>Richardson</surname><given-names>JS</given-names></name><name><surname>Richardson</surname><given-names>DC</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>The penultimate rotamer library</article-title><source>Proteins</source><volume>40</volume><fpage>389</fpage><lpage>408</lpage><pub-id pub-id-type="pmid">10861930</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Mehlman</surname><given-names>T</given-names></name><name><surname>Biel</surname><given-names>JT</given-names></name><name><surname>Azeem</surname><given-names>SM</given-names></name><name><surname>Nelson</surname><given-names>ER</given-names></name><name><surname>Hossain</surname><given-names>S</given-names></name><name><surname>Dunnett</surname><given-names>LE</given-names></name><name><surname>Paterson</surname><given-names>NG</given-names></name><name><surname>Douangamath</surname><given-names>A</given-names></name><name><surname>Talon</surname><given-names>R</given-names></name><name><surname>Axford</surname><given-names>D</given-names></name><name><surname>Orins</surname><given-names>H</given-names></name><name><surname>von Delft</surname><given-names>F</given-names></name><name><surname>Keedy</surname><given-names>DA</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Room-temperature crystallography reveals altered binding of small-molecule fragments to PTP1B</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2022.11.02.514751</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morin</surname><given-names>A</given-names></name><name><surname>Eisenbraun</surname><given-names>B</given-names></name><name><surname>Key</surname><given-names>J</given-names></name><name><surname>Sanschagrin</surname><given-names>PC</given-names></name><name><surname>Timony</surname><given-names>MA</given-names></name><name><surname>Ottaviano</surname><given-names>M</given-names></name><name><surname>Sliz</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Collaboration gets the most out of software</article-title><source>eLife</source><volume>2</volume><elocation-id>e01456</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.01456</pub-id><pub-id pub-id-type="pmid">24040512</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nakane</surname><given-names>T</given-names></name><name><surname>Kotecha</surname><given-names>A</given-names></name><name><surname>Sente</surname><given-names>A</given-names></name><name><surname>McMullan</surname><given-names>G</given-names></name><name><surname>Masiulis</surname><given-names>S</given-names></name><name><surname>Brown</surname><given-names>PMGE</given-names></name><name><surname>Grigoras</surname><given-names>IT</given-names></name><name><surname>Malinauskaite</surname><given-names>L</given-names></name><name><surname>Malinauskas</surname><given-names>T</given-names></name><name><surname>Miehling</surname><given-names>J</given-names></name><name><surname>Uchański</surname><given-names>T</given-names></name><name><surname>Yu</surname><given-names>L</given-names></name><name><surname>Karia</surname><given-names>D</given-names></name><name><surname>Pechnikova</surname><given-names>EV</given-names></name><name><surname>de Jong</surname><given-names>E</given-names></name><name><surname>Keizer</surname><given-names>J</given-names></name><name><surname>Bischoff</surname><given-names>M</given-names></name><name><surname>McCormack</surname><given-names>J</given-names></name><name><surname>Tiemeijer</surname><given-names>P</given-names></name><name><surname>Hardwick</surname><given-names>SW</given-names></name><name><surname>Chirgadze</surname><given-names>DY</given-names></name><name><surname>Murshudov</surname><given-names>G</given-names></name><name><surname>Aricescu</surname><given-names>AR</given-names></name><name><surname>Scheres</surname><given-names>SHW</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Single-particle cryo-EM at atomic resolution</article-title><source>Nature</source><volume>587</volume><fpage>152</fpage><lpage>156</lpage><pub-id pub-id-type="doi">10.1038/s41586-020-2829-0</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Orengo</surname><given-names>CA</given-names></name><name><surname>Michie</surname><given-names>AD</given-names></name><name><surname>Jones</surname><given-names>S</given-names></name><name><surname>Jones</surname><given-names>DT</given-names></name><name><surname>Swindells</surname><given-names>MB</given-names></name><name><surname>Thornton</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>CATH--a hierarchic classification of protein domain structures</article-title><source>Structure</source><volume>5</volume><fpage>1093</fpage><lpage>1108</lpage><pub-id pub-id-type="doi">10.1016/s0969-2126(97)00260-8</pub-id><pub-id pub-id-type="pmid">9309224</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Otten</surname><given-names>R</given-names></name><name><surname>Liu</surname><given-names>L</given-names></name><name><surname>Kenner</surname><given-names>LR</given-names></name><name><surname>Clarkson</surname><given-names>MW</given-names></name><name><surname>Mavor</surname><given-names>D</given-names></name><name><surname>Tawfik</surname><given-names>DS</given-names></name><name><surname>Kern</surname><given-names>D</given-names></name><name><surname>Fraser</surname><given-names>JS</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Rescue of conformational dynamics in enzyme catalysis by directed evolution</article-title><source>Nature Communications</source><volume>9</volume><elocation-id>1314</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-03562-9</pub-id><pub-id pub-id-type="pmid">29615624</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pearce</surname><given-names>NM</given-names></name><name><surname>Krojer</surname><given-names>T</given-names></name><name><surname>von Delft</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Proper modelling of ligand binding requires an ensemble of bound and unbound states</article-title><source>Acta Crystallographica Section D Structural Biology</source><volume>73</volume><fpage>256</fpage><lpage>266</lpage><pub-id pub-id-type="doi">10.1107/S2059798317003412</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pearce</surname><given-names>NM</given-names></name><name><surname>Gros</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>A method for intuitively extracting macromolecular dynamics from structural disorder</article-title><source>Nature Communications</source><volume>12</volume><elocation-id>5493</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-021-25814-x</pub-id><pub-id pub-id-type="pmid">34535675</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="web"><person-group person-group-type="author"><collab>Phenix</collab></person-group><year iso-8601-date="2023">2023</year><article-title>Computational crystallographic newsletter</article-title><ext-link ext-link-type="uri" xlink:href="https://phenix-online.org/phenixwebsite_static/mainsite/files/newsletter/CCN_2023_01.pdf#page=2">https://phenix-online.org/phenixwebsite_static/mainsite/files/newsletter/CCN_2023_01.pdf#page=2</ext-link><date-in-citation iso-8601-date="2023-01-05">January 5, 2023</date-in-citation></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pintilie</surname><given-names>G</given-names></name><name><surname>Zhang</surname><given-names>K</given-names></name><name><surname>Su</surname><given-names>Z</given-names></name><name><surname>Li</surname><given-names>S</given-names></name><name><surname>Schmid</surname><given-names>MF</given-names></name><name><surname>Chiu</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Measurement of atom resolvability in cryo-EM maps with Q-scores</article-title><source>Nature Methods</source><volume>17</volume><fpage>328</fpage><lpage>334</lpage><pub-id pub-id-type="doi">10.1038/s41592-020-0731-1</pub-id><pub-id pub-id-type="pmid">32042190</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ploscariu</surname><given-names>N</given-names></name><name><surname>Burnley</surname><given-names>T</given-names></name><name><surname>Gros</surname><given-names>P</given-names></name><name><surname>Pearce</surname><given-names>NM</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Improving sampling of crystallographic disorder in ensemble refinement</article-title><source>Acta Crystallographica. Section D, Structural Biology</source><volume>77</volume><fpage>1357</fpage><lpage>1364</lpage><pub-id pub-id-type="doi">10.1107/S2059798321010044</pub-id><pub-id pub-id-type="pmid">34726164</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Riley</surname><given-names>BT</given-names></name><name><surname>Wankowicz</surname><given-names>SA</given-names></name><name><surname>de Oliveira</surname><given-names>SHP</given-names></name><name><surname>van Zundert</surname><given-names>GCP</given-names></name><name><surname>Hogan</surname><given-names>DW</given-names></name><name><surname>Fraser</surname><given-names>JS</given-names></name><name><surname>Keedy</surname><given-names>DA</given-names></name><name><surname>van den Bedem</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>qFit 3: Protein and ligand multiconformer modeling for X-ray crystallographic and single-particle cryo-EM density maps</article-title><source>Protein Science</source><volume>30</volume><fpage>270</fpage><lpage>285</lpage><pub-id pub-id-type="doi">10.1002/pro.4001</pub-id><pub-id pub-id-type="pmid">33210433</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rodriguez-Corona</surname><given-names>U</given-names></name><name><surname>Sobol</surname><given-names>M</given-names></name><name><surname>Rodriguez-Zapata</surname><given-names>LC</given-names></name><name><surname>Hozak</surname><given-names>P</given-names></name><name><surname>Castano</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Fibrillarin from Archaea to human</article-title><source>Biology of the Cell</source><volume>107</volume><fpage>159</fpage><lpage>174</lpage><pub-id pub-id-type="doi">10.1111/boc.201400077</pub-id><pub-id pub-id-type="pmid">25772805</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schuller</surname><given-names>M</given-names></name><name><surname>Correy</surname><given-names>GJ</given-names></name><name><surname>Gahbauer</surname><given-names>S</given-names></name><name><surname>Fearon</surname><given-names>D</given-names></name><name><surname>Wu</surname><given-names>T</given-names></name><name><surname>Díaz</surname><given-names>RE</given-names></name><name><surname>Young</surname><given-names>ID</given-names></name><name><surname>Carvalho Martins</surname><given-names>L</given-names></name><name><surname>Smith</surname><given-names>DH</given-names></name><name><surname>Schulze-Gahmen</surname><given-names>U</given-names></name><name><surname>Owens</surname><given-names>TW</given-names></name><name><surname>Deshpande</surname><given-names>I</given-names></name><name><surname>Merz</surname><given-names>GE</given-names></name><name><surname>Thwin</surname><given-names>AC</given-names></name><name><surname>Biel</surname><given-names>JT</given-names></name><name><surname>Peters</surname><given-names>JK</given-names></name><name><surname>Moritz</surname><given-names>M</given-names></name><name><surname>Herrera</surname><given-names>N</given-names></name><name><surname>Kratochvil</surname><given-names>HT</given-names></name><collab>QCRG Structural Biology Consortium</collab><name><surname>Aimon</surname><given-names>A</given-names></name><name><surname>Bennett</surname><given-names>JM</given-names></name><name><surname>Brandao Neto</surname><given-names>J</given-names></name><name><surname>Cohen</surname><given-names>AE</given-names></name><name><surname>Dias</surname><given-names>A</given-names></name><name><surname>Douangamath</surname><given-names>A</given-names></name><name><surname>Dunnett</surname><given-names>L</given-names></name><name><surname>Fedorov</surname><given-names>O</given-names></name><name><surname>Ferla</surname><given-names>MP</given-names></name><name><surname>Fuchs</surname><given-names>MR</given-names></name><name><surname>Gorrie-Stone</surname><given-names>TJ</given-names></name><name><surname>Holton</surname><given-names>JM</given-names></name><name><surname>Johnson</surname><given-names>MG</given-names></name><name><surname>Krojer</surname><given-names>T</given-names></name><name><surname>Meigs</surname><given-names>G</given-names></name><name><surname>Powell</surname><given-names>AJ</given-names></name><name><surname>Rack</surname><given-names>JGM</given-names></name><name><surname>Rangel</surname><given-names>VL</given-names></name><name><surname>Russi</surname><given-names>S</given-names></name><name><surname>Skyner</surname><given-names>RE</given-names></name><name><surname>Smith</surname><given-names>CA</given-names></name><name><surname>Soares</surname><given-names>AS</given-names></name><name><surname>Wierman</surname><given-names>JL</given-names></name><name><surname>Zhu</surname><given-names>K</given-names></name><name><surname>O’Brien</surname><given-names>P</given-names></name><name><surname>Jura</surname><given-names>N</given-names></name><name><surname>Ashworth</surname><given-names>A</given-names></name><name><surname>Irwin</surname><given-names>JJ</given-names></name><name><surname>Thompson</surname><given-names>MC</given-names></name><name><surname>Gestwicki</surname><given-names>JE</given-names></name><name><surname>von Delft</surname><given-names>F</given-names></name><name><surname>Shoichet</surname><given-names>BK</given-names></name><name><surname>Fraser</surname><given-names>JS</given-names></name><name><surname>Ahel</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Fragment binding to the Nsp3 macrodomain of SARS-CoV-2 identified through crystallographic screening and computational docking</article-title><source>Science Advances</source><volume>7</volume><elocation-id>eabf8711</elocation-id><pub-id pub-id-type="doi">10.1126/sciadv.abf8711</pub-id><pub-id pub-id-type="pmid">33853786</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>JL</given-names></name><name><surname>Hendrickson</surname><given-names>WA</given-names></name><name><surname>Honzatko</surname><given-names>RB</given-names></name><name><surname>Sheriff</surname><given-names>S</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>Structural heterogeneity in protein crystals</article-title><source>Biochemistry</source><volume>25</volume><fpage>5018</fpage><lpage>5027</lpage><pub-id pub-id-type="doi">10.1021/bi00366a008</pub-id><pub-id pub-id-type="pmid">3768328</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stachowski</surname><given-names>TR</given-names></name><name><surname>Fischer</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>FLEXR: automated multi-conformer model building using electron-density map sampling</article-title><source>Acta Crystallographica. Section D, Structural Biology</source><volume>79</volume><fpage>354</fpage><lpage>367</lpage><pub-id pub-id-type="doi">10.1107/S2059798323002498</pub-id><pub-id pub-id-type="pmid">37071395</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Terashi</surname><given-names>G</given-names></name><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Maddhuri Venkata Subramaniya</surname><given-names>SR</given-names></name><name><surname>Tesmer</surname><given-names>JJG</given-names></name><name><surname>Kihara</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Residue-wise local quality estimation for protein models from cryo-EM maps</article-title><source>Nature Methods</source><volume>19</volume><fpage>1116</fpage><lpage>1125</lpage><pub-id pub-id-type="doi">10.1038/s41592-022-01574-4</pub-id><pub-id pub-id-type="pmid">35953671</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Terwilliger</surname><given-names>TC</given-names></name><name><surname>Grosse-Kunstleve</surname><given-names>RW</given-names></name><name><surname>Afonine</surname><given-names>PV</given-names></name><name><surname>Moriarty</surname><given-names>NW</given-names></name><name><surname>Adams</surname><given-names>PD</given-names></name><name><surname>Read</surname><given-names>RJ</given-names></name><name><surname>Zwart</surname><given-names>PH</given-names></name><name><surname>Hung</surname><given-names>L-W</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Iterative-build OMIT maps: map improvement by iterative model building and refinement without model bias</article-title><source>Acta Crystallographica Section D Biological Crystallography</source><volume>64</volume><fpage>515</fpage><lpage>524</lpage><pub-id pub-id-type="doi">10.1107/S0907444908004319</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vallat</surname><given-names>B</given-names></name><name><surname>Tauriello</surname><given-names>G</given-names></name><name><surname>Bienert</surname><given-names>S</given-names></name><name><surname>Haas</surname><given-names>J</given-names></name><name><surname>Webb</surname><given-names>BM</given-names></name><name><surname>Žídek</surname><given-names>A</given-names></name><name><surname>Zheng</surname><given-names>W</given-names></name><name><surname>Peisach</surname><given-names>E</given-names></name><name><surname>Piehl</surname><given-names>DW</given-names></name><name><surname>Anischanka</surname><given-names>I</given-names></name><name><surname>Sillitoe</surname><given-names>I</given-names></name><name><surname>Tolchard</surname><given-names>J</given-names></name><name><surname>Varadi</surname><given-names>M</given-names></name><name><surname>Baker</surname><given-names>D</given-names></name><name><surname>Orengo</surname><given-names>C</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Hoch</surname><given-names>JC</given-names></name><name><surname>Kurisu</surname><given-names>G</given-names></name><name><surname>Patwardhan</surname><given-names>A</given-names></name><name><surname>Velankar</surname><given-names>S</given-names></name><name><surname>Burley</surname><given-names>SK</given-names></name><name><surname>Sali</surname><given-names>A</given-names></name><name><surname>Schwede</surname><given-names>T</given-names></name><name><surname>Berman</surname><given-names>HM</given-names></name><name><surname>Westbrook</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>ModelCIF: an extension of PDBx/mmCIF data representation for computed structure models</article-title><source>Journal of Molecular Biology</source><volume>435</volume><elocation-id>168021</elocation-id><pub-id pub-id-type="doi">10.1016/j.jmb.2023.168021</pub-id><pub-id pub-id-type="pmid">36828268</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van den Bedem</surname><given-names>H</given-names></name><name><surname>Dhanik</surname><given-names>A</given-names></name><name><surname>Latombe</surname><given-names>JC</given-names></name><name><surname>Deacon</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Modeling discrete heterogeneity in X-ray diffraction data by fitting multi-conformers</article-title><source>Acta Crystallographica. Section D, Biological Crystallography</source><volume>65</volume><fpage>1107</fpage><lpage>1117</lpage><pub-id pub-id-type="doi">10.1107/S0907444909030613</pub-id><pub-id pub-id-type="pmid">19770508</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Zundert</surname><given-names>GCP</given-names></name><name><surname>Hudson</surname><given-names>BM</given-names></name><name><surname>de Oliveira</surname><given-names>SHP</given-names></name><name><surname>Keedy</surname><given-names>DA</given-names></name><name><surname>Fonseca</surname><given-names>R</given-names></name><name><surname>Heliou</surname><given-names>A</given-names></name><name><surname>Suresh</surname><given-names>P</given-names></name><name><surname>Borrelli</surname><given-names>K</given-names></name><name><surname>Day</surname><given-names>T</given-names></name><name><surname>Fraser</surname><given-names>JS</given-names></name><name><surname>van den Bedem</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>qFit-ligand reveals widespread conformational heterogeneity of drug-like molecules in X-Ray electron density maps</article-title><source>Journal of Medicinal Chemistry</source><volume>61</volume><fpage>11183</fpage><lpage>11198</lpage><pub-id pub-id-type="doi">10.1021/acs.jmedchem.8b01292</pub-id><pub-id pub-id-type="pmid">30457858</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vitkup</surname><given-names>D</given-names></name><name><surname>Ringe</surname><given-names>D</given-names></name><name><surname>Karplus</surname><given-names>M</given-names></name><name><surname>Petsko</surname><given-names>GA</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Why protein R-factors are so large: a self-consistent analysis</article-title><source>Proteins</source><volume>46</volume><fpage>345</fpage><lpage>354</lpage><pub-id pub-id-type="doi">10.1002/prot.10035</pub-id><pub-id pub-id-type="pmid">11835510</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Z</given-names></name><name><surname>Patwardhan</surname><given-names>A</given-names></name><name><surname>Kleywegt</surname><given-names>GJ</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Validation analysis of EMDB entries</article-title><source>Acta Crystallographica. Section D, Structural Biology</source><volume>78</volume><fpage>542</fpage><lpage>552</lpage><pub-id pub-id-type="doi">10.1107/S205979832200328X</pub-id><pub-id pub-id-type="pmid">35503203</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wankowicz</surname><given-names>SA</given-names></name><name><surname>de Oliveira</surname><given-names>SH</given-names></name><name><surname>Hogan</surname><given-names>DW</given-names></name><name><surname>van den Bedem</surname><given-names>H</given-names></name><name><surname>Fraser</surname><given-names>JS</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Ligand binding remodels protein side-chain conformational heterogeneity</article-title><source>eLife</source><volume>11</volume><elocation-id>e74114</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.74114</pub-id><pub-id pub-id-type="pmid">35312477</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Wankowicz</surname><given-names>S</given-names></name><name><surname>Fraser</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Comprehensive Encoding of Conformational and Compositional Protein Structural Ensembles through mmCIF Data Structure</article-title><source>ChemRxiv</source><pub-id pub-id-type="doi">10.26434/chemrxiv-2023-ggd1w-v3</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Wankowicz</surname><given-names>SA</given-names></name><name><surname>Ravikumar</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>Qfit_Biological_Testset</data-title><version designator="swh:1:rev:3019f425108f463d4b73a5c1d38322ab28cc9cdb">swh:1:rev:3019f425108f463d4b73a5c1d38322ab28cc9cdb</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:0636ec208ff592a71a54ef8431c787212fa60bb9;origin=https://github.com/fraser-lab/qFit_biological_testset;visit=swh:1:snp:ddd3633922508e187e3b56ff9e590e5dceb0d188;anchor=swh:1:rev:3019f425108f463d4b73a5c1d38322ab28cc9cdb">https://archive.softwareheritage.org/swh:1:dir:0636ec208ff592a71a54ef8431c787212fa60bb9;origin=https://github.com/fraser-lab/qFit_biological_testset;visit=swh:1:snp:ddd3633922508e187e3b56ff9e590e5dceb0d188;anchor=swh:1:rev:3019f425108f463d4b73a5c1d38322ab28cc9cdb</ext-link></element-citation></ref><ref id="bib70"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Wankowicz</surname><given-names>SA</given-names></name><name><surname>Riley</surname><given-names>B</given-names></name><name><surname>van Zundert</surname><given-names>G</given-names></name><name><surname>van den Bedem</surname><given-names>H</given-names></name><name><surname>Ravikumar</surname><given-names>A</given-names></name><name><surname>Hogan</surname><given-names>D</given-names></name><name><surname>Sharma</surname><given-names>S</given-names></name><name><surname>Flowers</surname><given-names>J</given-names></name><name><surname>Keedy</surname><given-names>D</given-names></name><collab>sauloho</collab></person-group><year iso-8601-date="2024">2024</year><data-title>Qfit-3.0</data-title><version designator="swh:1:rev:6960d03d1f95b74d8160b5a207dd29271c758297">swh:1:rev:6960d03d1f95b74d8160b5a207dd29271c758297</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:4619d63839ec3ca3f8db1b508a3884a7cec4a305;origin=https://github.com/ExcitedStates/qfit-3.0;visit=swh:1:snp:6b55ea5b6fe448ce23e07e648884170728f16c51;anchor=swh:1:rev:6960d03d1f95b74d8160b5a207dd29271c758297">https://archive.softwareheritage.org/swh:1:dir:4619d63839ec3ca3f8db1b508a3884a7cec4a305;origin=https://github.com/ExcitedStates/qfit-3.0;visit=swh:1:snp:6b55ea5b6fe448ce23e07e648884170728f16c51;anchor=swh:1:rev:6960d03d1f95b74d8160b5a207dd29271c758297</ext-link></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weichenberger</surname><given-names>CX</given-names></name><name><surname>Afonine</surname><given-names>PV</given-names></name><name><surname>Kantardjieff</surname><given-names>K</given-names></name><name><surname>Rupp</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The solvent component of macromolecular crystals</article-title><source>Acta Crystallographica. Section D, Biological Crystallography</source><volume>71</volume><fpage>1023</fpage><lpage>1038</lpage><pub-id pub-id-type="doi">10.1107/S1399004715006045</pub-id><pub-id pub-id-type="pmid">25945568</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Williams</surname><given-names>CJ</given-names></name><name><surname>Headd</surname><given-names>JJ</given-names></name><name><surname>Moriarty</surname><given-names>NW</given-names></name><name><surname>Prisant</surname><given-names>MG</given-names></name><name><surname>Videau</surname><given-names>LL</given-names></name><name><surname>Deis</surname><given-names>LN</given-names></name><name><surname>Verma</surname><given-names>V</given-names></name><name><surname>Keedy</surname><given-names>DA</given-names></name><name><surname>Hintze</surname><given-names>BJ</given-names></name><name><surname>Chen</surname><given-names>VB</given-names></name><name><surname>Jain</surname><given-names>S</given-names></name><name><surname>Lewis</surname><given-names>SM</given-names></name><name><surname>Arendall</surname><given-names>WB</given-names></name><name><surname>Snoeyink</surname><given-names>J</given-names></name><name><surname>Adams</surname><given-names>PD</given-names></name><name><surname>Lovell</surname><given-names>SC</given-names></name><name><surname>Richardson</surname><given-names>JS</given-names></name><name><surname>Richardson</surname><given-names>DC</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>MolProbity:more and better reference data for improved all-atom structure validation</article-title><source>Protein Science</source><volume>27</volume><fpage>293</fpage><lpage>315</lpage><pub-id pub-id-type="doi">10.1002/pro.3330</pub-id><pub-id pub-id-type="pmid">29067766</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Winn</surname><given-names>MD</given-names></name><name><surname>Ballard</surname><given-names>CC</given-names></name><name><surname>Cowtan</surname><given-names>KD</given-names></name><name><surname>Dodson</surname><given-names>EJ</given-names></name><name><surname>Emsley</surname><given-names>P</given-names></name><name><surname>Evans</surname><given-names>PR</given-names></name><name><surname>Keegan</surname><given-names>RM</given-names></name><name><surname>Krissinel</surname><given-names>EB</given-names></name><name><surname>Leslie</surname><given-names>AGW</given-names></name><name><surname>McCoy</surname><given-names>A</given-names></name><name><surname>McNicholas</surname><given-names>SJ</given-names></name><name><surname>Murshudov</surname><given-names>GN</given-names></name><name><surname>Pannu</surname><given-names>NS</given-names></name><name><surname>Potterton</surname><given-names>EA</given-names></name><name><surname>Powell</surname><given-names>HR</given-names></name><name><surname>Read</surname><given-names>RJ</given-names></name><name><surname>Vagin</surname><given-names>A</given-names></name><name><surname>Wilson</surname><given-names>KS</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Overview of the CCP4 suite and current developments</article-title><source>Acta Crystallographica. Section D, Biological Crystallography</source><volume>67</volume><fpage>235</fpage><lpage>242</lpage><pub-id pub-id-type="doi">10.1107/S0907444910045749</pub-id><pub-id pub-id-type="pmid">21460441</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Woldeyes</surname><given-names>RA</given-names></name><name><surname>Sivak</surname><given-names>DA</given-names></name><name><surname>Fraser</surname><given-names>JS</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>E pluribus unum, no more: from one crystal, many conformations</article-title><source>Current Opinion in Structural Biology</source><volume>28</volume><fpage>56</fpage><lpage>62</lpage><pub-id pub-id-type="doi">10.1016/j.sbi.2014.07.005</pub-id><pub-id pub-id-type="pmid">25113271</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Wolff</surname><given-names>AM</given-names></name><name><surname>Nango</surname><given-names>E</given-names></name><name><surname>Young</surname><given-names>ID</given-names></name><name><surname>Brewster</surname><given-names>AS</given-names></name><name><surname>Kubo</surname><given-names>M</given-names></name><name><surname>Nomura</surname><given-names>T</given-names></name><name><surname>Sugahara</surname><given-names>M</given-names></name><name><surname>Owada</surname><given-names>S</given-names></name><name><surname>Barad</surname><given-names>BA</given-names></name><name><surname>Ito</surname><given-names>K</given-names></name><name><surname>Bhowmick</surname><given-names>A</given-names></name><name><surname>Carbajo</surname><given-names>S</given-names></name><name><surname>Hino</surname><given-names>T</given-names></name><name><surname>Holton</surname><given-names>JM</given-names></name><name><surname>Im</surname><given-names>D</given-names></name><name><surname>O’Riordan</surname><given-names>LJ</given-names></name><name><surname>Tanaka</surname><given-names>T</given-names></name><name><surname>Tanaka</surname><given-names>R</given-names></name><name><surname>Sierra</surname><given-names>RG</given-names></name><name><surname>Yumoto</surname><given-names>F</given-names></name><name><surname>Tono</surname><given-names>K</given-names></name><name><surname>Iwata</surname><given-names>S</given-names></name><name><surname>Sauter</surname><given-names>NK</given-names></name><name><surname>Fraser</surname><given-names>JS</given-names></name><name><surname>Thompson</surname><given-names>MC</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Mapping protein dynamics at high spatial resolution with temperature-jump X-ray crystallography</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2022.06.10.495662</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xie</surname><given-names>Q</given-names></name><name><surname>Yoshioka</surname><given-names>CK</given-names></name><name><surname>Chapman</surname><given-names>MS</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Adeno-associated virus (AAV-DJ)-Cryo-EM structure at 1.56 Å resolution</article-title><source>Viruses</source><volume>12</volume><elocation-id>1194</elocation-id><pub-id pub-id-type="doi">10.3390/v12101194</pub-id><pub-id pub-id-type="pmid">33092282</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yabukarski</surname><given-names>F</given-names></name><name><surname>Doukov</surname><given-names>T</given-names></name><name><surname>Pinney</surname><given-names>MM</given-names></name><name><surname>Biel</surname><given-names>JT</given-names></name><name><surname>Fraser</surname><given-names>JS</given-names></name><name><surname>Herschlag</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Ensemble-function relationships to dissect mechanisms of enzyme catalysis</article-title><source>Science Advances</source><volume>8</volume><elocation-id>eabn7738</elocation-id><pub-id pub-id-type="doi">10.1126/sciadv.abn7738</pub-id><pub-id pub-id-type="pmid">36240280</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yip</surname><given-names>KM</given-names></name><name><surname>Fischer</surname><given-names>N</given-names></name><name><surname>Paknia</surname><given-names>E</given-names></name><name><surname>Chari</surname><given-names>A</given-names></name><name><surname>Stark</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Atomic-resolution protein structure determination by cryo-EM</article-title><source>Nature</source><volume>587</volume><fpage>157</fpage><lpage>161</lpage><pub-id pub-id-type="doi">10.1038/s41586-020-2833-4</pub-id><pub-id pub-id-type="pmid">33087927</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zaragoza</surname><given-names>JPT</given-names></name><name><surname>Offenbacher</surname><given-names>AR</given-names></name><name><surname>Hu</surname><given-names>S</given-names></name><name><surname>Gee</surname><given-names>CL</given-names></name><name><surname>Firestein</surname><given-names>ZM</given-names></name><name><surname>Minnetian</surname><given-names>N</given-names></name><name><surname>Deng</surname><given-names>Z</given-names></name><name><surname>Fan</surname><given-names>F</given-names></name><name><surname>Iavarone</surname><given-names>AT</given-names></name><name><surname>Klinman</surname><given-names>JP</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Temporal and spatial resolution of distal protein motions that activate hydrogen tunneling in soybean lipoxygenase</article-title><source>PNAS</source><volume>120</volume><elocation-id>e2211630120</elocation-id><pub-id pub-id-type="doi">10.1073/pnas.2211630120</pub-id><pub-id pub-id-type="pmid">36867685</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhong</surname><given-names>ED</given-names></name><name><surname>Bepler</surname><given-names>T</given-names></name><name><surname>Berger</surname><given-names>B</given-names></name><name><surname>Davis</surname><given-names>JH</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>CryoDRGN: reconstruction of heterogeneous cryo-EM structures using neural networks</article-title><source>Nature Methods</source><volume>18</volume><fpage>176</fpage><lpage>185</lpage><pub-id pub-id-type="doi">10.1038/s41592-020-01049-4</pub-id><pub-id pub-id-type="pmid">33542510</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.90606.3.sa0</article-id><title-group><article-title>eLife assessment</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Stockbridge</surname><given-names>Randy B</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution>University of Michigan</institution><country>United States</country></aff></contrib></contrib-group><kwd-group kwd-group-type="evidence-strength"><kwd>Convincing</kwd></kwd-group><kwd-group kwd-group-type="claim-importance"><kwd>Important</kwd></kwd-group></front-stub><body><p>This article offers <bold>important</bold> updates to qFit, the state-of-the art tool for modeling alternative conformations of protein molecules based on high-resolution X-ray diffraction or cryo-EM data. While the authors provide <bold>convincing</bold> examples of qFit's performance, these are restricted to selected test cases. This article will be of interest to structural biologists and protein biochemists more generally.</p></body></sub-article><sub-article article-type="referee-report" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.90606.3.sa1</article-id><title-group><article-title>Reviewer #1 (Public Review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>Protein conformational changes are often critical to protein function, but obtaining structural information about conformational ensembles is a challenge. Over a number of years, the authors of the current manuscript have developed and improved an algorithm, qFit protein, that models multiple conformations into high resolution electron density maps in an automated way. The current manuscript describes the latest improvements to the program, and analyzes the performance of qFit protein in a number of test cases, including classical statistical metrics of data fit like Rfree and the gap between Rwork and Rfree, model geometry, and global and case-by-case assessment of qFit performance at different data resolution cutoffs. The authors have also updated qFit to handle cryo-EM datasets, although the analysis of its performance is more limited due to a limited number of high-resolution test cases and less standardization of deposited/processed data.</p><p>Strengths:</p><p>The strengths of the manuscript are the careful and extensive analysis of qFit's performance over a variety of metrics and a diversity of test cases, as well as the careful discussion of the limitations of qFit. This manuscript also serves as a very useful guide for users in evaluating if and when qFit should be applied during structural refinement.</p></body></sub-article><sub-article article-type="referee-report" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.90606.3.sa2</article-id><title-group><article-title>Reviewer #2 (Public Review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>The manuscript by Wankowicz et al. describes updates to qFit, an algorithm for the characterization of conformational heterogeneity of protein molecules based on X-ray diffraction of Cryo-EM data. The work provides a clear description of the algorithm used by qFit. The authors then proceed to validate the performance of qFit by comparing it to deposited X-ray entries in the PDB in the 1.2-1.5 Å resolution range as quantified by Rfree, Rwork-Rfree, detailed examination of the conformations introduced by qFit, and performance on stereochemical measures (MolProbity scores). To examine the effect of experimental resolution of X-ray diffraction data, they start from an ultra high-resolution structure (SARS-CoV2 Nsp3 macrodomain) to determine how the loss of resolution (introduced artificially) degrades the ability of qFit to correctly infer the nature and presence of alternate conformations. The authors observe a gradual loss of ability to correctly infer alternate conformations as resolution degrades past 2 Å. The authors repeat this analysis for a larger set of entries in a more automated fashion and again observe that qFit works well for structures with resolutions better than 2 Å, with a rapid loss of accuracy at lower resolution. Finally, the authors examine the performance of qFit on cryo-EM data. Despite a few prominent examples, the authors find only a handful (8) of datasets for which they can confirm a resolution better than 2.0 Å. The performance of qFit on these maps is encouraging and will be of much interest because cryo-EM maps will, presumably, continue to improve and because of the rapid increase in the availability of such data for many supramolecular biological assemblies. As the authors note, practices in cryo-EM analysis are far from uniform, hampering the development and assessment of tools like qFit.</p><p>Strengths:</p><p>qFit improves the quality of refined structures at resolutions better than 2.0 A, in terms of reflecting true conformational heterogeneity and geometry. The algorithm is well designed and does not introduce spurious or unnecessary conformational heterogeneity. I was able to install and run the program without a problem within a computing cluster environment. The paper is well written and the validation thorough.</p><p>I found the section on cryo-EM particularly enlightening, both because it demonstrates the potential for discovery of conformational heterogeneity from such data by qFit, and because it clearly explains the hurdles towards this becoming common practice, including lack of uniformity in reporting resolution, and differences in map and solvent treatment.</p><p>Weaknesses:</p><p>The authors begin the results section by claiming that they made &quot;substantial improvement&quot; relative to the previous iteration of qFit, &quot;both algorithmically (e.g., scoring is improved by BIC, sampling of B factors is now included) and computationally (improving the efficiency and reliability of the code)&quot; (bottom of page 3). However, the paper does not provide a comparison to previous iterations of the software or quantitation of the effects of these specific improvements, such as whether scoring is improved by the BIC, how the application of BIC has changed since the previous paper, whether sampling of B factors helps, and whether the code faster. It would help the reader to understand what, if any, the significance of each of these improvements was.</p><p>The exclusion of structures containing ligands and multichain protein models in the validation of qFit was puzzling since both are very common in the PDB. This may convey the impression that qFit cannot handle such use cases. (Although it seems that qFit has an algorithm dedicated to modeling ligand heterogeneity and seems to be able to handle multiple chains). The paper would be more effective if it explained how a user of the software would handle scenarios with ligands and multiple chains, and why these would be excluded from analysis here.</p><p>It would be helpful to add some guidance on how/whether qFit models can be further refined afterwards in Coot, Phenix, ..., or whether these models are strictly intended as the terminal step in refinement.</p><p>Appraisal &amp; Discussion:</p><p>Overall, the authors convincingly demonstrate that qFit provides a reliable means to detect and model conformational heterogeneity within high-resolution X-ray diffraction datasets and (based on a smaller sample) in cryo-EM density maps. This represents the state of the art in the field and will be of interest to any structural biologist or biochemist seeking to attain an understanding of the structural basis of the function of their system of interest, including potential allosteric mechanisms-an area where there are still few good solutions. That is, I expect qFit to find widespread use.</p></body></sub-article><sub-article article-type="referee-report" id="sa3"><front-stub><article-id pub-id-type="doi">10.7554/eLife.90606.3.sa3</article-id><title-group><article-title>Reviewer #3 (Public Review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>The authors address a very important issue of going beyond a single-copy model obtained by the two principal experimental methods of structural biology, macromolecular crystallography and cryo electron microscopy (cryo-EM). Such multiconformer model is based on the fact that experimental data from both these methods represent a space- and time-average of a huge number of the molecules in a sample, or even in several samples, and that the respective distributions can be multimodal. Different from structure prediction methods, this approach is strongly based on high-resolution experimental information and requires validated single-copy high-quality models as input. Overall, the results support the authors' conclusions.</p><p>In fact, the method addresses two problems which could be considered separately:</p><p>- An automation of construction of multiple conformations when they can be identified visually;</p><p>- A determination of multiple conformations when their visual identification is difficult or impossible.</p><p>The first one is a known problem, when missing alternative conformations may cost a few percent in R-factors. While these conformations are relatively easy to detect and build manually, the current procedure may save significant time being quite efficient, as the test results show.</p><p>The second problem is important from the physical point of view and has been addressed first by Burling &amp; Brunger (1994; https://doi.org/10.1002/ijch.199400022). The new procedure deals with a second-order variation in the R-factors, of about 1% or less, like placing riding hydrogen atoms, modeling density deformation or variation of the bulk solvent. In such situations, it is hard to justify model improvement. Keeping Rfree values or their marginal decreasing can be considered as a sign that the model is not overfitted data but hardly as a strong argument in favor of the model.</p><p>In general, overall targets are less appropriate for this kind of problem and local characteristics may be better indicators. Improvement of the model geometry is a good choice. Indeed, yet Cruickshank (1956; https://doi.org/10.1107/S0365110X56002059) showed that averaged density images may lead to a shortening of covalent bonds when interpreting such maps by a single model. However, a total absence of geometric outliers is not necessarily required for the structures solved at a high resolution where diffraction data should have more freedom to place the atoms where the experiments &quot;see&quot; them.</p><p>The key local characteristic for multi conformer models is a closeness of the model map to the experimental one. Actually, the procedure uses a kind of such measure, the Bayesian information criteria (BIC). Unfortunately, there is no information about how sharply it identifies the best model, how much it changes between the initial and final models; in overall there is not any feeling about its values. The Q-score (page 17) can be a tool for the first problem where the multiple conformations are clearly separated and not for the second problem where the contributions from neighboring conformations are merged. In addition to BIC or to even more conventional target functions such as LS or local map correlation, the extreme and mean values of the local difference maps may help to validate the models.</p><p>This method with its results is a strong argument for a need in experimental data and information they contain, differently from a pure structure prediction. At the same time, absence of strong density-based proofs may limit its impact.</p><p>Strengths:</p><p>Addressing an important problem and automatization of model construction for alternative conformations using high-resolution experimental data.</p><p>Weaknesses:</p><p>An insufficient validation of the models when no discrete alternative conformations are visible and essentially missing local real-space validation indicators.</p></body></sub-article><sub-article article-type="author-comment" id="sa4"><front-stub><article-id pub-id-type="doi">10.7554/eLife.90606.3.sa4</article-id><title-group><article-title>Author response</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Wankowicz</surname><given-names>Stephanie A</given-names></name><role specific-use="author">Author</role><aff><institution>University of California, San Francisco</institution><addr-line><named-content content-type="city">San Francisco</named-content></addr-line><country>United States</country></aff></contrib><contrib contrib-type="author"><name><surname>Ravikumar</surname><given-names>Ashraya</given-names></name><role specific-use="author">Author</role><aff><institution>University of California San Francisco</institution><addr-line><named-content content-type="city">San Francisco</named-content></addr-line><country>United States</country></aff></contrib><contrib contrib-type="author"><name><surname>Sharma</surname><given-names>Shivani</given-names></name><role specific-use="author">Author</role><aff><institution>CUNY Advanced Science Research Center</institution><addr-line><named-content content-type="city">New York</named-content></addr-line><country>United States</country></aff></contrib><contrib contrib-type="author"><name><surname>Riley</surname><given-names>Blake</given-names></name><role specific-use="author">Author</role><aff><institution>CUNY Advanced Science Research Center</institution><addr-line><named-content content-type="city">New York</named-content></addr-line><country>United States</country></aff></contrib><contrib contrib-type="author"><name><surname>Raju</surname><given-names>Akshay</given-names></name><role specific-use="author">Author</role><aff><institution>CUNY Advanced Science Research Center</institution><addr-line><named-content content-type="city">New York</named-content></addr-line><country>United States</country></aff></contrib><contrib contrib-type="author"><name><surname>Hogan</surname><given-names>Daniel W</given-names></name><role specific-use="author">Author</role><aff><institution>University of California, San Francisco</institution><addr-line><named-content content-type="city">San Francisco</named-content></addr-line><country>United States</country></aff></contrib><contrib contrib-type="author"><name><surname>Flowers</surname><given-names>Jessica</given-names></name><role specific-use="author">Author</role><aff><institution>University of California San Francisco</institution><addr-line><named-content content-type="city">San Francisco</named-content></addr-line><country>United States</country></aff></contrib><contrib contrib-type="author"><name><surname>van den Bedem</surname><given-names>Henry</given-names></name><role specific-use="author">Author</role><aff><institution>Atomwise, Inc</institution><addr-line><named-content content-type="city">San Francisco</named-content></addr-line><country>United States</country></aff></contrib><contrib contrib-type="author"><name><surname>Keedy</surname><given-names>Daniel A</given-names></name><role specific-use="author">Author</role><aff><institution>CUNY Advanced Science Research Center</institution><addr-line><named-content content-type="city">New York</named-content></addr-line><country>United States</country></aff></contrib><contrib contrib-type="author"><name><surname>Fraser</surname><given-names>James S</given-names></name><role specific-use="author">Author</role><aff><institution>University of California, San Francisco</institution><addr-line><named-content content-type="city">San Francisco</named-content></addr-line><country>United States</country></aff></contrib></contrib-group></front-stub><body><p>The following is the authors’ response to the original reviews.</p><disp-quote content-type="editor-comment"><p><bold>Public Reviews:</bold></p><p><bold>Reviewer #1 (Public Review):</bold></p><p>Summary:</p><p>Protein conformational changes are often critical to protein function, but obtaining structural information about conformational ensembles is a challenge. Over a number of years, the authors of the current manuscript have developed and improved an algorithm, qFit protein, that models multiple conformations into high resolution electron density maps in an automated way. The current manuscript describes the latest improvements to the program, and analyzes the performance of qFit protein in a number of test cases, including classical statistical metrics of data fit like Rfree and the gap between Rwork and Rfree, model geometry, and global and case-by-case assessment of qFit performance at different data resolution cutoffs. The authors have also updated qFit to handle cryo-EM datasets, although the analysis of its performance is more limited due to a limited number of high-resolution test cases and less standardization of deposited/processed data.</p><p>Strengths:</p><p>The strengths of the manuscript are the careful and extensive analysis of qFit's performance over a variety of metrics and a diversity of test cases, as well as the careful discussion of the limitations of qFit. This manuscript also serves as a very useful guide for users in evaluating if and when qFit should be applied during structural refinement.</p><p><bold>Reviewer #2 (Public Review):</bold></p><p>Summary</p><p>The manuscript by Wankowicz et al. describes updates to qFit, an algorithm for the characterization of conformational heterogeneity of protein molecules based on X-ray diffraction of Cryo-EM data. The work provides a clear description of the algorithm used by qFit. The authors then proceed to validate the performance of qFit by comparing it to deposited X-ray entries in the PDB in the 1.2-1.5 Å resolution range as quantified by Rfree, Rwork-Rfree, detailed examination of the conformations introduced by qFit, and performance on stereochemical measures (MolProbity scores). To examine the effect of experimental resolution of X-ray diffraction data, they start from an ultra high-resolution structure (SARS-CoV2 Nsp3 macrodomain) to determine how the loss of resolution (introduced artificially) degrades the ability of qFit to correctly infer the nature and presence of alternate conformations. The authors observe a gradual loss of ability to correctly infer alternate conformations as resolution degrades past 2 Å. The authors repeat this analysis for a larger set of entries in a more automated fashion and again observe that qFit works well for structures with resolutions better than 2 Å, with a rapid loss of accuracy at lower resolution. Finally, the authors examine the performance of qFit on cryo-EM data. Despite a few prominent examples, the authors find only a handful (8) of datasets for which they can confirm a resolution better than 2.0 Å. The performance of qFit on these maps is encouraging and will be of much interest because cryo-EM maps will, presumably, continue to improve and because of the rapid increase in the availability of such data for many supramolecular biological assemblies. As the authors note, practices in cryo-EM analysis are far from uniform, hampering the development and assessment of tools like qFit.</p><p>Strengths</p><p>qFit improves the quality of refined structures at resolutions better than 2.0 A, in terms of reflecting true conformational heterogeneity and geometry. The algorithm is well designed and does not introduce spurious or unnecessary conformational heterogeneity. I was able to install and run the program without a problem within a computing cluster environment. The paper is well written and the validation thorough.</p><p>I found the section on cryo-EM particularly enlightening, both because it demonstrates the potential for discovery of conformational heterogeneity from such data by qFit, and because it clearly explains the hurdles towards this becoming common practice, including lack of uniformity in reporting resolution, and differences in map and solvent treatment.</p><p>Weaknesses</p><p>The authors begin the results section by claiming that they made &quot;substantial improvement&quot; relative to the previous iteration of qFit, &quot;both algorithmically (e.g., scoring is improved by BIC, sampling of B factors is now included) and computationally (improving the efficiency and reliability of the code)&quot; (bottom of page 3). However, the paper does not provide a comparison to previous iterations of the software or quantitation of the effects of these specific improvements, such as whether scoring is improved by the BIC, how the application of BIC has changed since the previous paper, whether sampling of B factors helps, and whether the code faster. It would help the reader to understand what, if any, the significance of each of these improvements was.</p></disp-quote><p>Indeed, it is difficult (embarrassingly) to benchmark against our past work due to the dependencies on different python packages and the lack of software engineering. With the infrastructure we’ve laid down with this paper, made possible by an EOSS grant from CZI, that will not be a problem going forward. Not only is the code more reliable and standardized, but we have developed several scientific test sets that can be used as a basis for broad comparisons to judge whether improvements are substantial. We’ve also changed with “substantial improvement” to “several modifications”  to indicate the lack of comparison to past versions.</p><disp-quote content-type="editor-comment"><p>The exclusion of structures containing ligands and multichain protein models in the validation of qFit was puzzling since both are very common in the PDB. This may convey the impression that qFit cannot handle such use cases. (Although it seems that qFit has an algorithm dedicated to modeling ligand heterogeneity and seems to be able to handle multiple chains). The paper would be more effective if it explained how a user of the software would handle scenarios with ligands and multiple chains, and why these would be excluded from analysis here.</p></disp-quote><p>qFit can indeed handle both. We left out multiple chains for simplicity in constructing a dataset enriched for small proteins while still covering diversity to speed the ability to rapidly iterate and test our approaches. Improvements to qFit ligand handling will be discussed in a forthcoming work as we face similar technical debt to what we saw in proteins and are undergoing a process of introducing “several modifications” that we hope will lead to “substantial improvement” - but at the very least will accelerate further development.</p><disp-quote content-type="editor-comment"><p>It would be helpful to add some guidance on how/whether qFit models can be further refined afterwards in Coot, Phenix, ..., or whether these models are strictly intended as the terminal step in refinement.</p></disp-quote><p>We added to the abstract:</p><p>“Importantly, unlike ensemble models, the multiconformer models produced by qFit can be manually modified in most major model building software (e.g. Coot)  and fit can be further improved by refinement using standard pipelines (e.g. Phenix, Refmac, Buster).”</p><p>and introduction:</p><p>“Multiconformer models are notably easier to modify and more interpretable in software like Coot12 unlike ensemble methods that generate multiple complete protein copies (Burnley et al. 2012; Ploscariu et al. 2021; Temple Burling and Brünger 1994).”</p><p>and results:</p><p>“This model can then be examined and edited in Coot12 or other visualization software, and further refined using software such as phenix.refine, refmac, or buster as the modeler sees fit.”</p><p>and discussion</p><p>“qFit is compatible with manual modification and further refinement as long as the subsequent software uses the PDB standard altloc column, as is common in most popular modeling and refinement programs. The models can therefore generally also be deposited in the PDB using the standard deposition and validation process.”</p><disp-quote content-type="editor-comment"><p>Appraisal &amp; Discussion</p><p>Overall, the authors convincingly demonstrate that qFit provides a reliable means to detect and model conformational heterogeneity within high-resolution X-ray diffraction datasets and (based on a smaller sample) in cryo-EM density maps. This represents the state of the art in the field and will be of interest to any structural biologist or biochemist seeking to attain an understanding of the structural basis of the function of their system of interest, including potential allosteric mechanisms-an area where there are still few good solutions. That is, I expect qFit to find widespread use.</p><p><bold>Reviewer #3 (Public Review):</bold></p><p>Summary:</p><p>The authors address a very important issue of going beyond a single-copy model obtained by the two principal experimental methods of structural biology, macromolecular crystallography and cryo electron microscopy (cryo-EM). Such multiconformer model is based on the fact that experimental data from both these methods represent a space- and time-average of a huge number of the molecules in a sample, or even in several samples, and that the respective distributions can be multimodal. Different from structure prediction methods, this approach is strongly based on high-resolution experimental information and requires validated single-copy high-quality models as input. Overall, the results support the authors' conclusions.</p><p>In fact, the method addresses two problems which could be considered separately:</p><p>- An automation of construction of multiple conformations when they can be identified visually;</p></disp-quote><p>- A determination of multiple conformations when their visual identification is difficult or impossible.</p><p>We often think about this problem similarly to the reviewer. However, in building qFit, we do not want to separate these problems - but rather use the first category (obvious visual identification) to build an approach that can accomplish part of the second category (difficult to visualize) without building “impossible”/nonexistent conformations - <italic>with a consistent approach/bias.</italic></p><disp-quote content-type="editor-comment"><p>The first one is a known problem, when missing alternative conformations may cost a few percent in R-factors. While these conformations are relatively easy to detect and build manually, the current procedure may save significant time being quite efficient, as the test results show.</p></disp-quote><p>We agree with the reviewers' assessment here. The “floor” in terms of impact is automating a tedious part of high resolution model building and improving model quality.</p><disp-quote content-type="editor-comment"><p>The second problem is important from the physical point of view and has been addressed first by Burling &amp; Brunger (1994; https://doi.org/10.1002/ijch.199400022). The new procedure deals with a second-order variation in the R-factors, of about 1% or less, like placing riding hydrogen atoms, modeling density deformation or variation of the bulk solvent. In such situations, it is hard to justify model improvement. Keeping Rfree values or their marginal decreasing can be considered as a sign that the model is not overfitted data but hardly as a strong argument in favor of the model.</p></disp-quote><p>We agree with the overall sentiment of this comment. What is a significant variation in R-free is an important question that we have looked at previously (http://dx.doi.org/10.1101/448795) and others have suggested an R-sleep for further cross validation (https://pubmed.ncbi.nlm.nih.gov/17704561/). For these reasons it is important to get at the significance of the changes to model types from large and diverse test sets, as we have here and in other works, and from careful examination of the <italic>biological</italic> significance of alternative conformations with experiments designed to test their importance in mechanism.</p><disp-quote content-type="editor-comment"><p>In general, overall targets are less appropriate for this kind of problem and local characteristics may be better indicators. Improvement of the model geometry is a good choice. Indeed, yet Cruickshank (1956; https://doi.org/10.1107/S0365110X56002059) showed that averaged density images may lead to a shortening of covalent bonds when interpreting such maps by a single model. However, a total absence of geometric outliers is not necessarily required for the structures solved at a high resolution where diffraction data should have more freedom to place the atoms where the experiments &quot;see&quot; them.</p></disp-quote><p>Again, we agree—geometric outliers should not be completely absent, but it is comforting when they and model/experiment agreement both improve.</p><disp-quote content-type="editor-comment"><p>The key local characteristic for multi conformer models is a closeness of the model map to the experimental one. Actually, the procedure uses a kind of such measure, the Bayesian information criteria (BIC). Unfortunately, there is no information about how sharply it identifies the best model, how much it changes between the initial and final models; in overall there is not any feeling about its values. The Q-score (page 17) can be a tool for the first problem where the multiple conformations are clearly separated and not for the second problem where the contributions from neighboring conformations are merged. In addition to BIC or to even more conventional target functions such as LS or local map correlation, the extreme and mean values of the local difference maps may help to validate the models.</p></disp-quote><p>We agree with the reviewer that the problem of “best” model determination is poorly posed here. We have been thinking a lot about htis in the context of Bayesian methods (see: https://www.ncbi.nlm.nih.gov/pmc/articles/PMC9278553/); however, a major stumbling block is in how variable representations of alternative conformations (and compositions) are handled. The answers are more (but by no means simply) straightforward for ensemble representations where the entire system is constantly represented but with multiple copies.</p><disp-quote content-type="editor-comment"><p>This method with its results is a strong argument for a need in experimental data and information they contain, differently from a pure structure prediction. At the same time, absence of strong density-based proofs may limit its impact.</p></disp-quote><p>We agree - indeed we think it will be difficult to further improve structure prediction methods without much more interaction with the experimental data.</p><disp-quote content-type="editor-comment"><p>Strengths:</p><p>Addressing an important problem and automatization of model construction for alternative conformations using high-resolution experimental data.</p><p>Weaknesses:</p><p>An insufficient validation of the models when no discrete alternative conformations are visible and essentially missing local real-space validation indicators.</p></disp-quote><p>While not perfect real space indicators, local real-space validation is implicit in the MIQP selection step and explicit when we do employ Q-score metrics.</p><disp-quote content-type="editor-comment"><p><bold>Recommendations for the authors:</bold></p><p><bold>Reviewer #1 (Recommendations For The Authors):</bold></p><p>A point of clarification: I don't understand why waters seem to be handled differently in for cryo-EM and crystallography datasets. I am interested about the statement on page 19 that the Molprobity Clashscore gets worse for cryo-EM datasets, primarily due to clashes with waters. But the qFit algorithm includes a round of refinement to optimize placement of ordered waters, and the clashscore improves for the qFit refinement in crystallography test cases. Why/how is this different for cryo-EM?</p></disp-quote><p>We agree that this was not an appropriate point. We believe that the high clash score is coming from side chains being incorrectly modeled. We have updated this in the manuscript and it will be a focus of future improvements.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #2 (Recommendations For The Authors):</bold></p><p>- It would be instructive to the reader to explain how qFit handles the chromophore in the PYP (1OTA) example. To this end, it would be helpful to include deposition of the multiconformer model of PYP. This might also be a suitable occasion for discussion of potential hurdles in the deposition of multiconformer models in the PDB (if any!). Such concerns may be real concerns causing hesitation among potential users.</p></disp-quote><p>Thank you for this comment. qFit does not alter the position or connectivity of any HETATM records (like the chromophore in this structure). Handling covalent modifications like this is an area of future development.</p><p>Regarding deposition, we have noted above that the discussion now includes:</p><p>“qFit is compatible with manual modification and further refinement as long as the subsequent software uses the PDB standard altloc column, as is common in most popular modeling and refinement programs. The models can therefore, generally also be deposited in the PDB using the standard deposition and validation process.”</p><p>Finally, we have placed all PDBs in a Zenodo deposition (XXX) and have included that language in the manuscript. It is currently under a separate data availability section (page XXX). We will defer to the editor as to the best header that should go under.</p><disp-quote content-type="editor-comment"><p>- It may be advisable to take the description of true/false pos/negatives out of the caption of Figure 4, and include it in a box or so, since these terms are important in the main text too, and the caption becomes very cluttered.</p></disp-quote><p>We think adding the description of true/false pos/negatives to the Figure panel would make it very cluttered and wordy. We would like to retain this description within the caption. We have also briefly described each in the main text.</p><disp-quote content-type="editor-comment"><p>- page 21, line 4: some issue with citation formatting.</p></disp-quote><p>We have updated these citations.</p><disp-quote content-type="editor-comment"><p>- page 25, second paragraph: cardinality is the number of members of a set. Perhaps &quot;minimal occupancy&quot; is more appropriate.</p></disp-quote><p>Thank you for pointing this out. This was a mistake and should have been called the occupancy threshold.</p><disp-quote content-type="editor-comment"><p>- page 26: it's - its</p></disp-quote><p>Thank you, we have made this change.</p><disp-quote content-type="editor-comment"><p>- Font sizes in Supplementary Figures 5-7 are too small to be readable.</p></disp-quote><p>We agree and will make this change.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #3 (Recommendations For The Authors):</bold></p><p>General remarks</p><p>(1) As I understand, the procedure starts from shifting residues one by one (page 4; A.1). Then, geometry reconstruction (e.g., B1) may be difficult in some cases joining back the shifted residues. It seems that such backbone perturbation can be done more efficiently by shifting groups of residues (&quot;potential coupled motions&quot;) as mentioned at the bottom of page 9. Did I miss its description?</p></disp-quote><p>We would describe the algorithm as sampling (which includes minimal shifts) in the backbone residues to ensure we can link neighboring residues. We agree that future iterations of qFit should include more effective backbone sampling by exploring motion along the Cβ-Cα, C-N, and (Cβ-Cα × C-N) bonds and exploring correlated backbone movements.</p><disp-quote content-type="editor-comment"><p>(2) While the paper is well split in clear parts, some of them seem to be not at their right/optimal place and better can be moved to &quot;Methods&quot; (detailed &quot;Overview of the qFit protein algorithm&quot; as a whole) or to &quot;Data&quot; missed now (Two first paragraphs of &quot;qFit improves overall fit...&quot;, page 8, and &quot;Generating the qFit test set&quot;, page 22, and &quot;Generating synthetic data ...&quot; at page 26; description of the test data set), At my personal taste, description of tests with simulated data (page 15) would be better before that of tests with real data.</p></disp-quote><p>Thank you for this comment, but we stand by our original decision to keep the general flow of the paper as it was submitted.</p><disp-quote content-type="editor-comment"><p>(3) I wonder if the term &quot;quadratic programming&quot; (e.g., A3, page 5) is appropriate. It supposes optimization of a quadratic function of the independent parameters and not of &quot;some&quot; parameters. This is like the crystallographic LS which is not a quadratic function of atomic coordinates, and I think this is a similar case here. Whatever the answer on this remark is, an example of the function and its parameters is certainly missed.</p></disp-quote><p>We think that the term quadratic programming is appropriate. We fit a function with a loss function (observed density - calculated density), while satisfying the independent parameters. We fit the coefficients minimizing a quadratic loss. We agree that the quadratic function is missing from the paper, and we have now included it in the Methods section.</p><disp-quote content-type="editor-comment"><p>Technical remarks to be answered by the authors :</p><p>(1) Page 1, Abstract, line 3. The ensemble modeling is not the only existing frontier, and saying &quot;one of the frontiers&quot; may be better. Also, this phrase gives a confusing impression that the authors aim to predict the ensemble models while they do it with experimental data.</p></disp-quote><p>We agree with this statement and have re-worded the abstract to reflect this.</p><disp-quote content-type="editor-comment"><p>(2) Page 2. Burling &amp; Brunger (1994) should be cited as predecessors. On the contrary, an excellent paper by Pearce &amp; Gros (2021) is not relevant here.</p></disp-quote><p>While we agree that we should mention the Burling &amp; Brunger paper and the Pearce &amp; Gros (2021) should not be removed as it is not discussing the method of ensemble refinement.</p><disp-quote content-type="editor-comment"><p>(3) Page 2, bottom. &quot;Further, when compared to ...&quot; The preference to such approach sounds too much affirmative.</p></disp-quote><p>We have amended this sentence to state:</p><p>“Multiconformer models are notably easier to modify and more interpretable in software like Coot(Emsley et al. 2010) unlike ensemble methods that generate multiple complete protein copies(Burnley et al. 2012; Ploscariu et al. 2021; Temple Burling and Brünger 1994).”</p><p>“The point we were trying to make in this sentence was that ensemble-based models are much harder to manually manipulate in Coot or other similar software compared to multiconformer models. We think that the new version of this sentence states this point more clearly.”</p><disp-quote content-type="editor-comment"><p>(4) Page 2, last paragraph. I do not see an obvious relation of references 15-17 to the phrase they are associated with.</p></disp-quote><p>We disagree with this statement, and think that these references are appropriate.</p><p>“Multiconformer models are notably easier to modify and more interpretable in software like Coot12 unlike ensemble methods that generate multiple complete protein copies (Burnley et al. 2012; Ploscariu et al. 2021; Temple Burling and Brünger 1994).”</p><disp-quote content-type="editor-comment"><p>(5) Page 3, paragraph 2. Cryo-EM maps should be also &quot;high-resolution&quot;; it does not read like this from the phrase.</p></disp-quote><p>We agree that high-resolution should be added, and the sentence now states:</p><p>“However, many factors make manually creating multiconformer models difficult and time-consuming. Interpreting weak density is complicated by noise arising from many sources, including crystal imperfections, radiation damage, and poor modeling in X-ray crystallography, and errors in particle alignment and classification, poor modeling of beam induced motion, and imperfect detector Detector Quantum Efficiency (DQE) in high-resolution cryo-EM.”</p><disp-quote content-type="editor-comment"><p>(6) Page 3, last paragraph before &quot;results&quot;. The words &quot;... in both individual cases and large structural bioinformatic projects&quot; do not have much meaning, except introducing a self-reference. Also, repeating &quot;better than 2 A&quot; looks not necessary.</p></disp-quote><p>We agree that this was unnecessary and have simplified the last sentence to state:</p><p>“With the improvements in model quality outlined here, qFit can now be increasingly used for finalizing high-resolution models to derive ensemble-function insights.”</p><disp-quote content-type="editor-comment"><p>(7) Page 3. &quot;Results&quot;. Could &quot;experimental&quot; be replaced by a synonym, like &quot;trial&quot;, to avoid confusing with the meaning &quot;using experimental data&quot;?</p></disp-quote><p>We have replaced experimental with exploratory to describe the use of qFit on CryoEM data. The statement now reads:</p><p>“For cryo-EM modeling applications, equivalent metrics of map and model quality are still developing, rendering the use of qFit for cryo-EM more exploratory.”</p><disp-quote content-type="editor-comment"><p>(8) Page 4, A.1. Should it be &quot;steps +/- 0.1&quot; and &quot;coordinate&quot; be &quot;coordinate axis&quot;? One can modify coordinates and not shift them. I do not understand how, with the given steps, the authors calculated the number of combinations (&quot;from 9 to 81&quot;). Could a long &quot;Alternatively, ...absent&quot; be reduced simply to &quot;Otherwise&quot;?</p></disp-quote><p>We have simplified and clarified the sentence on the sampling of backbone coordinates to state:</p><p>“If anisotropic B-factors are absent, the translation of coordinates occurs in the X, Y, and Z directions. Each translation takes place in steps of 0.1 along each coordinate axis, extending to 0.3 Å, resulting in 9 (if isotropic) or to 81 (if anisotropic) distinct backbone conformations for further analysis.”</p><disp-quote content-type="editor-comment"><p>(9) Page 6, B.1, line 2. Word &quot;linearly&quot; is meaningless here.</p></disp-quote><p>We have modified this to read:</p><p>“Moving from N- to C- terminus along the protein,”</p><disp-quote content-type="editor-comment"><p>(10) Page 9, line 2. It should be explained which data set is considered as the test set to calculate Rfree.</p></disp-quote><p>We think this is clear and would be repetitive if we duplicated it.</p><disp-quote content-type="editor-comment"><p>(11) Page 9, line 7. It should be &quot;a valuable metric&quot; and not &quot;an&quot;</p></disp-quote><p>We agree and have updated the sentence to read:</p><p>“Rfree is a valuable metric for monitoring overfitting, which is an important concern when increasing model parameters as is done in multiconformer modeling.”</p><disp-quote content-type="editor-comment"><p>(12) Page 10, paragraph 3. &quot;... as a string (Methods)&quot;. I did not find any other mention of this term &quot;string&quot;, including in &quot;Methods&quot; where it supposed to be explained. Either this should be explained (and an example is given?), or be avoided.</p></disp-quote><p>We agree that string is not necessary (discussing the programmatic datatype). We have removed this from the sentence. It now reads:</p><p>“To quantify how often qFit models new rotameric states, we analyzed the qFit models with <italic>phenix.rotalyze</italic>, which outputs the rotamer state for each conformer (<bold>Methods</bold>).”</p><disp-quote content-type="editor-comment"><p>(13) Page10, lines 3-4 from bottom. Are these two alternative conformations justified?</p></disp-quote><p>We are unsure what this is referring to.</p><disp-quote content-type="editor-comment"><p>(14) Page 12, Fig. 2A. In comparison with Supplement Fig 2C, the direction of axes is changed. Could they be similar in both Figures?</p></disp-quote><p>We have updated Supplementary Figure 2C to have the same direction of axes as Figure 2A.</p><disp-quote content-type="editor-comment"><p>(15) Page 15, section's title. Choose a single verb in &quot;demonstrate indicate&quot;.</p></disp-quote><p>We have amended the title of this section to be:</p><p>“Simulated data demonstrate qFit is appropriate for high-resolution data.”</p><disp-quote content-type="editor-comment"><p>(16) Page 15, paragraph 2. &quot;Structure factors from 0.8 to 3.0 A resolution&quot; does not mean what the author wanted apparently to tell: &quot;(complete?) data sets with the high-resolution limit which varied from 0.8 to 3.0 A ...&quot;. Also, a phrase of &quot;random noise increasing&quot; is not illustrated by Figs.5 as it is referred to.</p></disp-quote><p>We have edited this sentence to now read:</p><p>“To create the dataset for resolution dependence, we used the ground truth 7KR0 model, including all alternative conformations, and generated artificial structure factors with a high resolution limit ranging from  0.8 to 3.0 Å resolution (in increments of 0.1 Å).”</p><disp-quote content-type="editor-comment"><p>(17) Page 15, last paragraph is written in a rather formal and confusing way while a clearer description is given in the figure legend and repeated once more in Methods. I would suggest to remove this paragraph.</p></disp-quote><p>We agree that this is confusing. Instead of create a true positive/false positive/true negative/false negative matrix, we have just called things as they are, multiconformer or single conformer and match or no match. We have edited the language the in the manuscript and figure legends to reflect these changes.</p><disp-quote content-type="editor-comment"><p>(18) Page 16. Last two paragraphs start talking about a new story and it would help to separate them somehow from the previous ones (sub-title?).</p></disp-quote><p>We agree that this could use a subtitle. We have included the following subtitle above this section:</p><p>“Simulated multiconformer data illustrate the convergence of qFit.”</p><disp-quote content-type="editor-comment"><p>(19) Page 20. &quot;or static&quot; and &quot;we determined that&quot; seem to be not necessary.</p></disp-quote><p>We have removed static and only used single conformer models. However, as one of the main conclusions of this paper is determining that qFit can pick up on alternative conformers that were modeled manually, we have decided to the keep the “we determined that”.</p><disp-quote content-type="editor-comment"><p>(20) Page 21, first paragraph. &quot;Data&quot; are plural; it should be &quot;show&quot; and &quot;require&quot;</p></disp-quote><p>We have made these edits. The sentence now reads:</p><p>“However, our data here shows that not only does qFit need a high-resolution map to be able to detect signal from noise, it also requires a very well-modeled structure as input.”</p><disp-quote content-type="editor-comment"><p>(21) Page 21, References should be indicated as [41-45], [35,46-48], [55-57]. A similar remark to [58-63] at page 22.</p></disp-quote><p>We have fixed the reference layout to reflect this change.</p><disp-quote content-type="editor-comment"><p>(22) Page 21, last paragraph. &quot;Further reduce R-factors&quot; (moreover repeated twice) is not correct neither by &quot;further&quot;, since here it is rather marginal, nor as a goal; the variations of R-factors are not much significant. A more general statement like &quot;improving fit to experimental data&quot; (keeping in mind density maps) may be safer.</p></disp-quote><p>We agree with the duplicative nature of these statements. We have amended the sentence to now read:</p><p>“Automated detection and refinement of partial-occupancy waters should help improve fit to experimental data further reduce Rfree15 and provide additional insights into hydrogen-bond patterns and the influence of solvent on alternative conformations.”</p><disp-quote content-type="editor-comment"><p>(23) Page 22. Sub-sections of &quot;Methods&quot; are given in a little bit random order; &quot;Parallelization of large maps&quot; in the middle of the text is an example. Put them in a better order may help.</p></disp-quote><p>We have moved some section of the Methods around and made better headings by using an underscore to highlight the subsections (<italic>Generating and running the qFit test set, qFit improved features, Analysis metrics, Generating synthetic data for resolution dependence).</italic></p><disp-quote content-type="editor-comment"><p>(24) Page 24. Non-convex solution is a strange term. There exist non-convex problems and functions and not solutions.</p></disp-quote><p>We agree and we have changed the language to reflect that we present the algorithm with non-convex problems which it cannot solve.</p><disp-quote content-type="editor-comment"><p>(25) Page 26, &quot;Metrics&quot;. It is worthy to describe explicitly the metrics and not (only) the references to the scripts.</p></disp-quote><p>For all metrics, we describe a sentence or two on what each metric describes. As these metrics are well known in the structural biology field, we do not feel that we need to elaborate on them more.</p><disp-quote content-type="editor-comment"><p>(26) Page 26. Multiplying B by occupancy does not have much sense. A better option would be to refer to the density value in the atomic center as occ*(4*pi/B)^1.5 which gives a relation between these two entities.</p></disp-quote><p>We agree and have update the B-factor figures and metrics to reflect this.</p><disp-quote content-type="editor-comment"><p>(27) Page 40, suppl. Fig. 5. Due to the color choice, it is difficult to distinguish the green and blue curves in the diagram.</p></disp-quote><p>We have amended this with the colors of the curves have been switched.</p><disp-quote content-type="editor-comment"><p>(28) Page 42, Suppl. Fig. 7. (A) How the width of shaded regions is defined? (B) What the blue regions stand for? Input Rfree range goes up to 0.26 and not to 0.25; there is a point at the right bound. (C) Bounds for the &quot;orange&quot; occupancy are inversed in the legend.</p></disp-quote><p>(A) The width of the shaded region denotes the standard deviations among the values at every resolution. We have made this clearer in the caption</p><p>(B) The blue region denotes the confidence interval for the regression estimate. Size of the confidence interval was set to 95%. We have made this clearer in the caption</p><p>(C) This has been fixed now</p><p>The maximum R-free value is 0.2543, which we rounded down to 0.25.</p><disp-quote content-type="editor-comment"><p>(29) Page 43. Letters E-H in the legend are erroneously substituted by B-E.</p></disp-quote><p>We apologize for this mistake. It is now corrected.</p></body></sub-article></article>