<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN"  "JATS-archivearticle1-3-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">91532</article-id><article-id pub-id-type="doi">10.7554/eLife.91532</article-id><article-id pub-id-type="doi" specific-use="version">10.7554/eLife.91532.3</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Deciphering the genetic code of neuronal type connectivity through bilinear modeling</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-320061"><name><surname>Qiao</surname><given-names>Mu</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7309-4237</contrib-id><email>muqiao0626@gmail.com</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02fyxhe35</institution-id><institution>LinkedIn</institution></institution-wrap><addr-line><named-content content-type="city">Mountain View</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Nelson</surname><given-names>Sacha B</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05abbep66</institution-id><institution>Brandeis University</institution></institution-wrap><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Nelson</surname><given-names>Sacha B</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05abbep66</institution-id><institution>Brandeis University</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><pub-date publication-format="electronic" date-type="publication"><day>10</day><month>06</month><year>2024</year></pub-date><volume>12</volume><elocation-id>RP91532</elocation-id><history><date date-type="sent-for-review" iso-8601-date="2023-08-25"><day>25</day><month>08</month><year>2023</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint.</event-desc><date date-type="preprint" iso-8601-date="2023-08-04"><day>04</day><month>08</month><year>2023</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.08.01.551532"/></event><event><event-desc>This manuscript was published as a reviewed preprint.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2023-11-28"><day>28</day><month>11</month><year>2023</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.91532.1"/></event><event><event-desc>The reviewed preprint was revised.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2024-04-11"><day>11</day><month>04</month><year>2024</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.91532.2"/></event></pub-history><permissions><copyright-statement>Â© 2023, Qiao</copyright-statement><copyright-year>2023</copyright-year><copyright-holder>Qiao</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-91532-v1.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-91532-figures-v1.pdf"/><abstract><p>Understanding how different neuronal types connect and communicate is critical to interpreting brain function and behavior. However, it has remained a formidable challenge to decipher the genetic underpinnings that dictate the specific connections formed between neuronal types. To address this, we propose a novel bilinear modeling approach that leverages the architecture similar to that of recommendation systems. Our model transforms the gene expressions of presynaptic and postsynaptic neuronal types, obtained from single-cell transcriptomics, into a covariance matrix. The objective is to construct this covariance matrix that closely mirrors a connectivity matrix, derived from connectomic data, reflecting the known anatomical connections between these neuronal types. When tested on a dataset of <italic>Caenorhabditis elegans</italic>, our model achieved a performance comparable to, if slightly better than, the previously proposed spatial connectome model (SCM) in reconstructing electrical synaptic connectivity based on gene expressions. Through a comparative analysis, our model not only captured all genetic interactions identified by the SCM but also inferred additional ones. Applied to a mouse retinal neuronal dataset, the bilinear model successfully recapitulated recognized connectivity motifs between bipolar cells and retinal ganglion cells, and provided interpretable insights into genetic interactions shaping the connectivity. Specifically, it identified unique genetic signatures associated with different connectivity motifs, including genes important to cell-cell adhesion and synapse formation, highlighting their role in orchestrating specific synaptic connections between these neurons. Our work establishes an innovative computational strategy for decoding the genetic programming of neuronal type connectivity. It not only sets a new benchmark for single-cell transcriptomic analysis of synaptic connections but also paves the way for mechanistic studies of neural circuit assembly and genetic manipulation of circuit wiring.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>bilinear model</kwd><kwd>gene-connectivity mapping</kwd><kwd>transcriptome</kwd><kwd>connectome</kwd><kwd>neural circuitry</kwd><kwd>mouse retinal circuit</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>C. elegans</italic></kwd><kwd>Mouse</kwd></kwd-group><funding-group><funding-statement>No external funding was received for this work.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A novel bilinear modeling approach reveals genetic code of neuronal connectivity, offering insights for targeted genetic interventions in neural circuits.</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>publishing-route</meta-name><meta-value>prc</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>One of the fundamental objectives in neuroscience is understanding how diverse neuronal cell types establish connections to form functional circuits. This understanding serves as a cornerstone for decoding how the nervous system processes information and coordinates responses to stimuli (<xref ref-type="bibr" rid="bib71">Seung, 2012</xref>). Despite this, the genetic mechanisms determining the specific connections between distinct neuronal types, especially within complex brain structures, remains elusive (<xref ref-type="bibr" rid="bib59">Polleux and Snider, 2010</xref>; <xref ref-type="bibr" rid="bib69">Sanes and Zipursky, 2020</xref>).</p><p>Recent advances in transcriptomics and connectomics provide opportunities to probe this. Single-cell transcriptomics enables high-resolution profiling of gene expressions across neuronal types (<xref ref-type="bibr" rid="bib94">Zeng and Sanes, 2017</xref>; <xref ref-type="bibr" rid="bib73">Stegle et al., 2015</xref>), while connectomic data offers detailed maps quantifying connections between neuronal cell types (<xref ref-type="bibr" rid="bib17">Denk and Horstmann, 2004</xref>; <xref ref-type="bibr" rid="bib30">Helmstaedter et al., 2013</xref>; <xref ref-type="bibr" rid="bib79">Tapia et al., 2012</xref>). However, the challenge of linking gene expressions derived from single-cell transcriptomics to neuronal type connectivity evident from connectomic data to uncover the genetic underpinnings has yet to be fully addressed.</p><p>Drawing inspiration from the field of machine learning, particularly recommendation systems, we introduce a bilinear model to bridge this gap. This model, in the context of recommendation systems, has been successful in capturing intricate user-item interactions (<xref ref-type="bibr" rid="bib35">Koren et al., 2009</xref>). By treating the gene expressions of pre- and post-synaptic neurons and their connectivity akin to users, items, and their ratings, we adapt the architecture of recommendation systems to the neurobiological domain. We hypothesize that a similar model could capture the complex relationships between genetic patterns of presynaptic and postsynaptic neurons and their connectivity.</p><p>This bilinear modeling approach was first applied to a <italic>Caenorhabditis elegans</italic> (<italic>C. elegans</italic>) neuronal dataset, where it not only matched but slightly outperformed the spatial connectome model (SCM) in reconstructing the connectivity of electrical synapses or gap junctions from innexin gene expressions. Notably, it revealed additional genetic interactions beyond those uncovered by the SCM. When extended to mouse retinal neurons, we demonstrate that it could effectively reconstruct synaptic connectivity between bipolar cells (BCs) and retinal ganglion cells (RGCs) from their gene expressions. The model not only unveils connectivity motifs between BCs and RGCs but also provides biologically meaningful insights into candidate genes and the genetic interactions that orchestrate this connectivity. Furthermore, our model predicts potential BC partners for RGC transcriptomic types, with these predictions aligned substantially with functional descriptions of these cell types from previous studies. Collectively, this work significantly contributes to the ongoing exploration of the genetic code underlying neuronal connectivity and suggests a potential paradigm shift in the analysis of single-cell transcriptomic data in neuroscience.</p><sec id="s1-1"><title>Background</title><sec id="s1-1-1"><title>Synaptic specificity</title><p>The intricate neural networks that form the basis of our nervous system are a product of specific synaptic connections between different types of neurons. This specificity is not a mere coincidence but a meticulously orchestrated process that underpins the functionality of the entire network (<xref ref-type="bibr" rid="bib69">Sanes and Zipursky, 2020</xref>; <xref ref-type="bibr" rid="bib49">Martin et al., 2020</xref>). Each neuron can form thousands of connections, or synapses, with other neurons, and the specificity of these connections determines the neuronâ€™s function and, by extension, the networkâ€™s function as a whole.</p><p>Synaptic specificity encompasses both chemical synapses, which rely on neurotransmitter-mediated communication between pre- and post-synaptic neurons (<xref ref-type="bibr" rid="bib69">Sanes and Zipursky, 2020</xref>), and electrical synapses, where direct transmission of ions or small molecules occurs via gap junctions (<xref ref-type="bibr" rid="bib49">Martin et al., 2020</xref>). A classic example of chemical synaptic specificity is observed in the retina, where different types of BCs form specific synaptic connections with various types of RGCs (<xref ref-type="bibr" rid="bib30">Helmstaedter et al., 2013</xref>; <xref ref-type="bibr" rid="bib23">Euler et al., 2014</xref>; <xref ref-type="bibr" rid="bib68">Sanes and Masland, 2015</xref>). These connections create parallel pathways that transform visual signals from photoreceptors to RGCs, which subsequently transmit the information to the brain (<xref ref-type="bibr" rid="bib26">Gollisch and Meister, 2010</xref>; <xref ref-type="bibr" rid="bib1">Azeredo da Silveira and Roska, 2011</xref>). Meanwhile, specific gap junction connections, composed of connexins in vertebrates and innexins in invertebrates, has been observed between <italic>C. elegans</italic> neurons (<xref ref-type="bibr" rid="bib39">Kumar and Gilula, 1996</xref>; <xref ref-type="bibr" rid="bib58">Phelan et al., 1998</xref>; <xref ref-type="bibr" rid="bib62">Rabinowitch and Schafer, 2015</xref>; <xref ref-type="bibr" rid="bib48">Marcus et al., 2014</xref>; <xref ref-type="bibr" rid="bib76">SÃ¼dhof, 2017</xref>). They function broadly in neural circuits of sensory processing and behavioral output (<xref ref-type="bibr" rid="bib49">Martin et al., 2020</xref>; <xref ref-type="bibr" rid="bib29">Hall, 2017</xref>).</p><p>The genetic principles guiding the formation of these specific connections, particularly in complex brain structures, remains elusive. The brainâ€™s complexity, with its billions of neurons and trillions of synapses, poses significant challenges in identifying the specific genes and genetic mechanisms that guide the formation of these connections. Despite advances in genetic and neurobiological research, such as understanding the roles of certain recognition molecules and adhesion molecules in synaptic specificity, the genetic foundation of connectivity between neuronal types is still largely unknown (<xref ref-type="bibr" rid="bib69">Sanes and Zipursky, 2020</xref>; <xref ref-type="bibr" rid="bib16">de Wit and Ghosh, 2016</xref>; <xref ref-type="bibr" rid="bib49">Martin et al., 2020</xref>).</p><p>Emerging tools and technologies offer unprecedented opportunities to unravel these mysteries. Among these, transcriptome and connectome are particularly promising (<xref ref-type="bibr" rid="bib69">Sanes and Zipursky, 2020</xref>; <xref ref-type="bibr" rid="bib24">Fornito et al., 2019</xref>). Transcriptome, the complete set of RNA transcripts produced by the genome, can provide valuable insights into the genes that are active in different types of neurons and at different stages of neuronal development. This can help identify candidate genes that may play a role in guiding neuronal connectivity. Connectome, on the other hand, provides a detailed map of the connections between neurons. By combining information from transcriptome and connectome, it is possible to link specific genes to specific connections, thereby shedding light on the genetic basis of synaptic connectivity.</p></sec><sec id="s1-1-2"><title>Previous approaches</title><p>Prior research has reported several methodologies to unravel the genetic underpinnings of neuronal connectivity. For instance, Kaufman et al. showed a correlation between gene expression of <italic>C. elegans</italic> neurons and their connectivity (<xref ref-type="bibr" rid="bib33">Kaufman et al., 2006</xref>), and Varadan et al. developed an entropy minimization approach for understanding the molecular logic of synaptic connectivity in <italic>C. elegans</italic> (<xref ref-type="bibr" rid="bib87">Varadan et al., 2006</xref>). These models, however, did not fully account for spatial constraints for synaptic formation.</p><p>In response, subsequent studies proposed methodologies that integrate gene expressions with neuronal connectivity, taking into consideration physical contacts between neurons (<xref ref-type="bibr" rid="bib36">KovÃ¡cs et al., 2020</xref>; <xref ref-type="bibr" rid="bib4">BarabÃ¡si and BarabÃ¡si, 2020</xref>; <xref ref-type="bibr" rid="bib82">Taylor et al., 2021</xref>). Specifically, the SCM in KovÃ¡cs et al. correlates the gene expression of neurons with their connectivity via a rule matrix. This model aims to minimize the discrepancy between predicted connectivity based on gene expression, and observed connectivity. By restricting the analysis to neuron pairs that are in physical contact, the SCM transforms the original problem into a regression between the Kronecker product of the gene expression matrix and an edge list that captures neuronal connectivity (<xref ref-type="bibr" rid="bib36">KovÃ¡cs et al., 2020</xref>).</p><p>Additionally, Taylor et al. introduced the network differential gene expression analysis (nDGE), a statistical method that expands upon traditional differential gene expression analysis by examining the co-expression of gene pairs between neuron pairs, comparing synaptic versus non-synaptic neuronal groups through t-tests. It incorporates physical contacts between neurons through the generation of â€˜pseudoconnectomesâ€™ for null distribution estimation. Unlike multivariate methods such as the SCM, nDGE operates as a mass-univariate method, focusing on single gene pairsâ€™ contributions to synaptic formation without considering the complex interactions among multiple co-expressed genes. This makes nDGEâ€™s findings inherently conservative, ensuring strict control over type 1 errors but potentially underestimating the multifaceted nature of synaptic connectivity (<xref ref-type="bibr" rid="bib82">Taylor et al., 2021</xref>).</p><p>While the SCM and nDGE models have focused on the connectivity of individual neurons and were tested using <italic>C. elegans</italic> datasets, their generalization to neuronal cell types has not been explored. As we move from the invertebrate nervous systems to the neural architectures of vertebrates, such as those in mice or macaques, we need methodologies capable of unraveling the genetic basis of neuronal type connectivity (<xref ref-type="bibr" rid="bib94">Zeng and Sanes, 2017</xref>; <xref ref-type="bibr" rid="bib95">Zeng, 2022</xref>).</p></sec><sec id="s1-1-3"><title>Collaborative filtering</title><p>Our strategy draws inspiration from the concept of collaborative filtering using bilinear models, a technique fundamental to recommendation systems (<xref ref-type="bibr" rid="bib66">Ricci et al., 2011</xref>; <xref ref-type="bibr" rid="bib75">Su and Khoshgoftaar, 2009</xref>). These systems predict a userâ€™s preference for an item (e.g. a movie or product) based on user-item interaction data.</p><p>Bilinear models capture the interaction between users and items via low-dimensional latent features (<xref ref-type="bibr" rid="bib35">Koren et al., 2009</xref>; <xref ref-type="bibr" rid="bib65">Rendle et al., 2012</xref>). Mathematically, for user <inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>i</mml:mi></mml:mstyle></mml:math></inline-formula> and item <inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>j</mml:mi></mml:mstyle></mml:math></inline-formula>, we denote their original features as <inline-formula><mml:math id="inf3"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">ğ’™</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>âˆˆ</mml:mo><mml:msup><mml:mi mathvariant="bold">ğ‘</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>Ã—</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf4"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">ğ’š</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>âˆˆ</mml:mo><mml:msup><mml:mi mathvariant="bold">ğ‘</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>Ã—</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, respectively. These features are then projected into a shared latent space with dimension <inline-formula><mml:math id="inf5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>d</mml:mi></mml:mstyle></mml:math></inline-formula> via transformations <inline-formula><mml:math id="inf6"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">ğ’™</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi></mml:mrow></mml:math></inline-formula> (where <inline-formula><mml:math id="inf7"><mml:mrow><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi><mml:mo>âˆˆ</mml:mo><mml:msup><mml:mi mathvariant="bold">ğ‘</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>Ã—</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) and <inline-formula><mml:math id="inf8"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">ğ’š</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi></mml:mrow></mml:math></inline-formula> (where <inline-formula><mml:math id="inf9"><mml:mrow><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi><mml:mo>âˆˆ</mml:mo><mml:msup><mml:mi mathvariant="bold">ğ‘</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mo>Ã—</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>). The predicted rating of the user for the item is then formulated as:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula></p><p>In the context of collaborative filtering, the goal is to optimize the transformation matrices <inline-formula><mml:math id="inf10"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf11"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi></mml:math></inline-formula> to align the predicted rating <inline-formula><mml:math id="inf12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>r</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> with the ground-truth <inline-formula><mml:math id="inf13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>z</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>. This is expressed as the following optimization problem:<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mo form="prefix">min</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:munder><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>âˆ’</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Or in the matrix form:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:munder><mml:mo form="prefix">min</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mo>âˆ’</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></disp-formula></p><p>Here, the objective is to minimize the Frobenius norm of the residual matrix <inline-formula><mml:math id="inf14"><mml:mrow><mml:mi mathvariant="bold-italic">ğ’</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">ğ‘¿</mml:mi><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">ğ’€</mml:mi><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>In our study, we interpret neuronal connectivity through the lens of recommendation systems, viewing presynaptic neurons as â€˜usersâ€™, postsynaptic neurons as â€˜itemsâ€™, and the synapses formed between them as â€˜ratingsâ€™. Our chosen bilinear model extracts latent features of pre- and post-synaptic neurons from their respective gene expressions. One key advantage of the bilinear model is its capacity to assign different weights to the gene expressions of pre- and post-synaptic neurons, enabling the model to capture not just homogeneous but also complex, heterogeneous interactions fundamental to understanding neuronal connectivity. Prior studies have highlighted such heterogeneous interactions, noting the formation of connections between pre- and post-synaptic neurons expressing different cadherins, indicative of a heterogeneous adhesion process (<xref ref-type="bibr" rid="bib20">Duan et al., 2014</xref>; <xref ref-type="bibr" rid="bib21">Duan et al., 2018</xref>).</p></sec></sec></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Bilinear model for neuronal type connectivity</title><p>We discuss the bilinear model for neuronal type connectivity in the following two scenarios: the first in which gene expression and connectivity of each cell are known simultaneously and the second where connectivity and gene expressions of neuronal types are from different sources. The bilinear models for these two situations are illustrated in <xref ref-type="fig" rid="fig1">Figure 1</xref>.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Illustration of our approach.</title><p>(<bold>a</bold>) In an ideal scenario where gene expression profiles and connectivity data of individual cells are available simultaneously, we establish the relationship between connectivity and gene expression profiles via two transformation matrices <inline-formula><mml:math id="inf15"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf16"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi></mml:math></inline-formula> (<bold>b</bold>) In practical situations where the gene expression profiles are derived from distinct sources, such as single-cell transcriptomic and connectomic data, we propose that the connectivity of individual cells and their latent gene expression features can be approximated by the averages of their corresponding cell types, and establish their relationship through transformation matrices <inline-formula><mml:math id="inf17"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf18"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91532-fig1-v1.tif"/></fig><sec id="s2-1-1"><title>Gene expression and connectivity of each cell are known simultaneously</title><p>We begin with an ideal scenario where both the gene expression profiles and connectivity of individual cells are known concurrently. In this setting, we have <inline-formula><mml:math id="inf19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>a</mml:mi></mml:mstyle></mml:math></inline-formula> presynaptic neuronal types and <inline-formula><mml:math id="inf20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>b</mml:mi></mml:mstyle></mml:math></inline-formula> postsynaptic neuronal types, indexed by <inline-formula><mml:math id="inf21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>i</mml:mi></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>j</mml:mi></mml:mstyle></mml:math></inline-formula>, respectively. Each type contains a number of neurons, signified as <inline-formula><mml:math id="inf23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> for presynaptic and <inline-formula><mml:math id="inf24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> for postsynaptic types. The gene expression vector for the <inline-formula><mml:math id="inf25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>k</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> cell in the presynaptic type <inline-formula><mml:math id="inf26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>i</mml:mi></mml:mstyle></mml:math></inline-formula> is designated as <inline-formula><mml:math id="inf27"><mml:msub><mml:mi mathvariant="bold-italic">ğ’™</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>â¢</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula>, where <inline-formula><mml:math id="inf28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>k</mml:mi><mml:mo>âˆˆ</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, while for the <inline-formula><mml:math id="inf29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>l</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> cell in postsynaptic type <inline-formula><mml:math id="inf30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>j</mml:mi></mml:mstyle></mml:math></inline-formula>, it is <inline-formula><mml:math id="inf31"><mml:msub><mml:mi mathvariant="bold-italic">ğ’š</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>â¢</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> with <inline-formula><mml:math id="inf32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>l</mml:mi><mml:mo>âˆˆ</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. We depict the connectivity metric between a presynaptic neuron and a postsynaptic neuron as <inline-formula><mml:math id="inf33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>z</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>.</p><p>Drawing from the principles of collaborative filtering, we develop the following optimization objective:<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mo form="prefix">min</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:munderover><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munderover><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:munderover><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>âˆ’</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf34"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf35"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi></mml:math></inline-formula> denote the transformation matrices we aim to learn. This formula can also be expressed in its matrix form as:<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:munder><mml:mo form="prefix">min</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow><mml:mo>âŠ™</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mo>âˆ’</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></disp-formula></p><p>In this equation, <inline-formula><mml:math id="inf36"><mml:mi mathvariant="bold-italic">ğ‘¾</mml:mi></mml:math></inline-formula> symbolizes a weight matrix where each element <inline-formula><mml:math id="inf37"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>w</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:msqrt></mml:mfrac></mml:mstyle></mml:math></inline-formula>. As our study focuses on the genetic code of pre- and post-synaptic neuronal types rather than individual neurons, this weight matrix ensures that the model does not disproportionately favor neuronal types with a greater number of neurons over rarer types. Note that this formulation can be generalized to individual cell level analysis by treating each cell as a type and setting <inline-formula><mml:math id="inf38"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula>, thus allowing exploration of genetic underpinnings of connectivity at the single-cell resolution.</p><p>In the context of high dimensionality of gene expressions, the bilinear model may face a common issue in machine learning called multicollinearity, a condition where one or more predictor variables are highly correlated. To mitigate this, we can perform principal component analysis (PCA) on the gene expression vectors, transforming them into a new coordinate system and removing components with negligible eigenvalues to reduce redundant information. Alternatively, we can apply regularization techniques, such as L2 regularization (Ridge) or L1 regularization (Lasso) to effectively manage the multicollinearity. These regularization methods work by imposing a penalty on the size of the linear coefficients in the model, thereby shrinking the coefficients and stabilizing their estimates.</p><p>Incorporating L2 regularization, we minimize the following loss function with regularization hyperparameters <inline-formula><mml:math id="inf39"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>Î»</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>Î»</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>:<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow><mml:mo>âŠ™</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mo>âˆ’</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>Î»</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>Î»</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></disp-formula></p><p>To optimize this function, we propose an alternative gradient descent algorithm. This algorithm alternates between updating the transformation matrices <inline-formula><mml:math id="inf41"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf42"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi></mml:math></inline-formula>, using the gradient descent optimization method.</p><p>The algorithm begins by initializing transformation matrices <inline-formula><mml:math id="inf43"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf44"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi></mml:math></inline-formula> using random values drawn from a standard normal distribution. The central aspect of the algorithm is an iterative loop that alternates the updates of <inline-formula><mml:math id="inf45"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf46"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi></mml:math></inline-formula>. During each iteration, the algorithm first computes the predicted connectivity metric <inline-formula><mml:math id="inf47"><mml:mi mathvariant="bold-italic">ğ’</mml:mi></mml:math></inline-formula> using the current estimates of <inline-formula><mml:math id="inf48"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf49"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi></mml:math></inline-formula>. Subsequently, the gradient of the loss function with respect to the transformation matrices is calculated, and the matrices are updated by moving in the negative gradientâ€™s direction. This iterative process is repeated until the transformation matrices <inline-formula><mml:math id="inf50"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf51"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi></mml:math></inline-formula> converge to a steady solution. Upon completion, the algorithm yields the optimized transformation matrices.</p><p>This gradient descent-based algorithm provides a computationally efficient solution to the bilinear mapping problem between gene expression profiles and connectivity metrics. As a result, it produces associations between gene expression profiles of cell types and their connectivity.</p><table-wrap id="inlinetable1" position="anchor"><table frame="hsides" rules="groups" id="AL1"><thead><tr><th align="left" valign="bottom">Algorithm 1. Alternative Gradient Descent (AGD) for â€˜Gene expression and connectivity of each cell are known simultaneouslyâ€™</th></tr></thead><tbody><tr><td align="left" valign="bottom">1:â€‚<bold>Procedure</bold> AGD (<inline-formula><mml:math id="inf52"><mml:mrow><mml:mi mathvariant="bold-italic">ğ’</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">ğ‘¿</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">ğ’€</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>Î»</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Î»</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒ<inline-formula><mml:math id="inf53"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>â–¹</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>: latent space dimension; <inline-formula><mml:math id="inf54"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>r</mml:mi></mml:mstyle></mml:math></inline-formula>: learning rate<break/>2:â€ƒâ€ƒ <inline-formula><mml:math id="inf55"><mml:mrow><mml:mi>q</mml:mi><mml:mo>â†</mml:mo><mml:mrow><mml:mtext>second dimension of </mml:mtext><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold-italic">ğ‘¿</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>â€‰<break/>3:â€ƒâ€ƒ <inline-formula><mml:math id="inf56"><mml:mrow><mml:mi>p</mml:mi><mml:mo>â†</mml:mo><mml:mrow><mml:mtext>second dimension of </mml:mtext><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold-italic">ğ’€</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>â€‰<break/>4: â€ƒâ€ƒInitialize <inline-formula><mml:math id="inf57"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi></mml:math></inline-formula> with random values of size <inline-formula><mml:math id="inf58"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math></inline-formula>â€‰<break/>5: â€ƒâ€ƒInitialize <inline-formula><mml:math id="inf59"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi></mml:math></inline-formula> with random values of size <inline-formula><mml:math id="inf60"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math></inline-formula>â€‰<break/>6: â€ƒâ€ƒ<bold>while</bold> not converged do<break/>7:â€ƒâ€ƒâ€ƒâ€ƒ <inline-formula><mml:math id="inf61"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ’</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>â†</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">ğ‘¿</mml:mi><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi><mml:mo>â¢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">ğ’€</mml:mi><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>â–¹</mml:mo></mml:mstyle><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ’</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒ<inline-formula><mml:math id="inf62"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>â–¹</mml:mo><mml:mrow><mml:mover><mml:mi>Z</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>: prediction of <inline-formula><mml:math id="inf63"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ’</mml:mi><mml:mo stretchy="false">Â¯</mml:mo></mml:mover></mml:math></inline-formula>â€‰<break/>8: â€ƒâ€ƒâ€ƒâ€ƒCompute <inline-formula><mml:math id="inf64"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi><mml:mtext>grad</mml:mtext></mml:msub><mml:mo>â†</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>â¢</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">ğ‘¿</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">ğ‘¾</mml:mi><mml:mo>âŠ™</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ’</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mi mathvariant="bold-italic">ğ’</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold-italic">ğ’€</mml:mi><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>Î»</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>â€‰<break/>9: â€ƒâ€ƒâ€ƒâ€ƒUpdate <inline-formula><mml:math id="inf65"><mml:mrow><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi><mml:mo>â†</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>*</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi><mml:mtext>grad</mml:mtext></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>â€‰<break/>10: â€ƒâ€‚â€ƒâ€ƒCompute <inline-formula><mml:math id="inf66"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi><mml:mtext>grad</mml:mtext></mml:msub><mml:mo>â†</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>â¢</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">ğ’€</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>â¢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">ğ‘¾</mml:mi><mml:mo>âŠ™</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ’</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mi mathvariant="bold-italic">ğ’</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold-italic">ğ‘¿</mml:mi><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>Î»</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>â€‰<break/>11: â€ƒâ€‚â€ƒâ€ƒUpdate <inline-formula><mml:math id="inf67"><mml:mrow><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi><mml:mo>â†</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>*</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi><mml:mtext>grad</mml:mtext></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>â€‰<break/>12:â€ƒâ€‚ <bold>end while</bold><break/>13: â€ƒâ€‚<bold>return</bold> <inline-formula><mml:math id="inf68"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf69"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi></mml:math></inline-formula>â€‰<break/>14: â€‚<bold>end procedure</bold></td></tr></tbody></table></table-wrap></sec><sec id="s2-1-2"><title>Connectivity and gene expressions of neuronal types are from different sources</title><p>In real scenarios, gene expression profiles and connectivity information are often derived from separate sources, such as single-cell sequencing (<xref ref-type="bibr" rid="bib72">Shekhar et al., 2016</xref>; <xref ref-type="bibr" rid="bib84">Tran et al., 2019</xref>) and connectome data (<xref ref-type="bibr" rid="bib30">Helmstaedter et al., 2013</xref>; <xref ref-type="bibr" rid="bib3">Bae et al., 2018</xref>; <xref ref-type="bibr" rid="bib28">Greene et al., 2016</xref>). Bridging these datasets requires classifying neurons into cell types based on their gene expression profiles and morphological characteristics. These cell types from different sources are subsequently aligned according to established biological knowledge (e.g. specific gene markers are known to be expressed in certain morphologically defined cell types <xref ref-type="bibr" rid="bib25">Goetz et al., 2022</xref>).</p><p>The primary challenge in this scenario is that, while we can align cell types (denoted by indices <italic>i</italic> and <inline-formula><mml:math id="inf70"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>j</mml:mi></mml:mstyle></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ4">Equation 4</xref>), we are unable to associate individual cells (represented by indices <inline-formula><mml:math id="inf71"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>k</mml:mi></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf72"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>l</mml:mi></mml:mstyle></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ4">Equation 4</xref>). To tackle this issue, we adopt a simplifying assumption that the connectivity and latent gene expression features of individual cells can be approximated by the averages of their corresponding cell types. This premise hinges on the notion that the connectivity metrics and latent gene expression features of individual cells are close enough to the mean value of their corresponding cell types.</p><p>As a result, our optimization objective in <xref ref-type="disp-formula" rid="equ4">Equation 4</xref> becomes:<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mo form="prefix">min</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:munderover><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>.</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>.</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>âˆ’</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>.</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>.</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>In this equation, <inline-formula><mml:math id="inf73"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>z</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>.</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>.</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> denotes the mean connectivity metric between presynaptic cell type <italic>i</italic> and postsynaptic cell type <inline-formula><mml:math id="inf74"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>j</mml:mi></mml:mstyle></mml:math></inline-formula>. Meanwhile, <inline-formula><mml:math id="inf75"><mml:msub><mml:mi mathvariant="bold-italic">ğ’™</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>.</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf76"><mml:msub><mml:mi mathvariant="bold-italic">ğ’š</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>.</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> represent the average gene expressions of cell types <italic>i</italic> and <inline-formula><mml:math id="inf77"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>j</mml:mi></mml:mstyle></mml:math></inline-formula> respectively.</p><p>While optimizing the transformation matrices <inline-formula><mml:math id="inf78"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf79"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi></mml:math></inline-formula>, we impose constraints on these matrices to ensure that the variance of latent gene expression features within each neuronal type is minimized. Specifically, we define <inline-formula><mml:math id="inf80"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>Ïµ</mml:mi></mml:mstyle></mml:math></inline-formula> as a small enough value and impose the following constraints on <inline-formula><mml:math id="inf81"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi></mml:math></inline-formula>:<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="bold">Î£</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>â‰¤</mml:mo><mml:mi>Ïµ</mml:mi></mml:mrow></mml:math></disp-formula></p><p>where<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="bold">Î£</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:munderover><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>âˆ’</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>.</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>âˆ’</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>.</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>and <inline-formula><mml:math id="inf82"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi></mml:math></inline-formula>:<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="bold">Î£</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>â‰¤</mml:mo><mml:mi>Ïµ</mml:mi></mml:mrow></mml:math></disp-formula></p><p>where<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="bold">Î£</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:munderover><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>âˆ’</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>.</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>âˆ’</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>.</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>These conditions assure that the latent gene expression features of individual cells are proximate enough to the average value within their respective cell types. With these constraints in mind, we formulate the optimization problem as follows:<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mrow><mml:munder><mml:mo form="prefix">min</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mo stretchy="false">Â¯</mml:mo></mml:mover></mml:mrow><mml:mo>âˆ’</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo stretchy="false">Â¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mo stretchy="false">Â¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>s</mml:mi><mml:mo>.</mml:mo><mml:mi>t</mml:mi><mml:mo>.</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="bold">Î£</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>â‰¤</mml:mo><mml:mi>Ïµ</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="bold">Î£</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>â‰¤</mml:mo><mml:mi>Ïµ</mml:mi></mml:mrow></mml:math></disp-formula></p><p>In this equation, <inline-formula><mml:math id="inf83"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¿</mml:mi><mml:mo stretchy="false">Â¯</mml:mo></mml:mover><mml:mo>âˆˆ</mml:mo><mml:msup><mml:mi mathvariant="bold">ğ‘</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>Ã—</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> denotes the average gene expressions of the <inline-formula><mml:math id="inf84"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>a</mml:mi></mml:mstyle></mml:math></inline-formula> presynaptic cell types, wherein each element <inline-formula><mml:math id="inf85"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>x</mml:mi><mml:mo stretchy="false">Â¯</mml:mo></mml:mover></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> is indicative of the average gene expression feature <inline-formula><mml:math id="inf86"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi></mml:mstyle></mml:math></inline-formula> within cell type <italic>i</italic>. Likewise, <inline-formula><mml:math id="inf87"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ’€</mml:mi><mml:mo stretchy="false">Â¯</mml:mo></mml:mover><mml:mo>âˆˆ</mml:mo><mml:msup><mml:mi mathvariant="bold">ğ‘</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>Ã—</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> represents the average gene expressions of the <inline-formula><mml:math id="inf88"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>b</mml:mi></mml:mstyle></mml:math></inline-formula> postsynaptic cell types, with each element <inline-formula><mml:math id="inf89"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>y</mml:mi><mml:mo stretchy="false">Â¯</mml:mo></mml:mover></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>j</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> signifying the average gene expression feature <inline-formula><mml:math id="inf90"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi></mml:mstyle></mml:math></inline-formula> in cell type <inline-formula><mml:math id="inf91"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>j</mml:mi></mml:mstyle></mml:math></inline-formula>.</p><p>In practical application, we approximate <inline-formula><mml:math id="inf92"><mml:msub><mml:mi mathvariant="bold">ğšº</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf93"><mml:msub><mml:mi mathvariant="bold">ğšº</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula> with their diagonal estimates <inline-formula><mml:math id="inf94"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>Ïƒ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:msub><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>Ïƒ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:msub><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>Ïƒ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:msub><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf95"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>Ïƒ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:msub><mml:mi>y</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>Ïƒ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:msub><mml:mi>y</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>Ïƒ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:msub><mml:mi>y</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math></inline-formula>(<xref ref-type="bibr" rid="bib9">Butler et al., 2018</xref>; <xref ref-type="bibr" rid="bib74">Stuart et al., 2019</xref>). We then transform the initial optimization problem into the following:<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mrow><mml:munder><mml:mo form="prefix">min</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mo stretchy="false">Â¯</mml:mo></mml:mover></mml:mrow><mml:mo>âˆ’</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>s</mml:mi><mml:mo>.</mml:mo><mml:mi>t</mml:mi><mml:mo>.</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>â‰¤</mml:mo><mml:mi>Ïµ</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>â‰¤</mml:mo><mml:mi>Ïµ</mml:mi></mml:mrow></mml:math></disp-formula></p><p>where elements in <inline-formula><mml:math id="inf96"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¿</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>âˆˆ</mml:mo><mml:msup><mml:mi mathvariant="bold">ğ‘</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>Ã—</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> are defined as <inline-formula><mml:math id="inf97"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>x</mml:mi><mml:mo stretchy="false">Â¯</mml:mo></mml:mover></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>Ïƒ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:msub><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mfrac></mml:mstyle></mml:math></inline-formula> and elements in <inline-formula><mml:math id="inf98"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ’€</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>âˆˆ</mml:mo><mml:msup><mml:mi mathvariant="bold">ğ‘</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>Ã—</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> are given by <inline-formula><mml:math id="inf99"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>y</mml:mi><mml:mo stretchy="false">Â¯</mml:mo></mml:mover></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>Ïƒ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:msub><mml:mi>y</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mfrac></mml:mstyle></mml:math></inline-formula>. The optimization of this formulation tends to be computationally more tractable.</p><p>Here, instead of aligning at the level of individual cells, we focus on the alignment of neuronal types. We achieve this by mapping gene expressions into a latent space via transformation matrices <inline-formula><mml:math id="inf100"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf101"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>, with the optimization process aiming to minimize the discrepancies between these two sources of information while maintaining consistency of the gene expression features within individual neuronal types.</p><p>To solve the optimization problem as outlined in <xref ref-type="disp-formula" rid="equ13">Equation 13</xref>, we construct the following loss function:<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mo stretchy="false">Â¯</mml:mo></mml:mover></mml:mrow><mml:mo>âˆ’</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>Î»</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>Î»</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf102"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>Î»</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf103"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>Î»</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> are hyperparameters whose optimal values are determined through a grid search.</p><p>To optimize this loss function, we employ an alternative gradient descent algorithm analogous to that described above, by iteratively updating the transformation matrices <inline-formula><mml:math id="inf104"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf105"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>.</p><table-wrap id="inlinetable2" position="anchor"><table frame="hsides" rules="groups" id="AL2"><thead><tr><th align="left" valign="bottom">Algorithm 2. Alternative Gradient Descent (AGD) for â€˜Connectivity and gene expressions of neuronal types are from different sourcesâ€™</th></tr></thead><tbody><tr><td align="left" valign="bottom">1: â€‚<bold>Procedure</bold> AGD(<inline-formula><mml:math id="inf106"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ’</mml:mi><mml:mo stretchy="false">Â¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¿</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ’€</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>Î»</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Î»</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>)â€ƒâ€ƒâ€ƒâ€ƒâ€ƒ <inline-formula><mml:math id="inf107"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>â–¹</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>: latent space dimension; <inline-formula><mml:math id="inf108"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>r</mml:mi></mml:mstyle></mml:math></inline-formula>: learning rate<break/>2:â€ƒâ€ƒ <inline-formula><mml:math id="inf109"><mml:mrow><mml:mi>q</mml:mi><mml:mo>â†</mml:mo><mml:mrow><mml:mtext>second dimension of </mml:mtext><mml:mo>â¢</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¿</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula>â€‰<break/>3: â€ƒâ€ƒ<inline-formula><mml:math id="inf110"><mml:mrow><mml:mi>p</mml:mi><mml:mo>â†</mml:mo><mml:mrow><mml:mtext>second dimension of </mml:mtext><mml:mo>â¢</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ’€</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula>â€‰<break/>4: â€ƒâ€ƒInitialize <inline-formula><mml:math id="inf111"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> with random values of size <inline-formula><mml:math id="inf112"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math></inline-formula>â€‰<break/>5: â€ƒâ€ƒInitialize <inline-formula><mml:math id="inf113"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> with random values of size <inline-formula><mml:math id="inf114"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math></inline-formula>â€‰<break/>6: â€ƒâ€ƒ<bold>while</bold> not converge do<break/>7:â€ƒâ€ƒâ€ƒâ€ƒ <inline-formula><mml:math id="inf115"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ’</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>â†</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¿</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>â¢</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>â¢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ’€</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>â¢</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>â–¹</mml:mo></mml:mstyle><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ’</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒ <inline-formula><mml:math id="inf116"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>â–¹</mml:mo><mml:mrow><mml:mover><mml:mi>Z</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>: prediction of <inline-formula><mml:math id="inf117"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ’</mml:mi><mml:mo stretchy="false">Â¯</mml:mo></mml:mover></mml:math></inline-formula>â€‰<break/>8: â€ƒâ€ƒâ€ƒâ€ƒCompute <inline-formula><mml:math id="inf118"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mo>â¢</mml:mo><mml:mi>r</mml:mi><mml:mo>â¢</mml:mo><mml:mi>a</mml:mi><mml:mo>â¢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>â†</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¿</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msup><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ’</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ’</mml:mi><mml:mo stretchy="false">Â¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ’€</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>â¢</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>Î»</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>â¢</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msup><mml:mo>â¢</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>â€‰<break/>9:â€ƒâ€ƒâ€ƒâ€ƒ Update <inline-formula><mml:math id="inf119"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>â†</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>*</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mo>â¢</mml:mo><mml:mi>r</mml:mi><mml:mo>â¢</mml:mo><mml:mi>a</mml:mi><mml:mo>â¢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>â€‰<break/>10: â€ƒâ€‚â€ƒâ€ƒCompute <inline-formula><mml:math id="inf120"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mo>â¢</mml:mo><mml:mi>r</mml:mi><mml:mo>â¢</mml:mo><mml:mi>a</mml:mi><mml:mo>â¢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>â†</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ’€</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msup><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ’</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ’</mml:mi><mml:mo stretchy="false">Â¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¿</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>â¢</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>Î»</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>â¢</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msup><mml:mo>â¢</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>â€‰<break/>11: â€‚â€ƒâ€ƒâ€ƒUpdate <inline-formula><mml:math id="inf121"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>â†</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>*</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mo>â¢</mml:mo><mml:mi>r</mml:mi><mml:mo>â¢</mml:mo><mml:mi>a</mml:mi><mml:mo>â¢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>â€‰<break/>12: â€ƒâ€‚<bold>end while</bold><break/>13: â€‚â€ƒ<bold>return</bold> <inline-formula><mml:math id="inf122"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>, <inline-formula><mml:math id="inf123"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>â€‰<break/>14: <bold>end procedure</bold></td></tr></tbody></table></table-wrap></sec></sec><sec id="s2-2"><title>Comparative analysis of bilinear model and SCM of using <italic>C. elegans</italic> neuronal data</title><sec id="s2-2-1"><title>Reconstruction of <italic>C. elegans</italic> gap junction connectivity from innexin expressions</title><p>Utilizing the <italic>C. elegans</italic> neuronal dataset, we first tried to reconstruct the gap junction connectivity network based solely on the expression profiles of innexin genes. Using <inline-formula><mml:math id="inf124"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf125"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi></mml:math></inline-formula> generated by the bilinear model, we processed the innexin expression data to predict gap junction connectivity between neuron pairs as <inline-formula><mml:math id="inf126"><mml:mrow><mml:mi mathvariant="bold-italic">ğ‘¿</mml:mi><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi><mml:mo>â¢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">ğ’€</mml:mi><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2a</xref>). This approach was then compared to the SCM proposed by <xref ref-type="bibr" rid="bib36">KovÃ¡cs et al., 2020</xref>, which used a rule matrix <inline-formula><mml:math id="inf127"><mml:mi mathvariant="bold-italic">ğ‘¶</mml:mi></mml:math></inline-formula> to correlate gene expression with observed connectivity in the form of <inline-formula><mml:math id="inf128"><mml:mrow><mml:mi mathvariant="bold-italic">ğ‘¿</mml:mi><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold-italic">ğ‘¶</mml:mi><mml:mo>â¢</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">ğ‘¿</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2b</xref>).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Reconstructed gap junction connectivity from innexin expression data.</title><p>(<bold>a</bold>) Connectivity matrix predicted by the bilinear model. (<bold>b</bold>) Connectivity matrix modeled from KovÃ¡cs et al.â€™s SCM. (<bold>c</bold>) Observed gap junction connectivity matrix, serving as ground truth. The color spectrum from red to gray denotes the spectrum from strong connections to weak or no connections. (<bold>d</bold>) ROC curves from both the bilinear model and the SCM. Dashed line indicates the chance level.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91532-fig2-v1.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2â€”figure supplement 1.</label><caption><title>Hyperparameter selection through cross-validation for the <italic>C</italic>. <italic>elegans</italic> neuronal dataset.</title><p>(<bold>a</bold>) Heatmap plot of the logarithm (base 10) of the validation loss, showing variations with respect to <inline-formula><mml:math id="inf129"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>Î»</mml:mi></mml:mstyle></mml:math></inline-formula> across [10<sup>âˆ’8</sup>, 10<sup>âˆ’6</sup>, 0.0001, 0.01, 1] and dimensionality across [2, 4, 6, 8, 10, 12, 14, 16]. (<bold>b</bold>) Plot showing the logarithm (base 10) of the validation loss against <inline-formula><mml:math id="inf130"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>Î»</mml:mi></mml:mstyle></mml:math></inline-formula> over the range [10<sup>âˆ’8</sup>, 10<sup>âˆ’6</sup>, 0.0001, 0.01, 1]. (<bold>c</bold>) Plot displaying the logarithm (base 10) of the validation loss against dimensionality over the range [2, 4, 6, 8, 10, 12, 14, 16].</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91532-fig2-figsupp1-v1.tif"/></fig></fig-group><p>The effectiveness of both models was evaluated against the observed gap junction connectivity matrix of <italic>C. elegans</italic> neurons (<xref ref-type="fig" rid="fig2">Figure 2c</xref>). Given the binary nature of the ground truth matrix (where 1 denotes a connection and 0 indicates its absence) and the continuous nature of reconstructed connectivity matrices from both models, we conducted Receiver Operating Characteristic (ROC) analysis. This involves varying a threshold to binarize the continuous predictions, under which the true positive rate is plotted against the false positive rate for each possible cutoff. This process yields the ROC curve, which is a graphical representation of the trade-off between sensitivity and specificity at various thresholds (<xref ref-type="fig" rid="fig2">Figure 2d</xref>).</p><p>Subsequently, we calculated the Area Under the ROC Curve (AUC), providing a singular value summarizing the overall predictive performance of the model across all thresholds. The ROC-AUC metric is particularly informative as it aggregates the modelâ€™s effectiveness over all possible thresholds, with a score of 1 indicating perfect prediction and 0.5 denoting a performance no better than random chance. From the calculation, the bilinear model achieved a ROC-AUC score of 0.6435, slightly surpassing the SCMâ€™s score of 0.6428. While both scores are reasonably close, the slight edge of the bilinear model indicates its nuanced efficiency in mapping gene expressions to connectivity. However, it is noteworthy that both scores, while above 0.5, are substantially distant from the ideal score of 1. This observation suggests that relying exclusively on innexin expression data might be insufficient for fully capturing the detailed gap junction connectivity in <italic>C. elegans</italic>.</p></sec><sec id="s2-2-2"><title>Comparison of rule matrix from SCM and bilinear transformation matrices</title><p>In light of the challenge in fully capturing the <italic>C. elegans</italic> gap junction connectivity based on innexin expression data alone, instead of analyzing connectivity motifs between <italic>C. elegans</italic> neurons, our focus pivoted towards exploring and comparing the genetic rules inferred by both the bilinear model and the SCM, which was also the key discussion presented in <xref ref-type="bibr" rid="bib36">KovÃ¡cs et al., 2020</xref>. As mentioned in <italic>â€˜C. elegans</italic> neuronal datasetâ€™ and discussed in the Disscussion, the product of the bilinear transformation matrices, <inline-formula><mml:math id="inf131"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¶</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi><mml:mo>â¢</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, can be interpreted as a lower-dimensional reconstruction of the rule matrix <inline-formula><mml:math id="inf132"><mml:mi mathvariant="bold-italic">ğ‘¶</mml:mi></mml:math></inline-formula> used in the SCM. This perspective steered us to a meticulous comparative analysis between the two matrices.</p><p>The rule matrix solved from the SCM establishes a baseline for the comparison (<xref ref-type="fig" rid="fig3">Figure 3b</xref>). Against that, we compared the product of the bilinear transformation matrices (<xref ref-type="fig" rid="fig3">Figure 3a</xref>). Visualization of the two matrices suggests a high degree of similarity between them, which is quantitatively supported by a Pearson correlation coefficient of 0.90 (p &lt; 0.001), underscoring a strong alignment.</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Genetic rules from the bilinear model and the SCM.</title><p>(<bold>a</bold>) The rule matrix <inline-formula><mml:math id="inf133"><mml:mrow><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi><mml:mo>â¢</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> derived from the bilinear model. (<bold>b</bold>) The rule matrix <inline-formula><mml:math id="inf134"><mml:mi mathvariant="bold-italic">ğ‘¶</mml:mi></mml:math></inline-formula> from the SCM. Black boxes highlight entries with substantial differences.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91532-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3â€”figure supplement 1.</label><caption><title>Detailed discrepancy analysis between the bilinear model and SCM genetic rules.</title><p>(<bold>a</bold>) Discrepancy scores (DS) identifying divergences between the modelsâ€™ rule matrices. (<bold>b, c</bold>) Significant entries from the bilinear modelâ€™s rule matrix (<bold>b</bold>) and the SCMâ€™s rule matrix (<bold>c</bold>), respectively, with DS exceeding 0.5 and matrix entries no less than 0.1.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91532-fig3-figsupp1-v1.tif"/></fig></fig-group><p>To discern specific genetic interactions uniquely characterized by each model, we applied the DS metric to corresponding matrix entries (<xref ref-type="fig" rid="fig3s1">Figure 3â€”figure supplement 1a</xref>; see â€˜Methods and supplementary materialsâ€™ for details). This metric, ranging from 0 (no discrepancy) to 1 (maximum discrepancy), was thresholded at 0.5 to highlight entries with substantial differences. Further, to account for the regularization effect that pushes less important coefficients toward zero, we filtered out entry pairs where both values were less than 0.1 (<xref ref-type="fig" rid="fig3s1">Figure 3â€”figure supplement 1b and c</xref>). The remaining pairs are highlighted in black boxes in both matrices (<xref ref-type="fig" rid="fig3">Figure 3</xref>).</p><p>Comparing the values of highlighted entry pairs, we found that the bilinear model not only captured all genetic interactions identified by the SCM but also inferred additional ones: certain innexins (inx-11, inx-8, inx-5, and inx-2) were implicated in co-expression patterns within connected neurons, while another set (inx-11, inx-9, inx-3, inx-5, inx-7) was associated with an avoidance pattern, suggesting a lack of co-expression in neuron pairs forming gap junctions. These findings provide extra candidates to be tested in future experiments.</p></sec></sec><sec id="s2-3"><title>Application of bilinear model to mouse retinal neuronal data</title><sec id="s2-3-1"><title>Bilinear model reconstructs neuronal type-specific connectivity map from gene expression profiles</title><p>In our application of the bilinear model to the mouse retinal neuronal data, upon completion of the final training process, our optimized bilinear model produced transformation matrices, <inline-formula><mml:math id="inf135"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf136"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>. We used these matrices to project the normalized single-cell transcriptomic data, <inline-formula><mml:math id="inf137"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¿</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf138"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ’€</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>, into a shared latent feature space. Consequently, we obtained projected representations for BC and RGC types, <inline-formula><mml:math id="inf139"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¿</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>â¢</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf140"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ’€</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>â¢</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, respectively. With these latent representations, we were able to reconstruct the cell-type-specific connectivity matrix: <inline-formula><mml:math id="inf141"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¿</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>â¢</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>â¢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ’€</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>â¢</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4">Figure 4a</xref>).</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Reconstruction of connectivity map from gene expression profiles.</title><p>(<bold>a</bold>) The reconstructed connectivity matrix, derived from the shared latent feature space projections. (<bold>b</bold>) The connectivity matrix obtained from connectomic data. Differences in color intensity represent the strength of connections, with dark red indicating strong connections and dark blue indicating weak or no connections.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91532-fig4-v1.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4â€”figure supplement 1.</label><caption><title>Hyperparameter selection through cross-validation for the mouse retinal neuronal dataset.</title><p>(<bold>a</bold>) Heatmap plot of the logarithm (base 10) of the validation loss, showing variations with respect to <inline-formula><mml:math id="inf142"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>Î»</mml:mi></mml:mstyle></mml:math></inline-formula> across [0.1, 1, 10, 100] and dimensionality across [1, 2, 3, 4, 8]. (<bold>b</bold>) Plot showing the logarithm (base 10) of the validation loss against <inline-formula><mml:math id="inf143"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>Î»</mml:mi></mml:mstyle></mml:math></inline-formula> over the range [0.1, 1, 10, 100]. (<bold>c</bold>) Plot displaying the logarithm (base 10) of the validation loss against dimensionality over the range [1, 2, 3, 4, 8].</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91532-fig4-figsupp1-v1.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><label>Figure 4â€”figure supplement 2.</label><caption><title>Heatmaps showcasing the average absolute cosine similarities across five optimization repetitions for (<bold>a</bold>) <inline-formula><mml:math id="inf144"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> and (<bold>b</bold>) <inline-formula><mml:math id="inf145"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>.</title><p>The color scale reflects value of the metric.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91532-fig4-figsupp2-v1.tif"/></fig><fig id="fig4s3" position="float" specific-use="child-fig"><label>Figure 4â€”figure supplement 3.</label><caption><title>Detailed discrepancy analysis between the reconstructed and the target connectivity matrices.</title><p>(<bold>a</bold>) Discrepancy scores (DS) identifying divergences between the two matrices. (<bold>b, c</bold>) Specific connections present in the target matrix (<bold>c</bold>) that were not captured in the reconstructed matrix (<bold>b</bold>), with DS exceeding 0.5, indicating notable deviations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91532-fig4-figsupp3-v1.tif"/></fig></fig-group><p>To evaluate our model, we compared the reconstructed connectivity matrix with the one derived from connectomic data (<xref ref-type="fig" rid="fig4">Figure 4b</xref>). We calculated the Pearson correlation coefficient between entries of the two matrices to assess their agreement. The resulting correlation of 0.83 (p &lt; 0.001) demonstrated a robust association between the transformed gene expression features and the connectomic data. This result attests to our modelâ€™s capability in capturing the relationship between these two distinct types of biological information.</p><p>To gain insights into our modelâ€™s reconstruction accuracy, we employed the DS metric to identify entries with substantial deviations between the reconstructed and the actual connectivity matrices (<xref ref-type="fig" rid="fig4s3">Figure 4â€”figure supplement 3a</xref>; see â€˜Methods and supplementary materialsâ€™ for details). This examination specifically quantified the extent of connections in the target matrix (positive entries) that were not captured in the modelâ€™s reconstruction (negative entries; <xref ref-type="fig" rid="fig4s3">Figure 4â€”figure supplement 3b and c</xref>). Notably, the analysis revealed that only a small fraction, specifically 9 out of 115 connections, were not represented in the reconstructed matrix.</p></sec><sec id="s2-3-2"><title>Bilinear model recapitulates recognized connectivity motifs</title><p>Our cross-validation procedure indicated that the optimal number of latent dimensions was two (<xref ref-type="fig" rid="fig4s1">Figure 4â€”figure supplement 1</xref>; see â€˜Methods and supplementary materialsâ€™ for details). This finding suggested that these two dimensions capture the essential connectivity motifs between BC and RGC types. This led us to further investigate what are these motifs and how they are different from each other.</p><p>We first reconstructed connectivity using only the first latent dimension. The first dimension appeared to emphasize connectivity patterns between BCs and RGCs that laminate within the IPLâ€™s central region, as well as those that laminate within the marginal region (<xref ref-type="fig" rid="fig5">Figure 5a, d and g</xref>). We then reconstructed connectivity using only the second latent dimension. Notably, the spotlight shifted to connections between BCs and RGCs that laminate within the outer and inner regions of the IPL, respectively (<xref ref-type="fig" rid="fig5">Figure 5b, e and i</xref>).</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Distinct connectivity motifs revealed by the two latent dimensions.</title><p>(<bold>a, b</bold>) The reconstructed connectivity using only latent dimension 1 or 2, respectively. Differences in color intensity represent the strength of connections. (<bold>c</bold>) BC types plotted in the latent feature space, with each point representing a specific BC type. Dashed lines indicate zero values for latent dimensions 1 and 2. (<bold>d, e</bold>) Stratification profiles of BC types in IPL, color-coded based on their positions along the first (<bold>d</bold>) or second (<bold>e</bold>) latent dimension. Red indicates BC types on the positive half, while blue indicates BC types on the negative half. (<bold>f</bold>) RGC types plotted in the latent feature space, with each point representing a specific RGC type. (<bold>g, h</bold>) Stratification profiles of RGC types in IPL, color-coded based on their positions along the first (<bold>g</bold>) or second (<bold>h</bold>) latent dimension. Dashed lines in (<bold>d</bold>) and (<bold>g</bold>) mark the positions of ON and OFF SACs (<xref ref-type="bibr" rid="bib3">Bae et al., 2018</xref>). BCs and RGCs stratifying between them tend to exhibit more transient responses, and those stratifying outside them exhibit more sustained responses. Dashed lines in (<bold>e</bold>) and (<bold>h</bold>) denote the boundary of the outer and inner IPL (<xref ref-type="bibr" rid="bib3">Bae et al., 2018</xref>). Synapses between BCs and RGCs in the outer retina mediate OFF responses, while those in the inner retina mediate ON responses.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91532-fig5-v1.tif"/></fig><p>To confirm these observations, we further visualized BC and RGC types within the two-dimensional latent feature space (<xref ref-type="fig" rid="fig5">Figure 5c and f</xref>). Grouping BC and RGC types based on whether they fell within the positive or negative halves of the latent dimensions, we color-coded their stratification profiles within the IPL by group. BCs and RGCs that fell within the positive half of latent dimension 1 tend to stratify within the IPLâ€™s central region, delineated by the boundaries formed by the ON and OFF starburst amacrine cells (SACs; <xref ref-type="fig" rid="fig5">Figure 5d and g</xref>). Conversely, those falling within the negative half of this dimension tend to stratify in the marginal region of the IPL. As for the second latent dimension, BCs and RGCs that fell within the positive half predominantly stratify in the inner region of the IPL (<xref ref-type="fig" rid="fig5">Figure 5e and i</xref>), while those within the negative half primarily stratify in the IPLâ€™s outer region.</p><p>Interestingly, these distinct connectivity motifs align with two widely recognized properties of retinal neurons: kinetic attributes that reflect the temporal dynamics (transient versus sustained responses) of a neuron responding to visual stimuli, and polarity (ON versus OFF responses) reflecting whether a neuron responds to the initiation or cessation of a stimulus (<xref ref-type="bibr" rid="bib23">Euler et al., 2014</xref>; <xref ref-type="bibr" rid="bib68">Sanes and Masland, 2015</xref>; <xref ref-type="bibr" rid="bib50">Masland, 2012</xref>; <xref ref-type="bibr" rid="bib2">Baden et al., 2016</xref>). This correlation implies that our bilinear model has successfully captured key aspects of retinal circuitry from gene expression data.</p></sec><sec id="s2-3-3"><title>Bilinear model reveals interpretable insights into gene signatures associated with different connectivity motifs</title><p>The inherent linearity of our bilinear model affords a significant advantage: it enables the direct interpretation of gene expressions by examining their associated weights in the model. These weights signify the importance of each gene in determining the connectivity motifs between the BC and RGC types. We identified the top 50 genes with the largest positive or negative weights for BCs and RGCs across both latent dimensions. We plotted their weights alongside their expression profiles in the respective cell types (<xref ref-type="fig" rid="fig6">Figure 6</xref>).</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Gene signatures associated with the two latent dimensions.</title><p>(<bold>a, b</bold>) Weight vectors of the top 50 genes for latent dimension 1, along with their expression patterns in BC types (<bold>a</bold>) and RGC types (<bold>b</bold>). The weight value is indicated in the color bar, with the sign represented by color (red: positive and blue: negative), and the magnitude by saturation. The expression pattern is represented by the size of each dot (indicating the percentage of cells expressing the gene) and the color saturation (representing the gene expression level). BC and RGC types are sorted by their positions along latent dimension 1, as shown in <xref ref-type="fig" rid="fig5">Figure 5c and f</xref>, with the dashed line separating the positive category from the negative category. (<bold>c, d</bold>) Weight vectors of the top 50 genes for latent dimension 2, and their expression patterns in BC types (<bold>c</bold>) and RGC types (<bold>d</bold>), depicted in the same manner as in (<bold>a</bold>) and (<bold>b</bold>). BC and RGC types are sorted by their positions along latent dimension 2.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91532-fig6-v1.tif"/></fig><p>Our analysis unveiled distinct gene signatures associated with the connectivity motifs revealed by the two latent dimensions. In the first latent dimension, genes like CDH11 and EPHA3, involved in cell adhesion and axon guidance, carried high weights for BCs forming synapses in the IPLâ€™s central region. In contrast, for BCs synapsing in the marginal region, we observed high weights in the cell adhesion molecule PCDH9 and the axon guidance cue UNC5D (<xref ref-type="fig" rid="fig6">Figure 6a</xref>). This pattern was echoed in RGCs but involved a slightly different set of molecules. For example, in RGCs forming synapses in the IPLâ€™s central region, the cell adhesion molecule PCDH7 carried high weights, whereas for RGCs synapsing in the marginal region, cell adhesion molecules PCDH11X and CDH12 were associated with high weights (<xref ref-type="fig" rid="fig6">Figure 6b</xref>).</p><p>The second latent dimension revealed a comparable pattern, albeit with different gene signatures. For BCs laminating in the IPLâ€™s outer region, high weights were assigned with guidance cues such as SLIT2, NLGN1, EPHA3, and PLXNA4, as well as the adhesion molecule DSCAM. For BCs in the inner region, the adhesion molecule CNTN5 was associated with a high weight (<xref ref-type="fig" rid="fig6">Figure 6c</xref>). In RGCs, we noticed that guidance molecules such as PLXNA2, SLITRK6, and PLXNA4 along with adhesion modules CDH8 and LRRC4C were associated with high weights for cells forming synapses in the IPLâ€™s outer region. In contrast, the adhesion molecule SDK2 was among the top genes for RGCs laminating and forming synapses in the IPLâ€™s inner region (<xref ref-type="fig" rid="fig6">Figure 6d</xref>). Some of these genes or gene families, such as Plexins (PLXNA2, PLXNA4), Contactin5 (CNTN5), Sidekick2 (SDK2), and Cadherins (CDH8,11,12), are known to play crucial roles in establishing specific synaptic connections (<xref ref-type="bibr" rid="bib51">Matsuoka et al., 2011</xref>; <xref ref-type="bibr" rid="bib77">Sun et al., 2013</xref>; <xref ref-type="bibr" rid="bib57">Peng et al., 2017</xref>; <xref ref-type="bibr" rid="bib38">Krishnaswamy et al., 2015</xref>; <xref ref-type="bibr" rid="bib20">Duan et al., 2014</xref>; <xref ref-type="bibr" rid="bib21">Duan et al., 2018</xref>; <xref ref-type="bibr" rid="bib46">Liu et al., 2018</xref>). Others, particularly delta-protocadherins (PCDH7,9,11x), emerged as new candidates potentially mediating specific synaptic connections (<xref ref-type="bibr" rid="bib69">Sanes and Zipursky, 2020</xref>).</p><p>To elucidate the biological implications of these identified gene sets, we further conducted Gene Ontology (GO) enrichment analysis on the top genes through g:Profiler, a public web server for GO enrichment analysis (<xref ref-type="bibr" rid="bib64">Reimand et al., 2007</xref>; <xref ref-type="bibr" rid="bib63">Raudvere et al., 2019</xref>). This tool allowed us to delve into the molecular functions, cellular pathways, and biological processes associated with these genes. Intriguingly, when we listed the top 10 significant GO terms for each latent dimension based on their adjusted p-values, we found two common themes: neuronal development and synaptic organization (<xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref>). <xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref> also highlights the number of the top genes associated with each GO term, revealing that overall about 47% of these genes are involved in neural development and synaptic organization. Such findings underscore the potential roles of these genes in forming and shaping the specific connections between BC and RGC types.</p></sec><sec id="s2-3-4"><title>Bilinear model predicts connectivity partners of transcriptionally defined RGC types</title><p>The success of recommendation systems in accurately predicting the preferences of new users inspired us to leverage the bilinear model for predicting the connectivity partners of RGC types whose interconnections with BC types remain uncharted. There are some RGC types defined from single-cell transcriptomic data (<xref ref-type="bibr" rid="bib84">Tran et al., 2019</xref>), which lack clear correspondence with those identified through connectomics studies (<xref ref-type="bibr" rid="bib3">Bae et al., 2018</xref>). This discrepancy leaves the connectivity patterns of these transcriptionally defined RGC types unknown, providing an opportunity for our model to predict their BC partners.</p><p>To accomplish this, we first projected these RGC types into the same latent space as those used to train the model (<xref ref-type="fig" rid="fig7">Figure 7a</xref>). We then employed this projection to construct a connectivity matrix between these RGC types and BC types (<xref ref-type="fig" rid="fig7">Figure 7b</xref>), facilitating educated estimates about their connectivity partners. For each transcriptionally defined RGC type, we identified the top three BC types as potential partners, determined by the highest values present in the connectivity matrix. These three BC types could provide insight into the potential synaptic input to each RGC type. Detailed predictions are presented in <xref ref-type="supplementary-material" rid="supp5">Supplementary file 5</xref>.</p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>BC partner prediction of transcriptionally-defined RGC types.</title><p>(<bold>a</bold>) Projection of transcriptionally-defined RGC types with unknown connectivity into the same latent space as those with known connectivity. (<bold>b</bold>) The resulting predicted connectivity matrix between these RGC types and BC types. Transcriptionally-defined RGC types are named according to <xref ref-type="bibr" rid="bib84">Tran et al., 2019</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91532-fig7-v1.tif"/></fig><p>Although the ground truth connectivity of these RGC types remains unknown due to the absence of matching types in connectomic data, <xref ref-type="bibr" rid="bib25">Goetz et al., 2022</xref>, via Patch-seq, attempted to match some transcriptomic types with functionally defined RGC types. These functional descriptions may hint at the BC partners of these RGC types. For instance, an RGC exhibiting OFF sustained responses is likely to be synaptically linked with BC types bc1-2, known to mediate OFF sustained pathways. Conversely, an RGC that displays ON sustained responses likely receives synaptic inputs from BC types bc6-9, which oversee ON sustained pathways. We summarized these functional descriptions in <xref ref-type="supplementary-material" rid="supp5">Supplementary file 5</xref>, referencing Figure 5A from <xref ref-type="bibr" rid="bib25">Goetz et al., 2022</xref>, and highlighted whether our predictions were consistent with these functional annotations. Among the ten predictions made, eight aligned with these functional descriptions, lending support to the predictive power of our model.</p></sec></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><sec id="s3-1"><title>Summary of study</title><p>This study showcased a novel application of the bilinear modeling approach within the realm of gene expression analysis of neuronal type connectivity, drawing inspiration from recommendation systems - a machine learning domain focused on capturing intricate interactions between users and items and predicting user preferences. This analogy served as a useful framework in our study, where the roles of users and items in the recommendation systems are mirrored by presynaptic and postsynaptic neurons, respectively. Likewise, the user-item preference matrix corresponds to the synaptic connection matrix in neural circuits. The recommendation systems are based on the assumption that user preferences and item attributes can be represented by latent factors; similarly, our model assumes that synaptic connectivity between various neuron types is determined by a shared latent feature space derived from gene expression profiles.</p><p>The applicability and effectiveness of our bilinear model were validated using two different datasets. Applying it to the <italic>C. elegans</italic> neuronal dataset, which include data of gap junction connectivity and innexin expression at the individual neuron level, we showed that the model could be generalized to single-cell level connectivity by treating each neuronal type as an individual cell (â€˜Gene expression and connectivity of each cell are known simultaneouslyâ€™), and incorporate spatial constraints such as physical contact between neurons into the weight matrix (â€˜Gap junction connectivity and innexin expression data of <italic>C. elegans</italic> neuronsâ€™). In a more complex scenario where the transcriptomic and connectomic data are from different sources and aligned at the neuronal-type level, we demonstrated the modelâ€™s capability in decoding the genetic underlying of the connectivity between neuronal types (â€˜Connectivity and gene expressions of neuronal types are from different sourcesâ€™), using the mouse retinal neuronal dataset (â€˜Single-cell transcriptomic and connectomic data of mouse retinal neuronsâ€™). This emphasizes the modelâ€™s potential in offering insights into the genetic mechanisms that orchestrate synaptic connections across various nervous systems.</p></sec><sec id="s3-2"><title>Insights from analysis of <italic>C. elegans</italic> dataset and comparison with SCM</title><p>Using the <italic>C. elegans</italic> neuronal dataset, we conducted a comparative analysis between our bilinear model and the SCM, which correlates neuronal innexin expression with gap junction connectivity via a rule matrix (<xref ref-type="bibr" rid="bib36">KovÃ¡cs et al., 2020</xref>; <xref ref-type="bibr" rid="bib4">BarabÃ¡si and BarabÃ¡si, 2020</xref>). The SCM incorporates spatial constraints, such as physical contact between neurons, and represents the connectome as an edge list for regression against the Kronecker product of the gene expression matrix. Our model is closely related to the SCM, as it can be seen as factorization of the rule matrix into the product of two lower-dimensional transformation matrices. This factorization not only yielded a performance comparable to, if slightly better than, the SCM in reconstructing the gap junction connectivity matrix, but also revealing potential new innexin interactions for experimental exploration (<xref ref-type="fig" rid="fig2">Figure 2</xref>; <xref ref-type="fig" rid="fig3">Figure 3</xref>).</p><p>Beyond these, a crucial advantage of our bilinear model lies in in its computational efficiency, an attribute of significance when scaling to larger datasets, where the number of genes and the number of neurons or neuronal types escalates to the order of thousands, such as those of the mouse or macaque cortex (<xref ref-type="bibr" rid="bib91">Yao et al., 2023a</xref>; <xref ref-type="bibr" rid="bib12">Chen et al., 2023</xref>). In such situation, the computational complexity of the SCM is substantial, given its reliance on the Kronecker productâ€™s dimensions and subsequent matrix inversion. In contrast, the computational demands of our bilinear model, driven primarily by matrix multiplication in gradient descent, are considerably more manageable, offering scalability and feasibility even as dataset sizes increase. Furthermore, the requirement to calculate the Kronecker product in SCM significantly heightens memory usage, critical when the data scale is large but memory resources are constrained. These advantages ensure our bilinear model a scalable solution when applied to other organisms and brain regions.</p><p>In assessing the bilinear modelâ€™s and the SCMâ€™s performance to reconstruct <italic>C. elegans</italic> gap junction connectivity, the resulting modest ROC-AUC scores (approximately 0.64, much lower than the ideal 1.0) underscore the challenges in predicting electrical synapse specificity using innexin expressions alone. This suggests that additional molecular mechanisms, beyond innexin interactions, play crucial roles in forming specific electrical synaptic connections. Indeed, in the realm of chemical synapses, itâ€™s increasingly recognized that synaptic specificity is significantly influenced by factors such as cell-cell adhesion and recognition molecules, rather than just the pre- or post-synaptic machinery (<xref ref-type="bibr" rid="bib69">Sanes and Zipursky, 2020</xref>). Recent studies support this viewpoint. For instance, research on the <italic>C. elegans</italic> motor circuit has revealed how a developmental program fine-tunes cAMP signaling to guide neuron-specific assembly of electrical synapses (<xref ref-type="bibr" rid="bib54">Palumbos, 2021</xref>). Furthermore, the observed coexistence of electrical and chemical synapses in close proximity intimates potential shared mechanisms underlying their specificity (<xref ref-type="bibr" rid="bib41">Lasseigne et al., 2021</xref>).</p></sec><sec id="s3-3"><title>Insights from application to mouse retinal neuronal dataset</title><p>Applying to the mouse retinal neuronal dataset, our bilinear model successfully reconstructed a neuronal type-specific connectivity map from gene expression profiles and recapitulated two core connectivity motifs of the retinal circuit, representing synapses formed in central or marginal parts of the IPL, and synapses formed in outer or inner regions (<xref ref-type="fig" rid="fig4">Figure 4</xref>; <xref ref-type="fig" rid="fig5">Figure 5</xref>). These motifs align well with recognized properties of retinal neurons: kinetic attributes (transient versus sustained responses) and polarity (ON versus OFF responses; <xref ref-type="bibr" rid="bib23">Euler et al., 2014</xref>; <xref ref-type="bibr" rid="bib68">Sanes and Masland, 2015</xref>; <xref ref-type="bibr" rid="bib50">Masland, 2012</xref>; <xref ref-type="bibr" rid="bib2">Baden et al., 2016</xref>). Significantly, these motifs arenâ€™t predefined or explicitly encoded into the model; instead, they emerge naturally from the model, further attesting to the modelâ€™s power to capture key aspects of retinal circuitry.</p><p>The bilinear model also revealed unique insights into the gene signatures associated with the connectivity motifs. The weight vectors in the transformation matrices provide a means to assess the relative importance of individual genes. This direct interpretability is a significant advantage of the linear model, allowing for a more intuitive understanding of the gene-to-connectivity transformation process. Our analysis discovered distinct gene signatures associated with different connectivity motifs (<xref ref-type="fig" rid="fig6">Figure 6</xref>). Among these genes, some have been previously implicated in mediating specific synaptic connections, thererby validating our approach. For instance, Plexins A4 and A2 (PLXNA4, PLXNA2), predicted to be crucial for RGCsâ€™ synapsing in the outer IPL, have been shown to be necessary for forming specific lamina of the IPL in the mouse retina, interacting with the guidance molecule Semaphorin 6 A (SEM6A) (<xref ref-type="bibr" rid="bib51">Matsuoka et al., 2011</xref>; <xref ref-type="bibr" rid="bib77">Sun et al., 2013</xref>). Contactin5 (CNTN5), which our model predicted as vital for BCs forming synapses in the inner IPL, has been shown to be essential for synapses between ON BCs and the ON lamina of ON-OFF direction-selective ganglion cells (ooDSGCs; <xref ref-type="bibr" rid="bib57">Peng et al., 2017</xref>). Sidekick2 (SDK2), predicted to be critical for RGCsâ€™ synapses in the inner IPL, has been shown to guide the formation of a retinal circuit that detects differential motion (<xref ref-type="bibr" rid="bib38">Krishnaswamy et al., 2015</xref>). Similarly, Cadherins (CDH8,11,12), whose combinations have been implicated in synaptic specificity within retinal circuits (<xref ref-type="bibr" rid="bib20">Duan et al., 2014</xref>; <xref ref-type="bibr" rid="bib21">Duan et al., 2018</xref>), were highlighted for multiple connectivity motifs. In particular, Cadherin8 (CDH8), which our model predicted to be crucial for RGCâ€™s synaptic connections in the outer IPL, has been shown to be guided by the transciptional factor Tbr1 for laminar patterning of J-RGCs, a type of OFF direction-selective RGCs (<xref ref-type="bibr" rid="bib46">Liu et al., 2018</xref>). In addition to these validated gene signatures, our analysis identified promising candidate genes that may mediate specific synaptic connections. Particularly, delta-protocadherins (PCDH7,9,11x) appeared as potential new candidates. While their roles in synaptic connectivity arenâ€™t fully understood (<xref ref-type="bibr" rid="bib69">Sanes and Zipursky, 2020</xref>), mutations in delta-protocadherins in mice and humans have been linked with various neurological phenotypes, including axon growth and guidance impairments and changes in synaptic plasticity and stability (<xref ref-type="bibr" rid="bib32">Kahr et al., 2013</xref>; <xref ref-type="bibr" rid="bib45">Light and Jontes, 2017</xref>; <xref ref-type="bibr" rid="bib56">Peek et al., 2017</xref>; <xref ref-type="bibr" rid="bib6">Bisogni et al., 2018</xref>). Future experimental studies are needed to validate these findings and further unravel the roles of these genes in neural circuit formation and function in the mouse retina.</p><p>The bilinear modelâ€™s utility extends beyond the identification of gene signatures, emerging as a potent tool for hypothesis generation, particularly in predicting connectivity for transcriptionally defined neuronal types whose synaptic partners remain uncharted (<xref ref-type="fig" rid="fig7">Figure 7</xref>). Trained on data from a specific neural region, the bilinear model can facilitate the anticipation of synaptic partners for newly characterized transcriptional types within that region, thereby generating hypotheses on their functional roles within neural circuits. Furthermore, this model opens avenues for inferring neural wiring alterations resulting from genetic manipulations. For instance, by altering the genetic profile of certain neuronal types to create new transcriptionally defined types, we can use the model to predict changes in their synaptic partners, offering insights into the consequent reconfiguration of neural networks. This could be further extended to hypothesize the rewiring of the brain under psychological disorders, such as autism, where significant connectome changes suggest shifts in synaptic partner choices (<xref ref-type="bibr" rid="bib67">Roine et al., 2015</xref>; <xref ref-type="bibr" rid="bib31">Hong et al., 2019</xref>). With recent availability of neuronal gene expression data of autism (<xref ref-type="bibr" rid="bib88">Velmeshev et al., 2019</xref>; <xref ref-type="bibr" rid="bib53">Nassir et al., 2021</xref>; <xref ref-type="bibr" rid="bib44">Li et al., 2023</xref>), our model stands poised to predict the implications of such genetic profiles on neural circuitry, guiding the research of understanding and treating this psychological disorder.</p><p>While our bilinear model offers valuable insights into the connectivity motifs of retinal circuits and the associated gene signatures, with many findings aligning with existing literature, it is important to acknowledge certain limitations of this study. Firstly, the modelâ€™s connectivity matrix was deduced from stratification profiles derived from EM reconstruction. Although prior research has indicated stratification as a meaningful indicator of connectivity within the mouse retina, as certain BC types preferentially connect with specific RGC types stratified in the same lamina (<xref ref-type="bibr" rid="bib20">Duan et al., 2014</xref>; <xref ref-type="bibr" rid="bib38">Krishnaswamy et al., 2015</xref>; <xref ref-type="bibr" rid="bib21">Duan et al., 2018</xref>), this metric may not capture the entire complexity of synaptic connections (<xref ref-type="bibr" rid="bib22">Dunn and Wong, 2014</xref>). The incorporation of additional experimental data, such as electrophysiological measurements, could enhance both the accuracy and the reliability of the connectivity metrics. Secondly, the model, despite its overall success in reconstructing the connectivity matrix, missed several connections, notably among specific BC-RGC pairs such as those between RGC types 51, 5ti and BC types 3a, 3b, and 4 (<xref ref-type="fig" rid="fig4s3">Figure 4â€”figure supplement 3</xref>). This highlights the potential for a more complex approach, such as deep learning models, to capture the subtleties of synaptic connections. Finally, the list of top genes identified by our model is enriched with genes directly mediating synapse formation and maintenance, such as adhesion molecules (<xref ref-type="fig" rid="fig6">Figure 6</xref>; <xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref>), yet overlooks transcription factors like Tbr1 known to affect synaptic specificity (<xref ref-type="bibr" rid="bib46">Liu et al., 2018</xref>). These factors, impacting various neuronal functionalities, might not be captured by a linear model that inherently favors predictor variables that strongly correlate with the target variable.</p></sec><sec id="s3-4"><title>Future directions</title><sec id="s3-4-1"><title>Experiment validation of candidate genes</title><p>The bilinear model enables the predictions of possible changes in synaptic connections resulting from changes in expressions of the candidate genes. Emerging genome editing technologies, particularly CRISPR/Cas9 (<xref ref-type="bibr" rid="bib13">Cong et al., 2013</xref>; <xref ref-type="bibr" rid="bib47">Mali et al., 2013</xref>), offers a precise and efficient way to validate these predictions through experiments. By leveraging CRISPR/Cas9, targeted genetic manipulations, such as gene silencing or modification, can be conducted to assess their impact on synaptic connectivity. In the context of the mouse retina, the delivery of CRISPR/Cas9 components into BCs or RGCs can be achieved through electroporation or adeno-associated virus (AAV) vectors, respectively, allowing for targeted gene intervention (<xref ref-type="bibr" rid="bib70">Sarin et al., 2018</xref>; <xref ref-type="bibr" rid="bib83">Tian et al., 2022</xref>).</p><p>The finding of delta-protocadherins (PCDH7,9,11x) as potential mediators of synaptic specificity in the mouse retina presents an exciting opportunity for experimental exploration. We propose to design CRISPR/Cas9 systems targeting these delta-protocadherins (PCDH7,9,11x), similar to those detailed in a recent study (<xref ref-type="bibr" rid="bib7">Biswas et al., 2021</xref>). Delivered to the mouse retina using AAV vectors, we expect to knockdown delta-protocadherin expressions in RGCs (<xref ref-type="bibr" rid="bib83">Tian et al., 2022</xref>). With PCDH7 identified as a key factor in synapse formation within the central regions of the IPL, a focal point of our investigation will be RGC types like W3B RGCs, which are known to stratify in these central layers (<xref ref-type="bibr" rid="bib96">Zhang et al., 2012</xref>). The consequences of PCDH7 downregulation on the connectivity of W3B RGCs can be examined through multiple approaches (<xref ref-type="bibr" rid="bib38">Krishnaswamy et al., 2015</xref>): immunohistochemical techniques or the use of transgenic markers can reveal morphological changes indicative of altered connectivity; electrophysiological assessments, such as targeted recordings from postsynaptic neurons while optogenetically stimulating presynaptic partners, offer a functional probe into the synaptic alterations. Similarly, as PCDH9 and PCDH11x are implicated in synaptic connections within the marginal regions of the IPL, candidate RGCs for examination could include ON and OFF sustained alpha RGCs, known for their peripheral stratifications (<xref ref-type="bibr" rid="bib37">Krieger et al., 2017</xref>).</p><p>This experimental paradigm is not confined to the mouse retina but extends to a broad range of neuronal circuits, thanks to the flexibility and wide applicability of genome editing tools like CRISPR/Cas9 (<xref ref-type="bibr" rid="bib18">Dickinson and Goldstein, 2016</xref>; <xref ref-type="bibr" rid="bib27">Gratz et al., 2015</xref>; <xref ref-type="bibr" rid="bib43">Li et al., 2016</xref>). The capacity to induce targeted gene knockouts or modifications will empower researchers to validate our bilinear modelâ€™s predictions and explore the underlying genetic mechanisms for synaptic formation and maintenance. This endeavor opens new avenues for deciphering the complex interplay between genetics and neural circuit wiring, furthering our comprehension of the molecular mechanisms driving synaptic specificity.</p></sec><sec id="s3-4-2"><title>Application to other neural systems</title><p>Our bilinear model, while illustrated using the <italic>C. elegans</italic> and mouse retina datasets, holds significant potential for elucidating the genetic underpinnings of neuronal connectivity across various species and brain regions, contingent upon the availability of comprehensive gene expression profiles and synaptic connection data. For instance, the advent of a comprehensive single-cell transcriptome atlas for the adult fruit fly brain, alongside the recent establishment of its complete connectome, offers a fertile ground for extending our model to decipher the complex neural circuits of <italic>Drosophila</italic> (<xref ref-type="bibr" rid="bib15">Davie et al., 2018</xref>; <xref ref-type="bibr" rid="bib19">Ding et al., 2023</xref>).</p><p>In the context of the mouse brain, the depth and breadth of single-cell sequencing efforts have unveiled a rich tapestry of transcriptomic cell types across cortex regions and the hippocampus (<xref ref-type="bibr" rid="bib80">Tasic et al., 2016</xref>; <xref ref-type="bibr" rid="bib81">Tasic et al., 2018</xref>; <xref ref-type="bibr" rid="bib90">Yao et al., 2021</xref>; <xref ref-type="bibr" rid="bib91">Yao et al., 2023a</xref>). These efforts, in tandem with connectomic studies that meticulously map neuronal connections, lay a foundation for integrating transcriptomic and connectomic data (<xref ref-type="bibr" rid="bib8">Bock et al., 2011</xref>; <xref ref-type="bibr" rid="bib42">Lee et al., 2016</xref>; <xref ref-type="bibr" rid="bib86">Turner et al., 2022</xref>; <xref ref-type="bibr" rid="bib92">Yao et al., 2023b</xref>). Such integration, especially across diverse brain regions, presents an exciting avenue to uncover both neuronal connection mechanisms that are shared by neuronal types across different regions and those unique to specific regions. The scalability of our bilinear model, akin to collaborative filteringâ€™s effectiveness in e-commerce domains, supports the prospect of its cross-regional application. This approach positions our model at the forefront of efforts to explore how gene expression patterns contribute to the diversity of neuronal circuits across brain areas, moving us closer to a holistic understanding of the genetic blueprint of neuronal connectivity throughout the entire brain.</p><p>Nevertheless, we recognize the challenge that such well-aligned connectomic and transcriptomic data may not always be readily available. To address this, future research endeavors will also explore adaptations of our model to other available datasets, such as those that combine single-cell transcriptomic profiling with long-range neuronal projection mapping (<xref ref-type="bibr" rid="bib11">Chen et al., 2019</xref>; <xref ref-type="bibr" rid="bib78">Sun et al., 2021</xref>). Furthermore, our model is amenable to integration with trans-synaptic tracer-based sequencing methods (<xref ref-type="bibr" rid="bib85">Tsai et al., 2022</xref>; <xref ref-type="bibr" rid="bib97">Zhang et al., 2023</xref>), expanding its utility in studies where detailed connectomic information is limited. Pursuing these avenues is pivotal in broadening the modelâ€™s utility and ensuring its relevance across a wider spectrum of brain connectivity research, making it an invaluable tool in the quest to unravel the complexities of neural circuitry.</p></sec><sec id="s3-4-3"><title>Model advancements</title><p>To enhance the modelâ€™s fidelity and applicability, we propose several advancements. First, we recommend the integration of auxiliary data types, including electrophysiological data, neuron tracing data, and an array of omics data such as proteomics and epigenetics data, to augment and enrich the modelâ€™s training base (<xref ref-type="bibr" rid="bib2">Baden et al., 2016</xref>; <xref ref-type="bibr" rid="bib85">Tsai et al., 2022</xref>; <xref ref-type="bibr" rid="bib97">Zhang et al., 2023</xref>; <xref ref-type="bibr" rid="bib52">Mazan-Mamczarz et al., 2022</xref>; <xref ref-type="bibr" rid="bib5">Bennett et al., 2023</xref>). These data modalities offer complementary insights into neuronal function and connectivity, providing valuable context that can inform and refine the modelâ€™s predictions.</p><p>Second, we envision extending the bilinear model to incorporate non-linear interactions, capturing the intricate dynamics between gene expressions and synaptic connections. A potential pathway for this is through kernel methods or the integration of neural networks, specifically adopting the â€˜two-tower modelâ€™ framework renowned in modern recommendation systems (<xref ref-type="fig" rid="fig8">Figure 8</xref>). In this model, each â€˜towerâ€™ is a deep neural network that undertakes the non-linear transformation of input features (<xref ref-type="bibr" rid="bib89">Wang et al., 2021</xref>; <xref ref-type="bibr" rid="bib93">Yu et al., 2021</xref>). This architecture has proven effective in capturing complex user-item interactions and could significantly enhance our modelâ€™s ability to decipher the nuanced relationships between genetics and neural connectivity.</p><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Future direction: A two-tower deep learning model.</title><p>(<bold>a</bold>) Gene expression profiles of pre- and post-synaptic neurons are transformed into latent embedding representations via deep neural networks. The connectivity metric between the pre- and post-synaptic neurons is predicted by taking the inner product of their respective latent embeddings.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91532-fig8-v1.tif"/></fig></sec></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Datasets and pre-processing</title><p>To validate and assess the efficacy of our bilinear model, we utilized two distinct datasets available from previous studies:</p><sec id="s4-1-1"><title>Gap junction connectivity and innexin expression data of <italic>C. elegans</italic> neurons</title><p>We first used a dataset of gap junction connectivity and innexin expressions of individual <italic>C. elegans</italic> neurons. Derived from the work of <xref ref-type="bibr" rid="bib14">Cook et al., 2019</xref> and subsequently analyzed by <xref ref-type="bibr" rid="bib36">KovÃ¡cs et al., 2020</xref>, this dataset included expression profiles of 18 innexin genes across 184 neurons, alongside detailed gap junction connectivity between these neurons. We followed the same procedure outlined by KovÃ¡cs et al. to obtain the innexin expression matrix <inline-formula><mml:math id="inf146"><mml:mi mathvariant="bold-italic">ğ‘¿</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf147"><mml:mi mathvariant="bold-italic">ğ’€</mml:mi></mml:math></inline-formula> (in this case <inline-formula><mml:math id="inf148"><mml:mrow><mml:mi mathvariant="bold-italic">ğ‘¿</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">ğ’€</mml:mi></mml:mrow></mml:math></inline-formula> with the dimensions of 184 Ã— 18), and the connectivity matrix between individual <italic>C. elegans</italic> neurons <inline-formula><mml:math id="inf149"><mml:mi mathvariant="bold-italic">ğ’</mml:mi></mml:math></inline-formula>.</p><p>To incorporate spatial constraints by considering only neuron pairs in physical contact, we extracted a contact matrix from the dataset. This was transcribed into the weight matrix <inline-formula><mml:math id="inf150"><mml:mi mathvariant="bold-italic">ğ‘¾</mml:mi></mml:math></inline-formula> in our model, with values set to 0 for neuron pairs without physical contact and 1 for those with contact. This enabled our bilinear model to focus on the 5,592 neuron pairs that exhibit physical contacts, restricting the analysis to biologically plausible connections.</p><p>The utilization of this dataset serves a dual purpose. It not only provides a validation for our bilinear model but also enables a direct comparison with the model employed by KovÃ¡cs et al., offering a comprehensive evaluation of the bilinear model in the context of established connectomic research.</p></sec><sec id="s4-1-2"><title>Single-cell transcriptomic and connectomic data of mouse retinal neurons</title><p>The second dataset encompassed data of mouse retinal neurons, integrating single-cell transcriptomic data from various studies with connectomic data obtained from the EyeWire project. The data provide us with connectivity information and gene expression profiles of mouse BCs and RGCs, and are important for applying our proposed bilinear model and testing its effectiveness in a more complex neuronal environment compared to the <italic>C. elegans</italic> dataset.</p><p>The single-cell transcriptomic data include the gene expression profiles for two classes of mouse retinal neurons â€“ presynaptic BCs as reported by <xref ref-type="bibr" rid="bib72">Shekhar et al., 2016</xref>, and postsynaptic RGCs as reported by <xref ref-type="bibr" rid="bib84">Tran et al., 2019</xref>.</p><p>Preprocessing of this data adhered to previously documented procedures (<xref ref-type="bibr" rid="bib72">Shekhar et al., 2016</xref>; <xref ref-type="bibr" rid="bib84">Tran et al., 2019</xref>; <xref ref-type="bibr" rid="bib60">Qiao, 2023</xref>). The transcript counts within each cell were first normalized to align with the median number of the transcripts per cell, followed by a log-transformation of the normalized counts. High variable genes (HVGs) were then selected using an approach based on establishing a relationship between mean expression level and the coefficient of variance (<xref ref-type="bibr" rid="bib10">Chen et al., 2016</xref>; <xref ref-type="bibr" rid="bib55">Pandey et al., 2018</xref>; <xref ref-type="bibr" rid="bib40">Kurmangaliyev et al., 2019</xref>). We focused on those cells whose types correspond with the neuronal types outlined in the connectomic data, as delineated later in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>, <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>, and <xref ref-type="supplementary-material" rid="supp3">Supplementary file 3</xref>. This yielded two matrices, <inline-formula><mml:math id="inf151"><mml:mi mathvariant="bold-italic">ğ‘¿</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf152"><mml:mi mathvariant="bold-italic">ğ’€</mml:mi></mml:math></inline-formula>, representing presynaptic BCs and postsynaptic RGCs, where each row pertains to a cell and each column represents an HVG. The dimensions of <inline-formula><mml:math id="inf153"><mml:mi mathvariant="bold-italic">ğ‘¿</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf154"><mml:mi mathvariant="bold-italic">ğ’€</mml:mi></mml:math></inline-formula> are 22453 Ã— 17144 and 3779 Ã— 12926, respectively.</p><p>Next, we performed a principal component analysis (PCA) on these matrices to transform the gene expression data into the principal component (PC) space. We retained only the PCs that account for a cumulative 95% of explained variance. Consequently, the gene expression of the BCs in <inline-formula><mml:math id="inf155"><mml:mi mathvariant="bold-italic">ğ‘¿</mml:mi></mml:math></inline-formula> and the RGCs in <inline-formula><mml:math id="inf156"><mml:mi mathvariant="bold-italic">ğ’€</mml:mi></mml:math></inline-formula> were featurized by their respective PCs, resulting in matrices of dimensions 22453 Ã— 11323 and 3779 Ã— 3142, respectively.</p><p>Based on each cellâ€™s neuronal type, we computed the variance of gene expression features within these types. Mathematically, the variance of gene expression feature <inline-formula><mml:math id="inf157"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi></mml:mstyle></mml:math></inline-formula> within the BC types and the RGC types are expressed as:<disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mover><mml:mi>Ïƒ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:munderover><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>âˆ’</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>.</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ16"><label>(16)</label><mml:math id="m16"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mover><mml:mi>Ïƒ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:munderover><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>âˆ’</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>.</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Taking <inline-formula><mml:math id="inf158"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>x</mml:mi><mml:mo stretchy="false">Â¯</mml:mo></mml:mover></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf159"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>y</mml:mi><mml:mo stretchy="false">Â¯</mml:mo></mml:mover></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>j</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> to represent the average gene expression feature <inline-formula><mml:math id="inf160"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi></mml:mstyle></mml:math></inline-formula> of the BC type <inline-formula><mml:math id="inf161"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>i</mml:mi></mml:mstyle></mml:math></inline-formula> and the RGC type <inline-formula><mml:math id="inf162"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>j</mml:mi></mml:mstyle></mml:math></inline-formula>, we were able construct matrices, <inline-formula><mml:math id="inf163"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¿</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf164"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ’€</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>, in which <inline-formula><mml:math id="inf165"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>x</mml:mi><mml:mo stretchy="false">Â¯</mml:mo></mml:mover></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>Ïƒ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:msub><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mfrac></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf166"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>y</mml:mi><mml:mo stretchy="false">Â¯</mml:mo></mml:mover></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>Ïƒ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:msub><mml:mi>y</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mfrac></mml:mstyle></mml:math></inline-formula>. In these matrics, each row represents a cell type, with the dimensions of <inline-formula><mml:math id="inf167"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¿</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> being 25 Ã— 11323 and <inline-formula><mml:math id="inf168"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ’€</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> being 12 Ã— 3142. These matrices serve to bridge the gene expression of BC types and RGC types with the connectivity matrix of these neuronal types derived from the connectomic data.</p><p>The connectivity matrix of neuronal types is derived from connectomic data acquired through the process of serial electron microscopy (EM)-based reconstruction of brain tissues (<xref ref-type="bibr" rid="bib17">Denk and Horstmann, 2004</xref>; <xref ref-type="bibr" rid="bib30">Helmstaedter et al., 2013</xref>; <xref ref-type="bibr" rid="bib79">Tapia et al., 2012</xref>). From these reconstructed tissues, connectivity measurements are usually expressed as either the contact area or the number of synapses between neurons (<xref ref-type="bibr" rid="bib30">Helmstaedter et al., 2013</xref>; <xref ref-type="bibr" rid="bib86">Turner et al., 2022</xref>). When normalized to the total contact area or total number of synapses of each neuron, the resulting metric, ranging from 0 to 1, signifies the percentage of contact area or synapses formed between neurons. This normalized metric provides a quantitative connectivity measure, where 0 indicates no connectivity and 1 implies complete connectivity between two neurons.</p><p>Our analysis utilized the neural reconstruction data of mouse retinal neurons, courtesy of the EyeWire project, a crowd-sourced initiative that generates 3D reconstructions of neurons from serial section EM images (<xref ref-type="bibr" rid="bib34">Kim et al., 2014</xref>). This extensive dataset facilitated the derivation of a comprehensive connectivity matrix between two classes of mouse retinal neurons - BCs (<xref ref-type="bibr" rid="bib28">Greene et al., 2016</xref>) and RGCs (<xref ref-type="bibr" rid="bib3">Bae et al., 2018</xref>). The data were sourced from the EyeWire Museum (<ext-link ext-link-type="uri" xlink:href="https://museum.eyewire.org/">https://museum.eyewire.org/</ext-link>), which offers detailed information for each cell in a JSON file, including attributes like â€˜cell idâ€™, â€˜cell typeâ€™, â€˜cell classâ€™, and â€˜stratificationâ€™. The stratification profile describes the linear density of voxel volume as a function of the inner plexiform layer (IPL) depth (<xref ref-type="bibr" rid="bib34">Kim et al., 2014</xref>; <xref ref-type="bibr" rid="bib28">Greene et al., 2016</xref>; <xref ref-type="bibr" rid="bib3">Bae et al., 2018</xref>).</p><p>We approximated the connectivity metric between a BC and a RGC using the cosine similarity of their stratification profiles. Let <inline-formula><mml:math id="inf169"><mml:msub><mml:mi mathvariant="bold-italic">ğ’—</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>â¢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf170"><mml:msub><mml:mi mathvariant="bold-italic">ğ’—</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>â¢</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> denote the stratification profiles of the <inline-formula><mml:math id="inf171"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>k</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> cell in BC type <inline-formula><mml:math id="inf172"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>i</mml:mi></mml:mstyle></mml:math></inline-formula> and the <inline-formula><mml:math id="inf173"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>l</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> cell in RGC type <inline-formula><mml:math id="inf174"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>j</mml:mi></mml:mstyle></mml:math></inline-formula>, respectively. The connectivity metric <inline-formula><mml:math id="inf175"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>z</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> between these two neurons can be expressed as:<disp-formula id="equ17"><label>(17)</label><mml:math id="m17"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>This equation represents the degree of overlap in their voxel volume profile within the IPL, resulting in the connectivity matrix <inline-formula><mml:math id="inf176"><mml:mi mathvariant="bold-italic">ğ’</mml:mi></mml:math></inline-formula> between mouse BCs and RGCs. To allow for both positive and negative values within the matrix, we standardized <inline-formula><mml:math id="inf177"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ’</mml:mi><mml:mo stretchy="false">Â¯</mml:mo></mml:mover></mml:math></inline-formula> by subtracting the mean of <inline-formula><mml:math id="inf178"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ’</mml:mi><mml:mo stretchy="false">Â¯</mml:mo></mml:mover></mml:math></inline-formula> and then dividing by its standard deviation. Subsequently, the connectivity matrix <inline-formula><mml:math id="inf179"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ’</mml:mi><mml:mo stretchy="false">Â¯</mml:mo></mml:mover></mml:math></inline-formula> between mouse BC and RGC neuronal types was calculated, with each element <inline-formula><mml:math id="inf180"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>z</mml:mi><mml:mo stretchy="false">Â¯</mml:mo></mml:mover></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>.</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>.</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> representing the average of the connectivity metrics between cells of BC type <inline-formula><mml:math id="inf181"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>i</mml:mi></mml:mstyle></mml:math></inline-formula> and cells of RGC type <inline-formula><mml:math id="inf182"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>j</mml:mi></mml:mstyle></mml:math></inline-formula>.</p><p>Aligning neuronal types as annotated in the single-cell transcriptomic data and those identified in the connectomic data was informed by findings from previous studies. Notably, a one-to-one correspondence exists between BC cell types classified by <xref ref-type="bibr" rid="bib72">Shekhar et al., 2016</xref> and <xref ref-type="bibr" rid="bib28">Greene et al., 2016</xref>. This correspondence is presented in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>.</p><p>Regarding RGC types, alignment between cell types annotated in <xref ref-type="bibr" rid="bib84">Tran et al., 2019</xref> and <xref ref-type="bibr" rid="bib3">Bae et al., 2018</xref> was established primarily based on the findings from <xref ref-type="bibr" rid="bib25">Goetz et al., 2022</xref>. This study presents a unified classification of mouse RGC types, based on their functional, morphological, and gene expression features. The corresponding RGC types were mainly obtained from Supplementary Table S3 of <xref ref-type="bibr" rid="bib25">Goetz et al., 2022</xref> (<xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>), with additions derived from Supplementary Table S1 of <xref ref-type="bibr" rid="bib84">Tran et al., 2019</xref> based on the expressions of genetic markers of these RGC types (<xref ref-type="supplementary-material" rid="supp3">Supplementary file 3</xref>).</p></sec></sec><sec id="s4-2"><title>Model training, validation, and comparison</title><p>Our approach of training and validating the bilinear model involved an iterative optimization of transformation matrices using the AGD algorithm, as outlined in â€˜Bilinear model for neuronal type connectivityâ€™. The primary goal was to minimize the defined loss function. With the matrices initially generated from a standard normal distribution, the optimization process continued until the loss change was less than a threshold of 10<sup>âˆ’6</sup>, or a maximum of 10<sup>6</sup> iterations were completed.</p><p>During optimization, we focused on two key hyperparameters: the regularization parameters, <inline-formula><mml:math id="inf183"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>Î»</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf184"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>Î»</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>, and the latent feature space dimensionality. Preliminary tests indicated that a lower loss was achieved when both regularization parameters were set equally, leading us to consolidate them into a single parameter, <inline-formula><mml:math id="inf185"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>Î»</mml:mi></mml:mstyle></mml:math></inline-formula>.</p><sec id="s4-2-1"><title><italic>C. elegans</italic> neuronal dataset</title><p>For the <italic>C. elegans</italic> dataset, which provides simultaneous gene expression and connectivity data for individual cells, we employed the model configuration described in â€˜Gene expression and connectivity of each cell are known simultaneouslyâ€™. The modelâ€™s hyperparameters, <inline-formula><mml:math id="inf186"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>Î»</mml:mi></mml:mstyle></mml:math></inline-formula> and the latent feature space dimensionality, were fine-tuned through five-fold cross-validation, exploring a range of values for <inline-formula><mml:math id="inf187"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>Î»</mml:mi></mml:mstyle></mml:math></inline-formula> and different dimensions for the latent feature space. The optimal hyperparameters were identified based on the lowest validation loss observed during cross-validation (<xref ref-type="fig" rid="fig2s1">Figure 2â€”figure supplement 1</xref>).</p><p>Given the prior utilization of this dataset in validating the SCM proposed by <xref ref-type="bibr" rid="bib36">KovÃ¡cs et al., 2020</xref>, our bilinear model was positioned for a direct comparison with the SCM. The SCM introduced a rule matrix <inline-formula><mml:math id="inf188"><mml:mi mathvariant="bold-italic">ğ‘¶</mml:mi></mml:math></inline-formula> with the aim to minimize the discrepancy between the observed connectivity and the gene expression-based predicted connectivity <inline-formula><mml:math id="inf189"><mml:mrow><mml:mi mathvariant="bold-italic">ğ‘¿</mml:mi><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold-italic">ğ‘¶</mml:mi><mml:mo>â¢</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">ğ‘¿</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, employing L2 regularization on <inline-formula><mml:math id="inf190"><mml:mi mathvariant="bold-italic">ğ‘¶</mml:mi></mml:math></inline-formula>. Our bilinear model echoes this approach, where we seek to minimize the divergence between the connectivity matrix and the bilinearly predicted connectivity <inline-formula><mml:math id="inf191"><mml:mrow><mml:mi mathvariant="bold-italic">ğ‘¿</mml:mi><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi><mml:mo>â¢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">ğ‘¿</mml:mi><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, with L2 regularization imposed on matrices <inline-formula><mml:math id="inf192"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf193"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi></mml:math></inline-formula>. In essence, the bilinear form decomposes the rule matrix into two lower-dimensional matrices, which represent projections onto latent dimensions.</p><p>To quantitatively compare the bilinear modelâ€™s transformation matrix product <inline-formula><mml:math id="inf194"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¶</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi><mml:mo>â¢</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> with the SCMâ€™s rule matrix <inline-formula><mml:math id="inf195"><mml:mi mathvariant="bold-italic">ğ‘¶</mml:mi></mml:math></inline-formula>, and to systematically identify the genetic interaction each model uniquely captured, we introduced the discrepancy score (DS). For each pair of corresponding entries in the matrices at indices <inline-formula><mml:math id="inf196"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>i</mml:mi></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf197"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>j</mml:mi></mml:mstyle></mml:math></inline-formula>, the DS is calculated as follows:<disp-formula id="equ18"><label>(18)</label><mml:math id="m18"><mml:mrow><mml:mi>D</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>o</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>âˆ’</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>o</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>This metric, ranging from 0 to 1, quantifies the relative discrepancy between the two matrices, normalizing it in relation to their magnitudes. A score close to 1 indicates a large discrepancy, while a score near 0 suggests a negligible difference between the entries. Through this lens, we can further scrutinize the corresponding entries with the score above a certain threshold to reveal specific genetic interactions captured by one model but potentially missed by the other.</p></sec><sec id="s4-2-2"><title>Mouse retinal neuronal dataset</title><p>The modelâ€™s application to the mouse retina dataset, which involves gene expression and connectivity data from disparate sources, was facilitated by the approach outlined in â€˜Connectivity and gene expressions of neuronal types are from different sourcesâ€™. Optimal hyperparameters were determined through five-fold cross-validation, adjusting <inline-formula><mml:math id="inf198"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>Î»</mml:mi></mml:mstyle></mml:math></inline-formula> and exploring various dimensionalities for the latent feature space (<xref ref-type="fig" rid="fig4s1">Figure 4â€”figure supplement 1</xref>). Notably, the lowest validation loss was achieved with the dimensionality of two. Given the chosen hyperparameters, we performed the final round of training on the entire dataset to yield the definitive transformation matrices <inline-formula><mml:math id="inf199"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘¨</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf200"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ğ‘©</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>.</p><p>To assess the consistency of our model under PCA pre-processing across different replicates, we repeated the optimization procedure five times, each time adhering to the previously identified optimal hyperparameters. In the context of our solution, where <inline-formula><mml:math id="inf201"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mtable rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="false">]</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf202"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></inline-formula>, with vectors <inline-formula><mml:math id="inf203"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">ğ’–</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">ğ’—</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> representing coefficients for the first latent dimension and <inline-formula><mml:math id="inf204"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">ğ’–</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">ğ’—</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> for the second, we noted that negating the coefficients of any latent dimension in both matrices (for instance, <inline-formula><mml:math id="inf205"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mo>âˆ’</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf206"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mo>âˆ’</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></inline-formula>) results in an equivalent solution. Therefore, to compare solutions across different repetitions, we calculated the absolute value of cosine similarity for each latent dimensionâ€™s coefficient vectors, and reported the similarity between solutions as the average of the values across the two latent dimensions. Moreover, we recognized that swapping the positions of the coefficient vectors (yielding <inline-formula><mml:math id="inf207"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf208"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></inline-formula>) also leads to an equivalent solution. To accommodate this, we evaluated both the original and swapped vector pairings for each repetition. The final measure of consistency was determined by taking the maximum of the two average absolute cosine similarities, ensuring a comprehensive and robust assessment of solution consistency across multiple runs.</p><p>We observed a high degree of consistency across multiple repetitions of the solutions under PCA pre-processing (<xref ref-type="fig" rid="fig4s2">Figure 4â€”figure supplement 2</xref>). The majority of the average absolute cosine similarity scores are close to 1, and even the minimum observed similarities are well above 0.75, suggesting that the optimization yields stable solutions.</p></sec></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Correspondence of Mouse BC Types from <xref ref-type="bibr" rid="bib28">Greene et al., 2016</xref>; <xref ref-type="bibr" rid="bib72">Shekhar et al., 2016</xref>.</title></caption><media xlink:href="elife-91532-supp1-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="supp2"><label>Supplementary file 2.</label><caption><title>Correspondence of Mouse RGC Types from <xref ref-type="bibr" rid="bib3">Bae et al., 2018</xref>; <xref ref-type="bibr" rid="bib84">Tran et al., 2019</xref>; <xref ref-type="bibr" rid="bib25">Goetz et al., 2022</xref>.</title></caption><media xlink:href="elife-91532-supp2-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="supp3"><label>Supplementary file 3.</label><caption><title>Additional Correspondence of Mouse RGC types (<xref ref-type="bibr" rid="bib3">Bae et al., 2018</xref>; <xref ref-type="bibr" rid="bib84">Tran et al., 2019</xref>; <xref ref-type="bibr" rid="bib25">Goetz et al., 2022</xref>).</title></caption><media xlink:href="elife-91532-supp3-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="supp4"><label>Supplementary file 4.</label><caption><title>Gene Ontology (GO) Terms Associated with Latent Dimensions in BCs and RGCs.</title></caption><media xlink:href="elife-91532-supp4-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="supp5"><label>Supplementary file 5.</label><caption><title>Predicted BC Partners of Transciptionally-defined RGC Types.</title></caption><media xlink:href="elife-91532-supp5-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-91532-mdarchecklist1-v1.pdf" mimetype="application" mime-subtype="pdf"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>The current manuscript is a computational study, so no data have been generated for this manuscript. Modelling code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/muqiao0626/Bilinear_Model">GitHub</ext-link> (copy archived at <xref ref-type="bibr" rid="bib61">Qiao, 2024</xref>).</p><p>The following previously published datasets were used:</p><p><element-citation publication-type="data" specific-use="references" id="dataset1"><person-group person-group-type="author"><name><surname>Shekhar</surname><given-names>K</given-names></name><name><surname>Lapan</surname><given-names>SW</given-names></name><name><surname>Whitney</surname><given-names>IE</given-names></name><name><surname>Tran</surname><given-names>NM</given-names></name><name><surname>Macosko</surname><given-names>EZ</given-names></name><name><surname>Kowalczyk</surname><given-names>M</given-names></name><name><surname>Adiconis</surname><given-names>X</given-names></name><name><surname>Levin</surname><given-names>JZ</given-names></name><name><surname>Nemesh</surname><given-names>J</given-names></name><name><surname>Goldman</surname><given-names>M</given-names></name><name><surname>McCarroll</surname><given-names>SA</given-names></name><name><surname>Cepko</surname><given-names>CL</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2016">2016</year><data-title>Single cell RNA-sequencing of retinal bipolar cells (Mouse BC Gene Expression Data)</data-title><source>NCBI Gene Expression Omnibus</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE81905">GSE81905</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset2"><person-group person-group-type="author"><name><surname>Tran</surname><given-names>NM</given-names></name><name><surname>Shekhar</surname><given-names>K</given-names></name><name><surname>Whitney</surname><given-names>IE</given-names></name><name><surname>Jacobi</surname><given-names>A</given-names></name><name><surname>Benhar</surname><given-names>I</given-names></name><name><surname>Hong</surname><given-names>G</given-names></name><name><surname>Yan</surname><given-names>W</given-names></name><name><surname>Adiconis</surname><given-names>X</given-names></name><name><surname>Arnold</surname><given-names>ME</given-names></name><name><surname>Lee</surname><given-names>JM</given-names></name><name><surname>Levin</surname><given-names>JZ</given-names></name><name><surname>Lin</surname><given-names>D</given-names></name><name><surname>Wang</surname><given-names>C</given-names></name><name><surname>Lieber</surname><given-names>CM</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>He</surname><given-names>Z</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>Single-cell profiles of retinal neurons differing in resilience to injury reveal neuroprotective genes (Mouse RGC Gene Expression Data)</data-title><source>NCBI Gene Expression Omnibus</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE137400">GSE137400</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset3"><person-group person-group-type="author"><name><surname>KovÃ¡cs</surname><given-names>IA</given-names></name><name><surname>BarabÃ¡si</surname><given-names>DL</given-names></name><name><surname>BarabÃ¡s</surname><given-names>AL</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>kpisti/SCM v1.0 (<italic>C. elegans</italic> Data)</data-title><source>Zenodo</source><pub-id pub-id-type="doi">10.5281/zenodo.4027588</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Azeredo da Silveira</surname><given-names>R</given-names></name><name><surname>Roska</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Cell types, circuits, computation</article-title><source>Current Opinion in Neurobiology</source><volume>21</volume><fpage>664</fpage><lpage>671</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2011.05.007</pub-id><pub-id pub-id-type="pmid">21641794</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baden</surname><given-names>T</given-names></name><name><surname>Berens</surname><given-names>P</given-names></name><name><surname>Franke</surname><given-names>K</given-names></name><name><surname>RomÃ¡n RosÃ³n</surname><given-names>M</given-names></name><name><surname>Bethge</surname><given-names>M</given-names></name><name><surname>Euler</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The functional diversity of retinal ganglion cells in the mouse</article-title><source>Nature</source><volume>529</volume><fpage>345</fpage><lpage>350</lpage><pub-id pub-id-type="doi">10.1038/nature16468</pub-id><pub-id pub-id-type="pmid">26735013</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bae</surname><given-names>JA</given-names></name><name><surname>Mu</surname><given-names>S</given-names></name><name><surname>Kim</surname><given-names>JS</given-names></name><name><surname>Turner</surname><given-names>NL</given-names></name><name><surname>Tartavull</surname><given-names>I</given-names></name><name><surname>Kemnitz</surname><given-names>N</given-names></name><name><surname>Jordan</surname><given-names>CS</given-names></name><name><surname>Norton</surname><given-names>AD</given-names></name><name><surname>Silversmith</surname><given-names>WM</given-names></name><name><surname>Prentki</surname><given-names>R</given-names></name><name><surname>Sorek</surname><given-names>M</given-names></name><name><surname>David</surname><given-names>C</given-names></name><name><surname>Jones</surname><given-names>DL</given-names></name><name><surname>Bland</surname><given-names>D</given-names></name><name><surname>Sterling</surname><given-names>ALR</given-names></name><name><surname>Park</surname><given-names>J</given-names></name><name><surname>Briggman</surname><given-names>KL</given-names></name><name><surname>Seung</surname><given-names>HS</given-names></name><collab>Eyewirers</collab></person-group><year iso-8601-date="2018">2018</year><article-title>Digital museum of retinal ganglion cells with dense anatomy and physiology</article-title><source>Cell</source><volume>173</volume><fpage>1293</fpage><lpage>1306</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2018.04.040</pub-id><pub-id pub-id-type="pmid">29775596</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>BarabÃ¡si</surname><given-names>DL</given-names></name><name><surname>BarabÃ¡si</surname><given-names>AL</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>A genetic model of the connectome</article-title><source>Neuron</source><volume>105</volume><fpage>435</fpage><lpage>445</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2019.10.031</pub-id><pub-id pub-id-type="pmid">31806491</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bennett</surname><given-names>HM</given-names></name><name><surname>Stephenson</surname><given-names>W</given-names></name><name><surname>Rose</surname><given-names>CM</given-names></name><name><surname>Darmanis</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Single-cell proteomics enabled by next-generation sequencing or mass spectrometry</article-title><source>Nature Methods</source><volume>20</volume><fpage>363</fpage><lpage>374</lpage><pub-id pub-id-type="doi">10.1038/s41592-023-01791-5</pub-id><pub-id pub-id-type="pmid">36864196</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bisogni</surname><given-names>AJ</given-names></name><name><surname>Ghazanfar</surname><given-names>S</given-names></name><name><surname>Williams</surname><given-names>EO</given-names></name><name><surname>Marsh</surname><given-names>HM</given-names></name><name><surname>Yang</surname><given-names>JY</given-names></name><name><surname>Lin</surname><given-names>DM</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Tuning of delta-protocadherin adhesion through combinatorial diversity</article-title><source>eLife</source><volume>7</volume><elocation-id>e41050</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.41050</pub-id><pub-id pub-id-type="pmid">30547884</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Biswas</surname><given-names>S</given-names></name><name><surname>Emond</surname><given-names>MR</given-names></name><name><surname>Chenoweth</surname><given-names>KP</given-names></name><name><surname>Jontes</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Î´-Protocadherins regulate neural progenitor cell division by antagonizing Ryk and Wnt/Î²-catenin signaling</article-title><source>iScience</source><volume>24</volume><elocation-id>102932</elocation-id><pub-id pub-id-type="doi">10.1016/j.isci.2021.102932</pub-id><pub-id pub-id-type="pmid">34430817</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bock</surname><given-names>DD</given-names></name><name><surname>Lee</surname><given-names>WCA</given-names></name><name><surname>Kerlin</surname><given-names>AM</given-names></name><name><surname>Andermann</surname><given-names>ML</given-names></name><name><surname>Hood</surname><given-names>G</given-names></name><name><surname>Wetzel</surname><given-names>AW</given-names></name><name><surname>Yurgenson</surname><given-names>S</given-names></name><name><surname>Soucy</surname><given-names>ER</given-names></name><name><surname>Kim</surname><given-names>HS</given-names></name><name><surname>Reid</surname><given-names>RC</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Network anatomy and in vivo physiology of visual cortical neurons</article-title><source>Nature</source><volume>471</volume><fpage>177</fpage><lpage>182</lpage><pub-id pub-id-type="doi">10.1038/nature09802</pub-id><pub-id pub-id-type="pmid">21390124</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Butler</surname><given-names>A</given-names></name><name><surname>Hoffman</surname><given-names>P</given-names></name><name><surname>Smibert</surname><given-names>P</given-names></name><name><surname>Papalexi</surname><given-names>E</given-names></name><name><surname>Satija</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title><source>Nature Biotechnology</source><volume>36</volume><fpage>411</fpage><lpage>420</lpage><pub-id pub-id-type="doi">10.1038/nbt.4096</pub-id><pub-id pub-id-type="pmid">29608179</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>HIH</given-names></name><name><surname>Jin</surname><given-names>Y</given-names></name><name><surname>Huang</surname><given-names>Y</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Detection of high variability in gene expression from single-cell RNA-seq profiling</article-title><source>BMC Genomics</source><volume>17 Suppl 7</volume><elocation-id>508</elocation-id><pub-id pub-id-type="doi">10.1186/s12864-016-2897-6</pub-id><pub-id pub-id-type="pmid">27556924</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>X</given-names></name><name><surname>Sun</surname><given-names>YC</given-names></name><name><surname>Zhan</surname><given-names>H</given-names></name><name><surname>Kebschull</surname><given-names>JM</given-names></name><name><surname>Fischer</surname><given-names>S</given-names></name><name><surname>Matho</surname><given-names>K</given-names></name><name><surname>Huang</surname><given-names>ZJ</given-names></name><name><surname>Gillis</surname><given-names>J</given-names></name><name><surname>Zador</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>High-throughput mapping of long-range neuronal projection using in situ sequencing</article-title><source>Cell</source><volume>179</volume><fpage>772</fpage><lpage>786</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2019.09.023</pub-id><pub-id pub-id-type="pmid">31626774</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>A</given-names></name><name><surname>Sun</surname><given-names>Y</given-names></name><name><surname>Lei</surname><given-names>Y</given-names></name><name><surname>Li</surname><given-names>C</given-names></name><name><surname>Liao</surname><given-names>S</given-names></name><name><surname>Meng</surname><given-names>J</given-names></name><name><surname>Bai</surname><given-names>Y</given-names></name><name><surname>Liu</surname><given-names>Z</given-names></name><name><surname>Liang</surname><given-names>Z</given-names></name><name><surname>Zhu</surname><given-names>Z</given-names></name><name><surname>Yuan</surname><given-names>N</given-names></name><name><surname>Yang</surname><given-names>H</given-names></name><name><surname>Wu</surname><given-names>Z</given-names></name><name><surname>Lin</surname><given-names>F</given-names></name><name><surname>Wang</surname><given-names>K</given-names></name><name><surname>Li</surname><given-names>M</given-names></name><name><surname>Zhang</surname><given-names>S</given-names></name><name><surname>Yang</surname><given-names>M</given-names></name><name><surname>Fei</surname><given-names>T</given-names></name><name><surname>Zhuang</surname><given-names>Z</given-names></name><name><surname>Huang</surname><given-names>Y</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Xu</surname><given-names>Y</given-names></name><name><surname>Cui</surname><given-names>L</given-names></name><name><surname>Zhang</surname><given-names>R</given-names></name><name><surname>Han</surname><given-names>L</given-names></name><name><surname>Sun</surname><given-names>X</given-names></name><name><surname>Chen</surname><given-names>B</given-names></name><name><surname>Li</surname><given-names>W</given-names></name><name><surname>Huangfu</surname><given-names>B</given-names></name><name><surname>Ma</surname><given-names>K</given-names></name><name><surname>Ma</surname><given-names>J</given-names></name><name><surname>Li</surname><given-names>Z</given-names></name><name><surname>Lin</surname><given-names>Y</given-names></name><name><surname>Wang</surname><given-names>H</given-names></name><name><surname>Zhong</surname><given-names>Y</given-names></name><name><surname>Zhang</surname><given-names>H</given-names></name><name><surname>Yu</surname><given-names>Q</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Liu</surname><given-names>X</given-names></name><name><surname>Peng</surname><given-names>J</given-names></name><name><surname>Liu</surname><given-names>C</given-names></name><name><surname>Chen</surname><given-names>W</given-names></name><name><surname>Pan</surname><given-names>W</given-names></name><name><surname>An</surname><given-names>Y</given-names></name><name><surname>Xia</surname><given-names>S</given-names></name><name><surname>Lu</surname><given-names>Y</given-names></name><name><surname>Wang</surname><given-names>M</given-names></name><name><surname>Song</surname><given-names>X</given-names></name><name><surname>Liu</surname><given-names>S</given-names></name><name><surname>Wang</surname><given-names>Z</given-names></name><name><surname>Gong</surname><given-names>C</given-names></name><name><surname>Huang</surname><given-names>X</given-names></name><name><surname>Yuan</surname><given-names>Y</given-names></name><name><surname>Zhao</surname><given-names>Y</given-names></name><name><surname>Chai</surname><given-names>Q</given-names></name><name><surname>Tan</surname><given-names>X</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Zheng</surname><given-names>M</given-names></name><name><surname>Li</surname><given-names>S</given-names></name><name><surname>Huang</surname><given-names>Y</given-names></name><name><surname>Hong</surname><given-names>Y</given-names></name><name><surname>Huang</surname><given-names>Z</given-names></name><name><surname>Li</surname><given-names>M</given-names></name><name><surname>Jin</surname><given-names>M</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Zhang</surname><given-names>H</given-names></name><name><surname>Sun</surname><given-names>S</given-names></name><name><surname>Gao</surname><given-names>L</given-names></name><name><surname>Bai</surname><given-names>Y</given-names></name><name><surname>Cheng</surname><given-names>M</given-names></name><name><surname>Hu</surname><given-names>G</given-names></name><name><surname>Liu</surname><given-names>S</given-names></name><name><surname>Wang</surname><given-names>B</given-names></name><name><surname>Xiang</surname><given-names>B</given-names></name><name><surname>Li</surname><given-names>S</given-names></name><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Chen</surname><given-names>M</given-names></name><name><surname>Wang</surname><given-names>S</given-names></name><name><surname>Li</surname><given-names>M</given-names></name><name><surname>Liu</surname><given-names>W</given-names></name><name><surname>Liu</surname><given-names>X</given-names></name><name><surname>Zhao</surname><given-names>Q</given-names></name><name><surname>Lisby</surname><given-names>M</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Fang</surname><given-names>J</given-names></name><name><surname>Lin</surname><given-names>Y</given-names></name><name><surname>Xie</surname><given-names>Q</given-names></name><name><surname>Liu</surname><given-names>Z</given-names></name><name><surname>He</surname><given-names>J</given-names></name><name><surname>Xu</surname><given-names>H</given-names></name><name><surname>Huang</surname><given-names>W</given-names></name><name><surname>Mulder</surname><given-names>J</given-names></name><name><surname>Yang</surname><given-names>H</given-names></name><name><surname>Sun</surname><given-names>Y</given-names></name><name><surname>Uhlen</surname><given-names>M</given-names></name><name><surname>Poo</surname><given-names>M</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Yao</surname><given-names>J</given-names></name><name><surname>Wei</surname><given-names>W</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Shen</surname><given-names>Z</given-names></name><name><surname>Liu</surname><given-names>L</given-names></name><name><surname>Liu</surname><given-names>Z</given-names></name><name><surname>Xu</surname><given-names>X</given-names></name><name><surname>Li</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Single-cell spatial transcriptome reveals cell-type organization in the macaque cortex</article-title><source>Cell</source><volume>186</volume><fpage>3726</fpage><lpage>3743</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2023.06.009</pub-id><pub-id pub-id-type="pmid">37442136</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cong</surname><given-names>L</given-names></name><name><surname>Ran</surname><given-names>FA</given-names></name><name><surname>Cox</surname><given-names>D</given-names></name><name><surname>Lin</surname><given-names>S</given-names></name><name><surname>Barretto</surname><given-names>R</given-names></name><name><surname>Habib</surname><given-names>N</given-names></name><name><surname>Hsu</surname><given-names>PD</given-names></name><name><surname>Wu</surname><given-names>X</given-names></name><name><surname>Jiang</surname><given-names>W</given-names></name><name><surname>Marraffini</surname><given-names>LA</given-names></name><name><surname>Zhang</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Multiplex genome engineering using CRISPR/Cas systems</article-title><source>Science</source><volume>339</volume><fpage>819</fpage><lpage>823</lpage><pub-id pub-id-type="doi">10.1126/science.1231143</pub-id><pub-id pub-id-type="pmid">23287718</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cook</surname><given-names>SJ</given-names></name><name><surname>Jarrell</surname><given-names>TA</given-names></name><name><surname>Brittin</surname><given-names>CA</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Bloniarz</surname><given-names>AE</given-names></name><name><surname>Yakovlev</surname><given-names>MA</given-names></name><name><surname>Nguyen</surname><given-names>KCQ</given-names></name><name><surname>Tang</surname><given-names>LTH</given-names></name><name><surname>Bayer</surname><given-names>EA</given-names></name><name><surname>Duerr</surname><given-names>JS</given-names></name><name><surname>BÃ¼low</surname><given-names>HE</given-names></name><name><surname>Hobert</surname><given-names>O</given-names></name><name><surname>Hall</surname><given-names>DH</given-names></name><name><surname>Emmons</surname><given-names>SW</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Whole-animal connectomes of both <italic>Caenorhabditis elegans</italic> sexes</article-title><source>Nature</source><volume>571</volume><fpage>63</fpage><lpage>71</lpage><pub-id pub-id-type="doi">10.1038/s41586-019-1352-7</pub-id><pub-id pub-id-type="pmid">31270481</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davie</surname><given-names>K</given-names></name><name><surname>Janssens</surname><given-names>J</given-names></name><name><surname>Koldere</surname><given-names>D</given-names></name><name><surname>De Waegeneer</surname><given-names>M</given-names></name><name><surname>Pech</surname><given-names>U</given-names></name><name><surname>Kreft</surname><given-names>Å</given-names></name><name><surname>Aibar</surname><given-names>S</given-names></name><name><surname>Makhzami</surname><given-names>S</given-names></name><name><surname>Christiaens</surname><given-names>V</given-names></name><name><surname>Bravo GonzÃ¡lez-Blas</surname><given-names>C</given-names></name><name><surname>Poovathingal</surname><given-names>S</given-names></name><name><surname>Hulselmans</surname><given-names>G</given-names></name><name><surname>Spanier</surname><given-names>KI</given-names></name><name><surname>Moerman</surname><given-names>T</given-names></name><name><surname>Vanspauwen</surname><given-names>B</given-names></name><name><surname>Geurs</surname><given-names>S</given-names></name><name><surname>Voet</surname><given-names>T</given-names></name><name><surname>Lammertyn</surname><given-names>J</given-names></name><name><surname>Thienpont</surname><given-names>B</given-names></name><name><surname>Liu</surname><given-names>S</given-names></name><name><surname>Konstantinides</surname><given-names>N</given-names></name><name><surname>Fiers</surname><given-names>M</given-names></name><name><surname>Verstreken</surname><given-names>P</given-names></name><name><surname>Aerts</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A single-cell transcriptome atlas of the aging <italic>Drosophila</italic> brain</article-title><source>Cell</source><volume>174</volume><fpage>982</fpage><lpage>998</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2018.05.057</pub-id><pub-id pub-id-type="pmid">29909982</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Wit</surname><given-names>J</given-names></name><name><surname>Ghosh</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Specification of synaptic connectivity by cell surface interactions</article-title><source>Nature Reviews. Neuroscience</source><volume>17</volume><fpage>22</fpage><lpage>35</lpage><pub-id pub-id-type="doi">10.1038/nrn.2015.3</pub-id><pub-id pub-id-type="pmid">26656254</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Denk</surname><given-names>W</given-names></name><name><surname>Horstmann</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Serial block-face scanning electron microscopy to reconstruct three-dimensional tissue nanostructure</article-title><source>PLOS Biology</source><volume>2</volume><elocation-id>e329</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.0020329</pub-id><pub-id pub-id-type="pmid">15514700</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dickinson</surname><given-names>DJ</given-names></name><name><surname>Goldstein</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>CRISPR-based methods for <italic>Caenorhabditis elegans</italic> genome engineering</article-title><source>Genetics</source><volume>202</volume><fpage>885</fpage><lpage>901</lpage><pub-id pub-id-type="doi">10.1534/genetics.115.182162</pub-id><pub-id pub-id-type="pmid">26953268</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Ding</surname><given-names>Z</given-names></name><name><surname>Fahey</surname><given-names>PG</given-names></name><name><surname>Papadopoulos</surname><given-names>S</given-names></name><name><surname>Wang</surname><given-names>EY</given-names></name><name><surname>Celii</surname><given-names>B</given-names></name><name><surname>Papadopoulos</surname><given-names>C</given-names></name><name><surname>Kunin</surname><given-names>AB</given-names></name><name><surname>Chang</surname><given-names>A</given-names></name><name><surname>Fu</surname><given-names>J</given-names></name><name><surname>Ding</surname><given-names>Z</given-names></name><name><surname>Patel</surname><given-names>S</given-names></name><name><surname>Ponder</surname><given-names>K</given-names></name><name><surname>Muhammad</surname><given-names>T</given-names></name><name><surname>Bae</surname><given-names>JA</given-names></name><name><surname>Bodor</surname><given-names>AL</given-names></name><name><surname>Brittain</surname><given-names>D</given-names></name><name><surname>Buchanan</surname><given-names>J</given-names></name><name><surname>Bumbarger</surname><given-names>DJ</given-names></name><name><surname>Castro</surname><given-names>MA</given-names></name><name><surname>Cobos</surname><given-names>E</given-names></name><name><surname>Dorkenwald</surname><given-names>S</given-names></name><name><surname>Elabbady</surname><given-names>L</given-names></name><name><surname>Halageri</surname><given-names>A</given-names></name><name><surname>Jia</surname><given-names>Z</given-names></name><name><surname>Jordan</surname><given-names>C</given-names></name><name><surname>Kapner</surname><given-names>D</given-names></name><name><surname>Kemnitz</surname><given-names>N</given-names></name><name><surname>Kinn</surname><given-names>S</given-names></name><name><surname>Lee</surname><given-names>K</given-names></name><name><surname>Li</surname><given-names>K</given-names></name><name><surname>Lu</surname><given-names>R</given-names></name><name><surname>Macrina</surname><given-names>T</given-names></name><name><surname>Mahalingam</surname><given-names>G</given-names></name><name><surname>Mitchell</surname><given-names>E</given-names></name><name><surname>Mondal</surname><given-names>SS</given-names></name><name><surname>Mu</surname><given-names>S</given-names></name><name><surname>Nehoran</surname><given-names>B</given-names></name><name><surname>Popovych</surname><given-names>S</given-names></name><name><surname>Schneider-Mizell</surname><given-names>CM</given-names></name><name><surname>Silversmith</surname><given-names>W</given-names></name><name><surname>Takeno</surname><given-names>M</given-names></name><name><surname>Torres</surname><given-names>R</given-names></name><name><surname>Turner</surname><given-names>NL</given-names></name><name><surname>Wong</surname><given-names>W</given-names></name><name><surname>Wu</surname><given-names>J</given-names></name><name><surname>Yin</surname><given-names>W</given-names></name><name><surname>Yu</surname><given-names>SC</given-names></name><name><surname>Froudarakis</surname><given-names>E</given-names></name><name><surname>Sinz</surname><given-names>F</given-names></name><name><surname>Seung</surname><given-names>HS</given-names></name><name><surname>Collman</surname><given-names>F</given-names></name><name><surname>da Costa</surname><given-names>NM</given-names></name><name><surname>Reid</surname><given-names>RC</given-names></name><name><surname>Walker</surname><given-names>EY</given-names></name><name><surname>Pitkow</surname><given-names>X</given-names></name><name><surname>Reimer</surname><given-names>J</given-names></name><name><surname>Tolias</surname><given-names>AS</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Functional Connectomics Reveals General Wiring Rule in Mouse Visual Cortex</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2023.03.13.531369</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duan</surname><given-names>X</given-names></name><name><surname>Krishnaswamy</surname><given-names>A</given-names></name><name><surname>De la Huerta</surname><given-names>I</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Type II cadherins guide assembly of a direction-selective retinal circuit</article-title><source>Cell</source><volume>158</volume><fpage>793</fpage><lpage>807</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2014.06.047</pub-id><pub-id pub-id-type="pmid">25126785</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duan</surname><given-names>X</given-names></name><name><surname>Krishnaswamy</surname><given-names>A</given-names></name><name><surname>Laboulaye</surname><given-names>MA</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Peng</surname><given-names>YR</given-names></name><name><surname>Yamagata</surname><given-names>M</given-names></name><name><surname>Toma</surname><given-names>K</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Cadherin combinations recruit dendrites of distinct retinal neurons to a shared interneuronal scaffold</article-title><source>Neuron</source><volume>99</volume><fpage>1145</fpage><lpage>1154</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2018.08.019</pub-id><pub-id pub-id-type="pmid">30197236</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dunn</surname><given-names>FA</given-names></name><name><surname>Wong</surname><given-names>ROL</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Wiring patterns in the mouse retina: collecting evidence across the connectome, physiology and light microscopy</article-title><source>The Journal of Physiology</source><volume>592</volume><fpage>4809</fpage><lpage>4823</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.2014.277228</pub-id><pub-id pub-id-type="pmid">25172948</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Euler</surname><given-names>T</given-names></name><name><surname>Haverkamp</surname><given-names>S</given-names></name><name><surname>Schubert</surname><given-names>T</given-names></name><name><surname>Baden</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Retinal bipolar cells: elementary building blocks of vision</article-title><source>Nature Reviews. Neuroscience</source><volume>15</volume><fpage>507</fpage><lpage>519</lpage><pub-id pub-id-type="doi">10.1038/nrn3783</pub-id><pub-id pub-id-type="pmid">25158357</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fornito</surname><given-names>A</given-names></name><name><surname>ArnatkeviÄiÅ«tÄ—</surname><given-names>A</given-names></name><name><surname>Fulcher</surname><given-names>BD</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Bridging the gap between connectome and transcriptome</article-title><source>Trends in Cognitive Sciences</source><volume>23</volume><fpage>34</fpage><lpage>50</lpage><pub-id pub-id-type="doi">10.1016/j.tics.2018.10.005</pub-id><pub-id pub-id-type="pmid">30455082</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goetz</surname><given-names>J</given-names></name><name><surname>Jessen</surname><given-names>ZF</given-names></name><name><surname>Jacobi</surname><given-names>A</given-names></name><name><surname>Mani</surname><given-names>A</given-names></name><name><surname>Cooler</surname><given-names>S</given-names></name><name><surname>Greer</surname><given-names>D</given-names></name><name><surname>Kadri</surname><given-names>S</given-names></name><name><surname>Segal</surname><given-names>J</given-names></name><name><surname>Shekhar</surname><given-names>K</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name><name><surname>Schwartz</surname><given-names>GW</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Unified classification of mouse retinal ganglion cells using function, morphology, and gene expression</article-title><source>Cell Reports</source><volume>40</volume><elocation-id>111040</elocation-id><pub-id pub-id-type="doi">10.1016/j.celrep.2022.111040</pub-id><pub-id pub-id-type="pmid">35830791</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gollisch</surname><given-names>T</given-names></name><name><surname>Meister</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Eye smarter than scientists believed: neural computations in circuits of the retina</article-title><source>Neuron</source><volume>65</volume><fpage>150</fpage><lpage>164</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2009.12.009</pub-id><pub-id pub-id-type="pmid">20152123</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gratz</surname><given-names>SJ</given-names></name><name><surname>Rubinstein</surname><given-names>CD</given-names></name><name><surname>Harrison</surname><given-names>MM</given-names></name><name><surname>Wildonger</surname><given-names>J</given-names></name><name><surname>Oâ€™Connor-Giles</surname><given-names>KM</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>CRISPR-Cas9 genome editing in <italic>Drosophila</italic></article-title><source>Current Protocols in Molecular Biology</source><volume>111</volume><elocation-id>31</elocation-id><pub-id pub-id-type="doi">10.1002/0471142727.mb3102s111</pub-id><pub-id pub-id-type="pmid">26131852</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greene</surname><given-names>MJ</given-names></name><name><surname>Kim</surname><given-names>JS</given-names></name><name><surname>Seung</surname><given-names>HS</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Analogous convergence of sustained and transient inputs in parallel on and off pathways for retinal motion computation</article-title><source>Cell Reports</source><volume>14</volume><fpage>1892</fpage><lpage>1900</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2016.02.001</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hall</surname><given-names>DH</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Gap junctions in <italic>C. elegans</italic>: their roles in behavior and development</article-title><source>Developmental Neurobiology</source><volume>77</volume><fpage>587</fpage><lpage>596</lpage><pub-id pub-id-type="doi">10.1002/dneu.22408</pub-id><pub-id pub-id-type="pmid">27294317</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Helmstaedter</surname><given-names>M</given-names></name><name><surname>Briggman</surname><given-names>KL</given-names></name><name><surname>Turaga</surname><given-names>SC</given-names></name><name><surname>Jain</surname><given-names>V</given-names></name><name><surname>Seung</surname><given-names>HS</given-names></name><name><surname>Denk</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Connectomic reconstruction of the inner plexiform layer in the mouse retina</article-title><source>Nature</source><volume>500</volume><fpage>168</fpage><lpage>174</lpage><pub-id pub-id-type="doi">10.1038/nature12346</pub-id><pub-id pub-id-type="pmid">23925239</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hong</surname><given-names>SJ</given-names></name><name><surname>Vos de Wael</surname><given-names>R</given-names></name><name><surname>Bethlehem</surname><given-names>RAI</given-names></name><name><surname>Lariviere</surname><given-names>S</given-names></name><name><surname>Paquola</surname><given-names>C</given-names></name><name><surname>Valk</surname><given-names>SL</given-names></name><name><surname>Milham</surname><given-names>MP</given-names></name><name><surname>Di Martino</surname><given-names>A</given-names></name><name><surname>Margulies</surname><given-names>DS</given-names></name><name><surname>Smallwood</surname><given-names>J</given-names></name><name><surname>Bernhardt</surname><given-names>BC</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Atypical functional connectome hierarchy in autism</article-title><source>Nature Communications</source><volume>10</volume><elocation-id>1022</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-019-08944-1</pub-id><pub-id pub-id-type="pmid">30833582</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kahr</surname><given-names>I</given-names></name><name><surname>Vandepoele</surname><given-names>K</given-names></name><name><surname>van Roy</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Delta-protocadherins in health and disease</article-title><source>Progress in Molecular Biology and Translational Science</source><volume>116</volume><fpage>169</fpage><lpage>192</lpage><pub-id pub-id-type="doi">10.1016/B978-0-12-394311-8.00008-X</pub-id><pub-id pub-id-type="pmid">23481195</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kaufman</surname><given-names>A</given-names></name><name><surname>Dror</surname><given-names>G</given-names></name><name><surname>Meilijson</surname><given-names>I</given-names></name><name><surname>Ruppin</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Gene expression of <italic>Caenorhabditis elegans</italic> neurons carries information on their synaptic connectivity</article-title><source>PLOS Computational Biology</source><volume>2</volume><elocation-id>e167</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.0020167</pub-id><pub-id pub-id-type="pmid">17154715</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>JS</given-names></name><name><surname>Greene</surname><given-names>MJ</given-names></name><name><surname>Zlateski</surname><given-names>A</given-names></name><name><surname>Lee</surname><given-names>K</given-names></name><name><surname>Richardson</surname><given-names>M</given-names></name><name><surname>Turaga</surname><given-names>SC</given-names></name><name><surname>Purcaro</surname><given-names>M</given-names></name><name><surname>Balkam</surname><given-names>M</given-names></name><name><surname>Robinson</surname><given-names>A</given-names></name><name><surname>Behabadi</surname><given-names>BF</given-names></name><name><surname>Campos</surname><given-names>M</given-names></name><name><surname>Denk</surname><given-names>W</given-names></name><name><surname>Seung</surname><given-names>HS</given-names></name><collab>EyeWirers</collab></person-group><year iso-8601-date="2014">2014</year><article-title>Space-time wiring specificity supports direction selectivity in the retina</article-title><source>Nature</source><volume>509</volume><fpage>331</fpage><lpage>336</lpage><pub-id pub-id-type="doi">10.1038/nature13240</pub-id><pub-id pub-id-type="pmid">24805243</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koren</surname><given-names>Y</given-names></name><name><surname>Bell</surname><given-names>R</given-names></name><name><surname>Volinsky</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Matrix factorization techniques for recommender systems</article-title><source>Computer</source><volume>42</volume><fpage>30</fpage><lpage>37</lpage><pub-id pub-id-type="doi">10.1109/MC.2009.263</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>KovÃ¡cs</surname><given-names>IA</given-names></name><name><surname>BarabÃ¡si</surname><given-names>DL</given-names></name><name><surname>BarabÃ¡si</surname><given-names>AL</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Uncovering the genetic blueprint of the <italic>C. elegans</italic> nervous system</article-title><source>PNAS</source><volume>117</volume><fpage>33570</fpage><lpage>33577</lpage><pub-id pub-id-type="doi">10.1073/pnas.2009093117</pub-id><pub-id pub-id-type="pmid">33318182</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krieger</surname><given-names>B</given-names></name><name><surname>Qiao</surname><given-names>M</given-names></name><name><surname>Rousso</surname><given-names>DL</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name><name><surname>Meister</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Four alpha ganglion cell types in mouse retina: Function, structure, and molecular signatures</article-title><source>PLOS ONE</source><volume>12</volume><elocation-id>e0180091</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0180091</pub-id><pub-id pub-id-type="pmid">28753612</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krishnaswamy</surname><given-names>A</given-names></name><name><surname>Yamagata</surname><given-names>M</given-names></name><name><surname>Duan</surname><given-names>X</given-names></name><name><surname>Hong</surname><given-names>YK</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Sidekick 2 directs formation of a retinal circuit that detects differential motion</article-title><source>Nature</source><volume>524</volume><fpage>466</fpage><lpage>470</lpage><pub-id pub-id-type="doi">10.1038/nature14682</pub-id><pub-id pub-id-type="pmid">26287463</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kumar</surname><given-names>NM</given-names></name><name><surname>Gilula</surname><given-names>NB</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>The gap junction communication channel</article-title><source>Cell</source><volume>84</volume><fpage>381</fpage><lpage>388</lpage><pub-id pub-id-type="doi">10.1016/s0092-8674(00)81282-9</pub-id><pub-id pub-id-type="pmid">8608591</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kurmangaliyev</surname><given-names>YZ</given-names></name><name><surname>Yoo</surname><given-names>J</given-names></name><name><surname>LoCascio</surname><given-names>SA</given-names></name><name><surname>Zipursky</surname><given-names>SL</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Modular transcriptional programs separately define axon and dendrite connectivity</article-title><source>eLife</source><volume>8</volume><elocation-id>e50822</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.50822</pub-id><pub-id pub-id-type="pmid">31687928</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lasseigne</surname><given-names>AM</given-names></name><name><surname>Echeverry</surname><given-names>FA</given-names></name><name><surname>Ijaz</surname><given-names>S</given-names></name><name><surname>Michel</surname><given-names>JC</given-names></name><name><surname>Martin</surname><given-names>EA</given-names></name><name><surname>Marsh</surname><given-names>AJ</given-names></name><name><surname>Trujillo</surname><given-names>E</given-names></name><name><surname>Marsden</surname><given-names>KC</given-names></name><name><surname>Pereda</surname><given-names>AE</given-names></name><name><surname>Miller</surname><given-names>AC</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Electrical synaptic transmission requires a postsynaptic scaffolding protein</article-title><source>eLife</source><volume>10</volume><elocation-id>e66898</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.66898</pub-id><pub-id pub-id-type="pmid">33908867</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>WCA</given-names></name><name><surname>Bonin</surname><given-names>V</given-names></name><name><surname>Reed</surname><given-names>M</given-names></name><name><surname>Graham</surname><given-names>BJ</given-names></name><name><surname>Hood</surname><given-names>G</given-names></name><name><surname>Glattfelder</surname><given-names>K</given-names></name><name><surname>Reid</surname><given-names>RC</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Anatomy and function of an excitatory network in the visual cortex</article-title><source>Nature</source><volume>532</volume><fpage>370</fpage><lpage>374</lpage><pub-id pub-id-type="doi">10.1038/nature17192</pub-id><pub-id pub-id-type="pmid">27018655</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>M</given-names></name><name><surname>Zhao</surname><given-names>L</given-names></name><name><surname>Page-McCaw</surname><given-names>PS</given-names></name><name><surname>Chen</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Zebrafish genome engineering using the CRISPR-Cas9 system</article-title><source>Trends in Genetics</source><volume>32</volume><fpage>815</fpage><lpage>827</lpage><pub-id pub-id-type="doi">10.1016/j.tig.2016.10.005</pub-id><pub-id pub-id-type="pmid">27836208</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>C</given-names></name><name><surname>Fleck</surname><given-names>JS</given-names></name><name><surname>Martins-Costa</surname><given-names>C</given-names></name><name><surname>Burkard</surname><given-names>TR</given-names></name><name><surname>Themann</surname><given-names>J</given-names></name><name><surname>Stuempflen</surname><given-names>M</given-names></name><name><surname>Peer</surname><given-names>AM</given-names></name><name><surname>Vertesy</surname><given-names>Ã</given-names></name><name><surname>Littleboy</surname><given-names>JB</given-names></name><name><surname>Esk</surname><given-names>C</given-names></name><name><surname>Elling</surname><given-names>U</given-names></name><name><surname>Kasprian</surname><given-names>G</given-names></name><name><surname>Corsini</surname><given-names>NS</given-names></name><name><surname>Treutlein</surname><given-names>B</given-names></name><name><surname>Knoblich</surname><given-names>JA</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Single-cell brain organoid screening identifies developmental defects in autism</article-title><source>Nature</source><volume>621</volume><fpage>373</fpage><lpage>380</lpage><pub-id pub-id-type="doi">10.1038/s41586-023-06473-y</pub-id><pub-id pub-id-type="pmid">37704762</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Light</surname><given-names>SEW</given-names></name><name><surname>Jontes</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Î´-Protocadherins: Organizers of neural circuit assembly</article-title><source>Seminars in Cell &amp; Developmental Biology</source><volume>69</volume><fpage>83</fpage><lpage>90</lpage><pub-id pub-id-type="doi">10.1016/j.semcdb.2017.07.037</pub-id><pub-id pub-id-type="pmid">28751249</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Reggiani</surname><given-names>JDS</given-names></name><name><surname>Laboulaye</surname><given-names>MA</given-names></name><name><surname>Pandey</surname><given-names>S</given-names></name><name><surname>Chen</surname><given-names>B</given-names></name><name><surname>Rubenstein</surname><given-names>JLR</given-names></name><name><surname>Krishnaswamy</surname><given-names>A</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Tbr1 instructs laminar patterning of retinal ganglion cell dendrites</article-title><source>Nature Neuroscience</source><volume>21</volume><fpage>659</fpage><lpage>670</lpage><pub-id pub-id-type="doi">10.1038/s41593-018-0127-z</pub-id><pub-id pub-id-type="pmid">29632360</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mali</surname><given-names>P</given-names></name><name><surname>Yang</surname><given-names>L</given-names></name><name><surname>Esvelt</surname><given-names>KM</given-names></name><name><surname>Aach</surname><given-names>J</given-names></name><name><surname>Guell</surname><given-names>M</given-names></name><name><surname>DiCarlo</surname><given-names>JE</given-names></name><name><surname>Norville</surname><given-names>JE</given-names></name><name><surname>Church</surname><given-names>GM</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>RNA-guided human genome engineering via Cas9</article-title><source>Science</source><volume>339</volume><fpage>823</fpage><lpage>826</lpage><pub-id pub-id-type="doi">10.1126/science.1232033</pub-id><pub-id pub-id-type="pmid">23287722</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marcus</surname><given-names>G</given-names></name><name><surname>Marblestone</surname><given-names>A</given-names></name><name><surname>Dean</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The atoms of neural computation</article-title><source>Science</source><volume>346</volume><fpage>551</fpage><lpage>552</lpage><pub-id pub-id-type="doi">10.1126/science.1261661</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martin</surname><given-names>EA</given-names></name><name><surname>Lasseigne</surname><given-names>AM</given-names></name><name><surname>Miller</surname><given-names>AC</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Understanding the molecular and cell biological mechanisms of electrical synapse formation</article-title><source>Frontiers in Neuroanatomy</source><volume>14</volume><elocation-id>12</elocation-id><pub-id pub-id-type="doi">10.3389/fnana.2020.00012</pub-id><pub-id pub-id-type="pmid">32372919</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Masland</surname><given-names>RH</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The neuronal organization of the retina</article-title><source>Neuron</source><volume>76</volume><fpage>266</fpage><lpage>280</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2012.10.002</pub-id><pub-id pub-id-type="pmid">23083731</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matsuoka</surname><given-names>RL</given-names></name><name><surname>Nguyen-Ba-Charvet</surname><given-names>KT</given-names></name><name><surname>Parray</surname><given-names>A</given-names></name><name><surname>Badea</surname><given-names>TC</given-names></name><name><surname>ChÃ©dotal</surname><given-names>A</given-names></name><name><surname>Kolodkin</surname><given-names>AL</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Transmembrane semaphorin signalling controls laminar stratification in the mammalian retina</article-title><source>Nature</source><volume>470</volume><fpage>259</fpage><lpage>263</lpage><pub-id pub-id-type="doi">10.1038/nature09675</pub-id><pub-id pub-id-type="pmid">21270798</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mazan-Mamczarz</surname><given-names>K</given-names></name><name><surname>Ha</surname><given-names>J</given-names></name><name><surname>De</surname><given-names>S</given-names></name><name><surname>Sen</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Single-cell analysis of the transcriptome and epigenome</article-title><source>Methods in Molecular Biology</source><volume>2399</volume><fpage>21</fpage><lpage>60</lpage><pub-id pub-id-type="doi">10.1007/978-1-0716-1831-8_3</pub-id><pub-id pub-id-type="pmid">35604552</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nassir</surname><given-names>N</given-names></name><name><surname>Bankapur</surname><given-names>A</given-names></name><name><surname>Samara</surname><given-names>B</given-names></name><name><surname>Ali</surname><given-names>A</given-names></name><name><surname>Ahmed</surname><given-names>A</given-names></name><name><surname>Inuwa</surname><given-names>IM</given-names></name><name><surname>Zarrei</surname><given-names>M</given-names></name><name><surname>Safizadeh Shabestari</surname><given-names>SA</given-names></name><name><surname>AlBanna</surname><given-names>A</given-names></name><name><surname>Howe</surname><given-names>JL</given-names></name><name><surname>Berdiev</surname><given-names>BK</given-names></name><name><surname>Scherer</surname><given-names>SW</given-names></name><name><surname>Woodbury-Smith</surname><given-names>M</given-names></name><name><surname>Uddin</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Single-cell transcriptome identifies molecular subtype of autism spectrum disorder impacted by de novo loss-of-function variants regulating glial cells</article-title><source>Human Genomics</source><volume>15</volume><elocation-id>68</elocation-id><pub-id pub-id-type="doi">10.1186/s40246-021-00368-7</pub-id><pub-id pub-id-type="pmid">34802461</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="thesis"><person-group person-group-type="author"><name><surname>Palumbos</surname><given-names>SD</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Molecular determinants of electrical synaptic specificity</article-title><publisher-name>Vanderbilt University</publisher-name></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pandey</surname><given-names>S</given-names></name><name><surname>Shekhar</surname><given-names>K</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>Schier</surname><given-names>AF</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Comprehensive identification and spatial mapping of habenular neuronal types using single-cell RNA-seq</article-title><source>Current Biology</source><volume>28</volume><fpage>1052</fpage><lpage>1065</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2018.02.040</pub-id><pub-id pub-id-type="pmid">29576475</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peek</surname><given-names>SL</given-names></name><name><surname>Mah</surname><given-names>KM</given-names></name><name><surname>Weiner</surname><given-names>JA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Regulation of neural circuit formation by protocadherins</article-title><source>Cellular and Molecular Life Sciences</source><volume>74</volume><fpage>4133</fpage><lpage>4157</lpage><pub-id pub-id-type="doi">10.1007/s00018-017-2572-3</pub-id><pub-id pub-id-type="pmid">28631008</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peng</surname><given-names>YR</given-names></name><name><surname>Tran</surname><given-names>NM</given-names></name><name><surname>Krishnaswamy</surname><given-names>A</given-names></name><name><surname>Kostadinov</surname><given-names>D</given-names></name><name><surname>Martersteck</surname><given-names>EM</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Satb1 regulates contactin 5 to pattern dendrites of a mammalian retinal ganglion cell</article-title><source>Neuron</source><volume>95</volume><fpage>869</fpage><lpage>883</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.07.019</pub-id><pub-id pub-id-type="pmid">28781169</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Phelan</surname><given-names>P</given-names></name><name><surname>Bacon</surname><given-names>JP</given-names></name><name><surname>Davies</surname><given-names>JA</given-names></name><name><surname>Stebbings</surname><given-names>LA</given-names></name><name><surname>Todman</surname><given-names>MG</given-names></name><name><surname>Avery</surname><given-names>L</given-names></name><name><surname>Baines</surname><given-names>RA</given-names></name><name><surname>Barnes</surname><given-names>TM</given-names></name><name><surname>Ford</surname><given-names>C</given-names></name><name><surname>Hekimi</surname><given-names>S</given-names></name><name><surname>Lee</surname><given-names>R</given-names></name><name><surname>Shaw</surname><given-names>JE</given-names></name><name><surname>Starich</surname><given-names>TA</given-names></name><name><surname>Curtin</surname><given-names>KD</given-names></name><name><surname>Sun</surname><given-names>YA</given-names></name><name><surname>Wyman</surname><given-names>RJ</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Innexins: a family of invertebrate gap-junction proteins</article-title><source>Trends in Genetics</source><volume>14</volume><fpage>348</fpage><lpage>349</lpage><pub-id pub-id-type="doi">10.1016/s0168-9525(98)01547-9</pub-id><pub-id pub-id-type="pmid">9769729</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Polleux</surname><given-names>F</given-names></name><name><surname>Snider</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Initiating and growing an axon</article-title><source>Cold Spring Harbor Perspectives in Biology</source><volume>2</volume><elocation-id>a001925</elocation-id><pub-id pub-id-type="doi">10.1101/cshperspect.a001925</pub-id><pub-id pub-id-type="pmid">20452947</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qiao</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Factorized discriminant analysis for genetic signatures of neuronal phenotypes</article-title><source>Frontiers in Neuroinformatics</source><volume>17</volume><elocation-id>1265079</elocation-id><pub-id pub-id-type="doi">10.3389/fninf.2023.1265079</pub-id><pub-id pub-id-type="pmid">38156117</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Qiao</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>Bilinear_Model</data-title><version designator="swh:1:rev:c3fe60b50447a3e10884d662fdb0c5525c3b932d">swh:1:rev:c3fe60b50447a3e10884d662fdb0c5525c3b932d</version><source>Software Heriatge</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:ad66a05b8472508a4e1df435728966f86e2f822a;origin=https://github.com/muqiao0626/Bilinear_Model;visit=swh:1:snp:304111fae37024c1740019a072e05cf6532a2f1d;anchor=swh:1:rev:c3fe60b50447a3e10884d662fdb0c5525c3b932d">https://archive.softwareheritage.org/swh:1:dir:ad66a05b8472508a4e1df435728966f86e2f822a;origin=https://github.com/muqiao0626/Bilinear_Model;visit=swh:1:snp:304111fae37024c1740019a072e05cf6532a2f1d;anchor=swh:1:rev:c3fe60b50447a3e10884d662fdb0c5525c3b932d</ext-link></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rabinowitch</surname><given-names>I</given-names></name><name><surname>Schafer</surname><given-names>WR</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Engineering new synaptic connections in the <italic>C. elegans</italic> connectome</article-title><source>Worm</source><volume>4</volume><elocation-id>e992668</elocation-id><pub-id pub-id-type="doi">10.4161/21624054.2014.992668</pub-id><pub-id pub-id-type="pmid">26430564</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raudvere</surname><given-names>U</given-names></name><name><surname>Kolberg</surname><given-names>L</given-names></name><name><surname>Kuzmin</surname><given-names>I</given-names></name><name><surname>Arak</surname><given-names>T</given-names></name><name><surname>Adler</surname><given-names>P</given-names></name><name><surname>Peterson</surname><given-names>H</given-names></name><name><surname>Vilo</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>G:Profiler: a web server for functional enrichment analysis and conversions of gene lists (2019 update)</article-title><source>Nucleic Acids Research</source><volume>47</volume><fpage>W191</fpage><lpage>W198</lpage><pub-id pub-id-type="doi">10.1093/nar/gkz369</pub-id><pub-id pub-id-type="pmid">31066453</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reimand</surname><given-names>J</given-names></name><name><surname>Kull</surname><given-names>M</given-names></name><name><surname>Peterson</surname><given-names>H</given-names></name><name><surname>Hansen</surname><given-names>J</given-names></name><name><surname>Vilo</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>g:Profiler--a web-based toolset for functional profiling of gene lists from large-scale experiments</article-title><source>Nucleic Acids Research</source><volume>35</volume><fpage>W193</fpage><lpage>W200</lpage><pub-id pub-id-type="doi">10.1093/nar/gkm226</pub-id><pub-id pub-id-type="pmid">17478515</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Rendle</surname><given-names>S</given-names></name><name><surname>Freudenthaler</surname><given-names>C</given-names></name><name><surname>Gantner</surname><given-names>Z</given-names></name><name><surname>Schmidt-Thieme</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>BPR: Bayesian Personalized Ranking from Implicit Feedback, May 2012</article-title><conf-name>Comment: Appears in Proceedings of the Twenty-Fifth Conference on Uncertainty in Artificial Intelligence (UAI2009)</conf-name></element-citation></ref><ref id="bib66"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Ricci</surname><given-names>F</given-names></name><name><surname>Rokach</surname><given-names>L</given-names></name><name><surname>Shapira</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2011">2011</year><chapter-title>Introduction to Recommender Systems Handbook</chapter-title><person-group person-group-type="editor"><name><surname>Ricci</surname><given-names>F</given-names></name><name><surname>Rokach</surname><given-names>L</given-names></name><name><surname>Shapira</surname><given-names>B</given-names></name><name><surname>Kantor</surname><given-names>PB</given-names></name></person-group><source>Recommender Systems Handbook</source><publisher-name>Springer US</publisher-name><fpage>1</fpage><lpage>35</lpage><pub-id pub-id-type="doi">10.1007/978-0-387-85820-3_1</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roine</surname><given-names>U</given-names></name><name><surname>Roine</surname><given-names>T</given-names></name><name><surname>Salmi</surname><given-names>J</given-names></name><name><surname>Nieminen-von Wendt</surname><given-names>T</given-names></name><name><surname>Tani</surname><given-names>P</given-names></name><name><surname>LeppÃ¤mÃ¤ki</surname><given-names>S</given-names></name><name><surname>Rintahaka</surname><given-names>P</given-names></name><name><surname>Caeyenberghs</surname><given-names>K</given-names></name><name><surname>Leemans</surname><given-names>A</given-names></name><name><surname>Sams</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Abnormal wiring of the connectome in adults with high-functioning autism spectrum disorder</article-title><source>Molecular Autism</source><volume>6</volume><elocation-id>65</elocation-id><pub-id pub-id-type="doi">10.1186/s13229-015-0058-4</pub-id><pub-id pub-id-type="pmid">26677408</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanes</surname><given-names>JR</given-names></name><name><surname>Masland</surname><given-names>RH</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The types of retinal ganglion cells: current status and implications for neuronal classification</article-title><source>Annual Review of Neuroscience</source><volume>38</volume><fpage>221</fpage><lpage>246</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-071714-034120</pub-id><pub-id pub-id-type="pmid">25897874</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanes</surname><given-names>JR</given-names></name><name><surname>Zipursky</surname><given-names>SL</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Synaptic specificity, recognition molecules, and assembly of neural circuits</article-title><source>Cell</source><volume>181</volume><fpage>536</fpage><lpage>556</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2020.04.008</pub-id><pub-id pub-id-type="pmid">32359437</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sarin</surname><given-names>S</given-names></name><name><surname>Zuniga-Sanchez</surname><given-names>E</given-names></name><name><surname>Kurmangaliyev</surname><given-names>YZ</given-names></name><name><surname>Cousins</surname><given-names>H</given-names></name><name><surname>Patel</surname><given-names>M</given-names></name><name><surname>Hernandez</surname><given-names>J</given-names></name><name><surname>Zhang</surname><given-names>KX</given-names></name><name><surname>Samuel</surname><given-names>MA</given-names></name><name><surname>Morey</surname><given-names>M</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name><name><surname>Zipursky</surname><given-names>SL</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Role for Wnt signaling in retinal neuropil development: Analysis via RNA-Seq and in vivo somatic CRISPR mutagenesis</article-title><source>Neuron</source><volume>98</volume><fpage>109</fpage><lpage>126</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2018.03.004</pub-id><pub-id pub-id-type="pmid">29576390</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Seung</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2012">2012</year><source>Connectome: How the Brainâ€™s Wiring Makes Us Who We Are</source><publisher-name>Houghton Mifflin Harcourt</publisher-name></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shekhar</surname><given-names>K</given-names></name><name><surname>Lapan</surname><given-names>SW</given-names></name><name><surname>Whitney</surname><given-names>IE</given-names></name><name><surname>Tran</surname><given-names>NM</given-names></name><name><surname>Macosko</surname><given-names>EZ</given-names></name><name><surname>Kowalczyk</surname><given-names>M</given-names></name><name><surname>Adiconis</surname><given-names>X</given-names></name><name><surname>Levin</surname><given-names>JZ</given-names></name><name><surname>Nemesh</surname><given-names>J</given-names></name><name><surname>Goldman</surname><given-names>M</given-names></name><name><surname>McCarroll</surname><given-names>SA</given-names></name><name><surname>Cepko</surname><given-names>CL</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Comprehensive classification of retinal bipolar neurons by single-cell transcriptomics</article-title><source>Cell</source><volume>166</volume><fpage>1308</fpage><lpage>1323</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2016.07.054</pub-id><pub-id pub-id-type="pmid">27565351</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stegle</surname><given-names>O</given-names></name><name><surname>Teichmann</surname><given-names>SA</given-names></name><name><surname>Marioni</surname><given-names>JC</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Computational and analytical challenges in single-cell transcriptomics</article-title><source>Nature Reviews Genetics</source><volume>16</volume><fpage>133</fpage><lpage>145</lpage><pub-id pub-id-type="doi">10.1038/nrg3833</pub-id><pub-id pub-id-type="pmid">25628217</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stuart</surname><given-names>T</given-names></name><name><surname>Butler</surname><given-names>A</given-names></name><name><surname>Hoffman</surname><given-names>P</given-names></name><name><surname>Hafemeister</surname><given-names>C</given-names></name><name><surname>Papalexi</surname><given-names>E</given-names></name><name><surname>Mauck</surname><given-names>WM</given-names></name><name><surname>Hao</surname><given-names>Y</given-names></name><name><surname>Stoeckius</surname><given-names>M</given-names></name><name><surname>Smibert</surname><given-names>P</given-names></name><name><surname>Satija</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Comprehensive Integration of single-cell data</article-title><source>Cell</source><volume>177</volume><fpage>1888</fpage><lpage>1902</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2019.05.031</pub-id><pub-id pub-id-type="pmid">31178118</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Su</surname><given-names>X</given-names></name><name><surname>Khoshgoftaar</surname><given-names>TM</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>A survey of collaborative filtering techniques</article-title><source>Advances in Artificial Intelligence</source><volume>2009</volume><fpage>1</fpage><lpage>19</lpage><pub-id pub-id-type="doi">10.1155/2009/421425</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>SÃ¼dhof</surname><given-names>TC</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Synaptic neurexin complexes: a molecular code for the logic of neural circuits</article-title><source>Cell</source><volume>171</volume><fpage>745</fpage><lpage>769</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2017.10.024</pub-id><pub-id pub-id-type="pmid">29100073</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname><given-names>LO</given-names></name><name><surname>Jiang</surname><given-names>Z</given-names></name><name><surname>Rivlin-Etzion</surname><given-names>M</given-names></name><name><surname>Hand</surname><given-names>R</given-names></name><name><surname>Brady</surname><given-names>CM</given-names></name><name><surname>Matsuoka</surname><given-names>RL</given-names></name><name><surname>Yau</surname><given-names>KW</given-names></name><name><surname>Feller</surname><given-names>MB</given-names></name><name><surname>Kolodkin</surname><given-names>AL</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>On and off retinal circuit assembly by divergent molecular mechanisms</article-title><source>Science</source><volume>342</volume><elocation-id>1241974</elocation-id><pub-id pub-id-type="doi">10.1126/science.1241974</pub-id><pub-id pub-id-type="pmid">24179230</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname><given-names>YC</given-names></name><name><surname>Chen</surname><given-names>X</given-names></name><name><surname>Fischer</surname><given-names>S</given-names></name><name><surname>Lu</surname><given-names>S</given-names></name><name><surname>Zhan</surname><given-names>H</given-names></name><name><surname>Gillis</surname><given-names>J</given-names></name><name><surname>Zador</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Integrating barcoded neuroanatomy with spatial transcriptional profiling enables identification of gene correlates of projections</article-title><source>Nature Neuroscience</source><volume>24</volume><fpage>873</fpage><lpage>885</lpage><pub-id pub-id-type="doi">10.1038/s41593-021-00842-4</pub-id><pub-id pub-id-type="pmid">33972801</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tapia</surname><given-names>JC</given-names></name><name><surname>Kasthuri</surname><given-names>N</given-names></name><name><surname>Hayworth</surname><given-names>KJ</given-names></name><name><surname>Schalek</surname><given-names>R</given-names></name><name><surname>Lichtman</surname><given-names>JW</given-names></name><name><surname>Smith</surname><given-names>SJ</given-names></name><name><surname>Buchanan</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>High-contrast en bloc staining of neuronal tissue for field emission scanning electron microscopy</article-title><source>Nature Protocols</source><volume>7</volume><fpage>193</fpage><lpage>206</lpage><pub-id pub-id-type="doi">10.1038/nprot.2011.439</pub-id><pub-id pub-id-type="pmid">22240582</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tasic</surname><given-names>B</given-names></name><name><surname>Menon</surname><given-names>V</given-names></name><name><surname>Nguyen</surname><given-names>TN</given-names></name><name><surname>Kim</surname><given-names>TK</given-names></name><name><surname>Jarsky</surname><given-names>T</given-names></name><name><surname>Yao</surname><given-names>Z</given-names></name><name><surname>Levi</surname><given-names>B</given-names></name><name><surname>Gray</surname><given-names>LT</given-names></name><name><surname>Sorensen</surname><given-names>SA</given-names></name><name><surname>Dolbeare</surname><given-names>T</given-names></name><name><surname>Bertagnolli</surname><given-names>D</given-names></name><name><surname>Goldy</surname><given-names>J</given-names></name><name><surname>Shapovalova</surname><given-names>N</given-names></name><name><surname>Parry</surname><given-names>S</given-names></name><name><surname>Lee</surname><given-names>C</given-names></name><name><surname>Smith</surname><given-names>K</given-names></name><name><surname>Bernard</surname><given-names>A</given-names></name><name><surname>Madisen</surname><given-names>L</given-names></name><name><surname>Sunkin</surname><given-names>SM</given-names></name><name><surname>Hawrylycz</surname><given-names>M</given-names></name><name><surname>Koch</surname><given-names>C</given-names></name><name><surname>Zeng</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Adult mouse cortical cell taxonomy revealed by single cell transcriptomics</article-title><source>Nature Neuroscience</source><volume>19</volume><fpage>335</fpage><lpage>346</lpage><pub-id pub-id-type="doi">10.1038/nn.4216</pub-id><pub-id pub-id-type="pmid">26727548</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tasic</surname><given-names>B</given-names></name><name><surname>Yao</surname><given-names>Z</given-names></name><name><surname>Graybuck</surname><given-names>LT</given-names></name><name><surname>Smith</surname><given-names>KA</given-names></name><name><surname>Nguyen</surname><given-names>TN</given-names></name><name><surname>Bertagnolli</surname><given-names>D</given-names></name><name><surname>Goldy</surname><given-names>J</given-names></name><name><surname>Garren</surname><given-names>E</given-names></name><name><surname>Economo</surname><given-names>MN</given-names></name><name><surname>Viswanathan</surname><given-names>S</given-names></name><name><surname>Penn</surname><given-names>O</given-names></name><name><surname>Bakken</surname><given-names>T</given-names></name><name><surname>Menon</surname><given-names>V</given-names></name><name><surname>Miller</surname><given-names>J</given-names></name><name><surname>Fong</surname><given-names>O</given-names></name><name><surname>Hirokawa</surname><given-names>KE</given-names></name><name><surname>Lathia</surname><given-names>K</given-names></name><name><surname>Rimorin</surname><given-names>C</given-names></name><name><surname>Tieu</surname><given-names>M</given-names></name><name><surname>Larsen</surname><given-names>R</given-names></name><name><surname>Casper</surname><given-names>T</given-names></name><name><surname>Barkan</surname><given-names>E</given-names></name><name><surname>Kroll</surname><given-names>M</given-names></name><name><surname>Parry</surname><given-names>S</given-names></name><name><surname>Shapovalova</surname><given-names>NV</given-names></name><name><surname>Hirschstein</surname><given-names>D</given-names></name><name><surname>Pendergraft</surname><given-names>J</given-names></name><name><surname>Sullivan</surname><given-names>HA</given-names></name><name><surname>Kim</surname><given-names>TK</given-names></name><name><surname>Szafer</surname><given-names>A</given-names></name><name><surname>Dee</surname><given-names>N</given-names></name><name><surname>Groblewski</surname><given-names>P</given-names></name><name><surname>Wickersham</surname><given-names>I</given-names></name><name><surname>Cetin</surname><given-names>A</given-names></name><name><surname>Harris</surname><given-names>JA</given-names></name><name><surname>Levi</surname><given-names>BP</given-names></name><name><surname>Sunkin</surname><given-names>SM</given-names></name><name><surname>Madisen</surname><given-names>L</given-names></name><name><surname>Daigle</surname><given-names>TL</given-names></name><name><surname>Looger</surname><given-names>L</given-names></name><name><surname>Bernard</surname><given-names>A</given-names></name><name><surname>Phillips</surname><given-names>J</given-names></name><name><surname>Lein</surname><given-names>E</given-names></name><name><surname>Hawrylycz</surname><given-names>M</given-names></name><name><surname>Svoboda</surname><given-names>K</given-names></name><name><surname>Jones</surname><given-names>AR</given-names></name><name><surname>Koch</surname><given-names>C</given-names></name><name><surname>Zeng</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Shared and distinct transcriptomic cell types across neocortical areas</article-title><source>Nature</source><volume>563</volume><fpage>72</fpage><lpage>78</lpage><pub-id pub-id-type="doi">10.1038/s41586-018-0654-5</pub-id><pub-id pub-id-type="pmid">30382198</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taylor</surname><given-names>SR</given-names></name><name><surname>Santpere</surname><given-names>G</given-names></name><name><surname>Weinreb</surname><given-names>A</given-names></name><name><surname>Barrett</surname><given-names>A</given-names></name><name><surname>Reilly</surname><given-names>MB</given-names></name><name><surname>Xu</surname><given-names>C</given-names></name><name><surname>Varol</surname><given-names>E</given-names></name><name><surname>Oikonomou</surname><given-names>P</given-names></name><name><surname>Glenwinkel</surname><given-names>L</given-names></name><name><surname>McWhirter</surname><given-names>R</given-names></name><name><surname>Poff</surname><given-names>A</given-names></name><name><surname>Basavaraju</surname><given-names>M</given-names></name><name><surname>Rafi</surname><given-names>I</given-names></name><name><surname>Yemini</surname><given-names>E</given-names></name><name><surname>Cook</surname><given-names>SJ</given-names></name><name><surname>Abrams</surname><given-names>A</given-names></name><name><surname>Vidal</surname><given-names>B</given-names></name><name><surname>Cros</surname><given-names>C</given-names></name><name><surname>Tavazoie</surname><given-names>S</given-names></name><name><surname>Sestan</surname><given-names>N</given-names></name><name><surname>Hammarlund</surname><given-names>M</given-names></name><name><surname>Hobert</surname><given-names>O</given-names></name><name><surname>Miller</surname><given-names>DM</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Molecular topography of an entire nervous system</article-title><source>Cell</source><volume>184</volume><fpage>4329</fpage><lpage>4347</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2021.06.023</pub-id><pub-id pub-id-type="pmid">34237253</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tian</surname><given-names>F</given-names></name><name><surname>Cheng</surname><given-names>Y</given-names></name><name><surname>Zhou</surname><given-names>S</given-names></name><name><surname>Wang</surname><given-names>Q</given-names></name><name><surname>Monavarfeshani</surname><given-names>A</given-names></name><name><surname>Gao</surname><given-names>K</given-names></name><name><surname>Jiang</surname><given-names>W</given-names></name><name><surname>Kawaguchi</surname><given-names>R</given-names></name><name><surname>Wang</surname><given-names>Q</given-names></name><name><surname>Tang</surname><given-names>M</given-names></name><name><surname>Donahue</surname><given-names>R</given-names></name><name><surname>Meng</surname><given-names>H</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Jacobi</surname><given-names>A</given-names></name><name><surname>Yan</surname><given-names>W</given-names></name><name><surname>Yin</surname><given-names>J</given-names></name><name><surname>Cai</surname><given-names>X</given-names></name><name><surname>Yang</surname><given-names>Z</given-names></name><name><surname>Hegarty</surname><given-names>S</given-names></name><name><surname>Stanicka</surname><given-names>J</given-names></name><name><surname>Dmitriev</surname><given-names>P</given-names></name><name><surname>Taub</surname><given-names>D</given-names></name><name><surname>Zhu</surname><given-names>J</given-names></name><name><surname>Woolf</surname><given-names>CJ</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name><name><surname>Geschwind</surname><given-names>DH</given-names></name><name><surname>He</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Core transcription programs controlling injury-induced neurodegeneration of retinal ganglion cells</article-title><source>Neuron</source><volume>110</volume><fpage>2607</fpage><lpage>2624</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2022.06.003</pub-id><pub-id pub-id-type="pmid">35767995</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Tran</surname><given-names>NM</given-names></name><name><surname>Shekhar</surname><given-names>K</given-names></name><name><surname>Whitney</surname><given-names>IE</given-names></name><name><surname>Jacobi</surname><given-names>A</given-names></name><name><surname>Benhar</surname><given-names>I</given-names></name><name><surname>Hong</surname><given-names>G</given-names></name><name><surname>Yan</surname><given-names>W</given-names></name><name><surname>Adiconis</surname><given-names>X</given-names></name><name><surname>Arnold</surname><given-names>ME</given-names></name><name><surname>Lee</surname><given-names>JM</given-names></name><name><surname>Levin</surname><given-names>JZ</given-names></name><name><surname>Lin</surname><given-names>D</given-names></name><name><surname>Wang</surname><given-names>C</given-names></name><name><surname>Lieber</surname><given-names>CM</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>He</surname><given-names>Z</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Single-Cell Profiles of Retinal Neurons Differing in Resilience to Injury Reveal Neuroprotective Genes</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/711762</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsai</surname><given-names>NY</given-names></name><name><surname>Wang</surname><given-names>F</given-names></name><name><surname>Toma</surname><given-names>K</given-names></name><name><surname>Yin</surname><given-names>C</given-names></name><name><surname>Takatoh</surname><given-names>J</given-names></name><name><surname>Pai</surname><given-names>EL</given-names></name><name><surname>Wu</surname><given-names>K</given-names></name><name><surname>Matcham</surname><given-names>AC</given-names></name><name><surname>Yin</surname><given-names>L</given-names></name><name><surname>Dang</surname><given-names>EJ</given-names></name><name><surname>Marciano</surname><given-names>DK</given-names></name><name><surname>Rubenstein</surname><given-names>JL</given-names></name><name><surname>Wang</surname><given-names>F</given-names></name><name><surname>Ullian</surname><given-names>EM</given-names></name><name><surname>Duan</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Trans-Seq maps a selective mammalian retinotectal synapse instructed by nephronectin</article-title><source>Nature Neuroscience</source><volume>25</volume><fpage>659</fpage><lpage>674</lpage><pub-id pub-id-type="doi">10.1038/s41593-022-01068-8</pub-id><pub-id pub-id-type="pmid">35524141</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turner</surname><given-names>NL</given-names></name><name><surname>Macrina</surname><given-names>T</given-names></name><name><surname>Bae</surname><given-names>JA</given-names></name><name><surname>Yang</surname><given-names>R</given-names></name><name><surname>Wilson</surname><given-names>AM</given-names></name><name><surname>Schneider-Mizell</surname><given-names>C</given-names></name><name><surname>Lee</surname><given-names>K</given-names></name><name><surname>Lu</surname><given-names>R</given-names></name><name><surname>Wu</surname><given-names>J</given-names></name><name><surname>Bodor</surname><given-names>AL</given-names></name><name><surname>Bleckert</surname><given-names>AA</given-names></name><name><surname>Brittain</surname><given-names>D</given-names></name><name><surname>Froudarakis</surname><given-names>E</given-names></name><name><surname>Dorkenwald</surname><given-names>S</given-names></name><name><surname>Collman</surname><given-names>F</given-names></name><name><surname>Kemnitz</surname><given-names>N</given-names></name><name><surname>Ih</surname><given-names>D</given-names></name><name><surname>Silversmith</surname><given-names>WM</given-names></name><name><surname>Zung</surname><given-names>J</given-names></name><name><surname>Zlateski</surname><given-names>A</given-names></name><name><surname>Tartavull</surname><given-names>I</given-names></name><name><surname>Yu</surname><given-names>S-C</given-names></name><name><surname>Popovych</surname><given-names>S</given-names></name><name><surname>Mu</surname><given-names>S</given-names></name><name><surname>Wong</surname><given-names>W</given-names></name><name><surname>Jordan</surname><given-names>CS</given-names></name><name><surname>Castro</surname><given-names>M</given-names></name><name><surname>Buchanan</surname><given-names>J</given-names></name><name><surname>Bumbarger</surname><given-names>DJ</given-names></name><name><surname>Takeno</surname><given-names>M</given-names></name><name><surname>Torres</surname><given-names>R</given-names></name><name><surname>Mahalingam</surname><given-names>G</given-names></name><name><surname>Elabbady</surname><given-names>L</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Cobos</surname><given-names>E</given-names></name><name><surname>Zhou</surname><given-names>P</given-names></name><name><surname>Suckow</surname><given-names>S</given-names></name><name><surname>Becker</surname><given-names>L</given-names></name><name><surname>Paninski</surname><given-names>L</given-names></name><name><surname>Polleux</surname><given-names>F</given-names></name><name><surname>Reimer</surname><given-names>J</given-names></name><name><surname>Tolias</surname><given-names>AS</given-names></name><name><surname>Reid</surname><given-names>RC</given-names></name><name><surname>da Costa</surname><given-names>NM</given-names></name><name><surname>Seung</surname><given-names>HS</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Reconstruction of neocortex: organelles, compartments, cells, circuits, and activity</article-title><source>Cell</source><volume>185</volume><fpage>1082</fpage><lpage>1100</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2022.01.023</pub-id><pub-id pub-id-type="pmid">35216674</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Varadan</surname><given-names>V</given-names></name><name><surname>Miller</surname><given-names>DM</given-names></name><name><surname>Anastassiou</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Computational inference of the molecular logic for synaptic connectivity in <italic>C. elegans</italic></article-title><source>Bioinformatics</source><volume>22</volume><fpage>e497</fpage><lpage>e506</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btl224</pub-id><pub-id pub-id-type="pmid">16873513</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Velmeshev</surname><given-names>D</given-names></name><name><surname>Schirmer</surname><given-names>L</given-names></name><name><surname>Jung</surname><given-names>D</given-names></name><name><surname>Haeussler</surname><given-names>M</given-names></name><name><surname>Perez</surname><given-names>Y</given-names></name><name><surname>Mayer</surname><given-names>S</given-names></name><name><surname>Bhaduri</surname><given-names>A</given-names></name><name><surname>Goyal</surname><given-names>N</given-names></name><name><surname>Rowitch</surname><given-names>DH</given-names></name><name><surname>Kriegstein</surname><given-names>AR</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Single-cell genomics identifies cell type-specific molecular changes in autism</article-title><source>Science</source><volume>364</volume><fpage>685</fpage><lpage>689</lpage><pub-id pub-id-type="doi">10.1126/science.aav8130</pub-id><pub-id pub-id-type="pmid">31097668</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>T</given-names></name><name><surname>Brovman</surname><given-names>YM</given-names></name><name><surname>Madhvanath</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Personalized Embedding-Based e-Commerce Recommendations at eBay</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/2102.06156">https://arxiv.org/abs/2102.06156</ext-link></element-citation></ref><ref id="bib90"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yao</surname><given-names>Z</given-names></name><name><surname>van Velthoven</surname><given-names>CTJ</given-names></name><name><surname>Nguyen</surname><given-names>TN</given-names></name><name><surname>Goldy</surname><given-names>J</given-names></name><name><surname>Sedeno-Cortes</surname><given-names>AE</given-names></name><name><surname>Baftizadeh</surname><given-names>F</given-names></name><name><surname>Bertagnolli</surname><given-names>D</given-names></name><name><surname>Casper</surname><given-names>T</given-names></name><name><surname>Chiang</surname><given-names>M</given-names></name><name><surname>Crichton</surname><given-names>K</given-names></name><name><surname>Ding</surname><given-names>SL</given-names></name><name><surname>Fong</surname><given-names>O</given-names></name><name><surname>Garren</surname><given-names>E</given-names></name><name><surname>Glandon</surname><given-names>A</given-names></name><name><surname>Gouwens</surname><given-names>NW</given-names></name><name><surname>Gray</surname><given-names>J</given-names></name><name><surname>Graybuck</surname><given-names>LT</given-names></name><name><surname>Hawrylycz</surname><given-names>MJ</given-names></name><name><surname>Hirschstein</surname><given-names>D</given-names></name><name><surname>Kroll</surname><given-names>M</given-names></name><name><surname>Lathia</surname><given-names>K</given-names></name><name><surname>Lee</surname><given-names>C</given-names></name><name><surname>Levi</surname><given-names>B</given-names></name><name><surname>McMillen</surname><given-names>D</given-names></name><name><surname>Mok</surname><given-names>S</given-names></name><name><surname>Pham</surname><given-names>T</given-names></name><name><surname>Ren</surname><given-names>Q</given-names></name><name><surname>Rimorin</surname><given-names>C</given-names></name><name><surname>Shapovalova</surname><given-names>N</given-names></name><name><surname>Sulc</surname><given-names>J</given-names></name><name><surname>Sunkin</surname><given-names>SM</given-names></name><name><surname>Tieu</surname><given-names>M</given-names></name><name><surname>Torkelson</surname><given-names>A</given-names></name><name><surname>Tung</surname><given-names>H</given-names></name><name><surname>Ward</surname><given-names>K</given-names></name><name><surname>Dee</surname><given-names>N</given-names></name><name><surname>Smith</surname><given-names>KA</given-names></name><name><surname>Tasic</surname><given-names>B</given-names></name><name><surname>Zeng</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>A taxonomy of transcriptomic cell types across the isocortex and hippocampal formation</article-title><source>Cell</source><volume>184</volume><fpage>3222</fpage><lpage>3241</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2021.04.021</pub-id><pub-id pub-id-type="pmid">34004146</pub-id></element-citation></ref><ref id="bib91"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yao</surname><given-names>Z</given-names></name><name><surname>van Velthoven</surname><given-names>CTJ</given-names></name><name><surname>Kunst</surname><given-names>M</given-names></name><name><surname>Zhang</surname><given-names>M</given-names></name><name><surname>McMillen</surname><given-names>D</given-names></name><name><surname>Lee</surname><given-names>C</given-names></name><name><surname>Jung</surname><given-names>W</given-names></name><name><surname>Goldy</surname><given-names>J</given-names></name><name><surname>Abdelhak</surname><given-names>A</given-names></name><name><surname>Aitken</surname><given-names>M</given-names></name><name><surname>Baker</surname><given-names>K</given-names></name><name><surname>Baker</surname><given-names>P</given-names></name><name><surname>Barkan</surname><given-names>E</given-names></name><name><surname>Bertagnolli</surname><given-names>D</given-names></name><name><surname>Bhandiwad</surname><given-names>A</given-names></name><name><surname>Bielstein</surname><given-names>C</given-names></name><name><surname>Bishwakarma</surname><given-names>P</given-names></name><name><surname>Campos</surname><given-names>J</given-names></name><name><surname>Carey</surname><given-names>D</given-names></name><name><surname>Casper</surname><given-names>T</given-names></name><name><surname>Chakka</surname><given-names>AB</given-names></name><name><surname>Chakrabarty</surname><given-names>R</given-names></name><name><surname>Chavan</surname><given-names>S</given-names></name><name><surname>Chen</surname><given-names>M</given-names></name><name><surname>Clark</surname><given-names>M</given-names></name><name><surname>Close</surname><given-names>J</given-names></name><name><surname>Crichton</surname><given-names>K</given-names></name><name><surname>Daniel</surname><given-names>S</given-names></name><name><surname>DiValentin</surname><given-names>P</given-names></name><name><surname>Dolbeare</surname><given-names>T</given-names></name><name><surname>Ellingwood</surname><given-names>L</given-names></name><name><surname>Fiabane</surname><given-names>E</given-names></name><name><surname>Fliss</surname><given-names>T</given-names></name><name><surname>Gee</surname><given-names>J</given-names></name><name><surname>Gerstenberger</surname><given-names>J</given-names></name><name><surname>Glandon</surname><given-names>A</given-names></name><name><surname>Gloe</surname><given-names>J</given-names></name><name><surname>Gould</surname><given-names>J</given-names></name><name><surname>Gray</surname><given-names>J</given-names></name><name><surname>Guilford</surname><given-names>N</given-names></name><name><surname>Guzman</surname><given-names>J</given-names></name><name><surname>Hirschstein</surname><given-names>D</given-names></name><name><surname>Ho</surname><given-names>W</given-names></name><name><surname>Hooper</surname><given-names>M</given-names></name><name><surname>Huang</surname><given-names>M</given-names></name><name><surname>Hupp</surname><given-names>M</given-names></name><name><surname>Jin</surname><given-names>K</given-names></name><name><surname>Kroll</surname><given-names>M</given-names></name><name><surname>Lathia</surname><given-names>K</given-names></name><name><surname>Leon</surname><given-names>A</given-names></name><name><surname>Li</surname><given-names>S</given-names></name><name><surname>Long</surname><given-names>B</given-names></name><name><surname>Madigan</surname><given-names>Z</given-names></name><name><surname>Malloy</surname><given-names>J</given-names></name><name><surname>Malone</surname><given-names>J</given-names></name><name><surname>Maltzer</surname><given-names>Z</given-names></name><name><surname>Martin</surname><given-names>N</given-names></name><name><surname>McCue</surname><given-names>R</given-names></name><name><surname>McGinty</surname><given-names>R</given-names></name><name><surname>Mei</surname><given-names>N</given-names></name><name><surname>Melchor</surname><given-names>J</given-names></name><name><surname>Meyerdierks</surname><given-names>E</given-names></name><name><surname>Mollenkopf</surname><given-names>T</given-names></name><name><surname>Moonsman</surname><given-names>S</given-names></name><name><surname>Nguyen</surname><given-names>TN</given-names></name><name><surname>Otto</surname><given-names>S</given-names></name><name><surname>Pham</surname><given-names>T</given-names></name><name><surname>Rimorin</surname><given-names>C</given-names></name><name><surname>Ruiz</surname><given-names>A</given-names></name><name><surname>Sanchez</surname><given-names>R</given-names></name><name><surname>Sawyer</surname><given-names>L</given-names></name><name><surname>Shapovalova</surname><given-names>N</given-names></name><name><surname>Shepard</surname><given-names>N</given-names></name><name><surname>Slaughterbeck</surname><given-names>C</given-names></name><name><surname>Sulc</surname><given-names>J</given-names></name><name><surname>Tieu</surname><given-names>M</given-names></name><name><surname>Torkelson</surname><given-names>A</given-names></name><name><surname>Tung</surname><given-names>H</given-names></name><name><surname>Valera Cuevas</surname><given-names>N</given-names></name><name><surname>Vance</surname><given-names>S</given-names></name><name><surname>Wadhwani</surname><given-names>K</given-names></name><name><surname>Ward</surname><given-names>K</given-names></name><name><surname>Levi</surname><given-names>B</given-names></name><name><surname>Farrell</surname><given-names>C</given-names></name><name><surname>Young</surname><given-names>R</given-names></name><name><surname>Staats</surname><given-names>B</given-names></name><name><surname>Wang</surname><given-names>MQM</given-names></name><name><surname>Thompson</surname><given-names>CL</given-names></name><name><surname>Mufti</surname><given-names>S</given-names></name><name><surname>Pagan</surname><given-names>CM</given-names></name><name><surname>Kruse</surname><given-names>L</given-names></name><name><surname>Dee</surname><given-names>N</given-names></name><name><surname>Sunkin</surname><given-names>SM</given-names></name><name><surname>Esposito</surname><given-names>L</given-names></name><name><surname>Hawrylycz</surname><given-names>MJ</given-names></name><name><surname>Waters</surname><given-names>J</given-names></name><name><surname>Ng</surname><given-names>L</given-names></name><name><surname>Smith</surname><given-names>K</given-names></name><name><surname>Tasic</surname><given-names>B</given-names></name><name><surname>Zhuang</surname><given-names>X</given-names></name><name><surname>Zeng</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2023">2023a</year><article-title>A high-resolution transcriptomic and spatial atlas of cell types in the whole mouse brain</article-title><source>Nature</source><volume>624</volume><fpage>317</fpage><lpage>332</lpage><pub-id pub-id-type="doi">10.1038/s41586-023-06812-z</pub-id><pub-id pub-id-type="pmid">38092916</pub-id></element-citation></ref><ref id="bib92"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yao</surname><given-names>S</given-names></name><name><surname>Wang</surname><given-names>Q</given-names></name><name><surname>Hirokawa</surname><given-names>KE</given-names></name><name><surname>Ouellette</surname><given-names>B</given-names></name><name><surname>Ahmed</surname><given-names>R</given-names></name><name><surname>Bomben</surname><given-names>J</given-names></name><name><surname>Brouner</surname><given-names>K</given-names></name><name><surname>Casal</surname><given-names>L</given-names></name><name><surname>Caldejon</surname><given-names>S</given-names></name><name><surname>Cho</surname><given-names>A</given-names></name><name><surname>Dotson</surname><given-names>NI</given-names></name><name><surname>Daigle</surname><given-names>TL</given-names></name><name><surname>Egdorf</surname><given-names>T</given-names></name><name><surname>Enstrom</surname><given-names>R</given-names></name><name><surname>Gary</surname><given-names>A</given-names></name><name><surname>Gelfand</surname><given-names>E</given-names></name><name><surname>Gorham</surname><given-names>M</given-names></name><name><surname>Griffin</surname><given-names>F</given-names></name><name><surname>Gu</surname><given-names>H</given-names></name><name><surname>Hancock</surname><given-names>N</given-names></name><name><surname>Howard</surname><given-names>R</given-names></name><name><surname>Kuan</surname><given-names>L</given-names></name><name><surname>Lambert</surname><given-names>S</given-names></name><name><surname>Lee</surname><given-names>EK</given-names></name><name><surname>Luviano</surname><given-names>J</given-names></name><name><surname>Mace</surname><given-names>K</given-names></name><name><surname>Maxwell</surname><given-names>M</given-names></name><name><surname>Mortrud</surname><given-names>MT</given-names></name><name><surname>Naeemi</surname><given-names>M</given-names></name><name><surname>Nayan</surname><given-names>C</given-names></name><name><surname>Ngo</surname><given-names>NK</given-names></name><name><surname>Nguyen</surname><given-names>T</given-names></name><name><surname>North</surname><given-names>K</given-names></name><name><surname>Ransford</surname><given-names>S</given-names></name><name><surname>Ruiz</surname><given-names>A</given-names></name><name><surname>Seid</surname><given-names>S</given-names></name><name><surname>Swapp</surname><given-names>J</given-names></name><name><surname>Taormina</surname><given-names>MJ</given-names></name><name><surname>Wakeman</surname><given-names>W</given-names></name><name><surname>Zhou</surname><given-names>T</given-names></name><name><surname>Nicovich</surname><given-names>PR</given-names></name><name><surname>Williford</surname><given-names>A</given-names></name><name><surname>Potekhina</surname><given-names>L</given-names></name><name><surname>McGraw</surname><given-names>M</given-names></name><name><surname>Ng</surname><given-names>L</given-names></name><name><surname>Groblewski</surname><given-names>PA</given-names></name><name><surname>Tasic</surname><given-names>B</given-names></name><name><surname>Mihalas</surname><given-names>S</given-names></name><name><surname>Harris</surname><given-names>JA</given-names></name><name><surname>Cetin</surname><given-names>A</given-names></name><name><surname>Zeng</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2023">2023b</year><article-title>A whole-brain monosynaptic input connectome to neuron classes in mouse visual cortex</article-title><source>Nature Neuroscience</source><volume>26</volume><fpage>350</fpage><lpage>364</lpage><pub-id pub-id-type="doi">10.1038/s41593-022-01219-x</pub-id><pub-id pub-id-type="pmid">36550293</pub-id></element-citation></ref><ref id="bib93"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>Y</given-names></name><name><surname>Wang</surname><given-names>W</given-names></name><name><surname>Feng</surname><given-names>Z</given-names></name><name><surname>Xue</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>A dual augmented two-tower model for online large-scale recommendation</data-title><version designator="Version 4">Version 4</version><source>Github</source><ext-link ext-link-type="uri" xlink:href="https://dlp-kdd.github.io/assets/pdf/DLP-KDD_2021_paper_4.pdf">https://dlp-kdd.github.io/assets/pdf/DLP-KDD_2021_paper_4.pdf</ext-link></element-citation></ref><ref id="bib94"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zeng</surname><given-names>H</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Neuronal cell-type classification: challenges, opportunities and the path forward</article-title><source>Nature Reviews. Neuroscience</source><volume>18</volume><fpage>530</fpage><lpage>546</lpage><pub-id pub-id-type="doi">10.1038/nrn.2017.85</pub-id><pub-id pub-id-type="pmid">28775344</pub-id></element-citation></ref><ref id="bib95"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zeng</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>What is a cell type and how to define it?</article-title><source>Cell</source><volume>185</volume><fpage>2739</fpage><lpage>2755</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2022.06.031</pub-id><pub-id pub-id-type="pmid">35868277</pub-id></element-citation></ref><ref id="bib96"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Kim</surname><given-names>IJ</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name><name><surname>Meister</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The most numerous ganglion cell type of the mouse retina is a selective feature detector</article-title><source>PNAS</source><volume>109</volume><fpage>E2391</fpage><lpage>E2398</lpage><pub-id pub-id-type="doi">10.1073/pnas.1211547109</pub-id><pub-id pub-id-type="pmid">22891316</pub-id></element-citation></ref><ref id="bib97"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>A</given-names></name><name><surname>Jin</surname><given-names>L</given-names></name><name><surname>Yao</surname><given-names>S</given-names></name><name><surname>Matsuyama</surname><given-names>M</given-names></name><name><surname>van Velthoven</surname><given-names>C</given-names></name><name><surname>Sullivan</surname><given-names>H</given-names></name><name><surname>Sun</surname><given-names>N</given-names></name><name><surname>Kellis</surname><given-names>M</given-names></name><name><surname>Tasic</surname><given-names>B</given-names></name><name><surname>Wickersham</surname><given-names>IR</given-names></name><name><surname>Chen</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Rabies Virus-Based Barcoded Neuroanatomy Resolved by Single-Cell RNA and in Situ Sequencing</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2023.03.16.532873</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.91532.3.sa0</article-id><title-group><article-title>eLife assessment</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Nelson</surname><given-names>Sacha B</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution>Brandeis University</institution><country>United States</country></aff></contrib></contrib-group><kwd-group kwd-group-type="claim-importance"><kwd>Important</kwd></kwd-group><kwd-group kwd-group-type="evidence-strength"><kwd>Solid</kwd></kwd-group></front-stub><body><p>This is an <bold>important</bold> computational study that applies the machine learning method of bilinear modeling to the problem of relating gene expression to connectivity. Specifically, the author attempts to use transcriptomic data from mouse retinal neurons to predict their known connectivity with promising results. On revision, the approach was tested against a second data set from <italic>C. elegans</italic>. A limited number of genes studied in this second dataset may have resulted in performance that matched but did not exceed prior models. However, taken together, the results were felt to provide <bold>solid</bold> evidence for the value of the approach.</p></body></sub-article><sub-article article-type="referee-report" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.91532.3.sa1</article-id><title-group><article-title>Reviewer #1 (Public Review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>In this study, the author aimed to develop a method for estimating neuronal-type connectivity from transcriptomic gene expression data. They sought to develop an interpretable model that could be used to characterize the underlying genetic mechanisms of circuit assembly and connectivity in various neuronal systems.</p><p>Strengths:</p><p>Many of the proposed suggestions were addressed by the author from the initial review. In general the claims made by the author are more strongly supported by the data and better situated in the literature. A major improvement includes the application of the model to the <italic>C. elegans</italic> gap junction neuronal system. Despite several key differences in the dataset as compared to the mouse retina data, the proposed model performs comparably to the SCM model currently considered state of the art in the literature (the author should remain cautious about claiming better performance given extremely marginal differences). In section 7.2, the author clearly outlines additional advantages of the proposed model including superior time and space complexity. The overall model performance remains modest, but it learns the same rules as the SCM model as well as other candidate patterns.</p><p>As in the initial submission, the bilinear model recapitulates key connectivity motifs for the mouse dataset. The algorithm is shown to converge across several runs affirming its stability/replicability. The model is also extended to predict connectivity on unknown RGC-BC cell type pairs. Without ground truth, the author posits how it should perform based on known functional properties of the RGC type. The hypotheses are confirmed for 8/10 neuronal types with unknown connectivity. The author more clearly describes how this model can be used experimentally for hypothesis testing and presents a more comprehensive future roadmap regarding validation, avenues for improving the model, and incorporation of growing datasets.</p><p>Weaknesses:</p><p>While the C Elegans dataset is useful because it enables benchmarking to existing models, the dataset is quite different. The gene expression dimensionality is 18 genes as opposed to over 3000 genes in the mouse dataset. It is a strength that the model still works as intended, but a weakness that the bilinear model could not be tested on a similar mouse dataset. This distinction matters because it remains an open question if the PCA methodology would hold up in a dataset with varied distributions of gene expression. Variations of the PCA methodology could be evaluated further with the present dataset to make the generalizability of the model more convincing.</p><p>The Gene Ontology analysis requires more methodological explanation. The author claims, &quot;(the linear nature of the model) enables the direct interpretation of gene expressions by examining their associated weights in the model. These weights signify the importance of each gene in determining the connectivity motifs between the BC and RGC types.&quot; If I am correctly understanding the methods, the model weights in each dimension are indexing the importance of a gene expression feature as opposed to the importance of a single gene alone, &quot;the gene expression of the BCs in X and the RGCs in Y were featurized by their respective PCs, resulting in matrices of dimensions 22453 Ã— 11323 and 3779 Ã— 3142, respectively.&quot; It would be helpful to explain how gene weights are extracted from a gene expression feature once highlighted.</p><p>There could be a more rigorous analysis of the predictive capacity of the model even with the current data. The model recapitulates connectivity patterns from the full dataset and a prediction is demonstrated for unknown data. The model is thus championed as a useful tool for predicting how genetic modifications will influence connectivity, but this is not empirically evaluated.</p><p>Appraisal of whether the author achieved their aims, and whether results support their conclusions:</p><p>In line with the aims of the paper, the author proposed an interpretable bilinear model to learn a shared latent feature space derived from gene expression profiles to predict synaptic connectivity between various neuron types. The model was shown to generalize to two distinct neuronal systems with varying levels of genomic and cellular resolution. While the performance remains modest, the model performs comparably to the existing state of the art despite improved computational complexity.</p><p>Discussion of likely impact of the work on the field, and utility of methods and data to the community:</p><p>The author has elaborated substantially on the impact of this work, particularly how it could be leveraged in experimental settings. The clear methodology could be implemented by other researchers to test the model on new datasets and for benchmarking novel methods.</p></body></sub-article><sub-article article-type="referee-report" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.91532.3.sa2</article-id><title-group><article-title>Reviewer #2 (Public Review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>In this study, Mu Qiao employs a bilinear modelling approach, commonly utilised in the recommendation systems, to explore the intricate neural connections between different pre- and post-synaptic neuronal types. This approach involves projecting single-cell Transcriptomic datasets of pre- and post-synaptic neuronal types into a latent space through transformation matrices. Subsequently, the cross-correlation between these projected latent spaces is employed to estimate neuronal connectivity. To facilitate the model training, Connectomic data is used to estimate the ground-truth connectivity map. This work introduces a promising model for the exploration of neuronal connectivity and its associated molecular determinants. In the revised version of the manuscript, the author has applied and validated the model in both <italic>C. elegans</italic> gap junction connectivity and the retina neuron connectivity conditions.</p><p>Strengths:</p><p>This study introduces a succinct yet promising computational model for investigating connections between neuronal types. The model, while straightforward, effectively integrates single-cell transcriptomic and connectomic data to produce a reasonably accurate connectivity map, particularly within the context of retinal connectivity. Furthermore, it successfully recapitulates connectivity patterns and helps uncover the genetic factors that underlie these connections.</p><p>Weaknesses:</p><p>(1) When compared with the previous method - SCM, the new model shows a similar performance level. This may be due to the limitation of the dataset itself, as it only has the innexin expression data. Is it possible to apply the SCM model to the more complete retina dataset and compare the performance with the proposed bilinear modelling approach?</p><p>Minor Weakness:</p><p>(1) The study lacks experimental validation of the model's prediction results.</p></body></sub-article><sub-article article-type="author-comment" id="sa3"><front-stub><article-id pub-id-type="doi">10.7554/eLife.91532.3.sa3</article-id><title-group><article-title>Author response</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Qiao</surname><given-names>Mu</given-names></name><role specific-use="author">Author</role><aff><institution>LinkedIn</institution><addr-line><named-content content-type="city">Mountain View</named-content></addr-line><country>United States</country></aff></contrib></contrib-group></front-stub><body><p>The following is the authorsâ€™ response to the original reviews.</p><disp-quote content-type="editor-comment"><p><bold>eLife assessment</bold></p><p>This is a valuable computational study that applies the machine learning method of bilinear modeling to the problem of relating gene expression to connectivity. Specifically, the author attempts to use transcriptomic data from mouse retinal neurons to predict their known connectivity. The results are promising, although the reviewers felt that demonstration of the general applicability of the approach required testing it against a second data set. Hence the present results were felt to provide borderline incomplete support for a key premise of the paper.</p></disp-quote><p>We thank the reviewers for their insightful and constructive feedback. In response to the reviews, we have undertaken a comprehensive revision of our manuscript, incorporating changes and improvements as outlined below:</p><p>(1) New results have been included showcasing the application of our bilinear model to a seconddataset focusing on <italic>C. elegans</italic> gap junction connectivity. This extension validates our model with a biological context other than mouse retina and facilitates a direct comparison with the spatial connectome model (SCM).</p><p>(2) A new section titled &quot;Previous Approaches&quot; has been added to background, situating our studywithin the broader landscape of existing modeling methodologies.</p><p>(3) The discussion sections have been expanded to fully incorporate the suggestions and insightsoffered by the reviewers. This includes a deeper exploration of the implications of our findings, potential applications of our model, and a more thorough consideration of its limitations and future directions.</p><p>(4) To streamline the main text and ensure that the core narrative remains focused and accessible, select figures and tables have been relocated to the &quot;Supplementary Materials&quot; section.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer 1 (Public Review):</bold></p><p>Summary of what the author was trying to achieve: In this study, the author aimed to develop a method for estimating neuronal-type connectivity from transcriptomic gene expression data, specifically from mouse retinal neurons. They sought to develop an interpretable model that could be used to characterize the underlying genetic mechanisms of circuit assembly and connectivity.</p><p>Strengths:</p><p>The proposed bilinear model draws inspiration from commonly implemented recommendation systems in the field of machine learning. The author presents the model clearly and addresses critical statistical limitations that may weaken the validity of the model such as multicollinearity and outliers. The author presents two formulations of the model for separate scenarios in which varying levels of data resolution are available. The author effectively references key work in the field when establishing assumptions that affect the underlying model and subsequent results. For example, correspondence between gene expression cell types and connectivity cell types from different references are clearly outlined in Tables 1-3. The model training and validation are sufficient and yield a relatively high correlation with the ground truth connectivity matrix. Seemingly valid biological assumptions are made throughout, however, some assumptions may reduce resolution (such as averaging over cell types), thus missing potentially important single-cell gene expression interactions.</p></disp-quote><p>Thank you for recognizing the strengths of our work, particularly the clarity of the model presentation and its foundation in recommendation systems. In the revised manuscript we have also extended the modelâ€™s capabilities to analyze gene interactions for neural connectivity at single-cell resolution, when gene expression and connectivity of each cell are known simultaneously.</p><disp-quote content-type="editor-comment"><p>Weaknesses:</p><p>The main results of the study could benefit from replication in another dataset beyond mouse retinal neurons, to validate the proposed method. Dimensionality reduction significantly reduces the resolution of the model and the PCA methodology employed is largely non-deterministic. This may reduce the resolution and reproducibility of the model. It may be worth exploring how the PCA methodology of the model may affect results when replicating. Figure 5, â€™Gene signatures associated with the two latent dimensionsâ€™, lacks some readability and related results could be outlined more clearly in the results section. There should be more discussion on weaknesses of the results e.g. quantification of what connectivity motifs were not captured and what gene signatures might have been missed.</p></disp-quote><p>We acknowledge the significance of validating our method across different datasets. In line with this, our revised manuscript now includes an expanded analysis utilizing a <italic>C. elegans</italic> gap junction connectivity dataset, which not only broadens the methodâ€™s demonstrated applicability but also underscores its versatility across varied neuronal systems.</p><p>To address the concern of resolution and reproducibility associated with PCA preprocessing, we have conducted a comparative analysis from five replicates of the bilinear model, presenting the results in the revised manuscript (Figure S3). This analysis confirms the consistency of the solutions, as evidenced by the similarity metrics. Furthermore, we discussed alternative methodologies, such as L1 or L2 regularization, to tackle multicollinearity, offering flexibility in preprocessing choices.</p><p>In response to feedback on the original Figure 5â€™s clarity, we have replaced the original Figure 5e-h with Table S4, which summarizes the gene ontology (GO) enrichment results and quantifies the number of genes associated with aspects of neural development and synaptic organization. This revision aims to improve the interpretability and accessibility of the results, ensuring a clearer presentation of the modelâ€™s insights.</p><p>Finally, we have expanded our discussion to address the studyâ€™s limitations more comprehensively. This includes exploration of potentially missed connections and gene signatures, such as transcription factors, which might not be captured by a linear model due to its inherent preference for predictors with strong correlations to the target variable.</p><disp-quote content-type="editor-comment"><p>The main weakness is the lack of comparison against other similar methods, e.g. methods presented in BarabÃ¡si, DÃ¡niel L., and Albert-LÃ¡szlÃ³ BarabÃ¡si. &quot;A genetic model of the connectome.&quot; Neuron 105.3 (2020): 435-445. KovÃ¡cs, IstvÃ¡n A., DÃ¡niel L. BarabÃ¡si, and Albert-LÃ¡szlÃ³ BarabÃ¡si. &quot;Uncovering the genetic blueprint of the <italic>C. elegans</italic> nervous system.&quot; Proceedings of the National Academy of Sciences 117.52 (2020): 33570-33577. Taylor, Seth R., et al. &quot;Molecular topography of an entire nervous system.&quot; Cell 184.16 (2021): 4329-4347.</p></disp-quote><p>We value your suggestion to compare our model with established methods. The revised manuscript now includes a comparative analysis with the spatial connectome model (SCM) using the same <italic>C. elegans</italic> dataset. In addition, a section reviewing previous approaches has been included in the background part, and the discussion part has been extended for the comparison.</p><disp-quote content-type="editor-comment"><p>Appraisal of whether the author achieved their aims, and whether results support their conclusions: The author achieved their aims by recapitulating key connectivity motifs from single-cell gene expression data in the mouse retina. Furthermore, the model setup allowed for insight into gene signatures and interactions, however could have benefited from a deeper evaluation of the accuracy of these signatures. The author claims the method sets a new benchmark for single-cell transcriptomic analysis of synaptic connections. This should be more rigorously proven. (Iâ€™m not sure I can speak on the novelty of the method)</p></disp-quote><p>In the revised manuscript. we emphasized the bilinear modelâ€™s innovative application in the context of neuronal connectivity analysis, inspired by collaborative filtering in recommendation systems. We present quantitative performance metrics, such as the ROC-AUC score and Pearson correlation coefficient, as well as its comparison with the SCM, to benchmark our modelâ€™s efficacy in reconstructing connectivity matrices. We also quantified the overlap of the genetic interactions revealed by the bilinear model and the SCM (using the <italic>C. elegans</italic> dataset), and reported the percentage of the top genes associated with neural development and synaptic organization (using the mouse retina dataset). These numbers set a precedent for future methodological comparisons.</p><disp-quote content-type="editor-comment"><p>Discussion of the likely impact of the work on the field, and the utility of methods and data to the community : This study provides an understandable bilinear model for decoding the genetic programming of neuronal type connectivity. The proposed model leaves the door open for further testing and comparison with alternative linear and/or non-linear models, such as neural networkbased models. In addition to more complex models, this model can be built on to include higher resolution data such as more gene expression dimensions, different types of connectivity measures, and additional omics data.</p></disp-quote><p>We are grateful for your recognition of the studyâ€™s potential impact. The bilinear model indeed offers a foundation for future explorations, allowing for integration with more complex models, higher-resolution data, and diverse connectivity measures.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer 1 (Recommendations For The Authors):</bold></p><p>The inclusion of predicted connectivity (Figure 6) of unknown BC neurons is useful as it shows that this is a strong hypothesis generation tool. This utility should potentially be showcased more as it is also brought up in the abstract, &quot;genetic manipulation of circuit wiring&quot;, with an explanation of how the model could be leveraged as such. The discussion may benefit from a summarizing sentence regarding which key gene signatures were identified and are in line with the literature, which key gene signatures/connectivity motifs may have been missed, and which gene signatures are novel.</p></disp-quote><p>Thank you for the insightful recommendation on emphasizing the modelâ€™s utility in generating hypotheses, particularly regarding predicting connectivity. In the revised manuscript, we have expanded the discussion on how our model can be leveraged to guide genetic manipulations at altering circuit wiring and highlighted its potential impact in the field.</p><p>We have discussed key gene signatures identified from our model that are in line with existing literature, such as plexins and cadherins, which have been previously recognized for their involvement in synaptic connection formation and maintenance. We have also introduced potential new candidates, such as delta-protocadherins. In the revised manuscript, we summarized potentially missed gene signatures or synaptic connections, to provide a comprehensive view of our findings.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer 2 (Public Review):</bold></p><p>Summary:</p><p>In this study, Mu Qiao employs a bilinear modeling approach, commonly utilized in recommendation systems, to explore the intricate neural connections between different pre- and post-synaptic neuronal types. This approach involves projecting single-cell transcriptomic datasets of pre- and post-synaptic neuronal types into a latent space through transformation matrices. Subsequently, the cross-correlation between these projected latent spaces is employed to estimate neuronal connectivity. To facilitate the model training, connectomic data is used to estimate the ground-truth connectivity map. This work introduces a promising model for the exploration of neuronal connectivity and its associated molecular determinants. However, it is important to note that the current model has only been tested with Bipolar Cell and Retinal Ganglion Cell data, and its applicability in more general neuronal connectivity scenarios remains to be demonstrated.</p><p>Strengths:</p><p>This study introduces a succinct yet promising computational model for investigating connections between neuronal types. The model, while straightforward, effectively integrates singlecell transcriptomic and connectomic data to produce a reasonably accurate connectivity map, particularly within the context of retinal connectivity. Furthermore, it successfully recapitulates connectivity patterns and helps uncover the genetic factors that underlie these connections.</p></disp-quote><p>Thank you for your positive assessment of the paper.</p><disp-quote content-type="editor-comment"><p>Weaknesses:</p><p>(1) The study lacks experimental validation of the modelâ€™s prediction results.</p></disp-quote><p>We recognize the importance of experimental validation in substantiating the predictions made by computational models. While the primary focus of this study remains computational, we have dedicated a section in the revised manuscript, titled &quot;Experimental Validation of Candidate Genes&quot;, to outline proposed methodologies for the empirical verification of our modelâ€™s predictions. This section specifically discusses the experimental exploration of novel candidate genes, such as deltaprotocadherins, within the mouse retina using AAV-mediated CRISPR/Cas9 genetic manipulation. We plan to collaborate with experimental laboratories to facilitate the validation. Given the extensive nature of experimental work, both in terms of time and resources, it is more pragmatic to present a comprehensive experimental investigation in a follow-up study.</p><disp-quote content-type="editor-comment"><p>(2) The modelâ€™s applicability in other neuronal connectivity settings has not been thoroughly explored.</p></disp-quote><p>The question of the modelâ€™s broader applicability is well-taken. In response, we have expanded our analysis to include additional neuronal data and connectivity settings. Specifically, the revised manuscript includes results where we apply the model to a dataset of <italic>C. elegans</italic> gap junction connectivity, demonstrating its potential in different neuronal systems. This extension serves to illustrate the modelâ€™s adaptability and potential applicability to a broader range of neuronal connectivity studies.</p><disp-quote content-type="editor-comment"><p>(3) The proposed method relies on the availability of neuronal connectomic data for model training,which may be limited or absent in certain brain connectivity settings.</p></disp-quote><p>We acknowledge the limitations posed by the modelâ€™s dependency on comprehensive connectomic data, which may not be readily available across all research contexts. To address this, we have discussed in the revised manuscript several alternative strategies to adapt our model to the available data. This includes exploring the potential of applying the model to available data such as projectome, and integrating other data modalities such as electrophysiological measurements. These initiatives aim to enhance the modelâ€™s applicability and ensure its utility in a broader spectrum of brain connectivity studies, especially in scenarios where detailed connectomic data are not available.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer 2 (Recommendations For The Authors):</bold></p><p>Q1. In this work, the author has mainly been studying the retina neuronal type connectivity, it will be interesting to see whether the model works for other brain regions or other neuronal type connectivity as well.</p></disp-quote><p>We value your interest in the modelâ€™s applicability to other brain regions and neuronal types. To address this, we have extended our analysis in the revised manuscript to include a study on gap junction connectivity between <italic>C. elegans</italic> neurons. This extension demonstrates the modelâ€™s versatility and its potential applicability across various nervous systems and connectivity types.</p><disp-quote content-type="editor-comment"><p>Q2. Whether the authors can use the same transformation matrices trained from the retina data to predict neuronal connectivity in other brain regions? Or an easier case, the connectivity between RGC types to the neuronal types in SC, dLGN, or other post-RGC-synaptic brain regions. As the neuronal connection mechanisms are conserved and widely shared between different neuronal types, one would expect the same transformation matrices may work in predicting other neuronal type connectivity as well (at least to some extent).</p></disp-quote><p>The idea to use the same transformation matrices for predicting connectivity in other brain regions is intriguing. While direct application of these matrices to different regions remains challenging, we discussed the potential scalability of our model to other brain areas. By applying the model to combined datasets from various regions, we could uncover conserved neuronal connection mechanisms. This approach is theoretically feasible and is supported by the demonstrated scalability of the bilinear model and its deep learning variants in industrial applications.</p><disp-quote content-type="editor-comment"><p>Q3. Section 5.2 Connectivity metric generation: in this work, the author uses the stratification profiles of the neurons to estimate the connectivity metric, how reliable this method is? There will be a scenario where though two neuronal types project to a similar inner plexiform layer, they may not have any connection. Have the authors considered combining other experimental data (like electrophysiology data or neuron tracing data)?</p></disp-quote><p>We discussed the reliability of using stratification profiles for estimating connectivity metrics, acknowledging potential limitations. In the revised manuscript, we added discussion on how the integration of additional experimental data, such as electrophysiological and neuron tracing data, could enhance the accuracy of the connectivity metrics.</p><disp-quote content-type="editor-comment"><p>Q4. Section 6 Model training and validation: does the author have a potential hypothesis as to why 2 dimensions are the best latent feature spaces dimensionality? One would imagine with more dimensionality, the model will give better results. Could it be that the connectivity data that is used to train the model is only considering the two-dimensional space of the neuronal stratification?</p></disp-quote><p>The selection of two dimensions for the latent feature space was informed by 5-fold cross-validation, aimed at optimizing model generalization to unseen data. Here while increasing dimensionality improves performance on the training set, it does not necessarily enhance generalization to the validation set. Thus, the choice of two dimensions ensures good performance without overfitting to the training data.</p><disp-quote content-type="editor-comment"><p>Q5. Could the author provide the source code for the analysis? Or could the author make it a python/R package so that non-computational biologists can easily apply the method to their own data?</p></disp-quote><p>We have included a &quot;Data and Code Availability&quot; section in the revised manuscript. This section provides a link to the source code with pointers to datasets used in our study, facilitating the application of our methods by researchers from various backgrounds.</p><disp-quote content-type="editor-comment"><p>Q6. I know it may be difficult for the author to do, but is it possible to design and perform some experiments to validate the model prediction results, either connectivity partners of transcriptomicallydefined RGC types or the function of the key genetic molecules (which hasnâ€™t been discovered before)? The author may consider collaborating with some experimental labs. The author may even consider predicting the connectivity between RGC with some of its post-synaptic neurons in the brain regions, like SC or dLGN, as recently there are a lot of single-cell sequencing data as well as connectivity data.</p></disp-quote><p>We appreciate your suggestion regarding experimental validation. As a future direction, we have discussed potential experimental approaches to validate the modelâ€™s predictions in the &quot;Experimental Validation of Candidate Genes&quot; section. Specifically, we propose an experimental design involving the manipulation of delta-protocadherins using AAV-mediated CRISPR/Cas9 and subsequent examination of connectivity phenotypes. We are also open to collaborating with experimental labs to further explore the modelâ€™s predictions, particularly in predicting connectivity between RGCs and their post-synaptic neurons in other brain regions.</p></body></sub-article></article>