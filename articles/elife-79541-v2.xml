<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.2"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">79541</article-id><article-id pub-id-type="doi">10.7554/eLife.79541</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Emergence of time persistence in a data-driven neural network model</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" id="author-162735"><name><surname>Wolf</surname><given-names>Sebastien</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9394-3291</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-279834"><name><surname>Le Goc</surname><given-names>Guillaume</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6946-1142</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-291375"><name><surname>Debrégeas</surname><given-names>Georges</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3698-4497</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib2">‡</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-300160"><name><surname>Cocco</surname><given-names>Simona</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1852-7789</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib2">‡</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-276913"><name><surname>Monasson</surname><given-names>Rémi</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4459-0204</contrib-id><email>remi.monasson@phys.ens.fr</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib2">‡</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02en5vm52</institution-id><institution>Laboratory of Physics of the Ecole Normale Supérieure, CNRS UMR 8023 &amp; PSL Research, Sorbonne Université, Université de Paris</institution></institution-wrap><addr-line><named-content content-type="city">Paris</named-content></addr-line><country>France</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02en5vm52</institution-id><institution>Institut de Biologie Paris-Seine (IBPS), Laboratoire Jean Perrin, Sorbonne Université, CNRS</institution></institution-wrap><addr-line><named-content content-type="city">Paris</named-content></addr-line><country>France</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Sharpee</surname><given-names>Tatyana O</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03xez1567</institution-id><institution>Salk Institute for Biological Studies</institution></institution-wrap><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Gold</surname><given-names>Joshua I</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00b30xv10</institution-id><institution>University of Pennsylvania</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn><fn fn-type="con" id="equal-contrib2"><label>‡</label><p>These authors also contributed equally to this work</p></fn></author-notes><pub-date publication-format="electronic" date-type="publication"><day>14</day><month>03</month><year>2023</year></pub-date><pub-date pub-type="collection"><year>2023</year></pub-date><volume>12</volume><elocation-id>e79541</elocation-id><history><date date-type="received" iso-8601-date="2022-04-17"><day>17</day><month>04</month><year>2022</year></date><date date-type="accepted" iso-8601-date="2023-03-13"><day>13</day><month>03</month><year>2023</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at .</event-desc><date date-type="preprint" iso-8601-date="2022-02-04"><day>04</day><month>02</month><year>2022</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2022.02.02.478841"/></event></pub-history><permissions><copyright-statement>© 2023, Wolf, Le Goc, Debrégeas et al</copyright-statement><copyright-year>2023</copyright-year><copyright-holder>Wolf, Le Goc, Debrégeas et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-79541-v2.pdf"/><abstract><p>Establishing accurate as well as interpretable models of network activity is an open challenge in systems neuroscience. Here, we infer an energy-based model of the anterior rhombencephalic turning region (ARTR), a circuit that controls zebrafish swimming statistics, using functional recordings of the spontaneous activity of hundreds of neurons. Although our model is trained to reproduce the low-order statistics of the network activity at short time scales, its simulated dynamics quantitatively captures the slowly alternating activity of the ARTR. It further reproduces the modulation of this persistent dynamics by the water temperature and visual stimulation. Mathematical analysis of the model unveils a low-dimensional landscape-based representation of the ARTR activity, where the slow network dynamics reflects Arrhenius-like barriers crossings between metastable states. Our work thus shows how data-driven models built from large neural populations recordings can be reduced to low-dimensional functional models in order to reveal the fundamental mechanisms controlling the collective neuronal dynamics.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>neural persistence</kwd><kwd>metastable state</kwd><kwd>Ising model</kwd><kwd>dimensional reduction</kwd><kwd>zebrafish</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Zebrafish</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001665</institution-id><institution>Agence Nationale de la Recherche</institution></institution-wrap></funding-source><award-id>Locomat</award-id><principal-award-recipient><name><surname>Monasson</surname><given-names>Rémi</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A data-driven model of the neural activity of a circuit essential to swimming orientation in zebrafish can be mathematically interpreted to unveil the dynamical mechanism leading to persistence in tail orientation.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>How computational capacities emerge from the collective neural dynamics within large circuits is a prominent question in neuroscience. Modeling efforts have long been based on top-down approaches, in which mathematical models are designed to replicate basic functions. Although they might be very fruitful from a conceptual viewpoint, these models are unable to accurately reproduce actual data and thus remain speculative. Recently, progress in large-scale recording and simulation techniques has led to the development of bottom-up approaches. Machine-learning models, trained on recorded activity, allow for the decoding or the prediction of neuronal activity and behavior (<xref ref-type="bibr" rid="bib15">Glaser et al., 2020</xref>; <xref ref-type="bibr" rid="bib40">Pandarinath et al., 2018</xref>). Unfortunately, the blackbox nature of these data-driven models often obscures their biological interpretation, for example, the identification of the relevant computational units (<xref ref-type="bibr" rid="bib7">Butts, 2019</xref>). This calls for quantitative, yet interpretable approaches to illuminate the functions carried out by large neural populations and their neuronal substrate.</p><p>This work is an attempt to do so in the specific context of the anterior rhombencephalic turning region (ARTR), a circuit in the zebrafish larva that drives the saccadic dynamics and orchestrates the chaining of leftward/rightward swim bouts (<xref ref-type="bibr" rid="bib1">Ahrens et al., 2013</xref>; <xref ref-type="bibr" rid="bib12">Dunn et al., 2016</xref>; <xref ref-type="bibr" rid="bib63">Wolf et al., 2017</xref>; <xref ref-type="bibr" rid="bib46">Ramirez and Aksay, 2021</xref>; <xref ref-type="bibr" rid="bib26">Leyden et al., 2021</xref>). The ARTR spontaneous activity exhibits temporal persistence, that is, the maintenance of activity patterns over long (∼ 10 s) time scales. This functional feature is ubiquitous in the vertebrate brain. It plays an essential role in motor control, as best exemplified by the velocity position neural integrator, a circuit that integrates neural inputs and allows for a maintenance of the eye position after an ocular saccade (<xref ref-type="bibr" rid="bib50">Seung, 1996</xref>; <xref ref-type="bibr" rid="bib51">Seung et al., 2000</xref>; <xref ref-type="bibr" rid="bib35">Miri et al., 2011</xref>). Temporal persistence is also central to action selection (<xref ref-type="bibr" rid="bib61">Wang, 2008</xref>) and short-term memory storage (<xref ref-type="bibr" rid="bib65">Zaksas and Pasternak, 2006</xref>; <xref ref-type="bibr" rid="bib16">Guo et al., 2017</xref>). As isolated neurons generally display short relaxation times, neural persistence is thought to be an emergent property of recurrent circuit architectures (<xref ref-type="bibr" rid="bib66">Zylberberg and Strowbridge, 2017</xref>). Since the 1970s, numerous mechanistic network models have been proposed that display persistent activity. They are designed such as to possess attractor states, that is, stable activity patterns toward which the network spontaneously converges.</p><p>Although attractor models are conceptually appealing, assessing their relevance in biological circuits remains challenging. To this aim, recent advances in machine learning combined with large-scale methods of neural recordings may offer a promising avenue. We hereafter focus on energy-based network models, trained to replicate low-order data statistics, such as the mean activities and pairwise correlations, through the maximum entropy principle (<xref ref-type="bibr" rid="bib18">Jaynes, 1957</xref>). In neuroscience, such models have been successfully used to explain correlation structures in many areas, including the retina (<xref ref-type="bibr" rid="bib49">Schneidman et al., 2006</xref>; <xref ref-type="bibr" rid="bib9">Cocco et al., 2009</xref>; <xref ref-type="bibr" rid="bib56">Tkačik et al., 2015</xref>), the cortex (<xref ref-type="bibr" rid="bib54">Tavoni et al., 2016</xref>; <xref ref-type="bibr" rid="bib55">Tavoni et al., 2017</xref>; <xref ref-type="bibr" rid="bib38">Nghiem et al., 2018</xref>), and the hippocampus (<xref ref-type="bibr" rid="bib32">Meshulam et al., 2017</xref>; <xref ref-type="bibr" rid="bib43">Posani et al., 2017</xref>) of vertebrates, and the nervous system of <italic>Caenorhabditis elegans</italic> (<xref ref-type="bibr" rid="bib8">Chen et al., 2019</xref>). These models are generative, that is, they can be used to produce synthetic activity on short time scales, but whether they can reproduce long-time dynamical features of the biological networks remains an open question.</p><p>Here, we first report on spontaneous activity recordings of the ARTR network using light-sheet functional imaging at various yet ethologically relevant temperatures. These data demonstrate that the water temperature controls the persistence time scale of the ARTR network, and that this modulation is in quantitative agreement with the thermal dependence of the swimming statistics. We then infer energy-based models from the calcium activity recordings and show how these data-driven models not only capture the characteristics and probabilities of occurrence of activity patterns, but also reproduce the observed thermal dependence of the persistent time scale. We further derive a mathematically tractable version of our energy-based model, called mean-field approximation, whose resolution provides a physical interpretation of the energy landscape, of the dynamical paths there in, and of their changes with temperature. We finally extend the model to incorporate visual stimulation and correctly reproduce the previously reported visually driven ARTR dynamics (<xref ref-type="bibr" rid="bib63">Wolf et al., 2017</xref>). This work establishes the capacity of data-driven network inference to numerically emulate persistent dynamics and to unveil fundamental network features controlling such dynamics.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>The water temperature controls behavioral and neuronal persistence time scales in zebrafish larvae</title><p>In this first section, we report on functional recordings of the ARTR dynamics performed at various temperatures (18–33°C). We show that the persistent time scale that characterizes the ARTR’s endogenous dynamics is thermally modulated. This dependence is reflected in the change in swimming statistics observed in freely swimming assays. We further characterize how the water temperature impacts the distribution of activity patterns.</p><sec id="s2-1-1"><title>ARTR endogeneous dynamics is thermally modulated</title><p>We used light-sheet functional imaging to record the ARTR activity in zebrafish larvae expressing a calcium reporter pan-neuronally (<italic>Tg(elavl3:GCaMP6</italic>)). The larvae, embedded in agarose, were placed in a water tank whose temperature was controlled in the range 18–33°C (see <xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1A</xref>). ARTR neurons were identified using a combination of morphological and functional criteria, as detailed in <xref ref-type="bibr" rid="bib63">Wolf et al., 2017</xref>. Their spatial organization is displayed in <xref ref-type="fig" rid="fig1">Figure 1A</xref>, for all recorded animals after morphological registration on a unique reference brain (145 ± 65 left neurons, 165 ± 69 right neurons, mean ± SD across 13 different fish, see <xref ref-type="table" rid="app2table1">Appendix 2—table 1</xref>). For each neuron, an approximate spike train <inline-formula><mml:math id="inf1"><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> was inferred from the fluorescence signal using Bayesian deconvolution (<xref ref-type="bibr" rid="bib58">Tubiana et al., 2020</xref>). A typical raster plot of the ARTR is shown in <xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1B</xref> (recorded at 26°C), together with the mean signals of the left and right subcircuits, <inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Temperature dependence of anterior rhombencephalic turning region (ARTR) dynamics and turn direction persistence.</title><p>(<bold>A</bold>) Morphological organization of the ARTR showing all identified neurons from 13 fish recorded with light-sheet calcium imaging. (<bold>B</bold>) Example of ARTR binarized signal sign (<inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) (gray) along with the left (<inline-formula><mml:math id="inf4"><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula>, red) and right (<inline-formula><mml:math id="inf5"><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula>, blue) mean activities. (<bold>C</bold>) Averaged power spectra of the ARTR binarized signals for the five tested temperatures. The dotted vertical lines indicate the signal switching frequencies <inline-formula><mml:math id="inf6"><mml:mi>ν</mml:mi></mml:math></inline-formula> as extracted from the Lorentzian fit (solid lines). (<bold>D</bold>) Temperature dependence of <inline-formula><mml:math id="inf7"><mml:mi>ν</mml:mi></mml:math></inline-formula>. The lines join data points obtained with the same larva. (<bold>E</bold>) Swimming patterns in zebrafish larvae. Swim bouts are categorized into forward and turn bouts based on the amplitude of the heading reorientation. Example trajectory: each dot corresponds to a swim bout; the color encodes the reorientation angle. (<bold>F</bold>) The bouts are discretized as left/forward/right bouts. The continuous binary signal represents the putative orientational state governing the chaining of the turn bouts. (<bold>G</bold>) Power spectra of the discretized orientational signal averaged over all animals for each temperature (dots). Each spectrum is fitted by a Lorentzian function (solid lines) from which we extract the switching rate <inline-formula><mml:math id="inf8"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>l</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>i</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. (<bold>H</bold>) Temperature dependence of <inline-formula><mml:math id="inf9"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>l</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>i</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. Inset: relationship between <inline-formula><mml:math id="inf10"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>l</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>i</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (behavioral) and <inline-formula><mml:math id="inf11"><mml:mi>ν</mml:mi></mml:math></inline-formula> (neuronal) switching frequencies. Bar sizes represent SEM, and the dashed line is the linear fit.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79541-fig1-v2.tif"/></fig><p>To analyze the thermal dependence of the ARTR dynamics, we extracted from these recordings a binarized ARTR signal, <inline-formula><mml:math id="inf12"><mml:mrow><mml:mtext>sign</mml:mtext><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="120%" minsize="120%">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo maxsize="120%" minsize="120%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (see <xref ref-type="fig" rid="fig1">Figure 1B</xref> and <xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1C</xref> for example signals from the same fish at different temperatures). The average power spectra of these signals for the five tested temperatures (average of 3–8 animals for each temperature, see <xref ref-type="table" rid="app2table1">Appendix 2—table 1</xref>) are shown in <xref ref-type="fig" rid="fig1">Figure 1C</xref>. We used a Lorentzian fit to further extract the alternation frequency <inline-formula><mml:math id="inf13"><mml:mi>ν</mml:mi></mml:math></inline-formula> for each dataset (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, solid lines). This frequency was found to increase with the temperature (<xref ref-type="fig" rid="fig1">Figure 1D</xref>). Although <inline-formula><mml:math id="inf14"><mml:mi>ν</mml:mi></mml:math></inline-formula> could significantly vary across specimen at a given temperature, for a given animal, increasing the temperature induced an increase in the frequency in 87.5% of our recordings (28 out of 32 pairs of recordings).</p><p>In this analysis, we used the binarized ARTR activity to facilitate the comparison between behavioral and neural data, as described in the next section. However, the observed temperature dependence of the left-right alternation time scale was preserved when the spectra were computed from the ARTR activity, <inline-formula><mml:math id="inf15"><mml:mrow><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> (see <xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1D</xref>).</p></sec><sec id="s2-1-2"><title>Impact of the water temperature on the turn direction persistence in freely swimming larvae</title><p>It has previously been shown that the ARTR governs the selection of swim bout orientations: turn bouts are preferentially executed in the direction of the most active (right or left) ARTR subcircuit (<xref ref-type="bibr" rid="bib12">Dunn et al., 2016</xref>; <xref ref-type="bibr" rid="bib63">Wolf et al., 2017</xref>), such that <inline-formula><mml:math id="inf16"><mml:mrow><mml:mtext>sign</mml:mtext><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="120%" minsize="120%">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo maxsize="120%" minsize="120%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> constitutes a robust predictor of the turning direction of the animal; see Figure 5 - figure supplement 2E in <xref ref-type="bibr" rid="bib12">Dunn et al., 2016</xref>. Therefore, the temporal persistence of the ARTR dynamics is reflected in a turn direction persistence in the animal’s swimming pattern, that is, the preferred chaining of similarly orientated turn bouts.</p><p>We thus sought to examine whether the thermal dependence of the ARTR endogenous dynamics could manifest itself in the animal navigational statistics. In order to do so, we used the results of a recent study (<xref ref-type="bibr" rid="bib24">Le Goc et al., 2021</xref>), in which 5–7-day-old zebrafish larvae were video-monitored as they swam freely at constant and uniform temperature in the same thermal range (<xref ref-type="fig" rid="fig1">Figure 1E</xref>). We quantified the time scale of the turn direction persistence by assigning a discrete value to each turn bout: −1 for a right turn, +1 for a left turn (forward scouts were ignored). We then computed an orientational state signal continuously defined by the value of the last turn bout (<xref ref-type="fig" rid="fig1">Figure 1F</xref>). The power spectra of the resulting binary signals are shown in <xref ref-type="fig" rid="fig1">Figure 1G</xref> for various temperatures. We used a Lorentzian fit (‘Materials and methods,’ <xref ref-type="disp-formula" rid="equ6">Equation 6</xref>) to extract, for each experiment, a frequency <inline-formula><mml:math id="inf17"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. This rate, which defines the probability of switching orientation per unit of time, systematically increases with the temperature, from 0.1 to 0.6 s<sup>−1</sup> (<xref ref-type="fig" rid="fig1">Figure 1H</xref>). Increasing the temperature thus leads to a progressive reduction of the turn direction persistence time. The inset plot in <xref ref-type="fig" rid="fig1">Figure 1H</xref> establishes that the left/right alternation rates extracted from behavioral and neuronal recordings are consistent across the entire temperature range (slope = 0.81, <inline-formula><mml:math id="inf18"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mn>0.99</mml:mn></mml:mrow></mml:math></inline-formula>).</p></sec><sec id="s2-1-3"><title>ARTR activity maps are modulated by the temperature</title><p>We then investigated how the water temperature impacts the statistics of the ARTR activity defined by the mean activity of the left and right sub-populations, <inline-formula><mml:math id="inf19"><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf20"><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula>. The probability maps in the <inline-formula><mml:math id="inf21"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> plane are shown in <xref ref-type="fig" rid="fig2">Figure 2A</xref> for two different temperatures, with the corresponding raster plots and time signals of the two subcircuits. At high temperature, the ARTR activity map is confined within an L-shaped region around <inline-formula><mml:math id="inf22"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and the circuit remains inactive for a large fraction of the time. Conversely, at lower temperature, the ARTR activity is characterized by long periods during which both circuits are active and shorter periods of inactivity. We quantified this thermal dependence of the activity distribution by computing the log-probability of the activity of either region of the ARTR at various temperatures (<xref ref-type="fig" rid="app2fig2">Appendix 2—figure 2A</xref>). The occupation rate of the inactive state (<inline-formula><mml:math id="inf23"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) increases with temperature, with a corresponding steeper decay of the probability distribution of the activity. Consistently, we found that the mean activities <inline-formula><mml:math id="inf24"><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf25"><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula> decreased with temperature (<xref ref-type="fig" rid="app2fig2">Appendix 2—figure 2B</xref>). Such a dependence might reflect varying levels of temporal coherence in the activity of the ARTR with the temperature. In order to test this, we computed the Pearson correlation at various temperature but we saw no clear dependency of the average correlation across ipsilateral or contralateral pairs of neurons (<xref ref-type="fig" rid="app2fig2">Appendix 2—figure 2C</xref>).</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Ising models reproduce characteristic features of the recorded activity.</title><p>(<bold>A</bold>) (Top) Probability densities <inline-formula><mml:math id="inf26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, see Equation 2, of the activity state of the circuit (obtained from the spiking inference of the calcium data), in logarithmic scale, and for two different fish and water temperatures <italic>T</italic> = 20 and <italic>T</italic> = 30°C; Color encodes z-axis (same color bar for both). (Middle) 10-min-long raster plots of the activities of the left (red) and right (blue) subregions of the anterior rhombencephalic turning region (ARTR). (Bottom) Corresponding time traces of the mean activities <inline-formula><mml:math id="inf27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. (<bold>B</bold>) Processing pipeline for the inference of the Ising model. We first extract from the recorded fluorescence signals approximate spike trains using a Bayesian deconvolution algorithm (BSD). The activity of each neuron is then ‘0’ or ‘1.’ We then compute the mean activity and the pairwise covariance of the data, from which we infer the parameters <inline-formula><mml:math id="inf29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> of the Ising model. Finally, we can generate raster plot of activity using Monte Carlo sampling. (<bold>C</bold>) Same as (<bold>A</bold>) for the two corresponding inferred Ising models. The raster plots correspond to Monte Carlo-sampled activity, showing slow alternance between periods of high activity in the L/R regions. Here we show only two examples of a qualitative experimental vs. synthetic signals comparison. We provide in the supplementary materials the same comparison for every recording.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79541-fig2-v2.tif"/></fig><p>Our analysis thus indicates that the water temperature modulates both the endogenous dynamics and the activity distribution of the ARTR. For both aspects, we noticed a large variability between animals at a given temperature. This is not unexpected as it parallels the intra- and inter-individual variability in the fish exploratory kinematics reported in <xref ref-type="bibr" rid="bib24">Le Goc et al., 2021</xref>. Nevertheless, we observed a strong positive correlation between the persistence time and the mean activity across animals and trials for a given temperature (<xref ref-type="fig" rid="app2fig2">Appendix 2—figure 2D</xref> and ‘Materials and methods’), indicating that both features of the ARTR may have a common drive.</p></sec></sec><sec id="s2-2"><title>A data-driven energy-based model reproduces the statistics of the ARTR dynamics</title><p>Our aim was to reproduce the ARTR spontaneous activity using an energy-based data-driven network model. The inference pipeline, going from raw fluorescence data to the model, is summarized in <xref ref-type="fig" rid="fig2">Figure 2B</xref>. We first reconstructed an estimated spike train for each ARTR neuron using a deconvolution algorithm (<xref ref-type="bibr" rid="bib58">Tubiana et al., 2020</xref>). We divided the recording window (<inline-formula><mml:math id="inf31"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mn>1200</mml:mn><mml:mtext> </mml:mtext><mml:mrow/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> for each session) in time bins whose width was set by the imaging frame rate (<inline-formula><mml:math id="inf32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mn>300</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>). Each dataset thus consisted of a series of snapshots <inline-formula><mml:math id="inf33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="bold">s</mml:mi><mml:mrow><mml:mi mathvariant="bold">k</mml:mi></mml:mrow></mml:msup><mml:mo mathvariant="bold">=</mml:mo><mml:mo mathvariant="bold" stretchy="false">(</mml:mo></mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> of the ARTR activity at times <inline-formula><mml:math id="inf34"><mml:mi>k</mml:mi></mml:math></inline-formula>, with <inline-formula><mml:math id="inf35"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>; here, <inline-formula><mml:math id="inf36"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> if cell <inline-formula><mml:math id="inf37"><mml:mi>i</mml:mi></mml:math></inline-formula> is active or <inline-formula><mml:math id="inf38"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> if it is silent in time bin <inline-formula><mml:math id="inf39"><mml:mi>k</mml:mi></mml:math></inline-formula>.</p><p>We then computed the mean activities, <inline-formula><mml:math id="inf40"><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mtext>data</mml:mtext></mml:msub></mml:math></inline-formula>, and the pairwise correlations, <inline-formula><mml:math id="inf41"><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mtext>data</mml:mtext></mml:msub></mml:math></inline-formula>, as the averages of, respectively, <inline-formula><mml:math id="inf42"><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf43"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> over all time bins <inline-formula><mml:math id="inf44"><mml:mi>k</mml:mi></mml:math></inline-formula>. We next inferred the least constrained model, according to the maximum entropy principle (<xref ref-type="bibr" rid="bib18">Jaynes, 1957</xref>), that reproduced these quantities. This model, known as the Ising model in statistical mechanics (<xref ref-type="bibr" rid="bib28">Ma, 1985</xref>) and probabilistic graphical model in statistical inference (<xref ref-type="bibr" rid="bib22">Koller and Friedmann, 2009</xref>), describes the probability distribution over all <inline-formula><mml:math id="inf45"><mml:msup><mml:mn>2</mml:mn><mml:mi>N</mml:mi></mml:msup></mml:math></inline-formula> possible activity configurations <inline-formula><mml:math id="inf46"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>,<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>Z</mml:mi></mml:mfrac><mml:mspace width="thickmathspace"/><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf47"><mml:mi>Z</mml:mi></mml:math></inline-formula> is a normalization constant. The bias <inline-formula><mml:math id="inf48"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> controls the intrinsic activity of neuron <inline-formula><mml:math id="inf49"><mml:mi>i</mml:mi></mml:math></inline-formula>, while the coupling parameters <inline-formula><mml:math id="inf50"><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> account for the effect of the other neurons <inline-formula><mml:math id="inf51"><mml:mi>j</mml:mi></mml:math></inline-formula> activity on neuron <inline-formula><mml:math id="inf52"><mml:mi>i</mml:mi></mml:math></inline-formula> (‘Materials and methods’). The set of parameters <inline-formula><mml:math id="inf53"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> were inferred using the Adaptative Cluster Expansion and the Boltzmann machine algorithms (<xref ref-type="bibr" rid="bib10">Cocco and Monasson, 2011</xref>; <xref ref-type="bibr" rid="bib3">Barton and Cocco, 2013</xref>; <xref ref-type="bibr" rid="bib4">Barton et al., 2016</xref>). Notice that in <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>, the energy term in the parenthesis is not scaled by a thermal energy as in the Maxwell–Boltzmann statistics. We thus implicitly fix the model temperature to unity; of course, this model temperature has no relation with the water temperature <inline-formula><mml:math id="inf54"><mml:mi>T</mml:mi></mml:math></inline-formula>. Although the model was trained to reproduce the mean activities and pairwise correlations (see <xref ref-type="fig" rid="app2fig3">Appendix 2—figure 3A–C</xref> and ‘Materials and methods’ for fourfold cross-validation), it further captured higher-order statistical properties of the activity such as the probability that <inline-formula><mml:math id="inf55"><mml:mi>K</mml:mi></mml:math></inline-formula> cells are active in a time bin (<xref ref-type="fig" rid="app2fig3">Appendix 2—figure 3D</xref>; <xref ref-type="bibr" rid="bib49">Schneidman et al., 2006</xref>).</p><p>Once inferred, the Ising model can be used to generate synthetic activity configurations <inline-formula><mml:math id="inf56"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Here, we used a Monte Carlo (MC) algorithm to sample the probability distribution <inline-formula><mml:math id="inf57"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>. The algorithm starts from a random configuration of activity, then picks up uniformly at random a neuron index, say, <inline-formula><mml:math id="inf58"><mml:mi>i</mml:mi></mml:math></inline-formula>. The activity <inline-formula><mml:math id="inf59"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> of neuron <inline-formula><mml:math id="inf60"><mml:mi>i</mml:mi></mml:math></inline-formula> is then stochastically updated to 0 or to 1, with probabilities that depend on the current states <inline-formula><mml:math id="inf61"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> of the other neurons (see <xref ref-type="disp-formula" rid="equ8">Equation 8</xref> in ‘Materials and methods’ and code provided). The sampling procedure is iterated, ensuring convergence toward the distribution <inline-formula><mml:math id="inf62"><mml:mi>P</mml:mi></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>. This in silico MC dynamics is not supposed to reproduce any realistic neural dynamics, except for the locality in the activity configuration <inline-formula><mml:math id="inf63"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> space.</p><p><xref ref-type="fig" rid="fig2">Figure 2C</xref> shows the synthetic activity maps and temporal traces of Ising models trained on the two same datasets as in <xref ref-type="fig" rid="fig2">Figure 2A</xref>. For these synthetic signals, we use MC rounds, that is, the number of MC steps divided by the total number of neurons (‘Materials and methods’), as a proxy for time. Remarkably, although the Ising model is trained to reproduce the low-order statistics of the neuronal activity within a time bin only, the generated signals exhibit the main characteristics of the ARTR dynamics, that is, a slow alternation between the left and right subpopulations associated with long persistence times; see raster plots in <xref ref-type="fig" rid="fig2">Figure 2C</xref>.</p><sec id="s2-2-1"><title>Comparison of experimental and synthetic ARTR dynamics across recordings</title><p>We repeated the inference procedure described above for all our 32 recordings (carried out with <inline-formula><mml:math id="inf64"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>13</mml:mn></mml:mrow></mml:math></inline-formula> fish and 5 different water temperatures, see <xref ref-type="table" rid="app2table2">Appendix 2—table 2</xref>) and obtained the same number of sets of biases and couplings. We first compared the distributions of the left-right mean activity <inline-formula><mml:math id="inf65"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf66"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> extracted from the data and from the Ising model. In order to do so, we used the Kullback–Leibler (KL) divergence, a classical metrics of the dissimilarity between two probability distributions. The distribution of the KL divergences between the experimental test datasets (see ‘Materials and methods’) and their associated Ising models is shown in green in <xref ref-type="fig" rid="fig3">Figure 3A</xref>. The KL values were found to be much smaller than those obtained between experimental test datasets and Ising models trained from different recordings (red distribution). This result establishes that the Ising model quantitatively reproduces the ARTR activity distribution associated to each specimen and temperature.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Comparison of model distributions and persistence times across fish and water temperatures.</title><p>(<bold>A</bold>) Distribution of the Kullback–Leibler divergences between test datasets and their corresponding Ising models (green), between test datasets and Ising models trained on different datasets (red) and between test datasets and their corresponding independent models that assume no connections between neurons (dark blue). Note that each dataset is divided in a training set corresponding to 75% of the time bins chosen randomly and a test set comprising the remaining 25%. (<bold>B</bold>) Average persistence times in simulations vs. experiments. Each dot refers to one fish at one water temperature; colors encode temperature.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79541-fig3-v2.tif"/></fig><p>This agreement crucially relies on the presence of inter-neuronal couplings in order to reproduce the pairwise correlations in the activity: a model with no connection (i.e., the independent model, see ‘Materials and methods’) fitted to reproduce the neural firing rates offers a very poor description of the data (see <xref ref-type="fig" rid="fig3">Figure 3A</xref> [dark blue distribution] and <xref ref-type="fig" rid="app2fig3">Appendix 2—figure 3E–G</xref>).</p><p>Finally, we examined to what extent the synthetic data could capture the neural persistence characteristics of the ARTR. The persistence times extracted from the data and from the MC simulations of the inferred models were found to be strongly correlated (<xref ref-type="fig" rid="fig3">Figure 3B</xref>, <inline-formula><mml:math id="inf67"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mn>0.84</mml:mn></mml:mrow></mml:math></inline-formula>). The MC dynamics thus captures the inter-individual variability and temperature dependence of the ARTR persistent dynamics.</p></sec><sec id="s2-2-2"><title>Spatial organization and temperature dependence of the Ising inferred parameters</title><p>In all recordings, inferred ipsilateral couplings are found to be centered around a positive value (std = 0.12, mean = 0.062), while contralateral couplings are distributed around 0 (mean = –0.001, std = 0.10); see <xref ref-type="fig" rid="app2fig4">Appendix 2—figure 4A–C</xref>. Still, a significant fraction of these contralateral couplings are strongly negative. We illustrated this point by computing the fraction of neuronal pairs (<inline-formula><mml:math id="inf68"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula>) that are contralateral for each value of the coupling <inline-formula><mml:math id="inf69"><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> or the Pearson correlation (<xref ref-type="fig" rid="app2fig4">Appendix 2—figure 4D and E</xref>). Large negative values of couplings or correlations systematically correspond to contralateral pairs of neurons, whereas large positive values correspond to ipsilateral pairs of neurons.</p><p>In addition, we found that the ipsilateral couplings <inline-formula><mml:math id="inf70"><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> decay, on average, exponentially with the distance between neurons <inline-formula><mml:math id="inf71"><mml:mi>i</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf72"><mml:mi>j</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="app2fig4">Appendix 2—figure 4F</xref>), in agreement with findings in other neural systems (<xref ref-type="bibr" rid="bib44">Posani et al., 2018</xref>). Spatial structure is also present in contralateral couplings (<xref ref-type="fig" rid="app2fig4">Appendix 2—figure 4G</xref>). Biases display a wide distribution ranging from –8 to 0 (std = 1.1, mean = –4.1, <xref ref-type="fig" rid="app2fig5">Appendix 2—figure 5A–C</xref>), with no apparent spatial structure.</p><p>We next examined the dependency of the Ising model parameters on the water temperature. To do so, for each fish, we selected two different water temperatures, and the corresponding sets of inferred biases and couplings, <inline-formula><mml:math id="inf73"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>. We then computed the Pearson correlation coefficient <inline-formula><mml:math id="inf74"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> of the biases and of the coupling matrices at these two temperatures (inset of <xref ref-type="fig" rid="app2fig6">Appendix 2—figure 6</xref>). We saw no clear correlation between the model parameters at different temperatures, as shown by the distribution of <inline-formula><mml:math id="inf75"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> computed across fish and across every temperatures (<xref ref-type="fig" rid="app2fig6">Appendix 2—figure 6</xref>).</p></sec></sec><sec id="s2-3"><title>Mean-field study of the inferred model unveils the energy landscape underlying the ARTR dynamics</title><sec id="s2-3-1"><title>Mean-field approximation to the data-driven graphical model</title><p>While our data-driven Ising model reproduces the dependence of the persistence time scale and activity distribution on the water temperature, why it does so remains unclear. To understand what features of the coupling and local bias parameters govern these network functional properties, we turn to mean-field theory. This powerful and mathematically tractable approximation scheme is commonly used in statistical physics to study systems with many strongly interacting components (<xref ref-type="bibr" rid="bib28">Ma, 1985</xref>). In the present case, it amounts to deriving self-consistent equations for the mean activities <inline-formula><mml:math id="inf76"><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf77"><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula> of the left and right ARTR subpopulations (<xref ref-type="fig" rid="fig4">Figure 4A</xref> and Appendix 1).</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Mean-field approximation of the inferred Ising model.</title><p>(<bold>A</bold>) Schematic view of the mean-field Ising model. (<bold>B</bold>) Examples of simulated <inline-formula><mml:math id="inf78"><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf79"><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula> signals of the mean-field dynamical equations for two sets of parameters that correspond to fish ID #5 at two water temperatures (22°C and 30°C), see <xref ref-type="table" rid="app2table2">Appendix 2—table 2</xref>. (<bold>C</bold>) Free-energy landscapes in the (<inline-formula><mml:math id="inf80"><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula>,<inline-formula><mml:math id="inf81"><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula>) plane computed with the mean-field model. These data correspond to the same sets of parameters as in panel (<bold>B</bold>). Colored circles denote metastable states, and the line of black arrows indicates the optimal path between <inline-formula><mml:math id="inf82"><mml:mrow><mml:mo mathvariant="normal" stretchy="false">(</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>o</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo mathvariant="normal">,</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>o</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo mathvariant="normal" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf83"><mml:mrow><mml:mo mathvariant="normal" stretchy="false">(</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>o</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>,<inline-formula><mml:math id="inf84"><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>i</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>g</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msup><mml:mo mathvariant="normal" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> states. (<bold>D</bold>) Schematic view of the free energy along the <inline-formula><mml:math id="inf85"><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula> axes. The arrows denote the energy barriers <inline-formula><mml:math id="inf86"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></inline-formula><inline-formula><mml:math id="inf87"><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi></mml:math></inline-formula> associated with the various transitions. The dark green arrow denotes <inline-formula><mml:math id="inf88"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">→</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>; the purple arrow denotes <inline-formula><mml:math id="inf89"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">→</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. (<bold>E</bold>) Values of the free-energy barriers as a function of temperature. Error bars are standard error of the mean (32 recordings, n = 13 fish at 5 different water temperatures). (<bold>F</bold>) Persistence time of the mean-field anterior rhombencephalic turning region (ARTR) model for all fish and runs at different experimental temperatures. Each dot refers to one fish at one temperature; colors encode temperature.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79541-fig4-v2.tif"/></fig><p>Within mean-field theory, each neuron <inline-formula><mml:math id="inf90"><mml:mi>i</mml:mi></mml:math></inline-formula> is subject to (i) a local bias <inline-formula><mml:math id="inf91"><mml:mi>H</mml:mi></mml:math></inline-formula>, (ii) an excitatory coupling <inline-formula><mml:math id="inf92"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>J</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> from the neurons in the ipsilateral region, and (iii) a weak coupling <inline-formula><mml:math id="inf93"><mml:mi>I</mml:mi></mml:math></inline-formula> from the neurons in the contralateral side. These three parameters were set as the mean values of, respectively, the inferred biases <inline-formula><mml:math id="inf94"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and the inferred ipsilateral and contralateral interactions <inline-formula><mml:math id="inf95"><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. In addition, we introduce an effective size <inline-formula><mml:math id="inf96"><mml:mi>K</mml:mi></mml:math></inline-formula> of each region to take into account the fact that mean-field theory overestimates interactions by replacing them with their mean value. This effective number of neurons was chosen, in practice, to best match the results of the mean-field approach to the full Ising model predictions (see Appendix 1, <xref ref-type="table" rid="app2table2">Appendix 2—table 2</xref> and <xref ref-type="fig" rid="app2fig7">Appendix 2—figure 7A–C</xref>). It was substantially smaller than the number <inline-formula><mml:math id="inf97"><mml:mi>N</mml:mi></mml:math></inline-formula> of recorded neurons. The selection method used to delineate the ARTR populations may yield different number of neurons in the <inline-formula><mml:math id="inf98"><mml:mi>L</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf99"><mml:mi>R</mml:mi></mml:math></inline-formula> regions (see <xref ref-type="table" rid="app2table1">Appendix 2—table 1</xref>). This asymmetry was accounted for by allowing the parameters <inline-formula><mml:math id="inf100"><mml:mi>H</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf101"><mml:mi>J</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf102"><mml:mi>K</mml:mi></mml:math></inline-formula> defined above to take different values for the left and right sides.</p><p>Mean-field theory thus allowed us to reduce the data-driven Ising model, whose definition requires <inline-formula><mml:math id="inf103"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> parameters <inline-formula><mml:math id="inf104"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo rspace="7.5pt">,</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>, to a model depending on seven parameters (<inline-formula><mml:math id="inf105"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula>) only (<xref ref-type="fig" rid="fig4">Figure 4A</xref>), whose values vary with the animal and the experimental conditions, for example, temperature (<xref ref-type="table" rid="app2table2">Appendix 2—table 2</xref>).</p></sec><sec id="s2-3-2"><title>Free energy and Langevin dynamics</title><p>The main outcome of the analytical treatment of the model is the derivation of the so-called free energy <inline-formula><mml:math id="inf106"><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as a function of the average activities <inline-formula><mml:math id="inf107"><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf108"><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula>; see Appendix 1. The free energy is a fundamental quantity as it controls the density of probability to observe an activation pattern <inline-formula><mml:math id="inf109"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> through<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula></p><p>Consequently, the lower the free energy <inline-formula><mml:math id="inf110"><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi></mml:math></inline-formula>, the higher the probability of the corresponding state <inline-formula><mml:math id="inf111"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. In particular, the minima of the free energy define persistent states of activity in which the network can be transiently trapped.</p><p>The free energy landscape can be used to simulate dynamical trajectories in the activity space <inline-formula><mml:math id="inf112"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. To do so, we consider a Langevin dynamics in which the two activities <inline-formula><mml:math id="inf113"><mml:mrow><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> evolve in time according to the stochastic differential equations,<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mi>τ</mml:mi><mml:mspace width="thinmathspace"/><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mi>τ</mml:mi><mml:mspace width="thinmathspace"/><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf114"><mml:mi>τ</mml:mi></mml:math></inline-formula> is a microscopic time scale, and <inline-formula><mml:math id="inf115"><mml:mrow><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> are white noise ‘forces’, <inline-formula><mml:math id="inf116"><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, independent and delta-correlated in time: <inline-formula><mml:math id="inf117"><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf118"><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mn>2</mml:mn></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. This Langevin dynamical process ensures that all activity configurations <inline-formula><mml:math id="inf119"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> will be sampled in the course of time, with the expected probability as given by <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>.</p><p><xref ref-type="fig" rid="fig4">Figure 4B</xref> shows the mean-field simulated dynamics of the left and right activities, <inline-formula><mml:math id="inf120"><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf121"><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula>, with the parameters corresponding to two Ising models at two different temperatures in <xref ref-type="fig" rid="fig2">Figure 2C</xref>. We observe, at low temperatures, transient periods of self-sustained activity (denoted by <inline-formula><mml:math id="inf122"><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>) of one subcircuit, while the other has low activity (<inline-formula><mml:math id="inf123"><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>) (see time trace 1 in <xref ref-type="fig" rid="fig4">Figure 4B</xref>). At high temperature, high activity in either (left or right) area can be reached only transiently (see trace 2 in <xref ref-type="fig" rid="fig4">Figure 4B</xref>). These time traces are qualitatively similar to the ones obtained with the full inferred Ising model and in the data (<xref ref-type="fig" rid="fig2">Figure 2A and C</xref>, bottom).</p></sec><sec id="s2-3-3"><title>Barriers in the free-energy landscape and dynamical paths between states</title><p>We show in <xref ref-type="fig" rid="fig4">Figure 4C</xref> the free-energy landscape in the <inline-formula><mml:math id="inf124"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> plane for the same two conditions as in <xref ref-type="fig" rid="fig4">Figure 4B</xref>. The minimization conditions <inline-formula><mml:math id="inf125"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> provide two implicit equations over the activities <inline-formula><mml:math id="inf126"><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mi>L</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mi>R</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> corresponding to the preferred states. For most datasets, we found four local minima: the low-activity minimum <inline-formula><mml:math id="inf127"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mi>L</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mi>R</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, two asymmetric minima, <inline-formula><mml:math id="inf128"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf129"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, in which only one subregion is strongly active, and a state in which both regions are active, <inline-formula><mml:math id="inf130"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The low-activity minimum <inline-formula><mml:math id="inf131"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the state of lowest free energy, hence with largest probability, while the high-activity state <inline-formula><mml:math id="inf132"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> has a much higher free energy and much lower probability. The free energies of the asymmetric minima <inline-formula><mml:math id="inf133"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf134"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> lie in between, and their values strongly vary with the temperature.</p><p>The Langevin dynamics defines the most likely paths (see ‘Materials and methods’) in the activity plane joining one preferred state to another, for example, from <inline-formula><mml:math id="inf135"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf136"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> as shown in <xref ref-type="fig" rid="fig4">Figure 4C</xref>. Along these optimal paths, the free energy <inline-formula><mml:math id="inf137"><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi></mml:math></inline-formula> reaches local maxima, defining barriers to be overcome in order for the network to dynamically switchover (purple and green arrows in <xref ref-type="fig" rid="fig4">Figure 4C</xref>). The theory of activated processes stipulates that the average time to cross a barrier depends exponentially on its height <inline-formula><mml:math id="inf138"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∼</mml:mo><mml:mrow><mml:mi>τ</mml:mi><mml:mo>×</mml:mo><mml:mpadded width="+5pt"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi></mml:mrow></mml:msup></mml:mpadded></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>up to proportionality factors of the order of unity (<xref ref-type="bibr" rid="bib23">Langer, 1969</xref>). Thus, the barrier <inline-formula><mml:math id="inf139"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">→</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> shown in dark green in <xref ref-type="fig" rid="fig4">Figure 4D</xref> controls the time needed for the ARTR to escape the state in which the left region is active while the right region is mostly silent, and to reach the all-low state. The barrier <inline-formula><mml:math id="inf140"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> shown in purple is related to the rising time from the low-low activity state to the state where the right region is active, and the left one is silent.</p><p>Within mean-field theory, we estimated the dependence in temperature of these barriers height (<xref ref-type="fig" rid="fig4">Figure 4E</xref> and <xref ref-type="fig" rid="app2fig7">Appendix 2—figure 7D</xref>) and of the associated persistence times (<xref ref-type="fig" rid="fig4">Figure 4F</xref>). While substantial variations from animal to animal were observed, we found that barriers for escaping the all-low state and switching to either <inline-formula><mml:math id="inf141"><mml:mrow><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:math></inline-formula> region increase with the water temperature. As a consequence, at high temperature, only the low–low activity state is accessible in practice to the system, and the mean activity remains low (see <xref ref-type="fig" rid="app2fig2">Appendix 2—figure 2D</xref>), with fluctuations within the low–low state. Conversely, at low water temperatures, barriers separating the low–low and the active high–low or low–high states are weaker, so the latter become accessible. As a first consequence, the mean activity is higher at low temperature (<xref ref-type="fig" rid="app2fig2">Appendix 2—figure 2D</xref>). Furthermore, the system remains trapped for some time in such an active state before switching to the other side, for example, from high–low to low–high. This is the origin of the longer persistence time observed at low temperature.</p></sec></sec><sec id="s2-4"><title>Ising and mean-field models with modified biases capture the ARTR visually driven dynamics</title><p>While the analyses above focused on the spontaneous dynamics of the ARTR, our data-driven approach is also capable of explaining activity changes induced by external and time-varying inputs. In order to illustrate this capacity, we decided to reanalyze a series of experiments, reported in <xref ref-type="bibr" rid="bib63">Wolf et al., 2017</xref>, in which we alternatively illuminated the left and right eyes of the larva, for periods of 15–30 s, while monitoring the activity of the ARTR (<xref ref-type="fig" rid="fig5">Figure 5A</xref>) with a two-photon light-sheet microscope. During and after each stimulation protocol, 855 s of spontaneous activity was recorded on <inline-formula><mml:math id="inf142"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula> fish. We found that the ARTR activity could be driven by this alternating unilateral visual stimulation: the right side of the ARTR tended to activate when the right eye was stimulated and vice versa (<xref ref-type="fig" rid="fig5">Figure 5B</xref>).</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Modified Ising model captures the behavior of anterior rhombencephalic turning region (ARTR) under visual stimulation.</title><p>(<bold>A</bold>) Scheme of the stimulation protocol. The left and right eyes are stimulated alternatively for periods of 15–30 s, after which a period of spontaneous (no stimulus) activity is acquired. (<bold>B</bold>) Example of the ARTR activity signals under alternated left–right visual stimulation. The small arrows indicate the direction of the stimulus. (<bold>C</bold>) Sketch of the modified Ising model, with additional biases <inline-formula><mml:math id="inf143"><mml:mrow><mml:mi>δ</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> to account for the local visual inputs. (<bold>D</bold>) Values of the additional biases averaged over the ipsilateral and contralateral (with respect to the illuminated eye) neural populations. n = 6 fish. (<bold>E</bold>) Monte Carlo activity traces generated with the modified Ising model. (<bold>F</bold>) Free-energy landscapes computed with the mean-field theory during spontaneous (left panel) and stimulated (right panel) activity for an example fish. (<bold>G</bold>) Free-energy along the optimal path as a function of <inline-formula><mml:math id="inf144"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo mathvariant="normal">-</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> during spontaneous (plain line) and stimulated (dotted line) activity. The model is the same as in panel (<bold>F</bold>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79541-fig5-v2.tif"/></fig><p>To analyze these datasets, we first followed the approach described in <xref ref-type="fig" rid="fig2">Figure 2B</xref>, and inferred, for each fish, the sets of biases <inline-formula><mml:math id="inf145"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and interactions <inline-formula><mml:math id="inf146"><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> using the spontaneous activity recording only (<xref ref-type="table" rid="app2table3">Appendix 2—table 3</xref>). In a <xref ref-type="table" rid="app2table2">Appendix 2—table 2</xref>second step, we exploited recordings of the visually driven activity to infer additional biases <inline-formula><mml:math id="inf147"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> to the neurons, while keeping the interactions <inline-formula><mml:math id="inf148"><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> fixed (<xref ref-type="fig" rid="fig5">Figure 5C</xref>); in practice, we defined two sets of additional biases, <inline-formula><mml:math id="inf149"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>←</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf150"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, corresponding, respectively, to leftward and rightward illuminations. The underlying intuition is that biases encode inputs due to the stimulation, while the interactions between neurons can be considered as fixed over the experimental time scale. This simplified model reproduces the low order statistics of the data under stimulation (<xref ref-type="fig" rid="app2fig8">Appendix 2—figure 8A and B</xref>).</p><p>The inferred values of the additional biases, averaged over the entire subpopulation (right or left), are shown in <xref ref-type="fig" rid="fig5">Figure 5D</xref> for both ipsiversive or contraversive stimulation. The results show that light stimulation produces a strong increase of excitability for the ipsilateral neurons and a smaller one for contralateral neurons.</p><p>We then simulated the visual stimulation protocol by sampling the Ising model while alternating the model parameters, from <inline-formula><mml:math id="inf151"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf152"><mml:mrow><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>←</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>, and back. The simulated dynamics of the model (<xref ref-type="fig" rid="fig5">Figure 5E</xref>) qualitatively reproduces the experimental traces of the ARTR activity (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). In particular, the model captures the stabilizing effect of unilateral visual stimuli, which results in a large activation of the ipsilateral population, which in turn silences the contralateral subcircuit due to the negative <inline-formula><mml:math id="inf153"><mml:mi>I</mml:mi></mml:math></inline-formula> coupling between both. This yields the anticorrelation between the left and right sides clearly visible in both the experimental and simulated traces, and much stronger in the case of spontaneous activity (<xref ref-type="fig" rid="app2fig8">Appendix 2—figure 8C–F</xref>).</p><p>To better understand the Ising dynamics under visual stimulation, we resort, as previously, to mean-field theory. For asymmetric stimulation, our mean-field model includes, during the periods of stimulation, extra biases <inline-formula><mml:math id="inf154"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf155"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> over neurons in, respectively, the left and right areas (<xref ref-type="fig" rid="fig5">Figure 5C</xref>), while the couplings <inline-formula><mml:math id="inf156"><mml:mi>J</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf157"><mml:mi>I</mml:mi></mml:math></inline-formula> remain unchanged. We show in <xref ref-type="fig" rid="fig5">Figure 5F</xref> the free-energy <inline-formula><mml:math id="inf158"><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi></mml:math></inline-formula> as a function of <inline-formula><mml:math id="inf159"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> for an example fish. Due to the presence of the extra bias, the landscape is tilted with respect to its no-stimulation counterpart (<xref ref-type="fig" rid="fig5">Figure 5G</xref>), entailing that the left- or right-active states are much more likely, and the barrier separating them from the low–low state is much lower. As a consequence, the time necessary for reaching the high-activity state is considerably reduced with respect to the no-stimulation case (see <xref ref-type="disp-formula" rid="equ5">Equation 5</xref>). These results agree with the large probability of the high-activity states and the fast rise to reach these states in the Ising traces in <xref ref-type="fig" rid="fig5">Figure 5E</xref> compared with <xref ref-type="fig" rid="fig2">Figure 2C</xref>.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Modeling high-dimensional data, such as extensive neural recordings, imposes a trade-off between accuracy and interpretability. Although highly sophisticated machine-learning methods may offer quantitative and detailed predictions, they might in turn prove inadequate to elucidate fundamental neurobiological mechanisms. Here, we introduced a data-driven network model, whose biologically grounded architecture and relative simplicity make it both quantitatively accurate and amenable to detailed mathematical analysis. We implemented this approach on functional recordings performed at various temperature of a key population of neurons in the zebrafish larvae brain, called ARTR, that drives the orientation of tail bouts and gaze (<xref ref-type="bibr" rid="bib12">Dunn et al., 2016</xref>; <xref ref-type="bibr" rid="bib63">Wolf et al., 2017</xref>; <xref ref-type="bibr" rid="bib46">Ramirez and Aksay, 2021</xref>; <xref ref-type="bibr" rid="bib26">Leyden et al., 2021</xref>).</p><p>First, we demonstrate that the persistent time scale of the ARTR endogenous dynamics decreases with the temperature, mirroring the thermal modulation of turn direction persistence in freely swimming behavioral assays. We then demonstrate that our energy-based model not only captures the statistics of the different activity patterns, but also numerically reproduces the endogenous pseudo-oscillatory network dynamics, and their thermal dependence. The inferred Ising model is then analyzed within the so-called mean-field formulation, in which the coupling and bias parameters are replaced by their values averaged over the left and right subpopulations. It yields a two-dimensional representation of the network energy landscape where the preferred states and associated activation barriers can be easily evaluated. We show how this combined data-driven and theoretical approach can be applied to analyze the ARTR response to transient visual stimulation. The latter tilts the energy landscape, strongly favoring some states over others.</p><sec id="s3-1"><title>Origin and functional significance of the temperature dependence of the ARTR dynamics</title><p>The brains of cold-blooded animals need to operate within the range of temperature that they experience in their natural habitat, for example, 18–33°C for zebrafish (<xref ref-type="bibr" rid="bib14">Gau et al., 2013</xref>). This is a peculiarly stringent requirement since most biophysical processes are dependent on the temperature. In some rare instances, regulation mechanisms might stabilize the circuit dynamics in order to preserve its function, as best exemplified by the pyloric rhythm of the crab whose characteristic phase relationship is maintained over an extended temperature range (<xref ref-type="bibr" rid="bib53">Tang et al., 2010</xref>). Yet in general, an increase in temperature tends to increase the frequency of oscillatory processes (<xref ref-type="bibr" rid="bib47">Robertson and Money, 2012</xref>). The observed acceleration of the ARTR left/right alternation with increasing temperature could thus directly result from temperature-dependent cellular mechanisms. Furthermore, one cannot rule out the possibility that the ARTR dynamics could also be indirectly modulated by temperature via thermal-dependent descending neuromodulatory inputs.</p><p>As a result of this thermal modulation of the neuronal dynamics, many cold-blooded animals also exhibit temperature dependence of their behavior (<xref ref-type="bibr" rid="bib27">Long and Fee, 2008</xref>; <xref ref-type="bibr" rid="bib37">Neumeister et al., 2000</xref>; <xref ref-type="bibr" rid="bib52">Stevenson and Josephson, 1990</xref>). Here, we were able to quantitatively relate the two processes (neuronal and motor) by demonstrating that an increase in temperature consistently alters the pattern of spontaneous navigation by increasing the left/right alternation frequency. Interpreting the functional relevance of this modification of the swimming pattern is tricky since many other features of the animal’s navigation are concurrently impacted by a change in temperature, such as the bout frequency, turning rate, turn amplitude, etc. Nevertheless, we were able to show in a recent study that this thermal dependence of the swimming kinematic endows the larva with basic thermophobic capacity, thus efficiently protecting them from exposure to the hottest regions of their environment (<xref ref-type="bibr" rid="bib24">Le Goc et al., 2021</xref>).</p></sec><sec id="s3-2"><title>Ising model is not trained to reproduce short-term temporal correlations, but is able to predict long-term dynamics</title><p>The graphical model we introduced in this work was trained to capture the low-order statistics of snapshots of activity. Because graphical models are blind to the dynamical nature of the population activity, it is generally believed that they cannot reproduce any dynamical feature. Nevertheless, here we demonstrate that our model can quantitatively replicate aspects of the network long-term dynamics such as the slow alternation between the two preferred states. To better understand this apparent paradox, it is necessary to distinguish short and long time scales. At short time scale, defined here as the duration of a time bin (of the order of a few 100 ms), the model cannot capture any meaningful dynamics. The MC algorithm we used to generate activity is an abstract and arbitrary process, and the correlations it produces between successive time bins cannot reproduce the ones in the recording data. Capturing the short-term dynamics would require a biologically grounded model of the cell–cell interactions, or, at the very least, to introduce parameters capturing the experimental temporal correlations over this short time scale (<xref ref-type="bibr" rid="bib30">Marre et al., 2009</xref>; <xref ref-type="bibr" rid="bib33">Mézard and Sakellariou, 2011</xref>).</p><p>Yet, the inability of the Ising model to reproduce short time dynamical correlations does not hinder its capacity to predict long-time behavior. The separation between individual neuronal processes (taking place over time scales smaller than 100 ms) and network-scale activity modulation, which happens on time scales ranging from 1 to 20 s, is here essential. The weak dependence of macroscopic processes on microscopic details is in fact well known in many fields outside neuroscience. A classic example is provided by chemical reactions, whose kinetics are often controlled by a slow step due to the formation of the activated complex and to the crossing of the associated energy barrier <inline-formula><mml:math id="inf160"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula>, requiring a time proportional to <inline-formula><mml:math id="inf161"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula>. All fast processes, whose modeling can be very complex, contribute an effective microscopic time scale <inline-formula><mml:math id="inf162"><mml:mi>τ</mml:mi></mml:math></inline-formula> in Arrhenius’ expression for the reaction time (see <xref ref-type="disp-formula" rid="equ5">Equation 5</xref>). In this respect, what really matters to predict long time dynamical properties is a good estimate of <inline-formula><mml:math id="inf163"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> or, equivalently, of the effective energy landscape felt by the system. This is precisely what the Ising model is capable of doing. This explains why, even if temporal information are not explicitly included in the training process, our model may still be endowed with a predictive power over the long-term network dynamics.</p></sec><sec id="s3-3"><title>Energy-landscape-based mechanism for persistence</title><p>In a preceding article (<xref ref-type="bibr" rid="bib63">Wolf et al., 2017</xref>), we developed a mathematical model of the ARTR in which the left and right ARTR population were represented by a single unit. To account for the ARTR persistent dynamics, an intrinsic adaptation time scale had to be introduced in an ad hoc fashion. While the mean-field version of the inferred Ising model shows some formal mathematical similarity with this two-unit model, it differs in a fundamental aspect. Here, the slow dynamics reflects the itinerant exploration of a two-dimensional energy landscape (<xref ref-type="fig" rid="fig4">Figure 4C</xref>), for which the barriers separating metastable states scale linearly with the system size. The time to cross these barriers in turn grows exponentially with the system size, as prescribed by Arrhenius law, and can be orders of magnitude larger than any single-neuron relaxation time. Persistence is therefore an emerging property of the neural network.</p></sec><sec id="s3-4"><title>Mean-field approximation and beyond</title><p>The mean-field approach, through a drastic simplification of the Ising model, allows us to unveil the fundamental network features controlling its coarse-grained dynamics. Within this approximation, the distributions of couplings and of biases are replaced by their average values. The heterogeneities characterizing the Ising model parameters (<xref ref-type="fig" rid="app2fig4">Appendix 2—figure 4</xref> and <xref ref-type="fig" rid="app2fig5">Appendix 2—figure 5</xref>), and ignored in the mean-field approach, may, however, play an important role in the network dynamics.</p><p>In the Ising model, the ipsilateral couplings are found to be broadly distributed such as to possess both negative and positive values. This leads to the presence of so-called frustrated loops, that is, chains of neurons along which the product of the pairwise couplings is negative. The states of activities of the neurons along such loops cannot be set in a way that satisfies all the excitatory and inhibitory connections, hence giving rise to dynamical instabilities in the states of the neurons. The absence of frustrated loops in the network (<xref ref-type="fig" rid="fig4">Figure 4A</xref>) stabilizes and boosts the activity, an artifact we had to correct for in our analytical treatment by introducing an effective number of neurons <inline-formula><mml:math id="inf164"><mml:mi>K</mml:mi></mml:math></inline-formula>, much smaller than the total numbers of neurons <inline-formula><mml:math id="inf165"><mml:mi>N</mml:mi></mml:math></inline-formula> s. Neglecting the variability of the contralateral couplings also constitutes a drastic approximation of the mean-field approach. This is all the more true that the average contralateral coupling <inline-formula><mml:math id="inf166"><mml:mi>I</mml:mi></mml:math></inline-formula> happens to be small compared to its standard deviation.</p><p>Couplings are not only broadly distributed but also spatially organized. Ipsilateral couplings <inline-formula><mml:math id="inf167"><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> decay with the distance between neurons <inline-formula><mml:math id="inf168"><mml:mi>i</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf169"><mml:mi>j</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="app2fig4">Appendix 2—figure 4F</xref>). Similarly, contralateral couplings show strong correlations for short distances between the contralateral neurons (<xref ref-type="fig" rid="app2fig4">Appendix 2—figure 4G</xref>). The existence of a local spatial organization in the couplings is not unheard of in computational neuroscience and can have important functional consequences. It is, for instance, at the basis of ring-like attractor models and their extensions to two or three dimensions (<xref ref-type="bibr" rid="bib57">Tsodyks and Sejnowski, 1995</xref>). Combined with the presence of variable biases <inline-formula><mml:math id="inf170"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, short-range interactions can lead to complex propagation phenomena, intensively studied in statistical physics in the context of the Random Field Ising Model. (<xref ref-type="bibr" rid="bib48">Schneider and Pytte, 1977</xref>; <xref ref-type="bibr" rid="bib20">Kaufman et al., 1986</xref>). As the most excitable neurons (with the largest biases) fire, they excite their neighbors, who in turn become active, triggering the activation of other neurons in their neighborhood. Such an avalanche mechanism could explain the fast rise of activity in the left or right region, from low- to high-activity state.</p></sec><sec id="s3-5"><title>Interpretation of the functional connectivity</title><p>The inferred functional couplings <inline-formula><mml:math id="inf171"><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>’s are not expected to directly reflect the corresponding structural (synaptic) connectivity. However, their spatial distribution appears to be in line with the known ARTR organization (<xref ref-type="bibr" rid="bib12">Dunn et al., 2016</xref>; <xref ref-type="bibr" rid="bib21">Kinkhabwala et al., 2011</xref>) characterized by large positive (excitatory) interactions within the left and right population, and by the presence of negative (inhibitory) contralateral interactions. Although the contralateral couplings are found to be, on average, almost null, compared to the ipsilateral excitatory counterparts, they drive a subtle interplay between the left and right regions of the ARTR.</p><p>Our neural recordings demonstrate a systematic modulation of the ARTR dynamics with the water temperature, in quantitative agreement with the thermal dependence of the exploratory behavior in freely swimming assays. The model correctly captures this thermal modulation of the ARTR activity, and in particular the decay of the persistence time with the temperature. This owes to a progressive change in the values of both the couplings and the biases, which together deform the energy landscape and modulate the energy barriers between metastable states. The fact that the inferred functional connectivity between neurons does not display simple temperature dependence is not unexpected as different membrane currents can have different temperature dependence (<xref ref-type="bibr" rid="bib42">Partridge and Connor, 1978</xref>).</p><p>In addition, as shown in <xref ref-type="table" rid="app2table2">Appendix 2—table 2</xref>, the inferred parameters largely vary across datasets. This variability is partially due to the difficulty to separately infer the interactions <inline-formula><mml:math id="inf172"><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and the biases <inline-formula><mml:math id="inf173"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, a phenomenon not specific to graphical model but also found with other neural, for example, Integrate-and-Fire network models (<xref ref-type="bibr" rid="bib36">Monasson and Cocco, 2011</xref>). This issue can be easily understood within mean-field theory. For simplicity, let us neglect the weak contralateral coupling <inline-formula><mml:math id="inf174"><mml:mi>I</mml:mi></mml:math></inline-formula>. The mean activity <inline-formula><mml:math id="inf175"><mml:mi>m</mml:mi></mml:math></inline-formula> of a neuron then depends on the total ‘input’ <inline-formula><mml:math id="inf176"><mml:mrow><mml:mrow><mml:mpadded width="+1.7pt"><mml:mi>J</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math></inline-formula> it receives, which is the sum of the bias <inline-formula><mml:math id="inf177"><mml:mi>H</mml:mi></mml:math></inline-formula> and of the mean ipsilateral activity <inline-formula><mml:math id="inf178"><mml:mi>m</mml:mi></mml:math></inline-formula>, weighted by the recurrent coupling <inline-formula><mml:math id="inf179"><mml:mi>J</mml:mi></mml:math></inline-formula>. Hence, the combination <inline-formula><mml:math id="inf180"><mml:mrow><mml:mrow><mml:mpadded width="+1.7pt"><mml:mi>J</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math></inline-formula> is more robustly inferred than <inline-formula><mml:math id="inf181"><mml:mi>H</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf182"><mml:mi>J</mml:mi></mml:math></inline-formula> taken separately (<xref ref-type="fig" rid="app2fig7">Appendix 2—figure 7E</xref>).</p><p>The capacity to quantitatively capture subtle differences in the spontaneous activity induced by external cues is an important asset of our model. Recent studies have shown that spontaneous behavior in zebrafish larvae is not time-invariant but exhibits transitions between different regimes, lasting over minutes and associated with specific brain states. These transitions can have no apparent cause (<xref ref-type="bibr" rid="bib24">Le Goc et al., 2021</xref>) or be induced by external (e.g., stimuli; <xref ref-type="bibr" rid="bib2">Andalman et al., 2019</xref>) or internal cues (e.g., hunger states; <xref ref-type="bibr" rid="bib29">Marques et al., 2019</xref>). Although they engage brain-wide changes in the pattern of spontaneous neural dynamics, they are often triggered by the activation of neuromodulatory centers such as the habenula-dorsal raphe nucleus circuit (<xref ref-type="bibr" rid="bib11">Corradi and Filosa, 2021</xref>). Training Ising models in various conditions may help decipher how such neuromodulation impacts the network functional couplings leading to distinct dynamical regimes of spontaneous activity.</p></sec><sec id="s3-6"><title>Data-driven modeling and metastability</title><p>With its slow alternating activity and relatively simple architecture, the ARTR offers an ideally suited circuit to test the capacity of Ising models to capture network-driven dynamics. The possibility to experimentally modulate the ARTR persistence time scale further enabled us to evaluate the model ability to quantitatively represent this slow process. The ARTR is part of a widely distributed hindbrain network that controls the eye horizontal saccadic movements, and which includes several other neuronal populations whose activity is tuned to the eye velocity or position (<xref ref-type="bibr" rid="bib19">Joshua and Lisberger, 2015</xref>; <xref ref-type="bibr" rid="bib63">Wolf et al., 2017</xref>). A possible extension of the model would consist in incorporating these nuclei in order to obtain a more complete representation of the oculomotor circuit. Beyond this particular functional network, a similar data-driven approach could be implemented to capture the slow concerted dynamics that characterize numerous neural assemblies in the zebrafish brain (<xref ref-type="bibr" rid="bib59">van der Plas et al., 2021</xref>).</p><p>The importance of metastable states in cortical activity in mammals has been emphasized in previous studies as a possible basis for sequence-based computation (<xref ref-type="bibr" rid="bib17">Harvey et al., 2012</xref>; <xref ref-type="bibr" rid="bib6">Brinkman et al., 2022</xref>). Our model suggests that these metastable states are shaped by the connectivity of the network and are naturally explored during ongoing spontaneous activity. In this respect, the modification of the landscape resulting from visual stimulation, leading to a sharp decrease in the barrier separating the states, is reminiscent of the acceleration of sensory coding reported in <xref ref-type="bibr" rid="bib31">Mazzucato et al., 2019</xref>. Our principled data-driven modeling could be useful to assess the generality of such metastable-state-based computations and of their modulation by sensory inputs in other organisms.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><p>All data and new codes necessary to reproduce the results reported in this work can be accessed at <ext-link ext-link-type="uri" xlink:href="https://gin.g-node.org/Debregeas/ZF_ARTR_thermo">https://gin.g-node.org/Debregeas/ZF_ARTR_thermo</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://github.com/SebastWolf/ZF_ARTR_thermo">https://github.com/SebastWolf/ZF_ARTR_thermo</ext-link>.</p><table-wrap id="keyresource" position="anchor"><label>Key resources table</label><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Reagent type (species) or resource</th><th align="left" valign="bottom">Designation</th><th align="left" valign="bottom">Source or reference</th><th align="left" valign="bottom">Identifiers</th><th align="left" valign="bottom">Additional information</th></tr></thead><tbody><tr><td align="left" valign="bottom">Strain, strain background (<italic>Danio rerio</italic>)</td><td align="left" valign="bottom">Tg(elavl3:H2B-GCaMP6s)</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib60">Vladimirov et al., 2014</xref></td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>D. rerio</italic>)</td><td align="left" valign="bottom">Tg(elavl3:H2B-GCaMP6f)</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib45">Quirin et al., 2016</xref></td><td align="left" valign="bottom"/><td align="left" valign="top"/></tr><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">Blind Sparse Deconvolution</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib58">Tubiana et al., 2020</xref></td><td align="left" valign="bottom">BSD</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">Computational Morphometry Toolkit</td><td align="left" valign="bottom"><ext-link ext-link-type="uri" xlink:href="https://www.nitrc.org/projects/cmtk/">https://www.nitrc.org/projects/cmtk/</ext-link></td><td align="left" valign="bottom">CMTK</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">Adaptive Cluster Expansion</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib3">Barton and Cocco, 2013</xref></td><td align="left" valign="bottom">ACE</td><td align="left" valign="top"/></tr></tbody></table></table-wrap><sec id="s4-1"><title>Zebrafish lines and maintenance</title><p>All animals subjects were zebrafish (<italic>Danio rerio</italic>), aged 5–7 days post-fertilization (dpf). Larvae were reared in Petri dishes in embryo medium (E3) on a 14/10 hr light/dark cycle at 28°C, and were fed powdered nursery food (GM75) every day from 6 dpf.</p><p>Calcium imaging experiments were conducted on <italic>nacre</italic> mutants that were expressing either the calcium indicator GCaMP6f (12 fish) or GCaMP6s (1 fish) in the nucleus under the control of the nearly pan-neuronal promoter <italic>Tg(elavl3:H2B-GCaMP6)</italic>. Both lines were provided by Misha Ahrens and published in <xref ref-type="bibr" rid="bib60">Vladimirov et al., 2014</xref> (H2B-GCaMP6s) and <xref ref-type="bibr" rid="bib45">Quirin et al., 2016</xref> (H2B-GCaMP6f).</p><p>All experiments were approved by the Le Comité d’Éthique pour l’Expérimentation Animale Charles Darwin (02601.01).</p></sec><sec id="s4-2"><title>Behavioral assays</title><p>The behavioral experiments and preprocessing have been described in detail elsewhere (<xref ref-type="bibr" rid="bib24">Le Goc et al., 2021</xref>). Shortly, it consists of a metallic pool regulated in temperature with two Peltier elements, recorded in uniform white light from above at 25 Hz. A batch of 10 animals experienced 30 min in water at either 18, 22, 26, 30, or 33°C (10 batches of 10 fish, involving 170 different individuals, were used). Movies were tracked with FastTrack (<xref ref-type="bibr" rid="bib13">Gallois and Candelier, 2021</xref>), and MATLAB (The MathWorks) was used to detect discrete swim bouts from which the differences of orientation between two consecutive events are computed, referred to as turn or reorientation angles <inline-formula><mml:math id="inf183"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:math></inline-formula>.</p><p>Turn angles distributions could be fitted as the sum of two distributions (Gaussian and Gamma), whose intersection was used to define an angular threshold to categorize events into forward (F), left turn (L), or right turn (R, <xref ref-type="fig" rid="fig1">Figure 1E</xref>). This threshold was found to be close to 10° for all tested temperatures.</p><p>Then we ternarized <inline-formula><mml:math id="inf184"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:math></inline-formula> values, based on F, L, or R classification (<xref ref-type="fig" rid="fig1">Figure 1F</xref>), and computed the power spectrum of the binary signals defined from symbols L and R only, with the periodogram MATLAB function and averaged by temperature (<xref ref-type="fig" rid="fig1">Figure 1G</xref>). The outcome was fitted to the Lorentzian expression corresponding to a memory-less equiprobable two-state process (<xref ref-type="bibr" rid="bib39">Odde and Buettner, 1998</xref>):<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf185"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the rate of transition from one state to another. The inverse of the fitted flipping rate <inline-formula><mml:math id="inf186"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> represents the typical time spent in the same orientational state, that is, the typical time taken to switch turning direction.</p></sec><sec id="s4-3"><title>Light-sheet functional imaging of spontaneous activity</title><p>Volumetric functional recordings were carried out using custom-made one-photon light-sheet microscopes whose optical characteristics have been detailed elsewhere (<xref ref-type="bibr" rid="bib41">Panier et al., 2013</xref>). Larvae were mounted in a 1 mm diameter cylinder of low melting point agarose at 2% concentration.</p><p>Imaged volume corresponded to 122 ± 46 μm in thickness, split into 16 ± 4 slices (mean ± SD). Recordings were of length 1392 ± 256 s with a brain volume imaging frequency of 6 ± 2 Hz (mean ± SD).</p><p>Image preprocessing, neurons segmentation, and calcium transient (<inline-formula><mml:math id="inf187"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>F</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>F</mml:mi></mml:mrow></mml:math></inline-formula>) extraction were performed offline using MATLAB, according to the workflow previously reported (<xref ref-type="bibr" rid="bib41">Panier et al., 2013</xref>; <xref ref-type="bibr" rid="bib63">Wolf et al., 2017</xref>; <xref ref-type="bibr" rid="bib34">Migault et al., 2018</xref>).</p><p>A Peltier module is attached to the lower part of the pool (made of tin) with thermal tape (3M). A type T thermocouple (Omega) is placed near the fish head (&lt;5 mm) to record the fish surrounding temperature. The signal from a thermocouple amplifier (Adafruit) is used in a PID loop implemented on an Arduino board, which mitigate the Peltier power to achieve the predefined temperature target, stable at ±0.5°C. The temperature regulation software and electronics design are available on Gitlab under a GNU GPLv3 license (<ext-link ext-link-type="uri" xlink:href="https://gitlab.com/GuillaumeLeGoc/arduino-temperature-control">https://gitlab.com/GuillaumeLeGoc/arduino-temperature-control</ext-link> copy archived at <xref ref-type="bibr" rid="bib25">Le Goc, 2022</xref>).</p><p>The ARTR neurons were selected using a method described elsewhere (<xref ref-type="bibr" rid="bib63">Wolf et al., 2017</xref>). First, a group of neurons was manually selected on a given slice based on a morphological criterion such that the ARTR structure (ipsilateral correlations and contralateral anticorrelation) is revealed. Then, neurons showing Pearson’s correlation (anti-correlation) higher than 0.2 (less than –0.15, respectively) are selected, manually filtering them on a morphological criterion. Those neurons are then added to the previous ones, whose signals are used to find neurons from the next slice and so on until all slices are treated.</p><p>For fish that were recorded at different temperatures, to ensure that the same neurons are selected, we used the Computational Morphometry Toolkit (CMTK, <ext-link ext-link-type="uri" xlink:href="https://www.nitrc.org/projects/cmtk/">https://www.nitrc.org/projects/cmtk/</ext-link>) to align following recordings onto the first one corresponding to the same individual. Resulting transformations are then applied to convert neurons coordinates in a consistent manner through all recordings involving the same fish.</p></sec><sec id="s4-4"><title>Visually driven recordings</title><p>Volumetric functional recordings under visual stimulation were carried using our two-photon light-sheet microscope described in <xref ref-type="bibr" rid="bib62">Wolf et al., 2015</xref>. The stimulation protocol was previously explained in <xref ref-type="bibr" rid="bib63">Wolf et al., 2017</xref>: two LEDs were positioned symmetrically outside of the chamber at 45° and 4.5 cm from the fish eyes, delivering a visual intensity of 20 μW/cm<sup>2</sup>. We alternately illuminated 17 times each eye for 10 s, 15 s, 20 s, 25 s, and 30 s while performing two-photon light-sheet brain-wide functional imaging. Synchronization between the microscope and the stimulation set-up was done using a D/A card (NI USB-6259 NCS, National Instruments) and a LabVIEW program. Brain volume image frequency was of 1 Hz on the six recorded fish. Recordings last for 4500 s, 856 s of which is spontaneous activity. We extracted the ARTR neurons following the same procedure described above, yielding 89 ± 54 neurons (mean ± SD).</p></sec><sec id="s4-5"><title>Time constants definitions</title><p>For the flipping rates (<xref ref-type="fig" rid="fig1">Figure 1D</xref>), we defined the time-dependent signed activity of the ARTR (<xref ref-type="fig" rid="fig1">Figure 1B</xref>) through<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:mi>σ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mtext>sign</mml:mtext><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf188"><mml:mrow><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> are the average activities in the L, R regions. A power spectrum density is estimated for each signal with the Thomson’s multitaper method through the pmtm MATLAB function (time-halfbandwidth product set to 4). The power spectrum densities were then fitted with a Lorentzian spectrum see <xref ref-type="disp-formula" rid="equ6">Equation 6</xref> and <xref ref-type="fig" rid="fig1">Figure 1G</xref>.</p><p>ARTR left and right persistence times (<xref ref-type="fig" rid="fig3">Figure 3B</xref>) are defined as the time <inline-formula><mml:math id="inf189"><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf190"><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula> signals spend consecutively above an arbitrary threshold set at 0.1. Left and right signals are treated altogether. Changing the threshold does induce a global offset but does not change the observed effect of temperature, the relation with <inline-formula><mml:math id="inf191"><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf192"><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula> mean signals, nor the relation with the persistence times of the synthetic signals. The persistence times of the synthetic signals, generated with the Ising models, are computed using the same procedure: we compute the time <inline-formula><mml:math id="inf193"><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf194"><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula> synthetic signals spend consecutively above an arbitrary threshold set at 0.1, we then normalize these durations by the corresponding experimental frame rate in order to compare the different recordings (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). For the mean-field simulated dynamics of the left and right activities, we also follow the same strategy in order to compute the persistence times displayed in <xref ref-type="fig" rid="fig4">Figure 4F</xref>.</p></sec><sec id="s4-6"><title>Inference of Ising model from neural activity</title><sec id="s4-6-1"><title>From spontaneous activity to spiking data, to biases and connectivity</title><p>For each recording (animal and/or temperature), approximate spike trains were inferred from the fluorescence activity signal using the Blind Sparse Deconvolution algorithm (<xref ref-type="bibr" rid="bib58">Tubiana et al., 2020</xref>). This algorithm features automatic (fully unsupervised) estimation of the hyperparameters, such as spike amplitude, noise level, and rise and decay time constants, but also an automatic thresholding for binarizing spikes such as to maximize the precision-recall performance. The binarized activity of the <inline-formula><mml:math id="inf195"><mml:mi>N</mml:mi></mml:math></inline-formula> recorded neurons was then described for each time bin <inline-formula><mml:math id="inf196"><mml:mi>t</mml:mi></mml:math></inline-formula>, into a <inline-formula><mml:math id="inf197"><mml:mi>N</mml:mi></mml:math></inline-formula>-bit binary configuration <inline-formula><mml:math id="inf198"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, with, <inline-formula><mml:math id="inf199"><mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> if neuron <inline-formula><mml:math id="inf200"><mml:mi>i</mml:mi></mml:math></inline-formula> is active in bin <inline-formula><mml:math id="inf201"><mml:mi>t</mml:mi></mml:math></inline-formula>, 0 otherwise.</p><p>The functional connectivity matrix <inline-formula><mml:math id="inf202"><mml:msub><mml:mi>J</mml:mi><mml:mtext>ij</mml:mtext></mml:msub></mml:math></inline-formula> and the biases <inline-formula><mml:math id="inf203"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> defining the Ising probability distribution over neural configurations (see <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>) were determined such that the pairwise correlations and average activities computed from the model match their experimental counterparts. In practice, we approximately solved this hard inverse problem using the Adaptative Cluster Expansion and the MC learning algorithms described in <xref ref-type="bibr" rid="bib10">Cocco and Monasson, 2011</xref> and in <xref ref-type="bibr" rid="bib3">Barton and Cocco, 2013</xref>. The full code of the algorithms can be downloaded from the GitHub repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/johnbarton/ACE/">https://github.com/johnbarton/ACE/</ext-link> ( <xref ref-type="bibr" rid="bib5">Barton, 2019</xref>).</p></sec><sec id="s4-6-2"><title>Monte Carlo sampling</title><p>In order to generate synthetic activity, we resorted to Gibbs sampling, a class of Monte Carlo Markov Chain method, also known as Glauber dynamics. At each time step <inline-formula><mml:math id="inf204"><mml:mi>k</mml:mi></mml:math></inline-formula>, a neuron, say, <inline-formula><mml:math id="inf205"><mml:mi>i</mml:mi></mml:math></inline-formula>, is picked up uniformly at random, and the value of its activity is updated from <inline-formula><mml:math id="inf206"><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:math></inline-formula> to <inline-formula><mml:math id="inf207"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> according to the probability<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>∣</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>which depends on the current activities of the other neurons. As this updating fulfills detailed balance, the probability distribution of <inline-formula><mml:math id="inf208"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="bold">s</mml:mi><mml:mrow><mml:mi mathvariant="bold">k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> eventually converges to <inline-formula><mml:math id="inf209"><mml:mi>P</mml:mi></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>. A Monte Carlo round is defined as the number of Monte Carlo steps divided by the total number of neurons, <inline-formula><mml:math id="inf210"><mml:mi>N</mml:mi></mml:math></inline-formula>. The code used can be accessed from the link provided at the beginning of the ‘Materials and methods’ section.</p></sec><sec id="s4-6-3"><title>Cross-validation and independent model</title><p>We cross-validated the Ising models (see <xref ref-type="fig" rid="app2fig3">Appendix 2—figure 3</xref>) dividing the datasets in two parts: for each experiment, 75% of each dataset is used as a training set and the remaining 25% is used as a test set. Each training set is used to infer an Ising model. We then compare the mean activity and covariance of the test set with the one computed from the simulated data generated by the models (<xref ref-type="fig" rid="app2fig3">Appendix 2—figure 3A and B</xref>). We also show the relative variation of the models’ log likelihood computed on the training data and the test data (<xref ref-type="fig" rid="app2fig3">Appendix 2—figure 3C</xref>). In addition, as a null hypothesis, we decided to compare the Ising models fitted on the data with the independent model. The independent model depends on the mean activities <inline-formula><mml:math id="inf211"><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mtext>data</mml:mtext></mml:msub></mml:math></inline-formula> only and reads<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>Z</mml:mi></mml:mfrac><mml:mspace width="thickmathspace"/><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We demonstrate in <xref ref-type="fig" rid="app2fig3">Appendix 2—figure 3E–F</xref> the inefficiency of the independent models, comparing the mean activity and covariance of the test set with the one computed from the simulated data generated by the independent models. We also show the relative variation, between the Ising and the independent models, of the log likelihood computed on the training data and the test data (<xref ref-type="fig" rid="app2fig3">Appendix 2—figure 3G</xref>).</p></sec><sec id="s4-6-4"><title>Real data and models comparison</title><p>To quantify the quality of the log-probability landscapes reproduction by the Ising models (<xref ref-type="fig" rid="fig3">Figure 3A</xref>), we used the Kullback–Leibler divergence between (1) a dataset <inline-formula><mml:math id="inf212"><mml:mi>i</mml:mi></mml:math></inline-formula> and the synthetic signals generated with the model trained on that dataset <inline-formula><mml:math id="inf213"><mml:mi>i</mml:mi></mml:math></inline-formula> (green) and (2) the dataset <inline-formula><mml:math id="inf214"><mml:mi>i</mml:mi></mml:math></inline-formula> with synthetic signals generated with every other models (red). With <italic>c</italic><sub><italic>i</italic></sub> the count in the two-dimensional bin <inline-formula><mml:math id="inf215"><mml:mi>i</mml:mi></mml:math></inline-formula> (10 × 10 bins used) and <inline-formula><mml:math id="inf216"><mml:mi>α</mml:mi></mml:math></inline-formula> a pseudocount (set to 1), the probability in bin <inline-formula><mml:math id="inf217"><mml:mi>i</mml:mi></mml:math></inline-formula> is defined as <inline-formula><mml:math id="inf218"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:mstyle><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. The Kullback–Leibler divergence between a data/model pair is then defined as<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo rspace="7.5pt">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We follow the exact same procedure in order to compare the independent model and their corresponding datasets (<xref ref-type="fig" rid="fig3">Figure 3A</xref> in blue). In this case, we use synthetic signals generated with the independent model to define <inline-formula><mml:math id="inf219"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>.</p></sec><sec id="s4-6-5"><title>Inference of additional biases from visually driven activity recordings</title><p>For the visually driven activity recordings, we infer the additional biases <inline-formula><mml:math id="inf220"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>←</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> from the recordings of the ARTR activity (<xref ref-type="fig" rid="fig5">Figure 5D</xref>) during, for example, the leftward light stimulations as follows. Let <inline-formula><mml:math id="inf221"><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo>←</mml:mo></mml:mover></mml:math></inline-formula> the number of time bins <inline-formula><mml:math id="inf222"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo>←</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula> in the recording, and <inline-formula><mml:math id="inf223"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> the corresponding binarized activity configurations. We define, for each neuron <inline-formula><mml:math id="inf224"><mml:mi>i</mml:mi></mml:math></inline-formula>,<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mover><mml:mi>B</mml:mi><mml:mo>←</mml:mo></mml:mover></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mi>h</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mi>h</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mtext> </mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p><inline-formula><mml:math id="inf225"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> represents the mean activity of neuron <inline-formula><mml:math id="inf226"><mml:mi>i</mml:mi></mml:math></inline-formula>, when subject to a global bias summing <inline-formula><mml:math id="inf227"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, the other neurons activities <inline-formula><mml:math id="inf228"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> weighted by the couplings <inline-formula><mml:math id="inf229"><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and an additional bias <inline-formula><mml:math id="inf230"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:math></inline-formula>, averaged over all the frames <inline-formula><mml:math id="inf231"><mml:mi>t</mml:mi></mml:math></inline-formula> corresponding to left-sided light stimulation. It is a monotonously increasing function of <inline-formula><mml:math id="inf232"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:math></inline-formula>, which matches the experimental average activity <inline-formula><mml:math id="inf233"><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mn>1</mml:mn><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo>←</mml:mo></mml:mover></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo>←</mml:mo></mml:mover></mml:munderover></mml:mstyle><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> for a unique value of its argument. This value defines <inline-formula><mml:math id="inf234"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>←</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. The same procedure was followed to infer the additional biases <inline-formula><mml:math id="inf235"><mml:mrow><mml:mi>δ</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo mathvariant="normal">→</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> associated to rightward visual stimulations.</p></sec></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Data curation, Validation, Investigation, Visualization, Methodology, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Funding acquisition, Investigation, Methodology, Writing – original draft, Project administration</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Supervision, Methodology, Writing – original draft</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Formal analysis, Supervision, Investigation, Methodology, Writing – original draft, Project administration</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>All experiments were approved by Le Comité d'Éthique pour l'Expérimentation Animale Charles Darwin (02601.01).</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-79541-mdarchecklist1-v2.docx" mimetype="application" mime-subtype="docx"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>All data necessary to reproduce the results reported in this work can be accessed from <ext-link ext-link-type="uri" xlink:href="https://gin.g-node.org/Debregeas/ZF_ARTR_thermo">https://gin.g-node.org/Debregeas/ZF_ARTR_thermo</ext-link>. Codes can be accessed at <ext-link ext-link-type="uri" xlink:href="https://github.com/SebastWolf/ZF_ARTR_thermo">https://github.com/SebastWolf/ZF_ARTR_thermo</ext-link> copy archived at <xref ref-type="bibr" rid="bib64">Wolf, 2023</xref>.</p><p>The following dataset was generated:</p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset1"><person-group person-group-type="author"><name><surname>Wolf</surname><given-names>S</given-names></name><name><surname>Le Goc</surname><given-names>G</given-names></name><name><surname>Debregeas</surname><given-names>G</given-names></name><name><surname>Cocco</surname><given-names>S</given-names></name><name><surname>Monasson</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>ZF_ARTR_thermo</data-title><source>G-Node GIN</source><pub-id pub-id-type="accession" xlink:href="https://gin.g-node.org/Debregeas/ZF_ARTR_thermo">Debregeas/ZF_ARTR_thermo</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>SW acknowledges support by a fellowship from the Fondation pour la Recherche Médicale (SPF 201809007064), and GLG by the Systems Biology network of Sorbonne Université. We thank the IBPS fish facility staff for the fish maintenance. We are grateful to Carounagarane Dore for his contribution to the design of the experimental setups. We thank Misha Ahrens for providing the GCaMP line.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahrens</surname><given-names>MB</given-names></name><name><surname>Orger</surname><given-names>MB</given-names></name><name><surname>Robson</surname><given-names>DN</given-names></name><name><surname>Li</surname><given-names>JM</given-names></name><name><surname>Keller</surname><given-names>PJ</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Whole-brain functional imaging at cellular resolution using light-sheet microscopy</article-title><source>Nature Methods</source><volume>10</volume><fpage>413</fpage><lpage>420</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2434</pub-id><pub-id pub-id-type="pmid">23524393</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Andalman</surname><given-names>AS</given-names></name><name><surname>Burns</surname><given-names>VM</given-names></name><name><surname>Lovett-Barron</surname><given-names>M</given-names></name><name><surname>Broxton</surname><given-names>M</given-names></name><name><surname>Poole</surname><given-names>B</given-names></name><name><surname>Yang</surname><given-names>SJ</given-names></name><name><surname>Grosenick</surname><given-names>L</given-names></name><name><surname>Lerner</surname><given-names>TN</given-names></name><name><surname>Chen</surname><given-names>R</given-names></name><name><surname>Benster</surname><given-names>T</given-names></name><name><surname>Mourrain</surname><given-names>P</given-names></name><name><surname>Levoy</surname><given-names>M</given-names></name><name><surname>Rajan</surname><given-names>K</given-names></name><name><surname>Deisseroth</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Neuronal dynamics regulating brain and behavioral state transitions</article-title><source>Cell</source><volume>177</volume><fpage>970</fpage><lpage>985</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2019.02.037</pub-id><pub-id pub-id-type="pmid">31031000</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barton</surname><given-names>J</given-names></name><name><surname>Cocco</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Ising models for neural activity inferred via selective cluster expansion: structural and coding properties</article-title><source>Journal of Statistical Mechanics</source><volume>2013</volume><elocation-id>03002</elocation-id><pub-id pub-id-type="doi">10.1088/1742-5468/2013/03/P03002</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barton</surname><given-names>JP</given-names></name><name><surname>De Leonardis</surname><given-names>E</given-names></name><name><surname>Coucke</surname><given-names>A</given-names></name><name><surname>Cocco</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>ACE: adaptive cluster expansion for maximum entropy graphical model inference</article-title><source>Bioinformatics</source><volume>32</volume><fpage>3089</fpage><lpage>3097</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btw328</pub-id><pub-id pub-id-type="pmid">27329863</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Barton</surname><given-names>JP</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>Ace</data-title><version designator="8032305">8032305</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/johnbarton/ACE/">https://github.com/johnbarton/ACE/</ext-link></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brinkman</surname><given-names>BAW</given-names></name><name><surname>Yan</surname><given-names>H</given-names></name><name><surname>Maffei</surname><given-names>A</given-names></name><name><surname>Park</surname><given-names>IM</given-names></name><name><surname>Fontanini</surname><given-names>A</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>La Camera</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Metastable dynamics of neural circuits and networks</article-title><source>Applied Physics Reviews</source><volume>9</volume><elocation-id>011313</elocation-id><pub-id pub-id-type="doi">10.1063/5.0062603</pub-id><pub-id pub-id-type="pmid">35284030</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Butts</surname><given-names>DA</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Data-Driven approaches to understanding visual neuron activity</article-title><source>Annual Review of Vision Science</source><volume>5</volume><fpage>451</fpage><lpage>477</lpage><pub-id pub-id-type="doi">10.1146/annurev-vision-091718-014731</pub-id><pub-id pub-id-type="pmid">31386605</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>X</given-names></name><name><surname>Randi</surname><given-names>F</given-names></name><name><surname>Leifer</surname><given-names>AM</given-names></name><name><surname>Bialek</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Searching for collective behavior in a small brain</article-title><source>Physical Review. E</source><volume>99</volume><elocation-id>052418</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.99.052418</pub-id><pub-id pub-id-type="pmid">31212571</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cocco</surname><given-names>S</given-names></name><name><surname>Leibler</surname><given-names>S</given-names></name><name><surname>Monasson</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Neuronal couplings between retinal ganglion cells inferred by efficient inverse statistical physics methods</article-title><source>PNAS</source><volume>106</volume><fpage>14058</fpage><lpage>14062</lpage><pub-id pub-id-type="doi">10.1073/pnas.0906705106</pub-id><pub-id pub-id-type="pmid">19666487</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cocco</surname><given-names>S</given-names></name><name><surname>Monasson</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Adaptive cluster expansion for inferring Boltzmann machines with noisy data</article-title><source>Physical Review Letters</source><volume>106</volume><elocation-id>090601</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.106.090601</pub-id><pub-id pub-id-type="pmid">21405611</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Corradi</surname><given-names>L</given-names></name><name><surname>Filosa</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Neuromodulation and behavioral flexibility in larval zebrafish: from neurotransmitters to circuits</article-title><source>Frontiers in Molecular Neuroscience</source><volume>14</volume><elocation-id>718951</elocation-id><pub-id pub-id-type="doi">10.3389/fnmol.2021.718951</pub-id><pub-id pub-id-type="pmid">34335183</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dunn</surname><given-names>TW</given-names></name><name><surname>Mu</surname><given-names>Y</given-names></name><name><surname>Narayan</surname><given-names>S</given-names></name><name><surname>Randlett</surname><given-names>O</given-names></name><name><surname>Naumann</surname><given-names>EA</given-names></name><name><surname>Yang</surname><given-names>CT</given-names></name><name><surname>Schier</surname><given-names>AF</given-names></name><name><surname>Freeman</surname><given-names>J</given-names></name><name><surname>Engert</surname><given-names>F</given-names></name><name><surname>Ahrens</surname><given-names>MB</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Brain-Wide mapping of neural activity controlling zebrafish exploratory locomotion</article-title><source>eLife</source><volume>5</volume><elocation-id>e12741</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.12741</pub-id><pub-id pub-id-type="pmid">27003593</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gallois</surname><given-names>B</given-names></name><name><surname>Candelier</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>FastTrack: an open-source software for tracking varying numbers of deformable objects</article-title><source>PLOS Computational Biology</source><volume>17</volume><elocation-id>e1008697</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1008697</pub-id><pub-id pub-id-type="pmid">33571205</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gau</surname><given-names>P</given-names></name><name><surname>Poon</surname><given-names>J</given-names></name><name><surname>Ufret-Vincenty</surname><given-names>C</given-names></name><name><surname>Snelson</surname><given-names>CD</given-names></name><name><surname>Gordon</surname><given-names>SE</given-names></name><name><surname>Raible</surname><given-names>DW</given-names></name><name><surname>Dhaka</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The zebrafish ortholog of TRPV1 is required for heat-induced locomotion</article-title><source>The Journal of Neuroscience</source><volume>33</volume><fpage>5249</fpage><lpage>5260</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.5403-12.2013</pub-id><pub-id pub-id-type="pmid">23516290</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Glaser</surname><given-names>JI</given-names></name><name><surname>Benjamin</surname><given-names>AS</given-names></name><name><surname>Chowdhury</surname><given-names>RH</given-names></name><name><surname>Perich</surname><given-names>MG</given-names></name><name><surname>Miller</surname><given-names>LE</given-names></name><name><surname>Kording</surname><given-names>KP</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Machine learning for neural decoding</article-title><source>ENeuro</source><volume>7</volume><elocation-id>ENEURO.0506-19.2020</elocation-id><pub-id pub-id-type="doi">10.1523/ENEURO.0506-19.2020</pub-id><pub-id pub-id-type="pmid">32737181</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>ZV</given-names></name><name><surname>Inagaki</surname><given-names>HK</given-names></name><name><surname>Daie</surname><given-names>K</given-names></name><name><surname>Druckmann</surname><given-names>S</given-names></name><name><surname>Gerfen</surname><given-names>CR</given-names></name><name><surname>Svoboda</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Maintenance of persistent activity in a frontal thalamocortical loop</article-title><source>Nature</source><volume>545</volume><fpage>181</fpage><lpage>186</lpage><pub-id pub-id-type="doi">10.1038/nature22324</pub-id><pub-id pub-id-type="pmid">28467817</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harvey</surname><given-names>CD</given-names></name><name><surname>Coen</surname><given-names>P</given-names></name><name><surname>Tank</surname><given-names>DW</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Choice-specific sequences in parietal cortex during a virtual-navigation decision task</article-title><source>Nature</source><volume>484</volume><fpage>62</fpage><lpage>68</lpage><pub-id pub-id-type="doi">10.1038/nature10918</pub-id><pub-id pub-id-type="pmid">22419153</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jaynes</surname><given-names>ET</given-names></name></person-group><year iso-8601-date="1957">1957</year><article-title>Information theory and statistical mechanics</article-title><source>Physical Review</source><volume>106</volume><fpage>620</fpage><lpage>630</lpage><pub-id pub-id-type="doi">10.1103/PhysRev.106.620</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Joshua</surname><given-names>M</given-names></name><name><surname>Lisberger</surname><given-names>SG</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A tale of two species: neural integration in zebrafish and monkeys</article-title><source>Neuroscience</source><volume>296</volume><fpage>80</fpage><lpage>91</lpage><pub-id pub-id-type="doi">10.1016/j.neuroscience.2014.04.048</pub-id><pub-id pub-id-type="pmid">24797331</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kaufman</surname><given-names>M</given-names></name><name><surname>Klunzinger</surname><given-names>PE</given-names></name><name><surname>Khurana</surname><given-names>A</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>Multicritical points in an Ising random-field model</article-title><source>Physical Review. B, Condensed Matter</source><volume>34</volume><fpage>4766</fpage><lpage>4770</lpage><pub-id pub-id-type="doi">10.1103/physrevb.34.4766</pub-id><pub-id pub-id-type="pmid">9940272</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kinkhabwala</surname><given-names>A</given-names></name><name><surname>Riley</surname><given-names>M</given-names></name><name><surname>Koyama</surname><given-names>M</given-names></name><name><surname>Monen</surname><given-names>J</given-names></name><name><surname>Satou</surname><given-names>C</given-names></name><name><surname>Kimura</surname><given-names>Y</given-names></name><name><surname>Higashijima</surname><given-names>S-I</given-names></name><name><surname>Fetcho</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A structural and functional ground plan for neurons in the hindbrain of zebrafish</article-title><source>PNAS</source><volume>108</volume><fpage>1164</fpage><lpage>1169</lpage><pub-id pub-id-type="doi">10.1073/pnas.1012185108</pub-id><pub-id pub-id-type="pmid">21199947</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Koller</surname><given-names>D</given-names></name><name><surname>Friedmann</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2009">2009</year><source>Probabilistic Graphical Models: Principles and Techniques</source><publisher-name>MIT Press</publisher-name></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langer</surname><given-names>JS</given-names></name></person-group><year iso-8601-date="1969">1969</year><article-title>Statistical theory of the decay of metastable states</article-title><source>Annals of Physics</source><volume>54</volume><fpage>258</fpage><lpage>275</lpage><pub-id pub-id-type="doi">10.1016/0003-4916(69)90153-5</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Le Goc</surname><given-names>G</given-names></name><name><surname>Lafaye</surname><given-names>J</given-names></name><name><surname>Karpenko</surname><given-names>S</given-names></name><name><surname>Bormuth</surname><given-names>V</given-names></name><name><surname>Candelier</surname><given-names>R</given-names></name><name><surname>Debrégeas</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Thermal modulation of zebrafish exploratory statistics reveals constraints on individual behavioral variability</article-title><source>BMC Biology</source><volume>19</volume><elocation-id>208</elocation-id><pub-id pub-id-type="doi">10.1186/s12915-021-01126-w</pub-id><pub-id pub-id-type="pmid">34548084</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Le Goc</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>Arduino temperature control</data-title><version designator="swh:1:rev:9327f2fb3dd1f1cd844c35712299a8929a084b6e">swh:1:rev:9327f2fb3dd1f1cd844c35712299a8929a084b6e</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:da1f130cf0dee06a154abbe18703802994b56570;origin=https://gitlab.com/GuillaumeLeGoc/arduino-temperature-control.git;visit=swh:1:snp:a1187e6e48df7ddb93de7817883c4c1a545a62c4;anchor=swh:1:rev:9327f2fb3dd1f1cd844c35712299a8929a084b6e">https://archive.softwareheritage.org/swh:1:dir:da1f130cf0dee06a154abbe18703802994b56570;origin=https://gitlab.com/GuillaumeLeGoc/arduino-temperature-control.git;visit=swh:1:snp:a1187e6e48df7ddb93de7817883c4c1a545a62c4;anchor=swh:1:rev:9327f2fb3dd1f1cd844c35712299a8929a084b6e</ext-link></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leyden</surname><given-names>C</given-names></name><name><surname>Brysch</surname><given-names>C</given-names></name><name><surname>Arrenberg</surname><given-names>AB</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>A distributed saccade-associated network encodes high velocity conjugate and monocular eye movements in the zebrafish hindbrain</article-title><source>Scientific Reports</source><volume>11</volume><elocation-id>12644</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-021-90315-2</pub-id><pub-id pub-id-type="pmid">34135354</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Long</surname><given-names>MA</given-names></name><name><surname>Fee</surname><given-names>MS</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Using temperature to analyse temporal dynamics in the songbird motor pathway</article-title><source>Nature</source><volume>456</volume><fpage>189</fpage><lpage>194</lpage><pub-id pub-id-type="doi">10.1038/nature07448</pub-id><pub-id pub-id-type="pmid">19005546</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Ma</surname><given-names>SK</given-names></name></person-group><year iso-8601-date="1985">1985</year><source>Statistical Mechanics</source><publisher-name>World Scientific</publisher-name><pub-id pub-id-type="doi">10.1142/0073</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marques</surname><given-names>JC</given-names></name><name><surname>Li</surname><given-names>M</given-names></name><name><surname>Schaak</surname><given-names>D</given-names></name><name><surname>Robson</surname><given-names>DN</given-names></name><name><surname>Li</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Internal state dynamics shape brainwide activity and foraging behaviour</article-title><source>Nature</source><volume>577</volume><fpage>239</fpage><lpage>243</lpage><pub-id pub-id-type="doi">10.1038/s41586-019-1858-z</pub-id><pub-id pub-id-type="pmid">31853063</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marre</surname><given-names>O</given-names></name><name><surname>El Boustani</surname><given-names>S</given-names></name><name><surname>Frégnac</surname><given-names>Y</given-names></name><name><surname>Destexhe</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Prediction of spatiotemporal patterns of neural activity from pairwise correlations</article-title><source>Physical Review Letters</source><volume>102</volume><elocation-id>138101</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.102.138101</pub-id><pub-id pub-id-type="pmid">19392405</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mazzucato</surname><given-names>L</given-names></name><name><surname>La Camera</surname><given-names>G</given-names></name><name><surname>Fontanini</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Expectation-induced modulation of metastable activity underlies faster coding of sensory stimuli</article-title><source>Nature Neuroscience</source><volume>22</volume><fpage>787</fpage><lpage>796</lpage><pub-id pub-id-type="doi">10.1038/s41593-019-0364-9</pub-id><pub-id pub-id-type="pmid">30936557</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meshulam</surname><given-names>L</given-names></name><name><surname>Gauthier</surname><given-names>JL</given-names></name><name><surname>Brody</surname><given-names>CD</given-names></name><name><surname>Tank</surname><given-names>DW</given-names></name><name><surname>Bialek</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Collective behavior of place and non-place neurons in the hippocampal network</article-title><source>Neuron</source><volume>96</volume><fpage>1178</fpage><lpage>1191</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.10.027</pub-id><pub-id pub-id-type="pmid">29154129</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mézard</surname><given-names>M</given-names></name><name><surname>Sakellariou</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Exact mean-field inference in asymmetric kinetic Ising systems</article-title><source>Journal of Statistical Mechanics</source><volume>2011</volume><elocation-id>L07001</elocation-id><pub-id pub-id-type="doi">10.1088/1742-5468/2011/07/L07001</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Migault</surname><given-names>G</given-names></name><name><surname>van der Plas</surname><given-names>TL</given-names></name><name><surname>Trentesaux</surname><given-names>H</given-names></name><name><surname>Panier</surname><given-names>T</given-names></name><name><surname>Candelier</surname><given-names>R</given-names></name><name><surname>Proville</surname><given-names>R</given-names></name><name><surname>Englitz</surname><given-names>B</given-names></name><name><surname>Debrégeas</surname><given-names>G</given-names></name><name><surname>Bormuth</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Whole-Brain calcium imaging during physiological vestibular stimulation in larval zebrafish</article-title><source>Current Biology</source><volume>28</volume><fpage>3723</fpage><lpage>3735</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2018.10.017</pub-id><pub-id pub-id-type="pmid">30449666</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miri</surname><given-names>A</given-names></name><name><surname>Daie</surname><given-names>K</given-names></name><name><surname>Arrenberg</surname><given-names>AB</given-names></name><name><surname>Baier</surname><given-names>H</given-names></name><name><surname>Aksay</surname><given-names>E</given-names></name><name><surname>Tank</surname><given-names>DW</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Spatial gradients and multidimensional dynamics in a neural integrator circuit</article-title><source>Nature Neuroscience</source><volume>14</volume><fpage>1150</fpage><lpage>1159</lpage><pub-id pub-id-type="doi">10.1038/nn.2888</pub-id><pub-id pub-id-type="pmid">21857656</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Monasson</surname><given-names>R</given-names></name><name><surname>Cocco</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Fast inference of interactions in assemblies of stochastic integrate-and-fire neurons from spike recordings</article-title><source>Journal of Computational Neuroscience</source><volume>31</volume><fpage>199</fpage><lpage>227</lpage><pub-id pub-id-type="doi">10.1007/s10827-010-0306-8</pub-id><pub-id pub-id-type="pmid">21222149</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neumeister</surname><given-names>H</given-names></name><name><surname>Ripley</surname><given-names>B</given-names></name><name><surname>Preuss</surname><given-names>T</given-names></name><name><surname>Gilly</surname><given-names>WF</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Effects of temperature on escape jetting in the squid Loligo opalescens</article-title><source>The Journal of Experimental Biology</source><volume>203</volume><fpage>547</fpage><lpage>557</lpage><pub-id pub-id-type="doi">10.1242/jeb.203.3.547</pub-id><pub-id pub-id-type="pmid">10637183</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nghiem</surname><given-names>TA</given-names></name><name><surname>Telenczuk</surname><given-names>B</given-names></name><name><surname>Marre</surname><given-names>O</given-names></name><name><surname>Destexhe</surname><given-names>A</given-names></name><name><surname>Ferrari</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Maximum-entropy models reveal the excitatory and inhibitory correlation structures in cortical neuronal activity</article-title><source>Physical Review. E</source><volume>98</volume><elocation-id>012402</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.98.012402</pub-id><pub-id pub-id-type="pmid">30110850</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Odde</surname><given-names>DJ</given-names></name><name><surname>Buettner</surname><given-names>HM</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Autocorrelation function and power spectrum of two-state random processes used in neurite guidance</article-title><source>Biophysical Journal</source><volume>75</volume><fpage>1189</fpage><lpage>1196</lpage><pub-id pub-id-type="doi">10.1016/S0006-3495(98)74038-X</pub-id><pub-id pub-id-type="pmid">9726921</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pandarinath</surname><given-names>C</given-names></name><name><surname>O’Shea</surname><given-names>DJ</given-names></name><name><surname>Collins</surname><given-names>J</given-names></name><name><surname>Jozefowicz</surname><given-names>R</given-names></name><name><surname>Stavisky</surname><given-names>SD</given-names></name><name><surname>Kao</surname><given-names>JC</given-names></name><name><surname>Trautmann</surname><given-names>EM</given-names></name><name><surname>Kaufman</surname><given-names>MT</given-names></name><name><surname>Ryu</surname><given-names>SI</given-names></name><name><surname>Hochberg</surname><given-names>LR</given-names></name><name><surname>Henderson</surname><given-names>JM</given-names></name><name><surname>Shenoy</surname><given-names>KV</given-names></name><name><surname>Abbott</surname><given-names>LF</given-names></name><name><surname>Sussillo</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Inferring single-trial neural population dynamics using sequential auto-encoders</article-title><source>Nature Methods</source><volume>15</volume><fpage>805</fpage><lpage>815</lpage><pub-id pub-id-type="doi">10.1038/s41592-018-0109-9</pub-id><pub-id pub-id-type="pmid">30224673</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Panier</surname><given-names>T</given-names></name><name><surname>Romano</surname><given-names>SA</given-names></name><name><surname>Olive</surname><given-names>R</given-names></name><name><surname>Pietri</surname><given-names>T</given-names></name><name><surname>Sumbre</surname><given-names>G</given-names></name><name><surname>Candelier</surname><given-names>R</given-names></name><name><surname>Debrégeas</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Fast functional imaging of multiple brain regions in intact zebrafish larvae using selective plane illumination microscopy</article-title><source>Frontiers in Neural Circuits</source><volume>7</volume><elocation-id>65</elocation-id><pub-id pub-id-type="doi">10.3389/fncir.2013.00065</pub-id><pub-id pub-id-type="pmid">23576959</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Partridge</surname><given-names>LD</given-names></name><name><surname>Connor</surname><given-names>JA</given-names></name></person-group><year iso-8601-date="1978">1978</year><article-title>A mechanism for minimizing temperature effects on repetitive firing frequency</article-title><source>The American Journal of Physiology</source><volume>234</volume><fpage>C155</fpage><lpage>C161</lpage><pub-id pub-id-type="doi">10.1152/ajpcell.1978.234.5.C155</pub-id><pub-id pub-id-type="pmid">645890</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Posani</surname><given-names>L</given-names></name><name><surname>Cocco</surname><given-names>S</given-names></name><name><surname>Ježek</surname><given-names>K</given-names></name><name><surname>Monasson</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Functional connectivity models for decoding of spatial representations from hippocampal CA1 recordings</article-title><source>Journal of Computational Neuroscience</source><volume>43</volume><fpage>17</fpage><lpage>33</lpage><pub-id pub-id-type="doi">10.1007/s10827-017-0645-9</pub-id><pub-id pub-id-type="pmid">28484899</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Posani</surname><given-names>L</given-names></name><name><surname>Cocco</surname><given-names>S</given-names></name><name><surname>Monasson</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Integration and multiplexing of positional and contextual information by the hippocampal network</article-title><source>PLOS Computational Biology</source><volume>14</volume><elocation-id>e1006320</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006320</pub-id><pub-id pub-id-type="pmid">30106966</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quirin</surname><given-names>S</given-names></name><name><surname>Vladimirov</surname><given-names>N</given-names></name><name><surname>Yang</surname><given-names>C-T</given-names></name><name><surname>Peterka</surname><given-names>DS</given-names></name><name><surname>Yuste</surname><given-names>R</given-names></name><name><surname>Ahrens</surname><given-names>MB</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Calcium imaging of neural circuits with extended depth-of-field light-sheet microscopy</article-title><source>Optics Letters</source><volume>41</volume><fpage>855</fpage><lpage>858</lpage><pub-id pub-id-type="doi">10.1364/OL.41.000855</pub-id><pub-id pub-id-type="pmid">26974063</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramirez</surname><given-names>AD</given-names></name><name><surname>Aksay</surname><given-names>ERF</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Ramp-to-threshold dynamics in a hindbrain population controls the timing of spontaneous saccades</article-title><source>Nature Communications</source><volume>12</volume><elocation-id>4145</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-021-24336-w</pub-id><pub-id pub-id-type="pmid">34230474</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robertson</surname><given-names>RM</given-names></name><name><surname>Money</surname><given-names>TGA</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Temperature and neuronal circuit function: compensation, tuning and tolerance</article-title><source>Current Opinion in Neurobiology</source><volume>22</volume><fpage>724</fpage><lpage>734</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2012.01.008</pub-id><pub-id pub-id-type="pmid">22326854</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schneider</surname><given-names>T</given-names></name><name><surname>Pytte</surname><given-names>E</given-names></name></person-group><year iso-8601-date="1977">1977</year><article-title>Random-field instability of the ferromagnetic state</article-title><source>Physical Review B</source><volume>15</volume><fpage>1519</fpage><lpage>1522</lpage><pub-id pub-id-type="doi">10.1103/PhysRevB.15.1519</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schneidman</surname><given-names>E</given-names></name><name><surname>Berry</surname><given-names>MJ</given-names></name><name><surname>Segev</surname><given-names>R</given-names></name><name><surname>Bialek</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Weak pairwise correlations imply strongly correlated network states in a neural population</article-title><source>Nature</source><volume>440</volume><fpage>1007</fpage><lpage>1012</lpage><pub-id pub-id-type="doi">10.1038/nature04701</pub-id><pub-id pub-id-type="pmid">16625187</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seung</surname><given-names>HS</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>How the brain keeps the eyes still</article-title><source>PNAS</source><volume>93</volume><fpage>13339</fpage><lpage>13344</lpage><pub-id pub-id-type="doi">10.1073/pnas.93.23.13339</pub-id><pub-id pub-id-type="pmid">8917592</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seung</surname><given-names>HS</given-names></name><name><surname>Lee</surname><given-names>DD</given-names></name><name><surname>Reis</surname><given-names>BY</given-names></name><name><surname>Tank</surname><given-names>DW</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Stability of the memory of eye position in a recurrent network of conductance-based model neurons</article-title><source>Neuron</source><volume>26</volume><fpage>259</fpage><lpage>271</lpage><pub-id pub-id-type="doi">10.1016/s0896-6273(00)81155-1</pub-id><pub-id pub-id-type="pmid">10798409</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stevenson</surname><given-names>RD</given-names></name><name><surname>Josephson</surname><given-names>RK</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Effects of operating frequency and temperature on mechanical power output from moth flight muscle</article-title><source>Journal of Experimental Biology</source><volume>149</volume><fpage>61</fpage><lpage>78</lpage><pub-id pub-id-type="doi">10.1242/jeb.149.1.61</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname><given-names>LS</given-names></name><name><surname>Goeritz</surname><given-names>ML</given-names></name><name><surname>Caplan</surname><given-names>JS</given-names></name><name><surname>Taylor</surname><given-names>AL</given-names></name><name><surname>Fisek</surname><given-names>M</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Precise temperature compensation of phase in a rhythmic motor pattern</article-title><source>PLOS Biology</source><volume>8</volume><elocation-id>e1000469</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1000469</pub-id><pub-id pub-id-type="pmid">20824168</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tavoni</surname><given-names>G</given-names></name><name><surname>Cocco</surname><given-names>S</given-names></name><name><surname>Monasson</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Neural assemblies revealed by inferred connectivity-based models of prefrontal cortex recordings</article-title><source>Journal of Computational Neuroscience</source><volume>41</volume><fpage>269</fpage><lpage>293</lpage><pub-id pub-id-type="doi">10.1007/s10827-016-0617-5</pub-id><pub-id pub-id-type="pmid">27469424</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tavoni</surname><given-names>G</given-names></name><name><surname>Ferrari</surname><given-names>U</given-names></name><name><surname>Battaglia</surname><given-names>FP</given-names></name><name><surname>Cocco</surname><given-names>S</given-names></name><name><surname>Monasson</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Functional coupling networks inferred from prefrontal cortex activity show experience-related effective plasticity</article-title><source>Network Neuroscience</source><volume>1</volume><fpage>275</fpage><lpage>301</lpage><pub-id pub-id-type="doi">10.1162/NETN_a_00014</pub-id><pub-id pub-id-type="pmid">29855621</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tkačik</surname><given-names>G</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name><name><surname>Marre</surname><given-names>O</given-names></name><name><surname>Amodei</surname><given-names>D</given-names></name><name><surname>Palmer</surname><given-names>SE</given-names></name><name><surname>Berry</surname><given-names>MJ</given-names></name><name><surname>Bialek</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Thermodynamics and signatures of criticality in a network of neurons</article-title><source>PNAS</source><volume>112</volume><fpage>11508</fpage><lpage>11513</lpage><pub-id pub-id-type="doi">10.1073/pnas.1514188112</pub-id><pub-id pub-id-type="pmid">26330611</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsodyks</surname><given-names>M</given-names></name><name><surname>Sejnowski</surname><given-names>T</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Associative memory and hippocampal place cells</article-title><source>International Journal of Neural Systems</source><volume>6</volume><fpage>S81</fpage><lpage>S86</lpage></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tubiana</surname><given-names>J</given-names></name><name><surname>Wolf</surname><given-names>S</given-names></name><name><surname>Panier</surname><given-names>T</given-names></name><name><surname>Debregeas</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Blind deconvolution for spike inference from fluorescence recordings</article-title><source>Journal of Neuroscience Methods</source><volume>342</volume><elocation-id>108763</elocation-id><pub-id pub-id-type="doi">10.1016/j.jneumeth.2020.108763</pub-id><pub-id pub-id-type="pmid">32479972</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>van der Plas</surname><given-names>TL</given-names></name><name><surname>Tubiana</surname><given-names>J</given-names></name><name><surname>Le Goc</surname><given-names>G</given-names></name><name><surname>Migault</surname><given-names>G</given-names></name><name><surname>Kunst</surname><given-names>M</given-names></name><name><surname>Baier</surname><given-names>H</given-names></name><name><surname>Bormuth</surname><given-names>V</given-names></name><name><surname>Englitz</surname><given-names>B</given-names></name><name><surname>Debrégeas</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Neural Assemblies Uncovered by Generative Modeling Explain Whole-Brain Activity Statistics and Reflect Structural Connectivity</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.11.09.467900</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vladimirov</surname><given-names>N</given-names></name><name><surname>Mu</surname><given-names>Y</given-names></name><name><surname>Kawashima</surname><given-names>T</given-names></name><name><surname>Bennett</surname><given-names>DV</given-names></name><name><surname>Yang</surname><given-names>CT</given-names></name><name><surname>Looger</surname><given-names>LL</given-names></name><name><surname>Keller</surname><given-names>PJ</given-names></name><name><surname>Freeman</surname><given-names>J</given-names></name><name><surname>Ahrens</surname><given-names>MB</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Light-Sheet functional imaging in fictively behaving zebrafish</article-title><source>Nature Methods</source><volume>11</volume><fpage>883</fpage><lpage>884</lpage><pub-id pub-id-type="doi">10.1038/nmeth.3040</pub-id><pub-id pub-id-type="pmid">25068735</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>XJ</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Decision making in recurrent neuronal circuits</article-title><source>Neuron</source><volume>60</volume><fpage>215</fpage><lpage>234</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2008.09.034</pub-id><pub-id pub-id-type="pmid">18957215</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolf</surname><given-names>S</given-names></name><name><surname>Supatto</surname><given-names>W</given-names></name><name><surname>Debrégeas</surname><given-names>G</given-names></name><name><surname>Mahou</surname><given-names>P</given-names></name><name><surname>Kruglik</surname><given-names>SG</given-names></name><name><surname>Sintes</surname><given-names>JM</given-names></name><name><surname>Beaurepaire</surname><given-names>E</given-names></name><name><surname>Candelier</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Whole-Brain functional imaging with two-photon light-sheet microscopy</article-title><source>Nature Methods</source><volume>12</volume><fpage>379</fpage><lpage>380</lpage><pub-id pub-id-type="doi">10.1038/nmeth.3371</pub-id><pub-id pub-id-type="pmid">25924070</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolf</surname><given-names>S</given-names></name><name><surname>Dubreuil</surname><given-names>AM</given-names></name><name><surname>Bertoni</surname><given-names>T</given-names></name><name><surname>Böhm</surname><given-names>UL</given-names></name><name><surname>Bormuth</surname><given-names>V</given-names></name><name><surname>Candelier</surname><given-names>R</given-names></name><name><surname>Karpenko</surname><given-names>S</given-names></name><name><surname>Hildebrand</surname><given-names>DGC</given-names></name><name><surname>Bianco</surname><given-names>IH</given-names></name><name><surname>Monasson</surname><given-names>R</given-names></name><name><surname>Debrégeas</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Sensorimotor computation underlying phototaxis in zebrafish</article-title><source>Nature Communications</source><volume>8</volume><elocation-id>651</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-017-00310-3</pub-id><pub-id pub-id-type="pmid">28935857</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Wolf</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>ZF_ARTR_thermo</data-title><version designator="swh:1:rev:fe1d2670dc3eebb1c0d810ee7add067595229d82">swh:1:rev:fe1d2670dc3eebb1c0d810ee7add067595229d82</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:a476955c71411d6271791238fa85f14cee582def;origin=https://github.com/SebastWolf/ZF_ARTR_thermo;visit=swh:1:snp:869b0237ab4804caf34f7883d0114c339c52b732;anchor=swh:1:rev:fe1d2670dc3eebb1c0d810ee7add067595229d82">https://archive.softwareheritage.org/swh:1:dir:a476955c71411d6271791238fa85f14cee582def;origin=https://github.com/SebastWolf/ZF_ARTR_thermo;visit=swh:1:snp:869b0237ab4804caf34f7883d0114c339c52b732;anchor=swh:1:rev:fe1d2670dc3eebb1c0d810ee7add067595229d82</ext-link></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zaksas</surname><given-names>D</given-names></name><name><surname>Pasternak</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Directional signals in the prefrontal cortex and in area MT during a working memory for visual motion task</article-title><source>The Journal of Neuroscience</source><volume>26</volume><fpage>11726</fpage><lpage>11742</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3420-06.2006</pub-id><pub-id pub-id-type="pmid">17093094</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zylberberg</surname><given-names>J</given-names></name><name><surname>Strowbridge</surname><given-names>BW</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Mechanisms of persistent activity in cortical circuits: possible neural substrates for working memory</article-title><source>Annual Review of Neuroscience</source><volume>40</volume><fpage>603</fpage><lpage>627</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-070815-014006</pub-id><pub-id pub-id-type="pmid">28772102</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec sec-type="appendix" id="s8"><title>Mean-field theory for the ARTR activity</title><sec sec-type="appendix" id="s8-1"><title>Derivation of the free energy</title><p>We consider an Ising model with <italic>N</italic><sub><italic>L</italic></sub> and <italic>N</italic><sub><italic>R</italic></sub> neurons in, respectively, the left and right regions. Each neuron activity variable can take two values, <italic>i</italic> = 0, 1, corresponding to silent and active states (within a time window). The ‘energy’ of the system reads<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>H</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>H</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mover><mml:mi>J</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf236"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are biases acting on the neurons, and the coupling matrix is defined through<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>J</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mover><mml:mi>J</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mover><mml:mi>J</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mover><mml:mi>I</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mtd><mml:mtd/></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>We now introduce the left and right average activities:<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The energy <inline-formula><mml:math id="inf237"><mml:mi>E</mml:mi></mml:math></inline-formula> of a neural activity configuration in <xref ref-type="disp-formula" rid="equ12">Equation 12</xref> can be expressed in terms of these average activities:<disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>H</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:msub><mml:mrow><mml:mover><mml:mi>J</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>H</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:msub><mml:mrow><mml:mover><mml:mi>J</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mrow><mml:mover><mml:mi>J</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mrow><mml:mover><mml:mi>J</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>I</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>We may now compute the partition function normalizing the probability of configurations,<disp-formula id="equ16"><label>(16)</label><mml:math id="m16"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:munder><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thickmathspace"/><mml:msub><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thickmathspace"/><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where the sums run over fractional values of the average left and right activities, from 0 to 1 with steps equal to, respectively, <inline-formula><mml:math id="inf238"><mml:mrow><mml:mn>2</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf239"><mml:mrow><mml:mn>2</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, and the multiplicities <inline-formula><mml:math id="inf240"><mml:msub><mml:mi class="ltx_font_mathcaligraphic">ℳ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf241"><mml:msub><mml:mi class="ltx_font_mathcaligraphic">ℳ</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula> measure the numbers of neural configurations with prescribed average activities. We approximate these multiplicities with the standard entropy-based expressions, which are exact in the limit of large sizes <inline-formula><mml:math id="inf242"><mml:msub><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula>,<inline-formula><mml:math id="inf243"><mml:msub><mml:mi>K</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula>:<disp-formula id="equ17"><label>(17)</label><mml:math id="m17"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>≃</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mspace width="thickmathspace"/><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mspace width="1em"/><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:msub><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>≃</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mspace width="thickmathspace"/><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where<disp-formula id="equ18"><label>(18)</label><mml:math id="m18"><mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>is the entropy of a 0 − 1 variable with mean <inline-formula><mml:math id="inf244"><mml:mi>m</mml:mi></mml:math></inline-formula>. As a consequence, the activity-dependent free energy is given by<disp-formula id="equ19"><label>(19)</label><mml:math id="m19"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi>I</mml:mi><mml:mspace width="thinmathspace"/><mml:msqrt><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:msqrt><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>where the bias and coupling parameters are, respectively,<inline-formula><mml:math id="inf245"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>L</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mover accent="true"><mml:mi>J</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>L</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mrow></mml:math></inline-formula>,<inline-formula><mml:math id="inf246"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>R</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mover accent="true"><mml:mi>J</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>R</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mrow></mml:math></inline-formula>,<inline-formula><mml:math id="inf247"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+2.8pt"><mml:msub><mml:mi>N</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>J</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>L</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>,<inline-formula><mml:math id="inf248"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+2.8pt"><mml:msub><mml:mi>N</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>J</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>,<inline-formula><mml:math id="inf249"><mml:mrow><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+2.8pt"><mml:msqrt><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>N</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:msqrt></mml:mpadded><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>The sizes <inline-formula><mml:math id="inf250"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> enter formula (19) for the free energy in two ways:</p><list list-type="bullet"><list-item><p>Implicitly, through the biases <inline-formula><mml:math id="inf251"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and the couplings <inline-formula><mml:math id="inf252"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula>. These parameters are equal to, respectively, the average bias and the total ipsilateral and contralateral couplings acting on each neuron in the <inline-formula><mml:math id="inf253"><mml:mi>L</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf254"><mml:mi>R</mml:mi></mml:math></inline-formula> regions. They are effective parameters defining the mean-field theory.</p></list-item><list-item><p>Explicitly, as multiplicative factors to the free energy contributions coming from the left and right regions. The sizes then merely act as effective inverse ‘temperatures,’ in the Boltzmann factor <inline-formula><mml:math id="inf255"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula> associated to the probability of the <inline-formula><mml:math id="inf256"><mml:mrow><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:math></inline-formula> activities.</p></list-item></list><p>Mean-field theory generally overestimates the collective effects of interactions; a well-known illustration of this artifact is the prediction of the existence of a phase transition in the unidimensional ferromagnetic Ising model with short-range interactions, while such a transition is rigorously known not to take place (<xref ref-type="bibr" rid="bib28">Ma, 1985</xref>). We expect these effects to be strong here due to the wide distribution of inferred Ising couplings (<xref ref-type="fig" rid="app2fig4">Appendix 2—figure 4A</xref>). Many pairs of neurons carry close to zero couplings, and the interaction neighborhood of a neuron is effectively much smaller than <inline-formula><mml:math id="inf257"><mml:msub><mml:mi>N</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf258"><mml:msub><mml:mi>N</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula>. To compensate for the overestimation of interaction effects, we thus propose to keep <xref ref-type="disp-formula" rid="equ19">Equation 19</xref> for the free energy, but with effective sizes <inline-formula><mml:math id="inf259"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> replacing the numbers <inline-formula><mml:math id="inf260"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> of recorded neurons (see <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>), leading to the expression of the free energy:<disp-formula id="equ20"><label>(20)</label><mml:math id="m20"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mi>I</mml:mi><mml:msqrt><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:msqrt><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mn>1</mml:mn><mml:mi>n</mml:mi><mml:mtext> </mml:mtext><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>1</mml:mn><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mn>1</mml:mn><mml:mi>n</mml:mi><mml:mtext> </mml:mtext><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>1</mml:mn><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>These effective sizes <inline-formula><mml:math id="inf261"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are expected to be smaller than <inline-formula><mml:math id="inf262"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Their values are fixed through the comparison of the Langevin dynamical traces with the traces coming from the data; see below.</p></sec><sec sec-type="appendix" id="s8-2"><title>Langevin dynamical equations</title><p>The dynamical Langevin equations read<disp-formula id="equ21"><label>(21)</label><mml:math id="m21"><mml:mrow><mml:mpadded width="+1.7pt"><mml:mi>τ</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="120%" minsize="120%">(</mml:mo><mml:mrow><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>J</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow><mml:mo maxsize="120%" minsize="120%">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:msqrt><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:msqrt><mml:mo>⁢</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mpadded><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo rspace="7.5pt" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ22"><label>(22)</label><mml:math id="m22"><mml:mrow><mml:mpadded width="+1.7pt"><mml:mi>τ</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="120%" minsize="120%">(</mml:mo><mml:mrow><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>J</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow><mml:mo maxsize="120%" minsize="120%">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:msqrt><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:msqrt><mml:mo>⁢</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>K</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mpadded><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo rspace="7.5pt" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf263"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> denote white-noise processes; see main text.</p></sec><sec sec-type="appendix" id="s8-3"><title>Fit of the effective sizes <inline-formula><mml:math id="inf264"><mml:msub><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf265"><mml:msub><mml:mi>K</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula></title><p>The effective sizes <inline-formula><mml:math id="inf266"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf267"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> were fitted generating Langevin trajectories of the activities (<inline-formula><mml:math id="inf268"><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula>,<inline-formula><mml:math id="inf269"><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula>) for a large set of values of <inline-formula><mml:math id="inf270"><mml:mi>A</mml:mi></mml:math></inline-formula> (i.e., <inline-formula><mml:math id="inf271"><mml:msub><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf272"><mml:msub><mml:mi>K</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula>), and with fixed parameters (<inline-formula><mml:math id="inf273"><mml:msub><mml:mi>H</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula>,<inline-formula><mml:math id="inf274"><mml:msub><mml:mi>H</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula>,<inline-formula><mml:math id="inf275"><mml:msub><mml:mi>J</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula>,<inline-formula><mml:math id="inf276"><mml:msub><mml:mi>J</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula>,<inline-formula><mml:math id="inf277"><mml:mi>τ</mml:mi></mml:math></inline-formula>). For each value of <inline-formula><mml:math id="inf278"><mml:msub><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf279"><mml:msub><mml:mi>K</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula>, we computed the KL divergence between the experimental and the Langevin distributions of (<inline-formula><mml:math id="inf280"><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula>,<inline-formula><mml:math id="inf281"><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula>) (see <xref ref-type="fig" rid="app2fig7">Appendix 2—figure 7A–C</xref>). The effective sizes <inline-formula><mml:math id="inf282"><mml:msub><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf283"><mml:msub><mml:mi>K</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula> are the ones that minimize the value of the KL divergence. For low values of <inline-formula><mml:math id="inf284"><mml:mi>A</mml:mi></mml:math></inline-formula>, the KL divergence can be noisy and creates artifacts. To avoid these artifacts, we assume that <inline-formula><mml:math id="inf285"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>A</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></sec></sec></app><app id="appendix-2"><title>Appendix 2</title><fig id="app2fig1" position="float"><label>Appendix 2—figure 1.</label><caption><title>Temperature dependence of the anterior rhombencephalic turning region (ARTR) activity.</title><p>(<bold>A</bold>) Schematic of the experimental setup used to perform brain-wide calcium imaging of a zebrafish larva at controlled water temperature. (<bold>B</bold>) Raster plot of the ARTR spontaneous dynamics showing alternating right/left activation. The top and bottom traces are the ARTR average signal of the left and right subcircuits. (<bold>C</bold>) Example ARTR sign(<inline-formula><mml:math id="inf286"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo mathvariant="normal">-</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) binarized signals measured at three different temperatures (same larva). (<bold>D</bold>) Averaged power spectrum of the ARTR signals <inline-formula><mml:math id="inf287"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo mathvariant="normal">-</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> for the five tested temperatures. Lorentzian fits are shown as solid lines.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79541-app2-fig1-v2.tif"/></fig><fig id="app2fig2" position="float"><label>Appendix 2—figure 2.</label><caption><title>Effect of temperature on the anterior rhombencephalic turning region (ARTR) time persistence and activity.</title><p>(<bold>A</bold>) Pdf of activities of both sides of the ARTR. Color encodes temperature. (<bold>B</bold>) Temperature-averaged mean activity of ARTR left and right neuronal subpopulations. Error bars are standard error of the mean. (<bold>C</bold>) Temperature-averaged Pearson correlation for left/right ispilateral pairs (yellow line) or for contralateral pairs of neurons (purple line). Error bars are standard deviations (32 recordings), n = 13 fish at 5 different water temperatures. (<bold>D</bold>) ARTR persistence time vs. mean activity; note the quasi-linear dependence of these quantities (<inline-formula><mml:math id="inf288"><mml:mrow><mml:mi>R</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">0.91</mml:mn></mml:mrow></mml:math></inline-formula>). Each dot is the mean persistence time computed for one fish at one temperature; colors encode temperature.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79541-app2-fig2-v2.tif"/></fig><fig id="app2fig3" position="float"><label>Appendix 2—figure 3.</label><caption><title>Inference of the anterior rhombencephalic turning region (ARTR) Ising model.</title><p>(<bold>A, B</bold>) Comparison between the mean activities (<bold>A</bold>) and pairwise correlations (<bold>B</bold>) computed from experimental test data and from synthetic (Ising model-generated) data (32 recordings, n = 13 fish). Ising models were trained on a distinct subset of the experimental data. (<bold>C</bold>) Relative variation of the log–likelihoods of the Ising models between training and test data, showing the absence of overfitting. (<bold>D</bold>) Probability that <inline-formula><mml:math id="inf289"><mml:mi>K</mml:mi></mml:math></inline-formula> of the <inline-formula><mml:math id="inf290"><mml:mi>N</mml:mi></mml:math></inline-formula> neurons in the ARTR are simultaneously active in the data (black dots) and in the model (yellow line) configurations. (<bold>E, F</bold>) In order to demonstrate the need for effective connections in our model, we generated synthetic data with independent models of the training dataset. Here, we compare the mean activity (<bold>E</bold>) and the pairwise covariance (<bold>F</bold>) computed on the experimental test dataset and using independent models. (<bold>G</bold>) Excess log likelihood of the Ising models compared to the independent model for training and test data set (see ‘Materials and methods’).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79541-app2-fig3-v2.tif"/></fig><fig id="app2fig4" position="float"><label>Appendix 2—figure 4.</label><caption><title>Correlation structure within the anterior rhombencephalic turning region (ARTR) and properties of the inferred couplings.</title><p>(<bold>A</bold>) Probability density function of the functional connectivity for the ipsilateral (gold line) and the contralateral (purple line) couplings. These pdf were obtained by averaging across all animals. (<bold>B</bold>) Probability density function of the functional Pearson correlation for the ipsilateral (gold line) and the contralateral (purple line) couplings. (<bold>C</bold>) Box plot across experiments of the average value of the ipsilateral and contralateral couplings. (<bold>D</bold>) Probability to have an ipsilateral (gold line) or a contralateral (purple line) pair of neuron given its effective connectivity. For a given range of the effective connectivity, we compute the number of ipsilateral and contralateral pairs of neurons. (<bold>E</bold>) Probability to have an ipsilateral (gold line) or a contralateral (purple line) pair of neuron given its Pearson correlation. (<bold>F</bold>) Functional connectivity <inline-formula><mml:math id="inf291"><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> as a function of the distance between neurons <inline-formula><mml:math id="inf292"><mml:mrow><mml:mi>i</mml:mi><mml:mo mathvariant="normal">,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula>. (<bold>G</bold>) Correlation between the couplings <inline-formula><mml:math id="inf293"><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf294"><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, between one neuron <inline-formula><mml:math id="inf295"><mml:mi>i</mml:mi></mml:math></inline-formula> and one neuron <inline-formula><mml:math id="inf296"><mml:mi>k</mml:mi></mml:math></inline-formula> as a function of their distance <inline-formula><mml:math id="inf297"><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for every possible pair <inline-formula><mml:math id="inf298"><mml:mrow><mml:mo mathvariant="normal" stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo mathvariant="normal">,</mml:mo><mml:mi>k</mml:mi><mml:mo mathvariant="normal" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79541-app2-fig4-v2.tif"/></fig><fig id="app2fig5" position="float"><label>Appendix 2—figure 5.</label><caption><title>Distribution of biases in the inferred anterior rhombencephalic turning region (ARTR) Ising model.</title><p>(<bold>A</bold>) Bias parameter distribution for an example fish. (<bold>B</bold>) Box plot across experiments of the average value of the biases for the left and right subpopulations of the ARTR. (<bold>C</bold>) Box plot across animals of the standard deviation of the biases for the left and right subpopulations of the ARTR.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79541-app2-fig5-v2.tif"/></fig><fig id="app2fig6" position="float"><label>Appendix 2—figure 6.</label><caption><title>Correlation of Ising parameters at different temperatures.</title><p>For each fish (n = 13), we extract from the scatter plots of the coupling <inline-formula><mml:math id="inf299"><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and bias <italic>h</italic><sub><italic>i</italic></sub> inferred from activity recordings at two different temperatures, the Pearson correlation coefficients <inline-formula><mml:math id="inf300"><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>e</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>a</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>r</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>s</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>o</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. The distribution of <inline-formula><mml:math id="inf301"><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>e</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>a</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>r</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>s</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>o</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mn mathvariant="normal">2</mml:mn></mml:msubsup></mml:math></inline-formula> values are shown for all fish and pairs of temperature. Inset: Example scatter plots of the inferred biases <italic>h</italic><sub><italic>i</italic></sub> (left) and effective couplings <inline-formula><mml:math id="inf302"><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (right) for the same fish at two different temperature <italic>T</italic> = 22 and <italic>T</italic> = 30°C.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79541-app2-fig6-v2.tif"/></fig><fig id="app2fig7" position="float"><label>Appendix 2—figure 7.</label><caption><title>Mean-field model of the anterior rhombencephalic turning region (ARTR).</title><p>(<bold>A, B</bold>) Kullback–Leibler divergence between the experimental and the Langevin distributions as a function of <inline-formula><mml:math id="inf303"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf304"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is the total number of neurons of the left or right subpopulation, and <inline-formula><mml:math id="inf305"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is the effective extent of neuronal interaction (see ‘Materials and methods’) for two datasets. (<bold>C</bold>) Probability density function of <inline-formula><mml:math id="inf306"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (blue line) and <inline-formula><mml:math id="inf307"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (red line) across all recordings. (<bold>D</bold>) Free-energy difference between stationary sates of the landscape as a function of the temperature (32 recordings, n=13 fish). (<bold>E</bold>) Average values (for all experiments and regions) of <inline-formula><mml:math id="inf308"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>K</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:mo>+</mml:mo><mml:mi>J</mml:mi><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> as a function of the temperature of the water. Error bars are standard error of the mean.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79541-app2-fig7-v2.tif"/></fig><fig id="app2fig8" position="float"><label>Appendix 2—figure 8.</label><caption><title>A modified Ising model explains visually driven properties of the anterior rhombencephalic turning region (ARTR).</title><p>(<bold>A, B</bold>) To assess the performance of the model for visually driven experiments, we compare the mean activity (<bold>A</bold>) and the pairwise covariance (<bold>B</bold>) computed on the spontaneous part of the recordings to synthetic data. (<bold>C</bold>) Scatter plot of the correlation between contralateral pairs of neurons under visual stimulation vs. spontaneous activity on <italic>n</italic> = 6 fish. (<bold>D</bold>) Scatter plot of the correlation between ipsilateral pairs of neurons under visual stimulation vs. spontaneous activity. (<bold>E</bold>) Average Pearson correlation in the experimental recordings between contralateral (the p-value of a paired sampled <italic>t</italic>-test is provided) and ipsilateral pairs of cells during stimulated and spontaneous activity (<italic>n</italic> = 6 fish). (<bold>F</bold>) Average Pearson correlation in the simulated activity of the ARTR between contralateral and ipsilateral pairs of cells during stimulated and spontaneous activity (<italic>n</italic> = 6 fish).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79541-app2-fig8-v2.tif"/></fig><table-wrap id="app2table1" position="float"><label>Appendix 2—table 1.</label><caption><title>Datasets properties.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top">Temperature (°C)</th><th align="left" valign="top">ID</th><th align="left" valign="top">Line</th><th align="left" valign="top">Age (dpf)</th><th align="left" valign="top"><inline-formula><mml:math id="inf309"><mml:msub><mml:mi>N</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula></th><th align="left" valign="top"><inline-formula><mml:math id="inf310"><mml:msub><mml:mi>N</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula></th><th align="left" valign="top">Acquisition rate (Hz)</th><th align="left" valign="top">Duration (s)</th></tr></thead><tbody><tr><td align="char" char="." valign="top">18</td><td align="char" char="." valign="top">12</td><td align="left" valign="top">NucFast</td><td align="char" char="." valign="top">6</td><td align="char" char="." valign="top">146</td><td align="char" char="." valign="top">180</td><td align="char" char="." valign="top">5</td><td align="char" char="." valign="top">1200</td></tr><tr><td align="char" char="." valign="top">18</td><td align="char" char="." valign="top">13</td><td align="left" valign="top">NucFast</td><td align="char" char="." valign="top">7</td><td align="char" char="." valign="top">37</td><td align="char" char="." valign="top">96</td><td align="char" char="." valign="top">8</td><td align="char" char="." valign="top">1200</td></tr><tr><td align="char" char="." valign="top">18</td><td align="char" char="." valign="top">14</td><td align="left" valign="top">NucFast</td><td align="char" char="." valign="top">6</td><td align="char" char="." valign="top">179</td><td align="char" char="." valign="top">174</td><td align="char" char="." valign="top">8</td><td align="char" char="." valign="top">1200</td></tr><tr><td align="char" char="." valign="top">22</td><td align="char" char="." valign="top">2</td><td align="left" valign="top">Nuc slow</td><td align="char" char="." valign="top">7</td><td align="char" char="." valign="top">177</td><td align="char" char="." valign="top">212</td><td align="char" char="." valign="top">3</td><td align="char" char="." valign="top">1106</td></tr><tr><td align="char" char="." valign="top">22</td><td align="char" char="." valign="top">3</td><td align="left" valign="top">NucFast</td><td align="char" char="." valign="top">5</td><td align="char" char="." valign="top">152</td><td align="char" char="." valign="top">85</td><td align="char" char="." valign="top">3</td><td align="char" char="." valign="top">1812</td></tr><tr><td align="char" char="." valign="top">22</td><td align="char" char="." valign="top">5</td><td align="left" valign="top">NucFast</td><td align="char" char="." valign="top">5</td><td align="char" char="." valign="top">158</td><td align="char" char="." valign="top">123</td><td align="char" char="." valign="top">5</td><td align="char" char="." valign="top">1500</td></tr><tr><td align="char" char="." valign="top">22</td><td align="char" char="." valign="top">6</td><td align="left" valign="top">NucFast</td><td align="char" char="." valign="top">5</td><td align="char" char="." valign="top">98</td><td align="char" char="." valign="top">134</td><td align="char" char="." valign="top">5</td><td align="char" char="." valign="top">1500</td></tr><tr><td align="char" char="." valign="top">22</td><td align="char" char="." valign="top">7</td><td align="left" valign="top">NucFast</td><td align="char" char="." valign="top">6</td><td align="char" char="." valign="top">122</td><td align="char" char="." valign="top">221</td><td align="char" char="." valign="top">5</td><td align="char" char="." valign="top">1500</td></tr><tr><td align="char" char="." valign="top">22</td><td align="char" char="." valign="top">11</td><td align="left" valign="top">NucFast</td><td align="char" char="." valign="top">6</td><td align="char" char="." valign="top">295</td><td align="char" char="." valign="top">320</td><td align="char" char="." valign="top">5</td><td align="char" char="." valign="top">1200</td></tr><tr><td align="char" char="." valign="top">22</td><td align="char" char="." valign="top">13</td><td align="left" valign="top">NucFast</td><td align="char" char="." valign="top">7</td><td align="char" char="." valign="top">37</td><td align="char" char="." valign="top">96</td><td align="char" char="." valign="top">8</td><td align="char" char="." valign="top">1200</td></tr><tr><td align="char" char="." valign="top">22</td><td align="char" char="." valign="top">14</td><td align="left" valign="top">NucFast</td><td align="char" char="." valign="top">6</td><td align="char" char="." valign="top">179</td><td align="char" char="." valign="top">174</td><td align="char" char="." valign="top">8</td><td align="char" char="." valign="top">1200</td></tr><tr><td align="char" char="." valign="top">26</td><td align="char" char="." valign="top">2</td><td align="left" valign="top">Nuc slow</td><td align="char" char="." valign="top">7</td><td align="char" char="." valign="top">177</td><td align="char" char="." valign="top">212</td><td align="char" char="." valign="top">3</td><td align="char" char="." valign="top">1812</td></tr><tr><td align="char" char="." valign="top">26</td><td align="char" char="." valign="top">3</td><td align="left" valign="top">NucFast</td><td align="char" char="." valign="top">5</td><td align="char" char="." valign="top">152</td><td align="char" char="." valign="top">85</td><td align="char" char="." valign="top">3</td><td align="char" char="." valign="top">1812</td></tr><tr><td align="char" char="." valign="top">26</td><td align="char" char="." valign="top">4</td><td align="left" valign="top">NucFast</td><td align="char" char="." valign="top">5</td><td align="char" char="." valign="top">110</td><td align="char" char="." valign="top">76</td><td align="char" char="." valign="top">3</td><td align="char" char="." valign="top">1812</td></tr><tr><td align="char" char="." valign="top">26</td><td align="char" char="." valign="top">5</td><td align="left" valign="top">NucFast</td><td align="char" char="." valign="top">5</td><td align="char" char="." valign="top">158</td><td align="char" char="." valign="top">123</td><td align="char" char="." valign="top">5</td><td align="char" char="." valign="top">1500</td></tr><tr><td align="char" char="." valign="top">26</td><td align="char" char="." valign="top">6</td><td align="left" valign="top">NucFast</td><td align="char" char="." valign="top">5</td><td align="char" char="." valign="top">98</td><td align="char" char="." valign="top">134</td><td align="char" char="." valign="top">5</td><td align="char" char="." valign="top">1500</td></tr><tr><td align="char" char="." valign="top">26</td><td align="char" char="." valign="top">7</td><td align="left" valign="top">NucFast</td><td align="char" char="." valign="top">6</td><td align="char" char="." valign="top">122</td><td align="char" char="." valign="top">221</td><td align="char" char="." valign="top">5</td><td align="char" char="." valign="top">1500</td></tr><tr><td align="char" char="." valign="top">26</td><td align="char" char="." valign="top">11</td><td align="left" valign="top">NucFast</td><td align="char" char="." valign="top">6</td><td align="char" char="." valign="top">295</td><td align="char" char="." valign="top">320</td><td align="char" char="." valign="top">5</td><td align="char" char="." valign="top">1200</td></tr><tr><td align="char" char="." valign="top">26</td><td align="char" char="." valign="top">13</td><td align="left" valign="top">NucFast</td><td align="char" char="." valign="top">7</td><td align="char" char="." valign="top">37</td><td align="char" char="." valign="top">96</td><td align="char" char="." valign="top">8</td><td align="char" char="." valign="top">1200</td></tr><tr><td align="char" char="." valign="top">26</td><td align="char" char="." valign="top">14</td><td align="left" valign="top">NucFast</td><td align="char" char="." valign="top">6</td><td align="char" char="." valign="top">179</td><td align="char" char="." valign="top">174</td><td align="char" char="." valign="top">8</td><td align="char" char="." valign="top">1200</td></tr><tr><td align="char" char="." valign="top">30</td><td align="char" char="." valign="top">2</td><td align="left" valign="top">Nuc slow</td><td align="char" char="." valign="top">7</td><td align="char" char="." valign="top">177</td><td align="char" char="." valign="top">212</td><td align="char" char="." valign="top">3</td><td align="char" char="." valign="top">1812</td></tr><tr><td align="char" char="." valign="top">30</td><td align="char" char="." valign="top">4</td><td align="left" valign="top">NucFast</td><td align="char" char="." valign="top">5</td><td align="char" char="." valign="top">110</td><td align="char" char="." valign="top">76</td><td align="char" char="." valign="top">3</td><td align="char" char="." valign="top">1812</td></tr><tr><td align="char" char="." valign="top">30</td><td align="char" char="." valign="top">5</td><td align="left" valign="top">NucFast</td><td align="char" char="." valign="top">5</td><td align="char" char="." valign="top">158</td><td align="char" char="." valign="top">123</td><td align="char" char="." valign="top">5</td><td align="char" char="." valign="top">1500</td></tr><tr><td align="char" char="." valign="top">30</td><td align="char" char="." valign="top">6</td><td align="left" valign="top">NucFast</td><td align="char" char="." valign="top">5</td><td align="char" char="." valign="top">98</td><td align="char" char="." valign="top">134</td><td align="char" char="." valign="top">5</td><td align="char" char="." valign="top">1500</td></tr><tr><td align="char" char="." valign="top">30</td><td align="char" char="." valign="top">7</td><td align="left" valign="top">NucFast</td><td align="char" char="." valign="top">6</td><td align="char" char="." valign="top">122</td><td align="char" char="." valign="top">221</td><td align="char" char="." valign="top">5</td><td align="char" char="." valign="top">1500</td></tr><tr><td align="char" char="." valign="top">30</td><td align="char" char="." valign="top">13</td><td align="left" valign="top">NucFast</td><td align="char" char="." valign="top">7</td><td align="char" char="." valign="top">37</td><td align="char" char="." valign="top">96</td><td align="char" char="." valign="top">8</td><td align="char" char="." valign="top">1200</td></tr><tr><td align="char" char="." valign="top">30</td><td align="char" char="." valign="top">14</td><td align="left" valign="top">NucFast</td><td align="char" char="." valign="top">6</td><td align="char" char="." valign="top">179</td><td align="char" char="." valign="top">174</td><td align="char" char="." valign="top">8</td><td align="char" char="." valign="top">1200</td></tr><tr><td align="char" char="." valign="top">30</td><td align="char" char="." valign="top">15</td><td align="left" valign="top">NucFast</td><td align="char" char="." valign="top">7</td><td align="char" char="." valign="top">202</td><td align="char" char="." valign="top">252</td><td align="char" char="." valign="top">8</td><td align="char" char="." valign="top">1200</td></tr><tr><td align="char" char="." valign="top">33</td><td align="char" char="." valign="top">14</td><td align="left" valign="top">NucFast</td><td align="char" char="." valign="top">6</td><td align="char" char="." valign="top">179</td><td align="char" char="." valign="top">174</td><td align="char" char="." valign="top">8</td><td align="char" char="." valign="top">1200</td></tr><tr><td align="char" char="." valign="top">33</td><td align="char" char="." valign="top">15</td><td align="left" valign="top">NucFast</td><td align="char" char="." valign="top">7</td><td align="char" char="." valign="top">202</td><td align="char" char="." valign="top">252</td><td align="char" char="." valign="top">8</td><td align="char" char="." valign="top">1200</td></tr><tr><td align="char" char="." valign="top">33</td><td align="char" char="." valign="top">16</td><td align="left" valign="top">NucFast</td><td align="char" char="." valign="top">6</td><td align="char" char="." valign="top">127</td><td align="char" char="." valign="top">123</td><td align="char" char="." valign="top">7</td><td align="char" char="." valign="top">1200</td></tr><tr><td align="char" char="." valign="top">33</td><td align="char" char="." valign="top">17</td><td align="left" valign="top">NucFast</td><td align="char" char="." valign="top">5</td><td align="char" char="." valign="top">62</td><td align="char" char="." valign="top">170</td><td align="char" char="." valign="top">10</td><td align="char" char="." valign="top">1200</td></tr></tbody></table></table-wrap><table-wrap id="app2table2" position="float"><label>Appendix 2—table 2.</label><caption><title>Parameters of mean-field models.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top">Temperature (°C)</th><th align="left" valign="top">ID</th><th align="left" valign="top"><inline-formula><mml:math id="inf311"><mml:msub><mml:mi>J</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula></th><th align="left" valign="top"><inline-formula><mml:math id="inf312"><mml:msub><mml:mi>J</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula></th><th align="left" valign="top"><inline-formula><mml:math id="inf313"><mml:mi>I</mml:mi></mml:math></inline-formula></th><th align="left" valign="top"><inline-formula><mml:math id="inf314"><mml:msub><mml:mi>H</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula></th><th align="left" valign="top"><inline-formula><mml:math id="inf315"><mml:msub><mml:mi>H</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula></th><th align="left" valign="top"><inline-formula><mml:math id="inf316"><mml:msub><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula></th><th align="left" valign="top"><inline-formula><mml:math id="inf317"><mml:msub><mml:mi>K</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula></th></tr></thead><tbody><tr><td align="char" char="." valign="top">18</td><td align="char" char="." valign="top">12</td><td align="char" char="." valign="top">7.06</td><td align="char" char="." valign="top">7.23</td><td align="char" char="." valign="top">–0.6</td><td align="char" char="." valign="top">–3.66</td><td align="char" char="." valign="top">–3.63</td><td align="char" char="." valign="top">6.51</td><td align="char" char="." valign="top">8.03</td></tr><tr><td align="char" char="." valign="top">18</td><td align="char" char="." valign="top">13</td><td align="char" char="." valign="top">6.2</td><td align="char" char="." valign="top">7.84</td><td align="char" char="." valign="top">0.6</td><td align="char" char="." valign="top">–3.53</td><td align="char" char="." valign="top">–4.34</td><td align="char" char="." valign="top">3.18</td><td align="char" char="." valign="top">8.27</td></tr><tr><td align="char" char="." valign="top">18</td><td align="char" char="." valign="top">14</td><td align="char" char="." valign="top">7.27</td><td align="char" char="." valign="top">7.24</td><td align="char" char="." valign="top">0.31</td><td align="char" char="." valign="top">–3.88</td><td align="char" char="." valign="top">–3.99</td><td align="char" char="." valign="top">11.04</td><td align="char" char="." valign="top">10.74</td></tr><tr><td align="char" char="." valign="top">22</td><td align="char" char="." valign="top">2</td><td align="char" char="." valign="top">8.2</td><td align="char" char="." valign="top">8.28</td><td align="char" char="." valign="top">0.12</td><td align="char" char="." valign="top">–4.24</td><td align="char" char="." valign="top">–4.23</td><td align="char" char="." valign="top">6.65</td><td align="char" char="." valign="top">7.96</td></tr><tr><td align="char" char="." valign="top">22</td><td align="char" char="." valign="top">3</td><td align="char" char="." valign="top">8.18</td><td align="char" char="." valign="top">7.14</td><td align="char" char="." valign="top">0.55</td><td align="char" char="." valign="top">–4.26</td><td align="char" char="." valign="top">–4.13</td><td align="char" char="." valign="top">9.38</td><td align="char" char="." valign="top">5.24</td></tr><tr><td align="char" char="." valign="top">22</td><td align="char" char="." valign="top">5</td><td align="char" char="." valign="top">7.59</td><td align="char" char="." valign="top">7.01</td><td align="char" char="." valign="top">0.4</td><td align="char" char="." valign="top">–4.03</td><td align="char" char="." valign="top">–3.8</td><td align="char" char="." valign="top">5.56</td><td align="char" char="." valign="top">4.33</td></tr><tr><td align="char" char="." valign="top">22</td><td align="char" char="." valign="top">6</td><td align="char" char="." valign="top">7.13</td><td align="char" char="." valign="top">8.69</td><td align="char" char="." valign="top">1.1</td><td align="char" char="." valign="top">–4.49</td><td align="char" char="." valign="top">–4.64</td><td align="char" char="." valign="top">5.21</td><td align="char" char="." valign="top">7.12</td></tr><tr><td align="char" char="." valign="top">22</td><td align="char" char="." valign="top">7</td><td align="char" char="." valign="top">7.09</td><td align="char" char="." valign="top">7.46</td><td align="char" char="." valign="top">0.43</td><td align="char" char="." valign="top">–3.73</td><td align="char" char="." valign="top">–3.95</td><td align="char" char="." valign="top">6.28</td><td align="char" char="." valign="top">11.39</td></tr><tr><td align="char" char="." valign="top">22</td><td align="char" char="." valign="top">11</td><td align="char" char="." valign="top">7.82</td><td align="char" char="." valign="top">7.59</td><td align="char" char="." valign="top">–0.1</td><td align="char" char="." valign="top">–4.07</td><td align="char" char="." valign="top">–3.91</td><td align="char" char="." valign="top">8.28</td><td align="char" char="." valign="top">8.98</td></tr><tr><td align="char" char="." valign="top">22</td><td align="char" char="." valign="top">13</td><td align="char" char="." valign="top">6.54</td><td align="char" char="." valign="top">7.82</td><td align="char" char="." valign="top">1.45</td><td align="char" char="." valign="top">–4.29</td><td align="char" char="." valign="top">–4.5</td><td align="char" char="." valign="top">7.11</td><td align="char" char="." valign="top">18.46</td></tr><tr><td align="char" char="." valign="top">22</td><td align="char" char="." valign="top">14</td><td align="char" char="." valign="top">7.41</td><td align="char" char="." valign="top">8.03</td><td align="char" char="." valign="top">0.47</td><td align="char" char="." valign="top">–4.28</td><td align="char" char="." valign="top">–4.43</td><td align="char" char="." valign="top">10.91</td><td align="char" char="." valign="top">10.6</td></tr><tr><td align="char" char="." valign="top">26</td><td align="char" char="." valign="top">2</td><td align="char" char="." valign="top">8.37</td><td align="char" char="." valign="top">8.22</td><td align="char" char="." valign="top">–0.49</td><td align="char" char="." valign="top">–4.47</td><td align="char" char="." valign="top">–4.31</td><td align="char" char="." valign="top">9.72</td><td align="char" char="." valign="top">11.64</td></tr><tr><td align="char" char="." valign="top">26</td><td align="char" char="." valign="top">3</td><td align="char" char="." valign="top">8.42</td><td align="char" char="." valign="top">7.49</td><td align="char" char="." valign="top">0.53</td><td align="char" char="." valign="top">–4.56</td><td align="char" char="." valign="top">–4.62</td><td align="char" char="." valign="top">8.26</td><td align="char" char="." valign="top">4.61</td></tr><tr><td align="char" char="." valign="top">26</td><td align="char" char="." valign="top">4</td><td align="char" char="." valign="top">8.63</td><td align="char" char="." valign="top">6.44</td><td align="char" char="." valign="top">0.85</td><td align="char" char="." valign="top">–4.83</td><td align="char" char="." valign="top">–4.79</td><td align="char" char="." valign="top">10.37</td><td align="char" char="." valign="top">7.16</td></tr><tr><td align="char" char="." valign="top">26</td><td align="char" char="." valign="top">5</td><td align="char" char="." valign="top">7.29</td><td align="char" char="." valign="top">7.59</td><td align="char" char="." valign="top">0.48</td><td align="char" char="." valign="top">–3.92</td><td align="char" char="." valign="top">–4.14</td><td align="char" char="." valign="top">9.08</td><td align="char" char="." valign="top">7.06</td></tr><tr><td align="char" char="." valign="top">26</td><td align="char" char="." valign="top">6</td><td align="char" char="." valign="top">7.43</td><td align="char" char="." valign="top">7.86</td><td align="char" char="." valign="top">0.41</td><td align="char" char="." valign="top">–3.99</td><td align="char" char="." valign="top">–4.1</td><td align="char" char="." valign="top">8.59</td><td align="char" char="." valign="top">11.75</td></tr><tr><td align="char" char="." valign="top">26</td><td align="char" char="." valign="top">7</td><td align="char" char="." valign="top">7.55</td><td align="char" char="." valign="top">7.96</td><td align="char" char="." valign="top">0.32</td><td align="char" char="." valign="top">–4.08</td><td align="char" char="." valign="top">–4.22</td><td align="char" char="." valign="top">4.45</td><td align="char" char="." valign="top">8.06</td></tr><tr><td align="char" char="." valign="top">26</td><td align="char" char="." valign="top">11</td><td align="char" char="." valign="top">7.27</td><td align="char" char="." valign="top">7.45</td><td align="char" char="." valign="top">0.37</td><td align="char" char="." valign="top">–3.89</td><td align="char" char="." valign="top">–3.92</td><td align="char" char="." valign="top">10.31</td><td align="char" char="." valign="top">11.18</td></tr><tr><td align="char" char="." valign="top">26</td><td align="char" char="." valign="top">13</td><td align="char" char="." valign="top">6.99</td><td align="char" char="." valign="top">7.3</td><td align="char" char="." valign="top">0.6</td><td align="char" char="." valign="top">–3.99</td><td align="char" char="." valign="top">–3.94</td><td align="char" char="." valign="top">6.37</td><td align="char" char="." valign="top">16.55</td></tr><tr><td align="char" char="." valign="top">26</td><td align="char" char="." valign="top">14</td><td align="char" char="." valign="top">7.91</td><td align="char" char="." valign="top">7.35</td><td align="char" char="." valign="top">0.5</td><td align="char" char="." valign="top">–4.34</td><td align="char" char="." valign="top">–4.16</td><td align="char" char="." valign="top">11.32</td><td align="char" char="." valign="top">11.01</td></tr><tr><td align="char" char="." valign="top">30</td><td align="char" char="." valign="top">2</td><td align="char" char="." valign="top">7.54</td><td align="char" char="." valign="top">7.96</td><td align="char" char="." valign="top">–0.12</td><td align="char" char="." valign="top">–4.54</td><td align="char" char="." valign="top">–4.56</td><td align="char" char="." valign="top">7.02</td><td align="char" char="." valign="top">8.41</td></tr><tr><td align="char" char="." valign="top">30</td><td align="char" char="." valign="top">4</td><td align="char" char="." valign="top">8.36</td><td align="char" char="." valign="top">7.73</td><td align="char" char="." valign="top">0.11</td><td align="char" char="." valign="top">–4.52</td><td align="char" char="." valign="top">–4.18</td><td align="char" char="." valign="top">9.64</td><td align="char" char="." valign="top">6.66</td></tr><tr><td align="char" char="." valign="top">30</td><td align="char" char="." valign="top">5</td><td align="char" char="." valign="top">6.77</td><td align="char" char="." valign="top">6.42</td><td align="char" char="." valign="top">0.66</td><td align="char" char="." valign="top">–3.8</td><td align="char" char="." valign="top">–3.87</td><td align="char" char="." valign="top">9.18</td><td align="char" char="." valign="top">7.15</td></tr><tr><td align="char" char="." valign="top">30</td><td align="char" char="." valign="top">6</td><td align="char" char="." valign="top">7.35</td><td align="char" char="." valign="top">7.38</td><td align="char" char="." valign="top">0.45</td><td align="char" char="." valign="top">–3.91</td><td align="char" char="." valign="top">–3.97</td><td align="char" char="." valign="top">7.53</td><td align="char" char="." valign="top">10.3</td></tr><tr><td align="char" char="." valign="top">30</td><td align="char" char="." valign="top">7</td><td align="char" char="." valign="top">7.43</td><td align="char" char="." valign="top">8.07</td><td align="char" char="." valign="top">0.42</td><td align="char" char="." valign="top">–3.93</td><td align="char" char="." valign="top">–4.38</td><td align="char" char="." valign="top">7.09</td><td align="char" char="." valign="top">12.84</td></tr><tr><td align="char" char="." valign="top">30</td><td align="char" char="." valign="top">13</td><td align="char" char="." valign="top">6.91</td><td align="char" char="." valign="top">7.41</td><td align="char" char="." valign="top">0.73</td><td align="char" char="." valign="top">–4.13</td><td align="char" char="." valign="top">–4.03</td><td align="char" char="." valign="top">5.78</td><td align="char" char="." valign="top">15</td></tr><tr><td align="char" char="." valign="top">30</td><td align="char" char="." valign="top">14</td><td align="char" char="." valign="top">7.51</td><td align="char" char="." valign="top">7.45</td><td align="char" char="." valign="top">0.11</td><td align="char" char="." valign="top">–3.87</td><td align="char" char="." valign="top">–3.89</td><td align="char" char="." valign="top">9.42</td><td align="char" char="." valign="top">9.15</td></tr><tr><td align="char" char="." valign="top">30</td><td align="char" char="." valign="top">15</td><td align="char" char="." valign="top">8.01</td><td align="char" char="." valign="top">8.33</td><td align="char" char="." valign="top">0.58</td><td align="char" char="." valign="top">–4.45</td><td align="char" char="." valign="top">–4.46</td><td align="char" char="." valign="top">13.83</td><td align="char" char="." valign="top">17.26</td></tr><tr><td align="char" char="." valign="top">33</td><td align="char" char="." valign="top">14</td><td align="char" char="." valign="top">6.74</td><td align="char" char="." valign="top">7.02</td><td align="char" char="." valign="top">0.76</td><td align="char" char="." valign="top">–3.8</td><td align="char" char="." valign="top">–3.97</td><td align="char" char="." valign="top">9.32</td><td align="char" char="." valign="top">9.06</td></tr><tr><td align="char" char="." valign="top">33</td><td align="char" char="." valign="top">15</td><td align="char" char="." valign="top">6.99</td><td align="char" char="." valign="top">7.47</td><td align="char" char="." valign="top">–0.02</td><td align="char" char="." valign="top">–3.68</td><td align="char" char="." valign="top">–3.91</td><td align="char" char="." valign="top">14.85</td><td align="char" char="." valign="top">18.52</td></tr><tr><td align="char" char="." valign="top">33</td><td align="char" char="." valign="top">16</td><td align="char" char="." valign="top">7.53</td><td align="char" char="." valign="top">8.25</td><td align="char" char="." valign="top">–0.11</td><td align="char" char="." valign="top">–4.16</td><td align="char" char="." valign="top">–4.43</td><td align="char" char="." valign="top">14.43</td><td align="char" char="." valign="top">13.97</td></tr><tr><td align="char" char="." valign="top">33</td><td align="char" char="." valign="top">17</td><td align="char" char="." valign="top">6.66</td><td align="char" char="." valign="top">7.36</td><td align="char" char="." valign="top">0.45</td><td align="char" char="." valign="top">–3.69</td><td align="char" char="." valign="top">–3.89</td><td align="char" char="." valign="top">11.92</td><td align="char" char="." valign="top">32.69</td></tr></tbody></table></table-wrap><table-wrap id="app2table3" position="float"><label>Appendix 2—table 3.</label><caption><title>Parameters of mean-field models.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top"><italic>ID</italic></th><th align="left" valign="top"><inline-formula><mml:math id="inf318"><mml:msub><mml:mi>J</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula></th><th align="left" valign="top"><inline-formula><mml:math id="inf319"><mml:msub><mml:mi>J</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula></th><th align="left" valign="top"><inline-formula><mml:math id="inf320"><mml:mi>I</mml:mi></mml:math></inline-formula></th><th align="left" valign="top"><inline-formula><mml:math id="inf321"><mml:msub><mml:mi>H</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula></th><th align="left" valign="top"><inline-formula><mml:math id="inf322"><mml:msub><mml:mi>H</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula></th><th align="left" valign="top"><inline-formula><mml:math id="inf323"><mml:msub><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula></th><th align="left" valign="top"><inline-formula><mml:math id="inf324"><mml:msub><mml:mi>K</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula></th></tr></thead><tbody><tr><td align="char" char="." valign="top">1</td><td align="char" char="." valign="top">7.54</td><td align="char" char="." valign="top">7.35</td><td align="char" char="." valign="top">–0.67</td><td align="char" char="." valign="top">–3.75</td><td align="char" char="." valign="top">–3.44</td><td align="char" char="." valign="top">5.60</td><td align="char" char="." valign="top">3.43</td></tr><tr><td align="char" char="." valign="top">2</td><td align="char" char="." valign="top">7.10</td><td align="char" char="." valign="top">7.42</td><td align="char" char="." valign="top">0.64</td><td align="char" char="." valign="top">–3.69</td><td align="char" char="." valign="top">–4.02</td><td align="char" char="." valign="top">7.91</td><td align="char" char="." valign="top">12.82</td></tr><tr><td align="char" char="." valign="top">3</td><td align="char" char="." valign="top">7.51</td><td align="char" char="." valign="top">7.92</td><td align="char" char="." valign="top">–0.28</td><td align="char" char="." valign="top">–3.96</td><td align="char" char="." valign="top">–4.08</td><td align="char" char="." valign="top">4.98</td><td align="char" char="." valign="top">3.90</td></tr><tr><td align="char" char="." valign="top">4</td><td align="char" char="." valign="top">8.38</td><td align="char" char="." valign="top">6.25</td><td align="char" char="." valign="top">–0.04</td><td align="char" char="." valign="top">–3.68</td><td align="char" char="." valign="top">–3.18</td><td align="char" char="." valign="top">13.33</td><td align="char" char="." valign="top">4.44</td></tr><tr><td align="char" char="." valign="top">5</td><td align="char" char="." valign="top">8.73</td><td align="char" char="." valign="top">8.24</td><td align="char" char="." valign="top">0.01</td><td align="char" char="." valign="top">–4.38</td><td align="char" char="." valign="top">–4.13</td><td align="char" char="." valign="top">6.11</td><td align="char" char="." valign="top">6.89</td></tr><tr><td align="char" char="." valign="top">6</td><td align="char" char="." valign="top">7.87</td><td align="char" char="." valign="top">7.71</td><td align="char" char="." valign="top">0.51</td><td align="char" char="." valign="top">–4.17</td><td align="char" char="." valign="top">–4.09</td><td align="char" char="." valign="top">16.19</td><td align="char" char="." valign="top">15.52</td></tr></tbody></table></table-wrap></app></app-group></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.79541.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Sharpee</surname><given-names>Tatyana O</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03xez1567</institution-id><institution>Salk Institute for Biological Studies</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><related-object id="sa0ro1" object-id-type="id" object-id="10.1101/2022.02.02.478841" link-type="continued-by" xlink:href="https://sciety.org/articles/activity/10.1101/2022.02.02.478841"/></front-stub><body><p>The authors show how high-dimensional neural signals can be reduced to low-dimensional models with variables that can be directly linked to behavior. The reduced model can account for long time scales of persistent activity that arise from transitions between metastable model states. The authors further show that the rate of these transitions is modulated by water temperature according to the classic Arrhenius law, although the results for different temperatures could not yet be unified into a single description based on real external temperature.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.79541.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Sharpee</surname><given-names>Tatyana O</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03xez1567</institution-id><institution>Salk Institute for Biological Studies</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>Our editorial process produces two outputs: (i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2022.02.02.478841">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2022.02.02.478841v1">the preprint</ext-link> for the benefit of readers; (ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Emergence of time persistence in a data-driven neural network model&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 2 peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Joshua Gold as the Senior Editor. The reviewers have opted to remain anonymous.</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>(1) Please follow suggestions from reviewing on cross-validating model fitting</p><p>(2) Fitting the model across temperature values and discussing the relationship between the physical and model temperatures</p><p>(3) Analysis of temporal alignments between changes in the swim direction and the onset of sign change in the difference between the mean population activities of left and right hemispheres</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>1. Temporal alignment between neural activity and fish behavior.</p><p>Line 101: &quot;Impact of the bath temperature on the orientational persistence in freely swimming larvae&quot;.</p><p>The authors compare the statistics of their sign(m_L-m_R) to the statistics of swim bouts in a previous paper and show that the two variables are highly correlated. However, this is just an indirect observation since they didn't establish whether changes flips in sign(m_L-m_R) are temporally aligned to changes in the fish swimming direction when analyzed simultaneously. I believe this is an important missing link in the manuscript and I suggest that the authors show that this relationship holds at least in one example – although it'd be ideal to show this at different temperature, it is sufficient to show it for one particular temperature. The dataset in Figure 4 is appropriate for this extra analysis, which should be performed both during spontaneous and stimulated epochs.</p><p>Related to this issue: what is the probability of having a change in swim direction, without a flip of sign(m_L-m_R)? And vice versa, what is the probability of having a flip of sign(m_L-m_R) without a change in swim direction?</p><p>Also related, what is the distribution of intervals between changes in the swim bout directions? If these behavioral observable is faster than the temporal resolution of the calcium indicator dynamics, this might introduce some statistical biases in the analysis.</p><p>2. Cross-validation</p><p>Line 143: &quot;Inference of an Ising model from functional recordings of the ARTR.&quot; The authors fit an Ising model to the data showing that it captures various observables in the data. However, the model is not cross-validated. The authors should use standard cross-validation procedures to establish the goodness of fit of the various observables on held-out data. In all plots in Figure 2C-F and Appendix 2 Figure 2B-E results should be replaced with a comparison with held-out data not used to fit the model.</p><p>Moreover, what is the null hypothesis here? The authors should compare the held-out performance of their model to shuffled models trained on surrogate datasets obtained eg by destroying pairwise correlations.</p><p>3. Definition of temperature in the model</p><p>It is not explained at all how the water temperature appears in the model. Is it a missing 1/T factor in Equation (1)? This is a central issue the authors should be very clear about. What's a bit confusing is that the authors define &quot;inverse temperature&quot; as the effective size K, but there's no mention of the actual water temperature at all.</p><p>Line 234-236: In the Langevin formalism, the diffusion constant D usually appears in the noise autocorrelation function = 2*D*δ(t-t'). This is usually taken to be equal to the temperature (inverse β) in the partition function (which is missing from its definition!). How are the statistical mechanical temperature and the actual water temperature entering here? This is very confusing, I strongly urge the authors to clarify this point.</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>This is a beautiful study that combines physics with biology, treating a biological network as an inorganic system, by minimizing its free energy and maximizing entropy. It answers a lot of questions and hints at a valuable wider applicability of this approach. At the same time I am somewhat confused about the approach the authors have taken to fitting the models, explained below, and it would be good to have a conversation about that and possibly adjust some details of the approach, or to clarify. With appropriate revisions or clarifications this work would be a strong candidate for the journal.</p><p>Comments, questions, suggestions, and concerns:</p><p>1. I am puzzled why the authors fit the Ising model (and the mean field model) separately for every temperature. There are ways to include temperature directly into the model – for example, Ising models have an intrinsic dependence on (an abstracted) temperature, that is not included in equation 1 (line 157), where in typical formulations P(σ) = exp(-β*H(σ)) / Z, where β = 1/(k_b * T), so that the couplings J and biases h get naturally scaled by the temperature T, and the distribution over configurations σ becomes flatter with higher T. Of course the correspondence between the real ARTR and the real temperature, and the Ising model and the model temperature, should not be taken too literally. But qualitatively there may be an analogous effect, namely a reduction of effective couplings and a reduction in biases with increasing T, and a resulting flattening of the distribution over configurations (σ), producing a more &quot;disordered&quot; network with less coherence and shorter time constants. An alternative would be to treat temperature, or a function of temperature, as an input to the model, for example through the modified bias term h in the energy hamiltonian. Either of these seems more systematic than re-estimating the couplings and biases for every temperature, can the authors explain why they did it that way?</p><p>(I could not spot a systematic dependence on T of the parameters in Appendix 2 table 2 but as the authors explain, fitting the couplings and the biases can be hard to disentangle, however their comment &quot;This owes to a progressive change in the values of both the couplings and the biases&quot; suggests a systematic change, which I could not spot. However it could still work to incorporate a 1/T dependence explicitly.)</p><p>2. Then the traces in Figure 2A-D seem consistent with a loss of correlation amongst individual neurons in ARTR clusters, because the average becomes smaller (suggesting less coherence), but it is unclear because the Y units are &quot;a.u.&quot;. We would need to know that the Y axis units in A is the same as that in B, and that the Y axis in C is the same as in D. Since the Y axes are labeled &quot;a.u.&quot; so I am not sure whether this is the case. There is no reason not to provide true units (∆F/F for A,B, and average value for C,D) so that this comparison is possible.</p><p>3. Assuming my understanding of the above is correct, then, if the temperature dependence is incorporated in the model through for example the 1/T dependence or through the biases, it should be possible to fit the model at one temperature and then predict model behavior at all other temperatures. With this interpretation, the inclusion of multiple temperatures serves more as a &quot;cross validation&quot; of the model. I would find this a more convincing demonstration of the utility of the Ising model for network dynamics than what is currently demonstrated (i.e. more convincing than training on all temperatures and testing on all temperatures). This is analogous to the other strength of the model touted by the authors, namely that training on low-order statistics reproduces the higher-order statistics.</p><p>I realize that the temperature parameter T may not only reflect bath temperature, but also other factors like neuromodulatory inputs from the rest of the brain that depend on temperature, as the authors describe in the Discussion. Nevertheless, I think this should be attempted, even if the model T ends up scaling for example supralinearly with bath temperature, for example, T = bath-temperature + other-influences-that-are-a-function-of-T.</p><p>The same comments generalize to the mean field model. That is, I think it should be attempted to fit both the Ising and the mean field models to all temperatures and have the couplings and biases scale with 1/T (or 1/f(T) with f describing a combined dependence on bath temperature and other influences) or incorporate T into the biases as an external drive, instead of fitting the parameters separately for every temperature (of course individual fish should be fit separately). Then the held-out temperatures can serve for cross validation.</p><p>4. The way the Ising model is turned into something from which temporal dynamics can be read off is through the Monte Carlo sampler. This seems reasonable and elegant given what I understand about MC samplers and I trust it makes sense, but the paper explains the workings of the MC sampler poorly. There is a reference to some code online, but text providing the reader with a good intuition, or pseudocode, is missing. Given the importance of the MC sampler, the explanation of it, and why it can be interpreted as time evolution on long timescales, should be much more central.</p><p>5. Thus the interpretation of the Ising-ARTR correspondence seems to be first, that in both cases, less &quot;coherence&quot; between the units leads to longer time constants (under MC sampling in the model), and second, that increasing temperatures lead to less &quot;coherence&quot;, thus linking temperature to time constants. If this is right, it would be useful to spell this out more clearly.</p><p>6. The Ising model is proposed to be a good model of ARTR network dynamics, and the model neurons (let's call these particles, for clarity, and call ARTR neurons, neurons) are fit to individual ARTR neurons. For readers, it would be very useful to see a graphical comparison of the dynamics of the particles, at the population level, and the dynamics of individual neurons, also at the population level. The Methods state that the mean and variance of each is fit but readers need a more personalized intuition for what the model looks like in comparison to the biological network. Although Appendix 2 Figure 1 and Appendix 2 Figures 2A(5) goes some way to depict the Ising particles and the real neurons, I think that having an elaborated population representation comparison figure in the main text would be useful, just for readers to visualize.</p><p>7. Line 165 &quot;contralateral couplings vanish on average&quot;, also mentioned in the Discussion, seems strange because I would expect that contralateral couplings are on average negative. How does this fit in with contralateral inhibition? (As an aside, for biologists, the word vanish might be unclear and a different way of describing it might be better.) The discussion also says that the couplings are almost null but drive a subtle interplay. It seems to me that readers need to know if they are small but overall negative, or whether they can be small and overall positive; the latter would be hard to interpret but the former would be more straightforward to interpret. Why is the significance not quantified statistically?</p><p>8. The ARTR consists of excitatory and inhibitory clusters, as the authors describe, and refer to the Ising couplings, but I did not see a clear depiction or quantification of whether these couplings segregate, only a passing mention in the Discussion (lines 409-415). Can the authors depict the network connectivity accordingly, as particles with signed weights between them, and compared to their location in the brain?</p><p>9. In some ways, it is surprising that the behavior changes so much with temperature, because the field has learned from Eve Marder's group that network dynamics tend to be surprisingly robust to &quot;crude&quot; perturbations of the entire network. It is possible that it was difficult for evolution to compensate for the temperature dependence of ARTR, but it is also worth thinking about whether there might be an ethological purpose for the temperature dependence. Could it be useful for the animal to alternate turn direction more often when it's warm?</p><p>10. The phrasing &quot;orientational persistence&quot; came across as a bit of a misnomer to me, though I might be wrong – orientation typically means the angle of the animal in its environment, whereas this is about the change in angle, so orientation persistence might be interpreted by a casual reader as the fish swimming in a straight line at a fixed angle. I am not sure what else to call it though – &quot;turn direction persistence&quot; is probably more accurate but also clumsier. Is there a better term? If you decide to keep using &quot;orientational persistence&quot; it would be useful to very carefully and explicitly explain what you mean by it.</p><p>11. Cold-blooded animals have a body temperature that quickly converges to that of their surroundings (especially tiny fish). Their neural populations will likely experience a wider range of temperature fluctuation and therefore follow certain thermal dynamics laws unlike any warm-blooded animals (such that the flipping rate increases with temperature following Arrhenius law). It is important to discuss if the time persistence that emerges from the network model is a special case for cold-blooded animals experiencing different temperatures (through the 1/(kB*T) scaling of the couplings and biases), a direct thermal effect, rather than &quot;purposeful&quot; neural network computation (through external inputs that could be modeled by making the biases depend on T).</p><p>12. It is therefore good to discuss how applicable this free energy landscape description of a neural network is to other neural networks with persistent activities in other animal models, with different sensory inputs, in order to reach a larger audience and have wider potential applications. What types of time persistence can this interpretation address and what are its limitations?</p><p>13. Line 9: &quot;networks&quot; should probably be &quot;network&quot;.</p><p>14. Figure 1 C and G: labeling the colors by their temperature in the figure would be helpful.</p><p>15. Line 246, it is Figure 3B showing the energy landscape, not 3C.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.79541.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>(1) Please follow suggestions from reviewing on cross-validating model fitting</p><p>(2) Fitting the model across temperature values and discussing the relationship between the physical and model temperatures</p><p>(3) Analysis of temporal alignments between changes in the swim direction and the onset of sign change in the difference between the mean population activities of left and right hemispheres</p></disp-quote><p>We have followed these recommendations to write our amended manuscript. In particular, we now:</p><p>(1) include a systematic cross-validation of the inferred models following the comments by Reviewer 1. We show the predictions of the model (for observables such as the mean activity and the pairwise correlations, and for log-likelihoods) in the figures on the main text, e.g. figure 3A, as well as in the appendix figure 3.</p><p>(2) explain why we have fitted a model for each water temperature and each fish, and carry out a systematic comparison of the models inferred at different water temperatures for the same fish. We have added a new figure 3B to show the absence of correlation between models corresponding to different water temperatures. We have also included a new section in the Discussion, entitled “Origin and functional significance of the temperature dependence of the ARTR dynamics” to better discuss the role of temperature on the activity. We have also slightly rewritten the introduction of the model in the Results section to better distinguish the notions of water temperature and model temperature (implicitly set by the amplitude of the J,h parameters), as our first manuscript could be confusing on this point.</p><p>(3) point out the exact figure in Dunn et al., eLife 2016 in which the authors demonstrate that the sign of the difference in activity of the right and left ARTR populations dictates the swim direction. Replicating these observations would thus be redundant but would also require a different and more complex experimental setup. Indeed, they were obtained by recording fictive turns using electrical recordings from peripheral motor nerves in paralysed larvae, as actual tail bouts tend to occur at very low frequency in tethered configurations.</p><disp-quote content-type="editor-comment"><p>Reviewer #1 (Recommendations for the authors):</p><p>1. Temporal alignment between neural activity and fish behavior.</p><p>Line 101: &quot;Impact of the bath temperature on the orientational persistence in freely swimming larvae&quot;.</p><p>The authors compare the statistics of their sign(m_L-m_R) to the statistics of swim bouts in a previous paper and show that the two variables are highly correlated. However, this is just an indirect observation since they didn't establish whether changes flips in sign(m_L-m_R) are temporally aligned to changes in the fish swimming direction when analyzed simultaneously. I believe this is an important missing link in the manuscript and I suggest that the authors show that this relationship holds at least in one example – although it'd be ideal to show this at different temperature, it is sufficient to show it for one particular temperature. The dataset in Figure 4 is appropriate for this extra analysis, which should be performed both during spontaneous and stimulated epochs.</p><p>Related to this issue: what is the probability of having a change in swim direction, without a flip of sign(m_L-m_R)? And vice versa, what is the probability of having a flip of sign(m_L-m_R) without a change in swim direction?</p></disp-quote><p>We agree with the reviewer that the relation between the change in swim turn direction and the neuronal switch between the left and right ARTR subpopulations, is central to the proposed scenario. This relationship has been previously established by Dunn et al. in their <italic>eLife</italic> article (Dunn 2016). Below we reproduce the panel E of figure 5 —figure supplement 2 from this article, which precisely demonstrates the robust correlation that exists between <italic>m<sub>L</sub>-m<sub>R</sub></italic> and the turning direction. Notice that to obtain these results, the authors recorded fictive turns using electrical recordings from peripheral motor nerves on both sides of the tail of paralysed larvae, as actual tail bouts tend to occur at very low frequency in tethered configurations. In 2017, we also indirectly confirmed this relationship by establishing that <italic>m<sub>L</sub>-m<sub>R</sub></italic> was a strong predictor of the gaze direction, and that the latter was strongly correlated with the tail bout orientations (Wolf et al. 2017).</p><p>We modified the manuscript to clarify this point by explicitly referring to this figure:</p><p>line 111-114</p><p>“It has previously been shown that the ARTR governs the selection of swim bout orientations: turn bouts are preferentially executed in the direction of the most active (right or left) ARTR subcircuit (Dunn et al., 2016, Wolf et al., 2017), such that sign <inline-formula><mml:math id="sa2m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> constitutes a robust predictor of the turning direction of the animal, see figure 5 —figure supplement 2E in (Dunn et al., 2016).”</p><disp-quote content-type="editor-comment"><p>Also related, what is the distribution of intervals between changes in the swim bout directions? If these behavioral observable is faster than the temporal resolution of the calcium indicator dynamics, this might introduce some statistical biases in the analysis.</p></disp-quote><p>The distributions of orientational persistence times, as measured experimentally, are shown in <xref ref-type="fig" rid="sa2fig1">Author response image 1</xref>. Since two separate turning swim bouts are needed to detect a change in turn direction, this distribution shows a rapid decay for T&lt;1s, which is the mean interbout interval. The left-right alternation process thus occurs on time scales that are particularly well adapted to calcium imaging, whose temporal resolution after spike inference is of the order of a few hundreds of ms.</p><fig id="sa2fig1" position="float"><label>Author response image 1.</label><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79541-sa2-fig1-v2.tif"/></fig><disp-quote content-type="editor-comment"><p>2. Cross-validation</p><p>Line 143: &quot;Inference of an Ising model from functional recordings of the ARTR.&quot; The authors fit an Ising model to the data showing that it captures various observables in the data. However, the model is not cross-validated. The authors should use standard cross-validation procedures to establish the goodness of fit of the various observables on held-out data. In all plots in Figure 2C-F and Appendix 2 Figure 2B-E results should be replaced with a comparison with held-out data not used to fit the model.</p><p>Moreover, what is the null hypothesis here? The authors should compare the held-out performance of their model to shuffled models trained on surrogate datasets obtained eg by destroying pairwise correlations.</p></disp-quote><p>In order to answer this important point, we include in the revised version of the paper a systematic cross-validation of the inferred models summarized in Appendix 2 Figure 3.</p><p>Indeed for each experiment, we divided the data sets in two parts: 75% of each data set is used as a training set and the remaining 25% is used as a test set. Each training set is used to infer an Ising model. We then compare the mean activity and covariance of the test set with the one computed from the simulated data generated by the models (see Appendix 2 Figure 3A-B). We also computed the relative variation of the models' log likelihood computed on the training data and the test data (see Appendix 2 Figure 3C). The very weak value of this relative variation confirms the quality of the fits.</p><p>Moreover, as suggested by the reviewer, we decided to use the independent model as a null hypothesis. We thus compared the Ising models fitted on the data with the independent model. The independent model only depends on the firing rates of the neurons. We then compare the mean activity and covariance of the test set with the one computed from the simulated data generated by the independent models (see Appendix 2 Figure 3E-G). As expected, these independent models with no connections poorly reproduce the data. The excess log likelihood confirms this result (Appendix 2 Figure 3G). Indeed, the relative variation, between the Ising and the independent models, of the log likelihood computed on the training data and the test data is around 50%.</p><p>In addition, we also followed the reviewer’s suggestion and computed the KL divergence in Figure 3 using the test sets. Indeed, the distribution of the KL divergence between the experimental test datasets and their associated Ising models is much smaller than those obtained between experimental test datasets and Ising models trained on different recordings (red distribution). We also added, for comparison, the distribution of KL divergence obtained using independent models, which demonstrate the importance of interneuronal connections to reproduce the data.</p><p>line 206–209</p><p>“This agreement crucially relies on the presence of inter-neuronal couplings in order to reproduce the pairwise correlations in the activity: a model with no connection (i.e. the independent model, see Methods) fitted to reproduce the neural firing rates, offers a very poor description of the data, see Figure 3A (dark blue distribution) and Appendix 2 Figure 3E-G.”</p><disp-quote content-type="editor-comment"><p>3. Definition of temperature in the model</p><p>It is not explained at all how the water temperature appears in the model. Is it a missing 1/T factor in Equation (1)? This is a central issue the authors should be very clear about. What's a bit confusing is that the authors define &quot;inverse temperature&quot; as the effective size K, but there's no mention of the actual water temperature at all.</p><p>Line 234-236: In the Langevin formalism, the diffusion constant D usually appears in the noise autocorrelation function = 2*D*δ(t-t'). This is usually taken to be equal to the temperature (inverse β) in the partition function (which is missing from its definition!). How are the statistical mechanical temperature and the actual water temperature entering here? This is very confusing, I strongly urge the authors to clarify this point.</p></disp-quote><p>We agree that the previous version of the manuscript was not clear enough in the definition and introduction of temperature(s). In the new version, we make clear that temperature refers to the temperature of water, and denote this quantity by T.</p><p>Regarding the Ising distribution defined in Equation (1), we implicitly set the model temperature T_model to 1, which amounts to omitting it in Equation (1). Considering a different value for T_model would simply amount to rescaling the biases and couplings parameters by the same quantity, and would not affect the model distribution.</p><p>The fact that the model temperature T_model is equal to unity is consistent with the distribution of left and right activities in Equation (3) and the Langevin dynamics in Equation (4), see covariance of the noise epsilon, which is 2* δ(t-t’). As stressed by the referee, the covariance should be equal to 2 * T_model * δ(t-t’), hence our expression corresponds to T_model=1.</p><p>We now clearly state after Equation 1 that the model temperature is set to one throughout the paper.</p><p>line 172–174</p><p>“Notice that in Equation 1, the energy term in the parenthesis is not scaled by a thermal energy as in the Maxwell–Boltzmann statistics. We thus implicitly fix the model temperature to unity; of course, this model temperature has no relation with the water temperature <italic>T</italic>.”</p><p>The use of the vocable inverse temperature (which was done with quotation marks) in Appendix right after Equation (18) to design the sizes K<sub>L</sub>, K<sub>R</sub> was very confusing, and we apologize for that. We simply meant that, as the sizes K enter multiplicatively the free-energy F they could be formally interpreted as effective inverse temperatures in the Boltzmann factor e<sup>-F</sup>. We have removed this confusing part of the sentence, and hope that the current formulation is more clear.</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>This is a beautiful study that combines physics with biology, treating a biological network as an inorganic system, by minimizing its free energy and maximizing entropy. It answers a lot of questions and hints at a valuable wider applicability of this approach. At the same time I am somewhat confused about the approach the authors have taken to fitting the models, explained below, and it would be good to have a conversation about that and possibly adjust some details of the approach, or to clarify. With appropriate revisions or clarifications this work would be a strong candidate for the journal.</p><p>Comments, questions, suggestions, and concerns:</p><p>1. I am puzzled why the authors fit the Ising model (and the mean field model) separately for every temperature. There are ways to include temperature directly into the model – for example, Ising models have an intrinsic dependence on (an abstracted) temperature, that is not included in equation 1 (line 157), where in typical formulations P(σ) = exp(-β*H(σ)) / Z, where β = 1/(k_b * T), so that the couplings J and biases h get naturally scaled by the temperature T, and the distribution over configurations σ becomes flatter with higher T. Of course the correspondence between the real ARTR and the real temperature, and the Ising model and the model temperature, should not be taken too literally. But qualitatively there may be an analogous effect, namely a reduction of effective couplings and a reduction in biases with increasing T, and a resulting flattening of the distribution over configurations (σ), producing a more &quot;disordered&quot; network with less coherence and shorter time constants. An alternative would be to treat temperature, or a function of temperature, as an input to the model, for example through the modified bias term h in the energy hamiltonian. Either of these seems more systematic than re-estimating the couplings and biases for every temperature, can the authors explain why they did it that way?</p><p>(I could not spot a systematic dependence on T of the parameters in Appendix 2 table 2 but as the authors explain, fitting the couplings and the biases can be hard to disentangle, however their comment &quot;This owes to a progressive change in the values of both the couplings and the biases&quot; suggests a systematic change, which I could not spot. However it could still work to incorporate a 1/T dependence explicitly.)</p></disp-quote><p>In the new manuscript we have made clearer that β is a rescaling parameter, which is integrated in the inferred value of couplings, see answer to Major point 3 of Reviewer 1.</p><p>line 172–174</p><p>“Notice that in Equation 1, the energy term in the parenthesis is not scaled by a thermal energy as in the Maxwell–Boltzmann statistics. We thus implicitly fix the model temperature to unity; of course, this model temperature has no relation with the water temperature <italic>T</italic>.”</p><p>In addition, we now show in Appendix 2 Figure 6 some scatter plots of the couplings and biases at different temperatures for one fish, as well as statistics for all fish. These results clearly indicate the absence of any strong correlation between the Ising parameters at different temperatures (for the same animal). As a consequence, there is no simple global rescaling between the Ising parameters attached to two water temperatures. This is why we have fitted a model for each data set.</p><p>line 228–233</p><p>“We next examined the dependency of the Ising model parameters on the water temperature. To do so, for each fish, we selected two different water temperatures, and the corresponding sets of inferred biases and couplings, <italic>{h<sub>i</sub>, J<sub>ij</sub></italic>}. We then computed the Pearson correlation coefficient <italic>R<sup>2</sup></italic> of the biases and of the coupling matrices at these two temperatures (inset of Appendix 2 Figure 6). We saw no clear correlation between the model parameters at different temperatures, as shown by the distribution of <italic>R<sup>2</sup></italic> computed across fish and across every temperatures (Appendix 2 Figure 6).”</p><disp-quote content-type="editor-comment"><p>2. Then the traces in Figure 2A-D seem consistent with a loss of correlation amongst individual neurons in ARTR clusters, because the average becomes smaller (suggesting less coherence), but it is unclear because the Y units are &quot;a.u.&quot;. We would need to know that the Y axis units in A is the same as that in B, and that the Y axis in C is the same as in D. Since the Y axes are labeled &quot;a.u.&quot; so I am not sure whether this is the case. There is no reason not to provide true units (∆F/F for A,B, and average value for C,D) so that this comparison is possible.</p></disp-quote><p>The notation a.u. was misleading, as we are showing the time trace of the mean (over each region) of the binarized activity. The axis labels have been corrected in Figure 2 (beware that the numbers of the panels have changed with respect to the first version of the manuscript).</p><disp-quote content-type="editor-comment"><p>3. Assuming my understanding of the above is correct, then, if the temperature dependence is incorporated in the model through for example the 1/T dependence or through the biases, it should be possible to fit the model at one temperature and then predict model behavior at all other temperatures. With this interpretation, the inclusion of multiple temperatures serves more as a &quot;cross validation&quot; of the model. I would find this a more convincing demonstration of the utility of the Ising model for network dynamics than what is currently demonstrated (i.e. more convincing than training on all temperatures and testing on all temperatures). This is analogous to the other strength of the model touted by the authors, namely that training on low-order statistics reproduces the higher-order statistics.</p></disp-quote><p>In the new manuscript, we include in the revised version of the paper a systematic cross-validation of the inferred models summarized in Appendix 2 Figure 3, see Point 2 in the Answer to Reviewer 1. Note that this cross validation is done at each temperature separately. We discuss the putative relationship between models at different temperatures below.</p><p>line 644–658</p><p>“We cross-validated the Ising models (see Appendix Figure 3) dividing the data sets in two parts: for each experiment, 75% of each data set is used as a training set and the remaining 25% is used as a test set. Each training set is used to infer an Ising model. We then compare the mean activity and covariance of the test set with the one computed from the simulated data generated by the models…” (see manuscript)</p><disp-quote content-type="editor-comment"><p>I realize that the temperature parameter T may not only reflect bath temperature, but also other factors like neuromodulatory inputs from the rest of the brain that depend on temperature, as the authors describe in the Discussion. Nevertheless, I think this should be attempted, even if the model T ends up scaling for example supralinearly with bath temperature, for example, T = bath-temperature + other-influences-that-are-a-function-of-T.</p><p>The same comments generalize to the mean field model. That is, I think it should be attempted to fit both the Ising and the mean field models to all temperatures and have the couplings and biases scale with 1/T (or 1/f(T) with f describing a combined dependence on bath temperature and other influences) or incorporate T into the biases as an external drive, instead of fitting the parameters separately for every temperature (of course individual fish should be fit separately). Then the held-out temperatures can serve for cross validation.</p></disp-quote><p>Varying the water temperature was done here to investigate how the ARTR circuit persistent dynamics could be modeled across different behavioral conditions. The use of Ising is obviously not limited to this particular experimental protocol, which is of course adequate for cold-blooded animals only.</p><p>In general, we do not expect that the Ising models corresponding to different conditions can be related to each other in a simple way, e.g. through a global rescaling of the biases and/or of the couplings. However, we agree with Reviewer 2 that it is legitimate to attempt at relating the models inferred from the recordings at different water temperatures. We have done so in two ways:</p><p>– We have directly compared the couplings and biased inferred from the recordings of activity at different water temperatures for the same fish. Results are shown in Appendix 2 Figure 6, and show no clear interrelation between the parameters corresponding to different temperatures, as would be the case if parameters would transform according to a simple global rescaling.</p><p>– To confirm this finding, following the recommendations of Reviewer 2, we have carried out the following computation. We first infer the parameters h<sub>i</sub> , J<sub>ij</sub> of an Ising model from the recording of a fish at water temperature T. Then we rescale these parameters as a x h<sub>i</sub> , b x J<sub>ij</sub> and we generate synthetic activity with these rescaled ising models. We then compute the KL divergence between the distribution of activity defined by this rescaled Ising model and the recorded data at another temperature T’ (for the same fish). We then minimize this KL divergence over the global rescaling factors a and b in the [0.5;1.5] ranges, and compare this lowest divergence to the one between the same recorded data (at temperature T’) and the Ising model inferred from those data (as shown in Figure 3A of the main text). Ratios of these KL divergences are reported in <xref ref-type="fig" rid="sa2fig2">Author response image 2</xref>. These results show that the global rescalings of the parameters inferred from data at temperature T cannot reproduce correctly the data at another temperature T’.</p><fig id="sa2fig2" position="float"><label>Author response image 2.</label><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79541-sa2-fig2-v2.tif"/></fig><disp-quote content-type="editor-comment"><p>4. The way the Ising model is turned into something from which temporal dynamics can be read off is through the Monte Carlo sampler. This seems reasonable and elegant given what I understand about MC samplers and I trust it makes sense, but the paper explains the workings of the MC sampler poorly. There is a reference to some code online, but text providing the reader with a good intuition, or pseudocode, is missing. Given the importance of the MC sampler, the explanation of it, and why it can be interpreted as time evolution on long timescales, should be much more central.</p></disp-quote><p>We give now the details of the MC sampler in the main text and in methods of the revised version.</p><p>line 179-186</p><p>“The algorithm starts from a random configuration of activity, then picks up uniformly at random a neuron index, say, <italic>i</italic>. The activity <italic>s<sub>i</sub></italic> of neuron <italic>i</italic> is then stochastically updated to 0 or to 1, with probabilities that depend on the current states <italic>s<sub>i</sub></italic> of the other neurons (see Equation 8} in Methods, and code provided). The sampling procedure is iterated, ensuring convergence towards the distribution <italic>P</italic> in Equation 1. This <italic>in silico</italic> MC dynamics is not supposed to reproduce any realistic neural dynamics, except for the locality in the activity configuration <bold>s</bold> space.”</p><p>line 634-643</p><p>“In order to generate synthetic activity, we resorted to Gibbs sampling, a class of Monte Carlo Markov Chain method, also known as Glauber dynamics…” (see manuscript)</p><disp-quote content-type="editor-comment"><p>5. Thus the interpretation of the Ising-ARTR correspondence seems to be first, that in both cases, less &quot;coherence&quot; between the units leads to longer time constants (under MC sampling in the model), and second, that increasing temperatures lead to less &quot;coherence&quot;, thus linking temperature to time constants. If this is right, it would be useful to spell this out more clearly.</p></disp-quote><p>The origin of the dependence of the persistence time on water temperature is rather subtle. We think that this dependence is not directly related to a change of the correlation structure in the activity. To support this point we provide a new panel (Appendix 2 figure 2C) showing that no significant relation between the average correlations and the temperature exists.</p><p>However, as our mean-field analysis shows, barriers increase with temperature, see Figure 4E, a fact that may appear counterintuitive at first sight. As a consequence, at high temperature, only the low-low activity state is accessible in practice to the system, and the mean activity remains low, see Appendix 2 Figure 2B, with fluctuations within the low-low state. Conversely, at low water temperatures, barriers separating the low-low and the high-low (or low-high) states are weaker, so the active states are accessible. This has two consequences. First, the mean activity is higher at low temperature (Appendix 2 Figure 2B). Second, the system may remain trapped for some time in such an active state before switching to the other side, and reversing activity. This is the origin of the longer persistence at low temperature.</p><p>We have improved the manuscript to make these points clearer, see end of section “Barriers in the free-energy landscape and dynamical paths between states”.</p><p>line 306-313</p><p>“As a consequence, at high temperature, only the low-low activity state is accessible in practice to the system, and the mean activity remains low, see Appendix 2 Figure 2D, with fluctuations within the low-low state. Conversely, at low water temperatures, barriers separating the low-low and the active high-low or low-high states are weaker, so the latter become accessible. As a first consequence, the mean activity is higher at low temperature (Appendix 2 Figure 2D). Furthermore, the system remains trapped for some time in such an active state before switching to the other side, e.g. from high-low to low-high. This is the origin of the longer persistence time observed at low temperature.”</p><disp-quote content-type="editor-comment"><p>6. The Ising model is proposed to be a good model of ARTR network dynamics, and the model neurons (let's call these particles, for clarity, and call ARTR neurons, neurons) are fit to individual ARTR neurons. For readers, it would be very useful to see a graphical comparison of the dynamics of the particles, at the population level, and the dynamics of individual neurons, also at the population level. The Methods state that the mean and variance of each is fit but readers need a more personalized intuition for what the model looks like in comparison to the biological network. Although Appendix 2 Figure 1 and Appendix 2 Figures 2A(5) goes some way to depict the Ising particles and the real neurons, I think that having an elaborated population representation comparison figure in the main text would be useful, just for readers to visualize.</p></disp-quote><p>We agree with Reviewer 2 that such a representation is useful. We now show in Figure 2 of the main text raster plots of the activity in the recording (panel A) and in the simulated Ising dynamics (panel C). We also provide in the supplementary materials the same comparison for every recording.</p><disp-quote content-type="editor-comment"><p>7. Line 165 &quot;contralateral couplings vanish on average&quot;, also mentioned in the Discussion, seems strange because I would expect that contralateral couplings are on average negative. How does this fit in with contralateral inhibition? (As an aside, for biologists, the word vanish might be unclear and a different way of describing it might be better.) The discussion also says that the couplings are almost null but drive a subtle interplay. It seems to me that readers need to know if they are small but overall negative, or whether they can be small and overall positive; the latter would be hard to interpret but the former would be more straightforward to interpret. Why is the significance not quantified statistically?</p></disp-quote><p>We now provide a detailed analysis on both contralateral correlation and couplings in the Appendix 2 Figure 4. Indeed we show that strong negative correlation and couplings systematically correspond to pairs of contralateral neurons. We provide in the main text a paragraph on this point.</p><p>line 218-222</p><p>“… computing the fraction of neuronal pairs (<italic>i,j</italic>) that are contralateral for each value of the coupling <italic><bold>J</bold><sub>ij</sub></italic> or the Pearson correlation (Appendix 2 Figure 4D-E). Large negative values of couplings or correlations systematically correspond to contralateral pairs of neurons, whereas large positive values correspond to ipsilateral pairs of neurons.”</p><disp-quote content-type="editor-comment"><p>8. The ARTR consists of excitatory and inhibitory clusters, as the authors describe, and refer to the Ising couplings, but I did not see a clear depiction or quantification of whether these couplings segregate, only a passing mention in the Discussion (lines 409-415). Can the authors depict the network connectivity accordingly, as particles with signed weights between them, and compared to their location in the brain?</p></disp-quote><p>We do not see a spatial organization in the inferred couplings that would reflect the neuronal type organization. We stress that the relationship between the inferred couplings <italic><bold>J</bold><sub>ij</sub></italic> and the true physiological interactions is subtle. For instance, in our model, couplings are symmetric, which makes the distinction between inhibitory and excitatory neurons uneasy. In addition, the sampling time bin is long compared to synaptic integrations times, which makes causal dependencies hard to infer even with models where connections are not a priori required to be symmetric, see for instance Figure 7b and related discussion in a previous publication by two of us (SC,RM): J Comput Neurosci DOI 10.1007/s10827-010-0306-8</p><disp-quote content-type="editor-comment"><p>9. In some ways, it is surprising that the behavior changes so much with temperature, because the field has learned from Eve Marder's group that network dynamics tend to be surprisingly robust to &quot;crude&quot; perturbations of the entire network. It is possible that it was difficult for evolution to compensate for the temperature dependence of ARTR, but it is also worth thinking about whether there might be an ethological purpose for the temperature dependence. Could it be useful for the animal to alternate turn direction more often when it's warm?</p></disp-quote><p>The reviewer is right that some networks have evolved to maintain robust dynamics across a large thermal range. However, this is rather the exception than the rule, and even the frequency of the pyloric rhythm of the crab, studied by Marder, increases with temperature (although the phase is maintained).</p><p>Regarding whether or not the thermal dependence in ARTR dynamics is favorable for the animal, it is hard to conclude as many other kinematic features are also modified, as we have quantified recently. These different points are now discussed in a new section of the discussion.</p><p>line 379-400</p><p>“The brains of cold-blooded animals need to operate within the range of temperature that they experience in their natural habitat, e.g. 15-33°C for zebrafish [Gau et al., 2013]. This is a peculiarly stringent requirement since most biophysical processes are dependent on the temperature. In some rare instances, regulation mechanisms might stabilize the circuit dynamics in order to preserve its function, as best exemplified by the pyloric rhythm of the crab whose characteristic phase relationship is maintained over an extended temperature range [Tang et al., 2010]. Yet in general, an increase in temperature tends to increase the frequency of oscillatory processes [Robertson et al., 2012]. The observed acceleration of the ARTR left/right alternation with increasing temperature, could thus directly result from temperature-dependent cellular mechanisms. Furthermore, one cannot rule out the possibility that the ARTR dynamics could also be indirectly modulated by temperature via thermal-dependent descending neuromodulatory inputs.</p><p>As a result of this thermal modulation of the neuronal dynamics, many cold-blooded animals also exhibit temperature-dependence of their behavior [Long et al., 2008, Neumeister et al., 2000, Stevenson et al., 1990]. Here we were able to quantitatively relate the two processes (neuronal and motor) by demonstrating that an increase in temperature consistently alters the pattern of spontaneous navigation by increasing the left/right alternation frequency. Interpreting the functional relevance of this modification of the swimming pattern is tricky, since many other features of the animal’s navigation are concurrently impacted by a change in temperature, such as the bout frequency, turning rate, turn amplitude, etc. Nevertheless, we were able to show in a recent study that this thermal dependence of the swimming kinematic endows the larva with basic thermophobic capacity, thus efficiently protecting them from exposure to the hottest regions of their environment [Le Goc et al., 2021].”</p><disp-quote content-type="editor-comment"><p>10. The phrasing &quot;orientational persistence&quot; came across as a bit of a misnomer to me, though I might be wrong – orientation typically means the angle of the animal in its environment, whereas this is about the change in angle, so orientation persistence might be interpreted by a casual reader as the fish swimming in a straight line at a fixed angle. I am not sure what else to call it though – &quot;turn direction persistence&quot; is probably more accurate but also clumsier. Is there a better term? If you decide to keep using &quot;orientational persistence&quot; it would be useful to very carefully and explicitly explain what you mean by it.</p></disp-quote><p>We thank the reviewer for this suggestion: turn direction persistence is indeed better. We modified the text accordingly.</p><disp-quote content-type="editor-comment"><p>11. Cold-blooded animals have a body temperature that quickly converges to that of their surroundings (especially tiny fish). Their neural populations will likely experience a wider range of temperature fluctuation and therefore follow certain thermal dynamics laws unlike any warm-blooded animals (such that the flipping rate increases with temperature following Arrhenius law). It is important to discuss if the time persistence that emerges from the network model is a special case for cold-blooded animals experiencing different temperatures (through the 1/(kB*T) scaling of the couplings and biases), a direct thermal effect, rather than &quot;purposeful&quot; neural network computation (through external inputs that could be modeled by making the biases depend on T).</p></disp-quote><p>The observed speeding up of the ARTR alternating dynamics with the water temperature T is consistent with a direct thermal effect. We agree that the biases could also exhibit some variation with T. This is not unexpected, as different membrane currents may have different temperature dependence, see our response to point 9. However we do not see a strong dependence of the biases with T, see <xref ref-type="fig" rid="sa2fig3">Author response image 3</xref> showing the mean value of h<sub>i</sub> as a function of the water temperature.</p><fig id="sa2fig3" position="float"><label>Author response image 3.</label><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79541-sa2-fig3-v2.tif"/></fig><disp-quote content-type="editor-comment"><p>12. It is therefore good to discuss how applicable this free energy landscape description of a neural network is to other neural networks with persistent activities in other animal models, with different sensory inputs, in order to reach a larger audience and have wider potential applications. What types of time persistence can this interpretation address and what are its limitations?</p></disp-quote><p>Time persistence emerges in our work through the sampling of (generally) two metastable states. However, our approach could be applied to more complex landscapes, with more metastable states. Examples of such situations relevant for computation can be found in several works, e.g. Harvey et al. (2012), Mazzucato et al. (2019), Brinkman et al. (2022). It would be interesting to test our approach in the case of continuous attractors, e.g. ring attractors that serve as a theoretical basis for head direction networks (and their higher dimensional extension for place/grid cells circuits). Metastability in this context would be different as a continuum of states are expected to coexist. However we expect motion along the attractor direction, in particular drift, to happen on longer time scales than the damping of fluctuations along transverse directions. Some of us have already inferred graphical models on multi-electrode recordings of hippocampal place cells, see for instance Posani et al. (2018) PLoS Comp Bio 14:e1006320. However the limited number of recorded cells (compared to the recordings reported in our present manuscript) did not allow us to obtain sufficiently accurate generative performance with MC dynamics.</p><disp-quote content-type="editor-comment"><p>13. Line 9: &quot;networks&quot; should probably be &quot;network&quot;.</p></disp-quote><p>This has been corrected.</p><disp-quote content-type="editor-comment"><p>14. Figure 1 C and G: labeling the colors by their temperature in the figure would be helpful.</p></disp-quote><p>The figure has been modified.</p><disp-quote content-type="editor-comment"><p>15. Line246, it is Figure 3B showing the energy landscape, not 3C.</p></disp-quote><p>This has been corrected.</p></body></sub-article></article>