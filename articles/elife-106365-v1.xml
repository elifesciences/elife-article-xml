<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN"  "JATS-archivearticle1-3-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">106365</article-id><article-id pub-id-type="doi">10.7554/eLife.106365</article-id><article-id pub-id-type="doi" specific-use="version">10.7554/eLife.106365.3</article-id><article-version article-version-type="publication-state">version of record</article-version><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Evolutionary Biology</subject></subj-group></article-categories><title-group><article-title>Forecasting protein evolution by integrating birth-death population models with structurally constrained substitution models</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Ferreiro</surname><given-names>David</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-0757-7702</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>González-Vázquez</surname><given-names>Luis Daniel</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6973-6660</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Prado-Comesaña</surname><given-names>Ana</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Arenas</surname><given-names>Miguel</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0516-2717</contrib-id><email>marenas@uvigo.es</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05rdf8595</institution-id><institution>CINBIO, Universidade de Vigo</institution></institution-wrap><addr-line><named-content content-type="city">Vigo</named-content></addr-line><country>Spain</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05rdf8595</institution-id><institution>Department of Biochemistry, Genetics and Immunology, Universidade de Vigo</institution></institution-wrap><addr-line><named-content content-type="city">Vigo</named-content></addr-line><country>Spain</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Bitbol</surname><given-names>Anne-Florence</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02s376052</institution-id><institution>Ecole Polytechnique Federale de Lausanne (EPFL)</institution></institution-wrap><country>Switzerland</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Walczak</surname><given-names>Aleksandra M</given-names></name><role>Senior Editor</role><aff><institution>CNRS</institution><country>France</country></aff></contrib></contrib-group><pub-date publication-format="electronic" date-type="publication"><day>24</day><month>09</month><year>2025</year></pub-date><volume>14</volume><elocation-id>RP106365</elocation-id><history><date date-type="sent-for-review" iso-8601-date="2025-02-21"><day>21</day><month>02</month><year>2025</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint.</event-desc><date date-type="preprint" iso-8601-date="2025-04-02"><day>02</day><month>04</month><year>2025</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2025.02.21.639428"/></event><event><event-desc>This manuscript was published as a reviewed preprint.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2025-05-22"><day>22</day><month>05</month><year>2025</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.106365.1"/></event><event><event-desc>The reviewed preprint was revised.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2025-09-08"><day>08</day><month>09</month><year>2025</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.106365.2"/></event></pub-history><permissions><copyright-statement>© 2025, Ferreiro et al</copyright-statement><copyright-year>2025</copyright-year><copyright-holder>Ferreiro et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-106365-v1.pdf"/><abstract><p>Evolutionary studies in population genetics and ecology were mainly focused on predicting and understanding past evolutionary events. Recently, however, a growing trend explores the prediction of evolutionary trajectories toward the future promoted by its wide variety of applications. In this context, we introduce a forecasting protein evolution method that integrates birth-death population models with substitution models that consider selection on protein folding stability. In contrast to traditional population genetics methods that usually make the unrealistic assumption of simulating molecular evolution separately from the evolutionary history, the present method combines both processes to simultaneously model forward-in-time birth-death evolutionary trajectories and protein evolution under structurally constrained substitution models that outperformed traditional empirical substitution models. We implemented the method into a freely available computer framework. We evaluated the accuracy of the predictions with several monitored viral proteins of broad interest. Overall, the method showed acceptable errors in predicting the folding stability of the forecasted protein variants, but, expectedly, the errors were larger in the prediction of the corresponding sequences. We conclude that forecasting protein evolution is feasible in certain evolutionary scenarios and provide suggestions to enhance its accuracy by improving the underlying models of evolution.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>molecular evolution</kwd><kwd>forecasting evolution</kwd><kwd>birth-death process</kwd><kwd>substitution model</kwd><kwd>protein folding stability</kwd><kwd>phylogenetics</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Viruses</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05r0vyz12</institution-id><institution>Ministerio de Ciencia, Innovación y Universidades</institution></institution-wrap></funding-source><award-id>PID2023-151032NB-C22</award-id><principal-award-recipient><name><surname>González-Vázquez</surname><given-names>Luis Daniel</given-names></name><name><surname>Arenas</surname><given-names>Miguel</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="ror">https://ror.org/003x0zc53</institution-id><institution>Agencia Estatal de Investigación</institution></institution-wrap></funding-source><award-id>PID2023-151032NB-C22</award-id><principal-award-recipient><name><surname>González-Vázquez</surname><given-names>Luis Daniel</given-names></name><name><surname>Arenas</surname><given-names>Miguel</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0348bpk17</institution-id><institution>Federación Española de Enfermedades Raras</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>González-Vázquez</surname><given-names>Luis Daniel</given-names></name><name><surname>Arenas</surname><given-names>Miguel</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0181xnw06</institution-id><institution>Xunta de Galicia</institution></institution-wrap></funding-source><award-id>ED481A-2020/192</award-id><principal-award-recipient><name><surname>Ferreiro</surname><given-names>David</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Forecasting protein evolution in terms of folding stability using state-of-the-art population genetics and substitution models is feasible in rugged fitness landscapes, whereas forecasting exact amino acid sequences remains more challenging.</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>publishing-route</meta-name><meta-value>prc</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Molecular evolution is traditionally investigated through inferences about past evolutionary events, such as phylogenetic tree and ancestral sequence reconstructions, and predictions about the future were considered as inaccessible for a long time because they can be affected by complex processes such as environmental change. Nevertheless, a variety of biological systems display a Darwinian evolutionary process where selection operates toward a limited set of adapted variants. These variants, and in extension the evolutionary trajectories to reach them, would be positively selected and could present a certain degree of predictability (<xref ref-type="bibr" rid="bib66">Lässig et al., 2017</xref>; <xref ref-type="bibr" rid="bib111">Wortel et al., 2023</xref>). The progress made in developing more accurate models of evolution (<xref ref-type="bibr" rid="bib8">Arenas, 2015b</xref>) and the benefits from predicting the outcome of evolution (i.e. to understand the course of evolution or to prepare for the future <xref ref-type="bibr" rid="bib111">Wortel et al., 2023</xref>) motivated a variety of investigations on forecasting evolution in diverse fields including medicine, agriculture, biotechnology, and conservation biology, among others (e.g. <xref ref-type="bibr" rid="bib16">Barton et al., 2016</xref>; <xref ref-type="bibr" rid="bib23">Bull and Molineux, 2008</xref>; <xref ref-type="bibr" rid="bib34">de Visser et al., 2018</xref>; <xref ref-type="bibr" rid="bib35">Diaz-Uriarte and Vasallo, 2019</xref>; <xref ref-type="bibr" rid="bib43">Fischer et al., 2015</xref>; <xref ref-type="bibr" rid="bib47">Gerrish and Sniegowski, 2012</xref>; <xref ref-type="bibr" rid="bib65">Lässig and Łuksza, 2014</xref>; <xref ref-type="bibr" rid="bib71">Lind et al., 2019</xref>; <xref ref-type="bibr" rid="bib73">Luksza and Lässig, 2014</xref>; <xref ref-type="bibr" rid="bib79">Morris et al., 2018</xref>; <xref ref-type="bibr" rid="bib80">Munck et al., 2014</xref>; <xref ref-type="bibr" rid="bib83">Neher et al., 2014</xref>; <xref ref-type="bibr" rid="bib111">Wortel et al., 2023</xref>). Unfortunately, forecasting evolution is not always achievable. Under neutral evolution, all the molecular variants are equally likely to be present in the population, showing lack of repeatability and disallowing accurate prediction of future variants. Thus, forecasting evolution requires a system with measurable selection pressures, and where certain positively selected variants could produce more descendants than other variants and expand in the population (<xref ref-type="bibr" rid="bib33">Desai and Fisher, 2007</xref>; <xref ref-type="bibr" rid="bib52">Goyal et al., 2012</xref>; <xref ref-type="bibr" rid="bib82">Neher and Hallatschek, 2013</xref>; <xref ref-type="bibr" rid="bib83">Neher et al., 2014</xref>). Actually, a rougher fitness landscape resulting from selection can lead to greater accuracy in evolutionary predictions (<xref ref-type="bibr" rid="bib85">Papkou et al., 2023</xref>; <xref ref-type="bibr" rid="bib93">Rubin et al., 2023</xref>; <xref ref-type="bibr" rid="bib107">Van Cleve and Weissman, 2015</xref>). Overall, an evolutionary process could be predictable to some extent (prediction errors are inevitable with any method and in any evolutionary scenario) depending on the strength of selection driving evolution and the heterogeneity in fitness among different variants.</p><p>Here, we focus on forecasting protein evolution because it involves molecular evolutionary processes driven by selection pressures and where the fitness of each variant can be parameterized and predicted (<xref ref-type="bibr" rid="bib24">Carneiro and Hartl, 2010</xref>; <xref ref-type="bibr" rid="bib48">Gilson et al., 2017</xref>). Traditionally, evolutionary histories and ancestral sequences of proteins are inferred using probabilistic methods based on advanced substitution models of protein evolution (e.g. <xref ref-type="bibr" rid="bib8">Arenas, 2015b</xref>; <xref ref-type="bibr" rid="bib12">Arenas and Bastolla, 2020</xref>; <xref ref-type="bibr" rid="bib40">Ferreiro et al., 2022</xref>; <xref ref-type="bibr" rid="bib74">Malcolm et al., 1990</xref>; <xref ref-type="bibr" rid="bib78">Moreira et al., 2023</xref>; <xref ref-type="bibr" rid="bib101">Stackhouse et al., 1990</xref>; <xref ref-type="bibr" rid="bib105">Thornton et al., 2003</xref>; <xref ref-type="bibr" rid="bib106">Ugalde et al., 2004</xref>). The accuracy of these inferences is affected by the accuracy of the applied substitution model, where substitution models that better fit with the study data usually produce more accurate phylogenetic trees and ancestral sequences (<xref ref-type="bibr" rid="bib12">Arenas and Bastolla, 2020</xref>; <xref ref-type="bibr" rid="bib29">Del Amparo and Arenas, 2022a</xref>; <xref ref-type="bibr" rid="bib69">Lemmon and Moriarty, 2004</xref>). These findings suggest that accurate substitution models of evolution are also convenient for forecasting protein evolution. In this regard, a variety of studies showed that structurally constrained substitution (SCS) models of protein evolution provide more accurate evolutionary inferences than the traditional empirical substitution models of protein evolution, in terms of phylogenetic likelihood, distribution of amino acid frequencies among protein sites, rates of molecular evolution and folding stability of reconstructed proteins, among other aspects (e.g. <xref ref-type="bibr" rid="bib12">Arenas and Bastolla, 2020</xref>; <xref ref-type="bibr" rid="bib9">Arenas et al., 2016a</xref>; <xref ref-type="bibr" rid="bib18">Bastolla et al., 2006</xref>; <xref ref-type="bibr" rid="bib22">Bordner and Mittelmann, 2014</xref>; <xref ref-type="bibr" rid="bib32">Del Amparo et al., 2023</xref>; <xref ref-type="bibr" rid="bib39">Echave and Wilke, 2017</xref>; <xref ref-type="bibr" rid="bib41">Ferreiro et al., 2024a</xref>; <xref ref-type="bibr" rid="bib42">Ferreiro et al., 2024b</xref>; <xref ref-type="bibr" rid="bib45">Fornasari et al., 2002</xref>; <xref ref-type="bibr" rid="bib86">Parisi and Echave, 2001</xref>; <xref ref-type="bibr" rid="bib89">Pascual-García et al., 2019</xref>; <xref ref-type="bibr" rid="bib91">Rodrigue et al., 2005</xref>), although SCS models usually demand more computational resources than substitution models that only include information from the protein sequence. Notice that the protein structure provides information about the location and molecular interactions of amino acids at different protein sites, which could be far from each other in the sequence but close in the three-dimensional structure and interact affecting their evolution (<xref ref-type="bibr" rid="bib77">Morcos et al., 2011</xref>; <xref ref-type="bibr" rid="bib94">Ruiz-González and Fares, 2013</xref>). Indeed, selection from the protein folding stability is relevant in the evolution of multiple proteins, including those in microbial and viral systems (e.g. <xref ref-type="bibr" rid="bib40">Ferreiro et al., 2022</xref>; <xref ref-type="bibr" rid="bib51">Gong et al., 2013</xref>; <xref ref-type="bibr" rid="bib60">Jacquier et al., 2013</xref>; <xref ref-type="bibr" rid="bib92">Rodrigues et al., 2016</xref>; <xref ref-type="bibr" rid="bib113">Wylie and Shakhnovich, 2011</xref>; <xref ref-type="bibr" rid="bib118">Zeldovich et al., 2007</xref>). Therefore, we believe that it should be taken into account for forecasting protein evolution in such systems.</p><p>Predictions about future evolutionary events can be performed with simulation-based methods (e.g. <xref ref-type="bibr" rid="bib37">Eccleston et al., 2023</xref>; <xref ref-type="bibr" rid="bib83">Neher et al., 2014</xref>; <xref ref-type="bibr" rid="bib117">Yoshida et al., 2023</xref>). In order to simulate molecular evolution, traditional population genetics methods apply two separate steps (<xref ref-type="bibr" rid="bib5">Arenas, 2012</xref>; <xref ref-type="bibr" rid="bib55">Hoban et al., 2012</xref>). First, the simulation of the evolutionary history (i.e. a phylogenetic tree) using approaches such as the coalescent and birth-death population processes (<xref ref-type="bibr" rid="bib46">Gernhard, 2008</xref>; <xref ref-type="bibr" rid="bib57">Hudson, 1990</xref>; <xref ref-type="bibr" rid="bib63">Kingman, 1982</xref>; <xref ref-type="bibr" rid="bib102">Stadler, 2010</xref>). Afterward, the forward-in-time simulation of molecular evolution is performed, from the root node to the tip nodes, upon the previously simulated evolutionary history (<xref ref-type="bibr" rid="bib116">Yang, 2006</xref>). This methodology was implemented into a variety of population genetics frameworks that simulate molecular evolution (<xref ref-type="bibr" rid="bib5">Arenas, 2012</xref>; <xref ref-type="bibr" rid="bib55">Hoban et al., 2012</xref>). However, for technical and computational simplicity, it assumes that the simulation of the evolutionary history is independent from the simulation of molecular evolution, which can produce biological incoherences (i.e. the evolutionary history is usually simulated under neutral evolution while molecular evolution is usually simulated with substitution models that consider selection). To enhance the realism of this modeling, here we merged both processes into a single one where evolutionary history influences molecular evolution and <italic>vice versa</italic>. In particular, we adopted a birth-death population genetics method to simulate the forward-in-time evolutionary history already used for forecasting evolution (<xref ref-type="bibr" rid="bib65">Lässig and Łuksza, 2014</xref>; <xref ref-type="bibr" rid="bib83">Neher et al., 2014</xref>), taking into account the fitness of the molecular variant (through evolutionary constraints from the protein folding stability <xref ref-type="bibr" rid="bib17">Bastolla and Demetrius, 2005</xref>; <xref ref-type="bibr" rid="bib51">Gong et al., 2013</xref>; <xref ref-type="bibr" rid="bib70">Liberles et al., 2012</xref>; <xref ref-type="bibr" rid="bib118">Zeldovich et al., 2007</xref>) at the corresponding node, to determine its subsequent birth or death event, and we integrated this process with SCS models to model protein evolution along the derived phylogenetic branches. The method is detailed below, and we implemented it into a new version of our computer framework <italic>ProteinEvolver</italic> (<xref ref-type="bibr" rid="bib6">Arenas et al., 2013</xref>), which is freely available from <ext-link ext-link-type="uri" xlink:href="https://github.com/MiguelArenas/proteinevolver">https://github.com/MiguelArenas/proteinevolver</ext-link> (<xref ref-type="bibr" rid="bib13">Arenas, 2025</xref>) <italic>ProteinEvolver2</italic> includes detailed documentation and a variety of ready-to-use examples. Next, considering the potential applications of forecasting evolution to design vaccines and therapies against pathogens, we evaluated and applied the method to forecasting protein evolution in several real protein data of viruses monitored over time.</p></sec><sec id="s2" sec-type="methods"><title>Methods</title><sec id="s2-1"><title>A method for forecasting protein evolution by combining birth-death population genetics with structurally constrained substitution models of protein evolution</title><p>Following previous methods for forecasting evolution based on simulations (<xref ref-type="bibr" rid="bib65">Lässig and Łuksza, 2014</xref>; <xref ref-type="bibr" rid="bib83">Neher et al., 2014</xref>), we developed a method to simulate the forward-in-time evolutionary history of a protein sample with a birth-death process that considers the fitness of the protein variant (based on folding stability) at every temporal node. The method derives the birth and death rates for a protein variant based on the fitness of that variant, where a high fitness results in a high birth rate and a low death rate, which can lead to a large number of descendants, and the opposite leading to a few or none (extinction) descendants. Thus, the fitness of the molecular variant at every node drives its corresponding forward in time birth-death evolutionary history. The details of this simulation process are outlined below.</p><p>First, similarly to common simulators of molecular evolution (<xref ref-type="bibr" rid="bib5">Arenas, 2012</xref>; <xref ref-type="bibr" rid="bib55">Hoban et al., 2012</xref>; <xref ref-type="bibr" rid="bib116">Yang, 2006</xref>), a given protein sequence and structure (hereafter, protein variant) is assigned to the root node. The fitness (<italic>f</italic>) of the protein variant (<italic>A</italic>) is calculated from its folding stability (free energy, <italic>ΔG</italic>) following the Boltzmann distribution (<xref ref-type="bibr" rid="bib50">Goldstein, 2013</xref>) (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>, which takes values from 0 to 1),<disp-formula id="equ1"><label>(1)</label><alternatives><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>G</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mtext>kT</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t1">\begin{document}$$\displaystyle f\left (A\right)=\frac{1}{1+e^{\Delta G/\text{kT}}}$$\end{document}</tex-math></alternatives></disp-formula></p><p>Protein folding stability constrains protein evolution and is commonly used to obtain protein fitness (<xref ref-type="bibr" rid="bib19">Bastolla et al., 2007</xref>; <xref ref-type="bibr" rid="bib50">Goldstein, 2013</xref>; <xref ref-type="bibr" rid="bib70">Liberles et al., 2012</xref>; <xref ref-type="bibr" rid="bib72">Lobkovsky et al., 2010</xref>; <xref ref-type="bibr" rid="bib75">Mendez et al., 2010</xref>; <xref ref-type="bibr" rid="bib98">Sella and Hirsh, 2005</xref>; <xref ref-type="bibr" rid="bib118">Zeldovich et al., 2007</xref>). The user can alternatively choose whether the fitness of the modeled protein variant is determined solely by its folding stability or by its similarity to the stability of a real protein variant (i.e., a protein structure from the Protein Data Bank, PDB). We believe the latter can be more realistic, as in nature, high folding stability does not necessarily indicate high fitness, but a stability that closely resembles that of a real protein may suggest high fitness since the real stability is the result of a selection process (which also incorporates negative design). If the fitness is derived from only the folding stability of the protein variant, the birth rate (<italic>b</italic>) is considered equal to the fitness. Alternatively, if the fitness is determined based on the similarity in folding stability between the modeled variant and a real variant, the birth rate is assumed to be 1 minus the root mean square deviation (RMSD, which offers advantages such as minimizing the influence of small deviations while amplifying larger differences, thereby enhancing the detection of remarkable molecular changes) in folding stability. Notice that the smaller this difference, the higher the birth rate. In both cases, the death rate (<italic>d</italic>) is considered as <italic>1-b</italic> to allow a constant global (birth-death) rate. In this model, the fitness influences reproductive success, where protein variants with higher fitness have higher birth rates leading to more birth events, while those with lower fitness have higher death rates leading to more extinction events. This parameterization is meaningful in the context of protein evolution because the fitness of a protein variant can affect its survival (birth or extinction) without necessarily altering its rate of evolution. Although a higher growth rate can sometimes correlate with higher fitness, a variant with high fitness does not necessarily accumulate substitutions more rapidly.</p><p>Additionally, we incorporated another birth-death model that follows the proposal by <xref ref-type="bibr" rid="bib83">Neher et al., 2014</xref>, in which the death rate is fixed at 1 and the birth rate is modeled as <italic>1+fitness</italic>. In this model, fitness not only affects reproductive success but also influences the global birth-death rate, which can vary among lineages.</p><p>The birth-death process is simulated forward in time deciding whether every next event is a birth or a death event (<xref ref-type="bibr" rid="bib54">Harmon, 2019</xref>; <xref ref-type="bibr" rid="bib102">Stadler, 2010</xref>; <xref ref-type="bibr" rid="bib103">Stadler, 2011</xref>) according to the fitness of the corresponding molecular variant, and it ends when a user-specified criterion, such as a particular sample size (considering or ignoring extinction nodes) or a certain evolutionary time (<italic>t<sub>e</sub></italic>), is reached. Starting from an ‘active’ node (i.e. the root node) at current time <italic>t<sub>c</sub></italic>, the time to the next event (birth to produce two descendants or death to produce the extinction of the node) can be calculated (details below). In contrast to standard birth-death processes where birth and death rates are constant over time and among lineages, the present method considers heterogeneity where each protein variant at a node has specific birth and death rates according to its corresponding fitness. The method is described below and summarized in <xref ref-type="fig" rid="fig1">Figure 1</xref>.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Illustrative example of forward in time simulation of protein evolution integrating a birth-death population evolutionary process with fitness from the protein folding stability and the modeling of protein evolution with a structurally constrained substitution model.</title><p>Given a protein variant assigned to a node at time <italic>t</italic> (blue node), its fitness is calculated considering its protein folding stability. Then, the fitness is used to determine the birth and death rates for that variant, which provide the time to the next birth or death event (horizontal dashed line) that corresponds to the forward-in-time branch length. Next, the variant is evolved forward in time toward each descendant, upon the previously determined branch length, under an SCS model of protein evolution. The process is repeated, forward in time, starting at each new variant. If a death event occurs, the variant of the extinct node (pink node) is obtained, but it does have descendants. The process finishes when a particular sample size or simulation time is reached (i.e. <italic>t+n</italic>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-106365-fig1-v1.tif"/></fig><list list-type="simple" id="list1"><list-item><p>(1) The process starts at the root node, assigning a user-specified protein sequence and corresponding protein structure (i.e. obtained from the PDB) to that node. In general, for every protein variant assigned to an active node, the corresponding birth and death rates are calculated following the indications presented above.</p></list-item><list-item><p>(2) Calculation of the time to the next birth or death event. Following common birth-death methods, the time to the next event <italic>t<sub>n</sub></italic> is calculated through an exponential distribution with rate based on the number of active nodes (<italic>s</italic>) and the sum of the birth and death rates (<xref ref-type="bibr" rid="bib54">Harmon, 2019</xref>; <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>),</p></list-item></list><p><disp-formula id="equ2"><label>(2)</label><alternatives><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t2">\begin{document}$$\displaystyle t_{n}=e^{(s(b+d))}$$\end{document}</tex-math></alternatives></disp-formula></p><list list-type="simple" id="list2"><list-item><p>One of the birth-death models that we implemented considers that <italic>b+d = 1</italic> at each node, allowing variation of the reproductive success among nodes while keeping <italic>t<sub>n</sub></italic> consistent among them, according to <xref ref-type="bibr" rid="bib54">Harmon, 2019</xref>. In contrast, in the other birth-death model we implemented, <italic>b+d</italic> can vary among nodes (<xref ref-type="bibr" rid="bib83">Neher et al., 2014</xref>), thereby allowing variation of both reproductive success and <italic>t<sub>n</sub></italic> among nodes.</p></list-item><list-item><p>(3) Evaluate whether the simulation concludes before the next event occurs (<italic>t<sub>c</sub> +t<sub>n</sub></italic>).</p></list-item><list-item><p>(4) If it does conclude (i.e. <italic>t<sub>c</sub> +t<sub>n</sub></italic> higher than <italic>t<sub>e</sub></italic>), the simulation of the evolutionary history finishes.</p></list-item><list-item><p>(5) If it does not conclude, a random active node is selected, and its protein variant is analyzed to determine its type of next event (birth or death). The probability of a birth event is <italic>P<sub>b</sub> = b/(b+d</italic>) and the probability of a death event is <italic>P<sub>d</sub> = d/(b+d</italic>). A random sample from those probabilities is taken to determine the type of evolutionary event.</p></list-item><list-item><p>(6) If a birth event is selected. Two descendant active nodes from the study node are incorporated with branch lengths <italic>t<sub>n</sub></italic>, and the study node is then considered inactive. Next, molecular evolution is simulated from the original node to each descendant node based on the specified SCS model of protein evolution (<xref ref-type="bibr" rid="bib6">Arenas et al., 2013</xref>). The integration of SCS models to evolve protein variants along given branch lengths followed standards approaches of molecular evolution in population genetics, in which the branch length and the substitution model inform the number and type of substitution events, respectively (<xref ref-type="bibr" rid="bib5">Arenas, 2012</xref>; <xref ref-type="bibr" rid="bib25">Carvajal-Rodríguez, 2010</xref>; <xref ref-type="bibr" rid="bib55">Hoban et al., 2012</xref>; <xref ref-type="bibr" rid="bib116">Yang, 2006</xref>). Thus, the process results in a protein variant for every descendant node. Finally, the folding stability and subsequent fitness of these descendant protein variants are calculated.</p></list-item><list-item><p>(7) If a death event is selected. Then, the study node is considered inactive.</p></list-item><list-item><p>(8) Return to step 1 while the user-specified criterion for ending the birth-death process is not satisfied and at least one active node exists in the evolutionary history. Otherwise, the simulation ends.</p></list-item></list><p>This process simultaneously simulates, forward in time, evolutionary history and protein evolution, with protein evolution influencing the evolutionary history through selection from the folding stability. Indeed, selection can vary among protein variants at their corresponding nodes of the evolutionary history. The process produces a forward in time birth-death phylogenetic history that encompasses nodes that reached the ending time, internal nodes, and nodes that were extinct at some time, along with the protein variant associated with each node.</p><list list-type="bullet" id="list3"><list-item><p>The method includes several optional capabilities listed in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1A</xref> and in the software documentation, with some summarized below.</p></list-item><list-item><p>The user can fix the birth and death rates along the evolutionary history or specify that they are based on the fitness of the corresponding protein variant as described before. For the latter, the fitness can be based on the folding stability of the analyzed protein variant or on the similarity in folding stability between the analyzed and real protein variants. In addition, the global birth-death rate can be constant or vary among lineages depending on the specified birth-death model.</p></list-item><list-item><p>The birth-death simulation can finish when any of the following criteria is met: (a) A specified sample size, including extinction nodes derived from death events. (b) A specified sample size, excluding extinction nodes. (c) A specified evolutionary time, measured from the root to a tip node.</p></list-item><list-item><p>Extinction nodes can either be preserved or removed from the evolutionary history.</p></list-item><list-item><p>Evaluation of the simulated birth-death evolutionary history in terms of tree balance using the Colless index (<xref ref-type="bibr" rid="bib26">Colless and Wiley, 1982</xref>; <xref ref-type="bibr" rid="bib68">Lemant et al., 2022</xref>).</p></list-item><list-item><p>Possible variation of the site-specific substitution rate according to user specifications.</p></list-item><list-item><p>Customizable substitution model featuring site-specific exchangeability matrices (relative rates of change among amino acids and their frequencies at the equilibrium).</p></list-item><list-item><p>Implementation of several SCS models and a variety of empirical substitution models of protein evolution. The implemented SCS models were evaluated in our previous work (<xref ref-type="bibr" rid="bib6">Arenas et al., 2013</xref>), and the implemented empirical substitution models were properly identified using simulated data with <italic>ProtTest3</italic> (<xref ref-type="bibr" rid="bib28">Darriba et al., 2011</xref>).</p></list-item></list><p>The implemented SCS models consider molecular energy functions based on amino acid contact matrices and configurational entropies per residue in unfolded and misfolded proteins (<xref ref-type="bibr" rid="bib6">Arenas et al., 2013</xref>; <xref ref-type="bibr" rid="bib19">Bastolla et al., 2007</xref>; <xref ref-type="bibr" rid="bib75">Mendez et al., 2010</xref>). These models incorporate both positive and negative design strategies. In particular, the evaluation of the target protein structure while taking into account a database of residue contacts from alternative protein structures in the PDB, thus considering background genetic information that helps reduce prediction biases (<xref ref-type="bibr" rid="bib76">Minning et al., 2013</xref>). Technical details about these SCS models are presented in our previous study (<xref ref-type="bibr" rid="bib6">Arenas et al., 2013</xref>). Next, SCS models outperformed models that ignore structural evolutionary constraints in terms of phylogenetic likelihood, among other properties (<xref ref-type="bibr" rid="bib6">Arenas et al., 2013</xref>; <xref ref-type="bibr" rid="bib9">Arenas et al., 2016a</xref>; <xref ref-type="bibr" rid="bib22">Bordner and Mittelmann, 2014</xref>). The method also implements common empirical substitution models of protein evolution (i.e. <italic>Blosum62</italic>, <italic>CpRev</italic>, <italic>Dayhoff</italic>, <italic>DayhoffDCMUT</italic>, <italic>FLU</italic>, <italic>HIVb</italic>, <italic>HIVw</italic>, <italic>JTT</italic>, <italic>JonesDCMUT</italic>, <italic>LG</italic>, <italic>Mtart</italic>, <italic>Mtmam</italic>, <italic>Mtrev24</italic>, <italic>RtRev</italic>, <italic>VT,</italic> and <italic>WAG</italic>; <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1A</xref>) and the user can specify any particular exchangeability matrix for all sites or for each site, allowing for heterogeneity of the substitution process among sites (details in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1A</xref> and in the software documentation). In addition, the framework implements heterogeneous substitution rates among sites by the traditional Gamma distribution (+G; <xref ref-type="bibr" rid="bib115">Yang, 1996</xref>) and proportion of invariable sites (+I; <xref ref-type="bibr" rid="bib44">Fitch and Margoliash, 1967</xref>), and also the user can directly alter the substitution rate at each site for any empirical or SCS model (Table S1). Regarding the evolutionary history, in addition to the birth-death process presented before, the user can specify a particular phylogenetic tree or simulate a coalescent evolutionary history (<xref ref-type="bibr" rid="bib56">Hudson, 1983</xref>; <xref ref-type="bibr" rid="bib63">Kingman, 1982</xref>; <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1A</xref>). In this regard, we maintained the capabilities of the previous version, including the coalescent with recombination (<xref ref-type="bibr" rid="bib56">Hudson, 1983</xref>) which can be homogeneous or heterogeneous along the sequence according to <xref ref-type="bibr" rid="bib110">Wiuf and Posada, 2003</xref>, variable population size over time (growth rate or demographic periods), several migration models that is island (<xref ref-type="bibr" rid="bib58">Hudson, 1998</xref>), stepping-stone (<xref ref-type="bibr" rid="bib62">Kimura and Weiss, 1964</xref>), and continent-island <xref ref-type="bibr" rid="bib112">Wright, 1931</xref> with temporal variation of migration rates and convergence of demes or subpopulations, simulation of haploid or diploid data, and longitudinal sampling (<xref ref-type="bibr" rid="bib81">Navascués et al., 2010</xref>; details in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1A</xref> and in the software documentation). The framework outputs a simulated multiple sequence alignment with the protein sequences of the internal and tip nodes, as well as their folding stabilities and the evolutionary history, among other information (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1A</xref> and software documentation).</p></sec><sec id="s2-2"><title>Study data for evaluating the method for forecasting protein evolution</title><p>We evaluated the accuracy of the method for forecasting protein evolution using viral proteins sampled over time (longitudinal sampling). Specifically, we used protein sequences from previous experiments of virus evolution monitored over time, which contain consensus molecular data (avoiding rare variants) that belong to different evolutionary time points.</p><list list-type="bullet" id="list4"><list-item><p>The matrix (MA) protein of HIV-1, with data obtained from an in vitro cell culture experiment where samples were collected at different times (<xref ref-type="bibr" rid="bib10">Arenas et al., 2016b</xref>). This data included 21 MA protein consensus sequences collected at times (population passages, <italic>T</italic>) <italic>T1</italic> (initial time and includes an initial sequence) and <italic>T31</italic> (time after 31 passages and includes 20 sequences), which accumulated 48 amino acid substitutions (sequence identity 0.973; <xref ref-type="fig" rid="fig2">Figure 2</xref>).</p></list-item><list-item><p>The main protease (Mpro) and papain-like protease (PLpro) proteins of SARS-CoV-2. For each protein, the data includes the first sequenced variant (Wuhan) and a sequence built with all the substitutions observed in a dataset of 384 genomes of the Omicron variant of concern collected from the GISAID database. The resulting Mpro and PLpro sequences presented 10 and 22 substitutions (sequence identity 0.967 and 0.930), respectively.</p></list-item><list-item><p>The non-structural protein 1 (NS1) of the influenza virus. We retrieved the NS1 sequences from the years 2005, 2015 and 2020 from the Influenza Virus Resource (<xref ref-type="bibr" rid="bib15">Bao et al., 2008</xref>). Next, we obtained the consensus sequence of the 2005 dataset as initial time point (<italic>T1</italic>), and the consensus sequences from the 2015 (<italic>T2</italic>) and 2020 (<italic>T3</italic>) datasets as subsequent time points. The resulting consensus sequences for 2015 and 2020 showed 40 and 37 substitutions (sequence identity 0.802 and 0.817), respectively.</p></list-item><list-item><p>The protease (PR) of HIV-1 with data sampled from patients monitored over time, from 2008 to 2017, available from the Specialized Assistance Services in Sexually Transmissible Diseases and HIV/AIDS in Brazil (<xref ref-type="bibr" rid="bib40">Ferreiro et al., 2022</xref>; <xref ref-type="bibr" rid="bib96">Santos-Pereira et al., 2021</xref>; <xref ref-type="bibr" rid="bib99">Souto et al., 2021</xref>). These evolutionary scenarios are complex due to the diverse antiretroviral therapies administered to the patients (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1B</xref>), which could vary during the studied time periods and that could promote the fixation of specific mutations (i.e. associated with resistance; <xref ref-type="bibr" rid="bib40">Ferreiro et al., 2022</xref>; <xref ref-type="bibr" rid="bib96">Santos-Pereira et al., 2021</xref>; <xref ref-type="bibr" rid="bib99">Souto et al., 2021</xref>). For each viral population (patient), the data included a consensus sequence for each of the four or five samples collected at different time points. These consensus sequences exhibited between one and 22 amino acid substitutions with respect to the consensus sequence of the corresponding first sample (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1B</xref>).</p></list-item></list><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Distribution of amino acid substitutions observed along the HIV-1 MA sequences at time <italic>T31</italic>.</title><p>Left: Distribution of the observed amino acid substitutions along the HIV-1 matrix (MA) protein sequences at time <italic>T31</italic>. Right: Distribution of the indicated amino acid substitutions (shown in blue) along the protein structure.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-106365-fig2-v1.tif"/></fig><p>We identified a representative protein structure for each dataset, which was used to predict the folding stability and to inform the SCS model. In particular, we obtained the protein structures of the sequences at the initial time (<italic>T1</italic>) from the PDB (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1C</xref>). For the case of the HIV-1 protease, we obtained the protein structure through homology modeling. We used <italic>SWISS-MODEL</italic> (<xref ref-type="bibr" rid="bib14">Arnold et al., 2006</xref>) to identify the best-fitting templates of PDB structures (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1C</xref>). Next, we predicted the protein structures by homology modeling with <italic>Modeller</italic> (<xref ref-type="bibr" rid="bib95">Sali and Blundell, 1993</xref>) <italic>using the protein sequences and corresponding best-fitting structural templates</italic>.</p></sec><sec id="s2-3"><title>Forward in time prediction of viral protein variants</title><p>The evaluation was performed with the previously presented real data, which includes a real protein variant present at the initial time (<italic>T1</italic>) and subsequent protein variants present at a later time (<italic>Tn</italic>). We applied the method for forecasting protein evolution to predict the most likely protein variants at <italic>Tn</italic> derived from the real protein variant observed at the initial time (<italic>T1</italic>). The prediction error was determined by measuring the distance between the real protein variants and the predicted variants corresponding to time <italic>Tn</italic>.</p><p>Thus, we assigned to the initial node (<italic>T1</italic>) the corresponding real protein variant (including its sequence and structure), and its evolution was simulated forward in time until it reached the number of substitutions observed in the real data at time <italic>Tn</italic>. Thus, we considered the number of observed substitutions as a measure of evolutionary time to allow proper comparisons between real and predicted variants. We simulated 100 alignments of protein sequences, each containing the same number of sequences as the real data at <italic>Tn</italic>. This included 20 HIV-1 MA protein sequences, a consensus sequence for the SARS-CoV-2 Mpro, a consensus sequence for the SARS-CoV-2 PLpro, a consensus sequence of the influenza NS1 protein for each time point, and a consensus sequence of HIV-1 PR for each viral population. To avoid rare variants, each sequence of the simulated multiple sequence alignments was obtained as the consensus of 100 linked simulated sequences.</p><p>To investigate the effect of selection on the predictions, we compared the accuracy of forecasting protein evolution when selection from the protein structure is considered and when it is ignored (neutral evolution). If selection is considered, as previously presented, the probability of birth and death events was based on the fitness of the protein variants, and protein evolution was modeled using an SCS model (<xref ref-type="bibr" rid="bib6">Arenas et al., 2013</xref>). In the case of neutral evolution, all protein variants equally fit and are allowed. Since variants are observed, we allowed birth events. However, it assumed the absence of death events as no information independent of fitness is available to support their inclusion, thereby avoiding the imposition of arbitrary death events based on an arbitrary death rate. Also, to model neutral evolution, we used an exchangeability matrix with the same relative rates of change to all amino acid pairs.</p></sec><sec id="s2-4"><title>Accuracy of the predicted protein variants</title><p>We assessed the accuracy of the method for forecasting protein evolution by comparing the predicted and real protein variants present at time <italic>Tn</italic>, both at the protein sequence and structure levels.</p><p>For data containing multiple sequences at time <italic>Tn</italic> (i.e. HIV-1 MA dataset), we calculated the Kullback-Leibler (KL) divergence, which provides a distance between two multiple sequence alignments (the real and predicted data) based on the distribution of amino acid frequencies along the sequences (Equation III, where factors <italic>P</italic> and <italic>Q</italic> denote the distribution of amino acid frequencies in the real and predicted protein sequences at time <italic>Tn</italic>, respectively, <italic>i</italic> refers to protein site) (<xref ref-type="bibr" rid="bib64">Kullback and Leibler, 1951</xref>). This distance was only calculated for data with a set of sequences at time <italic>Tn</italic> (HIV-1 MA) because a single sequence does not provide site-specific variability.<disp-formula id="equ3"><label>(3)</label><alternatives><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi><mml:mi>L</mml:mi><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo>∥</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t3">\begin{document}$$\displaystyle  KL\,(P\parallel Q)=\sum\limits_{i}{P_{i}} \times {\rm log}(\frac{P_{i}}{Q_{i}} )$$\end{document}</tex-math></alternatives></disp-formula></p><p>We also compared the real and predicted evolutionary trajectories of protein variants using the Grantham distance, which measures the differences between amino acids based on their physicochemical properties (<xref ref-type="bibr" rid="bib53">Grantham, 1974</xref>). In particular, for both real and predicted protein variants, we calculated the Grantham distance at each protein site that differs between the two datasets, considering its evolution from <italic>T1</italic> to the subsequent multiple sequence alignment at <italic>Tn</italic>. We examined sites that varied over time, thus the general site-specific Grantham distance <italic>Gi</italic> was calculated as the frequency of each amino acid <italic>f</italic> at site <italic>i</italic> multiplied by the specific Grantham distance between amino acid <italic>m</italic> at time <italic>Tn</italic> and amino acid <italic>n</italic> at time <italic>T1</italic>, normalized with the largest Grantham distance <italic>G<sub>max</sub></italic> to obtain values between 0 and 1 (Equation IV). Next, to compare the real and predicted data, we calculated the site-specific difference of Grantham distance <italic>Gb<sub>i</sub></italic> between the real <italic>P</italic> and predicted <italic>Q</italic> protein variants (Equation V),<disp-formula id="equ4"><label>(4)</label><alternatives><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mfrac><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t4">\begin{document}$$\displaystyle  G_{i}=\sum _{m=1}^{20}f_{m}\times \frac{G_{\left (m,n\right)}}{G_{max}}$$\end{document}</tex-math></alternatives></disp-formula><disp-formula id="equ5"><label>(5)</label><alternatives><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>G</mml:mi><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=∣</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>Q</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">∣</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t5">\begin{document}$$\displaystyle Gb_{i}=\mid G_{P,i}- G_{Q,i}\mid $$\end{document}</tex-math></alternatives></disp-formula></p><p>In addition, we obtained and compared the protein folding stability (ΔG) of the predicted and real protein variants observed at time <italic>Tn</italic>, using their corresponding protein structures, with <italic>DeltaGREM</italic> (<xref ref-type="bibr" rid="bib9">Arenas et al., 2016a</xref>; <xref ref-type="bibr" rid="bib76">Minning et al., 2013</xref>).</p></sec></sec><sec id="s3" sec-type="results"><title>Results</title><sec id="s3-1"><title>Implementation of the forecasting protein evolution method</title><p>We extended the previous version of our framework <italic>ProteinEvolver</italic> (<xref ref-type="bibr" rid="bib6">Arenas et al., 2013</xref>), maintaining its previous capabilities (i.e. simulation of protein evolution upon user-specified phylogenetic trees and upon phylogenetic trees simulated with the coalescent with or without recombination, migration, demographics and longitudinal sampling, empirical and SCS models, among others; <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1A</xref>), by adding, among others (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1A</xref>), the forward in time modeling of protein evolution that combines a birth-death process based on the fitness of every protein variant (folding stability) at each node to determine its birth and death rates, as well as SCS models of protein evolution. The framework <italic>ProteinEvolver2</italic> is written in C and distributed with a detailed documentation and a variety of illustrative practical examples. The framework is freely available from <ext-link ext-link-type="uri" xlink:href="https://github.com/MiguelArenas/proteinevolver">https://github.com/MiguelArenas/proteinevolver</ext-link> (<xref ref-type="bibr" rid="bib13">Arenas, 2025</xref>).</p></sec><sec id="s3-2"><title>Evaluation of predictions of HIV-1 MA evolution</title><p>Regarding the evolution of the HIV-1 MA protein, the Grantham distance and the KL divergence between the real variants at time <italic>Tn</italic> and the corresponding predicted variants were low (around 5% and 6%, respectively; <xref ref-type="table" rid="table1">Table 1</xref>), and they did not differ comparing predictions that consider selection on the folding stability (including birth-death models with constant and variable global birth-death rate among lineages) and predictions that ignore it (<xref ref-type="table" rid="table1">Table 1</xref>). On the other hand, we found that the folding stability of the protein variants predicted considering selection on the folding stability (again, including birth-death models with constant or variable global birth-death rate among lineages) was closer to the folding stability of the real protein variants than that of the protein variants predicted under neutral evolution (<xref ref-type="table" rid="table1">Table 1</xref>). In particular, the protein variants predicted ignoring selection were less stable than those predicted considering selection and also less stable than the real protein variants.</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Comparison of real and predicted sequences of the HIV-1 MA protein considering predictions based on the SCS and neutral models.</title><p>For the data simulated under the SCS [including birth-death models with constant (SCS) and variable global birth-death rate among lineages (GlobalBDvar)] and neutral models, the table shows the Grantham distance between the amino acids that changed during the real and predicted evolutionary trajectories and the Kullback-Leibler (KL) divergence between the real and predicted multiple sequence alignments. Next, it shows the folding stability (ΔG) of the real protein variants at times <italic>T1</italic> and <italic>T31</italic> and the folding stability of the predicted protein variants at time <italic>T31</italic>. The error corresponds to the 95% confidence interval from the mean (100 samples) of predictions of folding stability.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"/><th align="left" valign="bottom">Grantham distance</th><th align="left" valign="bottom">KL divergence</th><th align="left" valign="bottom">ΔG of the real variant at <italic>T1</italic> (kcal/mol)</th><th align="left" valign="bottom">ΔG of the real variants at <italic>T31</italic> (kcal/mol)</th><th align="left" valign="bottom">ΔG of the predicted variants at <italic>T31</italic> (kcal/mol)</th><th align="left" valign="bottom">ΔΔG (kcal/mol) at <italic>T31</italic> (predicted – real variants)</th></tr></thead><tbody><tr><td align="left" valign="bottom">SCS model</td><td align="left" valign="bottom">5%</td><td align="left" valign="bottom">6%</td><td align="left" valign="bottom">–9.72</td><td align="left" valign="bottom">–10.34±0.14</td><td align="left" valign="bottom">–9.96±0.02</td><td align="left" valign="bottom">0.38</td></tr><tr><td align="left" valign="bottom">SCS GlobalBDvar model</td><td align="left" valign="bottom">5%</td><td align="left" valign="bottom">6%</td><td align="left" valign="bottom">–9.72</td><td align="left" valign="bottom">–10.34±0.14</td><td align="left" valign="bottom">–10.03±0.03</td><td align="left" valign="bottom">0.31</td></tr><tr><td align="left" valign="bottom">Neutral model</td><td align="left" valign="bottom">5%</td><td align="left" valign="bottom">6%</td><td align="left" valign="bottom">–9.72</td><td align="left" valign="bottom">–10.34±0.14</td><td align="left" valign="bottom">–9.21±0.07</td><td align="left" valign="bottom">1.14</td></tr></tbody></table></table-wrap></sec><sec id="s3-3"><title>Evaluation of predictions of SARS-CoV-2 Mpro and PLpro evolution</title><p>The analyses of the SARS-CoV-2 Mpro and PLpro data showed Grantham distances between the real and predicted sequences around 25% and 36%, respectively (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). Again, this distance was similar when comparing predictions based on models that consider selection on the protein folding stability (including birth-death models with constant or variable global birth-death rate among lineages) and a model of neutral evolution. Regarding comparisons based on the protein folding stability, we found again that the models that consider selection from the folding stability produce variants closer to the stability of the real protein variants than the model that ignores selection (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). Indeed, protein variants derived from the models that consider selection were more stable than those derived from the model of neutral evolution. Next, we did not find statistically significant differences in sequence similarity or folding stability between variants predicted under birth-death models with constant or variable global birth-death rate among lineages (<xref ref-type="fig" rid="fig3">Figure 3</xref>).</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Prediction error of SARS-CoV-2 Mpro and PLpro evolution under SCS and neutral models regarding physicochemical properties of the amino acid changes accumulated during the evolutionary trajectories and protein folding stability.</title><p>Predictions based on data simulated under the SCS [including birth-death models with constant (SCS) and variable global birth-death rate among lineages (GlobalBDvar)] and neutral models. (<bold>A</bold>) Grantham distance calculated from the amino acid changes that occurred during the real and predicted evolutionary trajectories based on SCS and neutral models of protein evolution. (<bold>B</bold>) Variation of protein folding stability (ΔΔG) between real and predicted protein variants based on SCS and neutral models of protein evolution. Notice that positive ΔΔG indicates that the real protein variants are more stable than the predicted protein variants and <italic>vice versa</italic>. Error bars correspond to the 95% confidence interval of the mean of prediction error from 100 multiple sequence alignments simulated for the corresponding population and time.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-106365-fig3-v1.tif"/></fig></sec><sec id="s3-4"><title>Evaluation of predictions of influenza NS1 protein evolution</title><p>The evolutionary predictions for the influenza NS1 protein varied depending on the model used. Specifically, at the sequence level and for the two prediction time points studied, Grantham distances between the real and predicted protein sequences were around 23.5% for the models that incorporated structural evolutionary constraints, compared to about 25.5% for the neutral model (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). These differences became more pronounced when examining predictions based on protein folding stability. For both time points, models that included selection consistently generated protein variants with stability more similar to that of the observed variants than those predicted by the neutral model (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). Indeed, sequences predicted by the model that accounts for selection were generally more stable than those predicted under neutral evolution. Again, we found no statistically significant differences in sequence similarity or folding stability between variants predicted under birth-death models with constant or variable global birth-death rate among lineages (<xref ref-type="fig" rid="fig4">Figure 4</xref>).</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Prediction error of influenza NS1 protein evolution under SCS and neutral models regarding physicochemical properties of the amino acid changes accumulated during the evolutionary trajectories and protein folding stability.</title><p>Predictions were performed for two time points (longitudinal samples T2 and T3). Predictions based on data simulated under the SCS [including birth-death models with constant (SCS) and variable global birth-death rate among lineages (GlobalBDvar)] and neutral models. (<bold>A</bold>) Grantham distance calculated from the amino acid changes that occurred during the real and predicted evolutionary trajectories based on SCS and neutral models of protein evolution. (<bold>B</bold>) Variation of protein folding stability (ΔΔG) between real and predicted protein variants based on SCS and neutral models of protein evolution. Notice that positive ΔΔG indicates that the real protein variants are more stable than the predicted protein variants and vice versa. Error bars correspond to the 95% confidence interval of the mean of prediction error from 100 multiple sequence alignments simulated for the corresponding population and time.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-106365-fig4-v1.tif"/></fig></sec><sec id="s3-5"><title>Evaluation of predictions of HIV-1 PR evolution</title><p>In general, the Grantham distance, which compared the evolutionary trajectories of the real and predicted protein variants from time <italic>T1</italic> to later times, varied among viral populations (patients; <xref ref-type="fig" rid="fig5">Figure 5A</xref>). However, for the majority of these populations, the distance remained below 30% and exhibited minor fluctuations over time. One particular population exhibited a notable trend, with the distance increasing from 10% to nearly 60% over time. Considering that the length of the evolutionary trajectories of the protein can differ among the studied populations, we explored whether the accumulated number of amino acid substitutions could affect the accuracy of the predictions, and we found that the number of substitutions varied among populations and this variability did not correlate with the Grantham distance between the real and predicted data (R<sup>2</sup>=0.0001, <xref ref-type="fig" rid="fig5">Figure 5B</xref>). In general, the folding stability of the predicted protein variants was similar or slightly less stable than that of the real protein variants [with a difference ranging from 0 to 9 kcal/mol and a mean of 3.1±0.9 (95% CI) kcal/mol; <xref ref-type="fig" rid="fig5">Figure 5C</xref>]. Indeed, the folding stability exhibited small fluctuations, increasing and decreasing, over time.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Prediction error of HIV-1 PR evolution at diverse populations regarding physicochemical properties of the amino acid changes accumulated during the evolutionary trajectories and protein folding stability.</title><p>(<bold>A</bold>) For each viral population (patient, represented with a particular color) and time, Grantham distance calculated from the amino acid changes that occurred during the real and predicted evolutionary trajectories. For each population, the mean of distances obtained over time is shown on the right. (<bold>B</bold>) Relationship between Grantham distances and accumulated number of substitution events (R<sup>2</sup>=0.0001, which indicates a lack of correlation between these parameters). (<bold>C</bold>) Variation of protein folding stability (ΔΔG) between real and predicted protein variants at each viral population and time. For each population, the mean of distances obtained over time is shown on the right. Notice that positive ΔΔG indicates that the real protein variants are more stable than the predicted protein variants and <italic>vice versa</italic>. Error bars correspond to the 95% confidence interval of the mean of prediction error from 100 multiple sequence alignments simulated for the corresponding viral population and time.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-106365-fig5-v1.tif"/></fig></sec></sec><sec id="s4" sec-type="discussion"><title>Discussion</title><p>While reconstructing evolutionary histories and ancestral sequences, among other inferences about the past, was popular in the field, predictions about evolution toward the future were traditionally ignored due to potential high prediction errors. However, in the last decade, forecasting evolution has gained attention because of its variety of applications and advancements in models of evolution (see the reviews <xref ref-type="bibr" rid="bib66">Lässig et al., 2017</xref>; <xref ref-type="bibr" rid="bib111">Wortel et al., 2023</xref>). Several studies showed that forecasting evolution can be feasible in some systems, including virus evolution (<xref ref-type="bibr" rid="bib73">Luksza and Lässig, 2014</xref>; <xref ref-type="bibr" rid="bib104">Thadani et al., 2023</xref>). Here, we also investigated forecasting evolution in viruses but at the molecular level, considering the relevance of the substitution process to produce molecular variants that affect the viral fitness (<xref ref-type="bibr" rid="bib7">Arenas, 2015a</xref>; <xref ref-type="bibr" rid="bib10">Arenas et al., 2016b</xref>; <xref ref-type="bibr" rid="bib21">Bloom and Neher, 2023</xref>; <xref ref-type="bibr" rid="bib90">Poon et al., 2007</xref>; <xref ref-type="bibr" rid="bib108">Watabe and Kishino, 2010</xref>). We believe that forecasting genome evolution remains challenging due to the complexity of its evolutionary processes [i.e. including epistatic interactions, chromosomal rearrangements, and heterogeneous substitution patterns among genomic regions (<xref ref-type="bibr" rid="bib3">Arbiza et al., 2011</xref>), among others] that complicate the parameterization and prediction of accurate fitness landscapes. However, we believe that it could be more feasible in structural proteins because of their relatively simpler evolutionary processes that usually include selection on folding stability (<xref ref-type="bibr" rid="bib20">Bloom et al., 2006</xref>; <xref ref-type="bibr" rid="bib49">Goldstein, 2011</xref>).</p><p>To make evolutionary predictions over time, either toward the past or toward the future, considering a substitution model of molecular evolution can be convenient. Actually, a variety of traditional studies showed that the substitution model influences the phylogenetic likelihood generated by probabilistic approaches used for evolutionary inference (<xref ref-type="bibr" rid="bib69">Lemmon and Moriarty, 2004</xref>; <xref ref-type="bibr" rid="bib114">Yang et al., 1994</xref>; <xref ref-type="bibr" rid="bib119">Zhang and Nei, 1997</xref>). To study protein evolution, empirical substitution models of protein evolution are routinely used because they allow rapid calculations based on the assumption of site-independent evolution and typically apply the same exchangeability matrix for all the protein sites, which is highly unrealistic (<xref ref-type="bibr" rid="bib38">Echave et al., 2016</xref>). Besides, a small set of empirical substitution models was developed for modeling the evolution of the diverse range of viral proteins (<xref ref-type="bibr" rid="bib27">Dang et al., 2010</xref>; <xref ref-type="bibr" rid="bib30">Del Amparo and Arenas, 2022b</xref>; <xref ref-type="bibr" rid="bib36">Dimmic et al., 2002</xref>; <xref ref-type="bibr" rid="bib67">Le and Vinh, 2020</xref>; <xref ref-type="bibr" rid="bib84">Nickle et al., 2007</xref>). As an alternative, some substitution models that consider evolutionary constraints on the protein structure incorporated site-dependent evolution, which allows a more accurate modeling of protein evolution compared to the empirical substitution models (<xref ref-type="bibr" rid="bib6">Arenas et al., 2013</xref>; <xref ref-type="bibr" rid="bib9">Arenas et al., 2016a</xref>; <xref ref-type="bibr" rid="bib22">Bordner and Mittelmann, 2014</xref>; <xref ref-type="bibr" rid="bib41">Ferreiro et al., 2024a</xref>; <xref ref-type="bibr" rid="bib87">Parisi and Echave, 2005</xref>).</p><p>According to previous methods for forecasting evolution based on computer simulations (<xref ref-type="bibr" rid="bib65">Lässig and Łuksza, 2014</xref>; <xref ref-type="bibr" rid="bib83">Neher et al., 2014</xref>), we also adopted the birth-death population genetics process to allow a forward-in-time evolutionary process where the birth and death rates can differ among nodes (<xref ref-type="bibr" rid="bib102">Stadler, 2010</xref>; <xref ref-type="bibr" rid="bib103">Stadler, 2011</xref>). Traditional population genetics methods to simulate the evolution of molecular data implement a two-step simulation process, where, first, the evolutionary history is simulated [i.e. with the coalescent theory or a forward-in-time simulation approach (<xref ref-type="bibr" rid="bib5">Arenas, 2012</xref>; <xref ref-type="bibr" rid="bib55">Hoban et al., 2012</xref>), often assuming neutral evolution] and, in a subsequent step, molecular evolution is simulated upon the previously obtained evolutionary history (<xref ref-type="bibr" rid="bib116">Yang, 2006</xref>). However, this methodology is unrealistic because the fitness of the data can affect its evolutionary history (i.e., a variant with high fitness is likely to have more descendants than a variant with low fitness). Thus, we designed and implemented a method for forecasting protein evolution that integrates a birth-death population genetics process (including the modeling of constant and variable global birth-death rate among lineages) with a SCS model of protein evolution, where the folding stability of each protein variant is evaluated to predict its future trajectory in terms of both evolutionary history and molecular evolution. We implemented this forward-in-time simulation of protein evolution in a new version of our previous framework <italic>ProteinEvolver</italic> (<xref ref-type="bibr" rid="bib6">Arenas et al., 2013</xref>), while maintaining its previous capabilities and extending some of them (i.e. incorporation of site-specific exchangeability matrices and additional substitution models of protein evolution, among others; see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1A</xref> and software documentation). As any other method for forecasting evolution, the present method ignores possible environmental shifts that are inherently unpredictable and that could affect the accuracy of the predictions. Next, we evaluated the forward-in-time evolutionary predictions with real data of HIV-1, SARS-CoV-2, and influenza virus proteins. We determined the prediction errors between the real and the predicted protein variants by examining dissimilarity in evolutionary trajectory (Grantham distance based on physicochemical properties among the differing amino acids during the evolutionary trajectories), sequence divergence (distribution of amino acid frequencies among sites using the KL divergence), and protein structure (protein folding stability). Additionally, we analyzed the influence of accounting for selection, based on the protein folding stability, on the predictions. We also evaluated birth-death models incorporating either constant or variable global birth-death rates among lineages. Notably, in the variable-rate model, fitness can influence both reproductive success and the rate of molecular evolution.</p><p>In general, the sequence and evolutionary trajectory dissimilarities between the real and predicted protein variants were relatively small, with some variations among the study proteins. For the HIV-1 MA protein, the SARS-CoV-2 Mpro and PLpro, and influenza NS1 protein, the sequence dissimilarity was below 10%, 26%, 36%, and 26%, respectively. The low prediction errors for the HIV-1 MA protein were expected because this dataset was derived from an in vitro cell culture experiment that is not influenced by a variety of external factors that could affect the predictions in in vivo experiments. As a rough reference, in traditional ancestral sequence reconstruction (ASR) of protein data with high sequence identity, the error was approximately 2% (<xref ref-type="bibr" rid="bib4">Arenas and Posada, 2010</xref>). Notice that ASR methods can exhibit low prediction errors due to their statistical evaluation based on a set of original sequences, rather than relying on a single original sequence used in the case of forecasting evolution. The contrasting scenario regarding evolutionary complexity was the HIV-1 PR data, which was sampled from populations (patients) undergoing various antiretroviral treatments (<xref ref-type="bibr" rid="bib40">Ferreiro et al., 2022</xref>). There, the sequence dissimilarity varied among viral populations, although most were below 30%. A viral population exhibited higher dissimilarities (near 60%) that we believe could be caused by molecular adaptations promoted by the therapies, although this needs formal investigation.</p><p>An unexpected result was that the model of neutral evolution produced sequence dissimilarities between the real and predicted protein variants that were quite similar to those obtained with the SCS model (<xref ref-type="table" rid="table1">Table 1</xref> and <xref ref-type="fig" rid="fig3">Figures 3</xref> and <xref ref-type="fig" rid="fig4">4</xref>). A few studies indicated that the substitution model has negligible effects on the reconstructed phylogenetic trees (<xref ref-type="bibr" rid="bib1">Abadi et al., 2019</xref>; <xref ref-type="bibr" rid="bib100">Spielman, 2020</xref>). Subsequent studies found that the influence of the substitution model on phylogenetic reconstructions is dependent on the diversity of the data, where data with high diversity is more sensitive to the applied substitution model due to containing more evolutionary information to be modeled (<xref ref-type="bibr" rid="bib31">Del Amparo and Arenas, 2023</xref>). Considering that the studied data present overall low diversity [i.e. sequence identity of 0.973, 0.967, 0.930, 0.802, and 0.817 for the HIV MA data, SARS-CoV-2 Mpro data, SARS-CoV-2 PLpro data, and influenza NS1 protein data (for each prediction time point, T2 and T3), respectively; it is important to note that, in general, longitudinal data derived from monitored evolutionary processes usually show a low diversity because they involve relatively short evolutionary histories, among other factors.], we believe that the influence of the applied substitution models on the prediction of the sequences was small because of the small number of modeled substitution events, as found in phylogenetic reconstructions (; <xref ref-type="bibr" rid="bib31">Del Amparo and Arenas, 2023</xref>). Actually, in the case of the influenza NS1 protein dataset, which had the highest sequence diversity among the study datasets, the sequences predicted under the SCS models were more similar to the real sequences than those derived from predictions under neutral evolution. Overall, the prediction accuracy varied among the studied evolutionary scenarios; as expected, it was lower in the more complex scenarios. Indeed, datasets with higher sequence diversity contain more evolutionary signals, which can improve prediction quality.</p><p>We also evaluated the prediction error between the real and predicted protein variants regarding their folding stability, again comparing the predictions made under a model that considers structural constraints and a model of neutral evolution. In general, the protein variants predicted under the SCS model presented a folding stability close to the folding stability of the respective real protein variants, with differences below 1, 2, 7, and 1 kcal/mol for the HIV MA data, SARS-CoV-2 Mpro data, SARS-CoV-2 PLpro data, and influenza NS1 protein data, respectively. The higher differences (around 9 kcal/mol) were again observed for the HIV-1 PR data. In contrast to the prediction error based on sequence dissimilarity, the prediction error based on folding stability varies between predictions obtained under the SCS model and those obtained under the neutral model. In the studied evolutionary scenarios, the protein variants predicted under the neutral model were less stable and farther from the stability of the real protein variants compared to those predicted under the SCS model. These results were expected because, under SCS models, protein stability can be modeled with greater accuracy than sequence similarity due to selection for maintaining stability in the protein structure despite amino acid changes (<xref ref-type="bibr" rid="bib12">Arenas and Bastolla, 2020</xref>; <xref ref-type="bibr" rid="bib59">Illergård et al., 2009</xref>; <xref ref-type="bibr" rid="bib88">Pascual-García et al., 2010</xref>). Indeed, previous studies showed that models that ignore structural constraints often produce proteins with unrealistic folding instability (<xref ref-type="bibr" rid="bib12">Arenas and Bastolla, 2020</xref>; <xref ref-type="bibr" rid="bib32">Del Amparo et al., 2023</xref>), which suggests that accounting for protein folding stability in the modeling of protein evolution is recommended for predicting protein variants with appropriate structural properties.</p><p>Therefore, we found a good accuracy in predicting the real folding stability of forecasted protein variants, while predicting the exact sequences was more challenging, which was not surprising considering previous studies. In particular, inferring specific sequences is considerably challenging even for ancestral molecular reconstruction (<xref ref-type="bibr" rid="bib12">Arenas and Bastolla, 2020</xref>; <xref ref-type="bibr" rid="bib11">Arenas et al., 2017</xref>). Indeed, observed sequence diversity is much greater than observed structural diversity (<xref ref-type="bibr" rid="bib59">Illergård et al., 2009</xref>; <xref ref-type="bibr" rid="bib88">Pascual-García et al., 2010</xref>), and substitutions between amino acids with similar physicochemical properties can yield modeled protein variants with more accurate folding stability, even when the exact amino acid sequences differ. Further work is demanded in the field of substitution models of molecular evolution. We also found that datasets with relatively high sequence diversity can improve the accuracy of the predictions due to containing more evolutionary information. Apart from that, forecasting the folding stability of future real proteins is an important advance in forecasting protein evolution, given the essential role of folding stability in protein function (<xref ref-type="bibr" rid="bib20">Bloom et al., 2006</xref>; <xref ref-type="bibr" rid="bib97">Scheiblhofer et al., 2017</xref>) and its variety of applications.</p><p>Variation in the global birth-death rate among lineages showed minor effects on prediction accuracy, suggesting a limited role in protein evolution modeling. Molecular evolution parameters, particularly the substitution model, appear to be more critical in this regard.</p><p>In the context of protein evolution, substitution models are a critical factor (<xref ref-type="bibr" rid="bib11">Arenas et al., 2017</xref>; <xref ref-type="bibr" rid="bib22">Bordner and Mittelmann, 2014</xref>; <xref ref-type="bibr" rid="bib38">Echave et al., 2016</xref>; <xref ref-type="bibr" rid="bib39">Echave and Wilke, 2017</xref>; <xref ref-type="bibr" rid="bib70">Liberles et al., 2012</xref>; <xref ref-type="bibr" rid="bib109">Wilke, 2012</xref>), and the presented combination with a birth-death model constitutes a first approximation upon which next studies can build to better understand this evolutionary system. Next, the present method assumes that the protein structure is maintained over the studied evolutionary time, which can be generally reasonable for short timescales where the structure is conserved (<xref ref-type="bibr" rid="bib59">Illergård et al., 2009</xref>; <xref ref-type="bibr" rid="bib88">Pascual-García et al., 2010</xref>). Over longer evolutionary timescales, structural changes may occur and, in such cases, modeling the evolution of the protein structure would be necessary. To our knowledge, modeling the evolution of the protein structure remains a challenging task that requires substantial methodological developments. Recent advances in artificial intelligence, particularly in protein structure prediction from sequence (<xref ref-type="bibr" rid="bib2">Abramson et al., 2024</xref>; <xref ref-type="bibr" rid="bib61">Jumper et al., 2021</xref>), may offer promising tools for addressing this challenge. However, we believe that evaluating such approaches in the context of structural evolution would be difficult, especially given the limited availability of real data with known evolutionary trajectories involving structural change. In any case, this is probably an important direction for future research.</p><p>We present a method to simulate forward-in-time protein evolution accounting for evolutionary constraints from the protein structure and a birth-death population process, and where the evolutionary history is influenced by the protein evolution and vice versa. The method is implemented in the computer framework <italic>ProteinEvolver2</italic>, which is freely distributed with several practical examples and detailed documentation. We believe that implementing methods into freely available phylogenetic frameworks is important to facilitate practical applications, as well as future improvements and evaluations. We applied the method to forecast protein evolution in some viral proteins. We found that the method provides acceptable approximations to the real evolution, especially in terms of protein folding stability, suggesting that combining structural constraints with birth-death population processes in the modeling of protein evolution is convenient. Still, to advance in methods for forecasting protein evolution, we believe that further efforts should be made in the field to improve the modeling of protein evolution, such as the incorporation of site-dependent evolutionary constraints from the protein activity.</p></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Resources, Data curation, Software, Formal analysis, Supervision, Validation, Investigation, Visualization, Methodology, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Resources, Data curation, Formal analysis, Investigation, Visualization, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Resources, Data curation, Formal analysis, Investigation, Visualization, Writing – review and editing</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Resources, Software, Funding acquisition, Investigation, Visualization, Methodology, Writing – original draft, Project administration, Writing – review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Supplementary tables A–C and references cited in the supplementary file.</title></caption><media xlink:href="elife-106365-supp1-v1.pdf" mimetype="application" mime-subtype="pdf"/></supplementary-material><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-106365-mdarchecklist1-v1.pdf" mimetype="application" mime-subtype="pdf"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>The computer framework ProteinEvolver2 is freely available from <ext-link ext-link-type="uri" xlink:href="https://github.com/MiguelArenas/proteinevolver">https://github.com/MiguelArenas/proteinevolver</ext-link> (<xref ref-type="bibr" rid="bib13">Arenas, 2025</xref>). The SARS-CoV-2 data is available from GISAID database with <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.55876/gis8.250206gt">https://doi.org/10.55876/gis8.250206gt</ext-link>. The real and predicted protein variants are available from Zenodo repository at the URL <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.15548146">https://doi.org/10.5281/zenodo.15548146</ext-link>.</p><p>The following dataset was generated:</p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset1"><person-group person-group-type="author"><name><surname>Ferreiro</surname><given-names>D</given-names></name><name><surname>González-Vázquez</surname><given-names>LD</given-names></name><name><surname>Prado-Comesaña</surname><given-names>A</given-names></name><name><surname>Arenas</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2025">2025</year><data-title>Forecasting protein evolution by combining birth-death population models with structurally constrained substitution models</data-title><source>Zenodo</source><pub-id pub-id-type="doi">10.5281/zenodo.15548146</pub-id></element-citation></p><p>The following previously published dataset was used:</p><p><element-citation publication-type="data" specific-use="references" id="dataset2"><person-group person-group-type="author"><collab>GISAID</collab></person-group><year iso-8601-date="2025">2025</year><data-title>SARS-CoV-2 protein sequences</data-title><source>EpiCoV</source><pub-id pub-id-type="doi">10.55876/gis8.250206gt</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>This work was supported by the Project PID2023-151032NB-C22 funded by MCIU/AEI/10.13039/501100011033 and by FEDER, UE. DF was funded by a fellowship from Xunta de Galicia [ED481A-2020/192]. We thank the “Centro de Supercomputación de Galicia (CESGA)” for the computer resources. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abadi</surname><given-names>S</given-names></name><name><surname>Azouri</surname><given-names>D</given-names></name><name><surname>Pupko</surname><given-names>T</given-names></name><name><surname>Mayrose</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Model selection may not be a mandatory step for phylogeny reconstruction</article-title><source>Nature Communications</source><volume>10</volume><elocation-id>934</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-019-08822-w</pub-id><pub-id pub-id-type="pmid">30804347</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abramson</surname><given-names>J</given-names></name><name><surname>Adler</surname><given-names>J</given-names></name><name><surname>Dunger</surname><given-names>J</given-names></name><name><surname>Evans</surname><given-names>R</given-names></name><name><surname>Green</surname><given-names>T</given-names></name><name><surname>Pritzel</surname><given-names>A</given-names></name><name><surname>Ronneberger</surname><given-names>O</given-names></name><name><surname>Willmore</surname><given-names>L</given-names></name><name><surname>Ballard</surname><given-names>AJ</given-names></name><name><surname>Bambrick</surname><given-names>J</given-names></name><name><surname>Bodenstein</surname><given-names>SW</given-names></name><name><surname>Evans</surname><given-names>DA</given-names></name><name><surname>Hung</surname><given-names>C-C</given-names></name><name><surname>O’Neill</surname><given-names>M</given-names></name><name><surname>Reiman</surname><given-names>D</given-names></name><name><surname>Tunyasuvunakool</surname><given-names>K</given-names></name><name><surname>Wu</surname><given-names>Z</given-names></name><name><surname>Žemgulytė</surname><given-names>A</given-names></name><name><surname>Arvaniti</surname><given-names>E</given-names></name><name><surname>Beattie</surname><given-names>C</given-names></name><name><surname>Bertolli</surname><given-names>O</given-names></name><name><surname>Bridgland</surname><given-names>A</given-names></name><name><surname>Cherepanov</surname><given-names>A</given-names></name><name><surname>Congreve</surname><given-names>M</given-names></name><name><surname>Cowen-Rivers</surname><given-names>AI</given-names></name><name><surname>Cowie</surname><given-names>A</given-names></name><name><surname>Figurnov</surname><given-names>M</given-names></name><name><surname>Fuchs</surname><given-names>FB</given-names></name><name><surname>Gladman</surname><given-names>H</given-names></name><name><surname>Jain</surname><given-names>R</given-names></name><name><surname>Khan</surname><given-names>YA</given-names></name><name><surname>Low</surname><given-names>CMR</given-names></name><name><surname>Perlin</surname><given-names>K</given-names></name><name><surname>Potapenko</surname><given-names>A</given-names></name><name><surname>Savy</surname><given-names>P</given-names></name><name><surname>Singh</surname><given-names>S</given-names></name><name><surname>Stecula</surname><given-names>A</given-names></name><name><surname>Thillaisundaram</surname><given-names>A</given-names></name><name><surname>Tong</surname><given-names>C</given-names></name><name><surname>Yakneen</surname><given-names>S</given-names></name><name><surname>Zhong</surname><given-names>ED</given-names></name><name><surname>Zielinski</surname><given-names>M</given-names></name><name><surname>Žídek</surname><given-names>A</given-names></name><name><surname>Bapst</surname><given-names>V</given-names></name><name><surname>Kohli</surname><given-names>P</given-names></name><name><surname>Jaderberg</surname><given-names>M</given-names></name><name><surname>Hassabis</surname><given-names>D</given-names></name><name><surname>Jumper</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Accurate structure prediction of biomolecular interactions with AlphaFold 3</article-title><source>Nature</source><volume>630</volume><fpage>493</fpage><lpage>500</lpage><pub-id pub-id-type="doi">10.1038/s41586-024-07487-w</pub-id><pub-id pub-id-type="pmid">38718835</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arbiza</surname><given-names>L</given-names></name><name><surname>Patricio</surname><given-names>M</given-names></name><name><surname>Dopazo</surname><given-names>H</given-names></name><name><surname>Posada</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Genome-wide heterogeneity of nucleotide substitution model fit</article-title><source>Genome Biology and Evolution</source><volume>3</volume><fpage>896</fpage><lpage>908</lpage><pub-id pub-id-type="doi">10.1093/gbe/evr080</pub-id><pub-id pub-id-type="pmid">21824869</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arenas</surname><given-names>M</given-names></name><name><surname>Posada</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>The effect of recombination on the reconstruction of ancestral sequences</article-title><source>Genetics</source><volume>184</volume><fpage>1133</fpage><lpage>1139</lpage><pub-id pub-id-type="doi">10.1534/genetics.109.113423</pub-id><pub-id pub-id-type="pmid">20124027</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arenas</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Simulation of molecular data under diverse evolutionary scenarios</article-title><source>PLOS Computational Biology</source><volume>8</volume><elocation-id>e1002495</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002495</pub-id><pub-id pub-id-type="pmid">22693434</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arenas</surname><given-names>M</given-names></name><name><surname>Dos Santos</surname><given-names>HG</given-names></name><name><surname>Posada</surname><given-names>D</given-names></name><name><surname>Bastolla</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Protein evolution along phylogenetic histories under structurally constrained substitution models</article-title><source>Bioinformatics</source><volume>29</volume><fpage>3020</fpage><lpage>3028</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btt530</pub-id><pub-id pub-id-type="pmid">24037213</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arenas</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015a</year><article-title>Genetic consequences of antiviral therapy on HIV-1</article-title><source>Computational and Mathematical Methods in Medicine</source><volume>2015</volume><elocation-id>395826</elocation-id><pub-id pub-id-type="doi">10.1155/2015/395826</pub-id><pub-id pub-id-type="pmid">26170895</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arenas</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015b</year><article-title>Trends in substitution models of molecular evolution</article-title><source>Frontiers in Genetics</source><volume>6</volume><elocation-id>319</elocation-id><pub-id pub-id-type="doi">10.3389/fgene.2015.00319</pub-id><pub-id pub-id-type="pmid">26579193</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arenas</surname><given-names>M</given-names></name><name><surname>Sánchez-Cobos</surname><given-names>A</given-names></name><name><surname>Bastolla</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2016">2016a</year><article-title>Maximum-likelihood phylogenetic inference with selection on protein folding stability</article-title><source>Molecular Biology and Evolution</source><volume>32</volume><fpage>2195</fpage><lpage>2207</lpage><pub-id pub-id-type="doi">10.1093/molbev/msv085</pub-id><pub-id pub-id-type="pmid">25837579</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arenas</surname><given-names>M</given-names></name><name><surname>Lorenzo-Redondo</surname><given-names>R</given-names></name><name><surname>Lopez-Galindez</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2016">2016b</year><article-title>Influence of mutation and recombination on HIV-1 in vitro fitness recovery</article-title><source>Molecular Phylogenetics and Evolution</source><volume>94</volume><fpage>264</fpage><lpage>270</lpage><pub-id pub-id-type="doi">10.1016/j.ympev.2015.09.001</pub-id><pub-id pub-id-type="pmid">26358613</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arenas</surname><given-names>M</given-names></name><name><surname>Weber</surname><given-names>CC</given-names></name><name><surname>Liberles</surname><given-names>DA</given-names></name><name><surname>Bastolla</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>ProtASR: an evolutionary framework for ancestral protein reconstruction with selection on folding stability</article-title><source>Systematic Biology</source><volume>66</volume><fpage>1054</fpage><lpage>1064</lpage><pub-id pub-id-type="doi">10.1093/sysbio/syw121</pub-id><pub-id pub-id-type="pmid">28057858</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arenas</surname><given-names>M</given-names></name><name><surname>Bastolla</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>ProtASR2: Ancestral reconstruction of protein sequences accounting for folding stability</article-title><source>Methods in Ecology and Evolution</source><volume>11</volume><fpage>248</fpage><lpage>257</lpage><pub-id pub-id-type="doi">10.1111/2041-210X.13341</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Arenas</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2025">2025</year><data-title>Proteinevolver</data-title><version designator="db71444">db71444</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/MiguelArenas/proteinevolver">https://github.com/MiguelArenas/proteinevolver</ext-link></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arnold</surname><given-names>K</given-names></name><name><surname>Bordoli</surname><given-names>L</given-names></name><name><surname>Kopp</surname><given-names>J</given-names></name><name><surname>Schwede</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>The SWISS-MODEL workspace: a web-based environment for protein structure homology modelling</article-title><source>Bioinformatics</source><volume>22</volume><fpage>195</fpage><lpage>201</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bti770</pub-id><pub-id pub-id-type="pmid">16301204</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bao</surname><given-names>Y</given-names></name><name><surname>Bolotov</surname><given-names>P</given-names></name><name><surname>Dernovoy</surname><given-names>D</given-names></name><name><surname>Kiryutin</surname><given-names>B</given-names></name><name><surname>Zaslavsky</surname><given-names>L</given-names></name><name><surname>Tatusova</surname><given-names>T</given-names></name><name><surname>Ostell</surname><given-names>J</given-names></name><name><surname>Lipman</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>The influenza virus resource at the National Center for Biotechnology Information</article-title><source>Journal of Virology</source><volume>82</volume><fpage>596</fpage><lpage>601</lpage><pub-id pub-id-type="doi">10.1128/JVI.02005-07</pub-id><pub-id pub-id-type="pmid">17942553</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barton</surname><given-names>JP</given-names></name><name><surname>Goonetilleke</surname><given-names>N</given-names></name><name><surname>Butler</surname><given-names>TC</given-names></name><name><surname>Walker</surname><given-names>BD</given-names></name><name><surname>McMichael</surname><given-names>AJ</given-names></name><name><surname>Chakraborty</surname><given-names>AK</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Relative rate and location of intra-host HIV evolution to evade cellular immunity are predictable</article-title><source>Nature Communications</source><volume>7</volume><elocation-id>11660</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms11660</pub-id><pub-id pub-id-type="pmid">27212475</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bastolla</surname><given-names>U</given-names></name><name><surname>Demetrius</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Stability constraints and protein evolution: the role of chain length, composition and disulfide bonds</article-title><source>Protein Engineering, Design &amp; Selection</source><volume>18</volume><fpage>405</fpage><lpage>415</lpage><pub-id pub-id-type="doi">10.1093/protein/gzi045</pub-id><pub-id pub-id-type="pmid">16085657</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bastolla</surname><given-names>U</given-names></name><name><surname>Porto</surname><given-names>M</given-names></name><name><surname>Roman</surname><given-names>HE</given-names></name><name><surname>Vendruscolo</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>A protein evolution model with independent sites that reproduces site-specific amino acid distributions from the Protein Data Bank</article-title><source>BMC Evolutionary Biology</source><volume>6</volume><elocation-id>43</elocation-id><pub-id pub-id-type="doi">10.1186/1471-2148-6-43</pub-id><pub-id pub-id-type="pmid">16737532</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bastolla</surname><given-names>U</given-names></name><name><surname>Porto</surname><given-names>M</given-names></name><name><surname>Roman</surname><given-names>HE</given-names></name><name><surname>Vendruscolo</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2007">2007</year><source>Structural Approaches to Sequence Evolution</source><publisher-name>Springer</publisher-name><pub-id pub-id-type="doi">10.1007/978-3-540-35306-5</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bloom</surname><given-names>JD</given-names></name><name><surname>Labthavikul</surname><given-names>ST</given-names></name><name><surname>Otey</surname><given-names>CR</given-names></name><name><surname>Arnold</surname><given-names>FH</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Protein stability promotes evolvability</article-title><source>PNAS</source><volume>103</volume><fpage>5869</fpage><lpage>5874</lpage><pub-id pub-id-type="doi">10.1073/pnas.0510098103</pub-id><pub-id pub-id-type="pmid">16581913</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bloom</surname><given-names>JD</given-names></name><name><surname>Neher</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Fitness effects of mutations to SARS-CoV-2 proteins</article-title><source>Virus Evolution</source><volume>9</volume><elocation-id>vead055</elocation-id><pub-id pub-id-type="doi">10.1093/ve/vead055</pub-id><pub-id pub-id-type="pmid">37727875</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bordner</surname><given-names>AJ</given-names></name><name><surname>Mittelmann</surname><given-names>HD</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A new formulation of protein evolutionary models that account for structural constraints</article-title><source>Molecular Biology and Evolution</source><volume>31</volume><fpage>736</fpage><lpage>749</lpage><pub-id pub-id-type="doi">10.1093/molbev/mst240</pub-id><pub-id pub-id-type="pmid">24307688</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bull</surname><given-names>JJ</given-names></name><name><surname>Molineux</surname><given-names>IJ</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Predicting evolution from genomics: experimental evolution of bacteriophage T7</article-title><source>Heredity</source><volume>100</volume><fpage>453</fpage><lpage>463</lpage><pub-id pub-id-type="doi">10.1038/sj.hdy.6801087</pub-id><pub-id pub-id-type="pmid">18212807</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carneiro</surname><given-names>M</given-names></name><name><surname>Hartl</surname><given-names>DL</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Colloquium papers: Adaptive landscapes and protein evolution</article-title><source>PNAS</source><volume>107 Suppl 1</volume><fpage>1747</fpage><lpage>1751</lpage><pub-id pub-id-type="doi">10.1073/pnas.0906192106</pub-id><pub-id pub-id-type="pmid">19805125</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carvajal-Rodríguez</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Simulation of genes and genomes forward in time</article-title><source>Current Genomics</source><volume>11</volume><fpage>58</fpage><lpage>61</lpage><pub-id pub-id-type="doi">10.2174/138920210790218007</pub-id><pub-id pub-id-type="pmid">20808525</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Colless</surname><given-names>DH</given-names></name><name><surname>Wiley</surname><given-names>EO</given-names></name></person-group><year iso-8601-date="1982">1982</year><article-title>Phylogenetics: the theory and practice of phylogenetic systematics</article-title><source>Systematic Zoology</source><volume>31</volume><elocation-id>13420</elocation-id><pub-id pub-id-type="doi">10.2307/2413420</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dang</surname><given-names>CC</given-names></name><name><surname>Le</surname><given-names>QS</given-names></name><name><surname>Gascuel</surname><given-names>O</given-names></name><name><surname>Le</surname><given-names>VS</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>FLU, an amino acid substitution model for influenza proteins</article-title><source>BMC Evolutionary Biology</source><volume>10</volume><elocation-id>99</elocation-id><pub-id pub-id-type="doi">10.1186/1471-2148-10-99</pub-id><pub-id pub-id-type="pmid">20384985</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Darriba</surname><given-names>D</given-names></name><name><surname>Taboada</surname><given-names>GL</given-names></name><name><surname>Doallo</surname><given-names>R</given-names></name><name><surname>Posada</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>ProtTest 3: fast selection of best-fit models of protein evolution</article-title><source>Bioinformatics</source><volume>27</volume><fpage>1164</fpage><lpage>1165</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btr088</pub-id><pub-id pub-id-type="pmid">21335321</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Del Amparo</surname><given-names>R</given-names></name><name><surname>Arenas</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2022">2022a</year><article-title>Consequences of substitution model selection on protein ancestral sequence reconstruction</article-title><source>Molecular Biology and Evolution</source><volume>39</volume><elocation-id>msac144</elocation-id><pub-id pub-id-type="doi">10.1093/molbev/msac144</pub-id><pub-id pub-id-type="pmid">35789388</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Del Amparo</surname><given-names>R</given-names></name><name><surname>Arenas</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2022">2022b</year><article-title>HIV protease and integrase empirical substitution models of evolution: protein-specific models outperform generalist models</article-title><source>Genes</source><volume>13</volume><elocation-id>61</elocation-id><pub-id pub-id-type="doi">10.3390/genes13010061</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Del Amparo</surname><given-names>R</given-names></name><name><surname>Arenas</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Influence of substitution model selection on protein phylogenetic tree reconstruction</article-title><source>Gene</source><volume>865</volume><elocation-id>147336</elocation-id><pub-id pub-id-type="doi">10.1016/j.gene.2023.147336</pub-id><pub-id pub-id-type="pmid">36871672</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Del Amparo</surname><given-names>R</given-names></name><name><surname>González-Vázquez</surname><given-names>LD</given-names></name><name><surname>Rodríguez-Moure</surname><given-names>L</given-names></name><name><surname>Bastolla</surname><given-names>U</given-names></name><name><surname>Arenas</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Consequences of genetic recombination on protein folding stability</article-title><source>Journal of Molecular Evolution</source><volume>91</volume><fpage>33</fpage><lpage>45</lpage><pub-id pub-id-type="doi">10.1007/s00239-022-10080-2</pub-id><pub-id pub-id-type="pmid">36463317</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Desai</surname><given-names>MM</given-names></name><name><surname>Fisher</surname><given-names>DS</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Beneficial mutation selection balance and the effect of linkage on positive selection</article-title><source>Genetics</source><volume>176</volume><fpage>1759</fpage><lpage>1798</lpage><pub-id pub-id-type="doi">10.1534/genetics.106.067678</pub-id><pub-id pub-id-type="pmid">17483432</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Visser</surname><given-names>J</given-names></name><name><surname>Elena</surname><given-names>SF</given-names></name><name><surname>Fragata</surname><given-names>I</given-names></name><name><surname>Matuszewski</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>The utility of fitness landscapes and big data for predicting evolution</article-title><source>Heredity</source><volume>121</volume><fpage>401</fpage><lpage>405</lpage><pub-id pub-id-type="doi">10.1038/s41437-018-0128-4</pub-id><pub-id pub-id-type="pmid">30127530</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Diaz-Uriarte</surname><given-names>R</given-names></name><name><surname>Vasallo</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Every which way? On predicting tumor evolution using cancer progression models</article-title><source>PLOS Computational Biology</source><volume>15</volume><elocation-id>e1007246</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1007246</pub-id><pub-id pub-id-type="pmid">31374072</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dimmic</surname><given-names>MW</given-names></name><name><surname>Rest</surname><given-names>JS</given-names></name><name><surname>Mindell</surname><given-names>DP</given-names></name><name><surname>Goldstein</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>rtREV: an amino acid substitution matrix for inference of retrovirus and reverse transcriptase phylogeny</article-title><source>Journal of Molecular Evolution</source><volume>55</volume><fpage>65</fpage><lpage>73</lpage><pub-id pub-id-type="doi">10.1007/s00239-001-2304-y</pub-id><pub-id pub-id-type="pmid">12165843</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eccleston</surname><given-names>RC</given-names></name><name><surname>Manko</surname><given-names>E</given-names></name><name><surname>Campino</surname><given-names>S</given-names></name><name><surname>Clark</surname><given-names>TG</given-names></name><name><surname>Furnham</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>A computational method for predicting the most likely evolutionary trajectories in the stepwise accumulation of resistance mutations</article-title><source>eLife</source><volume>12</volume><elocation-id>e84756</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.84756</pub-id><pub-id pub-id-type="pmid">38132182</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Echave</surname><given-names>J</given-names></name><name><surname>Spielman</surname><given-names>SJ</given-names></name><name><surname>Wilke</surname><given-names>CO</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Causes of evolutionary rate variation among protein sites</article-title><source>Nature Reviews. Genetics</source><volume>17</volume><fpage>109</fpage><lpage>121</lpage><pub-id pub-id-type="doi">10.1038/nrg.2015.18</pub-id><pub-id pub-id-type="pmid">26781812</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Echave</surname><given-names>J</given-names></name><name><surname>Wilke</surname><given-names>CO</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Biophysical models of protein evolution: understanding the patterns of evolutionary sequence divergence</article-title><source>Annual Review of Biophysics</source><volume>46</volume><fpage>85</fpage><lpage>103</lpage><pub-id pub-id-type="doi">10.1146/annurev-biophys-070816-033819</pub-id><pub-id pub-id-type="pmid">28301766</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ferreiro</surname><given-names>D</given-names></name><name><surname>Khalil</surname><given-names>R</given-names></name><name><surname>Gallego</surname><given-names>MJ</given-names></name><name><surname>Osorio</surname><given-names>NS</given-names></name><name><surname>Arenas</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>The evolution of the HIV-1 protease folding stability</article-title><source>Virus Evolution</source><volume>8</volume><elocation-id>veac115</elocation-id><pub-id pub-id-type="doi">10.1093/ve/veac115</pub-id><pub-id pub-id-type="pmid">36601299</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ferreiro</surname><given-names>D</given-names></name><name><surname>Branco</surname><given-names>C</given-names></name><name><surname>Arenas</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2024">2024a</year><article-title>Selection among site-dependent structurally constrained substitution models of protein evolution by approximate Bayesian computation</article-title><source>Bioinformatics</source><volume>40</volume><elocation-id>btae096</elocation-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btae096</pub-id><pub-id pub-id-type="pmid">38374231</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ferreiro</surname><given-names>D</given-names></name><name><surname>Khalil</surname><given-names>R</given-names></name><name><surname>Sousa</surname><given-names>SF</given-names></name><name><surname>Arenas</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2024">2024b</year><article-title>Substitution models of protein evolution with selection on enzymatic activity</article-title><source>Molecular Biology and Evolution</source><volume>41</volume><elocation-id>msae026</elocation-id><pub-id pub-id-type="doi">10.1093/molbev/msae026</pub-id><pub-id pub-id-type="pmid">38314876</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fischer</surname><given-names>A</given-names></name><name><surname>Vázquez-García</surname><given-names>I</given-names></name><name><surname>Mustonen</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The value of monitoring to control evolving populations</article-title><source>PNAS</source><volume>112</volume><fpage>1007</fpage><lpage>1012</lpage><pub-id pub-id-type="doi">10.1073/pnas.1409403112</pub-id><pub-id pub-id-type="pmid">25587136</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fitch</surname><given-names>WM</given-names></name><name><surname>Margoliash</surname><given-names>E</given-names></name></person-group><year iso-8601-date="1967">1967</year><article-title>A method for estimating the number of invariant amino acid coding positions in a gene using cytochrome c as a model case</article-title><source>Biochemical Genetics</source><volume>1</volume><fpage>65</fpage><lpage>71</lpage><pub-id pub-id-type="doi">10.1007/BF00487738</pub-id><pub-id pub-id-type="pmid">5610702</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fornasari</surname><given-names>MS</given-names></name><name><surname>Parisi</surname><given-names>G</given-names></name><name><surname>Echave</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Site-specific amino acid replacement matrices from structurally constrained protein evolution simulations</article-title><source>Molecular Biology and Evolution</source><volume>19</volume><fpage>352</fpage><lpage>356</lpage><pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a004089</pub-id><pub-id pub-id-type="pmid">11861895</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gernhard</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>The conditioned reconstructed process</article-title><source>Journal of Theoretical Biology</source><volume>253</volume><fpage>769</fpage><lpage>778</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2008.04.005</pub-id><pub-id pub-id-type="pmid">18538793</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gerrish</surname><given-names>PJ</given-names></name><name><surname>Sniegowski</surname><given-names>PD</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Real time forecasting of near-future evolution</article-title><source>Journal of the Royal Society, Interface</source><volume>9</volume><fpage>2268</fpage><lpage>2278</lpage><pub-id pub-id-type="doi">10.1098/rsif.2012.0119</pub-id><pub-id pub-id-type="pmid">22513725</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gilson</surname><given-names>AI</given-names></name><name><surname>Marshall-Christensen</surname><given-names>A</given-names></name><name><surname>Choi</surname><given-names>JM</given-names></name><name><surname>Shakhnovich</surname><given-names>EI</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>The role of evolutionary selection in the dynamics of protein structure evolution</article-title><source>Biophysical Journal</source><volume>112</volume><fpage>1350</fpage><lpage>1365</lpage><pub-id pub-id-type="doi">10.1016/j.bpj.2017.02.029</pub-id><pub-id pub-id-type="pmid">28402878</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldstein</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The evolution and evolutionary consequences of marginal thermostability in proteins</article-title><source>Proteins</source><volume>79</volume><fpage>1396</fpage><lpage>1407</lpage><pub-id pub-id-type="doi">10.1002/prot.22964</pub-id><pub-id pub-id-type="pmid">21337623</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldstein</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Population size dependence of fitness effect distribution and substitution rate probed by biophysical model of protein thermostability</article-title><source>Genome Biology and Evolution</source><volume>5</volume><fpage>1584</fpage><lpage>1593</lpage><pub-id pub-id-type="doi">10.1093/gbe/evt110</pub-id><pub-id pub-id-type="pmid">23884461</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gong</surname><given-names>LI</given-names></name><name><surname>Suchard</surname><given-names>MA</given-names></name><name><surname>Bloom</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Stability-mediated epistasis constrains the evolution of an influenza protein</article-title><source>eLife</source><volume>2</volume><elocation-id>e00631</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.00631</pub-id><pub-id pub-id-type="pmid">23682315</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goyal</surname><given-names>S</given-names></name><name><surname>Balick</surname><given-names>DJ</given-names></name><name><surname>Jerison</surname><given-names>ER</given-names></name><name><surname>Neher</surname><given-names>RA</given-names></name><name><surname>Shraiman</surname><given-names>BI</given-names></name><name><surname>Desai</surname><given-names>MM</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Dynamic mutation-selection balance as an evolutionary attractor</article-title><source>Genetics</source><volume>191</volume><fpage>1309</fpage><lpage>1319</lpage><pub-id pub-id-type="doi">10.1534/genetics.112.141291</pub-id><pub-id pub-id-type="pmid">22661327</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grantham</surname><given-names>R</given-names></name></person-group><year iso-8601-date="1974">1974</year><article-title>Amino acid difference formula to help explain protein evolution</article-title><source>Science</source><volume>185</volume><fpage>862</fpage><lpage>864</lpage><pub-id pub-id-type="doi">10.1126/science.185.4154.862</pub-id><pub-id pub-id-type="pmid">4843792</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Harmon</surname><given-names>LJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><chapter-title>Introduction to birth-death models</chapter-title><person-group person-group-type="editor"><name><surname>Harmon</surname><given-names>LJ</given-names></name></person-group><source>Phylogenetic Comparative Methods</source><publisher-name>Princeton University Press</publisher-name></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hoban</surname><given-names>S</given-names></name><name><surname>Bertorelle</surname><given-names>G</given-names></name><name><surname>Gaggiotti</surname><given-names>OE</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Computer simulations: tools for population and evolutionary genetics</article-title><source>Nature Reviews. Genetics</source><volume>13</volume><fpage>110</fpage><lpage>122</lpage><pub-id pub-id-type="doi">10.1038/nrg3130</pub-id><pub-id pub-id-type="pmid">22230817</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hudson</surname><given-names>RR</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>Properties of a neutral allele model with intragenic recombination</article-title><source>Theoretical Population Biology</source><volume>23</volume><fpage>183</fpage><lpage>201</lpage><pub-id pub-id-type="doi">10.1016/0040-5809(83)90013-8</pub-id><pub-id pub-id-type="pmid">6612631</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hudson</surname><given-names>RR</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Gene genealogies and the coalescent process</article-title><source>Oxford Surveys in Evolutionary Biology</source><volume>7</volume><fpage>1</fpage><lpage>44</lpage></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hudson</surname><given-names>RR</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Island models and the coalescent process</article-title><source>Molecular Ecology</source><volume>7</volume><fpage>413</fpage><lpage>418</lpage><pub-id pub-id-type="doi">10.1046/j.1365-294x.1998.00344.x</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Illergård</surname><given-names>K</given-names></name><name><surname>Ardell</surname><given-names>DH</given-names></name><name><surname>Elofsson</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Structure is three to ten times more conserved than sequence--a study of structural response in protein cores</article-title><source>Proteins</source><volume>77</volume><fpage>499</fpage><lpage>508</lpage><pub-id pub-id-type="doi">10.1002/prot.22458</pub-id><pub-id pub-id-type="pmid">19507241</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jacquier</surname><given-names>H</given-names></name><name><surname>Birgy</surname><given-names>A</given-names></name><name><surname>Le Nagard</surname><given-names>H</given-names></name><name><surname>Mechulam</surname><given-names>Y</given-names></name><name><surname>Schmitt</surname><given-names>E</given-names></name><name><surname>Glodt</surname><given-names>J</given-names></name><name><surname>Bercot</surname><given-names>B</given-names></name><name><surname>Petit</surname><given-names>E</given-names></name><name><surname>Poulain</surname><given-names>J</given-names></name><name><surname>Barnaud</surname><given-names>G</given-names></name><name><surname>Gros</surname><given-names>PA</given-names></name><name><surname>Tenaillon</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Capturing the mutational landscape of the beta-lactamase TEM-1</article-title><source>PNAS</source><volume>110</volume><fpage>13067</fpage><lpage>13072</lpage><pub-id pub-id-type="doi">10.1073/pnas.1215206110</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jumper</surname><given-names>J</given-names></name><name><surname>Evans</surname><given-names>R</given-names></name><name><surname>Pritzel</surname><given-names>A</given-names></name><name><surname>Green</surname><given-names>T</given-names></name><name><surname>Figurnov</surname><given-names>M</given-names></name><name><surname>Ronneberger</surname><given-names>O</given-names></name><name><surname>Tunyasuvunakool</surname><given-names>K</given-names></name><name><surname>Bates</surname><given-names>R</given-names></name><name><surname>Žídek</surname><given-names>A</given-names></name><name><surname>Potapenko</surname><given-names>A</given-names></name><name><surname>Bridgland</surname><given-names>A</given-names></name><name><surname>Meyer</surname><given-names>C</given-names></name><name><surname>Kohl</surname><given-names>SAA</given-names></name><name><surname>Ballard</surname><given-names>AJ</given-names></name><name><surname>Cowie</surname><given-names>A</given-names></name><name><surname>Romera-Paredes</surname><given-names>B</given-names></name><name><surname>Nikolov</surname><given-names>S</given-names></name><name><surname>Jain</surname><given-names>R</given-names></name><name><surname>Adler</surname><given-names>J</given-names></name><name><surname>Back</surname><given-names>T</given-names></name><name><surname>Petersen</surname><given-names>S</given-names></name><name><surname>Reiman</surname><given-names>D</given-names></name><name><surname>Clancy</surname><given-names>E</given-names></name><name><surname>Zielinski</surname><given-names>M</given-names></name><name><surname>Steinegger</surname><given-names>M</given-names></name><name><surname>Pacholska</surname><given-names>M</given-names></name><name><surname>Berghammer</surname><given-names>T</given-names></name><name><surname>Bodenstein</surname><given-names>S</given-names></name><name><surname>Silver</surname><given-names>D</given-names></name><name><surname>Vinyals</surname><given-names>O</given-names></name><name><surname>Senior</surname><given-names>AW</given-names></name><name><surname>Kavukcuoglu</surname><given-names>K</given-names></name><name><surname>Kohli</surname><given-names>P</given-names></name><name><surname>Hassabis</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Highly accurate protein structure prediction with AlphaFold</article-title><source>Nature</source><volume>596</volume><fpage>583</fpage><lpage>589</lpage><pub-id pub-id-type="doi">10.1038/s41586-021-03819-2</pub-id><pub-id pub-id-type="pmid">34265844</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kimura</surname><given-names>M</given-names></name><name><surname>Weiss</surname><given-names>GH</given-names></name></person-group><year iso-8601-date="1964">1964</year><article-title>The stepping stone model of population structure and the decrease of genetic correlation with distance</article-title><source>Genetics</source><volume>49</volume><fpage>561</fpage><lpage>576</lpage><pub-id pub-id-type="doi">10.1093/genetics/49.4.561</pub-id><pub-id pub-id-type="pmid">17248204</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kingman</surname><given-names>JFC</given-names></name></person-group><year iso-8601-date="1982">1982</year><article-title>The coalescent</article-title><source>Stochastic Processes and Their Applications</source><volume>13</volume><fpage>235</fpage><lpage>248</lpage><pub-id pub-id-type="doi">10.1016/0304-4149(82)90011-4</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kullback</surname><given-names>S</given-names></name><name><surname>Leibler</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="1951">1951</year><article-title>On information and sufficiency</article-title><source>The Annals of Mathematical Statistics</source><volume>22</volume><fpage>79</fpage><lpage>86</lpage><pub-id pub-id-type="doi">10.1214/aoms/1177729694</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lässig</surname><given-names>M</given-names></name><name><surname>Łuksza</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Can we read the future from a tree?</article-title><source>eLife</source><volume>3</volume><elocation-id>e05060</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.05060</pub-id><pub-id pub-id-type="pmid">25395039</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lässig</surname><given-names>M</given-names></name><name><surname>Mustonen</surname><given-names>V</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Predicting evolution</article-title><source>Nature Ecology &amp; Evolution</source><volume>1</volume><elocation-id>0077</elocation-id><pub-id pub-id-type="doi">10.1038/s41559-017-0077</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Le</surname><given-names>TK</given-names></name><name><surname>Vinh</surname><given-names>LS</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>FLAVI: An amino acid substitution model for flaviviruses</article-title><source>Journal of Molecular Evolution</source><volume>88</volume><fpage>445</fpage><lpage>452</lpage><pub-id pub-id-type="doi">10.1007/s00239-020-09943-3</pub-id><pub-id pub-id-type="pmid">32356020</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lemant</surname><given-names>J</given-names></name><name><surname>Le Sueur</surname><given-names>C</given-names></name><name><surname>Manojlović</surname><given-names>V</given-names></name><name><surname>Noble</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Robust, universal tree balance indices</article-title><source>Systematic Biology</source><volume>71</volume><fpage>1210</fpage><lpage>1224</lpage><pub-id pub-id-type="doi">10.1093/sysbio/syac027</pub-id><pub-id pub-id-type="pmid">35412638</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lemmon</surname><given-names>AR</given-names></name><name><surname>Moriarty</surname><given-names>EC</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>The importance of proper model assumption in bayesian Phylogenetics</article-title><source>Systematic Biology</source><volume>53</volume><fpage>265</fpage><lpage>277</lpage><pub-id pub-id-type="doi">10.1080/10635150490423520</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liberles</surname><given-names>DA</given-names></name><name><surname>Teichmann</surname><given-names>SA</given-names></name><name><surname>Bahar</surname><given-names>I</given-names></name><name><surname>Bastolla</surname><given-names>U</given-names></name><name><surname>Bloom</surname><given-names>J</given-names></name><name><surname>Bornberg-Bauer</surname><given-names>E</given-names></name><name><surname>Colwell</surname><given-names>LJ</given-names></name><name><surname>de Koning</surname><given-names>APJ</given-names></name><name><surname>Dokholyan</surname><given-names>NV</given-names></name><name><surname>Echave</surname><given-names>J</given-names></name><name><surname>Elofsson</surname><given-names>A</given-names></name><name><surname>Gerloff</surname><given-names>DL</given-names></name><name><surname>Goldstein</surname><given-names>RA</given-names></name><name><surname>Grahnen</surname><given-names>JA</given-names></name><name><surname>Holder</surname><given-names>MT</given-names></name><name><surname>Lakner</surname><given-names>C</given-names></name><name><surname>Lartillot</surname><given-names>N</given-names></name><name><surname>Lovell</surname><given-names>SC</given-names></name><name><surname>Naylor</surname><given-names>G</given-names></name><name><surname>Perica</surname><given-names>T</given-names></name><name><surname>Pollock</surname><given-names>DD</given-names></name><name><surname>Pupko</surname><given-names>T</given-names></name><name><surname>Regan</surname><given-names>L</given-names></name><name><surname>Roger</surname><given-names>A</given-names></name><name><surname>Rubinstein</surname><given-names>N</given-names></name><name><surname>Shakhnovich</surname><given-names>E</given-names></name><name><surname>Sjölander</surname><given-names>K</given-names></name><name><surname>Sunyaev</surname><given-names>S</given-names></name><name><surname>Teufel</surname><given-names>AI</given-names></name><name><surname>Thorne</surname><given-names>JL</given-names></name><name><surname>Thornton</surname><given-names>JW</given-names></name><name><surname>Weinreich</surname><given-names>DM</given-names></name><name><surname>Whelan</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The interface of protein structure, protein biophysics, and molecular evolution</article-title><source>Protein Science</source><volume>21</volume><fpage>769</fpage><lpage>785</lpage><pub-id pub-id-type="doi">10.1002/pro.2071</pub-id><pub-id pub-id-type="pmid">22528593</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lind</surname><given-names>PA</given-names></name><name><surname>Libby</surname><given-names>E</given-names></name><name><surname>Herzog</surname><given-names>J</given-names></name><name><surname>Rainey</surname><given-names>PB</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Predicting mutational routes to new adaptive phenotypes</article-title><source>eLife</source><volume>8</volume><elocation-id>e38822</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.38822</pub-id><pub-id pub-id-type="pmid">30616716</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lobkovsky</surname><given-names>AE</given-names></name><name><surname>Wolf</surname><given-names>YI</given-names></name><name><surname>Koonin</surname><given-names>EV</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Universal distribution of protein evolution rates as a consequence of protein folding physics</article-title><source>PNAS</source><volume>107</volume><fpage>2983</fpage><lpage>2988</lpage><pub-id pub-id-type="doi">10.1073/pnas.0910445107</pub-id><pub-id pub-id-type="pmid">20133769</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luksza</surname><given-names>M</given-names></name><name><surname>Lässig</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A predictive fitness model for influenza</article-title><source>Nature</source><volume>507</volume><fpage>57</fpage><lpage>61</lpage><pub-id pub-id-type="doi">10.1038/nature13087</pub-id><pub-id pub-id-type="pmid">24572367</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Malcolm</surname><given-names>BA</given-names></name><name><surname>Wilson</surname><given-names>KP</given-names></name><name><surname>Matthews</surname><given-names>BW</given-names></name><name><surname>Kirsch</surname><given-names>JF</given-names></name><name><surname>Wilson</surname><given-names>AC</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Ancestral lysozymes reconstructed, neutrality tested, and thermostability linked to hydrocarbon packing</article-title><source>Nature</source><volume>345</volume><fpage>86</fpage><lpage>89</lpage><pub-id pub-id-type="doi">10.1038/345086a0</pub-id><pub-id pub-id-type="pmid">2330057</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mendez</surname><given-names>R</given-names></name><name><surname>Fritsche</surname><given-names>M</given-names></name><name><surname>Porto</surname><given-names>M</given-names></name><name><surname>Bastolla</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Mutation bias favors protein folding stability in the evolution of small populations</article-title><source>PLOS Computational Biology</source><volume>6</volume><elocation-id>e1000767</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000767</pub-id><pub-id pub-id-type="pmid">20463869</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Minning</surname><given-names>J</given-names></name><name><surname>Porto</surname><given-names>M</given-names></name><name><surname>Bastolla</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Detecting selection for negative design in proteins through an improved model of the misfolded state</article-title><source>Proteins</source><volume>81</volume><fpage>1102</fpage><lpage>1112</lpage><pub-id pub-id-type="doi">10.1002/prot.24244</pub-id><pub-id pub-id-type="pmid">23280507</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morcos</surname><given-names>F</given-names></name><name><surname>Pagnani</surname><given-names>A</given-names></name><name><surname>Lunt</surname><given-names>B</given-names></name><name><surname>Bertolino</surname><given-names>A</given-names></name><name><surname>Marks</surname><given-names>DS</given-names></name><name><surname>Sander</surname><given-names>C</given-names></name><name><surname>Zecchina</surname><given-names>R</given-names></name><name><surname>Onuchic</surname><given-names>JN</given-names></name><name><surname>Hwa</surname><given-names>T</given-names></name><name><surname>Weigt</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Direct-coupling analysis of residue coevolution captures native contacts across many protein families</article-title><source>PNAS</source><volume>108</volume><fpage>E1293</fpage><lpage>E1301</lpage><pub-id pub-id-type="doi">10.1073/pnas.1111471108</pub-id><pub-id pub-id-type="pmid">22106262</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moreira</surname><given-names>F</given-names></name><name><surname>Arenas</surname><given-names>M</given-names></name><name><surname>Videira</surname><given-names>A</given-names></name><name><surname>Pereira</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Evolution of TOP1 and TOP1MT topoisomerases in chordata</article-title><source>Journal of Molecular Evolution</source><volume>91</volume><fpage>192</fpage><lpage>203</lpage><pub-id pub-id-type="doi">10.1007/s00239-022-10091-z</pub-id><pub-id pub-id-type="pmid">36651963</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morris</surname><given-names>DH</given-names></name><name><surname>Gostic</surname><given-names>KM</given-names></name><name><surname>Pompei</surname><given-names>S</given-names></name><name><surname>Bedford</surname><given-names>T</given-names></name><name><surname>Łuksza</surname><given-names>M</given-names></name><name><surname>Neher</surname><given-names>RA</given-names></name><name><surname>Grenfell</surname><given-names>BT</given-names></name><name><surname>Lässig</surname><given-names>M</given-names></name><name><surname>McCauley</surname><given-names>JW</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Predictive modeling of influenza shows the promise of applied evolutionary biology</article-title><source>Trends in Microbiology</source><volume>26</volume><fpage>102</fpage><lpage>118</lpage><pub-id pub-id-type="doi">10.1016/j.tim.2017.09.004</pub-id><pub-id pub-id-type="pmid">29097090</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Munck</surname><given-names>C</given-names></name><name><surname>Gumpert</surname><given-names>HK</given-names></name><name><surname>Wallin</surname><given-names>AIN</given-names></name><name><surname>Wang</surname><given-names>HH</given-names></name><name><surname>Sommer</surname><given-names>MOA</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Prediction of resistance development against drug combinations by collateral responses to component drugs</article-title><source>Science Translational Medicine</source><volume>6</volume><elocation-id>262ra156</elocation-id><pub-id pub-id-type="doi">10.1126/scitranslmed.3009940</pub-id><pub-id pub-id-type="pmid">25391482</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Navascués</surname><given-names>M</given-names></name><name><surname>Depaulis</surname><given-names>F</given-names></name><name><surname>Emerson</surname><given-names>BC</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Combining contemporary and ancient DNA in population genetic and phylogeographical studies</article-title><source>Molecular Ecology Resources</source><volume>10</volume><fpage>760</fpage><lpage>772</lpage><pub-id pub-id-type="doi">10.1111/j.1755-0998.2010.02895.x</pub-id><pub-id pub-id-type="pmid">21565088</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neher</surname><given-names>RA</given-names></name><name><surname>Hallatschek</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Genealogies of rapidly adapting populations</article-title><source>PNAS</source><volume>110</volume><fpage>437</fpage><lpage>442</lpage><pub-id pub-id-type="doi">10.1073/pnas.1213113110</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neher</surname><given-names>RA</given-names></name><name><surname>Russell</surname><given-names>CA</given-names></name><name><surname>Shraiman</surname><given-names>BI</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Predicting evolution from the shape of genealogical trees</article-title><source>eLife</source><volume>3</volume><elocation-id>e03568</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.03568</pub-id><pub-id pub-id-type="pmid">25385532</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nickle</surname><given-names>DC</given-names></name><name><surname>Heath</surname><given-names>L</given-names></name><name><surname>Jensen</surname><given-names>MA</given-names></name><name><surname>Gilbert</surname><given-names>PB</given-names></name><name><surname>Mullins</surname><given-names>JI</given-names></name><name><surname>Kosakovsky Pond</surname><given-names>SL</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>HIV-specific probabilistic models of protein evolution</article-title><source>PLOS ONE</source><volume>2</volume><elocation-id>e503</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0000503</pub-id><pub-id pub-id-type="pmid">17551583</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Papkou</surname><given-names>A</given-names></name><name><surname>Garcia-Pastor</surname><given-names>L</given-names></name><name><surname>Escudero</surname><given-names>JA</given-names></name><name><surname>Wagner</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>A rugged yet easily navigable fitness landscape</article-title><source>Science</source><volume>382</volume><elocation-id>eadh3860</elocation-id><pub-id pub-id-type="doi">10.1126/science.adh3860</pub-id><pub-id pub-id-type="pmid">37995212</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parisi</surname><given-names>G</given-names></name><name><surname>Echave</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Structural constraints and emergence of sequence patterns in protein evolution</article-title><source>Molecular Biology and Evolution</source><volume>18</volume><fpage>750</fpage><lpage>756</lpage><pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a003857</pub-id><pub-id pub-id-type="pmid">11319259</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parisi</surname><given-names>G</given-names></name><name><surname>Echave</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Generality of the structurally constrained protein evolution model: assessment on representatives of the four main fold classes</article-title><source>Gene</source><volume>345</volume><fpage>45</fpage><lpage>53</lpage><pub-id pub-id-type="doi">10.1016/j.gene.2004.11.025</pub-id><pub-id pub-id-type="pmid">15716088</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pascual-García</surname><given-names>A</given-names></name><name><surname>Abia</surname><given-names>D</given-names></name><name><surname>Méndez</surname><given-names>R</given-names></name><name><surname>Nido</surname><given-names>GS</given-names></name><name><surname>Bastolla</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Quantifying the evolutionary divergence of protein structures: the role of function change and function conservation</article-title><source>Proteins</source><volume>78</volume><fpage>181</fpage><lpage>196</lpage><pub-id pub-id-type="doi">10.1002/prot.22616</pub-id><pub-id pub-id-type="pmid">19830831</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pascual-García</surname><given-names>A</given-names></name><name><surname>Arenas</surname><given-names>M</given-names></name><name><surname>Bastolla</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The molecular clock in the evolution of protein structures</article-title><source>Systematic Biology</source><volume>68</volume><fpage>987</fpage><lpage>1002</lpage><pub-id pub-id-type="doi">10.1093/sysbio/syz022</pub-id><pub-id pub-id-type="pmid">31111152</pub-id></element-citation></ref><ref id="bib90"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poon</surname><given-names>AFY</given-names></name><name><surname>Kosakovsky Pond</surname><given-names>SL</given-names></name><name><surname>Richman</surname><given-names>DD</given-names></name><name><surname>Frost</surname><given-names>SDW</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Mapping protease inhibitor resistance to human immunodeficiency virus type 1 sequence polymorphisms within patients</article-title><source>Journal of Virology</source><volume>81</volume><fpage>13598</fpage><lpage>13607</lpage><pub-id pub-id-type="doi">10.1128/JVI.01570-07</pub-id><pub-id pub-id-type="pmid">17913806</pub-id></element-citation></ref><ref id="bib91"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rodrigue</surname><given-names>N</given-names></name><name><surname>Lartillot</surname><given-names>N</given-names></name><name><surname>Bryant</surname><given-names>D</given-names></name><name><surname>Philippe</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Site interdependence attributed to tertiary structure in amino acid sequence evolution</article-title><source>Gene</source><volume>347</volume><fpage>207</fpage><lpage>217</lpage><pub-id pub-id-type="doi">10.1016/j.gene.2004.12.011</pub-id><pub-id pub-id-type="pmid">15733531</pub-id></element-citation></ref><ref id="bib92"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rodrigues</surname><given-names>JV</given-names></name><name><surname>Bershtein</surname><given-names>S</given-names></name><name><surname>Li</surname><given-names>A</given-names></name><name><surname>Lozovsky</surname><given-names>ER</given-names></name><name><surname>Hartl</surname><given-names>DL</given-names></name><name><surname>Shakhnovich</surname><given-names>EI</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Biophysical principles predict fitness landscapes of drug resistance</article-title><source>PNAS</source><volume>113</volume><fpage>E1470</fpage><lpage>E1478</lpage><pub-id pub-id-type="doi">10.1073/pnas.1601441113</pub-id></element-citation></ref><ref id="bib93"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rubin</surname><given-names>IN</given-names></name><name><surname>Ispolatov</surname><given-names>Y</given-names></name><name><surname>Doebeli</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Adaptive diversification and niche packing on rugged fitness landscapes</article-title><source>Journal of Theoretical Biology</source><volume>562</volume><elocation-id>111421</elocation-id><pub-id pub-id-type="doi">10.1016/j.jtbi.2023.111421</pub-id><pub-id pub-id-type="pmid">36754345</pub-id></element-citation></ref><ref id="bib94"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ruiz-González</surname><given-names>MX</given-names></name><name><surname>Fares</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Coevolution analyses illuminate the dependencies between amino acid sites in the chaperonin system GroES-L</article-title><source>BMC Evolutionary Biology</source><volume>13</volume><elocation-id>156</elocation-id><pub-id pub-id-type="doi">10.1186/1471-2148-13-156</pub-id><pub-id pub-id-type="pmid">23875653</pub-id></element-citation></ref><ref id="bib95"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sali</surname><given-names>A</given-names></name><name><surname>Blundell</surname><given-names>TL</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Comparative protein modelling by satisfaction of spatial restraints</article-title><source>Journal of Molecular Biology</source><volume>234</volume><fpage>779</fpage><lpage>815</lpage><pub-id pub-id-type="doi">10.1006/jmbi.1993.1626</pub-id><pub-id pub-id-type="pmid">8254673</pub-id></element-citation></ref><ref id="bib96"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Santos-Pereira</surname><given-names>A</given-names></name><name><surname>Triunfante</surname><given-names>V</given-names></name><name><surname>Araújo</surname><given-names>PMM</given-names></name><name><surname>Martins</surname><given-names>J</given-names></name><name><surname>Soares</surname><given-names>H</given-names></name><name><surname>Poveda</surname><given-names>E</given-names></name><name><surname>Souto</surname><given-names>B</given-names></name><name><surname>Osório</surname><given-names>NS</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Nationwide study of drug resistance mutations in HIV-1 infected individuals under antiretroviral therapy in Brazil</article-title><source>International Journal of Molecular Sciences</source><volume>22</volume><elocation-id>5304</elocation-id><pub-id pub-id-type="doi">10.3390/ijms22105304</pub-id><pub-id pub-id-type="pmid">34069929</pub-id></element-citation></ref><ref id="bib97"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scheiblhofer</surname><given-names>S</given-names></name><name><surname>Laimer</surname><given-names>J</given-names></name><name><surname>Machado</surname><given-names>Y</given-names></name><name><surname>Weiss</surname><given-names>R</given-names></name><name><surname>Thalhamer</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Influence of protein fold stability on immunogenicity and its implications for vaccine design</article-title><source>Expert Review of Vaccines</source><volume>16</volume><fpage>479</fpage><lpage>489</lpage><pub-id pub-id-type="doi">10.1080/14760584.2017.1306441</pub-id><pub-id pub-id-type="pmid">28290225</pub-id></element-citation></ref><ref id="bib98"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sella</surname><given-names>G</given-names></name><name><surname>Hirsh</surname><given-names>AE</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>The application of statistical physics to evolutionary biology</article-title><source>PNAS</source><volume>102</volume><fpage>9541</fpage><lpage>9546</lpage><pub-id pub-id-type="doi">10.1073/pnas.0501865102</pub-id><pub-id pub-id-type="pmid">15980155</pub-id></element-citation></ref><ref id="bib99"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Souto</surname><given-names>B</given-names></name><name><surname>Triunfante</surname><given-names>V</given-names></name><name><surname>Santos-Pereira</surname><given-names>A</given-names></name><name><surname>Martins</surname><given-names>J</given-names></name><name><surname>Araújo</surname><given-names>PMM</given-names></name><name><surname>Osório</surname><given-names>NS</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Evolutionary dynamics of HIV-1 subtype C in Brazil</article-title><source>Scientific Reports</source><volume>11</volume><elocation-id>23060</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-021-02428-3</pub-id><pub-id pub-id-type="pmid">34845263</pub-id></element-citation></ref><ref id="bib100"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spielman</surname><given-names>SJ</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Relative model fit does not predict topological accuracy in single-gene protein Phylogenetics</article-title><source>Molecular Biology and Evolution</source><volume>37</volume><fpage>2110</fpage><lpage>2123</lpage><pub-id pub-id-type="doi">10.1093/molbev/msaa075</pub-id><pub-id pub-id-type="pmid">32191313</pub-id></element-citation></ref><ref id="bib101"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stackhouse</surname><given-names>J</given-names></name><name><surname>Presnell</surname><given-names>SR</given-names></name><name><surname>McGeehan</surname><given-names>GM</given-names></name><name><surname>Nambiar</surname><given-names>KP</given-names></name><name><surname>Benner</surname><given-names>SA</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>The ribonuclease from an extinct bovid ruminant</article-title><source>FEBS Letters</source><volume>262</volume><fpage>104</fpage><lpage>106</lpage><pub-id pub-id-type="doi">10.1016/0014-5793(90)80164-e</pub-id><pub-id pub-id-type="pmid">2318301</pub-id></element-citation></ref><ref id="bib102"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stadler</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Sampling-through-time in birth-death trees</article-title><source>Journal of Theoretical Biology</source><volume>267</volume><fpage>396</fpage><lpage>404</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2010.09.010</pub-id><pub-id pub-id-type="pmid">20851708</pub-id></element-citation></ref><ref id="bib103"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stadler</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Simulating trees with a fixed number of extant species</article-title><source>Systematic Biology</source><volume>60</volume><fpage>676</fpage><lpage>684</lpage><pub-id pub-id-type="doi">10.1093/sysbio/syr029</pub-id><pub-id pub-id-type="pmid">21482552</pub-id></element-citation></ref><ref id="bib104"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thadani</surname><given-names>NN</given-names></name><name><surname>Gurev</surname><given-names>S</given-names></name><name><surname>Notin</surname><given-names>P</given-names></name><name><surname>Youssef</surname><given-names>N</given-names></name><name><surname>Rollins</surname><given-names>NJ</given-names></name><name><surname>Ritter</surname><given-names>D</given-names></name><name><surname>Sander</surname><given-names>C</given-names></name><name><surname>Gal</surname><given-names>Y</given-names></name><name><surname>Marks</surname><given-names>DS</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Learning from prepandemic data to forecast viral escape</article-title><source>Nature</source><volume>622</volume><fpage>818</fpage><lpage>825</lpage><pub-id pub-id-type="doi">10.1038/s41586-023-06617-0</pub-id><pub-id pub-id-type="pmid">37821700</pub-id></element-citation></ref><ref id="bib105"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thornton</surname><given-names>JW</given-names></name><name><surname>Need</surname><given-names>E</given-names></name><name><surname>Crews</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Resurrecting the ancestral steroid receptor: ancient origin of estrogen signaling</article-title><source>Science</source><volume>301</volume><fpage>1714</fpage><lpage>1717</lpage><pub-id pub-id-type="doi">10.1126/science.1086185</pub-id><pub-id pub-id-type="pmid">14500980</pub-id></element-citation></ref><ref id="bib106"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ugalde</surname><given-names>JA</given-names></name><name><surname>Chang</surname><given-names>BSW</given-names></name><name><surname>Matz</surname><given-names>MV</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Evolution of coral pigments recreated</article-title><source>Science</source><volume>305</volume><elocation-id>1433</elocation-id><pub-id pub-id-type="doi">10.1126/science.1099597</pub-id><pub-id pub-id-type="pmid">15353795</pub-id></element-citation></ref><ref id="bib107"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van Cleve</surname><given-names>J</given-names></name><name><surname>Weissman</surname><given-names>DB</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Measuring ruggedness in fitness landscapes</article-title><source>PNAS</source><volume>112</volume><fpage>7345</fpage><lpage>7346</lpage><pub-id pub-id-type="doi">10.1073/pnas.1507916112</pub-id><pub-id pub-id-type="pmid">26038574</pub-id></element-citation></ref><ref id="bib108"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Watabe</surname><given-names>T</given-names></name><name><surname>Kishino</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Structural considerations in the fitness landscape of a virus</article-title><source>Molecular Biology and Evolution</source><volume>27</volume><fpage>1782</fpage><lpage>1791</lpage><pub-id pub-id-type="doi">10.1093/molbev/msq056</pub-id><pub-id pub-id-type="pmid">20194425</pub-id></element-citation></ref><ref id="bib109"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilke</surname><given-names>CO</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Bringing molecules back into molecular evolution</article-title><source>PLOS Computational Biology</source><volume>8</volume><elocation-id>e1002572</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002572</pub-id><pub-id pub-id-type="pmid">22761562</pub-id></element-citation></ref><ref id="bib110"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wiuf</surname><given-names>C</given-names></name><name><surname>Posada</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>A coalescent model of recombination hotspots</article-title><source>Genetics</source><volume>164</volume><fpage>407</fpage><lpage>417</lpage><pub-id pub-id-type="doi">10.1093/genetics/164.1.407</pub-id><pub-id pub-id-type="pmid">12750351</pub-id></element-citation></ref><ref id="bib111"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wortel</surname><given-names>MT</given-names></name><name><surname>Agashe</surname><given-names>D</given-names></name><name><surname>Bailey</surname><given-names>SF</given-names></name><name><surname>Bank</surname><given-names>C</given-names></name><name><surname>Bisschop</surname><given-names>K</given-names></name><name><surname>Blankers</surname><given-names>T</given-names></name><name><surname>Cairns</surname><given-names>J</given-names></name><name><surname>Colizzi</surname><given-names>ES</given-names></name><name><surname>Cusseddu</surname><given-names>D</given-names></name><name><surname>Desai</surname><given-names>MM</given-names></name><name><surname>van Dijk</surname><given-names>B</given-names></name><name><surname>Egas</surname><given-names>M</given-names></name><name><surname>Ellers</surname><given-names>J</given-names></name><name><surname>Groot</surname><given-names>AT</given-names></name><name><surname>Heckel</surname><given-names>DG</given-names></name><name><surname>Johnson</surname><given-names>ML</given-names></name><name><surname>Kraaijeveld</surname><given-names>K</given-names></name><name><surname>Krug</surname><given-names>J</given-names></name><name><surname>Laan</surname><given-names>L</given-names></name><name><surname>Lässig</surname><given-names>M</given-names></name><name><surname>Lind</surname><given-names>PA</given-names></name><name><surname>Meijer</surname><given-names>J</given-names></name><name><surname>Noble</surname><given-names>LM</given-names></name><name><surname>Okasha</surname><given-names>S</given-names></name><name><surname>Rainey</surname><given-names>PB</given-names></name><name><surname>Rozen</surname><given-names>DE</given-names></name><name><surname>Shitut</surname><given-names>S</given-names></name><name><surname>Tans</surname><given-names>SJ</given-names></name><name><surname>Tenaillon</surname><given-names>O</given-names></name><name><surname>Teotónio</surname><given-names>H</given-names></name><name><surname>de Visser</surname><given-names>JAGM</given-names></name><name><surname>Visser</surname><given-names>ME</given-names></name><name><surname>Vroomans</surname><given-names>RMA</given-names></name><name><surname>Werner</surname><given-names>GDA</given-names></name><name><surname>Wertheim</surname><given-names>B</given-names></name><name><surname>Pennings</surname><given-names>PS</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Towards evolutionary predictions: Current promises and challenges</article-title><source>Evolutionary Applications</source><volume>16</volume><fpage>3</fpage><lpage>21</lpage><pub-id pub-id-type="doi">10.1111/eva.13513</pub-id><pub-id pub-id-type="pmid">36699126</pub-id></element-citation></ref><ref id="bib112"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wright</surname><given-names>S</given-names></name></person-group><year iso-8601-date="1931">1931</year><article-title>Evolution in mendelian populations</article-title><source>Genetics</source><volume>16</volume><fpage>97</fpage><lpage>159</lpage><pub-id pub-id-type="doi">10.1093/genetics/16.2.97</pub-id><pub-id pub-id-type="pmid">17246615</pub-id></element-citation></ref><ref id="bib113"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wylie</surname><given-names>CS</given-names></name><name><surname>Shakhnovich</surname><given-names>EI</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A biophysical protein folding model accounts for most mutational fitness effects in viruses</article-title><source>PNAS</source><volume>108</volume><fpage>9916</fpage><lpage>9921</lpage><pub-id pub-id-type="doi">10.1073/pnas.1017572108</pub-id></element-citation></ref><ref id="bib114"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z</given-names></name><name><surname>Goldman</surname><given-names>N</given-names></name><name><surname>Friday</surname><given-names>A</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Comparison of models for nucleotide substitution used in maximum-likelihood phylogenetic estimation</article-title><source>Molecular Biology and Evolution</source><volume>11</volume><fpage>316</fpage><lpage>324</lpage><pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a040112</pub-id><pub-id pub-id-type="pmid">8170371</pub-id></element-citation></ref><ref id="bib115"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Among-site rate variation and its impact on phylogenetic analyses</article-title><source>Trends in Ecology &amp; Evolution</source><volume>11</volume><fpage>367</fpage><lpage>372</lpage><pub-id pub-id-type="doi">10.1016/0169-5347(96)10041-0</pub-id><pub-id pub-id-type="pmid">21237881</pub-id></element-citation></ref><ref id="bib116"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2006">2006</year><source>Computational Molecular Evolution</source><publisher-loc>Oxford, England</publisher-loc><publisher-name>Oxford University Press</publisher-name><pub-id pub-id-type="doi">10.1093/acprof:oso/9780198567028.001.0001</pub-id></element-citation></ref><ref id="bib117"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yoshida</surname><given-names>K</given-names></name><name><surname>Hata</surname><given-names>K</given-names></name><name><surname>Kawakami</surname><given-names>K</given-names></name><name><surname>Hiradate</surname><given-names>S</given-names></name><name><surname>Osawa</surname><given-names>T</given-names></name><name><surname>Kachi</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Predicting ecosystem changes by a new model of ecosystem evolution</article-title><source>Scientific Reports</source><volume>13</volume><elocation-id>15353</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-023-42529-9</pub-id><pub-id pub-id-type="pmid">37717039</pub-id></element-citation></ref><ref id="bib118"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zeldovich</surname><given-names>KB</given-names></name><name><surname>Chen</surname><given-names>P</given-names></name><name><surname>Shakhnovich</surname><given-names>EI</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Protein stability imposes limits on organism complexity and speed of molecular evolution</article-title><source>PNAS</source><volume>104</volume><fpage>16152</fpage><lpage>16157</lpage><pub-id pub-id-type="doi">10.1073/pnas.0705366104</pub-id></element-citation></ref><ref id="bib119"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Nei</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Accuracies of ancestral amino acid sequences inferred by the parsimony, likelihood, and distance methods</article-title><source>Journal of Molecular Evolution</source><volume>44 Suppl 1</volume><fpage>S139</fpage><lpage>S146</lpage><pub-id pub-id-type="doi">10.1007/pl00000067</pub-id><pub-id pub-id-type="pmid">9071022</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.106365.3.sa0</article-id><title-group><article-title>eLife Assessment</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Bitbol</surname><given-names>Anne-Florence</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution>Ecole Polytechnique Federale de Lausanne (EPFL)</institution><country>Switzerland</country></aff></contrib></contrib-group><kwd-group kwd-group-type="evidence-strength"><kwd>Solid</kwd></kwd-group><kwd-group kwd-group-type="claim-importance"><kwd>Useful</kwd></kwd-group></front-stub><body><p>This manuscript introduces a <bold>useful</bold> protein-stability-based fitness model for simulating protein evolution and unifying non-neutral models of molecular evolution with phylogenetic models. The model is applied to five viral proteins that are of structural and functional importance. While the general modelling approach is <bold>solid</bold>, and effectively preserves folding stability, the evidence for the model's predictive power remains limited, since it shows little improvement over neutral models in predicting protein evolution. The work should be of interest to researchers developing theoretical models of molecular evolution.</p></body></sub-article><sub-article article-type="referee-report" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.106365.3.sa1</article-id><title-group><article-title>Reviewer #1 (Public review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>Ferreiro et al. present a method to simulate protein sequence evolution under a birth-death model where sequence evolution is guided by structural constraints on protein stability. The authors then use this model to explore the predictability of sequence evolution in several viral proteins. In principle, this work is of great interest to molecular evolution and phylodynamics, which has struggled to couple non-neutral models of sequence evolution to phylodynamic models like birth-death processes. Unfortunately, though, the model shows little improvement over neutral models in predicting protein sequence evolution, although it can predict protein stability better than models assuming neutral evolution. It appears that more work is needed to determine exactly what aspects of protein sequence evolution are predictable under such non-neutral phylogenetic models.</p><p>Major concerns:</p><p>(1) The authors have clarified the mapping between birth-death model parameters and fitness, but how fitness is modeled still appears somewhat problematic. The authors assume the death rate = 1 - birth rate. So a variant with a birth rate b = 1 would have a death rate d = 0 and so would be immortal and never die, which does not seem plausible. Also I'm not sure that this would &quot;allow a constant global (birth-death) rate&quot; as stated in line 172, as selection would still act to increase the population mean growth rate r = b - d. It seems more reasonable to assume that protein stability affects only either the birth or death rate and assume the other rate is constant, as in the Neher 2014 model.</p><p>(2) It is difficult to evaluate the predictive performance of protein sequence evolution. This is in part due to the fact that performance is compared in terms of percent divergence, which is difficult to compare across viral proteins and datasets. Some protein sequences would be expected to diverge more because they are evolving over longer time scales, under higher substitution rates or under weaker purifying selection. It might therefore help to normalize the divergence between predicted and observed sequences by the expected or empirically observed amount of divergence seen over the timescale of prediction.</p><p>(3) Predictability may also vary significantly across different sites in a protein. For example, mutations at many sites may have little impact on structural stability (in which case we would expect poor predictive performance) while even conservative changes at other sites may disrupt folding. I therefore feel that there remains much work to be done here in terms of figuring out where and when sequence evolution might be predictable under these types of models, and when sequence evolution might just be fundamentally unpredictable due to the high entropy of sequence space.</p></body></sub-article><sub-article article-type="referee-report" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.106365.3.sa2</article-id><title-group><article-title>Reviewer #2 (Public review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>In this study, the authors aim to forecast the evolution of viral proteins by simulating sequence changes under a constraint of folding stability. The central idea is that proteins must retain a certain level of structural stability (quantified by folding free energy, ΔG) to remain functional, and that this constraint can shape and restrict the space of viable evolutionary trajectories. The authors integrate a birth-death population model with a structurally constrained substitution (SCS) model and apply this simulation framework to several viral proteins from HIV-1, SARS-CoV-2, and influenza.</p><p>The motivation to incorporate biophysical constraints into evolutionary models is scientifically sound, and the general approach aligns with a growing interest in bridging molecular evolution and structural biology. The authors focus on proteins where immune pressure is limited and stability is likely to be a dominant constraint, which is conceptually appropriate. The method generates sequence variants that preserve folding stability, suggesting that stability-based filtering may capture certain evolutionary patterns.</p><p>However, the study does not substantiate its central claim of forecasting. The model does not predict future sequences with measurable accuracy, nor does it reproduce observed evolutionary paths. Validation is limited to endpoint comparisons in a few datasets. While KL divergence is used to compare amino acid distributions, this analysis is only applied to a single protein (HIV-1 MA), and there is no assessment of mutation-level predictive accuracy or quantification of how well simulated sequences recapitulate real evolutionary paths. No comparison is made to real intermediate variants available from extensive viral sequencing datasets which gather thousands of sequences with detailed collection date annotation (SARS-CoV-2, Influenza, RSV).</p><p>The selection of proteins is narrow and the rationale for including or excluding specific proteins is not clearly justified.</p><p>The analyzed datasets are also under-characterized: we are not given insight into how variable the sequences are or how surprising the simulated sequences might be relative to natural diversity. Furthermore, the use of consensus sequences to represent timepoints is problematic, particularly in the context of viral evolution, where divergent subclades often coexist - a consensus sequence may not accurately reflect the underlying population structure.</p><p>The fitness function used in the main simulations is based on absolute ΔG and rewards increased stability without testing whether real evolutionary trajectories tend to maintain, increase, or reduce folding stability over time for the particular systems (proteins) that are studied. While a variant of the model does attempt to center selection around empirical ΔG values, this more biologically plausible version is underutilized and not well validated.</p><p>Ultimately, the model constrains sequence evolution to stability-compatible trajectories but does not forecast which of these trajectories are likely to occur. It is better understood as a filter of biophysically plausible outcomes than as a predictive tool. The distinction between constraint-based plausibility and sequence-level forecasting should be made clearer. Despite these limitations, the work may be of interest to researchers developing simulation frameworks or exploring the role of protein stability in viral evolution, and it raises interesting questions about how biophysical constraints shape sequence space over time.</p></body></sub-article><sub-article article-type="author-comment" id="sa3"><front-stub><article-id pub-id-type="doi">10.7554/eLife.106365.3.sa3</article-id><title-group><article-title>Author response</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Ferreiro</surname><given-names>David</given-names></name><role specific-use="author">Author</role><aff><institution>Universidade de Vigo</institution><addr-line><named-content content-type="city">Vigo</named-content></addr-line><country>Spain</country></aff></contrib><contrib contrib-type="author"><name><surname>González-Vázquez</surname><given-names>Luis Daniel</given-names></name><role specific-use="author">Author</role><aff><institution>Universidade de Vigo</institution><addr-line><named-content content-type="city">Vigo</named-content></addr-line><country>Spain</country></aff></contrib><contrib contrib-type="author"><name><surname>Prado-Comesaña</surname><given-names>Ana</given-names></name><role specific-use="author">Author</role><aff><institution>Universidade de Vigo</institution><addr-line><named-content content-type="city">Vigo</named-content></addr-line><country>Spain</country></aff></contrib><contrib contrib-type="author"><name><surname>Arenas</surname><given-names>Miguel</given-names></name><role specific-use="author">Author</role><aff><institution>Universidade de Vigo</institution><addr-line><named-content content-type="city">Vigo</named-content></addr-line><country>Spain</country></aff></contrib></contrib-group></front-stub><body><p>The following is the authors’ response to the current reviews.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #1 (Public review):</bold></p><p>Summary:</p><p>Ferreiro et al. present a method to simulate protein sequence evolution under a birth-death model where sequence evolution is guided by structural constraints on protein stability. The authors then use this model to explore the predictability of sequence evolution in several viral proteins. In principle, this work is of great interest to molecular evolution and phylodynamics, which has struggled to couple non-neutral models of sequence evolution to phylodynamic models like birth-death processes. Unfortunately, though, the model shows little improvement over neutral models in predicting protein sequence evolution, although it can predict protein stability better than models assuming neutral evolution. It appears that more work is needed to determine exactly what aspects of protein sequence evolution are predictable under such non-neutral phylogenetic models.</p></disp-quote><p>We thank the reviewer for the positive comments about our work. We agree that further work is needed in the field of substitution models of molecular evolution to enable more accurate predictions of specific amino acid sequences in evolutionary processes.</p><disp-quote content-type="editor-comment"><p>Major concerns:</p><p>(1) The authors have clarified the mapping between birth-death model parameters and fitness, but how fitness is modeled still appears somewhat problematic. The authors assume the death rate = 1 - birth rate. So a variant with a birth rate b = 1 would have a death rate d = 0 and so would be immortal and never die, which does not seem plausible. Also I'm not sure that this would &quot;allow a constant global (birth-death) rate&quot; as stated in line 172, as selection would still act to increase the population mean growth rate r = b - d. It seems more reasonable to assume that protein stability affects only either the birth or death rate and assume the other rate is constant, as in the Neher 2014 model.</p></disp-quote><p>The model proposed by Neher, et al. (2014), which incorporates a death rate (d) higher than 0 for any variant, was implemented and applied in the present method. In general, this model did not yield results different from those obtained using the model that assumes d = 1 – b, suggesting that this aspect may not be crucial for the study system. Next, the imposition of arbitrary death events based on an arbitrary death rate could be a point of concern. Regarding the original model, a variant with d = 0 can experience a decrease in fitness through the mutation process. In an evolutionary process, each variant is subject to mutation, and Markov models allow for the incorporation of mutations that decrease fitness (albeit with lower probability than beneficial ones, but they can still occur). All this information is included in the manuscript.</p><disp-quote content-type="editor-comment"><p>(2) It is difficult to evaluate the predictive performance of protein sequence evolution. This is in part due to the fact that performance is compared in terms of percent divergence, which is difficult to compare across viral proteins and datasets. Some protein sequences would be expected to diverge more because they are evolving over longer time scales, under higher substitution rates or under weaker purifying selection. It might therefore help to normalize the divergence between predicted and observed sequences by the expected or empirically observed amount of divergence seen over the timescale of prediction.</p></disp-quote><p>AU: The study protein datasets showed different levels of sequence divergence over their evolutionary times, as indicated for each dataset in the manuscript. For some metrics, we evaluated the accuracy (or error) of the predictions through direct comparisons between real and predicted protein variants using percentages to facilitate interpretation: 0% indicates a perfect prediction (no error), while 100% indicates a completely incorrect prediction (total error). Regarding normalization of these evaluations, we respectfully disagree with the suggestion because diverse factors can affect (not only the substitution rate, but also the sample size, structural features of the protein that may affect stability when accommodating different sequences, among others) and this complicates defining a consistent and meaningful normalization criterion. Given that the manuscript provides detailed information for each dataset, we believe that the presentation of the prediction accuracy through direct comparisons between real and predicted protein variants, expressed as percentages of similarity, is the clearest way.</p><disp-quote content-type="editor-comment"><p>(3) Predictability may also vary significantly across different sites in a protein. For example, mutations at many sites may have little impact on structural stability (in which case we would expect poor predictive performance) while even conservative changes at other sites may disrupt folding. I therefore feel that there remains much work to be done here in terms of figuring out where and when sequence evolution might be predictable under these types of models, and when sequence evolution might just be fundamentally unpredictable due to the high entropy of sequence space.</p></disp-quote><p>We agree with this reflection. Mutations can have different effects on folding stability, which are accounted for by the model presented in this study. However, accurately predicting the exact sequences of protein variants with similar stability remains difficult with current structurally constrained substitution models, and therefore, further work is needed in this regard. This aspect is indicated in the manuscript.</p><p>We want to thank the reviewer again for taking the time to revise our work and for the insightful and helpful comments.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #2 (Public review):</bold></p><p>In this study, the authors aim to forecast the evolution of viral proteins by simulating sequence changes under a constraint of folding stability. The central idea is that proteins must retain a certain level of structural stability (quantified by folding free energy, ΔG) to remain functional, and that this constraint can shape and restrict the space of viable evolutionary trajectories. The authors integrate a birth-death population model with a structurally constrained substitution (SCS) model and apply this simulation framework to several viral proteins from HIV-1, SARS-CoV-2, and influenza.</p><p>The motivation to incorporate biophysical constraints into evolutionary models is scientifically sound, and the general approach aligns with a growing interest in bridging molecular evolution and structural biology. The authors focus on proteins where immune pressure is limited and stability is likely to be a dominant constraint, which is conceptually appropriate. The method generates sequence variants that preserve folding stability, suggesting that stability-based filtering may capture certain evolutionary patterns.</p></disp-quote><p>Correct. We thank the reviewer for the positive comments about our study.</p><disp-quote content-type="editor-comment"><p>However, the study does not substantiate its central claim of forecasting. The model does not predict future sequences with measurable accuracy, nor does it reproduce observed evolutionary paths. Validation is limited to endpoint comparisons in a few datasets. While KL divergence is used to compare amino acid distributions, this analysis is only applied to a single protein (HIV-1 MA), and there is no assessment of mutation-level predictive accuracy or quantification of how well simulated sequences recapitulate real evolutionary paths. No comparison is made to real intermediate variants available from extensive viral sequencing datasets which gather thousands of sequences with detailed collection date annotation (SARS-CoV-2, Influenza, RSV).</p></disp-quote><p>There are several points in this comment.</p><p>The presented method accurately predicts folding stability of forecasted variants, as shown through comparisons between real and predicted protein variants. However, as the reviewer correctly indicates, predicting the exact amino acid sequences remains challenging. This limitation is discussed in detail in the manuscript, where we also suggest that further improvements in substitution models of protein evolution are needed to better capture the evolutionary signatures of amino acid change at the sequence level, even between amino acids with similar physicochemical properties. Regarding the time points used for validation, the studied influenza NS1 dataset included two validation points. A key limitation in increasing the number of time points is the scarcity of datasets derived from monitoring protein evolution with sufficient molecular diversity between samples collected at consecutive time points (i.e., at least more than five polymorphic amino acid sites).</p><p>As described in the manuscript, calculating Kullback-Leibler (KL) divergence requires more than one sequence per studied time point. However, most datasets in the literature include only a single sequence per time point, typically a consensus sequence derived from bulk population sequencing. Generating multiple sequences per time point is experimentally more demanding, often requiring advanced methods such as single-virus sequencing or amplification of sublineages in viral subpopulations, as was done for the first dataset used in the study (Arenas, et al. 2016), which enabled the calculation of KL divergence. The extent to which the simulated sequences resemble real evolution is evaluated in the method validation. As noted, intermediate time point validation was performed using the influenza NS1 protein dataset. Although, as the reviewer indicates, thousands of viral sequences are available, these are usually consensus sequences from bulk sequencing. Indeed, many viral variants mainly differ through synonymous mutations, where the number of accumulated nonsynonymous mutations is small. For example, from the original Wuhan strain to the Omicron variant, the SARS-CoV-2 proteins Mpro and PLpro accumulated only 10 and 22 amino acid changes, respectively.</p><p>Analyzing intermediate variants of concern (i.e., Gamma or Delta) would reduce this number affecting statistics. In addition, many available viral sequences are not consecutive in evolutionary terms (one dataset does not represent the direct origin of another dataset at a subsequent time point), which further limits their applicability in this study. There is little data from monitored protein evolution with consecutive samples. The most suitable studies usually involve in vitro virus evolution, but the data from these studies often show low genetic variability between samples collected at different time points. Finally, it is important to note that the presented method can only be applied to proteins with known 3D structures, as it relies on selection based on folding stability. Non-structural proteins cannot be analyzed using this approach. Future work could incorporate additional selection constraints, which may improve the accuracy of predictions. These considerations and limitations are indicated in the manuscript.</p><disp-quote content-type="editor-comment"><p>The selection of proteins is narrow and the rationale for including or excluding specific proteins is not clearly justified.</p></disp-quote><p>The viral proteins included in the study were selected based on two main criteria, general interest and data availability. In particular, we included proteins from viruses that affect humans and for which data from monitored protein evolution, with sufficient molecular diversity between consecutive time points, is available. These aspects are indicated in the manuscript.</p><disp-quote content-type="editor-comment"><p>The analyzed datasets are also under-characterized: we are not given insight into how variable the sequences are or how surprising the simulated sequences might be relative to natural diversity. Furthermore, the use of consensus sequences to represent timepoints is problematic, particularly in the context of viral evolution, where divergent subclades often coexist - a consensus sequence may not accurately reflect the underlying population structure.</p></disp-quote><p>The manuscript indicates the sequence identity among protein datasets of different time points, along with other technical details. Next, the evaluation based on comparisons between simulated and real sequences reflects how surprising the simulated sequences might be relative to natural diversity, considering that the real dataset is representative. We believe that the diverse study real datasets are useful to evaluate the accuracy of the method in predicting different molecular patterns. Regarding the use of consensus sequences, we agree that they provide an approximation. However, as previously indicated, most of the available data from monitored protein evolution consist of consensus sequences obtained through bulk sequencing. Additionally, analyzing every individual viral sequence within a viral population, which is typically large, would be ideal but computationally intractable.</p><disp-quote content-type="editor-comment"><p>The fitness function used in the main simulations is based on absolute ΔG and rewards increased stability without testing whether real evolutionary trajectories tend to maintain, increase, or reduce folding stability over time for the particular systems (proteins) that are studied. While a variant of the model does attempt to center selection around empirical ΔG values, this more biologically plausible version is underutilized and not well validated.</p></disp-quote><p>The applied fitness function, based on absolute ΔG, is well stablished in the field (Sella and Hirsh 2005; Goldstein 2013). The present study independently predicts ΔG for the real and simulated protein variants at each sampling point. This ΔG prediction accounts not only for negative design, informed by empirical data, but also for positive design based on the study data (Arenas, et al. 2013; Minning, et al. 2013), thereby enabling the detection of variation in folding stability among protein variants. These aspects are indicated in the manuscript. Therefore, in our view, the study provides a proper comparison of real and predicted evolutionary trajectories in terms of folding stability.</p><disp-quote content-type="editor-comment"><p>Ultimately, the model constrains sequence evolution to stability-compatible trajectories but does not forecast which of these trajectories are likely to occur. It is better understood as a filter of biophysically plausible outcomes than as a predictive tool. The distinction between constraint-based plausibility and sequence-level forecasting should be made clearer. Despite these limitations, the work may be of interest to researchers developing simulation frameworks or exploring the role of protein stability in viral evolution, and it raises interesting questions about how biophysical constraints shape sequence space over time.</p></disp-quote><p>The presented method estimates the fitness of each protein variant, which can reflect the relative survival capacity of the variant. Therefore, despite the error due to evolutionary constraints not considered by the method, it indicates which variants are more likely to become fixed over time. In our view, the method does not merely filter plausible variants, rather, it generates predictions of variant survival through predicted fitness based on folding stability and simulations of protein evolution under structurally constrained substitution models integrated with birth-death population genetics approaches. The use of simulation-based approaches for prediction is well established in population genetics. For example, approaches such as approximate Bayesian computation (Beaumont, et al. 2002) rely on this strategy, and it has also been applied in other studies of forecasting evolution (e.g., Neher, et al. 2014). We believe that the distinction between forecasting folding stability and amino acid sequence is clearly shown in the manuscript, including the main text and the figures.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #2 (Recommendations for the authors):</bold></p><p>I thank the authors for addressing the question about template switching, their clarification was helpful. However, the core concerns I raised remain unresolved: the claim that the method is useful for forecasting is not substantiated. In order to support the paper's central claims or to prove its usefulness, several key improvements could be incorporated:</p><p>(1) Systematic analysis of more proteins:</p><p>The manuscript would be significantly strengthened by a systematic evaluation of model performance across a broader set of viral proteins, beyond the examples currently shown. Many human influenza and SARS-CoV-2 proteins have wellcharacterized structures or high-quality homology templates, making them suitable candidates. In the light of limited success of the method, presenting the model's behavior across a more comprehensive protein set, including those with varying structural constraints and immune pressures, would help assess generalizability and clarify the specific conditions under which the model is applicable.</p></disp-quote><p>Following a comment from the reviewer in a previous revision of the study, we included the analysis of an influenza NS1 protein dataset that contains two evaluation time points. Next, to validate the prediction method, it is necessary to have monitored protein sequences collected at least at two consecutive time points, with sufficient divergence between them to capture evolutionary signatures that allow for proper evaluation. Additionally, many data involve sequences that are not consecutive in evolutionary terms (one dataset is not a direct ancestor of another dataset existing at a posterior time point), which disallows their applicability in this study. Little data from monitored protein evolution with trustable consecutive (ancestor-descendant) samples exist. The most suitable studies often involve in vitro virus evolution, but they usually show low genetic variability between samples collected at different time points. Although thousands of sequences are available for some viruses, they are usually consensus sequences from bulk sequencing and often show a low number of nonsynonymous mutations at the study protein-coding gene between time points. For example, from the original Wuhan strain and the Omicron variant, the SARS-CoV-2 proteins Mpro and PLpro accumulated only 10 and 22 amino acid changes, respectively. Analyzing intermediate variants of concern (i.e., Gamma or Delta) would reduce this number affecting statistics. Thus, in practice, we found scarcity of data derived from monitoring protein evolution, with trustable ancestor and corresponding descendant data at consecutive time points and with sufficient molecular diversity between them (i.e., at least more than five polymorphic amino acid sites). In all, we believe that the diverse viral protein datasets used in the present study, along with the multiple analyzed datasets collected from monitored HIV-1 populations present in different patients, provide a representative application of the method, since notice that similar patterns were generally generated from the analysis of the different datasets.</p><disp-quote content-type="editor-comment"><p>(2) Present clear data statistics: For each analyzed dataset, the authors should provide basic information about the number of unique sequences, levels of variability, and evolutionary divergence between start and end sequences. This would contextualize the forecasting task and clarify whether the simulations are non-trivial. In particular, it should be shown that the consensus sequence is indeed representative of the viral population at a given time point. In viral evolution we frequently observe co-circulation of subclades and the consensus sequence is then not representative.</p></disp-quote><p>For each dataset analyzed, the manuscript provides the sequence identity between samples at the study time points (which also informs about sequence variability), sample sizes, representative protein structure, and other technical details. The study assumes that consensus sequences, typically generated by bulk sequencing, are representative of the viral population. Next, samples at different time points should involve ancestor-descendant relationships, which is a requirement and one of the limitations to find appropriate data for this study, as noted in our previous response.</p><disp-quote content-type="editor-comment"><p>(3) Explore other metrics for population level sequence comparison:</p><p>In the light of possible existence of subclades, mentioned above, the currently used metrics for sequence comparison may underestimate performance of the simulations. It would be sufficient to see some overlap of simulated clades and the observed clades.</p></disp-quote><p>We found this to be a good idea. However, in practice, we believe that the criteria used to define subclades could introduce biases into the results. For some metrics, we evaluated the accuracy of the predictions through direct comparisons between all real and predicted protein variants, using percentages to facilitate interpretation. We believe that using subclades could potentially reduce the current prediction errors, but this would complicate the interpretation of the results, as they would be influenced by the subjective criteria used to define the subclades.</p><disp-quote content-type="editor-comment"><p>Currently, the manuscript presents a plausible filtering framework rather than a predictive model. Without these additional analyses, the main claims remain only partially supported.</p></disp-quote><p>Please see our reply to the comment of the reviewer just before the section titled “Recommendations for the authors”.</p><disp-quote content-type="editor-comment"><p><bold>Response to some rebuttal statements:</bold></p><p>(1) &quot;Sequence comparisons based on the KL divergence require, at the studied time point, an observed distribution of amino acid frequencies among sites and an estimated distribution of amino acid frequencies among sites. In the study datasets, this is only the case for the HIV-1 MA dataset, which belongs to a previous study from one of us and collaborators where we obtained at least 20 independent sequences at each sampling point (Arenas, et al. 2016)&quot;</p><p>The available Influenza and SARS-CoV-2 data gathers isolates annotated with exact collection dates, providing reach datasets for such analysis.</p></disp-quote><p>The available influenza and SARS-CoV-2 sequences are typically derived from bulk sequencing and, therefore, they are consensus sequences. As a result, they cannot be used to calculate KL divergence. Additionally, many of the indicated sequences from databases are not demonstrated to be consecutive in evolutionary terms (one dataset is not a direct ancestor of another dataset existing at a posterior time point), which disallows their applicability in this study. The most suitable studies often involve in vitro virus evolution, but they usually show low genetic variability between samples collected at different time points.</p><disp-quote content-type="editor-comment"><p>(2) &quot;Regarding extending the analysis to other time points (other variants of concern), we kindly disagree because Omicron is the variant of concern with the highest genetic distance to the Wuhan variant, and a high genetic distance is required to properly evaluate the prediction method.&quot;</p><p>There have been many more variants of concern subsequent to Omicron which circulated in 2021.</p></disp-quote><p>A key aspect is the accumulation of diversity in the study proteins across different time points. The SARS-CoV-2 proteins Mpro and PLpro accumulated only 10 and 22 amino acid changes from the original Wuhan variant to Omicron, respectively.</p><p>Analyzing intermediate variants of concern (e.g., Gamma or Delta) or those closely related to Omicron would reduce the number of accumulated mutations even further.</p><p>We want to thank the reviewer again for taking the time to revise our work and for the insightful and helpful comments.</p><p>The following is the authors’ response to the original reviews.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #1 (Public review):</bold></p><p>Summary:</p><p>Ferreiro et al. present a method to simulate protein sequence evolution under a birth-death model where sequence evolution is constrained by structural constraints on protein stability. The authors then use this model to explore the predictability of sequence evolution in several viral structural proteins. In principle, this work is of great interest to molecular evolution and phylodynamics, which have struggled to couple non-neutral models of sequence evolution to phylodynamic models like birth-death. Unfortunately, though, the model shows little improvement over neutral models in predicting protein evolution, and this ultimately appears to be due to fundamental conceptual problems with how fitness is modeled and linked to the phylodynamic birth-death model.</p></disp-quote><p>AU: We thank the reviewer for the positive comments about our work.</p><p>Regarding predictive power, the study showed a good accuracy in predicting the real folding stability of forecasted protein variants under a selection model, but not under a neutral model. Next, predicting the exact sequences was more challenging. In this revised version, where we added additional real data, we found that the accuracy of this prediction can vary among proteins (i.e., the SCS model was more accurate than the neutral model in predicting sequences of the influenza NS1 protein at different time points). Still, we consider that efforts are required in the field of substitution models of molecular evolution. For example, amino acids with similar physicochemical properties can result in predictions with appropriate folding stability while different specific sequence. The development of accurate substitution models of molecular evolution is an active area of research with ongoing progress, but further efforts are still needed. Next, forecasting the folding stability of future real proteins is fundamental for proper forecasting protein evolution, given the essential role of folding stability in protein function and its variety of applications. Regarding the conceptual concerns related to fitness modeling, we clarify them in detail in our responses to the specific comments below.</p><disp-quote content-type="editor-comment"><p>Major concerns:</p><p>(1) Fitness model: All lineages have the same growth rate r = b-d because the authors assume b+d=1. But under a birth-death model, the growth r is equivalent to fitness, so this is essentially assuming all lineages have the same absolute fitness since increases in reproductive fitness (b) will simply trade off with decreases in survival (d). Thus, even if the SCS model constrains sequence evolution, the birthdeath model does not really allow for non-neutral evolution such that mutations can feed back and alter the structure of the phylogeny.</p></disp-quote><p>We thank the reviewer for this comment that aims to improve the realism of our model. In the model presented (but see later another model, derived from the proposal of the reviewer, that we have now implemented into the framework and applied it to the study data), the fitness predicted from a protein variant is used to obtain the corresponding birth rate of that variant. In this way, protein variants with high fitness have high birth rates leading to overall more birth events, while protein variants with low fitness have low birth rates resulting in overall more extinction events, which has biological meaning for the study system. The statement “All lineages have the same growth rate r = b-d” in our model is incorrect because, in our model, b and d can vary among lineages according to the fitness. For example, a lineage might have b=0.9, d=0.1, r=0.8, while another lineage could have b=0.6, d=0.4, r=0.2. Indeed, the statement “this is essentially assuming all lineages have the same absolute fitness” is incorrect. Clearly, assuming that all lineages have the same fitness would not make sense, in that situation the folding stability of the forecasted protein variants would be similar under any model, which is not the case as shown in the results. In our model, the fitness affects the reproductive success, where protein variants with a high fitness have higher birth rates leading to more birth events, while those with lower fitness have higher death rates leading to more extinction events. This parameterization is meaningful for protein evolution because the fitness of a protein variant can affect its survival (birth or extinction) without necessarily affecting its rate of evolution. While faster growth rate can sometimes be associated with higher fitness, a variant with high fitness does not necessarily accumulate substitutions at a faster rate. Regarding the phylogenetic structure, the model presented considers variable birth and death events across different lineages according to the fitness of the corresponding protein variants, and this affects the derived phylogeny (i.e., protein variants selected against can go extinct while others with high fitness can produce descendants). We are not sure about the meaning of the term “mutations can feed back” in the context of our system. Note that we use Markov models of evolution, which are well-stablished in the field (despite their limitations), and substitutions are fixed mutations, which still could be reverted later if selected by the substitution model (Yang 2006). Altogether, we find that the presented birth-death model is technically correct and appropriate for modeling our biological system. Its integration with structurally constrained substitution (SCS) models of protein evolution as Markov models follows general approaches of molecular evolution in population genetics (Yang 2006; Carvajal-Rodriguez 2010; Arenas 2012; Hoban, et al. 2012). We have now provided a more detailed description of the models in the manuscript.</p><p>Apart from these clarifications about the birth-death model used, we could understand the point of the reviewer and following the suggestion we have now incorporated an additional birth-death model that accounts for variable global birth-death rate among lineages. Specifically, we followed the model proposed by Neher et al (2014), where the death rate is considered as 1 and the birth rate is modeled as 1 + fitness. In this model, the global birth-death rate can vary among lineages. We implemented this model into the computer framework and applied it to the data used for the evaluation of the models. The results indicated that, in general, this model yields similar predictive accuracy compared to the previous birth-death model. Thus, accounting for variability in the global birth-death rate does not appear to play a major role in the studied systems of protein evolution. We have now presented this additional birth-death model and its results in the manuscript.</p><disp-quote content-type="editor-comment"><p>(2) Predictive performance: Similar performance in predicting amino acid frequencies is observed under both the SCS model and the neutral model. I suspect that this rather disappointing result owes to the fact that the absolute fitness of different viral variants could not actually change during the simulations (see comment #1).</p></disp-quote><p>As indicated in our previous answer, our study shows a good accuracy in predicting the real folding stability of forecasted protein variants under a selection model, but not under a neutral model. Next, predicting the exact sequences was more challenging, which was not surprising considering previous studies. In particular, inferring specific sequences is considerably challenging even for ancestral molecular reconstruction (Arenas, et al. 2017; Arenas and Bastolla 2020). Indeed, observed sequence diversity is much greater than observed structural diversity (Illergard, et al. 2009; Pascual-Garcia, et al. 2010), and substitutions between amino acids with similar physicochemical properties can yield modeled protein variants with more accurate folding stability, even when the exact amino acid sequences differ. As indicated, further work is demanded in the field of substitution models of molecular evolution. Next, in this revised version, where we included analyses of additional real datasets, we found that the accuracy of sequence prediction can vary among datasets. Notably, the analysis of an influenza NS1 protein dataset, with higher diversity than the other datasets studied, showed that the SCS model was more accurate than the neutral model in predicting sequences across different time points. Datasets with relatively high sequence diversity can contain more evolutionary information, which can improve prediction quality. In any case, as previously indicated, we believe that efforts are required in the field of substitution models of molecular evolution. Apart from that, forecasting the folding stability of future real proteins is an important advance in forecasting protein evolution, given the essential role of folding stability in protein function (Scheiblhofer, et al. 2017; Bloom and Neher 2023) and its variety of applications.</p><p>Next, also as indicated in our previous response, the birth-death model used in this study accounts for variation in fitness among lineages producing variable reproductive success. The additional birth-death model that we have now incorporated, which considers variation of the global birth-death rate among lineages, produced similar prediction accuracy, suggesting a limited role in protein evolution modeling. Molecular evolution parameters, particularly the substitution model, appear to be more critical in this regard. We have now included these aspects in the manuscript.</p><disp-quote content-type="editor-comment"><p>(3) Model assessment: It would be interesting to know how much the predictions were informed by the structurally constrained sequence evolution model versus the birth-death model. To explore this, the authors could consider three different models: (1) neutral, (2) SCS, and (3) SCS + BD. Simulations under the SCS model could be performed by simulating molecular evolution along just one hypothetical lineage. Seeing if the SCS + BD model improves over the SCS model alone would be another way of testing whether mutations could actually impact the evolutionary dynamics of lineages in the phylogeny.</p></disp-quote><p>In the present study, we compared the neutral model + birth-death (BD) with the SCS model + BD. Markov substitution models Q are applied upon an evolutionary time (i.e., branch length, t) and this allows to determine the probability of substitution events during that time period [P(t) = exp (Qt)]. This approach is traditionally used in phylogenetics to model the incorporation of substitution events over time. Therefore, to compare the neutral and SCS models in terms of evolutionary inference, an evolutionary time is required, in this case it is provided by the birth-death process. Thus, the cases (1) and (2) cannot be compared without an underlined evolutionary history. Next, comparisons in terms of likelihood, and other aspects, between models that ignore the protein structure and the implemented SCS models are already available in previous studies based on coalescent simulations or given phylogenetic trees (Arenas, et al. 2013; Arenas, et al. 2015). There, SCS models outperformed models that ignore evolutionary constraints from the protein structure, and those findings are consistent with the results obtained in the present study where we explored the application of these models to forecasting protein evolution. We would like to emphasize that forecasting the folding stability of future real proteins is a significant finding, folding stability is fundamental to protein function and has a variety of applications. We have now indicated these aspects in the manuscript.</p><disp-quote content-type="editor-comment"><p>(4) Background fitness effects: The model ignores background genetic variation in fitness. I think this is particularly important as the fitness effects of mutations in any one protein may be overshadowed by the fitness effects of mutations elsewhere in the genome. The model also ignores background changes in fitness due to the environment, but I acknowledge that might be beyond the scope of the current work.</p></disp-quote><p>AU: This comment made us realize that more information about the features of the implemented SCS models should be included in the manuscript. In particular, the implemented SCS models consider a negative design based on the observed residue contacts in nearly all proteins available in the Protein Data Bank (Arenas, et al. 2013; Arenas, et al. 2015). This data is distributed with the framework, and it can be updated to incorporate new structures (further details are provided in the distributed framework documentation and practical examples). Therefore, the prediction of folding stability is a combination of positive design (direct analysis of the target protein) and negative design (consideration of background proteins from a database to improve the predictions), thus incorporating background molecular diversity. We have now indicated this important aspect in the manuscript. Regarding the fitness caused by the environment, we agree with the reviewer. This is a challenge for any method aiming to forecast evolution, as future environmental shifts are inherently unpredictable and may affect the accuracy of the predictions. Although one might attempt to incorporate such effects into the model, doing so risks overparameterization, especially when the additional factors are uncertain or speculative. We have now mentioned this aspect in the manuscript.</p><disp-quote content-type="editor-comment"><p>(5) In contrast to the model explored here, recent work on multi-type birth-death processes has considered models where lineages have type-specific birth and/or death rates and therefore also type-specific growth rates and fitness (Stadler and Bonhoeffer, 2013; Kunhert et al., 2017; Barido-Sottani, 2023). Rasmussen &amp; Stadler (eLife, 2019) even consider a multi-type birth-death model where the fitness effects of multiple mutations in a protein or viral genome collectively determine the overall fitness of a lineage. The key difference with this work presented here is that these models allow lineages to have different growth rates and fitness, so these models truly allow for non-neutral evolutionary dynamics. It would appear the authors might need to adopt a similar approach to successfully predict protein evolution.</p></disp-quote><p>We agree with the reviewer that robust birth-death models have been developed applying statistics and, in many cases, the primary aim of those studies is the development and refinement of the model itself. Regarding the study by Rasmussen and Stadler 2019, it incorporates an external evaluation of mutation events where the used fitness is specific for the proteins investigated in that study, which may pose challenges for users interested in analyzing other proteins. In contrast, our study takes a different approach. We implement a fitness function that can be predicted and evaluated for any type of structural protein (Goldstein 2013), making it broadly applicable. Actually, in this revised version we added the analysis of additional data of another protein (influenza NS1 protein) with predictions at different time points. In addition, we provide a freely available and well-documented computational framework to facilitate its use. The primary aim of our study is not the development of novel or complex birthdeath models. Rather, we aim to explore the integration of a standard birth-death model with SCS models for the purpose of predicting protein evolution. In the context of protein evolution, substitution models are a critical factor (Liberles, et al. 2012; Wilke 2012; Bordner and Mittelmann 2013; Echave, et al. 2016; Arenas, et al. 2017; Echave and Wilke 2017), and the presented combination with a birth-death model constitutes a first approximation upon which next studies can build to better understand this evolutionary system. We have now indicated these considerations in the manuscript.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #2 (Public review):</bold></p><p>Summary:</p><p>In this study, &quot;Forecasting protein evolution by integrating birth-death population models with structurally constrained substitution models&quot;, David Ferreiro and coauthors present a forward-in-time evolutionary simulation framework that integrates a birth-death population model with a fitness function based on protein folding stability. By incorporating structurally constrained substitution models and estimating fitness from ΔG values using homology-modeled structures, the authors aim to capture biophysically realistic evolutionary dynamics. The approach is implemented in a new version of their open-source software, ProteinEvolver2, and is applied to four viral proteins from HIV-1 and SARS-CoV-2.</p><p>Overall, the study presents a compelling rationale for using folding stability as a constraint in evolutionary simulations and offers a novel framework and software to explore such dynamics. While the results are promising, particularly for predicting biophysical properties, the current analysis provides only partial evidence for true evolutionary forecasting, especially at the sequence level. The work offers a meaningful conceptual advance and a useful simulation tool, and sets the stage for more extensive validation in future studies.</p></disp-quote><p>We thank the reviewer for the positive comments on our study. Regarding the predictive power, the results showed good accuracy in predicting the folding stability of the forecasted protein variants. In this revised version, where we included analyses of additional real datasets, we found that the accuracy of sequence prediction can vary among datasets. Notably, the analysis of an influenza NS1 protein dataset, with higher diversity than the other datasets studied, showed that the SCS model was more accurate than the neutral model in predicting sequences across different time points. Datasets with relatively high sequence diversity can contain more evolutionary information, which can improve prediction quality. Still, we believe that further efforts are required in the field in improving the accuracy of substitution models of molecular evolution. Altogether, accurately forecasting the folding stability of future real proteins is fundamental for predicting their protein function and enabling a variety of applications. Also, we implemented the models into a freely available computer framework, with detailed documentation and a variety of practical examples.</p><disp-quote content-type="editor-comment"><p>Strengths:</p><p>The results demonstrate that fitness constraints based on protein stability can prevent the emergence of unrealistic, destabilized variants - a limitation of traditional, neutral substitution models. In particular, the predicted folding stabilities of simulated protein variants closely match those observed in real variants, suggesting that the model captures relevant biophysical constraints.</p></disp-quote><p>We agree with the reviewer and appreciate the consideration that forecasting the folding stability of future real proteins is a relevant finding. For instance, folding stability is fundamental for protein function and affects several other molecular properties.</p><disp-quote content-type="editor-comment"><p>Weaknesses:</p><p>The predictive scope of the method remains limited. While the model effectively preserves folding stability, its ability to forecast specific sequence content is not well supported.</p></disp-quote><p>Our study showed a good accuracy in predicting the real folding stability of forecasted protein variants under a selection model, but not under a neutral model. Predicting the exact sequences was more challenging, which was not surprising considering previous studies. In particular, inferring specific sequences is considerably challenging even for ancestral molecular reconstruction (Arenas, et al. 2017; Arenas and Bastolla 2020). Indeed, observed sequence diversity is much greater than observed structural diversity (Illergard, et al. 2009; Pascual-Garcia, et al. 2010), and substitutions between amino acids with similar physicochemical properties can yield modeled protein variants with more accurate folding stability, even when the exact amino acid sequences differ. As indicated, further work is demanded in the field of substitution models of molecular evolution. Next, in this revised version, where we included analyses of additional real datasets, we found that the accuracy of sequence prediction can vary among datasets. Notably, the analysis of an influenza NS1 protein dataset, with higher diversity than the other datasets studied, showed that the SCS model was more accurate than the neutral model in predicting sequences across different time points. Datasets with relatively high sequence diversity can contain more evolutionary information, which can improve prediction quality. In any case, as previously indicated, we believe that efforts are required in the field of substitution models of molecular evolution. Apart from that, forecasting the folding stability of future real proteins is an important advance in forecasting protein evolution, given the essential role of folding stability in protein function (Scheiblhofer, et al. 2017; Bloom and Neher 2023) and its variety of applications. We have now expanded these aspects in the manuscript.</p><disp-quote content-type="editor-comment"><p>Only one dataset (HIV-1 MA) is evaluated for sequence-level divergence using KL divergence; this analysis is absent for the other proteins. The authors use a consensus Omicron sequence as a representative endpoint for SARS-CoV-2, which overlooks the rich longitudinal sequence data available from GISAID. The use of just one consensus from a single time point is not fully justified, given the extensive temporal and geographical sampling available. Extending the analysis to include multiple timepoints, particularly for SARS-CoV-2, would strengthen the predictive claims. Similarly, applying the model to other well-sampled viral proteins, such as those from influenza or RSV, would broaden its relevance and test its generalizability.</p></disp-quote><p>The evaluation of forecasting evolution using real datasets is complex due to several conceptual and practical aspects. In contrast to traditional phylogenetic reconstruction of past evolutionary events and ancestral sequences, forecasting evolution often begins with a variant that is evolved forward in time and requires a rough fitness landscape to select among possible future variants (Lässig, et al. 2017). Another concern for validating the method is the need to know the initial variant that gives rise to the corresponding future (forecasted) variants, and it is not always known. Thus, we investigated systems where the initial variant, or a close approximation, is known, such as scenarios of in vitro monitored evolution. In the case of SARS-CoV-2, the Wuhan variant is commonly used as the starting variant of the pandemic. Next, since forecasting evolution is highly dependent on the used model of evolution, unexpected external factors can be dramatic for the predictions. For this reason, systems with minimal external influences provide a more controlled context for evaluating forecasting evolution. For instance, scenarios of in vitro monitored virus evolution avoid some external factors such as host immune responses. Another important aspect is the availability of data at two (i.e., present and future) or more time points along the evolutionary trajectory, with sufficient genetic diversity between them to identify clear evolutionary signatures. Additionally, using consensus sequences can help mitigate effects from unfixed mutations, which should not be modeled by a substitution model of evolution. Altogether, not all datasets are appropriate to properly evaluate or apply forecasting evolution. These aspects are indicated in the manuscript. Sequence comparisons based on the KL divergence require, at the studied time point, an observed distribution of amino acid frequencies among sites and an estimated distribution of amino acid frequencies among sites. In the study datasets, this is only the case for the HIV-1 MA dataset, which belongs to a previous study from one of us and collaborators where we obtained at least 20 independent sequences at each sampling point (Arenas, et al. 2016). This aspect is now more clearly indicated in the manuscript. Regarding the Omicron datasets, we used 384 curated sequences of the Omicron variant of concern to construct the study data and we believe that it is a representative sample. The sequence used for the initial time point was the Wuhan variant (Wu, et al. 2020), which is commonly assumed to be the origin of the pandemic in SARS-CoV-2 studies. As previously indicated, the use of consensus sequences is convenient to avoid variants with unfixed mutations. Regarding extending the analysis to other time points (other variants of concern), we kindly disagree because Omicron is the variant of concern with the highest genetic distance to the Wuhan variant, and a high genetic distance is required to properly evaluate the prediction method. Actually, we noted that earlier variants of concern show a small number of fixed mutations in the study proteins, despite the availability of large numbers of sequences in databases such as GISAID. Additionally, we investigated the evolutionary trajectories of HIV-1 protease (PR) in 12 intra-host viral populations with predictions for up to four different time points. Apart from those aspects, following the proposal of the reviewer, we have now incorporated the analysis of an additional dataset of influenza NS1 protein (Bao, et al. 2008), with predictions for two different time points, to further assess the generalizability of the method. We have now included details of this influenza NS1 protein dataset and the predictions derived from it in the manuscript.</p><disp-quote content-type="editor-comment"><p>It would also be informative to include a retrospective analysis of the evolution of protein stability along known historical trajectories. This would allow the authors to assess whether folding stability is indeed preserved in real-world evolution, as assumed in their model.</p></disp-quote><p>Our present study does not aim to investigate the evolution of the folding stability over time, although it provides this information indirectly at the studied time points. Instead, the present study shows that the folding stability of the forecasted protein variants is similar to the folding stability of the corresponding real protein variants for diverse viral proteins, which provides an important evaluation of the prediction method. Next, the folding stability can indeed vary over time in both real and modeled evolutionary scenarios, and our present study is not in conflict with this. In that regard, which is not the aim of our present study, some previous phylogenetic-based studies have reported temporal fluctuations in folding stability for diverse protein data (Arenas, et al. 2017; Olabode, et al. 2017; Arenas and Bastolla 2020; Ferreiro, et al. 2022).</p><disp-quote content-type="editor-comment"><p>Finally, a discussion on the impact of structural templates - and whether the fixed template remains valid across divergent sequences - would be valuable. Addressing the possibility of structural remodeling or template switching during evolution would improve confidence in the model's applicability to more divergent evolutionary scenarios.</p></disp-quote><p>This is an important point. For the datasets that required homology modeling (in several cases it was not necessary because the sequence was present in a protein structure of the PDB), the structural templates were selected using SWISS-MODEL, and we applied the best-fitting template. We have now included in a supplementary table details about the fitting of the structural templates. Indeed, our proposal assumes that the protein structure is maintained over the studied evolutionary time, which can be generally reasonable for short timescales where the structure is conserved (Illergard, et al. 2009; Pascual-Garcia, et al. 2010). Over longer evolutionary timescales, structural changes may occur and, in such cases, modeling the evolution of the protein structure would be necessary. To our knowledge, modeling the evolution of the protein structure remains a challenging task that requires substantial methodological developments. Recent advances in artificial intelligence, particularly in protein structure prediction from sequence, may offer promising tools for addressing this challenge. However, we believe that evaluating such approaches in the context of structural evolution would be difficult, especially given the limited availability of real data with known evolutionary trajectories involving structural change. In any case, this is probably an important direction for future research. We have now included this discussion in the manuscript.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #1 (Recommendations for the authors):</bold></p><p>(1) Abstract: &quot;expectedly, the errors grew up in the prediction of the corresponding sequences&quot; &lt;- Not entirely clear what is meant by &quot;errors grew up&quot; or what the errors grew with.</p></disp-quote><p>This sentence refers to the accuracy of sequence prediction in comparison to that of folding stability prediction. We have now clarified this aspect in the manuscript.</p><disp-quote content-type="editor-comment"><p>(2) Lines 162-165: &quot;Alternatively, if the fitness is determined based on the similarity in folding stability between the modeled variant and a real variant, the birth rate is assumed to be 1 minus the root mean square deviation (RMSD) in folding stability.&quot; &lt;- What is the biological motivation for using the RMSD? It seems like a more stable variant would always have higher fitness, at least according to Equation 1.</p></disp-quote><p>RMSD is commonly used in molecular biology to compare proteins in terms of structural distance, folding stability, kinetics, and other properties. It offers advantages such as minimizing the influence of small deviations while amplifying larger differences, thereby enhancing the detection of remarkable molecular changes. Additionally, RMSD would facilitate the incorporation of other biophysical parameters, such as structural divergences from a wild-type variant or entropy, which could be informative for fitness in future versions of the method. We have now included this consideration in the manuscript.</p><disp-quote content-type="editor-comment"><p>(3) Lines 165-166: &quot;In both cases, the death rate (d) is considered as 1-b to allow a constant global (birth-death) rate&quot; &lt;- This would give a constant R = b / (1-b) over the entire phylogenetic tree. For applications to pathogens like viruses with epidemic dynamics, this is extremely implausible. Is there any need to make such a restrictive assumption?</p></disp-quote><p>Regarding technical considerations of the model, we refer to our answer to the first public review comment. Next, a constant global rate of evolution was observed in numerous genes and proteins of diverse organisms, including viruses (Gojobori, et al.1990; Leitner and Albert 1999; Shankarappa, et al. 1999; Liu, et al. 2004; Lu, et al. 2018; Zhou, et al. 2019). However, following the comment of the reviewer, and as we indicated in our answer to the first public review comment, we have now implemented and evaluated an additional birth-death model that allows for variation in the global birth-death rate among lineages. We have implemented this additional model in the framework and described it along with its results in the manuscript.</p><disp-quote content-type="editor-comment"><p>(4) Lines 187-188: &quot;As a consequence, since b+d=1 at each node, tn is consistent across all nodes, according to (Harmon, 2019).&quot; &lt;- This would also imply that all lineages have a growth rate r = b - d, which under a birth-death model is equivalent to saying all lineages have the same fitness!</p></disp-quote><p>We clarified this aspect in our answer to the first public review comment. In particular, in the model presented, protein variants with higher fitness have higher birth rates, leading to more birth events, while protein variants with lower fitness have lower birth rates leading to more extinction events, which presents biological meaning for the study system. In our model b and d can vary among lineages according to the corresponding fitness (i.e., a lineage may have b=0.9, d=0.1, r=0.8; while another one may have b=0.6, d=0.4, r=0.2). Since the reproductive success varies among lineages in our model, the statement “this is essentially assuming all lineages have the same absolute fitness” is incorrect, although it could be interpreted like that in certain models. Fitness affects reproductive success, but fitness and growth rate of evolution are different biological processes (despite a faster growth rate can sometimes be associated with higher fitness, a variant with a high fitness not necessarily has to accumulate substitutions at a higher rate). An example in molecular adaptation studies is the traditional nonsynonymous to synonymous substitution rates ratio (dN/dS), where dN/dS (that informs about selection derived from fitness) can be constant at different rates of evolution (dN and dS). In any case, we thank the reviewer for raising this point, which led us to incorporate an additional birth-death model and inspired some ideas. Thus, following the comment of the reviewer and as indicated in the answer to the first public review comment, we have now implemented and evaluated an additional birthdeath model that allows for variation in the global birth-death rate among lineages. The results indicated that this model yields similar predictive accuracy compared to the previous birth-death model. We have now included these aspects, along with the results from the additional model, in the manuscript.</p><disp-quote content-type="editor-comment"><p>(5) Line 321-322: &quot;For the case of neutral evolution, all protein variants equally fit and are allowed, leading to only birth events,&quot; &lt;- Why would there only be birth events? Lineages can die regardless of their fitness.</p></disp-quote><p>AU: In the neutral evolution model, all protein variants have the same fitness, resulting in a flat fitness landscape. Since variants are observed, we allowed birth events. However, it assumed the absence of death events as no information independent of fitness is available to support their inclusion and quantification, thereby avoiding the imposition of arbitrary death events based on an arbitrary death rate. We have now provided a justification of this assumption in the manuscript.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #2 (Recommendations for the authors):</bold></p><p>(1) Clarify the purpose of the alternative fitness mode (&quot;ΔG similarity to a target variant&quot;):</p><p>The manuscript briefly introduces an alternative fitness function based on the similarity of a simulated protein's folding stability to that of a real protein variant, but does not provide a clear motivation, usage scenario, or results derived from it.</p></disp-quote><p>The presented model provides two approaches for deriving fitness from predicted folding stability. The simpler approach assumes that a more stable protein variant has higher fitness than a less stable one. The alternative approach assigns high fitness to protein variants whose stability closely matches observed stability, acknowledging that the real observed stability is derived from the real selection process, and this approach considers negative design by contrasting the prediction with real information. For the analyses of real data in this study, we used the second approach, guided by these considerations. We have now clarified this aspect in the manuscript.</p><disp-quote content-type="editor-comment"><p>(2) Report structural template quality and modeling confidence:</p><p>Since folding stability (ΔG) estimates rely on structural models derived from homology templates, the accuracy of these predictions will be sensitive to the choice and quality of the template structure. I recommend that the authors report, for each protein modeled, the template's sequence identity, coverage, and modeling quality scores. This will help readers assess the confidence in the ΔG estimates and interpret how template quality might impact simulation outcomes.</p></disp-quote><p>We agree with the reviewer and we have now included additional information in a supplementary table regarding sequence identity, modeling quality and coverage of the structural templates for the proteins that required homology modeling. The selection of templates was performed using the well-established framework SWISS-MODEL and the best-fitting template was chosen. Next, a large number of protein structures are available in the PDB for the study proteins, which favors the accuracy of the homology modeling. For some datasets, homology modeling was not required, as the modeled sequence was already present in an available protein structure. We have now included this information in the manuscript and in a supplementary table.</p><disp-quote content-type="editor-comment"><p>(3) Clarify whether structural remodeling occurs during simulation:</p><p>It appears that folding stability (ΔG) for all simulated protein variants is computed by mapping them onto a single initial homology model, without remodeling the structure as sequences evolve. If correct, this should be clearly stated, as it assumes that the structural fold remains valid across all simulated variants. A discussion on the potential impact of structural drift would be welcome.</p></disp-quote><p>We agree with the reviewer. As indicated in our answer to a previous comment, our method assumes that the protein structure is maintained over the studied evolutionary time, which is generally acceptable for short timescales where the structure is conserved (Illergard, et al. 2009; Pascual-Garcia, et al. 2010). At longer timescales the protein structure could change, requiring the modeling of structural evolution over the evolutionary time. To our knowledge, modeling the evolution of the protein structure remains a challenging task that requires substantial methodological developments. Recent advances in artificial intelligence, particularly in protein structure prediction from sequence, can be promising tools for addressing this challenge. However, we believe that evaluating such approaches in the context of structural evolution would be difficult, especially given the limited availability of real datasets with known evolutionary trajectories involving structural change. In any case, this is probably an important direction for future research. We have now included this discussion in the manuscript.</p></body></sub-article></article>