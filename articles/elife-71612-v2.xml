<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article article-type="research-article" dtd-version="1.2" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">71612</article-id><article-id pub-id-type="doi">10.7554/eLife.71612</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Distributed coding of duration in rodent prefrontal cortex during time reproduction</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-244379"><name><surname>Henke</surname><given-names>Josephine</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-244493"><name><surname>Bunk</surname><given-names>David</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-244494"><name><surname>von Werder</surname><given-names>Dina</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4193-5203</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="pa1">†</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-244495"><name><surname>Häusler</surname><given-names>Stefan</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-0772-8662</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-244496"><name><surname>Flanagin</surname><given-names>Virginia L</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6677-459X</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" corresp="yes" id="author-40362"><name><surname>Thurley</surname><given-names>Kay</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4857-1083</contrib-id><email>thurley@bio.lmu.de</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>Faculty of Biology, Ludwig-Maximilians-Universität München</institution><addr-line><named-content content-type="city">Munich</named-content></addr-line><country>Germany</country></aff><aff id="aff2"><label>2</label><institution>Bernstein Center for Computational Neuroscience Munich</institution><addr-line><named-content content-type="city">Munich</named-content></addr-line><country>Germany</country></aff><aff id="aff3"><label>3</label><institution>German Center for Vertigo and Balance Disorders, Ludwig-Maximilians-Universität München</institution><addr-line><named-content content-type="city">Munich</named-content></addr-line><country>Germany</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Merchant</surname><given-names>Hugo</given-names></name><role>Reviewing Editor</role><aff><institution>National Autonomous University of Mexico</institution><country>Mexico</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Frank</surname><given-names>Michael J</given-names></name><role>Senior Editor</role><aff><institution>Brown University</institution><country>United States</country></aff></contrib></contrib-group><author-notes><fn fn-type="present-address" id="pa1"><label>†</label><p>Institute of Medical Technology, Brandenburg University of Technology Cottbus-Senftenberg, Cottbus, Germany</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>23</day><month>12</month><year>2021</year></pub-date><pub-date pub-type="collection"><year>2021</year></pub-date><volume>10</volume><elocation-id>e71612</elocation-id><history><date date-type="received" iso-8601-date="2021-06-24"><day>24</day><month>06</month><year>2021</year></date><date date-type="accepted" iso-8601-date="2021-12-14"><day>14</day><month>12</month><year>2021</year></date></history><permissions><copyright-statement>© 2021, Henke et al</copyright-statement><copyright-year>2021</copyright-year><copyright-holder>Henke et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-71612-v2.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-71612-figures-v2.pdf"/><abstract><p>As we interact with the external world, we judge magnitudes from sensory information. The estimation of magnitudes has been characterized in primates, yet it is largely unexplored in nonprimate species. Here, we use time interval reproduction to study rodent behavior and its neural correlates in the context of magnitude estimation. We show that gerbils display primate-like magnitude estimation characteristics in time reproduction. Most prominently their behavioral responses show a systematic overestimation of small stimuli and an underestimation of large stimuli, often referred to as regression effect. We investigated the underlying neural mechanisms by recording from medial prefrontal cortex and show that the majority of neurons respond either during the measurement or the reproduction of a time interval. Cells that are active during both phases display distinct response patterns. We categorize the neural responses into multiple types and demonstrate that only populations with mixed responses can encode the bias of the regression effect. These results help unveil the organizing neural principles of time reproduction and perhaps magnitude estimation in general.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>interval timing</kwd><kwd>regression effect</kwd><kwd>central tendency</kwd><kwd>magnitude estimation</kwd><kwd>population coding</kwd><kwd>gerbil</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Other</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution>Bundesministerium für Bildung, Wissenschaft und Forschung</institution></institution-wrap></funding-source><award-id>01GQ1004A</award-id><principal-award-recipient><name><surname>Henke</surname><given-names>Josephine</given-names></name><name><surname>Thurley</surname><given-names>Kay</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Mixed responses in single cells or distributed across a local population of neurons can explain regression effects during time reproduction.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Animals including humans estimate the magnitude of physical stimuli, integrate path length, and keep track of duration to gather behaviorally relevant information from their environment. Although such estimates may ultimately be used for binary actions, like discriminating items or events and making decisions, the estimation itself is done on a continuum of values. Behavioral analyses over the past century established specific biases in magnitude estimation (e.g., reviewed in <xref ref-type="bibr" rid="bib40">Petzschner et al., 2015</xref>) such as the <italic>regression effect</italic>, that is, the overestimation of small and the underestimation of large stimuli across a range of values (also known as regression to the mean, central tendency, or Vierordt’s law). Recently, this bias regained attention as it may be the result of an error minimization strategy (<xref ref-type="bibr" rid="bib20">Jazayeri and Shadlen, 2010</xref>; <xref ref-type="bibr" rid="bib39">Petzschner and Glasauer, 2011</xref>; <xref ref-type="bibr" rid="bib5">Cicchini et al., 2012</xref>).</p><p>Despite a long history of behavioral research on magnitude estimation, its neural basis is not well understood. It is an ongoing debate whether a dedicated or distributed magnitude system exists in the brain (for review, see <xref ref-type="bibr" rid="bib6">Cohen Kadosh et al., 2008</xref>; <xref ref-type="bibr" rid="bib4">Bueti and Walsh, 2009</xref>; <xref ref-type="bibr" rid="bib37">Opstal and Verguts, 2013</xref>). Human studies identified frontal, parietal, and striatal brain regions that are active during magnitude estimation. Recent studies with nonhuman primates used time interval reproduction experiments to investigate the connection between neural population dynamics in frontal and parietal cortices and magnitude estimation behavior (<xref ref-type="bibr" rid="bib21">Jazayeri and Shadlen, 2015</xref>; <xref ref-type="bibr" rid="bib50">Sohn et al., 2019</xref>). These studies focused on the estimation of time intervals lasting hundreds of milliseconds. What remains unclear is how their findings translate to durations of several seconds, that is, to time scales that are relevant for more complex and ecologically important behaviors like spatial navigation and action planning. Furthermore, it is unresolved to what extent the results generalize to nonprimate species.</p><p>We addressed these issues for Mongolian gerbils (<italic>Meriones unguiculatus</italic>) and designed a psychophysical task for time interval reproduction of several seconds on a continuous range. The task was implemented in virtual reality (<xref ref-type="bibr" rid="bib55">Thurley and Ayaz, 2017</xref>), which allows for the precise control of the behaviorally relevant variables. We used gerbils because we could successfully train these animals in complex virtual reality tasks before (<xref ref-type="bibr" rid="bib53">Thurley et al., 2014</xref>). We and others also performed timing experiments with gerbils in virtual reality (<xref ref-type="bibr" rid="bib22">Kautzky and Thurley, 2016</xref>) or alike (<xref ref-type="bibr" rid="bib46">Shankar and Ellard, 2000</xref>).</p><p>First, we demonstrate the capability of gerbils to precisely measure and reproduce time intervals of several seconds. We show that the gerbils’ responses display the regression effect, indicative of an error minimization strategy. Then, we present associated neural activity in gerbil medial prefrontal cortex (mPFC) – a brain area that has been implicated in interval timing in rodents and other species (<xref ref-type="bibr" rid="bib12">Genovesio et al., 2006</xref>; <xref ref-type="bibr" rid="bib23">Kim et al., 2013</xref>; <xref ref-type="bibr" rid="bib59">Xu et al., 2014</xref>; <xref ref-type="bibr" rid="bib10">Emmons et al., 2017</xref>). The activity we observed was composed of mixtures of responses including phasic activation and ramp-like firing patterns, response types well known from the interval timing literature (e.g., <xref ref-type="bibr" rid="bib34">Mita et al., 2009</xref>; <xref ref-type="bibr" rid="bib31">Merchant et al., 2011</xref>; <xref ref-type="bibr" rid="bib23">Kim et al., 2013</xref>; <xref ref-type="bibr" rid="bib15">Gouvêa et al., 2015</xref>; <xref ref-type="bibr" rid="bib38">Paton and Buonomano, 2018</xref>). Since our task involves measurement and reproduction, that is, the timing of an external event and of one’s own behavior, we could test how individual cells participated in both. To make the variety of responses accessible, we provide a comprehensive characterization of activity at the single neuron level and show that, despite the response heterogeneity, the mPFC population jointly measures and reproduces time intervals lasting several seconds. We find that different types of ramping neurons are necessary to explain the regression effect and thus to gain a mechanistic understanding of the neural basis of time reproduction and perhaps of magnitude estimation in general. This reveals that variables underlying cognitive functions may be encoded by mixed responses within a local neural population.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Behavioral characteristics of time reproduction in gerbils</title><p>We trained gerbils to measure and reproduce the duration of time intervals lasting a few seconds. After the presentation of a black screen, the animals had to reproduce its duration by walking along a corridor in virtual reality. Intervals were randomly sampled between 3 and 7.5 s. <xref ref-type="fig" rid="fig1">Figure 1A–C</xref> details the apparatus and task.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>A time reproduction task for rodents.</title><p>(<bold>A</bold>) Experimental apparatus and task. A gerbil was placed on top of a treadmill surrounded by a projection screen. Each trial started with a timed stimulus (black screen). The animal had to measure its duration and, when a virtual linear corridor appeared, reproduce the duration by walking. If the reproduction was close to the stimulus duration (‘in’), a food reward was delivered and the entire screen was set to green for 3–4 s before another trial was initiated; otherwise, screen color was set to white (‘out’). (<bold>B</bold>) The feedback range was narrowed/widened after each in/out response. (<bold>C</bold>) Stimulus intervals were randomly sampled from a discrete uniform distribution with seven values between 3 and 7.5 s. Colors identify stimulus duration and will be used throughout the paper. (<bold>D</bold>) Behavioral responses exhibited specific characteristics. Single reproductions (small dots) and their averages (large connected circles) showed the <italic>regression effect. Inset:</italic> standard deviation increased with stimulus duration (<italic>scalar variability</italic>). Same <italic>x</italic>-axis as in the main panel. Data in the main panel and inset are from one example session (of animal 10526). (<bold>E</bold>) Slope of the linear regression between stimuli and reproductions – quantifying the strength of the regression effect, with values closer to 1 meaning less regression, – coefficient of variation (CV), average bias, and average tolerance of the feedback range for each session sorted by animal. Values from single sessions are displayed as open circles. Gray violin plots illustrate distributions, and black solid lines mark the medians. Color identifies animals; see also ID numbers below the panels. (<bold>F</bold>) Slope negatively correlates with CV and feedback range across animals and sessions, indicating stronger regression effects with more variable responses. Open circles correspond to single sessions. Crosses mark averages for each animal. Color code as in (<bold>E</bold>).</p><p><supplementary-material id="fig1sdata1"><label>Figure 1—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig1">Figure 1E&amp;F</xref> and <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2A–C</xref>.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-71612-fig1-data1-v2.csv"/></supplementary-material></p><p><supplementary-material id="fig1sdata2"><label>Figure 1—source data 2.</label><caption><title>Source data for <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2C</xref><sub>1</sub> and C<sub>2</sub> and <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-71612-fig1-data2-v2.csv"/></supplementary-material></p><p><supplementary-material id="fig1sdata3"><label>Figure 1—source data 3.</label><caption><title>Source data for <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2D</xref>.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-71612-fig1-data3-v2.csv"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71612-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Behavioral data from an example session.</title><p>(<bold>A</bold>) Virtual speed, that is, the speed of visual movement an animal experiences, over the course of a session. Colored traces mark the reproductions (responses); gray otherwise. Color identifies stimulus duration. The 74th trial is magnified and labeled with trial phases. Position was tracked during the response phase but not during measurement and feedback. The interval between the end of stimulus presentation and the begin of the response we call ‘reaction time.’ To finish the response, the animal had to stop for at least 0.5 s. (<bold>B</bold>) Virtual speed in individual trials sorted by stimulus duration. (<bold>C</bold>) Averages for each trial of the virtual speed, the running speed of the animal on the treadmill, the path length covered during the response, and the reaction time sorted by stimulus duration or reproduction. Again color identifies stimulus duration. Pearson’s <italic>r</italic> and <italic>p</italic>-values are given on top of each panel. The data belongs to the session displayed in <xref ref-type="fig" rid="fig1">Figure 1D</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71612-fig1-figsupp1-v2.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 2.</label><caption><title>Reward rates, reaction times, and training data.</title><p>(<bold>A</bold>) Number of trials in the experimental sessions sorted by animal. Values from single sessions are displayed as open circles. Violin plots illustrate the distribution, and black solid lines mark the median. Color identifies individual animals. (<bold>B</bold>) Percentage of rewards in the sessions. (<bold>C</bold>) Average ‘reaction time’ in each session. (<bold>C<sub>1</sub></bold>, <bold>C<sub>2</sub></bold>) Distributions of Pearson’s correlation coefficients between reaction time and stimulus or reproduced durations. Histograms are displayed in gray with significant values delimited by an orange outline (<italic>p</italic>&lt;0.05). Pie plots show significant (orange) and nonsignificant (blue) fractions. (<bold>D</bold>) Development of slope and coefficient of variation across sessions for each animal. Gray shaded areas and negative session numbers mark training sessions. Data from training sessions is not included in any other part of this paper.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71612-fig1-figsupp2-v2.tif"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 3.</label><caption><title>Speed vs. other behavioral parameters.</title><p>(<bold>A</bold>) Average virtual speed in each session and distributions of Pearson’s correlations with stimulus duration (<bold>A<sub>1</sub></bold>), reproduced duration (<bold>A<sub>2</sub></bold>), and bias (i.e., reproduced – stimulus duration, <bold>A<sub>3</sub></bold>). (<bold>B</bold>) Same as (<bold>A</bold>) for running speed of the animal on the treadmill. Values from single sessions are displayed as open circles. Violin plots illustrate the distribution, and black solid lines mark the median. Color identifies animals. Histograms are displayed in gray with significant values delimited by an orange outline (<italic>p</italic>&lt;0.05). Pie plots show significant (orange) and nonsignificant (blue) fractions.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71612-fig1-figsupp3-v2.tif"/></fig></fig-group><p>The gerbil’s behavior exhibited typical magnitude estimation characteristics. Across the range of stimuli, small stimuli were overestimated whereas large stimuli were underestimated, that is, the regression effect (<xref ref-type="bibr" rid="bib40">Petzschner et al., 2015</xref>). <xref ref-type="fig" rid="fig1">Figure 1D</xref> gives an example from a single experimental session. To quantify the regression effect across sessions and animals, we calculated the slope of linear fits between stimuli and reproductions in each session. The slopes increased during training (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2D</xref>), indicating learning and improvement in the time reproduction task, but remained at levels less than 1 in the actual experimental sessions due to the regression effect (<xref ref-type="fig" rid="fig1">Figure 1E</xref>). Variability, that is, the coefficient of variation (CV), decreased with training and remained at low levels during the actual experiments (<xref ref-type="fig" rid="fig1">Figure 1E</xref>, <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2D</xref>). The CV correlated with the strength of regression, indicating a connection between the regression effect and error minimization (<xref ref-type="fig" rid="fig1">Figure 1F</xref>). Some sessions showed a general under- or overestimation in addition to the regression effect (bias, <xref ref-type="fig" rid="fig1">Figure 1E</xref>).</p><p>To keep the animals motivated, we gave them feedback on their reproduction performance (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). Although this feedback could be used to correct reproduction errors, we still observed the regression effect. Since we adapted the feedback range after every stimulus (<xref ref-type="fig" rid="fig1">Figure 1B</xref>), its width indicated estimation precision, with a narrower feedback range corresponding to higher precision. The average width of the feedback range in a session correlated negatively with the slope, which is another sign of a connection between the regression effect and error minimization (<xref ref-type="fig" rid="fig1">Figure 1F</xref>).</p></sec><sec id="s2-2"><title>Single cells differentially encode time during measurement and reproduction</title><p>We recorded a total of 1766 mPFC units over 101 experimental sessions from three gerbils. Visual inspection of the spiking responses, after sorting by stimulus duration and splitting into the two task phases ‘measurement’ and ‘reproduction,’ revealed a variety of response patterns that could underlie time reproduction. Three examples are shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>; further examples can be found in <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>-<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>. The neuron in <xref ref-type="fig" rid="fig2">Figure 2A</xref> increased its activity during measurement, such that the firing rate by the end of the phase correlated with the stimulus interval (see <xref ref-type="fig" rid="fig2">Figure 2D</xref>). During reproduction, this neuron displayed downward ramping. However, here the change in firing rate correlated with the stimulus interval to be reproduced, such that for shorter intervals the firing rate decreased faster than for longer intervals (see also <xref ref-type="fig" rid="fig2">Figure 2D</xref>). This effect was also observed in cells whose activity increased to a fixed level at the end of reproduction that was independent of the stimulus duration (<xref ref-type="fig" rid="fig2">Figure 2C and D</xref>). Such ramp-to-threshold cells peaked at a constant time from the end of the reproduction epoch, with higher slopes for shorter intervals, suggesting the prediction of time to an event (<xref ref-type="bibr" rid="bib30">Merchant and Georgopoulos, 2006</xref>; <xref ref-type="bibr" rid="bib35">Murakami et al., 2014</xref>). Yet other cells constantly increased firing rate (<xref ref-type="fig" rid="fig2">Figure 2B</xref>), similar to what we saw during measurement in the neuron in displayed in <xref ref-type="fig" rid="fig2">Figure 2A</xref>. We also found cells that responded at absolute times (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>) or relative to the reproduction interval, for example, at its begin or end (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4A</xref>).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Gerbil medial prefrontal cortex (mPFC) neuron responses during time reproduction.</title><p>(<bold>A</bold>) A cell that linearly increased its firing rate during measurement and ramped down to zero during reproduction. (<bold>B</bold>) A neuron that scaled its firing with the stimulus duration during reproduction and (<bold>C</bold>) a ramp-to-threshold cell. (<bold>A–C</bold>) Panels display spike raster plots sorted by stimulus duration (bottom) and corresponding spike density functions (SDF, top). Each column plots the data with different alignment, that is, measurement begin and end, reproduction begin and end. Color identifies stimulus duration as in <xref ref-type="fig" rid="fig1">Figure 1C</xref>. In the raster plots, black ticks are single spikes. For better visualization, we only plot half of the spikes (randomly chosen). Measurement or reproduction phases are delimited by underlayed color. The SDFs are colored in the respective task phase, outside they are displayed as thin gray lines. (<bold>D</bold>) Dependence of firing on stimulus duration in the example cells. Single markers show the average firing rate or change of firing rate at each stimulus duration. Open dots are used for data from measurement and filled squares for those from reproduction. Solid lines are linear fits. Pearson’s correlation coefficient and significance is given in the lower-right corner. Above each panel, cell and task phase is indicated. The averages of firing rate and its change were calculated from the last half of the SDFs in the corresponding task phase.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71612-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Electrophysiological recordings in gerbil medial prefrontal cortex (mPFC) – histology and spike sorting.</title><p>(<bold>A</bold>) Representative coronal sections of the brains of all three gerbils. Tetrode tracks are visible in right cingulate cortex. In addition, stains from DiI coating of the tetrodes are visible in (<bold>A<sub>1</sub>, A<sub>2</sub></bold>), and a big postmortem electrolytic lesion in (<bold>A<sub>3</sub></bold>). Background staining was done with DAPI and Neurotracer (<bold>A<sub>1</sub></bold>, <bold>A<sub>2</sub></bold>) and Neutralred (<bold>A<sub>3</sub></bold>). A section from a gerbil brain atlas is overlaid in (<bold>A<sub>1</sub></bold>) (<xref ref-type="bibr" rid="bib41">Radtke-Schuller et al., 2016</xref>). M1, M2, primary and secondary motor cortex; CG1, cingulate cortex, area 1; PrL, prelimbic cortex; IL, infralimbic cortex; fmi, forceps minor of corpus callosum; CPu, caudate putamen. (<bold>B</bold>) Spike clusters in feature space of signals recorded at one tetrode; data from three different example sessions. (<bold>B<sub>1</sub></bold>) Cell from <xref ref-type="fig" rid="fig2">Figure 2A</xref> in the main text. (<bold>B<sub>2</sub></bold>) cell from <xref ref-type="fig" rid="fig2">Figure 2B</xref> in the main text. (<bold>B<sub>3</sub></bold>) cell from <xref ref-type="fig" rid="fig2">Figure 2C</xref> (orange) in the main text and <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3A</xref> (green). Peak signals are shown for two different channels of one tetrode as an example projection. Other spikes and voltage deflections are displayed as gray dots. <italic>Insets:</italic> average waveforms (1 ms length) corresponding to the colored clusters. (<bold>C</bold>) Three different projections of the feature space from the tetrode recoding in (<bold>B<sub>1</sub></bold>). All eight spike clusters that could be separated are marked (color coded). Other spikes and voltage deflections are again displayed as gray dots. The table lists quality measures for each cluster. Clusters 6–8 had too large amplitude cutoff and were excluded from further analysis. (<bold>D</bold>) Distributions of isolation distance and signal-to-noise ratio (SNR) for the clusters of all 1766 cells (i.e., excluding clusters/cells of insufficient quality). Both values were weakly correlated with the average firing rate (bottom panels). Isolation distance was calculated as described in <xref ref-type="bibr" rid="bib45">Schmitzer-Torbert et al., 2005</xref> for clusters of the peak amplitude (<bold>C</bold>). SNR was calculated as the ratio of the peak of the average spike waveform to the standard deviation of the background noise, that is, spikes that do not belong to a separated cluster. This was done for every channel individually and then averaged for all channels of a tetrode. Interspike interval (ISI) violations and amplitude cutoff were calculated as described in the Materials and methods section.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71612-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Ramping neurons.</title><p>(<bold>A–C</bold>) Example cells from <xref ref-type="fig" rid="fig2">Figure 2</xref> in the main text. (<bold>D</bold>) Another cell that linearly increased its firing rate during measurement and ramped down to zero during reproduction. (<bold>E</bold>) A neuron that responded constantly but somewhat modulated by stimulus duration during measurement and ramps to threshold during reproduction. (<bold>F</bold>) Another ramp-to-threshold cell. (<bold>A–F</bold>) Panels display spike rasters sorted by stimulus duration (bottom) and corresponding spike density functions (SDF, top). Each column plots the data with different alignment, measurement begin and end, reproduction begin and end. Color identifies stimulus duration (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). In the raster plots, black ticks are single spikes. For better visualization, we only plot half of the spikes (randomly chosen). Measurement or reproduction phases are delimited by underlayed color. The SDFs are colored in the respective task phase, outside they are displayed as thin gray lines. Markers in second and third panels show percent explained variance for each principal component (see <xref ref-type="fig" rid="fig5">Figure 5</xref>). Black dots – which may be connected by a line – illustrate the cell type according to categorization (see <xref ref-type="fig" rid="fig6">Figure 6</xref>). Bottom panels compare SDF (color coded) to average (virtual) running speed (gray) for each stimulus duration. Bottom-right panels plot the tuning curves for virtual speed (speed response function). Modulation index and significance is given in the lower-right corner.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71612-fig2-figsupp2-v2.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 3.</label><caption><title>Phasically timing neurons.</title><p>(<bold>A–H</bold>) Examples of neurons that showed phasic responses at specific time points or for a certain duration in the reproduction phase. Note that the cell in (<bold>E</bold>) signals absolute time as it starts firing at 4 s – and proceeds until shortly before the end of the reproduced interval. (<bold>C–H</bold>) Neurons with pronounced modulation by (virtual) running speed. Plots are organized as in <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71612-fig2-figsupp3-v2.tif"/></fig><fig id="fig2s4" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 4.</label><caption><title>Other example neurons.</title><p>(<bold>A</bold>) A neuron that during reproduction appeared very similar to the cell in <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3F</xref>, but in fact does not signal absolute but relative time as it starts firing later for longer stimuli. (<bold>B–D</bold>) Cells that during reproduction responded with brief (<bold>D</bold>) or extended drops of activity (<bold>B, C</bold>). The amount of activity reduction may (<bold>B</bold>) or may not (<bold>C</bold>) have scaled with the stimulus duration. All plots are organized as in <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71612-fig2-figsupp4-v2.tif"/></fig><fig id="fig2s5" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 5.</label><caption><title>Influence of speed on single neuron responses.</title><p>Distributions of modulation indices derived from the speed response functions of each neuron for virtual speed (<bold>A</bold>) and running speed on the treadmill (<bold>B</bold>). Neurons with significant speed tuning are delimited by the orange outline (i.e., with variance of their speed response function larger than that of the speed response function for shuffled spike times; significance assessed by Levene’s test <italic>p</italic>&lt;0.05). Black outline gives histogram for cells with ramp-like responses only (cells explained by PC 1 and those explained by PC 1 + stimulus PC 1, see categorization analysis below and <xref ref-type="fig" rid="fig6">Figure 6</xref>). Pie plots show significant (orange) and nonsignificant (blue) fractions. Raised wedges mark ramping neurons. (<bold>C</bold>) Modulation indices for virtual speed vs. running speed for each neuron (blue dots). Ramping neurons are marked with black dots.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71612-fig2-figsupp5-v2.tif"/></fig></fig-group><p>Between measurement and reproduction, the neurons adapted their response patterns. We did not find a single cell that responded in the very same way in both task phases and essentially repeated its activity pattern from the measurement phase during reproduction – an observation that will be analyzed systematically below.</p><p>Since reproduction involved walking in our behavioral task, we looked at dependencies between firing rate and running speed. In most example neurons, running speed influences were weak. Although speed response functions may have been significant (from shuffled controls, see Materials and methods), modulation of the speed response function was low (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>-<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>). Still, some neurons displayed an obvious speed modulation. For instance, the shape of the spike density functions (SDFs) of the neurons in <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3G and H</xref> was rising and decreasing over the reproduction phase, and this pattern corresponded well to changes of the running speed. These neurons had a monotonously rising speed response function. Yet other neurons had large speed modulation indices, but the overlap between their SDFs and the running speed pattern was small (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3C–F</xref>). Velocity changes over a trial certainly contributed to the response of such neurons but could not fully explain their firing. To assess speed modulation more systematically, we calculated modulation indices of all neurons for virtual speed and for running speed on the treadmill. These modulation indices were widely distributed and often larger for running speed on the treadmill than for virtual speed. Although also weak speed modulation could be significant, it was significant in only 22% of the neurons for virtual speed and in 27% for the running speed (<xref ref-type="fig" rid="fig2s5">Figure 2—figure supplement 5</xref>).</p><p>We note that running speed as well as other unobserved behavioral factors may contribute to firing in some neurons and hence may explain differences in firing patterns between task phases. However, since we were interested in the collective action of the neuronal population, we did not investigate this further and also decided against excluding such neurons from the subsequent analyses.</p></sec><sec id="s2-3"><title>Single-cell picture holds for the whole population</title><p>The different response patterns for single neurons were also obvious when visualizing the whole population. Some neurons ramped up at the end of measurement, others were active at the beginning and then decreased activity (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). During reproduction, a similar but more pronounced pattern emerged with up/down ramping and phasically active neurons (<xref ref-type="fig" rid="fig3">Figure 3B</xref>).</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Single neuron and population dynamics in measurement and reproduction.</title><p>(<bold>A</bold>) Normalized (z-scored) spike density functions (SDFs) of all 1766 medial prefrontal cortex (mPFC) neurons for each stimulus interval during the measurement phase sorted by their timing within the intervals. <italic>Small panel:</italic> matrix of pairwise Pearson correlations between all neurons. Diagonal entries not plotted. (<bold>B</bold>) Same as (<bold>A</bold>) but for the reproduction phase. (<bold>C</bold>) Same as (<bold>B</bold>) but with neurons sorted as in (<bold>A</bold>). (<bold>D</bold>) Population vector correlations in corresponding time bins of measurement and reproduction. (<bold>E</bold>) Pearson correlations between measurement and reproduction for single neurons. (<bold>F</bold>) Pairwise correlations of the whole population for different stimuli in measurement (<bold>F<sub>1</sub></bold>) and reproduction (<bold>F<sub>2</sub></bold>). Diagonal entries not plotted. (<bold>G</bold>) Distributions of average Pearson correlations of single-cell activity for different stimuli in measurement (<bold>G<sub>1</sub></bold>) and reproduction (<bold>G<sub>2</sub></bold>). Histograms in (<bold>D, E</bold>, <bold>G</bold>) are displayed in gray with significant values (<italic>p</italic>&lt;0.05) delimited by an orange outline. Pie plots show significant (orange) and nonsignificant (blue) percentages.</p><p><supplementary-material id="fig3sdata1"><label>Figure 3—source data 1.</label><caption><title>Spike density function (SDF) source data for <xref ref-type="fig" rid="fig3">Figure 3A and B</xref> and all upcoming analyses and figures based on SDFs.</title><p>The zip also includes Python source code to load the hdf5 data.</p></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-71612-fig3-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71612-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Stability of neuronal responses.</title><p>(<bold>A</bold>) Normalized (z-scored) spike density functions (SDFs) of all neurons for each stimulus interval during (<bold>A<sub>1</sub></bold>) measurement and (<bold>A<sub>2</sub></bold>) reproduction sorted by their timing within the intervals for odd trials; same sorting in (<bold>A<sub>1</sub></bold>) and (<bold>A<sub>2</sub></bold>). The left side displays data for odd trials only; the right panel for even trials. <italic>Small panels:</italic> matrices of pairwise Pearson correlations between all neurons. Diagonal entries not plotted. (<bold>B</bold>) Sorting indices assigned to the neurons if sorting would be based only on activity during odd or even trials. The closer a dot appears at the bisecting line, the better sorting corresponds between odd and even trials. During reproduction, activity corresponds well, arguing for stable responses throughout a recording session. During measurement activity is less similar. This has to be attributed to less pronounced and noisier responses in this task phase and not unstable recordings since measurement and reproduction are interleaved throughout the session. (<bold>C</bold>) Correlations between odd and even trials give a similar picture. Histograms plot Pearson’s correlation coefficients during (<bold>C<sub>1</sub></bold>) measurement and (<bold>C<sub>2</sub></bold>) reproduction of the population in each time bin (left) and for single neurons (right). Histograms are displayed in gray with significant values delimited by an orange outline (<italic>p</italic>&lt;0.05). Pie plots show significant (orange) and nonsignificant (blue) percentages.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71612-fig3-figsupp1-v2.tif"/></fig></fig-group><p>Striking, however, were the activity differences between measurement and reproduction, indicating a state change in the population between both task phases. When individual cells were sorted in the same order for both measurement and reproduction, no global pattern was visible (<xref ref-type="fig" rid="fig3">Figure 3B and C</xref>). Also, correlating population vectors in corresponding time bins for measurement and reproduction yielded only low values (<xref ref-type="fig" rid="fig3">Figure 3D</xref>). For single cells, however, the correlation between task phases was larger and significant in about 20% of the cells (<xref ref-type="fig" rid="fig3">Figure 3E</xref>). Note that this does not indicate a precise correspondence between the activity profiles for measurement and reproduction but rather that a neuron was active in both phases. See, for example, the neuron in <xref ref-type="fig" rid="fig2">Figure 2A</xref>, which shows a negative correlation between task phases.</p><p>Neural activity was similar for different stimulus durations during reproduction. On the one hand, population activity correlated for different stimuli (<xref ref-type="fig" rid="fig3">Figure 3F<sub>2</sub></xref>); on the other hand, single-neuron activity correlated across different stimuli in about 20% of the neurons (<xref ref-type="fig" rid="fig3">Figure 3G<sub>2</sub></xref>). During measurement, correlations across stimuli were absent (<xref ref-type="fig" rid="fig3">Figure 3F<sub>1</sub> and G<sub>1</sub></xref>).</p><p>The above picture remained, when we split activity into odd and even trials. Activity was largely similar arguing for stable neural activity throughout a session. However, during measurement, data was more noisy in agreement with the weak correlations we observed in this task phase (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>).</p></sec><sec id="s2-4"><title>Scaling of neuronal activity with duration</title><p>The activity of the prefrontal neurons we recorded appeared to scale with stimulus duration (<xref ref-type="fig" rid="fig3">Figure 3A and B</xref>), which was reminiscent of findings in interval timing studies for striatum (<xref ref-type="bibr" rid="bib29">Mello et al., 2015</xref>) and prefrontal cortex (<xref ref-type="bibr" rid="bib59">Xu et al., 2014</xref>; <xref ref-type="bibr" rid="bib58">Wang et al., 2018</xref>).</p><p>To examine stimulus-related scaling in our data set, we followed the approach of <xref ref-type="bibr" rid="bib29">Mello et al., 2015</xref>. We first calculated for each cell the center of mass (COM) of the SDF at every stimulus duration. The COMs were, in particular during reproduction, widely distributed and tiled the time intervals. For comparison, we simulated SDFs with no temporal modulation (‘noise’). The corresponding COMs clustered around the center of the intervals and significantly differed from those for the recorded SDFs (<italic>p</italic>&lt;0.001 in all cases, Kolmogorov–Smirnov test; <xref ref-type="fig" rid="fig4">Figure 4A</xref>). Interestingly, during reproduction, for neurons with a COM at the begin or end of an interval, activity correlated more strongly across different stimuli (<xref ref-type="fig" rid="fig4">Figure 4B</xref>, <xref ref-type="fig" rid="fig3">Figure 3G<sub>2</sub></xref>). This indicates that, in particular for neurons with increased firing at the border of the interval, activity depended on the temporal stimulus.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Temporal scaling.</title><p>(<bold>A</bold>) Distributions of center of mass for all 1766 medial prefrontal cortex (mPFC) neurons (colored histograms). Gray histograms give distributions of center of mass for noise spike density functions (SDFs). Arrowheads mark the middle of the stimulus interval and of the average reproduced interval, respectively. (<bold>B</bold>) During reproduction, the average Pearson correlations of single-cell activity for different stimuli (<xref ref-type="fig" rid="fig3">Figure 3F</xref>) were larger for neurons with center of mass at the begin or end of an interval. Dots give single-cell data, solid lines are moving averages. Arrowheads in the lower panel mark the middle of the average reproduced interval. (<bold>C</bold>) Center of mass of each cell for 5.25 s against 3 s (red) and 7.5 s (green) during reproduction. Colored dashed lines mark the predicted ratio; gray dashed line corresponds to no change. (<bold>D</bold>) Distributions of scaling indices for all cells, that is, center of mass of the SDF at every stimulus divided by the center of mass for 5.25 s. Solid vertical line marks 1. Dashed lines mark the medians and arrow heads the ratio between 5.25 s and the respective other stimulus duration. Gray histograms give distributions of center of mass for shuffled control SDFs. (<bold>E</bold>) Bootstrapped distributions of p-values for Kolmogorov–Smirnov tests between scaling indices for recorded and shuffled SDFs. Solid vertical line marks 5%. Logarithmic <italic>x</italic>-axis.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71612-fig4-v2.tif"/></fig><p>As a second step, we calculated scaling indices by dividing every cell’s COMs by the corresponding COM at the 5.25 s stimulus, that is, the mean of the stimulus distribution. These scaling indices theoretically range between 3.0/5.25 ≈ 0.57 and 7.5/5.25 ≈ 1.43. Indeed, scaling indices were close to the theoretical values during both measurement and reproduction (<xref ref-type="fig" rid="fig4">Figure 4C and D</xref>). During reproduction, scaling indices were even larger or smaller than the prediction in a manner consistent with the regression effect, that is, smaller durations had larger scaling factors and vice versa.</p><p>Finally, we obtained scaling indices after shuffling cell identities across stimuli to test whether the scaling indices from the recorded data were in fact the result of a meaningful modulation. Only for the reproduction phase the indices from shuffling were more widely distributed than the data; for the measurement phase, a difference was not clearly visible (<xref ref-type="fig" rid="fig4">Figure 4D</xref>). Statistical testing, however, identified significant effects in both phases (<inline-formula><mml:math id="inf1"><mml:mrow><mml:mi>p</mml:mi><mml:mo>§lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> in all cases, Kolmogorov–Smirnov test). This statistical result was likely due to the large number of samples contained in the data set. Therefore, we performed bootstrapped Kolmogorov–Smirnov tests on 10% of the data over 10,000 runs. The p-values obtained lay below 0.05 for almost all cases during reproduction. During measurement, only about 30% of the bootstrapped Kolmogorov–Smirnov tests were significant (<xref ref-type="fig" rid="fig4">Figure 4E</xref>).</p><p>Taken together, this indicates activity-dependent temporal scaling of prefrontal single-cell responses in the reproduction phase alluding to a potential role in time encoding and the regression effect. Scaling during measurement was not different from what would be expected of neural activity that unfolds over time. Note that the results are in line with the non-/significant correlations of activity across stimuli for measurement and reproduction, respectively (<xref ref-type="fig" rid="fig3">Figure 3F and G</xref>).</p></sec><sec id="s2-5"><title>Collective population activity in the different task phases</title><p>The activity differences between measurement and reproduction revealed above argue against an underlying mechanism just at the single-cell level. Therefore, we examined the collective properties of the prefrontal neurons by decomposing population activity into its principal components (PCs). We used demixed principal component analysis (PCA), a form of PCA that allowed us to separate time course-related contributions to neural activity from contributions that depended on stimulus duration (<xref ref-type="bibr" rid="bib24">Kobak et al., 2016</xref>).</p><p>Interestingly, the PCs for measurement and reproduction shared common features (<xref ref-type="fig" rid="fig5">Figure 5A and B</xref>). The time course-related PCs were ramp-like (PC 1) or had a comparable non-monotonous shape (PC 2 and 3). The strongest stimulus-dependent PC was constant over time and had amplitudes that were ordered by stimulus (see bottom-right panels in <xref ref-type="fig" rid="fig5">Figure 5A and B</xref>). Moreover, the contribution of the PCs to the single-cell responses (PCA scores) correlated for PC 1 and stimulus PC 1, indicating a link between ramp-like and stimulus-dependent activity in both measurement and reproduction (<xref ref-type="fig" rid="fig5">Figure 5C</xref>, see also <xref ref-type="fig" rid="fig5s4">Figure 5—figure supplement 4</xref>). Nevertheless, differences between measurement and reproduction were also obvious in the collective activity. In the measurement phase, PCs 2 and 3 in general contributed very little to explaining population activity; instead, PCs were most strongly driven by stimulus duration (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). During reproduction but not during measurement, stimulus PC 1 also correlated with PCs 2 and 3, arguing for a richer representation of the to-be-reproduced compared to the to-be-measured time interval.</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Decomposition of population activity.</title><p>Demixed principal component analysis (PCA) yields separate principal components (PCs) for the time course during a trial (PCs 1–3) and for each stimulus duration (stimulus PC 1). (<bold>A</bold>) PCs for measurement and (<bold>B</bold>) for reproduction. The small panels display individual PCs at each stimulus interval scaled to the length of the interval. Note that PCs 1–3 for different stimuli lie on top of each other, demonstrating perfect demixing. Stimuli are colored as in previous figures. Circles and crosses mark interval start and end. Open symbols are used for measurement and filled for reproduction. The PCs were calculated for the whole data set and gray-shaded areas delimit the standard deviation of results from bootstrapping with 10% of the cells. Bottom-right panels in (<bold>A</bold>) and (<bold>B</bold>): correlation of stimulus PC 1 with the stimulus duration. Black solid line is a linear fit, and gray lines are fits for the bootstrap samples; dark gray significant, light gray nonsignificant cases. (<bold>C</bold>) Distributions of Pearson’s correlation coefficients between PCs 1–3 and stimulus PC 1 from bootstrap samples. Significant correlations are colored in brown (measurement) and blue (reproduction). Dotted (measurement) and solid (reproduction) black lines mark coefficients for the whole data set. (<bold>D</bold>, small panels) PCs for conventional PCA during measurement scaled to the length of the interval for each stimulus. Note that, in contrast to demixed PCA, conventional PCs contain both time course-related and stimulus information. (<bold>D</bold>, large panel) Time course of PC 1 for conventional PCA at each stimulus during measurement. The percentage of covered trajectory is given with respect to PC 1 for the 7.5 s stimulus. (<bold>E</bold>) Same as (<bold>D</bold>) for reproduction.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71612-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Explained variance of demixed principal component analysis (PCA).</title><p>Panels show explained variance for each principal component (bar graphs) and their cumulative explained variance (green line) of demixed PCA for measurement (<bold>A</bold>) and reproduction (<bold>B</bold>). Different panels correspond to all or individual animals. Numbers above bars give order with regard to component type, that is, time course-related (gray), stimulus duration (blue), or interaction between both (orange). Results are comparable for individual animals and when pooled across all animals. In measurement, the first time course-related and stimulus-dependent PCs are strongest. Reproduction is best explained by the first three time course-related PCs; only at fourth position stimulus components start contributing.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71612-fig5-figsupp1-v2.tif"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 2.</label><caption><title>Proper demixing of principal components (PCs) by demixed principal component analysis (PCA).</title><p>(<bold>A</bold>) Each panel shows correlations between all pairs of the first four demixed PCs for measurement. At top and to the left, the PCs are illustrated. Different stimuli are color coded as in other figures. Different panels give results for pooled data (all) and individual animals. (<bold>B</bold>) Same as (<bold>A</bold>) for reproduction. The correlations between different PCs are zero, indicating proper demixing.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71612-fig5-figsupp2-v2.tif"/></fig><fig id="fig5s3" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 3.</label><caption><title>Demixed principal component analysis (PCA) results are similar across animals.</title><p>(<bold>A</bold>) Individual panels show correlations between all pairs of demixed principal components (PCs) calculated for pooled data (all) and single animals for the measurement phase. At top and to the left, the PCs are illustrated. Stimuli are color coded. Different panels give time course-related PCs 1-3 and stimulus-related PC 1. (<bold>B</bold>) Same as (<bold>A</bold>) for reproduction. PCs are highly correlated across animals.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71612-fig5-figsupp3-v2.tif"/></fig><fig id="fig5s4" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 4.</label><caption><title>Distributions of and correlations between demixed principal component analysis (PCA) scores.</title><p>(<bold>A</bold>) The scatter plot shows the correlation between scores for time course-related principal component (PC) 1 and stimulus PC 1 in the measurement phase. Pearson’s <inline-formula><mml:math id="inf2"><mml:mi>r</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf3"><mml:mi>p</mml:mi></mml:math></inline-formula>-value are listed above the scatter plot. Both were calculated for all cells. Histograms give distributions for the PCs. Cells that can be explained by the two PCs are plotted in orange, all others in gray. Pie plot shows fractions of cells that can (orange) and cannot (blue) be explained by the PCs. (<bold>B</bold>) Same as (<bold>A</bold>) for reproduction and for time course-related PCs 1-3 and stimulus PC 1. (<bold>C</bold>) Categorization procedure at the example of the measurement data in (<bold>A</bold>). Categories were determined only for cells that could be sufficiently explained by the PCs. Cells were counted as explained by a PC if the ratio of scores (in absolute values) to the other category was below tan(67.5°). For the measurement phase, this results in three different categories: PC 1 only, stimulus PC 1 only, or PC 1 and stimulus PC 1 delineated by the three types of wedges in the plot.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71612-fig5-figsupp4-v2.tif"/></fig><fig id="fig5s5" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 5.</label><caption><title>Decomposition with conventional principal component (PC) analysis.</title><p>First four PCs for (<bold>A</bold>) measurement and (<bold>B</bold>) reproduction. Stimuli are colored as in other figures. Circles and crosses mark interval start and end. Open symbols are used for measurement and filled for reproduction. Bottom-right panels: explained variance for each PC (bar graphs) and their cumulative explained variance (green line).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71612-fig5-figsupp5-v2.tif"/></fig><fig id="fig5s6" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 6.</label><caption><title>Collective activity adds to principal components (PCs).</title><p>We drew 1000 random tensor maximum entropy surrogate samples (<xref ref-type="bibr" rid="bib8">Elsayed and Cunningham, 2017a</xref>) for measurement (upper panels) and reproduction (lower panels) and determined the explained variance of time course-related components PCs 1–3 and stimulus PC 1 (gray histograms). Orange vertical lines mark values for the real data. During measurement, PC 1 for the data was larger than expected. Similarly, PC 3 was larger than expected during reproduction. Stimulus PC 1 was larger than expected for reproduction.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71612-fig5-figsupp6-v2.tif"/></fig></fig-group><p>Recent work has shown that collective neural activity evolves along very similar trajectories when estimating different time intervals, but which final state is reached depends on the duration of the interval. In contrast, when a time interval is reproduced, trajectories of similar length are found for different stimuli but the speed of progression decreases with duration (<xref ref-type="bibr" rid="bib15">Gouvêa et al., 2015</xref>; <xref ref-type="bibr" rid="bib58">Wang et al., 2018</xref>; <xref ref-type="bibr" rid="bib42">Remington et al., 2018</xref>; <xref ref-type="bibr" rid="bib50">Sohn et al., 2019</xref>). Since we separated time course-related from stimulus information through the demixed PCA, we could not see such stimulus-dependent effects directly. We therefore also applied conventional PCA to our data. The strongest PCs from conventional PCA were similar in shape to those from demixed PCA but were – as expected – influenced by the stimulus (<xref ref-type="fig" rid="fig5">Figure 5D and E</xref>, <xref ref-type="fig" rid="fig5s5">Figure 5—figure supplement 5</xref>). Indeed, in the measurement phase, neural activity developed at similar speed along trajectories with a length that depended on stimulus duration. During reproduction, trajectories had similar length. However, activity along those trajectories accelerated over an interval resulting at higher average speed for stimuli of shorter duration. Note that this effect corresponds to the temporal scaling described in the previous section.</p><p>It is possible that the population responses during measurement and reproduction are not actually collective phenomena but simply the result of pooling single neurons. To test this, we compared population activity to surrogate data that preserve stimulus tuning of single neurons, correlations of single-cell firing rates across time, and pairwise correlations between neurons (<xref ref-type="bibr" rid="bib8">Elsayed and Cunningham, 2017a</xref>). During measurement, PC 1 of the original data was larger than expected, suggesting that collective activity added to representing ongoing time; similarly, PC 3 was larger than expected during reproduction (<xref ref-type="fig" rid="fig5s6">Figure 5—figure supplement 6</xref>). Stimulus PC 1 was stronger than expected in reproduction, indicating that here the population as a whole contributed to the representation of the stimulus interval.</p></sec><sec id="s2-6"><title>Heterogeneous prefrontal activity can be categorized into a few response types</title><p>To extract response types from a set of neurons, usually, specific tests must be designed, which are based on predefined knowledge of the responses of interest. To circumvent such rigid preselection, we used the demixed PCA results for categorizing neurons into different response types.</p><p>Single-cell activity patterns can be decomposed into linear mixtures of different PCs. We focused on the contributions of the strongest PCs, which were time course-related PC 1 and stimulus PC 1 during measurement and PCs 1–3 and stimulus PC 1 during reproduction (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). As we already mentioned above, the PCA scores for single-cell responses were correlated for these PCs (<xref ref-type="fig" rid="fig5">Figure 5C</xref>), pointing to a potential utility for capturing single-cell responses. For instance, mixing the ramp-like PC 1 and stimulus PC 1 with its constant responses ordered by stimulus, one can describe the activity during the measurement phase of cells like in <xref ref-type="fig" rid="fig2">Figure 2A</xref>. Similarly, mixtures of the different time-modulated profiles from PCs 1–3 and stimulus PC 1 can capture various response patterns during reproduction (<xref ref-type="fig" rid="fig6">Figure 6A</xref>).</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Single-cell activity and their contribution to the population response change from measurement to reproduction.</title><p>(<bold>A</bold>) Reconstructions (thin lines) of the firing patterns (spike density functions [SDFs], thick faint lines) of the example neurons from <xref ref-type="fig" rid="fig2">Figure 2</xref> (identified by bold letters; note that here SDFs were not smoothed). Markers show percent explained variance for each principal component (PC) and illustrate the response type according to the categorization (see <bold>D</bold>). For instance, the neuron in the first row is reconstructed by the linear combination of PC 1 and stimulus PC 1 during measurement and with (negative) PC 1 during reproduction. (<bold>B</bold>) Distributions of variance of single-cell responses explained by PCs during measurement. Variance explained by PC 1 is displayed in blue and by stimulus PC 1 in red. The remainder (i.e., variance unexplained) is displayed as gray open bars. Each panel displays distributions for cells belonging to one of the four possible response categories visualized by the markers above the panel. (<bold>C</bold>) Same as (<bold>B</bold>) for the reproduction phase. Here the coloring is PCs 1–3, blue, orange, green; stimulus PC 1, red. Distributions are displayed for the four categories with the most cells. (<bold>D</bold>) Transition between response categories from measurement to reproduction (Sankey diagram). At the margins the numbers of cells are given with activity patterns that can be reconstructed by PCs. For measurement (left), PC 1 and stimulus PC 1 were considered and for reproduction (right) PCs 1–3 and stimulus PC 1. Dark dots indicate the contribution of a PC to a response category. Percentages are only given for categories that contain significant numbers of cells compared to shuffled data. The signs &lt; and &gt; indicate if the number is smaller or larger than for shuffled data. Zero percentages mean less than 1%. Bold letters correspond to the examples from (<bold>A</bold>).Bar graphs at the top show percentages and cell numbers with contributions of each PC. Pie chart at bottom shows percentages of cells active during the task phases determined from the reconstructions.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71612-fig6-v2.tif"/></fig><p>Combinations of PC 1 and stimulus PC 1 yield three possible response categories in the measurement phase: activity explained by (1) PC 1 only, (2) stimulus PC 1 only, or (3) both PCs. For each neuron, a category was selected based on the angle between its PC 1 and stimulus PC 1 scores (<xref ref-type="fig" rid="fig5s4">Figure 5—figure supplement 4C</xref>). We only included cells with large demixed PCA scores (explained variance) in this analysis (see also <xref ref-type="fig" rid="fig5s4">Figure 5—figure supplement 4</xref>). Cells with small scores were categorized as ‘unrelated activity,’ giving a fourth response category. Likewise, 15 different categories were defined for the reproduction phase from combinations of PCs 1–3 and stimulus PC 1 plus a 16th category for ‘unrelated activity’.</p><p>Categorization provided meaningful representations of single-cell responses as reflected in the variance explained by the contributing PCs (<xref ref-type="fig" rid="fig6">Figure 6B and C</xref>). For instance, large parts of variance were explained by PC 1 for neurons in the category ‘PC 1 only’ during measurement; contributions from stimulus PC 1 were marginal. In the stimulus PC 1-only category, the situation was reversed, and for the mixed PC 1 and stimulus PC 1 category contributions by both PCs matched (<xref ref-type="fig" rid="fig6">Figure 6B</xref>). However, only less than 50% of variance could be explained by the two PCs in the measurement phase. The PCs used for reconstructing during the reproduction phase better captured the activity; leaving less variance unexplained (<xref ref-type="fig" rid="fig6">Figure 6C</xref>). In particular, for the PC 1-only category often cell activity could be explained to more than 50% by PC 1.</p><p>Cells that could be described by PC 1 had a ramp-like response profile. During measurement, about a quarter of the cells showed such ramping activity. These cells included ramping to stimulus duration-dependent levels like the neuron in <xref ref-type="fig" rid="fig2">Figure 2A</xref> and ramping that did not depend on stimulus. The other cells represented the stimulus duration in a different way or showed activity unrelated to the task during measurement (67%; <xref ref-type="fig" rid="fig6">Figure 6D</xref>).</p><p>During reproduction, about 10% of the neurons showed ramping activity (PC 1 only), for example, ramp-to-threshold cells where the rate of ramping decreased with stimulus duration (examples in <xref ref-type="fig" rid="fig2">Figure 2B and C</xref>, <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2B and C</xref>). Another ∼10% of neurons were explained by mixing PCs 1 and 2, and 6% by a mixture of PCs 1–3. Only 1% was explained by ramps that encoded stimulus (i.e., PC 1 and stimulus PC 1). However, counting all combinations of stimulus PC 1 with PCs 1–3 showed that about 5% of the neurons combined ramps with stimulus duration-dependent firing. In total, 35% of the cells contained a ramping component. These cells overlapped largely with those whose activity was significantly correlated across stimuli (not shown, <xref ref-type="fig" rid="fig3">Figure 3G<sub>2</sub></xref>). In <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>-<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>, further examples for the different categories can be found.</p><p>We also determined if the ramp-like responses (cells explained by PC 1 and those explained by PC 1 + stimulus PC 1) could be driven by running speed rather than time reproduction. Half of the ramping neurons were significantly modulated by virtual speed and 60% by running speed. Nevertheless, speed modulation indices were in general low for those ramping cells (<xref ref-type="fig" rid="fig2s5">Figure 2—figure supplement 5</xref>).</p><p>The categorization analysis strengthened the picture of changing response patterns between measurement and reproduction we have already noted above in several places. Cells switched response types between task phases but with no specific pattern as becomes obvious from the flow diagram in <xref ref-type="fig" rid="fig6">Figure 6D</xref>. Separating cells with small scores from those with large ones, we could estimate the number of cells active during the task phases. About 17% of the cells fired action potentials in both phases, 16% were only active during measurement and 23% only during reproduction; 44% of the cells did not contribute substantially in either phase (pie chart in <xref ref-type="fig" rid="fig6">Figure 6D</xref>).</p></sec><sec id="s2-7"><title>Time encoding is governed by different response types</title><p>To understand how mPFC may encode time in our task, we read out ongoing time from the responses of all neurons using a simple linear regression decoder (see Materials and methods). During the reproduction phase, time readouts were accurate in the first seconds; however, by the end of the phase, a regression effect was visible with over- and underestimation at short and long stimuli, respectively (<xref ref-type="fig" rid="fig7">Figure 7A</xref>). This was due to neurons with large PCA scores, as we obtained a similar result when decoding only from such neurons (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>). In contrast, time readouts using neurons with small PCA scores were very imprecise. Here, decoded time was almost constant throughout the reproduction phase, such that real time was overestimated initially and underestimated at the end of reproduction. A similar picture emerged when we read out time from shuffled data and was even more pronounced for pure noise (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>).</p><fig-group><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Decoding elapsed time from prefrontal population activity.</title><p>(<bold>A</bold>) Elapsed time (average ± standard deviation from bootstrapping) decoded from the responses of all neurons recorded during the reproduction phase. As before, color identifies stimulus duration. Crosses mark final values. A strong regression effect is visible. (<bold>B</bold>) Time decoding with neurons that ramp to stimulus-dependent levels but with the same slope and (<bold>C</bold>) with ramp-to-threshold cells. Left panels illustrate the theoretical prediction for decoded time and example neuronal activity above. Middle panels plot decoding results using only neurons from the respective response category. Right panels give results for decoding using the corresponding components from demixed principal component analysis (PCA). As displayed in the top panels, these components are principal component (PC) 1 and stimulus PC 1 in (<bold>B</bold>); and PC 1 only in (<bold>C</bold>). (<bold>D</bold>) Median slopes of the linear regression between the final values of real and predicted time for decoding from data in (<bold>A</bold>–<bold>C</bold>) and for a mixture of 80% slope-changing and 20% linear increasing cells, which aligns well with decoding from all data (<bold>A</bold>); regarding mixtures see also (<bold>F</bold>). Error bars delimit interquartile ranges (from bootstrapping). (<bold>E</bold>) Mixtures of linear increasing activity and slope changes explain behavioral regression effects. Theoretical predictions for mixing both responses in single neurons (left) or as two different response types across a population (right). For the second case, a neuron with noisy linear increasing activity is displayed as an example. (<bold>F</bold>) Decoding results for a mixed population of 40% slope-changing and 60% linear increasing cells. The cells were sampled at these fractions in each bootstrapping run from the response categories we identified in our recorded data. The upper-right panel shows the regression slope (<bold>D</bold>) for different fractions of slope-changing cells. The orange marker corresponds to the example in the left panel. The lower-right panel displays the PCA scores of the cells from the linear increasing (red; PC 1 + stimulus PC 1) and slope-changing categories (blue; PC 1 only). The size of the marker illustrates the decoder weight <inline-formula><mml:math id="inf4"><mml:mi>β</mml:mi></mml:math></inline-formula> for that cell. See also <xref ref-type="fig" rid="fig5s4">Figure 5—figure supplement 4C</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71612-fig7-v2.tif"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 1.</label><caption><title>Decoding elapsed time from data, shuffled data, and noise.</title><p>Decoding results from the whole population, cells with sufficiently large dPCA scores, cells with small dPCA scores (‘unrelated activity’), shuffled data and noise during the reproduction phase. Each panel displays decoded time vs. the real time for each stimulus (color coded); average ± standard deviation (from bootstrapping). Crosses mark final values. Number of neurons is given in the lower-right corner. Rightmost panels display slopes and indifference points of linear regression between final values of real and predicted time for the five data sets. At the indifference point, real and decoded final time match. We calculated it from the slope and intercept of the regression line as <inline-formula><mml:math id="inf5"><mml:mfrac><mml:mtext>intercept</mml:mtext><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mtext>slope</mml:mtext></mml:mrow></mml:mfrac></mml:math></inline-formula>. The indifference point estimates the amount of general over-/underestimation. With a regression effect, the indifference point should be at the center of the stimulus distribution (5.25 s), which we only obtain when decoding from all data or the cells with large principal component analysis (PCA) scores.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71612-fig7-figsupp1-v2.tif"/></fig><fig id="fig7s2" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 2.</label><caption><title>Decoding time from phasically active neurons.</title><p>Decoding results for three different theoretical response types with phasic activation. The uppermost panel in each column shows example neuronal activity and the panel below gives the prediction for decoded time. Different stimulus intervals are color coded. Crosses mark final values. Relative timing neurons peak at the center of an interval. Absolute timing neurons peak at a specific time point. In addition, stimulus interval may be coded in the response amplitude (absolute timing + amplitude change). Although only one example is displayed, for both types of absolute timing neurons the population comprises cells peaking at different time points such that the whole interval is tiled. Relative timing neurons can only encode a single time point, whereas absolute timing neurons allow for precise time encoding.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71612-fig7-figsupp2-v2.tif"/></fig><fig id="fig7s3" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 3.</label><caption><title>Decoding time during measurement.</title><p>Results are displayed for all data (left), cells in the principal component (PC) 1 + stimulus PC 1 category, and cells in the PC 1-only category. For all data, decoding is imprecise with initial overestimation and underestimation at the end of the interval. For PC 1 + stimulus PC 1 cells as well as cells in the PC 1-only category, decoded time starts out more precisely but ends up at a general underestimation for the first response type. However, a regression effect with an overestimation for small stimuli is visible in the second case.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71612-fig7-figsupp3-v2.tif"/></fig></fig-group><p>The regression effect we observed when decoding from all neurons was stronger than in the behavior. The slope of the linear regression between the final values of real and predicted time was close to zero <xref ref-type="fig" rid="fig7">Figure 7D</xref>, values from behavior were between 1 and 0.5 (see <xref ref-type="fig" rid="fig1">Figure 1E</xref>). This discrepancy probably comes from the fact that the neuronal population includes not only neurons encoding the regression effect. We therefore wondered what response types could mediate the regression effect and simulated a few stereotypical cases. Decoding time from neurons that ramp with same slope to stimulus duration-dependent levels (linear increasing neurons) shows precise time representation but no regression effect (<xref ref-type="fig" rid="fig7">Figure 7B</xref>). Whereas ramp-to-threshold cells that change slope but reach same activity levels by the end of an interval can only encode the mean of the stimulus distribution and result in maximal regression (<xref ref-type="fig" rid="fig7">Figure 7C</xref>).</p><p>Decoding time from the response categories (<xref ref-type="fig" rid="fig6">Figure 6</xref>) corresponding to the theoretical cases led to similar results. For the response type combining time-dependent PC 1 with stimulus PC 1, time reproduction displayed only a weak regression effect (<xref ref-type="fig" rid="fig7">Figure 7B</xref>) and ramp-to-threshold responses (PC 1 only) displayed very strong regression (<xref ref-type="fig" rid="fig7">Figure 7C</xref>); see also <xref ref-type="fig" rid="fig7">Figure 7D</xref>. Decoding time directly from the demixed PCs gave similar results (<xref ref-type="fig" rid="fig7">Figure 7C and D</xref>).</p><p>Regression effects in our behavioral data lay between the extremes yielded by the two response categories (<xref ref-type="fig" rid="fig1">Figure 1E</xref>). This discrepancy made us think about another solution to the question of how regression effects may arise. In theory, combining ramping to stimulus duration-dependent levels with slope changes by stimulus also generates regression effects (<xref ref-type="fig" rid="fig7">Figure 7E</xref>). Such a combination can be implemented either with mixed response patterns within one neuron or as a mixture of response types across a neuronal population. To find out which of the two scenarios underlies our data, we looked at the distribution of PCA scores for the cells in the linear increasing and the slope-changing categories. These scores were broadly distributed and also the corresponding decoding weights did not reveal a particular structure, indicating time coding comprising different response types (bottom-right panel in <xref ref-type="fig" rid="fig7">Figure 7F</xref>). To further test this possibility, we mixed responses of recorded cells from both categories at different fractions. Decoding not only yielded regression effects, but the strength of regression could be manipulated by the relative shares of both response types. The more slope-changing cells were present in the population, the stronger was the regression effect (top-right panel in <xref ref-type="fig" rid="fig7">Figure 7F</xref>).</p><p>Another response type that has been often connected to timing are phasically active cells. We therefore wondered how ongoing time would be encoded by such neurons. Constructing again theoretical stereotypes, we saw that neurons that are active relative to the stimulus interval can only encode a single time point. In contrast, a population of neurons that are phasically active at different absolute times tiling the whole interval would provide an accurate time representation (<xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2</xref>). Since neither relative nor absolute timing neurons by themselves predict regression effects as found in the behavioral responses, again a mixture of both response types would be required. Matching these theoretical results to our own recordings turned out to be less straightforward. We recorded phasically active cells (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>), but this subset of cells did not completely tile the whole time intervals. However, such a prerequisite is necessary to seriously attempt to reproduce the theoretical predictions.</p><p>Finally, we examined whether time could also be decoded from the neuronal responses in the measurement phase. Here, decoding was imprecise with overestimation at the begin and underestimation at the end of the interval (<xref ref-type="fig" rid="fig7s3">Figure 7—figure supplement 3</xref>) – a picture that also appeared for shuffled and noisy data (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>) and matches the less pronounced time signaling across the population during measurement, which we have found above in several places. A general underestimation was also found when we used only neurons in the PC 1 + stimulus PC 1 category, indicating their foremost influence on the collective readout. Interestingly, when we decoded time from the cells in the PC 1-only category, a regression effect was also seen during measurement (rightmost panel in <xref ref-type="fig" rid="fig7s3">Figure 7—figure supplement 3</xref>), suggesting an impact of previous stimuli (prior knowledge) on the activity of these neurons already during stimulus measurement and not just during reproduction.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We investigated the neural basis of time reproduction and analyzed neural correlates from rodent mPFC in a novel interval timing task. We showed that Mongolian gerbils (<italic>M. unguiculatus</italic>) are able to measure and reproduce durations lasting several seconds. To allow the gerbils to respond in a natural way, we used walking as a response (<xref ref-type="bibr" rid="bib27">Meijer and Robbers, 2014</xref>). The task was implemented in a rodent virtual reality system (<xref ref-type="bibr" rid="bib55">Thurley and Ayaz, 2017</xref>), which (1) gave us the use of a treadmill, (2) prevented landmark-based strategies for task-solving and (3) decoupled time from distance, such that the task could not be solved by path integration.</p><p>The rodents’ behavior exhibited typical characteristics of time reproduction and magnitude estimation, including the regression effect, that is, the overestimation of small and underestimation of large stimuli (also known as regression to the mean, central tendency, or Vierordt’s law; <xref ref-type="bibr" rid="bib57">von Vierordt, 1868</xref>; <xref ref-type="bibr" rid="bib18">Hollingworth, 1910</xref>; <xref ref-type="bibr" rid="bib47">Shi et al., 2013</xref>; <xref ref-type="bibr" rid="bib40">Petzschner et al., 2015</xref>). Neural activity in gerbil mPFC correlated with and likely contributed to time reproduction behavior. Prefrontal neurons displayed various firing characteristics, which could be grouped into a number of representative categories. Single-cell firing patterns differed between measurement and reproduction. For those cells that participated in both task phases, activity profiles never matched between task phases – although they sometimes correlated; see, for example, the ramp-type neurons in <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2A and D</xref> and <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4D</xref>. Moreover, changes in response characteristics between task phases were not coordinated across neurons, leading to low population vector correlations and no specific transition patterns between response types. Linear decomposition of the population activity, however, revealed state-space trajectories with common features in measurement and reproduction. This indicates that – despite the response heterogeneity within and between cells – the prefrontal population similarly encoded time in both task phases. Such effects on low-dimensional population activity in connection to changes of behavioral and cognitive state have been described for attention and task engagement (<xref ref-type="bibr" rid="bib11">Engel and Steinmetz, 2019</xref>). Nevertheless, task-related activity in the reproduction phase was more robust and less noisy compared to the measurement phase. This was obvious from most of our analyses and could mean that the mPFC is less involved or not involved at all during the measurement phase of our task. An issue that may be resolved in further experiments.</p><p>Neural correlates of interval timing in the range of seconds have been found in several brain areas (<xref ref-type="bibr" rid="bib32">Merchant et al., 2013</xref>; <xref ref-type="bibr" rid="bib38">Paton and Buonomano, 2018</xref>; <xref ref-type="bibr" rid="bib19">Issa et al., 2020</xref>), including prefrontal cortex (<xref ref-type="bibr" rid="bib12">Genovesio et al., 2006</xref>; <xref ref-type="bibr" rid="bib23">Kim et al., 2013</xref>; <xref ref-type="bibr" rid="bib59">Xu et al., 2014</xref>; <xref ref-type="bibr" rid="bib10">Emmons et al., 2017</xref>; <xref ref-type="bibr" rid="bib56">Tiganj et al., 2017</xref>), pre-/supplementary motor cortex (<xref ref-type="bibr" rid="bib34">Mita et al., 2009</xref>; <xref ref-type="bibr" rid="bib31">Merchant et al., 2011</xref>), hippocampus (<xref ref-type="bibr" rid="bib26">MacDonald et al., 2011</xref>), entorhinal cortex (<xref ref-type="bibr" rid="bib16">Heys and Dombeck, 2018</xref>), and striatum (<xref ref-type="bibr" rid="bib15">Gouvêa et al., 2015</xref>; <xref ref-type="bibr" rid="bib29">Mello et al., 2015</xref>; <xref ref-type="bibr" rid="bib1">Bakhurin et al., 2017</xref>; <xref ref-type="bibr" rid="bib10">Emmons et al., 2017</xref>). What distinguishes our experiments from previous studies is twofold: (1) we tested time intervals on a continuous range and (2) we combined timing of an external event (measurement phase) and timing own behavior (reproduction phase), linking sensory and motor timing (<xref ref-type="bibr" rid="bib38">Paton and Buonomano, 2018</xref>). Our study is therefore conceptually different from the fixed interval or discrimination tasks that have been used in most of the above timing studies. Some studies with monkeys used tasks comparable to ours but focused on intervals lasting only hundreds of milliseconds (<xref ref-type="bibr" rid="bib21">Jazayeri and Shadlen, 2015</xref>; <xref ref-type="bibr" rid="bib50">Sohn et al., 2019</xref>). The neural activity in primate parietal and frontal cortices observed in these studies is surprisingly similar to what we found in rodent mPFC. This is especially interesting since we tested timing of several seconds and neural dynamics typically act on much shorter time scales.</p><p>The mPFC responses we recorded during the reproduction phase are reminiscent of the neural correlates of self-initiated behavior found in rat secondary motor cortex by <xref ref-type="bibr" rid="bib35">Murakami et al., 2014</xref>; <xref ref-type="bibr" rid="bib36">Murakami et al., 2017</xref>. The reproduction phase in our task also involves self-initiated behavior (i.e., to stop walking). Murakami et al. found ramp-to-threshold cells similar to the one in <xref ref-type="fig" rid="fig2">Figure 2C</xref>. However, in contrast to our findings, they reported the absence of such responses in mPFC (<xref ref-type="bibr" rid="bib36">Murakami et al., 2017</xref>). This discrepancy may be due to the different tasks involved: waiting for a signal to appear after a random interval in their experiments vs. responding after a previously measured interval in our case. Ramp-to-threshold responses have also been found in monkey motor cortices during various timing behaviors (<xref ref-type="bibr" rid="bib30">Merchant and Georgopoulos, 2006</xref>; <xref ref-type="bibr" rid="bib34">Mita et al., 2009</xref>; <xref ref-type="bibr" rid="bib31">Merchant et al., 2011</xref>) and as a population pattern in lateral intraparietal cortex (<xref ref-type="bibr" rid="bib21">Jazayeri and Shadlen, 2015</xref>) during time (re-)production, demonstrating their ubiquitous presence in self-initiated behaviors. Note that we also recorded negative ramp-to-threshold, that is, ramp-down, responses (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). In addition, we observed linear increasing neurons (neurons that ramp to stimulus duration-dependent levels at the same slope, e.g., <xref ref-type="fig" rid="fig2">Figure 2B</xref>) that may serve as integrators of time information provided by sequentially activated, phasically responding cells (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>). Again, both types of neurons have been reported in other timing tasks (<xref ref-type="bibr" rid="bib31">Merchant et al., 2011</xref>; <xref ref-type="bibr" rid="bib23">Kim et al., 2013</xref>; <xref ref-type="bibr" rid="bib15">Gouvêa et al., 2015</xref>; <xref ref-type="bibr" rid="bib13">Genovesio et al., 2016</xref>). Responses with a linear ramping component (comprising both linear increasing and ramp-to-threshold) have been shown to be important for precise time decoding and to underlie low-dimensional population dynamics (<xref ref-type="bibr" rid="bib7">Cueva et al., 2020</xref>).</p><p>Our time decoding analysis revealed that ramp-to-threshold and linear increasing neurons cannot by themselves explain the regression effect; rather, the combination of both response types is necessary in either a single neuron or mixed across a population of neurons. Reading out this activity will show the regression effect. We used a linear regression decoder, which takes the perspective of a neuron that forms a weighted sum of its inputs and provides a continuous time readout. This choice was motivated to gain insight into the potential mechanism of the regression effect. Despite its simplicity, it revealed that the regression effect may be the result of decoding from mixed responses. Other decoding approaches are far more efficient and precise in reading out elapsed time from neural activity like, for example, classifiers (<xref ref-type="bibr" rid="bib1">Bakhurin et al., 2017</xref>; <xref ref-type="bibr" rid="bib33">Merchant and Averbeck, 2017</xref>). But due to their efficiency they do not show the regression effect and would contribute less to its understanding in the present framework.</p><p>Although we cannot tell from our data how mixing is accomplished, mixed response types are compatible with theoretical models of interval timing (<xref ref-type="bibr" rid="bib49">Simen et al., 2011</xref>; <xref ref-type="bibr" rid="bib54">Thurley, 2016</xref>). Similarly, distributing relative and absolute timing cells across a neuronal population may yield the regression effect. However, since ramp-like responses were prominent in our data set, we consider their contribution more likely. Mixed response types are in general important in cognitive tasks (<xref ref-type="bibr" rid="bib43">Rigotti et al., 2013</xref>) but have also been reported during spontaneous behavior (<xref ref-type="bibr" rid="bib52">Stringer et al., 2019</xref>). Coding of variables related to cognitive functions like choice and task engagement is often distributed across brain regions (<xref ref-type="bibr" rid="bib51">Steinmetz et al., 2019</xref>). Although we only recorded in one brain region and cannot comment on the distribution across the brain, our findings suggest that a local distribution of response types may also underlie cognitive functions.</p><p>Temporal scaling appears to be a general feature of timed computations in the brain as it has been described in various brain regions (<xref ref-type="bibr" rid="bib59">Xu et al., 2014</xref>; <xref ref-type="bibr" rid="bib29">Mello et al., 2015</xref>; <xref ref-type="bibr" rid="bib58">Wang et al., 2018</xref>). It has also been demonstrated to be important for time coding in neural network models (<xref ref-type="bibr" rid="bib3">Bi and Zhou, 2020</xref>). In our experiments, neuronal activity scaled and changed speed in relation to the stimulus duration in the reproduction phase only. Here, animals had to actively generate timed behavior (motor timing); in contrast to the measurement phase (sensory timing), where due to the randomization stimulus duration could not be determined in advance.</p><p>Temporal scaling and speed dependence of neural dynamics corresponded to the regression effect we observed in the behavioral data. Bayesian models (<xref ref-type="bibr" rid="bib20">Jazayeri and Shadlen, 2010</xref>; <xref ref-type="bibr" rid="bib40">Petzschner et al., 2015</xref>) as well as other approaches (<xref ref-type="bibr" rid="bib2">Bausenhart et al., 2014</xref>; <xref ref-type="bibr" rid="bib54">Thurley, 2016</xref>) have demonstrated that the regression effect may be a strategy to minimize behavioral errors. Bayesian models fuse probability distributions of the current stimulus estimate and prior knowledge. The neural representations of these probability distributions and the mechanism underlying the probabilistic computations have yet to be determined. An interesting solution was proposed by <xref ref-type="bibr" rid="bib50">Sohn et al., 2019</xref> based on recordings from monkey frontal cortex. While the animals measured time intervals in a task very similar to ours, frontal cortex activity followed low-dimensional curved state-space trajectories. These curved trajectories can be interpreted as a compressed nonlinear representation of time, which when read-out appropriately during reproduction can explain regression effects seen in behavior. Our demixed PCs also showed curved trajectories during measurement (<xref ref-type="fig" rid="fig5">Figure 5A</xref>); however, trajectories from conventional PCA did not comprise such curvatures (<xref ref-type="fig" rid="fig5">Figure 5D</xref>, <xref ref-type="fig" rid="fig5s5">Figure 5—figure supplement 5A</xref>). These results do not necessarily contrast with those of <xref ref-type="bibr" rid="bib50">Sohn et al., 2019</xref>. It is possible that – at least in our behavioral task – mPFC is not involved in the compression of the time estimate in the measurement phase. But it may contribute to reproduce the compressed estimate, for example, to signal when to stop running in the reproduction phase. The fact that we observed curved state-space trajectories in the reproduction phase suggests this possibility. At the single-neuron-level, curved state-space trajectories are supported by neurons with a ramping component. These contribute to the monotonous shape of the strongest PC (PC 1, <xref ref-type="fig" rid="fig5">Figure 5B</xref>). In combination with the non-monotonous PC 2, curved but non-entangled state-space trajectories result that can support the mechanism suggested by <xref ref-type="bibr" rid="bib50">Sohn et al., 2019</xref>.</p><p>Our results further suggest that two different types of ramping underlie the regression effect: ramping with a constant slope and ramping with a slope that depends on stimulus duration. When both response types are implemented in different neurons and distributed across the population, the amount of noise in the system determines the strength of the regression effect. Without noise, duration encoding is dominated by neurons that ramp with a constant slope and no regression effect emerges. If activity is noisy, neurons with stimulus-dependent slope contribute and the regression effect appears. Thus, the amount of noise (uncertainty about the current stimulus) determines the impact of either response type and thus the balance between current stimulus estimate and prior knowledge.</p><p>State-space trajectories for different stimulus durations were well separated during measurement (<xref ref-type="fig" rid="fig5">Figure 5A</xref>). Since stimulus duration is unknown at the beginning of the measurement phase, such duration-dependent trajectories are likely due to prior expectations about the stimulus duration. Small stimuli are typically followed by larger ones and vice versa, which may bias neural responses and behavioral estimates accordingly. Such sequential effects are known in magnitude estimation (<xref ref-type="bibr" rid="bib2">Bausenhart et al., 2014</xref>; <xref ref-type="bibr" rid="bib40">Petzschner et al., 2015</xref>; <xref ref-type="bibr" rid="bib54">Thurley, 2016</xref>). Interestingly, when we only included ramping cells for time decoding a regression effect was also seen during measurement (<xref ref-type="fig" rid="fig7s3">Figure 7—figure supplement 3</xref>), implying that previous stimuli affect the current measurement. Influences of prior expectations on neural activity during time interval estimation have been reported recently (<xref ref-type="bibr" rid="bib28">Meirhaeghe et al., 2021</xref>). During reproduction, trajectories were also ordered by stimulus (<xref ref-type="fig" rid="fig5">Figure 5B</xref>, <xref ref-type="fig" rid="fig5s5">Figure 5—figure supplement 5B</xref>), which is considered an indication that cortical dynamics are adjusted for (re-)producing different time intervals (<xref ref-type="bibr" rid="bib42">Remington et al., 2018</xref>).</p><p>The present work provides insight into the neural substrate of time reproduction, including the regression effect and error minimization, in rodents. A thorough characterization of mPFC responses allowed us to show that only mixed responses in either single cells or distributed across a local population of neurons can explain the regression effect. By adjusting the relative fractions of response types, one can parameterize the strength of the regression effect and thus the fusion of stimulus estimate and prior knowledge. To resolve the specifics of the underlying neural computations will be an important direction for future research.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Animals</title><p>The experiments in this study were conducted with three female adult Mongolian gerbils (<italic>M. unguiculatus</italic>) from a wild-type colony at the local animal house (referred to by IDs 10526, 11769, and 11770 throughout the article). Training started at an age of at least 4 months. The gerbils were housed individually on a 12 hr light/dark cycle, and all behavioral training and recording sessions were performed in the light phase of the cycle. The animals received a diet maintaining them at about 85–95% of their free feeding weight. All experiments were approved according to national and European guidelines on animal welfare (Reg. von Oberbayern, District Government of Upper Bavaria; reference numbers: AZ 55.2-1-54-2532-10-11 and AZ 55.2-1-54-2532-70-2016).</p></sec><sec id="s4-2"><title>Behavioral experiments</title><sec id="s4-2-1"><title>Experimental apparatus</title><p>Experiments were done on a virtual reality (VR) setup for rodents (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). For a detailed description, see <xref ref-type="bibr" rid="bib53">Thurley et al., 2014</xref>. In brief, the setup consists of an air-suspended styrofoam sphere that acts as a treadmill. On top of the sphere, the rodent is fixated with a harness that leaves head and legs freely movable. Rotations of the sphere are induced when the animal moves its legs. The rotations are detected by infrared sensors and fed into a computer to generate and update a visual virtual scene. The scene is displayed via a projector onto a projection screen that surrounds the treadmill. We used Vizard Virtual Reality Toolkit (v5, WorldViz, <ext-link ext-link-type="uri" xlink:href="https://www.worldviz.com">https://www.worldviz.com</ext-link>) for real-time rendering; the virtual environment was designed with Blender (v2.49b, <ext-link ext-link-type="uri" xlink:href="https://www.blender.org/">https://www.blender.org/</ext-link>). Animals were rewarded with food pellets (20 mg Purified Rodent Tablet, banana and chocolate flavor, TestDiet, Sandown Scientific, UK) that were automatically delivered and controlled by the VR software.</p></sec><sec id="s4-2-2"><title>Behavioral paradigm</title><p>In our interval reproduction task, a rodent had to estimate the duration of a visual stimulus and reproduce it by moving along a virtual corridor. It is thus a variant of the ‘ready-set-go’ timing task by <xref ref-type="bibr" rid="bib20">Jazayeri and Shadlen, 2010</xref>. <xref ref-type="fig" rid="fig1">Figure 1A</xref> illustrates the procedure: each trial started with the presentation of a temporal stimulus – a black screen. Animals were trained to measure its duration and not to move during this phase of the task. Stimuli were randomly chosen between 3 and 7.5 s (i.e., either 3, 3.75, 4.5, 5.25, 6, 6.75, or 7.5 s). Afterward, the visual scene switched, a virtual corridor appeared, and the animal had to reproduce the stimulus by moving through the corridor for the same duration. The animal decided on its own when to start reproducing the interval as well as when to stop. These ‘reaction times’ typically took a few seconds and correlated only weakly with the stimulus or the reproduced stimulus in some sessions (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2C</xref>). If the animal continuously moved the treadmill for at least 1 s, the start of this movement was counted as the begin of reproduction. To finish reproduction, the animal had to stop for more than 0.5 s. These 0.5 s were not included in the reproduced interval. With this procedure, we avoided counting brief movements and stops as responses. <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> shows movement data from one example session.</p><p>We gave feedback to our gerbils on their reproduction performance. Following the reproduction phase, the entire projection screen was either set to green (positive, ‘in’) or white (negative, ‘out’) for 3–4 s. In addition, the animal was rewarded with one food pellet. For a reward, the reproduction had to be sufficiently close to the stimulus interval, that is, <inline-formula><mml:math id="inf6"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>±</mml:mo><mml:mi>k</mml:mi><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> stimulus. The width of this feedback range depended on the stimulus interval since errors increase with interval length, that is, scalar variability (<xref ref-type="bibr" rid="bib20">Jazayeri and Shadlen, 2010</xref>; <xref ref-type="bibr" rid="bib50">Sohn et al., 2019</xref>). Across the session, tolerance <inline-formula><mml:math id="inf7"><mml:mi>k</mml:mi></mml:math></inline-formula> was reduced by –3% when a reward was given and extended by +3% otherwise (<xref ref-type="fig" rid="fig1">Figure 1B</xref>).</p><p>In the first trial of a session, <inline-formula><mml:math id="inf8"><mml:mi>k</mml:mi></mml:math></inline-formula> was always set to the value from the last trial in the previous session. Adapting <inline-formula><mml:math id="inf9"><mml:mi>k</mml:mi></mml:math></inline-formula> over a session, animals reached values of 15% and below on average (<xref ref-type="fig" rid="fig1">Figure 1E</xref>). Reward rates lay roughly between 50% and 75% (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2B</xref>), indicating that the adaptive feedback range was successful in preventing alternative strategies such as learning the lower border of the feedback range.</p><p>The virtual corridor was designed to exclude landmark-based strategies. It was infinite and had a width of 0.5 m. The walls of 0.5 m height were covered with a repetitive pattern of black and white stripes, each with a height to width ratio of 1:5. The floor was homogeneously colored in medium light-blue and the sky was black.</p><p>By randomly changing the gain between an animals’ own movement (i.e., movement on the treadmill) and movement in VR, we decorrelated movement time from virtual distance and thus prevented path integration strategies for task solving. Gain values were uniformly sampled between 0.25 and 2.25. Distributions of virtual speed, running speed, as well as their correlations with stimulus interval, reproduced duration and the bias (i.e., reproduction – stimulus) can be found in <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>. Running speed was (mostly negatively) correlated in about 25% of the sessions to stimulus and reproduction.</p></sec><sec id="s4-2-3"><title>Behavioral training and testing</title><p>Naive gerbils were accustomed to the VR setup in a virtual linear maze for 5–10 sessions (~2 weeks, <xref ref-type="bibr" rid="bib53">Thurley et al., 2014</xref>). Then, we exposed the animals to the timing task. As a first step, we presented only stimuli of 3 and 6 s, which were easy to distinguish for the animals. The animals had to learn to either walk for a short or a long duration. Feedback was initially given with a tolerance of <inline-formula><mml:math id="inf10"><mml:mi>k</mml:mi></mml:math></inline-formula> = 50% and training proceeded until values below 30% were reached for at least three subsequent sessions. This training phase took about 1.5 months (ca. 30 sessions). In the second part of the training, we presented the full stimulus range for about seven sessions (1.5 weeks) to introduce the animals to stimuli on a continuous scale. Training state was quantified by the slope and CV (see also <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2D</xref>). Afterward, we implanted tetrodes into the animals’ mPFC and continued with the test phase.</p></sec><sec id="s4-2-4"><title>Analysis of behavioral data</title><p>To compare behavioral performance across sessions and animals, we calculated different measures. To quantify the strength of the regression effect, we determined the slope of the linear regression between stimuli <inline-formula><mml:math id="inf11"><mml:mi>s</mml:mi></mml:math></inline-formula> and their reproductions <inline-formula><mml:math id="inf12"><mml:mi>r</mml:mi></mml:math></inline-formula>. A slope of 1 would correspond to no regression and smaller slopes to stronger regression. Variability is measured by the CV, which we calculated as <inline-formula><mml:math id="inf13"><mml:mrow><mml:mrow><mml:mtext>CV</mml:mtext><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mtext>E</mml:mtext><mml:mi>s</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mtext>STD</mml:mtext><mml:mi>s</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mtext>E</mml:mtext><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt">∣</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Here <inline-formula><mml:math id="inf14"><mml:mrow><mml:msub><mml:mtext>E</mml:mtext><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt">∣</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the average response to a stimulus <inline-formula><mml:math id="inf15"><mml:mi>s</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf16"><mml:mrow><mml:msub><mml:mtext>STD</mml:mtext><mml:mi>s</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> the corresponding standard deviation. The ratio of both values is averaged over all stimuli, denoted by <inline-formula><mml:math id="inf17"><mml:mrow><mml:msub><mml:mtext>E</mml:mtext><mml:mi>s</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mo>⋅</mml:mo><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. To quantify general under- or overestimation, we use <inline-formula><mml:math id="inf18"><mml:mrow><mml:mrow><mml:mtext>BIAS</mml:mtext><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mtext>E</mml:mtext><mml:mi>s</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mtext>E</mml:mtext><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt">∣</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></sec></sec><sec id="s4-3"><title>Electrophysiological recordings</title><sec id="s4-3-1"><title>Electrode implantation</title><p>We chronically implanted gerbils with eight tetrodes mounted to a microdrive that allowed for movement of all tetrodes together (Axona Ltd., St. Albans, UK). Tetrodes were made of 17 µm platinum-iridium wires (California Fine Wire Co.). For surgery, we anesthetized an animal with an initial dose of medetomidine-midazolam-fentanyl (0.15 mg/kg, 7.5 mg/kg, 0.03 mg/kg, s.c.) and later maintained anesthesia by 2/3 doses every 2 hr. The animal was placed on a heating pad to keep body temperature at 37°C and fixated in a stereotactic unit (Stoelting Co.). After giving local analgesia of the skull with lidocaine (Xylocain, Astra Zeneca GmbH), we drilled a hole into the skull above the right mPFC and placed tetrodes at an initial depth of 700 µm into the cortex (2.1 mm AP, –0.7 mm ML, –0.7 mm DV; <xref ref-type="bibr" rid="bib41">Radtke-Schuller et al., 2016</xref>). To protect the exposed part of the brain, we used alginate (0.5% sodium alginate and 10% calcium chloride, Sigma-Aldrich) and paraffin wax. Further holes were drilled into the frontal, parietal, and occipital bone to place small jewellers’ screws to help anchoring the microdrive to the skull with dental acrylic (iBond Etch, Heraeus Kulzer GmbH, Germany; Simplex Rapid, Kemdent, UK). One of the screws served as electrical ground. At the end of the surgery, anesthesia was antagonized with atipamezole-flumazenil-naloxone (0.4 mg/kg, 0.4 mg/kg, 0.5 mg/kg, s.c.). During surgery and for three postsurgical days, we gave meloxicam as a painkiller (0.2 mg/kg, s.c.). In addition, enrofloxacin antibiosis (Baytril, 10 mg/kg, s.c.) was done for 5–7 postsurgical days. The animals were allowed to recover for at least 3 days after surgery before recordings started.</p></sec><sec id="s4-3-2"><title>Recording procedures</title><p>Extracellular action potentials of single units were recorded at a rate of 32 kHz (Digital Lynx SX, Neuralynx, Inc). Unit activity was band-pass filtered at 600 Hz to 6 kHz. Each tetrode could be recorded differentially, being referenced by one electrode of another tetrode or the ground connected to one of the jewellers’ screws. Recordings were done with Neuralynx’ data acquisition software Cheetah v5.6.3 (<ext-link ext-link-type="uri" xlink:href="https://neuralynx.com">https://neuralynx.com</ext-link>).</p><p>To sample different neurons throughout the experimental period, we lowered the position of the tetrodes along the dorsoventral axis of the mPFC. Lowering was done for 50 µm at the end of every second experimental session to allow for stabilization until the next experiment.</p></sec><sec id="s4-3-3"><title>Reconstruction of tetrode placement</title><p>Tetrode placement was verified histologically postmortem. Animals received an overdose of sodium pentobarbital and were perfused intracardially with 4% paraformaldehyde. Brains were extracted and incubated in paraformaldehyde for 1–2 days. Afterward, the brain was washed in 0.02 M phosphate buffered saline and coronal slices of 60–80 µm thickness were obtained and stained either with Neutralred or DiI (D282), NeuroTrace 500/525 Green Fluorescent Nissl Stain, and DAPI – all stains from Thermo Fisher Scientific. Histology of all animals can be found in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A</xref>.</p></sec></sec><sec id="s4-4"><title>Analysis of electrophysiological data</title><p>A total of 1766 mPFC neurons were recorded over 101 experimental sessions, each with on average more than 50 trials (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2A</xref>); animal 10526: 348 cells in 38 sessions; animal 11769: 677 cells in 32 sessions; and animal 11770: 741 cells in 31 sessions.</p><sec id="s4-4-1"><title>Spike sorting</title><p>Spike sorting was done offline in two steps. First, data was automatically clustered with KlustaKwik (v1.6). Afterward, clusters were improved manually in 2D projections of waveform features including peak and valley, the difference between both, and energy, that is, integral of the absolute value of the waveform, with MClust v4.3 (<ext-link ext-link-type="uri" xlink:href="http://redishlab.neuroscience.umn.edu/MClust/MClust.html">http://redishlab.neuroscience.umn.edu/MClust/MClust.html</ext-link>) under MATLAB2015b (The MathWorks, Inc). See <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref> for example spike clusters.</p><p>Quality of spike sorting was assessed by calculating (1) rate of interspike interval (ISI) violations (spikes with ISI &lt; 1.5 ms are assumed to come from different neurons) and (2) calculating the fraction of spikes missing assuming a symmetric distribution of amplitudes (for details, see <xref ref-type="bibr" rid="bib17">Hill et al., 2011</xref>). We excluded clusters with ISI violations &gt; 0.5 and amplitude cutoff &gt; 0.1. Both measures were calculated using the implementation in the Allen Institute ecephys spike sorting Python modules (<ext-link ext-link-type="uri" xlink:href="https://github.com/AllenInstitute/ecephys_spike_sorting">https://github.com/AllenInstitute/ecephys_spike_sorting</ext-link>; <xref ref-type="bibr" rid="bib48">Siegle et al., 2021</xref>). Also, only units with stable firing throughout a session entered further analysis. A unit was considered stable if spike counts in 1 min windows did not drop below 4 standard deviations from the mean session firing rate.</p></sec><sec id="s4-4-2"><title>Spike density functions</title><p>We determined spike density functions (SDFs) for each task phase separately. To calculate an SDF, spikes were either aligned at the begin or the end of the task phase. Then, spikes were counted in 100 ms windows for all trials at the same stimulus and divided by window width to gain firing rates. The windows were right aligned (looking into the past) to gain causal SDFs. To avoid edge effects due to response variability at the same stimulus, trials were scaled to the average response for the reproduction phase. During the measurement phase, trials had the same duration by design. For visualization only (<xref ref-type="fig" rid="fig2">Figure 2</xref>, <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>-<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>), SDFs were smoothed with a half Gaussian kernel of 3-bin standard deviation whose direction matched the right alignment of the window for spike counting, that is, which was looking into the past.</p><p>For the analyses in Figures 3–7 and accompanying supplementary figures, SDFs were z-scored to account for cell-specific differences in firing rate. In addition, we resampled to same number of bins (time-normalized) the SDFs of different cells and for different stimuli to be able to compare data from stimuli and responses of different duration.</p><p>For the population plots in <xref ref-type="fig" rid="fig3">Figure 3A–C</xref>, neurons were sorted by the angle between their demixed PCA scores for the first two time course-related PCs (see below for the description of the demixed PCA). This takes into account the full response profile instead of single features like the peak firing rate.</p><p>Control SDFs used in <xref ref-type="fig" rid="fig4">Figure 4</xref> and <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref> were generated by (1) shuffling SDFs for each stimulus across cells (‘shuffled data’) and (2) shuffling single responses over time (‘noise’).</p></sec><sec id="s4-4-3"><title>Single-cell responses to running speed</title><p>To determine the influence of running speed on the firing rate of a neuron (speed response function), we counted the number of spikes that occurred at a certain running speed (5 cm/s bins, minimum speed 10 cm/s, maximum speed 1 m/s) and divided the count by the total duration the animal moved at this speed. This response function was hence independent of trial and stimulus interval. To assess statistical significance of speed modulation, we (1) shuffled spikes times, (2) recalculated the firing rate as a function of speed in each bin, and (3) determined the variance in firing rate of the shuffled speed response function (<xref ref-type="bibr" rid="bib44">Saleem et al., 2013</xref>). To have a robust shuffle control value, we repeated this procedure 10 times and used the shuffled speed response function with the largest variance. Using Levene’s test, this variance was compared to that of the true speed response function. We tested for variances larger than the shuffle control only. A speed modulation index in firing rate was calculated from the average firing rate in the 0–10 and 90–100 percentiles of the speed response function as <inline-formula><mml:math id="inf19"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>90</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>90</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s4-4-4"><title>Single-cell and population correlations</title><p>In <xref ref-type="fig" rid="fig3">Figure 3</xref>, we report different Pearson correlations for the single-cell and population data. All correlations were calculated on the time-normalized SDFs. Pairwise correlations were determined for the responses to all stimuli between all pairs of neurons (insets in <xref ref-type="fig" rid="fig3">Figure 3A–C</xref>). The population vector correlation in <xref ref-type="fig" rid="fig3">Figure 3D</xref> was calculated between the activity of all neurons in one time bin during measurement and the corresponding time bin during reproduction, that is, correlating columns in <xref ref-type="fig" rid="fig3">Figure 3A and C</xref>. In <xref ref-type="fig" rid="fig3">Figure 3E</xref>, single-cell activity across all stimuli was correlated between measurement and reproduction, that is, correlating rows in <xref ref-type="fig" rid="fig3">Figure 3A and C</xref>. In <xref ref-type="fig" rid="fig3">Figure 3F</xref>, population vector correlations were calculated for all stimulus pairs, that is, correlating all points belonging to a particular stimulus in <xref ref-type="fig" rid="fig3">Figure 3A</xref> or B to those belonging to another stimulus. Similarly, correlations for all pairs of stimuli were determined for each individual cell in <xref ref-type="fig" rid="fig3">Figure 3G</xref>.</p></sec><sec id="s4-4-5"><title>Principal component analysis</title><p>To gain a reduced representation of the collective population activity over time, we applied demixed and conventional PCA in the <inline-formula><mml:math id="inf20"><mml:mi>T</mml:mi></mml:math></inline-formula>-dimensional space where each dimension represents the firing rate at a different time point. A neuron’s activity pattern is hence represented as one single point in this space and a PC will be a component that has <inline-formula><mml:math id="inf21"><mml:mi>T</mml:mi></mml:math></inline-formula> points and evolves over time. The first PC will be the temporal pattern of activity that explains most variance; the second PC the one orthogonal to the first with second most variance and so on. By this method, PCs represent collective population activity over time. With demixed PCA, this population activity can be separated into components related to the stimulus interval and those related to the overall time course of the population activity independent of the stimulus.</p><p>Demixed PCA was performed separately for measurement and reproduction on the SDFs of all recorded neurons aligned at the respective onsets (<xref ref-type="fig" rid="fig5">Figure 5</xref>); see <xref ref-type="bibr" rid="bib24">Kobak et al., 2016</xref> for a detailed description. We used the demixed PCA implementation available at <ext-link ext-link-type="uri" xlink:href="https://github.com/machenslab/dPCA">https://github.com/machenslab/dPCA</ext-link> (<xref ref-type="bibr" rid="bib25">Kobak et al., 2021</xref>). When we applied demixed PCA on data from individual animals, results were similar (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref> <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>, and <xref ref-type="fig" rid="fig5s3">Figure 5—figure supplement 3</xref>). Conventional PCA was also done separately for measurement and reproduction and on the SDFs of all recorded neurons aligned at the respective onsets (<xref ref-type="fig" rid="fig5s5">Figure 5—figure supplement 5</xref>).</p><p>Bootstrapping was done by performing demixed PCA on 1000 random subsets comprising each 10% of the whole data set. Subsets were picked in a stratified way, that is, accounting for the different numbers of cells recorded in each animal. The function StratifiedShuffleSplit from scikit-learn was used for picking the subsets. Results were similar for 5% and 20% subsets.</p></sec><sec id="s4-4-6"><title>Tensor maximum entropy surrogates</title><p>To test whether population responses contained collective contributions beyond what is expected from pooling single neurons, we generated control surrogate data according to <xref ref-type="bibr" rid="bib8">Elsayed and Cunningham, 2017a</xref>. Random tensor maximum entropy surrogate samples were drawn that preserved the stimulus tuning of single neurons, correlations of single-cell firing rates across time and signal correlations across neurons. The implementation we used is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/gamaleldin/rand_tensor">https://github.com/gamaleldin/rand_tensor</ext-link> (<xref ref-type="bibr" rid="bib9">Elsayed and Cunningham, 2017b</xref>).</p></sec><sec id="s4-4-7"><title>Categorization of response types</title><p>We categorized cells into different response types by their score values for specific PCs: time course-related PC 1 and stimulus PC 1 for measurement and time course-related PCs 1–3 and stimulus PC 1 for reproduction. Since the scores for those PCs had single peaked distributions, displaying no obvious clusters or response groups (<xref ref-type="fig" rid="fig5s4">Figure 5—figure supplement 4</xref>), we used the following procedure to construct response categories: first, a cell’s responses in either task phase were reconstructed as a linear combination from the abovementioned PCs weighted by the respective PCA scores. Then the variance of the cell’s response was determined, which was explained by this reconstruction. If this explained variance was below the cumulative overall explained variance for the PCs (measurement: 6%, reproduction: 28%; <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>), the cell was assigned to the ‘unrelated activity’ category (<xref ref-type="fig" rid="fig5s4">Figure 5—figure supplement 4</xref>). Otherwise, first the strongest PC (the one with the largest absolute scores) was found and then the angles between this PC and each of the other PCs were determined (calculated on the absolute values). If any of those angles was above 22.5°, the other component was counted as contributing (<xref ref-type="fig" rid="fig5s4">Figure 5—figure supplement 4C</xref>). In total, <inline-formula><mml:math id="inf22"><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> different response types were possible in the measurement phase and <inline-formula><mml:math id="inf23"><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mn>4</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:math></inline-formula> in the reproduction phase, that is, categories ranging from ‘unrelated activity’ with no overlap with any of the PCs to activity explained by all PCs used for categorization.</p><p>Categories were validated by categorizing every cell by its scores for each of the 1000 bootstrapped demixed PCAs described above. Finally, the category with maximum likelihood was assigned to the cell.</p><p>In addition, we compared the number of cells in each category to a random prediction. For that, we constructed random surrogate data by shuffling SDFs across stimuli and cells, performed demixed PCA on this data, categorized each ‘surrogate cell,’ and counted the number of cells in each category. From 1000 such shufflings, we got distributions of by chance expected cell counts in each category, which we used to determine p-values for the count in the original data. A level of 5% was chosen and indicated as significant in <xref ref-type="fig" rid="fig6">Figure 6</xref>.</p></sec><sec id="s4-4-8"><title>Time decoding</title><p>To decode elapsed time, we used multiple linear regression (Wiener filter; <xref ref-type="bibr" rid="bib14">Glaser et al., 2020</xref>, <ext-link ext-link-type="uri" xlink:href="https://github.com/kordinglab/neural_decoding">https://github.com/kordinglab/neural_decoding</ext-link>) between time points and the spike responses (SDFs) of all neurons, that is, the SDFs of each neuron were weighted such that elapsed time could be most precisely decoded. The SDFs of all neurons were combined in a matrix <inline-formula><mml:math id="inf24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">R</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> with the individual SDFs as columns, such that the matrix had as many rows as time points and as many columns as neurons. Representing ongoing time as a vector <inline-formula><mml:math id="inf25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">t</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, the regression problem reads<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">R</mml:mi></mml:mrow><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold">t</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>with <inline-formula><mml:math id="inf26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> being the vector comprising the weights for each neuron (SDF), which can be fit by least squares.</p><p>The above equation deals only with one SDF per neuron, that is, the response at one stimulus interval. However, we did not want to find individual weights for each stimulus but one weight for all stimuli per neuron. Therefore, we concatenated a neuron’s SDFs for all stimuli, such that <inline-formula><mml:math id="inf27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">R</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> had as many rows as time points × stimuli. The weights <inline-formula><mml:math id="inf28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> were then fit. This treated the whole data set as a reference (prior). During decoding ongoing time at a particular stimulus, we plugged in only the SDF at this stimulus into the left side of <xref ref-type="disp-formula" rid="equ1">Equation 1</xref> and received a vector of decoded time points. Fitting and decoding was done on random subsets of 20 cells (1000 bootstrap runs), from which we extracted average and standard deviation. To avoid overfitting, zero-mean Gaussian noise with <inline-formula><mml:math id="inf29"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> was added to the SDFs. Note that the SDFs were z-scored.</p></sec></sec><sec id="s4-5"><title>Additional notes on data analysis</title><p>Data analysis was done with Python 2.7 using Matplotlib 2.2, Numpy 1.15, Pandas 0.24, Scipy 1.2, Scikit-learn 0.20, and Statsmodels 0.10 – in addition to abovementioned packages. If p-values are not provided, significance is indicated by <italic>* p</italic>&lt;0.05, ** <italic>p</italic>&lt; 0.01, *** <italic>p</italic>&lt;0.001.</p></sec></sec></body><back><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Data curation, Investigation, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Formal analysis, Software, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Formal analysis, Software, Writing – review and editing</p></fn><fn fn-type="con" id="con4"><p>Formal analysis, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con6"><p>Conceptualization, Data curation, Formal analysis, Methodology, Project administration, Software, Supervision, Writing - original draft, Writing – review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>All experiments were approved according to national and European guidelines on animal welfare (Reg. von Oberbayern, District Government of Upper Bavaria; reference numbers: AZ 55.2-1-54-2532-10-11 and AZ 55.2-1-54-2532-70-2016).</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-71612-transrepform1-v2.pdf"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>Raw data for this study are available at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.12751/g-node.tarvrs">https://doi.org/10.12751/g-node.tarvrs</ext-link> (Henke et al., 2021). In addition, source data are given when mentioned in the figure captions.</p><p>The following dataset was generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Henke</surname><given-names>J</given-names></name><name><surname>Bunk</surname><given-names>D</given-names></name><name><surname>von Werder</surname><given-names>D</given-names></name><name><surname>Häusler</surname><given-names>S</given-names></name><name><surname>Flanagin</surname><given-names>V</given-names></name><name><surname>Thurley</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>Data for Distributed coding of duration in rodent prefrontal cortex during time reproduction</data-title><source>tarvrs</source><pub-id pub-id-type="doi">10.12751/g-node.tarvrs</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>We thank Tobias Bernklau for help with data analysis and Moritz Dittmeyer for help with the schematic drawing of the setup.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bakhurin</surname><given-names>KI</given-names></name><name><surname>Goudar</surname><given-names>V</given-names></name><name><surname>Shobe</surname><given-names>JL</given-names></name><name><surname>Claar</surname><given-names>LD</given-names></name><name><surname>Buonomano</surname><given-names>DV</given-names></name><name><surname>Masmanidis</surname><given-names>SC</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Differential Encoding of Time by Prefrontal and Striatal Network Dynamics</article-title><source>The Journal of Neuroscience</source><volume>37</volume><fpage>854</fpage><lpage>870</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1789-16.2016</pub-id><pub-id pub-id-type="pmid">28123021</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bausenhart</surname><given-names>KM</given-names></name><name><surname>Dyjas</surname><given-names>O</given-names></name><name><surname>Ulrich</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Temporal reproductions are influenced by an internal reference: explaining the Vierordt effect</article-title><source>Acta Psychologica</source><volume>147</volume><fpage>60</fpage><lpage>67</lpage><pub-id pub-id-type="doi">10.1016/j.actpsy.2013.06.011</pub-id><pub-id pub-id-type="pmid">23896562</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bi</surname><given-names>Z</given-names></name><name><surname>Zhou</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Understanding the computation of time using neural network models</article-title><source>PNAS</source><volume>117</volume><fpage>10530</fpage><lpage>10540</lpage><pub-id pub-id-type="doi">10.1073/pnas.1921609117</pub-id><pub-id pub-id-type="pmid">32341153</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bueti</surname><given-names>D</given-names></name><name><surname>Walsh</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>The parietal cortex and the representation of time, space, number and other magnitudes</article-title><source>Philosophical Transactions of the Royal Society of London. Series B, Biological Sciences</source><volume>364</volume><fpage>1831</fpage><lpage>1840</lpage><pub-id pub-id-type="doi">10.1098/rstb.2009.0028</pub-id><pub-id pub-id-type="pmid">19487186</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cicchini</surname><given-names>GM</given-names></name><name><surname>Arrighi</surname><given-names>R</given-names></name><name><surname>Cecchetti</surname><given-names>L</given-names></name><name><surname>Giusti</surname><given-names>M</given-names></name><name><surname>Burr</surname><given-names>DC</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Optimal encoding of interval timing in expert percussionists</article-title><source>The Journal of Neuroscience</source><volume>32</volume><fpage>1056</fpage><lpage>1060</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3411-11.2012</pub-id><pub-id pub-id-type="pmid">22262903</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cohen Kadosh</surname><given-names>R</given-names></name><name><surname>Lammertyn</surname><given-names>J</given-names></name><name><surname>Izard</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Are numbers special? An overview of chronometric, neuroimaging, developmental and comparative studies of magnitude representation</article-title><source>Progress in Neurobiology</source><volume>84</volume><fpage>132</fpage><lpage>147</lpage><pub-id pub-id-type="doi">10.1016/j.pneurobio.2007.11.001</pub-id><pub-id pub-id-type="pmid">18155348</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cueva</surname><given-names>CJ</given-names></name><name><surname>Saez</surname><given-names>A</given-names></name><name><surname>Marcos</surname><given-names>E</given-names></name><name><surname>Genovesio</surname><given-names>A</given-names></name><name><surname>Jazayeri</surname><given-names>M</given-names></name><name><surname>Romo</surname><given-names>R</given-names></name><name><surname>Salzman</surname><given-names>CD</given-names></name><name><surname>Shadlen</surname><given-names>MN</given-names></name><name><surname>Fusi</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Low-dimensional dynamics for working memory and time encoding</article-title><source>PNAS</source><volume>117</volume><fpage>21</fpage><lpage>23</lpage><pub-id pub-id-type="doi">10.1073/pnas.1915984117</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Elsayed</surname><given-names>GF</given-names></name><name><surname>Cunningham</surname><given-names>JP</given-names></name></person-group><year iso-8601-date="2017">2017a</year><article-title>Structure in neural population recordings: an expected byproduct of simpler phenomena?</article-title><source>Nature Neuroscience</source><volume>20</volume><fpage>1310</fpage><lpage>1318</lpage><pub-id pub-id-type="doi">10.1038/nn.4617</pub-id><pub-id pub-id-type="pmid">28783140</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Elsayed</surname><given-names>G</given-names></name><name><surname>Cunningham</surname><given-names>JP</given-names></name></person-group><year iso-8601-date="2017">2017b</year><data-title>rand_tensor</data-title><version designator="3fef2ee">3fef2ee</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/gamaleldin/rand_tensor">https://github.com/gamaleldin/rand_tensor</ext-link></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Emmons</surname><given-names>EB</given-names></name><name><surname>De Corte</surname><given-names>BJ</given-names></name><name><surname>Kim</surname><given-names>Y</given-names></name><name><surname>Parker</surname><given-names>KL</given-names></name><name><surname>Matell</surname><given-names>MS</given-names></name><name><surname>Narayanan</surname><given-names>NS</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Rodent Medial Frontal Control of Temporal Processing in the Dorsomedial Striatum</article-title><source>The Journal of Neuroscience</source><volume>37</volume><fpage>8718</fpage><lpage>8733</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1376-17.2017</pub-id><pub-id pub-id-type="pmid">28821670</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Engel</surname><given-names>TA</given-names></name><name><surname>Steinmetz</surname><given-names>NA</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>New perspectives on dimensionality and variability from large-scale cortical dynamics</article-title><source>Current Opinion in Neurobiology</source><volume>58</volume><fpage>181</fpage><lpage>190</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2019.09.003</pub-id><pub-id pub-id-type="pmid">31585331</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Genovesio</surname><given-names>A</given-names></name><name><surname>Tsujimoto</surname><given-names>S</given-names></name><name><surname>Wise</surname><given-names>SP</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Neuronal activity related to elapsed time in prefrontal cortex</article-title><source>Journal of Neurophysiology</source><volume>95</volume><fpage>3281</fpage><lpage>3285</lpage><pub-id pub-id-type="doi">10.1152/jn.01011.2005</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Genovesio</surname><given-names>A</given-names></name><name><surname>Seitz</surname><given-names>LK</given-names></name><name><surname>Tsujimoto</surname><given-names>S</given-names></name><name><surname>Wise</surname><given-names>SP</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Context-Dependent Duration Signals in the Primate Prefrontal Cortex</article-title><source>Cerebral Cortex</source><volume>26</volume><fpage>3345</fpage><lpage>3356</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhv156</pub-id><pub-id pub-id-type="pmid">26209845</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Glaser</surname><given-names>JI</given-names></name><name><surname>Benjamin</surname><given-names>AS</given-names></name><name><surname>Chowdhury</surname><given-names>RH</given-names></name><name><surname>Perich</surname><given-names>MG</given-names></name><name><surname>Miller</surname><given-names>LE</given-names></name><name><surname>Kording</surname><given-names>KP</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Machine Learning for Neural Decoding</article-title><source>ENeuro</source><volume>7</volume><elocation-id>ENEURO.0506-19.2020</elocation-id><pub-id pub-id-type="doi">10.1523/ENEURO.0506-19.2020</pub-id><pub-id pub-id-type="pmid">32737181</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gouvêa</surname><given-names>TS</given-names></name><name><surname>Monteiro</surname><given-names>T</given-names></name><name><surname>Motiwala</surname><given-names>A</given-names></name><name><surname>Soares</surname><given-names>S</given-names></name><name><surname>Machens</surname><given-names>C</given-names></name><name><surname>Paton</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Striatal dynamics explain duration judgments</article-title><source>eLife</source><volume>4</volume><elocation-id>e11386</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.11386</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heys</surname><given-names>JG</given-names></name><name><surname>Dombeck</surname><given-names>DA</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Evidence for a subcircuit in medial entorhinal cortex representing elapsed time during immobility</article-title><source>Nature Neuroscience</source><volume>21</volume><fpage>1574</fpage><lpage>1582</lpage><pub-id pub-id-type="doi">10.1038/s41593-018-0252-8</pub-id><pub-id pub-id-type="pmid">30349104</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hill</surname><given-names>DN</given-names></name><name><surname>Mehta</surname><given-names>SB</given-names></name><name><surname>Kleinfeld</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Quality metrics to accompany spike sorting of extracellular signals</article-title><source>The Journal of Neuroscience</source><volume>31</volume><fpage>8699</fpage><lpage>8705</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0971-11.2011</pub-id><pub-id pub-id-type="pmid">21677152</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hollingworth</surname><given-names>HL</given-names></name></person-group><year iso-8601-date="1910">1910</year><article-title>The central tendency of judgment</article-title><source>The Journal of Philosophy, Psychology and Scientific Methods</source><volume>10</volume><fpage>461</fpage><lpage>469</lpage></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Issa</surname><given-names>JB</given-names></name><name><surname>Tocker</surname><given-names>G</given-names></name><name><surname>Hasselmo</surname><given-names>ME</given-names></name><name><surname>Heys</surname><given-names>JG</given-names></name><name><surname>Dombeck</surname><given-names>DA</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Navigating Through Time: A Spatial Navigation Perspective on How the Brain May Encode Time</article-title><source>Annual Review of Neuroscience</source><volume>43</volume><fpage>73</fpage><lpage>93</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-101419-011117</pub-id><pub-id pub-id-type="pmid">31961765</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jazayeri</surname><given-names>M</given-names></name><name><surname>Shadlen</surname><given-names>MN</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Temporal context calibrates interval timing</article-title><source>Nature Neuroscience</source><volume>13</volume><fpage>1020</fpage><lpage>1026</lpage><pub-id pub-id-type="doi">10.1038/nn.2590</pub-id><pub-id pub-id-type="pmid">20581842</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jazayeri</surname><given-names>M</given-names></name><name><surname>Shadlen</surname><given-names>MN</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A Neural Mechanism for Sensing and Reproducing a Time Interval</article-title><source>Current Biology</source><volume>25</volume><fpage>2599</fpage><lpage>2609</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2015.08.038</pub-id><pub-id pub-id-type="pmid">26455307</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kautzky</surname><given-names>M</given-names></name><name><surname>Thurley</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Estimation of self-motion duration and distance in rodents</article-title><source>Royal Society Open Science</source><volume>3</volume><elocation-id>160118</elocation-id><pub-id pub-id-type="doi">10.1098/rsos.160118</pub-id><pub-id pub-id-type="pmid">27293792</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>J</given-names></name><name><surname>Ghim</surname><given-names>JW</given-names></name><name><surname>Lee</surname><given-names>JH</given-names></name><name><surname>Jung</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Neural correlates of interval timing in rodent prefrontal cortex</article-title><source>The Journal of Neuroscience</source><volume>33</volume><fpage>13834</fpage><lpage>13847</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1443-13.2013</pub-id><pub-id pub-id-type="pmid">23966703</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kobak</surname><given-names>D</given-names></name><name><surname>Brendel</surname><given-names>W</given-names></name><name><surname>Constantinidis</surname><given-names>C</given-names></name><name><surname>Feierstein</surname><given-names>CE</given-names></name><name><surname>Kepecs</surname><given-names>A</given-names></name><name><surname>Mainen</surname><given-names>ZF</given-names></name><name><surname>Qi</surname><given-names>XL</given-names></name><name><surname>Romo</surname><given-names>R</given-names></name><name><surname>Uchida</surname><given-names>N</given-names></name><name><surname>Machens</surname><given-names>CK</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Demixed principal component analysis of neural population data</article-title><source>eLife</source><volume>5</volume><elocation-id>e10989</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.10989</pub-id><pub-id pub-id-type="pmid">27067378</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Kobak</surname><given-names>D</given-names></name><name><surname>Brendel</surname><given-names>W</given-names></name><name><surname>Constantinidis</surname><given-names>C</given-names></name><name><surname>Feierstein</surname><given-names>CE</given-names></name><name><surname>Kepecs</surname><given-names>A</given-names></name><name><surname>Mainen</surname><given-names>ZF</given-names></name><name><surname>Qi</surname><given-names>XL</given-names></name><name><surname>Romo</surname><given-names>R</given-names></name><name><surname>Uchida</surname><given-names>N</given-names></name><name><surname>Machens</surname><given-names>CK</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>demixed Principal Component Analysis (dPCA)</data-title><version designator="v1.0.5">v1.0.5</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/machenslab/dPCA">https://github.com/machenslab/dPCA</ext-link></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>MacDonald</surname><given-names>CJ</given-names></name><name><surname>Lepage</surname><given-names>KQ</given-names></name><name><surname>Eden</surname><given-names>UT</given-names></name><name><surname>Eichenbaum</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Hippocampal “time cells” bridge the gap in memory for discontiguous events</article-title><source>Neuron</source><volume>71</volume><fpage>737</fpage><lpage>749</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2011.07.012</pub-id><pub-id pub-id-type="pmid">21867888</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meijer</surname><given-names>JH</given-names></name><name><surname>Robbers</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Wheel running in the wild</article-title><source>Proceedings. Biological Sciences</source><volume>281</volume><elocation-id>20140210</elocation-id><pub-id pub-id-type="doi">10.1098/rspb.2014.0210</pub-id><pub-id pub-id-type="pmid">24850923</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meirhaeghe</surname><given-names>N</given-names></name><name><surname>Sohn</surname><given-names>H</given-names></name><name><surname>Jazayeri</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>A precise and adaptive neural mechanism for predictive temporal processing in the frontal cortex</article-title><source>Neuron</source><volume>109</volume><fpage>2995</fpage><lpage>3011</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2021.08.025</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mello</surname><given-names>GBM</given-names></name><name><surname>Soares</surname><given-names>S</given-names></name><name><surname>Paton</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A Scalable Population Code for Time in the Striatum</article-title><source>Current Biology</source><volume>25</volume><fpage>1113</fpage><lpage>1122</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2015.02.036</pub-id><pub-id pub-id-type="pmid">25913405</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Merchant</surname><given-names>H</given-names></name><name><surname>Georgopoulos</surname><given-names>AP</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Neurophysiology of Perceptual and Motor Aspects of Interception</article-title><source>Journal of Neurophysiology</source><volume>95</volume><fpage>1</fpage><lpage>13</lpage><pub-id pub-id-type="doi">10.1152/jn.00422.2005</pub-id><pub-id pub-id-type="pmid">16339504</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Merchant</surname><given-names>H</given-names></name><name><surname>Zarco</surname><given-names>W</given-names></name><name><surname>Pérez</surname><given-names>O</given-names></name><name><surname>Prado</surname><given-names>L</given-names></name><name><surname>Bartolo</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Measuring time with different neural chronometers during a synchronization-continuation task</article-title><source>PNAS</source><volume>108</volume><fpage>19784</fpage><lpage>19789</lpage><pub-id pub-id-type="doi">10.1073/pnas.1112933108</pub-id><pub-id pub-id-type="pmid">22106292</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Merchant</surname><given-names>H</given-names></name><name><surname>Harrington</surname><given-names>DL</given-names></name><name><surname>Meck</surname><given-names>WH</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Neural basis of the perception and estimation of time</article-title><source>Annual Review of Neuroscience</source><volume>36</volume><fpage>313</fpage><lpage>336</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-062012-170349</pub-id><pub-id pub-id-type="pmid">23725000</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Merchant</surname><given-names>H</given-names></name><name><surname>Averbeck</surname><given-names>BB</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>The Computational and Neural Basis of Rhythmic Timing in Medial Premotor Cortex</article-title><source>The Journal of Neuroscience</source><volume>37</volume><fpage>4552</fpage><lpage>4564</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0367-17.2017</pub-id><pub-id pub-id-type="pmid">28336572</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mita</surname><given-names>A</given-names></name><name><surname>Mushiake</surname><given-names>H</given-names></name><name><surname>Shima</surname><given-names>K</given-names></name><name><surname>Matsuzaka</surname><given-names>Y</given-names></name><name><surname>Tanji</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Interval time coding by neurons in the presupplementary and supplementary motor areas</article-title><source>Nature Neuroscience</source><volume>12</volume><fpage>502</fpage><lpage>507</lpage><pub-id pub-id-type="doi">10.1038/nn.2272</pub-id><pub-id pub-id-type="pmid">19252498</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murakami</surname><given-names>M</given-names></name><name><surname>Vicente</surname><given-names>MI</given-names></name><name><surname>Costa</surname><given-names>GM</given-names></name><name><surname>Mainen</surname><given-names>ZF</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Neural antecedents of self-initiated actions in secondary motor cortex</article-title><source>Nature Neuroscience</source><volume>17</volume><fpage>1574</fpage><lpage>1582</lpage><pub-id pub-id-type="doi">10.1038/nn.3826</pub-id><pub-id pub-id-type="pmid">25262496</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murakami</surname><given-names>M</given-names></name><name><surname>Shteingart</surname><given-names>H</given-names></name><name><surname>Loewenstein</surname><given-names>Y</given-names></name><name><surname>Mainen</surname><given-names>ZF</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Distinct Sources of Deterministic and Stochastic Components of Action Timing Decisions in Rodent Frontal Cortex</article-title><source>Neuron</source><volume>94</volume><fpage>908</fpage><lpage>919</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.04.040</pub-id><pub-id pub-id-type="pmid">28521140</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Opstal</surname><given-names>FV</given-names></name><name><surname>Verguts</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Is there a generalized magnitude system in the brain? behavioral, neuroimaging, and computational evidence</article-title><source>Frontiers in Psychology</source><volume>4</volume><elocation-id>435</elocation-id><pub-id pub-id-type="doi">10.3389/fpsyg.2013.00435</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paton</surname><given-names>JJ</given-names></name><name><surname>Buonomano</surname><given-names>DV</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>The Neural Basis of Timing: Distributed Mechanisms for Diverse Functions</article-title><source>Neuron</source><volume>98</volume><fpage>687</fpage><lpage>705</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2018.03.045</pub-id><pub-id pub-id-type="pmid">29772201</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Petzschner</surname><given-names>FH</given-names></name><name><surname>Glasauer</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Iterative Bayesian Estimation as an Explanation for Range and Regression Effects: A Study on Human Path Integration</article-title><source>Journal of Neuroscience</source><volume>31</volume><fpage>17220</fpage><lpage>17229</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2028-11.2011</pub-id><pub-id pub-id-type="pmid">22114288</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Petzschner</surname><given-names>FH</given-names></name><name><surname>Glasauer</surname><given-names>S</given-names></name><name><surname>Stephan</surname><given-names>KE</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A bayesian perspective on magnitude estimation</article-title><source>Trends Cogn Sci</source><volume>19</volume><fpage>285</fpage><lpage>293</lpage><pub-id pub-id-type="doi">10.1016/j.tics.2015.03.002</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Radtke-Schuller</surname><given-names>S</given-names></name><name><surname>Schuller</surname><given-names>G</given-names></name><name><surname>Angenstein</surname><given-names>F</given-names></name><name><surname>Grosser</surname><given-names>OS</given-names></name><name><surname>Goldschmidt</surname><given-names>J</given-names></name><name><surname>Budinger</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Brain atlas of the Mongolian gerbil (Meriones unguiculatus) in CT/MRI-aided stereotaxic coordinates</article-title><source>Brain Structure and Function</source><volume>221</volume><fpage>1</fpage><lpage>272</lpage><pub-id pub-id-type="doi">10.1007/s00429-016-1259-0</pub-id><pub-id pub-id-type="pmid">27507296</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Remington</surname><given-names>ED</given-names></name><name><surname>Narain</surname><given-names>D</given-names></name><name><surname>Hosseini</surname><given-names>EA</given-names></name><name><surname>Jazayeri</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Flexible Sensorimotor Computations through Rapid Reconfiguration of Cortical Dynamics</article-title><source>Neuron</source><volume>98</volume><fpage>1005</fpage><lpage>1019</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2018.05.020</pub-id><pub-id pub-id-type="pmid">29879384</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rigotti</surname><given-names>M</given-names></name><name><surname>Barak</surname><given-names>O</given-names></name><name><surname>Warden</surname><given-names>MR</given-names></name><name><surname>Wang</surname><given-names>XJ</given-names></name><name><surname>Daw</surname><given-names>ND</given-names></name><name><surname>Miller</surname><given-names>EK</given-names></name><name><surname>Fusi</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The importance of mixed selectivity in complex cognitive tasks</article-title><source>Nature</source><volume>497</volume><fpage>585</fpage><lpage>590</lpage><pub-id pub-id-type="doi">10.1038/nature12160</pub-id><pub-id pub-id-type="pmid">23685452</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saleem</surname><given-names>AB</given-names></name><name><surname>Ayaz</surname><given-names>A</given-names></name><name><surname>Jeffery</surname><given-names>KJ</given-names></name><name><surname>Harris</surname><given-names>KD</given-names></name><name><surname>Carandini</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Integration of visual motion and locomotion in mouse visual cortex</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>1864</fpage><lpage>1869</lpage><pub-id pub-id-type="doi">10.1038/nn.3567</pub-id><pub-id pub-id-type="pmid">24185423</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schmitzer-Torbert</surname><given-names>N</given-names></name><name><surname>Jackson</surname><given-names>J</given-names></name><name><surname>Henze</surname><given-names>D</given-names></name><name><surname>Harris</surname><given-names>K</given-names></name><name><surname>Redish</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Quantitative measures of cluster quality for use in extracellular recordings</article-title><source>Neuroscience</source><volume>131</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1016/j.neuroscience.2004.09.066</pub-id><pub-id pub-id-type="pmid">15680687</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shankar</surname><given-names>S</given-names></name><name><surname>Ellard</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Visually guided locomotion and computation of time-to-collision in the mongolian gerbil (Meriones unguiculatus): the effects of frontal and visual cortical lesions</article-title><source>Behavioural Brain Research</source><volume>108</volume><fpage>21</fpage><lpage>37</lpage><pub-id pub-id-type="doi">10.1016/s0166-4328(99)00131-x</pub-id><pub-id pub-id-type="pmid">10680754</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shi</surname><given-names>Z</given-names></name><name><surname>Church</surname><given-names>RM</given-names></name><name><surname>Meck</surname><given-names>WH</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Bayesian optimization of time perception</article-title><source>Trends in Cognitive Sciences</source><volume>17</volume><fpage>556</fpage><lpage>564</lpage><pub-id pub-id-type="doi">10.1016/j.tics.2013.09.009</pub-id><pub-id pub-id-type="pmid">24139486</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Siegle</surname><given-names>J</given-names></name><name><surname>Myroshnychenko</surname><given-names>M</given-names></name><name><surname>Jia</surname><given-names>X</given-names></name><name><surname>Graddis</surname><given-names>N</given-names></name><name><surname>Li</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>ecephys spike sorting</data-title><version designator="v0.2">v0.2</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/AllenInstitute/ecephys_spike_sorting">https://github.com/AllenInstitute/ecephys_spike_sorting</ext-link></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Simen</surname><given-names>P</given-names></name><name><surname>Balci</surname><given-names>F</given-names></name><name><surname>de Souza</surname><given-names>L</given-names></name><name><surname>Cohen</surname><given-names>JD</given-names></name><name><surname>Holmes</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A model of interval timing by neural integration</article-title><source>The Journal of Neuroscience</source><volume>31</volume><fpage>9238</fpage><lpage>9253</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3121-10.2011</pub-id><pub-id pub-id-type="pmid">21697374</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sohn</surname><given-names>H</given-names></name><name><surname>Narain</surname><given-names>D</given-names></name><name><surname>Meirhaeghe</surname><given-names>N</given-names></name><name><surname>Jazayeri</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Bayesian Computation through Cortical Latent Dynamics</article-title><source>Neuron</source><volume>103</volume><fpage>934</fpage><lpage>947</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2019.06.012</pub-id><pub-id pub-id-type="pmid">31320220</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steinmetz</surname><given-names>NA</given-names></name><name><surname>Zatka-Haas</surname><given-names>P</given-names></name><name><surname>Carandini</surname><given-names>M</given-names></name><name><surname>Harris</surname><given-names>KD</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Distributed coding of choice, action and engagement across the mouse brain</article-title><source>Nature</source><volume>576</volume><fpage>266</fpage><lpage>273</lpage><pub-id pub-id-type="doi">10.1038/s41586-019-1787-x</pub-id><pub-id pub-id-type="pmid">31776518</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stringer</surname><given-names>C</given-names></name><name><surname>Pachitariu</surname><given-names>M</given-names></name><name><surname>Steinmetz</surname><given-names>N</given-names></name><name><surname>Reddy</surname><given-names>CB</given-names></name><name><surname>Carandini</surname><given-names>M</given-names></name><name><surname>Harris</surname><given-names>KD</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Spontaneous behaviors drive multidimensional, brainwide activity</article-title><source>Science</source><volume>364</volume><elocation-id>255</elocation-id><pub-id pub-id-type="doi">10.1126/science.aav7893</pub-id><pub-id pub-id-type="pmid">31000656</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thurley</surname><given-names>K</given-names></name><name><surname>Henke</surname><given-names>J</given-names></name><name><surname>Hermann</surname><given-names>J</given-names></name><name><surname>Ludwig</surname><given-names>B</given-names></name><name><surname>Tatarau</surname><given-names>C</given-names></name><name><surname>Wätzig</surname><given-names>A</given-names></name><name><surname>Herz</surname><given-names>AVM</given-names></name><name><surname>Leibold</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Mongolian gerbils learn to navigate in complex virtual spaces</article-title><source>Behavioural Brain Research</source><volume>266</volume><fpage>161</fpage><lpage>168</lpage><pub-id pub-id-type="doi">10.1016/j.bbr.2014.03.007</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thurley</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Magnitude Estimation with Noisy Integrators Linked by an Adaptive Reference</article-title><source>Frontiers in Integrative Neuroscience</source><volume>10</volume><elocation-id>6</elocation-id><pub-id pub-id-type="doi">10.3389/fnint.2016.00006</pub-id><pub-id pub-id-type="pmid">26909028</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thurley</surname><given-names>K</given-names></name><name><surname>Ayaz</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Virtual reality systems for rodents</article-title><source>Current Zoology</source><volume>63</volume><fpage>109</fpage><lpage>119</lpage><pub-id pub-id-type="doi">10.1093/cz/zow070</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tiganj</surname><given-names>Z</given-names></name><name><surname>Jung</surname><given-names>MW</given-names></name><name><surname>Kim</surname><given-names>J</given-names></name><name><surname>Howard</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Sequential firing codes for time in rodent medial prefrontal cortex</article-title><source>Cerebral Cortex</source><volume>27</volume><fpage>5663</fpage><lpage>5671</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhw336</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>von Vierordt</surname><given-names>K</given-names></name></person-group><year iso-8601-date="1868">1868</year><source>Der Zeitsinn Nach Versuchen</source><publisher-name>Laupp</publisher-name></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Narain</surname><given-names>D</given-names></name><name><surname>Hosseini</surname><given-names>EA</given-names></name><name><surname>Jazayeri</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Flexible timing by temporal scaling of cortical responses</article-title><source>Nature Neuroscience</source><volume>21</volume><fpage>102</fpage><lpage>110</lpage><pub-id pub-id-type="doi">10.1038/s41593-017-0028-6</pub-id><pub-id pub-id-type="pmid">29203897</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>M</given-names></name><name><surname>Zhang</surname><given-names>S</given-names></name><name><surname>Dan</surname><given-names>Y</given-names></name><name><surname>Poo</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Representation of interval timing by temporally scalable firing patterns in rat prefrontal cortex</article-title><source>PNAS</source><volume>111</volume><fpage>480</fpage><lpage>485</lpage><pub-id pub-id-type="doi">10.1073/pnas.1321314111</pub-id><pub-id pub-id-type="pmid">24367075</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.71612.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Merchant</surname><given-names>Hugo</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution>National Autonomous University of Mexico</institution><country>Mexico</country></aff></contrib></contrib-group></front-stub><body><p>This study investigates the neural underpinnings of the bias property of timing, namely an overestimation for short and underestimation for long intervals, during an interval reproduction task in the medial prefrontal cortex of gerbils. The key novel result is that only neural populations with mixed responses, including ramping activity with linear increasing and slope-changing modulations as a function of reproduced durations, can encode the bias effect. Overall, experiments and data analysis are technically sound, and the conclusions well supported.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.71612.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Merchant</surname><given-names>Hugo</given-names></name><role>Reviewing Editor</role><aff><institution>National Autonomous University of Mexico</institution><country>Mexico</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Merchant</surname><given-names>Hugo</given-names></name><role>Reviewer</role><aff><institution>National Autonomous University of Mexico</institution><country>Mexico</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="box1"><p>Our editorial process produces two outputs: (i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2020.04.02.021287">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2020.04.02.021287v2">the preprint</ext-link> for the benefit of readers; (ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Distributed coding of stimulus magnitude in rodent prefrontal cortex&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, including Hugo Merchant as Reviewing Editor and Reviewer #1, and the evaluation has been overseen by Michael Frank as the Senior Editor.</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>1) The main weakness of the paper is a conceptual problem, which requires clarification. Both the title and the introduction point to magnitude quantification, which in general exhibits the regression effect (Vierordt's law). Interval timing is certainly a form of magnitude quantification and exhibits the regression effect. However, any neural correlate of the regression effect in interval timing does not necessarily generalizes to other forms of magnitude quantification. The way the findings of this paper are framed in the title, abstract, introduction, and discussion seem to make that generalization, and that claim is not supported because the data shown has a narrower scope.</p><p>2) It is necessary to clearly demonstrate that the behavioral protocol produces a robust, reliable time interval reproduction. Is also fundamental to provide a valid justification for such low levels of performance. It is especially important to clarify this point before analyzing the potentially associated neuronal activity. It is important to understand how stable the behavior is in a session-by-session base. We suggest including a full description of the learning curve. This point is especially relevant for the population analysis, where the activity of cells collected in different sessions was pooled together. In addition, it's well known that in behavioral protocols like this, behavior tend to stereotype, making it difficult to determine if the neural activity is associated with a particular behavioral variable (such as speed or distance) or elapsed time. Hence, it would be necessary to formally assess how behavioral variables covariate (or not) with time. For this, examples of single sessions are not sufficient. It is necessary to clarify several things. For example, the slopes of the linear regressions for dozens of sessions are presented (Figure 1E) but is not clear if there was a behavioral evolution over the training. For another example, animal 10526 presented high levels of variability in many variables (Figure S2), hence, it would be important to know which sessions were used for the analysis of the neural data.</p><p>3) A main conclusion of the paper is that only neural populations with mixed responses, including ramping activity with linear increasing and slope-changing modulations as a function of reproduced durations, can encode the regression effect. How the prior knowledge about the distribution of used intervals in the task is combined with the actual measurement of the passage of time? It is not evident on the last part of the paper how the slope changing cells, associated with a prior signal, are combined with the linearly increasing ramping cells to generate both the regression effect and a sufficiently accurate representation of produced duration. Sessions within the same animal with different slopes in the regression effect show different proportions of the two cell types? How is the mixing accomplished?</p><p>4) During reproduction, the percent of neurons categorized with time-dependent PC 1 and stimulus PC 1 responses is &lt; 1%, which is one of the two combinations that gives the best regression effect in the decoding. These linearly increasing ramping cells were very common during measurement and may be encoding elapsed time since the stimulus onset. In contrast, most of the responses in reproduction were slope changing cells, reaching a peak of activation close to the end of the produced interval. This type of responses has been observed when a prediction of time to an event is needed (time-to-contact cells Merchant and Georgopoulos, 2006). A key issue, then, is whether the decoding method used to reconstruct elapsed time is capturing the prediction to an event signal as a regression effect because is aligned to the onset of the time interval, instead of to the end of the produced interval, which is probably the task event that the cells are encoding.</p><p>5) The authors say the conventional PCA did not show curved trajectories (line 418, Discussion, Pg. 17) for the measuring phase. However, that is certainly not the case for the reproduction phase, where the decoding analysis was successfully performed, and the regression effect was observed. I don't see the present results as alternative to the hypothesis by Sohn et al., 2019., but as a quite interesting step forward from that. It is possible that what the PFC is encoding in this task is an estimate of when to stop moving. In that case, the neural activity would be equivalent to that observed in Sohn et al., 2019. And perhaps warped and transformed by down-stream reading areas similarly to the &quot;curved manifold projected onto a line&quot;. It would be very interesting if slope-changing cells were contributing to a more curved shape of the population trajectory, since they can be encoding a prior as the authors suggest. The results of the decoding analysis which uses a linear (i.e. lower dimensional) decoder indirectly suggest this.</p><p>6) Despite the clear differences in neural activity between the two phases presented in figures 2 to 4, authors named the following section &quot;Population activity shares similar components for measurement and reproduction&quot; (page 8 line 58). However, that entire section, that includes figures 5 and 6 and several supplementary figures (e.g. S8 and S9), shows notorious differences between the two phases. From the explained variance (Figures 5, S8, S9) to how single cell activity contributes to the population representations, there are striking differences between the two behavioral phases. Authors must clarify what do they mean by &quot;activity shares similar components&quot; or change the name of the section for something that better represents the data.</p><p>7) Elapsed time decoding from populations of cells using classifiers suggest that different ramping cell types can contribute to represent the passages of time and that the decoding error can explain the error in produced interval (Merchant and Averbeck, 2017; Bakhurin et al., 2017). Based on this and the previous comment I am wondering whether a classifier is not a better option for decoding than the linear decoder.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.71612.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) The main weakness of the paper is a conceptual problem, which requires clarification. Both the title and the introduction point to magnitude quantification, which in general exhibits the regression effect (Vierordt's law). Interval timing is certainly a form of magnitude quantification and exhibits the regression effect. However, any neural correlate of the regression effect in interval timing does not necessarily generalizes to other forms of magnitude quantification. The way the findings of this paper are framed in the title, abstract, introduction, and discussion seem to make that generalization, and that claim is not supported because the data shown has a narrower scope.</p></disp-quote><p>We agree that our findings in particular with regard to the neural correlates are more in the scope of interval timing. Therefore, we have toned down the emphasis on magnitude quantification in connection with our findings and now take a stronger interval timing/reproduction perspective. We changed the title and edited abstract, introduction, results and discussion.</p><disp-quote content-type="editor-comment"><p>2) It is necessary to clearly demonstrate that the behavioral protocol produces a robust, reliable time interval reproduction. Is also fundamental to provide a valid justification for such low levels of performance. It is especially important to clarify this point before analyzing the potentially associated neuronal activity. It is important to understand how stable the behavior is in a session-by-session base. We suggest including a full description of the learning curve. This point is especially relevant for the population analysis, where the activity of cells collected in different sessions was pooled together.</p></disp-quote><p>The gerbils display very well and reliable time reproduction behavior in our experiments. Task performance of the gerbils in our behavioral paradigm is comparable to previous studies conducted with humans and non-human primates on time interval reproduction (Jazayeri and Shadlen 2010 <italic>Nature Neuroscience,</italic> Jazayeri and Shadlen 2015 <italic>Current Biology</italic> and Sohn et al., 2019 <italic>Neuron</italic>). This is indicated by the slope of the linear fit between stimulus interval and reproduced interval being between 0.5 and 1, and by the small coefficients of variation (CV) being below 0.2 on average. In own time reproduction experiments with humans, performance levels were similar (Thurley and Schild 2018 <italic>Sci Rep</italic>).</p><p>To better illustrate the behavioral performance, we now plot the development of slope and coefficient of variation across sessions for each animal in Figure 1—figure supplement 2D. In these plots we also include the final training sessions, when we started presenting the whole stimulus distribution. An ongoing improvement can be seen for each animal during training. Data at even earlier stages of training are not included in the plot, since these were not tracked systematically. Training data did not appear in the earlier version of the manuscript and only does in Figure 1—figure supplement 2D now.</p><p>The impression of “low levels of performance” most likely stems from the “percentage of hits” in each session that we presented in former Figure S2B. Hits in our paradigm can not be interpreted as for binary decision tasks, this means that 50% performance does not correspond to chance performance.</p><p>We used an adaptive feedback protocol to decide whether a reproduced interval is close enough to the stimulus interval and hence rewarded or not. Rewarding is necessary to keep the animals motivated. However, if rewards would always be given at a fixed distance off the stimulus, e.g. 15%, the animals could learn to reproduce 15% shorter intervals than the stimulus interval. Adaptive feedback avoids this situation as the distance from stimulus that needs to be reached to receive a reward changes with every (non-)rewarded trial. Effectively, rewards will be given in only a bit more than 50% of the trials. See the following papers that used a similar feedback protocol:</p><p>Jazayeri and Shadlen 2010 <italic>Nature Neuroscience</italic>: “As such, every subject’s performance for every session yielded approximately 50% positively reinforced trials.”</p><p>Jazayeri and Shadlen 2015 <italic>Current Biology</italic>: “The scaling constant was adjusted so that approximately 60% of trials were rewarded.”</p><p>We understand that the term “hits” is misleading, so we now use “rewards” instead (Figure 1—figure supplement 2B).</p><disp-quote content-type="editor-comment"><p>In addition, it's well known that in behavioral protocols like this, behavior tend to stereotype, making it difficult to determine if the neural activity is associated with a particular behavioral variable (such as speed or distance) or elapsed time. Hence, it would be necessary to formally assess how behavioral variables covariate (or not) with time. For this, examples of single sessions are not sufficient. It is necessary to clarify several things. For example, the slopes of the linear regressions for dozens of sessions are presented (Figure 1E) but is not clear if there was a behavioral evolution over the training. For another example, animal 10526 presented high levels of variability in many variables (Figure S2), hence, it would be important to know which sessions were used for the analysis of the neural data.</p></disp-quote><p>All behavioral data reported is from the sessions in which also recordings were performed, except for the new Figure 1—figure supplement 2D in which we now also present behavioral data from the final training sessions. No data from training sessions is used in the paper at any other point.</p><p>We always excluded sessions with too low performance from the data set. In the revision, we reconsidered behavioral performance and decided to exclude another 4 border-line sessions. Our data set now includes 1766 cells recorded in 101 sessions.</p><p>We randomly changed the gain between virtual movement and treadmill movement in every trial. This efficiently decorrelates time and distance (stimulus interval and path length, Figure 1—figure supplement 1C, formerly Figure S1C). This is a typical procedure to enforce time reproduction and avoid e.g. distance reproduction as an alternative strategy for task solving in virtual reality experiments (e.g. Petzschner and Glasauer 2011 <italic>J Neurosci</italic>, Thurley and Schild 2018 <italic>Sci Rep</italic>, Robinson and Wiener 2021 <italic>NeuroImage</italic>). Since neural responses may nevertheless be related to, running speed, we extended the analysis in this respect.</p><disp-quote content-type="editor-comment"><p>3) A main conclusion of the paper is that only neural populations with mixed responses, including ramping activity with linear increasing and slope-changing modulations as a function of reproduced durations, can encode the regression effect. How the prior knowledge about the distribution of used intervals in the task is combined with the actual measurement of the passage of time? It is not evident on the last part of the paper how the slope changing cells, associated with a prior signal, are combined with the linearly increasing ramping cells to generate both the regression effect and a sufficiently accurate representation of produced duration. Sessions within the same animal with different slopes in the regression effect show different proportions of the two cell types? How is the mixing accomplished?</p></disp-quote><p>This is a very interesting question! We do not have a specific mechanistic hypothesis as to how the mixing occurs, but we also do not think we can tell from our data. Our data and analyses in Figure 7F only indicates that mixing linear increasing and slope-changing cells at different fractions allows for parameterizing the strength of the regression effect. How mixing is accomplished, we can not directly tell from the present experiments, but we want to explore this question in future work.</p><p>We are also hesitant to draw direct conclusions from our data about the relationship between the proportions of active cell types and the regression effect in a given session. Our recording technique only allowed the recording of different cells in each session due to changes of electrode position between sessions. Cell numbers and types most likely depend on the specific subset of cells we were able to recorded rather than on a potentially dynamic recruitment of cells in each session.</p><p>A conclusive experiment would need to systematically record from the same cells across several sessions with changing strength of the regression effect.</p><p>We now explicitly point out in the Discussion that “we can not tell from our data how mixing is accomplished”.</p><disp-quote content-type="editor-comment"><p>4) During reproduction, the percent of neurons categorized with time-dependent PC 1 and stimulus PC 1 responses is &lt; 1%, which is one of the two combinations that gives the best regression effect in the decoding. These linearly increasing ramping cells were very common during measurement and may be encoding elapsed time since the stimulus onset. In contrast, most of the responses in reproduction were slope changing cells, reaching a peak of activation close to the end of the produced interval. This type of responses has been observed when a prediction of time to an event is needed (time-to-contact cells Merchant and Georgopoulos, 2006). A key issue, then, is whether the decoding method used to reconstruct elapsed time is capturing the prediction to an event signal as a regression effect because is aligned to the onset of the time interval, instead of to the end of the produced interval, which is probably the task event that the cells are encoding.</p></disp-quote><p>Indeed, decoding from slope-changing cells allows to predict the final time point in the reproduction interval (time to event, time to contact) precisely. We tested this training a classifier to differentiate between the final time bin of reproduction versus all other time bins (25 bins in total) for data aligned at the end of the time interval. This shows that the slope-changing cells contain information about the “contact” to the final time point. However, this does not translate into the (behavioral) regression effect if one tries to decode elapsed time from the same cells. As we show in Figure 7C, the readout from slope-changing cells will be the same final time point for all stimulus durations, i.e. regression slope = 0. The insight we gained from our decoding analyses is that in order to explain the milder regression slopes observed behaviorally, slope-changing and linear-increasing cells need to be readout together. We emphasize this in the Discussion now.</p><disp-quote content-type="editor-comment"><p>5) The authors say the conventional PCA did not show curved trajectories (line 418, Discussion, Pg. 17) for the measuring phase. However, that is certainly not the case for the reproduction phase, where the decoding analysis was successfully performed, and the regression effect was observed. I don't see the present results as alternative to the hypothesis by Sohn et al., 2019., but as a quite interesting step forward from that. It is possible that what the PFC is encoding in this task is an estimate of when to stop moving. In that case, the neural activity would be equivalent to that observed in Sohn et al., 2019. And perhaps warped and transformed by down-stream reading areas similarly to the &quot;curved manifold projected onto a line&quot;. It would be very interesting if slope-changing cells were contributing to a more curved shape of the population trajectory, since they can be encoding a prior as the authors suggest. The results of the decoding analysis which uses a linear (i.e. lower dimensional) decoder indirectly suggest this.</p></disp-quote><p>We also performed demixed and conventional PCA only with specific response types. Since we determined response types from the principal components in the whole data set, restriction to or exclusion from certain response types means focusing or removing the related principal components.</p><p>The slope-changing cells contribute mostly a monotonous change (PC 1 in Figure 5B). This monotonous change is not completely linear and hence contributes to a curved shape of the population trajectory. The most important contribution to the trajectory, however, is the monotonous change. In combination with the non-monotonous PC 2 it results in a smooth and curved population trajectory. If we remove all cells with a slope-changing component, i.e. all response types with a contribution of PC 1, PC 2 and 3 become dominant. Since both PC 2 and PC 3 are non-monotonous they form a tangled population trajectory. From that we conclude that a slope-changing component is essential for a smooth, untangled but curved population trajectory that could support the regression effect as suggested by Sohn et al., 2019.</p><p>We added the above insights to the discussion. We also agree with the reviewers that our results do not represent an alternative to Sohn et al., 2019 and have therefore refined and tempered the discussion in this regard.</p><disp-quote content-type="editor-comment"><p>6) Despite the clear differences in neural activity between the two phases presented in figures 2 to 4, authors named the following section &quot;Population activity shares similar components for measurement and reproduction&quot; (page 8 line 58). However, that entire section, that includes figures 5 and 6 and several supplementary figures (e.g. S8 and S9), shows notorious differences between the two phases. From the explained variance (Figures 5, S8, S9) to how single cell activity contributes to the population representations, there are striking differences between the two behavioral phases. Authors must clarify what do they mean by &quot;activity shares similar components&quot; or change the name of the section for something that better represents the data.</p></disp-quote><p>We agree that the subsection’s title was not appropriate and changed it to “Collective population activity in the different task phases”. We also changed the descriptions in the paragraph to more strongly emphasize the similarities and differences in collective activity between the two task phases.</p><disp-quote content-type="editor-comment"><p>7) Elapsed time decoding from populations of cells using classifiers suggest that different ramping cell types can contribute to represent the passages of time and that the decoding error can explain the error in produced interval (Merchant and Averbeck, 2017; Bakhurin et al., 2017). Based on this and the previous comment I am wondering whether a classifier is not a better option for decoding than the linear decoder.</p></disp-quote><p>We performed decoding analyses using a support-vector machine classifier (Bakhurin et al., 2017) implemented in Glaser et al., 2020, <ext-link ext-link-type="uri" xlink:href="https://github.com/kordinglab/neural_decoding">https://github.com/kordinglab/neural_decoding</ext-link>. Indeed, with such a classifier one could decode elapsed time much more veridical than with a linear regression decoder. We show in <xref ref-type="fig" rid="sa2fig1">Author response image 1</xref>, a variant of Figure 7 from the main text in which we (1) split 7.5 s of real time into 25 bins and (2) decoded time with a support-vector machine classifier.</p><fig id="sa2fig1" position="float"><label>Author response image 1.</label><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71612-sa2-fig1-v2.tif"/></fig><p>The readout was similar whether decoding was done from all data (A), linear increasing cells (B), or slope-changing cells (C). Final values of decoded time displayed large slopes indicating veridical values close to real time (D). For slope-changing cells decoding deviated markedly from theoretical prediction (C). This is likely due to the classifier exploiting subtle differences (partly random and due to noise) between recorded cells for decoding time. This also explains the overall better decoding performance of a classifier compared to a linear regression decoder. Despite its lower performance, in our view, the insight gained from a linear regression decoder with respect to the nature of the regression effect is larger than from a classifier. Also the mechanistic interpretation is different. A linear regression decoder may be implemented by a readout unit receiving continuous inputs and decoding elapsed time. A classifier would correspond to several readout units decoding a different time point each.</p><p>We extended the Discussion by this aspect but we did not include the figure above into the manuscript.</p></body></sub-article></article>