<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.2" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">68699</article-id><article-id pub-id-type="doi">10.7554/eLife.68699</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Cancer Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Genetics and Genomics</subject></subj-group></article-categories><title-group><article-title>Multi-syndrome, multi-gene risk modeling for individuals with a family history of cancer with the novel R package PanelPRO</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" id="author-233226"><name><surname>Lee</surname><given-names>Gavin</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2659-1163</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-233290"><name><surname>Liang</surname><given-names>Jane W</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2302-3809</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-233291"><name><surname>Zhang</surname><given-names>Qing</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-233292"><name><surname>Huang</surname><given-names>Theodore</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-233293"><name><surname>Choirat</surname><given-names>Christine</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-233294"><name><surname>Parmigani</surname><given-names>Giovanni</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-231703"><name><surname>Braun</surname><given-names>Danielle</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5177-8598</contrib-id><email>bmendel@jimmy.harvard.edu</email><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>Swiss Data Science Center, ETH Zürich and EPFL</institution><addr-line><named-content content-type="city">Lausanne</named-content></addr-line><country>Switzerland</country></aff><aff id="aff2"><label>2</label><institution>Department of Biostatistics, Harvard T.H. Chan School of Public Health</institution><addr-line><named-content content-type="city">Boston</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution>Department of Data Sciences, Dana-Farber Cancer Institute</institution><addr-line><named-content content-type="city">Boston</named-content></addr-line><country>United States</country></aff><aff id="aff4"><label>4</label><institution>Broad Institute of MIT and Harvard</institution><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Narla</surname><given-names>Goutham</given-names></name><role>Reviewing Editor</role><aff><institution>University of Michigan</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Franco</surname><given-names>Eduardo</given-names></name><role>Senior Editor</role><aff><institution>McGill University</institution><country>Canada</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>18</day><month>08</month><year>2021</year></pub-date><pub-date pub-type="collection"><year>2021</year></pub-date><volume>10</volume><elocation-id>e68699</elocation-id><history><date date-type="received" iso-8601-date="2021-03-24"><day>24</day><month>03</month><year>2021</year></date><date date-type="accepted" iso-8601-date="2021-08-16"><day>16</day><month>08</month><year>2021</year></date></history><permissions><copyright-statement>© 2021, Lee et al</copyright-statement><copyright-year>2021</copyright-year><copyright-holder>Lee et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-68699-v2.pdf"/><related-article ext-link-type="doi" id="ra1" related-article-type="commentary" xlink:href="10.7554/eLife.73380"/><abstract><p>Identifying individuals who are at high risk of cancer due to inherited germline mutations is critical for effective implementation of personalized prevention strategies. Most existing models focus on a few specific syndromes; however, recent evidence from multi-gene panel testing shows that many syndromes are overlapping, motivating the development of models that incorporate family history on several cancers and predict mutations for a comprehensive panel of genes.</p><p>We present PanelPRO, a new, open-source R package providing a fast, flexible back-end for multi-gene, multi-cancer risk modeling with pedigree data. It includes a customizable database with default parameter values estimated from published studies and allows users to select any combinations of genes and cancers for their models, including well-established single syndrome BayesMendel models (BRCAPRO and MMRPRO). This leads to more accurate risk predictions and ultimately has a high impact on prevention strategies for cancer and clinical decision making. The package is available for download for research purposes at <ext-link ext-link-type="uri" xlink:href="https://projects.iq.harvard.edu/bayesmendel/panelpro">https://projects.iq.harvard.edu/bayesmendel/panelpro</ext-link>.</p></abstract><abstract abstract-type="executive-summary"><title>eLife digest</title><p>Genetic mutations that increase cancer risk can be passed down from parents to their children, which can affect families across many generations. In these families, multiple members may be affected by different types of cancer, and these cancers often develop at an early age. Unaffected family members are often referred to genetic counselling, where they can explore their own risk of cancer. Clinicians and genetic counselors can provide recommendations to minimize cancer risk and inform personal choices on how to manage that risk, such as opting for preventative surgeries or participating in regular screening.</p><p>In genetic counselling sessions, highly trained clinicians and specialists use software that takes an individual’s family history of cancer and uses it to estimate their individual risk of carrying certain genetic mutations. These estimates can in turn help to predict their future risk of cancer. Many existing software packages are limited to estimating risks based on mutations in well-known cancer-related genes, such as <italic>BRCA1</italic> and <italic>BRCA2</italic> in breast and ovarian cancer. However, emerging evidence suggests that many of the genes associated with cancer risk work as part of a complex and overlapping network. Since current risk-profiling software packages are only designed to consider such genes in isolation, they cannot generate the most robust, accurate or comprehensive cancer risk profiles.</p><p>To address this challenge, Lee, Liang et al. have developed a new risk-profiling software that can integrate a large number of gene mutations and a wide range of potential cancer types to provide more accurate estimates of individual cancer risk. This software, called PanelPRO, uses evidence identified from extensive literature reviews to model the complex interplay between genes and cancer risk. The software not only calculates risks based on known genes, but also allows other developers to integrate new cancer-related genes that may be identified in the future. Importantly, the software is compatible with genetic counselling applications, since it returns answers within seconds when reasonable family and gene database sizes are used.</p><p>PanelPRO is a new, modern, flexible and efficient software package that provides an important advance towards modelling the vast genetic and biological complexity that contributes to inherited cancer risk. This software is designed to provide a more accurate and comprehensive estimate of cancer risk for individuals with family histories of cancer.</p><p>As an open-source software, it is freely available for research purposes, and can be licensed by software companies and healthcare organizations to integrate electronic patient records and rapidly identify at-risk individuals across larger patient groups. Ultimately, this software has the potential to improve cancer prevention strategies and optimize the personalized decision-making processes around cancer risk.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>mendelian modeling</kwd><kwd>cancer risk</kwd><kwd>statistical software</kwd><kwd>pedigree data</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>5T32CA009337</award-id><principal-award-recipient><name><surname>Liang</surname><given-names>Jane W</given-names></name><name><surname>Huang</surname><given-names>Theodore</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>2T32CA009001</award-id><principal-award-recipient><name><surname>Huang</surname><given-names>Theodore</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>4P30CA006516</award-id><principal-award-recipient><name><surname>Parmigani</surname><given-names>Giovanni</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A comprehensive package for pedigree-based risk modeling, with a highly optimized computational back-end, extends existing models beyond syndrome-specific approaches and incorporates data from panel studies by allowing for an arbitrary number of gene and syndrome associations.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>In the last decade, DNA sequencing has changed dramatically. Tests have become faster and more affordable, leading to discovery of a growing number of germline pathogenic variants associated with increased cancer risk. Multi-gene panels are routinely available and include varying combinations of genes (<xref ref-type="bibr" rid="bib26">Plichta et al., 2016</xref>). Evidence is accruing that gene mutations, which were typically believed to be only associated with one or two types of hereditary cancers, may in fact increase the risk for a wider range of syndromes. These advancements have changed the genetic counseling landscape by introducing a need to consider a wider set of individual genes and cancers to accurately assess overall risks. In the context of genetic counseling, the importance of accurate estimates of carrier probabilities is well-known (<xref ref-type="bibr" rid="bib25">Nelson et al., 2014</xref>). With the number of genes of interest and their combinations increasing, efficient calculation of these estimates becomes crucial in clinical settings.</p><p>In genetic counseling, an individual may be suspected of inherited cancer susceptibility if their family history exhibits certain patterns. For example, if two or more relatives have the same type of cancer on the same side of the family, or if cancer diagnoses in the family are particularly early, they may be referred to testing for mutations in genes associated with increased risk for those specific cancers. In the case of hereditary breast cancer, guidelines in the US were established to identify patients who have higher likelihoods of benefiting from germline genetic testing. Thresholds for testing were set high initially, since genetic testing was very expensive at the time (<xref ref-type="bibr" rid="bib24">Manahan et al., 2019</xref>). Although cost of testing has decreased and guidelines are constantly changing, accurate calculation of carrier probabilities, given family history, is essential in supporting the decision for further testing, preventative treatment, or family planning (<xref ref-type="bibr" rid="bib9">Chen et al., 2004</xref>).</p><p>Existing Mendelian models consider a relatively narrow subset of cancers and genes. For example, BRCAPRO, available in the BayesMendel R package (<xref ref-type="bibr" rid="bib9">Chen et al., 2004</xref>), considers two cancers (breast and ovarian) and two genes (BRCA1 and BRCA2). Boadicea v4 Beta (<xref ref-type="bibr" rid="bib8">Centre for Cancer Genetic Epidemiology, 2020</xref>) considers BRCA1, BRCA2, PALB2, CHEK2, and ATM mutations in the same cancers. To comprehensively incorporate cancers, genes, and their interactions, we introduce PanelPRO, an R package which aims to efficiently and flexibly scale to the demands of germline panel testing. The newly developed package has the following key advantages:</p><list list-type="bullet"><list-item><p>Customizable model specification, including the choice of genes and cancers included in the model;</p></list-item><list-item><p>Customizable model parameters, including the allele frequencies and penetrances;</p></list-item><list-item><p>Accurate default parameter estimates, curated from an extensive literature search;</p></list-item><list-item><p>Flexibility to incorporate cancer risk modifiers such as prophylactic surgeries;</p></list-item><list-item><p>Comprehensive user input checks for pedigrees;</p></list-item><list-item><p>Speed of computation, through an optimized C++ implementation of an efficient algorithm. (<xref ref-type="bibr" rid="bib23">Madsen et al., 2018</xref>)</p></list-item></list><p>In general, PanelPRO can handle models with <inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> genes and <inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> cancers, where <inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> are arbitrary (subject to reasonable run-times and memory constraints). It is intended that <inline-formula><mml:math id="inf5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> become larger as more research on gene cancer associations becomes available. The package contains a comprehensive collection of functions designed to efficiently calculate carrier probabilities and future cancer risk for individuals, given detailed information about their family history.</p><p>PanelPRO is designed to be back-compatible with the existing BayesMendel package; individual models within that package (for example, <italic>BRCAPRO</italic>, <italic>MMRPRO</italic>, <italic>BRCAPRO5</italic>, or <italic>BRCAPRO6</italic>) can be called directly from PanelPRO by passing this model specification to the main function call. We expect that users of BayesMendel will migrate to this generalized and customizable enhancement, and that PanelPRO will lead to new users interested in broader cross syndrome modeling in the current landscape for cancer clinical risk assessment. In the current release, there are minor differences in how BayesMendel and PanelPRO deal with peer-reviewed data, in particular, for cancer penetrance calculations.</p><p>The PanelPRO R package is freely available for research purposes. The BayesMendel R package is likewise freely available for research purposes, and is currently licensed for clinical commercial use to CRA Health, CancerGene Connect, Progeny, FamHis, MagView, Igentify, CancerIQ, and Finch genetics. Family history has long been understood to be a key component for identifying risk and preventing heritable diseases, and clinical tools such as the ones which license BayesMendel are becoming more readily available (<xref ref-type="bibr" rid="bib35">Welch et al., 2018</xref>). For BayesMendel, we leave clinical integration to the software licensees, including the integration of electronic medical records such as EPIC. We envision a similar dissemination plan for PanelPRO.</p><sec id="s1-1"><title>Methods: package workflow</title><p>The workflow of the package includes four main parts: the input, including user and model input; pre-processing of the inputs, including user input checks and a database build; running the peeling-paring algorithm; and outputting the results. <xref ref-type="fig" rid="fig1">Figure 1</xref> shows the workflow. Additionally, <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref> shows detailed sub-routines within the package.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>PanelPRO package workflow.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig1-v2.tif"/></fig></sec><sec id="s1-2"><title>Input</title><sec id="s1-2-1"><title>User input</title><p>The main input from the user is their pedigree. This is in the form of an R <italic><monospace>data.frame</monospace></italic> which contains detailed information about known family members, such as their ages and previous cancer diagnoses. The pedigree structure is defined by the <monospace><italic>ID</italic>, <italic>MotherID</italic> and <italic>FatherID</italic></monospace> columns. Previous cancer diagnoses and their ages of diagnosis are stored in the <italic><monospace>isAff*</monospace></italic> and <italic><monospace>Age*</monospace></italic> columns, respectively, where <italic>*</italic> represents a cancer type, designated according to a standard nomenclature of two- to four-letter tags which are also used in visualizations. Cancers currently considered in PanelPRO are listed in <xref ref-type="table" rid="app1table1">Appendix 1—table 1</xref>. Note, this list will be expanded for future versions of the package as more information on risk for various genes and cancers becomes available in the literature. Risk modifiers, such as prophylactic surgeries, can be incorporated to adjust the likelihood calculation. Previous genetic testing history can also be incorporated. The current version of the package, v0.2.0, contains thirteen sample pedigrees, called <italic><monospace>test_fam_X</monospace></italic>, where <italic>X</italic> goes from 1 to 12, and <italic><monospace>err_fam_1</monospace></italic>. The <italic><monospace>test_fam_X</monospace></italic> pedigrees provide realistic and extreme examples of the data that can be included in the user input, whereas <italic><monospace>err_fam_1</monospace></italic> is an example of a family that does not pass PanelPRO’s preprocessing pedigree check and therefore cannot be evaluated by the model. A clipped version (with a subset of the necessary columns) of <italic><monospace>test_fam_1</monospace></italic> pedigree is shown below. Key figures relevant to the pedigree can be found in <xref ref-type="table" rid="app1table2">Appendix 1—table 2</xref>.</p><table-wrap id="inlinetable1" position="anchor"><table frame="hsides" rules="groups"><thead><tr><th align="left" colspan="13"><monospace><named-content content-type="author-callout-style-a3">head</named-content>(test_fam_1)</monospace></th></tr></thead><tbody><tr><td align="left"><monospace>##</monospace></td><td align="right"/><td align="right"><monospace>ID</monospace></td><td align="right"><monospace>Sex</monospace></td><td align="right"><monospace>MotherID</monospace></td><td align="right"><monospace>FatherID</monospace></td><td align="right"><monospace>isProband</monospace></td><td align="right"><monospace>CurAge</monospace></td><td align="right"><monospace>isAffBC</monospace></td><td align="right"><monospace>isAffBC</monospace></td><td align="right"><monospace>AgeBC</monospace></td><td align="right"><monospace>AgeOC</monospace></td><td align="right"><monospace>isDead</monospace></td></tr><tr><td align="left"><monospace>##</monospace></td><td align="right"><monospace>1</monospace></td><td align="right"><monospace>1</monospace></td><td align="right"><monospace>0</monospace></td><td align="right"><monospace>NA</monospace></td><td align="right"><monospace>NA</monospace></td><td align="right"><monospace>0</monospace></td><td align="right"><monospace>93</monospace></td><td align="right"><monospace>1</monospace></td><td align="right"><monospace>0</monospace></td><td align="right"><monospace>65</monospace></td><td align="right"><monospace>NA</monospace></td><td align="right"><monospace>1</monospace></td></tr><tr><td align="left"><monospace>##</monospace></td><td align="right"><monospace>2</monospace></td><td align="right"><monospace>2</monospace></td><td align="right"><monospace>1</monospace></td><td align="right"><monospace>NA</monospace></td><td align="right"><monospace>NA</monospace></td><td align="right"><monospace>0</monospace></td><td align="right"><monospace>80</monospace></td><td align="right"><monospace>0</monospace></td><td align="right"><monospace>0</monospace></td><td align="right"><monospace>NA</monospace></td><td align="right"><monospace>NA</monospace></td><td align="right"><monospace>1</monospace></td></tr><tr><td align="left"><monospace>##</monospace></td><td align="right"><monospace>3</monospace></td><td align="right"><monospace>3</monospace></td><td align="right"><monospace>0</monospace></td><td align="right"><monospace>1</monospace></td><td align="right"><monospace>2</monospace></td><td align="right"><monospace>0</monospace></td><td align="right"><monospace>72</monospace></td><td align="right"><monospace>1</monospace></td><td align="right"><monospace>1</monospace></td><td align="right"><monospace>40</monospace></td><td align="right"><monospace>NA</monospace></td><td align="right"><monospace>0</monospace></td></tr><tr><td align="left"><monospace>##</monospace></td><td align="right"><monospace>4</monospace></td><td align="right"><monospace>4</monospace></td><td align="right"><monospace>1</monospace></td><td align="right"><monospace>1</monospace></td><td align="right"><monospace>2</monospace></td><td align="right"><monospace>0</monospace></td><td align="right"><monospace>65</monospace></td><td align="right"><monospace>0</monospace></td><td align="right"><monospace>0</monospace></td><td align="right"><monospace>NA</monospace></td><td align="right"><monospace>NA</monospace></td><td align="right"><monospace>1</monospace></td></tr><tr><td align="left"><monospace>##</monospace></td><td align="right"><monospace>5</monospace></td><td align="right"><monospace>5</monospace></td><td align="right"><monospace>1</monospace></td><td align="right"><monospace>1</monospace></td><td align="right"><monospace>2</monospace></td><td align="right"><monospace>0</monospace></td><td align="right"><monospace>65</monospace></td><td align="right"><monospace>0</monospace></td><td align="right"><monospace>0</monospace></td><td align="right"><monospace>NA</monospace></td><td align="right"><monospace>NA</monospace></td><td align="right"><monospace>0</monospace></td></tr><tr><td align="left"><monospace>##</monospace></td><td align="right"><monospace>6</monospace></td><td align="right"><monospace>6</monospace></td><td align="right"><monospace>0</monospace></td><td align="right"><monospace>1</monospace></td><td align="right"><monospace>2</monospace></td><td align="right"><monospace>1</monospace></td><td align="right"><monospace>55</monospace></td><td align="right"><monospace>0</monospace></td><td align="right"><monospace>0</monospace></td><td align="right"><monospace>NA</monospace></td><td align="right"><monospace>NA</monospace></td><td align="right"><monospace>0</monospace></td></tr></tbody></table></table-wrap><p>The full specification of the pedigree structure is shown in <xref ref-type="table" rid="table1">Table 1</xref>. The family tree pedigree can also be visualized by using the visPed package as in <xref ref-type="fig" rid="fig2">Figure 2</xref>. This external package is available through <ext-link ext-link-type="uri" xlink:href="https://github.com/bayesmendel/visPed">https://github.com/bayesmendel/visPed</ext-link> version 0.1.0 (<xref ref-type="bibr" rid="bib22">Lee, 2021</xref>) and is based on the kinship2 package available in CRAN (<xref ref-type="bibr" rid="bib29">Sinnwell et al., 2014</xref>). PanelPRO itself does not contain pedigree plotting functionality. However, users can easily acquire the visPed package separately.</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Pedigree structure in PanelPRO.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Column</th><th>Definition</th><th>Value</th></tr></thead><tbody><tr><td>ID</td><td>Unique numeric identifier of each individual</td><td>Non-repeated strictly positive integer</td></tr><tr><td>MotherID</td><td>ID of one’s mother</td><td>Strictly positive integer or NA (missing)</td></tr><tr><td>FatherID</td><td>ID of one’s father</td><td>Strictly positive integer or NA (missing)</td></tr><tr><td>Sex</td><td>Sex of the individual: 1 for male, 0 for female</td><td>One of {0, 1}</td></tr><tr><td>isProband</td><td>Indicates the proband or counselee by 1 and 0 otherwise – multiple probands can be specified</td><td>One of {0, 1)</td></tr><tr><td>CurAge</td><td>Age of censoring: either the current age or death age, depending on isDead status</td><td>Positive integer or NA (missing)</td></tr><tr><td>isAff*</td><td>Affection status of cancer *</td><td>One of {0, 1}</td></tr><tr><td>Age*</td><td>Affection age of cancer *</td><td>Positive integer or NA (missing)</td></tr><tr><td>isDead</td><td>Whether someone has died</td><td>One of {0, 1, NA}</td></tr><tr><td>race</td><td>Race of individual (used to modify penetrance)</td><td>One of All_Races, AIAN, Asian, Black, White, Hispanic, WH, WNH, NA</td></tr><tr><td>Ancestry</td><td>Ancestry of individual (used to modify allele frequencies)</td><td>One of AJ, nonAJ, Italian, NA</td></tr><tr><td>Twins</td><td>Identifies siblings who are identical twins or multiple births</td><td>Each set is identified by a unique integer, and 0 otherwise</td></tr><tr><td>riskmod</td><td>Preventative interventions which modify penetrance</td><td>List, combination of &quot;mastectomy&quot;, &quot;hysterectomy&quot;, and &quot;oophorectomy&quot;</td></tr><tr><td>InterAge</td><td>Age of each preventative interventions</td><td>List, combination of integers</td></tr><tr><td>Gene name from GENE_TYPES</td><td>Germline testing result</td><td>One of {0, 1, NA}</td></tr><tr><td>Marker name from CK14, CK5.6, ER, PR, HER2, MSI</td><td>Marker testing result</td><td>One of {0, 1, NA}</td></tr><tr><td/><td/><td/></tr></tbody></table></table-wrap><fig id="fig2" position="float"><label>Figure 2.</label><caption><title><italic>test_fam_1</italic> sample pedigree as included in the PanelPRO package, plotted using the external visPed package.</title><p>The colors refer to cancer diagnoses in the legend. The age of diagnosis is shown below the individual if it is known.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig2-v2.tif"/></fig><p>Prophylactic surgeries (mastectomy, oophorectomy and hysterectomy) act as risk modifiers. They are specified in a column of lists in the user input pedigree. Including these risk modifiers changes the resulting carrier probability and future risk outputs (see the Output section). Previous history of biomarker testing for breast and colorectal cancers can also be included in the model.</p></sec><sec id="s1-2-2"><title>Model input</title><p>Calculation of carrier probabilities requires information about allele frequencies and penetrances for the mutations and cancers requested in the function call. They are derived from peer-reviewed studies whose results are cataloged in the PanelPRODatabase. At each function call, the code extracts the appropriate subset of gene-cancer combinations. These combinations are specified in the main PanelPRO function call, where the user should indicate the cancers for which family history in the pedigree should be used, as well as the genes for which carrier probabilities are requested.<code xml:space="preserve">PanelPRO(pedigree = test_fam_1, 
                      cancers = c(‘Breast’, ‘Ovarian’), 
                      genes = c(‘BRCA1’, ‘BRCA2’, ‘ATM’, ‘MSH2’))</code></p><p>If no genes or cancers are specified, <monospace>PanelPRO</monospace> will default to all the supported genes in the version at that time, with all the cancers in the pedigree.</p><p>Users are free to change the database defaults for their own purposes. The structure of this database is an R list. A partial output is provided below.</p><table-wrap id="inlinetable2" position="anchor"><table frame="hsides" rules="groups"><tbody><tr><th align="left" colspan="3"><monospace>str(PanelPRODatabase)</monospace> </th></tr><tr><td align="left"><monospace>##</monospace></td><td align="left"><monospace>$ Penetrance</monospace></td><td align="left"><monospace>: num [1:18, 1:26, 1:8, 1:2, 1:94, 1:2] 3.98e-05 2.80e-07 0.00 5.00e-08 0.00 ...</monospace></td></tr><tr><td align="left"><monospace>##</monospace></td><td align="left" colspan="2"> <monospace>..- attr(*, 'dimnames')=List of 6</monospace></td></tr><tr><td align="left"><monospace>##</monospace></td><td align="left"> <monospace>.. ..$ Cancer</monospace></td><td align="left"><monospace>: chr [1:18] 'Brain' 'Breast' 'Cervical' 'Colorectal' ...</monospace> </td></tr><tr><td align="left"><monospace>##</monospace></td><td align="left"> <monospace>.. ..$ Gene</monospace></td><td align="left"><monospace>: chr [1:26] 'APC_hetero_anyPV' 'ATM_hetero_anyPV' 'BARD1_hetero_anyPV' ...</monospace></td></tr><tr><td align="left"><monospace>##</monospace></td><td align="left"><monospace>.. ..$ Race</monospace></td><td align="left"><monospace>: chr [1:8] 'All_Races' 'AIAN' 'Asian' 'Black' ...</monospace> </td></tr><tr><td align="left"><monospace>##</monospace></td><td align="left"> <monospace>.. ..$ Sex</monospace></td><td align="left"><monospace>: chr [1:2] 'Female' 'Male</monospace></td></tr><tr><td align="left"><monospace>##</monospace></td><td align="left"> <monospace>.. ..$ PenetType</monospace></td><td align="left"><monospace>: chr [1:2] 'Net' 'Crude</monospace></td></tr><tr><td align="left"><monospace>##</monospace></td><td align="left"> <monospace>$ AlleleFrequency</monospace></td><td align="left"><monospace>: num [1:24, 1:3] 1.45e-04 1.90e-03 3.41e-04 2.17e-05 1.37e-02 ...</monospace></td></tr><tr><td align="left"><monospace>##</monospace></td><td align="left" colspan="2"> <monospace>..- attr(*, 'dimnames')=List of 2</monospace></td></tr><tr><td align="left"><monospace>##</monospace></td><td align="left"> <monospace>.. ..$ Gene</monospace></td><td align="left"><monospace>: chr [1:24] 'APC_anyPV' 'ATM_anyPV' 'BARD1_anyPV' 'BMPR1A_anyPV' ...</monospace> </td></tr><tr><td align="left"><monospace>##</monospace></td><td align="left"> <monospace>.. ..$ Ancestry</monospace></td><td align="left"><monospace>: chr [1:3] 'AJ' 'nonAJ' 'Italian'</monospace></td></tr></tbody></table></table-wrap><p>In the current PanelPRO database, cancer penetrances are taken from data included in the BayesMendel package when available: the BRCA1 and BRCA2 estimates for the probability of developing breast or ovarian cancer <xref ref-type="bibr" rid="bib11">Chen et al., 2020</xref>; the MLH1, MSH2, and MSH6 estimates for the probability of developing colorectal or endometrial cancer <xref ref-type="bibr" rid="bib34">Wang et al., 2020</xref>; <xref ref-type="bibr" rid="bib15">Felton et al., 2007</xref>; and the CDKN2A estimates for the probability of developing melanoma (<xref ref-type="bibr" rid="bib33">Wang et al., 2010</xref>; <xref ref-type="bibr" rid="bib2">Begg et al., 2005</xref>; <xref ref-type="bibr" rid="bib4">Bishop, 2002</xref>). All other cancer penetrances are pulled from the All Syndromes Known to Man Evaluator (ASK2ME) clinical tool (<xref ref-type="bibr" rid="bib6">Braun et al., 2018</xref>).</p><p>For allele frequencies, we use the non-Ashkenazi, Ashkenazi Jewish, and Italian BRCA1 and BRCA2 allele frequency estimates from BRCAPRO (<xref ref-type="bibr" rid="bib9">Chen et al., 2004</xref>; <xref ref-type="bibr" rid="bib1">Antoniou et al., 2002</xref>); for MLH1, MSH2, and MSH6, we use the allele frequency estimates from MMRpro (<xref ref-type="bibr" rid="bib9">Chen et al., 2004</xref>; <xref ref-type="bibr" rid="bib10">Chen et al., 2006</xref>); and for CDKN2A, we use the allele frequency estimate from Melapro (<xref ref-type="bibr" rid="bib9">Chen et al., 2004</xref>; <xref ref-type="bibr" rid="bib3">Berwick, 2006</xref>). Allele frequency estimates for ATM, CHEK2, and PALB2 are taken from <xref ref-type="bibr" rid="bib20">Lee et al., 2016</xref>. The allele frequencies of the remaining genes are estimated based on a 25-gene panel study of 252,223 individuals (<xref ref-type="bibr" rid="bib27">Rosenthal et al., 2017</xref>) that did not adjust for ascertainment. In this case, we rescale the reported estimates by the ratio of the ascertained and unascertained allele frequencies for a gene reported in both our existing database and the study.</p><p>New genes and cancers will be added to PanelPRO based on regular literature reviews as conducted in ASK2ME (<xref ref-type="bibr" rid="bib6">Braun et al., 2018</xref>). The ASK2ME approach identifies best-available studies that adjust for ascertainment; since many papers report odds ratios or relative risks, it then calculates absolute age-specific cancer penetrances when necessary.</p><p>The user can also select other options in the function call which are relevant at run-time. Examples include the maximum number of simultaneous gene mutations considered for a given individual, whether a parallelized version of the algorithm is performed, and the number of imputations in case of missing age data (see the Missing Data section). Many of the useful options are listed in <xref ref-type="table" rid="table2">Table 2</xref>.</p><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>List of model options that the user can pass to PanelPRO, along with their defaults.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Option</th><th>Default value</th><th>Possible values</th><th>Description</th></tr></thead><tbody><tr><td>max.mut</td><td>NULL</td><td>Integers up to the number of genes</td><td>Number of maximum simultaneous mutations, also known as the paring parameter. If no integer has been input, it re-defaults to 2.</td></tr><tr><td>iterations</td><td>20</td><td>Integers from 1 upwards</td><td>In case of missing current or cancer ages in the pedigree, this is the number of times those ages will be imputed.</td></tr><tr><td>parallel</td><td>TRUE</td><td>TRUE or FALSE</td><td>If age imputations are needed, this parameter can be set to utilize multiple cores on one’s machine.</td></tr><tr><td>net</td><td>FALSE</td><td>TRUE or FALSE</td><td>Determines whether net or crude penetrances are used to compute future risk of cancer. Net penetrances exclude all other causes of death, apart from the affected cancer.</td></tr><tr><td>age.by</td><td>5</td><td>Integers from one upwards</td><td>The intervals of age used to report the future risk of cancer.</td></tr></tbody></table></table-wrap><p>Passing these options to the function call is simple, as shown below.<code xml:space="preserve">PanelPRO(pedigree = test_fam_1, 
                      cancers = c(‘Breast’, ‘Ovarian’),
                      genes = c(‘BRCA1’, ‘BRCA2’, ‘ATM’, ‘MSH2’),
                      max.mut = 1,
                      parallel = FALSE)</code></p><p>Instead of specifying a set of cancers and genes, users can call models corresponding to those in the BayesMendel package, as well as other predefined models. For example, the two calls below are equivalent.<code xml:space="preserve">bayesMendelCall &lt;- BRCAPRO6(pedigree = test_fam_1)
panelProCall &lt;- PanelPRO(pedigree = test_fam_1,
                                                    cancers = c(‘Breast’, ‘Ovarian’),
                                               genes = c(‘BRCA1’, ‘BRCA2’, ‘MLH1’, ‘MSH2’, ‘MSH6’, ‘CDKN2A’))
all.equal(bayesMendelCall, panelProCall)
## (1) TRUE</code></p></sec></sec><sec id="s1-3"><title>Preprocessing</title><sec id="s1-3-1"><title>Pedigree check</title><p>First, PanelPRO checks the structure of the user-supplied <monospace>R <italic>data.frame</italic></monospace> containing the family history to be evaluated, using a call to the checkFam function. A description can be found in <xref ref-type="table" rid="table3">Table 3</xref>. Messages or warnings are given to the user if values have been automatically changed to rectify conflicts. For example, <italic><monospace>test_fam_1</monospace></italic> contains some ancestry and race inconsistencies.</p><table-wrap id="table3" position="float"><label>Table 3.</label><caption><title>List of main functions in PanelPRO.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Category</th><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>Pre-processing</td><td>checkFam</td><td>Checks family structure as defined by the user. The inputs are a <italic><monospace>data.frame</monospace></italic> specifying the pedigree and a built database returned by buildDatabase. The output is a modified <italic><monospace>data.frame</monospace></italic> pedigree and list of imputed ages, if missing ages were imputed (see the Missing Data section).</td></tr><tr><td>Pre-processing</td><td>buildDatabase</td><td>Subsets the internal database PanelPRODatabase depending on the cancers and genes selected. The input is the list PanelPRODatabase. The output is another list which is a subset of PanelPRODatabase.</td></tr><tr><td>Algorithm</td><td>PanelPROCalc</td><td>Estimates the posterior carrier probabilities and future risks of the proband. The inputs are the outputs of checkFam. The outputs are lists of posterior probabilities and future risks for the proband.</td></tr><tr><td>Main function</td><td>PanelPRO</td><td>Runs main function. The inputs are the user-specified pedigree, a vector of cancers in the model, a vector of genes in the model, and other optional parameters. The output is a list of estimates of posterior carrier probabilities for each genotype, along with future cancer risks and ranges for each of these.</td></tr></tbody></table></table-wrap><p><code xml:space="preserve">checkFam(test_fam_1)
## Your model has two cancers - Breast, Ovarian and 24 genes - APC_hetero_anyPV, ATM_hetero_anyPV ...
## Germline testing results for BRCA1 are assumed to be for default variant BRCA1_hetero_anyPV.
## Germline testing results for BRCA2 are assumed to be for default variant BRCA2_hetero_anyPV.
## ID 3 ’s Ancestry has been changed to nonAJ to meet heredity consistency
## ID 10 ’s race has been changed to All_Races to meet heredity consistency
## ID 9 ’s Ancestry has been changed to nonAJ to meet heredity consistency
## ID 16,17 ’s Ancestry has been changed to nonAJ to meet heredity consistency
## ID 29,30 ’s Ancestry has been changed to nonAJ to meet heredity consistency
## ID 33,34 ’s race has been changed to All_Races to meet heredity consistency
## ID 33,34 ’s Ancestry has been changed to nonAJ to meet heredity consistency</code></p><p>Errors are given if inconsistencies or ambiguities in the pedigree cannot be resolved such that the pedigree can be safely passed into downstream functions. Most of the checks are for the presence of required information; whether the pedigree variables have values in the expected range/set; and for consistency between cancers and sex and in terms of features with hereditary assumptions among parents/children and twins. The pedigree is also checked for ‘loops’, which PanelPRO currently does not support. For example, within <italic><monospace>err_fam_1</monospace></italic>, there are two sets of male and female siblings (four individuals) who have mated with the corresponding siblings in another family, as shown in <xref ref-type="fig" rid="fig3">Figure 3</xref>. This mating configuration results in a loop. For a more detailed definition of loops, see <xref ref-type="bibr" rid="bib16">Fernando et al., 1993</xref>. In addition, disconnected family members are detected and removed from the pedigree if they will not influence the counselee’s results.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>The sample pedigree err_fam_1 which contains a pedigree loop, due to the mating pattern of the siblings aged 59 and 55 with the siblings aged 60 and 62, respectively.</title><p>The two circles linked by a dotted line represent the same individual.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig3-v2.tif"/></fig></sec><sec id="s1-3-2"><title>Build database</title><p>Depending on the configuration of the model requested (cancers in the family, genes considered), a subset of <monospace>PanelPRODatabase</monospace> or a user-modified database will be created and passed through for further calculation by the buildDatabase function. A description of this function can be found in <xref ref-type="table" rid="table3">Table 3</xref> .</p></sec></sec><sec id="s1-4"><title>Algorithm</title><p>The checked pedigree and PanelPRODatabase subset, as well as any user options, are then passed to the ‘peeling-paring’ algorithm, which approximates Equation 2 in the Genotype probabilities section. It is based on the ‘peeling’ algorithm as introduced by <xref ref-type="bibr" rid="bib14">Elston and Stewart, 1971</xref> with its implementation based on <xref ref-type="bibr" rid="bib16">Fernando et al., 1993</xref>. The ‘paring’ aspect of the algorithm limits the number of simultaneous mutations allowed. This is called the paring parameter and has a default value of 2, which results in an approximation which has been shown to be adequate for clinical purposes (<xref ref-type="bibr" rid="bib23">Madsen et al., 2018</xref>). When the paring parameter is set equal to the number of distinct genes to be considered, the calculation is exact (assuming no other missing information about the pedigree). Future cancer risks are then calculated based on the law of total probability, using the previously calculated posterior carrier probabilities, as described in the Methods: Mendelian modeling section. These two calculations are performed in PanelPROCalc, as listed in <xref ref-type="table" rid="table3">Table 3</xref>. The underlying algorithm is written in <italic>Rcpp</italic> using the <italic>RcppArmadillo</italic> package (<xref ref-type="bibr" rid="bib13">Eddelbuettel and Sanderson, 2014</xref>; <xref ref-type="bibr" rid="bib12">Eddelbuettel and Francois, 2011</xref>). It uses, as much as possible, optimized data structures, vectorized operations and in-place modifications to be both time and memory efficient. See the Discussion section for benchmarks on the run-time of the implementation.</p><p>The recursive nature of the peeling-paring algorithm allows for multiple counselees to be specified in the function call without significant increase in the computational time. This is an advantage when multiple family members are at high risk and would benefit from knowing their carrier probabilities and future cancer risks.</p><sec id="s1-4-1"><title>Missing data</title><p>PanelPRO calculates mutation carrier probabilities for one or more counselees. The peeling-paring algorithm requires both parents of the counselee to be present in the pedigree in order to link individuals who are non-founders. When there is only data for a single parent (whose children influence the results), we add a pseudo-parent who has the same prior allele frequencies as the parent for whom we do have information on. This allows the peeling-paring algorithm to run and serves as an approximation of the final results.</p><p>When the current age or age of cancer diagnosis of a family member is unknown, we use a multiple imputation procedure to repeatedly sample their age (<xref ref-type="bibr" rid="bib5">Biswas et al., 2013</xref>). Unknown current ages are sampled based on the current ages of the relatives, and unknown ages of cancer diagnosis are sampled from the cancer penetrances, using the current age as an upper bound. The optional impute.times argument in the main PanelPRO function can be used to set the number of samples taken. The value labeled ‘estimate’ in the output is the average of the results over the sampled ages, whilst the ‘lower’ and ‘upper’ bounds are the minimum and maximum values over the respective samples (whether it be for the posterior probabilities or future risks).</p><p>When impute.times is high (say, 50 or more), it is recommended to set the parameter parallel to TRUE. The algorithm will then use the foreach package and the existing cores in one’s machine to execute the imputations in a parallel fashion, instead of sequentially, thereby speeding up the computation.</p></sec></sec><sec id="s1-5"><title>Output</title><p>For each proband in the pedigree, the output consists of:</p><list list-type="bullet"><list-item><p>estimates of carrier probabilities,</p></list-item><list-item><p>lower and upper bound estimates of carrier probabilities if imputations were made for missing data,</p></list-item><list-item><p>estimates of future risks of cancers in 5-year intervals (the user can also change the length of the intervals),</p></list-item><list-item><p>lower and upper bound estimates of future risks of cancers in 5-year intervals if imputations were made for missing data.</p></list-item></list><p>Messages or warnings generated from checkFam have been omitted in the example below for brevity.<code xml:space="preserve">output &lt;- PanelPRO(pedigree = test_fam_1, 
                                          cancers = c(‘Breast’, ‘Ovarian’), 
                                          genes = c(‘BRCA1’, ‘BRCA2’, ‘ATM’, ‘MSH2’), 
                                          max.mut = 2, 
                                          parallel = FALSE)</code><code xml:space="preserve">## Your model has two cancers - Breast, Ovarian and four genes - BRCA1_hetero_anyPV ...</code></p><table-wrap id="inlinetable3" position="anchor"><table frame="hsides" rules="groups"><tbody><tr><td colspan="9"><monospace>output</monospace></td></tr><tr><td><monospace>##</monospace></td><td><monospace>$posterior.prob</monospace></td><td align="right" colspan="4"/><td align="right"/><td align="right"/><td align="right"/></tr><tr><td><monospace>##</monospace></td><td><monospace>$posterior.prob$‘6‘</monospace> </td><td align="right" colspan="4"/><td align="right"/><td align="right"/><td align="right"/></tr><tr><td><monospace>##</monospace></td><td/><td align="right" colspan="4"><monospace>genes</monospace></td><td align="right"><monospace>estimate</monospace></td><td align="right"><monospace>lower</monospace></td><td align="right"><monospace>upper</monospace></td></tr><tr><td><monospace>##</monospace></td><td><monospace>1</monospace></td><td align="right" colspan="4"><monospace>noncarrier</monospace></td><td align="right"><monospace>6.895857e-01</monospace></td><td align="right"><monospace>6.852634e-01</monospace> </td><td align="right"><monospace>6.901750e-01</monospace></td></tr><tr><td><monospace>##</monospace></td><td><monospace>2</monospace></td><td align="right" colspan="4"><monospace>BRCA1_hetero_anyPV</monospace></td><td align="right"><monospace>3.028050e-01</monospace></td><td align="right"><monospace>3.009048e-01</monospace></td><td align="right"><monospace>3.030639e-01</monospace></td></tr><tr><td><monospace>##</monospace></td><td><monospace>3</monospace></td><td align="right" colspan="4"> <monospace><monospace>BRCA2_hetero_anyPV</monospace></monospace></td><td align="right"><monospace>3.486877e-04</monospace></td><td align="right"><monospace><monospace>2.817221e-04</monospace></monospace> </td><td align="right"><monospace>4.216045e-04</monospace></td></tr><tr><td><monospace>##</monospace></td><td><monospace>4</monospace></td><td align="right" colspan="4"><monospace>ATM_hetero_anyPV</monospace></td><td align="right"><monospace>4.027689e-03</monospace></td><td align="right"><monospace>3.904178e-03</monospace></td><td align="right"><monospace>5.532214e-03</monospace></td></tr><tr><td><monospace>##</monospace></td><td><monospace>5</monospace></td><td align="right" colspan="4"><monospace>MSH2_hetero_anyPV</monospace></td><td align="right"><monospace>9.814770e-04</monospace></td><td align="right"><monospace>5.697486e-04</monospace></td><td align="right"><monospace>4.574016e-03</monospace></td></tr><tr><td><monospace>##</monospace></td><td><monospace>6</monospace></td><td align="right" colspan="4"><monospace>BRCA1_hetero_anyPV.BRCA2_hetero_anyPV</monospace></td><td align="right"><monospace>1.462717e-04</monospace></td><td align="right"><monospace><monospace>1.181799e-04</monospace></monospace> </td><td align="right"><monospace>1.768601e-04</monospace></td></tr><tr><td><monospace>##</monospace></td><td><monospace>7</monospace></td><td align="right" colspan="4"><monospace>BRCA1_hetero_anyPV.ATM_hetero_anyPV</monospace></td><td align="right"><monospace>1.689866e-03</monospace></td><td align="right"><monospace>1.638046e-03</monospace></td><td align="right"><monospace>2.321095e-03</monospace></td></tr><tr><td><monospace>##</monospace></td><td><monospace>8</monospace></td><td align="right" colspan="4"><monospace><monospace>BRCA2_hetero_anyPV.ATM_hetero_anyPV</monospace></monospace> </td><td align="right"><monospace>7.125399e-07</monospace></td><td align="right"><monospace>6.081245e-07</monospace></td><td align="right"><monospace>9.481190e-07</monospace></td></tr><tr><td><monospace>##</monospace></td><td><monospace>9</monospace></td><td align="right" colspan="4"><monospace>BRCA1_hetero_anyPV.MSH2_hetero_anyPV</monospace></td><td align="right"><monospace>4.118459e-04</monospace></td><td align="right"><monospace>2.390780e-04</monospace></td><td align="right"><monospace>9.481190e-07</monospace></td></tr><tr><td><monospace>##</monospace></td><td><monospace>10</monospace></td><td align="right" colspan="4"><monospace>BRCA2_hetero_anyPV.MSH2_hetero_anyPV</monospace></td><td align="right"><monospace>4.118459e-04</monospace></td><td align="right"><monospace>1.361573e-07</monospace></td><td align="right"><monospace>9.481190e-07</monospace></td></tr><tr><td><monospace>##</monospace></td><td><monospace>11</monospace></td><td align="right" colspan="4"><monospace>ATM_hetero_anyPV.MSH2_hetero_anyPV</monospace></td><td align="right"><monospace>2.541503e-06</monospace></td><td align="right"><monospace>1.637872e-06</monospace></td><td align="right"><monospace>9.481190e-07</monospace></td></tr><tr><td><monospace>##</monospace></td><td/><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/></tr><tr><td><monospace>##</monospace></td><td/><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/></tr><tr><td><monospace>##</monospace></td><td><monospace>$future.risk</monospace></td><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/></tr><tr><td><monospace>##</monospace></td><td><monospace>$future.risk$‘6‘</monospace> </td><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/></tr><tr><td><monospace>##</monospace></td><td><monospace>$future.risk$‘6‘$Breast</monospace></td><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/></tr><tr><td><monospace>##</monospace></td><td/><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/></tr><tr><td><monospace>##</monospace></td><td/><td align="right"><monospace>ByAge</monospace></td><td align="right"><monospace>estimate</monospace></td><td align="right"><monospace>lower</monospace></td><td align="right"><monospace>upper</monospace></td><td align="right"/><td align="right"/><td align="right"/></tr><tr><td><monospace>##</monospace></td><td><monospace>1</monospace></td><td align="right"><monospace>60</monospace></td><td align="right"><monospace>0.04694233</monospace></td><td align="right"><monospace>0.04691714</monospace></td><td align="right"><monospace>0.04707834</monospace></td><td align="right"/><td align="right"/><td align="right"/></tr><tr><td><monospace>##</monospace></td><td><monospace>2</monospace></td><td align="right"><monospace>65</monospace></td><td align="right"><monospace>0.09340834</monospace></td><td align="right"><monospace>0.09336108</monospace></td><td align="right"><monospace>0.09367413</monospace></td><td align="right"/><td align="right"/><td align="right"/></tr><tr><td><monospace>##</monospace></td><td><monospace>3</monospace></td><td align="right"><monospace>70</monospace></td><td align="right"><monospace>0.13709254</monospace></td><td align="right"><monospace>0.13702686</monospace></td><td align="right"><monospace>0.13747579</monospace></td><td align="right"/><td align="right"/><td align="right"/></tr><tr><td><monospace>##</monospace></td><td><monospace>4</monospace></td><td align="right"><monospace>75</monospace></td><td align="right"><monospace>0.17464537</monospace></td><td align="right"><monospace>0.17456501</monospace></td><td align="right"><monospace>0.17513057</monospace></td><td align="right"/><td align="right"/><td align="right"/></tr><tr><td><monospace>##</monospace></td><td><monospace>5</monospace></td><td align="right"><monospace>80</monospace></td><td align="right"><monospace>0.20483919</monospace></td><td align="right"><monospace>0.20474732</monospace></td><td align="right"><monospace>0.20541009</monospace></td><td align="right"/><td align="right"/><td align="right"/></tr><tr><td><monospace>##</monospace></td><td><monospace>6</monospace></td><td align="right"><monospace>85</monospace></td><td align="right"><monospace>0.22687210</monospace></td><td align="right"><monospace>0.22677195</monospace> </td><td align="right"><monospace>0.22750817</monospace></td><td align="right"/><td align="right"/><td align="right"/></tr><tr><td><monospace>##</monospace></td><td><monospace>7</monospace></td><td align="right"><monospace>90</monospace></td><td align="right"><monospace>0.23927170</monospace></td><td align="right"><monospace>0.23916714</monospace></td><td align="right"><monospace>0.23994509</monospace></td><td align="right"/><td align="right"/><td align="right"/></tr><tr><td><monospace>##</monospace></td><td/><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/></tr><tr><td><monospace>##</monospace></td><td><monospace>$future.risk$‘6‘$Ovarian</monospace></td><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/></tr><tr><td><monospace>##</monospace></td><td/><td align="right"><monospace>ByAge</monospace></td><td align="right"><monospace>estimate</monospace></td><td align="right"><monospace>lower</monospace></td><td align="right"><monospace>upper</monospace></td><td align="right"/><td align="right"/><td align="right"/></tr><tr><td><monospace>##</monospace></td><td><monospace>1</monospace></td><td align="right"><monospace>60</monospace></td><td align="right"><monospace>0.03600079</monospace></td><td align="right"><monospace>0.03598267</monospace></td><td align="right"><monospace>0.17954734</monospace></td><td align="right"/><td align="right"/><td align="right"/></tr><tr><td><monospace>##</monospace></td><td><monospace>2</monospace></td><td align="right"><monospace>65</monospace></td><td align="right"><monospace>0.07186345</monospace></td><td align="right"><monospace>0.07183188</monospace></td><td align="right"><monospace>0.17954734</monospace></td><td align="right"/><td align="right"/><td align="right"/></tr><tr><td><monospace>##</monospace></td><td><monospace>3</monospace></td><td align="right"><monospace>70</monospace></td><td align="right"><monospace>0.10464159</monospace></td><td align="right"><monospace>0.10460004</monospace></td><td align="right"><monospace>0.10477485</monospace></td><td align="right"/><td align="right"/><td align="right"/></tr><tr><td><monospace>##</monospace></td><td><monospace>4</monospace></td><td align="right"><monospace>75</monospace></td><td align="right"><monospace>0.13238354</monospace></td><td align="right"><monospace>0.13233432</monospace></td><td align="right"><monospace>0.13253217</monospace></td><td align="right"/><td align="right"/><td align="right"/></tr><tr><td><monospace>##</monospace></td><td><monospace>5</monospace></td><td align="right"><monospace>80</monospace></td><td align="right"><monospace>0.15520230</monospace></td><td align="right"><monospace>0.13233432</monospace></td><td align="right"><monospace>0.15536227</monospace></td><td align="right"/><td align="right"/><td align="right"/></tr><tr><td><monospace>##</monospace></td><td><monospace>6</monospace></td><td align="right"><monospace>85</monospace></td><td align="right"><monospace>0.17183044</monospace></td><td align="right"><monospace>0.17177152</monospace></td><td align="right"><monospace>0.15536227</monospace></td><td align="right"/><td align="right"/><td align="right"/></tr><tr><td><monospace>##</monospace></td><td><monospace>7</monospace></td><td align="right"><monospace>90</monospace></td><td align="right"><monospace>0.17960786</monospace></td><td align="right"><monospace>0.17954734</monospace></td><td align="right"><monospace>0.15536227</monospace></td><td align="right"/><td align="right"/><td align="right"/></tr><tr><td/><td/><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/></tr><tr><td/><td/><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/><td align="right"/></tr></tbody></table></table-wrap><p>The package includes the function visRisk to visualize the output graphically. <xref ref-type="fig" rid="fig4">Figure 4</xref> demonstrates this usage for <italic><monospace>test_fam_1</monospace></italic>. The visRisk function was implemented using the plotly (<xref ref-type="bibr" rid="bib28">Sievert, 2020</xref>) package, so that the output can be rendered interactively and display the exact probabilities upon hovering.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Sample output using visRisk function.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig4-v2.tif"/></fig></sec><sec id="s1-6"><title>Additional examples</title><p>In this section, we display some of the other test pedigrees included in PanelPRO and their corresponding output from the visRisk function, as well as a comparison to some other platforms and models. We compared PanelPRO to: BRCAPRO and MMRPRO in BayesMendel (<xref ref-type="bibr" rid="bib9">Chen et al., 2004</xref>), CanRisk (<xref ref-type="bibr" rid="bib21">Lee et al., 2019</xref>; <xref ref-type="bibr" rid="bib7">Carver et al., 2021</xref>), IBIS (<xref ref-type="bibr" rid="bib32">Tyrer et al., 2004</xref>), and PREMM-5 (<xref ref-type="bibr" rid="bib18">Kastrinos et al., 2017</xref>), which all support different cancers, genes and model assumptions. <xref ref-type="table" rid="table4">Table 4</xref> summarizes the supported inputs and outputs of each model. If a particular model or platform does not support certain cancers, the irrelevant family history is simply omitted from input. For brevity, <xref ref-type="fig" rid="fig5">Figures 5</xref>–<xref ref-type="fig" rid="fig9">9</xref> provide visualizations of the pedigrees of these additional examples, and the corresponding model outputs are reported in as figure supplements. In all cases, we used the default model settings (if any). Many of the aforementioned platforms have long reports as outputs, so we have only included the portions concerned with carrier probabilities and future risks. The same information contained in the PanelPRO sample pedigrees is input to the other models; however not all of the features are used by these other platforms. Conversely, there are some inputs for the other models that PanelPRO does not include.</p><table-wrap id="table4" position="float"><label>Table 4.</label><caption><title>Comparison between supported cancers and genes in PanelPRO and other platforms.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Model or platform name</th><th>Version</th><th>Supported cancer input types</th><th>Supported gene carrier probability outputs</th><th>Supported future cancer risk outputs</th></tr></thead><tbody><tr><td>PanelPRO</td><td>0.2.0</td><td>Brain, breast, cervical, colorectal, endometrial, gastric, kidney, leukemia, melanoma, ovarian, osteosarcoma, pancreatic, small intestine, soft tissue sarcoma, thyroid, urinary bladder, hepatobiliary</td><td>APC, ATM, BARD1, BMPR1A, BRCA1, BRCA2, BRIP1, CDH1, CDK4, CDKN2A, CHEK2, EPCAM, MLH1, MSH2, MSH6, MUTYH, NBN, PALB2, PMS2, PTEN, RAD51C, RAD51D, STK11, TP53</td><td> same as cancer inputs</td></tr><tr><td>BRCAPRO</td><td>2.1–7</td><td>Breast, ovarian</td><td>BRCA1, BRCA2</td><td> same as cancer inputs</td></tr><tr><td>MMRPRO</td><td>2.1–7</td><td>Colorectal, endometrial</td><td>MLH1, MSH2, MSH6</td><td> same as cancer inputs</td></tr><tr><td>IBIS</td><td>0.8b</td><td>Breast</td><td>NA</td><td>Breast</td></tr><tr><td>CanRisk</td><td>1.2.3</td><td>Breast, contralateral breast, ovarian, prostate, pancreatic</td><td>BRCA1, BRCA2, PALB2, CHEK2, ATM, RAD51D, RAD51C, BRIP1</td><td>Breast, ovarian</td></tr><tr><td>PREMM-5</td><td>NA</td><td>Colorectal, endometrial, other (group of ovarian, stomach, small intestine, urinary tract/bladder/kidney, bile ducts, brain, pancreas, sebaceous gland skin)</td><td>MLH1, MSH2, MSH6, PMS2, EPCAM</td><td>NA</td></tr></tbody></table></table-wrap><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Sample pedigree <italic>test_fam_5</italic>.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>PanelPRO output with <italic>test_fam_5</italic> as pedigree input.</title><p>Graphical output from the visRisk function in PanelPRO for <italic>test_fam_5</italic>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig5-figsupp1-v2.tif"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 2.</label><caption><title>BRCAPRO output with <italic>test_fam_5</italic> as pedigree input.</title><p>Text output from the BRCAPRO model for <italic>test_fam_5</italic>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig5-figsupp2-v2.tif"/></fig><fig id="fig5s3" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 3.</label><caption><title>IBIS output with <italic>test_fam_5</italic> as pedigree input.</title><p>Screenshot of output from IBIS for <italic>test_fam_5</italic>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig5-figsupp3-v2.tif"/></fig></fig-group><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Sample pedigree <italic>test_fam_6</italic>.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig6-v2.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>PanelPRO output with <italic>test_fam_6</italic> as pedigree input.</title><p>Graphical output from the visRisk function in PanelPRO for <italic>test_fam_6</italic>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig6-figsupp1-v2.tif"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 2.</label><caption><title>BRCAPRO output with <italic>test_fam_6</italic> as pedigree input.</title><p>Text output from the BRCAPRO model for <italic>test_fam_6</italic>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig6-figsupp2-v2.tif"/></fig><fig id="fig6s3" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 3.</label><caption><title>MMRPRO output with <italic>test_fam_6</italic> as pedigree input.</title><p>Text output from the MMRPRO model for <italic>test_fam_6</italic>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig6-figsupp3-v2.tif"/></fig><fig id="fig6s4" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 4.</label><caption><title>IBIS output with <italic>test_fam_6</italic> as pedigree input.</title><p>Screenshot of output from IBIS for <italic>test_fam_6</italic>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig6-figsupp4-v2.tif"/></fig><fig id="fig6s5" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 5.</label><caption><title>PREMM-5 output with <italic>test_fam_6</italic> as pedigree input.</title><p>Screenshot of output from PREMM-5 for <italic>test_fam_6</italic>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig6-figsupp5-v2.tif"/></fig></fig-group><fig-group><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Sample pedigree <italic>test_fam_7</italic>.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig7-v2.tif"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 1.</label><caption><title>PanelPRO output with <italic>test_fam_7</italic> as pedigree input.</title><p>Graphical output from the visRisk function in PanelPRO for <italic>test_fam_7</italic>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig7-figsupp1-v2.tif"/></fig><fig id="fig7s2" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 2.</label><caption><title>MMRPRO output with <italic>test_fam_7</italic> as pedigree input.</title><p>Text output from the MMRPRO model for <italic>test_fam_7</italic>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig7-figsupp2-v2.tif"/></fig><fig id="fig7s3" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 3.</label><caption><title>PREMM-5 output with <italic>test_fam_7</italic> as pedigree input.</title><p>Screenshot of output from PREMM-5 for <italic>test_fam_7</italic>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig7-figsupp3-v2.tif"/></fig></fig-group><fig-group><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Sample pedigree <italic>test_fam_10</italic>.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig8-v2.tif"/></fig><fig id="fig8s1" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 1.</label><caption><title>PanelPRO output with <italic>test_fam_10</italic> as pedigree input.</title><p>Graphical output from the visRisk function in PanelPRO for <italic>test_fam_10</italic>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig8-figsupp1-v2.tif"/></fig><fig id="fig8s2" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 2.</label><caption><title>BRCAPRO output with <italic>test_fam_10</italic> as pedigree input.</title><p>Text output from the BRCAPRO model for <italic>test_fam_10</italic>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig8-figsupp2-v2.tif"/></fig><fig id="fig8s3" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 3.</label><caption><title>MMRPRO output with <italic>test_fam_10</italic> as pedigree input.</title><p>Text output from the MMRPRO model for <italic>test_fam_10</italic>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig8-figsupp3-v2.tif"/></fig><fig id="fig8s4" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 4.</label><caption><title>IBIS output with <italic>test_fam_1</italic> as pedigree input.</title><p>Screenshot of output from IBIS for <italic>test_fam_10</italic>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig8-figsupp4-v2.tif"/></fig><fig id="fig8s5" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 5.</label><caption><title>PREMM-5 output with test_fam_10 as pedigree input.</title><p>Screenshot of output from PREMM-5 for test_fam_10.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig8-figsupp5-v2.tif"/></fig></fig-group><fig-group><fig id="fig9" position="float"><label>Figure 9.</label><caption><title>Sample pedigree test_fam_11.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig9-v2.tif"/></fig><fig id="fig9s1" position="float" specific-use="child-fig"><label>Figure 9—figure supplement 1.</label><caption><title>PanelPRO output with test_fam_11 as pedigree input.</title><p>Graphical output from the visRisk function in PanelPRO for test_fam_11.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig9-figsupp1-v2.tif"/></fig><fig id="fig9s2" position="float" specific-use="child-fig"><label>Figure 9—figure supplement 2.</label><caption><title>BRCAPRO output with test_fam_11 as pedigree input.</title><p>Text output from the MMRPRO model for test_fam_11.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig9-figsupp2-v2.tif"/></fig><fig id="fig9s3" position="float" specific-use="child-fig"><label>Figure 9—figure supplement 3.</label><caption><title>MMRPRO output with test_fam_11 as pedigree input.</title><p>Text output from the MMRPRO model for test_fam_11.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig9-figsupp3-v2.tif"/></fig><fig id="fig9s4" position="float" specific-use="child-fig"><label>Figure 9—figure supplement 4.</label><caption><title>IBIS output with test_fam_11 as pedigree input.</title><p>Screenshot of output from IBIS for test_fam_11.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig9-figsupp4-v2.tif"/></fig><fig id="fig9s5" position="float" specific-use="child-fig"><label>Figure 9—figure supplement 5.</label><caption><title>PREMM-5 output with test_fam_11 as pedigree input.</title><p>Screenshot of output from PREMM-5 for test_fam_11</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig9-figsupp5-v2.tif"/></fig></fig-group><p>Notably, all the cancers and genes supported by these other models are a subset of those supported in PanelPRO, except for PREMM-5, which takes into consideration other cancers associated with Lynch syndrome which are not currently included in PanelPRO (bile duct and sebaceous gland). However, PREMM-5 does not provide the associated future risk for these additional cancers, only carrier probabilities for MLH1, MSH2, MSH6, PMS2, and EPCAM.</p><p>Comparing PanelPRO with BRCAPRO and MMRPRO, we see that PanelPRO offers carrier probability estimates for a larger set of genes, as well as a graphical output of the future risk. IBIS does not give any estimates for carrier probabilities; however, it gives a summary of the future risks in text format, relative to population averages. Finally, PREMM-5 gives an estimate of carrying any of five genes (MLH1, MSH2, MSH6, PMS2, or EPCAM), whilst PanelPRO is able to give estimates for each of those individual genes. PREMM-5 also does not give estimates for future risks of cancer.</p><p>Two pedigrees that illustrate the differences between PanelPRO and PREMM-5 are <italic>test_fam_7</italic> (<xref ref-type="fig" rid="fig5">Figure 5</xref>) and <italic>test_fam_11</italic> (<xref ref-type="fig" rid="fig9">Figure 9</xref>). For <italic>test_fam_7</italic>, PanelPRO estimates a 42.3% probability of carrying an MLH1, MSH2, MSH6, PMS2, or EPCAM mutation (when excluding the possibility of multiple simultaneous gene mutations), compared to 32% for PREMM-5. This pedigree only contains family history of colorectal and endometrial cancers, which PREMM-5 uses as key risk factors, leading to similar results. In contrast, the mutation probability estimates between the same two models for <italic>test_fam_11</italic> are quite different. This pedigree is an extreme example that contains history of endometrial, small intestine, ovarian, and pancreatic cancers, but PREMM-5 groups the latter three cancers into a single risk factor for any other Lynch syndrome-associated cancers. The differences in the model approaches and assumptions result in PanelPRO giving a 93% estimate for a mutation in any of the aforementioned genes (without multiple simultaneous gene mutations), while PREMM-5 returns 3.2%. <italic>test_fam_11</italic> is an extreme pedigree, but it nonetheless illustrates the flexibility of PanelPRO for incorporating very detailed pedigree information with a high clinical impact.</p></sec><sec id="s1-7"><title>Implementation summary</title><p>We list the key functions with their input(s) and output(s) in <xref ref-type="table" rid="table3">Table 3</xref>. The PanelPRO function calls the pre-processing functions and the algorithm engine in the back-end, so we expect that most users will only need to use this main function. However, the other functions can be called separately if desired. For example, users can call buildDatabase to inspect the database of model parameters or run checkFam to examine the pedigree after it has been checked.</p></sec><sec id="s1-8"><title>Methods: Mendelian modeling</title><p>In this section, we give the mathematical details of the main PanelPROCalc engine, which encompasses approximating genotype distributions of counselees and their future cancer risks.</p></sec><sec id="s1-9"><title>Genotype probabilities</title><p>PanelPRO predicts an individual’s probability of having a specified genotype. We use the notation in <xref ref-type="table" rid="table5">Table 5</xref>. Without loss of generality, let the subscript <inline-formula><mml:math id="inf7"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> represent the counselee (i.e. the individual who is counseled). For simplicity, we only consider one counselee, although the model can handle multiple counselees in a computationally efficient manner. The counselee’s genotype probability is: <disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><table-wrap id="table5" position="float"><label>Table 5.</label><caption><title>Notation for Mendelian Modeling for a model with <inline-formula><mml:math id="inf8"><mml:mi>K</mml:mi></mml:math></inline-formula> genes and <inline-formula><mml:math id="inf9"><mml:mi>R</mml:mi></mml:math></inline-formula> cancers and a family of <inline-formula><mml:math id="inf10"><mml:mi>I</mml:mi></mml:math></inline-formula> members.</title><p>The subscript <inline-formula><mml:math id="inf11"><mml:mi>i</mml:mi></mml:math></inline-formula> denotes the <inline-formula><mml:math id="inf12"><mml:mi>i</mml:mi></mml:math></inline-formula> th family member.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Variable and notation</th><th>Description</th><th>R object from user input, if applicable</th></tr></thead><tbody><tr><td>Genotypes</td><td/><td/></tr><tr><td><inline-formula><mml:math id="inf13"><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐆</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula></td><td>Genotype of individual <inline-formula><mml:math id="inf14"><mml:mi>i</mml:mi></mml:math></inline-formula>, where <inline-formula><mml:math id="inf15"><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the binary indicator for carrying a deleterious mutation in the <inline-formula><mml:math id="inf16"><mml:mi>k</mml:mi></mml:math></inline-formula> th gene</td><td/></tr><tr><td><inline-formula><mml:math id="inf17"><mml:mrow><mml:mi mathvariant="bold">𝐆</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐆</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>I</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula></td><td>Genotypes of all family members <inline-formula><mml:math id="inf18"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula></td><td/></tr><tr><td>Sex</td><td/><td/></tr><tr><td><inline-formula><mml:math id="inf19"><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula></td><td>Binary indicator that individual <inline-formula><mml:math id="inf20"><mml:mi>i</mml:mi></mml:math></inline-formula> is male</td><td>Sex</td></tr><tr><td><inline-formula><mml:math id="inf21"><mml:mrow><mml:mi mathvariant="bold">𝐔</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>I</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula></td><td>Binary male indicators for all family members <inline-formula><mml:math id="inf22"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula></td><td/></tr><tr><td>Cancer history</td><td/><td/></tr><tr><td><inline-formula><mml:math id="inf23"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td>Age of diagnosis of the <inline-formula><mml:math id="inf24"><mml:mi>r</mml:mi></mml:math></inline-formula> th cancer for individual <inline-formula><mml:math id="inf25"><mml:mi>i</mml:mi></mml:math></inline-formula></td><td>AgeXX</td></tr><tr><td><inline-formula><mml:math id="inf26"><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula></td><td>Individual i’ s censoring age (current age or age of death)</td><td>CurAge</td></tr><tr><td><inline-formula><mml:math id="inf27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="double-struck">I</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>Binary indicator that cancer <inline-formula><mml:math id="inf28"><mml:mi>r</mml:mi></mml:math></inline-formula> occurs before the censoring age for individual <inline-formula><mml:math id="inf29"><mml:mi>i</mml:mi></mml:math></inline-formula></td><td/></tr><tr><td><inline-formula><mml:math id="inf30"><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐇</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="5pt" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mtext>if </mml:mtext><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mtext>if </mml:mtext><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></inline-formula></td><td>Observed history of the <inline-formula><mml:math id="inf31"><mml:mi>r</mml:mi></mml:math></inline-formula> th cancer for individual <inline-formula><mml:math id="inf32"><mml:mi>i</mml:mi></mml:math></inline-formula>, not including risk modifiers and interventions</td><td/></tr><tr><td><inline-formula><mml:math id="inf33"><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐇</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐇</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>R</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula></td><td>All observed history for individual <inline-formula><mml:math id="inf34"><mml:mi>i</mml:mi></mml:math></inline-formula></td><td/></tr><tr><td><inline-formula><mml:math id="inf35"><mml:mrow><mml:mi mathvariant="bold">𝐇</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐇</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>I</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula></td><td>Observed histories for all family members <inline-formula><mml:math id="inf36"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula></td><td/></tr><tr><td><inline-formula><mml:math id="inf37"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula></td><td>Individual <inline-formula><mml:math id="inf38"><mml:mi>i</mml:mi></mml:math></inline-formula> ’s age of death from causes other than cancer <inline-formula><mml:math id="inf39"><mml:mi>r</mml:mi></mml:math></inline-formula></td><td/></tr><tr><td><inline-formula><mml:math id="inf40"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td><td>Individual <inline-formula><mml:math id="inf41"><mml:mi>i</mml:mi></mml:math></inline-formula> ’s age of first outcome, either cancer <inline-formula><mml:math id="inf42"><mml:mi>r</mml:mi></mml:math></inline-formula> or death from causes other than cancer <inline-formula><mml:math id="inf43"><mml:mi>r</mml:mi></mml:math></inline-formula></td><td/></tr><tr><td><inline-formula><mml:math id="inf44"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>I</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td><td>Binary indicator that individual <inline-formula><mml:math id="inf45"><mml:mi>i</mml:mi></mml:math></inline-formula> develops the <inline-formula><mml:math id="inf46"><mml:mi>r</mml:mi></mml:math></inline-formula> th cancer</td><td>isAffXX</td></tr></tbody></table></table-wrap><p>Using Bayes’ rule, the law of total probability and the assumption of independence of family phenotypes given genotypes and sex, this can be written as<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mtd><mml:mtd><mml:mo>∝</mml:mo><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>From this representation of the posterior probability, we can clearly see the model and user inputs to PanelPRO. <inline-formula><mml:math id="inf47"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐆</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> represents the allele frequencies for each gene in the model. <inline-formula><mml:math id="inf48"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi mathvariant="bold">𝐇</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mpadded><mml:mo lspace="2.5pt" rspace="4.2pt" stretchy="false">|</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐆</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are derived from the cancer penetrances <inline-formula><mml:math id="inf49"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>t</mml:mi></mml:mpadded><mml:mo rspace="4.2pt" stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐆</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Explicitly,<disp-formula id="equ3"><mml:math id="m3"><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>𝐇</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mpadded><mml:mo lspace="2.5pt" rspace="4.2pt" stretchy="false">|</mml:mo><mml:mrow><mml:msub><mml:mi>𝐆</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msubsup></mml:mstyle><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>s</mml:mi></mml:mpadded><mml:mo rspace="4.2pt" stretchy="false">|</mml:mo><mml:msub><mml:mi>𝐆</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow> <mml:mtext>if </mml:mtext><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mpadded><mml:mo rspace="4.2pt" stretchy="false">|</mml:mo><mml:msub><mml:mi>𝐆</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow> <mml:mtext>if </mml:mtext><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf50"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the random variable and <inline-formula><mml:math id="inf51"><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is the observed cancer age. By default, the allele frequencies and penetrances are obtained from existing peer-reviewed studies and estimates, but are completely customizable within PanelPRO.</p><p>Since the genotype space <inline-formula><mml:math id="inf52"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐆</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐆</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐆</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mi>K</mml:mi></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> is large for large values of <inline-formula><mml:math id="inf53"><mml:mi>K</mml:mi></mml:math></inline-formula>, we use the peeling-paring algorithm (<xref ref-type="bibr" rid="bib23">Madsen et al., 2018</xref>) as an approximation, only allowing a pre-specified number of mutations to be simultaneously present in the same individual. The pedigree structure from the user input is used to derive the <inline-formula><mml:math id="inf54"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐆</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi mathvariant="bold">𝐆</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mpadded><mml:mo lspace="2.5pt" rspace="4.2pt" stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐆</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> term in <xref ref-type="disp-formula" rid="equ4">Equation</xref> 2 using Mendelian laws of inheritance.</p></sec><sec id="s1-10"><title>Future cancer risk</title><p>PanelPRO also estimates future cancer risk, based on the previously calculated genotype distribution of the individual. Suppose the counselee has not developed the <inline-formula><mml:math id="inf55"><mml:mi>r</mml:mi></mml:math></inline-formula> th cancer by their current age. Then the risk of developing the <inline-formula><mml:math id="inf56"><mml:mi>r</mml:mi></mml:math></inline-formula> th cancer in <italic>t</italic><sub>0</sub> years is<disp-formula id="equ4"><label>(3)</label><mml:math id="m4"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>≤</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:mn>1</mml:mn></mml:mpadded><mml:mo rspace="4.2pt" stretchy="false">|</mml:mo><mml:mi>𝐇</mml:mi><mml:mo>,</mml:mo><mml:mi>𝐔</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:msub><mml:mi>𝐆</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:munder></mml:mstyle><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>≤</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:mn>1</mml:mn></mml:mpadded><mml:mo rspace="4.2pt" stretchy="false">|</mml:mo><mml:msub><mml:mi>𝐆</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>𝐔</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>𝐆</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mpadded><mml:mo rspace="4.2pt" stretchy="false">|</mml:mo><mml:mi>𝐇</mml:mi><mml:mo>,</mml:mo><mml:mi>𝐔</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ4">Equation 3</xref> produces so-called ‘crude’ risk, since competing risks of death from causes other than the specified cancer are accounted for. Thus, the reported future risk is the probability that the counselee develops the <inline-formula><mml:math id="inf57"><mml:mi>r</mml:mi></mml:math></inline-formula> th cancer within the next <italic>t</italic><sub>0</sub> years and does not die from other causes beforehand, given the cancer history and sexes of the family. <inline-formula><mml:math id="inf58"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>≤</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:mn>1</mml:mn></mml:mpadded><mml:mo rspace="4.2pt" stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐆</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">𝐔</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the crude penetrance and is also a model input with default values estimated from the literature.</p><p>PanelPRO also provides the option to report ‘net’ future risk, which is the probability that the counselee develops the <inline-formula><mml:math id="inf59"><mml:mi>r</mml:mi></mml:math></inline-formula> th cancer in a hypothetical world where they cannot die from other causes, given the cancer history and sexes of the family. This risk type is not as realistic but some clinicians find it useful, as it focuses on the specified cancer and allows them to factor qualitatively the patient-specific covariates that may affect the patient’s risk. To report net future risk, PanelPRO uses the net penetrances <inline-formula><mml:math id="inf60"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>t</mml:mi></mml:mpadded><mml:mo rspace="4.2pt" stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐆</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Note that the genotype probabilities in Equation 2 were calculated using net penetrances, as we do not collect death from other causes as a user input.</p></sec></sec><sec id="s2" sec-type="discussion"><title>Discussion</title><p>PanelPRO is a highly flexible package which provides an interface to efficiently calculate carrier probabilities for a wide array of cancer susceptibility genes, as well as future cancer risks. It is designed for R users. Similarly to the BayesMendel package, it can provide the computational engine behind clinical and counseling decision support tools.</p><p>It excels in being fully customizable. Any combination of the 24 genes and 18 cancers currently in version 0.2.0 of the package can be included in the model. New genes and cancers can easily be added, and in fact the code allows for an arbitrary number of genes and cancers. Risk modifiers have been included for certain procedures, and more can be added as additional information becomes available. The user can also change the internal database of parameter values.</p><p>The package includes a comprehensive check on the input pedigree to ensure users are informed of potentially inconsistent or infeasible data entries. When it is possible to do so safely, the data is automatically remedied and the user is then notified. Otherwise, the program will halt with an informative error message. Once the pedigree is pre-processed, the posterior probabilities are calculated efficiently. For example, <italic>test_fam_1</italic>, which has 19 members and family history of 2 cancers, runs with all the default settings in a few seconds as shown in <xref ref-type="fig" rid="fig10">Figure 10</xref>. The polynomial run-time of the peeling-paring algorithm is alleviated with PanelPRO’s Rcpp implementation. Even when relaxing the maximum mutations (paring) parameter, the C++ implementation is able to handle the calculations efficiently. Run-times in these ranges are certainly appropriate for clinical use, as well as use in a research setting where possibly hundreds of pedigrees have to be processed through PanelPRO. Moreover, the peeling-paring algorithm run-time scales linearly in the number of family members in the pedigree and can handle hundreds of members in an inter-generational configuration easily.</p><fig id="fig10" position="float"><label>Figure 10.</label><caption><title>Sample run-times for <italic>test_fam_1</italic> evaluated by PanelPRO on the default settings, as a function of the number of genes considered.</title><p>The paring parameter is set to 2. These run time experiments were performed on a 2020 Linux machine with an 11th Gen Intel(R) i7-1165G7 chip at 2.80 GHz.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-fig10-v2.tif"/></fig><p>PanelPRO has two main limitations. Firstly, the initial release does not handle pedigrees which contain loops. This additional functionality would be desirable in future releases, although loops in pedigrees do not happen frequently. Several studies suggest either exact or approximate computations for pedigrees with loops, see <xref ref-type="bibr" rid="bib30">Stricker et al., 1995</xref> and <xref ref-type="bibr" rid="bib31">Totir et al., 2009</xref>. Secondly, the polynomial scaling of peeling-paring as a function of the number of genes considered becomes significant when many genes are incorporated. This issue is of concern because we strive for future releases to contain far more genes than 24 as data becomes available. Alternative algorithms which have different time complexity properties, such as the Lander-Green family of algorithms (<xref ref-type="bibr" rid="bib19">Lander and Green, 1987</xref>), should be explored. These algorithms scale linearly in terms of the number of genes considered, but are exponential in the number of family members in the pedigree (<xref ref-type="bibr" rid="bib17">Gao et al., 2009</xref>). A future objective for this package is to contain a choice of the carrier probability calculation method, and ideally an automatic selection of the one which is most efficient, depending on family size and total number of genes. Appropriate thresholds of these two parameters need to be determined by a comprehensive benchmarking exercise.</p></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We gratefully acknowledge support from the National Cancer Institute at the National Institutes of Health grants 5T32CA009337 (JWL and TH), 2T32CA009001 (TH), and 4P30CA006516 (GP).</p></ack><sec id="s3" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Software, Investigation, Methodology, Writing - original draft</p></fn><fn fn-type="con" id="con2"><p>Software, Formal analysis, Validation, Methodology, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Software, Validation, Investigation, Methodology</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Data curation, Software, Investigation, Methodology, Writing - review and editing</p></fn><fn fn-type="con" id="con5"><p>Supervision, Investigation, Methodology, Project administration, Writing - review and editing</p></fn><fn fn-type="con" id="con6"><p>Conceptualization, Formal analysis, Supervision, Methodology, Project administration, Writing - review and editing</p></fn><fn fn-type="con" id="con7"><p>Conceptualization, Supervision, Methodology, Project administration, Writing - review and editing</p></fn></fn-group></sec><sec id="s4" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-68699-transrepform-v2.docx.pdf"/></supplementary-material></sec><sec id="s5" sec-type="data-availability"><title>Data availability</title><p>This manuscript introduces PanelPRO, an innovative multi-gene multi-cancer Mendelian model. Software for this model, including the model parameter database, is available to download for research use; <ext-link ext-link-type="uri" xlink:href="https://projects.iq.harvard.edu/bayesmendel/panelpro">https://projects.iq.harvard.edu/bayesmendel/panelpro</ext-link>.</p><p>The following dataset was generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>G</given-names></name><name><surname>Liang</surname><given-names>JW</given-names></name><name><surname>Zhang</surname><given-names>Q</given-names></name><name><surname>Huang</surname><given-names>T</given-names></name><name><surname>Choirat</surname><given-names>C</given-names></name><name><surname>Parmigani</surname><given-names>G</given-names></name><name><surname>Braun</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>PanelPRO R Package</data-title><source>PanelPRO R Package</source><pub-id assigning-authority="other" pub-id-type="accession" xlink:href="https://projects.iq.harvard.edu/bayesmendel/panelpro">projects.iq.harvard.edu/bayesmendel/panelpro</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Antoniou</surname> <given-names>AC</given-names></name><name><surname>Pharoah</surname> <given-names>PD</given-names></name><name><surname>McMullan</surname> <given-names>G</given-names></name><name><surname>Day</surname> <given-names>NE</given-names></name><name><surname>Stratton</surname> <given-names>MR</given-names></name><name><surname>Peto</surname> <given-names>J</given-names></name><name><surname>Ponder</surname> <given-names>BJ</given-names></name><name><surname>Easton</surname> <given-names>DF</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>A comprehensive model for familial breast Cancer incorporating BRCA1, BRCA2 and other genes</article-title><source>British Journal of Cancer</source><volume>86</volume><fpage>76</fpage><lpage>83</lpage><pub-id pub-id-type="doi">10.1038/sj.bjc.6600008</pub-id><pub-id pub-id-type="pmid">11857015</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Begg</surname> <given-names>CB</given-names></name><name><surname>Orlow</surname> <given-names>I</given-names></name><name><surname>Hummer</surname> <given-names>AJ</given-names></name><name><surname>Armstrong</surname> <given-names>BK</given-names></name><name><surname>Kricker</surname> <given-names>A</given-names></name><name><surname>Marrett</surname> <given-names>LD</given-names></name><name><surname>Millikan</surname> <given-names>RC</given-names></name><name><surname>Gruber</surname> <given-names>SB</given-names></name><name><surname>Anton-Culver</surname> <given-names>H</given-names></name><name><surname>Zanetti</surname> <given-names>R</given-names></name><name><surname>Gallagher</surname> <given-names>RP</given-names></name><name><surname>Dwyer</surname> <given-names>T</given-names></name><name><surname>Rebbeck</surname> <given-names>TR</given-names></name><name><surname>Mitra</surname> <given-names>N</given-names></name><name><surname>Busam</surname> <given-names>K</given-names></name><name><surname>From</surname> <given-names>L</given-names></name><name><surname>Berwick</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Lifetime risk of melanoma in CDKN2A mutation carriers in a Population-Based sample</article-title><source>JNCI: Journal of the National Cancer Institute</source><volume>97</volume><fpage>1507</fpage><lpage>1515</lpage><pub-id pub-id-type="doi">10.1093/jnci/dji312</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berwick</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>The prevalence of CDKN2A Germ-Line mutations and relative risk for cutaneous malignant melanoma: an international Population-Based study</article-title><source>Cancer Epidemiology Biomarkers &amp; Prevention</source><volume>15</volume><fpage>1520</fpage><lpage>1525</lpage><pub-id pub-id-type="doi">10.1158/1055-9965.EPI-06-0270</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bishop</surname> <given-names>DT</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Geographical variation in the penetrance of CDKN2A mutations for melanoma</article-title><source>CancerSpectrum Knowledge Environment</source><volume>94</volume><fpage>894</fpage><lpage>903</lpage><pub-id pub-id-type="doi">10.1093/jnci/94.12.894</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Biswas</surname> <given-names>S</given-names></name><name><surname>Atienza</surname> <given-names>P</given-names></name><name><surname>Chipman</surname> <given-names>J</given-names></name><name><surname>Hughes</surname> <given-names>K</given-names></name><name><surname>Barrera</surname> <given-names>AMG</given-names></name><name><surname>Amos</surname> <given-names>CI</given-names></name><name><surname>Arun</surname> <given-names>B</given-names></name><name><surname>Parmigiani</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Simplifying clinical use of the genetic risk prediction model BRCAPRO</article-title><source>Breast Cancer Research and Treatment</source><volume>139</volume><fpage>571</fpage><lpage>579</lpage><pub-id pub-id-type="doi">10.1007/s10549-013-2564-4</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Braun</surname> <given-names>D</given-names></name><name><surname>Yang</surname> <given-names>J</given-names></name><name><surname>Griffin</surname> <given-names>M</given-names></name><name><surname>Parmigiani</surname> <given-names>G</given-names></name><name><surname>Hughes</surname> <given-names>KS</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A clinical decision support tool to predict Cancer risk for commonly tested Cancer-Related germline mutations</article-title><source>Journal of Genetic Counseling</source><volume>27</volume><fpage>1187</fpage><lpage>1199</lpage><pub-id pub-id-type="doi">10.1007/s10897-018-0238-4</pub-id><pub-id pub-id-type="pmid">29500626</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carver</surname> <given-names>T</given-names></name><name><surname>Hartley</surname> <given-names>S</given-names></name><name><surname>Lee</surname> <given-names>A</given-names></name><name><surname>Cunningham</surname> <given-names>AP</given-names></name><name><surname>Archer</surname> <given-names>S</given-names></name><name><surname>Babb de Villiers</surname> <given-names>C</given-names></name><name><surname>Roberts</surname> <given-names>J</given-names></name><name><surname>Ruston</surname> <given-names>R</given-names></name><name><surname>Walter</surname> <given-names>FM</given-names></name><name><surname>Tischkowitz</surname> <given-names>M</given-names></name><name><surname>Easton</surname> <given-names>DF</given-names></name><name><surname>Antoniou</surname> <given-names>AC</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>CanRisk Tool—A Web Interface for the Prediction of Breast and Ovarian Cancer Risk and the Likelihood of Carrying Genetic Pathogenic Variants</article-title><source>Cancer Epidemiology Biomarkers &amp; Prevention</source><volume>30</volume><fpage>469</fpage><lpage>473</lpage><pub-id pub-id-type="doi">10.1158/1055-9965.EPI-20-1319</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="software"><person-group person-group-type="author"><collab>Centre for Cancer Genetic Epidemiology</collab></person-group><year iso-8601-date="2020">2020</year><source>BOADICEA Model Description</source><ext-link ext-link-type="uri" xlink:href="https://ccge.medschl.cam.ac.uk/boadicea/boadicea-model/">https://ccge.medschl.cam.ac.uk/boadicea/boadicea-model/</ext-link></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname> <given-names>S</given-names></name><name><surname>Wang</surname> <given-names>W</given-names></name><name><surname>Broman</surname> <given-names>KW</given-names></name><name><surname>Katki</surname> <given-names>HA</given-names></name><name><surname>Parmigiani</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>BayesMendel: an R Environment for Mendelian Risk Prediction</article-title><source>Statistical Applications in Genetics and Molecular Biology</source><volume>3</volume><fpage>1</fpage><lpage>19</lpage><pub-id pub-id-type="doi">10.2202/1544-6115.1063</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname> <given-names>S</given-names></name><name><surname>Wang</surname> <given-names>W</given-names></name><name><surname>Lee</surname> <given-names>S</given-names></name><name><surname>Nafa</surname> <given-names>K</given-names></name><name><surname>Lee</surname> <given-names>J</given-names></name><name><surname>Romans</surname> <given-names>K</given-names></name><name><surname>Watson</surname> <given-names>P</given-names></name><name><surname>Gruber</surname> <given-names>SB</given-names></name><name><surname>Euhus</surname> <given-names>D</given-names></name><name><surname>Kinzler</surname> <given-names>KW</given-names></name><name><surname>Jass</surname> <given-names>J</given-names></name><name><surname>Gallinger</surname> <given-names>S</given-names></name><name><surname>Lindor</surname> <given-names>NM</given-names></name><name><surname>Casey</surname> <given-names>G</given-names></name><name><surname>Ellis</surname> <given-names>N</given-names></name><name><surname>Giardiello</surname> <given-names>FM</given-names></name><name><surname>Offit</surname> <given-names>K</given-names></name><name><surname>Parmigiani</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Prediction of germline mutations and Cancer risk in the lynch syndrome</article-title><source>Jama</source><volume>296</volume><fpage>1479</fpage><lpage>1487</lpage><pub-id pub-id-type="doi">10.1001/jama.296.12.1479</pub-id><pub-id pub-id-type="pmid">17003396</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname> <given-names>J</given-names></name><name><surname>Bae</surname> <given-names>E</given-names></name><name><surname>Zhang</surname> <given-names>L</given-names></name><name><surname>Hughes</surname> <given-names>K</given-names></name><name><surname>Parmigiani</surname> <given-names>G</given-names></name><name><surname>Braun</surname> <given-names>D</given-names></name><name><surname>Rebbeck</surname> <given-names>TR</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Penetrance of breast and ovarian Cancer in women who carry a <italic>BRCA1/2</italic> Mutation and Do Not Use Risk-Reducing Salpingo-Oophorectomy: An Updated Meta-Analysis</article-title><source>JNCI Cancer Spectrum</source><volume>4</volume><elocation-id>pkaa029</elocation-id><pub-id pub-id-type="doi">10.1093/jncics/pkaa029</pub-id><pub-id pub-id-type="pmid">32676552</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eddelbuettel</surname> <given-names>D</given-names></name><name><surname>Francois</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Rcpp: seamless r and c++ integration</article-title><source>Journal of Statistical Software</source><volume>40</volume><fpage>1</fpage><lpage>18</lpage><pub-id pub-id-type="doi">10.18637/jss.v040.i08</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eddelbuettel</surname> <given-names>D</given-names></name><name><surname>Sanderson</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>RcppArmadillo: accelerating R with high-performance C++ linear algebra</article-title><source>Computational Statistics &amp; Data Analysis</source><volume>71</volume><fpage>1054</fpage><lpage>1063</lpage><pub-id pub-id-type="doi">10.1016/j.csda.2013.02.005</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Elston</surname> <given-names>RC</given-names></name><name><surname>Stewart</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1971">1971</year><article-title>A general model for the genetic analysis of pedigree data</article-title><source>Human Heredity</source><volume>21</volume><fpage>523</fpage><lpage>542</lpage><pub-id pub-id-type="doi">10.1159/000152448</pub-id><pub-id pub-id-type="pmid">5149961</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Felton</surname> <given-names>KE</given-names></name><name><surname>Gilchrist</surname> <given-names>DM</given-names></name><name><surname>Andrew</surname> <given-names>SE</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Constitutive deficiency in DNA mismatch repair: is it time for lynch III?</article-title><source>Clinical Genetics</source><volume>71</volume><fpage>499</fpage><lpage>500</lpage><pub-id pub-id-type="doi">10.1111/j.1399-0004.2007.00801.x</pub-id><pub-id pub-id-type="pmid">17539898</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fernando</surname> <given-names>RL</given-names></name><name><surname>Stricker</surname> <given-names>C</given-names></name><name><surname>Elston</surname> <given-names>RC</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>An efficient algorithm to compute the posterior genotypic distribution for every member of a pedigree without loops</article-title><source>Theoretical and Applied Genetics</source><volume>87</volume><fpage>89</fpage><lpage>93</lpage><pub-id pub-id-type="doi">10.1007/BF00223750</pub-id><pub-id pub-id-type="pmid">24190198</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gao</surname> <given-names>G</given-names></name><name><surname>Allison</surname> <given-names>DB</given-names></name><name><surname>Hoeschele</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Haplotyping methods for pedigrees</article-title><source>Human Heredity</source><volume>67</volume><fpage>248</fpage><lpage>266</lpage><pub-id pub-id-type="doi">10.1159/000194978</pub-id><pub-id pub-id-type="pmid">19172084</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kastrinos</surname> <given-names>F</given-names></name><name><surname>Uno</surname> <given-names>H</given-names></name><name><surname>Ukaegbu</surname> <given-names>C</given-names></name><name><surname>Alvero</surname> <given-names>C</given-names></name><name><surname>McFarland</surname> <given-names>A</given-names></name><name><surname>Yurgelun</surname> <given-names>MB</given-names></name><name><surname>Kulke</surname> <given-names>MH</given-names></name><name><surname>Schrag</surname> <given-names>D</given-names></name><name><surname>Meyerhardt</surname> <given-names>JA</given-names></name><name><surname>Fuchs</surname> <given-names>CS</given-names></name><name><surname>Mayer</surname> <given-names>RJ</given-names></name><name><surname>Ng</surname> <given-names>K</given-names></name><name><surname>Steyerberg</surname> <given-names>EW</given-names></name><name><surname>Syngal</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Development and validation of the PREMM<sub>5</sub>model for comprehensive risk assessment of lynch syndrome</article-title><source>Journal of Clinical Oncology</source><volume>35</volume><fpage>2165</fpage><lpage>2172</lpage><pub-id pub-id-type="doi">10.1200/JCO.2016.69.6120</pub-id><pub-id pub-id-type="pmid">28489507</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lander</surname> <given-names>ES</given-names></name><name><surname>Green</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Construction of multilocus genetic linkage maps in humans</article-title><source>PNAS</source><volume>84</volume><fpage>2363</fpage><lpage>2367</lpage><pub-id pub-id-type="doi">10.1073/pnas.84.8.2363</pub-id><pub-id pub-id-type="pmid">3470801</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname> <given-names>AJ</given-names></name><name><surname>Cunningham</surname> <given-names>AP</given-names></name><name><surname>Tischkowitz</surname> <given-names>M</given-names></name><name><surname>Simard</surname> <given-names>J</given-names></name><name><surname>Pharoah</surname> <given-names>PD</given-names></name><name><surname>Easton</surname> <given-names>DF</given-names></name><name><surname>Antoniou</surname> <given-names>AC</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Incorporating truncating variants in PALB2, CHEK2, and ATM into the BOADICEA breast Cancer risk model</article-title><source>Genetics in Medicine</source><volume>18</volume><fpage>1190</fpage><lpage>1198</lpage><pub-id pub-id-type="doi">10.1038/gim.2016.31</pub-id><pub-id pub-id-type="pmid">27464310</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname> <given-names>A</given-names></name><name><surname>Mavaddat</surname> <given-names>N</given-names></name><name><surname>Wilcox</surname> <given-names>AN</given-names></name><name><surname>Cunningham</surname> <given-names>AP</given-names></name><name><surname>Carver</surname> <given-names>T</given-names></name><name><surname>Hartley</surname> <given-names>S</given-names></name><name><surname>Babb de Villiers</surname> <given-names>C</given-names></name><name><surname>Izquierdo</surname> <given-names>A</given-names></name><name><surname>Simard</surname> <given-names>J</given-names></name><name><surname>Schmidt</surname> <given-names>MK</given-names></name><name><surname>Walter</surname> <given-names>FM</given-names></name><name><surname>Chatterjee</surname> <given-names>N</given-names></name><name><surname>Garcia-Closas</surname> <given-names>M</given-names></name><name><surname>Tischkowitz</surname> <given-names>M</given-names></name><name><surname>Pharoah</surname> <given-names>P</given-names></name><name><surname>Easton</surname> <given-names>DF</given-names></name><name><surname>Antoniou</surname> <given-names>AC</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>BOADICEA: a comprehensive breast Cancer risk prediction model incorporating genetic and nongenetic risk factors</article-title><source>Genetics in Medicine</source><volume>21</volume><fpage>1708</fpage><lpage>1718</lpage><pub-id pub-id-type="doi">10.1038/s41436-018-0406-9</pub-id><pub-id pub-id-type="pmid">30643217</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Lee</surname> <given-names>GK</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>visPed</data-title><source>GitHub </source><version designator="bd17577">bd17577</version><ext-link ext-link-type="uri" xlink:href="https://github.com/bayesmendel/visPed">https://github.com/bayesmendel/visPed</ext-link></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Madsen</surname> <given-names>T</given-names></name><name><surname>Braun</surname> <given-names>D</given-names></name><name><surname>Peng</surname> <given-names>G</given-names></name><name><surname>Parmigiani</surname> <given-names>G</given-names></name><name><surname>Trippa</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Efficient computation of the joint probability of multiple inherited risk alleles from pedigree data</article-title><source>Genetic Epidemiology</source><volume>42</volume><fpage>528</fpage><lpage>538</lpage><pub-id pub-id-type="doi">10.1002/gepi.22130</pub-id><pub-id pub-id-type="pmid">29943416</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Manahan</surname> <given-names>ER</given-names></name><name><surname>Kuerer</surname> <given-names>HM</given-names></name><name><surname>Sebastian</surname> <given-names>M</given-names></name><name><surname>Hughes</surname> <given-names>KS</given-names></name><name><surname>Boughey</surname> <given-names>JC</given-names></name><name><surname>Euhus</surname> <given-names>DM</given-names></name><name><surname>Boolbol</surname> <given-names>SK</given-names></name><name><surname>Taylor</surname> <given-names>WA</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Consensus guidelines on genetic` testing for hereditary breast Cancer from the american society of breast surgeons</article-title><source>Annals of Surgical Oncology</source><volume>26</volume><fpage>3025</fpage><lpage>3031</lpage><pub-id pub-id-type="doi">10.1245/s10434-019-07549-8</pub-id><pub-id pub-id-type="pmid">31342359</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nelson</surname> <given-names>HD</given-names></name><name><surname>Pappas</surname> <given-names>M</given-names></name><name><surname>Zakher</surname> <given-names>B</given-names></name><name><surname>Mitchell</surname> <given-names>JP</given-names></name><name><surname>Okinaka-Hu</surname> <given-names>L</given-names></name><name><surname>Fu</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Risk assessment, genetic counseling, and genetic testing for BRCA-related Cancer in women: a systematic review to update the U.S. preventive services task force recommendation</article-title><source>Annals of Internal Medicine</source><volume>160</volume><fpage>255</fpage><lpage>266</lpage><pub-id pub-id-type="doi">10.7326/M13-1684</pub-id><pub-id pub-id-type="pmid">24366442</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Plichta</surname> <given-names>JK</given-names></name><name><surname>Griffin</surname> <given-names>M</given-names></name><name><surname>Thakuria</surname> <given-names>J</given-names></name><name><surname>Hughes</surname> <given-names>KS</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>What’s new in genetic testing for cancer susceptibility?</article-title><source>Oncology</source><volume>30</volume><fpage>787</fpage><lpage>799</lpage><pub-id pub-id-type="pmid">27633409</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosenthal</surname> <given-names>ET</given-names></name><name><surname>Bernhisel</surname> <given-names>R</given-names></name><name><surname>Brown</surname> <given-names>K</given-names></name><name><surname>Kidd</surname> <given-names>J</given-names></name><name><surname>Manley</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Clinical testing with a panel of 25 genes associated with increased Cancer risk results in a significant increase in clinically significant findings across a broad range of Cancer histories</article-title><source>Cancer Genetics</source><volume>218-219</volume><fpage>58</fpage><lpage>68</lpage><pub-id pub-id-type="doi">10.1016/j.cancergen.2017.09.003</pub-id><pub-id pub-id-type="pmid">29153097</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sievert</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2020">2020</year><source>Interactive Web-Based Data Visualization with R, Plotly, and Shiny</source><publisher-name>Chapman and Hall/CRC</publisher-name></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sinnwell</surname> <given-names>JP</given-names></name><name><surname>Therneau</surname> <given-names>TM</given-names></name><name><surname>Schaid</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The kinship2 R package for pedigree data</article-title><source>Human Heredity</source><volume>78</volume><fpage>91</fpage><lpage>93</lpage><pub-id pub-id-type="doi">10.1159/000363105</pub-id><pub-id pub-id-type="pmid">25074474</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stricker</surname> <given-names>C</given-names></name><name><surname>Fernando</surname> <given-names>RL</given-names></name><name><surname>Elston</surname> <given-names>RC</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>An algorithm to approximate the likelihood for pedigree data with loops by cutting</article-title><source>Theoretical and Applied Genetics</source><volume>91</volume><fpage>1054</fpage><lpage>1063</lpage><pub-id pub-id-type="doi">10.1007/BF00223919</pub-id><pub-id pub-id-type="pmid">24169996</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Totir</surname> <given-names>LR</given-names></name><name><surname>Fernando</surname> <given-names>RL</given-names></name><name><surname>Abraham</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>An efficient algorithm to compute marginal posterior genotype probabilities for every member of a pedigree with loops</article-title><source>Genetics Selection Evolution</source><volume>41</volume><elocation-id>52</elocation-id><pub-id pub-id-type="doi">10.1186/1297-9686-41-52</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tyrer</surname> <given-names>J</given-names></name><name><surname>Duffy</surname> <given-names>SW</given-names></name><name><surname>Cuzick</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>A breast Cancer prediction model incorporating familial and personal risk factors</article-title><source>Statistics in Medicine</source><volume>23</volume><fpage>1111</fpage><lpage>1130</lpage><pub-id pub-id-type="doi">10.1002/sim.1668</pub-id><pub-id pub-id-type="pmid">15057881</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname> <given-names>W</given-names></name><name><surname>Niendorf</surname> <given-names>KB</given-names></name><name><surname>Patel</surname> <given-names>D</given-names></name><name><surname>Blackford</surname> <given-names>A</given-names></name><name><surname>Marroni</surname> <given-names>F</given-names></name><name><surname>Sober</surname> <given-names>AJ</given-names></name><name><surname>Parmigiani</surname> <given-names>G</given-names></name><name><surname>Tsao</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Estimating <italic>CDKN2A</italic> carrier probability and personalizing Cancer risk assessments in hereditary melanoma using MelaPRO</article-title><source>Cancer Research</source><volume>70</volume><fpage>552</fpage><lpage>559</lpage><pub-id pub-id-type="doi">10.1158/0008-5472.CAN-09-2653</pub-id><pub-id pub-id-type="pmid">20068151</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname> <given-names>C</given-names></name><name><surname>Wang</surname> <given-names>Y</given-names></name><name><surname>Hughes</surname> <given-names>KS</given-names></name><name><surname>Parmigiani</surname> <given-names>G</given-names></name><name><surname>Braun</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Penetrance of colorectal Cancer among mismatch repair gene mutation carriers: a Meta-Analysis</article-title><source>JNCI Cancer Spectrum</source><volume>4</volume><elocation-id>pkaa027</elocation-id><pub-id pub-id-type="doi">10.1093/jncics/pkaa027</pub-id><pub-id pub-id-type="pmid">32923933</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Welch</surname> <given-names>BM</given-names></name><name><surname>Wiley</surname> <given-names>K</given-names></name><name><surname>Pflieger</surname> <given-names>L</given-names></name><name><surname>Achiangia</surname> <given-names>R</given-names></name><name><surname>Baker</surname> <given-names>K</given-names></name><name><surname>Hughes-Halbert</surname> <given-names>C</given-names></name><name><surname>Morrison</surname> <given-names>H</given-names></name><name><surname>Schiffman</surname> <given-names>J</given-names></name><name><surname>Doerr</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Review and comparison of electronic Patient-Facing family health history tools</article-title><source>Journal of Genetic Counseling</source><volume>27</volume><fpage>381</fpage><lpage>391</lpage><pub-id pub-id-type="doi">10.1007/s10897-018-0235-7</pub-id><pub-id pub-id-type="pmid">29512060</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><boxed-text><sec id="s6" sec-type="appendix"><title>In depth package workflow</title><sec id="s6-1"><title>Cancer name mapping</title><fig id="app1fig1" position="float"><label>Appendix 1—figure 1.</label><caption><title>PanelPRO in depth package workflow.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68699-app1-fig1-v2.tif"/></fig><table-wrap id="app1table1" position="float"><label>Appendix 1—table 1.</label><caption><title>Abbreviations of cancers in PanelPRO.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Short name</th><th>Long name</th><th>Short name</th><th>Long name</th></tr></thead><tbody><tr><td>BRA</td><td>Brain</td><td>OC</td><td>Ovarian</td></tr><tr><td>BC</td><td>Breast</td><td>OST</td><td>Osteosarcoma</td></tr><tr><td>CER</td><td>Cervical</td><td>PANC</td><td>Pancreas</td></tr><tr><td>COL</td><td>Colorectal</td><td>PROS</td><td>Prostate</td></tr><tr><td>ENDO</td><td>Endometrial</td><td>SI</td><td>Small Intestine</td></tr><tr><td>GAS</td><td>Gastric</td><td>STS</td><td>Soft Tissue Sarcoma</td></tr><tr><td>KID</td><td>Kidney</td><td>THY</td><td>Thyroid</td></tr><tr><td>LEUK</td><td>Leukemia</td><td>UB</td><td>Urinary Bladder</td></tr><tr><td>MELA</td><td>Melanoma</td><td>HEP</td><td>Heptobiliary</td></tr></tbody></table></table-wrap></sec></sec><sec id="s7" sec-type="appendix"><title>Sample pedigrees</title><table-wrap id="app1table2" position="float"><label>Appendix 1—table 2.</label><caption><title>Summary of sample pedigrees provided within the package.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Pedigree name</th><th>Number of family members</th><th>Cancers present</th></tr></thead><tbody><tr><td>test_fam_1</td><td>19</td><td>BC, OC</td></tr><tr><td>test_fam_2</td><td>25</td><td>ENDO, PANC, SI</td></tr><tr><td>test_fam_3</td><td>50</td><td>BRA, BC, COL, ENDO, GAS, KID, MELA, OC, PANC, PROS, SI</td></tr><tr><td>test_fam_4</td><td>9</td><td>BC, OC, BRA, COL, PROS, ENDO, SI,</td></tr><tr><td>test_fam_5</td><td>17</td><td>BC, MELA</td></tr><tr><td>test_fam_6</td><td>19</td><td>BC, ENDO, MELA, PANC</td></tr><tr><td>test_fam_7</td><td>19</td><td>COL, ENDO</td></tr><tr><td>test_fam_8</td><td>20</td><td>COL, PROS</td></tr><tr><td>test_fam_9</td><td>19</td><td>BC, PROS</td></tr><tr><td>test_fam_10</td><td>21</td><td>BC, COL</td></tr><tr><td>test_fam_11</td><td>16</td><td>BC, ENDO, OC, PANC, SI</td></tr><tr><td>test_fam_12</td><td>21</td><td>all cancers in <xref ref-type="table" rid="app1table1">Appendix 1—table 1</xref></td></tr><tr><td>err_fam_1</td><td>10</td><td>BC, PANC</td></tr></tbody></table></table-wrap></sec></boxed-text></app></app-group></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.68699.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Narla</surname><given-names>Goutham</given-names></name><role>Reviewing Editor</role><aff><institution>University of Michigan</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>The authors have done an admirable job responding to the reviewers and editorial board members. They have increased the number of cases/pedigrees analyzed using this novel modeling tool. They have also outlined how to practically use this program for users.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;PanelPRO: An R package for multi-syndrome, multi-gene risk modeling for individuals with a family history of cancer&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 2 peer reviewers, one of whom is a member of our Board of Reviewing Editors, and the evaluation has been overseen by a Senior Editor. The reviewers have opted to remain anonymous.</p><p>The reviewers have discussed their reviews with one another, and the Editors have drafted this to help you prepare a revised submission.</p><p>Essential Revisions:</p><p>Overall the reviewers felt that this is outstanding manuscript with potential broad impact in the cancer genetics and oncology community as highlighted in the reviews below. There are a couple of key revisions that are recommended prior to the manuscript being acceptable for publication.</p><p>1) Additional examples of cases and the output from the analysis performed on these example cases with comparison when appropriate to existing programs.</p><p>2) More details about the practical uses of the program in the clinic and discussion about the ability to import data from existing clinical platforms into PanelPRO.<italic>Reviewer #1:</italic></p><p>This is an outstanding paper that develops and validates a new germline analysis tool for inputting family history and germline sequencing data into a user friendly interface that can be then used to calculate the risk architecture of a given family based upon both ascertained family history information as well as DNA sequencing results.</p><p>There are a number of strengths in this manuscript including:</p><p>1. The work and program generated here is novel and has a number of advantages to the existing software / platforms currently available to the cancer genetics community – it is more comprehensive in genes that can be inputted and in the family history architecture that can be ascertained.</p><p>2. The paper is well written and is able to clearly followed with the methods laid out thoroughly and comprehensively.</p><p>3. The impact of this work to the cancer genetics and oncology community will be immediate and I can envision and predict widespread adoption of this software platform in the near term.</p><p>One weakness to be noted is that more example cases could be included as test and validation examples and to show the results from the analysis being performed. When appropriate and relevant perhaps a comparison of the results to currently available platforms to analyze germline sequencing data would be of value and strengthen the paper.</p><p><italic>Reviewer #2:</italic></p><p>This work describes an R package called PanelPRO that seeks to assist in identifying individuals at increased risk of cancer due to inherited germline mutations in multiple genes. This tool integrates pedigree data and, importantly, has the ability to be updated as new cancer predisposition genes are discovered and peer-reviewed data on cancer risk becomes available. Patient factors such as risk-reducing surgeries and tumor biomarkers can also be incorporated as part of the risk evaluation. This allows for more personalized risk predictions compared to existing risk prediction models.</p><p>Strengths:</p><p>This R package offers many advantages over existing programs with similar intended uses. The authors highlight this by noting the limited cancer types and genes considered by existing tools and contrasting this to the capabilities of PanelPRO. Specifically, the authors provide clear examples of this software's ability to incorporate family histories with several different cancer types and to provide an output for prediction of finding a germline pathogenic variant in multiple genes as well as individualized future cancer risk. It also allows users to include individual level risk factors and biomarkers, resulting in a more personalized risk assessment when compared to existing tools. There are several other features that can be changed based on user preference, providing users with a high level of customization. The flexibility to make updates to the R package to reflect changes in the field of cancer genetics is another strength of this work. PanelPRO is designed to be compatible with an existing risk-modeling package, BayesMendel.</p><p>The authors provide a clear workflow explaining the use of the package and provide the necessary information to access it in its currently available form. The different variables, notations, and customizable features of the program are clearly explained in the manuscript. Many important variables from the family history that cannot be included in risk assessments using currently available tools can be incorporated into PanelPRO. There are several examples showing different features and capabilities of the program that improve on existing tools. Instructions for use with pedigree information appear to be clear for those familiar with R software. Some limitations of the technology are noted but suggestions to address the described limitations are included.</p><p>Weaknesses:</p><p>While the strengths of the PanelPRO package are evident, discussion around its use in practice is lacking. By excluding this aspect, potential limitations related to implementation and use are not addressed here, but are key in determining the potential impact of this software in the field. It is not noted if this new package is intended for use in clinical practice, research, or both. Proposed users include users of the existing BayesMendel package, so providing information about users of the BayesMendel package (clinicians versus researchers, volumes, etc) could help readers determine possible applicability of PanelPRO to their own practice. While the authors posit new users may be interested in this software due to its enhanced abilities, further information on new potential users is not included. Due to the absence of discussion of use of this package in a clinical and/or research setting, the likely uptake and impact of this work on the field is difficult to determine. Broader audiences may benefit from more context surrounding existing cancer risk models and their use in cancer genetics to better appreciate the improvements noted here compared to traditional risk modeling programs.</p><p>One of the strengths of PanelPRO is the capability for software updates as new knowledge about hereditary cancer syndromes and associated pathogenic variants becomes available. Although this software has the ability to customize the allele frequency and penetrance for a requested gene, meaning it can accommodate predictions for genes not built into its software, built-in gene data relies on published, peer-reviewed data for allele frequencies and penetrance. Additional context surrounding how new genes get added to PanelPRO would help readers understand the significance of the work.</p><p>While the improvements compared to existing programs are clear, context around the current use of available risk models in practice, and specific examples of intended use, would help the reader better appreciate the potential significant impact of PanelPRO in clinical and/or research cancer genetics settings. Information about the ability to import data directly from popular pedigree programs would also help determine the potential uptake and impact.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.68699.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential Revisions:</p><p>Overall the reviewers felt that this is outstanding manuscript with potential broad impact in the cancer genetics and oncology community as highlighted in the reviews below. There are a couple of key revisions that are recommended prior to the manuscript being acceptable for publication.</p><p>1) Additional examples of cases and the output from the analysis performed on these example cases with comparison when appropriate to existing programs.</p></disp-quote><p>We appreciate the reviewer's thoughtful comments. We agree that additional example cases and comparisons would strengthen the manuscript. We have added eight additional example pedigrees to PanelPRO version 0.2.0, with a total of thirteen pedigrees now provided as examples in the package (see revised manuscript lines 103-108 in the User Input subsection). These pedigrees cover a broad range of realistic and extreme examples that illustrate the utility of the PanelPRO model. In the manuscript, we have added a new subsection to the Methods section titled Additional Examples (see revised manuscript lines 236-273). We visualize five of these sample pedigrees, as well as their outputs based on PanelPRO with all the default settings (Figures 5-9 and their corresponding figure supplements). Where appropriate, depending on the cancers reported in the example pedigree, we compare these outputs to the outputs of BRCAPRO (breast and ovarian) and MMRPRO (colorectal and endometrial), both from the BayesMendel R package (Chen et al., 2004); CanRisk (breast and ovarian), also known as BOADICEA (Lee et al., 2019; Carver et al., 2021); IBIS (breast and ovarian) (Tyrer et al., 2004); and PREMM-5 (colorectal, endometrial, and any other Lynch syndrome-associated cancers) (Kastrinos et al., 2017). We have added Table 3 to the main text which summarizes the cancer inputs and output for each of these models. The advantage of PanelPRO is that it takes as input multiple cancers; the output includes both carrier probability and future risk estimates; future risks of cancers are shown over time; and the entire output figure is interactive, meaning that numerical estimates can be sought by hovering over the relevant data point(s).</p><disp-quote content-type="editor-comment"><p>2) More details about the practical uses of the program in the clinic and discussion about the ability to import data from existing clinical platforms into PanelPRO.</p></disp-quote><p>PanelPRO is currently available for research purposes (https://projects.iq.harvard.edu/bayesmendel/panelpro) and we may license it in the future for commercial clinical use. The existing BayesMendel package is also available for research purposes (https://projects.iq.harvard.edu/bayesmendel/bayesmendel-r-package) and is currently licensed for commercial clinical use to CRA Health, CancerGene Connect, Progeny, FamHis, MagView, Igentify, CancerIQ, and Finch genetics. For BayesMendel, we leave clinical integration to the software licensees, including the integration into electronic health records using software such as EPIC. We envision a similar dissemination plan for PanelPRO. Since R is capable of reading in a wide range of data types, from flat files to compressed data objects, there are many approaches for importing and formatting PanelPRO-compatible pedigrees from existing clinical platforms. We do hope, funding permitted, to develop a R shiny app to support a user interface for R usage of the package, but we leave integration of the PanelPRO model into existing clinical platforms to the companies who specialize in this. We have added a discussion on the practical usage of PanelPRO to the end of the Introduction section in lines 78-85.</p><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>One weakness to be noted is that more example cases could be included as test and validation examples and to show the results from the analysis being performed. When appropriate and relevant perhaps a comparison of the results to currently available platforms to analyze germline sequencing data would be of value and strengthen the paper.</p></disp-quote><p>To address this weakness, we have added eight additional pedigrees, for a total of thirteen example cases in PanelPRO version 0.2.0 (lines 103-108 in the User Input subsection) (see also the response to reviewing editor, comment 1). These pedigrees cover a broad range of realistic and extreme examples that illustrate the utility of the PanelPRO model. In the manuscript, we provide visualizations for five of these sample pedigrees, as well as the results from applying PanelPRO with all the default settings to these pedigrees (Figures 5-9 and their corresponding figure supplements). We compare the PanelPRO results for these pedigrees to those of BRCAPRO and MMRPRO (from the BayesMendel R package) (Chen et al., 2004), CanRisk (also known as BOADICEA) (Lee et al., 2019; Carver et al., 2021), IBIS (Tyrer et al., 2004) and PREMM-5 (Kastrinos et al., 2017), when relevant (i.e. for pedigrees with cancer family history supported by both models). The output from PanelPRO provides both carrier probability and future risk estimates; future risks of cancers are shown over time; and the entire figure is interactive, meaning that numerical estimates can be sought by hovering over the relevant data point(s). Lines 236-273 and Table 3 in the newly-added “Additional Examples&quot; section summarize this analysis and discussion.</p><p>A pair of such examples illustrates the differences between PanelPRO and PREMM-5 for estimating the risk for gene mutations associated with Lynch syndrome. For the pedigree `test_fam_7`, the mutation probabilities for any of the genes MLH1, MSH2, MSH6, PMS2 or EPCAM is 42.3% according to PanelPRO (when excluding the possibility of multiple simultaneous gene mutations), whereas it is 32% for PREMM-5. This pedigree only contains history of colorectal and endometrial cancers, which PREMM-5 uses as key risk factors in their model, leading to similar results (though PanelPRO gives estimates of each individual gene in addition). In contrast, the mutation probability estimates between the same two models for `test_fam_11` are quite different. This pedigree is an extreme example for illustration purposes and is unlikely to appear in clinical settings. Nevertheless, it contains endometrial, small intestine, ovarian and pancreatic cancers, all of which are associated with Lynch syndrome, but the latter three are grouped, along with other cancers, into a single risk factor in the PREMM-5 model. It also contains a case of breast cancer in a second-degree relative, but for Lynch syndrome this is not a significant risk factor. The differences in the model approaches, along with differences in assumptions, result in PanelPRO giving a 93% estimate for a mutation in any of the aforementioned genes (without multiple simultaneous gene mutations), whilst PREMM-5 gives 3.2%. This is clearly an extreme pedigree in terms of the number and nature of the relevant cancers, and both models give a recommendation for further genetic evaluation at a cut-o_ of 2.5%; however, it illustrates the exibility of PanelPRO for incorporating very detailed pedigree information that will have a high clinical impact.</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>Weaknesses:</p><p>While the strengths of the PanelPRO package are evident, discussion around its use in practice is lacking. By excluding this aspect, potential limitations related to implementation and use are not addressed here, but are key in determining the potential impact of this software in the field. It is not noted if this new package is intended for use in clinical practice, research, or both. Proposed users include users of the existing BayesMendel package, so providing information about users of the BayesMendel package (clinicians versus researchers, volumes, etc) could help readers determine possible applicability of PanelPRO to their own practice. While the authors posit new users may be interested in this software due to its enhanced abilities, further information on new potential users is not included. Due to the absence of discussion of use of this package in a clinical and/or research setting, the likely uptake and impact of this work on the field is difficult to determine. Broader audiences may benefit from more context surrounding existing cancer risk models and their use in cancer genetics to better appreciate the improvements noted here compared to traditional risk modeling programs.</p></disp-quote><p>The reviewer raises excellent points about the practical usage of PanelPRO (see also the response to reviewing editor, comment 2). The existing BayesMendel package is used in research, as well as integrated into clinical tools such as CancerGene (Chen et al., 2004) (over 4,000 users in more than 75 countries), CRA Health (over 15,000 users per month), Progeny, FamHis, MagView, Igentify, CancerIQ, and Finch genetics. Similarly, we hope PanelPRO will be used by both clinicians and researchers. Family history has long been understood to be a key component for identifying risk and preventing heritable diseases, and clinical tools such as the ones which license BayesMendel are becoming more readily available (Welch et al., 2018). Cancer risk models like PanelPRO and the existing BayesMendel models incorporate family history and other information to quantify risk in terms of carrier probabilities and the future probability of disease development. Beyond current users of the BayesMendel package, we hope that PanelPRO's generality and relevance to panel testing will attract a broader audience in the current landscape for cancer clinical risk assessment. This additional context has been added to the end of the Introduction section in lines 74-75 and 81-85.</p><disp-quote content-type="editor-comment"><p>One of the strengths of PanelPRO is the capability for software updates as new knowledge about hereditary cancer syndromes and associated pathogenic variants becomes available. Although this software has the ability to customize the allele frequency and penetrance for a requested gene, meaning it can accommodate predictions for genes not built into its software, built-in gene data relies on published, peer-reviewed data for allele frequencies and penetrance. Additional context surrounding how new genes get added to PanelPRO would help readers understand the significance of the work.</p></disp-quote><p>As the reviewer notes, one must obtain estimates of the pathogenic variant allele frequency and the penetrance for at least one cancer in the database in order to add a new gene. Therefore, new genes will be added to PanelPRO based on regular literature reviews as conducted in the All Syndromes Known to Man Evaluator (ASK2ME) clinical tool (Braun et al., 2018). The ASK2ME approach identifies best-available studies that adjust for ascertainment; since many papers report odds ratios or relative risks, it then calculates absolute age-specific cancer penetrances when necessary.</p><p>In the current PanelPRO database, we incorporate cancer penetrances from data included in the Bayes-Mendel package (primarily from meta-analyses) when available: the BRCA1 and BRCA2 estimates for the probability of developing breast or ovarian cancer (Chen et al., 2020); the MLH1, MSH2, and MSH6 estimates for the probability of developing colorectal or endometrial cancer (Wang et al., 2020; Felton et al., 2007); and the CDKN2A estimates for the probability of developing melanoma (Wang et al., 2010; Begg et al., 2005; Bishop et al., 2002). All other cancer penetrances were pulled from ASK2ME (Braun et al., 2018).</p><p>For allele frequencies, we also perform a literature review. In the current PanelPRO database, we used the non-Ashkenazi, Ashkenazi Jewish, and Italian BRCA1 and BRCA2 allele frequency estimates from BRCAPRO (Chen et al., 2004; Antoniou et al., 2002); for MLH1, MSH2, and MSH6, we used the allele frequency estimates from MMRpro (Chen et al., 2004, 2006); and for CDKN2A, we used the allele frequency estimate from Melapro (Chen et al., 2004; Berwick et al., 2006). Allele frequency estimates for ATM, CHEK2, and PALB2 were taken from Lee et al. (2016). The allele frequencies of the remaining genes were estimated based on a 25-gene panel study of 252,223 individuals (Rosenthal et al., 2017) that did not adjust for ascertainment. In this case, we rescaled the reported estimates by the ratio of the ascertained and unascertained allele frequencies for a gene reported in both our existing database and the study. We now include notes on adding new genes and obtaining model parameter estimates, including new citations, in lines 131-150 of the Model Input subsection.</p><disp-quote content-type="editor-comment"><p>While the improvements compared to existing programs are clear, context around the current use of available risk models in practice, and specific examples of intended use, would help the reader better appreciate the potential significant impact of PanelPRO in clinical and/or research cancer genetics settings. Information about the ability to import data directly from popular pedigree programs would also help determine the potential uptake and impact.</p></disp-quote><p>We thank the reviewer for their recommendations (see also the response to reviewing editor, comment 2 and the response to reviewer 2, comment 1). As mentioned in previous responses, for BayesMendel, we leave clinical integration to the software licensees, including the integration of electronic medical records such as EPIC. We envision a similar dissemination plan for PanelPRO. Since R is capable of reading in a wide range of data types, from flat files to compressed data objects, there are many approaches for directly importing pedigrees from existing clinical platforms. We do hope, funding permitted, to develop an R shiny app to support R usage of the package that requires less technical skill, but we leave integration of the PanelPRO model into existing clinical platforms to the companies who specialize in this. We have added a discussion on the practical usage of PanelPRO to the end of the Introduction section in lines 78-85.</p><p>References</p><p>Antoniou, A., Pharoah, P., McMullan, G., Day, N., Stratton, M., Peto, J., Ponder, B., and Easton, D. (2002). A comprehensive model for familial breast cancer incorporating BRCA1, BRCA2 and other genes. British journal of cancer, 86(1):76.</p><p>Begg, C. B., Orlow, I., Hummer, A. J., Armstrong, B. K., Kricker, A., Marrett, L. D., Millikan, R. C., Gruber, S. B., Anton-Culver, H., Zanetti, R., et al. (2005). Lifetime risk of melanoma in CDKN2A mutation carriers in a population-based sample. Journal of the National Cancer Institute, 97(20):1507{1515.</p><p>Berwick, M., Orlow, I., Hummer, A. J., Armstrong, B. K., Kricker, A., Marrett, L. D., Millikan, R. C., Gruber, S. B., Anton-Culver, H., Zanetti, R., et al. (2006). The prevalence of CDKN2A germ-line mutations and relative risk for cutaneous malignant melanoma: an international population-based study. Cancer Epidemiology and Prevention Biomarkers, 15(8):1520{1525.</p><p>Bishop, D. T., Demenais, F., Goldstein, A. M., Bergman, W., Bishop, J. N., Paillerets, B. B.-d., Chompret, A., Ghiorzo, P., Gruis, N., Hansson, J., et al. (2002). Geographical variation in the penetrance of CDKN2A mutations for melanoma. Journal of the National Cancer Institute, 94(12):894{903.</p><p>Braun, D., Yang, J., Gri_n, M., Parmigiani, G., and Hughes, K. S. (2018). A clinical decision support tool to predict cancer risk for commonly tested cancer-related germline mutations. Journal of genetic counseling,27(5):1187{1199.</p><p>Carver, T., Hartley, S., Lee, A., Cunningham, A. P., Archer, S., de Villiers, C. B., Roberts, J., Ruston, R., Walter, F. M., Tischkowitz, M., et al. (2021). Canrisk tool|a web interface for the prediction of breast and ovarian cancer risk and the likelihood of carrying genetic pathogenic variants. Cancer Epidemiology and Prevention Biomarkers, 30(3):469{473.</p><p>Chen, J., Bae, E., Zhang, L., Hughes, K., Parmigiani, G., Braun, D., and Rebbeck, T. R. (2020). Penetrance of breast and ovarian cancer in women who carry a BRCA1/2 mutation and do not use risk-reducing salpingo-oophorectomy: An updated meta-analysis. JNCI cancer spectrum, 4(4):pkaa029.</p><p>Chen, S., Wang, W., Broman, K. W., Katki, H. A., and Parmigiani, G. (2004). BayesMendel: an R environment for mendelian risk prediction. Statistical applications in genetics and molecular biology, 3(1):1{19.</p><p>Chen, S., Wang, W., Lee, S., Nafa, K., Lee, J., Romans, K., Watson, P., Gruber, S. B., Euhus, D., Kinzler, K. W., et al. (2006). Prediction of germline mutations and cancer risk in the Lynch syndrome. Jama, 296(12):1479{1487.</p><p>Felton, K., Gilchrist, D., and Andrew, S. (2007). Constitutive deficiency in DNA mismatch repair: is it time for Lynch III? Clinical genetics, 71(6):499{500.</p><p>Kastrinos, F., Uno, H., Ukaegbu, C., Alvero, C., McFarland, A., Yurgelun, M. B., Kulke, M. H., Schrag, D., Meyerhardt, J. A., Fuchs, C. S., et al. (2017). Development and validation of the premm5 model for comprehensive risk assessment of lynch syndrome. Journal of clinical oncology, 35(19):2165.</p><p>Lee, A., Mavaddat, N., Wilcox, A. N., Cunningham, A. P., Carver, T., Hartley, S., de Villiers, C. B., Izquierdo, A., Simard, J., Schmidt, M. K., et al. (2019). Boadicea: a comprehensive breast cancer risk prediction model incorporating genetic and nongenetic risk factors. Genetics in Medicine, 21(8):1708{1718.</p><p>Lee, A. J., Cunningham, A. P., Tischkowitz, M., Simard, J., Pharoah, P. D., Easton, D. F., and Antoniou, A. C. (2016). Incorporating truncating variants in PALB2, CHEK2, and ATM into the BOADICEA breast cancer risk model. Genetics in Medicine, 18(12):1190.</p><p>Rosenthal, E. T., Bernhisel, R., Brown, K., Kidd, J., and Manley, S. (2017). Clinical testing with a panel of 25 genes associated with increased cancer risk results in a significant increase in clinically significant findings across a broad range of cancer histories. Cancer genetics, 218:58{68.</p><p>Tyrer, J., Du_y, S. W., and Cuzick, J. (2004). A breast cancer prediction model incorporating familial and personal risk factors. Statistics in medicine, 23(7):1111{1130.</p><p>Wang, C., Wang, Y., Hughes, K. S., Parmigiani, G., and Braun, D. (2020). Penetrance of colorectal cancer among mismatch repair gene mutation carriers: A meta-analysis. JNCI Cancer Spectrum.</p><p>Wang, W., Niendorf, K. B., Patel, D., Blackford, A., Marroni, F., Sober, A. J., Parmigiani, G., and Tsao, H. (2010). Estimating CDKN2A carrier probability and personalizing cancer risk assessments in hereditary melanoma using MelaPRO. Cancer research, 70(2):552{559.</p><p>Welch, B. M., Wiley, K., Pfieger, L., Achiangia, R., Baker, K., Hughes-Halbert, C., Morrison, H., Schiffman, J., and Doerr, M. (2018). Review and comparison of electronic patient-facing family health history tools. Journal of genetic counseling, 27(2):381{391.</p></body></sub-article></article>