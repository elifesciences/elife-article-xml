<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.2"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">85126</article-id><article-id pub-id-type="doi">10.7554/eLife.85126</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group></article-categories><title-group><article-title>A transfer-learning approach to predict antigen immunogenicity and T-cell receptor specificity</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-278207"><name><surname>Bravi</surname><given-names>Barbara</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4860-7584</contrib-id><email>b.bravi21@imperial.ac.uk</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-300158"><name><surname>Di Gioacchino</surname><given-names>Andrea</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6085-7589</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund6"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-300159"><name><surname>Fernandez-de-Cossio-Diaz</surname><given-names>Jorge</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4476-805X</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-50904"><name><surname>Walczak</surname><given-names>Aleksandra M</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2686-5702</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib2">‡</xref><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-300161"><name><surname>Mora</surname><given-names>Thierry</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5456-9361</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib2">‡</xref><xref ref-type="other" rid="fund4"/><xref ref-type="other" rid="fund5"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-300160"><name><surname>Cocco</surname><given-names>Simona</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1852-7789</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib2">‡</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-276913"><name><surname>Monasson</surname><given-names>Rémi</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4459-0204</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib2">‡</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/041kmwe10</institution-id><institution>Department of Mathematics, Imperial College London</institution></institution-wrap><addr-line><named-content content-type="city">London</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/013cjyk83</institution-id><institution>Laboratoire de Physique de l’Ecole Normale Supérieure, ENS, Université PSL, CNRS, Sorbonne Université, Université Paris-Cité</institution></institution-wrap><addr-line><named-content content-type="city">Paris</named-content></addr-line><country>France</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Bitbol</surname><given-names>Anne-Florence</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02s376052</institution-id><institution>Ecole Polytechnique Federale de Lausanne (EPFL)</institution></institution-wrap><country>Switzerland</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Eisen</surname><given-names>Michael B</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01an7q238</institution-id><institution>University of California, Berkeley</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn><fn fn-type="con" id="equal-contrib2"><label>‡</label><p>These authors also contributed equally to this work</p></fn></author-notes><pub-date publication-format="electronic" date-type="publication"><day>08</day><month>09</month><year>2023</year></pub-date><pub-date pub-type="collection"><year>2023</year></pub-date><volume>12</volume><elocation-id>e85126</elocation-id><history><date date-type="received" iso-8601-date="2022-11-23"><day>23</day><month>11</month><year>2022</year></date><date date-type="accepted" iso-8601-date="2023-09-07"><day>07</day><month>09</month><year>2023</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at .</event-desc><date date-type="preprint" iso-8601-date="2022-12-09"><day>09</day><month>12</month><year>2022</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2022.12.06.519259"/></event></pub-history><permissions><copyright-statement>© 2023, Bravi et al</copyright-statement><copyright-year>2023</copyright-year><copyright-holder>Bravi et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-85126-v2.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-85126-figures-v2.pdf"/><abstract><p>Antigen immunogenicity and the specificity of binding of T-cell receptors to antigens are key properties underlying effective immune responses. Here we propose diffRBM, an approach based on transfer learning and Restricted Boltzmann Machines, to build sequence-based predictive models of these properties. DiffRBM is designed to learn the distinctive patterns in amino-acid composition that, on the one hand, underlie the antigen’s probability of triggering a response, and on the other hand the T-cell receptor’s ability to bind to a given antigen. We show that the patterns learnt by diffRBM allow us to predict putative contact sites of the antigen-receptor complex. We also discriminate immunogenic and non-immunogenic antigens, antigen-specific and generic receptors, reaching performances that compare favorably to existing sequence-based predictors of antigen immunogenicity and T-cell receptor specificity.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>machine learning</kwd><kwd>immune response</kwd><kwd>immunogenicity</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001665</institution-id><institution>Agence Nationale de la Recherche</institution></institution-wrap></funding-source><award-id>RBMPro CE30-0021-01</award-id><principal-award-recipient><name><surname>Di Gioacchino</surname><given-names>Andrea</given-names></name><name><surname>Fernandez-de-Cossio-Diaz</surname><given-names>Jorge</given-names></name><name><surname>Cocco</surname><given-names>Simona</given-names></name><name><surname>Monasson</surname><given-names>Rémi</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001665</institution-id><institution>Agence Nationale de la Recherche</institution></institution-wrap></funding-source><award-id>ProDiGen CE45-2023</award-id><principal-award-recipient><name><surname>Di Gioacchino</surname><given-names>Andrea</given-names></name><name><surname>Fernandez-de-Cossio-Diaz</surname><given-names>Jorge</given-names></name><name><surname>Cocco</surname><given-names>Simona</given-names></name><name><surname>Monasson</surname><given-names>Rémi</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001665</institution-id><institution>Agence Nationale de la Recherche</institution></institution-wrap></funding-source><award-id>Decrypted CE30-0021-01</award-id><principal-award-recipient><name><surname>Di Gioacchino</surname><given-names>Andrea</given-names></name><name><surname>Fernandez-de-Cossio-Diaz</surname><given-names>Jorge</given-names></name><name><surname>Cocco</surname><given-names>Simona</given-names></name><name><surname>Monasson</surname><given-names>Rémi</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001665</institution-id><institution>Agence Nationale de la Recherche</institution></institution-wrap></funding-source><award-id>RESP-REP CE45-0018</award-id><principal-award-recipient><name><surname>Bravi</surname><given-names>Barbara</given-names></name><name><surname>Walczak</surname><given-names>Aleksandra M</given-names></name><name><surname>Mora</surname><given-names>Thierry</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000781</institution-id><institution>European Research Council</institution></institution-wrap></funding-source><award-id>COG 724208</award-id><principal-award-recipient><name><surname>Bravi</surname><given-names>Barbara</given-names></name><name><surname>Walczak</surname><given-names>Aleksandra M</given-names></name><name><surname>Mora</surname><given-names>Thierry</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100018694</institution-id><institution>HORIZON EUROPE Marie Sklodowska-Curie Actions</institution></institution-wrap></funding-source><award-id>101026293</award-id><principal-award-recipient><name><surname>Di Gioacchino</surname><given-names>Andrea</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>An interpretable machine learning approach can recapitulate the molecular features associated to immune protein-protein binding and leverage them for the prediction of immune response specificity.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>T cells play an essential role in the immune response to pathogens and malignancies. Killer T cells are activated following the binding of their surface receptors (T-cell receptors or TCRs) to short portions of pathogen-related proteins (peptide antigens) that are presented by class I major histocompatibility complexes (MHCs) forming the peptide-MHC epitope (pMHC).</p><p>Only a fraction of peptides presented by the MHC are immunogenic, meaning that they possess biochemical properties that can promote a T-cell response (<xref ref-type="bibr" rid="bib75">Sette et al., 1994</xref>). Accurate prediction of immunogenicity is crucial to the successful identification of microbial antigens and cancer neoantigens (antigens carrying cancer-related mutations) that help develop vaccines and immune-based cancer therapies. A very recent systematic assessment <xref ref-type="bibr" rid="bib10">Buckley et al., 2022</xref> of the available models to identify immunogenic targets from pathogens and cancers reports suboptimal overall performances, with none of the models able to substantially improve beyond pure MHC-presentation prediction when evaluated on immunogenic peptides from a new virus (SARS-CoV-2). The largest-scale validation <xref ref-type="bibr" rid="bib92">Wells et al., 2020</xref> of existing computational pipelines for neoantigen discovery has highlighted a general lack of consensus among their predictions and a rather low average success rate, with only 6% of the predicted neoantigens validated as truly immunogenic.</p><p>We also know that a given pMHC epitope elicits the response of only specific small subsets of the human T-cell repertoire. Predicting the molecular composition of TCRs that have the potential to be reactive to a given epitope is a difficult computational problem that is yet not fully solved despite numerous recent advances (<xref ref-type="bibr" rid="bib30">Gielis et al., 2019</xref>; <xref ref-type="bibr" rid="bib39">Jokinen et al., 2019</xref>; <xref ref-type="bibr" rid="bib82">Springer et al., 2020</xref>; <xref ref-type="bibr" rid="bib56">Montemurro et al., 2021</xref>; <xref ref-type="bibr" rid="bib90">Weber et al., 2021</xref>). Improvements in predicting immunogenicity and TCR specificity would have direct consequences for medical applications, including the study of an individual’s infection history from their T-cell repertoire and personalized adoptive T-cell therapy for cancer treatment.</p><p>A few approaches have been proposed to predict antigen immunogenicity (<xref ref-type="bibr" rid="bib12">Calis et al., 2013</xref>; <xref ref-type="bibr" rid="bib84">Trolle and Nielsen, 2014</xref>; <xref ref-type="bibr" rid="bib14">Chowell et al., 2015</xref>; <xref ref-type="bibr" rid="bib59">Ogishi and Yotsuyanagi, 2019</xref>; <xref ref-type="bibr" rid="bib27">Gao et al., 2020</xref>; <xref ref-type="bibr" rid="bib72">Schmidt et al., 2021</xref>; <xref ref-type="bibr" rid="bib43">Lin et al., 2021</xref>; <xref ref-type="bibr" rid="bib10">Buckley et al., 2022</xref>), some of them specifically developed for computational pipelines of neoantigen discovery (<xref ref-type="bibr" rid="bib46">Łuksza et al., 2017</xref>; <xref ref-type="bibr" rid="bib80">Smith et al., 2019</xref>; <xref ref-type="bibr" rid="bib67">Riley et al., 2019</xref>; <xref ref-type="bibr" rid="bib71">Schenck et al., 2019</xref>; <xref ref-type="bibr" rid="bib70">Schaap-Johansen et al., 2021</xref>). The model by <xref ref-type="bibr" rid="bib12">Calis et al., 2013</xref> is currently the most used resource for MHC class I immunogenicity prediction, being both implemented by the IEDB tool (<ext-link ext-link-type="uri" xlink:href="http://tools.iedb.org/immunogenicity/">http://tools.iedb.org/immunogenicity/</ext-link>) for immunogenicity predictions and integrated in the T cell-antigen interaction prediction by the NetTepi server (<xref ref-type="bibr" rid="bib84">Trolle and Nielsen, 2014</xref>). It relies on measuring the enrichment in amino-acid usage between immunogenic and non-immunogenic peptides, assuming position independence of the main biophysical properties underlying immunogenicity. Some of these approaches are based on a preliminary choice of peptide positions (<xref ref-type="bibr" rid="bib72">Schmidt et al., 2021</xref>) or properties (such as hydrophobicity <xref ref-type="bibr" rid="bib14">Chowell et al., 2015</xref>), assumed to be important for recognition by TCRs.</p><p>Conversely, the computational prediction of the epitope specificity of a given TCR is extremely relevant for therapeutic design, and has been done so far through a variety of machine-learning methods (<xref ref-type="bibr" rid="bib16">Cinelli et al., 2017</xref>; <xref ref-type="bibr" rid="bib30">Gielis et al., 2019</xref>; <xref ref-type="bibr" rid="bib39">Jokinen et al., 2019</xref>; <xref ref-type="bibr" rid="bib20">Davidsen et al., 2019</xref>; <xref ref-type="bibr" rid="bib82">Springer et al., 2020</xref>; <xref ref-type="bibr" rid="bib48">Luu et al., 2021</xref>; <xref ref-type="bibr" rid="bib79">Sidhom et al., 2021</xref>; <xref ref-type="bibr" rid="bib15">Chronister et al., 2021</xref>; <xref ref-type="bibr" rid="bib90">Weber et al., 2021</xref>; <xref ref-type="bibr" rid="bib43">Lin et al., 2021</xref>; <xref ref-type="bibr" rid="bib56">Montemurro et al., 2021</xref>; <xref ref-type="bibr" rid="bib96">Zhang et al., 2021</xref>). These models are typically calibrated towards achieving high predictive power as classifiers of TCR specificity, while less attention is paid to the interpretability of their predictions in terms of molecular properties determining binding specificity, apart from a few exceptions relying on model-agnostic interpretability pipelines (<xref ref-type="bibr" rid="bib62">Papadopoulou et al., 2022</xref>).</p><p>Both antigen immunogenicity and epitope-specificity of T-cell receptors have a molecular-level component. They result from specific physico-chemical constraints on the sequence composition of antigens and T-cell receptors. Immunogenic antigens and epitope-specific receptors display an enrichment in specific patterns of amino acid composition. For example, several works have shown enrichment in hydrophobic (<xref ref-type="bibr" rid="bib14">Chowell et al., 2015</xref>; <xref ref-type="bibr" rid="bib67">Riley et al., 2019</xref>) and aromatic (<xref ref-type="bibr" rid="bib72">Schmidt et al., 2021</xref>) residues in immunogenic peptides, compared to all presented peptides (which are predominantly non-binders of TCRs). TCRs specifically responding to the same peptide are also characterized by convergent amino-acid motifs (<xref ref-type="bibr" rid="bib16">Cinelli et al., 2017</xref>; <xref ref-type="bibr" rid="bib19">Dash et al., 2017</xref>; <xref ref-type="bibr" rid="bib31">Glanville et al., 2017</xref>; <xref ref-type="bibr" rid="bib64">Pogorelyy et al., 2019a</xref>, <xref ref-type="bibr" rid="bib36">Huang et al., 2020</xref>; <xref ref-type="bibr" rid="bib77">Shomuradova et al., 2020</xref>; <xref ref-type="bibr" rid="bib51">Mayer-Blackwell et al., 2021</xref>; <xref ref-type="bibr" rid="bib55">Minervina et al., 2021</xref>; <xref ref-type="bibr" rid="bib32">Goncharov et al., 2022</xref>), whose retrieval is the focus of several clustering approaches (<xref ref-type="bibr" rid="bib19">Dash et al., 2017</xref>; <xref ref-type="bibr" rid="bib31">Glanville et al., 2017</xref>; <xref ref-type="bibr" rid="bib52">Meysman et al., 2019</xref>; <xref ref-type="bibr" rid="bib65">Pogorelyy and Shugay, 2019b</xref>; <xref ref-type="bibr" rid="bib83">Thakkar and Bailey-Kellogg, 2019</xref>; <xref ref-type="bibr" rid="bib51">Mayer-Blackwell et al., 2021</xref>; <xref ref-type="bibr" rid="bib87">Valkiers et al., 2021</xref>). Such specific patterns are observed in addition to others, broadly shared across antigens and TCRs. These shared patterns reflect baseline constraints ensuring viability and function (ensuring that TCRs are structurally stable and have the basic binding properties allowing them to pass thymic selection, or ensuring that antigens have high binding affinity to the presenting HLA protein). An outstanding question is how to disentangle sequence pattern enrichment underlying immunogenicity and TCR epitope specificity from the stronger statistical signatures stemming from these baseline constraints. This separation could generate insight into the molecular basis of antigen immunogenicity and epitope specificity and could enable their prediction from sequence alone.</p><p>To tackle this question, we here introduce a strategy of ‘differential learning’ within the architecture of Restricted Boltzmann Machines (<xref ref-type="bibr" rid="bib33">Hinton, 2002</xref>; <xref ref-type="bibr" rid="bib34">Hinton and Salakhutdinov, 2006</xref>), which we call diffRBM (differential Restricted Boltzmann Machine). DiffRBM relies on a transfer learning procedure, where we first learn general background distributions of antigen or TCR sequences, exploiting the large availability of such data. We then refine these models to learn, typically from small amounts of sequence data, the distinctive features that confer immunogenicity or epitope specificity. We first inspect and extract biologically interpretable features from the trained parameters. We then assess diffRBM performance at predicting antigen immunogenicity and TCR specificity compared to existing computational tools.</p><sec id="s1-1"><title>Overview of diffRBM</title><p>In this paper, we develop the diffRBM approach to build models of peptide immunogenicity and T-cell binding to specific peptides. The basic transfer-learning idea of diffRBM is in principle applicable to any data that have some distinctive features compared to a much larger pool of data endowed with the baseline properties. This is the reason why we will refer to these two different sets of data generically as ‘selected’ and ‘background’ datasets (<xref ref-type="fig" rid="fig1">Figure 1A–B</xref>). Here, these two sets correspond to, respectively, immunogenic and presented only antigens in the case of the model of immunogenicity, or antigen-specific and bulk-repertoire TCRs in the case of the model of TCR epitope specificity (<xref ref-type="fig" rid="fig1">Figure 1C–D</xref>).</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Cartoon of the differential RBM (diffRBM) learning approach.</title><p>(<bold>A</bold>) The parameters of background RBM (gray) are learnt from the ‘background’ sequence dataset. (<bold>B</bold>) The diffRBM units (gold) are learnt from a small subset of ‘selected’ sequences. (<bold>C</bold>) We consider the application of diffRBM to modeling peptide immunogenicity or T-cell receptor (TCR) antigen specificity, whereby the background dataset consists, respectively, of all antigens presented by a given Human Leukocyte Antigen class I complex (HLA) or of generic TCRs from the bulk repertoire. (<bold>D</bold>) The selected sequences correspond to HLA-specific antigens validated to be immunogenic or to TCRs that are antigen-specific responders. The inferred parameters associated to the diffRBM units allow one to identify putative contact positions in the peptide-HLA-TCR structure (<bold>E</bold>) and more generally to assign scores that distinguish the selected from the background sequences (<bold>F</bold>). E is an example of a peptide-HLA-TCR structure for the CMV peptide NLVPMVATV (PDB-ID:3GSN), where the contact points along the peptide and the TCR are highlighted in different colors (image obtained with Mol* <xref ref-type="bibr" rid="bib73">Sehnal et al., 2018</xref>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85126-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>DiffRBM architecture recapitulating the mathematical notation used in Materials and methods.</title><p>In this cartoon example, we have assumed <inline-formula><mml:math id="inf1"><mml:mrow><mml:msup><mml:mi>M</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf3"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:math></inline-formula> (corresponding to the length of the actual sequence input in the case of peptides, see <xref ref-type="fig" rid="fig2">Figure 2A</xref> and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85126-fig1-figsupp1-v2.tif"/></fig></fig-group><p>The portion of the machine learnt from the background dataset specifies what we call ‘background RBM’ (<xref ref-type="fig" rid="fig1">Figure 1A</xref>), while we call ‘differential’ the hidden units learnt from the selected dataset, since they focus the learning on its distinctive features (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). We will call diffRBM (standing for ‘differential RBM’) the full model architecture comprising background RBM and the diffRBM units (<xref ref-type="fig" rid="fig1">Figure 1B</xref>, <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>).</p><p>Our differential approach is akin to the machine-learning technique known as transfer learning, whereby a model learnt for one task is transferred to the second task in such a way that the information embedded in the first model facilitates the learning of the second model. Deep learning approaches like (<xref ref-type="bibr" rid="bib93">Wu et al., 2021</xref>; <xref ref-type="bibr" rid="bib1">Akbar et al., 2022</xref>; <xref ref-type="bibr" rid="bib42">Leem et al., 2022</xref>) pre-train on large sets of unannotated antibody sequences to learn the general structure of the space before fine tuning the parameters on sequences with a defined epitope specificity. Similarly, transfer-learning approaches aimed at the prediction of TCR-antigen binding take advantage of pre-training on larger amounts of data, either describing general protein-protein interactions (<xref ref-type="bibr" rid="bib90">Weber et al., 2021</xref>) or sets of TCRs and epitopes without a specific pairing (<xref ref-type="bibr" rid="bib45">Lu et al., 2021</xref>). The SONIA method (<xref ref-type="bibr" rid="bib23">Elhanati et al., 2014</xref>; <xref ref-type="bibr" rid="bib74">Sethna et al., 2020</xref>) (and its deep-learning version soNNia <xref ref-type="bibr" rid="bib37">Isacchini et al., 2021</xref>) quantifies thymic selection on top of the distribution of receptor generation via V(D)J recombination. Contrary to SONIA, diffRBM predicts also antigen immunogenicity. The diffRBM units focus on the differences relative to the background, disentangling in this way the data features that make them a selected subset with distinctive properties. As a result, scores based on the diffRBM units distinguish the selected data from the background data (<xref ref-type="fig" rid="fig1">Figure 1F</xref>), performing better than RBM models learnt without a transfer-learning step. As a consequence, diffRBM units and their parameters support the discovery of salient amino acid patterns underlying TCR-antigen binding, for instance they can identify antigen-TCR contact points in the three-dimensional molecular structure (<xref ref-type="fig" rid="fig1">Figure 1E</xref>).</p></sec></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>DiffRBM model of antigen immunogenicity</title><p>We collected from the Immune Epitope Database (IEDB; <xref ref-type="bibr" rid="bib89">Vita et al., 2019</xref>) sets of peptides that elicited a T-cell reaction in T cell assays (referred to as ‘immunogenic’) and sets of peptides that were not T-cell-reactive (‘non-immunogenic’). The peptide-presenting MHCs are specialized proteins coded by highly polymorphic human genes called Human Leukocyte Antigen (HLA) gene. We selected only peptides presented by 3 HLA-I alleles (HLA-A*02:01, HLA-B*35:01, HLA-B*07:02). We chose these HLA-I alleles since they are associated to at least 200 immunogenic peptides in IEDB and at least one TCR-pMHC structure in the Protein Data Bank (Materials and methods). We trained diffRBM for each set of HLA-restricted immunogenic peptides in two steps, by training first a background RBM on samples of antigens presented by one specific HLA via the RBM-based algorithm RBM-MHC (<xref ref-type="bibr" rid="bib7">Bravi et al., 2021b</xref>), and next by training the diffRBM units on the set of immunogenic antigens of the same HLA type (<xref ref-type="fig" rid="fig2">Figure 2A</xref>, <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). Background RBM can predict scores of presentation on the specific HLA under consideration, while the diffRBM units predict scores of immunogenicity.</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>DiffRBM model of immunogenicity and structural interpretation of its parameters.</title><p>(<bold>A</bold>) DiffRBM units are learnt from HLA-specific peptides annotated as immunogenic. (<bold>B</bold>) HLA contact frequency for each peptide position across 41 structures (bars, left-axis). On the right-axis, log-frequency of amino-acids in the background dataset of HLA-A*02:01-presented antigens (black line), and single-site factor magnitude predicted by the background RBM (HLA-A*02:01-specific presentation model, gray line), both averaged over the 41 structures. Right inset: Average Positive Predictive Value (PPV) for the prediction of peptide positions in contact with the HLA as a function of the number of ranked positions, averaged over the 41 structures. The average PPV over a uniformly random prediction is shown in blue (dotted line, see Materials and methods). (<bold>C</bold>) Same as B, but for peptide-TCR contacts. Single-site factors as calculated from the diffRBM units of the immunogenicity model. Immunogenic to either non-immunogenic or all presented peptides’ amino acid frequency ratios are also shown (legend in D). <inline-formula><mml:math id="inf4"><mml:mi>ρ</mml:mi></mml:math></inline-formula> denotes the correlation coefficient between the contact frequency distribution and single-site factor magnitudes. Peptide contact positions are those within 3.5 Å (4 Å) to the HLA (TCR) in the crystal structure. (<bold>D</bold>) Peptide-TCR contact prediction PPV for each peptide position, sorted by single-site factor magnitude, and averaged over 46 structures (4 for HLA-B*35:01, 41 for HLA-A*02:01, 1 for HLA-B*07:02). Predictions are made using the HLA-specific immunogenicity model for each peptide. Average PPVs are reweighed by a sequence similarity between peptide entries, see Materials and methods (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3A–B</xref>, <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4A–B</xref>).</p><p><supplementary-material id="fig2sdata1"><label>Figure 2—source data 1.</label><caption><title>List of TCR-pMHC structures from PDB and estimated contact positions at 4Å.</title></caption><media mimetype="application" mime-subtype="xls" xlink:href="elife-85126-fig2-data1-v2.xls"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85126-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Schematic summary of the construction of a diffRBM model of immunogenicity.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85126-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Hyperparametric search for the diffRBM model of immunogenicity.</title><p>(<bold>A-B</bold>) The hyperparametric search for the diffRBM model of immunogenicity is performed by monitoring the value of the diffRBM units’ score (<xref ref-type="disp-formula" rid="equ10">Equation 10</xref>) as a function of the number of differential hidden units (<inline-formula><mml:math id="inf5"><mml:msup><mml:mi>N</mml:mi><mml:mi>h</mml:mi></mml:msup></mml:math></inline-formula>) and the regularization (<inline-formula><mml:math id="inf6"><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>). The score values plotted are averages over 50 randomly selected partitions into a training (<bold>A</bold>) and validation set (<bold>B</bold>), see Materials and methods. Dataset used: immunogenic peptides presented on HLA-A*02:01 (<inline-formula><mml:math id="inf7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> = 1682). The optimal combination of <inline-formula><mml:math id="inf8"><mml:msup><mml:mi>N</mml:mi><mml:mi>h</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf9"><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> is marked by the black bold dot. (<bold>C</bold>) AUC of discrimination between immunogenic and non-immunogenic in the test set (averaged over 50 random training-test set partitions) given by diffRBMs with different <inline-formula><mml:math id="inf10"><mml:msup><mml:mi>N</mml:mi><mml:mi>h</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf11"><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> parameters. (<bold>D</bold>) Control of sampling effects on the predictive power of diffRBM with the optimal parameters (<inline-formula><mml:math id="inf12"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mi>h</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf13"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>), its version where the differential part is linear (diffRBM lin.) and a PWM approach. Here PWM refers to the approaches described in Supporting Methods (section ‘PWM-based approach’), whereby the equivalent of the differential model part is given by the ratio of the PWM learnt on selected data and the PWM learnt on the background data. Differential models are trained on a randomly drawn portion of the background dataset of size <inline-formula><mml:math id="inf14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, for varying <inline-formula><mml:math id="inf15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, instead of a training set of immunogenic-only sequences, and then the differential part is used to estimate the AUC of discrimination between immunogenic and non-immunogenic sequences in the test set. Differential models, as expected in this control dataset, have no power at discriminating immunogenic from non-immunogenic peptides (AUC ∼0.5) for all values of the ratio <inline-formula><mml:math id="inf16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85126-fig2-figsupp2-v2.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 3.</label><caption><title>Prediction of peptide contact positions with the TCR.</title><p>(<bold>A</bold>) The average PPV shown in <xref ref-type="fig" rid="fig2">Figure 2D</xref> is compared to the PPV obtained from: the single-site factors from diffRBM units with fields only (‘diffRBM units (lin.)’, dashed-dotted line); a prediction based on a difference of diffRBM units’ scores (<xref ref-type="disp-formula" rid="equ25">Equation 25</xref>). The later is marked as ‘diffRBM units (score diff.)’ (dashed line) to distinguish it from the prediction by diffRBM single-site factors (<xref ref-type="disp-formula" rid="equ11">Equation 11</xref>, simply denoted as ‘diffRBM units’). (<bold>B</bold>) is the same plot as A but obtained without applying the reweighting to account for peptide sequence similarity (Materials and methods). (<bold>C</bold>) Same plot as <xref ref-type="fig" rid="fig2">Figure 2D</xref>, where predictions are divided by HLA allele. The number of structures considered is as follows: 4 structures for HLA-B*35:01, 41 for HLA-A*02:01, and 1 for HLA-B*07:02. (<bold>D</bold>) Same plot as <xref ref-type="fig" rid="fig2">Figure 2D</xref> varying the threshold in Å to define a contact. In all plots, the blue dotted line marks the result of predicting at random the contact positions (Materials and methods).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85126-fig2-figsupp3-v2.tif"/></fig><fig id="fig2s4" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 4.</label><caption><title>Prediction of peptide contact positions with the HLA.</title><p>(<bold>A</bold>) The average PPV of contact prediction shown in <xref ref-type="fig" rid="fig2">Figure 2B</xref> (inset) is compared to the PPV obtained from: the single-site factors from a background RBM with all parameters (bold gray line); a prediction based on a difference of background RBM log-likelihoods (‘background RBM (score diff.)’, dashed line). (<bold>B</bold>) is the same plot as A but obtained without applying the reweighting to account for peptide sequence similarity (Materials and methods). (<bold>C</bold>) Same plot as <xref ref-type="fig" rid="fig2">Figure 2B</xref> (inset) where the prediction is shown separately for each HLA (4 structures for HLA-B*35:01, 41 for HLA-A*02:01, and 1 for HLA-B*07:02). (<bold>D</bold>) Same plot as <xref ref-type="fig" rid="fig2">Figure 2B</xref> (inset) varying the threshold in Å to define a contact. In all plots, the blue dotted line marks the result of predicting at random the contact positions (Materials and methods).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85126-fig2-figsupp4-v2.tif"/></fig></fig-group><p>Differently from some existing approaches to modeling immunogenicity (<xref ref-type="bibr" rid="bib12">Calis et al., 2013</xref>; <xref ref-type="bibr" rid="bib14">Chowell et al., 2015</xref>; <xref ref-type="bibr" rid="bib72">Schmidt et al., 2021</xref>), we train <italic>HLA-specific</italic> models. Preliminary inspection of the datasets revealed that patterns of amino acid enrichment differ between immunogenic peptides presented by different HLAs, apart from some general trend in terms of dominant amino acid properties (<xref ref-type="bibr" rid="bib12">Calis et al., 2013</xref>; <xref ref-type="bibr" rid="bib14">Chowell et al., 2015</xref>; <xref ref-type="bibr" rid="bib67">Riley et al., 2019</xref>; <xref ref-type="bibr" rid="bib72">Schmidt et al., 2021</xref>; <xref ref-type="bibr" rid="bib47">Łuksza et al., 2022</xref>). This is true also when we restrict to the peptide positions known to be relevant for immunogenicity (<xref ref-type="bibr" rid="bib72">Schmidt et al., 2021</xref>; <xref ref-type="bibr" rid="bib69">Rudolph et al., 2006</xref>; <xref ref-type="bibr" rid="bib11">Calis et al., 2012</xref>; <xref ref-type="bibr" rid="bib47">Łuksza et al., 2022</xref>; <xref ref-type="fig" rid="fig3">Figure 3A</xref>). For instance, the extent to which enrichment in hydrophobicity can discriminate immunogenic from non-immunogenic peptides was observed to vary across HLAs (<xref ref-type="bibr" rid="bib10">Buckley et al., 2022</xref>), supporting HLA-specific strategies to model immunogenicity. On the practical side, cross-HLA imbalances in the size of training sets were found to skew predictions toward the most characterized HLAs, in particular toward HLA-A*02:01 (<xref ref-type="bibr" rid="bib10">Buckley et al., 2022</xref>).</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>DiffRBM units encode molecular features of immunogenicity.</title><p>(<bold>A</bold>) Amino-acid usage log-enrichment of immunogenic to non-immunogenic peptides, across central positions (4-8) for each HLA type. The color code indicates amino acid properties: negatively charged (red), positively charged (blue), polar (purple), aromatic (yellow), aliphatic hydrophobic (black), cysteine (green), tiny (grey). (<bold>B</bold>) DiffRBM predicts a positive contribution to immunogenicity of key residues, in agreement with observations. (Top) DiffRBM single-site factors distribution evaluated across HLA-A*02:01-specific immunogenic sequences with W at position 5. (Bottom) The single-site factors given by the immunogenic <italic>vs</italic> non-immunogenic amino acid frequency ratio, which do not include the sequence context (Materials and methods), predict a much lower contribution to immunogenicity, as indicated by the p-values of their difference with respect to the average of the diffRBM single-site factors distribution. (<bold>C</bold>) Illustration of TCR activation curves from <xref ref-type="bibr" rid="bib47">Łuksza et al., 2022</xref> for wild-type (<inline-formula><mml:math id="inf17"><mml:mrow><mml:mi>W</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>) peptide NLVPMVATV and its point-mutants (<inline-formula><mml:math id="inf18"><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>). (<bold>D</bold>) Total count of lethal mutation costs (214 of 513 TCR-mutant combinations), plotted per mutated peptide position. (<bold>E</bold>) DiffRBM units predicted costs of lethal mutations are mostly positive (Materials and methods). (<bold>F</bold>) Non-lethal mutation costs sum (299 of 514 TCR-mutant combinations) per mutated peptide position. (<bold>G</bold>) Experimental <italic>vs</italic> background RBM predicted costs for non-lethal mutations, for one TCR (TCR1). Spearmann correlation coefficients <inline-formula><mml:math id="inf19"><mml:mi>r</mml:mi></mml:math></inline-formula> are comparable across all 3 TCRs, with p-values ≤10<sup>-6</sup> (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1B</xref>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85126-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Prediction of immunogenicity-related residues and mutation costs.</title><p>(<bold>A</bold>) Same as <xref ref-type="fig" rid="fig3">Figure 3B</xref> for all the key residues: W at position 5 (39 sequences) and position 6 (20 sequences), F at position 5 (104 sequences) and position 7 (107 sequences); M at position 5 (33 sequences); Y at position 8 (90 sequences). (<bold>B</bold>) Experimental <italic>vs</italic> predicted mutation costs of non-lethal mutations (like in <xref ref-type="fig" rid="fig3">Figure 3G</xref>) for all 3 TCRs analyzed in <xref ref-type="bibr" rid="bib47">Łuksza et al., 2022</xref>, showing the predictions both by background RBM and the diffRBM units. The Spearmann correlation coefficient <inline-formula><mml:math id="inf20"><mml:mi>r</mml:mi></mml:math></inline-formula> for the predictions by background RBM is significant across the 3 TCRs (p-value ≤10<sup>-6</sup>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85126-fig3-figsupp1-v2.tif"/></fig></fig-group><p>Equipped with these single-alleles models of immunogenicity, we can perform two tasks, the prediction of peptide sites in contact with the TCR (<xref ref-type="fig" rid="fig1">Figure 1E</xref>) and the classification of immunogenic peptides against non-immunogenic ones (<xref ref-type="fig" rid="fig1">Figure 1F</xref>).</p></sec><sec id="s2-2"><title>Validation of model predictions against TCR-pMHC structures</title><p>Since the diffRBM units are inferred to capture the distinctive patterns of peptide immunogenicity, we hypothesized that the associated inferred parameters can be informative about the actual structural properties of the pMHC-TCR complex. To test this hypothesis, we collected a set of resolved crystal structures publicly available in the Protein Data Bank (<xref ref-type="bibr" rid="bib4">Berman et al., 2000</xref>) describing peptides in complex with the presenting HLA molecule and a cognate TCR. For each of these TCR-pMHC complexes, we estimated the peptide positions in contact with the TCR and the HLA (Methods, <xref ref-type="supplementary-material" rid="fig2sdata1">Figure 2—source data 1</xref>). <xref ref-type="fig" rid="fig2">Figure 2B–C</xref> show the frequency of contacts at each peptide position with the HLA (B) and the TCR (C) in peptides presented by HLA-A*02:01 (the HLA allele to which the large majority of structures is available, 41 over 46 structures, see Materials and methods). These contact frequency distributions highlight that positions 2 and 9 (and 1 and 3 to a lower extent) are the anchor sites for the binding of the peptide to the HLA-I protein (<xref ref-type="fig" rid="fig2">Figure 2B</xref>), while central positions (4-8) tend to be in contact to the TCR (<xref ref-type="fig" rid="fig2">Figure 2C</xref>), consistently with the analyses of structures reported in <xref ref-type="bibr" rid="bib69">Rudolph et al., 2006</xref>; <xref ref-type="bibr" rid="bib11">Calis et al., 2012</xref>; <xref ref-type="bibr" rid="bib72">Schmidt et al., 2021</xref>; <xref ref-type="bibr" rid="bib54">Milighetti et al., 2021</xref>. Previous measures of TCR functional avidity with mutant peptides indicate that amino acid changes at the peptide central positions impact the most T-cell activation (<xref ref-type="bibr" rid="bib35">Hoof et al., 2010</xref>; <xref ref-type="bibr" rid="bib72">Schmidt et al., 2021</xref>; <xref ref-type="bibr" rid="bib47">Łuksza et al., 2022</xref>), suggesting that these positions are important for TCR response. Anchor sites of peptide-HLA binding can be inferred from the background RBM parameters. We first focus on HLA-peptide binding. Anchor sites for the bond with the HLA constrain the amino acid usage at those positions across peptides presented by that same HLA, increasing the frequency of the amino acids required for binding (<italic>e.g</italic>. I, L, V at positions 2 and 9 of HLA-A*02:01 ligands). As a result, the sites occupied by the high-frequency amino acids at those positions are typically anchor sites (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). To check whether the background RBM captures this statistical information, we took the parameters learnt to reproduce the amino-acid statistics in HLA-A*02:01-presented peptides and we used them to define peptide site-specific quantities that we call ‘single-site factors’. These correspond essentially to the background RBM log probabilities of a given residue (Materials and methods). For each peptide found in the TCR-pMHC-A*02:01 structures, we ranked sequence positions by single-site factors and we verified this prediction against the true contacts by calculating an average Positive Predictive Value (PPV), see the inset of <xref ref-type="fig" rid="fig2">Figure 2B</xref> and Materials and methods. Large single-site factors (dashed-dotted black line), similarly to the amino acid frequency, detect the peptide-HLA binding anchor sites, both when the rest of the sequence is accounted for and when it is not (the average PPV of both these predictions is comparable to the amino acid frequency-based prediction, see <xref ref-type="fig" rid="fig2">Figure 2B</xref> and <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4A</xref>). DiffRBM single-site factors flag up peptide positions important for immunogenicity. Also in sets of immunogenic peptides we expect the statistics at the contact positions with the TCR to reflect the constraint of being in contact, when compared to the statistics of all presented peptides. These constraints are captured by the parameters linked to the diffRBM units. In analogy to the prediction of HLA-peptide binding via background RBM, we introduce ‘diffRBM single-site factors’ to predict the single residue potential to establish a contact with the TCR. The diffRBM single-site factors give approximately log odds-ratios between the full RBM and the background RBM probabilities of a certain residue conditional on the rest of the sequence (<xref ref-type="disp-formula" rid="equ11">Equation 11</xref> in Materials and methods). Once evaluated on an amino acid in a given peptide position, these model-dependent terms provide a measure of the predicted contribution to immunogenicity of the amino acid, while accounting for the sequence context given by all other sites. <xref ref-type="fig" rid="fig2">Figure 2C</xref> shows the average magnitude of the diffRBM single-site factors evaluated on the 41 peptides binding to HLA-A*02:01, which identifies positions 4–8 as the most relevant for immunogenicity. The pattern of positional contact frequency with the TCR in the same figure supports the structural interpretation of the model’s prediction in terms of binding between peptide and TCR. The diffRBM units’ prediction recovers the pattern of positions important for immunogenicity without restricting a priori the input sequences to a subset of peptide positions already known or assumed to be involved in TCR binding, in contrast with existing approaches (<xref ref-type="bibr" rid="bib12">Calis et al., 2013</xref>; <xref ref-type="bibr" rid="bib72">Schmidt et al., 2021</xref>) that choose a priori what positions to retain in the formulation of the immunogenicity model. DiffRBM single-site factors predict peptide contact positions with the TCR. We ranked sequence positions by the diffRBM single-site factors’ magnitude for each peptide in the TCR-pMHC complexes, and we took the highest ranking positions as predicted contact points. The peptide-averaged PPV for this prediction as a function of the ranked positions (<xref ref-type="fig" rid="fig2">Figure 2D</xref>) indicates a model’s predictive power substantially higher than the random expectation (the p-value of this difference at the first ranked position is <inline-formula><mml:math id="inf21"><mml:mrow><mml:mn mathsize="80%">7.7</mml:mn><mml:mo mathsize="80%" stretchy="false">×</mml:mo><mml:msup><mml:mn mathsize="80%">10</mml:mn><mml:mrow><mml:mo mathsize="80%" stretchy="false">-</mml:mo><mml:mn mathsize="80%">5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, see Materials and methods). We compared the prediction by the diffRBM units to predictions based on the enrichment in amino acid usage in immunogenic peptides (<xref ref-type="fig" rid="fig2">Figure 2C–D</xref>). In this case, we ranked positions based on the log ratio between the position-specific amino acid frequency in immunogenic peptides of a given HLA type and the one in the set of either all presented peptides or the non-immunogenic peptides with the same HLA type (Materials and methods). The diffRBM units outperform these predictions based on amino acid frequency ratios, as quantified by the average PPV (<xref ref-type="fig" rid="fig2">Figure 2D</xref>, <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>). For the HLA-A*02:01 peptides, we also found that the magnitude of the diffRBM single-site factors across positions correlates with the pattern of contact frequency better than predictions based on amino acid frequency ratios (<xref ref-type="fig" rid="fig2">Figure 2C</xref>).</p></sec><sec id="s2-3"><title>DiffRBM encodes molecular features of immunogenicity</title><p>Next, we assessed whether our model predictions of the residues’ contribution to immunogenicity, based on single-site factors, are consistent with previous findings (<xref ref-type="bibr" rid="bib63">Piepenbrink et al., 2013</xref>; <xref ref-type="bibr" rid="bib14">Chowell et al., 2015</xref>; <xref ref-type="bibr" rid="bib67">Riley et al., 2019</xref>; <xref ref-type="bibr" rid="bib72">Schmidt et al., 2021</xref>; <xref ref-type="bibr" rid="bib47">Łuksza et al., 2022</xref>). We inspected the amino acid enrichment with respect to non-immunogenic antigens at the common peptide-TCR contact points (positions 4–8) in <xref ref-type="fig" rid="fig3">Figure 3A</xref>. Some of the observed trends resemble the ones found in previous studies, for instance: the bias, in immunogenic sequences, towards hydrophobic amino acids (<xref ref-type="bibr" rid="bib14">Chowell et al., 2015</xref>; <xref ref-type="bibr" rid="bib67">Riley et al., 2019</xref>; <xref ref-type="bibr" rid="bib47">Łuksza et al., 2022</xref>; <xref ref-type="bibr" rid="bib10">Buckley et al., 2022</xref>) (especially valine, V); the abundance of glutamic acid (E) (<xref ref-type="bibr" rid="bib12">Calis et al., 2013</xref>) and, to a more moderate extent, of tryptophan (W) <xref ref-type="bibr" rid="bib72">Schmidt et al., 2021</xref>; <xref ref-type="bibr" rid="bib47">Łuksza et al., 2022</xref>; the depletion of the small polar amino acid serine (S) and the positively charged amino acid lysine (K), consistently with the observations respectively in <xref ref-type="bibr" rid="bib14">Chowell et al., 2015</xref> and <xref ref-type="bibr" rid="bib72">Schmidt et al., 2021</xref>. We noted also a number of discrepancies, presumably due to the use of updated datasets of immunogenic and non-immunogenic peptides and the restriction to sequences of only three selected HLA types. The most striking is the under-representation of the aromatic amino acids phenylalanine (F) and tyrosine (Y), particularly severe in HLA-A*02:01, in contrast with the experiment-based observations in <xref ref-type="bibr" rid="bib72">Schmidt et al., 2021</xref>; <xref ref-type="bibr" rid="bib63">Piepenbrink et al., 2013</xref>. Note however that also other analyses performed on IEDB data, like <xref ref-type="bibr" rid="bib12">Calis et al., 2013</xref>; <xref ref-type="bibr" rid="bib14">Chowell et al., 2015</xref>, did not flag up a significant enrichment in Y. DiffRBM single-site factors recover the positive contribution to immunogenicity of key residues. We considered a few combinations of amino acids and positions along the peptide that were suggested to play a crucial role in T-cell reactivity and binding (in the context of HLA-A*02:01 epitopes) based on structural or functional analyses. For instance, W at position 6 and F at position 7 (<xref ref-type="bibr" rid="bib72">Schmidt et al., 2021</xref>), as well as Y at position 8 (<xref ref-type="bibr" rid="bib63">Piepenbrink et al., 2013</xref>), were observed to form a variety of stabilizing interactions with the TCR. Testing functional avidity of TCRs against peptides harbouring single-point mutations, (<xref ref-type="bibr" rid="bib72">Schmidt et al., 2021</xref>) detected that F and W at position 5 triggered the strongest activation signal, while <xref ref-type="bibr" rid="bib47">Łuksza et al., 2022</xref> found that the substitution of methionine (M) at position 5 systematically abrogated TCR response.</p><p>For each of these combinations, we identified the sequences possessing the particular amino acid at the combined position and calculated the diffRBM single-site factors for that position (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). For all amino acid/position pairs, the distribution of these single-site factors is skewed toward positive values (<xref ref-type="fig" rid="fig3">Figure 3B</xref>, <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1A</xref>), meaning that the diffRBM units predict a positive contribution to immunogenicity. In contrast, measuring purely the amino acid frequency ratio at that position under the independent-site assumption predicts a contribution to immunogenicity that is significantly smaller (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). In other words, the diffRBM’s ability to capture the sequence context reconciles its predictions with previous findings on residues that are key to immunogenicity.</p><p>Model predictions are in agreement with data on TCR reactivity to mutant peptides. To further corroborate the connection between the model’s predictions and T-cell reactivity assays, we considered the data from <xref ref-type="bibr" rid="bib47">Łuksza et al., 2022</xref> on the TCR response to one of the highly immunogenic peptides to which our HLA-A*02:01-specific diffRBM model of immunogenicity can be applied (NLVPMVATV from the human cytomegalovirus). These data measure TCR reactivity to all possible single-site mutants of NLVPMVATV for 3 TCRs specific to it (Materials and methods, <xref ref-type="fig" rid="fig3">Figure 3C</xref>). Some of these single-site mutations do not cause a complete loss of TCR response (‘non-lethal’ mutations), meaning that TCR reactivity can be recovered by increasing the peptide concentration (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). We can estimate a ‘cost’ for such mutations in terms of the TCR cross-reactivity between NLVPMVATV and its mutants, measured in <xref ref-type="bibr" rid="bib47">Łuksza et al., 2022</xref> as the log ratio between the half maximal effective concentration for TCR activation after the peptide has been mutated (<inline-formula><mml:math id="inf22"><mml:mrow><mml:mi mathsize="80%">E</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathsize="80%">C</mml:mi><mml:mn mathsize="80%">50</mml:mn><mml:mrow><mml:mi mathsize="80%">M</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="80%">T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>) and the one before the mutation (<inline-formula><mml:math id="inf23"><mml:mrow><mml:mi mathsize="80%">E</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathsize="80%">C</mml:mi><mml:mn mathsize="80%">50</mml:mn><mml:mrow><mml:mi mathsize="80%">W</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="80%">T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>), see <xref ref-type="fig" rid="fig3">Figure 3C</xref>. Other mutations completely destroy peptide-TCR binding, and TCR reactivity cannot be restored even at highest peptide concentrations considered (‘lethal’ mutations, see <xref ref-type="fig" rid="fig3">Figure 3C</xref>).</p><p>Lethal mutations tend to occur at the typical TCR-contact positions along the peptide (<xref ref-type="fig" rid="fig3">Figure 3D</xref>), and we confirmed that the diffRBM single-site factors predict mainly positive costs for these mutations (see Materials and methods), which matches qualitatively the observed loss of immunogenicity (<xref ref-type="fig" rid="fig3">Figure 3E</xref>).</p><p>We observed that the magnitude of non-lethal mutations across all TCR-mutant pairs is concentrated at the peptide positions 2 and 9, which are the anchor sites for binding the HLA in HLA-A*02:01-specific peptides (<xref ref-type="fig" rid="fig3">Figure 3F</xref>). We therefore hypothesized that these mutation costs, despite being measured in terms of loss of TCR reactivity, could reflect a disruption of the peptide presentation on the HLA. We found that the model prediction for HLA-A*02:01 presentation (background RBM) correlates in a statistically significant way to the experimental mutation costs, and the degree of correlation is consistent across all three TCRs (<xref ref-type="fig" rid="fig3">Figure 3G</xref>, <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1B</xref>). In contrast, the diffRBM single-site factors cannot predict these mutational effects concentrated at the anchor sites for presentation (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1B</xref>), since its parameters capture the distinctive molecular composition of immunogenic peptides at the central positions (<xref ref-type="fig" rid="fig2">Figure 2C</xref>).</p></sec><sec id="s2-4"><title>DiffRBM discriminates immunogenic <italic>vs</italic> non-immunogenic peptides</title><p>The diffRBM units learn distinctive sequence patterns of immunogenicity, having the background RBM captured the sequence constraints associated to presentability. Such patterns should contribute to distinguish immunogenic from non-immunogenic peptides. We therefore assigned scores of immunogenicity based on the diffRBM units to held-out test sets of peptides (<xref ref-type="fig" rid="fig4">Figure 4A</xref>) and we measured the score’s ability to discriminate HLA-specific immunogenic peptides from non-immunogenic ones sharing the same HLA specificity in terms of the area under the receiver operating characteristic curve (AUC), see inset of <xref ref-type="fig" rid="fig4">Figure 4A</xref> and Materials and methods.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Immunogenic <italic>vs</italic> non-immunogenic peptide discrimination performance.</title><p>(<bold>A</bold>) The Area Under the Curve (AUC, see Materials and methods) is computed for HLA-specific diffRBM units’ scores of immunogenic and non-immunogenic held-out peptides. (<bold>B</bold>) Performance of diffRBM units, full RBM, background RBM, and other methods, for the HLA-A*02:01 dataset. Semi-supervised methods (red) are trained only on immunogenic (or presented) peptides. Supervised methods (green) are trained with immunogenic and non-immunogenic peptides. ‘DiffRBM units (difference)’ is intermediate, exploiting the annotation of peptides as immunogenic and non-immunogenic <italic>a-posteriori</italic> (but it is not trained for the discrimination task). (<bold>C–D</bold>) Same as B, for HLA-B*07:02 (<bold>C</bold>) and HLA-B*35:01 (<bold>D</bold>). All AUC values are the averaged over 50 train/test set partitions, and error bars give the corresponding standard deviation (Materials and methods).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85126-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Comparison of performance of differential models of immunogenicity.</title><p>Comparison of performance, in terms of the AUC of immunogenic <italic>vs</italic> non-immunogenic discrimination, between diffRBM, its version where the differential part is linear (diffRBM lin.) and a PWM approach. Here PWM refers to the approaches described in Supporting Methods (section ‘PWM-based approach’), where the ‘Full model’ is given by the PWM learnt on the selected data (immunogenic peptides) while the ‘Differential part’ corresponds to the ratio of the PWM learnt on selected data and the PWM learnt on the background data. AUCs are averages over 50 training-test partitions and error bars give the corresponding standard deviation (Materials and methods).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85126-fig4-figsupp1-v2.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 2.</label><caption><title>Score comparison between immunogenic peptides and peptides from the human proteome.</title><p>We have drawn at random 10<sup>5</sup> peptides from all the possible 9-mers in the human proteome and we have assigned to them scores under the HLA-specific models listed in the legend. We have measured via the AUC the extent to which scores assigned by these models to HLA-specific immunogenic peptides are higher than the ones assigned either to only the peptides predicted to be presented on the corresponding HLA by NetMHCpan4.1 (<bold>A</bold>) or to all the 10<sup>5</sup> human proteome peptides (<bold>B</bold>). AUCs are averages over 50 training-test partitions and error bars give the corresponding standard deviation (Materials and methods).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85126-fig4-figsupp2-v2.tif"/></fig><fig id="fig4s3" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 3.</label><caption><title>Leave-one-organism-out cross-validation for HLA-A*02:01-specific model (Materials and methods).</title><p>The case of <italic>Trypanosoma cruzi</italic> visibly constitutes an outlier, whereby the binding affinity to the HLA alone discriminates accurately immunogenic and non immunogenic antigens (AUC = 0.85). This result is confirmed by scoring the peptides via NetMHCpan4.1 (AUC=0.85). Excluding this case, the average diffRBM units AUC = 0.68, which is comparable to the AUC obtained via standard validation (average AUC = 0.66, <xref ref-type="fig" rid="fig4">Figure 4B</xref>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85126-fig4-figsupp3-v2.tif"/></fig><fig id="fig4s4" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 4.</label><caption><title>Further comparison of diffRBM and RBM scores.</title><p>Upper row: the AUC of classification of immunogenic <italic>vs</italic> non-immunogenic peptides given by the full RBM (trained in part on the background dataset and in part on the selected data and indicated as ‘RBM (differential)’) is essentially the same as the one of an RBM with the same hyperparameters trained only on selected data (denoted as ‘RBM (non-differential)’). The comparison is made separately for each HLA. In these scatter plots every point gives the AUC of discrimination of the two models compared for one of the 50 random partitions into training and test sets of the corresponding HLA-specific dataset (Materials and methods). Bottom row: we consider the AUC of immunogenic <italic>vs</italic> non-immunogenic classification obtained through the difference of scores between the diffRBM units trained on immunogenic peptides and the ones trained on non-immunogenic peptides. The scatter plots show that such performance (on the y-axis), as it should, is equivalent to the one attained by the difference of the full RBM log-likelihoods (x-axis).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85126-fig4-figsupp4-v2.tif"/></fig><fig id="fig4s5" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 5.</label><caption><title>Hyperparametric search for the classifier of immunogenicity.</title><p>The hyperparametric search for the classifier is based on the optimal performance on the validation dataset at discriminating immunogenic <italic>vs</italic> non-immunogenic peptides as measured by the AUC. We show the mean AUC over 50 random partitions into training set (<bold>A</bold>) and validation set (<bold>B</bold>). The labels on the x-axis denote different classifier architectures, which are described in C, while the label ‘WD’ stands for the coefficient of weight decay used. (<bold>C</bold>) Tested architectures for the classifier of immunogenicity. All classifiers alternate dense linear layers with LeakyReLU (<xref ref-type="bibr" rid="bib49">Maas et al., 2013</xref>) activation functions. The models differ in the number of layers (column <italic>Depth</italic>) and the width of intermediate layers (column <italic>Intermediate widths</italic>). The first layer is always of input size 180 = 21×9, and corresponds to one-hot encoded sequences of length 9 with 20 amino-acid + 1 gap letters. The last layer always has an output of size 1 giving the predicted log-odds that the input sequence is immunogenic. Model C1 has no intermediate layers and corresponds to the linear classifier whose results are shown in <xref ref-type="fig" rid="fig4">Figure 4</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85126-fig4-figsupp5-v2.tif"/></fig><fig id="fig4s6" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 6.</label><caption><title>Performance of differential models of immunogenicity with sample reweighting.</title><p>Performance at discriminating immunogenic <italic>vs</italic> non-immunogenic peptides (like in <xref ref-type="fig" rid="fig4">Figure 4</xref>) where a reweighting scheme based on sequence similarity is applied during training (Materials and methods).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85126-fig4-figsupp6-v2.tif"/></fig></fig-group><p>In <xref ref-type="fig" rid="fig4">Figure 4B</xref>, we compare the diffRBM units’ AUC for the HLA-A*02:01-specific model to the AUC of the full RBM, that includes the background model in its predictions and hence yields a joint representation of the enriched patterns and of the background constraints. The AUC of discrimination progressively decreases, as expected, from the model part that disentangles enriched patterns from the background constraints (diffRBM units), to the full RBM capturing both, to the model fit to the background constraints only (background RBM). (In fact, there is no reason why background RBM should predict anything at all unless presentability and immunogenicity are correlated). This trend indicates that learning the background constraints that are shared by immunogenic and non-immunogenic peptides along with the sequence pattern enrichment distinctive of immunogenicity can act as a confounding factor when we look for the features that characterize and distinguish immunogenic peptides. Also simpler differential models relying on the independent-site assumption, while returning lower AUCs than RBM-based models, exhibit a decrease in AUC between the differential part and the full model (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). The AUC values and trend remain stable when we compare scores assigned to immunogenic peptides and to peptides from the human proteome (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2A</xref>) and when we score immunogenic and non-immunogenic peptides from the same organism having trained the models on the immunogenic peptides from all the other organisms (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>).</p><p>Conversely, the diffRBM units are not designed to capture the background constraints (here associated to presentability). As a result, they cannot successfully discriminate presentable antigens from generic peptides that are predominantly non-presentable (like peptides randomly drawn from the human proteome), in contrast to background RBM and the full RBM (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2B</xref>). The same trends of discrimination performance are consistently found across the 3 HLA alleles considered (<xref ref-type="fig" rid="fig4">Figure 4C–D</xref>, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>, <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>).</p><p>The prediction by the background model (trained on peptides probed for their binding to a given HLA-I) provides no clear signal that already the binding affinity to the HLA can discriminate immunogenic peptides (average AUC = 0.55 for HLA-A*02:01, 0.50 for HLA-B*07:02, 0.53 for HLA-B*35:01, see <xref ref-type="fig" rid="fig4">Figure 4</xref>). To further check this prediction, we scored HLA-A*02:01 peptides by their binding affinity to the HLA through NetMHCpan4.1 (<xref ref-type="bibr" rid="bib66">Reynisson et al., 2020</xref>) and found a comparable difference in score distributions between immunogenic and non-immunogenic peptides (AUC = 0.54 for HLA-A*02:01, 0.48 for HLA-B*07:02, 0.53 for HLA-B*35:01). Our observation is in line with a recent large-scale mapping of killer T-cell recognition of candidate neopeptides at high HLA affinity (<xref ref-type="bibr" rid="bib41">Kristensen et al., 2022</xref>), which did not find a significantly different distribution of HLA-binding NetMHCpan scores between immunogenic <italic>vs</italic> non-immunogenic neopeptides. Other studies, however, have suggested that immunogenic peptides bind more strongly to the HLA compared to non-immunogenic ones, both in the case of viral epitopes (<xref ref-type="bibr" rid="bib18">Croft et al., 2019</xref>; <xref ref-type="bibr" rid="bib10">Buckley et al., 2022</xref>) and neo-epitopes (<xref ref-type="bibr" rid="bib5">Bjerregaard et al., 2017</xref>; <xref ref-type="bibr" rid="bib10">Buckley et al., 2022</xref>). More work is needed in the future to clarify the link between binding affinity to the HLA and immunogenicity.</p></sec><sec id="s2-5"><title>A deeper classifier reaches optimal performance, but diffRBM stays comparable</title><p>To perform a task of classification of immunogenic <italic>vs</italic> non-immunogenic peptides, it is more effective to leverage the information in both sets of immunogenic and non-immunogenic peptides. In our framework of differential learning, this can be done by training a second set of differential units on the non-immunogenic peptides, which learns differences in their amino acid statistics with respect to the background. The difference of the scores of the diffRBM units trained on immunogenic peptides and the ones trained on non-immunogenic peptides plays as well the role of a score of immunogenicity, expected to be positive when evaluated on immunogenic peptides and negative on non-immunogenic peptides (Materials and methods). We use it to classify immunogenic <italic>vs</italic> non-immunogenic peptides, resorting to the AUC to measure its classification performance (<xref ref-type="fig" rid="fig4">Figure 4B–D</xref>).</p><p>Exploiting the availability of both immunogenic and non-immunogenic peptides, we also trained a deep neural-network-based classifier. The classifier architecture was optimized among several ones of different depth and width (Materials and methods, <xref ref-type="fig" rid="fig4s5">Figure 4—figure supplement 5</xref>) and reaches a performance quantified by a cross-HLA average AUC = <inline-formula><mml:math id="inf24"><mml:mrow><mml:mn mathsize="80%">0.71</mml:mn><mml:mo mathsize="80%" stretchy="false">±</mml:mo><mml:mn mathsize="80%">0.02</mml:mn></mml:mrow></mml:math></inline-formula> (see ‘optimal classifier’ in <xref ref-type="fig" rid="fig4">Figure 4B–D</xref>; here and in the following uncertainties are estimated over several training-test partitions, see Materials and methods), higher than the best linear classifier (AUC = <inline-formula><mml:math id="inf25"><mml:mrow><mml:mn mathsize="80%">0.66</mml:mn><mml:mo mathsize="80%" stretchy="false">±</mml:mo><mml:mn mathsize="80%">0.02</mml:mn></mml:mrow></mml:math></inline-formula>). The AUC of the optimal classifier sets the maximal predictive performance that can be achieved, with the datasets under consideration, by a supervised method that is trained to discriminate immunogenic and non-immunogenic antigens. Its value (AUC = <inline-formula><mml:math id="inf26"><mml:mrow><mml:mn mathsize="80%">0.71</mml:mn><mml:mo mathsize="80%" stretchy="false">±</mml:mo><mml:mn mathsize="80%">0.02</mml:mn></mml:mrow></mml:math></inline-formula>) indicates that the predictability of immunogenicity from peptide sequences is limited, both by data availability and by the fact that sequence patterns along the peptide are not the only determinant of a positive T-cell response. In the future, more exhaustive assessments of peptide immunogenicity should account for the composition of cognate TCRs, peptide expression levels as well as the regulatory dynamics underlying T-cell response in physiological conditions. The performance of the diffRBM units’ scores (AUC = <inline-formula><mml:math id="inf27"><mml:mrow><mml:mn mathsize="80%">0.69</mml:mn><mml:mo mathsize="80%" stretchy="false">±</mml:mo><mml:mn mathsize="80%">0.02</mml:mn></mml:mrow></mml:math></inline-formula>) is slightly lower than the one of the optimal classifier but higher than the one of the linear classifier (<xref ref-type="fig" rid="fig4">Figure 4B–D</xref>). We emphasize that the deep classifier is trained in a supervised way (<italic>i.e</italic>. using information on the two ‘labels’, immunogenic and non-immunogenic) while our RBM-based approach in <xref ref-type="fig" rid="fig4">Figure 4</xref> is ‘semi-supervised’ because its training requires knowledge of a portion of the ‘labels’ (the antigens labelled as ‘immunogenic’) only.</p><p>Finally, we checked that the performance of diffRBM compares favorably to established sequence-based methods for immunogenicity prediction (<xref ref-type="bibr" rid="bib12">Calis et al., 2013</xref>; <xref ref-type="bibr" rid="bib72">Schmidt et al., 2021</xref>; <xref ref-type="bibr" rid="bib67">Riley et al., 2019</xref>), for more details see Supporting Information - Appendix 1 - Comparison of performance with existing tools.</p></sec><sec id="s2-6"><title>DiffRBM model for T-cell-specific binding</title><p>To train diffRBM models of epitope specificity, we first collected from the VDJdb database (<xref ref-type="bibr" rid="bib78">Shugay et al., 2018</xref>; <xref ref-type="bibr" rid="bib3">Bagaev et al., 2020</xref>) datasets of TCRs specific to 4 epitopes (Materials and methods): the M1<sub>58</sub> peptide from the influenza virus (with sequence GILGFVFTL), the pp65<sub>495</sub> from the human cytomegalovirus (CMV, with sequence NLVPMVATV), the BMLF1<sub>280</sub> peptide from the Epstein-Barr virus (EBV, with sequence GLCTLVAML), the peptide from the Spike protein S<sub>269</sub> from Sars-Cov-2 (with sequence YLQPRTFLL). We limited the search to sequences of the <inline-formula><mml:math id="inf28"><mml:mi mathsize="80%">β</mml:mi></mml:math></inline-formula> chain of the TCR (TCRβ), where the sites of binding to the antigen are concentrated in a region called complementarity determining region 3 (CDR3β).</p><p>The background dataset, in this case, is meant as a typical bulk TCRβ repertoire in normal conditions (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). In particular we take, to train background RBM, the repertoire of a hypothetical universal donor that was constructed by <xref ref-type="bibr" rid="bib37">Isacchini et al., 2021</xref> from the TCRβ repertoires of the large scale study <xref ref-type="bibr" rid="bib25">Emerson et al., 2017</xref> (Materials and methods). The sequence features captured by background RBM concern germline-encoded amino acid usage related to stability and binding constraints (as is the case for the two conserved residues cysteine and phenylalanine delimiting the CDR3β region), as well as additional biases in amino acid usage stemming from VDJ recombination and thymic selection.</p><p>After having trained the background RBM, we train a set of diffRBM units on each set of epitope-specific CDR3β (<xref ref-type="fig" rid="fig5">Figure 5A</xref>, <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). By design, these diffRBM units capture antigen-driven convergent sequence features that have been documented in connection to epitope specificity (<xref ref-type="bibr" rid="bib19">Dash et al., 2017</xref>; <xref ref-type="bibr" rid="bib31">Glanville et al., 2017</xref>; <xref ref-type="bibr" rid="bib52">Meysman et al., 2019</xref>; <xref ref-type="bibr" rid="bib65">Pogorelyy and Shugay, 2019b</xref>; <xref ref-type="bibr" rid="bib83">Thakkar and Bailey-Kellogg, 2019</xref>; <xref ref-type="bibr" rid="bib51">Mayer-Blackwell et al., 2021</xref>; <xref ref-type="bibr" rid="bib87">Valkiers et al., 2021</xref>). As such, similarly to the model of antigen immunogenicity, the diffRBM units can predict contact sites along the CDR3β (<xref ref-type="fig" rid="fig1">Figure 1E</xref>) and classify specific receptor against generic, predominantly non-specific ones (<xref ref-type="fig" rid="fig1">Figure 1F</xref>).</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>DiffRBM model of TCR epitope specificity and structural interpretation.</title><p>(<bold>A</bold>) DiffRBM units are learnt from CDR3β sequences of antigen-specific TCRs. (<bold>B</bold>) Contact frequency distribution (bars) with peptide at each CDR3β position, across 12 structures (2 for YLQPRTFLL, 3 for NLVPMVATV, 1 for GLCTLVAML, 6 for GILGFVFTL). CDR3β positions are given as distances to either the left or right anchor sites. Contacts are sites with distance ≤4 Å between CDR3β and peptide. Magnitude of single-site factors based on the diffRBM units or the amino acid frequency ratio (of peptide-specific sequences relative to bulk-repertoire sequences) averaged over the 12 CDR3β are shown as lines. (<bold>C</bold>) PPV of CDR3β-peptide contact positions, averaged over the 12 structures, using single-site factors from the peptide-specific models (diffRBM or amino-acid frequency ratios). PPVs are reweighed by CDR3β sequence similarity (Materials and methods, <xref ref-type="fig" rid="fig5s3">Figure 5—figure supplement 3A–B</xref>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85126-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Schematic summary of the construction of a diffRBM model of TCR epitope-specificity.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85126-fig5-figsupp1-v2.tif"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 2.</label><caption><title>Hyperparametric search for the diffRBM model of TCR specificity.</title><p>(<bold>A-B</bold>) Hyperparametric search for the background RBM model using the dataset from <xref ref-type="bibr" rid="bib25">Emerson et al., 2017</xref> (Materials and methods). Due to the large sample size, the differences between training and validation sets arising from sampling are minimal and as a result the model’s performance is largely equivalent. (<bold>C-D</bold>) Hyperparametric search for the diffRBM units, performed in the same way as for the immunogenicity model (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2A–B</xref>). The diffRBM units’ scores plotted are averages over 50 random partitions into a training (<bold>C</bold>) and validation set (<bold>D</bold>), see Materials and methods. Dataset used: set of sequences specific to the CMV peptide NLVPMVATV (<inline-formula><mml:math id="inf29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> = 4548). (<bold>E</bold>) AUC of discrimination between epitope-specific and generic sequences in the test set (averaged over 50 random training-test set partitions) varying <inline-formula><mml:math id="inf30"><mml:msup><mml:mi>N</mml:mi><mml:mi>h</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf31"><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>. The black bold dot in <bold>A–B</bold> and <bold>C–E</bold> marks the combination of <inline-formula><mml:math id="inf32"><mml:msup><mml:mi>N</mml:mi><mml:mi>h</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf33"><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> chosen, respectively, for background RBM (<inline-formula><mml:math id="inf34"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mi>h</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf35"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>) and diffRBM units (<inline-formula><mml:math id="inf36"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mi>h</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf37"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>). (<bold>F</bold>) As a control, differential models are trained on a randomly drawn portion of the background dataset of size <inline-formula><mml:math id="inf38"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, for varying <inline-formula><mml:math id="inf39"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, instead of a training set of epitope-specific sequences, and then their differential part is used to estimate the AUC of discrimination between epitope-specific and generic sequences in the test set, see the caption of <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2D</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85126-fig5-figsupp2-v2.tif"/></fig><fig id="fig5s3" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 3.</label><caption><title>Prediction of CDR3β contact positions with the peptide.</title><p>(<bold>A</bold>) Similarly to <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3A</xref>, the average PPV of contact prediction shown in <xref ref-type="fig" rid="fig5">Figure 5C</xref> is compared to the PPV by two alternative predictors, the expression (<xref ref-type="disp-formula" rid="equ25">Equation 25</xref>) (‘diffRBM units (score diff.)’, dashed line) and the single-site factors from diffRBM units with fields only (‘diffRBM units (lin.)’, dashed-dotted line). (<bold>B</bold>) is the same plot as A but obtained without applying the reweighting to account for peptide sequence similarity (Materials and methods). (<bold>C</bold>) Same plot as <xref ref-type="fig" rid="fig5">Figure 5C</xref>, where predictions are divided by epitope specificity. The number of structures considered is as follows: 2 structures for YLQPRTFLL, 3 for NLVPMVATV, 1 for GLCTLVAML, and 6 for GILGFVFTL. (<bold>D</bold>) Same plot as <xref ref-type="fig" rid="fig5">Figure 5C</xref> varying the threshold in Å to define a contact. The cutoff 5 Å is the one used in <xref ref-type="bibr" rid="bib11">Calis et al., 2012</xref>; <xref ref-type="bibr" rid="bib31">Glanville et al., 2017</xref>; <xref ref-type="bibr" rid="bib60">Ostmeyer et al., 2019</xref>; <xref ref-type="bibr" rid="bib54">Milighetti et al., 2021</xref>. In all plots, the blue dotted line marks the result of predicting at random the contact positions (Materials and methods).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85126-fig5-figsupp3-v2.tif"/></fig></fig-group></sec><sec id="s2-7"><title>DiffRBM predicts CDR3-β contact positions with the peptide</title><p>It has been discussed that convergent features in receptors responding to same antigens have structural interpretation in terms of interactions across the peptide-TCR interface (<xref ref-type="bibr" rid="bib19">Dash et al., 2017</xref>; <xref ref-type="bibr" rid="bib31">Glanville et al., 2017</xref>) and that the TCR contact regions are dominated by CDR3β residues (<xref ref-type="bibr" rid="bib31">Glanville et al., 2017</xref>; <xref ref-type="bibr" rid="bib60">Ostmeyer et al., 2019</xref>; <xref ref-type="bibr" rid="bib54">Milighetti et al., 2021</xref>; see also <xref ref-type="fig" rid="fig1">Figure 1E</xref>). Starting from the available TCR-pMHC structures already analyzed, we looked at the peptide-TCR contacts lying in the CDR3β region of the TCR, focusing on the structures involving the four epitopes under consideration (12 structures in total, see Materials and methods). <xref ref-type="fig" rid="fig5">Figure 5B</xref> shows the distribution of contacts along the CDR3β positions, which consists, as already observed in <xref ref-type="bibr" rid="bib31">Glanville et al., 2017</xref>; <xref ref-type="bibr" rid="bib60">Ostmeyer et al., 2019</xref>; <xref ref-type="bibr" rid="bib54">Milighetti et al., 2021</xref>, of stretches of 3–5 contiguous amino acids in the central part of the CDR3 (6–8 positions from the left and right anchor).</p><p>We estimated the diffRBM single-site factors for the CDR3β sequences from the available structures. Their average value across CDR3β sequences concentrates on the CDR3β central positions and well correlates with the contact frequency distribution (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). We next ranked the positions by the single-site factor magnitude and we took top ranking positions as positions of predicted contact. <xref ref-type="fig" rid="fig5">Figure 5C</xref> shows the PPV averaged over the 12 available structures (Materials and methods). Similarly to the predictions for peptides (<xref ref-type="fig" rid="fig2">Figure 2D</xref>), the predictive power of the diffRBM units is superior to the position-specific amino acid frequency ratio between the antigen-specific and the bulk-repertoire set of receptors, and is substantially higher than the random expectation (the p-value of this difference at the first ranked position is 1.6 × 10<sup>-5</sup>, see Materials and methods). The PPV trend stays robust varying the distance cutoff from 4 up to 5 Å (the value chosen to determine peptide-TCR contacts in other work <xref ref-type="bibr" rid="bib11">Calis et al., 2012</xref>; <xref ref-type="bibr" rid="bib31">Glanville et al., 2017</xref>; <xref ref-type="bibr" rid="bib60">Ostmeyer et al., 2019</xref>; <xref ref-type="bibr" rid="bib54">Milighetti et al., 2021</xref>), see <xref ref-type="fig" rid="fig5s3">Figure 5—figure supplement 3D</xref>.</p></sec><sec id="s2-8"><title>DiffRBM discriminates specific receptors</title><p>We tested the power to discriminate receptors specific to the 4 epitopes under consideration (GILGFVFTL, NLVPMVATV, GLCTLVAML, YLQPRTFLL) from generic sequences drawn from a bulk repertoire (background dataset). These can be seen as a proxy for non-specific receptors, since the large majority of them is not expected to respond to a specific epitope. We measured the performance at discriminating specific from generic receptors by the AUC (<xref ref-type="fig" rid="fig6">Figure 6A</xref>) and the results for the 4 epitope-specific models are reported in <xref ref-type="fig" rid="fig6">Figure 6B–E</xref>, <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>. We observed the same trend described for the models of immunogenicity, whereby the AUC of discrimination for the diffRBM units is consistently higher than the one for the full RBM. Also in this context, singling out the sequence features associated to epitope specificity, as the differential units do, enhances the model’s predictive performance compared to the full RBM, where the information on those features is added to the background constraints. Any discrimination power is lost when using the background RBM, as it should, since it has no information on epitope specificity.</p></sec><sec id="s2-9"><title>DiffRBM reaches state-of-the-art performance</title><p>For the sake of comparison of diffRBM to other tools, we considered another generative model of antigen-specific repertoires, SONIA (<xref ref-type="bibr" rid="bib23">Elhanati et al., 2014</xref>; <xref ref-type="bibr" rid="bib74">Sethna et al., 2020</xref>), and a series of methods trained to discriminate target-specific from unspecific receptors (labeled as ‘supervised’ in <xref ref-type="fig" rid="fig6">Figure 6B–E</xref>), which include: a baseline method to determine the predictive power achievable from TCR sequence similarity alone (a <inline-formula><mml:math id="inf40"><mml:mi mathsize="80%">k</mml:mi></mml:math></inline-formula>-Nearest Neighbours classifier, <inline-formula><mml:math id="inf41"><mml:mi mathsize="80%">k</mml:mi></mml:math></inline-formula>-NN, see Supporting Information - Appendix 3 - Alternative approaches tested and <xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3</xref>); the state-of-the-art supervised predictors of TCR specificity TCRex (<xref ref-type="bibr" rid="bib30">Gielis et al., 2019</xref>) and NetTCR-2.0 (<xref ref-type="bibr" rid="bib56">Montemurro et al., 2021</xref>). As shown in <xref ref-type="fig" rid="fig6">Figure 6B–E</xref>, the performance of the diffRBM units is fully comparable to the most performant among the state-of-the-art supervised methods, TCRex (both with an average AUC across peptides of <inline-formula><mml:math id="inf42"><mml:mrow><mml:mn mathsize="80%">0.83</mml:mn><mml:mo mathsize="80%" stretchy="false">±</mml:mo><mml:mn mathsize="80%">0.01</mml:mn></mml:mrow></mml:math></inline-formula>), and higher than SONIA, <inline-formula><mml:math id="inf43"><mml:mi mathsize="80%">k</mml:mi></mml:math></inline-formula>-NN (AUC = <inline-formula><mml:math id="inf44"><mml:mrow><mml:mn mathsize="80%">0.80</mml:mn><mml:mo mathsize="80%" stretchy="false">±</mml:mo><mml:mn mathsize="80%">0.01</mml:mn></mml:mrow></mml:math></inline-formula> for both), and NetTCR-2.0 (AUC = <inline-formula><mml:math id="inf45"><mml:mrow><mml:mn mathsize="80%">0.73</mml:mn><mml:mo mathsize="80%" stretchy="false">±</mml:mo><mml:mn mathsize="80%">0.01</mml:mn></mml:mrow></mml:math></inline-formula>). Similarly, when computing the average precision (AP), diffRBM (with AP averaged over the 4 peptides of <inline-formula><mml:math id="inf46"><mml:mrow><mml:mn mathsize="80%">0.87</mml:mn><mml:mo mathsize="80%" stretchy="false">±</mml:mo><mml:mn mathsize="80%">0.01</mml:mn></mml:mrow></mml:math></inline-formula>) works as well or slightly better than TCRex (AP = <inline-formula><mml:math id="inf47"><mml:mrow><mml:mn mathsize="80%">0.86</mml:mn><mml:mo mathsize="80%" stretchy="false">±</mml:mo><mml:mn mathsize="80%">0.01</mml:mn></mml:mrow></mml:math></inline-formula>) and better than NetTCR2.0 (AP = <inline-formula><mml:math id="inf48"><mml:mrow><mml:mn mathsize="80%">0.76</mml:mn><mml:mo mathsize="80%" stretchy="false">±</mml:mo><mml:mn mathsize="80%">0.01</mml:mn></mml:mrow></mml:math></inline-formula>), see Supporting Information - Appendix 1 - Comparison of performance with existing tools.</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Performance at discriminating antigen-specific from generic T-cell receptors.</title><p>(<bold>A</bold>) For a given epitope model (<italic>e.g</italic>. the Influenza epitope GILGFVFTL), we assign diffRBM units’ scores to held-out sets of antigen-specific CDR3β and generic CDR3β from the bulk repertoire, and we measure the discrimination performance via the Area Under the Curve (AUC), see Materials and methods. (<bold>B</bold>) AUC of the diffRBM units, full RBM, background RBM and other methods trained and tested on CDR3β sequences specific to the Influenza epitope GILGFVFTL. (<bold>C–E</bold>) The performance assessment illustrated in <bold>A–B</bold> is repeated for the models of specific response to the CMV epitope NLVPMVATV (<bold>C</bold>) EBV epitope GLCTLVAML (<bold>D</bold>), and the Sars-Cov-2 epitope YLQPRTFLL (<bold>E</bold>). AUC values shown are the average over 50 partitions into training and test sets and error bars give the corresponding standard deviation (Materials and methods).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85126-fig6-v2.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Comparison of performance of differential models of TCR specificity.</title><p>Comparison of performance, in terms of the AUC of epitope-specific <italic>vs</italic> bulk sequences discrimination, between diffRBM, its version where the differential part is linear (diffRBM lin.) and a PWM approach, see caption of <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85126-fig6-figsupp1-v2.tif"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 2.</label><caption><title>Comparison of performance of differential models of TCR specificity with different background datasets.</title><p>The plots show, for each epitope, the AUC of discrimination between the epitope-specific and naive sequences for the diffRBM units, full RBM and background RBM in the case where the background dataset is drawn from the <xref ref-type="bibr" rid="bib9">Britanova et al., 2016</xref> dataset, compared to the values obtained for a background dataset from <xref ref-type="bibr" rid="bib25">Emerson et al., 2017</xref> (the one used in <xref ref-type="fig" rid="fig6">Figure 6</xref>). AUCs are averages over 50 training-test partitions and error bars give the corresponding standard deviation (Materials and methods).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85126-fig6-figsupp2-v2.tif"/></fig><fig id="fig6s3" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 3.</label><caption><title>Hyperparametric search of the optimal <inline-formula><mml:math id="inf49"><mml:mi>k</mml:mi></mml:math></inline-formula> for the <inline-formula><mml:math id="inf50"><mml:mi>k</mml:mi></mml:math></inline-formula>-NN algorithm.</title><p>The optimal <inline-formula><mml:math id="inf51"><mml:mi>k</mml:mi></mml:math></inline-formula> (<inline-formula><mml:math id="inf52"><mml:mi>k</mml:mi></mml:math></inline-formula>=26, indicated by the black bold dot) is chosen by looking at the maximal AUC of discrimination between epitope-specific and background sequences in the validation set. For each <inline-formula><mml:math id="inf53"><mml:mi>k</mml:mi></mml:math></inline-formula>, the plot shows the average AUC over 50 independent partitions into training and validation sets (Materials and methods). Dataset used: set of sequences specific to the CMV peptide NLVPMVATV (<inline-formula><mml:math id="inf54"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>=4548).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85126-fig6-figsupp3-v2.tif"/></fig><fig id="fig6s4" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 4.</label><caption><title>Comparison of performance of models of TCR specificity without V and J type.</title><p>Given that NetTCR2.0 (<xref ref-type="bibr" rid="bib56">Montemurro et al., 2021</xref>) does not account for V and J type in its input, we report the performance of the diffRBM units, full RBM and background RBM for the 4 epitope-specific models under consideration when only the CDR3β amino acid sequence has been used to train and test the models. AUCs are averages over 50 training-test partitions and error bars give the corresponding standard deviation (Materials and methods).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85126-fig6-figsupp4-v2.tif"/></fig></fig-group></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We have introduced a machine-learning framework, diffRBM, based on the probabilistic graphical model of Restricted Boltzmann Machines to address two important and complementary issues in the context of the immune response, namely the modeling of antigen immunogenicity and epitope-specific TCRs. Our approach relies on a ‘background’ dataset of large size, on which a background RBM model is trained, and a small subset of selected data on which some additional hidden units of the RBM, the diffRBM units, are learnt (<xref ref-type="fig" rid="fig1">Figure 1</xref>, <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>).</p><p>First, we applied diffRBM to model the ability of an antigen to trigger a positive T-cell response. We showed that diffRBM units encode several features relevant to antigen immunogenicity, leading to biologically interpretable predictions. For instance, diffRBM allows us to estimate which peptide positions are likely to be in contact with the TCR (<xref ref-type="fig" rid="fig2">Figure 2</xref>), outperforming immunogenicity predictors tools that treat peptide sites as independent of each other (<xref ref-type="bibr" rid="bib12">Calis et al., 2013</xref>). Our model construction does not require an ad hoc selection of residue positions (like in <xref ref-type="bibr" rid="bib72">Schmidt et al., 2021</xref>) or properties (like in <xref ref-type="bibr" rid="bib14">Chowell et al., 2015</xref>) that are assumed to be predictive of immunogenicity. Rather, the diffRBM units directly learn patterns of enrichment in certain biophysical properties, such as aromaticity, across peptide positions. As such, diffRBM probabilistic scores can be used to predict mutational costs in terms of TCR reactivity (<xref ref-type="fig" rid="fig3">Figure 3</xref>) and to distinguish immunogenic from non-immunogenic peptides, with performances comparable to supervised classifiers (<xref ref-type="fig" rid="fig4">Figure 4</xref>).</p><p>Second, we have trained differential models from datasets of epitope-specific T-cell receptors, and have successfully tested the models’ power to identify the CDR3β residues that bind to the antigen (<xref ref-type="fig" rid="fig5">Figure 5</xref>). DiffRBM provides insight into the structural basis of this process, and helps discriminate epitope-specific from generic receptors (<xref ref-type="fig" rid="fig6">Figure 6</xref>). Our model performs as well as the state-of-the-art methods for distinguishing few antigen-specific receptors out of the bulk repertoire, both in terms of AUC and of average precision (<xref ref-type="fig" rid="fig6">Figure 6</xref>, Section Appendix 1 - ‘Comparison of performance with existing tools’). Performing well on this task is important as the fraction of the TCR repertoire reactive to a given epitope is expected to range between 10<sup>−6</sup> and 10<sup>−4</sup> (<xref ref-type="bibr" rid="bib94">Yates, 2014</xref>).</p><sec id="s3-1"><title>Main differences of diffRBM with existing methods</title><p>In the following we discuss the main differences of diffRBM with state-of-the-art predictors for peptide immunogenicity and the ability of a TCR to bind to a given antigen. Most methods for TCR specificity prediction (<xref ref-type="bibr" rid="bib30">Gielis et al., 2019</xref>; <xref ref-type="bibr" rid="bib56">Montemurro et al., 2021</xref>; <xref ref-type="bibr" rid="bib90">Weber et al., 2021</xref>) are classifiers built from two sets of labeled data: the positive samples containing the receptors with the given specificity and the negative ones containing receptors specific to other antigens. The diffRBM framework is semi-supervised, as negative samples, whose construction is somewhat arbitrary, are not needed.</p><p>In the context of antigen immunogenicity modeling, the diffRBM approach is specific to an HLA type, contrary to existing pan-HLA predictors (<xref ref-type="bibr" rid="bib72">Schmidt et al., 2021</xref>). This choice has the advantage of better capturing the HLA-specific amino-acid usage associated with presentation in the background model, and of being robust against cross-HLA imbalances in the available data (HLA-A*02:01 is much better represented than other alleles). Similarly, our diffRBM models predict TCRs binding to a given peptide, while other methods (<xref ref-type="bibr" rid="bib82">Springer et al., 2020</xref>; <xref ref-type="bibr" rid="bib90">Weber et al., 2021</xref>; <xref ref-type="bibr" rid="bib54">Milighetti et al., 2021</xref>) are predictive across potentially any peptide.</p><sec id="s3-1-1"><title>DiffRBM is parsimonious</title><p>Even for the HLA alleles and epitopes we considered, available datasets cover only a small fraction of HLA-specific peptides that have the potential to be immunogenic and TCR that can recognize given peptides, and pool together data obtained through a heterogeneous set of T-cell response assays, a source of additional noise in the data (Materials and methods). Such limitations pinpoint the need for approaches that are parsimonious in terms of training data. For instance, our search for an optimal neural network classifier of immunogenicity returned an architecture with a rather modest depth (only one hidden layer, <xref ref-type="fig" rid="fig4s5">Figure 4—figure supplement 5</xref>). DiffRBM is tailored for such data-limited situations, and, yet, is able to capture interactions between residues that cannot be modeled by simpler approaches (<xref ref-type="fig" rid="fig2">Figure 2</xref>, <xref ref-type="fig" rid="fig5">Figure 5</xref>, <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>, <xref ref-type="fig" rid="fig5s3">Figure 5—figure supplement 3</xref>, <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>).</p></sec><sec id="s3-1-2"><title>DiffRBM is a generative model</title><p>It can be used to produce new, putative sequences of antigens or TCRs with desired properties, testable in experimental setups, with potential applications in vaccine design and TCR engineering for therapeutic purposes. The probabilistic distribution encoded by the model allows for estimating the diversity of the data space (through its entropy, Appendix 4), and the loss of diversity due to selection. In the case of epitope-specific repertoires (<xref ref-type="fig" rid="app4fig1">Appendix 4—figure 1</xref>), this reduction appears rather modest, consistently with previous analyses on epitope-specific CDR3β data (<xref ref-type="bibr" rid="bib74">Sethna et al., 2020</xref>), with the exception of the YLQPRTFLL-specific repertoire.</p></sec><sec id="s3-1-3"><title>DiffRBM is purely sequence-based</title><p>The fast growth of peptidomic and immune repertoire sequence data, many of them produced in clinical settings for personalized medicine purposes, calls for the development of sequence-based modeling approaches. These are computationally faster and more broadly applicable than structure-informed methods. Structural features, such as the conformational arrangement of the peptide within the HLA binding groove and of TCR chains, have been shown to be important to predict a positive T-cell response, both at the level of peptide binding to the MHC (<xref ref-type="bibr" rid="bib67">Riley et al., 2019</xref>) and TCR binding to the pMHC complex (<xref ref-type="bibr" rid="bib43">Lin et al., 2021</xref>). However, these methods are often limited to TCR-peptide pairs of known crystal structures, narrowing down the scope of applications. To circumvent this limitation, a peptide-threading procedure into pre-defined template structures was proposed (<xref ref-type="bibr" rid="bib67">Riley et al., 2019</xref>). This strategy is made possible by the homogeneity of the backbone conformation across nonamer peptides presented by the same HLA-I, but might become problematic with peptides of different lengths or for HLA types admitting different binding modes with the peptide (<xref ref-type="bibr" rid="bib28">Gfeller et al., 2018</xref>).</p><p>There are many transfer-learning approaches in machine learning aimed at obtaining domain-invariant representations that enable portability across domains. From this point of view, several works have considered the RBM architecture, see for instance (<xref ref-type="bibr" rid="bib95">Zhang, 2011</xref>; <xref ref-type="bibr" rid="bib91">Wei and Pal, 2011</xref>). Our objective here is somewhat different: learning the statistical differences between background and selected data allows us not only to reach very good performance when data is scarce, but also to capture enriched molecular motifs in the selected data. The model parameters learnt in this way allow us to extract biologically interpretable predictions, such as contact sites and mutation costs in terms TCR reactivity.</p></sec></sec><sec id="s3-2"><title>Biomedical applicability of diffRBM</title><p>Our computational predictions of antigen immunogenicity can be used to propose candidate antigens for experimental validation and vaccine design. Similarly, they can be used to identify potentially immunogenic neoantigens to target in immune-based cancer therapies, or to detect phenomena of immunoediting in cancer (<xref ref-type="bibr" rid="bib47">Łuksza et al., 2022</xref>). To adapt diffRBM to neoantigen modeling, it may need to be re-trained on neoantigen-specific training sets (rather than on IEDB as done here), given the substantial variation in method performance and in the immunogenicity-related predicted features between pathogenic and cancer data (<xref ref-type="bibr" rid="bib10">Buckley et al., 2022</xref>). As a preliminary assessment of diffRBM performance in a cancer setting, we assigned scores to the HLA-A*02:01-presented neoantigens from the TESLA dataset (<xref ref-type="bibr" rid="bib92">Wells et al., 2020</xref>; 11 immunogenic and 227 non-immunogenic peptides). We obtained an AUC of immunogenic <italic>vs</italic> non-immunogenic discrimination, differing significantly from the random expectation (0.6 for the diffRBM units’ scores and 0.69 for the difference of diffRBM units’ scores).</p></sec><sec id="s3-3"><title>Future extensions of diffRBM</title><p>This diffRBM model of specific TCR response can be formulated in an equivalent way for the CDR3 region on the other chain of TCRs (<inline-formula><mml:math id="inf55"><mml:mi mathsize="80%">α</mml:mi></mml:math></inline-formula> chain). In this case, one uses CDR3α sequences from healthy TCR repertoires and samples of antigen-specific CDR3α as respectively the background and the selected dataset. DiffRBM models for the <inline-formula><mml:math id="inf56"><mml:mi mathsize="80%">α</mml:mi></mml:math></inline-formula> chain reach a discrimination performance comparable to the one for the <inline-formula><mml:math id="inf57"><mml:mi mathsize="80%">β</mml:mi></mml:math></inline-formula> chain (<xref ref-type="bibr" rid="bib53">Meysman et al., 2022</xref>). Similarly, with single-cell TCR sequencing data becoming increasingly available, our approach could also be extended to model pairs of TCR <inline-formula><mml:math id="inf58"><mml:mi mathsize="80%">α</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf59"><mml:mi mathsize="80%">β</mml:mi></mml:math></inline-formula> chains, which have been suggested to play a synergistic role in determining antigen specificity (<xref ref-type="bibr" rid="bib13">Carter et al., 2019</xref>; <xref ref-type="bibr" rid="bib56">Montemurro et al., 2021</xref>; <xref ref-type="bibr" rid="bib54">Milighetti et al., 2021</xref>). An important direction for future work could be to improve the modeling strategy presented by leveraging structural information on the TCR-pMHC complex and its estimated binding energy along with sequences, as investigated by <xref ref-type="bibr" rid="bib67">Riley et al., 2019</xref>; <xref ref-type="bibr" rid="bib43">Lin et al., 2021</xref>; <xref ref-type="bibr" rid="bib54">Milighetti et al., 2021</xref>; <xref ref-type="bibr" rid="bib40">Karnaukhov et al., 2022</xref>, especially given the expected increase in the number of available crystallographic structures.</p><p>Last of all, diffRBM provides a potentially general and flexible approach, which can be used in analyzing directed evolution protocols (<xref ref-type="bibr" rid="bib38">Jäckel et al., 2008</xref>; <xref ref-type="bibr" rid="bib61">Packer and Liu, 2015</xref>; <xref ref-type="bibr" rid="bib2">Arnold, 2018</xref>) and SELEX experiments (<xref ref-type="bibr" rid="bib24">Ellington and Szostak, 1990</xref>; <xref ref-type="bibr" rid="bib86">Tuerk and Gold, 1990</xref>; <xref ref-type="bibr" rid="bib81">Sola et al., 2020</xref>), where each round performs a selection of a subset of molecules from the previous round (the ‘background’). These potential applications require novel efforts of data pre-processing and model training. For instance, the present setting, in which the two learning steps are done sequentially, needs to be modified when the baseline and the specific features are entangled.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>DiffRBM architecture</title><p>The core idea of what we refer to as a ‘differential’ probabilistic model is to learn a distribution for sequence data <inline-formula><mml:math id="inf60"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> with the parametric form:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>Z</mml:mi></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mspace width="2em"/><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf61"><mml:mi mathsize="80%">Z</mml:mi></mml:math></inline-formula> is simply a normalization factor, <inline-formula><mml:math id="inf62"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>. <inline-formula><mml:math id="inf63"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> specifies the background distribution <inline-formula><mml:math id="inf64"><mml:msup><mml:mi mathsize="80%">P</mml:mi><mml:mi mathsize="80%" mathvariant="normal">b</mml:mi></mml:msup></mml:math></inline-formula>, learnt from the background dataset <inline-formula><mml:math id="inf65"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, through <inline-formula><mml:math id="inf66"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msup><mml:mi>Z</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf67"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>Z</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>. <inline-formula><mml:math id="inf68"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> contains the parameters learnt on top of the background distribution from the selected data <inline-formula><mml:math id="inf69"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>. Here, we assume that <inline-formula><mml:math id="inf70"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf71"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> are parametrized in terms of a Restricted Boltzmann Machine (RBM; <xref ref-type="bibr" rid="bib33">Hinton, 2002</xref>; <xref ref-type="bibr" rid="bib34">Hinton and Salakhutdinov, 2006</xref>). Hence <inline-formula><mml:math id="inf72"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> can be written as:<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munderover><mml:mi>d</mml:mi><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mspace width="1em"/><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>∼</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi mathvariant="script">U</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>that is, in an RBM, the probability of the data <inline-formula><mml:math id="inf73"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is expressed as the marginal of a joint probability over the data <inline-formula><mml:math id="inf74"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (the ‘observed’ sequences of length <inline-formula><mml:math id="inf75"><mml:mi mathsize="80%">N</mml:mi></mml:math></inline-formula>) and a set of <inline-formula><mml:math id="inf76"><mml:msup><mml:mi mathsize="80%">M</mml:mi><mml:mi mathsize="80%" mathvariant="normal">b</mml:mi></mml:msup></mml:math></inline-formula> ‘hidden’ units <inline-formula><mml:math id="inf77"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">h</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, playing the role of coordinates of low-dimensional representations of the data. Thus, for an RBM as background:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munderover><mml:msubsup><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where we have set <inline-formula><mml:math id="inf78"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf79"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>∫</mml:mo><mml:mi>d</mml:mi><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="thinmathspace"/><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="script">U</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. <xref ref-type="disp-formula" rid="equ2 equ3">Equations 2 and 3</xref> contain the following parameters: a set of single-site fields <inline-formula><mml:math id="inf80"><mml:mrow><mml:msubsup><mml:mi mathsize="80%">g</mml:mi><mml:mi mathsize="80%">i</mml:mi><mml:mi mathsize="80%" mathvariant="normal">b</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, capturing the amino acid usage at each sequence position, a potential <inline-formula><mml:math id="inf81"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">U</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> for each hidden unit <inline-formula><mml:math id="inf82"><mml:msubsup><mml:mi mathsize="80%">h</mml:mi><mml:mi mathsize="80%">μ</mml:mi><mml:mi mathsize="80%" mathvariant="normal">b</mml:mi></mml:msubsup></mml:math></inline-formula> and a set of parameters <inline-formula><mml:math id="inf83"><mml:msubsup><mml:mi mathsize="80%">w</mml:mi><mml:mrow><mml:mi mathsize="80%">i</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="80%">μ</mml:mi></mml:mrow><mml:mi mathsize="80%" mathvariant="normal">b</mml:mi></mml:msubsup></mml:math></inline-formula>, called weights, connecting the sites of observed sequences to each hidden unit. Their values are learnt from the background dataset <inline-formula><mml:math id="inf84"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> by maximizing the log-likelihood:<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>After the background distribution has been learnt, we learn the differential units of the diffRBM architecture, specified by the probability distribution:<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>∼</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi mathvariant="script">U</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi mathvariant="script">U</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:munder><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msup><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>see also <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>. Hence:<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munderover><mml:msubsup><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf85"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf86"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>∫</mml:mo><mml:mi>d</mml:mi><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="thinmathspace"/><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="script">U</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. The parameters featuring in <inline-formula><mml:math id="inf87"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, defining the diffRBM units, are learnt from the dataset <inline-formula><mml:math id="inf88"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> by maximizing:<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mspace width="2em"/><mml:mtext>with</mml:mtext><mml:mspace width="1em"/><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munderover><mml:mi>d</mml:mi><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munderover><mml:mi>d</mml:mi><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msubsup><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>In summary, the diffRBM architecture is equivalent to an RBM with <inline-formula><mml:math id="inf89"><mml:mrow><mml:msup><mml:mi mathsize="80%">M</mml:mi><mml:mi mathsize="80%" mathvariant="normal">b</mml:mi></mml:msup><mml:mo mathsize="80%" stretchy="false">+</mml:mo><mml:msup><mml:mi mathsize="80%">M</mml:mi><mml:mi mathsize="80%" mathvariant="normal">d</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> hidden units with overall observed fields <inline-formula><mml:math id="inf90"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msubsup><mml:mo>:</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>, the weights <inline-formula><mml:math id="inf91"><mml:msubsup><mml:mi mathsize="80%">w</mml:mi><mml:mrow><mml:mi mathsize="80%">i</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="80%">μ</mml:mi></mml:mrow><mml:mi mathsize="80%" mathvariant="normal">b</mml:mi></mml:msubsup></mml:math></inline-formula> and potentials <inline-formula><mml:math id="inf92"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">U</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> for the first <inline-formula><mml:math id="inf93"><mml:msup><mml:mi mathsize="80%">M</mml:mi><mml:mi mathsize="80%" mathvariant="normal">b</mml:mi></mml:msup></mml:math></inline-formula> units are learnt from the background data, then they are kept fixed, and <inline-formula><mml:math id="inf94"><mml:msubsup><mml:mi mathsize="80%">g</mml:mi><mml:mi mathsize="80%">i</mml:mi><mml:mi mathsize="80%" mathvariant="normal">d</mml:mi></mml:msubsup></mml:math></inline-formula>, the weights <inline-formula><mml:math id="inf95"><mml:msubsup><mml:mi mathsize="80%">w</mml:mi><mml:mrow><mml:mi mathsize="80%">i</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathsize="80%">μ</mml:mi><mml:mo mathsize="80%" stretchy="false">′</mml:mo></mml:msup></mml:mrow><mml:mi mathsize="80%" mathvariant="normal">d</mml:mi></mml:msubsup></mml:math></inline-formula> and potentials <inline-formula><mml:math id="inf96"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">U</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> for the additional <inline-formula><mml:math id="inf97"><mml:msup><mml:mi mathsize="80%">M</mml:mi><mml:mi mathsize="80%" mathvariant="normal">d</mml:mi></mml:msup></mml:math></inline-formula> units are learnt from the selected data (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>, Appendix 2).</p><p>The predictions of peptide immunogenicity or epitope specificity rely on the assignment to sequences <inline-formula><mml:math id="inf98"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> of scores. Using <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>, the score of the full RBM is given by the log-likelihood:<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where the <italic>constant</italic> stands for a sequence-independent term coming from the partition function. Analogously, the background RBM score and the diffRBM units’ score are respectively:<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math></disp-formula><disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math></disp-formula></p><p>Software-wise diffRBM is coded via additional functions to execute a differential learning on top of the RBM Python implementation from <xref ref-type="bibr" rid="bib88">van der Plas et al., 2023</xref> and is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/cossio/diffRBM">https://github.com/cossio/diffRBM</ext-link> (copy archived at <xref ref-type="bibr" rid="bib26">Fernandez-de-Cossio-Diaz, 2023</xref>). The codes used for its application to modeling antigen immunogenicity and TCR specificity are downloadable from <ext-link ext-link-type="uri" xlink:href="https://github.com/bravib/diffRBM_immunogenicity_TCRspecificity">https://github.com/bravib/diffRBM_immunogenicity_TCRspecificity</ext-link> (copy archived at <xref ref-type="bibr" rid="bib8">Bravi, 2023</xref>).</p></sec><sec id="s4-2"><title>Data collection</title><sec id="s4-2-1"><title>Sequence datasets for the immunogenicity model</title><p>Differential models of immunogenicity were trained on sets of immunogenic peptides collected from the Immune Epitope Database (IEDB) (<xref ref-type="bibr" rid="bib89">Vita et al., 2019</xref>), where the database entries were filtered through the following steps. Firstly, the curated set of HLA ligands tested in T cell assays was downloaded from IEDB (file <italic>tcell_full_v3.csv</italic> from <ext-link ext-link-type="uri" xlink:href="http://www.iedb.org/database_export_v3.php">http://www.iedb.org/database_export_v3.php</ext-link>, accessed in December 2021). We selected from this file linear, human peptides with a given HLA restriction (<italic>e.g</italic>. HLA-A*02:01), limiting the search to peptides of length 8–11 amino acids like in <xref ref-type="bibr" rid="bib7">Bravi et al., 2021b</xref> and presented by HLA of class I (<italic>i.e</italic>. targeted epitopes of killer T cells). Following <xref ref-type="bibr" rid="bib12">Calis et al., 2013</xref>, we required the peptide (and not the full protein or the pathogen) to be the first immunogen (by setting the field <italic>Antigen Epitope Relation</italic> = ‘Epitope’) and we excluded T-cell response experiments with a restimulation step (by discarding ‘Restimulation in vitro’ from the field In Vitro Process Type). Immunogenic peptides were finally identified as the peptides for which positive responses by T cells were reported while negative ones were absent (field <italic>Qualitative Measure</italic> marked as ‘Positive’ or ‘Positive-High’ and never as ‘Negative’). Equivalently, non-immunogenic peptides were identified as the peptides for which negative responses by T cells were reported while positive ones were absent (field <italic>Qualitative Measure</italic> set to ‘Negative’ and never to ‘Positive’, ‘Positive-High’, ‘Positive-Intermediate’ or ‘Positive-Low’). To avoid oversampling, we removed duplicate entries. To check whether we needed an additional redundancy filtering, similarly to <xref ref-type="bibr" rid="bib12">Calis et al., 2013</xref>, we applied a reweighting scheme <xref ref-type="bibr" rid="bib57">Morcos et al., 2011</xref> that reweighs each sequence by the inverse of the number of other sequences that have more than 80% of similarity, and we found that the models’ performance (<xref ref-type="fig" rid="fig4s6">Figure 4—figure supplement 6</xref>) is largely unchanged compared to the one without reweighting (<xref ref-type="fig" rid="fig4">Figure 4</xref>), indicating that there is no substantial need for additional sampling bias mitigation strategies. We choose only the HLA-I alleles for which the filtering steps just described allowed us to recover at least 200 immunogenic peptides and for which at least one TCR-pMHC structure was available in the Protein Data Bank (resulting in the choice of HLA-A*02:01, HLA-B*07:02 and HLA-B*35:01). The size of the final datasets of immunogenic peptides is: <inline-formula><mml:math id="inf99"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1682</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> for HLA-A*02:01, <inline-formula><mml:math id="inf100"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>258</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> for HLA-B*07:02, <inline-formula><mml:math id="inf101"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>215</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> for HLA-B*35:01. Sets of non-immunogenic peptides consist of 2301 sequences (HLA-A*02:01), 807 (HLA-B*07:02), 166 (HLA-B*35:01).</p><p>To train the antigen presentation model (background model), we relied on the sets of 8–11 amino acid long peptides extracted from IEDB by the RBM-MHC algorithm as described in <xref ref-type="bibr" rid="bib7">Bravi et al., 2021b</xref>, choosing the option of peptides from HLA binding affinity assays rather than mass spectrometry, to avoid biases in the amino acid statistics that might be due to this technique. The resulting training dataset sizes are <inline-formula><mml:math id="inf102"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>4265</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> for HLA-A*02:01, <inline-formula><mml:math id="inf103"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1006</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> for HLA-B*07:02, <inline-formula><mml:math id="inf104"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1211</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> for HLA-B*35:01. For consistency with the type of datasets used in RBM-MHC, scores of presentation from the algorithm NetMHCpan4.1 (<xref ref-type="bibr" rid="bib66">Reynisson et al., 2020</xref>) are obtained with the option <italic>-BA</italic> (predictions from the training on binding assay data).</p></sec><sec id="s4-2-2"><title>Sequence datasets for the T-cell specificity model</title><p>Each differential model of specific T-cell binding to a given peptide was trained on TCRs experimentally validated to be specific to the peptide collected from the VDJdb database (<xref ref-type="bibr" rid="bib78">Shugay et al., 2018</xref>; <xref ref-type="bibr" rid="bib3">Bagaev et al., 2020</xref>) (file <italic>vdjdb.txt</italic> downloaded from <ext-link ext-link-type="uri" xlink:href="https://vdjdb.cdr3.net">https://vdjdb.cdr3.net</ext-link> in July 2021). We selected all the human TCRβ chains fully annotated with their V and J segment and labeled to be specific to the given peptide (for example, for the Influenza M1<sub>58</sub>-specific model we set <italic>antigen.epitope</italic> = ‘GILGFVFTL’). We constructed the training sets from the CDR3β sequence and the V/J annotation of these entries, removing replicates. Their size is: <inline-formula><mml:math id="inf105"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>3464</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (for the Influenza M1<sub>58</sub> model), <inline-formula><mml:math id="inf106"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>4548</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (for the CMV pp65<sub>495</sub> model), <inline-formula><mml:math id="inf107"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>993</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (for the EBV BMLF1<sub>280</sub> model), and <inline-formula><mml:math id="inf108"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>315</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (for the Sars-Cov-2 S<sup>269</sup> model).</p><p>For the background model, we considered the dataset assembled by <xref ref-type="bibr" rid="bib37">Isacchini et al., 2021</xref> pooling together unique TCRβ clones from the 743 donors of the cohort in <xref ref-type="bibr" rid="bib25">Emerson et al., 2017</xref>, with a total of ∼9 × 10<sup>7</sup> sequences. For training background RBM, we used a smaller, randomly subsampled dataset of 10<sup>6</sup> sequences that could be more easily handled. We also considered the dataset collected by <xref ref-type="bibr" rid="bib9">Britanova et al., 2016</xref> to train a second, independent background model. This dataset contains about 3×10<sup>7</sup> CDR3β sequences. We excluded from this dataset any sequence associated to non-functional V or J genes, and randomly subsampled the resulting dataset to obtain 10<sup>6</sup> sequences for the training of the background RBM and 10<sup>4</sup> sequences to test it (with no identical sequences between training and test set).</p></sec><sec id="s4-2-3"><title>Data pre-processing and formatting</title><p>RBM and PWM-based approaches require sequence inputs of fixed length, hence we performed an alignment. Background datasets are aligned to obtain same-length sequences, following the alignment procedures described in <xref ref-type="bibr" rid="bib7">Bravi et al., 2021b</xref> for peptides and <xref ref-type="bibr" rid="bib6">Bravi et al., 2021a</xref> for CDR3β amino acid sequences. The length of the alignment is set to 9 (9 being the typical length of HLA-I ligands) and to 20 in the case of CDR3β. These alignments serve as seeds to learn Hidden Markov Model profiles of length 9 and 20, in such a way that the selected datasets can be aligned against the profile built from the corresponding background dataset (see <xref ref-type="bibr" rid="bib7">Bravi et al., 2021b</xref> for more details). In the models for TCR sequences, the input combines the aligned CDR3β amino acid sequence to the V segment type and the J segment type, all converted into numerical values varying within an interval of appropriate length (length = 21 for the CDR3β positions, standing for the 20 amino acids + 1 gap; length = 48 for the V type, length = 13 for the J type).</p></sec><sec id="s4-2-4"><title>Crystallographic structures from PDB</title><p>We downloaded, from the Protein Data Bank <ext-link ext-link-type="uri" xlink:href="https://www.rcsb.org/">https://www.rcsb.org/</ext-link> (<xref ref-type="bibr" rid="bib4">Berman et al., 2000</xref>) as of February 2022, the TCR-pMHC crystallographic structures with 9 amino acid-long peptides where the HLA complex is HLA-B*35:01, HLA-A*02:01, or HLA-B*07:02. We excluded the structures with modified/non-peptidic epitopes and with incomplete TCR chains. As a result, we obtained 5 structures for HLA-B*35:01, 56 for HLA-A*02:01, and 1 for HLA-B*07:02. Some of the 56 HLA-A*02:01 structures describe TCRs in contact with the peptides we considered for the differential models of specific TCR response (3 for the Sars-Cov-2 epitope YLQPRTFLL, 3 for the CMV epitope NLVPMVATV, 1 for the EBV epitope GLCTLVAML, and 8 for the Influenza epitope GILGFVFTL).</p><p>For each structure, we estimated the positions along the peptide in contact with the TCR, using a standard cutoff at 4 Å (<xref ref-type="bibr" rid="bib68">Rossjohn et al., 2015</xref>; <xref ref-type="bibr" rid="bib72">Schmidt et al., 2021</xref>; <xref ref-type="bibr" rid="bib45">Lu et al., 2021</xref>) between heavy atoms. The availability of structures is highly skewed toward the limited set of epitopes that have been the focus of several studies, hence our final list of peptides exhibits redundancy, with same or similar peptides in complex with different TCRs. If more than 1 structure contain the same peptide and have same contact positions, we retain only one of such structures (resulting in 4 structures for HLA-B*35:01, 41 for HLA-A*02:01, and 1 for HLA-B*07:02). If the same ligand is annotated with different contact positions, we keep these as different entries but we re-weight their contribution to the average PPV and the frequency of contact positions (section ‘Contact prediction’). We followed the same steps to estimate CDR3β contacts with the peptide and peptide contacts with the HLA complex and to filter out redundant entries, opting for a slightly more restrictive cutoff distance (3.5 Å) for peptide-HLA contacts. Since distance cutoffs can vary with the van der Waals’ radii for single atoms (<xref ref-type="bibr" rid="bib76">Sheriff et al., 1987</xref>), we also monitored the robustness of our results to changes in the choice of the cutoff (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3D</xref>, <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4D</xref>, <xref ref-type="fig" rid="fig5s3">Figure 5—figure supplement 3D</xref>). The list of all structures and corresponding estimated contacts is provided in <xref ref-type="supplementary-material" rid="fig2sdata1">Figure 2—source data 1</xref>.</p></sec></sec><sec id="s4-3"><title>DiffRBM training and model selection</title><p>The first step of the diffRBM training consists of training the background model on the background dataset. For the model of immunogenicity, we trained allele-specific presentation models with an RBM architecture by running the RBM-MHC algorithm (<xref ref-type="bibr" rid="bib7">Bravi et al., 2021b</xref>) on IEDB-derived peptide data (see section ‘Sequence datasets for the immunogenicity model’) with default parameters (10 hidden units, <inline-formula><mml:math id="inf109"><mml:mrow><mml:msubsup><mml:mi mathsize="80%">λ</mml:mi><mml:mn mathsize="80%">2</mml:mn><mml:mn mathsize="80%">1</mml:mn></mml:msubsup><mml:mo mathsize="80%" stretchy="false">=</mml:mo><mml:mn mathsize="80%">0.001</mml:mn></mml:mrow></mml:math></inline-formula>). The RBM-MHC algorithm internally aligns peptide sequences of its training dataset to the reference length of 9 amino acids; we used the same alignment routine to align the immunogenic peptides against the seed given by the RBM-MHC training data. The second step is training the diffRBM units on the selected datasets <inline-formula><mml:math id="inf110"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> (see section ‘Sequence datasets for the immunogenicity model’). We divided these datasets into a training set with 80% of the data (used for training and for model selection) and a test set with the remaining 20% (used for model validation, see section ‘Classification performance’), repeating this split 50 times.</p><p>Having fixed the background model, we used the largest available dataset of immunogenic sequences (the one for HLA-A*02:01) to perform model selection by cross-validation, as follows. We further divided randomly each of the 50 training sets into a set actually used for training and a validation set (with respectively 80% and 20% of the training set). We used this training/validation partitions to select optimal hyperparameters for the differential part (the number of hidden units and regularization penalty <inline-formula><mml:math id="inf111"><mml:msubsup><mml:mi mathsize="80%">λ</mml:mi><mml:mn mathsize="80%">2</mml:mn><mml:mn mathsize="80%">1</mml:mn></mml:msubsup></mml:math></inline-formula>), by training diffRBM models on the training set at varying hyperparameters and monitoring the average diffRBM units’ score (<xref ref-type="disp-formula" rid="equ10">Equation 10</xref>) on the validation sets (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2A–B</xref>). We also performed additional checks on the diffRBM units’ AUC of immunogenic <italic>vs</italic> non-immunogenic discrimination with different hyperparameters (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2C</xref>) and in a control case (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2D</xref>).</p><p>For the model of T-cell specificity, the background is given by an RBM trained on a random subsample of 10<sup>6</sup> CDR3β sequences from <xref ref-type="bibr" rid="bib25">Emerson et al., 2017</xref> (section ‘Sequence datasets for the T-cell specificity model’), choosing the optimal RBM architecture (100 hidden units, <inline-formula><mml:math id="inf112"><mml:mrow><mml:msubsup><mml:mi mathsize="80%">λ</mml:mi><mml:mn mathsize="80%">2</mml:mn><mml:mn mathsize="80%">1</mml:mn></mml:msubsup><mml:mo mathsize="80%" stretchy="false">=</mml:mo><mml:mn mathsize="80%">0.001</mml:mn></mml:mrow></mml:math></inline-formula>) by cross-validation (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2A–B</xref>). For cross-validation, we used as validation set another subsample of about 10<sup>5</sup> CDR3β sequences from <xref ref-type="bibr" rid="bib25">Emerson et al., 2017</xref>, chosen so that no overlap with the training set is present. The grid search for optimal hyperparameters for the differential part was carried out at fixed background model, using the largest dataset of peptide-specific receptors (NLVPMVATV) and partitioning it 50 times at random into training and validation sets (with respectively 80% and 20% of the data, <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2C–E</xref>).</p></sec><sec id="s4-4"><title>Classification performance</title><p>Having found the optimal diffRBM architecture (section ‘DiffRBM training and model selection’) for the immunogenicity model, for each of the 3 HLA types considered we trained 50 HLA-specific models on the original training sets (consisting of the 80% of the full datasets available) and we assessed their average performance over the corresponding 50 choices of the test set. In particular, we tested the ability of the HLA-specific immunogenicity models to identify new immunogenic peptides by the Receiver Operating Characteristic curve (ROC). For each of the 50 repetitions, we assigned scores of immunogenicity predicted by a given HLA-specific model (given by the diffRBM units’ score <inline-formula><mml:math id="inf113"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> of <xref ref-type="disp-formula" rid="equ10">Equation 10</xref>) to the sequences of the test set of positives (immunogenic peptides with the HLA type under consideration) and of negatives (a test set of non-immunogenic peptides presented by the same HLA). Varying the threshold score value to discriminate positives from negatives, we obtained the ROC curve describing the fraction of immunogenic peptides predicted by the models’ scores, against the fraction of predicted non-immunogenic ones. We took the Area Under the Curve (AUC) as a metric of the models’ ability to discriminate immunogenic from non-immunogenic peptides. We performed the same validation for all the RBM-based approaches (section ‘DiffRBM architecture’, <xref ref-type="fig" rid="fig4">Figure 4</xref>), using their corresponding output scores (<xref ref-type="disp-formula" rid="equ8">Equation 8</xref> for the full RBM, <xref ref-type="disp-formula" rid="equ9">Equation 9</xref> for background RBM). The performance of the full RBM obtained through the score (<xref ref-type="disp-formula" rid="equ8">Equation 8</xref>) is by far and large equivalent to the one of an RBM with the same hyperparameters entirely trained, in one step only, from the selected dataset (<xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4</xref>), showing that there is a gain in performance with the differential learning strategy only when we focus on the differential units and their parameters. For the diffRBM linear approach (section Appendix 3 - ‘Alternative approaches tested’), the scores (<xref ref-type="disp-formula" rid="equ8">Equation 8</xref>) and (<xref ref-type="disp-formula" rid="equ10">Equation 10</xref>) contain, for the differential part, only fields <inline-formula><mml:math id="inf114"><mml:mrow><mml:msubsup><mml:mi mathsize="80%">g</mml:mi><mml:mi mathsize="80%">i</mml:mi><mml:mi mathsize="80%" mathvariant="normal">d</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>; in the PWM-based approach, we used (<xref ref-type="disp-formula" rid="equ18">Equation 18</xref>) (see section Appendix 3 - ‘Alternative approaches tested’); results from these approaches are reported in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>.</p><p>We also performed a leave-one-organism-out cross-validation, whereby we divided peptides by the organism of origin, we held out as test set only the immunogenic and non-immunogenic peptides from the same organism and trained the models on the peptides from all the other organisms (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>). We considered in the test sets only the organisms for which at least 15 immunogenic and non-immunogenic peptides could be retrieved from IEDB. HLA-A*02:01 is the only allele for which we found sufficient data for this validation.</p><p>Also negatives were randomly divided into 50 training and test sets. Training sets of negatives were used to train diffRBM units for non-immunogenic peptides (assigning scores that we will denote as <inline-formula><mml:math id="inf115"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> to distinguish it from the scores of immunogenicity <inline-formula><mml:math id="inf116"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>) and the classifiers of immunogenicity (section ‘Classifier of immunogenic peptides’). The classifiers output a probability of being immunogenic which is used as the score for calculating the AUC on the 50 test sets of positives and negatives. To evaluate the AUC for the approach denoted as ‘diffRBM units (difference)’ (<xref ref-type="fig" rid="fig4">Figure 4</xref>, <xref ref-type="fig" rid="fig4s6">Figure 4—figure supplement 6</xref>), we considered the score given, for each test sequence <inline-formula><mml:math id="inf117"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, by the difference <inline-formula><mml:math id="inf118"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. Given that the background model is the same, it can be seen from <xref ref-type="disp-formula" rid="equ8 equ10">Equations 8 and 10</xref> that the score <inline-formula><mml:math id="inf119"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> gives the same result as the difference of the full RBM scores <inline-formula><mml:math id="inf120"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4</xref>).</p><p>We followed the same procedure to train and evaluate the models of T-cell response specificity (<xref ref-type="fig" rid="fig6">Figure 6</xref>, <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>, <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>, <xref ref-type="fig" rid="fig6s4">Figure 6—figure supplement 4</xref>). To test the T-cell specificity models’ ability to identify new peptide-specific receptors, we performed an AUC-based assessment of predictive performance using, as positives, the receptors with the same peptide-specificity from the held-out test sets and, as negatives, a subset of generic receptors from the bulk repertoire, randomly drawn at each repetition with the same size as the positive test set and with no overlap with the 10<sup>6</sup> sequences of the training set of the background model. To further check the robustness of our results with respect to the choice of the background dataset, we repeated the training and testing constructing the background model from a different set of bulk-repertoire TCRβ sequences from healthy donors (the dataset from <xref ref-type="bibr" rid="bib9">Britanova et al., 2016</xref>). All the performance metrics are almost unaffected by this change of the background dataset (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>). The average AUC attained by the diffRBM units across the 4 peptide-specific models is <inline-formula><mml:math id="inf121"><mml:mrow><mml:mn mathsize="80%">0.83</mml:mn><mml:mo mathsize="80%" stretchy="false">±</mml:mo><mml:mn mathsize="80%">0.01</mml:mn></mml:mrow></mml:math></inline-formula> with the background dataset from <xref ref-type="bibr" rid="bib25">Emerson et al., 2017</xref> and <inline-formula><mml:math id="inf122"><mml:mrow><mml:mn mathsize="80%">0.84</mml:mn><mml:mo mathsize="80%" stretchy="false">±</mml:mo><mml:mn mathsize="80%">0.01</mml:mn></mml:mrow></mml:math></inline-formula> with the background dataset from <xref ref-type="bibr" rid="bib9">Britanova et al., 2016</xref> (uncertainties are estimated over several training-test partitions). All the approaches (diffRBM and alternatives versions, SONIA, <inline-formula><mml:math id="inf123"><mml:mi mathsize="80%">k</mml:mi></mml:math></inline-formula>-NN, NetTCR-2.0, TCRex) are trained and tested on 50 independent random partitions of both positives and negatives into training and test sets, and the performance shown in <xref ref-type="fig" rid="fig6">Figure 6</xref>, <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>, <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>, <xref ref-type="fig" rid="fig6s4">Figure 6—figure supplement 4</xref> is the average AUC over these 50 partitions. As negative set to train the supervised approaches (<inline-formula><mml:math id="inf124"><mml:mi mathsize="80%">k</mml:mi></mml:math></inline-formula>-NN, NetTCR-2.0, TCRex) we took, for each training repetition, a subset of the bulk-repertoire dataset from <xref ref-type="bibr" rid="bib25">Emerson et al., 2017</xref> with the same size as the positive training set.</p></sec><sec id="s4-5"><title>Contact prediction</title><sec id="s4-5-1"><title>Definition of single-site factors</title><p>Given the TCR-pMHC structures retrieved from PDB and the estimated peptide-TCR and peptide-HLA contact sites (section ‘Crystallographic structures from PDB’), we assessed whether differential models can predict contact positions. We defined single-site factors <inline-formula><mml:math id="inf125"><mml:msub><mml:mi mathsize="80%">T</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub></mml:math></inline-formula> from the models’ parameters to be evaluated on each sequence <inline-formula><mml:math id="inf126"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> as:<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munderover><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msup><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo fence="false" stretchy="false">⟩</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where the average over the differential hidden units <inline-formula><mml:math id="inf127"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo fence="false" stretchy="false">⟩</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is estimated from a distribution conditional on the sequence <inline-formula><mml:math id="inf128"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> that is <inline-formula><mml:math id="inf129"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>∼</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="script">U</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. As clear from the definition (<xref ref-type="disp-formula" rid="equ11">Equation 11</xref>), single-site factors measure generally whether the amino acid <inline-formula><mml:math id="inf130"><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub></mml:math></inline-formula> at position <inline-formula><mml:math id="inf131"><mml:mi mathsize="80%">i</mml:mi></mml:math></inline-formula>, in the sequence context provided by <inline-formula><mml:math id="inf132"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, has high probability to occur among selected sequences, for instance among HLA-specific immunogenic peptides, hence we have used them to quantify residue-specific contributions to immunogenicity (<xref ref-type="fig" rid="fig3">Figure 3</xref>).</p><p>For the prediction of contacts, the sequence <inline-formula><mml:math id="inf133"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in (<xref ref-type="disp-formula" rid="equ11">Equation 11</xref>) is represented by either peptides or by receptors’ CDR3β sequences when we predict, respectively, the peptide sites in contact with the TCR through the models of immunogenicity (<xref ref-type="fig" rid="fig2">Figure 2C–D</xref>) and the CDR3β sites in contact with peptides through the models of epitope specificity (<xref ref-type="fig" rid="fig5">Figure 5B–C</xref>). For each peptide, we use the immunogenicity model corresponding to its HLA type and for each CDR3β we use the model corresponding to its epitope specificity. Since we are interested in a prediction at the level of residues, the models of epitope specificity used here are defined only on the CDR3β amino acid sequence (disregarding the V and J identity). Given the set of <inline-formula><mml:math id="inf134"><mml:mrow><mml:msub><mml:mi mathsize="80%">T</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for each sequence position <inline-formula><mml:math id="inf135"><mml:mi mathsize="80%">i</mml:mi></mml:math></inline-formula>, we rank them according to their magnitude and we take the top ranking positions as the model’s prediction on contacts for the sequence <inline-formula><mml:math id="inf136"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. In the case of CDR3β sequences, we consider only non-gap positions for such ranking.</p></sec><sec id="s4-5-2"><title>Prediction assessment via the Positive Predictive Value</title><p>Given the models’ predictions of putative contact sites, we assessed their quality by estimating the Positive Predictive Value (PPV, <xref ref-type="fig" rid="fig2">Figure 2D</xref>, <xref ref-type="fig" rid="fig5">Figure 5C</xref>, <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>, <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>, <xref ref-type="fig" rid="fig5s3">Figure 5—figure supplement 3</xref>). The PPV for sequence <inline-formula><mml:math id="inf137"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> at the ranked position <inline-formula><mml:math id="inf138"><mml:mi mathsize="80%">p</mml:mi></mml:math></inline-formula> (<inline-formula><mml:math id="inf139"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mtext>PPV</mml:mtext><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>) is given by the number of top <inline-formula><mml:math id="inf140"><mml:mi mathsize="80%">p</mml:mi></mml:math></inline-formula> ranked positions that is included among the contact positions of <inline-formula><mml:math id="inf141"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (true positives), divided by <inline-formula><mml:math id="inf142"><mml:mi mathsize="80%">p</mml:mi></mml:math></inline-formula> or by number of contacts when this is lower than <inline-formula><mml:math id="inf143"><mml:mi mathsize="80%">p</mml:mi></mml:math></inline-formula> (all the positives). <inline-formula><mml:math id="inf144"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mtext>PPV</mml:mtext><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> hence hits 1 when <inline-formula><mml:math id="inf145"><mml:mi mathsize="80%">p</mml:mi></mml:math></inline-formula> is equal to the full length of sequence <inline-formula><mml:math id="inf146"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. For a given <inline-formula><mml:math id="inf147"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mtext>PPV</mml:mtext><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>, the associated random expectation corresponds to drawing uniformly at random <inline-formula><mml:math id="inf148"><mml:mi mathsize="80%">p</mml:mi></mml:math></inline-formula> positions and using them to predict the contact positions of <inline-formula><mml:math id="inf149"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. The summary values reported in <xref ref-type="fig" rid="fig2">Figure 2D</xref> and <xref ref-type="fig" rid="fig5">Figure 5C</xref> correspond to the average of <inline-formula><mml:math id="inf150"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mtext>PPV</mml:mtext><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> over all the sequences <inline-formula><mml:math id="inf151"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> under consideration (respectively, peptides and CDR3β) as a function of the number <inline-formula><mml:math id="inf152"><mml:mi mathsize="80%">p</mml:mi></mml:math></inline-formula> of ranked sequence positions. To check that the average PPV values obtained are due to the predictive power of the diffRBM model, we performed a statistical hypothesis test based on the binomial distribution: we define as ‘success’ the correct prediction of a contact using the diffRBM top ranked position and, using as null model a binomial distribution, we tested the null hypothesis that the probability of a success (<inline-formula><mml:math id="inf153"><mml:mi mathsize="80%">s</mml:mi></mml:math></inline-formula>) is simply given by the average fraction of contact positions per sequence. We calculated the p-value of the hypothesis test as the probability, under the null model, of obtaining the number of successes corresponding to the diffRBM PPV value for the top ranked position out of a number of trials given by the number of sequences tested. We obtain statistically significant p-values for both the immunogenicity model (s=0.48, p-value = <inline-formula><mml:math id="inf154"><mml:mrow><mml:mn mathsize="80%">7.7</mml:mn><mml:mo mathsize="80%" stretchy="false">×</mml:mo><mml:msup><mml:mn mathsize="80%">10</mml:mn><mml:mrow><mml:mo mathsize="80%" stretchy="false">-</mml:mo><mml:mn mathsize="80%">5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) and the TCR specificity model (s=0.20, p-value = <inline-formula><mml:math id="inf155"><mml:mrow><mml:mn mathsize="80%">1.6</mml:mn><mml:mo mathsize="80%" stretchy="false">×</mml:mo><mml:msup><mml:mn mathsize="80%">10</mml:mn><mml:mrow><mml:mo mathsize="80%" stretchy="false">-</mml:mo><mml:mn mathsize="80%">5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>). To correct for the over-representation among the available resolved structures of certain sequences (the same peptide and its one-point mutants in contact with different TCRs, sets of highly similar CDR3βs specific to the Influenza peptide GILGFVFTL), we calculate the average <inline-formula><mml:math id="inf156"><mml:msup><mml:mtext mathsize="80%">PPV</mml:mtext><mml:mi mathsize="80%">p</mml:mi></mml:msup></mml:math></inline-formula> at each position <inline-formula><mml:math id="inf157"><mml:mi mathsize="80%">p</mml:mi></mml:math></inline-formula> as a weighted average:<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mtext>PPV</mml:mtext><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mfrac><mml:msubsup><mml:mtext>PPV</mml:mtext><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msubsup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where we reweight the contribution of each sequence to the PPV by a factor <inline-formula><mml:math id="inf158"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, taking <inline-formula><mml:math id="inf159"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> as the number of sequences that are equal to or one mutation away from <inline-formula><mml:math id="inf160"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. In <xref ref-type="disp-formula" rid="equ12">Equation 12</xref> we have denoted by <inline-formula><mml:math id="inf161"><mml:mi mathsize="80%">R</mml:mi></mml:math></inline-formula> the total number of entries under consideration and by <inline-formula><mml:math id="inf162"><mml:msub><mml:mi mathsize="80%">R</mml:mi><mml:mi mathsize="80%">eff</mml:mi></mml:msub></mml:math></inline-formula> their effective number obtained as <inline-formula><mml:math id="inf163"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:munderover><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. Retaining only unique combinations of sequence and contact positions at the chosen distance cutoffs (4 Å for peptide-TCR contacts, 3.5 Å for peptide-HLA contacts), the number of structures considered for: (<italic>i</italic>) the prediction of contacts with the TCR along the peptide is <inline-formula><mml:math id="inf164"><mml:mrow><mml:mi mathsize="80%">R</mml:mi><mml:mo mathsize="80%" stretchy="false">=</mml:mo><mml:mn mathsize="80%">46</mml:mn></mml:mrow></mml:math></inline-formula> (4 for HLA-B*35:01, 41 for HLA-A*02:01, 1 for HLA-B*07:02); (<italic>ii</italic>) the prediction of contacts with the HLA along the peptide is <inline-formula><mml:math id="inf165"><mml:mrow><mml:mi mathsize="80%">R</mml:mi><mml:mo mathsize="80%" stretchy="false">=</mml:mo><mml:mn mathsize="80%">53</mml:mn></mml:mrow></mml:math></inline-formula> (5 for HLA-B*35:01, 47 for HLA-A*02:01, 1 for HLA-B*07:02); (<italic>iii</italic>) the prediction of contacts with the peptide along the CDR3β is <inline-formula><mml:math id="inf166"><mml:mrow><mml:mi mathsize="80%">R</mml:mi><mml:mo mathsize="80%" stretchy="false">=</mml:mo><mml:mn mathsize="80%">12</mml:mn></mml:mrow></mml:math></inline-formula> (2 for YLQPRTFLL, 3 for NLVPMVATV, 1 for GLCTLVAML, 6 for GILGFVFTL). The corresponding effective numbers are <inline-formula><mml:math id="inf167"><mml:mrow><mml:msub><mml:mi mathsize="80%">R</mml:mi><mml:mi mathsize="80%">eff</mml:mi></mml:msub><mml:mo mathsize="80%" stretchy="false">=</mml:mo><mml:mn mathsize="80%">22.7</mml:mn></mml:mrow></mml:math></inline-formula> for (<italic>i</italic>) and (<italic>ii</italic>), and <inline-formula><mml:math id="inf168"><mml:mrow><mml:msub><mml:mi mathsize="80%">R</mml:mi><mml:mi mathsize="80%">eff</mml:mi></mml:msub><mml:mo mathsize="80%" stretchy="false">=</mml:mo><mml:mn mathsize="80%">10.3</mml:mn></mml:mrow></mml:math></inline-formula> for (<italic>iii</italic>). In <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3A–B</xref>, <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4A–B</xref>, <xref ref-type="fig" rid="fig5s3">Figure 5—figure supplement 3A–B</xref> we report the comparison of the average reweighted PPV (<xref ref-type="disp-formula" rid="equ12">Equation 12</xref>) to the average PPV calculated without reweighting (<inline-formula><mml:math id="inf169"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mtext>PPV</mml:mtext><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>R</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mtext>PPV</mml:mtext><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>), showing that the reweighting does not affect the ranking of performance between different methods.</p></sec></sec><sec id="s4-6"><title>Mutation costs</title><p>The experiments of <xref ref-type="bibr" rid="bib47">Łuksza et al., 2022</xref> on how TCRs cross-react between the NLVPMVATV peptide and its mutants consisted of the following steps: the wild-type peptide (WT) was mutated to every amino acid at every position to obtain 171 mutants (MT); for each MT, its concentration was varied across a 10,000-fold range and the degree activation of 3 WT-specific TCRs was monitored as relative percentage of CD137 expression to determine the TCR cross-reactivity:<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtext>TCR cross-reactivity</mml:mtext><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>E</mml:mi><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mn>50</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mn>50</mml:mn></mml:mrow><mml:mrow><mml:mi>W</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>from the WT and MT half maximal Effective Concentration <inline-formula><mml:math id="inf170"><mml:mrow><mml:mi mathsize="80%">E</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathsize="80%">C</mml:mi><mml:mn mathsize="80%">50</mml:mn><mml:mrow><mml:mi mathsize="80%">W</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="80%">T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf171"><mml:mrow><mml:mi mathsize="80%">E</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathsize="80%">C</mml:mi><mml:mn mathsize="80%">50</mml:mn><mml:mrow><mml:mi mathsize="80%">M</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="80%">T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> (both measured in <inline-formula><mml:math id="inf172"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathsize="80%">μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="80%">g</mml:mi></mml:mrow><mml:mo mathsize="80%" stretchy="false">/</mml:mo><mml:mi mathsize="80%">m</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi mathsize="80%">l</mml:mi></mml:mrow></mml:math></inline-formula>). We took these reported values of TCR cross-reactivity as the experimental mutation costs for each TCR/mutation pair for non-lethal mutations. We defined ‘lethal’ the mutations that were associated to a formally infinite <inline-formula><mml:math id="inf173"><mml:mrow><mml:mi mathsize="80%">E</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathsize="80%">C</mml:mi><mml:mn mathsize="80%">50</mml:mn><mml:mrow><mml:mi mathsize="80%">M</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="80%">T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> in a given TCR context (<italic>i.e</italic>. TCR response could not be recovered even at the highest concentrations).</p><p>For a mutation in sequence <inline-formula><mml:math id="inf174"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> at position <inline-formula><mml:math id="inf175"><mml:mi mathsize="80%">i</mml:mi></mml:math></inline-formula> changing <inline-formula><mml:math id="inf176"><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub></mml:math></inline-formula> to <inline-formula><mml:math id="inf177"><mml:msubsup><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi><mml:mo mathsize="80%" stretchy="false">′</mml:mo></mml:msubsup></mml:math></inline-formula>, we estimated the model prediction of the mutation cost as:<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtext>Predicted mutation cost</mml:mtext><mml:mo>=</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where we took <inline-formula><mml:math id="inf178"><mml:msub><mml:mi mathsize="80%">T</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub></mml:math></inline-formula> as the single-site factors (<xref ref-type="disp-formula" rid="equ11">Equation 11</xref>) for lethal mutations (<xref ref-type="fig" rid="fig3">Figure 3E</xref>) and of background RBM (<xref ref-type="disp-formula" rid="equ22">Equation 22</xref> in Supporting Materials and methods) for non-lethal mutations (<xref ref-type="fig" rid="fig3">Figure 3G</xref>).</p><p>To assess whether the distribution towards positive values for lethal mutations is significantly higher than the expectation for generic, non immunogenicity-impacting mutations, we estimated the mutation cost distribution of a ‘control’ case (see <xref ref-type="fig" rid="fig3">Figure 3E</xref>) where we drew at random 3000 HLA-A*02:01-presented peptides from the background dataset, and we calculated the costs of all possible amino acid substitutions at each position. The p-value for the difference in these distributions was estimated by the Mann-Whitney U test.</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>Senior editor, eLife</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing - original draft</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Software, Formal analysis, Validation, Investigation, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Software, Formal analysis, Validation, Investigation, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Formal analysis, Supervision, Funding acquisition, Investigation, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Formal analysis, Supervision, Funding acquisition, Investigation, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con6"><p>Conceptualization, Formal analysis, Supervision, Funding acquisition, Investigation, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con7"><p>Conceptualization, Formal analysis, Supervision, Funding acquisition, Investigation, Methodology, Writing – review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-85126-mdarchecklist1-v2.pdf" mimetype="application" mime-subtype="pdf"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>The current manuscript is a computational study, so no data have been generated for this manuscript. The data used are downloaded from public databases. The pre-processed data, the results of the analysis, the codes to train and evaluate the models as well as the trained models are all available at the github page <ext-link ext-link-type="uri" xlink:href="https://github.com/bravib/diffRBM_immunogenicity_TCRspecificity">https://github.com/bravib/diffRBM_immunogenicity_TCRspecificity</ext-link> (copy archived at <xref ref-type="bibr" rid="bib8">Bravi, 2023</xref>).</p></sec><ack id="ack"><title>Acknowledgements</title><p>We thank Julien Racle, Nathanael Spisak, Francesco Camaglia, Marta Łuksza, Christopher Thorpe, Morten Nielsen and Vadim Karnaukhov for discussions. We are particularly grateful to Giulio Isacchini for help with the data and software. This research was supported by the ANR-17-CE30-0021-01 RBMPro, ANR-19-CE30-0021-01 Decrypted, ANR-19-CE45-0018 RESP-REP, Prodigen grants from the Agence Nationale de la Recherche and by the European Research Council COG 724208. ADG acknowledges funding from the European Union’s Horizon 2020 research and innovation programme under the Marie Sklodowska-Curie grant agreement No 101026293.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Akbar</surname><given-names>R</given-names></name><name><surname>Robert</surname><given-names>PA</given-names></name><name><surname>Weber</surname><given-names>CR</given-names></name><name><surname>Widrich</surname><given-names>M</given-names></name><name><surname>Frank</surname><given-names>R</given-names></name><name><surname>Pavlović</surname><given-names>M</given-names></name><name><surname>Scheffer</surname><given-names>L</given-names></name><name><surname>Chernigovskaya</surname><given-names>M</given-names></name><name><surname>Snapkov</surname><given-names>I</given-names></name><name><surname>Slabodkin</surname><given-names>A</given-names></name><name><surname>Mehta</surname><given-names>BB</given-names></name><name><surname>Miho</surname><given-names>E</given-names></name><name><surname>Lund-Johansen</surname><given-names>F</given-names></name><name><surname>Andersen</surname><given-names>JT</given-names></name><name><surname>Hochreiter</surname><given-names>S</given-names></name><name><surname>Hobæk Haff</surname><given-names>I</given-names></name><name><surname>Klambauer</surname><given-names>G</given-names></name><name><surname>Sandve</surname><given-names>GK</given-names></name><name><surname>Greiff</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>In silico proof of principle of machine learning-based antibody design at unconstrained scale</article-title><source>mAbs</source><volume>14</volume><elocation-id>2031482</elocation-id><pub-id pub-id-type="doi">10.1080/19420862.2022.2031482</pub-id><pub-id pub-id-type="pmid">35377271</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arnold</surname><given-names>FH</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Directed Evolution: Bringing New Chemistry to Life</article-title><source>Angewandte Chemie</source><volume>57</volume><fpage>4143</fpage><lpage>4148</lpage><pub-id pub-id-type="doi">10.1002/anie.201708408</pub-id><pub-id pub-id-type="pmid">29064156</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bagaev</surname><given-names>DV</given-names></name><name><surname>Vroomans</surname><given-names>RMA</given-names></name><name><surname>Samir</surname><given-names>J</given-names></name><name><surname>Stervbo</surname><given-names>U</given-names></name><name><surname>Rius</surname><given-names>C</given-names></name><name><surname>Dolton</surname><given-names>G</given-names></name><name><surname>Greenshields-Watson</surname><given-names>A</given-names></name><name><surname>Attaf</surname><given-names>M</given-names></name><name><surname>Egorov</surname><given-names>ES</given-names></name><name><surname>Zvyagin</surname><given-names>IV</given-names></name><name><surname>Babel</surname><given-names>N</given-names></name><name><surname>Cole</surname><given-names>DK</given-names></name><name><surname>Godkin</surname><given-names>AJ</given-names></name><name><surname>Sewell</surname><given-names>AK</given-names></name><name><surname>Kesmir</surname><given-names>C</given-names></name><name><surname>Chudakov</surname><given-names>DM</given-names></name><name><surname>Luciani</surname><given-names>F</given-names></name><name><surname>Shugay</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>VDJdb in 2019: database extension, new analysis infrastructure and a T-cell receptor motif compendium</article-title><source>Nucleic Acids Research</source><volume>48</volume><fpage>D1057</fpage><lpage>D1062</lpage><pub-id pub-id-type="doi">10.1093/nar/gkz874</pub-id><pub-id pub-id-type="pmid">31588507</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berman</surname><given-names>HM</given-names></name><name><surname>Westbrook</surname><given-names>J</given-names></name><name><surname>Feng</surname><given-names>Z</given-names></name><name><surname>Gilliland</surname><given-names>G</given-names></name><name><surname>Bhat</surname><given-names>TN</given-names></name><name><surname>Weissig</surname><given-names>H</given-names></name><name><surname>Shindyalov</surname><given-names>IN</given-names></name><name><surname>Bourne</surname><given-names>PE</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>The Protein Data Bank</article-title><source>Nucleic Acids Research</source><volume>28</volume><fpage>235</fpage><lpage>242</lpage><pub-id pub-id-type="doi">10.1093/nar/28.1.235</pub-id><pub-id pub-id-type="pmid">10592235</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bjerregaard</surname><given-names>A-M</given-names></name><name><surname>Nielsen</surname><given-names>M</given-names></name><name><surname>Jurtz</surname><given-names>V</given-names></name><name><surname>Barra</surname><given-names>CM</given-names></name><name><surname>Hadrup</surname><given-names>SR</given-names></name><name><surname>Szallasi</surname><given-names>Z</given-names></name><name><surname>Eklund</surname><given-names>AC</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>An Analysis of Natural T Cell Responses to Predicted Tumor Neoepitopes</article-title><source>Frontiers in Immunology</source><volume>8</volume><elocation-id>1566</elocation-id><pub-id pub-id-type="doi">10.3389/fimmu.2017.01566</pub-id><pub-id pub-id-type="pmid">29187854</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bravi</surname><given-names>B</given-names></name><name><surname>Balachandran</surname><given-names>VP</given-names></name><name><surname>Greenbaum</surname><given-names>BD</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name><name><surname>Monasson</surname><given-names>R</given-names></name><name><surname>Cocco</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2021">2021a</year><article-title>Probing T-cell response by sequence-based probabilistic modeling</article-title><source>PLOS Computational Biology</source><volume>17</volume><elocation-id>e1009297</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1009297</pub-id><pub-id pub-id-type="pmid">34473697</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bravi</surname><given-names>B</given-names></name><name><surname>Tubiana</surname><given-names>J</given-names></name><name><surname>Cocco</surname><given-names>S</given-names></name><name><surname>Monasson</surname><given-names>R</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2021">2021b</year><article-title>RBM-MHC: A Semi-Supervised Machine-Learning Method for Sample-Specific Prediction of Antigen Presentation by HLA-I Alleles</article-title><source>Cell Systems</source><volume>12</volume><fpage>195</fpage><lpage>202</lpage><pub-id pub-id-type="doi">10.1016/j.cels.2020.11.005</pub-id><pub-id pub-id-type="pmid">33338400</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Bravi</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>Diffrbm_Immunogenicity_Tcrspecificity</data-title><version designator="swh:1:rev:3f18aa575e8e627145e47ceab9a02921fd632464">swh:1:rev:3f18aa575e8e627145e47ceab9a02921fd632464</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:8cc30942ade91369c5106f58e5d10d9a49d2f667;origin=https://github.com/bravib/diffRBM_immunogenicity_TCRspecificity;visit=swh:1:snp:e2832b22a14afd691bb9af5ee93e56ba396bc5bd;anchor=swh:1:rev:3f18aa575e8e627145e47ceab9a02921fd632464">https://archive.softwareheritage.org/swh:1:dir:8cc30942ade91369c5106f58e5d10d9a49d2f667;origin=https://github.com/bravib/diffRBM_immunogenicity_TCRspecificity;visit=swh:1:snp:e2832b22a14afd691bb9af5ee93e56ba396bc5bd;anchor=swh:1:rev:3f18aa575e8e627145e47ceab9a02921fd632464</ext-link></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Britanova</surname><given-names>OV</given-names></name><name><surname>Shugay</surname><given-names>M</given-names></name><name><surname>Merzlyak</surname><given-names>EM</given-names></name><name><surname>Staroverov</surname><given-names>DB</given-names></name><name><surname>Putintseva</surname><given-names>EV</given-names></name><name><surname>Turchaninova</surname><given-names>MA</given-names></name><name><surname>Mamedov</surname><given-names>IZ</given-names></name><name><surname>Pogorelyy</surname><given-names>MV</given-names></name><name><surname>Bolotin</surname><given-names>DA</given-names></name><name><surname>Izraelson</surname><given-names>M</given-names></name><name><surname>Davydov</surname><given-names>AN</given-names></name><name><surname>Egorov</surname><given-names>ES</given-names></name><name><surname>Kasatskaya</surname><given-names>SA</given-names></name><name><surname>Rebrikov</surname><given-names>DV</given-names></name><name><surname>Lukyanov</surname><given-names>S</given-names></name><name><surname>Chudakov</surname><given-names>DM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Dynamics of Individual T Cell Repertoires: From Cord Blood to Centenarians</article-title><source>Journal of Immunology</source><volume>196</volume><fpage>5005</fpage><lpage>5013</lpage><pub-id pub-id-type="doi">10.4049/jimmunol.1600005</pub-id><pub-id pub-id-type="pmid">27183615</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buckley</surname><given-names>PR</given-names></name><name><surname>Lee</surname><given-names>CH</given-names></name><name><surname>Ma</surname><given-names>R</given-names></name><name><surname>Woodhouse</surname><given-names>I</given-names></name><name><surname>Woo</surname><given-names>J</given-names></name><name><surname>Tsvetkov</surname><given-names>VO</given-names></name><name><surname>Shcherbinin</surname><given-names>DS</given-names></name><name><surname>Antanaviciute</surname><given-names>A</given-names></name><name><surname>Shughay</surname><given-names>M</given-names></name><name><surname>Rei</surname><given-names>M</given-names></name><name><surname>Simmons</surname><given-names>A</given-names></name><name><surname>Koohy</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Evaluating performance of existing computational models in predicting CD8+ T cell pathogenic epitopes and cancer neoantigens</article-title><source>Briefings in Bioinformatics</source><volume>23</volume><elocation-id>bbac141</elocation-id><pub-id pub-id-type="doi">10.1093/bib/bbac141</pub-id><pub-id pub-id-type="pmid">35471658</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Calis</surname><given-names>JJA</given-names></name><name><surname>de Boer</surname><given-names>RJ</given-names></name><name><surname>Keşmir</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Degenerate T-cell recognition of peptides on MHC molecules creates large holes in the T-cell repertoire</article-title><source>PLOS Computational Biology</source><volume>8</volume><elocation-id>e1002412</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002412</pub-id><pub-id pub-id-type="pmid">22396638</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Calis</surname><given-names>JJA</given-names></name><name><surname>Maybeno</surname><given-names>M</given-names></name><name><surname>Greenbaum</surname><given-names>JA</given-names></name><name><surname>Weiskopf</surname><given-names>D</given-names></name><name><surname>De Silva</surname><given-names>AD</given-names></name><name><surname>Sette</surname><given-names>A</given-names></name><name><surname>Keşmir</surname><given-names>C</given-names></name><name><surname>Peters</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Properties of MHC class I presented peptides that enhance immunogenicity</article-title><source>PLOS Computational Biology</source><volume>9</volume><elocation-id>e1003266</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003266</pub-id><pub-id pub-id-type="pmid">24204222</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carter</surname><given-names>JA</given-names></name><name><surname>Preall</surname><given-names>JB</given-names></name><name><surname>Grigaityte</surname><given-names>K</given-names></name><name><surname>Goldfless</surname><given-names>SJ</given-names></name><name><surname>Jeffery</surname><given-names>E</given-names></name><name><surname>Briggs</surname><given-names>AW</given-names></name><name><surname>Vigneault</surname><given-names>F</given-names></name><name><surname>Atwal</surname><given-names>GS</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Single T Cell Sequencing Demonstrates the Functional Role of <italic>αβ</italic> TCR Pairing in Cell Lineage and Antigen Specificity</article-title><source>Frontiers in Immunology</source><volume>10</volume><elocation-id>1516</elocation-id><pub-id pub-id-type="doi">10.3389/fimmu.2019.01516</pub-id><pub-id pub-id-type="pmid">31417541</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chowell</surname><given-names>D</given-names></name><name><surname>Krishna</surname><given-names>S</given-names></name><name><surname>Becker</surname><given-names>PD</given-names></name><name><surname>Cocita</surname><given-names>C</given-names></name><name><surname>Shu</surname><given-names>J</given-names></name><name><surname>Tan</surname><given-names>X</given-names></name><name><surname>Greenberg</surname><given-names>PD</given-names></name><name><surname>Klavinskis</surname><given-names>LS</given-names></name><name><surname>Blattman</surname><given-names>JN</given-names></name><name><surname>Anderson</surname><given-names>KS</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>TCR contact residue hydrophobicity is a hallmark of immunogenic CD8+ T cell epitopes</article-title><source>PNAS</source><volume>112</volume><fpage>E1754</fpage><lpage>E1762</lpage><pub-id pub-id-type="doi">10.1073/pnas.1500973112</pub-id><pub-id pub-id-type="pmid">25831525</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chronister</surname><given-names>WD</given-names></name><name><surname>Crinklaw</surname><given-names>A</given-names></name><name><surname>Mahajan</surname><given-names>S</given-names></name><name><surname>Vita</surname><given-names>R</given-names></name><name><surname>Koşaloğlu-Yalçın</surname><given-names>Z</given-names></name><name><surname>Yan</surname><given-names>Z</given-names></name><name><surname>Greenbaum</surname><given-names>JA</given-names></name><name><surname>Jessen</surname><given-names>LE</given-names></name><name><surname>Nielsen</surname><given-names>M</given-names></name><name><surname>Christley</surname><given-names>S</given-names></name><name><surname>Cowell</surname><given-names>LG</given-names></name><name><surname>Sette</surname><given-names>A</given-names></name><name><surname>Peters</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>TCRMatch: Predicting T-Cell Receptor Specificity Based on Sequence Similarity to Previously Characterized Receptors</article-title><source>Frontiers in Immunology</source><volume>12</volume><elocation-id>640725</elocation-id><pub-id pub-id-type="doi">10.3389/fimmu.2021.640725</pub-id><pub-id pub-id-type="pmid">33777034</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cinelli</surname><given-names>M</given-names></name><name><surname>Sun</surname><given-names>Y</given-names></name><name><surname>Best</surname><given-names>K</given-names></name><name><surname>Heather</surname><given-names>JM</given-names></name><name><surname>Reich-Zeliger</surname><given-names>S</given-names></name><name><surname>Shifrut</surname><given-names>E</given-names></name><name><surname>Friedman</surname><given-names>N</given-names></name><name><surname>Shawe-Taylor</surname><given-names>J</given-names></name><name><surname>Chain</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Feature selection using a one dimensional naïve Bayes’ classifier increases the accuracy of support vector machine classification of CDR3 repertoires</article-title><source>Bioinformatics</source><volume>33</volume><fpage>951</fpage><lpage>955</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btw771</pub-id><pub-id pub-id-type="pmid">28073756</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cocco</surname><given-names>S</given-names></name><name><surname>Feinauer</surname><given-names>C</given-names></name><name><surname>Figliuzzi</surname><given-names>M</given-names></name><name><surname>Monasson</surname><given-names>R</given-names></name><name><surname>Weigt</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Inverse statistical physics of protein sequences: a key issues review</article-title><source>Reports on Progress in Physics. Physical Society</source><volume>81</volume><elocation-id>032601</elocation-id><pub-id pub-id-type="doi">10.1088/1361-6633/aa9965</pub-id><pub-id pub-id-type="pmid">29120346</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Croft</surname><given-names>NP</given-names></name><name><surname>Smith</surname><given-names>SA</given-names></name><name><surname>Pickering</surname><given-names>J</given-names></name><name><surname>Sidney</surname><given-names>J</given-names></name><name><surname>Peters</surname><given-names>B</given-names></name><name><surname>Faridi</surname><given-names>P</given-names></name><name><surname>Witney</surname><given-names>MJ</given-names></name><name><surname>Sebastian</surname><given-names>P</given-names></name><name><surname>Flesch</surname><given-names>IEA</given-names></name><name><surname>Heading</surname><given-names>SL</given-names></name><name><surname>Sette</surname><given-names>A</given-names></name><name><surname>La Gruta</surname><given-names>NL</given-names></name><name><surname>Purcell</surname><given-names>AW</given-names></name><name><surname>Tscharke</surname><given-names>DC</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Most viral peptides displayed by class I MHC on infected cells are immunogenic</article-title><source>PNAS</source><volume>116</volume><fpage>3112</fpage><lpage>3117</lpage><pub-id pub-id-type="doi">10.1073/pnas.1815239116</pub-id><pub-id pub-id-type="pmid">30718433</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dash</surname><given-names>P</given-names></name><name><surname>Fiore-Gartland</surname><given-names>AJ</given-names></name><name><surname>Hertz</surname><given-names>T</given-names></name><name><surname>Wang</surname><given-names>GC</given-names></name><name><surname>Sharma</surname><given-names>S</given-names></name><name><surname>Souquette</surname><given-names>A</given-names></name><name><surname>Crawford</surname><given-names>JC</given-names></name><name><surname>Clemens</surname><given-names>EB</given-names></name><name><surname>Nguyen</surname><given-names>THO</given-names></name><name><surname>Kedzierska</surname><given-names>K</given-names></name><name><surname>La Gruta</surname><given-names>NL</given-names></name><name><surname>Bradley</surname><given-names>P</given-names></name><name><surname>Thomas</surname><given-names>PG</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Quantifiable predictive features define epitope-specific T cell receptor repertoires</article-title><source>Nature</source><volume>547</volume><fpage>89</fpage><lpage>93</lpage><pub-id pub-id-type="doi">10.1038/nature22383</pub-id><pub-id pub-id-type="pmid">28636592</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davidsen</surname><given-names>K</given-names></name><name><surname>Olson</surname><given-names>BJ</given-names></name><name><surname>DeWitt</surname><given-names>WS</given-names></name><name><surname>Feng</surname><given-names>J</given-names></name><name><surname>Harkins</surname><given-names>E</given-names></name><name><surname>Bradley</surname><given-names>P</given-names></name><name><surname>Matsen</surname><given-names>FA</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Deep generative models for T cell receptor protein sequences</article-title><source>eLife</source><volume>8</volume><elocation-id>e46935</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.46935</pub-id><pub-id pub-id-type="pmid">31487240</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Neuter</surname><given-names>N</given-names></name><name><surname>Bittremieux</surname><given-names>W</given-names></name><name><surname>Beirnaert</surname><given-names>C</given-names></name><name><surname>Cuypers</surname><given-names>B</given-names></name><name><surname>Mrzic</surname><given-names>A</given-names></name><name><surname>Moris</surname><given-names>P</given-names></name><name><surname>Suls</surname><given-names>A</given-names></name><name><surname>Van Tendeloo</surname><given-names>V</given-names></name><name><surname>Ogunjimi</surname><given-names>B</given-names></name><name><surname>Laukens</surname><given-names>K</given-names></name><name><surname>Meysman</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>On the feasibility of mining CD8+ T cell receptor patterns underlying immunogenic peptide recognition</article-title><source>Immunogenetics</source><volume>70</volume><fpage>159</fpage><lpage>168</lpage><pub-id pub-id-type="doi">10.1007/s00251-017-1023-5</pub-id><pub-id pub-id-type="pmid">28779185</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>De Neuter</surname><given-names>N</given-names></name><name><surname>Bittremieux</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>TCR-Classifier</data-title><version designator="7d11df9">7d11df9</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/bittremieux/TCR-classifier">https://github.com/bittremieux/TCR-classifier</ext-link></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Elhanati</surname><given-names>Y</given-names></name><name><surname>Murugan</surname><given-names>A</given-names></name><name><surname>Callan</surname><given-names>CG</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Quantifying selection in immune receptor repertoires</article-title><source>PNAS</source><volume>111</volume><fpage>9875</fpage><lpage>9880</lpage><pub-id pub-id-type="doi">10.1073/pnas.1409572111</pub-id><pub-id pub-id-type="pmid">24941953</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ellington</surname><given-names>AD</given-names></name><name><surname>Szostak</surname><given-names>JW</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>In vitro selection of RNA molecules that bind specific ligands</article-title><source>Nature</source><volume>346</volume><fpage>818</fpage><lpage>822</lpage><pub-id pub-id-type="doi">10.1038/346818a0</pub-id><pub-id pub-id-type="pmid">1697402</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Emerson</surname><given-names>RO</given-names></name><name><surname>DeWitt</surname><given-names>WS</given-names></name><name><surname>Vignali</surname><given-names>M</given-names></name><name><surname>Gravley</surname><given-names>J</given-names></name><name><surname>Hu</surname><given-names>JK</given-names></name><name><surname>Osborne</surname><given-names>EJ</given-names></name><name><surname>Desmarais</surname><given-names>C</given-names></name><name><surname>Klinger</surname><given-names>M</given-names></name><name><surname>Carlson</surname><given-names>CS</given-names></name><name><surname>Hansen</surname><given-names>JA</given-names></name><name><surname>Rieder</surname><given-names>M</given-names></name><name><surname>Robins</surname><given-names>HS</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Immunosequencing identifies signatures of cytomegalovirus exposure history and HLA-mediated effects on the T cell repertoire</article-title><source>Nature Genetics</source><volume>49</volume><fpage>659</fpage><lpage>665</lpage><pub-id pub-id-type="doi">10.1038/ng.3822</pub-id><pub-id pub-id-type="pmid">28369038</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Fernandez-de-Cossio-Diaz</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>Diffrbm</data-title><version designator="swh:1:rev:b0dbb3854e082cbb4a1452a441b6e4d0ffd804cb">swh:1:rev:b0dbb3854e082cbb4a1452a441b6e4d0ffd804cb</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:323a64477a72d06d21392ba3792c5161faf59de1;origin=https://github.com/cossio/diffRBM;visit=swh:1:snp:1b90696a33936a7c27c4f8384a2ebd4ad06f948a;anchor=swh:1:rev:b0dbb3854e082cbb4a1452a441b6e4d0ffd804cb">https://archive.softwareheritage.org/swh:1:dir:323a64477a72d06d21392ba3792c5161faf59de1;origin=https://github.com/cossio/diffRBM;visit=swh:1:snp:1b90696a33936a7c27c4f8384a2ebd4ad06f948a;anchor=swh:1:rev:b0dbb3854e082cbb4a1452a441b6e4d0ffd804cb</ext-link></element-citation></ref><ref id="bib27"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Gao</surname><given-names>A</given-names></name><name><surname>Chen</surname><given-names>Z</given-names></name><name><surname>Segal</surname><given-names>FP</given-names></name><name><surname>Carrington</surname><given-names>M</given-names></name><name><surname>Streeck</surname><given-names>H</given-names></name><name><surname>Chakraborty</surname><given-names>AK</given-names></name><name><surname>Julg</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Predicting the Immunogenicity of T Cell Epitopes: From HIV to SARS-CoV-2</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2020.05.14.095885</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gfeller</surname><given-names>D</given-names></name><name><surname>Guillaume</surname><given-names>P</given-names></name><name><surname>Michaux</surname><given-names>J</given-names></name><name><surname>Pak</surname><given-names>H-S</given-names></name><name><surname>Daniel</surname><given-names>RT</given-names></name><name><surname>Racle</surname><given-names>J</given-names></name><name><surname>Coukos</surname><given-names>G</given-names></name><name><surname>Bassani-Sternberg</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>The Length Distribution and Multiple Specificity of Naturally Presented HLA-I Ligands</article-title><source>The Journal of Immunology</source><volume>201</volume><fpage>3705</fpage><lpage>3716</lpage><pub-id pub-id-type="doi">10.4049/jimmunol.1800914</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Gfeller</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>Prime</data-title><version designator="2.0">2.0</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/GfellerLab/PRIME">https://github.com/GfellerLab/PRIME</ext-link></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gielis</surname><given-names>S</given-names></name><name><surname>Moris</surname><given-names>P</given-names></name><name><surname>Bittremieux</surname><given-names>W</given-names></name><name><surname>De Neuter</surname><given-names>N</given-names></name><name><surname>Ogunjimi</surname><given-names>B</given-names></name><name><surname>Laukens</surname><given-names>K</given-names></name><name><surname>Meysman</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Detection of Enriched T Cell Epitope Specificity in Full T Cell Receptor Sequence Repertoires</article-title><source>Frontiers in Immunology</source><volume>10</volume><elocation-id>2820</elocation-id><pub-id pub-id-type="doi">10.3389/fimmu.2019.02820</pub-id><pub-id pub-id-type="pmid">31849987</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Glanville</surname><given-names>J</given-names></name><name><surname>Huang</surname><given-names>H</given-names></name><name><surname>Nau</surname><given-names>A</given-names></name><name><surname>Hatton</surname><given-names>O</given-names></name><name><surname>Wagar</surname><given-names>LE</given-names></name><name><surname>Rubelt</surname><given-names>F</given-names></name><name><surname>Ji</surname><given-names>X</given-names></name><name><surname>Han</surname><given-names>A</given-names></name><name><surname>Krams</surname><given-names>SM</given-names></name><name><surname>Pettus</surname><given-names>C</given-names></name><name><surname>Haas</surname><given-names>N</given-names></name><name><surname>Arlehamn</surname><given-names>CSL</given-names></name><name><surname>Sette</surname><given-names>A</given-names></name><name><surname>Boyd</surname><given-names>SD</given-names></name><name><surname>Scriba</surname><given-names>TJ</given-names></name><name><surname>Martinez</surname><given-names>OM</given-names></name><name><surname>Davis</surname><given-names>MM</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Identifying specificity groups in the T cell receptor repertoire</article-title><source>Nature</source><volume>547</volume><fpage>94</fpage><lpage>98</lpage><pub-id pub-id-type="doi">10.1038/nature22976</pub-id><pub-id pub-id-type="pmid">28636589</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goncharov</surname><given-names>MM</given-names></name><name><surname>Bryushkova</surname><given-names>EA</given-names></name><name><surname>Sharaev</surname><given-names>NI</given-names></name><name><surname>Skatova</surname><given-names>VD</given-names></name><name><surname>Baryshnikova</surname><given-names>AM</given-names></name><name><surname>Sharonov</surname><given-names>GV</given-names></name><name><surname>Karnaukhov</surname><given-names>V</given-names></name><name><surname>Vakhitova</surname><given-names>MT</given-names></name><name><surname>Samoylenko</surname><given-names>IV</given-names></name><name><surname>Demidov</surname><given-names>LV</given-names></name><name><surname>Lukyanov</surname><given-names>S</given-names></name><name><surname>Chudakov</surname><given-names>DM</given-names></name><name><surname>Serebrovskaya</surname><given-names>EO</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Pinpointing the tumor-specific T cells via TCR clusters</article-title><source>eLife</source><volume>11</volume><elocation-id>e77274</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.77274</pub-id><pub-id pub-id-type="pmid">35377314</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hinton</surname><given-names>GE</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Training products of experts by minimizing contrastive divergence</article-title><source>Neural Computation</source><volume>14</volume><fpage>1771</fpage><lpage>1800</lpage><pub-id pub-id-type="doi">10.1162/089976602760128018</pub-id><pub-id pub-id-type="pmid">12180402</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hinton</surname><given-names>GE</given-names></name><name><surname>Salakhutdinov</surname><given-names>RR</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Reducing the dimensionality of data with neural networks</article-title><source>Science</source><volume>313</volume><fpage>504</fpage><lpage>507</lpage><pub-id pub-id-type="doi">10.1126/science.1127647</pub-id><pub-id pub-id-type="pmid">16873662</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hoof</surname><given-names>I</given-names></name><name><surname>Pérez</surname><given-names>CL</given-names></name><name><surname>Buggert</surname><given-names>M</given-names></name><name><surname>Gustafsson</surname><given-names>RKL</given-names></name><name><surname>Nielsen</surname><given-names>M</given-names></name><name><surname>Lund</surname><given-names>O</given-names></name><name><surname>Karlsson</surname><given-names>AC</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Interdisciplinary analysis of HIV-specific CD8+ T cell responses against variant epitopes reveals restricted TCR promiscuity</article-title><source>Journal of Immunology</source><volume>184</volume><fpage>5383</fpage><lpage>5391</lpage><pub-id pub-id-type="doi">10.4049/jimmunol.0903516</pub-id><pub-id pub-id-type="pmid">20363973</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>H</given-names></name><name><surname>Wang</surname><given-names>C</given-names></name><name><surname>Rubelt</surname><given-names>F</given-names></name><name><surname>Scriba</surname><given-names>TJ</given-names></name><name><surname>Davis</surname><given-names>MM</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Analyzing the Mycobacterium tuberculosis immune response by T-cell receptor clustering with GLIPH2 and genome-wide antigen screening</article-title><source>Nature Biotechnology</source><volume>38</volume><fpage>1194</fpage><lpage>1202</lpage><pub-id pub-id-type="doi">10.1038/s41587-020-0505-4</pub-id><pub-id pub-id-type="pmid">32341563</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Isacchini</surname><given-names>G</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name><name><surname>Nourmohammad</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Deep generative selection models of T and B cell receptor repertoires with soNNia</article-title><source>PNAS</source><volume>118</volume><elocation-id>e2023141118</elocation-id><pub-id pub-id-type="doi">10.1073/pnas.2023141118</pub-id><pub-id pub-id-type="pmid">33795515</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jäckel</surname><given-names>C</given-names></name><name><surname>Kast</surname><given-names>P</given-names></name><name><surname>Hilvert</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Protein design by directed evolution</article-title><source>Annual Review of Biophysics</source><volume>37</volume><fpage>153</fpage><lpage>173</lpage><pub-id pub-id-type="doi">10.1146/annurev.biophys.37.032807.125832</pub-id><pub-id pub-id-type="pmid">18573077</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Jokinen</surname><given-names>E</given-names></name><name><surname>Huuhtanen</surname><given-names>J</given-names></name><name><surname>Mustjoki</surname><given-names>S</given-names></name><name><surname>Heinonen</surname><given-names>M</given-names></name><name><surname>Lähdesmäki</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Determining epitope specificity of T cell receptors with TCRGP</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/542332</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Karnaukhov</surname><given-names>VK</given-names></name><name><surname>Shcherbinin</surname><given-names>DS</given-names></name><name><surname>Chugunov</surname><given-names>AO</given-names></name><name><surname>Chudakov</surname><given-names>DM</given-names></name><name><surname>Efremov</surname><given-names>RG</given-names></name><name><surname>Zvyagin</surname><given-names>IV</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Predicting TCR-Peptide Recognition Based on Residue-Level Pairwise Statistical Potential</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2022.02.15.480516</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kristensen</surname><given-names>NP</given-names></name><name><surname>Heeke</surname><given-names>C</given-names></name><name><surname>Tvingsholm</surname><given-names>SA</given-names></name><name><surname>Borch</surname><given-names>A</given-names></name><name><surname>Draghi</surname><given-names>A</given-names></name><name><surname>Crowther</surname><given-names>MD</given-names></name><name><surname>Carri</surname><given-names>I</given-names></name><name><surname>Munk</surname><given-names>KK</given-names></name><name><surname>Holm</surname><given-names>JS</given-names></name><name><surname>Bjerregaard</surname><given-names>A-M</given-names></name><name><surname>Bentzen</surname><given-names>AK</given-names></name><name><surname>Marquard</surname><given-names>AM</given-names></name><name><surname>Szallasi</surname><given-names>Z</given-names></name><name><surname>McGranahan</surname><given-names>N</given-names></name><name><surname>Andersen</surname><given-names>R</given-names></name><name><surname>Nielsen</surname><given-names>M</given-names></name><name><surname>Jönsson</surname><given-names>GB</given-names></name><name><surname>Donia</surname><given-names>M</given-names></name><name><surname>Svane</surname><given-names>IM</given-names></name><name><surname>Hadrup</surname><given-names>SR</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Neoantigen-reactive CD8+ T cells affect clinical outcome of adoptive cell therapy with tumor-infiltrating lymphocytes in melanoma</article-title><source>The Journal of Clinical Investigation</source><volume>132</volume><elocation-id>e150535</elocation-id><pub-id pub-id-type="doi">10.1172/JCI150535</pub-id><pub-id pub-id-type="pmid">34813506</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leem</surname><given-names>J</given-names></name><name><surname>Mitchell</surname><given-names>LS</given-names></name><name><surname>Farmery</surname><given-names>JHR</given-names></name><name><surname>Barton</surname><given-names>J</given-names></name><name><surname>Galson</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Deciphering the language of antibodies using self-supervised learning</article-title><source>Patterns</source><volume>3</volume><elocation-id>100513</elocation-id><pub-id pub-id-type="doi">10.1016/j.patter.2022.100513</pub-id><pub-id pub-id-type="pmid">35845836</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>X</given-names></name><name><surname>George</surname><given-names>JT</given-names></name><name><surname>Schafer</surname><given-names>NP</given-names></name><name><surname>Chau</surname><given-names>KN</given-names></name><name><surname>Birnbaum</surname><given-names>ME</given-names></name><name><surname>Clementi</surname><given-names>C</given-names></name><name><surname>Onuchic</surname><given-names>JN</given-names></name><name><surname>Levine</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Rapid Assessment of T-Cell Receptor Specificity of the Immune Repertoire</article-title><source>Nature Computational Science</source><volume>1</volume><fpage>362</fpage><lpage>373</lpage><pub-id pub-id-type="doi">10.1038/s43588-021-00076-1</pub-id><pub-id pub-id-type="pmid">36090450</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Loshchilov</surname><given-names>I</given-names></name><name><surname>Hutter</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2019">2019</year><source>Decoupled Weight Decay Regularization</source><publisher-name>ICLR</publisher-name></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lu</surname><given-names>T</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Zhu</surname><given-names>J</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Jiang</surname><given-names>P</given-names></name><name><surname>Xiao</surname><given-names>X</given-names></name><name><surname>Bernatchez</surname><given-names>C</given-names></name><name><surname>Heymach</surname><given-names>JV</given-names></name><name><surname>Gibbons</surname><given-names>DL</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Xu</surname><given-names>L</given-names></name><name><surname>Reuben</surname><given-names>A</given-names></name><name><surname>Wang</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Deep learning-based prediction of the T cell receptor-antigen binding specificity</article-title><source>Nature Machine Intelligence</source><volume>3</volume><fpage>864</fpage><lpage>875</lpage><pub-id pub-id-type="doi">10.1038/s42256-021-00383-2</pub-id><pub-id pub-id-type="pmid">36003885</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Łuksza</surname><given-names>M</given-names></name><name><surname>Riaz</surname><given-names>N</given-names></name><name><surname>Makarov</surname><given-names>V</given-names></name><name><surname>Balachandran</surname><given-names>VP</given-names></name><name><surname>Hellmann</surname><given-names>MD</given-names></name><name><surname>Solovyov</surname><given-names>A</given-names></name><name><surname>Rizvi</surname><given-names>NA</given-names></name><name><surname>Merghoub</surname><given-names>T</given-names></name><name><surname>Levine</surname><given-names>AJ</given-names></name><name><surname>Chan</surname><given-names>TA</given-names></name><name><surname>Wolchok</surname><given-names>JD</given-names></name><name><surname>Greenbaum</surname><given-names>BD</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A neoantigen fitness model predicts tumour response to checkpoint blockade immunotherapy</article-title><source>Nature</source><volume>551</volume><fpage>517</fpage><lpage>520</lpage><pub-id pub-id-type="doi">10.1038/nature24473</pub-id><pub-id pub-id-type="pmid">29132144</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Łuksza</surname><given-names>M</given-names></name><name><surname>Sethna</surname><given-names>ZM</given-names></name><name><surname>Rojas</surname><given-names>LA</given-names></name><name><surname>Lihm</surname><given-names>J</given-names></name><name><surname>Bravi</surname><given-names>B</given-names></name><name><surname>Elhanati</surname><given-names>Y</given-names></name><name><surname>Soares</surname><given-names>K</given-names></name><name><surname>Amisaki</surname><given-names>M</given-names></name><name><surname>Dobrin</surname><given-names>A</given-names></name><name><surname>Hoyos</surname><given-names>D</given-names></name><name><surname>Guasp</surname><given-names>P</given-names></name><name><surname>Zebboudj</surname><given-names>A</given-names></name><name><surname>Yu</surname><given-names>R</given-names></name><name><surname>Chandra</surname><given-names>AK</given-names></name><name><surname>Waters</surname><given-names>T</given-names></name><name><surname>Odgerel</surname><given-names>Z</given-names></name><name><surname>Leung</surname><given-names>J</given-names></name><name><surname>Kappagantula</surname><given-names>R</given-names></name><name><surname>Makohon-Moore</surname><given-names>A</given-names></name><name><surname>Johns</surname><given-names>A</given-names></name><name><surname>Gill</surname><given-names>A</given-names></name><name><surname>Gigoux</surname><given-names>M</given-names></name><name><surname>Wolchok</surname><given-names>J</given-names></name><name><surname>Merghoub</surname><given-names>T</given-names></name><name><surname>Sadelain</surname><given-names>M</given-names></name><name><surname>Patterson</surname><given-names>E</given-names></name><name><surname>Monasson</surname><given-names>R</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name><name><surname>Cocco</surname><given-names>S</given-names></name><name><surname>Iacobuzio-Donahue</surname><given-names>C</given-names></name><name><surname>Greenbaum</surname><given-names>BD</given-names></name><name><surname>Balachandran</surname><given-names>VP</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Neoantigen quality predicts immunoediting in survivors of pancreatic cancer</article-title><source>Nature</source><volume>606</volume><fpage>389</fpage><lpage>395</lpage><pub-id pub-id-type="doi">10.1038/s41586-022-04735-9</pub-id><pub-id pub-id-type="pmid">35589842</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luu</surname><given-names>AM</given-names></name><name><surname>Leistico</surname><given-names>JR</given-names></name><name><surname>Miller</surname><given-names>T</given-names></name><name><surname>Kim</surname><given-names>S</given-names></name><name><surname>Song</surname><given-names>JS</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Predicting TCR-Epitope Binding Specificity Using Deep Metric Learning and Multimodal Learning</article-title><source>Genes</source><volume>12</volume><elocation-id>572</elocation-id><pub-id pub-id-type="doi">10.3390/genes12040572</pub-id><pub-id pub-id-type="pmid">33920780</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Maas</surname><given-names>AL</given-names></name><name><surname>Hannun</surname><given-names>AY</given-names></name><name><surname>Ng</surname><given-names>AY</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Rectifier Nonlinearities Improve Neural Network Acoustic Models</article-title><conf-name>Proceedings of the 30th International Conference on Machine Learning</conf-name></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marchi</surname><given-names>J</given-names></name><name><surname>Galpern</surname><given-names>EA</given-names></name><name><surname>Espada</surname><given-names>R</given-names></name><name><surname>Ferreiro</surname><given-names>DU</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Size and structure of the sequence space of repeat proteins</article-title><source>PLOS Computational Biology</source><volume>15</volume><elocation-id>e1007282</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1007282</pub-id><pub-id pub-id-type="pmid">31415557</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mayer-Blackwell</surname><given-names>K</given-names></name><name><surname>Schattgen</surname><given-names>S</given-names></name><name><surname>Cohen-Lavi</surname><given-names>L</given-names></name><name><surname>Crawford</surname><given-names>JC</given-names></name><name><surname>Souquette</surname><given-names>A</given-names></name><name><surname>Gaevert</surname><given-names>JA</given-names></name><name><surname>Hertz</surname><given-names>T</given-names></name><name><surname>Thomas</surname><given-names>PG</given-names></name><name><surname>Bradley</surname><given-names>P</given-names></name><name><surname>Fiore-Gartland</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>TCR meta-clonotypes for biomarker discovery with <italic>tcrdist3</italic> enabled identification of public, HLA-restricted clusters of SARS-CoV-2 TCRs</article-title><source>eLife</source><volume>10</volume><elocation-id>e68605</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.68605</pub-id><pub-id pub-id-type="pmid">34845983</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meysman</surname><given-names>P</given-names></name><name><surname>De Neuter</surname><given-names>N</given-names></name><name><surname>Gielis</surname><given-names>S</given-names></name><name><surname>Bui Thi</surname><given-names>D</given-names></name><name><surname>Ogunjimi</surname><given-names>B</given-names></name><name><surname>Laukens</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>On the viability of unsupervised T-cell receptor sequence clustering for epitope preference</article-title><source>Bioinformatics</source><volume>35</volume><fpage>1461</fpage><lpage>1468</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bty821</pub-id><pub-id pub-id-type="pmid">30247624</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Meysman</surname><given-names>P</given-names></name><name><surname>Barton</surname><given-names>J</given-names></name><name><surname>Bravi</surname><given-names>B</given-names></name><name><surname>Cohen-Lavi</surname><given-names>L</given-names></name><name><surname>Karnaukhov</surname><given-names>V</given-names></name><name><surname>Lilleskov</surname><given-names>E</given-names></name><name><surname>Montemurro</surname><given-names>A</given-names></name><name><surname>Nielsen</surname><given-names>M</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name><name><surname>Pereira</surname><given-names>P</given-names></name><name><surname>Postovskaya</surname><given-names>A</given-names></name><name><surname>Martínez</surname><given-names>MR</given-names></name><name><surname>Fernandez-de-Cossio-Diaz</surname><given-names>J</given-names></name><name><surname>Vujkovic</surname><given-names>A</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name><name><surname>Weber</surname><given-names>A</given-names></name><name><surname>Yin</surname><given-names>R</given-names></name><name><surname>Eugster</surname><given-names>A</given-names></name><name><surname>Sharma</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Benchmarking Solutions to the T-Cell Receptor Epitope Prediction Problem: IMMREP22 Workshop Report</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2022.10.27.514020</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Milighetti</surname><given-names>M</given-names></name><name><surname>Shawe-Taylor</surname><given-names>J</given-names></name><name><surname>Chain</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Predicting T Cell Receptor Antigen Specificity From Structural Features Derived From Homology Models of Receptor-Peptide-Major Histocompatibility Complexes</article-title><source>Frontiers in Physiology</source><volume>12</volume><elocation-id>730908</elocation-id><pub-id pub-id-type="doi">10.3389/fphys.2021.730908</pub-id><pub-id pub-id-type="pmid">34566692</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Minervina</surname><given-names>AA</given-names></name><name><surname>Komech</surname><given-names>EA</given-names></name><name><surname>Titov</surname><given-names>A</given-names></name><name><surname>Bensouda Koraichi</surname><given-names>M</given-names></name><name><surname>Rosati</surname><given-names>E</given-names></name><name><surname>Mamedov</surname><given-names>IZ</given-names></name><name><surname>Franke</surname><given-names>A</given-names></name><name><surname>Efimov</surname><given-names>GA</given-names></name><name><surname>Chudakov</surname><given-names>DM</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name><name><surname>Lebedev</surname><given-names>YB</given-names></name><name><surname>Pogorelyy</surname><given-names>MV</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Longitudinal high-throughput TCR repertoire profiling reveals the dynamics of T-cell memory formation after mild COVID-19 infection</article-title><source>eLife</source><volume>10</volume><elocation-id>e63502</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.63502</pub-id><pub-id pub-id-type="pmid">33399535</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Montemurro</surname><given-names>A</given-names></name><name><surname>Schuster</surname><given-names>V</given-names></name><name><surname>Povlsen</surname><given-names>HR</given-names></name><name><surname>Bentzen</surname><given-names>AK</given-names></name><name><surname>Jurtz</surname><given-names>V</given-names></name><name><surname>Chronister</surname><given-names>WD</given-names></name><name><surname>Crinklaw</surname><given-names>A</given-names></name><name><surname>Hadrup</surname><given-names>SR</given-names></name><name><surname>Winther</surname><given-names>O</given-names></name><name><surname>Peters</surname><given-names>B</given-names></name><name><surname>Jessen</surname><given-names>LE</given-names></name><name><surname>Nielsen</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>NetTCR-2.0 enables accurate prediction of TCR-peptide binding by using paired TCRα and β sequence data</article-title><source>Communications Biology</source><volume>4</volume><elocation-id>1060</elocation-id><pub-id pub-id-type="doi">10.1038/s42003-021-02610-3</pub-id><pub-id pub-id-type="pmid">34508155</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morcos</surname><given-names>F</given-names></name><name><surname>Pagnani</surname><given-names>A</given-names></name><name><surname>Lunt</surname><given-names>B</given-names></name><name><surname>Bertolino</surname><given-names>A</given-names></name><name><surname>Marks</surname><given-names>DS</given-names></name><name><surname>Sander</surname><given-names>C</given-names></name><name><surname>Zecchina</surname><given-names>R</given-names></name><name><surname>Onuchic</surname><given-names>JN</given-names></name><name><surname>Hwa</surname><given-names>T</given-names></name><name><surname>Weigt</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Direct-coupling analysis of residue coevolution captures native contacts across many protein families</article-title><source>PNAS</source><volume>108</volume><fpage>E1293</fpage><lpage>E1301</lpage><pub-id pub-id-type="doi">10.1073/pnas.1111471108</pub-id><pub-id pub-id-type="pmid">22106262</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nguyen</surname><given-names>AT</given-names></name><name><surname>Szeto</surname><given-names>C</given-names></name><name><surname>Gras</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>The pockets guide to HLA class I molecules</article-title><source>Biochemical Society Transactions</source><volume>49</volume><fpage>2319</fpage><lpage>2331</lpage><pub-id pub-id-type="doi">10.1042/BST20210410</pub-id><pub-id pub-id-type="pmid">34581761</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ogishi</surname><given-names>M</given-names></name><name><surname>Yotsuyanagi</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Quantitative Prediction of the Landscape of T Cell Epitope Immunogenicity in Sequence Space</article-title><source>Frontiers in Immunology</source><volume>10</volume><elocation-id>827</elocation-id><pub-id pub-id-type="doi">10.3389/fimmu.2019.00827</pub-id><pub-id pub-id-type="pmid">31057550</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ostmeyer</surname><given-names>J</given-names></name><name><surname>Christley</surname><given-names>S</given-names></name><name><surname>Toby</surname><given-names>IT</given-names></name><name><surname>Cowell</surname><given-names>LG</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Biophysicochemical Motifs in T-cell Receptor Sequences Distinguish Repertoires from Tumor-Infiltrating Lymphocyte and Adjacent Healthy Tissue</article-title><source>Cancer Research</source><volume>79</volume><fpage>1671</fpage><lpage>1680</lpage><pub-id pub-id-type="doi">10.1158/0008-5472.CAN-18-2292</pub-id><pub-id pub-id-type="pmid">30622114</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Packer</surname><given-names>MS</given-names></name><name><surname>Liu</surname><given-names>DR</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Methods for the directed evolution of proteins</article-title><source>Nature Reviews. Genetics</source><volume>16</volume><fpage>379</fpage><lpage>394</lpage><pub-id pub-id-type="doi">10.1038/nrg3927</pub-id><pub-id pub-id-type="pmid">26055155</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Papadopoulou</surname><given-names>I</given-names></name><name><surname>Nguyen</surname><given-names>A-P</given-names></name><name><surname>Weber</surname><given-names>A</given-names></name><name><surname>Martínez</surname><given-names>MR</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>DECODE: A computational pipeline to discover T cell receptor binding rules</article-title><source>Bioinformatics</source><volume>38</volume><fpage>i246</fpage><lpage>i254</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btac257</pub-id><pub-id pub-id-type="pmid">35758821</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Piepenbrink</surname><given-names>KH</given-names></name><name><surname>Blevins</surname><given-names>SJ</given-names></name><name><surname>Scott</surname><given-names>DR</given-names></name><name><surname>Baker</surname><given-names>BM</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The basis for limited specificity and MHC restriction in a T cell receptor interface</article-title><source>Nature Communications</source><volume>4</volume><elocation-id>1948</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms2948</pub-id><pub-id pub-id-type="pmid">23736024</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pogorelyy</surname><given-names>MV</given-names></name><name><surname>Minervina</surname><given-names>AA</given-names></name><name><surname>Shugay</surname><given-names>M</given-names></name><name><surname>Chudakov</surname><given-names>DM</given-names></name><name><surname>Lebedev</surname><given-names>YB</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2019">2019a</year><article-title>Detecting T cell receptors involved in immune responses from single repertoire snapshots</article-title><source>PLOS Biology</source><volume>17</volume><elocation-id>e3000314</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.3000314</pub-id><pub-id pub-id-type="pmid">31194732</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pogorelyy</surname><given-names>MV</given-names></name><name><surname>Shugay</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2019">2019b</year><article-title>A Framework for Annotation of Antigen specificities in high-throughput T-Cell Repertoire sequencing studies</article-title><source>Frontiers in Immunology</source><volume>10</volume><elocation-id>2159</elocation-id><pub-id pub-id-type="doi">10.3389/fimmu.2019.02159</pub-id><pub-id pub-id-type="pmid">31616409</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reynisson</surname><given-names>B</given-names></name><name><surname>Alvarez</surname><given-names>B</given-names></name><name><surname>Paul</surname><given-names>S</given-names></name><name><surname>Peters</surname><given-names>B</given-names></name><name><surname>Nielsen</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>NetMHCpan-4.1 and NetMHCIIpan-4.0: improved predictions of MHC antigen presentation by concurrent motif deconvolution and integration of MS MHC eluted ligand data</article-title><source>Nucleic Acids Research</source><volume>48</volume><fpage>W449</fpage><lpage>W454</lpage><pub-id pub-id-type="doi">10.1093/nar/gkaa379</pub-id><pub-id pub-id-type="pmid">32406916</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Riley</surname><given-names>TP</given-names></name><name><surname>Keller</surname><given-names>GLJ</given-names></name><name><surname>Smith</surname><given-names>AR</given-names></name><name><surname>Davancaze</surname><given-names>LM</given-names></name><name><surname>Arbuiso</surname><given-names>AG</given-names></name><name><surname>Devlin</surname><given-names>JR</given-names></name><name><surname>Baker</surname><given-names>BM</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Structure based prediction of neoantigen immunogenicity</article-title><source>Frontiers in Immunology</source><volume>10</volume><elocation-id>2047</elocation-id><pub-id pub-id-type="doi">10.3389/fimmu.2019.02047</pub-id><pub-id pub-id-type="pmid">31555277</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rossjohn</surname><given-names>J</given-names></name><name><surname>Gras</surname><given-names>S</given-names></name><name><surname>Miles</surname><given-names>JJ</given-names></name><name><surname>Turner</surname><given-names>SJ</given-names></name><name><surname>Godfrey</surname><given-names>DI</given-names></name><name><surname>McCluskey</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>T cell antigen receptor recognition of antigen-presenting molecules</article-title><source>Annual Review of Immunology</source><volume>33</volume><fpage>169</fpage><lpage>200</lpage><pub-id pub-id-type="doi">10.1146/annurev-immunol-032414-112334</pub-id><pub-id pub-id-type="pmid">25493333</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rudolph</surname><given-names>MG</given-names></name><name><surname>Stanfield</surname><given-names>RL</given-names></name><name><surname>Wilson</surname><given-names>IA</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>How TCRs bind MHCs, peptides, and coreceptors</article-title><source>Annual Review of Immunology</source><volume>24</volume><fpage>419</fpage><lpage>466</lpage><pub-id pub-id-type="doi">10.1146/annurev.immunol.23.021704.115658</pub-id><pub-id pub-id-type="pmid">16551255</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schaap-Johansen</surname><given-names>A-L</given-names></name><name><surname>Vujović</surname><given-names>M</given-names></name><name><surname>Borch</surname><given-names>A</given-names></name><name><surname>Hadrup</surname><given-names>SR</given-names></name><name><surname>Marcatili</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>T Cell Epitope prediction and its application to immunotherapy</article-title><source>Frontiers in Immunology</source><volume>12</volume><elocation-id>712488</elocation-id><pub-id pub-id-type="doi">10.3389/fimmu.2021.712488</pub-id><pub-id pub-id-type="pmid">34603286</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schenck</surname><given-names>RO</given-names></name><name><surname>Lakatos</surname><given-names>E</given-names></name><name><surname>Gatenbee</surname><given-names>C</given-names></name><name><surname>Graham</surname><given-names>TA</given-names></name><name><surname>Anderson</surname><given-names>ARA</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>NeoPredPipe: high-throughput neoantigen prediction and recognition potential pipeline</article-title><source>BMC Bioinformatics</source><volume>20</volume><elocation-id>264</elocation-id><pub-id pub-id-type="doi">10.1186/s12859-019-2876-4</pub-id><pub-id pub-id-type="pmid">31117948</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schmidt</surname><given-names>J</given-names></name><name><surname>Smith</surname><given-names>AR</given-names></name><name><surname>Magnin</surname><given-names>M</given-names></name><name><surname>Racle</surname><given-names>J</given-names></name><name><surname>Devlin</surname><given-names>JR</given-names></name><name><surname>Bobisse</surname><given-names>S</given-names></name><name><surname>Cesbron</surname><given-names>J</given-names></name><name><surname>Bonnet</surname><given-names>V</given-names></name><name><surname>Carmona</surname><given-names>SJ</given-names></name><name><surname>Huber</surname><given-names>F</given-names></name><name><surname>Ciriello</surname><given-names>G</given-names></name><name><surname>Speiser</surname><given-names>DE</given-names></name><name><surname>Bassani-Sternberg</surname><given-names>M</given-names></name><name><surname>Coukos</surname><given-names>G</given-names></name><name><surname>Baker</surname><given-names>BM</given-names></name><name><surname>Harari</surname><given-names>A</given-names></name><name><surname>Gfeller</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Prediction of neo-epitope immunogenicity reveals TCR recognition determinants and provides insight into immunoediting</article-title><source>Cell Reports. Medicine</source><volume>2</volume><elocation-id>100194</elocation-id><pub-id pub-id-type="doi">10.1016/j.xcrm.2021.100194</pub-id><pub-id pub-id-type="pmid">33665637</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Sehnal</surname><given-names>D</given-names></name><name><surname>Rose</surname><given-names>AS</given-names></name><name><surname>Koča</surname><given-names>J</given-names></name><name><surname>Burley</surname><given-names>SK</given-names></name><name><surname>Velankar</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Mol*: Towards a common library and tools for web molecular graphics</article-title><conf-name>In Proceedings of the Workshop on Molecular Graphics and Visual Analysis of Molecular Data, MolVA ’18</conf-name><fpage>29</fpage><lpage>33</lpage></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sethna</surname><given-names>Z</given-names></name><name><surname>Isacchini</surname><given-names>G</given-names></name><name><surname>Dupic</surname><given-names>T</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name><name><surname>Elhanati</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Population variability in the generation and selection of T-cell repertoires</article-title><source>PLOS Computational Biology</source><volume>16</volume><elocation-id>e1008394</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1008394</pub-id><pub-id pub-id-type="pmid">33296360</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sette</surname><given-names>A</given-names></name><name><surname>Vitiello</surname><given-names>A</given-names></name><name><surname>Reherman</surname><given-names>B</given-names></name><name><surname>Fowler</surname><given-names>P</given-names></name><name><surname>Nayersina</surname><given-names>R</given-names></name><name><surname>Kast</surname><given-names>WM</given-names></name><name><surname>Melief</surname><given-names>CJ</given-names></name><name><surname>Oseroff</surname><given-names>C</given-names></name><name><surname>Yuan</surname><given-names>L</given-names></name><name><surname>Ruppert</surname><given-names>J</given-names></name><name><surname>Sidney</surname><given-names>J</given-names></name><name><surname>del Guercio</surname><given-names>MF</given-names></name><name><surname>Southwood</surname><given-names>S</given-names></name><name><surname>Kubo</surname><given-names>RT</given-names></name><name><surname>Chesnut</surname><given-names>RW</given-names></name><name><surname>Grey</surname><given-names>HM</given-names></name><name><surname>Chisari</surname><given-names>FV</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>The relationship between class I binding affinity and immunogenicity of potential cytotoxic T cell epitopes</article-title><source>The Journal of Immunology</source><volume>153</volume><fpage>5586</fpage><lpage>5592</lpage><pub-id pub-id-type="doi">10.4049/jimmunol.153.12.5586</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sheriff</surname><given-names>S</given-names></name><name><surname>Hendrickson</surname><given-names>WA</given-names></name><name><surname>Smith</surname><given-names>JL</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Structure of myohemerythrin in the azidomet state at 1.7/1.3 A resolution</article-title><source>Journal of Molecular Biology</source><volume>197</volume><fpage>273</fpage><lpage>296</lpage><pub-id pub-id-type="doi">10.1016/0022-2836(87)90124-0</pub-id><pub-id pub-id-type="pmid">3681996</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shomuradova</surname><given-names>AS</given-names></name><name><surname>Vagida</surname><given-names>MS</given-names></name><name><surname>Sheetikov</surname><given-names>SA</given-names></name><name><surname>Zornikova</surname><given-names>KV</given-names></name><name><surname>Kiryukhin</surname><given-names>D</given-names></name><name><surname>Titov</surname><given-names>A</given-names></name><name><surname>Peshkova</surname><given-names>IO</given-names></name><name><surname>Khmelevskaya</surname><given-names>A</given-names></name><name><surname>Dianov</surname><given-names>DV</given-names></name><name><surname>Malasheva</surname><given-names>M</given-names></name><name><surname>Shmelev</surname><given-names>A</given-names></name><name><surname>Serdyuk</surname><given-names>Y</given-names></name><name><surname>Bagaev</surname><given-names>DV</given-names></name><name><surname>Pivnyuk</surname><given-names>A</given-names></name><name><surname>Shcherbinin</surname><given-names>DS</given-names></name><name><surname>Maleeva</surname><given-names>AV</given-names></name><name><surname>Shakirova</surname><given-names>NT</given-names></name><name><surname>Pilunov</surname><given-names>A</given-names></name><name><surname>Malko</surname><given-names>DB</given-names></name><name><surname>Khamaganova</surname><given-names>EG</given-names></name><name><surname>Biderman</surname><given-names>B</given-names></name><name><surname>Ivanov</surname><given-names>A</given-names></name><name><surname>Shugay</surname><given-names>M</given-names></name><name><surname>Efimov</surname><given-names>GA</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>SARS-CoV-2 Epitopes are recognized by a public and diverse repertoire of Human T Cell receptors</article-title><source>Immunity</source><volume>53</volume><fpage>1245</fpage><lpage>1257</lpage><pub-id pub-id-type="doi">10.1016/j.immuni.2020.11.004</pub-id><pub-id pub-id-type="pmid">33326767</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shugay</surname><given-names>M</given-names></name><name><surname>Bagaev</surname><given-names>DV</given-names></name><name><surname>Zvyagin</surname><given-names>IV</given-names></name><name><surname>Vroomans</surname><given-names>RM</given-names></name><name><surname>Crawford</surname><given-names>JC</given-names></name><name><surname>Dolton</surname><given-names>G</given-names></name><name><surname>Komech</surname><given-names>EA</given-names></name><name><surname>Sycheva</surname><given-names>AL</given-names></name><name><surname>Koneva</surname><given-names>AE</given-names></name><name><surname>Egorov</surname><given-names>ES</given-names></name><name><surname>Eliseev</surname><given-names>AV</given-names></name><name><surname>Van Dyk</surname><given-names>E</given-names></name><name><surname>Dash</surname><given-names>P</given-names></name><name><surname>Attaf</surname><given-names>M</given-names></name><name><surname>Rius</surname><given-names>C</given-names></name><name><surname>Ladell</surname><given-names>K</given-names></name><name><surname>McLaren</surname><given-names>JE</given-names></name><name><surname>Matthews</surname><given-names>KK</given-names></name><name><surname>Clemens</surname><given-names>EB</given-names></name><name><surname>Douek</surname><given-names>DC</given-names></name><name><surname>Luciani</surname><given-names>F</given-names></name><name><surname>van Baarle</surname><given-names>D</given-names></name><name><surname>Kedzierska</surname><given-names>K</given-names></name><name><surname>Kesmir</surname><given-names>C</given-names></name><name><surname>Thomas</surname><given-names>PG</given-names></name><name><surname>Price</surname><given-names>DA</given-names></name><name><surname>Sewell</surname><given-names>AK</given-names></name><name><surname>Chudakov</surname><given-names>DM</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>VDJdb: A curated database of T-cell receptor sequences with known antigen specificity</article-title><source>Nucleic Acids Research</source><volume>46</volume><fpage>D419</fpage><lpage>D427</lpage><pub-id pub-id-type="doi">10.1093/nar/gkx760</pub-id><pub-id pub-id-type="pmid">28977646</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sidhom</surname><given-names>J-W</given-names></name><name><surname>Larman</surname><given-names>HB</given-names></name><name><surname>Pardoll</surname><given-names>DM</given-names></name><name><surname>Baras</surname><given-names>AS</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Author Correction: DeepTCR is a deep learning framework for revealing sequence concepts within T-cell repertoires</article-title><source>Nature Communications</source><volume>12</volume><elocation-id>2309</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-021-22667-2</pub-id><pub-id pub-id-type="pmid">33850137</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>CC</given-names></name><name><surname>Chai</surname><given-names>S</given-names></name><name><surname>Washington</surname><given-names>AR</given-names></name><name><surname>Lee</surname><given-names>SJ</given-names></name><name><surname>Landoni</surname><given-names>E</given-names></name><name><surname>Field</surname><given-names>K</given-names></name><name><surname>Garness</surname><given-names>J</given-names></name><name><surname>Bixby</surname><given-names>LM</given-names></name><name><surname>Selitsky</surname><given-names>SR</given-names></name><name><surname>Parker</surname><given-names>JS</given-names></name><name><surname>Savoldo</surname><given-names>B</given-names></name><name><surname>Serody</surname><given-names>JS</given-names></name><name><surname>Vincent</surname><given-names>BG</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Machine-learning prediction of tumor antigen immunogenicity in the selection of therapeutic epitopes</article-title><source>Cancer Immunology Research</source><volume>7</volume><fpage>1591</fpage><lpage>1604</lpage><pub-id pub-id-type="doi">10.1158/2326-6066.CIR-19-0155</pub-id><pub-id pub-id-type="pmid">31515258</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sola</surname><given-names>M</given-names></name><name><surname>Menon</surname><given-names>AP</given-names></name><name><surname>Moreno</surname><given-names>B</given-names></name><name><surname>Meraviglia-Crivelli</surname><given-names>D</given-names></name><name><surname>Soldevilla</surname><given-names>MM</given-names></name><name><surname>Cartón-García</surname><given-names>F</given-names></name><name><surname>Pastor</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Aptamers against live targets: is in vivo SELEX finally coming to the edge?</article-title><source>Molecular Therapy. Nucleic Acids</source><volume>21</volume><fpage>192</fpage><lpage>204</lpage><pub-id pub-id-type="doi">10.1016/j.omtn.2020.05.025</pub-id><pub-id pub-id-type="pmid">32585627</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Springer</surname><given-names>I</given-names></name><name><surname>Besser</surname><given-names>H</given-names></name><name><surname>Tickotsky-Moskovitz</surname><given-names>N</given-names></name><name><surname>Dvorkin</surname><given-names>S</given-names></name><name><surname>Louzoun</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Prediction of specific TCR-Peptide binding from large dictionaries of TCR-Peptide Pairs</article-title><source>Frontiers in Immunology</source><volume>11</volume><elocation-id>1803</elocation-id><pub-id pub-id-type="doi">10.3389/fimmu.2020.01803</pub-id><pub-id pub-id-type="pmid">32983088</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thakkar</surname><given-names>N</given-names></name><name><surname>Bailey-Kellogg</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Balancing sensitivity and specificity in distinguishing TCR groups by CDR sequence similarity</article-title><source>BMC Bioinformatics</source><volume>20</volume><elocation-id>241</elocation-id><pub-id pub-id-type="doi">10.1186/s12859-019-2864-8</pub-id><pub-id pub-id-type="pmid">31092185</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trolle</surname><given-names>T</given-names></name><name><surname>Nielsen</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>NetTepi: an integrated method for the prediction of T cell epitopes</article-title><source>Immunogenetics</source><volume>66</volume><fpage>449</fpage><lpage>456</lpage><pub-id pub-id-type="doi">10.1007/s00251-014-0779-0</pub-id><pub-id pub-id-type="pmid">24863339</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tubiana</surname><given-names>J</given-names></name><name><surname>Cocco</surname><given-names>S</given-names></name><name><surname>Monasson</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Learning protein constitutive motifs from sequence data</article-title><source>eLife</source><volume>8</volume><elocation-id>e39397</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.39397</pub-id><pub-id pub-id-type="pmid">30857591</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tuerk</surname><given-names>C</given-names></name><name><surname>Gold</surname><given-names>L</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Systematic evolution of ligands by exponential enrichment: RNA ligands to bacteriophage T4 DNA polymerase</article-title><source>Science</source><volume>249</volume><fpage>505</fpage><lpage>510</lpage><pub-id pub-id-type="doi">10.1126/science.2200121</pub-id><pub-id pub-id-type="pmid">2200121</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Valkiers</surname><given-names>S</given-names></name><name><surname>Van Houcke</surname><given-names>M</given-names></name><name><surname>Laukens</surname><given-names>K</given-names></name><name><surname>Meysman</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>ClusTCR: A python interface for rapid clustering of large sets of CDR3 sequences with unknown antigen specificity</article-title><source>Bioinformatics</source><volume>37</volume><fpage>4865</fpage><lpage>4867</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btab446</pub-id><pub-id pub-id-type="pmid">34132766</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van der Plas</surname><given-names>TL</given-names></name><name><surname>Tubiana</surname><given-names>J</given-names></name><name><surname>Le Goc</surname><given-names>G</given-names></name><name><surname>Migault</surname><given-names>G</given-names></name><name><surname>Kunst</surname><given-names>M</given-names></name><name><surname>Baier</surname><given-names>H</given-names></name><name><surname>Bormuth</surname><given-names>V</given-names></name><name><surname>Englitz</surname><given-names>B</given-names></name><name><surname>Debrégeas</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Neural assemblies uncovered by generative modeling explain whole-brain activity statistics and reflect structural connectivity</article-title><source>eLife</source><volume>12</volume><elocation-id>e83139</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.83139</pub-id><pub-id pub-id-type="pmid">36648065</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vita</surname><given-names>R</given-names></name><name><surname>Mahajan</surname><given-names>S</given-names></name><name><surname>Overton</surname><given-names>JA</given-names></name><name><surname>Dhanda</surname><given-names>SK</given-names></name><name><surname>Martini</surname><given-names>S</given-names></name><name><surname>Cantrell</surname><given-names>JR</given-names></name><name><surname>Wheeler</surname><given-names>DK</given-names></name><name><surname>Sette</surname><given-names>A</given-names></name><name><surname>Peters</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The Immune Epitope Database (IEDB): 2018 update</article-title><source>Nucleic Acids Research</source><volume>47</volume><fpage>D339</fpage><lpage>D343</lpage><pub-id pub-id-type="doi">10.1093/nar/gky1006</pub-id><pub-id pub-id-type="pmid">30357391</pub-id></element-citation></ref><ref id="bib90"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weber</surname><given-names>A</given-names></name><name><surname>Born</surname><given-names>J</given-names></name><name><surname>Rodriguez Martínez</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>TITAN: T-cell receptor specificity prediction with bimodal attention networks</article-title><source>Bioinformatics</source><volume>37</volume><fpage>i237</fpage><lpage>i244</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btab294</pub-id><pub-id pub-id-type="pmid">34252922</pub-id></element-citation></ref><ref id="bib91"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wei</surname><given-names>B</given-names></name><name><surname>Pal</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Heterogeneous Transfer Learning with RBMs</article-title><source>Proceedings of the AAAI Conference on Artificial Intelligence</source><volume>25</volume><fpage>531</fpage><lpage>536</lpage><pub-id pub-id-type="doi">10.1609/aaai.v25i1.7925</pub-id></element-citation></ref><ref id="bib92"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wells</surname><given-names>DK</given-names></name><name><surname>van Buuren</surname><given-names>MM</given-names></name><name><surname>Dang</surname><given-names>KK</given-names></name><name><surname>Hubbard-Lucey</surname><given-names>VM</given-names></name><name><surname>Sheehan</surname><given-names>KCF</given-names></name><name><surname>Campbell</surname><given-names>KM</given-names></name><name><surname>Lamb</surname><given-names>A</given-names></name><name><surname>Ward</surname><given-names>JP</given-names></name><name><surname>Sidney</surname><given-names>J</given-names></name><name><surname>Blazquez</surname><given-names>AB</given-names></name><name><surname>Rech</surname><given-names>AJ</given-names></name><name><surname>Zaretsky</surname><given-names>JM</given-names></name><name><surname>Comin-Anduix</surname><given-names>B</given-names></name><name><surname>Ng</surname><given-names>AHC</given-names></name><name><surname>Chour</surname><given-names>W</given-names></name><name><surname>Yu</surname><given-names>TV</given-names></name><name><surname>Rizvi</surname><given-names>H</given-names></name><name><surname>Chen</surname><given-names>JM</given-names></name><name><surname>Manning</surname><given-names>P</given-names></name><name><surname>Steiner</surname><given-names>GM</given-names></name><name><surname>Doan</surname><given-names>XC</given-names></name><name><surname>Merghoub</surname><given-names>T</given-names></name><name><surname>Guinney</surname><given-names>J</given-names></name><name><surname>Kolom</surname><given-names>A</given-names></name><name><surname>Selinsky</surname><given-names>C</given-names></name><name><surname>Ribas</surname><given-names>A</given-names></name><name><surname>Hellmann</surname><given-names>MD</given-names></name><name><surname>Hacohen</surname><given-names>N</given-names></name><name><surname>Sette</surname><given-names>A</given-names></name><name><surname>Heath</surname><given-names>JR</given-names></name><name><surname>Bhardwaj</surname><given-names>N</given-names></name><name><surname>Ramsdell</surname><given-names>F</given-names></name><name><surname>Schreiber</surname><given-names>RD</given-names></name><name><surname>Schumacher</surname><given-names>TN</given-names></name><name><surname>Kvistborg</surname><given-names>P</given-names></name><name><surname>Defranoux</surname><given-names>NA</given-names></name><collab>Tumor Neoantigen Selection Alliance</collab></person-group><year iso-8601-date="2020">2020</year><article-title>Key parameters of tumor epitope immunogenicity revealed through a consortium approach improve neoantigen prediction</article-title><source>Cell</source><volume>183</volume><fpage>818</fpage><lpage>834</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2020.09.015</pub-id><pub-id pub-id-type="pmid">33038342</pub-id></element-citation></ref><ref id="bib93"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>K</given-names></name><name><surname>Yost</surname><given-names>KE</given-names></name><name><surname>Daniel</surname><given-names>B</given-names></name><name><surname>Belk</surname><given-names>JA</given-names></name><name><surname>Xia</surname><given-names>Y</given-names></name><name><surname>Egawa</surname><given-names>T</given-names></name><name><surname>Satpathy</surname><given-names>A</given-names></name><name><surname>Chang</surname><given-names>HY</given-names></name><name><surname>Zou</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>TCR-BERT: Learning the Grammar of T-Cell Receptors for Flexible Antigen-Xbinding Analyses</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.11.18.469186</pub-id></element-citation></ref><ref id="bib94"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yates</surname><given-names>AJ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Theories and quantification of thymic selection</article-title><source>Frontiers in Immunology</source><volume>5</volume><elocation-id>13</elocation-id><pub-id pub-id-type="doi">10.3389/fimmu.2014.00013</pub-id><pub-id pub-id-type="pmid">24550908</pub-id></element-citation></ref><ref id="bib95"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Deep transfer learning via restricted boltzmann machine for documentclassification</article-title><conf-name>In 2011 10th International Conference on Machine Learning and Applications and Workshops</conf-name></element-citation></ref><ref id="bib96"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>W</given-names></name><name><surname>Hawkins</surname><given-names>PG</given-names></name><name><surname>He</surname><given-names>J</given-names></name><name><surname>Gupta</surname><given-names>NT</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Choonoo</surname><given-names>G</given-names></name><name><surname>Jeong</surname><given-names>SW</given-names></name><name><surname>Chen</surname><given-names>CR</given-names></name><name><surname>Dhanik</surname><given-names>A</given-names></name><name><surname>Dillon</surname><given-names>M</given-names></name><name><surname>Deering</surname><given-names>R</given-names></name><name><surname>Macdonald</surname><given-names>LE</given-names></name><name><surname>Thurston</surname><given-names>G</given-names></name><name><surname>Atwal</surname><given-names>GS</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>A framework for highly multiplexed dextramer mapping and prediction of T cell receptor sequences to antigen specificity</article-title><source>Science Advances</source><volume>7</volume><elocation-id>eabf5835</elocation-id><pub-id pub-id-type="doi">10.1126/sciadv.abf5835</pub-id><pub-id pub-id-type="pmid">33990328</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec sec-type="appendix" id="s8"><title>Comparison of performance with existing tools</title><sec sec-type="appendix" id="s8-1"><title>DiffRBM model of antigen immunogenicity</title><p>We compared the discrimination performance of the diffRBM model of antigen immunogenicity to two established methods for immunogenicity prediction, the IEDB immunogenicity tool and PRIME (<xref ref-type="bibr" rid="bib72">Schmidt et al., 2021</xref>). Since these methods are not designed to be re-trained on custom datasets such as ours, the comparison cannot be fully consistent in terms of using the <italic>same</italic> training and test sets, as done for all the methods in <xref ref-type="fig" rid="fig4">Figure 4</xref>. The IEDB tool for immunogenicity prediction is based on the model by <xref ref-type="bibr" rid="bib12">Calis et al., 2013</xref> and can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://tools.iedb.org/immunogenicity/">http://tools.iedb.org/immunogenicity/</ext-link>. By applying it to our set of immunogenic and non-immunogenic peptides, we obtained AUC = 0.54 for the HLA-A*02:01-specific peptides, AUC = 0.60 for HLA-B*07:02 and AUC = 0.57 for HLA-B*35:01, which are all lower than the diffRBM average AUC values (respectively 0.66, 0.65, 0.67, see <xref ref-type="fig" rid="fig4">Figure 4</xref>).</p><p>PRIME (<xref ref-type="bibr" rid="bib72">Schmidt et al., 2021</xref>) was downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/GfellerLab/PRIME">https://github.com/GfellerLab/PRIME</ext-link> (<xref ref-type="bibr" rid="bib29">Gfeller, 2022</xref>). Since it was not possible to re-train PRIME on our datasets for a fair comparison of performance, we simply evaluated it on the set of immunogenic and non-immunogenic peptides we collected and we obtained a discrimination performance with AUC = 0.53 for peptides specific to HLA-A*02:01, AUC = 0.45 for HLA-B*07:02 and AUC = 0.56 for HLA-B*35:01. Since we set out to predict immunogenicity conditioned on binding to a given HLA allele, PRIME was run in the mono-allelic mode (<italic>e.g</italic>. with option <italic>-a A0201</italic> for the case of HLA-A*02:01); in general, however, different results are obtained by adding more alleles, where then the best presenting allele according to the predictor is taken. In summary, hence, we found poorer performance compared to the diffRBM units, despite not having excluded from our test sets the immunogenic peptides that are either in PRIME’s or in the IEDB tool’s training sets. Differences in the peptide datasets used may contribute to explain this result. For instance, our dataset consists of epitopes with experimentally validated positive T-cell responses from IEDB, mainly of microbial origin, while PRIME’s training set (<xref ref-type="bibr" rid="bib72">Schmidt et al., 2021</xref>) was constructed in such a way as to contain a high proportion of neoantigens.</p><p>As an additional point of comparison, (<xref ref-type="bibr" rid="bib67">Riley et al., 2019</xref>) propose a neural network trained in a supervised way to classify immunogenic against non-immunogenic peptides using sequence as well as structural features of the peptide/HLA complex. When they check the performance of a peptide sequence-only predictor (using nonamer HLA-A*02:01-restricted peptides), they obtain AUC = 0.61 on the training set and AUC = 0.50 on the test. This further confirms that the performance of our diffRBM approach, despite not being directly trained as a discriminator of immunogenic <italic>vs</italic> non-immunogenic peptides, compares favorably to existing sequence-based tools of prediction.</p></sec><sec sec-type="appendix" id="s8-2"><title>DiffRBM model of TCR specificity</title><p>To compare diffRBM to state-of-the-art predictors, we chose to take into consideration TCRex (<xref ref-type="bibr" rid="bib30">Gielis et al., 2019</xref>) and NetTCR-2.0 (<xref ref-type="bibr" rid="bib56">Montemurro et al., 2021</xref>), which were found to attain the best performance at predicting TCR specificity in a recent benchmark of different methods (<xref ref-type="bibr" rid="bib53">Meysman et al., 2022</xref>). TCRex is a random forest classifier of TCRs by epitope specificity. The most recent version is publicly accessible at <ext-link ext-link-type="uri" xlink:href="https://github.com/bittremieux/TCR-classifier">https://github.com/bittremieux/TCR-classifier</ext-link> (<xref ref-type="bibr" rid="bib22">De Neuter and Bittremieux, 2020</xref>), and can be used as described in <xref ref-type="bibr" rid="bib21">De Neuter et al., 2018</xref>. As a modification to the pipeline described in <xref ref-type="bibr" rid="bib21">De Neuter et al., 2018</xref>, we decided to skip the feature selection step (originally performed through the Boruta algorithm) after checking that the performance of the classification task is not affected by this choice in our case. NetTCR belongs to a family of methods (<xref ref-type="bibr" rid="bib82">Springer et al., 2020</xref>; <xref ref-type="bibr" rid="bib90">Weber et al., 2021</xref>; <xref ref-type="bibr" rid="bib54">Milighetti et al., 2021</xref>) trained on TCR-antigen pairs to predict a score of binding, but can also be applied to the prediction of whether an unseen TCR is likely to be specific to a given peptide target. In particular, NetTCR-2.0 (<xref ref-type="bibr" rid="bib56">Montemurro et al., 2021</xref>) is a convolutional neural network method trained from sets of pairs of peptides and cognate TCR sequences (β chain only or <inline-formula><mml:math id="inf179"><mml:mrow><mml:mi mathsize="80%">α</mml:mi><mml:mo mathsize="80%" stretchy="false">+</mml:mo><mml:mi mathsize="80%">β</mml:mi></mml:mrow></mml:math></inline-formula> chains). To make a fair comparison of performance, we re-trained these methods on our training sets and evaluated the AUC of discrimination of specific receptors on our test sets, considering their version for the β-chain only (section ‘Classification performance’).</p><p>To re-train and evaluate NetTCR-2.0 with our datasets, we replaced the sets of CDR3β specific to the 4 epitopes of interest with our VDJdb-derived datasets. We kept the other NetTCR training data (3 additional peptides with their specific CDR3β as well as their control data). Re-training NetTCR-2.0 with only the 4 epitope-specific sets of CDR3β we considered gave AUCs in the same range as for the case with 7 peptides. Our training of NetTCR-2.0 uses the same default settings as <xref ref-type="bibr" rid="bib56">Montemurro et al., 2021</xref>. While the performance of TCRex is the same as diffRBM (both with an average AUC across peptides of <inline-formula><mml:math id="inf180"><mml:mrow><mml:mn mathsize="80%">0.83</mml:mn><mml:mo mathsize="80%" stretchy="false">±</mml:mo><mml:mn mathsize="80%">0.01</mml:mn></mml:mrow></mml:math></inline-formula>, see <xref ref-type="fig" rid="fig6">Figure 6B–E</xref>), we observed a moderately lower performance of NetTCR-2.0 (AUC = <inline-formula><mml:math id="inf181"><mml:mrow><mml:mn mathsize="80%">0.73</mml:mn><mml:mo mathsize="80%" stretchy="false">±</mml:mo><mml:mn mathsize="80%">0.01</mml:mn></mml:mrow></mml:math></inline-formula>), which could be partially due to the fact that the CDR3β version of NetTCR-2.0 does not take as input the V and J genes. To check the role of including information on V and J, we also re-trained diffRBM using only the CDR3β amino acid sequence (<xref ref-type="fig" rid="fig6s4">Figure 6—figure supplement 4</xref>). The performance of the diffRBM units is reduced (AUC = <inline-formula><mml:math id="inf182"><mml:mrow><mml:mn mathsize="80%">0.79</mml:mn><mml:mo mathsize="80%" stretchy="false">±</mml:mo><mml:mn mathsize="80%">0.01</mml:mn></mml:mrow></mml:math></inline-formula>), but still higher than NetTCR-2.0. To test the susceptibility to predict false positives of diffRBM compared to state-of-the-art methods, we calculated also the Average Precision score (AP) and we obtained that diffRBM performs better or as well as the other methods across the 4 epitopes (GILGFVFTL: diffRBM has an average AP = 0.87 across the 50 training/test partitions, TCRex AP = 0.85, NetTCR-2.0 = 0.77; NLVPMVATV: diffRBM AP = 0.79, TCRex AP = 0.78, NetTCR-2.0 = 0.67; GLCTLVAML: diffRBM AP = 0.82, TCRex AP = 0.81, NetTCR-2.0 = 0.70; YLQPRTFLL: diffRBM AP = 0.99, TCRex AP = 0.99, NetTCR-2.0 = 0.89). Note it is at the task of distinguishing specific TCRs from background data that diffRBM compares in this way to state-of-the-art methods. The performance by diffRBM decreases when we consider as negatives receptors with a different antigen specificity (<xref ref-type="bibr" rid="bib53">Meysman et al., 2022</xref>), because the differential units can learn features shared between antigen-specific sequences (<italic>e.g</italic>., being expressed by CD8+T cells). More fine-tuned choices of the background (<italic>e.g</italic>., with only CD8+T cell receptors) would be needed to improve performance for this particular task.</p></sec></sec></app><app id="appendix-2"><title>Appendix 2</title><sec sec-type="appendix" id="s9"><title>Details on training diffRBM</title><p>Let us define a compact notation <inline-formula><mml:math id="inf183"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> for the set of parameters associated to the differential units, <inline-formula><mml:math id="inf184"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ξ</mml:mi><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf185"><mml:msubsup><mml:mi mathsize="80%">ξ</mml:mi><mml:msup><mml:mi mathsize="80%">μ</mml:mi><mml:mo mathsize="80%" stretchy="false">′</mml:mo></mml:msup><mml:mi mathsize="80%" mathvariant="normal">d</mml:mi></mml:msubsup></mml:math></inline-formula> is a shorthand for the parameters specifying the shape of <inline-formula><mml:math id="inf186"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">U</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> (see <xref ref-type="disp-formula" rid="equ5">Equation 5</xref> in Materials and methods). In all our implementations, both <inline-formula><mml:math id="inf187"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">U</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf188"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">U</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> are set to dReLU potentials, a choice that has been shown to confer high expressivity (<xref ref-type="bibr" rid="bib85">Tubiana et al., 2019</xref>). The rules to infer <inline-formula><mml:math id="inf189"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> are given by gradient-ascent equations to maximize the likelihood of the post-selection data <inline-formula><mml:math id="inf190"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> under the full RBM model (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>):<disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msup><mml:mi mathvariant="bold">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mfrac><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msup><mml:mi mathvariant="bold">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mfrac><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msup><mml:mi mathvariant="bold">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf191"><mml:msub><mml:mrow><mml:mo maxsize="80%" minsize="80%">⟨</mml:mo><mml:mo maxsize="80%" minsize="80%">⟩</mml:mo></mml:mrow><mml:mi mathsize="80%">m</mml:mi></mml:msub></mml:math></inline-formula> indicates the average under the full RBM model, <inline-formula><mml:math id="inf192"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi>f</mml:mi><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mn>1</mml:mn><mml:mi>Z</mml:mi></mml:mfrac><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>. Since the parameters <inline-formula><mml:math id="inf193"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> to learn appear only in <inline-formula><mml:math id="inf194"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, one has <inline-formula><mml:math id="inf195"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msup><mml:mi mathvariant="bold">Ψ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi mathvariant="normal">∂</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msup><mml:mi mathvariant="bold">Ψ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>; the contribution of the background <inline-formula><mml:math id="inf196"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> enters therefore only in the estimation of the average <inline-formula><mml:math id="inf197"><mml:msub><mml:mrow><mml:mo maxsize="80%" minsize="80%">⟨</mml:mo><mml:mo maxsize="80%" minsize="80%">⟩</mml:mo></mml:mrow><mml:mi mathsize="80%">m</mml:mi></mml:msub></mml:math></inline-formula>, which requires, at each step of the training, to sample configurations with the probability (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>).</p><p>Regularization terms are typically added during the training to control the values of the inferred parameters. Here we used a <inline-formula><mml:math id="inf198"><mml:msub><mml:mi mathsize="80%">L</mml:mi><mml:mn mathsize="80%">1</mml:mn></mml:msub></mml:math></inline-formula>-type regularization over the weights, which enforces sparsity to prevent overfitting (see <xref ref-type="bibr" rid="bib85">Tubiana et al., 2019</xref> for details); following the convention in <xref ref-type="bibr" rid="bib85">Tubiana et al., 2019</xref> we denote by <inline-formula><mml:math id="inf199"><mml:msubsup><mml:mi mathsize="80%">λ</mml:mi><mml:mn mathsize="80%">2</mml:mn><mml:mn mathsize="80%">1</mml:mn></mml:msubsup></mml:math></inline-formula> the coefficient setting the magnitude of such regularization term. Additional <inline-formula><mml:math id="inf200"><mml:msub><mml:mi mathsize="80%">L</mml:mi><mml:mn mathsize="80%">2</mml:mn></mml:msub></mml:math></inline-formula> regularization was imposed on the weigths, with amplitude <inline-formula><mml:math id="inf201"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> for background models and <inline-formula><mml:math id="inf202"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> for differential models (<xref ref-type="bibr" rid="bib17">Cocco et al., 2018</xref>).</p></sec></app><app id="appendix-3"><title>Appendix 3</title><sec sec-type="appendix" id="s10"><title>Alternative approaches tested</title><p>We compared diffRBM performance either to alternative architectures for differential models (diffRBM linear, PWM-based approach, SONIA) or to fully supervised, background-free models (classifiers).</p></sec><sec sec-type="appendix" id="s11"><title>DiffRBM linear</title><p>DiffRBM linear is a diffRBM architecture where the differential part is specified by single-site fields <inline-formula><mml:math id="inf203"><mml:mrow><mml:msubsup><mml:mi mathsize="80%">g</mml:mi><mml:mi mathsize="80%">i</mml:mi><mml:mi mathsize="80%" mathvariant="normal">d</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (without the addition of weights <inline-formula><mml:math id="inf204"><mml:mrow><mml:msubsup><mml:mi mathsize="80%">w</mml:mi><mml:mrow><mml:mi mathsize="80%">i</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathsize="80%">μ</mml:mi><mml:mo mathsize="80%" stretchy="false">′</mml:mo></mml:msup></mml:mrow><mml:mi mathsize="80%" mathvariant="normal">d</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>).</p></sec><sec sec-type="appendix" id="s12"><title>PWM-based approach</title><p>We considered a differential model based entirely on single-site amino frequency, where both the background model and the differential part are specified only by single-site fields (<inline-formula><mml:math id="inf205"><mml:mrow><mml:msubsup><mml:mi mathsize="80%">g</mml:mi><mml:mi mathsize="80%">i</mml:mi><mml:mi mathsize="80%" mathvariant="normal">b</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf206"><mml:mrow><mml:msubsup><mml:mi mathsize="80%">g</mml:mi><mml:mi mathsize="80%">i</mml:mi><mml:mi mathsize="80%" mathvariant="normal">d</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> respectively). The equations for learning <inline-formula><mml:math id="inf207"><mml:mrow><mml:msubsup><mml:mi mathsize="80%">g</mml:mi><mml:mi mathsize="80%">i</mml:mi><mml:mi mathsize="80%" mathvariant="normal">b</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf208"><mml:mrow><mml:msubsup><mml:mi mathsize="80%">g</mml:mi><mml:mi mathsize="80%">i</mml:mi><mml:mi mathsize="80%" mathvariant="normal">d</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are:<disp-formula id="equ16"><label>(16)</label><mml:math id="m16"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ17"><label>(17)</label><mml:math id="m17"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf209"><mml:mrow><mml:msubsup><mml:mi mathsize="80%">f</mml:mi><mml:mi mathsize="80%">i</mml:mi><mml:mi mathsize="80%" mathvariant="normal">b</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the frequency of amino acid <inline-formula><mml:math id="inf210"><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub></mml:math></inline-formula> at position <inline-formula><mml:math id="inf211"><mml:mi mathsize="80%">i</mml:mi></mml:math></inline-formula> in the background dataset <inline-formula><mml:math id="inf212"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf213"><mml:mrow><mml:msub><mml:mi mathsize="80%">f</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the frequency of amino acid <inline-formula><mml:math id="inf214"><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub></mml:math></inline-formula> at position <inline-formula><mml:math id="inf215"><mml:mi mathsize="80%">i</mml:mi></mml:math></inline-formula> in the dataset <inline-formula><mml:math id="inf216"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf217"><mml:mrow><mml:mi mathsize="80%">i</mml:mi><mml:mo mathsize="80%" stretchy="false">=</mml:mo><mml:mrow><mml:mn mathsize="80%">1</mml:mn><mml:mo mathsize="80%" stretchy="false">,</mml:mo><mml:mi mathsize="80%" mathvariant="normal">…</mml:mi><mml:mo mathsize="80%" stretchy="false">,</mml:mo><mml:mi mathsize="80%">N</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. We use the same <inline-formula><mml:math id="inf218"><mml:msub><mml:mi mathsize="80%">L</mml:mi><mml:mn mathsize="80%">2</mml:mn></mml:msub></mml:math></inline-formula> regularization penalty that we chosen for the RBM fields (<inline-formula><mml:math id="inf219"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> for background models and <inline-formula><mml:math id="inf220"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> for differential part). This approach is equivalent to learning from the background and selected datasets Position Weight Matrices (PWMs), probabilistic models of amino acid usage that treat all sequence positions as independent. By defining <inline-formula><mml:math id="inf221"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathsize="80%">P</mml:mi><mml:mi mathsize="80%">i</mml:mi><mml:mi mathsize="80%" mathvariant="normal">b</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow><mml:mo mathsize="80%" stretchy="false">=</mml:mo><mml:mrow><mml:msup><mml:mi mathsize="80%">e</mml:mi><mml:mrow><mml:msubsup><mml:mi mathsize="80%">g</mml:mi><mml:mi mathsize="80%">i</mml:mi><mml:mi mathsize="80%" mathvariant="normal">b</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo mathsize="80%" stretchy="false">/</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" mathsize="80%" stretchy="false" symmetric="true">∑</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub></mml:msub><mml:msup><mml:mi mathsize="80%">e</mml:mi><mml:mrow><mml:msubsup><mml:mi mathsize="80%">g</mml:mi><mml:mi mathsize="80%">i</mml:mi><mml:mi mathsize="80%" mathvariant="normal">b</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf222"><mml:mrow><mml:mrow><mml:msub><mml:mi mathsize="80%">P</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow><mml:mo mathsize="80%" stretchy="false">=</mml:mo><mml:mrow><mml:msup><mml:mi mathsize="80%">e</mml:mi><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathsize="80%">g</mml:mi><mml:mi mathsize="80%">i</mml:mi><mml:mi mathsize="80%" mathvariant="normal">b</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow><mml:mo mathsize="80%" stretchy="false">+</mml:mo><mml:mrow><mml:msubsup><mml:mi mathsize="80%">g</mml:mi><mml:mi mathsize="80%">i</mml:mi><mml:mi mathsize="80%" mathvariant="normal">d</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:msup><mml:mo mathsize="80%" stretchy="false">/</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" mathsize="80%" stretchy="false" symmetric="true">∑</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub></mml:msub><mml:msup><mml:mi mathsize="80%">e</mml:mi><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathsize="80%">g</mml:mi><mml:mi mathsize="80%">i</mml:mi><mml:mi mathsize="80%" mathvariant="normal">b</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow><mml:mo mathsize="80%" stretchy="false">+</mml:mo><mml:mrow><mml:msubsup><mml:mi mathsize="80%">g</mml:mi><mml:mi mathsize="80%">i</mml:mi><mml:mi mathsize="80%" mathvariant="normal">d</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and given the independent-site assumption of PWMs, the background data PWM probability and the selected data PWM probability are respectively recovered as <inline-formula><mml:math id="inf223"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf224"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. Since <inline-formula><mml:math id="inf225"><mml:mrow><mml:msubsup><mml:mi mathsize="80%">P</mml:mi><mml:mi mathsize="80%">i</mml:mi><mml:mi mathsize="80%" mathvariant="normal">b</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf226"><mml:mrow><mml:msub><mml:mi mathsize="80%">P</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are learnt to closely reproduce the frequencies <inline-formula><mml:math id="inf227"><mml:mrow><mml:msubsup><mml:mi mathsize="80%">f</mml:mi><mml:mi mathsize="80%">i</mml:mi><mml:mi mathsize="80%" mathvariant="normal">b</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf228"><mml:mrow><mml:msub><mml:mi mathsize="80%">f</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, their predictions are the ones that are inferable from single-site amino acid frequency alone in the respective training datasets (hence in <xref ref-type="fig" rid="fig2">Figure 2</xref>, <xref ref-type="fig" rid="fig5">Figure 5</xref>, <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>, <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>, <xref ref-type="fig" rid="fig5s3">Figure 5—figure supplement 3</xref> we refer to such predictions by ‘Amino-acid frequency’). For a sequence <inline-formula><mml:math id="inf229"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, the score based on the differential part is then simply given by the log-likelihood ratio:<disp-formula id="equ18"><label>(18)</label><mml:math id="m18"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>measuring the site-specific enrichment in amino-acid usage in selected data compared to the background.</p></sec><sec sec-type="appendix" id="s13"><title>SONIA</title><p>We implemented a SONIA model using the software package from <xref ref-type="bibr" rid="bib37">Isacchini et al., 2021</xref> and setting the option <italic>deep = False</italic>. For consistency with the background of diffRBM, we first learn a background model from 10<sup>6</sup> randomly assembled from the universal donor repertoire from <xref ref-type="bibr" rid="bib25">Emerson et al., 2017</xref>, next we learn a model from epitope-specific repertoires and we take, as SONIA score, the difference between the scores assigned by these two models. The <inline-formula><mml:math id="inf230"><mml:msub><mml:mi mathsize="80%">L</mml:mi><mml:mn mathsize="80%">2</mml:mn></mml:msub></mml:math></inline-formula>-type regularization strength is set to the default value (zero); higher regularizations applied to one of our test sets did not provide visible improvement of the log-likelihood.</p></sec><sec sec-type="appendix" id="s14"><title>Classifier of immunogenic peptides</title><p>As a term of comparison for the immunogenicity model, we implemented first a linear (logistic) classifier (see Model C1 in <xref ref-type="fig" rid="fig4s5">Figure 4—figure supplement 5C</xref>), which we trained by minimization of a binary cross-entropy loss. To find an optimal classifier, we also searched among different neural-network architectures trained to discriminate the immunogenic and non-immunogenic data retrieved from IEDB (section ‘Sequence datasets for the immunogenicity model’). We used the same 50 validation sets held out from the training set of immunogenic, HLA-A*02:01-presented peptides utilized for the model selection of diffRBM (section ‘DiffRBM training and model selection’). In an analogous way, we randomly partitioned the set of non-immunogenic, HLA-A*02:01-presented peptides into training/test sets (with respectively 80%/20% of the data), repeating the partition 50 times, and we further partitioned the training sets to hold out at each repetition a validation set with 20% of sequences. We trained the models varying the number and width of hidden layers (<xref ref-type="fig" rid="fig4s5">Figure 4—figure supplement 5C</xref>), as well as the weight decay. The ‘optimal classifier’ performance for HLA-A*02:01 (<xref ref-type="fig" rid="fig4">Figure 4</xref>) is obtained by selecting for each partition the best performing architecture on the validation set and evaluating its AUC on the test set. Next, we identified the architecture giving the maximal average AUC of discrimination between the immunogenic and non-immunogenic peptides in the validation sets (Model C8 in <xref ref-type="fig" rid="fig4s5">Figure 4—figure supplement 5C</xref>) and we used it to estimate the ‘optimal classifier’ average AUC for the HLA-B*07:02 and HLA-B*35:01 models (<xref ref-type="fig" rid="fig4">Figure 4C–D</xref>). Our numerical implementation is based on the PyTorch library. Training is performed in mini-batches of 64 sequences, by the AdamW optimizer with weight decay (<xref ref-type="bibr" rid="bib44">Loshchilov and Hutter, 2019</xref>), learning rate 0.001, for 500 epochs.</p></sec><sec sec-type="appendix" id="s15"><title><inline-formula><mml:math id="inf231"><mml:mi>k</mml:mi></mml:math></inline-formula>-NN based classifier</title><p>In <xref ref-type="bibr" rid="bib90">Weber et al., 2021</xref> a <inline-formula><mml:math id="inf232"><mml:mi mathsize="80%">k</mml:mi></mml:math></inline-formula>-Nearest Neighbours (<inline-formula><mml:math id="inf233"><mml:mi mathsize="80%">k</mml:mi></mml:math></inline-formula>-NN) classifier served as a baseline method to determine the predictive power achievable from TCR sequence similarity alone and, despite its simplicity, it was found to outperform some existing methods. Thus, following <xref ref-type="bibr" rid="bib90">Weber et al., 2021</xref>, we built a <inline-formula><mml:math id="inf234"><mml:mi mathsize="80%">k</mml:mi></mml:math></inline-formula>-Nearest Neighbours (<inline-formula><mml:math id="inf235"><mml:mi mathsize="80%">k</mml:mi></mml:math></inline-formula>-NN) based classifier to distinguish TCRs recognizing a specific antigen from generic ones. The method works by computing the Levenshtein distance of the CDR3β under analysis with respect to a set of positive examples (training set of antigen-specific CDR3β) and to a set of negative examples (training set of bulk repertoire CDR3β). In the computation of the Levenshtein distance, the V and J segments are used as well (different V or J segments increase the distance by 1). Next the average distances from the <inline-formula><mml:math id="inf236"><mml:mi mathsize="80%">k</mml:mi></mml:math></inline-formula> nearest neighbours are computed for both the positive and negative examples, and a score is computed as the difference between the two average distances.</p><p>The only parameter of this model, <inline-formula><mml:math id="inf237"><mml:mi mathsize="80%">k</mml:mi></mml:math></inline-formula>, has been fixed for the largest dataset of positive examples (TCRs reactive to the NLVPMVATV peptide) by cross-validation. We split the positive and negative data in 50 independent training and test sets (with respectively 80% and 20% of the sequences); from each training set, a portion of 20% of its data is held out as validation set. Next <inline-formula><mml:math id="inf238"><mml:mi mathsize="80%">k</mml:mi></mml:math></inline-formula>, for each partition, is fixed by maximizing the model performance on the validation set, and the model with the best <inline-formula><mml:math id="inf239"><mml:mi mathsize="80%">k</mml:mi></mml:math></inline-formula> is evaluated on the test set. For the other datasets of positive examples, which are smaller, we used <inline-formula><mml:math id="inf240"><mml:mrow><mml:mi mathsize="80%">k</mml:mi><mml:mo mathsize="80%" stretchy="false">=</mml:mo><mml:mn mathsize="80%">26</mml:mn></mml:mrow></mml:math></inline-formula>, obtained as the <inline-formula><mml:math id="inf241"><mml:mi mathsize="80%">k</mml:mi></mml:math></inline-formula> for which the average AUC on the validation set is maximal (<xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3</xref>). The performance of the <inline-formula><mml:math id="inf242"><mml:mi mathsize="80%">k</mml:mi></mml:math></inline-formula>-NN based classifier was evaluated as described in section ‘Classification performance’.</p></sec><sec sec-type="appendix" id="s16"><title>Single-site factors for the alternative approaches</title><p>As a term of comparison of diffRBM single-site factors (<xref ref-type="disp-formula" rid="equ11">Equation 11</xref> in Materials and methods), we considered single-site factors from the diffRBM linear model <inline-formula><mml:math id="inf243"><mml:mrow><mml:mrow><mml:msub><mml:mi mathsize="80%">T</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow><mml:mo mathsize="80%" stretchy="false">=</mml:mo><mml:mrow><mml:msubsup><mml:mi mathsize="80%">g</mml:mi><mml:mi mathsize="80%">i</mml:mi><mml:mi mathsize="80%" mathvariant="normal">d</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3A–B</xref>, <xref ref-type="fig" rid="fig5s3">Figure 5—figure supplement 3A–B</xref>), and from models which assume all positions independent (section ‘PWM-based approach’). Here the single-site factors reduce to the log-likelihood ratio:<disp-formula id="equ19"><label>(19)</label><mml:math id="m19"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where that <inline-formula><mml:math id="inf244"><mml:mrow><mml:msub><mml:mi mathsize="80%">P</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf245"><mml:mrow><mml:msubsup><mml:mi mathsize="80%">P</mml:mi><mml:mi mathsize="80%">i</mml:mi><mml:mi mathsize="80%" mathvariant="normal">b</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are given by PWMs (section ‘PWM-based approach’) and hence represent position-specific amino acid frequencies. In the case of the immunogenicity model, the prediction by <xref ref-type="disp-formula" rid="equ19">Equation 19</xref> simply describes the log ratio between the frequency of amino acids in immunogenic peptides relative to the amino acid frequency of all presented peptides from the background dataset (we refer to it as ‘AA frequency ratio (to all presented)’, see <xref ref-type="fig" rid="fig2">Figure 2C–D</xref>); in the case of the TCR specificity model <xref ref-type="disp-formula" rid="equ19">Equation 19</xref> gives the log ratio between the frequency of amino acids in peptide-specific CDR3β repertoires relative to the amino acid frequency in bulk repertoire (we refer to it as ‘AA frequency ratio (to bulk)’, see <xref ref-type="fig" rid="fig5">Figure 5B–C</xref>). In both cases the prediction indicated as ‘Amino acid frequency’ is obtained by estimating and ranking the single-site factors:<disp-formula id="equ20"><label>(20)</label><mml:math id="m20"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>In the case of the immunogenicity model, we have also learnt an independent-site model from non-immunogenic data (that we call <inline-formula><mml:math id="inf246"><mml:mrow><mml:msup><mml:mi mathsize="80%">P</mml:mi><mml:mi mathsize="80%">NI</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) and we have looked at the single-site factors:<disp-formula id="equ21"><label>(21)</label><mml:math id="m21"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>which represents a log ratio of amino acid frequency in immunogenic data relative to non-immunogenic data (this prediction is labeled ‘AA frequency ratio (to non-immunogenic)’ in <xref ref-type="fig" rid="fig2">Figure 2C–D</xref> and <xref ref-type="fig" rid="fig3">Figure 3B</xref>). To identify the sites of binding to the HLA, we took first single-site factors simply capturing amino acid usage in presented peptides defined as:<disp-formula id="equ22"><label>(22)</label><mml:math id="m22"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>and labeled as ‘Amino Acid Frequency’ in <xref ref-type="fig" rid="fig2">Figure 2B</xref> and <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>. Next we looked at the parameters of background RBM by defining single-site factors that correspond essentially to the model’s log probability of residue <inline-formula><mml:math id="inf247"><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub></mml:math></inline-formula> conditional on the rest of the residues:<disp-formula id="equ23"><label>(23)</label><mml:math id="m23"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munderover><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo fence="false" stretchy="false">⟩</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We also considered a less refined version including only the fields of the background RBM model (hence not accounting for the interaction with the rest of the sequence sites):<disp-formula id="equ24"><label>(24)</label><mml:math id="m24"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>and we observed that this fields-only prediction performs slightly better at identifying the anchor sites of binding to the HLA compared to the full RBM prediction (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4A–B</xref>). Indeed, the background RBM weights tend also to capture amino acid differences at the peptide’s central positions, which are likely to reflect the existence of variable peptide conformations within the binding pocket (<xref ref-type="bibr" rid="bib58">Nguyen et al., 2021</xref>). A case in point was discussed in <xref ref-type="bibr" rid="bib7">Bravi et al., 2021b</xref>, where we found that the weights of a single-allele RBM presentation model captured different modes of binding across peptides of the same HLA specificity. This would help explain why fields alone perform slightly better as predictors of the primary anchor sites of binding to the HLA, and in <xref ref-type="fig" rid="fig2">Figure 2B</xref> we use the single-site factors from a fields-only RBM model as predictors. Anyway the prediction by a full RBM model (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4A–B</xref>) exhibits only a minimal decrease in performance compared to the fields-only prediction, due to the weights-related effects being mainly second-order ones.</p><p>Finally, we have explored an alternative, more general measure of site-specific amino acid importance from the differential units:<disp-formula id="equ25"><label>(25)</label><mml:math id="m25"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>q</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:munderover><mml:msup><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf248"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is the differential units’ score of the sequence <inline-formula><mml:math id="inf249"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> where position <inline-formula><mml:math id="inf250"><mml:mi mathsize="80%">i</mml:mi></mml:math></inline-formula> has been mutated from <inline-formula><mml:math id="inf251"><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub></mml:math></inline-formula> to <inline-formula><mml:math id="inf252"><mml:msubsup><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi><mml:mo mathsize="80%" stretchy="false">′</mml:mo></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="inf253"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is calculated using <xref ref-type="disp-formula" rid="equ10">Equation 10</xref> in Materials and methods and <inline-formula><mml:math id="inf254"><mml:mi mathsize="80%">q</mml:mi></mml:math></inline-formula> is the number of values that <inline-formula><mml:math id="inf255"><mml:msubsup><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi><mml:mo mathsize="80%" stretchy="false">′</mml:mo></mml:msubsup></mml:math></inline-formula> can take. <inline-formula><mml:math id="inf256"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathsize="80%">T</mml:mi><mml:mo mathsize="80%" stretchy="false">~</mml:mo></mml:mover><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> can be hence seen as a measure of the importance of amino acid <inline-formula><mml:math id="inf257"><mml:msub><mml:mi mathsize="80%">σ</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub></mml:math></inline-formula> at position <inline-formula><mml:math id="inf258"><mml:mi mathsize="80%">i</mml:mi></mml:math></inline-formula> obtained by comparing its contribution to the likelihood to the one of all other possible <inline-formula><mml:math id="inf259"><mml:mi mathsize="80%">q</mml:mi></mml:math></inline-formula> amino acids. The diffRBM single-site factors (<xref ref-type="disp-formula" rid="equ11">Equation 11</xref> in Materials and methods) can be derived as a small-weight approximation of the more general definition (<xref ref-type="disp-formula" rid="equ25">Equation 25</xref>), whose advantage is that per se does not depend on the RBM structure of the probability <inline-formula><mml:math id="inf260"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. Overall, at the numerical level, the predictions of contacts obtained by ranking sites by <xref ref-type="disp-formula" rid="equ25">Equation 25</xref> are comparable to the ones by <xref ref-type="disp-formula" rid="equ11">Equation 11</xref>, see <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3A–B</xref>, <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4A–B</xref>, <xref ref-type="fig" rid="fig5s3">Figure 5—figure supplement 3A–B</xref>.</p></sec></app><app id="appendix-4"><title>Appendix 4</title><sec sec-type="appendix" id="s17"><title>Entropy estimation</title><p>The entropies of background RBM and full RBM (<xref ref-type="fig" rid="app4fig1">Appendix 4—figure 1A–B</xref>) were estimated as:<disp-formula id="equ26"><label>(26)</label><mml:math id="m26"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtext>Background RBM:</mml:mtext><mml:mspace width="1em"/><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mtext>Full RBM:</mml:mtext><mml:mspace width="1em"/><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf261"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf262"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> are given respectively by <xref ref-type="disp-formula" rid="equ1 equ2">Equations 1 and 2</xref> in Materials and methods. The <inline-formula><mml:math id="inf263"><mml:mi mathsize="80%">log</mml:mi></mml:math></inline-formula> is meant as a natural logarithm, hence the entropy values in <xref ref-type="fig" rid="app4fig1">Appendix 4—figure 1A–B</xref> are expressed in nats. To estimate the entropy of PWM-based approaches (<xref ref-type="fig" rid="app4fig1">Appendix 4—figure 1C</xref>), we used <xref ref-type="disp-formula" rid="equ26">Equation 26</xref> with PWM probabilities for <inline-formula><mml:math id="inf264"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf265"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> (see section ‘PWM-based approach’, Appendix 3).</p><fig id="app4fig1" position="float"><label>Appendix 4—figure 1.</label><caption><title>Model-based entropy estimation.</title><p>(<bold>A</bold>) Entropy (expressed in nats) of the space of HLA-specific presented antigens (evaluated by background RBM) and of HLA-specific immunogenic antigens (evaluated by the full RBM) for the 3 HLAs. Error bars represent the sampling-related uncertainty on the estimated entropy and was calculated as in <xref ref-type="bibr" rid="bib50">Marchi et al., 2019</xref>. (<bold>B</bold>) The entropy of the background dataset (CDR3 bulk repertoire) obtained from background RBM is compared to the entropy of epitope-specific CDR3 obtained from the full RBM models of TCR specificity to GILGFVFTL, NLVPMVATV, GLCTLVAML and YLQPRTFLL. (<bold>C</bold>) The entropies calculated from background RBM and the full RBM plotted in A and B is lower than the one estimated from independent-site models of the same data (Entropy PWM), because RBM models can account for correlations between sequence sites, hence for additional constraints on sequence diversity. (Colors are the same as in <bold>A, B</bold>). The entropy values from RBM and PWM models show a highly correlated trend across datasets, reflecting their different degree of heterogeneity in amino acid composition, as shown by the sequence logos of peptide (<bold>D</bold>) and CDR3 (<bold>E</bold>) data we considered.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85126-app4-fig1-v2.tif"/></fig></sec></app></app-group></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.85126.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Bitbol</surname><given-names>Anne-Florence</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02s376052</institution-id><institution>Ecole Polytechnique Federale de Lausanne (EPFL)</institution></institution-wrap><country>Switzerland</country></aff></contrib></contrib-group><related-object id="sa0ro1" object-id-type="id" object-id="10.1101/2022.12.06.519259" link-type="continued-by" xlink:href="https://sciety.org/articles/activity/10.1101/2022.12.06.519259"/></front-stub><body><p>In this important work, the authors present a sequence-based approach using transfer learning and Restricted Boltzmann Machines to predict antigen immunogenicity and specificity. The evidence and methodology are compelling. This work should be of interest to immunologists, computational biologists, and biophysicists.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.85126.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Bitbol</surname><given-names>Anne-Florence</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02s376052</institution-id><institution>Ecole Polytechnique Federale de Lausanne (EPFL)</institution></institution-wrap><country>Switzerland</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>Our editorial process produces two outputs: (i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2022.12.06.519259">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2022.12.06.519259v1">the preprint</ext-link> for the benefit of readers; (ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Learning the differences: a transfer-learning approach to predict antigen immunogenicity and T-cell receptor specificity&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Naama Barkai as the Senior Editor. The reviewers have opted to remain anonymous.</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>1) Please streamline the manuscript, which is very complete and rigorous, but also quite long and sometimes intricate. In particular:</p><p>– In the Discussion, please emphasize the main conclusions regarding the performance of the method, by concisely explaining for the general reader in what cases it is better than existing methods and what new insights it can provide for immunology (see also Reviewer #1 and Reviewer #3's comments about this).</p><p>– The various comparisons to other methods are definitely important and useful, but they sometimes obscure the main points of the paper. We advise to state the conclusions of the various comparisons to other methods in the main text, but to put some of the details of these analyses in Supplement (see also Reviewer #2's comment about this).</p><p>2) Please consider including comparisons to transfer learning methods, as advised by Reviewer #3. If feasible, comparisons to general transfer learning tools would be interesting and could strengthen the evidence for broad applicability. If these comparisons are not feasible, please explain why.</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>General Questions</p><p>I will provide here some general questions that if addressed could, in my opinion, help improve the clarity of this article.</p><p>1. I found the formulation aimed to disentangle the background from selected features really interesting. The way the learning is done is that both datasets are known a priori and then the learning happens sequentially. But what if the datasets where the two generic and specific features are mixed? How would the learning happen in this case? If DiffRBM cannot be used in this situation then it is ok, but it would be good to discuss it as a limitation.</p><p>2. The paper mentions that the learning happened in an HLA-specific approach. Although advantages and disadvantages are presented throughout the paper, it would be good to address this important distinction in the discussion.</p><p>3. Although I understand this article's main goal is to present a technical solution to specific phenomena in immunology, after reading the manuscript I felt that more specific direct applications should have been discussed. How can the scientific community, take this approach that has been extensively validated and compared and translate it into potential therapeutic or scientific applications?</p><p>4. When describing contact prediction and the ranking of peptide positions, the result seemed quite encouraging, however, when one deals with such a small dataset (6-9 positions) then statistical significance becomes a relevant question. Can the authors also discuss this in the presentation of the results? This might help prove a more realistic representation of the predictive qualities of this side of DiffRBM.</p><p>5. In Figure 3G the authors estimate the mutational cost of peptides compared to experimental measures. The correlation although significant seems low to me r=0.47. Can the authors comment if this is a limitation or if in fact, other methods cannot reach better correlations than the one presented using DiffRBM?</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>The authors propose a novel model architecture called diffRBM, which is based on the original RBM papers [Hinton, 2002, Hinton and Salakhutdinov, 2006], by adding separate background and differential units and a specific training procedure, as described in section 5.1, opening a possibility to use this model for the transfer of learning.</p><p>To be interesting to the wide readership of <italic>eLife</italic> this paper should show novelty both in terms of the biology it describes and the(AI transfer of learning) tools. Especially as the tool's novelty is emphasized by the authors.</p><p>While the paper is very long and detailed it is still a bit unclear to us why other than being novel in its AI methods it is better or more revealing than existing (also non-AI) methods in terms of our understanding of TCR immunology.</p><p>We also have the following questions about the methodology:</p><p>1. Since it is a novel transfer of learning method, we would like to see a general comparison of this method with other transfer of learning methods on standard benchmarks, not only on the immunological data. Authors claim in section 2 that &quot;… it could be applied to any data that has some distinctive features compared to a much larger pool of data endowed with the baseline properties&quot;. We also believe that such a method could be useful to a broader community of researchers. Also, by performing a comparison on standard benchmarks, the novelty of diffRBM could be highlighted more clearly, since it will be certain whether this model consistently achieves state-of-the-art results or not.</p><p>We suggest two directions:</p><p>1.1 Performing a comparison to the classical transfer of learning and domain adaptation papers, that provide generally good transfer of learning methods, used by a broad research community. Such papers also talk about the transfer of learning benchmark datasets. While most of the datasets are about image data, text-based datasets, more closely resembling biological data, can be found as well in related papers.</p><p>An example classical paper:</p><p>Adversarial Discriminative Domain Adaptation, Eric Tzeng et. al</p><p>1.2. Performing a comparison to the more recent transfer of learning and domain adaptation papers. While it is up to the authors to analyze and define the scope of applicability of the proposed diffRBM model, we can suggest selecting some of the recent papers and benchmark datasets from the links: https://paperswithcode.com/task/domain-adaptation; https://paperswithcode.com/sota/domain-adaptation-on-visda2017. Same comment about closeness to biological data is applicable here as well: it may be necessary to find more specific standard datasets, closely resembling the biological data, if diffRBM is supposed to work well specifically on such data domains.</p><p>2. On the other hand, when applied to immunological data (that is described in the paper), we also would like to see more models from the classical and recent transfer of learning papers to be compared to. So if applicable, adding classical and recent transfer of learning models from the above links to the comparison would be beneficial.</p><p>Note: If in fact, diffRBM is not widely applicable beyond specific immunological/sequence data – it would be nice to see a detailed analysis as to what properties of the immunological data make diffRBM applicable to it, and not to other data.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.85126.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) Please streamline the manuscript, which is very complete and rigorous, but also quite long and sometimes intricate. In particular:</p><p>– In the Discussion, please emphasize the main conclusions regarding the performance of the method, by concisely explaining for the general reader in what cases it is better than existing methods and what new insights it can provide for immunology (see also Reviewer #1 and Reviewer #3's comments about this).</p></disp-quote><p>We have re-written several paragraphs in the discussion, addressing directly the advantages and limitations of our approach compared to other methods, explaining the type of insights and predictions they can provide, and mentioning a few related applications in the biomedical context. We have also divided the discussion into small sections. Following Reviewer 1’s comments, we now make clear that diffRBM, contrary to most existing methods, needs only positive examples for its training, and is thus ‘semi-supervised’.</p><disp-quote content-type="editor-comment"><p>– The various comparisons to other methods are definitely important and useful, but they sometimes obscure the main points of the paper. We advise to state the conclusions of the various comparisons to other methods in the main text, but to put some of the details of these analyses in Supplement (see also Reviewer #2's comment about this).</p></disp-quote><p>We have significantly shortened the sections devoted to the comparison to other methods, and moved the details to the Appendix (‘Appendix 1 – Comparison of performance with existing tools’). This SI section also includes details on our implementation of TCRex and NetTCR. We have also moved the summary on state-of-the-art methods to the Introduction (lines 43-62) to improve the readability of the Results section.</p><p>We have streamlined the sections ‘Validation of model predictions against TCR-pMHC structures’ and ‘DiffRBM encodes molecular features of immunogenicity’. We have also shortened the Methods, adding Appendix 2, 3, 4 where we have moved details on diffRBM training, estimation of single-site factors and entropies and the description of the alternative approaches tested.</p><p>While a few paragraphs have been rephrased to be more concise, or moved to the Appendix as we said, we have highlighted in a different colour (red) only the sentences that were added or modified to address questions by the referees.</p><disp-quote content-type="editor-comment"><p>2) Please consider including comparisons to transfer learning methods, as advised by Reviewer #3. If feasible, comparisons to general transfer learning tools would be interesting and could strengthen the evidence for broad applicability. If these comparisons are not feasible, please explain why.</p></disp-quote><p>We explain in detail in response to Reviewer 3 why we believe these comparisons can be confusing. In short, a fair comparison of methods that were developed for different purposes is challenging, while comparing them on other datasets requires careful data curation and experimental setups. We explain these points in detail below.</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>General Questions</p><p>I will provide here some general questions that if addressed could, in my opinion, help improve the clarity of this article.</p><p>1. I found the formulation aimed to disentangle the background from selected features really interesting. The way the learning is done is that both datasets are known a priori and then the learning happens sequentially. But what if the datasets where the two generic and specific features are mixed? How would the learning happen in this case? If DiffRBM cannot be used in this situation then it is ok, but it would be good to discuss it as a limitation.</p></disp-quote><p>We thank the reviewer for this interesting remark, we have added a sentence to comment on this point in the discussion (lines 532-535). In summary, the set up analyzed here is not designed to deal with these situations, but we think that some minimal modification of the framework would already be useful in this regard (e.g. allowing a kind of ‘parallel’ learning, where the learning of the background model not only informs the learning of the differential units, but also receives feedback from them).</p><disp-quote content-type="editor-comment"><p>2. The paper mentions that the learning happened in an HLA-specific approach. Although advantages and disadvantages are presented throughout the paper, it would be good to address this important distinction in the discussion.</p></disp-quote><p>We agree with the reviewer that this is a point worth covering again in the discussion, we have added a couple of sentences (lines 462-465).</p><disp-quote content-type="editor-comment"><p>3. Although I understand this article's main goal is to present a technical solution to specific phenomena in immunology, after reading the manuscript I felt that more specific direct applications should have been discussed. How can the scientific community, take this approach that has been extensively validated and compared and translate it into potential therapeutic or scientific applications?</p></disp-quote><p>We agree that this point deserves additional comments in the discussion. We have therefore added a short section on the potential applications of the method (vaccine design, cancer neoantigen discovery, TCR engineering, detection of immunoediting in cancer and immune evasion in viral evolution), see lines 505-508.</p><p>We have also expanded the discussion of the advantages and limitations of the method, in such a way that it becomes clearer in what cases it is convenient to use it (like the fact that the method is generative, sequence-based and parsimonious in terms of training data, see lines 468-497).</p><disp-quote content-type="editor-comment"><p>4. When describing contact prediction and the ranking of peptide positions, the result seemed quite encouraging, however, when one deals with such a small dataset (6-9 positions) then statistical significance becomes a relevant question. Can the authors also discuss this in the presentation of the results? This might help prove a more realistic representation of the predictive qualities of this side of DiffRBM.</p></disp-quote><p>We have derived an estimate of the statistical significance of our PPV values using a binomial test (as explained in the Methods, lines 784-793). The p-values are reported in the main text (lines 208-209, 396-397). At the same lines we have also emphasized more clearly in the text that the difference of our prediction with respect to the random expectation curve is statistically significant.</p><disp-quote content-type="editor-comment"><p>5. In Figure 3G the authors estimate the mutational cost of peptides compared to experimental measures. The correlation although significant seems low to me r=0.47. Can the authors comment if this is a limitation or if in fact, other methods cannot reach better correlations than the one presented using DiffRBM?</p></disp-quote><p>The correlation coefficient we find is not high but it is statistically significant (see the p-values provided in Figure 3 —figure supplement 1B). We look at this correlation not with the purpose of showing the predictive power per se of our presentation model (background RBM), but rather to support our hypothesis that these mutation costs, which are mutation costs measured by TCR avidity curves, reflect also an effect of disruption of presentation. In fact, these mutation costs are measured in terms of loss of TCR recognition, and therefore are expected to be predicted by a presentation model alone to a first approximation only (we should instead expect a higher correlation if one had measured the change in HLA-peptide binding). As an additional check, we have measured the same correlation coefficients using the predicted mutation costs by NetMHCpan4.1 (an established predictor of antigen presentation): also in this case, we find that their value is not particularly high (0.52 for TCR1, 0.45 for TCR2 and 0.66 for TCR3).</p><p>We have better clarified this point by rephrasing the sentences at lines 272-276.</p><disp-quote content-type="editor-comment"><p>Reviewer #3 (Recommendations for the authors):</p><p>The authors propose a novel model architecture called diffRBM, which is based on the original RBM papers [Hinton, 2002, Hinton and Salakhutdinov, 2006], by adding separate background and differential units and a specific training procedure, as described in section 5.1, opening a possibility to use this model for the transfer of learning.</p><p>To be interesting to the wide readership of eLife this paper should show novelty both in terms of the biology it describes and the(AI transfer of learning) tools. Especially as the tool's novelty is emphasized by the authors.</p><p>While the paper is very long and detailed it is still a bit unclear to us why other than being novel in its AI methods it is better or more revealing than existing (also non-AI) methods in terms of our understanding of TCR immunology.</p><p>We also have the following questions about the methodology:</p><p>1. Since it is a novel transfer of learning method, we would like to see a general comparison of this method with other transfer of learning methods on standard benchmarks, not only on the immunological data. Authors claim in section 2 that &quot;… it could be applied to any data that has some distinctive features compared to a much larger pool of data endowed with the baseline properties&quot;. We also believe that such a method could be useful to a broader community of researchers. Also, by performing a comparison on standard benchmarks, the novelty of diffRBM could be highlighted more clearly, since it will be certain whether this model consistently achieves state-of-the-art results or not.</p><p>2. On the other hand, when applied to immunological data (that is described in the paper), we also would like to see more models from the classical and recent transfer of learning papers to be compared to. So if applicable, adding classical and recent transfer of learning models from the above links to the comparison would be beneficial.</p></disp-quote><p>We have decided not to carry out the comparisons to other data and to other transferlearning approaches suggested by the reviewer 3, because they might be not pertinent and largely outside the scope of our work for several reasons, summarizable as follows:</p><list list-type="order"><list-item><p>Additional comparisons would not be fair and consistent in terms of tasks, and would not serve to strengthen our main message;</p></list-item><list-item><p>Additional comparisons do not fit the stated purpose of our work;</p></list-item><list-item><p>We do already have comparisons to similar methods when it is feasible, consistent in terms of type of task, and relevant;</p></list-item><list-item><p>Additional comparisons require an amount of work that would justify separate papers.</p></list-item></list><p>We now elaborate more on each of these reasons.</p><list list-type="order"><list-item><p>Additional comparisons would not be fair and consistent in terms of tasks, and would not serve to strengthen our main message. Many machine learning papers on transfer learning and domain adaptation focus on obtaining domain-invariant representations and portability of methods across domains, which are not the tasks we are interested in here. Since these methods were developed for other purposes, the comparisons we would carry out would neither be fair, nor consistent in terms of tasks for which the different methods are optimized.</p></list-item></list><p>Our main message is that by learning the statistical differences between ‘background' and biologically selected data we can obtain insight into selected biological features, in particular the enriched molecular motifs in immunogenic antigens and epitope-specific receptors. The model parameters learnt in such a way as to capture such statistical differences allow us to extract biologically interpretable predictions, like contact sites, mutation costs in terms of TCR reactivity, patterns of enrichment in certain biological properties. The typical transfer-learning task of designing domain-invariant representations goes in a different direction, thus, even if we compared to other methods from the field of domain adaptation, the result would not help us illustrate these points.</p><list list-type="order"><list-item><p>Additional comparisons do not fit the stated purpose of our work. This work is not meant to be a purely machine learning paper, our focus on the inspection and extraction of biologically interpretable features in an immunological context is pivotal. We are not putting forward claims on diffRBM being a better transfer-learning method than other ones in general, and it is not our aim to compete with them. Rather, the novelty of our approach relies on the idea of using transfer-learning for these two specific problems (modeling antigen immunogenicity and T-cell receptor specificity).</p></list-item><list-item><p>We do already have comparisons to similar methods when it is feasible, consistent in terms of type of task, and relevant. In terms of model performance, we already have the comparison to the most established predictors in both fields (prediction of antigen immunogenicity and TCR specificity). Importantly, these comparisons already include the existing transfer-learning methods in T-cell receptor modeling: one of them is SONIA [Elhanati et al., 2014, Sethna et al., 2020], to which we compare diffRBM explicitly by training and testing it on our same dataset. Another one is TITAN [Weber et al., 2021], that exploits a pre-training on general protein-protein interactions data to build a model of TCR-epitope binding. Since in a recent benchmark of different methods [Meysman et al., 2022] TITAN performed slightly worse than TCRex and NetTCR , we decided to include explicitly the comparison only with TCRex and NetTCR (the most performant methods to date). Given that diffRBM can perform as well as TCRex and NetTCR at the task of distinguishing specific from generic receptors from the background dataset, the results in [Meysman et al., 2022] suggest that diffRBM would compare favorably also to the other methods tested including TITAN. Hence our work uses previously done benchmarks to identify the best methods with which it is sensible to compare. In connection to modeling antigen immunogenicity, we are not aware of transfer-learning methods. One of the methods we consider for comparison (the IEDB tool, based on [Calis et al., 2013]) is based on the similar idea of measuring the enrichment in amino acid usage between immunogenic and non-immunogenic peptides, but with the simple assumption of position-independence of the main biophysical properties underlying immunogenicity.</p></list-item></list><p>Next, we wanted to emphasize that the approach is parsimonious in terms of training data, an aspect that is particularly crucial since data annotated by the information on immunogenicity or epitope specificity are scarce and the risk of overfitting is high. In this regard, other comparisons are important, i.e. comparisons to linear models with fewer parameters (diffRBM linear, PWM, SONIA, linear classifier), and we carry them out systematically (Figures 2, 4, 5, 6, Figure 4 —figure supplement 1, Figure 6 —figure supplement 1). These comparisons illustrate that diffRBM is a more advanced yet parsimonious choice, which is able to capture nonlinearities at the price of a limited amount of added parameters, keeping us away from overfitting but at the same time giving improved performance (as stressed at lines 474-477).</p><list list-type="order"><list-item><p>Additional comparisons require an amount of work that would justify separate papers. It is true that we mention that the diffRBM approach could be eventually applied to data that possess some distinctive, enriched set of features compared to larger pools of data endowed with the baseline properties. In particular, specific types of data we have in mind are RNA sequences selected through Selex protocols and protein sequences produced by in vitro directed evolution. We mentioned, however, such applications with different biological data only as future directions because they would require an amount of additional work that is even superior to the one put into this manuscript. Indeed, the application to new data requires a substantial work of model selection and testing (as done here), but also to design and test pipelines of data pre-processing specific to the new data. The steps of pre-processing and embedding required for the biological data we have analyzed here are quite ad hoc and demanding per se: for these steps we are actually building on the efforts of two separate papers, one on the application of RBMs to model T-cell receptors [Bravi et al., 2021a] and one on the application of RBMs to model antigen presentation [Bravi et al., 2021b]. This is the same reason why also performing comparisons of diffRBM to transfer-learning approaches implemented through different machine machine learning architectures, for instance from the papers kindly suggested by the reviewer, would require an amount of work that would justify a separate paper. Other machine learning architectures simply can’t be used off-the-shelf on these sequence data. As we have highlighted in the text for the comparisons we carry out, re-training other methods on the same data is key to a fair comparison, and, in addition to re-training, designing and implementing the steps of data pre-processing and embedding for other model architectures would require an amount of work that goes beyond the scope of a simple comparison of transfer-learning ideas.</p></list-item></list><p>To clarify all these points, we have made the following changes to the text:</p><list list-type="order"><list-item><p>In the introduction, we have clarified that the main focus is on the inspection and extraction of biologically interpretable features through the learnt parameters in terms of these properties (lines 87-89). We have expanded the paragraph where we mention other transfer-learning approaches in the context of modelling T-cell receptor specificity, to clarify how diffRBM is positioned compared to these approaches, in terms of architecture, training, and related advantages (lines 105-114).</p></list-item><list-item><p>In the discussion, we have added a paragraph on the difference of diffRBM with typical tasks for which transfer-learning is used (portability across domains), thus we stress diffRBM is not meant to compete with this type of approach (lines 498-504).</p></list-item><list-item><p>We have left the reference to additional applications with new data (such as data from SELEX protocols) only in the discussion about future extensions. We clarify that these applications are meant as future work since they will require the design of pipelines of data pre-processing specific to the new data, and possibly other adjustments of the model architecture and the learning strategy to accommodate their specificities (lines 529-532).</p></list-item></list></body></sub-article></article>