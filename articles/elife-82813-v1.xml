<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.2"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">82813</article-id><article-id pub-id-type="doi">10.7554/eLife.82813</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Immunology and Inflammation</subject></subj-group></article-categories><title-group><article-title>Structure-based prediction of T cell receptor:peptide-MHC interactions</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-174735"><name><surname>Bradley</surname><given-names>Philip</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0224-6464</contrib-id><email>pbradley@fredhutch.org</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/007ps6h72</institution-id><institution>Herbold Computational Biology Program, Division of Public Health Sciences. Fred Hutchinson Cancer Center</institution></institution-wrap><addr-line><named-content content-type="city">Seattle</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00cvxb145</institution-id><institution>Institute for Protein Design. University of Washington</institution></institution-wrap><addr-line><named-content content-type="city">Seattle</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Dustin</surname><given-names>Michael L</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/052gg0110</institution-id><institution>University of Oxford</institution></institution-wrap><country>United Kingdom</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Taniguchi</surname><given-names>Tadatsugu</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/057zh3y96</institution-id><institution>University of Tokyo</institution></institution-wrap><country>Japan</country></aff></contrib></contrib-group><pub-date publication-format="electronic" date-type="publication"><day>20</day><month>01</month><year>2023</year></pub-date><pub-date pub-type="collection"><year>2023</year></pub-date><volume>12</volume><elocation-id>e82813</elocation-id><history><date date-type="received" iso-8601-date="2022-08-18"><day>18</day><month>08</month><year>2022</year></date><date date-type="accepted" iso-8601-date="2023-01-05"><day>05</day><month>01</month><year>2023</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at bioRxiv.</event-desc><date date-type="preprint" iso-8601-date="2022-08-06"><day>06</day><month>08</month><year>2022</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2022.08.05.503004"/></event></pub-history><permissions><copyright-statement>© 2023, Bradley</copyright-statement><copyright-year>2023</copyright-year><copyright-holder>Bradley</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-82813-v1.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-82813-figures-v1.pdf"/><abstract><p>The regulatory and effector functions of T cells are initiated by the binding of their cell-surface T cell receptor (TCR) to peptides presented by major histocompatibility complex (MHC) proteins on other cells. The specificity of TCR:peptide-MHC interactions, thus, underlies nearly all adaptive immune responses. Despite intense interest, generalizable predictive models of TCR:peptide-MHC specificity remain out of reach; two key barriers are the diversity of TCR recognition modes and the paucity of training data. Inspired by recent breakthroughs in protein structure prediction achieved by deep neural networks, we evaluated structural modeling as a potential avenue for prediction of TCR epitope specificity. We show that a specialized version of the neural network predictor AlphaFold can generate models of TCR:peptide-MHC interactions that can be used to discriminate correct from incorrect peptide epitopes with substantial accuracy. Although much work remains to be done for these predictions to have widespread practical utility, we are optimistic that deep learning-based structural modeling represents a path to generalizable prediction of TCR:peptide-MHC interaction specificity.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>T cell receptor</kwd><kwd>MHC</kwd><kwd>deep learning</kwd><kwd>structure prediction</kwd><kwd>T cell epitope</kwd><kwd>binding specificity</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd><kwd>Mouse</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>R35 GM141457</award-id><principal-award-recipient><name><surname>Bradley</surname><given-names>Philip</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>R01 AI136514</award-id><principal-award-recipient><name><surname>Bradley</surname><given-names>Philip</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>The AlphaFold protein structure prediction network can be specialized for T cell receptor docking, leading to improved models of ternary complexes and some ability to discriminate correct from incorrect peptide epitopes.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>The specificity of T cell receptors (TCR) for peptides presented by major histocompatibility complex proteins (pMHC) is a critical determinant of adaptive immune responses to pathogens and tumors and of autoimmune disease. A predictive model of TCR:pMHC interactions, capable of mapping between TCR sequences and pMHC targets, could lead to advances in cancer immunotherapy and in the diagnosis and treatment of infectious and autoimmune diseases. Despite recent progress in TCR sequence analysis and modeling (<xref ref-type="bibr" rid="bib12">Gielis et al., 2019</xref>; <xref ref-type="bibr" rid="bib14">Huang et al., 2020</xref>; <xref ref-type="bibr" rid="bib21">Mayer-Blackwell et al., 2021</xref>; <xref ref-type="bibr" rid="bib24">Montemurro et al., 2021</xref>), a generalizable predictive model of TCR:pMHC interactions remains out of reach: existing predictors can learn to recognize new TCR sequences specific for pMHCs in their training set, but robust generalization to unseen pMHC epitopes has not been convincingly demonstrated (<xref ref-type="bibr" rid="bib25">Moris et al., 2021</xref>). Two key difficulties are the diversity of TCR:pMHC recognition modes, a consequence of TCR sequence and structural diversity and flexibility in TCR:pMHC docking orientation, and the limited number of experimentally validated TCR:pMHC interaction examples for use in training.</p><p>We hypothesized that 3D structural modeling might offer a path toward generalizable prediction of TCR:pMHC interactions in the current data-limited regime. At the biophysical level, TCR:pMHC interaction specificity is determined by the structures and flexibilities of the interacting partners. A wealth of structural studies have provided valuable insights into the atomistic determinants of specificity (<xref ref-type="bibr" rid="bib30">Rossjohn et al., 2015</xref>; <xref ref-type="bibr" rid="bib31">Rudolph et al., 2006</xref>; <xref ref-type="bibr" rid="bib34">Singh et al., 2017</xref>). Collectively, these experimentally determined structures define a range of docking geometries that likely covers the majority of unseen interactions; they also provide valuable templates for cutting-edge deep neural network structure prediction methods such as AlphaFold (<xref ref-type="bibr" rid="bib17">Jumper et al., 2021</xref>) and RoseTTAfold (<xref ref-type="bibr" rid="bib2">Baek et al., 2021</xref>). These prediction tools feature advanced network architectures with millions of parameters that are trained on structurally characterized proteins and their sequence homologs. Despite being trained on monomeric structures, these approaches can generate state-of-the-art structure predictions for protein complexes, and they have even been used to predict whether or not protein pairs will associate (<xref ref-type="bibr" rid="bib15">Humphreys et al., 2021</xref>).</p><p>Here we show that a version of AlphaFold specialized for TCR:pMHC modeling can be used to predict TCR:pMHC binding specificity with some success. Whereas the default AlphaFold version trained to predict protein:protein docking (AlphaFold-Multimer <xref ref-type="bibr" rid="bib10">Evans et al., 2021</xref>) shows inconsistent performance on TCR:pMHC structures (<xref ref-type="bibr" rid="bib38">Yin et al., 2022</xref>), our specialized pipeline demonstrates improved accuracy and reduced computational cost. Moreover, this modeling pipeline has significant power to discriminate target peptides from decoy peptides as evaluated on a benchmark of human and mouse MHC class I epitopes. Importantly, success in predicting the correct peptide target correlates with structural accuracy of the models, suggesting that when the pipeline succeeds, it does so by recapitulating key specificity determinants. This work, together with previous studies applying molecular modeling techniques to TCRs (<xref ref-type="bibr" rid="bib6">Borrman et al., 2020</xref>; <xref ref-type="bibr" rid="bib16">Jensen et al., 2019</xref>; <xref ref-type="bibr" rid="bib18">Lanzarotti et al., 2018</xref>; <xref ref-type="bibr" rid="bib28">Pierce and Weng, 2013</xref>), suggests that structure-based approaches represent a promising path forward for predicting TCR:pMHC interaction specificity.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Structure prediction</title><p>We first evaluated the structure prediction performance of a recently released version of AlphaFold (AlphaFold-Multimer <xref ref-type="bibr" rid="bib10">Evans et al., 2021</xref>) that was specifically trained for protein:protein docking. AlphaFold-Multimer leverages inter-chain residue covariation observed in orthologs of the target proteins to identify amino acid pairs making interface contacts. Given that TCR:pMHC interactions are determined in part by highly variable, non-germline encoded CDR3 regions, it was unclear whether AlphaFold’s strong docking performance on other systems would translate to TCR:pMHC interactions. Indeed, the AlphaFold-Multimer developers noted that it does not perform well on antibody:antigen complexes, which share many features with TCR:pMHC complexes.</p><p>We tested two versions of AlphaFold-Multimer, one in which the full sequences of the interacting partners are provided as input ('AFM_full': MHC-I or MHC-IIa, beta-2 microglobulin or MHC-IIb, peptide, TCRa, and TCRb variable and constant domains), and one in which only the directly interacting domains are provided as input ('AFM_trim': TCR constant domains, beta-2 microglobulin, and C-terminal MHC domains are removed). Restricting to the core interacting domains speeds the calculations substantially at the risk of introducing decoy docking sites at the location of interfaces with the missing domains. Although both models were capable of generating high-quality predictions on a nonredundant set of 130 TCR:pMHC complexes (as indicated by CDR loop RMSDs at and below ~2 Å; details below), prediction quality was highly variable, and visual inspection revealed that many of the predicted models had displaced peptides and/or TCR:pMHC docking modes that were outside the range observed in native proteins. Additionally, these AlphaFold predictions took multiple hours per target to complete, limiting their throughput.</p><p>One limitation of AlphaFold-Multimer is that it does not support multi-chain templates (<xref ref-type="bibr" rid="bib10">Evans et al., 2021</xref>): template information from the database of solved structures can inform the internal conformation of individual chains, but it does not guide the docking of chains into higher order complexes. The constrained nature of the TCR:pMHC binding mode suggests that higher and more consistent prediction accuracy could be obtained by providing additional template information. A challenge when modeling TCR structures is that the V-alpha and V-beta genes largely determine the best structural template, and these genes associate freely rather than in fixed pairings, which means that the optimal structural template for the TCR-alpha chain will often come from a different PDB structure as that for the TCR-beta chain. Additionally, the TCR:pMHC docking mode varies widely within an overall diagonal binding mode, in a way that is not easily predicted directly from sequence, making it challenging to select an optimal template for the TCR:pMHC relative orientation. Guided by these considerations, we developed an AlphaFold-based TCR docking pipeline that uses hybrid structural templates to provide a broad, native-like sampling of potential docking modes (<xref ref-type="fig" rid="fig1">Figure 1</xref>). In this approach, individual chain templates are first selected based on sequence similarity to the target TCR:pMHC (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). Hybrid complexes are created from these individual chain templates by using a diverse set of representative docking geometries to orient the TCR chains relative to the pMHC (see Methods). Docking geometries are defined in terms of the 6 degrees of freedom that relate the MHC reference frame to the TCR reference frame, where the MHC and TCR reference frames are defined based on internal pseudo symmetry (<xref ref-type="fig" rid="fig1">Figure 1B and D</xref> and Methods). These hybrid complexes are provided as templates to multiple independent AlphaFold simulations, four templates per simulation, with the highest confidence model from the simulations taken as the final prediction (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). During benchmarking, templates and docking geometries from structures with similar TCRs or pMHCs to the target are excluded to reduce bias toward the native structure (see Methods; this constraint was not applied to the default AlphaFold-Multimer methods). Given that we are providing template information that constrains the inter-chain docking, we chose not to include additional multiple sequence alignment (MSA) information beyond the target sequence. This greatly speeds the predictions: MSA building is the most time-consuming part of the AlphaFold pipeline, and the neural network inference step is also significantly faster without MSA information.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Constructing diverse hybrid templates for AlphaFold modeling.</title><p>(<bold>A</bold>) Four structural templates for each TCR chain and for the peptide:MHC are identified in the Protein Databank (<xref ref-type="bibr" rid="bib5">Berman et al., 2000</xref>) by sequence similarity search. (<bold>B</bold>) TCR:pMHC docking geometry is defined by computing the rigid-body transformation between TCR and pMHC coordinate frames. Coordinate frames are oriented based on internal pseudo symmetry as described in the Methods. (<bold>C</bold>) Three independent AlphaFold simulations are performed, each with four hybrid templates built from the four sets of single-chain templates oriented relative to one another using one of twelve representative docking geometries chosen to cover a wide range of experimentally determined ternary complexes. (<bold>D</bold>) TCR coordinate frames from class I pMHC ternary structures and the 12 representative transforms (thicker arrows) are shown in a common coordinate system defined by their corresponding pMHC coordinate frames.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82813-fig1-v1.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>MHC and TCR core residue definitions.</title><p>The MHC symmetry axis is the rotation axis of the transformation that superimposes the 12 core residues onto themselves, interchanging the N- and C-terminal half-cores. The TCR symmetry axis is the rotation axis of the superposition transform that interchanges the TCRA and TCRB cores.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82813-fig1-figsupp1-v1.tif"/></fig></fig-group><p>We found that the hybrid templates AlphaFold pipeline specialized for TCR:pMHC ('AF_TCR') produces higher quality models than either of the Alphafold-Multimer variants on a benchmark set (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>) of 130 TCR:pMHC complexes (<xref ref-type="fig" rid="fig2">Figure 2A</xref>, Wilcoxon <italic>P</italic>&lt;10<sup>–7</sup> vs AFM_full and <italic>P</italic>&lt;10<sup>–12</sup> vs AFM_trim on the full set; <xref ref-type="fig" rid="fig2">Figure 2B</xref>, <italic>P</italic>&lt;10<sup>–3</sup> for both comparisons on 20 targets without a close homolog in the AlphaFold-Multimer training set; and <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref> for peptide modeling accuracy). The AF_TCR pipeline also outperforms the state of the art TCRpMHCmodels pipeline (<xref ref-type="bibr" rid="bib16">Jensen et al., 2019</xref>) for Class I MHC TCR modeling (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3A–B</xref>), and produces better docking geometries than simply borrowing the geometry from the most sequence-similar template (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3C</xref>). There was a significant positive correlation between predicted and observed model accuracy (<xref ref-type="fig" rid="fig2">Figure 2C</xref>).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>TCR modeling accuracy.</title><p>(<bold>A</bold>) Comparison between Alphafold-Multimer with full ('AFM_full') or trimmed ('AFM_trim') input sequences and the hybrid-templates TCR pipeline ('AF_TCR'). CDR RMSD values (y-axis) are computed by superimposing the native and modeled MHC coordinates and comparing the placement of the TCR CDR loops (see Methods). (<bold>B</bold>) Same as in (<bold>A</bold>) but for the 20 benchmark targets unrelated to any TCR:pMHC structure deposited before May 2018, the cutoff date for the AlphaFold-Multimer training set. (<bold>C</bold>) AlphaFold’s predicted aligned error (PAE) measure, evaluated between TCR and pMHC, correlates with CDR RMSD between model and native structure. (<bold>D</bold>) The docking geometry of the final AlphaFold model improves over the best of the 12 templates in 30% of cases (points above the line <italic>y=x</italic>). (<bold>E</bold>) The docking geometry of the final AlphaFold model improves over the median of the 12 templates in 94% of cases (points above the line <italic>y=x</italic>). (<bold>F</bold>) Fine-tuning AlphaFold’s parameters on human TCR:pMHC complexes improves prediction of mouse TCR:pMHC complexes. Boxes in A, B, and F show the quartiles of the plotted distributions.</p><p><supplementary-material id="fig2sdata1"><label>Figure 2—source data 1.</label><caption><title>Structure prediction benchmark.</title><p>CSV file containing information on the ternary complexes in the structure prediction benchmark.</p></caption><media mimetype="application" mime-subtype="octet-stream" xlink:href="elife-82813-fig2-data1-v1.csv"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82813-fig2-v1.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Composition of the TCR:pMHC ternary structure database.</title><p>Source organism (left column), MHC allele (middle column), and peptide length (right column) composition of two different nonredundant versions of the ternary database. In the first ('Set 1'), no two structures have <italic>both</italic> fewer than three peptide mismatches <italic>and</italic> a paired chain TCRdist distance less than 120. In the second ('Set 2'), no two structures have <italic>either</italic> fewer than three peptide mismatches <italic>or</italic> a paired chain TCRdist less than 120. Set 1 corresponds to the 130-member benchmark set used for method comparisons. MHC Class II peptides are trimmed to the common 9-residue core plus two residues on either side, making them length 11 by construction, consistent with the lack of insertions/deletions in the middle of the peptide. TCRs with distances less than 120 tend to share one or both V gene identities and similar CDR3 lengths and sequences, and are often found to bind the same epitope in TCR clustering studies (<xref ref-type="bibr" rid="bib9">Dash et al., 2017</xref>; <xref ref-type="bibr" rid="bib23">Minervina et al., 2022</xref>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82813-fig2-figsupp1-v1.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Peptide structural modeling accuracy.</title><p>Peptide backbone RMSD (rows 1 and 3) and peptide length (row 2) versus CDR RMSD for MHC class I (rows 1–2) and MHC class II (row 3). CDR RMSD is calculated by first superimposing the model and the native structure using the MHC coordinates, and then computing the RMSD over the CDR loop residues without further superposition. In the RMSD calculation, a weight of three is applied to the CDR3 coordinates to reflect their greater role in peptide specificity. Peptide backbone (BB) RMSD is computed over the N, CA, C, and O atoms after superimposing the modeled and native MHC coordinates.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82813-fig2-figsupp2-v1.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 3.</label><caption><title>TCR:pMHC modeling performance.</title><p>(<bold>A–B</bold>) Comparison between the AlphaFold-TCR pipeline and the TCRpMHCmodels software on MHC class I targets. The TCRpMHCmodels calculation was run locally, and nearby templates were excluded using the '--blacklist' command line option (applying the same exclusion criteria used in the AF_TCR calculations). (<bold>C</bold>) Comparison between the AlphaFold-TCR pipeline and a simple protocol that borrows the docking geometry from the most sequence-similar ternary structure template. Sequence similarity is calculated over the concatenated MHC, peptide, and TCR chains with a uniform residue weight ('SeqID(unwtd)') or upweighting residues inversely proportional to chain length, to equalize contributions from the peptide, MHC, TCRalpha, and TCRbeta chains. <italic>P</italic> values correspond to the larger of the Wilcoxon and paired t test 2-sided <italic>P</italic> values comparing the indicated RMSD distributions.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82813-fig2-figsupp3-v1.tif"/></fig><fig id="fig2s4" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 4.</label><caption><title>Comparison of docking RMSD to CDR RMSD.</title><p>Docking RMSD and CDR RMSD are well correlated. CDR RMSD tends to be larger than docking RMSD because it also includes deviation in the internal structures of the CDR loops.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82813-fig2-figsupp4-v1.tif"/></fig><fig id="fig2s5" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 5.</label><caption><title>Docking geometry landscapes for the structure prediction benchmark.</title><p>The UMAP (<xref ref-type="bibr" rid="bib22">McInnes et al., 2018</xref>) algorithm was used to transform a matrix of docking RMSD distances into a 2D landscape projection of the 130 native structures and the models from the AlphaFold TCR pipeline ('AF_TCR') and from two variants of the AlphaFold-Multimer model ('AFM_trim' and 'AFM_full'). Regions of docking space not sampled by the natives can be seen at the far left and bottom of the landscapes. Representative AlphaFold-Multimer models are shown: in the bottom left panel, a TCR docked to the underside of the MHC; in the bottom right panel, a TCR docked to the side of the MHC and not making contacts with the peptide. In each panel, structures from one source are colored as indicated in the legend, and the remaining points are gray.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82813-fig2-figsupp5-v1.tif"/></fig><fig id="fig2s6" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 6.</label><caption><title>Factors influencing AF_TCR docking accuracy.</title><p>Ordinary least squares (OLS) linear regression was used to identify factors influencing the docking accuracy of AF_TCR models. In all panels, the y-axis corresponds to the Dock RMSD of the final AF_TCR model. In panels 1–8 (top left to bottom middle), a single feature (named in the panel title) is plotted on the x-axis. The panel title indicates the coefficient assigned to each feature in the fitted linear regression model as well as the p value assigned to the feature (which reflects the strength of its influence on docking RMSD). 'Native docking geometry Z-score' is a measure of the distance between the docking geometry in the native structure and the mean docking geometry of all ternary structures in the same MHC class (defined using the Mahalobis distance to account for correlations between the six parameters defining docking geometry); outlier docking geometries will have larger values. This is by far the largest contributor to the accuracy of the AF_TCR model. 'V templates TCRdist' is the sum of the V gene TCRdist for the closest TCR alpha and beta templates; values of 0 mean that both the V genes in the target TCR are found in an unrelated template structure and hence available for modeling. 'Loop RMSD' measures the accuracy of the CDR loop structure in the TCRalpha and TCRbeta CDR loops, ignoring alpha/beta pairing geometry and docking geometry. It is calculated for each chain separately by superimposing on the single-chain TCR core residues (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>) and upweighting the CDR3 by a factor of 3; the final value is the sum of the alpha and beta chain RMSDS. 'TCR core RMSD' is calculated by superimposing the 26 TCR core residues (13 from each chain) of the model onto the native structure; it mainly reflects the accuracy of the alpha/beta pairing geometry, since the core residue positions are well conserved within each TCR chain structure. 'Peptide RMSD' records the backbone atom (N, CA, C, O) RMSD between modeled and native peptides after superimposing on the MHC coordinates. The bottom right panel shows the OLS fitted RMSD (x-axis) versus the actual Dock RMSD (y-axis).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82813-fig2-figsupp6-v1.tif"/></fig></fig-group><p>For each benchmark target, the AlphaFold TCR pipeline is provided with 12 hybrid template complexes whose TCR:pMHC docking modes are taken from 12 diverse ternary structures unrelated to the target. We were curious to know whether the AlphaFold simulation was improving on the docking information present in these template structures. To answer this question, we compared the accuracy of the docking geometry present in the final model to the accuracies of the 12 template structures. Since the 12 templates differ in the sequences and structures of their CDR loops, we developed a distance between TCR:pMHC docking geometries that compares the placement of 'generic' CDR loops ('docking RMSD', see Methods). This docking RMSD measure is correlated with CDR RMSD in comparisons of models to natives (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>), but it focuses exclusively on the docking geometry and provides a sequence-independent way of comparing binding modes that emphasizes CDR loop placement. For 30% of the targets, the AlphaFold TCR final model had a lower RMSD than the best template docking geometry (<xref ref-type="fig" rid="fig2">Figure 2D</xref>); the final model improved over the median template RMSD for 94% of the targets (<xref ref-type="fig" rid="fig2">Figure 2E</xref>). To visualize the overall docking geometry landscape of models and natives, we calculated docking RMSD values between all of the native ternary structures and the AlphaFold-TCR and AlphaFold-Multimer models and transformed this distance matrix into a 2D projection (<xref ref-type="fig" rid="fig2s5">Figure 2—figure supplement 5</xref>) using the UMAP algorithm (<xref ref-type="bibr" rid="bib22">McInnes et al., 2018</xref>). Inspection of this 2D docking geometry landscape reveals regions that are distant from the native structures and only sampled by the AlphaFold-Multimer models, supporting the view that incorporating template docking geometries helps to constrain predictions to native-like geometries. We analyzed the factors contributing to docking prediction accuracy and found that two dominant factors are the degree to which the docking geometry in the native structure deviates from the consensus binding mode (as captured in a multidimensional Z score, see methods) and the MHC class (class II binding modes were better predicted than class I), with minor contributions from V gene template sequence distance, CDR loop modeling accuracy, peptide modeling accuracy, and TCRalpha/TCRbeta docking accuracy (<xref ref-type="fig" rid="fig2s6">Figure 2—figure supplement 6</xref>).</p><p>An attractive feature of neural network architectures is the potential to 'fine tune' a general network for improved prediction accuracy in a specific domain. We fine-tuned the AlphaFold parameters in the context of the AlphaFold TCR pipeline on the set of 93 human TCR:pMHC complexes from the benchmarking set and subsequently evaluated the performance of this model on the 37 mouse TCR:pMHC targets. Despite the small size of the TCR:pMHC ternary structure database, the fine-tuned model showed improved performance on the mouse targets (<xref ref-type="fig" rid="fig2">Figure 2F</xref>; Wilcoxon p&lt;0.015), which are distinct in the details of their epitope, MHC, and TCR sequences from the human training set, suggesting that the model was able to learn generalizable features of TCR:pMHC interactions. This fine-tuning procedure was facilitated by the fact that the AF2 model requires significantly less memory in the absence of MSA information, making it possible to perform parameter optimization on full TCR:pMHC systems without any residue cropping.</p></sec><sec id="s2-2"><title>Binding specificity prediction</title><p>Having established that the AlphaFold TCR pipeline can generate more accurate TCR:pMHC models than AlphaFold-Multimer, we evaluated its performance in TCR epitope prediction. The general problem of predicting, de novo, which peptide:MHCs a given TCR recognizes is likely to be very difficult due to the diversity of TCR:pMHC recognition modes, the polyspecificity of individual TCRs, and the paucity of available training data (<xref ref-type="bibr" rid="bib25">Moris et al., 2021</xref>). Here we consider instead the simpler problem of selecting the correct target peptide from a small set of candidates. This might correspond to a real-world scenario in which we know the source antigen from which the unknown peptide epitope is taken, or we have a positive hit in a T cell stimulation assay that implicates a pool of peptides rather than a unique epitope. For benchmarking, we focus on peptide-MHC epitopes for which a repertoire of cognate TCRs has been identified. This allows us to evaluate the sensitivity of the predictions to small changes in TCR sequence. It also lets us investigate a scenario in which we are given not one TCR, but a set of TCRs that are all predicted to recognize the same epitope, and we consider the extent to which this helps to constrain the target epitope. With improved single-cell technologies for paired TCR sequencing, and improved methods for identifying TCR sequence convergence, we hypothesize that this will become an increasingly common scenario.</p><p>We selected a set of 8 Class I peptide:MHC systems (<xref ref-type="table" rid="table1">Table 1</xref>) for which a repertoire of paired epitope-specific TCRs and a solved ternary structure were available. These systems include one human (A*0201) and one mouse (H2-Db) MHC allele, each with 9- and 10-residue peptides. TCR repertoires containing more than 50 unique TCR sequences were subsampled to a set of 50 TCRs using an algorithm that removed redundancy while concentrating on the more densely sampled regions of TCR space (see Methods). For each MHC/peptide length combination, we used the NetMHCpan-4.1 (<xref ref-type="bibr" rid="bib29">Reynisson et al., 2020</xref>) method to select 9 decoy peptides with binding scores in the range of the true peptide binders. We additionally selected 50 irrelevant TCRs at random from human and mouse CD8 T cell datasets made available by 10 X Genomics (these TCRs were used to correct for pMHC-intrinsic effects; see below and Methods).</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Binding specificity benchmark.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Organism</th><th align="left" valign="bottom">MHC</th><th align="left" valign="bottom">Peptide length</th><th align="left" valign="bottom">Peptide sequence</th><th align="left" valign="bottom">Antigen</th></tr></thead><tbody><tr><td align="left" valign="bottom">human</td><td align="left" valign="bottom">HLA-A*02:01</td><td align="char" char="." valign="bottom">9</td><td align="left" valign="bottom">GILGFVFTL</td><td align="left" valign="bottom">Flu M1</td></tr><tr><td align="left" valign="bottom">human</td><td align="left" valign="bottom">HLA-A*02:01</td><td align="char" char="." valign="bottom">9</td><td align="left" valign="bottom">GLCTLVAML</td><td align="left" valign="bottom">EBV BMLF1</td></tr><tr><td align="left" valign="bottom">human</td><td align="left" valign="bottom">HLA-A*02:01</td><td align="char" char="." valign="bottom">9</td><td align="left" valign="bottom">NLVPMVATV</td><td align="left" valign="bottom">CMV pp65</td></tr><tr><td align="left" valign="bottom">human</td><td align="left" valign="bottom">HLA-A*02:01</td><td align="char" char="." valign="bottom">9</td><td align="left" valign="bottom">YLQPRTFLL</td><td align="left" valign="bottom">SARS-CoV-2 Spike</td></tr><tr><td align="left" valign="bottom">human</td><td align="left" valign="bottom">HLA-A*02:01</td><td align="char" char="." valign="bottom">10</td><td align="left" valign="bottom">ELAGIGILTV</td><td align="left" valign="bottom">human MART-1</td></tr><tr><td align="left" valign="bottom">human</td><td align="left" valign="bottom">HLA-A*02:01</td><td align="char" char="." valign="bottom">10</td><td align="left" valign="bottom">KLVALGINAV</td><td align="left" valign="bottom">HCV POLG</td></tr><tr><td align="left" valign="bottom">mouse</td><td align="left" valign="bottom">H2-Db</td><td align="char" char="." valign="bottom">9</td><td align="left" valign="bottom">ASNENMETM</td><td align="left" valign="bottom">Flu NP</td></tr><tr><td align="left" valign="bottom">mouse</td><td align="left" valign="bottom">H2-Db</td><td align="char" char="." valign="bottom">10</td><td align="left" valign="bottom">SSLENFRAYV</td><td align="left" valign="bottom">Flu PA</td></tr></tbody></table></table-wrap><p>We used the AlphaFold TCR pipeline to generate docked complexes and associated interface accuracy estimates for pairings of each TCR with its true pMHC epitope and with 9 decoy peptides of the same length (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). This produces, for each of the eight pMHCs, an Nx10 matrix of predicted interface accuracies (<xref ref-type="fig" rid="fig3">Figure 3B</xref>, left panel), where N is the number of TCRs specific for the given pMHC. To generate a single number representing the estimated interface accuracy of a complex, we summed the residue-residue predicted aligned error (PAE) for all TCR:pMHC residue pairs. These raw accuracy estimates showed significant TCR- and pMHC-intrinsic effects (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). Certain TCRs had consistently higher or lower than average predicted interface accuracies due to features such as longer CDR3 loops or usage of V genes without a close structural template. We saw similar, albeit weaker, trends across different peptide:MHC complexes, perhaps due to AlphaFold’s confidence in the MHC-bound structure of the peptide. TCR-intrinsic factors do not change the relative order of candidate peptides, but they make comparisons of binding predictions across TCRs difficult; pMHC effects have the potential to change the rank ordering of candidate peptide epitopes. Since we are interested here in evaluating the compatibility between TCR and pMHC and not, e.g., ranking peptides by their affinity for MHC, we corrected for these TCR- and pMHC-intrinsic effects to generate an array of TCR:pMHC binding scores intended to be comparable across different pMHCs and TCRs (<xref ref-type="fig" rid="fig3">Figure 3B</xref>, middle panel; lower scores indicate stronger predicted binding, see Methods).</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Structural modeling can sometimes discriminate correct from incorrect TCR:pMHC pairings.</title><p>(<bold>A</bold>) For each of the eight peptide:MHC epitopes, we docked multiple cognate TCRs against multiple decoy peptides and the wild type epitope. Here three TCRs and three pMHCs are shown; 9 decoys and up to 50 TCRs were actually modeled. (<bold>B</bold>) For each candidate TCR:pMHC pairing, the mean AlphaFold predicted aligned error (PAE) for the TCR:pMHC interface was calculated (left) and transformed into a binding score by subtracting out TCR-intrinsic and pMHC-intrinsic factors (middle). These binding scores were averaged to define a repertoire-level binding score for the WT epitope and each of the decoys (bottom). Also calculated was the rank of the WT binding score within the list of all the binding scores for each TCR (right). (<bold>C</bold>) TCRdist hierarchical clustering tree of the 50 modeled TCRs for the A*02:01 GIL9 epitope, labeled with the TCR sequence information, top-ranked peptide, and rank of the WT peptide, and colored by the rank of the WT peptide. Internal edges, which correspond to multiple ‘leaf’ TCRs, are colored by the rank of the WT peptide after averaging the binding scores over the leaf TCRs. (<bold>D</bold>) Repertoire binding scores for each of the eight target epitopes and the 9 decoy peptides, with the lowest (most favorable) binding score in each row boxed. (<bold>E</bold>) Receiver operating characteristic (ROC) curves for discrimination of WT from decoy peptides by binding score. Area under the ROC curve (AUROC) values are given in the legend along with the sequence of the WT peptide.</p><p><supplementary-material id="fig3sdata1"><label>Figure 3—source data 1.</label><caption><title>Epitope specificity benchmark TCRs.</title><p>CSV file containing information on the TCR sequences in the epitope decoy discrimination benchmark.</p></caption><media mimetype="application" mime-subtype="octet-stream" xlink:href="elife-82813-fig3-data1-v1.csv"/></supplementary-material></p><p><supplementary-material id="fig3sdata2"><label>Figure 3—source data 2.</label><caption><title>Epitope specificity benchmark peptides.</title><p>CSV file containing information on the peptides in the epitope decoy discrimination benchmark.</p></caption><media mimetype="application" mime-subtype="octet-stream" xlink:href="elife-82813-fig3-data2-v1.csv"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82813-fig3-v1.tif"/></fig><p>We evaluated the accuracy of these binding predictions across the eight pMHC epitopes. First, we calculated the rank of the true peptide epitope amongst the 9 decoy peptides (<xref ref-type="fig" rid="fig3">Figure 3B</xref>, right panel) on a per-TCR basis. To visualize how these ranks vary across each pMHC-specific repertoire, we constructed hierarchical clustering trees of the TCR sequences using the TCRdist measure (<xref ref-type="bibr" rid="bib9">Dash et al., 2017</xref>) and colored them by the rank of the true peptide (<xref ref-type="fig" rid="fig3">Figure 3C</xref> and <xref ref-type="fig" rid="fig4">Figure 4</xref>). Internal edges, which correspond to multiple ‘leaf’ TCRs, are colored by the rank of the true peptide after averaging the binding scores over the leaf TCRs. Looking across all eight epitopes, we can see, first, that the predictions are not random: on average the correct peptide is ranked more favorably than most of the decoys (i.e. there is more blue than red). For six of the eight epitopes, the correct peptide is ranked first when we average the binding scores of all the TCRs in the repertoire (<xref ref-type="fig" rid="fig3">Figure 3D</xref>; <xref ref-type="fig" rid="fig4">Figure 4</xref>: the largest branch of the tree is dark blue). It also appears that the epitopes with more sequence-diverse repertoires (A*0201-GLC9 and A*02:01-NLV9) are more challenging to predict: the trees that merge completely at smaller TCRdist values (further to the left) are bluer than the other trees in <xref ref-type="fig" rid="fig4">Figure 4</xref>. This can be seen quantitatively by plotting the TCRdiv repertoire sequence diversity measure (<xref ref-type="bibr" rid="bib9">Dash et al., 2017</xref>) against measures of binding prediction success (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). If we rank the peptides by binding score and compare the recovery of true binder peptides to decoys using receiver operating characteristic (ROC) curves, we can see that some epitopes, such as A*02:01-YLQ9 and A*02:01-ELA10 are predicted very well (by area under the ROC curve, AUROC ≥ 0.96) and some predictions are only slightly better than random (<xref ref-type="fig" rid="fig3">Figure 3E</xref>). We find an overall AUROC value of 0.82 when binding and non-binding TCR:pMHC pairs from all epitopes are ranked together.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Peptide decoy discrimination results for the eight benchmark epitopes.</title><p>The rank of the wild type peptide relative to the 9 decoys (0=best, 9=worst) is shown in a heatmap and a TCRdist hierarchical clustering tree of the epitope-specific TCRs. Each row of the heatmap corresponds to a single TCR; each column corresponds to one of the 10 modeled peptides, with the wild type peptide on the left. The vertical ordering of the TCRs in the heatmaps and trees is the same. Internal edges of the trees, which correspond to multiple ‘leaf’ TCRs, are colored by the rank of the wild type peptide after averaging the binding scores over the leaf TCRs.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82813-fig4-v1.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Peptide specificity prediction accuracy is inversely correlated with repertoire sequence diversity.</title><p>TCR repertoire sequence diversity is measured with the TCRdiv measure (<xref ref-type="bibr" rid="bib9">Dash et al., 2017</xref>) with a sigma value of 120. Each colored marker corresponds to one of the eight benchmark epitopes as indicated in the legend. (<bold>A</bold>) For each epitope, the average rank of the wild type peptide relative to the nine decoys (0=best binding score; 9=worst binding score) is calculated over all the epitope-specific TCRs and plotted against the TCRdiv score for the corresponding TCR repertoire. (<bold>B</bold>) TCRdiv scores are plotted against the area under the receiver operating characteristic curve (AUROC) values for discriminating the wild type from decoy peptides by binding score.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82813-fig4-figsupp1-v1.tif"/></fig></fig-group><p>We looked to see whether structural modeling accuracy correlated with binding prediction success (<xref ref-type="fig" rid="fig5">Figure 5</xref>). Although very few of the specific TCRs being modeled have been structurally characterized, each of the epitopes has at least one solved ternary structure in the protein structure database. For each TCR, we computed docking RMSDs between the TCR:pMHC model in complex with its cognate epitope and the solved ternary structures for that epitope and took the minimum value as a proxy for the accuracy of the predicted binding mode. <xref ref-type="fig" rid="fig5">Figure 5A</xref> shows the distribution of these RMSD values across each repertoire. Well-predicted epitopes such as A*02:01-YLQ9 and A*02:01-ELA10 indeed appear to have smaller RMSD values than other repertoires. The mouse pMHC H2Db-ASN9 is an outlier, with an RMSD distribution shifted to very high values. Examination of the three ternary structures for this pMHC revealed that they represent a unique population of TRBV17+ TCRs that is distinct from the consensus repertoire modeled here. Two of the three TCRs bind with a reversed docking orientation (<xref ref-type="bibr" rid="bib13">Gras et al., 2016</xref>), and the third has a highly displaced binding footprint (<xref ref-type="bibr" rid="bib39">Zareie et al., 2021</xref>); all three are outliers in a hierarchical clustering tree of Class I TCRs based on docking RMSD (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). If we exclude H2Db:ASN9 and plot docking RMSD to the closest epitope structure versus binding score for the correct peptide, we see that there is a positive correlation (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). The TCRs for which the correct peptide is ranked first have a lower RMSD distribution than other TCRs, and this RMSD distribution shifts upward as the rank of the correct peptide declines (<xref ref-type="fig" rid="fig5">Figure 5C</xref>). These results suggest that the correct binding predictions are driven at least in part by recovery of native-like structural features (analysis of peptide backbone RMSDs shows a positive, but much weaker, correlation between binding prediction and modeling accuracy: <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>).</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Success in decoy discrimination correlates with structural modeling accuracy.</title><p>(<bold>A</bold>) For each TCR, the structural model in complex with the wild type epitope was compared to all experimentally determined ternary structures for that epitope and the smallest docking RMSD was recorded. The resulting RMSD distributions were smoothed using kernel density estimation and plotted. (<bold>B</bold>) Scatter plot of docking RMSD to the nearest wild type structure versus the binding score for the wild type peptide. Favorable wild type binding scores correlate with lower RMSD values. (<bold>C</bold>) Distributions of docking RMSD to the nearest wild type structure (y-axis) as a function of the rank of the wild type peptide (x-axis). When the wild type peptide is ranked first (left violin), the corresponding docking geometries are more similar to those of ternary complexes for that epitope, suggesting higher accuracy.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82813-fig5-v1.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Hierarchical clustering tree of TCR:pMHC class I docking geometries.</title><p>Structures are labeled with PDB IDs and, for the epitopes in the peptide decoy discrimination benchmark, MHC and peptide sequence colored as in main text <xref ref-type="fig" rid="fig3">Figures 3</xref>, <xref ref-type="fig" rid="fig5">5</xref> and <xref ref-type="fig" rid="fig6">6</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82813-fig5-figsupp1-v1.tif"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 2.</label><caption><title>Peptide backbone accuracy in the specificity benchmark.</title><p>(<bold>A</bold>) For each TCR, the structural model in complex with the wild type epitope was compared to all experimentally determined ternary structures for that epitope and the median peptide backbone RMSD was recorded. The resulting RMSD distributions were smoothed using kernel density estimation and plotted. (<bold>B</bold>) Scatter plot of peptide backbone RMSD versus the binding score for the wild type peptide. The correlation between more favorable (lower) wild type binding scores and lower RMSD values is much weaker than that seen for docking RMSDs in <xref ref-type="fig" rid="fig5">Figure 5B</xref>. (<bold>C</bold>) Distributions of peptide backbone RMSD (y-axis) as a function of the rank of the wild type peptide (x-axis). When the wild type peptide is ranked first (left violin), the corresponding peptide backbone RMSDs are slightly lower, although the trend is again weaker than that seen for docking RMSDs in <xref ref-type="fig" rid="fig5">Figure 5C</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82813-fig5-figsupp2-v1.tif"/></fig></fig-group><p>To further investigate the behavior of our modeling approach, we performed an in silico epitope alanine scan of each of the eight pMHC-specific repertoires. We built models and calculated binding scores for each epitope-specific TCR docked to all single-alanine mutants of the native peptide (native alanine residues were mutated to glycine). Binding scores for each TCR and each of the alanine mutants are shown in the heatmaps in <xref ref-type="fig" rid="fig6">Figure 6</xref>. Averaging these binding scores over all of the TCRs for each epitope and subtracting the score for the native peptide gives a predicted repertoire-level sensitivity to mutation at each peptide position (<xref ref-type="fig" rid="fig6">Figure 6B</xref>). From these sensitivity plots, we can see that the majority of the epitope-specific repertoires show the expected preference for the native peptide at most positions, with a subset of positions showing high sensitivity. Coloring the pMHC structures by mutation sensitivity (<xref ref-type="fig" rid="fig6">Figure 6A</xref>) reveals that these highly sensitive positions are largely TCR-exposed; several are sites of known viral escape mutations, such as A*02:01-KLV position L5 (<xref ref-type="bibr" rid="bib37">Wölfl et al., 2008</xref>) and H2Db-SSL position R7 (<xref ref-type="bibr" rid="bib35">Valkenburg et al., 2013</xref>). Although the observation that positions predicted to disrupt TCR binding are largely TCR-exposed accords with biophysical intuition, this is still an important validation of the protocol. Since the binding scores are derived from pairwise AlphaFold confidence measures partly involving the peptide, one concern is that they might be reflecting peptide-MHC binding preferences rather pMHC-TCR binding. The fact that peptide anchor mutations are not among the most strongly predicted positions here suggests that, by subtracting each peptide’s average binding score for the background ‘non-binder’ TCRs, we are able to correct for these peptide-intrinsic features. As a final test, we evaluated the specificity protocol in a more challenging setting: single TCRs (rather than TCR repertoires) interacting with altered peptide variants, some with diverse amino acid mutations. Here we found much poorer performance than in the decoy-discrimination task (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>), which could be somewhat improved by including related TCR:pMHC complexes in the template pool (suggesting that future improvements to the structure prediction methods may translate into improved binding predictions).</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Alanine scanning results for the eight benchmark epitopes.</title><p>(<bold>A</bold>) Heatmaps showing the binding scores for the wild type peptide (left column) and all single-alanine mutants (columns labeled with the wild type sequence) in complex with each TCR (rows). Below each heatmap, the wild type pMHC crystal structure is shown with the peptide colored by the delta between mutant and wild-type repertoire-averaged binding scores. (<bold>B</bold>) Line plots of the delta between the mutant and wild-type repertoire-averaged binding scores reflect the predicted repertoire-level sensitivity to epitope mutations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82813-fig6-v1.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Comparison to experimental data on single TCRs binding altered peptide ligands.</title><p>(<bold>A–B</bold>) Experimental binding affinities for the A6 and 1G4 TCRs were taken from <xref ref-type="bibr" rid="bib27">Pettmann et al., 2021</xref> Figure 1 source data, 'Bmax constrained' KD values. (<bold>A</bold>) Binding predictions generated without related templates show poor correlation with experiment (lower binding scores and lower KD values correspond to tighter binding, so we would expect to see a positive correlation). (<bold>B</bold>) Inclusion of related templates in the modeling pipeline leads to improved binding predictions. (<bold>C</bold>) Activation data for single-alanine mutants of the A*02:01 restricted M1<sub>58</sub> epitope were taken from <xref ref-type="fig" rid="fig4">Figure 4</xref> (<xref ref-type="bibr" rid="bib4">Berkhoff et al., 2005</xref>) and plotted against the repertoire-level binding score for the M1<sub>58</sub> epitope (GILGFVFTL) from our alanine scanning simulations (<xref ref-type="fig" rid="fig6">Figure 6</xref>). Here, we see the expected association between lower binding scores (i.e. stronger predicted binding) and higher levels of activation, though the correlation is relatively weak.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82813-fig6-figsupp1-v1.tif"/></fig></fig-group></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Prediction of TCR:pMHC interactions is challenging because of the diversity of TCR:pMHC recognition modes and the limited number of validated interactions available for training. Inspired by recent breakthroughs in protein structure prediction (<xref ref-type="bibr" rid="bib2">Baek et al., 2021</xref>; <xref ref-type="bibr" rid="bib17">Jumper et al., 2021</xref>), we hypothesized that structure-based approaches, which can leverage general features of protein structures and interactions, might offer a path to generalizable TCR:pMHC binding predictions from limited data. We developed a specialized AlphaFold pipeline for TCR:pMHC structure prediction that uses hybrid templates assembled from existing TCR:pMHC structures to constrain the TCR docking orientation to native-like geometries. Here we show that this pipeline can generate more accurate structure predictions of TCR:pMHC complexes than the state-of-the-art method Alphafold-Multimer. Prediction accuracy correlates with model confidence, and model quality can be further improved by fine-tuning the AlphaFold parameters on TCR:pMHC structures. When tested on peptide decoy discrimination, we found that the model’s docking accuracy estimates, corrected for TCR- and pMHC-intrinsic effects, could be used to select the correct target peptides from decoys with substantial accuracy. Success in this decoy discrimination task correlated with the structural accuracy of the models, suggesting that the pipeline was picking out the correct peptide on the basis of molecular specificity determinants. Prediction accuracy varied across pMHC epitopes, with those epitopes having more sequence-diverse TCR repertoires proving more challenging to model.</p><p>There are a number of caveats to this work. First, the overall level of accuracy falls short of what would be required for most practical applications of TCR:pMHC binding prediction. As described below, we are pursuing multiple avenues for improving this initial pipeline; it may also be possible to predict from the simulations themselves which systems are reliably modeled, which could allow useful predictions to be extracted from large-scale calculations. Second, several of the epitopes in our peptide decoy discrimination benchmark have been extensively characterized in structural studies. While we made efforts to avoid using information from related structures during template assembly (see Methods), it is still possible that bias toward native-like conformations was introduced. For example, the AlphaFold parameters that we rely on in the pipeline were trained on individual protein chains (not protein complexes) deposited prior to May 2018. Some of the TCR chains modeled in the decoy discrimination task are likely similar to protein chains present in this AlphaFold training set. As the database of TCR:pMHC pairs grows, future benchmarking will establish whether the performance observed here will extend to epitopes without structural coverage. Until then, these results should be considered a favorable upper bound on the method’s performance. Finally, our template-based modeling approach is unlikely to succeed on TCR:pMHC systems with highly divergent binding modes. Although we do see evidence that AlphaFold can improve over the best template provided (<xref ref-type="fig" rid="fig2">Figure 2D</xref>), it is unlikely that it can reliably predict complexes that deviate substantially from any template (e.g. reversed-orientation geometries <xref ref-type="bibr" rid="bib3">Beringer et al., 2015</xref>; <xref ref-type="bibr" rid="bib13">Gras et al., 2016</xref>). More generally, a template-based approach such as ours is fundamentally limited by the coverage of the structure database, which is highly biased toward well-studied alleles such as HLA-A*02:01 and, for MHC Class I, toward canonical 9-residue epitopes (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>).</p><p>The modeling pipeline described here represents a first step in applying deep learning structure prediction tools to study TCR:pMHC interactions. We anticipate that it can be improved by further testing on other systems and by comparison with other experimental data types (binding affinities, interface mutations, etc.). This initial pipeline does not make use of multiple sequence alignment (MSA) information, but it may be helpful to include MSAs for individual chains or to construct ‘paired MSAs’ consisting of concatenated TCR:peptide:MHC sequences of known binding examples. Such paired MSAs could take the place of the paired ortholog alignments used by AlphaFold-Multimer to detect residue covariation across interfaces. We evaluated the use of AlphaFold’s residue-residue accuracy estimate (PAE) to discriminate wild type from decoy peptide-MHC epitopes, but it may also be worth exploring the use of other binding affinity estimates such as binding energies computed with the Rosetta software package (<xref ref-type="bibr" rid="bib19">Leaver-Fay et al., 2011</xref>) or other molecular modeling tools (<xref ref-type="bibr" rid="bib20">Lee et al., 2018</xref>). Finally, it may be possible to fine-tune AlphaFold parameters directly to discriminate TCR:pMHC binding examples from non-binding examples, as we have recently demonstrated for peptide:MHC interactions (<xref ref-type="bibr" rid="bib26">Motmaen et al., 2022</xref>). This would allow us to directly leverage the thousands of validated TCR:pMHC interactions within the context of a structurally informed training procedure.</p></sec><sec id="s4" sec-type="methods"><title>Methods</title><sec id="s4-1"><title>Defining TCR:pMHC docking geometry</title><p>The TCR:pMHC docking geometry is defined by the rigid body transformation that maps between the MHC and TCR coordinate frames (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). The MHC coordinate frame is defined on the basis of the approximate 2-fold symmetry axis that relates the N- and C-terminal halves of the beta sheet forming the floor of the peptide binding pocket. 12 core residues in the beta sheet were selected (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1A</xref>), 6 from the N-terminal half and 6 from the C-terminal half, that are related by this approximate 2-fold rotational symmetry. For a given MHC structure, the transformation mapping these 12 residues onto themselves, interchanging the N- and C-terminal residues and minimizing the RMSD of the alpha carbon atoms, is computed. The rotation axis of this orthogonal transformation, oriented to point toward the peptide, is taken as the x-axis of the MHC coordinate frame. The z-axis of the coordinate frame points from the center of mass (COM) of the 6 N-terminal core alpha carbons to the COM of the 6 C-terminal core alpha carbons. The coordinate frame is centered at the COM of the 12 core residues.</p><p>To define the TCR coordinate frame, 13 structurally conserved core residues from the TCR alpha chain and 13 aligned core residues from the TCR beta chain (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1B–C</xref>) were selected on the basis of visual inspection of TCR multiple structural alignments. The same procedure as outlined above for the MHC is used to define the TCR coordinate frame, replacing the 6 N-terminal and 6 C-terminal core residues of the MHC with the 13 TCRA and 13 TCRB core residues of the TCR heterodimer. The x-axis of the coordinate frame is chosen to point along the TCR pseudo symmetry axis toward the CDR loops, while the z-axis points from the COM of the TCRA core residues to the COM of the TCRB core residues.</p><p>The docking geometry is defined by the rigid body transformation relating the MHC coordinate frame to the TCR coordinate frame. This transformation naturally lives in a 6-dimensional non-Euclidean space (SE(3)). We take advantage of the fact that, as defined above, the x-axes of the MHC and TCR frames point toward the typical location of their partner in order to define a local 6-dimensional parameterization of this space in terms of the distance between the frame origins, a dihedral angle about the axis connecting the frame origins, the unit vector pointing from the MHC to TCR in the MHC frame, and the unit vector pointing from TCR to MHC in the TCR frame (see the README at <ext-link ext-link-type="uri" xlink:href="https://github.com/phbradley/TCRdock">https://github.com/phbradley/TCRdock</ext-link> for further details and visualizations). This mapping of TCR:pMHC docking geometries to 6 real-valued parameters allows us to approximate the space of docking geometries by a multidimensional normal distribution and assign a ‘Z score’ (using the Mahalanobis distance) to any observed docking geometry. This score reflects the degree to which the docking geometry diverges from the consensus binding mode for its MHC class and was found to be a strong predictor of docking accuracy (<xref ref-type="fig" rid="fig2s6">Figure 2—figure supplement 6</xref> upper left panel). The Python script parse_tcr_pmhc_pdbfile.py in the TCRdock github repository (see Code Availability) computes the MHC and TCR coordinate frames for an input PDB structure and calculates the docking geometry.</p></sec><sec id="s4-2"><title>AlphaFold modeling pipeline</title><p>To model a given TCR:pMHC target, three AlphaFold simulations (using the 'model_2_ptm' parameter set) are conducted and the final model with the lowest predicted aligned error (PAE) between the TCR and pMHC is selected (<xref ref-type="fig" rid="fig1">Figure 1</xref>). The model_2_ptm parameter set was chosen based on our experience in peptide:MHC binding predictions, but the model_1_ptm set gives very similar results. To reduce parameter training bias, we used the original AlphaFold monomer parameters, which were trained on single protein chains, rather than the AlphaFold-Multimer parameter set, whose training set included protein complexes. Each AlphaFold simulation can use a maximum of four templates, allowing for 12 total templates across the three runs (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). These 12 templates are constructed from four templates for each of the pMHC, TCRA, and TCRB chains selected on the basis of sequence identity to the modeling target (<xref ref-type="fig" rid="fig1">Figure 1A</xref>) combined with 12 docking geometry templates. The same four templates per chain are used in each of the three AlphaFold runs; only the docking geometries vary between runs. Thus the full combinatorics of chain templates by docking geometries is not sampled. Peptide-MHC templates are sorted by total sequence identity computed over both the MHC and the peptide. To create hybrid templates for AlphaFold modeling, the pMHC and TCRB template coordinates must be mapped into the coordinate frame of the TCRA template structure. First, the TCR structure from which the TCRB template coordinates are being taken is superimposed onto the TCRA template structure by superimposing the 13 TCRA core residues. Then the superimposed TCRB coordinates are appended to the hybrid template after the TCRA coordinates. To map the pMHC coordinates into the coordinate frame of the TCRA and TCRB coordinates, MHC and TCR coordinate frames are defined as described above, and 12 representative docking geometries are selected. Each docking geometry defines the transformation between the MHC and TCR coordinate frames, allowing the pMHC template coordinates to be mapped into the hybrid template TCR coordinate frame. To choose the 12 representative docking geometries, docking geometries from TCR:pMHC structures of the same MHC class as the target are hierarchically clustered and the clustering tree is cut at a distance threshold at which there are 12 clusters. The docking geometry from each cluster with the smallest mean distance to the other cluster members is chosen as the representative. For hierarchical clustering, a matrix of docking RMSDs (defined below) is provided to the hierarchy.linkage function in the SciPy (<xref ref-type="bibr" rid="bib36">Virtanen et al., 2020</xref>) cluster module. The hierarchy.fcluster function with 'maxclust' criterion is used to select the distance threshold at which the docking geometry tree divides into 12 clusters. Template structures were downloaded from the RCSB Protein Databank (<xref ref-type="bibr" rid="bib5">Berman et al., 2000</xref>) ftp site on 2021-08-05.</p></sec><sec id="s4-3"><title>Fine-tuning AlphaFold for TCR:pMHC structure prediction</title><p>To fine tune the AlphaFold parameters for TCR:pMHC structure prediction, we used a version of the AlphaFold package that was modified slightly to expose the parameter training interface (<xref ref-type="bibr" rid="bib26">Motmaen et al., 2022</xref>). The Python script run_finetuning_for_structure.py in the alphafold_finetune github repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/phbradley/alphafold_finetune">https://github.com/phbradley/alphafold_finetune</ext-link>; <xref ref-type="bibr" rid="bib7">Bradley, 2022a</xref>) with the additional command line flags '<monospace>--model_name model_2_ptm</monospace> <monospace>--crop_size</monospace> 419' was provided with a training set consisting of three runs for each of the 93 human ternary structures (279 total training examples). Due to the small size of the training dataset, training was stopped after two epochs to avoid over-fitting.</p></sec><sec id="s4-4"><title>Structure prediction benchmark</title><p>The structure prediction benchmark set consists of 130 nonredundant ternary TCR:pMHC structures deposited prior to 2021-08-05 (<xref ref-type="supplementary-material" rid="fig2sdata1">Figure 2—source data 1</xref>). No two structures in the set have fewer than 3 peptide mismatches <italic>and</italic> a paired TCRdist (<xref ref-type="bibr" rid="bib9">Dash et al., 2017</xref>) distance less than or equal to 120. This constraint eliminates pairs of structures with the same or similar TCRs binding to the same or similar peptides. After visual inspection, we eliminated the following 9 outlier structures with highly divergent binding modes (reversed docking orientations, extremely bulged peptides, etc.): PDB IDs 5sws, 7jwi, 4jry, 4nhu, 3tjh, 4y19, 4y1a, 1ymm, and 2wbj.</p><p>During benchmarking, we excluded templates and docking geometries that were too similar to the target sequence being modeled. Peptide-MHC templates were excluded if they had fewer than three peptide mismatches with the target peptide. TCR chain templates were excluded if they had a single-chain TCRdist of 36 or less to the target chain (corresponding to three non-conservative mismatches or indels in the CDR3 loop). Docking geometries were excluded if they came from a structure with fewer than three peptide mismatches to the target or a TCRdist of 48 or less from the target TCR.</p></sec><sec id="s4-5"><title>RMSD measures</title><p>We assessed model accuracy by comparing the placement of the CDR loops relative to the MHC in the native and modeled structures. The two structures were first superimposed on the MHC coordinates; then an alpha-carbon RMSD was calculated (without further superposition) over the CDR loops, up-weighting residues in the CDR3 by a factor of 3 to reflect the greater importance of the CDR3 for epitope recognition (this is the 'CDR RMSD' reported in <xref ref-type="fig" rid="fig2">Figure 2</xref>). TCRdist CDR loop definitions were used.</p><p>To compare docking geometries between structures with different CDR loop sequences, we developed a 'docking geometry RMSD' intended to approximate the CDR RMSD in a sequence-independent fashion. The full template database was first used to calculate a mean center of mass of the residues in each CDR loop with respect to the TCR coordinate frame. To compute the docking RMSD between two docking geometries, each docking geometry is used to build a TCR coordinate frame assuming the MHC coordinate frame is centered at the origin and aligned with the coordinate axes. Then the CDR centers of mass are built with respect to each of these two TCR coordinate frames, and an RMSD is calculated between these two sets of eight points (4 CDR centers of mass each for the TCRA and TCRB chains) without superposition, upweighting the CDR3 center of mass by a factor of 3. The correlation between CDR RMSD and docking RMSD is shown in <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>.</p></sec><sec id="s4-6"><title>Epitope decoy discrimination benchmark</title><p>Eight MHC class I epitopes with TCR repertoire data and experimentally determined structures were selected as targets for a decoy discrimination benchmark (<xref ref-type="table" rid="table1">Table 1</xref>). Paired alpha and beta sequences of TCRs specific for these eight epitopes were collected from the literature (<xref ref-type="bibr" rid="bib1">10xGenomics, 2020</xref>; <xref ref-type="bibr" rid="bib9">Dash et al., 2017</xref>; <xref ref-type="bibr" rid="bib11">Francis et al., 2022</xref>; <xref ref-type="bibr" rid="bib23">Minervina et al., 2022</xref>; <xref ref-type="bibr" rid="bib32">Schattgen et al., 2022</xref>; <xref ref-type="bibr" rid="bib33">Shugay et al., 2018</xref>). Epitope-specific TCR repertoires with more than 50 TCRs were subsampled to 50 representatives using a Gaussian kernel density-based algorithm designed to preferentially sample denser regions of TCR space without introducing excessive redundancy (see algorithms_from_the_paper.py in the TCRdock github repository). The goal in sampling denser regions of TCR space was to avoid outlier TCR sequences that might represent experimental errors. 100 additional 'irrelevant' background TCR sequences (50 mouse TCRs and 50 human TCRs) were selected at random from naive CD8 T cells in datasets made publicly available by <xref ref-type="bibr" rid="bib1">10xGenomics, 2020</xref> for human and <ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-vdj/datasets/3.0.0/vdj_v1_mm_balbc_pbmc_5gex">here</ext-link> for mouse. All epitope-specific and background TCR sequences are listed in <xref ref-type="supplementary-material" rid="fig3sdata1">Figure 3—source data 1</xref>.</p><p>The eight MHC class I epitopes include 9 and 10 residue peptides presented by the MHC alleles HLA-A*02:01 and H2-Db. For each MHC and peptide length, 9 decoy peptides were selected by scanning a 1500 residue artificial source antigen sequence with NetMHCpan-4.1 (<xref ref-type="bibr" rid="bib29">Reynisson et al., 2020</xref>) and selecting the top 9 predicted binders (<xref ref-type="supplementary-material" rid="fig3sdata2">Figure 3—source data 2</xref>). The artificial source antigen sequence was created by concatenating the source antigen sequences for the nine benchmark targets (<xref ref-type="table" rid="table1">Table 1</xref>), shuffling, and selecting the first 1500 residues.</p><p>Each epitope-specific TCR was modeled in complex with its cognate peptide epitope and in complex with the nine length- and MHC-matched decoy peptides using the AlphaFold pipeline specialized for TCRs. The mean predicted aligned error (PAE) residue-residue accuracy measure for TCR:pMHC residue pairs was calculated for each complex and stored in an Nx10 matrix, where N is the number of TCRs (each row corresponds to a TCR and each column to a peptide). To convert these raw TCR:pMHC PAE values into a binding score that can be compared across TCRs and pMHCs, we also modeled each pMHC in complex with 50 irrelevant background TCRs from the same organism. The mean TCR:pMHC PAE for these background complexes was calculated for each pMHC and was subtracted from the matrix column of PAE values involving that pMHC. The values in the resulting matrix of adjusted PAE values were then shifted to have 0 row sums by subtracting its mean value from each row. Thus in the final Nx10 matrix of binding scores, the mean value for each row is 0, while the mean values of the columns reflect the overall binding preference of the full repertoire of TCRs for the peptide corresponding to the column ('Repertoire binding score' in <xref ref-type="fig" rid="fig3">Figures 3</xref> and <xref ref-type="fig" rid="fig6">6</xref>).</p><p>During modeling, the TCR- and pMHC-similarity constraints described above in 'Structure Prediction Benchmark' were applied to exclude templates; in addition, ternary structures with a peptide having fewer than three mismatches from the wild type peptide were excluded from all simulations (with decoy or wild type peptides). Note that the original AlphaFold monomer network (model_2_ptm), not the structure fine-tuned network, was used for the epitope specificity benchmark, since the training set used for fine-tuning overlapped with the specificity benchmark targets.</p><p>The epitope alanine-scanning benchmark was performed as described above with the difference that the decoys were single-residue alanine mutants of the wild type peptide (alanine residues in the wild type peptide were mutated to glycine). Thus there were nine decoys for 9-residue peptides and 10 decoys for 10-residue peptides.</p></sec><sec id="s4-7"><title>Software and data availability</title><p>Python software to set up and run the TCR-specialized AlphaFold pipeline described here and to parse TCR:pMHC ternary structures are available in the TCRdock github repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/phbradley/TCRdock">https://github.com/phbradley/TCRdock</ext-link>, copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:1ae0f2747ae6587bb308c3fdcdcf790bc7e26c9a;origin=https://github.com/phbradley/TCRdock;visit=swh:1:snp:69d59008ec0f75b8a0a9c021df0410ab88369817;anchor=swh:1:rev:060bdb4a59391f2d7d57b0f2a923e4b4d6c9a89f">swh:1:rev:060bdb4a59391f2d7d57b0f2a923e4b4d6c9a89f</ext-link>; <xref ref-type="bibr" rid="bib8">Bradley, 2022b</xref>). Benchmark datasets are provided as Source Data for <xref ref-type="fig" rid="fig2">Figures 2</xref> and <xref ref-type="fig" rid="fig3">3</xref>.</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Supervision, Funding acquisition, Validation, Investigation, Visualization, Methodology, Writing - original draft, Project administration, Writing - review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-82813-mdarchecklist1-v1.docx" mimetype="application" mime-subtype="docx"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>The current manuscript is a computational study, so no data have been generated for this manuscript. Benchmark datasets compiled from the literature are made available as Source Data for figures 2 and 3. Modelling code is publicly accessible through the github repository <ext-link ext-link-type="uri" xlink:href="https://github.com/phbradley/TCRdock">https://github.com/phbradley/TCRdock</ext-link>, (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:1ae0f2747ae6587bb308c3fdcdcf790bc7e26c9a;origin=https://github.com/phbradley/TCRdock;visit=swh:1:snp:69d59008ec0f75b8a0a9c021df0410ab88369817;anchor=swh:1:rev:060bdb4a59391f2d7d57b0f2a923e4b4d6c9a89f">swh:1:rev:060bdb4a59391f2d7d57b0f2a923e4b4d6c9a89f</ext-link>).</p></sec><ack id="ack"><title>Acknowledgements</title><p>I am grateful to Jeremy Crawford, Anastasia Minervina, Amir Motmaen, Paul Thomas, and Albert Yeh for helpful comments on the manuscript, to Justas Dauparas for help fine-tuning AlphaFold, to the creators of AlphaFold for freely sharing their software and parameters, and to Fred Hutch Scientific Computing and NIH ORIP S10OD028685 for outstanding computing infrastructure. This research was supported by NIH grants R35 GM141457 and R01 AI136514.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="web"><person-group person-group-type="author"><collab>10xGenomics</collab></person-group><year iso-8601-date="2020">2020</year><article-title>A new way of exploring immunity: linking highly multiplexed antigen recognition to immune repertoire and phenotype</article-title><ext-link ext-link-type="uri" xlink:href="https://pages.10xgenomics.com/rs/446-PBO-704/images/10x_AN047_IP_A_New_Way_of_Exploring_Immunity_Digital.pdf">https://pages.10xgenomics.com/rs/446-PBO-704/images/10x_AN047_IP_A_New_Way_of_Exploring_Immunity_Digital.pdf</ext-link><date-in-citation iso-8601-date="2021-06-01">June 1, 2021</date-in-citation></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baek</surname><given-names>M</given-names></name><name><surname>DiMaio</surname><given-names>F</given-names></name><name><surname>Anishchenko</surname><given-names>I</given-names></name><name><surname>Dauparas</surname><given-names>J</given-names></name><name><surname>Ovchinnikov</surname><given-names>S</given-names></name><name><surname>Lee</surname><given-names>GR</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Cong</surname><given-names>Q</given-names></name><name><surname>Kinch</surname><given-names>LN</given-names></name><name><surname>Schaeffer</surname><given-names>RD</given-names></name><name><surname>Millán</surname><given-names>C</given-names></name><name><surname>Park</surname><given-names>H</given-names></name><name><surname>Adams</surname><given-names>C</given-names></name><name><surname>Glassman</surname><given-names>CR</given-names></name><name><surname>DeGiovanni</surname><given-names>A</given-names></name><name><surname>Pereira</surname><given-names>JH</given-names></name><name><surname>Rodrigues</surname><given-names>AV</given-names></name><name><surname>van Dijk</surname><given-names>AA</given-names></name><name><surname>Ebrecht</surname><given-names>AC</given-names></name><name><surname>Opperman</surname><given-names>DJ</given-names></name><name><surname>Sagmeister</surname><given-names>T</given-names></name><name><surname>Buhlheller</surname><given-names>C</given-names></name><name><surname>Pavkov-Keller</surname><given-names>T</given-names></name><name><surname>Rathinaswamy</surname><given-names>MK</given-names></name><name><surname>Dalwadi</surname><given-names>U</given-names></name><name><surname>Yip</surname><given-names>CK</given-names></name><name><surname>Burke</surname><given-names>JE</given-names></name><name><surname>Garcia</surname><given-names>KC</given-names></name><name><surname>Grishin</surname><given-names>NV</given-names></name><name><surname>Adams</surname><given-names>PD</given-names></name><name><surname>Read</surname><given-names>RJ</given-names></name><name><surname>Baker</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Accurate prediction of protein structures and interactions using a three-track neural network</article-title><source>Science</source><volume>373</volume><fpage>871</fpage><lpage>876</lpage><pub-id pub-id-type="doi">10.1126/science.abj8754</pub-id><pub-id pub-id-type="pmid">34282049</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beringer</surname><given-names>DX</given-names></name><name><surname>Kleijwegt</surname><given-names>FS</given-names></name><name><surname>Wiede</surname><given-names>F</given-names></name><name><surname>van der Slik</surname><given-names>AR</given-names></name><name><surname>Loh</surname><given-names>KL</given-names></name><name><surname>Petersen</surname><given-names>J</given-names></name><name><surname>Dudek</surname><given-names>NL</given-names></name><name><surname>Duinkerken</surname><given-names>G</given-names></name><name><surname>Laban</surname><given-names>S</given-names></name><name><surname>Joosten</surname><given-names>A</given-names></name><name><surname>Vivian</surname><given-names>JP</given-names></name><name><surname>Chen</surname><given-names>Z</given-names></name><name><surname>Uldrich</surname><given-names>AP</given-names></name><name><surname>Godfrey</surname><given-names>DI</given-names></name><name><surname>McCluskey</surname><given-names>J</given-names></name><name><surname>Price</surname><given-names>DA</given-names></name><name><surname>Radford</surname><given-names>KJ</given-names></name><name><surname>Purcell</surname><given-names>AW</given-names></name><name><surname>Nikolic</surname><given-names>T</given-names></name><name><surname>Reid</surname><given-names>HH</given-names></name><name><surname>Tiganis</surname><given-names>T</given-names></name><name><surname>Roep</surname><given-names>BO</given-names></name><name><surname>Rossjohn</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>T cell receptor reversed polarity recognition of a self-antigen major histocompatibility complex</article-title><source>Nature Immunology</source><volume>16</volume><fpage>1153</fpage><lpage>1161</lpage><pub-id pub-id-type="doi">10.1038/ni.3271</pub-id><pub-id pub-id-type="pmid">26437244</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berkhoff</surname><given-names>EGM</given-names></name><name><surname>de Wit</surname><given-names>E</given-names></name><name><surname>Geelhoed-Mieras</surname><given-names>MM</given-names></name><name><surname>Boon</surname><given-names>ACM</given-names></name><name><surname>Symons</surname><given-names>J</given-names></name><name><surname>Fouchier</surname><given-names>RAM</given-names></name><name><surname>Osterhaus</surname><given-names>ADME</given-names></name><name><surname>Rimmelzwaan</surname><given-names>GF</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Functional constraints of influenza A virus epitopes limit escape from cytotoxic T lymphocytes</article-title><source>Journal of Virology</source><volume>79</volume><fpage>11239</fpage><lpage>11246</lpage><pub-id pub-id-type="doi">10.1128/JVI.79.17.11239-11246.2005</pub-id><pub-id pub-id-type="pmid">16103176</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berman</surname><given-names>HM</given-names></name><name><surname>Westbrook</surname><given-names>J</given-names></name><name><surname>Feng</surname><given-names>Z</given-names></name><name><surname>Gilliland</surname><given-names>G</given-names></name><name><surname>Bhat</surname><given-names>TN</given-names></name><name><surname>Weissig</surname><given-names>H</given-names></name><name><surname>Shindyalov</surname><given-names>IN</given-names></name><name><surname>Bourne</surname><given-names>PE</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>The protein data bank</article-title><source>Nucleic Acids Research</source><volume>28</volume><fpage>235</fpage><lpage>242</lpage><pub-id pub-id-type="doi">10.1093/nar/28.1.235</pub-id><pub-id pub-id-type="pmid">10592235</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Borrman</surname><given-names>T</given-names></name><name><surname>Pierce</surname><given-names>BG</given-names></name><name><surname>Vreven</surname><given-names>T</given-names></name><name><surname>Baker</surname><given-names>BM</given-names></name><name><surname>Weng</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>High-throughput modeling and scoring of TCR-pmhc complexes to predict cross-reactive peptides</article-title><source>Bioinformatics</source><volume>36</volume><fpage>5377</fpage><lpage>5385</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btaa1050</pub-id><pub-id pub-id-type="pmid">33355667</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Bradley</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2022">2022a</year><data-title>Alphafold_finetune</data-title><version designator="swh:1:rev:af1f2f7507975ffc734ae57a928786e7f90f93b1">swh:1:rev:af1f2f7507975ffc734ae57a928786e7f90f93b1</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:3e0d466550a96a7eed8e94327b1808aa142e7306;origin=https://github.com/phbradley/alphafold_finetune;visit=swh:1:snp:d9526429d564ae1b7b0a8441adec6d6be4ada724;anchor=swh:1:rev:af1f2f7507975ffc734ae57a928786e7f90f93b1">https://archive.softwareheritage.org/swh:1:dir:3e0d466550a96a7eed8e94327b1808aa142e7306;origin=https://github.com/phbradley/alphafold_finetune;visit=swh:1:snp:d9526429d564ae1b7b0a8441adec6d6be4ada724;anchor=swh:1:rev:af1f2f7507975ffc734ae57a928786e7f90f93b1</ext-link></element-citation></ref><ref id="bib8"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Bradley</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2022">2022b</year><data-title>TCRdock</data-title><version designator="swh:1:rev:060bdb4a59391f2d7d57b0f2a923e4b4d6c9a89f">swh:1:rev:060bdb4a59391f2d7d57b0f2a923e4b4d6c9a89f</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:1ae0f2747ae6587bb308c3fdcdcf790bc7e26c9a;origin=https://github.com/phbradley/TCRdock;visit=swh:1:snp:69d59008ec0f75b8a0a9c021df0410ab88369817;anchor=swh:1:rev:060bdb4a59391f2d7d57b0f2a923e4b4d6c9a89f">https://archive.softwareheritage.org/swh:1:dir:1ae0f2747ae6587bb308c3fdcdcf790bc7e26c9a;origin=https://github.com/phbradley/TCRdock;visit=swh:1:snp:69d59008ec0f75b8a0a9c021df0410ab88369817;anchor=swh:1:rev:060bdb4a59391f2d7d57b0f2a923e4b4d6c9a89f</ext-link></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dash</surname><given-names>P</given-names></name><name><surname>Fiore-Gartland</surname><given-names>AJ</given-names></name><name><surname>Hertz</surname><given-names>T</given-names></name><name><surname>Wang</surname><given-names>GC</given-names></name><name><surname>Sharma</surname><given-names>S</given-names></name><name><surname>Souquette</surname><given-names>A</given-names></name><name><surname>Crawford</surname><given-names>JC</given-names></name><name><surname>Clemens</surname><given-names>EB</given-names></name><name><surname>Nguyen</surname><given-names>THO</given-names></name><name><surname>Kedzierska</surname><given-names>K</given-names></name><name><surname>La Gruta</surname><given-names>NL</given-names></name><name><surname>Bradley</surname><given-names>P</given-names></name><name><surname>Thomas</surname><given-names>PG</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Quantifiable predictive features define epitope-specific T cell receptor repertoires</article-title><source>Nature</source><volume>547</volume><fpage>89</fpage><lpage>93</lpage><pub-id pub-id-type="doi">10.1038/nature22383</pub-id><pub-id pub-id-type="pmid">28636592</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Evans</surname><given-names>R</given-names></name><name><surname>O’Neill</surname><given-names>M</given-names></name><name><surname>Pritzel</surname><given-names>A</given-names></name><name><surname>Antropova</surname><given-names>N</given-names></name><name><surname>Senior</surname><given-names>A</given-names></name><name><surname>Green</surname><given-names>T</given-names></name><name><surname>Žídek</surname><given-names>A</given-names></name><name><surname>Bates</surname><given-names>R</given-names></name><name><surname>Blackwell</surname><given-names>S</given-names></name><name><surname>Yim</surname><given-names>J</given-names></name><name><surname>Ronneberger</surname><given-names>O</given-names></name><name><surname>Bodenstein</surname><given-names>S</given-names></name><name><surname>Zielinski</surname><given-names>M</given-names></name><name><surname>Bridgland</surname><given-names>A</given-names></name><name><surname>Potapenko</surname><given-names>A</given-names></name><name><surname>Cowie</surname><given-names>A</given-names></name><name><surname>Tunyasuvunakool</surname><given-names>K</given-names></name><name><surname>Jain</surname><given-names>R</given-names></name><name><surname>Clancy</surname><given-names>E</given-names></name><name><surname>Kohli</surname><given-names>P</given-names></name><name><surname>Jumper</surname><given-names>J</given-names></name><name><surname>Hassabis</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Protein Complex Prediction with AlphaFold-Multimer</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.10.04.463034</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Francis</surname><given-names>JM</given-names></name><name><surname>Leistritz-Edwards</surname><given-names>D</given-names></name><name><surname>Dunn</surname><given-names>A</given-names></name><name><surname>Tarr</surname><given-names>C</given-names></name><name><surname>Lehman</surname><given-names>J</given-names></name><name><surname>Dempsey</surname><given-names>C</given-names></name><name><surname>Hamel</surname><given-names>A</given-names></name><name><surname>Rayon</surname><given-names>V</given-names></name><name><surname>Liu</surname><given-names>G</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Wille</surname><given-names>M</given-names></name><name><surname>Durkin</surname><given-names>M</given-names></name><name><surname>Hadley</surname><given-names>K</given-names></name><name><surname>Sheena</surname><given-names>A</given-names></name><name><surname>Roscoe</surname><given-names>B</given-names></name><name><surname>Ng</surname><given-names>M</given-names></name><name><surname>Rockwell</surname><given-names>G</given-names></name><name><surname>Manto</surname><given-names>M</given-names></name><name><surname>Gienger</surname><given-names>E</given-names></name><name><surname>Nickerson</surname><given-names>J</given-names></name><collab>MGH COVID-19 Collection and Processing Team</collab><name><surname>Moarefi</surname><given-names>A</given-names></name><name><surname>Noble</surname><given-names>M</given-names></name><name><surname>Malia</surname><given-names>T</given-names></name><name><surname>Bardwell</surname><given-names>PD</given-names></name><name><surname>Gordon</surname><given-names>W</given-names></name><name><surname>Swain</surname><given-names>J</given-names></name><name><surname>Skoberne</surname><given-names>M</given-names></name><name><surname>Sauer</surname><given-names>K</given-names></name><name><surname>Harris</surname><given-names>T</given-names></name><name><surname>Goldrath</surname><given-names>AW</given-names></name><name><surname>Shalek</surname><given-names>AK</given-names></name><name><surname>Coyle</surname><given-names>AJ</given-names></name><name><surname>Benoist</surname><given-names>C</given-names></name><name><surname>Pregibon</surname><given-names>DC</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Allelic variation in class I HLA determines CD8+ T cell repertoire shape and cross-reactive memory responses to SARS-cov-2</article-title><source>Science Immunology</source><volume>7</volume><elocation-id>eabk3070</elocation-id><pub-id pub-id-type="doi">10.1126/sciimmunol.abk3070</pub-id><pub-id pub-id-type="pmid">34793243</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gielis</surname><given-names>S</given-names></name><name><surname>Moris</surname><given-names>P</given-names></name><name><surname>Bittremieux</surname><given-names>W</given-names></name><name><surname>De Neuter</surname><given-names>N</given-names></name><name><surname>Ogunjimi</surname><given-names>B</given-names></name><name><surname>Laukens</surname><given-names>K</given-names></name><name><surname>Meysman</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Detection of enriched T cell epitope specificity in full T cell receptor sequence repertoires</article-title><source>Frontiers in Immunology</source><volume>10</volume><elocation-id>2820</elocation-id><pub-id pub-id-type="doi">10.3389/fimmu.2019.02820</pub-id><pub-id pub-id-type="pmid">31849987</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gras</surname><given-names>S</given-names></name><name><surname>Chadderton</surname><given-names>J</given-names></name><name><surname>Del Campo</surname><given-names>CM</given-names></name><name><surname>Farenc</surname><given-names>C</given-names></name><name><surname>Wiede</surname><given-names>F</given-names></name><name><surname>Josephs</surname><given-names>TM</given-names></name><name><surname>Sng</surname><given-names>XYX</given-names></name><name><surname>Mirams</surname><given-names>M</given-names></name><name><surname>Watson</surname><given-names>KA</given-names></name><name><surname>Tiganis</surname><given-names>T</given-names></name><name><surname>Quinn</surname><given-names>KM</given-names></name><name><surname>Rossjohn</surname><given-names>J</given-names></name><name><surname>La Gruta</surname><given-names>NL</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Reversed T cell receptor docking on a major histocompatibility class I complex limits involvement in the immune response</article-title><source>Immunity</source><volume>45</volume><fpage>749</fpage><lpage>760</lpage><pub-id pub-id-type="doi">10.1016/j.immuni.2016.09.007</pub-id><pub-id pub-id-type="pmid">27717799</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>H</given-names></name><name><surname>Wang</surname><given-names>C</given-names></name><name><surname>Rubelt</surname><given-names>F</given-names></name><name><surname>Scriba</surname><given-names>TJ</given-names></name><name><surname>Davis</surname><given-names>MM</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Analyzing the Mycobacterium tuberculosis immune response by T-cell receptor clustering with GLIPH2 and genome-wide antigen screening</article-title><source>Nature Biotechnology</source><volume>38</volume><fpage>1194</fpage><lpage>1202</lpage><pub-id pub-id-type="doi">10.1038/s41587-020-0505-4</pub-id><pub-id pub-id-type="pmid">32341563</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Humphreys</surname><given-names>IR</given-names></name><name><surname>Pei</surname><given-names>J</given-names></name><name><surname>Baek</surname><given-names>M</given-names></name><name><surname>Krishnakumar</surname><given-names>A</given-names></name><name><surname>Anishchenko</surname><given-names>I</given-names></name><name><surname>Ovchinnikov</surname><given-names>S</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Ness</surname><given-names>TJ</given-names></name><name><surname>Banjade</surname><given-names>S</given-names></name><name><surname>Bagde</surname><given-names>SR</given-names></name><name><surname>Stancheva</surname><given-names>VG</given-names></name><name><surname>Li</surname><given-names>X-H</given-names></name><name><surname>Liu</surname><given-names>K</given-names></name><name><surname>Zheng</surname><given-names>Z</given-names></name><name><surname>Barrero</surname><given-names>DJ</given-names></name><name><surname>Roy</surname><given-names>U</given-names></name><name><surname>Kuper</surname><given-names>J</given-names></name><name><surname>Fernández</surname><given-names>IS</given-names></name><name><surname>Szakal</surname><given-names>B</given-names></name><name><surname>Branzei</surname><given-names>D</given-names></name><name><surname>Rizo</surname><given-names>J</given-names></name><name><surname>Kisker</surname><given-names>C</given-names></name><name><surname>Greene</surname><given-names>EC</given-names></name><name><surname>Biggins</surname><given-names>S</given-names></name><name><surname>Keeney</surname><given-names>S</given-names></name><name><surname>Miller</surname><given-names>EA</given-names></name><name><surname>Fromme</surname><given-names>JC</given-names></name><name><surname>Hendrickson</surname><given-names>TL</given-names></name><name><surname>Cong</surname><given-names>Q</given-names></name><name><surname>Baker</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Computed structures of core eukaryotic protein complexes</article-title><source>Science</source><volume>374</volume><elocation-id>eabm4805</elocation-id><pub-id pub-id-type="doi">10.1126/science.abm4805</pub-id><pub-id pub-id-type="pmid">34762488</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jensen</surname><given-names>KK</given-names></name><name><surname>Rantos</surname><given-names>V</given-names></name><name><surname>Jappe</surname><given-names>EC</given-names></name><name><surname>Olsen</surname><given-names>TH</given-names></name><name><surname>Jespersen</surname><given-names>MC</given-names></name><name><surname>Jurtz</surname><given-names>V</given-names></name><name><surname>Jessen</surname><given-names>LE</given-names></name><name><surname>Lanzarotti</surname><given-names>E</given-names></name><name><surname>Mahajan</surname><given-names>S</given-names></name><name><surname>Peters</surname><given-names>B</given-names></name><name><surname>Nielsen</surname><given-names>M</given-names></name><name><surname>Marcatili</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>TCRpMHCmodels: structural modelling of TCR-pmhc class I complexes</article-title><source>Scientific Reports</source><volume>9</volume><elocation-id>14530</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-019-50932-4</pub-id><pub-id pub-id-type="pmid">31601838</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jumper</surname><given-names>J</given-names></name><name><surname>Evans</surname><given-names>R</given-names></name><name><surname>Pritzel</surname><given-names>A</given-names></name><name><surname>Green</surname><given-names>T</given-names></name><name><surname>Figurnov</surname><given-names>M</given-names></name><name><surname>Ronneberger</surname><given-names>O</given-names></name><name><surname>Tunyasuvunakool</surname><given-names>K</given-names></name><name><surname>Bates</surname><given-names>R</given-names></name><name><surname>Žídek</surname><given-names>A</given-names></name><name><surname>Potapenko</surname><given-names>A</given-names></name><name><surname>Bridgland</surname><given-names>A</given-names></name><name><surname>Meyer</surname><given-names>C</given-names></name><name><surname>Kohl</surname><given-names>SAA</given-names></name><name><surname>Ballard</surname><given-names>AJ</given-names></name><name><surname>Cowie</surname><given-names>A</given-names></name><name><surname>Romera-Paredes</surname><given-names>B</given-names></name><name><surname>Nikolov</surname><given-names>S</given-names></name><name><surname>Jain</surname><given-names>R</given-names></name><name><surname>Adler</surname><given-names>J</given-names></name><name><surname>Back</surname><given-names>T</given-names></name><name><surname>Petersen</surname><given-names>S</given-names></name><name><surname>Reiman</surname><given-names>D</given-names></name><name><surname>Clancy</surname><given-names>E</given-names></name><name><surname>Zielinski</surname><given-names>M</given-names></name><name><surname>Steinegger</surname><given-names>M</given-names></name><name><surname>Pacholska</surname><given-names>M</given-names></name><name><surname>Berghammer</surname><given-names>T</given-names></name><name><surname>Bodenstein</surname><given-names>S</given-names></name><name><surname>Silver</surname><given-names>D</given-names></name><name><surname>Vinyals</surname><given-names>O</given-names></name><name><surname>Senior</surname><given-names>AW</given-names></name><name><surname>Kavukcuoglu</surname><given-names>K</given-names></name><name><surname>Kohli</surname><given-names>P</given-names></name><name><surname>Hassabis</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Highly accurate protein structure prediction with alphafold</article-title><source>Nature</source><volume>596</volume><fpage>583</fpage><lpage>589</lpage><pub-id pub-id-type="doi">10.1038/s41586-021-03819-2</pub-id><pub-id pub-id-type="pmid">34265844</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lanzarotti</surname><given-names>E</given-names></name><name><surname>Marcatili</surname><given-names>P</given-names></name><name><surname>Nielsen</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Identification of the cognate peptide-MHC target of T cell receptors using molecular modeling and force field scoring</article-title><source>Molecular Immunology</source><volume>94</volume><fpage>91</fpage><lpage>97</lpage><pub-id pub-id-type="doi">10.1016/j.molimm.2017.12.019</pub-id><pub-id pub-id-type="pmid">29288899</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leaver-Fay</surname><given-names>A</given-names></name><name><surname>Tyka</surname><given-names>M</given-names></name><name><surname>Lewis</surname><given-names>SM</given-names></name><name><surname>Lange</surname><given-names>OF</given-names></name><name><surname>Thompson</surname><given-names>J</given-names></name><name><surname>Jacak</surname><given-names>R</given-names></name><name><surname>Kaufman</surname><given-names>K</given-names></name><name><surname>Renfrew</surname><given-names>PD</given-names></name><name><surname>Smith</surname><given-names>CA</given-names></name><name><surname>Sheffler</surname><given-names>W</given-names></name><name><surname>Davis</surname><given-names>IW</given-names></name><name><surname>Cooper</surname><given-names>S</given-names></name><name><surname>Treuille</surname><given-names>A</given-names></name><name><surname>Mandell</surname><given-names>DJ</given-names></name><name><surname>Richter</surname><given-names>F</given-names></name><name><surname>Ban</surname><given-names>YEA</given-names></name><name><surname>Fleishman</surname><given-names>SJ</given-names></name><name><surname>Corn</surname><given-names>JE</given-names></name><name><surname>Kim</surname><given-names>DE</given-names></name><name><surname>Bradley</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>ROSETTA3: an object-oriented software suite for the simulation and design of macromolecules</article-title><source>Methods in Enzymology</source><volume>487</volume><fpage>545</fpage><lpage>574</lpage></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>TS</given-names></name><name><surname>Cerutti</surname><given-names>DS</given-names></name><name><surname>Mermelstein</surname><given-names>D</given-names></name><name><surname>Lin</surname><given-names>C</given-names></name><name><surname>LeGrand</surname><given-names>S</given-names></name><name><surname>Giese</surname><given-names>TJ</given-names></name><name><surname>Roitberg</surname><given-names>A</given-names></name><name><surname>Case</surname><given-names>DA</given-names></name><name><surname>Walker</surname><given-names>RC</given-names></name><name><surname>York</surname><given-names>DM</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>GPU-accelerated molecular dynamics and free energy methods in amber18: performance enhancements and new features</article-title><source>Journal of Chemical Information and Modeling</source><volume>58</volume><fpage>2043</fpage><lpage>2050</lpage><pub-id pub-id-type="doi">10.1021/acs.jcim.8b00462</pub-id><pub-id pub-id-type="pmid">30199633</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mayer-Blackwell</surname><given-names>K</given-names></name><name><surname>Schattgen</surname><given-names>S</given-names></name><name><surname>Cohen-Lavi</surname><given-names>L</given-names></name><name><surname>Crawford</surname><given-names>JC</given-names></name><name><surname>Souquette</surname><given-names>A</given-names></name><name><surname>Gaevert</surname><given-names>JA</given-names></name><name><surname>Hertz</surname><given-names>T</given-names></name><name><surname>Thomas</surname><given-names>PG</given-names></name><name><surname>Bradley</surname><given-names>P</given-names></name><name><surname>Fiore-Gartland</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Tcr meta-clonotypes for biomarker discovery with tcrdist3 enabled identification of public, HLA-restricted clusters of SARS-cov-2 tcrs</article-title><source>eLife</source><volume>10</volume><elocation-id>e68605</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.68605</pub-id><pub-id pub-id-type="pmid">34845983</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McInnes</surname><given-names>L</given-names></name><name><surname>Healy</surname><given-names>J</given-names></name><name><surname>Saul</surname><given-names>N</given-names></name><name><surname>Großberger</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>UMAP: uniform manifold approximation and projection</article-title><source>Journal of Open Source Software</source><volume>3</volume><elocation-id>861</elocation-id><pub-id pub-id-type="doi">10.21105/joss.00861</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Minervina</surname><given-names>AA</given-names></name><name><surname>Pogorelyy</surname><given-names>MV</given-names></name><name><surname>Kirk</surname><given-names>AM</given-names></name><name><surname>Crawford</surname><given-names>JC</given-names></name><name><surname>Allen</surname><given-names>EK</given-names></name><name><surname>Chou</surname><given-names>C-H</given-names></name><name><surname>Mettelman</surname><given-names>RC</given-names></name><name><surname>Allison</surname><given-names>KJ</given-names></name><name><surname>Lin</surname><given-names>C-Y</given-names></name><name><surname>Brice</surname><given-names>DC</given-names></name><name><surname>Zhu</surname><given-names>X</given-names></name><name><surname>Vegesana</surname><given-names>K</given-names></name><name><surname>Wu</surname><given-names>G</given-names></name><name><surname>Trivedi</surname><given-names>S</given-names></name><name><surname>Kottapalli</surname><given-names>P</given-names></name><name><surname>Darnell</surname><given-names>D</given-names></name><name><surname>McNeely</surname><given-names>S</given-names></name><name><surname>Olsen</surname><given-names>SR</given-names></name><name><surname>Schultz-Cherry</surname><given-names>S</given-names></name><name><surname>Estepp</surname><given-names>JH</given-names></name><collab>SJTRC Study Team</collab><name><surname>McGargill</surname><given-names>MA</given-names></name><name><surname>Wolf</surname><given-names>J</given-names></name><name><surname>Thomas</surname><given-names>PG</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>SARS-cov-2 antigen exposure history shapes phenotypes and specificity of memory CD8+ T cells</article-title><source>Nature Immunology</source><volume>23</volume><fpage>781</fpage><lpage>790</lpage><pub-id pub-id-type="doi">10.1038/s41590-022-01184-4</pub-id><pub-id pub-id-type="pmid">35383307</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Montemurro</surname><given-names>A</given-names></name><name><surname>Schuster</surname><given-names>V</given-names></name><name><surname>Povlsen</surname><given-names>HR</given-names></name><name><surname>Bentzen</surname><given-names>AK</given-names></name><name><surname>Jurtz</surname><given-names>V</given-names></name><name><surname>Chronister</surname><given-names>WD</given-names></name><name><surname>Crinklaw</surname><given-names>A</given-names></name><name><surname>Hadrup</surname><given-names>SR</given-names></name><name><surname>Winther</surname><given-names>O</given-names></name><name><surname>Peters</surname><given-names>B</given-names></name><name><surname>Jessen</surname><given-names>LE</given-names></name><name><surname>Nielsen</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>NetTCR-2.0 enables accurate prediction of TCR-peptide binding by using paired TCRα and β sequence data</article-title><source>Communications Biology</source><volume>4</volume><elocation-id>1060</elocation-id><pub-id pub-id-type="doi">10.1038/s42003-021-02610-3</pub-id><pub-id pub-id-type="pmid">34508155</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moris</surname><given-names>P</given-names></name><name><surname>De Pauw</surname><given-names>J</given-names></name><name><surname>Postovskaya</surname><given-names>A</given-names></name><name><surname>Gielis</surname><given-names>S</given-names></name><name><surname>De Neuter</surname><given-names>N</given-names></name><name><surname>Bittremieux</surname><given-names>W</given-names></name><name><surname>Ogunjimi</surname><given-names>B</given-names></name><name><surname>Laukens</surname><given-names>K</given-names></name><name><surname>Meysman</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Current challenges for unseen-epitope TCR interaction prediction and a new perspective derived from image classification</article-title><source>Briefings in Bioinformatics</source><volume>22</volume><elocation-id>bbaa318</elocation-id><pub-id pub-id-type="doi">10.1093/bib/bbaa318</pub-id><pub-id pub-id-type="pmid">33346826</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Motmaen</surname><given-names>A</given-names></name><name><surname>Dauparas</surname><given-names>J</given-names></name><name><surname>Baek</surname><given-names>M</given-names></name><name><surname>Abedi</surname><given-names>MH</given-names></name><name><surname>Baker</surname><given-names>D</given-names></name><name><surname>Bradley</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Peptide Binding Specificity Prediction Using Fine-Tuned Protein Structure Prediction Networks</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2022.07.12.499365</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pettmann</surname><given-names>J</given-names></name><name><surname>Huhn</surname><given-names>A</given-names></name><name><surname>Abu Shah</surname><given-names>E</given-names></name><name><surname>Kutuzov</surname><given-names>MA</given-names></name><name><surname>Wilson</surname><given-names>DB</given-names></name><name><surname>Dustin</surname><given-names>ML</given-names></name><name><surname>Davis</surname><given-names>SJ</given-names></name><name><surname>van der Merwe</surname><given-names>PA</given-names></name><name><surname>Dushek</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>The discriminatory power of the T cell receptor</article-title><source>eLife</source><volume>10</volume><elocation-id>e67092</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.67092</pub-id><pub-id pub-id-type="pmid">34030769</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pierce</surname><given-names>BG</given-names></name><name><surname>Weng</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A flexible docking approach for prediction of T cell receptor-peptide-MHC complexes</article-title><source>Protein Science</source><volume>22</volume><fpage>35</fpage><lpage>46</lpage><pub-id pub-id-type="doi">10.1002/pro.2181</pub-id><pub-id pub-id-type="pmid">23109003</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reynisson</surname><given-names>B</given-names></name><name><surname>Alvarez</surname><given-names>B</given-names></name><name><surname>Paul</surname><given-names>S</given-names></name><name><surname>Peters</surname><given-names>B</given-names></name><name><surname>Nielsen</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>NetMHCpan-4.1 and netmhciipan-4.0: improved predictions of MHC antigen presentation by concurrent motif deconvolution and integration of MS MHC eluted ligand data</article-title><source>Nucleic Acids Research</source><volume>48</volume><fpage>W449</fpage><lpage>W454</lpage><pub-id pub-id-type="doi">10.1093/nar/gkaa379</pub-id><pub-id pub-id-type="pmid">32406916</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rossjohn</surname><given-names>J</given-names></name><name><surname>Gras</surname><given-names>S</given-names></name><name><surname>Miles</surname><given-names>JJ</given-names></name><name><surname>Turner</surname><given-names>SJ</given-names></name><name><surname>Godfrey</surname><given-names>DI</given-names></name><name><surname>McCluskey</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>T cell antigen receptor recognition of antigen-presenting molecules</article-title><source>Annual Review of Immunology</source><volume>33</volume><fpage>169</fpage><lpage>200</lpage><pub-id pub-id-type="doi">10.1146/annurev-immunol-032414-112334</pub-id><pub-id pub-id-type="pmid">25493333</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rudolph</surname><given-names>MG</given-names></name><name><surname>Stanfield</surname><given-names>RL</given-names></name><name><surname>Wilson</surname><given-names>IA</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>How tcrs bind mhcs, peptides, and coreceptors</article-title><source>Annual Review of Immunology</source><volume>24</volume><fpage>419</fpage><lpage>466</lpage><pub-id pub-id-type="doi">10.1146/annurev.immunol.23.021704.115658</pub-id><pub-id pub-id-type="pmid">16551255</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schattgen</surname><given-names>SA</given-names></name><name><surname>Guion</surname><given-names>K</given-names></name><name><surname>Crawford</surname><given-names>JC</given-names></name><name><surname>Souquette</surname><given-names>A</given-names></name><name><surname>Barrio</surname><given-names>AM</given-names></name><name><surname>Stubbington</surname><given-names>MJT</given-names></name><name><surname>Thomas</surname><given-names>PG</given-names></name><name><surname>Bradley</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Integrating T cell receptor sequences and transcriptional profiles by clonotype neighbor graph analysis (conga)</article-title><source>Nature Biotechnology</source><volume>40</volume><fpage>54</fpage><lpage>63</lpage><pub-id pub-id-type="doi">10.1038/s41587-021-00989-2</pub-id><pub-id pub-id-type="pmid">34426704</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shugay</surname><given-names>M</given-names></name><name><surname>Bagaev</surname><given-names>DV</given-names></name><name><surname>Zvyagin</surname><given-names>IV</given-names></name><name><surname>Vroomans</surname><given-names>RM</given-names></name><name><surname>Crawford</surname><given-names>JC</given-names></name><name><surname>Dolton</surname><given-names>G</given-names></name><name><surname>Komech</surname><given-names>EA</given-names></name><name><surname>Sycheva</surname><given-names>AL</given-names></name><name><surname>Koneva</surname><given-names>AE</given-names></name><name><surname>Egorov</surname><given-names>ES</given-names></name><name><surname>Eliseev</surname><given-names>AV</given-names></name><name><surname>Van Dyk</surname><given-names>E</given-names></name><name><surname>Dash</surname><given-names>P</given-names></name><name><surname>Attaf</surname><given-names>M</given-names></name><name><surname>Rius</surname><given-names>C</given-names></name><name><surname>Ladell</surname><given-names>K</given-names></name><name><surname>McLaren</surname><given-names>JE</given-names></name><name><surname>Matthews</surname><given-names>KK</given-names></name><name><surname>Clemens</surname><given-names>EB</given-names></name><name><surname>Douek</surname><given-names>DC</given-names></name><name><surname>Luciani</surname><given-names>F</given-names></name><name><surname>van Baarle</surname><given-names>D</given-names></name><name><surname>Kedzierska</surname><given-names>K</given-names></name><name><surname>Kesmir</surname><given-names>C</given-names></name><name><surname>Thomas</surname><given-names>PG</given-names></name><name><surname>Price</surname><given-names>DA</given-names></name><name><surname>Sewell</surname><given-names>AK</given-names></name><name><surname>Chudakov</surname><given-names>DM</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>VDJdb: a curated database of T-cell receptor sequences with known antigen specificity</article-title><source>Nucleic Acids Research</source><volume>46</volume><fpage>D419</fpage><lpage>D427</lpage><pub-id pub-id-type="doi">10.1093/nar/gkx760</pub-id><pub-id pub-id-type="pmid">28977646</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Singh</surname><given-names>NK</given-names></name><name><surname>Riley</surname><given-names>TP</given-names></name><name><surname>Baker</surname><given-names>SCB</given-names></name><name><surname>Borrman</surname><given-names>T</given-names></name><name><surname>Weng</surname><given-names>Z</given-names></name><name><surname>Baker</surname><given-names>BM</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Emerging concepts in TCR specificity: rationalizing and (maybe) predicting outcomes</article-title><source>Journal of Immunology</source><volume>199</volume><fpage>2203</fpage><lpage>2213</lpage><pub-id pub-id-type="doi">10.4049/jimmunol.1700744</pub-id><pub-id pub-id-type="pmid">28923982</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Valkenburg</surname><given-names>SA</given-names></name><name><surname>Quiñones-Parra</surname><given-names>S</given-names></name><name><surname>Gras</surname><given-names>S</given-names></name><name><surname>Komadina</surname><given-names>N</given-names></name><name><surname>McVernon</surname><given-names>J</given-names></name><name><surname>Wang</surname><given-names>Z</given-names></name><name><surname>Halim</surname><given-names>H</given-names></name><name><surname>Iannello</surname><given-names>P</given-names></name><name><surname>Cole</surname><given-names>C</given-names></name><name><surname>Laurie</surname><given-names>K</given-names></name><name><surname>Kelso</surname><given-names>A</given-names></name><name><surname>Rossjohn</surname><given-names>J</given-names></name><name><surname>Doherty</surname><given-names>PC</given-names></name><name><surname>Turner</surname><given-names>SJ</given-names></name><name><surname>Kedzierska</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Acute emergence and reversion of influenza A virus quasispecies within CD8+ T cell antigenic peptides</article-title><source>Nature Communications</source><volume>4</volume><elocation-id>2663</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms3663</pub-id><pub-id pub-id-type="pmid">24173108</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Virtanen</surname><given-names>P</given-names></name><name><surname>Gommers</surname><given-names>R</given-names></name><name><surname>Oliphant</surname><given-names>TE</given-names></name><name><surname>Haberland</surname><given-names>M</given-names></name><name><surname>Reddy</surname><given-names>T</given-names></name><name><surname>Cournapeau</surname><given-names>D</given-names></name><name><surname>Burovski</surname><given-names>E</given-names></name><name><surname>Peterson</surname><given-names>P</given-names></name><name><surname>Weckesser</surname><given-names>W</given-names></name><name><surname>Bright</surname><given-names>J</given-names></name><name><surname>van der Walt</surname><given-names>SJ</given-names></name><name><surname>Brett</surname><given-names>M</given-names></name><name><surname>Wilson</surname><given-names>J</given-names></name><name><surname>Millman</surname><given-names>KJ</given-names></name><name><surname>Mayorov</surname><given-names>N</given-names></name><name><surname>Nelson</surname><given-names>ARJ</given-names></name><name><surname>Jones</surname><given-names>E</given-names></name><name><surname>Kern</surname><given-names>R</given-names></name><name><surname>Larson</surname><given-names>E</given-names></name><name><surname>Carey</surname><given-names>CJ</given-names></name><name><surname>Polat</surname><given-names>İ</given-names></name><name><surname>Feng</surname><given-names>Y</given-names></name><name><surname>Moore</surname><given-names>EW</given-names></name><name><surname>VanderPlas</surname><given-names>J</given-names></name><name><surname>Laxalde</surname><given-names>D</given-names></name><name><surname>Perktold</surname><given-names>J</given-names></name><name><surname>Cimrman</surname><given-names>R</given-names></name><name><surname>Henriksen</surname><given-names>I</given-names></name><name><surname>Quintero</surname><given-names>EA</given-names></name><name><surname>Harris</surname><given-names>CR</given-names></name><name><surname>Archibald</surname><given-names>AM</given-names></name><name><surname>Ribeiro</surname><given-names>AH</given-names></name><name><surname>Pedregosa</surname><given-names>F</given-names></name><name><surname>van Mulbregt</surname><given-names>P</given-names></name><collab>SciPy 1.0 Contributors</collab></person-group><year iso-8601-date="2020">2020</year><article-title>SciPy 1.0: fundamental algorithms for scientific computing in python</article-title><source>Nature Methods</source><volume>17</volume><fpage>261</fpage><lpage>272</lpage><pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id><pub-id pub-id-type="pmid">32015543</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wölfl</surname><given-names>M</given-names></name><name><surname>Rutebemberwa</surname><given-names>A</given-names></name><name><surname>Mosbruger</surname><given-names>T</given-names></name><name><surname>Mao</surname><given-names>Q</given-names></name><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Netski</surname><given-names>D</given-names></name><name><surname>Ray</surname><given-names>SC</given-names></name><name><surname>Pardoll</surname><given-names>D</given-names></name><name><surname>Sidney</surname><given-names>J</given-names></name><name><surname>Sette</surname><given-names>A</given-names></name><name><surname>Allen</surname><given-names>T</given-names></name><name><surname>Kuntzen</surname><given-names>T</given-names></name><name><surname>Kavanagh</surname><given-names>DG</given-names></name><name><surname>Kuball</surname><given-names>J</given-names></name><name><surname>Greenberg</surname><given-names>PD</given-names></name><name><surname>Cox</surname><given-names>AL</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Hepatitis C virus immune escape via exploitation of a hole in the T cell repertoire</article-title><source>Journal of Immunology</source><volume>181</volume><fpage>6435</fpage><lpage>6446</lpage><pub-id pub-id-type="doi">10.4049/jimmunol.181.9.6435</pub-id><pub-id pub-id-type="pmid">18941234</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yin</surname><given-names>R</given-names></name><name><surname>Feng</surname><given-names>BY</given-names></name><name><surname>Varshney</surname><given-names>A</given-names></name><name><surname>Pierce</surname><given-names>BG</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Benchmarking alphafold for protein complex modeling reveals accuracy determinants</article-title><source>Protein Science</source><volume>31</volume><elocation-id>e4379</elocation-id><pub-id pub-id-type="doi">10.1002/pro.4379</pub-id><pub-id pub-id-type="pmid">35900023</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zareie</surname><given-names>P</given-names></name><name><surname>Szeto</surname><given-names>C</given-names></name><name><surname>Farenc</surname><given-names>C</given-names></name><name><surname>Gunasinghe</surname><given-names>SD</given-names></name><name><surname>Kolawole</surname><given-names>EM</given-names></name><name><surname>Nguyen</surname><given-names>A</given-names></name><name><surname>Blyth</surname><given-names>C</given-names></name><name><surname>Sng</surname><given-names>XYX</given-names></name><name><surname>Li</surname><given-names>J</given-names></name><name><surname>Jones</surname><given-names>CM</given-names></name><name><surname>Fulcher</surname><given-names>AJ</given-names></name><name><surname>Jacobs</surname><given-names>JR</given-names></name><name><surname>Wei</surname><given-names>Q</given-names></name><name><surname>Wojciech</surname><given-names>L</given-names></name><name><surname>Petersen</surname><given-names>J</given-names></name><name><surname>Gascoigne</surname><given-names>NRJ</given-names></name><name><surname>Evavold</surname><given-names>BD</given-names></name><name><surname>Gaus</surname><given-names>K</given-names></name><name><surname>Gras</surname><given-names>S</given-names></name><name><surname>Rossjohn</surname><given-names>J</given-names></name><name><surname>La Gruta</surname><given-names>NL</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Canonical T cell receptor docking on peptide-MHC is essential for T cell signaling</article-title><source>Science</source><volume>372</volume><elocation-id>eabe9124</elocation-id><pub-id pub-id-type="doi">10.1126/science.abe9124</pub-id><pub-id pub-id-type="pmid">34083463</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.82813.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Dustin</surname><given-names>Michael L</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/052gg0110</institution-id><institution>University of Oxford</institution></institution-wrap><country>United Kingdom</country></aff></contrib></contrib-group><related-object id="sa0ro1" object-id-type="id" object-id="10.1101/2022.08.05.503004" link-type="continued-by" xlink:href="https://sciety.org/articles/activity/10.1101/2022.08.05.503004"/></front-stub><body><p>The study provides a significant step forward in the prediction of T cell receptor docking to peptide-major histocompatibility complex ligands using a specialised version of the deep neural network structure prediction program AlphaFold. Progress towards this goal has implications for vaccine development, and cancer immunotherapy and is an intrinsically interesting structural problem due to the variability of the T cell receptor scaffold.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.82813.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Dustin</surname><given-names>Michael L</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/052gg0110</institution-id><institution>University of Oxford</institution></institution-wrap><country>United Kingdom</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Dustin</surname><given-names>Michael L</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/052gg0110</institution-id><institution>University of Oxford</institution></institution-wrap><country>United Kingdom</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>Our editorial process produces two outputs: (i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2022.08.05.503004">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2022.08.05.503004v1">the preprint</ext-link> for the benefit of readers; (ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Structure-based prediction of T cell receptor:peptide-MHC interactions&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, including Michael L Dustin as Reviewing Editor and Reviewer #1, and the evaluation has been overseen by Tadatsugu Taniguchi as the Senior Editor.</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>Please see the comments from each reviewer and the specific recommendations. Please address the points with an emphasis on revisions that will clarify and quantify the strengths of the approach without overstatement and that clarify limitations to identify areas requiring further innovation. Any opportunity to use existing data to check predictions should be prioritised.</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>No specific recommendations. In addition to alanine scans, interesting peptide libraries have been developed by changing key residues to all other residues to look for useful altered peptide ligands. Does this version of α fold do well in predicting known APC series- for altered peptide ligand series for OT1 or 1G4 TCR? This is another limited problem where there are currently labor-intensive experimental approaches that might be accelerated by reliable structural predictions.</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>Bradley has made a bold step forward here. Yes, TCR-pMHC structure predictions are fraught with danger and have historically been treated with healthy scepticism (and rightly so). However, we need to make a foray into this space – the number of paired TCR sequences is increasing exponentially, but the number of unique experimentally determined TCR-pMHC structures has plateaued. This is an issue for the field. While an argument could be easily made that the experimental data set is insufficient and biased (and it is), I cannot see the experimental data set increasing sufficiently in the next decade – thus someone needs to make a tentative, yet credible step in this direction. The manuscript is clearly lacking any experimental validation of novel predictions – and this represents a key weakness – but the manuscript has merits and will stimulate the field.</p><p>1) One major concern is the extent to which biases within the training data would undoubtedly influence predictions – there is clearly an overrepresentation of TCR ternary complexes for HLA-A*02 and H2-Db, for example. How many 'unique' TCR-pMHC complexes out of the limited data set have been determined and what is the functional definition of unique? I feel a graphic highlighting the bias of the current experimental data set in a class I and class II setting would be worthwhile, and discussions surrounding these limitations would be prudent.</p><p>2) A key question is whether 'close enough is good enough' regarding structural predictions. In TCR-pMHC structures, subtle shifts in structures (eg &lt; 1A) can be the difference between immune recognition or not. Thus a seemingly close prediction could still miss the mark – this needs reflection.</p><p>3) It is also an obvious choice to exclude bulged or longer peptides from the class I modelling in this preliminary work. Typical peptidome data suggests that ~60-80% of HLA-I eluted peptides are 8-11aa long. However, this also means there is an over-representation of shorter epitopes within structural databases (excluding class II). Can the author, therefore, include a comment in the discussion about the extent to which removing the longer peptides might bias the final output towards recapitulating known docking topologies? Would a Docking RMSD vs epitope length be informative? Is modelling more likely to fail as epitopes get larger?</p><p>4) There are far more high-resolution pMHC complexes in isolation than co-complexed TCR structures. A complicating factor for modelling of TCR:pMHC complexes will be that any errors modelling epitope structure, particularly in defining which residues project outward will obviously cascade into docking errors. Is it possible to utilise this larger pool of high-resolution structures to better characterise RMSD in peptide modelling?</p><p>5) That is can we better understand for which epitopes the modelling pipeline is likely to fail? Bradley has defined cases in which TCR docking topologies diverge. Does the author envisage, or have they tested, similar conditions for which the peptide structure may also fail to be correctly modelled? For example, cases such as PDB: 5T6X where point-mutations in the P3 position drastically alter epitope shape. Or longer epitopes containing helical turns (e.g. 6AVF).</p><p>6) Bradley rightly mentions one reversed TCR-pMHC-I docking structure. The original reference is Gras et al. Immunity 2016. Note, there is another reversed structure, TCR-pMHC-II (Beringer et al. NI 2015). Further, as the TCR-pMHC class I docking topologies are very diverse (over 80 degrees – ignoring the reversed docking), there are likely to be many more outliers/poorly modelled ternary complexes beyond the reversed dockers.</p><p>The paper is generally well-written and has easy-to-understand figures. The multiple uses of &quot;we&quot; in the abstract comes across oddly with only a single author.</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>1. For Figure S1, the gray points do not seem to be specifically described in the figure legend or key. The author should specify what the gray points represent, to avoid ambiguity.</p><p>2. Results: &quot;predicted models had displace peptides&quot; should be &quot;predicted models had displaced peptides&quot;.</p><p>3. Figures 2 and 5 show RMSD values, but the axis labels do not have units (presumably Ångstroms) shown. Appropriate units should be added to all axis labels that are reporting RMSD values.</p><p>4. The plot in Figure 2D uses the same colors as Figure 2A and 2B to represent different methods than those panels. The author should change the colors in order not to confuse readers (AF_TCR can be green, AF_TCR finetuned can be some other color).</p><p>5. In another study by the author focused on peptide-MHC modeling and reporting the AF finetuning method, the authors appeared to use model_1 and model_2 from AlphaFold, which both utilize templates. However, in this study, the author only appears to use model_2. The author should briefly note why this was done and model_1 was not used here.</p><p>6. The author states: &quot;There was a strong positive correlation between predicted and observed model accuracy (Figure 2C).&quot;. The author should remove (or replace) &quot;strong&quot; there, as the correlation does not seem strong based on the value (r = 0.484) or visual inspection.</p><p>7. It is not clear where the results for the 50 non-binding TCRs are given in any of the figures. If these results are not given, they should be added in the revision, or else the note regarding that set should be removed to avoid confusion.</p><p>8. In the &quot;Binding specificity prediction&quot; section of the Results, the statement: &quot;It also lets us investigate a scenario in which we are given not one TCR, but a set of TCRs that all recognize the same epitope, and we consider the extent to which this helps to constrain the target epitope.&quot; It seems that if TCRs are known for certain to bind the same epitope, that would be due to an experimental assay that already assesses epitope specificity. Based on the sentence that follows the above sentence, it seems that the author means that the TCRs are inferred to bind the same epitope based on sequence similarity or clustering. If this is the case, the above sentence should be modified to clarify this distinction for readers, e.g. &quot;…a set of TCRs that are predicted to recognize the same epitope…&quot;.</p><p>9. In the Methods, the author notes: &quot;100 additional 'irrelevant' TCR sequences (50 mouse TCRs and 50 human TCRs) were selected at random from naive CD8 T cells in datasets made publicly available by 10X Genomics (https://www.10xgenomics.com/resources/datasets).&quot; As 10X has many datasets available through that set, the author should specify the specific datasets being utilized for this. The &quot;A new way of exploring immunity&quot; 10X dataset (included by the author in the References) seems to be a part of this, but it seems to be human only and would not contain the 50 murine TCRs.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.82813.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Reviewer #1 (Recommendations for the authors):</p><p>No specific recommendations. In addition to alanine scans, interesting peptide libraries have been developed by changing key residues to all other residues to look for useful altered peptide ligands. Does this version of α fold do well in predicting known APC series- for altered peptide ligand series for OT1 or 1G4 TCR? This is another limited problem where there are currently labor-intensive experimental approaches that might be accelerated by reliable structural predictions.</p></disp-quote><p>This is an excellent suggestion. I looked at two examples of APL series with recently published binding data and available structures, for the 1G4 and A6 TCRs (Pettmann et al., <italic>eLife</italic> 2021), as well as T cell activation data for alanine mutants of the Flu M1<sub>58</sub> epitope (Berkhoff et al., JVI 2005). The results for 1G4 and A6 are not great: with all template information from related structures excluded from the modeling (as was done for the calculations in the main text), there is very little correlation between prediction and experiment, and the structures are also not well-modeled (Figure 6, supplement 1A). If we don't filter out related templates, we see improved structural models (lower docking RMSDs) and a modest but still imperfect correlation between predicted and experimental binding (Figure 6, supplement 1B). This highlights the importance of structural modeling accuracy in binding prediction, as well as the variable performance of the network in this challenging setting of a single TCR binding to multiple highly similar peptides. With a single TCR, rather than a family of related TCRs (as in the epitope decoy discrimination benchmark), there is no opportunity to leverage consensus to average out noise. Better results were seen for the M1<sub>58</sub> epitope scanning data: predicted binding affinity correlated with levels of T cell activation, albeit still imperfectly.</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>Bradley has made a bold step forward here. Yes, TCR-pMHC structure predictions are fraught with danger and have historically been treated with healthy scepticism (and rightly so). However, we need to make a foray into this space – the number of paired TCR sequences is increasing exponentially, but the number of unique experimentally determined TCR-pMHC structures has plateaued. This is an issue for the field. While an argument could be easily made that the experimental data set is insufficient and biased (and it is), I cannot see the experimental data set increasing sufficiently in the next decade – thus someone needs to make a tentative, yet credible step in this direction. The manuscript is clearly lacking any experimental validation of novel predictions – and this represents a key weakness – but the manuscript has merits and will stimulate the field.</p><p>1) One major concern is the extent to which biases within the training data would undoubtedly influence predictions – there is clearly an overrepresentation of TCR ternary complexes for HLA-A*02 and H2-Db, for example. How many 'unique' TCR-pMHC complexes out of the limited data set have been determined and what is the functional definition of unique? I feel a graphic highlighting the bias of the current experimental data set in a class I and class II setting would be worthwhile, and discussions surrounding these limitations would be prudent.</p></disp-quote><p>This is a great suggestion. I've added a new figure (Figure 2, supplement 1) showing the composition of the ternary structure database, for two definitions of redundancy and with respect to three features: species of origin, MHC allele, and peptide length. In the first definition of redundancy (&quot;Set 1&quot;), two TCR:pMHC complexes are considered redundant if the peptides are similar (&lt; 3 mismatches) <italic>and</italic> the TCRs are similar (paired TCRdist&lt;=120). This yields a set of 130 complexes. In the second definition of redundancy (&quot;Set 2&quot;), two TCR:pMHC complexes are considered redundant if the peptides are similar <italic>or</italic> the TCRs are similar. This definition yields a set of 64 complexes.</p><disp-quote content-type="editor-comment"><p>2) A key question is whether 'close enough is good enough' regarding structural predictions. In TCR-pMHC structures, subtle shifts in structures (eg &lt; 1A) can be the difference between immune recognition or not. Thus a seemingly close prediction could still miss the mark – this needs reflection.</p></disp-quote><p>I completely agree: larger numbers of systems and more detailed structural metrics will be necessary to fully understand the method's performance in epitope specificity prediction. I do think that we can conclusively say that this approach is an improvement over the state of the art (AlphaFold multimer and TCRpMHCmodels) in TCR:pMHC ternary structure prediction. From that perspective, the application to epitope prediction, albeit imperfect, represents an important benchmark test.</p><disp-quote content-type="editor-comment"><p>3) It is also an obvious choice to exclude bulged or longer peptides from the class I modelling in this preliminary work. Typical peptidome data suggests that ~60-80% of HLA-I eluted peptides are 8-11aa long. However, this also means there is an over-representation of shorter epitopes within structural databases (excluding class II). Can the author, therefore, include a comment in the discussion about the extent to which removing the longer peptides might bias the final output towards recapitulating known docking topologies? Would a Docking RMSD vs epitope length be informative? Is modelling more likely to fail as epitopes get larger?</p></disp-quote><p>This is an important point. I've added an analysis of peptide backbone and CDR RMSDs broken down by peptide length. For the AF_TCR pipeline, it does look as if the longest peptides in the benchmark (13mers) are modeled rather poorly, but the counts are small.</p><disp-quote content-type="editor-comment"><p>4) There are far more high-resolution pMHC complexes in isolation than co-complexed TCR structures. A complicating factor for modelling of TCR:pMHC complexes will be that any errors modelling epitope structure, particularly in defining which residues project outward will obviously cascade into docking errors. Is it possible to utilise this larger pool of high-resolution structures to better characterise RMSD in peptide modelling?</p></disp-quote><p>Currently these pMHC complexes are being used as templates for the peptide:MHC components. It would be interesting to conduct a more thorough analysis of pMHC structure predictions with these new tools. We look at this a little bit in our peptide-MHC &quot;fine-tuning&quot; paper (Motmaen et al., bioRxiv 2022), but not too deeply since the main focus is on peptide-MHC binding predictions. I also believe that a comprehensive look at pMHC structure modeling is outside the scope of the present paper, but it will be an important step for future work.</p><disp-quote content-type="editor-comment"><p>5) That is can we better understand for which epitopes the modelling pipeline is likely to fail? Bradley has defined cases in which TCR docking topologies diverge. Does the author envisage, or have they tested, similar conditions for which the peptide structure may also fail to be correctly modelled? For example, cases such as PDB: 5T6X where point-mutations in the P3 position drastically alter epitope shape. Or longer epitopes containing helical turns (e.g. 6AVF).</p></disp-quote><p>The analysis of peptide backbone RMSD versus CDR RMSD (Figure 2, supplement 2) gives some insight into this, and it does look as if poor peptide structure predictions tend to have worse interface predictions, although this feature is not assigned a significant <italic>P</italic> value in the linear regression model (Figure 2, supplement 6).</p><disp-quote content-type="editor-comment"><p>6) Bradley rightly mentions one reversed TCR-pMHC-I docking structure. The original reference is Gras et al. Immunity 2016. Note, there is another reversed structure, TCR-pMHC-II (Beringer et al. NI 2015). Further, as the TCR-pMHC class I docking topologies are very diverse (over 80 degrees – ignoring the reversed docking), there are likely to be many more outliers/poorly modelled ternary complexes beyond the reversed dockers.</p></disp-quote><p>I completely agree: the reversed orientation structures are striking outliers, but there are many less-extreme outliers that will likely be poorly modeled by the current protocol. This is nicely illustrated in Figure 2, supplement 6, top left panel, which looks at the correlation between a docking geometry &quot;outlier Z-score&quot; and docking accuracy. More generally, I think TCR structure or binding prediction will always be, at best, an 80% proposition: we can hope for good predictions of the well-behaved 60/70/80% of TCRs, but there will always be challenging cases with long CDR3s/long peptides/divergent binding modes. The key will be to develop robust confidence measures so that we can tell when the predictions are reliable.</p><disp-quote content-type="editor-comment"><p>The paper is generally well-written and has easy-to-understand figures. The multiple uses of &quot;we&quot; in the abstract comes across oddly with only a single author.</p></disp-quote><p>I agree. But it felt even stranger to rewrite the whole thing in the first person singular or avoid first person entirely.</p><disp-quote content-type="editor-comment"><p>Reviewer #3 (Recommendations for the authors):</p><p>1. For Figure S1, the gray points do not seem to be specifically described in the figure legend or key. The author should specify what the gray points represent, to avoid ambiguity.</p></disp-quote><p>This has been fixed.</p><disp-quote content-type="editor-comment"><p>2. Results: &quot;predicted models had displace peptides&quot; should be &quot;predicted models had displaced peptides&quot;.</p></disp-quote><p>This has been fixed.</p><disp-quote content-type="editor-comment"><p>3. Figures 2 and 5 show RMSD values, but the axis labels do not have units (presumably Ångstroms) shown. Appropriate units should be added to all axis labels that are reporting RMSD values.</p></disp-quote><p>This has been fixed.</p><disp-quote content-type="editor-comment"><p>4. The plot in Figure 2D uses the same colors as Figure 2A and 2B to represent different methods than those panels. The author should change the colors in order not to confuse readers (AF_TCR can be green, AF_TCR finetuned can be some other color).</p></disp-quote><p>This has been fixed.</p><disp-quote content-type="editor-comment"><p>5. In another study by the author focused on peptide-MHC modeling and reporting the AF finetuning method, the authors appeared to use model_1 and model_2 from AlphaFold, which both utilize templates. However, in this study, the author only appears to use model_2. The author should briefly note why this was done and model_1 was not used here.</p></disp-quote><p>This has been fixed. We're actually using model_2_ptm now also in the pMHC work, and whenever we need the 'PAE' pairwise confidence measures (although model_1_ptm performs very similarly).</p><disp-quote content-type="editor-comment"><p>6. The author states: &quot;There was a strong positive correlation between predicted and observed model accuracy (Figure 2C).&quot;. The author should remove (or replace) &quot;strong&quot; there, as the correlation does not seem strong based on the value (r = 0.484) or visual inspection.</p></disp-quote><p>I replaced &quot;strong&quot; with &quot;significant&quot;.</p><disp-quote content-type="editor-comment"><p>7. It is not clear where the results for the 50 non-binding TCRs are given in any of the figures. If these results are not given, they should be added in the revision, or else the note regarding that set should be removed to avoid confusion.</p></disp-quote><p>These background TCRs were used to normalize for pMHC-intrinsic effects. I've added a bit of text to the results to clarify this.</p><disp-quote content-type="editor-comment"><p>8. In the &quot;Binding specificity prediction&quot; section of the Results, the statement: &quot;It also lets us investigate a scenario in which we are given not one TCR, but a set of TCRs that all recognize the same epitope, and we consider the extent to which this helps to constrain the target epitope.&quot; It seems that if TCRs are known for certain to bind the same epitope, that would be due to an experimental assay that already assesses epitope specificity. Based on the sentence that follows the above sentence, it seems that the author means that the TCRs are inferred to bind the same epitope based on sequence similarity or clustering. If this is the case, the above sentence should be modified to clarify this distinction for readers, e.g. &quot;…a set of TCRs that are predicted to recognize the same epitope…&quot;.</p></disp-quote><p>Great point-- I've changed the wording as suggested.</p><disp-quote content-type="editor-comment"><p>9. In the Methods, the author notes: &quot;100 additional 'irrelevant' TCR sequences (50 mouse TCRs and 50 human TCRs) were selected at random from naive CD8 T cells in datasets made publicly available by 10X Genomics (https://www.10xgenomics.com/resources/datasets).&quot; As 10X has many datasets available through that set, the author should specify the specific datasets being utilized for this. The &quot;A new way of exploring immunity&quot; 10X dataset (included by the author in the References) seems to be a part of this, but it seems to be human only and would not contain the 50 murine TCRs.</p></disp-quote><p>This has been fixed.</p><p>Again, I really appreciate the detailed comments and corrections from all the reviewers. Thank you!</p></body></sub-article></article>