<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">57541</article-id><article-id pub-id-type="doi">10.7554/eLife.57541</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Learning prediction error neurons in a canonical interneuron circuit</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-121262"><name><surname>Hertäg</surname><given-names>Loreen</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7838-3361</contrib-id><email>loreen.hertaeg@tu-berlin.de</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-43434"><name><surname>Sprekeler</surname><given-names>Henning</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0690-3553</contrib-id><email>h.sprekeler@tu-berlin.de</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>Modelling of Cognitive Processes, Institute of Software Engineering and Theoretical Computer Science, Berlin Institute of Technology</institution><addr-line><named-content content-type="city">Berlin</named-content></addr-line><country>Germany</country></aff><aff id="aff2"><label>2</label><institution>Bernstein Center for Computational Neuroscience</institution><addr-line><named-content content-type="city">Berlin</named-content></addr-line><country>Germany</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Ostojic</surname><given-names>Srdjan</given-names></name><role>Reviewing Editor</role><aff><institution>Ecole Normale Superieure Paris</institution><country>France</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Ivry</surname><given-names>Richard B</given-names></name><role>Senior Editor</role><aff><institution>University of California, Berkeley</institution><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>21</day><month>08</month><year>2020</year></pub-date><pub-date pub-type="collection"><year>2020</year></pub-date><volume>9</volume><elocation-id>e57541</elocation-id><history><date date-type="received" iso-8601-date="2020-04-03"><day>03</day><month>04</month><year>2020</year></date><date date-type="accepted" iso-8601-date="2020-07-28"><day>28</day><month>07</month><year>2020</year></date></history><permissions><copyright-statement>© 2020, Hertäg and Sprekeler</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>Hertäg and Sprekeler</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-57541-v1.pdf"/><abstract><p>Sensory systems constantly compare external sensory information with internally generated predictions. While neural hallmarks of prediction errors have been found throughout the brain, the circuit-level mechanisms that underlie their computation are still largely unknown. Here, we show that a well-orchestrated interplay of three interneuron types shapes the development and refinement of negative prediction-error neurons in a computational model of mouse primary visual cortex. By balancing excitation and inhibition in multiple pathways, experience-dependent inhibitory plasticity can generate different variants of prediction-error circuits, which can be distinguished by simulated optogenetic experiments. The experience-dependence of the model circuit is consistent with that of negative prediction-error circuits in layer 2/3 of mouse primary visual cortex. Our model makes a range of testable predictions that may shed light on the circuitry underlying the neural computation of prediction errors.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>predictive processing</kwd><kwd>prediction-error neurons</kwd><kwd>neural circuits</kwd><kwd>sensorimotor processing</kwd><kwd>visual system</kwd><kwd>synaptic plasticity</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002347</institution-id><institution>Bundesministerium für Bildung und Forschung</institution></institution-wrap></funding-source><award-id>FKZ 01GQ1201</award-id><principal-award-recipient><name><surname>Sprekeler</surname><given-names>Henning</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001659</institution-id><institution>Deutsche Forschungsgemeinschaft</institution></institution-wrap></funding-source><award-id>FOR 2143</award-id><principal-award-recipient><name><surname>Sprekeler</surname><given-names>Henning</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>The formation and refinement of prediction error circuits relies on an experience-dependent balance of excitation and inhibition in canonical microcircuits.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Changes in sensory inputs can arise from changes in our environment, but also from our own movements. When you walk through a room full of people, your perspective changes over time, and you will experience a global visual flow. Superimposed on this global change are local changes generated by the movements of the people around you. An essential task of sensory perception is to disentangle these different origins of sensory inputs, because the appropriate behavioral responses to environmental and to self-generated changes are often different. Am I approaching a person or is she approaching me?</p><p>A common assumption is that perceptual systems subtract from the sensory data an internal prediction (<xref ref-type="bibr" rid="bib6">Bell, 1981</xref>; <xref ref-type="bibr" rid="bib58">Rao and Ballard, 1999</xref>; <xref ref-type="bibr" rid="bib20">Friston, 2005</xref>; <xref ref-type="bibr" rid="bib68">Spratling, 2010</xref>; <xref ref-type="bibr" rid="bib19">Franklin and Wolpert, 2011</xref>; <xref ref-type="bibr" rid="bib12">den Ouden et al., 2012</xref>; <xref ref-type="bibr" rid="bib34">Kennedy et al., 2014</xref>; <xref ref-type="bibr" rid="bib33">Keller and Mrsic-Flogel, 2018</xref>), which is calculated from an efference copy of the motor signals our brain has issued. Changes in the external world then take the form of mismatches – or prediction errors – between internal predictions and sensory data (<xref ref-type="bibr" rid="bib77">Wolpert et al., 1995</xref>). This comparison requires an accurate prediction system that adapts to ongoing changes in the environment or in behavior. An efficient way to ensure a flexible adaptation is to render the prediction circuits experience-dependent by minimizing prediction errors (<xref ref-type="bibr" rid="bib78">Wolpert et al., 2011</xref>).</p><p>Neural hallmarks of prediction errors are found throughout the brain. Dopaminergic neurons in the basal ganglia and the striatum (<xref ref-type="bibr" rid="bib63">Schultz and Dickinson, 2000</xref>) encode a reward prediction error (mismatch between expected and received reward), and subsets of neurons in visual cortex (<xref ref-type="bibr" rid="bib31">Keller et al., 2012</xref>; <xref ref-type="bibr" rid="bib83">Zmarz and Keller, 2016</xref>; <xref ref-type="bibr" rid="bib3">Attinger et al., 2017</xref>), auditory cortex (<xref ref-type="bibr" rid="bib15">Eliades and Wang, 2008</xref>; <xref ref-type="bibr" rid="bib32">Keller and Hahnloser, 2009</xref>) and barrel cortex (<xref ref-type="bibr" rid="bib4">Ayaz et al., 2019</xref>) code for a mismatch between feedback and feedforward information.</p><p>While neural correlates of prediction errors have been found broadly, the circuit level mechanisms that underlie their computation are poorly understood. Given that prediction errors involve a subtraction of expectations from sensory data (for an alternative implementation employing divisive inhibition, see <xref ref-type="bibr" rid="bib67">Spratling, 2008</xref>; <xref ref-type="bibr" rid="bib69">Spratling, 2017</xref>; <xref ref-type="bibr" rid="bib70">Spratling, 2019</xref>), the relevant circuits likely involve both excitatory and inhibitory pathways (<xref ref-type="bibr" rid="bib3">Attinger et al., 2017</xref>). Negative prediction-error (nPE) neurons, which are activated only when sensory signals are weaker than predicted, are likely to receive excitatory predictions counterbalanced by inhibitory sensory signals. Conversely, positive prediction-error (pPE) neurons, which respond only when sensory signals exceed the internal prediction, may receive excitatory sensory signals counterbalanced by inhibitory predictions (<xref ref-type="bibr" rid="bib58">Rao and Ballard, 1999</xref>; <xref ref-type="bibr" rid="bib33">Keller and Mrsic-Flogel, 2018</xref>). How the complex inhibitory circuits of the cortex (<xref ref-type="bibr" rid="bib48">Markram et al., 2004</xref>; <xref ref-type="bibr" rid="bib60">Rudy et al., 2011</xref>; <xref ref-type="bibr" rid="bib54">Pfeffer et al., 2013</xref>; <xref ref-type="bibr" rid="bib28">Jiang et al., 2015</xref>; <xref ref-type="bibr" rid="bib71">Tremblay et al., 2016</xref>; <xref ref-type="bibr" rid="bib75">Wamsley and Fishell, 2017</xref>) support the computations of these prediction errors is not resolved and neither are the activity-dependent forms of plasticity that would allow these circuits to refine the prediction machine.</p><p>For prediction-error neurons, fully predicted sensory signals should cancel with the internal prediction and hence trigger no response. We therefore hypothesized that an experience-dependent formation and refinement of prediction-error circuits can be achieved by balancing excitation and inhibition in an activity-dependent manner. Using a computational model comprised of excitatory pyramidal cells and three types of inhibitory interneurons, we show that nPE neurons can be learned by inhibitory synaptic plasticity rules that balance excitation and inhibition in principal cells. We find that the circuit shows a similar experience dependence as observed in V1 (<xref ref-type="bibr" rid="bib3">Attinger et al., 2017</xref>). Depending on which interneuron classes receive motor predictions and which receive sensory signals, the plasticity rules shape different, fully functional variants of the prediction circuit. Using simulated optogenetic experiments, we show that these variants have identifiable fingerprints in their reaction to optogenetic activation or inactivation of different interneuron classes. Finally, we demonstrate that the inhibitory prediction circuits can be learned by biologically plausible forms of homeostatic inhibitory synaptic plasticity, which only rely on local information available at the synapses.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>We studied a rate-based network model of layer 2/3 of rodent V1 to investigate how prediction-error (PE) neurons develop. In the following, we will focus primarily on negative prediction-error (nPE) neurons. In V1, nPE neurons have been studied more extensively, which allows us to compare our results with experimental findings. However, the same approaches and principles derived for nPE neurons can also be applied to positive prediction-error (pPE) neurons (see <xref ref-type="fig" rid="app2fig1">Appendix 2—figures 1</xref> and <xref ref-type="fig" rid="app2fig2">2</xref>). The network model includes excitatory pyramidal cells (PCs) as well as inhibitory parvalbumin-expressing (PV), somatostatin-expressing (SOM) and vasoactive intestinal peptide-expressing (VIP) interneurons (<xref ref-type="fig" rid="fig1">Figure 1a</xref>). The relative abundance of the four cell types and the probability of the respective synaptic connections are chosen in line with electrophysiological studies (see Materials and methods). While all inhibitory neurons are modeled as point neurons (<xref ref-type="bibr" rid="bib76">Wilson and Cowan, 1972</xref>), we used a two-compartment model for PCs with a rectifying active dendritic process that allowed nonlinear dynamics akin to dendritic calcium spikes (<xref ref-type="bibr" rid="bib50">Murayama et al., 2009</xref>) (see Materials and methods and Appendix 1).</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Balancing excitation and inhibition gives rise to negative prediction-error neurons.</title><p>(<bold>a</bold>) Network model with excitatory PCs and inhibitory PV, SOM and VIP neurons. Connections from PCs not shown for the sake of clarity. Somatic compartment of PCs, SOM and PV neurons receive visual input, apical dendrites of PCs and VIP neurons receive a motor-related prediction thereof. Connections marked with an asterisk undergo experience-dependent plasticity. (<bold>b</bold>) During plasticity, the network is exposed to a sequence of feedback (coupled sensorimotor experience) and playback phases (black square, visual input not predicted by motor commands). Stimuli last for 1 s and are alternated with baseline phases (absence of visual input and motor predictions). (<bold>c</bold>) Left: Before plasticity, somatic excitation (light red) and inhibition (light blue) in PCs are not balanced. Excitatory and inhibitory currents shifted by ±20 pA for visualization. The varying net excitatory current (gray) causes the PC population rate to deviate from baseline. Right: Response relative to baseline (<inline-formula><mml:math id="inf1"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:math></inline-formula>) of all PCs in feedback (FB), mismatch (MM) and playback (PB) phase, sorted by amplitude of mismatch response. None of the PCs are classified as nPE neurons (indicated by gray shading to the right). (<bold>d</bold>) Same as in (<bold>c</bold>) after plasticity. Somatic excitation and inhibition are balanced. PC population rate remains at baseline. All PCs classified as nPE neurons (also indicated by black shading to the right). (<bold>e</bold>) Left: Mismatch response increases with the difference between visual and motor input. Right: nPE neuron response during playback does not change with the difference between visual and motor input but remains at baseline.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57541-fig1-v1.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Learning prediction-error circuits with different forms of homeostatic plasticity.</title><p>(<bold>a</bold>) Network model as in <xref ref-type="fig" rid="fig1">Figure 1</xref>. Connections colored and marked with an asterisk undergo experience-dependent plasticity. (<bold>b</bold>) PCs receive visual input. Connections onto PCs follow an inhibitory plasticity rule akin to <xref ref-type="bibr" rid="bib73">Vogels et al., 2011</xref> (triangle). SOM→PV and VIP→PV synapses approximate a back-propagation of error (diamond). The averaged weights converge to a steady-state. Weights are normalized to the theoretically derived values for nPE neurons (see Materials and methods). (<bold>c</bold>) Same as in (<bold>b</bold>) but SOM→PV and VIP→PV synapses change in proportion to the difference between the excitatory recurrent drive onto PV neurons and a target value (square). (<bold>d</bold>) Same as in (<bold>b</bold>) but visual drive onto PCs is absent. SOM→PV and VIP→PV synapses follow an inhibitory plasticity rule akin to <xref ref-type="bibr" rid="bib73">Vogels et al., 2011</xref> (triangle). Connections from PCs onto PV neurons establish a baseline for PV neurons by an anti-Hebbian plasticity rule (inverted triangle) .</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57541-fig1-figsupp1-v1.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 2.</label><caption><title>VIP→PV synapses are not required for the formation of nPE neurons.</title><p>(<bold>a</bold>) Network model as in <xref ref-type="fig" rid="fig1">Figure 1</xref> but without VIP→PV synapses. PV neurons receive visual input. (<bold>b</bold>) Population response (<inline-formula><mml:math id="inf2"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:math></inline-formula>) of PCs in feedback (dark gray) and playback phase (light gray) for varying SOM→PV (top), SOM→VIP (middle) and VIP→SOM (bottom) connections. For all values tested, firing rate during feedback and playback deviates from baseline. (<bold>c</bold>) Response (<inline-formula><mml:math id="inf3"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:math></inline-formula>) of all PCs in feedback, mismatch and playback phase, sorted by amplitude of mismatch response. Most PCs change their firing rate only mildly in feedback and/or playback phase. As indicated by the gray/black shading to the right, many of the PCs are classified as nPE neurons. (<bold>d–f</bold>) Same as in (<bold>a</bold>) but PV neurons receive motor predictions. (<bold>f</bold>) All PCs change their firing rate in response to all stimulation patterns. None of the PCs are classified as nPE neurons (indicated by gray shading to the right). .</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57541-fig1-figsupp2-v1.tif"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 3.</label><caption><title>Balancing excitation, somatic and dendritic inhibition gives rise to nPE neurons in a model in which an excess of dendritic inhibition is forwarded to the soma.</title><p>Network model, its inputs and the training set are shown in <xref ref-type="fig" rid="fig1">Figure 1</xref>. Model setup modified to enable the formation of nPE neurons while abiding to Dale’s law: PCs receive 0.5 x visual input. External excitatory input onto the dendrites is set to 2.8 <inline-formula><mml:math id="inf4"><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> to mitigate an excess of dendritic inhibition during baseline. Additional non-linearity for synapses from SOM neurons onto the apical dendrites of PCs: <inline-formula><mml:math id="inf5"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>DS</mml:mi></mml:msub></mml:mrow><mml:mo>∝</mml:mo><mml:mrow><mml:mrow><mml:mi>σ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⋅</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf6"><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:msub></mml:math></inline-formula> denotes the total dendritic activity and <inline-formula><mml:math id="inf7"><mml:mi>σ</mml:mi></mml:math></inline-formula> is a sigmoid function given by <inline-formula><mml:math id="inf8"><mml:mrow><mml:mrow><mml:mi>σ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.5</mml:mn><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi>tanh</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mn>3.5</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. (<bold>a</bold>) Before plasticity, somatic excitation (light red) and inhibition (light blue) in PCs are not balanced. Excitatory and inhibitory currents are shifted by ±20 pA for visualization. The varying net excitatory current (gray) causes the PC population rate to deviate from baseline. (<bold>b</bold>) Left: Response (<inline-formula><mml:math id="inf9"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:math></inline-formula>) of all PCs in feedback, mismatch and playback phase, sorted by amplitude of mismatch response. All PCs change their firing rate in response to all stimulation patterns. None of the PCs are classified as nPE neurons (indicated by gray shading to the right). Right: Population responses of PV, SOM and VIP neurons in all phases. Responses are normalized between −1 and 1 such that baseline is zero. (<bold>c</bold>) Same as in (<bold>a</bold>) after plasticity. Somatic excitation and inhibition are balanced. PC population rate remains at baseline. (<bold>d</bold>) Same as in (<bold>b</bold>) after plasticity. Almost all PCs classified as nPE neurons (indicated by black/gray shading to the right). PV neurons are less active during the playback phase than during the feedback phase.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57541-fig1-figsupp3-v1.tif"/></fig></fig-group><p>A subset of inhibitory synapses – chosen based on a mathematical analysis (see Materials and methods, or Appendix 1) – are subject to experience-dependent plasticity, which aims at minimizing deviations of the PC firing rate from a baseline rate. These deviations can be interpreted as prediction errors. Learning hence strives to adapt the inhibitory circuit such as to reduce these errors. While the synapses onto both the somatic and dendritic compartments of PCs follow an inhibitory plasticity rule akin to <xref ref-type="bibr" rid="bib73">Vogels et al., 2011</xref>, the inhibitory synapses onto PV neurons follow an approximated backpropagation of error rule akin to <xref ref-type="bibr" rid="bib61">Rumelhart et al., 1986</xref>. Specifically, the former rule changes the synapses onto PCs in proportion to the presynaptic interneuron activity and the deviation of PC activity from a baseline rate (see Materials and methods, <xref ref-type="disp-formula" rid="equ13">Equation 14</xref>). The latter rule changes the synapses onto PV neurons in proportion to the presynaptic interneuron activity and the averaged deviation of the postsynaptic PCs from their baseline rate (see Materials and methods, <xref ref-type="disp-formula" rid="equ15">Equation 16</xref>). Earlier work has shown that such forms of plasticity establish a balance of excitation and inhibition (<xref ref-type="bibr" rid="bib73">Vogels et al., 2011</xref>; <xref ref-type="bibr" rid="bib46">Mackwood et al., 2020</xref>).</p><p>All neurons in the model receive excitatory background input that ensures reasonable baseline activities in the absence of visual input and motor-related internal predictions (‘baseline’). In addition, we stimulated the network with time-varying external inputs representing actual and predicted visual stimuli (<xref ref-type="fig" rid="fig1">Figure 1a,b</xref>). We reasoned that during natural conditions, movements lead to sensory inputs that are fully predicted by internal motor commands (‘feedback phase’, <xref ref-type="bibr" rid="bib3">Attinger et al., 2017</xref>), while unexpected external changes in the environment should generate unpredicted sensory signals (‘playback phase’, <xref ref-type="bibr" rid="bib3">Attinger et al., 2017</xref>). Situations in which internal motor commands are not accompanied by corresponding sensory signals should be rare (‘feedback mismatch phase’, <xref ref-type="bibr" rid="bib3">Attinger et al., 2017</xref>). During plasticity, we therefore stimulated the circuit with a sequence consisting of feedback and playback phases (‘quasi-natural training’, <xref ref-type="fig" rid="fig1">Figure 1b</xref>).</p><sec id="s2-1"><title>Negative prediction-error neurons emerge by balancing excitation and inhibition</title><p>Before the onset of plasticity, synaptic connections were randomly initialized, leading to PCs receiving unbalanced excitation and inhibition. Therefore, all PCs change their firing rate in response to both feedback and playback stimuli, indicating the absence of nPE neurons (<xref ref-type="fig" rid="fig1">Figure 1c</xref>). During quasi-natural sensorimotor experience, inhibitory plasticity strengthens or weakens inhibitory synapses to diminish the firing rate deviations of PCs from their baseline firing rate (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). At the same time, dendritic inhibition mediated by SOM interneurons was sufficiently strengthened to suppress the motor prediction arriving at the apical dendrite. After synaptic plasticity, somatic excitation and inhibition are balanced on a stimulus-by-stimulus basis (<xref ref-type="fig" rid="fig1">Figure 1d–e</xref>). PCs merely show small and transient onset/offset responses to feedback and playback stimuli. In contrast, all PCs show an increase in activity for feedback mismatch stimuli (<xref ref-type="fig" rid="fig1">Figure 1d</xref>), which scales with the size of the difference between actual and predicted visual input (<xref ref-type="fig" rid="fig1">Figure 1e</xref>). Hence, inhibitory synaptic plasticity generates nPE neurons by balancing excitation and inhibition in PCs for quasi-natural conditions.</p></sec><sec id="s2-2"><title>Balance of excitation, inhibition and disinhibition in different functional prediction circuits</title><p>The circuit we studied so far was motivated by the widely accepted view that PCs and SOM and PV interneurons show visual responses (<xref ref-type="bibr" rid="bib36">Ko et al., 2011</xref>; <xref ref-type="bibr" rid="bib80">Yang et al., 2013</xref>; <xref ref-type="bibr" rid="bib39">Larkum, 2013a</xref>; <xref ref-type="bibr" rid="bib79">Xue et al., 2014</xref>; <xref ref-type="bibr" rid="bib23">Harris and Shepherd, 2015</xref>; <xref ref-type="bibr" rid="bib43">Lee et al., 2016</xref>; <xref ref-type="bibr" rid="bib3">Attinger et al., 2017</xref>), while long-range (motor) predictions arrive in the superficial layers of V1 and target VIP neurons (<xref ref-type="bibr" rid="bib21">Fu et al., 2014</xref>; <xref ref-type="bibr" rid="bib23">Harris and Shepherd, 2015</xref>; <xref ref-type="bibr" rid="bib71">Tremblay et al., 2016</xref>; <xref ref-type="bibr" rid="bib3">Attinger et al., 2017</xref>) and the apical and distal compartments of PCs (<xref ref-type="bibr" rid="bib39">Larkum, 2013a</xref>; <xref ref-type="bibr" rid="bib44">Leinweber et al., 2017</xref>; <xref ref-type="bibr" rid="bib3">Attinger et al., 2017</xref>). Because this view is not uncontested (<xref ref-type="bibr" rid="bib21">Fu et al., 2014</xref>) and it has been shown that interneuron types can receive both feedforward and feedback inputs (<xref ref-type="bibr" rid="bib74">Wall et al., 2016</xref>), we systematically varied the inputs to the different neuron classes. We first studied circuit variations in which PCs and PV neurons receive visual and/or motor signals (<xref ref-type="fig" rid="fig2">Figure 2</xref>, see also <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Multi-pathway balance of excitation and inhibition in different nPE neuron circuits.</title><p>(<bold>a</bold>) Excitatory, inhibitory, disinhibitory and dis-disinhibitory pathways onto PCs that need to be balanced in nPE neuron circuits. Input to the soma of PCs and PV neurons is varied (<bold>c–f</bold>). SOM neurons receive visual input, VIP neurons receive a motor-related prediction. (<bold>b</bold>) Test stimuli: Feedback (FB), mismatch (MM) and playback (PB) phases of 1 s each. (<bold>c</bold>) PCs and PV neurons receive visual input (left, top). When all visual (V) and motor (M) pathways are balanced (left, bottom), PCs act as nPE neurons (right). PV neuron activity increases in both feedback and playback phases. Responses normalized between −1 and 1 such that baseline is zero. (<bold>d</bold>) Same as in (<bold>c</bold>) but PV neurons receive motor predictions. (<bold>e</bold>) Same as in (<bold>c</bold>) but PCs receive no visual input. PV neurons remain at baseline in the absence of visual input to the soma of PCs. (<bold>f</bold>) Same as in (<bold>c</bold>) but PCs receive no visual input and PV neurons receive motor predictions. PV neurons remain at baseline in the absence of visual input to the soma of PCs.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57541-fig2-v1.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Multi-pathway balance of excitation and inhibition in different nPE neuron circuits with both visual and motor input onto PV neurons.</title><p>(<bold>a</bold>) Excitatory, inhibitory, disinhibitory and dis-disinhibitory pathways onto PCs that need to be balanced in nPE neuron circuits. Input to the soma of PCs and PV neurons is varied (<bold>c–d</bold>). SOM neurons receive visual input, VIP neurons receive a motor-related prediction thereof. (<bold>b</bold>) Test stimuli: Feedback (FB), mismatch (MM) and playback (PB) phases of 1 s each. (<bold>c</bold>) PCs receive visual input (left, top). When all visual (V) and motor (M) pathways are balanced (left, bottom), PCs act as nPE neurons (right). PV neuron activity increases in both feedback and playback phases. Responses normalized between −1 and 1 such that baseline is zero. (<bold>d</bold>) Same as in (<bold>c</bold>) but PCs receive no visual input. PV neurons remain at baseline in the absence of visual input to the soma of PCs.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57541-fig2-figsupp1-v1.tif"/></fig></fig-group><p>We found that inhibitory plasticity establishes nPE neurons independent of the input configuration onto PCs and PV neurons (<xref ref-type="fig" rid="fig2">Figure 2c–f</xref>, right). The emerging connectivity of the interneuron circuits varied, however. For PCs not to respond above baseline in feedback and playback phase, various excitatory, inhibitory, disinhibitory and dis-disinhibitory pathways need to be balanced. An informative example is the input configuration in which PCs receive visual input and PV neurons receive motor predictions (<xref ref-type="fig" rid="fig2">Figure 2d</xref>). In this case, visual inputs arrive at the PCs as direct excitation, as disinhibition through the SOM-PV pathway, and as dis-disinhibition via the SOM-VIP-PV pathway (<xref ref-type="fig" rid="fig2">Figure 2a</xref>). To keep the PCs at their baseline during the playback phase, these three pathways need to be balanced (<xref ref-type="fig" rid="fig2">Figure 2d</xref>, left). Similarly, motor signals arrive at the PCs as inhibition from PV neurons, dis-inhibition via the VIP-PV pathway, dis-dis-inhibition via the VIP-SOM-PV pathway and as direct excitation to the dendrite that is canceled by SOM-mediated inhibition. Again, all these pathways need to be balanced to keep the PCs at their baseline for fully predicted visual stimuli (<xref ref-type="fig" rid="fig2">Figure 2d</xref>, left). Analog balancing arguments hold for other input configurations (<xref ref-type="fig" rid="fig2">Figure 2c–f</xref>, left). Note that this multi-pathway balance applies primarily to somatic inputs to PCs. During feedback and playback phases, this provides a complete picture, because the dendrites are deactivated by inhibition. During mismatch phases, this dendritic inhibition is withdrawn and the dendrites provide additional excitatory input to the soma that can drive mismatch responses.</p><p>While the flow of visual and motor information in the learned inhibitory microcircuit is different for different input configurations, the neural responses of the different interneuron classes provide limited information about the input configuration. PV neuron activity reflects whether PCs receive visual input: If PCs receive visual input, PV responses increase during feedback and playback phases to balance the sensory input at the soma of PCs (<xref ref-type="fig" rid="fig2">Figure 2c–d</xref>, right). If PCs receive no visual input, PV neurons remain at their baseline firing rate (<xref ref-type="fig" rid="fig2">Figure 2e–f</xref>, right), which is in contradiction to the experimentally observed increase of PV neurons during feedback (see <xref ref-type="bibr" rid="bib3">Attinger et al., 2017</xref>). The activity of SOM and VIP neurons varies between playback, feedback and mismatch phases (in line with experimental results, see <xref ref-type="bibr" rid="bib3">Attinger et al., 2017</xref>), but is independent of the input configuration for PCs and PV interneurons (<xref ref-type="fig" rid="fig2">Figure 2c–f</xref>, right).</p><p>In summary, inhibitory plasticity can establish functional nPE circuits irrespective of the inputs onto the soma of PCs and PV neurons. Although the underlying circuits vary substantially in the specific balance of pathways, the neural activity patterns only weakly reflect the underlying information flow.</p></sec><sec id="s2-3"><title>Simulated optogenetic manipulations disambiguate prediction-error circuits</title><p>We hypothesized that the need to simultaneously balance several pathways offers a way to disambiguate the different prediction-error circuits by optogenetic manipulations. To test this, we systematically suppressed or activated PV, SOM and VIP interneurons in each input configuration after inhibitory plasticity had established the respective nPE circuit.</p><p>We found that in our model, such simulated optogenetic experiments are highly informative about the underlying input configuration (<xref ref-type="fig" rid="fig3">Figure 3</xref>). For example, PV neuron inactivation changes the response of nPE neurons during feedback, playback and mismatch phases if and only if the PCs receive visual inputs. VIP inactivation renders nPE neurons silent unless PV neurons receive motor predictions, in which case they are transformed into positive prediction-error (pPE) neurons. Since SOM and VIP neurons are mutually inhibiting (see e.g. <xref ref-type="bibr" rid="bib54">Pfeffer et al., 2013</xref>), the same information can be gained by an over-activation of SOM neurons that effectively silences VIP neurons.</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Simulated optogenetic manipulations of PV, SOM and VIP neurons disambiguate prediction-error circuits.</title><p>(<bold>a</bold>) Left: nPE neuron circuit in which PCs and PV neurons receive visual input. Inactivation (middle) or activation (right) of PV (first row), SOM (second row) or VIP neurons (third row). Optogenetic manipulations change responses of nPE neurons (Ctrl) in feedback, mismatch and playback phases. Responses normalized between −1 and 1 such that baseline is zero. Inactivation input is -<inline-formula><mml:math id="inf10"><mml:mrow><mml:mpadded width="+1.7pt"><mml:mn>8</mml:mn></mml:mpadded><mml:mo>⁢</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. Activation input is <inline-formula><mml:math id="inf11"><mml:mrow><mml:mpadded width="+1.7pt"><mml:mn>5</mml:mn></mml:mpadded><mml:mo>⁢</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. (<bold>b</bold>) Same as in (<bold>a</bold>) but PV neurons receive motor-related prediction. (<bold>c</bold>) Same as in (<bold>a</bold>) but PCs receive no visual input. (<bold>d</bold>) Same as in (<bold>a</bold>) but PCs receive no visual input and PV neurons receive a motor-related prediction.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57541-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Net currents in PCs after in/activation of PV, SOM or VIP neurons elucidate prediction-error circuits.</title><p>(<bold>a</bold>) nPE neuron circuit in which PCs and PV neurons receive visual input. In/activation of PV, SOM or VIP neurons changes net current in nPE neurons in feedback (blue), mismatch (red), playback (orange) and baseline (green) phase. Gray shading denotes currents below rheobase of PC. (<bold>b</bold>) Same as in (<bold>a</bold>) but PV neurons receive motor-related prediction. (<bold>c</bold>) Same as in (<bold>a</bold>) but PCs receive no visual input. (<bold>d</bold>) Same as in (<bold>a</bold>) but PCs receive no visual input and PV neurons receive a motor-related prediction.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57541-fig3-figsupp1-v1.tif"/></fig></fig-group><p>Changes in neuronal activity due to optogenetic manipulations depend on a variety of factors such as baseline firing rates and saturation effects (<xref ref-type="bibr" rid="bib55">Phillips and Hasenstaub, 2016</xref>). For instance, while an excess of inhibition is not observable when PCs exhibit vanishingly small baseline activity, it leads to a firing rate decrease otherwise. Moreover, in/activation of interneuron types within a recurrent network may also have ambiguous consequences contingent on potential saturation effects in other cell types. These ambiguities can be partially resolved by measuring currents rather than firing rates, during baseline, feedback, mismatch and playback phases. Indeed, we found that the net currents in PCs after in/activation of PV, SOM or VIP neurons are highly informative about the underlying input configuration (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>).</p><p>When we compared our results with optogenetic experiments in which SOM or VIP neurons are either inactivated or activated during mismatch or running (<xref ref-type="bibr" rid="bib3">Attinger et al., 2017</xref>), it shows that a homogeneous input configuration in which all PCs receive visual input while all PV neurons receive a motor-related prediction thereof is unlikely (<xref ref-type="fig" rid="fig3">Figure 3b</xref>). All other variants of nPE circuits exhibit mismatch responses during SOM/VIP neuron manipulation that are in line with the ones observed experimentally. However, the responses observed in the feedback phase (when compared with ‘during running’, see <xref ref-type="bibr" rid="bib3">Attinger et al., 2017</xref>) deviate from all the conditions we simulated, indicating that the interneurons do not receive exclusively sensory or motor inputs, but rather a combination of actual and predicted visual input.</p><p>In summary, our model predicts that optogenetic experiments may unveil a unique fingerprint for nPE circuits that differ in their inputs onto PCs and PV neurons.</p></sec><sec id="s2-4"><title>Fraction of nPE neurons is modulated by inputs to SOM and VIP interneurons</title><p>In the model considered so far, all PCs developed into nPE neurons during learning, irrespective of the inputs to PCs and PV interneurons. However, nPE neurons represent only a small fraction of neurons in mouse V1 (<xref ref-type="bibr" rid="bib31">Keller et al., 2012</xref>; <xref ref-type="bibr" rid="bib62">Saleem et al., 2013</xref>; <xref ref-type="bibr" rid="bib83">Zmarz and Keller, 2016</xref>; <xref ref-type="bibr" rid="bib3">Attinger et al., 2017</xref>). Given that in our model, motor predictions arriving at the apical dendrites are canceled by SOM neuron-mediated inhibition, we hypothesized that the fraction of PCs that develop into nPE neurons depends on the distribution of visual and motor input onto SOM and VIP neurons.</p><p>To test this, we allow neurons of both SOM and VIP populations to receive either visual input or a motor prediction thereof. A fraction <italic>f</italic> of SOM neurons and a fraction <inline-formula><mml:math id="inf12"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of VIP neurons receive visual input. The remaining SOM and VIP neurons receive a motor-related prediction (<xref ref-type="fig" rid="fig4">Figure 4a</xref>). When the majority of SOM neurons receive visual inputs and the majority of VIP neurons receive motor predictions (<inline-formula><mml:math id="inf13"><mml:mrow><mml:mi>f</mml:mi><mml:mo>≈</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>), all PCs develop into nPE neurons (<xref ref-type="fig" rid="fig4">Figure 4b</xref>, left). Reducing the proportion of SOM neurons that receive visual input (and, equivalently, the proportion of VIP neurons that receive the motor prediction), the fraction of nPE neurons decreases (<xref ref-type="fig" rid="fig4">Figure 4b</xref>, middle). Non-nPE neurons remain at their baseline in all three phases, show a suppression during mismatch or develop into pPE neurons that respond only during playback. pPE neurons only emerge when the inputs to SOM and VIP neurons are reversed such that most SOM neurons receive motor predictions (<xref ref-type="fig" rid="fig4">Figure 4b</xref>, right).</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Fraction of nPE neurons depends on SOM and VIP neuron inputs.</title><p>(<bold>a</bold>) Network model with excitatory PCs and inhibitory PV, SOM and VIP neurons. Connections from PCs not shown for the sake of clarity. Somatic compartment of PCs, PV neurons, a fraction <italic>f</italic> of SOM neurons and a fraction <inline-formula><mml:math id="inf14"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of VIP neurons receive visual input. The remaining SOM and VIP neurons receive motor predictions. (<bold>b</bold>) Response relative to baseline (<inline-formula><mml:math id="inf15"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:math></inline-formula>) of all PCs in feedback, mismatch and playback phases, sorted by amplitude of mismatch response. The fraction of nPE neurons that develop during learning decreases with <italic>f</italic> (also indicated by black and gray shading to the right). The increasing fraction of non-nPE neurons comprises neurons that remain at their baseline in all three phases, show a suppression during mismatch or develop into positive prediction-error neurons that respond only during playback.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57541-fig4-v1.tif"/></fig><p>In summary, the fraction of nPE neurons that develop during learning depends on the distribution of visual input and motor predictions onto both SOM and VIP neurons.</p></sec><sec id="s2-5"><title>Experience-dependence of mismatch and interneuron responses</title><p><xref ref-type="bibr" rid="bib3">Attinger et al., 2017</xref> showed that the number of nPE neurons and the strength of their mismatch responses decreases when mice are trained in artificial conditions, during which a mouse was shown the visual information of a different mouse, such that motor predictions and visual flow were uncorrelated (‘non-coupled training’). We reasoned that this training paradigm should include baseline phases where both animals sit still and phases, during which the speeds of the two animals differ. To test whether the model shows the same experience-dependence, we generated a modified training paradigm, which includes baseline phases and phases during which the visual inputs and motor-related predictions are statistically independent (‘random gain training’, <xref ref-type="fig" rid="fig5">Figure 5a</xref>). We found that the number of nPE neurons and their mismatch responses also decrease for random gain trained relative to quasi-natural trained networks (<xref ref-type="fig" rid="fig5">Figure 5b</xref>). This decrease is primarily due to changes in PCs and PV neurons, while the responses of SOM and VIP neurons during the mismatch phase are largely independent of the training paradigm (<xref ref-type="fig" rid="fig5">Figure 5c</xref>). Hence, the experience-dependence of the model circuit is in line with that of nPE neurons in rodent V1 (<xref ref-type="bibr" rid="bib3">Attinger et al., 2017</xref>).</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Experience-dependence of nPE and PV neurons.</title><p>(<bold>a</bold>) The network is either exposed to a sequence of baseline, feedback and playback phases (quasi-natural training, QT), to baseline phases and phases during which the visual inputs and motor-related predictions are statistically independent (random gain training, RT) or perfectly coupled sensorimotor experience (coupled training, CT) (<bold>b</bold>) The number of nPE neurons that develop during learning (top) and their mismatch responses (bottom) are smaller for RT than for QT networks. 90% of SOM and 50% of VIP neurons receive visual input. (<bold>c</bold>) Population response (<inline-formula><mml:math id="inf16"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:math></inline-formula>) of PCs, PV, SOM and VIP neurons during mismatch phase. SOM and VIP neurons show the same mismatch response for QT and RT, PCs and PV neurons show stronger responses in QT than in RT. 90% of SOM and 50% of VIP neurons receive visual input. (<bold>d</bold>) Responses during mismatch (top) and playback (bottom) for QT and CT networks. CT networks can exhibit a decrease in activity during playback phase. Connections from VIP to PV neurons are non-plastic and fixed to −0.3.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57541-fig5-v1.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Coupled-trained networks can produce nPE neurons that decrease their activity in playback phase.</title><p>(<bold>a</bold>) During plasticity, the network is exposed to a sequence of feedback phases only, representing perfectly coupled sensorimotor experience. Network model shown in <xref ref-type="fig" rid="fig1">Figure 1</xref>. Connections from VIP to PV neurons are non-plastic. (<bold>b–c</bold>) Model in which an excess of dendritic inhibition does not affect the soma of PCs. Connection strength from VIP to PV neurons fixed to −0.3. (<bold>b</bold>) Response (<inline-formula><mml:math id="inf17"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:math></inline-formula>) of all PCs in feedback, mismatch and playback phase, sorted by amplitude of mismatch response. All PCs increase their activity during mismatch phase but decrease their firing rate during playback phase. The decrease of PC activity during playback is a result of an excess of somatic inhibition mediated by PV neurons. (<bold>c</bold>) Population responses of PV, SOM and VIP neurons in all phases. Responses normalized between −1 and 1 such that baseline is zero. (<bold>d–e</bold>) Model in which an excess of dendritic inhibition is forwarded to the soma of PCs. Connection strength from VIP to PV neurons fixed to −0.18. External excitatory input onto the dendrites is set to 2.8 <inline-formula><mml:math id="inf18"><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> to mitigate an excess of dendritic inhibition during baseline. (<bold>d</bold>) Same as in (<bold>b</bold>). The decrease of PC activity during playback is a result of an excess of dendritic inhibition mediated by SOM neurons. (<bold>e</bold>) Same as in (<bold>c</bold>). PV neurons are less active during the playback phase than during the feedback phase.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57541-fig5-figsupp1-v1.tif"/></fig></fig-group><p>During learning, we exposed the network to sensory inputs and motor-related predictions designed to reflect coupled sensorimotor experience. To account for changes in the external world that do not arise from the animal’s own movements, we included ‘playback’ phases in which the visual input is stronger than predicted by the motor-related input. Consistent with the experimental setup of <xref ref-type="bibr" rid="bib3">Attinger et al., 2017</xref>, we deliberately excluded feedback mismatch phases. In the model, the stimuli experienced during learning have a strong impact on the response structure of the PCs, because the learning rules aim to keep the PCs at a given baseline rate at all times. The inclusion of feedback and playback phases during learning therefore leads to neurons that remain at their baseline during those phases, in line with nPE neurons. In mouse V1, nPE neurons exhibit an average rate decrease during playback when the animals were only exposed to perfectly coupled sensorimotor experience (<xref ref-type="bibr" rid="bib3">Attinger et al., 2017</xref>). When our network was trained in the same way, we also observed that PCs reduced their firing rate during playback phases (<xref ref-type="fig" rid="fig5">Figure 5d</xref> and <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). This can be a result of an excess of somatic inhibition, dendritic inhibition or both. The model hence predicts that the rate reduction during playback phases observed by <xref ref-type="bibr" rid="bib3">Attinger et al., 2017</xref> vanishes when playback phases are included during training.</p></sec><sec id="s2-6"><title>nPE circuits can also be learned by biologically plausible learning rules</title><p>In our model, nPE neurons developed through inhibitory plasticity that establishes an excitation-inhibition (E/I) balance in PCs. So far, we used learning rules that approximate a backpropagation of error (<xref ref-type="bibr" rid="bib61">Rumelhart et al., 1986</xref>), which changed SOM→PV and VIP→PV connections such as to minimize the difference between the PC firing rate and a baseline rate (see <xref ref-type="disp-formula" rid="equ15">Equation 16</xref> in Materials and methods). The biological plausibility of such backpropagation rules, which are broadly used in artificial intelligence, is still debated, because they rely on information that is not locally available at the synapse in question (<xref ref-type="bibr" rid="bib11">Crick, 1989</xref>; <xref ref-type="bibr" rid="bib59">Richards and Lillicrap, 2019</xref>). We therefore wondered whether prediction-error circuits can also be established by biologically plausible local learning rules.</p><p>We found that nPE neurons also emerged when the backpropagation rules were replaced by a form of plasticity that changes SOM→PV and VIP→PV synapses in proportion to the difference between the excitatory recurrent drive onto PV neurons and a target value (see <xref ref-type="bibr" rid="bib46">Mackwood et al., 2020</xref>, and <xref ref-type="disp-formula" rid="equ16 equ17">Equations 17 and 18</xref> in Materials and methods). This local form of learning was also able to balance excitation and inhibition sufficiently (<xref ref-type="fig" rid="fig6">Figure 6b,c</xref> and <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1c</xref>) so that all PCs developed into nPE neurons (<xref ref-type="fig" rid="fig6">Figure 6c</xref>).</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Learning nPE neurons by biologically plausible learning rules.</title><p>(<bold>a</bold>) Left: Network model as in <xref ref-type="fig" rid="fig1">Figure 1</xref>. Connections marked with symbols undergo experience-dependent plasticity. Connections onto PCs follow an inhibitory plasticity rule akin to <xref ref-type="bibr" rid="bib73">Vogels et al., 2011</xref> (triangle). SOM→PV and VIP→PV synapses change in proportion to the difference between the excitatory recurrent drive onto PV neurons and a target value (square). Right: During plasticity, the network is exposed to a sequence of feedback (coupled sensorimotor experience) and playback phases (black square, visual input not predicted by motor commands). Stimuli last for 1 s and are alternated with baseline phases (absence of visual input and motor predictions). (<bold>b</bold>) Left: Before plasticity, somatic excitation (light red) and inhibition (light blue) in PCs are not balanced. Excitatory and inhibitory currents shifted by ±20 pA for visualization. The varying net excitatory current (gray) causes the PC population rate to deviate from baseline. Right: Response relative to baseline (<inline-formula><mml:math id="inf19"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:math></inline-formula>) of all PCs in feedback, mismatch and playback phases, sorted by amplitude of mismatch response. None of the PCs are classified as nPE neurons (indicated by gray shading to the right). (<bold>c</bold>) Same as in (<bold>b</bold>) after plasticity. Somatic excitation and inhibition are balanced. PC population rate remains at baseline. All PCs classified as nPE neurons (also indicated by black shading to the right).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57541-fig6-v1.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Learning nPE neurons by biologically plausible learning rules in networks without visual input at the soma of PCs.</title><p>(<bold>a</bold>) Network model as in <xref ref-type="fig" rid="fig1">Figure 1</xref>. Connections marked with symbols undergo experience-dependent plasticity. Inhibitory connections onto PCs and PV neurons follow an inhibitory plasticity rule akin to <xref ref-type="bibr" rid="bib73">Vogels et al., 2011</xref> (triangle). Synapses from PCs onto PV neurons follow an anti-Hebbian plasticity rule (inverted triangle). (<bold>b</bold>) Left: Before plasticity, somatic excitation (light red) and inhibition (light blue) at PCs are not balanced. Excitatory and inhibitory currents are shifted by ±20 pA for visualization. The varying net excitatory current (gray) causes the PC population rate to deviate from baseline. Right: Response relative to baseline (<inline-formula><mml:math id="inf20"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:math></inline-formula>) of all PCs in feedback, mismatch and playback phase, sorted by amplitude of mismatch response. None of the PCs are classified as nPE neurons (indicated by gray shading to the right). (<bold>c</bold>) Same as in (<bold>b</bold>) after plasticity. Somatic excitation and inhibition are balanced. PC population rate remains at baseline. All PCs classified as nPE neurons (also indicated by black shading to the right).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57541-fig6-figsupp1-v1.tif"/></fig></fig-group><p>The plasticity rules can be further simplified when PCs do not receive visual information. In this case, PV neurons also remain at their baseline firing rate in feedback and playback phases (<xref ref-type="fig" rid="fig2">Figure 2e–f</xref>, right). Hence, the strength of SOM→PV and VIP→PV synapses can be learned according to a homeostatic rule (<xref ref-type="bibr" rid="bib73">Vogels et al., 2011</xref>) that aims to sustain a target rate in the PV neurons (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref> and <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1d</xref>, <xref ref-type="disp-formula" rid="equ18 equ19">Equations 19 and 20</xref> in Materials and methods). In summary, the backpropagation-like learning rules for the synapses onto PV neurons can be approximated by biologically plausible rules that exploit local information available at the respective synapses.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>How the nervous system disentangles self-generated and external sensory stimuli is a long-standing question (<xref ref-type="bibr" rid="bib6">Bell, 1981</xref>; <xref ref-type="bibr" rid="bib19">Franklin and Wolpert, 2011</xref>; <xref ref-type="bibr" rid="bib33">Keller and Mrsic-Flogel, 2018</xref>). Here, we investigated the circuit level mechanisms that underlie the computation of negative prediction errors and how different types of inhibitory neurons shape these prediction circuits. We used computational modeling to show that nPE neurons can be learned by balancing excitation and inhibition in cortical microcircuits with three types of interneurons. We show that the required E/I balance can be achieved by biologically plausible forms of synaptic plasticity. Furthermore, the experience-dependence of the circuit is similar to that of nPE circuits in mouse V1 (<xref ref-type="bibr" rid="bib3">Attinger et al., 2017</xref>).</p><p>Our model makes a number of predictions. Firstly, the multi-pathway balance of excitation and inhibition suggests that the input configuration of the prediction circuit could be disambiguated using cell type-specific modulations of neural activity. This could be achieved by optogenetic or pharmacogenetic manipulations, or by exploiting the differential sensitivity of interneuron classes to neuromodulators. The precarious nature of an exact multi-pathway balance also suggests that nPE neurons might change their response characteristics in a context-dependent way, for example by neuromodulatory effects.</p><p>Secondly, the central assumption of the model is that nPE neurons emerge by a self-organized E/I balance during sensorimotor experience. It therefore predicts that (i) sensorimotor experience an animal is habituated to should lead to balanced excitation and inhibition in PCs, (ii) E/I balance should break for sensorimotor experience the animal has rarely encountered, for example for mismatches of sensory stimuli and motor predictions and (iii) during altered sensorimotor experience in a virtual reality setting or when the excitability of specific interneuron types is altered, interneuron circuits should gradually reconfigure to reestablish the E/I balance.</p><p>PCs in L2/3 of V1 have very low spontaneous firing rates (<xref ref-type="bibr" rid="bib57">Polack et al., 2013</xref>; <xref ref-type="bibr" rid="bib79">Xue et al., 2014</xref>). A potential rate decrease during feedback and playback could hence be hard to detect. Whether the low response of nPE neurons during feedback and playback phases are due to an E/I balance – as suggested here – or due to an excess of inhibition may hence be difficult to decide, and could for example be resolved by intracellular recordings (<xref ref-type="bibr" rid="bib29">Jordan and Keller, 2020</xref>).</p><p>We used a mathematical analysis to derive constraints imposed on an interneuron circuit by the presence of nPE neurons. In particular, the equations unveiled the relation between the strength of a number of inhibitory synapses, describing a multi-pathway E/I balance in a network comprising PV, SOM and VIP neurons (see Materials and methods, <xref ref-type="disp-formula" rid="equ8 equ8">Equations 8, 9)</xref>. However, we also performed an extensive analysis of different subnetworks, to elucidate under which conditions nPE neurons can emerge (see Appendix 1). By comparing nPE circuits with less cell types, a set of common principles can be extracted (see Appendix 1 for a detailed description): (I) SOM neurons must be present to balance feedback predictions at the dendrites of PCs. (II) SOM neurons must receive visual input unless both PV and VIP neurons are present as well. (III) The connections onto the dendrites must undergo experience-dependent plasticity. (IV) PV neurons must be present when PCs receive visual input in their somatic compartment. (V) Dendritic non-linearities are necessary except for a small set of networks, in which all interneuron types are present and specific constraints for the input configuration apply. While a minimal model that allows nPE neurons to develop comprises SOM neurons and PCs (<xref ref-type="bibr" rid="bib3">Attinger et al., 2017</xref>), the network with three inhibitory neuron types appears the most likely nPE circuit given what is currently known about rodent V1.</p><p>The interneuron circuit in our model is motivated by the canonical circuit found in a variety of brain regions (<xref ref-type="bibr" rid="bib54">Pfeffer et al., 2013</xref>; <xref ref-type="bibr" rid="bib42">Lee et al., 2013</xref>; <xref ref-type="bibr" rid="bib28">Jiang et al., 2015</xref>). In addition to the connections between interneuron classes that are frequently reported as strong and numerous, we included VIP→PV synapses in the circuit, because a mathematical analysis reveals that they are required for a perfect E/I balance during both feedback and playback phases (see Appendix 1). While VIP→PV synapses have been found in visual (<xref ref-type="bibr" rid="bib54">Pfeffer et al., 2013</xref>), auditory (<xref ref-type="bibr" rid="bib56">Pi et al., 2013</xref>), somatosensory (<xref ref-type="bibr" rid="bib27">Hioki et al., 2013</xref>; <xref ref-type="bibr" rid="bib42">Lee et al., 2013</xref>) and medial prefrontal cortex (<xref ref-type="bibr" rid="bib56">Pi et al., 2013</xref>), as well as amygdala (<xref ref-type="bibr" rid="bib37">Krabbe et al., 2019</xref>), they are less prominent and often weaker than SOM→PV connections (but see <xref ref-type="bibr" rid="bib37">Krabbe et al., 2019</xref>). VIP→PV synapses can be excluded when the conditions for nPE neurons during feedback and playback phases are mildly relaxed (<xref ref-type="bibr" rid="bib32">Keller and Hahnloser, 2009</xref>; <xref ref-type="bibr" rid="bib31">Keller et al., 2012</xref>; <xref ref-type="bibr" rid="bib3">Attinger et al., 2017</xref>) and when PV neurons receive visual, but not motor inputs (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>).</p><p>Cortical circuits are complex and contain a large variety of interneuron classes (<xref ref-type="bibr" rid="bib60">Rudy et al., 2011</xref>; <xref ref-type="bibr" rid="bib28">Jiang et al., 2015</xref>; <xref ref-type="bibr" rid="bib71">Tremblay et al., 2016</xref>). We restricted the model to three of these classes: PV, SOM and VIP neurons. It is conceivable that several other interneuron types can play a pivotal role in prediction-error circuits. The dendrites of layer 2/3 neurons reach out to layer 1, the major target for feedback connections (<xref ref-type="bibr" rid="bib16">Felleman and Van Essen, 1991</xref>; <xref ref-type="bibr" rid="bib9">Cauller, 1995</xref>; <xref ref-type="bibr" rid="bib39">Larkum, 2013a</xref>) and home to a number of distinct interneuron types (<xref ref-type="bibr" rid="bib40">Larkum, 2013b</xref>; <xref ref-type="bibr" rid="bib64">Schuman et al., 2019</xref>), which may contribute to associative learning (<xref ref-type="bibr" rid="bib1">Abs et al., 2018</xref>). In particular, NDNF neurons unspecifically inhibit apical dendrites located in the superficial layers, and at the same time receive strong inhibition from SOM neurons (<xref ref-type="bibr" rid="bib1">Abs et al., 2018</xref>). Hence, it is possible that these interneurons also shape the processing of feedback information, including the computation of prediction errors.</p><p>Our analysis revealed a number of synapses in the circuit that undergo experience-dependent changes. While the synapses from PV neurons onto PCs established a baseline firing rate in the absence of visual input and motor predictions, the synergy between the SOM→PV, VIP→PV and SOM→PC synapses guaranteed that the baseline is retained in feedback and playback phase. The multi-pathway balance of excitation and inhibition could also be achieved by synaptic plasticity in other inhibitory synapses – for example the mutual inhibition between SOM and VIP neurons. However, the assumption that mainly the inhibitory synapses onto PV neurons are plastic is supported by the observation that PV neuron activity – in contrast to SOM and VIP neuron activity – is experience-dependent (<xref ref-type="bibr" rid="bib3">Attinger et al., 2017</xref>).</p><p>In our circuit, the bottom-up and top-down connections conveying actual and predicted visual input, respectively, were non-plastic. However, this modeling choice is not a pre-requisite for the formation of nPE neurons and can be relaxed. As a matter of fact, nPE neurons can also develop in a network, in which the excitatory top-down and bottom-up connections undergo experience-dependent plasticity that balances excitation and inhibition in somatic and dendritic compartments of PCs. For instance, nPE neurons can also be learned by endowing the top-down and bottom-up connections onto PCs and PV neurons with similar plasticity rules described here. Restricting plasticity to the excitatory connections onto PCs would, however, require all inhibitory interneurons to exclusively receive visual input, suggesting that excitatory bottom-up/top-down connections onto interneurons must also change in an activity-dependent manner.</p><p>In the model, the plastic inhibitory synapses onto PV neurons change according to non-local information that might not be directly available at the synapse. These synapses therefore implement an approximation of a backpropagation of error, the biological plausibility of which is debated (<xref ref-type="bibr" rid="bib11">Crick, 1989</xref>). We showed that this plasticity rule can be approximated by biologically plausible variants of the plasticity rules. If PCs do not receive direct visual input (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>), the backpropagation-like algorithm can be replaced by a simple homeostatic Hebbian plasticity rule in the synapses onto the PV interneurons. Given that PCs in V1 are known to receive substantial visual drive (<xref ref-type="bibr" rid="bib80">Yang et al., 2013</xref>; <xref ref-type="bibr" rid="bib79">Xue et al., 2014</xref>), this assumption is unlikely to be valid. We therefore propose an alternative form of plasticity that changes SOM→PV and VIP→PV synapses in proportion to the difference between the excitatory recurrent drive onto PV neurons and a target value (<xref ref-type="bibr" rid="bib46">Mackwood et al., 2020</xref>, see <xref ref-type="fig" rid="fig6">Figure 6</xref>). The underlying mechanism is similar to feedback alignment (<xref ref-type="bibr" rid="bib45">Lillicrap et al., 2016</xref>) and requires sufficient overlap between the set of postsynaptic PCs a PV neuron inhibits and the set of presynaptic PCs the same PV neuron receives excitation from. This is likely, given the high connection probability between PCs and PV neurons (<xref ref-type="bibr" rid="bib54">Pfeffer et al., 2013</xref>; <xref ref-type="bibr" rid="bib53">Pala and Petersen, 2015</xref>; <xref ref-type="bibr" rid="bib28">Jiang et al., 2015</xref>). Given that the main goal of the present paper was to show that PE circuits can be learned by balancing excitation and inhibition, we used the plasticity rule implementing a backpropagation of error, to ensure maximal generality.</p><p>We modeled the apical dendrite of PCs as a single compartment that integrates excitatory and inhibitory input currents and has the potential to produce calcium spike-like events (<xref ref-type="bibr" rid="bib82">Yuste et al., 1994</xref>; <xref ref-type="bibr" rid="bib38">Larkum et al., 1999</xref>; <xref ref-type="bibr" rid="bib50">Murayama et al., 2009</xref>; <xref ref-type="bibr" rid="bib26">Hertäg and Sprekeler, 2019</xref>). Moreover, we assumed that an overshoot of inhibition decouples the apical tuft of the PCs from their soma, by including a rectifying non-linearity that precludes an excess of dendritic inhibition to influence somatic activity. However, the presence or nature of these dendritic nonlinearities has a minor influence on the development of nPE neurons (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>). When we allowed dendritic inhibition to influence the soma, inhibitory plasticity still established nPE neurons, although the learned interneuron circuit differs with respect to the synaptic strengths. The additional dendritic inhibition reduces the required amount of somatic, PV-mediated inhibition. This is primarily the case during playback phases, when the excitatory motor input to the apical dendrite is absent. PV neurons are therefore less active during the playback phase than during the feedback phase (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>), consistent with recordings in mouse V1 (<xref ref-type="bibr" rid="bib3">Attinger et al., 2017</xref>).</p><p>By modeling the apical dendrite as a single compartment, we also neglected the possibility that dendritic branches process distinct information. However, we expect that the suggested framework of generating predictive signals by a compartment-specific E/I balance generalizes to more complex dendritic configurations, in which local inhibition could contribute by gating different dendritic inputs (<xref ref-type="bibr" rid="bib81">Yang et al., 2016</xref>).</p><p>A hallmark of neurons in sensory areas is their pronounced feature selectivity (<xref ref-type="bibr" rid="bib8">Cardin et al., 2007</xref>; <xref ref-type="bibr" rid="bib51">Niell and Stryker, 2008</xref>; <xref ref-type="bibr" rid="bib22">Harris and Mrsic-Flogel, 2013</xref>). This selectivity is also present in nPE neurons in layer 2/3 of rodent V1 which preferentially signal mismatches in a particular location of the visual field (<xref ref-type="bibr" rid="bib83">Zmarz and Keller, 2016</xref>). Here, we did not include feature selectivity, but only modeled one-dimensional input signals representing actual or expected visual input. However, we expect that nPE neurons can also develop in networks in which excitatory neurons are equipped with feature selectivity and receive multi-dimensional inputs, by the same plasticity rules described here. We conjecture that the presence of feature selectivity imposes further constraints on the network, for instance, regarding feature topography or interneuron tuning properties. For future work, it would be interesting to study how the presence of feature-selective PE neurons constrains the feature selectivity in interneurons that tend to be more broadly tuned than excitatory neurons (<xref ref-type="bibr" rid="bib66">Sohya et al., 2007</xref>; <xref ref-type="bibr" rid="bib8">Cardin et al., 2007</xref>; <xref ref-type="bibr" rid="bib35">Kerlin et al., 2010</xref>; <xref ref-type="bibr" rid="bib2">Atallah et al., 2012</xref>).</p><p>In our model, the excitatory recurrent connections target the apical dendrites of PCs, but given that PCs comprise a homogeneous population, they serve no specific computational purpose in the present context. We expect that this would change if the neurons in the circuit were endowed with stimulus selectivity. For instance, the predictive coding model by <xref ref-type="bibr" rid="bib7">Boerlin et al., 2013</xref> assumes separate recurrent loops for coding and computation (see also <xref ref-type="bibr" rid="bib13">Denève and Machens, 2016</xref>). In this model, the membrane potential represents a prediction error and occasional spiking serves the purpose of reducing a potential mismatch by initiating fast inhibition. The excitatory neurons receive feedforward inputs, fast feedback inhibition and slow excitatory recurrent connections. While the fast inhibitory loop balances the excitatory feedforward and the slow feedback inputs, the slower loop – combined with dendritic nonlinearities – allows for nonlinear computations of the delayed represented variable (<xref ref-type="bibr" rid="bib13">Denève and Machens, 2016</xref>). It will be interesting to study how this line of work is related to the PE circuit model we studied here, but it would require to extend the present model to perform richer computations, for example by endowing it with stimulus selectivity.</p><p>Here, we have mainly focused on the development of nPE neurons because those have been studied extensively in layer 2/3 of rodent V1, which allowed us to qualitatively compare our model with experimental findings. In contrast, to the best of our knowledge, less is known for pPE neurons in the visual system. Moreover, as we assume that excitatory neurons aim to establish an E/I balance for all stimuli they are regularly exposed to, and as animals experience episodes, in which the change of visual input is only caused by external factors (playback phases), excitatory neurons are more likely to develop into nPE than pPE neurons in the sensorimotor paradigm used here. However, it can be assumed that under different circumstances pPE neurons do play an equally important role in the processing of information. We expect that the same principles and approaches described here also hold for the formation of pPE neurons. Indeed, when a network, in which SOM neurons receive motor-related input and VIP neurons receive visual input, is exposed to baseline, feedback and mismatch phases, pPE neurons develop (see <xref ref-type="fig" rid="app2fig2">Appendix 2—figure 2</xref>). The inhibitory plasticity establishes pPE neurons independent of the input configuration onto PCs and PV neurons as long as various excitatory, inhibitory, disinhibitory and dis-disinhibitory pathways can be balanced (see <xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1</xref>, <xref ref-type="disp-formula" rid="equ57 equ58">Equations 50 and 51)</xref>.</p><p>In the present work, we derived the constraints for separate nPE and pPE neurons and did not study the parallel development of both in the same neural network. While the formation of nPE neurons requires SOM neurons to receive visual input, the formation of pPE neurons requires SOM neurons to receive a motor-related prediction thereof. Given that SOM neurons constitute a heterogeneous population (<xref ref-type="bibr" rid="bib28">Jiang et al., 2015</xref>; <xref ref-type="bibr" rid="bib71">Tremblay et al., 2016</xref>; <xref ref-type="bibr" rid="bib72">Urban-Ciecko and Barth, 2016</xref>), it is conceivable that separate sub-circuits enable the parallel existence of nPE and pPE neurons. However, we expect that the presence of both PE types requires refined constraints on the interneuron circuit and plasticity rules. For instance, the formation of nPE and pPE neurons that only increase their activity in mismatch and playback phases, respectively, while remaining at baseline otherwise, introduces constraints for all three phases. Hence, the network must be exposed to all input phases during learning. In the present framework, this would most likely produce excitatory neurons that remain at their baseline in all phases and hence do not encode prediction errors at all. Hence, the plasticity rules must be modified such that they incorporate gating signals that restrict learning to a subset of input phases or a subset of synapses, for example by controlling the learning rates. It has been argued that specific neuromodulators that are linked to self-motion may guide plasticity in prediction-error circuits (<xref ref-type="bibr" rid="bib33">Keller and Mrsic-Flogel, 2018</xref>). For example, neuromodulators could restrict learning to feedback phases. In this case, excitatory neurons would show deviations from baseline during both playback and mismatch phases, that is essentially all neurons would encode both positive and negative prediction errors. A dichotomy of nPE and pPE neurons could result from low baseline firing rates. A thorough investigation of these scenarios for the simultaneous development of nPE and pPE neurons is, however, beyond the scope of the present study.</p><p>Our model suggests a well-orchestrated division of labor of PV, SOM and VIP interneurons that is shaped by experience: While PV neurons balance the sensory input at the somatic compartment of PCs, SOM neurons cancel feedback signals at the apical dendrites. VIP neurons ensure sufficiently large mismatch responses by amplifying small differences between feedforward and feedback inputs (<xref ref-type="bibr" rid="bib3">Attinger et al., 2017</xref>; <xref ref-type="bibr" rid="bib26">Hertäg and Sprekeler, 2019</xref>). Given the relative uniformity of cortex in its appearance, structure and cell types (<xref ref-type="bibr" rid="bib14">Douglas et al., 1989</xref>; <xref ref-type="bibr" rid="bib49">Mountcastle, 1997</xref>), it is conceivable that the same principles also hold for other regions of the cortex beyond V1. Shedding light on the mechanisms that constitute the predictive power of neuronal circuits may in the long run contribute to an understanding of psychiatric disorders that have long been associated with a malfunction of the brain’s prediction machinery (<xref ref-type="bibr" rid="bib18">Fletcher and Frith, 2009</xref>; <xref ref-type="bibr" rid="bib10">Corlett et al., 2009</xref>; <xref ref-type="bibr" rid="bib65">Sinha et al., 2014</xref>; <xref ref-type="bibr" rid="bib41">Lawson et al., 2017</xref>) and specific types of interneurons (<xref ref-type="bibr" rid="bib47">Marín, 2012</xref>; <xref ref-type="bibr" rid="bib24">Hattori et al., 2017</xref>; <xref ref-type="bibr" rid="bib5">Batista-Brito et al., 2018</xref>).</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Network model</title><p>We simulated a rate-based network model of excitatory pyramidal cells (<inline-formula><mml:math id="inf21"><mml:msub><mml:mi>N</mml:mi><mml:mi>PC</mml:mi></mml:msub></mml:math></inline-formula> = 70) and inhibitory PV, SOM and VIP neurons (<inline-formula><mml:math id="inf22"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>PV</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>SOM</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>VIP</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> = 10). All neurons are randomly connected with connection strengths and probabilities given below (see ‘Connectivity’).</p><p>The excitatory pyramidal cells are described by a two-compartment rate model that was introduced by <xref ref-type="bibr" rid="bib50">Murayama et al., 2009</xref>. The dynamics of the firing rate <inline-formula><mml:math id="inf23"><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of the somatic compartment of neuron <italic>i</italic> obeys<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf24"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:math></inline-formula> denotes the excitatory rate time constant (<inline-formula><mml:math id="inf25"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:math></inline-formula> = 60 ms), <inline-formula><mml:math id="inf26"><mml:mi mathvariant="normal">Θ</mml:mi></mml:math></inline-formula> terms the rheobase of the neuron (<inline-formula><mml:math id="inf27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo>=</mml:mo><mml:mn>14</mml:mn><mml:mtext> </mml:mtext><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>). Firing rates are rectified to ensure positivity. <inline-formula><mml:math id="inf28"><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is the total somatic input generated by somatic and dendritic synaptic events and potential dendritic calcium spikes:<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>syn</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>syn</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Here, the function <inline-formula><mml:math id="inf29"><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is a rectifying nonlinearity that prohibits an excess of inhibition at the apical dendrite to reach the soma. <inline-formula><mml:math id="inf30"><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>syn</mml:mi></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf31"><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>syn</mml:mi></mml:msubsup></mml:math></inline-formula> are the total synaptic inputs into dendrite and soma, respectively, and <inline-formula><mml:math id="inf32"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> denotes a dendritic calcium event. <inline-formula><mml:math id="inf33"><mml:msub><mml:mi>λ</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf34"><mml:msub><mml:mi>λ</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:math></inline-formula> are the fractions of ‘currents’ leaking away from dendrites and soma, respectively (<inline-formula><mml:math id="inf35"><mml:msub><mml:mi>λ</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:msub></mml:math></inline-formula>=0.27, <inline-formula><mml:math id="inf36"><mml:msub><mml:mi>λ</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:math></inline-formula>=0.31). The synaptic input to the soma <inline-formula><mml:math id="inf37"><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>syn</mml:mi></mml:msubsup></mml:math></inline-formula> is given by the sum of external sensory inputs <inline-formula><mml:math id="inf38"><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:math></inline-formula> and PV neuron-induced (P) inhibition,<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>syn</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>PV</mml:mi></mml:msub></mml:munderover></mml:mstyle><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>EP</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The dendritic input <inline-formula><mml:math id="inf39"><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>syn</mml:mi></mml:msubsup></mml:math></inline-formula> is the sum of motor-related predictions <inline-formula><mml:math id="inf40"><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:msub></mml:math></inline-formula>, the recurrent, excitatory connections from other PCs and SOM neuron-induced (S) inhibition:<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>syn</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>SOM</mml:mi></mml:msub></mml:munderover></mml:mstyle><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>DS</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>PC</mml:mi></mml:msub></mml:munderover></mml:mstyle><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>DE</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The weight matrices <inline-formula><mml:math id="inf41"><mml:msub><mml:mi>w</mml:mi><mml:mi>EP</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf42"><mml:msub><mml:mi>w</mml:mi><mml:mi>DS</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf43"><mml:msub><mml:mi>w</mml:mi><mml:mi>DE</mml:mi></mml:msub></mml:math></inline-formula> denote the strength of connection between PV neurons and the soma of PCs (<inline-formula><mml:math id="inf44"><mml:msub><mml:mi>w</mml:mi><mml:mi>EP</mml:mi></mml:msub></mml:math></inline-formula>), SOM neurons and the dendrites of PCs (<inline-formula><mml:math id="inf45"><mml:msub><mml:mi>w</mml:mi><mml:mi>DS</mml:mi></mml:msub></mml:math></inline-formula>) and the recurrence between PCs (<inline-formula><mml:math id="inf46"><mml:msub><mml:mi>w</mml:mi><mml:mi>DE</mml:mi></mml:msub></mml:math></inline-formula>), respectively. The input generated by a calcium spike is given by<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>⋅</mml:mo><mml:mi>H</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>c</italic> scales the amount of current produced (<inline-formula><mml:math id="inf47"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>7</mml:mn><mml:mspace width="thinmathspace"/><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>), <inline-formula><mml:math id="inf48"><mml:mi>H</mml:mi></mml:math></inline-formula> is the Heaviside step function, <inline-formula><mml:math id="inf49"><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula> represents a threshold that describes the minimal input needed to produce a Ca<sup>2+</sup>-spike (<inline-formula><mml:math id="inf50"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>28</mml:mn><mml:mtext> </mml:mtext><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>) and <inline-formula><mml:math id="inf51"><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup></mml:math></inline-formula> denotes the total, synaptically generated input in the dendrites,<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>syn</mml:mi></mml:msubsup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>syn</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Note that we incorporated the gain factor present in <xref ref-type="bibr" rid="bib50">Murayama et al., 2009</xref> into the parameters to achieve unit consistency for all neuron types (when we compared excitatory/inhibitory currents, the respective activities were divided by this gain factor, <inline-formula><mml:math id="inf52"><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>0.07</mml:mn></mml:mrow></mml:math></inline-formula> (pA· s)<sup>−1</sup>).</p><p>The firing rate dynamics of each interneuron is modeled by a rectified, linear differential equation (<xref ref-type="bibr" rid="bib76">Wilson and Cowan, 1972</xref>),<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">X</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">X</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">X</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">X</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">O</mml:mi><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">X</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">X</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf53"><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">X</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> denotes the firing rate of neuron <italic>i</italic> from neuron type <inline-formula><mml:math id="inf54"><mml:mi>X</mml:mi></mml:math></inline-formula> (<inline-formula><mml:math id="inf55"><mml:mrow><mml:mi>X</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) and <inline-formula><mml:math id="inf56"><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> represents external inputs. The weight matrices <inline-formula><mml:math id="inf57"><mml:msub><mml:mi>w</mml:mi><mml:mi>XY</mml:mi></mml:msub></mml:math></inline-formula> denote the strength of connection between the presynaptic neuron population <italic>Y</italic> and the postsynaptic neuron population <italic>X</italic>. The rate time constant <inline-formula><mml:math id="inf58"><mml:msub><mml:mi>τ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> was chosen to resemble a fast GABA<sub>A</sub> time constant, and set to 2 ms for all interneuron types included.</p></sec><sec id="s4-2"><title>Negative prediction-error neurons</title><p>We define PCs as nPE neurons when they exclusively increase their firing rate during feedback mismatch (visual input smaller than predicted), while remaining at their baseline during feedback and playback phases. In a linearized, homogeneous network and under the assumption that the apical dendrites are sufficiently inhibited during feedback and playback phase, this definition is equivalent to two constraints on the interneuron network (see Appendix 1 for a detailed analysis and derivation):<disp-formula id="equ8"><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mlabeledtr><mml:mtd><mml:mtext>(8)</mml:mtext></mml:mtd><mml:mtd><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mtr><mml:mtd><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mlabeledtr><mml:mtd><mml:mtext>(9)</mml:mtext></mml:mtd><mml:mtd/><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The parameters <inline-formula><mml:math id="inf59"><mml:mrow><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>X</mml:mi></mml:msub></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> indicate whether neuron type <italic>X</italic> receives visual and motor-related inputs, respectively, and control the different input configurations. In addition to the conditions <xref ref-type="disp-formula" rid="equ8 equ8">Equations 8 and 9</xref>, the synapses from SOM neurons onto the apical dendrites must be sufficiently strong to cancel potential excitatory inputs during feedback and playback phase.</p><p>In practice, we classify PCs as nPE neurons when <inline-formula><mml:math id="inf60"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:math></inline-formula> is larger than 20% in the mismatch phase and less than ±10% elsewhere (<inline-formula><mml:math id="inf61"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>BL</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>BL</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf62"><mml:msub><mml:mi>r</mml:mi><mml:mi>BL</mml:mi></mml:msub></mml:math></inline-formula>: baseline firing rate). Tolerating small deviations in feedback and playback phase is more in line with experimental approaches. The results do not rely on the precise thresholds used for the classification.</p></sec><sec id="s4-3"><title>Connectivity</title><p>All neurons are randomly connected with connection probabilities motivated by the experimental literature (<xref ref-type="bibr" rid="bib17">Fino and Yuste, 2011</xref>; <xref ref-type="bibr" rid="bib52">Packer and Yuste, 2011</xref>; <xref ref-type="bibr" rid="bib54">Pfeffer et al., 2013</xref>; <xref ref-type="bibr" rid="bib42">Lee et al., 2013</xref>; <xref ref-type="bibr" rid="bib56">Pi et al., 2013</xref>; <xref ref-type="bibr" rid="bib28">Jiang et al., 2015</xref>; <xref ref-type="bibr" rid="bib30">Jouhanneau et al., 2015</xref>; <xref ref-type="bibr" rid="bib53">Pala and Petersen, 2015</xref>),<disp-formula id="equ9"><label>(10)</label><mml:math id="m9"><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="5pt" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>p</mml:mi><mml:mi>EE</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>p</mml:mi><mml:mi>EP</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>p</mml:mi><mml:mi>ES</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>p</mml:mi><mml:mi>EV</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>p</mml:mi><mml:mi>DE</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>p</mml:mi><mml:mi>DP</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>p</mml:mi><mml:mi>DS</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>p</mml:mi><mml:mi>DV</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>p</mml:mi><mml:mi>PE</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>p</mml:mi><mml:mi>PP</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>p</mml:mi><mml:mi>PS</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>p</mml:mi><mml:mi>PV</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>p</mml:mi><mml:mi>SE</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>p</mml:mi><mml:mi>SP</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>p</mml:mi><mml:mi>SS</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>p</mml:mi><mml:mi>SV</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>p</mml:mi><mml:mi>VE</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>p</mml:mi><mml:mi>VP</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>p</mml:mi><mml:mi>VS</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>p</mml:mi><mml:mi>VV</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="5pt" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:mo>-</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mn>0.6</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mo>-</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mo>-</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0.1</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mo>-</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mn>0.55</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mo>-</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0.45</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0.5</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0.6</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0.5</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0.35</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mo>-</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mo>-</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mn>0.5</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0.1</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mo>-</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mn>0.45</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mo>-</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>All cells of the same neuron type have the same number of incoming connections. The mean connection strengths are given by<disp-formula id="equ10"><label>(11)</label><mml:math id="m10"><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="5pt" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mi>EE</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mi>EP</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mi>ES</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mi>EV</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mi>DE</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mi>DP</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mi>DS</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mi>DV</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mi>PE</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mi>PP</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mi>PS</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mi>PV</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mi>SE</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mi>SP</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mi>SS</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mi>SV</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mi>VE</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mi>VP</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mi>VS</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mi>VV</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="5pt" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:mo>-</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mo>*</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mo>-</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mo>-</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0.42</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mo>-</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mo>*</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mo>-</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mo>*</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mo>*</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mo>*</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mo>*</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mo>-</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mo>-</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mn>0.6</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mo>-</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mn>0.5</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mo>-</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>where the symbol * denotes weights that vary between simulations (e.g., subject to plasticity or computed from the <xref ref-type="disp-formula" rid="equ8 equ8">Equations 8 and 9</xref>). For non-plastic networks, these synaptic strengths are given by <inline-formula><mml:math id="inf63"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>EP</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2.8</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf64"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>DS</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>3.5</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf65"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>PE</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf66"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>PP</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> (if PCs receive visual input) or <inline-formula><mml:math id="inf67"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>PP</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:math></inline-formula> (if PCs receive no visual input), <inline-formula><mml:math id="inf68"><mml:msub><mml:mi>w</mml:mi><mml:mi>PS</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf69"><mml:msub><mml:mi>w</mml:mi><mml:mi>PV</mml:mi></mml:msub></mml:math></inline-formula> are computed from the <xref ref-type="disp-formula" rid="equ8 equ8">Equations 8 and 9</xref>.</p><p>For plastic networks, the initial connections between neurons are drawn from uniform distributions <inline-formula><mml:math id="inf70"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">𝒰</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mpadded width="+5pt"><mml:mn>0.5</mml:mn></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mpadded width="+5pt"><mml:mn>1.5</mml:mn></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> where <italic>w</italic> denotes the mean connection strengths given in (<xref ref-type="disp-formula" rid="equ10">Equation 11</xref>) and <inline-formula><mml:math id="inf71"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>EP</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1.75</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf72"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>DS</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.35</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf73"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>PE</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2.5</mml:mn></mml:mrow></mml:math></inline-formula> (if PCs receive visual input) or <inline-formula><mml:math id="inf74"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>PE</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1.2</mml:mn></mml:mrow></mml:math></inline-formula> (if PCs receive no visual input), <inline-formula><mml:math id="inf75"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>PP</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> (if PCs receive visual input) or <inline-formula><mml:math id="inf76"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>PP</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:math></inline-formula> (if PCs receive no visual input), <inline-formula><mml:math id="inf77"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>PS</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf78"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>PV</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math></inline-formula>. Please note that the system is robust to the choice of connections strengths. The connection strengths are merely chosen such that the solutions of <xref ref-type="disp-formula" rid="equ8 equ8">Equations 8 and 9</xref> comply with Dale’s principle.</p><p>All weights are scaled in proportion to the number of existing connections (i.e., the product of the number of presynaptic neurons and the connection probability), so that the results are independent of the population size.</p></sec><sec id="s4-4"><title>Inputs</title><p>All neurons receive constant, external background input that ensures reasonable baseline firing rates in the absence of visual and motor-related input. In the case of non-plastic networks, these inputs were set such that the baseline firing rates are <inline-formula><mml:math id="inf79"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf80"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf81"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf82"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. In the case of plastic networks, we set the external inputs to <inline-formula><mml:math id="inf83"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>28</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf84"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf85"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf86"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf87"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> (if not stated otherwise). In addition to the external background inputs, the neurons receive either visual input (<italic>v</italic>), a motor-related prediction thereof (<italic>m</italic>) or both.</p><p>In line with the experimental setup of <xref ref-type="bibr" rid="bib3">Attinger et al., 2017</xref>, we distinguish between baseline (<inline-formula><mml:math id="inf88"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), feedback (<inline-formula><mml:math id="inf89"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mi>v</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), feedback mismatch (<inline-formula><mml:math id="inf90"><mml:mrow><mml:mi>m</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:math></inline-formula>) and playback (<inline-formula><mml:math id="inf91"><mml:mrow><mml:mi>m</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:math></inline-formula>) phases. During training, the network is exposed to feedback and playback phases with stimuli drawn from a uniform distribution from the interval <inline-formula><mml:math id="inf92"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mn>7</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. After learning, the strength of stimuli is set to <inline-formula><mml:math id="inf93"><mml:mrow><mml:mn>7</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> (plastic networks) or <inline-formula><mml:math id="inf94"><mml:mrow><mml:mn>3.5</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> (non-plastic networks).</p></sec><sec id="s4-5"><title>Plasticity</title><p>In plastic networks, a number of connections between neurons are subject to experience-dependent changes in order to establish an E/I balance for PCs. PV→PC and the PC→PV synapses establish the target firing rates for PCs and PV neurons, respectively. VIP→PV and SOM→PV synapses and the synapses from SOM neurons onto the apical dendrites of PCs ensure that PCs remain at their baseline during feedback and playback phase. The corresponding plasticity rules are of the form<disp-formula id="equ11"><label>(12)</label><mml:math id="m11"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mo>∝</mml:mo><mml:mrow><mml:mo>±</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>post</mml:mi><mml:mo>-</mml:mo><mml:mi>baseline</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mi>pre</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><sec id="s4-5-1"><title>Connections onto PCs</title><p>In detail, the connections from PV and SOM neurons onto the soma and the apical dendrites, respectively, obey inhibitory Hebbian plasticity rules akin to <xref ref-type="bibr" rid="bib73">Vogels et al., 2011</xref><disp-formula id="equ12"><label>(13)</label><mml:math id="m12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∝</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>ρ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ13"><label>(14)</label><mml:math id="m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∝</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mi>ϵ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The parameter <inline-formula><mml:math id="inf95"><mml:msubsup><mml:mi>ρ</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> denotes the baseline firing rate of the postsynaptic PC, and the dendritic activity <inline-formula><mml:math id="inf96"><mml:msubsup><mml:mi>A</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is given by the rectified synaptic events at the dendrites<disp-formula id="equ14"><label>(15)</label><mml:math id="m14"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>A</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>syn</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:msub></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The small ‘correction’ term <inline-formula><mml:math id="inf97"><mml:mi>ϵ</mml:mi></mml:math></inline-formula> eases the effect of strong onset responses (here, we used <inline-formula><mml:math id="inf98"><mml:mrow><mml:mi>ϵ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.1</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>).</p></sec><sec id="s4-5-2"><title>Connections onto PV neurons - non-local learning</title><p>The connections from both SOM and VIP neurons onto PV neurons implement an approximation of a backpropagation of error<disp-formula id="equ15"><label>(16)</label><mml:math id="m15"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>∝</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munder></mml:mstyle><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>ρ</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p><inline-formula><mml:math id="inf99"><mml:msubsup><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> denotes the set of postsynaptic PCs a particular PV neuron is connected to, and <inline-formula><mml:math id="inf100"><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the number of excitatory neurons in <inline-formula><mml:math id="inf101"><mml:msubsup><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>.</p></sec><sec id="s4-5-3"><title>Connections onto PV neurons - local approximation to backpropagation of error</title><p>When the connection probability between PCs and PV neurons is large, this backpropagation of error can be replaced by a biologically plausible learning rule that only relies on local information available in the PV neurons (<xref ref-type="fig" rid="fig6">Figure 6</xref>),<disp-formula id="equ16"><label>(17)</label><mml:math id="m16"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>∝</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi mathvariant="normal">E</mml:mi><mml:mrow><mml:mi>rec</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf102"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi mathvariant="normal">E</mml:mi><mml:mrow><mml:mi>rec</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> denotes the difference between the excitatory recurrent drive onto PV neuron <italic>i</italic> and a target value<disp-formula id="equ17"><label>(18)</label><mml:math id="m17"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi mathvariant="normal">E</mml:mi><mml:mrow><mml:mi>rec</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munder></mml:mstyle><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>PE</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>ρ</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p><inline-formula><mml:math id="inf103"><mml:msubsup><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> denotes the set of presynaptic PCs a particular PV neuron receives excitation from.</p></sec><sec id="s4-5-4"><title>Connections onto PV neurons - learning with a homeostatic firing rate for PV neurons</title><p>When nPE neurons do not receive direct visual input, the backpropagation rules can be simplified even further (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). The synapses onto PV neurons can be learned according to a Hebbian inhibitory plasticity rule (<xref ref-type="bibr" rid="bib73">Vogels et al., 2011</xref>) that aims to sustain a baseline rate in the PV neurons<disp-formula id="equ18"><label>(19)</label><mml:math id="m18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">X</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∝</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>ρ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">X</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></disp-formula>with <inline-formula><mml:math id="inf104"><mml:mrow><mml:mi>X</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. This baseline rate is established by modifying the connections from PCs onto PV neurons according to an anti-Hebbian plasticity rule<disp-formula id="equ19"><label>(20)</label><mml:math id="m19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∝</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ρ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p></sec></sec><sec id="s4-6"><title>Simulation and code availability</title><p>All simulations were performed in customized Python code written by LH. Differential equations were numerically integrated using a 2nd-order Runge-Kutta method with time steps between 0.05 and 2 ms. Neurons were initialized with <inline-formula><mml:math id="inf105"><mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Source code and data for all figures will be available after publication at <xref ref-type="bibr" rid="bib25">Hertäg, 2020</xref> (<ext-link ext-link-type="uri" xlink:href="https://github.com/sprekelerlab/SourceCode_Hertaeg20">https://github.com/sprekelerlab/SourceCode_Hertaeg20</ext-link>, copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/SourceCode_Hertaeg20">https://github.com/elifesciences-publications/SourceCode_Hertaeg20</ext-link>).</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We are grateful to Laura Bella Naumann and Joram Keijser for critical reading of the manuscript and Owen Mackwood for technical guidance during development of the simulator. We also want to thank all members of the Sprekeler lab for discussion, support and comments on the manuscript. The project is funded by the German Federal Ministry for Education and Research, FKZ 01GQ1201 and the DFG via the collaborative research center FOR 2143.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Resources, Supervision, Funding acquisition, Writing - original draft, Project administration, Writing - review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-57541-transrepform-v1.pdf"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>Source code to reproduce simulated data and figures is publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/sprekelerlab/SourceCode_Hertaeg20">https://github.com/sprekelerlab/SourceCode_Hertaeg20</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/SourceCode_Hertaeg20">https://github.com/elifesciences-publications/SourceCode_Hertaeg20</ext-link>).</p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abs</surname> <given-names>E</given-names></name><name><surname>Poorthuis</surname> <given-names>RB</given-names></name><name><surname>Apelblat</surname> <given-names>D</given-names></name><name><surname>Muhammad</surname> <given-names>K</given-names></name><name><surname>Pardi</surname> <given-names>MB</given-names></name><name><surname>Enke</surname> <given-names>L</given-names></name><name><surname>Kushinsky</surname> <given-names>D</given-names></name><name><surname>Pu</surname> <given-names>DL</given-names></name><name><surname>Eizinger</surname> <given-names>MF</given-names></name><name><surname>Conzelmann</surname> <given-names>KK</given-names></name><name><surname>Spiegel</surname> <given-names>I</given-names></name><name><surname>Letzkus</surname> <given-names>JJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Learning-Related plasticity in Dendrite-Targeting layer 1 interneurons</article-title><source>Neuron</source><volume>100</volume><fpage>684</fpage><lpage>699</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2018.09.001</pub-id><pub-id pub-id-type="pmid">30269988</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Atallah</surname> <given-names>BV</given-names></name><name><surname>Bruns</surname> <given-names>W</given-names></name><name><surname>Carandini</surname> <given-names>M</given-names></name><name><surname>Scanziani</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Parvalbumin-expressing interneurons linearly transform cortical responses to visual stimuli</article-title><source>Neuron</source><volume>73</volume><fpage>159</fpage><lpage>170</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2011.12.013</pub-id><pub-id pub-id-type="pmid">22243754</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Attinger</surname> <given-names>A</given-names></name><name><surname>Wang</surname> <given-names>B</given-names></name><name><surname>Keller</surname> <given-names>GB</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Visuomotor coupling shapes the functional development of mouse visual cortex</article-title><source>Cell</source><volume>169</volume><fpage>1291</fpage><lpage>1302</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2017.05.023</pub-id><pub-id pub-id-type="pmid">28602353</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ayaz</surname> <given-names>A</given-names></name><name><surname>Stäuble</surname> <given-names>A</given-names></name><name><surname>Hamada</surname> <given-names>M</given-names></name><name><surname>Wulf</surname> <given-names>MA</given-names></name><name><surname>Saleem</surname> <given-names>AB</given-names></name><name><surname>Helmchen</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Layer-specific integration of locomotion and sensory information in mouse barrel cortex</article-title><source>Nature Communications</source><volume>10</volume><elocation-id>2585</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-019-10564-8</pub-id><pub-id pub-id-type="pmid">31197148</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Batista-Brito</surname> <given-names>R</given-names></name><name><surname>Zagha</surname> <given-names>E</given-names></name><name><surname>Ratliff</surname> <given-names>JM</given-names></name><name><surname>Vinck</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Modulation of cortical circuits by top-down processing and arousal state in health and disease</article-title><source>Current Opinion in Neurobiology</source><volume>52</volume><fpage>172</fpage><lpage>181</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2018.06.008</pub-id><pub-id pub-id-type="pmid">30064117</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bell</surname> <given-names>CC</given-names></name></person-group><year iso-8601-date="1981">1981</year><article-title>An efference copy which is modified by reafferent input</article-title><source>Science</source><volume>214</volume><fpage>450</fpage><lpage>453</lpage><pub-id pub-id-type="doi">10.1126/science.7291985</pub-id><pub-id pub-id-type="pmid">7291985</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boerlin</surname> <given-names>M</given-names></name><name><surname>Machens</surname> <given-names>CK</given-names></name><name><surname>Denève</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Predictive coding of dynamical variables in balanced spiking networks</article-title><source>PLOS Computational Biology</source><volume>9</volume><elocation-id>e1003258</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003258</pub-id><pub-id pub-id-type="pmid">24244113</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cardin</surname> <given-names>JA</given-names></name><name><surname>Palmer</surname> <given-names>LA</given-names></name><name><surname>Contreras</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Stimulus feature selectivity in excitatory and inhibitory neurons in primary visual cortex</article-title><source>Journal of Neuroscience</source><volume>27</volume><fpage>10333</fpage><lpage>10344</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1692-07.2007</pub-id><pub-id pub-id-type="pmid">17898205</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cauller</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Layer I of primary sensory neocortex: where top-down converges upon bottom-up</article-title><source>Behavioural Brain Research</source><volume>71</volume><fpage>163</fpage><lpage>170</lpage><pub-id pub-id-type="doi">10.1016/0166-4328(95)00032-1</pub-id><pub-id pub-id-type="pmid">8747184</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Corlett</surname> <given-names>PR</given-names></name><name><surname>Frith</surname> <given-names>CD</given-names></name><name><surname>Fletcher</surname> <given-names>PC</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>From drugs to deprivation: a bayesian framework for understanding models of psychosis</article-title><source>Psychopharmacology</source><volume>206</volume><fpage>515</fpage><lpage>530</lpage><pub-id pub-id-type="doi">10.1007/s00213-009-1561-0</pub-id><pub-id pub-id-type="pmid">19475401</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crick</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>The recent excitement about neural networks</article-title><source>Nature</source><volume>337</volume><fpage>129</fpage><lpage>132</lpage><pub-id pub-id-type="doi">10.1038/337129a0</pub-id><pub-id pub-id-type="pmid">2911347</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>den Ouden</surname> <given-names>HE</given-names></name><name><surname>Kok</surname> <given-names>P</given-names></name><name><surname>de Lange</surname> <given-names>FP</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>How prediction errors shape perception, attention, and motivation</article-title><source>Frontiers in Psychology</source><volume>3</volume><elocation-id>548</elocation-id><pub-id pub-id-type="doi">10.3389/fpsyg.2012.00548</pub-id><pub-id pub-id-type="pmid">23248610</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Denève</surname> <given-names>S</given-names></name><name><surname>Machens</surname> <given-names>CK</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Efficient codes and balanced networks</article-title><source>Nature Neuroscience</source><volume>19</volume><fpage>375</fpage><lpage>382</lpage><pub-id pub-id-type="doi">10.1038/nn.4243</pub-id><pub-id pub-id-type="pmid">26906504</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Douglas</surname> <given-names>RJ</given-names></name><name><surname>Martin</surname> <given-names>KAC</given-names></name><name><surname>Whitteridge</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>A canonical microcircuit for neocortex</article-title><source>Neural Computation</source><volume>1</volume><fpage>480</fpage><lpage>488</lpage><pub-id pub-id-type="doi">10.1162/neco.1989.1.4.480</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eliades</surname> <given-names>SJ</given-names></name><name><surname>Wang</surname> <given-names>X</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Neural substrates of vocalization feedback monitoring in primate auditory cortex</article-title><source>Nature</source><volume>453</volume><fpage>1102</fpage><lpage>1106</lpage><pub-id pub-id-type="doi">10.1038/nature06910</pub-id><pub-id pub-id-type="pmid">18454135</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Felleman</surname> <given-names>DJ</given-names></name><name><surname>Van Essen</surname> <given-names>DC</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>Distributed hierarchical processing in the primate cerebral cortex</article-title><source>Cerebral Cortex</source><volume>1</volume><fpage>1</fpage><lpage>47</lpage><pub-id pub-id-type="doi">10.1093/cercor/1.1.1</pub-id><pub-id pub-id-type="pmid">1822724</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fino</surname> <given-names>E</given-names></name><name><surname>Yuste</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Dense inhibitory connectivity in neocortex</article-title><source>Neuron</source><volume>69</volume><fpage>1188</fpage><lpage>1203</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2011.02.025</pub-id><pub-id pub-id-type="pmid">21435562</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fletcher</surname> <given-names>PC</given-names></name><name><surname>Frith</surname> <given-names>CD</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Perceiving is believing: a bayesian approach to explaining the positive symptoms of schizophrenia</article-title><source>Nature Reviews Neuroscience</source><volume>10</volume><fpage>48</fpage><lpage>58</lpage><pub-id pub-id-type="doi">10.1038/nrn2536</pub-id><pub-id pub-id-type="pmid">19050712</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Franklin</surname> <given-names>DW</given-names></name><name><surname>Wolpert</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Computational mechanisms of sensorimotor control</article-title><source>Neuron</source><volume>72</volume><fpage>425</fpage><lpage>442</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2011.10.006</pub-id><pub-id pub-id-type="pmid">22078503</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friston</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>A theory of cortical responses</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>360</volume><fpage>815</fpage><lpage>836</lpage><pub-id pub-id-type="doi">10.1098/rstb.2005.1622</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fu</surname> <given-names>Y</given-names></name><name><surname>Tucciarone</surname> <given-names>JM</given-names></name><name><surname>Espinosa</surname> <given-names>JS</given-names></name><name><surname>Sheng</surname> <given-names>N</given-names></name><name><surname>Darcy</surname> <given-names>DP</given-names></name><name><surname>Nicoll</surname> <given-names>RA</given-names></name><name><surname>Huang</surname> <given-names>ZJ</given-names></name><name><surname>Stryker</surname> <given-names>MP</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A cortical circuit for gain control by behavioral state</article-title><source>Cell</source><volume>156</volume><fpage>1139</fpage><lpage>1152</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2014.01.050</pub-id><pub-id pub-id-type="pmid">24630718</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harris</surname> <given-names>KD</given-names></name><name><surname>Mrsic-Flogel</surname> <given-names>TD</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Cortical connectivity and sensory coding</article-title><source>Nature</source><volume>503</volume><fpage>51</fpage><lpage>58</lpage><pub-id pub-id-type="doi">10.1038/nature12654</pub-id><pub-id pub-id-type="pmid">24201278</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harris</surname> <given-names>KD</given-names></name><name><surname>Shepherd</surname> <given-names>GM</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The neocortical circuit: themes and variations</article-title><source>Nature Neuroscience</source><volume>18</volume><fpage>170</fpage><lpage>181</lpage><pub-id pub-id-type="doi">10.1038/nn.3917</pub-id><pub-id pub-id-type="pmid">25622573</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hattori</surname> <given-names>R</given-names></name><name><surname>Kuchibhotla</surname> <given-names>KV</given-names></name><name><surname>Froemke</surname> <given-names>RC</given-names></name><name><surname>Komiyama</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Functions and dysfunctions of neocortical inhibitory neuron subtypes</article-title><source>Nature Neuroscience</source><volume>20</volume><fpage>1199</fpage><lpage>1208</lpage><pub-id pub-id-type="doi">10.1038/nn.4619</pub-id><pub-id pub-id-type="pmid">28849791</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Hertäg</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>Code for reproduction of Hertäg &amp; Sprekeler (2020)</data-title><source>GitHub</source><version designator="b681f98">b681f98</version><ext-link ext-link-type="uri" xlink:href="https://github.com/sprekelerlab/SourceCode_Hertaeg20">https://github.com/sprekelerlab/SourceCode_Hertaeg20</ext-link></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hertäg</surname> <given-names>L</given-names></name><name><surname>Sprekeler</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Amplifying the redistribution of somato-dendritic inhibition by the interplay of three interneuron types</article-title><source>PLOS Computational Biology</source><volume>15</volume><elocation-id>e1006999</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006999</pub-id><pub-id pub-id-type="pmid">31095556</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hioki</surname> <given-names>H</given-names></name><name><surname>Okamoto</surname> <given-names>S</given-names></name><name><surname>Konno</surname> <given-names>M</given-names></name><name><surname>Kameda</surname> <given-names>H</given-names></name><name><surname>Sohn</surname> <given-names>J</given-names></name><name><surname>Kuramoto</surname> <given-names>E</given-names></name><name><surname>Fujiyama</surname> <given-names>F</given-names></name><name><surname>Kaneko</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Cell type-specific inhibitory inputs to dendritic and somatic compartments of parvalbumin-expressing neocortical interneuron</article-title><source>Journal of Neuroscience</source><volume>33</volume><fpage>544</fpage><lpage>555</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2255-12.2013</pub-id><pub-id pub-id-type="pmid">23303934</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname> <given-names>X</given-names></name><name><surname>Shen</surname> <given-names>S</given-names></name><name><surname>Cadwell</surname> <given-names>CR</given-names></name><name><surname>Berens</surname> <given-names>P</given-names></name><name><surname>Sinz</surname> <given-names>F</given-names></name><name><surname>Ecker</surname> <given-names>AS</given-names></name><name><surname>Patel</surname> <given-names>S</given-names></name><name><surname>Tolias</surname> <given-names>AS</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Principles of connectivity among morphologically defined cell types in adult neocortex</article-title><source>Science</source><volume>350</volume><elocation-id>aac9462</elocation-id><pub-id pub-id-type="doi">10.1126/science.aac9462</pub-id><pub-id pub-id-type="pmid">26612957</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Jordan</surname> <given-names>R</given-names></name><name><surname>Keller</surname> <given-names>GB</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Opposing influence of top-down and bottom-up input on different types of excitatory layer 2/3 neurons in mouse visual corte</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2020.03.25.008607</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jouhanneau</surname> <given-names>JS</given-names></name><name><surname>Kremkow</surname> <given-names>J</given-names></name><name><surname>Dorrn</surname> <given-names>AL</given-names></name><name><surname>Poulet</surname> <given-names>JF</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>In vivo monosynaptic excitatory transmission between layer 2 cortical pyramidal neurons</article-title><source>Cell Reports</source><volume>13</volume><fpage>2098</fpage><lpage>2106</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2015.11.011</pub-id><pub-id pub-id-type="pmid">26670044</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keller</surname> <given-names>GB</given-names></name><name><surname>Bonhoeffer</surname> <given-names>T</given-names></name><name><surname>Hübener</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Sensorimotor mismatch signals in primary visual cortex of the behaving mouse</article-title><source>Neuron</source><volume>74</volume><fpage>809</fpage><lpage>815</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2012.03.040</pub-id><pub-id pub-id-type="pmid">22681686</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keller</surname> <given-names>GB</given-names></name><name><surname>Hahnloser</surname> <given-names>RH</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Neural processing of auditory feedback during vocal practice in a songbird</article-title><source>Nature</source><volume>457</volume><fpage>187</fpage><lpage>190</lpage><pub-id pub-id-type="doi">10.1038/nature07467</pub-id><pub-id pub-id-type="pmid">19005471</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keller</surname> <given-names>GB</given-names></name><name><surname>Mrsic-Flogel</surname> <given-names>TD</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Predictive processing: a canonical cortical computation</article-title><source>Neuron</source><volume>100</volume><fpage>424</fpage><lpage>435</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2018.10.003</pub-id><pub-id pub-id-type="pmid">30359606</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kennedy</surname> <given-names>A</given-names></name><name><surname>Wayne</surname> <given-names>G</given-names></name><name><surname>Kaifosh</surname> <given-names>P</given-names></name><name><surname>Alviña</surname> <given-names>K</given-names></name><name><surname>Abbott</surname> <given-names>LF</given-names></name><name><surname>Sawtell</surname> <given-names>NB</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A temporal basis for predicting the sensory consequences of motor commands in an electric fish</article-title><source>Nature Neuroscience</source><volume>17</volume><fpage>416</fpage><lpage>422</lpage><pub-id pub-id-type="doi">10.1038/nn.3650</pub-id><pub-id pub-id-type="pmid">24531306</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kerlin</surname> <given-names>AM</given-names></name><name><surname>Andermann</surname> <given-names>ML</given-names></name><name><surname>Berezovskii</surname> <given-names>VK</given-names></name><name><surname>Reid</surname> <given-names>RC</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Broadly tuned response properties of diverse inhibitory neuron subtypes in mouse visual cortex</article-title><source>Neuron</source><volume>67</volume><fpage>858</fpage><lpage>871</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2010.08.002</pub-id><pub-id pub-id-type="pmid">20826316</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ko</surname> <given-names>H</given-names></name><name><surname>Hofer</surname> <given-names>SB</given-names></name><name><surname>Pichler</surname> <given-names>B</given-names></name><name><surname>Buchanan</surname> <given-names>KA</given-names></name><name><surname>Sjöström</surname> <given-names>PJ</given-names></name><name><surname>Mrsic-Flogel</surname> <given-names>TD</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Functional specificity of local synaptic connections in neocortical networks</article-title><source>Nature</source><volume>473</volume><fpage>87</fpage><lpage>91</lpage><pub-id pub-id-type="doi">10.1038/nature09880</pub-id><pub-id pub-id-type="pmid">21478872</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krabbe</surname> <given-names>S</given-names></name><name><surname>Paradiso</surname> <given-names>E</given-names></name><name><surname>d'Aquin</surname> <given-names>S</given-names></name><name><surname>Bitterman</surname> <given-names>Y</given-names></name><name><surname>Courtin</surname> <given-names>J</given-names></name><name><surname>Xu</surname> <given-names>C</given-names></name><name><surname>Yonehara</surname> <given-names>K</given-names></name><name><surname>Markovic</surname> <given-names>M</given-names></name><name><surname>Müller</surname> <given-names>C</given-names></name><name><surname>Eichlisberger</surname> <given-names>T</given-names></name><name><surname>Gründemann</surname> <given-names>J</given-names></name><name><surname>Ferraguti</surname> <given-names>F</given-names></name><name><surname>Lüthi</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Adaptive disinhibitory gating by VIP interneurons permits associative learning</article-title><source>Nature Neuroscience</source><volume>22</volume><fpage>1834</fpage><lpage>1843</lpage><pub-id pub-id-type="doi">10.1038/s41593-019-0508-y</pub-id><pub-id pub-id-type="pmid">31636447</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Larkum</surname> <given-names>ME</given-names></name><name><surname>Zhu</surname> <given-names>JJ</given-names></name><name><surname>Sakmann</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>A new cellular mechanism for coupling inputs arriving at different cortical layers</article-title><source>Nature</source><volume>398</volume><fpage>338</fpage><lpage>341</lpage><pub-id pub-id-type="doi">10.1038/18686</pub-id><pub-id pub-id-type="pmid">10192334</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Larkum</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013a</year><article-title>A cellular mechanism for cortical associations: an organizing principle for the cerebral cortex</article-title><source>Trends in Neurosciences</source><volume>36</volume><fpage>141</fpage><lpage>151</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2012.11.006</pub-id><pub-id pub-id-type="pmid">23273272</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Larkum</surname> <given-names>ME</given-names></name></person-group><year iso-8601-date="2013">2013b</year><article-title>The yin and yang of cortical layer 1</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>114</fpage><lpage>115</lpage><pub-id pub-id-type="doi">10.1038/nn.3317</pub-id><pub-id pub-id-type="pmid">23354381</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lawson</surname> <given-names>RP</given-names></name><name><surname>Mathys</surname> <given-names>C</given-names></name><name><surname>Rees</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Adults with autism overestimate the volatility of the sensory environment</article-title><source>Nature Neuroscience</source><volume>20</volume><fpage>1293</fpage><lpage>1299</lpage><pub-id pub-id-type="doi">10.1038/nn.4615</pub-id><pub-id pub-id-type="pmid">28758996</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname> <given-names>S</given-names></name><name><surname>Kruglikov</surname> <given-names>I</given-names></name><name><surname>Huang</surname> <given-names>ZJ</given-names></name><name><surname>Fishell</surname> <given-names>G</given-names></name><name><surname>Rudy</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A disinhibitory circuit mediates motor integration in the somatosensory cortex</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>1662</fpage><lpage>1670</lpage><pub-id pub-id-type="doi">10.1038/nn.3544</pub-id><pub-id pub-id-type="pmid">24097044</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname> <given-names>WC</given-names></name><name><surname>Bonin</surname> <given-names>V</given-names></name><name><surname>Reed</surname> <given-names>M</given-names></name><name><surname>Graham</surname> <given-names>BJ</given-names></name><name><surname>Hood</surname> <given-names>G</given-names></name><name><surname>Glattfelder</surname> <given-names>K</given-names></name><name><surname>Reid</surname> <given-names>RC</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Anatomy and function of an excitatory network in the visual cortex</article-title><source>Nature</source><volume>532</volume><fpage>370</fpage><lpage>374</lpage><pub-id pub-id-type="doi">10.1038/nature17192</pub-id><pub-id pub-id-type="pmid">27018655</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leinweber</surname> <given-names>M</given-names></name><name><surname>Ward</surname> <given-names>DR</given-names></name><name><surname>Sobczak</surname> <given-names>JM</given-names></name><name><surname>Attinger</surname> <given-names>A</given-names></name><name><surname>Keller</surname> <given-names>GB</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A sensorimotor circuit in mouse cortex for visual flow predictions</article-title><source>Neuron</source><volume>95</volume><fpage>1420</fpage><lpage>1432</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.08.036</pub-id><pub-id pub-id-type="pmid">28910624</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lillicrap</surname> <given-names>TP</given-names></name><name><surname>Cownden</surname> <given-names>D</given-names></name><name><surname>Tweed</surname> <given-names>DB</given-names></name><name><surname>Akerman</surname> <given-names>CJ</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Random synaptic feedback weights support error backpropagation for deep learning</article-title><source>Nature Communications</source><volume>7</volume><elocation-id>13276</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms13276</pub-id><pub-id pub-id-type="pmid">27824044</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Mackwood</surname> <given-names>O</given-names></name><name><surname>Naumann</surname> <given-names>LB</given-names></name><name><surname>Sprekeler</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Learning excitatory-inhibitory neuronal assemblies in recurrent networks</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2020.03.30.016352</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marín</surname> <given-names>O</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Interneuron dysfunction in psychiatric disorders</article-title><source>Nature Reviews Neuroscience</source><volume>13</volume><fpage>107</fpage><lpage>120</lpage><pub-id pub-id-type="doi">10.1038/nrn3155</pub-id><pub-id pub-id-type="pmid">22251963</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Markram</surname> <given-names>H</given-names></name><name><surname>Toledo-Rodriguez</surname> <given-names>M</given-names></name><name><surname>Wang</surname> <given-names>Y</given-names></name><name><surname>Gupta</surname> <given-names>A</given-names></name><name><surname>Silberberg</surname> <given-names>G</given-names></name><name><surname>Wu</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Interneurons of the neocortical inhibitory system</article-title><source>Nature Reviews Neuroscience</source><volume>5</volume><fpage>793</fpage><lpage>807</lpage><pub-id pub-id-type="doi">10.1038/nrn1519</pub-id><pub-id pub-id-type="pmid">15378039</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mountcastle</surname> <given-names>VB</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>The columnar organization of the neocortex</article-title><source>Brain</source><volume>120 (Pt 4)</volume><fpage>701</fpage><lpage>722</lpage><pub-id pub-id-type="doi">10.1093/brain/120.4.701</pub-id><pub-id pub-id-type="pmid">9153131</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murayama</surname> <given-names>M</given-names></name><name><surname>Pérez-Garci</surname> <given-names>E</given-names></name><name><surname>Nevian</surname> <given-names>T</given-names></name><name><surname>Bock</surname> <given-names>T</given-names></name><name><surname>Senn</surname> <given-names>W</given-names></name><name><surname>Larkum</surname> <given-names>ME</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Dendritic encoding of sensory stimuli controlled by deep cortical interneurons</article-title><source>Nature</source><volume>457</volume><fpage>1137</fpage><lpage>1141</lpage><pub-id pub-id-type="doi">10.1038/nature07663</pub-id><pub-id pub-id-type="pmid">19151696</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Niell</surname> <given-names>CM</given-names></name><name><surname>Stryker</surname> <given-names>MP</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Highly selective receptive fields in mouse visual cortex</article-title><source>Journal of Neuroscience</source><volume>28</volume><fpage>7520</fpage><lpage>7536</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0623-08.2008</pub-id><pub-id pub-id-type="pmid">18650330</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Packer</surname> <given-names>AM</given-names></name><name><surname>Yuste</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Dense, unspecific connectivity of neocortical parvalbumin-positive interneurons: a canonical microcircuit for inhibition?</article-title><source>Journal of Neuroscience</source><volume>31</volume><fpage>13260</fpage><lpage>13271</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3131-11.2011</pub-id><pub-id pub-id-type="pmid">21917809</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pala</surname> <given-names>A</given-names></name><name><surname>Petersen</surname> <given-names>CCH</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>In vivo measurement of cell-type-specific synaptic connectivity and synaptic transmission in layer 2/3 mouse barrel cortex</article-title><source>Neuron</source><volume>85</volume><fpage>68</fpage><lpage>75</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.11.025</pub-id><pub-id pub-id-type="pmid">25543458</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pfeffer</surname> <given-names>CK</given-names></name><name><surname>Xue</surname> <given-names>M</given-names></name><name><surname>He</surname> <given-names>M</given-names></name><name><surname>Huang</surname> <given-names>ZJ</given-names></name><name><surname>Scanziani</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Inhibition of inhibition in visual cortex: the logic of connections between molecularly distinct interneurons</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>1068</fpage><lpage>1076</lpage><pub-id pub-id-type="doi">10.1038/nn.3446</pub-id><pub-id pub-id-type="pmid">23817549</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Phillips</surname> <given-names>EA</given-names></name><name><surname>Hasenstaub</surname> <given-names>AR</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Asymmetric effects of activating and inactivating cortical interneurons</article-title><source>eLife</source><volume>5</volume><elocation-id>e18383</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.18383</pub-id><pub-id pub-id-type="pmid">27719761</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pi</surname> <given-names>HJ</given-names></name><name><surname>Hangya</surname> <given-names>B</given-names></name><name><surname>Kvitsiani</surname> <given-names>D</given-names></name><name><surname>Sanders</surname> <given-names>JI</given-names></name><name><surname>Huang</surname> <given-names>ZJ</given-names></name><name><surname>Kepecs</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Cortical interneurons that specialize in disinhibitory control</article-title><source>Nature</source><volume>503</volume><fpage>521</fpage><lpage>524</lpage><pub-id pub-id-type="doi">10.1038/nature12676</pub-id><pub-id pub-id-type="pmid">24097352</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Polack</surname> <given-names>PO</given-names></name><name><surname>Friedman</surname> <given-names>J</given-names></name><name><surname>Golshani</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Cellular mechanisms of brain state-dependent gain modulation in visual cortex</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>1331</fpage><lpage>1339</lpage><pub-id pub-id-type="doi">10.1038/nn.3464</pub-id><pub-id pub-id-type="pmid">23872595</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rao</surname> <given-names>RP</given-names></name><name><surname>Ballard</surname> <given-names>DH</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Predictive coding in the visual cortex: a functional interpretation of some extra-classical receptive-field effects</article-title><source>Nature Neuroscience</source><volume>2</volume><fpage>79</fpage><lpage>87</lpage><pub-id pub-id-type="doi">10.1038/4580</pub-id><pub-id pub-id-type="pmid">10195184</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Richards</surname> <given-names>BA</given-names></name><name><surname>Lillicrap</surname> <given-names>TP</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Dendritic solutions to the credit assignment problem</article-title><source>Current Opinion in Neurobiology</source><volume>54</volume><fpage>28</fpage><lpage>36</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2018.08.003</pub-id><pub-id pub-id-type="pmid">30205266</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rudy</surname> <given-names>B</given-names></name><name><surname>Fishell</surname> <given-names>G</given-names></name><name><surname>Lee</surname> <given-names>S</given-names></name><name><surname>Hjerling-Leffler</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Three groups of interneurons account for nearly 100% of neocortical GABAergic neurons</article-title><source>Developmental Neurobiology</source><volume>71</volume><fpage>45</fpage><lpage>61</lpage><pub-id pub-id-type="doi">10.1002/dneu.20853</pub-id><pub-id pub-id-type="pmid">21154909</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rumelhart</surname> <given-names>DE</given-names></name><name><surname>Hinton</surname> <given-names>GE</given-names></name><name><surname>Williams</surname> <given-names>RJ</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>Learning representations by back-propagating errors</article-title><source>Nature</source><volume>323</volume><fpage>533</fpage><lpage>536</lpage><pub-id pub-id-type="doi">10.1038/323533a0</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saleem</surname> <given-names>AB</given-names></name><name><surname>Ayaz</surname> <given-names>A</given-names></name><name><surname>Jeffery</surname> <given-names>KJ</given-names></name><name><surname>Harris</surname> <given-names>KD</given-names></name><name><surname>Carandini</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Integration of visual motion and locomotion in mouse visual cortex</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>1864</fpage><lpage>1869</lpage><pub-id pub-id-type="doi">10.1038/nn.3567</pub-id><pub-id pub-id-type="pmid">24185423</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schultz</surname> <given-names>W</given-names></name><name><surname>Dickinson</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Neuronal coding of prediction errors</article-title><source>Annual Review of Neuroscience</source><volume>23</volume><fpage>473</fpage><lpage>500</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.23.1.473</pub-id><pub-id pub-id-type="pmid">10845072</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schuman</surname> <given-names>B</given-names></name><name><surname>Machold</surname> <given-names>RP</given-names></name><name><surname>Hashikawa</surname> <given-names>Y</given-names></name><name><surname>Fuzik</surname> <given-names>J</given-names></name><name><surname>Fishell</surname> <given-names>GJ</given-names></name><name><surname>Rudy</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Four unique interneuron populations reside in neocortical layer 1</article-title><source>The Journal of Neuroscience</source><volume>39</volume><fpage>125</fpage><lpage>139</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1613-18.2018</pub-id><pub-id pub-id-type="pmid">30413647</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sinha</surname> <given-names>P</given-names></name><name><surname>Kjelgaard</surname> <given-names>MM</given-names></name><name><surname>Gandhi</surname> <given-names>TK</given-names></name><name><surname>Tsourides</surname> <given-names>K</given-names></name><name><surname>Cardinaux</surname> <given-names>AL</given-names></name><name><surname>Pantazis</surname> <given-names>D</given-names></name><name><surname>Diamond</surname> <given-names>SP</given-names></name><name><surname>Held</surname> <given-names>RM</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Autism as a disorder of prediction</article-title><source>PNAS</source><volume>111</volume><fpage>15220</fpage><lpage>15225</lpage><pub-id pub-id-type="doi">10.1073/pnas.1416797111</pub-id><pub-id pub-id-type="pmid">25288765</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sohya</surname> <given-names>K</given-names></name><name><surname>Kameyama</surname> <given-names>K</given-names></name><name><surname>Yanagawa</surname> <given-names>Y</given-names></name><name><surname>Obata</surname> <given-names>K</given-names></name><name><surname>Tsumoto</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>GABAergic neurons are less selective to stimulus orientation than excitatory neurons in layer II/III of visual cortex, as revealed by in vivo functional Ca2+ imaging in transgenic mice</article-title><source>Journal of Neuroscience</source><volume>27</volume><fpage>2145</fpage><lpage>2149</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4641-06.2007</pub-id><pub-id pub-id-type="pmid">17314309</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spratling</surname> <given-names>MW</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Predictive coding as a model of biased competition in visual attention</article-title><source>Vision Research</source><volume>48</volume><fpage>1391</fpage><lpage>1408</lpage><pub-id pub-id-type="doi">10.1016/j.visres.2008.03.009</pub-id><pub-id pub-id-type="pmid">18442841</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spratling</surname> <given-names>MW</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Predictive coding as a model of response properties in cortical area V1</article-title><source>Journal of Neuroscience</source><volume>30</volume><fpage>3531</fpage><lpage>3543</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4911-09.2010</pub-id><pub-id pub-id-type="pmid">20203213</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spratling</surname> <given-names>MW</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A review of predictive coding algorithms</article-title><source>Brain and Cognition</source><volume>112</volume><fpage>92</fpage><lpage>97</lpage><pub-id pub-id-type="doi">10.1016/j.bandc.2015.11.003</pub-id><pub-id pub-id-type="pmid">26809759</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spratling</surname> <given-names>MW</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Fitting predictive coding to the neurophysiological data</article-title><source>Brain Research</source><volume>1720</volume><elocation-id>146313</elocation-id><pub-id pub-id-type="doi">10.1016/j.brainres.2019.146313</pub-id><pub-id pub-id-type="pmid">31265817</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tremblay</surname> <given-names>R</given-names></name><name><surname>Lee</surname> <given-names>S</given-names></name><name><surname>Rudy</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>GABAergic interneurons in the neocortex: from cellular properties to circuits</article-title><source>Neuron</source><volume>91</volume><fpage>260</fpage><lpage>292</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.06.033</pub-id><pub-id pub-id-type="pmid">27477017</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Urban-Ciecko</surname> <given-names>J</given-names></name><name><surname>Barth</surname> <given-names>AL</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Somatostatin-expressing neurons in cortical networks</article-title><source>Nature Reviews Neuroscience</source><volume>17</volume><fpage>401</fpage><lpage>409</lpage><pub-id pub-id-type="doi">10.1038/nrn.2016.53</pub-id><pub-id pub-id-type="pmid">27225074</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vogels</surname> <given-names>TP</given-names></name><name><surname>Sprekeler</surname> <given-names>H</given-names></name><name><surname>Zenke</surname> <given-names>F</given-names></name><name><surname>Clopath</surname> <given-names>C</given-names></name><name><surname>Gerstner</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Inhibitory plasticity balances excitation and inhibition in sensory pathways and memory networks</article-title><source>Science</source><volume>334</volume><fpage>1569</fpage><lpage>1573</lpage><pub-id pub-id-type="doi">10.1126/science.1211095</pub-id><pub-id pub-id-type="pmid">22075724</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wall</surname> <given-names>NR</given-names></name><name><surname>De La Parra</surname> <given-names>M</given-names></name><name><surname>Sorokin</surname> <given-names>JM</given-names></name><name><surname>Taniguchi</surname> <given-names>H</given-names></name><name><surname>Huang</surname> <given-names>ZJ</given-names></name><name><surname>Callaway</surname> <given-names>EM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Brain-Wide maps of synaptic input to cortical interneurons</article-title><source>The Journal of Neuroscience</source><volume>36</volume><fpage>4000</fpage><lpage>4009</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3967-15.2016</pub-id><pub-id pub-id-type="pmid">27053207</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wamsley</surname> <given-names>B</given-names></name><name><surname>Fishell</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Genetic and activity-dependent mechanisms underlying interneuron diversity</article-title><source>Nature Reviews Neuroscience</source><volume>18</volume><fpage>299</fpage><lpage>309</lpage><pub-id pub-id-type="doi">10.1038/nrn.2017.30</pub-id><pub-id pub-id-type="pmid">28381833</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname> <given-names>HR</given-names></name><name><surname>Cowan</surname> <given-names>JD</given-names></name></person-group><year iso-8601-date="1972">1972</year><article-title>Excitatory and inhibitory interactions in localized populations of model neurons</article-title><source>Biophysical Journal</source><volume>12</volume><fpage>1</fpage><lpage>24</lpage><pub-id pub-id-type="doi">10.1016/S0006-3495(72)86068-5</pub-id><pub-id pub-id-type="pmid">4332108</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolpert</surname> <given-names>DM</given-names></name><name><surname>Ghahramani</surname> <given-names>Z</given-names></name><name><surname>Jordan</surname> <given-names>MI</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>An internal model for sensorimotor integration</article-title><source>Science</source><volume>269</volume><fpage>1880</fpage><lpage>1882</lpage><pub-id pub-id-type="doi">10.1126/science.7569931</pub-id><pub-id pub-id-type="pmid">7569931</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolpert</surname> <given-names>DM</given-names></name><name><surname>Diedrichsen</surname> <given-names>J</given-names></name><name><surname>Flanagan</surname> <given-names>JR</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Principles of sensorimotor learning</article-title><source>Nature Reviews Neuroscience</source><volume>12</volume><fpage>739</fpage><lpage>751</lpage><pub-id pub-id-type="doi">10.1038/nrn3112</pub-id><pub-id pub-id-type="pmid">22033537</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xue</surname> <given-names>M</given-names></name><name><surname>Atallah</surname> <given-names>BV</given-names></name><name><surname>Scanziani</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Equalizing excitation-inhibition ratios across visual cortical neurons</article-title><source>Nature</source><volume>511</volume><fpage>596</fpage><lpage>600</lpage><pub-id pub-id-type="doi">10.1038/nature13321</pub-id><pub-id pub-id-type="pmid">25043046</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname> <given-names>W</given-names></name><name><surname>Carrasquillo</surname> <given-names>Y</given-names></name><name><surname>Hooks</surname> <given-names>BM</given-names></name><name><surname>Nerbonne</surname> <given-names>JM</given-names></name><name><surname>Burkhalter</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Distinct balance of excitation and inhibition in an interareal feedforward and feedback circuit of mouse visual cortex</article-title><source>Journal of Neuroscience</source><volume>33</volume><fpage>17373</fpage><lpage>17384</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2515-13.2013</pub-id><pub-id pub-id-type="pmid">24174670</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname> <given-names>GR</given-names></name><name><surname>Murray</surname> <given-names>JD</given-names></name><name><surname>Wang</surname> <given-names>XJ</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>A dendritic disinhibitory circuit mechanism for pathway-specific gating</article-title><source>Nature Communications</source><volume>7</volume><elocation-id>12815</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms12815</pub-id><pub-id pub-id-type="pmid">27649374</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yuste</surname> <given-names>R</given-names></name><name><surname>Gutnick</surname> <given-names>MJ</given-names></name><name><surname>Saar</surname> <given-names>D</given-names></name><name><surname>Delaney</surname> <given-names>KR</given-names></name><name><surname>Tank</surname> <given-names>DW</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Ca2+ accumulations in dendrites of neocortical pyramidal neurons: an apical band and evidence for two functional compartments</article-title><source>Neuron</source><volume>13</volume><fpage>23</fpage><lpage>43</lpage><pub-id pub-id-type="doi">10.1016/0896-6273(94)90457-X</pub-id><pub-id pub-id-type="pmid">8043278</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zmarz</surname> <given-names>P</given-names></name><name><surname>Keller</surname> <given-names>GB</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Mismatch receptive fields in mouse visual cortex</article-title><source>Neuron</source><volume>92</volume><fpage>766</fpage><lpage>772</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.09.057</pub-id><pub-id pub-id-type="pmid">27974161</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><boxed-text><p>We performed a mathematical analysis of a simplified model to identify the constraints that are imposed on the interneuron circuit by the presence of nPE neurons. We first describe the assumptions made and the definition of nPE neurons. We then derive the constraints for a simplified network with canonical interneuron connectivity including VIP-to-PV synapses. The solutions provide the relationship for the strength of synapses between different neuron types that must be satisfied for nPE neurons to emerge. We then show that the same network without VIP-to-PV synapses can only produce nPE neurons under very restrictive assumptions. Finally, we will provide an exhaustive list of networks, which differ in terms of number of interneuron types, their inputs and the nature of the dendritic processes, and specify the conditions under which these networks can produce nPE neurons.</p><sec id="s8" sec-type="appendix"><title>Constraints for the interneuron circuit by the presence of nPE neurons</title><p>To derive the constraints for the interneuron network that are imposed by the presence of nPE neurons, we performed a mathematical analysis of a simplified network model, in which the nonlinearity of the dendritic compartment and the rectifying nonlinearities are neglected. This reduces the network to an analytically tractable linear system. The simplifications rely on the following assumptions:</p><list list-type="order"><list-item><p>During baseline, feedback and playback phases, SOM interneuron-mediated inhibition either equals or exceeds excitatory motor predictions arriving at the apical dendrites of PCs.</p></list-item><list-item><p>Any excess of inhibition in the dendrite does not affect the soma of PCs.</p></list-item><list-item><p>During baseline, feedback and playback phases, all neuron types have positive firing rates, such that the rate rectification can be neglected.</p></list-item></list><p>These assumptions allow us to omit the dendritic compartment of PCs and consequently all synapses thereto. The remaining system of linear equations describes the activity of all neuron types during baseline, feedback and playback phase. For the subsequent analysis, we furthermore consider a homogeneous network, that is, all weights, neuronal properties and the number of incoming connections for cells of the same type are the same. As a result, we can reduce the high-dimensional system to four equations, each describing the dynamics of one representative firing rate per neuron type:<disp-formula id="equ20"><label>(21)</label><mml:math id="m20"><mml:mrow><mml:mrow><mml:mrow><mml:mpadded width="+1.7pt"><mml:mi>τ</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mi mathvariant="normal">Ω</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mpadded width="+1.7pt"><mml:mi mathvariant="bold">𝐗</mml:mi></mml:mpadded></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf106"><mml:mi>τ</mml:mi></mml:math></inline-formula> denotes the rate time constant, <inline-formula><mml:math id="inf107"><mml:mrow><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> (subscripts refer to the different neuron types; E: soma of PC, P: PV, S: SOM, V: VIP), Ω is the weight matrix and <inline-formula><mml:math id="inf108"><mml:mi mathvariant="bold">𝐗</mml:mi></mml:math></inline-formula> denotes the external inputs. In the steady state, the firing rates are given by<disp-formula id="equ21"><label>(22)</label><mml:math id="m21"><mml:mrow><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo>-</mml:mo><mml:mn>𝟙</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold">𝐗</mml:mi></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold">𝐗</mml:mi></mml:mrow></mml:mrow></mml:math></disp-formula>with the effective connectivity matrix <italic>W</italic> that includes the leak:<disp-formula id="equ22"><label>(23)</label><mml:math id="m22"><mml:mrow><mml:mrow><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="5pt" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>EP</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mi>PE</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>PP</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>PS</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>PV</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mi>SE</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>SP</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>SS</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>SV</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mi>VE</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>VP</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>VS</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>VV</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The weight parameters <inline-formula><mml:math id="inf109"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> between neuron types are strictly positive to maintain the excitatory/inhibitory nature of the various neuron types. In our model, an excitatory neuron is classified as a perfect nPE neuron, if<disp-formula id="equ23"><label>(24)</label><mml:math id="m23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>y</mml:mi><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ24"><label>(25)</label><mml:math id="m24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>During feedback mismatch, the PC firing rate increases with respect to the baseline as long as the motor-related excitatory inputs exceed the somatic inhibition mediated by PV neurons. The conditions according to which no change in activity occurs in either feedback or playback phase (see <xref ref-type="disp-formula" rid="equ23">Equation 24</xref>) impose constraints on the weight configuration that need to be satisfied. These can be summarized by<disp-formula id="equ25"><label>(26)</label><mml:math id="m25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ26"><label>(27)</label><mml:math id="m26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf110"><mml:msup><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf111"><mml:msup><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> denote the excess external inputs above baseline during feedback and playback phase, respectively,<disp-formula id="equ27"><label>(28)</label><mml:math id="m27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mi>T</mml:mi></mml:msup><mml:mo>⋅</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ28"><label>(29)</label><mml:math id="m28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mi>T</mml:mi></mml:msup><mml:mo>⋅</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>with <italic>s</italic> representing a varying excitatory stimulus strength. The parameters <inline-formula><mml:math id="inf112"><mml:mrow><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>X</mml:mi></mml:msub></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> indicate whether neuron type <italic>X</italic> receives visual and motor-related inputs, respectively, and control the different input configurations.</p></sec><sec id="s9" sec-type="appendix"><title>Interneuron connectivity with VIP-to-PV synapses</title><p>We start with the connectivity motif proposed by <xref ref-type="bibr" rid="bib54">Pfeffer et al., 2013</xref>. We also allow for connections from VIP to PV neurons. Although they are considered to be less prominent and weaker than connections from VIP to SOM neurons and are therefore often neglected in diagrams and computational models, those synapses have been observed in various brain regions (<xref ref-type="bibr" rid="bib56">Pi et al., 2013</xref>; <xref ref-type="bibr" rid="bib54">Pfeffer et al., 2013</xref>; <xref ref-type="bibr" rid="bib27">Hioki et al., 2013</xref>; <xref ref-type="bibr" rid="bib42">Lee et al., 2013</xref>; <xref ref-type="bibr" rid="bib37">Krabbe et al., 2019</xref>). To this end, the respective connectivity matrix is given by<disp-formula id="equ29"><label>(30)</label><mml:math id="m29"><mml:mrow><mml:mrow><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="5pt" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>EP</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mi>PE</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>PP</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>PS</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>PV</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mi>SE</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>SV</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mi>VE</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>VS</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The constraints (<xref ref-type="disp-formula" rid="equ25">Equation 26</xref>) and (<xref ref-type="disp-formula" rid="equ26">Equation 27</xref>) defining nPE neurons are then given by<disp-formula id="equ30"><mml:math id="m30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mi/><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mlabeledtr><mml:mtd><mml:mtext>(31)</mml:mtext></mml:mtd><mml:mtd/><mml:mtd><mml:mi/><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd><mml:mtext>(32)</mml:mtext></mml:mtd><mml:mtd><mml:mn>0</mml:mn><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mi/><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>These two equations yield<disp-formula id="equ31"><mml:math id="m31"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mlabeledtr><mml:mtd><mml:mtext>(33)</mml:mtext></mml:mtd><mml:mtd><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mtr><mml:mtd><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mlabeledtr><mml:mtd><mml:mtext>(34)</mml:mtext></mml:mtd><mml:mtd/><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ31">Equation 33 and 34</xref> are the mathematical formulation of the E/I balance of multiple pathways shown in <xref ref-type="fig" rid="fig2">Figure 2</xref> and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>.</p><p>For the derivation above, we have assumed that the motor-related input is switched off during the playback phase. This assumption, however, can be relaxed. When motor predictions are merely smaller than the actual sensory input but non-zero during playback, analogous calculations yield the same constraints.</p></sec><sec id="s10" sec-type="appendix"><title>Interneuron connectivity without VIP-to-PV synapses</title><p>Without connections from VIP onto PV neurons, the constraints (<xref ref-type="disp-formula" rid="equ25">Equation 26</xref>) and (<xref ref-type="disp-formula" rid="equ26">Equation 27</xref>) yield<disp-formula id="equ32"><mml:math id="m32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mlabeledtr><mml:mtd><mml:mtext>(35)</mml:mtext></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd><mml:mtext>(36)</mml:mtext></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>These two equations simplify to<disp-formula id="equ33"><label>(37)</label><mml:math id="m33"><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>PS</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>SV</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>VS</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>SV</mml:mi></mml:msub></mml:mfrac></mml:mstyle></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>As the weight <inline-formula><mml:math id="inf113"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is strictly positive (see definition of weight matrix above), the product <inline-formula><mml:math id="inf114"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>SV</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>VS</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> must be larger than 1. This, however, indicates that networks with rate rectification exceed a bifurcation point and run into a winner-take-all (WTA) regime, in which either VIP or SOM neurons are silent (<xref ref-type="bibr" rid="bib26">Hertäg and Sprekeler, 2019</xref>).</p><p>With VIP neurons being silent in all phases but during feedback mismatch phases, the constraint on <inline-formula><mml:math id="inf115"><mml:msub><mml:mi>w</mml:mi><mml:mi>PS</mml:mi></mml:msub></mml:math></inline-formula> can be recalculated from <xref ref-type="disp-formula" rid="equ48 equ23">Equations 40 and 24</xref> while neglecting VIP neurons:<disp-formula id="equ34"><label>(38)</label><mml:math id="m34"><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>PS</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>PP</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>EP</mml:mi></mml:msub></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This equation reveals that PV neurons must receive visual input to ensure <inline-formula><mml:math id="inf116"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>PS</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>In summary, this mathematical analysis shows that perfect nPE neurons can only emerge when VIP neurons are silent during all phases but the feedback mismatch phase.</p><p>Please note that the very same results are obtained even if connections from PV to both SOM and VIP neurons are included.</p></sec><sec id="s11" sec-type="appendix"><title>Summary of nPE circuits and their constraints</title><p>To derive the weight and input constraints on nPE circuits for networks with different complexity, we varied the number of interneuron types and the nature of the dendritic processes. The following network features were not varied, either because they are strongly constrained by what is known about the circuit or because the number of variations would become too large:</p><list list-type="bullet"><list-item><p>We require nPE neurons to remain at baseline during feedback and playback phases (perfect nPE neurons).</p></list-item><list-item><p>We consider a canonical microcircuit in which both VIP and SOM neurons inhibit other interneuron types but not themselves and SOM neurons inhibit the apical dendrites of PCs, while PV neurons inhibit the soma of PCs and other PV neurons.</p></list-item><list-item><p>PCs receive a motor-related prediction of visual input at their dendrites.</p></list-item><list-item><p>All interneurons receive either visual or motor-related input.</p></list-item><list-item><p>During baseline, feedback and playback phases all neuron types have non-zero firing rates.</p></list-item><list-item><p>During feedback, motor-related inputs and the excitatory recurrence at the dendrite are perfectly balanced by SOM neuron mediated inhibition.</p></list-item></list><p>In contrast to the assumption made before according to which the dendrite is rectified, we now also consider the possibility that an excess of inhibition can be forwarded to the soma. Following the same approaches outlined in the sections above, and taking into account the assumptions herein before mentioned, we derive a few unifying principles that are required for nPE neurons to develop:</p><list list-type="bullet"><list-item><p>SOM interneurons must be present to provide dendritic inhibition</p></list-item><list-item><p>The synapses from SOM neurons onto the dendrites of PCs must undergo experience-dependent plasticity to achieve an E/I balance at the dendrites during feedback.</p></list-item><list-item><p>When PCs receive visual input, PV neurons must be present (to provide somatic inhibition that can balance the inputs at the soma).</p></list-item><list-item><p>Only when PV, SOM and VIP neurons are present, dendritic non-linearities may not be strictly necessary</p></list-item><list-item><p>SOM neurons must receive visual input unless PV and VIP neurons are present.</p></list-item></list><p>This leaves four networks with a number of constraints, detailed below.</p><sec id="s11-1"><title>PC-SOM</title><p>In a network comprising PCs and SOM neurons, PCs act as nPE neurons when</p><list list-type="bullet"><list-item><p>the dendrites are rectified,</p></list-item><list-item><p>SOM neurons receive visual input, while PCs do not, and</p></list-item><list-item><p><inline-formula><mml:math id="inf117"><mml:msub><mml:mi>w</mml:mi><mml:mi>DS</mml:mi></mml:msub></mml:math></inline-formula> is tuned (see <xref ref-type="disp-formula" rid="equ4 equ7">Equations 4 and 7)</xref></p><list list-type="simple"><list-item><p><disp-formula id="equ35"><mml:math id="m35"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>DS</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>max</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>DE</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>max</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>SE</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>→</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo> <mml:mtext>for </mml:mtext><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>max</mml:mi></mml:msub></mml:mrow><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></disp-formula></p></list-item></list></list-item></list><list list-type="simple"><list-item><p>where <inline-formula><mml:math id="inf118"><mml:msub><mml:mi>s</mml:mi><mml:mi>max</mml:mi></mml:msub></mml:math></inline-formula> denotes the maximal stimulus strength and <inline-formula><mml:math id="inf119"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:math></inline-formula> represents the PC baseline firing rate.</p></list-item></list><p>Mismatch responses are caused by an excess of dendritic excitation that cannot be canceled by SOM neuron mediated inhibition.</p></sec><sec id="s11-2"><title>PC-SOM-VIP</title><p>In a network comprising PCs and SOM and VIP neurons, PCs act as nPE neurons when</p><list list-type="bullet"><list-item><p>the dendrites are rectified,</p></list-item><list-item><p>SOM neurons receive visual input, while PCs do not, and</p></list-item><list-item><p><inline-formula><mml:math id="inf120"><mml:msub><mml:mi>w</mml:mi><mml:mi>DS</mml:mi></mml:msub></mml:math></inline-formula> is tuned (see <xref ref-type="disp-formula" rid="equ4 equ7">Equations 4 and 7)</xref></p><list list-type="simple"><list-item><p><disp-formula id="equ36"><mml:math id="m36"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>DS</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>max</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>DE</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>SV</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>VS</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>SV</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>max</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>SV</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>SE</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>SV</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>VE</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>→</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>SV</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>VS</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>SV</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo> <mml:mtext>for </mml:mtext><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>max</mml:mi></mml:msub></mml:mrow><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></disp-formula></p></list-item></list></list-item></list><list list-type="simple"><list-item><p>where <inline-formula><mml:math id="inf121"><mml:msub><mml:mi>s</mml:mi><mml:mi>max</mml:mi></mml:msub></mml:math></inline-formula> denotes the maximal stimulus strength and <inline-formula><mml:math id="inf122"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:math></inline-formula> represents the PC baseline firing rate.</p></list-item></list><p>Mismatch responses are caused by an excess of dendritic excitation that cannot be canceled by SOM neuron mediated inhibition.</p></sec><sec id="s11-3"><title>PC-PV-SOM</title><p>In a network comprising PCs and SOM and PV neurons, PCs act as nPE neurons when</p><list list-type="bullet"><list-item><p>SOM neurons receive visual input,</p></list-item><list-item><p><inline-formula><mml:math id="inf123"><mml:msub><mml:mi>w</mml:mi><mml:mi>DS</mml:mi></mml:msub></mml:math></inline-formula> is tuned (see <xref ref-type="disp-formula" rid="equ4 equ7">Equations 4 and 7)</xref></p></list-item></list><list list-type="simple"><list-item><p><disp-formula id="equ37"><mml:math id="m37"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>DS</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>max</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>DE</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>max</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>SE</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>→</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo> <mml:mtext>for </mml:mtext><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>max</mml:mi></mml:msub></mml:mrow><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></disp-formula></p></list-item></list><list list-type="simple"><list-item><p>where <inline-formula><mml:math id="inf124"><mml:msub><mml:mi>s</mml:mi><mml:mi>max</mml:mi></mml:msub></mml:math></inline-formula> denotes the maximal stimulus strength and <inline-formula><mml:math id="inf125"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:math></inline-formula> represents the PC baseline firing rate,</p></list-item></list><list list-type="bullet"><list-item><p>somatic excitation and disinhibition must be balanced by PV mediated inhibition (see <xref ref-type="disp-formula" rid="equ8">Equation 8</xref>)</p></list-item></list><list list-type="simple"><list-item><p><disp-formula id="equ38"><mml:math id="m38"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>PS</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>PP</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>EP</mml:mi></mml:msub></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p></list-item></list><list list-type="bullet"><list-item><p>and PV neurons must receive visual input (if the dendrites are rectified) or motor predictions thereof (if the dendrites are not rectified).</p></list-item></list><p>Mismatch responses are either caused by an excess of dendritic excitation that cannot be canceled by SOM neuron mediated inhibition (if the dendrites are rectified) or rely on the presence of supra-linear processes in the dendrites – for instance calcium spikes (if the dendrites are not rectified).</p></sec><sec id="s11-4"><title>PC-PV-SOM-VIP</title><p>In a network comprising PCs and SOM, VIP and PV neurons, PCs act as nPE neurons when the following conditions are met:</p><list list-type="bullet"><list-item><p><inline-formula><mml:math id="inf126"><mml:msub><mml:mi>w</mml:mi><mml:mi>DS</mml:mi></mml:msub></mml:math></inline-formula> is tuned (see <xref ref-type="disp-formula" rid="equ4 equ7">Equations 4 and 7)</xref></p><list list-type="simple"><list-item><p><disp-formula id="equ39"><mml:math id="m39"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>DS</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>max</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>DE</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>SV</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>VS</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>SV</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>max</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>SV</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>SE</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>SV</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>VE</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>→</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>SV</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>VS</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>SV</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p></list-item></list></list-item></list><list list-type="simple"><list-item><p>where <inline-formula><mml:math id="inf127"><mml:msub><mml:mi>s</mml:mi><mml:mi>max</mml:mi></mml:msub></mml:math></inline-formula> denotes the maximal stimulus strength and <inline-formula><mml:math id="inf128"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:math></inline-formula> represents the PC baseline firing rate.</p></list-item></list><list list-type="bullet"><list-item><p>Dependent on the input onto SOM/VIP neurons and the nature of the dendritic processes:</p><list list-type="bullet"><list-item><p>If both SOM and VIP neurons receive visual input and dendrites are rectified, then (see <xref ref-type="disp-formula" rid="equ30">Equation 31</xref>)</p></list-item></list><list list-type="simple"><list-item><p><disp-formula id="equ40"><mml:math id="m40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p></list-item></list><list list-type="simple"><list-item><p>Mismatch responses are caused by an excess of dendritic excitation that cannot be canceled by SOM neuron mediated inhibition.</p></list-item></list><list list-type="bullet"><list-item><p>If both SOM and VIP neurons receive visual input and dendrites are not rectified, then (see <xref ref-type="disp-formula" rid="equ30">Equation 31</xref> and <xref ref-type="disp-formula" rid="equ2 equ3 equ4 equ7">Equations 2–4 and 7</xref>)</p></list-item></list><list list-type="simple"><list-item><p><disp-formula id="equ41"><mml:math id="m41"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>λ</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p></list-item></list><list list-type="simple"><list-item><p>Mismatch responses are caused by an excess of dendritic excitation that cannot be canceled by SOM neuron mediated inhibition and over-compensates for increased somatic inhibition.</p></list-item></list><list list-type="bullet"><list-item><p>If SOM neurons receive visual input, while VIP neurons receive a motor-related prediction thereof and dendrites are rectified, then (see <xref ref-type="disp-formula" rid="equ8 equ8">Equations 8 and 9)</xref></p> </list-item></list><list list-type="simple"><list-item><p><disp-formula id="equ42"><mml:math id="m42"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p></list-item></list><list list-type="simple"><list-item><p>Mismatch responses are caused by an excess of dendritic excitation that cannot be canceled by SOM neuron mediated inhibition.</p></list-item></list><list list-type="bullet"><list-item><p>If SOM neurons receive visual input, while VIP neurons receive a motor-related prediction thereof and dendrites are not rectified, then (see <xref ref-type="disp-formula" rid="equ8 equ8">Equations 8 and 9</xref>, augmented with an inhibitory dendritic current <inline-formula><mml:math id="inf129"><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mi>ED</mml:mi></mml:msub></mml:math></inline-formula> that influences the soma during playback)</p></list-item></list><list list-type="simple"><list-item><p><disp-formula id="equ43"><mml:math id="m43"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p></list-item></list><list list-type="simple"><list-item><p>where <inline-formula><mml:math id="inf130"><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mi>ED</mml:mi></mml:msub></mml:math></inline-formula> is given by (<xref ref-type="disp-formula" rid="equ2 equ3 equ4 equ7">Equations 2–4 and 7</xref>)</p></list-item></list><list list-type="simple"><list-item><p><disp-formula id="equ44"><mml:math id="m44"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mi>ED</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:msub><mml:mi>λ</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>⋅</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>SV</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>VS</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>SV</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>⋅</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>PP</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></list-item></list><list list-type="simple"><list-item><p>Mismatch responses are caused by an excess of dendritic excitation that cannot be canceled by SOM neuron mediated inhibition and over-compensates for increased somatic inhibition.</p></list-item></list><list list-type="bullet"><list-item><p>If SOM neurons receive motor input, while VIP neurons receive visual input (see <xref ref-type="disp-formula" rid="equ8 equ8">Equations 8 and 9</xref>, augmented with an excitatory dendritic current <inline-formula><mml:math id="inf131"><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mi>ED</mml:mi></mml:msub></mml:math></inline-formula> that influences the soma during playback)</p></list-item></list><list list-type="simple"><list-item><p><disp-formula id="equ45"><mml:math id="m45"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p></list-item></list><list list-type="simple"><list-item><p>where <inline-formula><mml:math id="inf132"><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mi>ED</mml:mi></mml:msub></mml:math></inline-formula> is given by (<xref ref-type="disp-formula" rid="equ2 equ3 equ4 equ7">Equations 2–4 and 7</xref>)</p></list-item></list><list list-type="simple"><list-item><p><disp-formula id="equ46"><mml:math id="m46"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mi>ED</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:msub><mml:mi>λ</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>⋅</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>SV</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>VS</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>SV</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>⋅</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>PP</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>SV</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula></p></list-item></list><list list-type="simple"><list-item><p>when the dendrites are not inhibited in the baseline condition. Mismatch responses are caused by a release from PV neuron mediated inhibition (somatic disinhibition) that is strong enough to over-compensate for an excess of dendritic inhibition that is forwarded to the soma (when dendrites are not rectified).</p></list-item></list></list-item></list></sec></sec></boxed-text></app><app id="appendix-2"><title>Appendix 2</title><boxed-text><p>We performed a mathematical analysis of a simplified model to identify the constraints that are imposed on the interneuron circuit by the presence of pPE neurons. We first describe the assumptions made and the definition of pPE neurons. We then derive the constraints for a simplified network with canonical interneuron connectivity. The solutions provide the relationship for the strength of synapses between different neuron types that must be satisfied for pPE neurons to emerge.</p><sec id="s12" sec-type="appendix"><title>Constraints for the interneuron circuit by the presence of pPE neurons</title><p>To derive the constraints for the interneuron network that are imposed by the presence of pPE neurons, we performed an analogous mathematical analysis of a simplified network model. In contrast to nPE circuits, we now assume that SOM neurons receive motor-related input, while VIP neurons receive visual input. The simplifications for the derivation rely on the following assumptions:</p><list list-type="order"><list-item><p>During baseline, feedback and mismatch phases, SOM interneuron-mediated inhibition exceeds excitatory motor predictions arriving at the apical dendrites of PCs.</p></list-item><list-item><p>Any excess of inhibition in the dendrite does not affect the soma of PCs.</p></list-item><list-item><p>During baseline, feedback and mismatch phases, all neuron types have positive firing rates, such that the rate rectification can be neglected.</p></list-item></list><p>These assumptions allow us to omit the dendritic compartment of PCs and consequently all synapses thereto. The remaining system of linear equations describes the activity of all neuron types during baseline, feedback and mismatch phase. For the subsequent analysis, we furthermore consider a homogeneous network, that is, all weights, neuronal properties and the number of incoming connections for cells of the same type are the same. As a result, we can reduce the high-dimensional system to four equations, each describing the dynamics of one representative firing rate per neuron type:<disp-formula id="equ47"><label>(39)</label><mml:math id="m47"><mml:mrow><mml:mrow><mml:mrow><mml:mpadded width="+1.7pt"><mml:mi>τ</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mi mathvariant="normal">Ω</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mpadded width="+1.7pt"><mml:mi mathvariant="bold">𝐗</mml:mi></mml:mpadded></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf133"><mml:mi>τ</mml:mi></mml:math></inline-formula> denotes the rate time constant, <inline-formula><mml:math id="inf134"><mml:mrow><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> (subscripts refer to the different neuron types; E: soma of PC, P: PV, S: SOM, V: VIP), <inline-formula><mml:math id="inf135"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula> is the weight matrix and <inline-formula><mml:math id="inf136"><mml:mi mathvariant="bold">𝐗</mml:mi></mml:math></inline-formula> denotes the external inputs. In the steady state, the firing rates are given by<disp-formula id="equ48"><label>(40)</label><mml:math id="m48"><mml:mrow><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo>-</mml:mo><mml:mn>𝟙</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold">𝐗</mml:mi></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold">𝐗</mml:mi></mml:mrow></mml:mrow></mml:math></disp-formula>with the effective connectivity matrix <inline-formula><mml:math id="inf137"><mml:mi>W</mml:mi></mml:math></inline-formula> that includes the leak:<disp-formula id="equ49"><label>(41)</label><mml:math id="m49"><mml:mrow><mml:mrow><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="5pt" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>EP</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mi>PE</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>PP</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>PS</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>PV</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mi>SE</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>SV</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mi>VE</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>VS</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The weight parameters <inline-formula><mml:math id="inf138"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> between neuron types are strictly positive to maintain the excitatory/inhibitory nature of the various neuron types. In our model, an excitatory neuron is classified as a perfect pPE neuron, if<disp-formula id="equ50"><label>(42)</label><mml:math id="m50"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ51"><label>(43)</label><mml:math id="m51"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>y</mml:mi><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The conditions according to which no change in activity occurs in either feedback or mismatch phase (see <xref ref-type="disp-formula" rid="equ50">Equation 42</xref>) impose constraints on the weight configuration that need to be satisfied. These can be summarized by<disp-formula id="equ52"><label>(44)</label><mml:math id="m52"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ53"><label>(45)</label><mml:math id="m53"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf139"><mml:msup><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf140"><mml:msup><mml:mi mathvariant="bold">𝐗</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> denote the excess external inputs above baseline during feedback and mismatch phase, respectively,<disp-formula id="equ54"><label>(46)</label><mml:math id="m54"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mi>T</mml:mi></mml:msup><mml:mo>⋅</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ55"><label>(47)</label><mml:math id="m55"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mi>T</mml:mi></mml:msup><mml:mo>⋅</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>with <italic>s</italic> representing a varying excitatory stimulus strength. The parameters <inline-formula><mml:math id="inf141"><mml:mrow><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>X</mml:mi></mml:msub></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> indicate whether neuron type <inline-formula><mml:math id="inf142"><mml:mi>X</mml:mi></mml:math></inline-formula> receives visual and motor-related inputs, respectively, and control the different input configurations.</p><p>The constraints (<xref ref-type="disp-formula" rid="equ52">Equation 44</xref>) and (<xref ref-type="disp-formula" rid="equ53">Equation 45</xref>) defining pPE neurons are then given by<disp-formula id="equ56"><mml:math id="m56"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mi/><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mlabeledtr><mml:mtd><mml:mtext>(48)</mml:mtext></mml:mtd><mml:mtd/><mml:mtd><mml:mi/><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd><mml:mtext>(49)</mml:mtext></mml:mtd><mml:mtd><mml:mn>0</mml:mn><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mi/><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>These two equations yield<disp-formula id="equ57"><label>(50)</label><mml:math id="m57"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ58"><label>(51)</label><mml:math id="m58"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ57 equ58">Equation 50 and 51</xref> are the mathematical formulation of an E/I balance of multiple pathways shown in <xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1</xref>. This balance can be learned by experience-dependent inhibitory plasticity (<xref ref-type="fig" rid="app2fig2">Appendix 2—figure 2</xref>).</p><fig id="app2fig1" position="float"><label>Appendix 2—figure 1.</label><caption><title>Multi-pathway balance of excitation and inhibition in different pPE neuron circuits.</title><p>(<bold>a</bold>) Excitatory, inhibitory, disinhibitory and dis-disinhibitory pathways onto PCs that need to be balanced in pPE neuron circuits. Input to the soma of PCs and PV neurons is varied (<bold>c–f</bold>). VIP neurons receive visual input, SOM neurons receive a motor-related prediction thereof. (<bold>b</bold>) Test stimuli: Feedback (FB), mismatch (MM) and playback (PB) phases of 1 s each. (<bold>c</bold>) PCs receive visual input. PV neurons receive visual and motor inputs (left, top). When all visual (V) and motor (M) pathways are balanced (left, bottom), PCs act as pPE neurons (right). PV neuron activity increases in both feedback and playback phases but remains at baseline during mismatch. Responses normalized between −1 and 1 such that baseline is zero. (<bold>d</bold>) Same as in (<bold>c</bold>) but PV neurons receive motor predictions only. (<bold>e</bold>) Same as in (<bold>c</bold>) but PCs receive no visual input. PV neurons remain at baseline in the absence of visual input to the soma of PCs during feedback and mismatch. (<bold>f</bold>) Same as in (<bold>c</bold>) but PCs receive no visual input and PV neurons receive motor predictions only. PV neurons remain at baseline in the absence of visual input to the soma of PCs during feedback and mismatch.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57541-app2-fig1-v1.tif"/></fig><fig id="app2fig2" position="float"><label>Appendix 2—figure 2.</label><caption><title>Balancing excitation and inhibition gives rise to positive prediction-error neurons.</title><p>(<bold>a</bold>) Network model with excitatory PCs and inhibitory PV, SOM and VIP neurons. Connections from PCs not shown for the sake of clarity. Somatic compartment of PCs and VIP receive visual input, apical dendrites of PCs, SOM and PV neurons receive a motor-related prediction thereof. Connections marked with an asterisk undergo experience-dependent plasticity. (<bold>b</bold>) During plasticity, the network is exposed to a sequence of feedback (coupled sensorimotor experience) and mismatch phases (black square, no visual flow despite motor-related predictions). Stimuli last for 1 s and are alternated with baseline phases (absence of visual input and motor predictions). (<bold>c</bold>) Left: Before plasticity, somatic excitation (light red) and inhibition (light blue) in PCs are not balanced. Excitatory and inhibitory currents shifted by ±20 pA for visualization. The varying net excitatory current (gray) causes the PC population rate to deviate from baseline. Right: Response relative to baseline (<inline-formula><mml:math id="inf143"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:math></inline-formula>) of all PCs in feedback (FB), mismatch (MM) and playback (PB) phase, sorted by amplitude of mismatch response. None of the PCs are classified as pPE neurons. (<bold>d</bold>) Same as in (<bold>c</bold>) after plasticity. Somatic excitation and inhibition are balanced. PC population rate fluctuates around baseline. All PCs classified as pPE neurons. Connection strength from VIP onto SOM neurons is set to 0.8.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57541-app2-fig2-v1.tif"/></fig><p>Please note that in the present network model, the increase during playback is caused by SOM neurons being rectified and/or a non-zero motor-related input (weaker than the visual input).</p></sec></boxed-text></app></app-group></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.57541.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Ostojic</surname><given-names>Srdjan</given-names></name><role>Reviewing Editor</role><aff><institution>Ecole Normale Superieure Paris</institution><country>France</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Ostojic</surname><given-names>Srdjan</given-names> </name><role>Reviewer</role><aff><institution>Ecole Normale Superieure Paris</institution><country>France</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>This manuscript explores an excitatory-inhibitory network model to determine the circuit and plasticity mechanisms underlying the generation of neurons coding for prediction errors in the visual cortex. The manuscript demonstrates that negative prediction errors arise naturally if synaptic plasticity acts to produce homeostatic excitation-inhibition balance when the circuit receives both visual inputs and internal predictions thereof. Remarkably, the emergence of prediction error neurons depends on experience of the circuit with coupled visuomotor input, reflecting recent experimental results, and the model provides direction for future optogenetic experiments to disentangle which cell types are targeted by visual or motor input.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Learning prediction error neurons in a canonical interneuron circuit&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, including Srdjan Ostojic as the Reviewing Editor, and the evaluation has been overseen by Richard Ivry as the Senior Editor.</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>This manuscript models a canonical cortical microcircuit in order to investigate the circuit configurations and plasticity underlying one type of sensorimotor mismatch response identified in visual cortex. The authors show that negative prediction error neurons emerge from the network via plasticity in a set of inhibitory synapses that acts to minimize evoked firing of pyramidal cells. Moreover, the emergence of these response properties is robust to the particular cellular targets of visual and motor input (for PVs and PCs), while the type of prediction error neuron that emerges (positive versus negative) is dependent on how motor and visual inputs target VIPs and SOMs. Very nicely, the emergence of prediction error neurons depends on experience of the circuit with coupled visuomotor input (reflecting recent experimental results), and the model provides direction for future optogenetic experiments to disentangle which cell types are targeted by visual or motor input.</p><p>The general topic of microcircuits for predictive coding is very interesting, in direct relationship with experimental work. The manuscript is well written and thorough, and the topic is timely. All reviewers were generally supportive, but some concerns were raised and need to be addressed in the revision.</p><p>Essential revisions:</p><p>1) The paper focuses on a very homogeneous coding of negative prediction errors, while positive prediction errors appear only in one figure. The authors don't justify their focus on the former over the latter. It would therefore be important to include better the variety of prediction error coding in the model, and discuss its functional implications. Wouldn't it be possible and interesting to compare the distribution of different types of neurons (nPE, pPE, others) between the model and the data? The manuscript states that &quot;nPE neurons represent only a small fraction of neurons in mouse V1&quot;. This undercuts somewhat the previous sections, and calls for a more quantitative comparison, in particular with respect to a distribution that would be obtained from random wiring for instance. The predictions for optogenetic inactivations in Figure 3 are very nice, but how do they extend to the heterogeneous case with pPE and other neuron classes (Figure 4) ? Can Equations 8-9 be extended to pPE neurons?</p><p>2) In the model, every neuron receives one or two scalar signals representing a one-dimensional visual input and corresponding motor efference copy. The authors should describe how their results would generalize to a situation in which neurons have different selectivities. In particular, there are observations that receptive-field size differs across cell types. More generally, could the circuit the authors describe generalize to neurons with &quot;mixed selectivity&quot; to multiple variables?</p><p>3) The paper heavily focuses on a 4 cell-type motif (Pyr, PV, SOM, VIP), but does not provide a clear message on what the functional importance of this motif is. Could PE and nPE neurons emerge in circuits with only 2 or 3 cell types? If so, what computational benefits does the presence of other cell types provide? Along similar lines, how stringent are the conditions on synaptic weights to generate nPE (or pPE) neurons ? A comparison between the number of constraints and the number of variables would be interesting to determine how large the space of solutions is.</p><p>4) What is the role of recurrent connections In the model? The argument in terms of pathways (Figure 2) does not take loops into account. The approach taken here should be compared with predictive coding of Deneve and Machens, which relies on recurrent connection.</p><p>5) A key point of the paper is the plasticity rule operative at SOM-&gt;PV synapses. In the first part of the paper, the authors use a non-local, backpropagation-like rule, and then later show that under certain circumstances this assumption can be relaxed. The fact that the initial learning rule is based on backpropagation becomes apparent only in the first paragraph of the Results, and the reader needs to dig through the Materials and methods and appendix to understand the details of the plasticity rule that is being used throughout the main text. The learning rules need to be explained earlier in the manuscript, e.g. by including, Equations 16, 17, and 19 of the Materials and methods in the main text. We also suggest reorganising the corresponding part of the Materials and methods to clearly separate the two different types of learning used at different points in the Results. More generally, during the discussion of biological plausible plasticity, the reader is left asking why the authors didn't restrict to such plasticity from the beginning. Are the results worsened when using more realistic rules?</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.57541.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) The paper focuses on a very homogeneous coding of negative prediction errors, while positive prediction errors appear only in one figure. The authors don't justify their focus on the former over the latter. It would therefore be important to include better the variety of prediction error coding in the model, and discuss its functional implications. Wouldn't it be possible and interesting to compare the distribution of different types of neurons (nPE, pPE, others) between the model and the data? The manuscript states that &quot;nPE neurons represent only a small fraction of neurons in mouse V1&quot;. This undercuts somewhat the previous sections, and calls for a more quantitative comparison, in particular with respect to a distribution that would be obtained from random wiring for instance. The predictions for optogenetic inactivations in Figure 3 are very nice, but how do they extend to the heterogeneous case with pPE and other neuron classes (Figure 4) ? Can Equations 8-9 be extended to pPE neurons?</p><p>“The paper focuses on a very homogeneous coding of negative prediction errors, while positive prediction errors appear only in one figure. The authors don't justify their focus on the former over the latter.”</p></disp-quote><p>We do agree that our focus on nPE neurons should be justified more clearly in the main text. There are several reasons why we decided to mainly look at nPE neurons: First of all, the study was motivated and inspired by experimental work on mismatch neurons (aka nPE neurons) that we wanted to compare our results with. Secondly, the vast majority of experimental findings on PE neurons is for nPE neurons (to the best of our knowledge). Thirdly, we assume that in the given context of visuomotor experience, nPE neurons should be the primary PE neurons. This is because we assume that an animal naturally learns over time that when it moves forward the world moves backwards (visual flow changes). At the same time the visual input can also change when the animal doesn’t move (e.g. caused by the movements of other animals in their environment). In contrast, phases in which self-movement does not cause changes in visual input are true mismatches and PE neurons should indicate this. As we assume that the experience a network is exposed to determines the nature of the PE neuron, this would indicate that the majority of PE neurons are indeed nPE neurons (in this simplified setting we studied).</p><p>To emphasize our choice, we have changed the beginning of the Results section:</p><p>“We studied a rate-based network model of layer 2/3 of rodent V1 to investigate how prediction-error (PE) neurons develop. In the following, we will focus primarily on negative prediction-error (nPE) neurons. […] However, the same approaches and principles derived for nPE neurons can also be applied to positive prediction-error (pPE) neurons.”</p><p>and the Discussion:</p><p>“Here, we have mainly focused on the development of nPE neurons because those have been studied extensively in layer 2/3 of rodent V1, which allowed us to qualitatively compare our model with experimental findings. […] Moreover, as we assume that excitatory neurons aim to establish an E/I balance for all stimuli they are regularly exposed to, and as animals experience episodes, in which the change of visual input is only caused by external factors (playback phases), excitatory neurons are more likely to develop into nPE than pPE neurons in the sensorimotor paradigm used here.”</p><disp-quote content-type="editor-comment"><p>“Wouldn't it be possible and interesting to compare the distribution of different types of neurons (nPE, pPE, others) between the model and the data? Can Equations 8-9 be extended to pPE neurons?”</p></disp-quote><p>Yes, it would indeed be interesting to compare the constraints for nPE and pPE neurons. Even though we assume that nPE neurons should play the major role in the visuomotor paradigm we study, the existence of pPE neurons in other contexts (e.g., reward coding) is undenied. Therefore, it would be interesting to formally derive and compare constraints on the interneuron circuit. We therefore now include mathematical constraints for pPE neurons (similar to Equation 8 and 9, see Appendix 2) and first simulation results for different pPE circuits (analog to Figure 2, see Appendix 2—figure 1). We also show how those can be learned with the same learning rules used for nPE neurons (similar to Figure 1, see Appendix 2—figure 2). Note that these results are for a homogeneous network of pPE neurons. The results, which are shown in the Appendix, are referred to in the Discussion:</p><p>“We expect that the same principles and approaches described here also hold for the formation of pPE neurons. […] The inhibitory plasticity establishes pPE neurons independent of the input configuration onto PCs and PV neurons as long as various excitatory, inhibitory, disinhibitory and dis-disinhibitory pathways can be balanced (see Appendix 2—figure 1, Equations 50 and 51)”.</p><p>A thorough and complete investigation of nPE and pPE neurons developing in the same network is beyond the scope of this study and currently an ongoing project in the lab. To understand why the formation of both PE neurons in the same network is not a trivial task in the framework we use, please consider these two cases:</p><p>i) Perfect PE neurons, that is, nPE neurons remain at baseline during feedback and playback, while pPE neurons remain at baseline during feedback and mismatch phase:</p><p>For perfect nPE neurons to develop, the network must be exposed to feedback and playback phases. For perfect pPE neurons to develop, the network must be exposed to feedback and mismatch phases during training. Thus, if both PE neurons should emerge within the very same network, the network must be exposed to all phases. However, given the current plasticity rules we use in the framework, this would most likely produce neurons that remain at their baseline during all phases. To force the network to generate nPE and pPE neurons, the plasticity rules must incorporate gating signals that restrict learning to a subset of these phases. This is beyond the current framework.</p><p>ii) Imperfect PE neurons, that is, nPE neurons remain at baseline during feedback, but are allowed to decrease activity during playback, and similarly pPE neurons remain at baseline during feedback but are allowed to decrease activity during mismatch:</p><p>In such a scenario, the network must only be exposed to feedback phases, to avoid that the plasticity establishes an E/I balance also during playback and mismatch phases. nPE and pPE neurons can then develop within the same network, but the outcome will depend on many parameters, including the network initialisation, the number of plastic synapses and the distribution of actual and expected signals. The number of degrees of freedom in the model is then very large. A complete characterisation of all parameter boundaries is subject to ongoing research in the lab and beyond the scope of the present paper.</p><p>We have now included a section on this topic in the Discussion:</p><p>“In the present work, we derived the constraints for separate nPE and pPE neurons and did not study the parallel development of both in the same neural network. […] A thorough investigation of these scenarios for the simultaneous development of nPE and pPE neurons is, however, beyond the scope of the present study.”</p><disp-quote content-type="editor-comment"><p>“The predictions for optogenetic inactivations in Figure 3 are very nice, but how do they extend to the heterogeneous case with pPE and other neuron classes (Figure 4)?”</p></disp-quote><p>We agree that it would be great to extend the simulated optogenetic experience to heterogeneous networks. However, as discussed above, a thorough understanding of heterogeneous networks with nPE and pPE neurons is beyond the scope of the present work. In fact, Loreen Hertäg is currently preparing a grant proposal, in which she aims to extend on this work, including an extensive study of heterogeneous networks.</p><disp-quote content-type="editor-comment"><p>2) In the model, every neuron receives one or two scalar signals representing a one-dimensional visual input and corresponding motor efference copy. The authors should describe how their results would generalize to a situation in which neurons have different selectivities. In particular, there are observations that receptive-field size differs across cell types. More generally, could the circuit the authors describe generalize to neurons with &quot;mixed selectivity&quot; to multiple variables?</p></disp-quote><p>That is a very good point and one of the foci of the above mentioned grant proposal. Indeed, it has been found that layer 2/3 mismatch neurons in rodent V1 exhibit receptive fields for mismatches, which co-align with their visual receptive fields (Zmarz and Keller, 2016). These sensorimotor mismatch responses are confined to local regions of the visual field. It is therefore very interesting to equip excitatory neurons with feature selectivity and study how the constraints on the IN circuit change and how this affects the selectivity in IN types, which have been shown to exhibit a broad spectrum of tuning properties (Sohya et al., 2007; Cardin et al., 2007; Kerlin et al., 2010; Atallah et al., 2012). We expect that nPE (and also pPE neurons) can still emerge in these networks, but further constraints will need to be satisfied. In a first approach, feature selectivity can be studied in independent columns (see e.g. Wacongne et al., 2012) with weak cross-coupling that is increased systematically. We intend to study this in detail but would prefer to leave this for future work because it will open up a completely new chapter. Nevertheless, we have included a section on this topic in the Discussion:</p><p>“A hallmark of neurons in sensory areas is their pronounced feature selectivity (Cardin et al., 2007; Niell and Stryker, 2008; Harris and Mrsic-Flogel, 2013). […] For future work, it would be interesting to study how the presence of feature-selective PE neurons constrains the feature selectivity in interneurons that tend to be more broadly tuned than excitatory neurons (Sohya et al., 2007; Cardin et al., 2007; Kerlin et al., 2010; Atallah et al., 2012).”</p><disp-quote content-type="editor-comment"><p>3) The paper heavily focuses on a 4 cell-type motif (Pyr, PV, SOM, VIP), but does not provide a clear message on what the functional importance of this motif is. Could PE and nPE neurons emerge in circuits with only 2 or 3 cell types? If so, what computational benefits does the presence of other cell types provide? Along similar lines, how stringent are the conditions on synaptic weights to generate nPE (or pPE) neurons ? A comparison between the number of constraints and the number of variables would be interesting to determine how large the space of solutions is.</p></disp-quote><p>Thanks for this suggestion. We decided to focus on these three IN types because they form a canonical motif that has been observed frequently. However, we agree that a more extensive discussion further strengthens the paper. We therefore now include an exhaustive list of nPE circuits and the corresponding constraints in the Appendix that hopefully clarifies this matter. Moreover, we adapted the text to account for this:</p><p>“We used a mathematical analysis to derive constraints imposed on an interneuron circuit by the presence of nPE neurons. […] While a minimal model that allows nPE neurons to develop comprises SOM neurons and PCs (Attinger et al., 2017), the network with three inhibitory neuron types appears the most likely nPE circuit given what is currently known about rodent V1.”</p><disp-quote content-type="editor-comment"><p>4) What is the role of recurrent connections In the model? The argument in terms of pathways (Figure 2) does not take loops into account. The approach taken here should be compared with predictive coding of Deneve and Machens, which relies on recurrent connection.</p></disp-quote><p>Thanks for this comment. It highlights that we have not sufficiently emphasized that the model in fact includes recurrent connections, not only between the PCs and the INs, but also within the PC population. To keep the figures clean, excitatory connections are not includes in the network schemata. To highlight that those are included, we updated the corresponding captions. Note that during feedback and playback, these connections are not relevant because the E-E synapses target the dendrites, which are over-inhibited in those phases. Please note also that the generality of the approach does not rely on the recurrent connections targeting the dendrites.</p><p>Thanks for highlighting that the related work of Deneve and Machens should be discussed in the paper. We have now added a section in the Discussion:</p><p>“In our model, the excitatory recurrent connections target the apical dendrites of PCs, but given that PCs comprise a homogeneous population, they serve no specific computational purpose in the present context. […] It will be interesting to study how this line of work is related to the PE circuit model we studied here, but it would require to extend the present model to perform richer computations, e.g., by endowing it with stimulus selectivity.”</p><disp-quote content-type="editor-comment"><p>5) A key point of the paper is the plasticity rule operative at SOM-&gt;PV synapses. In the first part of the paper, the authors use a non-local, backpropagation-like rule, and then later show that under certain circumstances this assumption can be relaxed. The fact that the initial learning rule is based on backpropagation becomes apparent only in the first paragraph of the Results, and the reader needs to dig through the Materials and methods and appendix to understand the details of the plasticity rule that is being used throughout the main text. The learning rules need to be explained earlier in the manuscript, e.g. by including, Equations 16, 17, and 19 of the Materials and methods in the main text. We also suggest reorganising the corresponding part of the Materials and methods to clearly separate the two different types of learning used at different points in the Results. More generally, during the discussion of biological plausible plasticity, the reader is left asking why the authors didn't restrict to such plasticity from the beginning. Are the results worsened when using more realistic rules?</p></disp-quote><p>Thanks for pointing out that the plasticity rules used are not obvious to the reader and should therefore be mentioned earlier. We now describe the plasticity rules in the Results (second paragraph and subsection “nPE circuits can also be learned by biologically plausible learning rules” and reference to the respective equations in the Materials and methods more carefully. The Materials and methods now includes subsections that hopefully make the distinction between the two different rules more visible (subsections “Connections onto PCs”, “Connections onto PV neurons - non-local learning” and “Connections onto PV neurons - local approximation to backpropagation of error”).</p><p>Regarding the performance of the local approximation of the backprop rule:</p><p>The main goal of the present paper was to show that PE circuits can be learned by balancing excitation and inhibition, rather than on the specific synaptic learning rules that achieve an E/I balance. In our setting, the local, more biological learning rule does a very good job (see Figure 6). We also found that this local rule effectively establishes an E/I balance in networks with rich stimulus selectivity (Mackwood et al., 2020). Of course, we expect that the approximation will break down at some point, e.g., when the connection probability is too low. An extensive evaluation of the conditions under which the approximation works would in our view distract from the main message of the paper and should be done elsewhere.</p><p>To justify our choice, we added a sentence in the Discussion:</p><p>“Given that the main goal of the present paper was to show that PE circuits can be learned by balancing excitation and inhibition, we used the plasticity rule implementing a backpropagation of error, to ensure maximal generality.”</p></body></sub-article></article>