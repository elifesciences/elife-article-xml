<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">61968</article-id><article-id pub-id-type="doi">10.7554/eLife.61968</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group></article-categories><title-group><article-title>Metage2Metabo, microbiota-scale metabolic complementarity for the identification of key species</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" id="author-208370"><name><surname>Belcour</surname><given-names>Arnaud</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1170-0785</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-111542"><name><surname>Frioux</surname><given-names>Clémence</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2114-0697</contrib-id><email>clemence.frioux@inria.fr</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-208371"><name><surname>Aite</surname><given-names>Méziane</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9086-1485</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-208372"><name><surname>Bretaudeau</surname><given-names>Anthony</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-0914-2470</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-208135"><name><surname>Hildebrand</surname><given-names>Falk</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0078-8948</contrib-id><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-111557"><name><surname>Siegel</surname><given-names>Anne</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-6542-1568</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>Univ Rennes, Inria, CNRS, IRISA</institution><addr-line><named-content content-type="city">Rennes</named-content></addr-line><country>France</country></aff><aff id="aff2"><label>2</label><institution>Inria Bordeaux Sud-Ouest</institution><addr-line><named-content content-type="city">Talence</named-content></addr-line><country>France</country></aff><aff id="aff3"><label>3</label><institution>Gut Microbes and Heath, Quadram Institute</institution><addr-line><named-content content-type="city">Norwich</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff4"><label>4</label><institution>Digital Biology, Earlham Institute</institution><addr-line><named-content content-type="city">Norwich</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff5"><label>5</label><institution>Inria, UMR IGEPP, BioInformatics Platform for Agroecosystems Arthropods (BIPAA)</institution><addr-line><named-content content-type="city">Rennes</named-content></addr-line><country>France</country></aff><aff id="aff6"><label>6</label><institution>Inria, IRISA, GenOuest Core Facility</institution><addr-line><named-content content-type="city">Rennes</named-content></addr-line><country>France</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Zambrano</surname><given-names>María Mercedes</given-names></name><role>Reviewing Editor</role><aff><institution>CorpoGen</institution><country>Colombia</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Storz</surname><given-names>Gisela</given-names></name><role>Senior Editor</role><aff><institution>National Institute of Child Health and Human Development</institution><country>United States</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>29</day><month>12</month><year>2020</year></pub-date><pub-date pub-type="collection"><year>2020</year></pub-date><volume>9</volume><elocation-id>e61968</elocation-id><history><date date-type="received" iso-8601-date="2020-08-10"><day>10</day><month>08</month><year>2020</year></date><date date-type="accepted" iso-8601-date="2020-12-25"><day>25</day><month>12</month><year>2020</year></date></history><permissions><copyright-statement>© 2020, Belcour et al</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>Belcour et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-61968-v2.pdf"/><abstract><p>To capture the functional diversity of microbiota, one must identify metabolic functions and species of interest within hundreds or thousands of microorganisms. We present Metage2Metabo (M2M) a resource that meets the need for de novo functional screening of genome-scale metabolic networks (GSMNs) at the scale of a metagenome, and the identification of critical species with respect to metabolic cooperation. M2M comprises a flexible pipeline for the characterisation of individual metabolisms and collective metabolic complementarity. In addition, M2M identifies key species, that are meaningful members of the community for functions of interest. We demonstrate that M2M is applicable to collections of genomes as well as metagenome-assembled genomes, permits an efficient GSMN reconstruction with Pathway Tools, and assesses the cooperation potential between species. M2M identifies key organisms by reducing the complexity of a large-scale microbiota into minimal communities with equivalent properties, suitable for further analyses.</p></abstract><abstract abstract-type="executive-summary"><title>eLife digest</title><p>All the microbes that live in a specific environment, for example an organ, are collectively called the microbiota. In humans, the microbiota of the gut has been extensively studied by sequencing the DNA of the different microbes to identify them and determine the roles they play in health and disease. The DNA sequences of all the members of the microbiota is called the metagenome.</p><p>The chemical reactions that the gut microbiota perform to produce energy and make the biomolecules they need to survive are collectively referred to as the metabolism of these microbes. Studying the metabolism of the gut microbiota can help researchers understand the roles of the different microbes. However, the large variety of species in the gut microbiota and gaps in the information about them render these studies difficult, despite technology improving quickly.</p><p>To tackle this issue, Belcour, Frioux et al developed a new piece of software called Metage2Metabo (M2M) that simulates the metabolism of the gut microbiota and describes the metabolic relationships between the different microbes. Metage2Metabo analyses the roles of the metabolic genes of a large number of microbe species to establish how they complement each other metabolically. Then, it can calculate the minimum number of species needed to perform a metabolic role of interest within that microbiota, and which key species are associated with that role.</p><p>To test the new software, Belcour, Frioux et al. used Metage2Metabo to analyse genomes from the human gut microbiota and from the cow rumen (one of the cow’s stomachs). They showed that even if the metagenome was incomplete, the software was able to make stable predictions of key species involved in metabolic complementarity. Additionally, they also illustrated how the method can be used to study the gut microbiota of individuals.</p><p>This work presents a new method for determining the metabolic relationships between species within a microbiota. The software is highly flexible and could be adapted to identify key members within different communities. In the context of the gut microbiota, the predictions of Metage2Metabo could shed lights on the interactions between the host and the microbes and contribute to a better understanding of microbe environments.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>systems biology</kwd><kwd>metabolic modelling</kwd><kwd>microbiota</kwd><kwd>metagenomics</kwd><kwd>keystone species</kwd><kwd>metabolic complementarity</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000268</institution-id><institution>BBSRC</institution></institution-wrap></funding-source><award-id>Gut Microbes and Health BB/r012490/1 and its constituent project BBS/e/F/000Pr1035</award-id><principal-award-recipient><name><surname>Frioux</surname><given-names>Clémence</given-names></name><name><surname>Hildebrand</surname><given-names>Falk</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001665</institution-id><institution>ANR</institution></institution-wrap></funding-source><award-id>IDEALG (ANR-10-BTBR-04) &quot;Investissements d'Avenir. Biotechnologies-Bioressources&quot;</award-id><principal-award-recipient><name><surname>Belcour</surname><given-names>Arnaud</given-names></name><name><surname>Frioux</surname><given-names>Clémence</given-names></name><name><surname>Aite</surname><given-names>Méziane</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Computational models and software connect metagenomics to metabolic network reconstruction, assess metabolic complementarity between species, and identify critical species associated to functions of interest.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Understanding the interactions between organisms within microbiomes is crucial for ecological (<xref ref-type="bibr" rid="bib99">Tara Oceans coordinators et al., 2015</xref>) and health (<xref ref-type="bibr" rid="bib48">Integrative HMP (iHMP) Research Network Consortium, 2014</xref>) applications. Improvements in metagenomics, and in particular the development of methods to assemble individual genomes from metagenomes, have given rise to unprecedented amounts of data which can be used to elucidate the functioning of microbiomes. Hundreds or thousands of genomes can now be reconstructed from various environments (<xref ref-type="bibr" rid="bib77">Pasolli et al., 2019</xref>; <xref ref-type="bibr" rid="bib33">Forster et al., 2019</xref>; <xref ref-type="bibr" rid="bib109">Zou et al., 2019</xref>; <xref ref-type="bibr" rid="bib98">Stewart et al., 2018</xref>; <xref ref-type="bibr" rid="bib3">Almeida et al., 2020</xref>), either with the help of reference genomes or through metagenome-assembled genomes (MAGs), paving the way for numerous downstream analyses. Some major interactions between species occur at the metabolic level. This is the case for negative interactions such as exploitative competition (e.g. for nutrient resources), or for positive interactions such as cross-feeding or syntrophy (<xref ref-type="bibr" rid="bib23">Coyte and Rakoff-Nahoum, 2019</xref>) that we will refer to with the generic term of cooperation. In order to unravel such interactions between species, it is necessary to go beyond functional annotation of individual genomes and connect metagenomic data to metabolic modelling. The main challenges impeding mathematical and computational analysis and simulation of metabolism in microbiomes are the scale of metagenomic datasets and the incompleteness of their data.</p><p>Genome-scale metabolic networks (GSMNs) integrate all the expected metabolic reactions of an organism. <xref ref-type="bibr" rid="bib101">Thiele and Palsson, 2010</xref> defined a precise protocol for their reconstruction, associating the use of automatic methods and thorough curation based on expertise, literature, and mathematical analyses. There now exists a variety of GSMN reconstruction implementations: all-in-one platforms such as Pathway Tools (<xref ref-type="bibr" rid="bib51">Karp et al., 2016</xref>), CarveMe (<xref ref-type="bibr" rid="bib58">Machado et al., 2018</xref>) or KBase that provides narratives from metagenomic datasets analysis up to GSMN reconstruction with ModelSEED (<xref ref-type="bibr" rid="bib40">Henry et al., 2010</xref>; <xref ref-type="bibr" rid="bib90">Seaver et al., 2020</xref>). In addition, a variety of toolboxes (<xref ref-type="bibr" rid="bib1">Aite et al., 2018</xref>; <xref ref-type="bibr" rid="bib105">Wang et al., 2018</xref>; <xref ref-type="bibr" rid="bib88">Schellenberger et al., 2011</xref>), or individual tools perform targeted refinements and analyses on GSMNs (<xref ref-type="bibr" rid="bib83">Prigent et al., 2017</xref>; <xref ref-type="bibr" rid="bib100">Thiele et al., 2014</xref>; <xref ref-type="bibr" rid="bib104">Vitkin and Shlomi, 2012</xref>). Reconstructed GSMNs are a resource to analyse the metabolic complementarity between species, which can be seen as a representation of the putative cooperation within communities (<xref ref-type="bibr" rid="bib74">Opatovsky et al., 2018</xref>). SMETANA (<xref ref-type="bibr" rid="bib107">Zelezniak et al., 2015</xref>) estimates the cooperation potential and simulates flux exchanges within communities. MiSCoTo (<xref ref-type="bibr" rid="bib35">Frioux et al., 2018</xref>) computes the metabolic potential of interacting species and performs community reduction. NetCooperate (<xref ref-type="bibr" rid="bib56">Levy et al., 2015</xref>) predicts the metabolic complementarity between species.</p><p>In addition, a variety of toolboxes have been proposed to study communities of organisms using GSMNs (<xref ref-type="bibr" rid="bib54">Kumar et al., 2019</xref>; <xref ref-type="bibr" rid="bib92">Sen and Orešič, 2019</xref>), most of them relying on constraint-based modelling (<xref ref-type="bibr" rid="bib18">Chan et al., 2017</xref>; <xref ref-type="bibr" rid="bib108">Zomorrodi and Maranas, 2012</xref>; <xref ref-type="bibr" rid="bib52">Khandelwal et al., 2013</xref>). However, these tools can only be applied to communities with few members, as the computational cost scales exponentially with the number of included members (<xref ref-type="bibr" rid="bib54">Kumar et al., 2019</xref>). Only recently has the computational bottleneck started to be addressed (<xref ref-type="bibr" rid="bib26">Diener et al., 2020</xref>). In addition, current methods require GSMNs of high quality in order to produce accurate mathematical predictions and quantitative simulations. Reaching this level of quality entails manual modifications to the models using human expertise, which is not feasible at a large scale in metagenomics. Automatic reconstruction of GSMNs scales to metagenomic datasets, but it comes with the cost of possible missing reactions and inaccurate stoichiometry that impede the use of constraint-based modelling (<xref ref-type="bibr" rid="bib11">Bernstein et al., 2019</xref>). Therefore, development of tools tailored to the analysis of large communities is needed.</p><p>Here, we describe Metage2Metabo (M2M), a software system for the characterisation of metabolic complementarity starting from annotated individual genomes. M2M capitalises on the parallel reconstruction of GSMNs and a relevant metabolic modelling formalism to scale to large microbiotas. It comprises a pipeline for the individual and collective analysis of GSMNs and the identification of communities and key species ensuring the producibility of metabolic compounds of interest. M2M automates the systematic reconstruction of GSMNs using Pathway Tools or relies on GSMNs provided by the user. The software system uses the algorithm of network expansion (<xref ref-type="bibr" rid="bib27">Ebenhöh et al., 2004</xref>) to capture the set of producible metabolites in a GSMN. This choice answers the needs for stoichiometry inaccuracy handling, and the robustness of the algorithm was demonstrated by the stability of the set of reachable metabolites despite missing reactions (<xref ref-type="bibr" rid="bib39">Handorf et al., 2005</xref>; <xref ref-type="bibr" rid="bib53">Kruse and Ebenhöh, 2008</xref>). Consequently, M2M scales metabolic modelling to metagenomics and large collections of (metagenome-assembled) genomes.</p><p>We applied M2M on a collection of 1520 draft bacterial reference genomes from the gut microbiota (<xref ref-type="bibr" rid="bib109">Zou et al., 2019</xref>) in order to illustrate the range of analyses the tool can produce. This demonstrates that M2M efficiently reconstructs metabolic networks for all genomes, identifies potential metabolites produced by cooperating bacteria, and suggests minimal communities and key species associated to their production. We then compared metabolic network reconstruction applied to the gut reference genomes to the results obtained with a collection of 913 cow rumen MAGs (<xref ref-type="bibr" rid="bib98">Stewart et al., 2018</xref>). In addition, we tested the robustness of metabolic prediction with respect to genome incompleteness by degrading the rumen MAGs. The comparison of outputs from the pipeline indicates stability of the results with moderately degraded genomes, and the overall suitability of M2M to MAGs. Finally, we demonstrated the applicability of M2M in practice to metagenomic data of individuals. To that purpose, we reconstructed communities for 170 samples of healthy and diabetic individuals (<xref ref-type="bibr" rid="bib32">Forslund et al., 2015</xref>; <xref ref-type="bibr" rid="bib26">Diener et al., 2020</xref>). We show how M2M can help connect sequence analyses to metabolic screening in metagenomic datasets.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>M2M pipeline and key species</title><p>M2M is a flexible software solution that performs automatic GSMN reconstruction and systematic screening of metabolic capabilities for up to thousands of species for which an annotated genome is available. The tool computes both the individual and collective metabolic capabilities to estimate the complementarity between the metabolisms of the species. Then based on a determined metabolic objective which can be ensuring the producibility of metabolites that need cooperation, that we call cooperation potential, M2M performs a community reduction step that aims at identifying a minimal community fulfilling the metabolic objective, as well as the set of associated key species.</p><p>M2M’s main pipeline (<xref ref-type="fig" rid="fig1">Figure 1a</xref>) consists in five main steps that can be performed sequentially or independently: (i) reconstruction of metabolic networks for all annotated genomes, (ii) computation of individual and (iii) collective metabolic capabilities, (iv) calculation of the cooperation potential, and (v) identification of minimal communities and key species for a targeted set of compounds.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Overview of the Metage2Metabo (M2M) pipeline.</title><p>(<bold>a</bold>) Main steps of the M2M pipeline and associated tools. The software’s main pipeline (m2m workflow) takes as inputs a collection of annotated genomes that can be reference genomes or metagenomic-assembled genomes. The first step of M2M consists in reconstructing metabolic networks with Pathway Tools (step 0). This first step can be bypassed and genome-scale metabolic networks (GSMNs) can be directly loaded in M2M. The resulting metabolic networks are analysed to identify individual (step 1) and collective (step 2) metabolic capabilities. The added-value of cooperation is calculated (step 3) and used as a metabolic objective to compute a minimal community and key species (step 4). Optionally, one can customise the metabolic targets for community reduction. The pipeline without GSMN reconstruction can be called with m2m metacom, and each step can also be called independently (m2m iscope, m2m cscope, m2m addedvalue, m2m mincom). (<bold>b</bold>) Description of key species. Community reduction performed at step 4 can lead to multiple equivalent communities. M2M provides one minimal community and efficiently computes the full set of species that occur in all minimal communities, without the need for a full enumeration, thanks to projection modes. It is possible to distinguish the species occurring in every minimal community (essential symbionts), from those occurring in some (alternative symbionts). Altogether, these two groups form the key species.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61968-fig1-v2.tif"/></fig><p>Sets of producible metabolites for individual or communities of species are computed using the network expansion algorithm (<xref ref-type="bibr" rid="bib27">Ebenhöh et al., 2004</xref>) that is implemented in Answer Set Programming in dependencies of M2M. Network expansion enables the calculation of the <italic>scope</italic> of one or several metabolic networks in given nutritional conditions, described as seed compounds. The scope therefore represents the metabolic potential or reachable metabolites in these conditions (see Materials and methods). M2M calculates individual scopes for all metabolic networks, and the community scope comprising all reachable metabolites for the interacting species. Network expansion is also used in the community reduction optimisation implemented in MiSCoTo (<xref ref-type="bibr" rid="bib35">Frioux et al., 2018</xref>), the dependency of M2M, as reduced communities are expected to produce the metabolites of interest.</p><p>The inputs to the whole workflow are a set of annotated genomes, a list of nutrients representing a growth medium, and optionally a list of targeted compounds to be produced by selected communities that will bypass the default objective of ensuring the producibility of the cooperation potential. Users can use the annotation pipeline of their choice prior running M2M. The whole pipeline is called with the command <monospace>m2m workflow</monospace> but each step can also be run individually as described in <xref ref-type="table" rid="table1">Table 1</xref>.</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>List and description of Metage2Metabo (M2M) commands.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Command</th><th>Action</th></tr></thead><tbody><tr><td><monospace>m2m workflow</monospace></td><td>Runs the whole m2m workflow</td></tr><tr><td><monospace>m2m metacom</monospace></td><td>Runs the workflow with already-reconstructed metabolic networks</td></tr><tr><td><monospace>m2m recon</monospace></td><td>Reconstructs metabolic networks using Pathway Tools</td></tr><tr><td><monospace>m2m iscope</monospace></td><td>Computes scopes for individual metabolic networks</td></tr><tr><td><monospace>m2m cscope</monospace></td><td>Computes the community scope</td></tr><tr><td><monospace>m2m addedvalue</monospace></td><td>Computes the cooperation potential</td></tr><tr><td><monospace>m2m mincom</monospace></td><td>Selects a minimal community and computes key species</td></tr><tr><td><monospace>m2m seeds</monospace></td><td>Creates a SBML file for nutrients</td></tr><tr><td><monospace>m2m test</monospace></td><td>Runs m2m workflow on a sample dataset</td></tr><tr><td><monospace>m2m_analysis</monospace></td><td>Runs additional analyses on community selection</td></tr></tbody></table></table-wrap><p>A main characteristic of M2M is to provide at the end of the pipeline a set of <italic>key species</italic> associated to a metabolic function together with one minimal community predicted to satisfy this function. We define as key species organisms whose GSMNs are selected in at least one of the minimal communities predicted to fulfill the metabolic objective. Among key species, we distinguish those that occur in every minimal community, suggesting that they possess key functions associated to the objective, from those that occur only in some communities. We call the former <italic>essential symbionts</italic>, and the latter <italic>alternative symbionts</italic>. These terms were inspired by the terminology used in flux variability analysis (<xref ref-type="bibr" rid="bib75">Orth et al., 2010</xref>) for the description of reactions in all optimal flux distributions. If interested, one can compute the enumeration of all minimal communities with <italic>m2m_analysis</italic>, which will provide the total number of minimal communities as well as the composition of each. <xref ref-type="fig" rid="fig1">Figure 1b</xref> illustrates these concepts with an initial community formed of eight species. There are four minimal communities satisfying the metabolic objective. Each includes three species, and in particular, the yellow one is systematically a member. Therefore, the yellow species is an essential symbiont whereas the four other species involved in minimal communities constitute the set of alternative symbiont. As key species represent the diversity associated to all minimal communities, it is likely that their number is greater than the size of a minimal community, as this is the case in <xref ref-type="fig" rid="fig1">Figure 1b</xref>.</p></sec><sec id="s2-2"><title>M2M connects metagenomics to metabolism with GSMN reconstruction, metabolic complementarity screening and community reduction</title><p>In order to illustrate its applicability to real data, M2M was applied to a collection of 1520 bacterial high-quality draft reference genomes from the gut microbiota presented in <xref ref-type="bibr" rid="bib109">Zou et al., 2019</xref>. The genomes were derived from cultured bacteria, isolated from faecal samples covering typical gut phyla (<xref ref-type="bibr" rid="bib21">Costea et al., 2018</xref>): 796 Firmicutes, 447 Bacteroidetes, 235 Actinobacteria, 36 Proteobacteria, and 6 Fusobacteria. The dereplicated genomes represent 338 species. The genomes were already annotated and could therefore directly enter M2M pipeline. The full workflow (from GSMN reconstruction to key species computation) took 155 min on a cluster with 72 CPUs and 144 Gb of memory. We illustrate in the next paragraphs the scalability of M2M and the range of analyses it proposes by applying the pipeline to this collection of genomes.</p><sec id="s2-2-1"><title>GSMN reconstruction</title><p>GSMNs were automatically reconstructed for the 1520 isolate-based genomes using their published annotation. A total of 3932 unique reactions and 4001 metabolites were included in the reconstructed GSMNs (<xref ref-type="table" rid="table2">Table 2</xref>). The reconstructed gut metabolic networks contained on average 1144 (±255) reactions and 1366 (±262) metabolites per genome. Of the reactions, 74.6% were associated to genes, the remaining being spontaneous reactions or reactions added by the PathoLogic algorithm (they can be removed in M2M using the <italic>–noorphan</italic> option).</p><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>Results of the genome-scale metabolic network (GSMN) reconstruction step and metabolic potential analysis for the three datasets presented in the article (Avg = Average, '±' precedes standard deviation).</title></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>Gut dataset</th><th>Rumen dataset</th><th>Diabetes dataset</th></tr></thead><tbody><tr><td>Initial data</td><td>Draft reference genomes</td><td>MAGs</td><td>MAGs</td></tr><tr><td>Number of genomes</td><td>1520</td><td>913</td><td>778</td></tr><tr><td><italic>GSMN reconstruction</italic></td><td/><td/><td/></tr><tr><td>All reactions</td><td>3932</td><td>4418</td><td>5554</td></tr><tr><td>All metabolites</td><td>4001</td><td>4466</td><td>5386</td></tr><tr><td>Avg reactions per GSMN</td><td>1144 (±255)</td><td>1155 (±199)</td><td>1640 (±368)</td></tr><tr><td>Avg metabolites per GSMN</td><td>1366 (±262)</td><td>1422 (±212)</td><td>1925 (±361)</td></tr><tr><td>Avg genes per mn</td><td>596 (±150)</td><td>543 (±107)</td><td>1658 (±469)</td></tr><tr><td>% reactions associated to genes</td><td>74.6 (±2.17)</td><td>73.8 (±2.61)</td><td>79.57 (±1.60)</td></tr><tr><td>Avg pathways per mn</td><td>163 (±49)</td><td>146 (±32)</td><td>220 (±58)</td></tr><tr><td><italic>Metabolic potential</italic></td><td/><td/><td/></tr><tr><td>Number of seeds</td><td>93</td><td>26</td><td>175</td></tr><tr><td>Avg scope per mn</td><td>286 (±70)</td><td>101 (±44)</td><td>508 (±83)</td></tr><tr><td>Union of individual scopes</td><td>828</td><td>368</td><td>1326</td></tr></tbody></table></table-wrap><p>The metabolic potential, or <italic>scope</italic>, was computed for each individual GSMN (<xref ref-type="table" rid="table2">Table 2</xref>). Nutrients in this experiment were components of a classical diet (see Materials and methods). The union of all individual scopes is of size 828 (21% of all compounds included in the GSMNs), indicating a small part of the metabolism reachable in the chosen nutritional environment (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref> - Table 1). <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1h,i</xref> displays the distributions of the scopes. Across all GSMNs, individual scopes are overall stable in size. The core set of producible metabolites is small and a variety of metabolites are only reachable by a small number of organisms (<xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1i</xref>). The overall small size of metabolic potentials can be explained by the restricted amount of seeds used for computation. Among metabolites that are reachable by all or almost all metabolic networks, the primary metabolism is highly represented, as expected, with metabolites derived from common sugars (glucose, fructose), pyruvate, 2-oxoglutaric acid, amino acids… On the other hand but not surprisingly, metabolites that predicted to be reached by a limited number of individual producers include compounds from secondary metabolism: (fatty) acids (e.g. oxalate, maleate, allantoate, hydroxybutanoate, methylthiopropionate), derivatives of amino acids, amines (spermidine derivatives).</p></sec><sec id="s2-2-2"><title>Cooperation potential</title><p>Metabolic cooperation enables the activation of more reactions in GSMNs than what can be expected when networks are considered in isolation. By taking into account the complementarity between GSMNs in each dataset, it is possible to capture the putative benefit of metabolic cooperation on the diversity of producible metabolites. Running <italic>m2m cscope</italic> predicted 156 new metabolites as producible by the gut collection of GSMNs if cooperation is allowed.</p><p>We analysed the composition of the 156 newly producible metabolites for the gut dataset using the ontology provided for metabolic compounds in the MetaCyc database. 80.1% of them could be grouped into six categories: amino acids and derivatives (5 metabolites), aromatic compounds (11), carboxy acids (14), coenzyme A (CoA) derivatives (10), lipids (28), sugar derivatives (58). The groups were used in the subsequent analyses. The remaining 30 compounds were highly heterogeneous, we therefore restrained our subsequent analyses to subcategories of biochemically homogeneous targets.</p><p>We paid a particular attention to the predicted producibility of short-chain fatty acids (SCFAs) among genomes of the gut collection. We analysed formate, acetate, propionate, and butyrate in individual and collective metabolic potentials (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref> - Table 25). A total of 543 metabolic networks are predicted to be able to produce all four molecules in a cooperative context, 74% of them belonging the Firmicutes, as expected. Surprisingly, predicted individual producers of the four SCFAs (n = 128) are mostly Bacteroidetes (70%) suggesting the dependency of Firmicutes to interactions in order to permit the producibility of SCFAs in this experimental setting. The same observations are made when focusing on butyrate alone, that has the particularity of belonging to the seeds. As Bacteroidetes are not the main butyrate producers in the gut, the predictions of such producibility is likely an artefact relying on alternative pathways, and further emphasises the fact that owning the genetic material for a function does not entail its expression.</p></sec><sec id="s2-2-3"><title>Key species associated to groups of metabolites</title><p>M2M proposes by default one community composition for an objective defined by enabling the producibility of metabolic end-products. Given the functional redundancy of gut bacteria (<xref ref-type="bibr" rid="bib70">Moya and Ferrer, 2016</xref>), there could be thousands of bacterial composition combinations, and it is computationally costly to enumerate them. To circumvent this restriction, M2M identifies <italic>key species</italic> without the need for all possible combinations of species to be enumerated, consequentially reducing computational time. Key species include all species occurring in at least one minimal community for the production of chosen end-products. They can be distinguished in two categories: <italic>essential symbionts</italic> occurring in all minimal communities, and <italic>alternative symbionts</italic> occurring in some minimal communities.</p><p>To explore the spectrum of possible key species, we ran M2M community reduction step (<monospace>m2m mincom</monospace> command) with the above six metabolic target groups. This allowed us to compute predicted key species for each of them (<xref ref-type="table" rid="table3">Table 3</xref>). The contents of key species for each of the six groups of targets as well as for the complete set of targets is displayed in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref> (Tables 6 to 12). To our surprise, the size of the minimal community is relatively small for each group of metabolites (between 4 and 11), compared to the initial community of 1520 GSMNs. The number of identified key species varies between 59 and 227, which might be closer to the total taxonomic diversity found in the human gut microbiome. This strong reduction compared to the initial number of 1520 GSMNs used for the analysis illustrates the existence of groups of bacteria with specific metabolic capabilities. In particular, essential symbionts are likely of high importance for the functions as they are found in each solution. More generally, compositions vary across the target categories: a high proportion of key species for the production of lipids targets are Bacteroidetes, whereas Firmicutes were more often key species for aminoacids and derivatives production. The propensity of Bacteroidetes to metabolise lipids has been proposed previously, it has for example been observed in the <italic>Bacteroides</italic> enterotype for functions related to lipolysis (<xref ref-type="bibr" rid="bib103">Vieira-Silva et al., 2016</xref>).</p><table-wrap id="table3" position="float"><label>Table 3.</label><caption><title>Community reduction analysis of the target categories in the gut.</title><p>All minimal communities were enumerated, starting from the set of 1520 genome-scale metabolic networks (GSMNs). KS: key species, ES: essential symbionts, AS: alternative symbionts, Firm.: Firmicutes, Bact.: Bacteroidetes, Acti.: Actinobacteria, Prot.: Proteobacteria, Fuso.: Fusobacteria.</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th/><th>Firm.</th><th>Bact.</th><th>Acti.</th><th>Prot.</th><th>Fuso.</th><th>Total</th></tr></thead><tbody><tr><td rowspan="3"><bold>Aminoacids and derivatives</bold> (5 targets)4 bact. per community120,329 communities</td><td>KS</td><td>142</td><td>52</td><td>0</td><td>27</td><td>6</td><td>227</td></tr><tr><td>ES</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>AS</td><td>142</td><td>52</td><td>0</td><td>27</td><td>6</td><td>227</td></tr><tr><td rowspan="3"><bold>Aromatic compounds</bold> (11 targets)5 bact. per community950 communities</td><td>KS</td><td>52</td><td>0</td><td>0</td><td>20</td><td>0</td><td>72</td></tr><tr><td>ES</td><td>2</td><td>0</td><td>0</td><td>1</td><td>0</td><td>3</td></tr><tr><td>AS</td><td>50</td><td>0</td><td>0</td><td>19</td><td>0</td><td>69</td></tr><tr><td rowspan="3"><bold>Carboxyacids</bold> (14 targets)9 bact. per community48,412 communities</td><td>KS</td><td>16</td><td>13</td><td>0</td><td>28</td><td>2</td><td>59</td></tr><tr><td>ES</td><td>2</td><td>0</td><td>0</td><td>2</td><td>0</td><td>4</td></tr><tr><td>AS</td><td>14</td><td>13</td><td>0</td><td>26</td><td>2</td><td>55</td></tr><tr><td rowspan="3"><bold>CoA derivatives</bold> (10 targets)5 bact. per community95,256 communities</td><td>KS</td><td>106</td><td>0</td><td>50</td><td>17</td><td>1</td><td>174</td></tr><tr><td>ES</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>1</td></tr><tr><td>AS</td><td>106</td><td>0</td><td>50</td><td>17</td><td>0</td><td>173</td></tr><tr><td rowspan="3"><bold>Lipids</bold> (28 targets)7 bact. per community58,520 communities</td><td>KS</td><td>3</td><td>140</td><td>22</td><td>20</td><td>0</td><td>185</td></tr><tr><td>ES</td><td>3</td><td>0</td><td>0</td><td>1</td><td>0</td><td>4</td></tr><tr><td>AS</td><td>0</td><td>140</td><td>22</td><td>19</td><td>0</td><td>181</td></tr><tr><td rowspan="3"><bold>Sugar derivatives</bold> (58 targets)11 bact. per community7,860,528 communities</td><td>KS</td><td>11</td><td>30</td><td>78</td><td>23</td><td>0</td><td>142</td></tr><tr><td>ES</td><td>5</td><td>0</td><td>0</td><td>0</td><td>0</td><td>5</td></tr><tr><td>AS</td><td>6</td><td>30</td><td>78</td><td>23</td><td>0</td><td>137</td></tr></tbody></table></table-wrap></sec><sec id="s2-2-4"><title>Analysis of minimal communities identifies groups of organisms with equivalent roles</title><p>To go further, we enumerated all minimal communities for each individual group of targets using <italic>m2m_analysis</italic>. The number of optimal solutions is large, reaching more than 7 million equivalent minimal communities for the sugar-derived metabolites (<xref ref-type="table" rid="table3">Table 3</xref>). Our analysis of key species indicates that the large number of optimal communities is due to combinatorial choices among a rather small number of bacteria (<xref ref-type="table" rid="table3">Table 3</xref>).</p><p>In order to visualise the association of GSMNs in minimal communities, we created for each target set a graph whose nodes are the key species (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref> - Tables 6 to 12), and whose edges represent the association between two species if they co-occur in at least one of the enumerated communities. Graphs were very dense: 185 nodes, 6888 edges for the lipids, 142 nodes, and 6602 edges for the sugar derivatives. This density is expected given the large number of optimal communities and the comparatively small number of key species. The graphs were compressed into power graphs to capture the combinatorics of association within minimal communities. Power graphs enable a lossless compression of re-occurring motifs within a graph: cliques, bicliques, and star patterns (<xref ref-type="bibr" rid="bib86">Royer et al., 2008</xref>). The increased readability of power graphs permits pinpointing metabolic equivalency between members of the key species with respect to the target compound families.</p><p><xref ref-type="fig" rid="fig2">Figure 2</xref> presents the compressed graphs for each set of targets. Graph nodes are the key species, coloured by their phylum. Nodes are included into power nodes that are connected by power edges, illustrating the redundant metabolic function(s) that species provide to the community when considering specific end-products. GSMNs belonging to a power node play the same role in the construction of the minimal communities. In this visualisation, essential symbionts are easily identifiable, either into power nodes with loops (<xref ref-type="fig" rid="fig2">Figure 2a,e</xref>) or as individual nodes connected to power nodes (<xref ref-type="fig" rid="fig2">Figure 2a,c,d,f</xref>).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Power graph analysis of predicted microbial associations within communities for the human gut dataset.</title><p>Each category of metabolites predicted as newly producible in the gut was defined as a target set for community selection among the 1520 genome-scale metabolic networks (GSMNs) from the gut microbiota reference genomes dataset. For each metabolic group, key species and the full enumeration of all minimal communities were computed. Association graphs were built to associate members that are found together in at least one minimal community among the enumeration. These graphs were compressed as power graphs to identify patterns of associations and groups of equivalence within key species. Power graphs a., b., c., d., e., f. were generated for the sets of lipids, aminoacids and derivatives, carboxy-acids, sugar derivatives, aromatic compounds, and coenzyme A derivative compounds, respectively. Node colour describes the phylum associated to the GSMN. Figure (<bold>a</bold>) has an additional description to ease readability. Edges symbolise conjunctions ('AND’) and the co-occurrences of nodes in regular power nodes (as in power node 1, 2, 4) symbolise disjunctions ('OR’) related to alternative symbionts. Power nodes with a loop (e.g. power node 5) indicate conjunctions. Therefore, each enumerated minimal community for lipid production is composed of the two Firmicutes and the Proteobacteria from power node 5, the Firmicutes node 3 (the four of them being the essential symbionts), and one Proteobacteria from power node 4, one Actinobacteria from power node 2 and 1 Bacteroidetes from power node 1. Members from an inner power node are interchangeable with respect to the metabolic objective. A version of the figures with species identification is available in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>, <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>, <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>, <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>, <xref ref-type="fig" rid="fig2s5">Figure 2—figure supplement 5</xref>, <xref ref-type="fig" rid="fig2s6">Figure 2—figure supplement 6</xref> (see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref> - Table 4 for a mapping between identifiers and taxonomy). Power graphs can be generated with m2m_analysis. The figures display one visual representation for each power graph although such representations are not unique. The number of power edges is minimal, which leads to nesting of (power) nodes.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61968-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Sugars derivatives power graph.</title><p>Power graph associated to the minimal communities producing the sugars derivatives group of targets.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61968-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Lipids derivatives power graph.</title><p>Power graph associated to the minimal communities producing the lipids derivatives group of targets.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61968-fig2-figsupp2-v2.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 3.</label><caption><title>Amino acids and derivatives power graph.</title><p>Power graph associated to the minimal communities producing the amino acids and derivatives group of targets.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61968-fig2-figsupp3-v2.tif"/></fig><fig id="fig2s4" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 4.</label><caption><title>Aromatic compounds power graph.</title><p>Power graph associated to the minimal communities producing the aromatic compounds group of targets.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61968-fig2-figsupp4-v2.tif"/></fig><fig id="fig2s5" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 5.</label><caption><title>Carboxy-acids compounds power graph.</title><p>Power graph associated to the minimal communities producing the carboxy-acids group of targets.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61968-fig2-figsupp5-v2.tif"/></fig><fig id="fig2s6" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 6.</label><caption><title>Coenzyme A derivatives power graph.</title><p>Power graph associated to the minimal communities producing the coenzyme A derivatives group of targets.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61968-fig2-figsupp6-v2.tif"/></fig></fig-group><p>We observe that power nodes often contain GSMNs from the same phylum, indicating that phylogenetic groups encode redundant functions. <xref ref-type="fig" rid="fig3">Figure 3a</xref> has additional comments to guide the reader into analysing the community composition on one example. Each minimal community suitable for the production of the targeted lipids is composed of one Bacteroidetes from power node (PN) 1, one Actinobacteria from PN 2, the Firmicutes member 3, one Proteobacteria from PN 4 and finally the two Firmicutes and the Proteobacteria from PN 5. For all the target groups of this study, the large enumerations can be summarised with a boolean formula derived from the graph compressions. For instance, for the lipids of <xref ref-type="fig" rid="fig3">Figure 3a</xref>, the community composition as described above is the following:<disp-formula id="equ1"><mml:math id="m1"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>∨</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∧</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>∨</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∧</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∧</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>∨</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∧</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>∧</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We further investigated the essential symbionts associated to carbohydrate-derived metabolites in our study: <italic>Paenibacillus polymyxa</italic>, <italic>Lactobacillus lactis</italic>, <italic>Bacillus licheniformis</italic>, <italic>Lactobacillus plantarum</italic>, and <italic>Dorea longicatena</italic>. Interestingly, out of these five species, the first four have already been studied in the context of probiotics, for animals or humans (<xref ref-type="bibr" rid="bib24">Cutting, 2011</xref>; <xref ref-type="bibr" rid="bib67">Monteagudo-Mera et al., 2012</xref>). In particular, the study of <italic>P. polymyxa</italic> CAZymes demonstrated its ability to assist in digesting complex carbohydrates (<xref ref-type="bibr" rid="bib96">Soni et al., 2020</xref>). <italic>L. plantarum</italic> is also known for its role in carbohydrate acquisition (<xref ref-type="bibr" rid="bib25">de Vries et al., 2006</xref>; <xref ref-type="bibr" rid="bib62">Marco et al., 2010</xref>). The present analysis illustrates that within the full genome collection, these species are likely to exhibit functions related to carbohydrate synthesis and degradation that are not found in other species. <italic>Bacillus licheniformis</italic> is also an essential symbiont for the lipid metabolites. Among essential symbionts for other groups of metabolites, <italic>Burkholderiales bacterium</italic> (Proteobacteria) and <italic>Hungatella hathewayi</italic> (Firmicutes) have the particularity of occurring in predictions for the lipids, carboxy acids, and aromatic metabolites. This suggest a metabolism for these two species that differs from the other species, with non-redundant contributions to some metabolites of these categories. While <italic>Hungatella hathewayi</italic> is a relatively frequent gut commensal, little is known about this species (<xref ref-type="bibr" rid="bib61">Manzoor et al., 2017</xref>). The <italic>Burkholderiales</italic> order is also poorly known, but its ability to degrade a variety of aromatic compounds has been established (<xref ref-type="bibr" rid="bib79">Pérez-Pantoja et al., 2012</xref>). Finally, the only essential symbiont predicted for the coA-related metabolites is <italic>Fusobacterium varium</italic>, a butyrate producer known for its ability to ferment both sugars and amino acids (<xref ref-type="bibr" rid="bib82">Potrykus et al., 2008</xref>).</p><p>Altogether, computation of key species coupled to the visualisation of community compositions enables a better understanding of the associations of organisms into the minimal communities. In this genome collection, groups of equivalent GSMNs allow us to identify genomes that are providing specialised functions to the community, enabling metabolic pathways leading to specific end-products.</p></sec></sec><sec id="s2-3"><title>M2M is suited to the metabolic analysis of MAGs</title><sec id="s2-3-1"><title>Comparison of M2M applications to MAGs and draft reference genomes</title><p>In order to compare the effect of genome quality on M2M predictions, we performed analyses on a collection of 913 MAGs binned from cow rumen metagenomes (<xref ref-type="bibr" rid="bib98">Stewart et al., 2018</xref>). These MAGs were predicted to be &gt;80% complete and &lt;10% contaminated. The complete M2M workflow ran in 81 min on a cluster with 72 CPUs and 144 Gb of memory.</p><p>Results of the GSMN reconstruction are presented in <xref ref-type="table" rid="table2">Table 2</xref>. GSMNs of the cow rumen MAGs dataset consisted in average of 1155 (±199) reactions and 1422 (±212) metabolites. 73.8% of the reactions could be associated to genes. We compared these numbers with those obtained for the collection of draft reference genomes from the human gut microbiota of the previous subsection. Appendix 1 displays the distributions of the numbers of reactions, pathways, metabolites and genes for both datasets. Altogether, these distributions are very similar for both datasets although the initial number of genes in the whole genomes varies a lot (Appendix 1 g), a difference that is expected between MAGs and reference genomes. Interestingly, the average number of reactions per GSMN is slightly higher for the MAGs of the rumen than for the reference genomes of the gut. This could be explained by the higher phylogenetic diversity observed in MAGs compared to culturable bacteria, or a higher potential for contaminated genomes, or a difference in average genome size. However, the smallest GSMN size is observed in the rumen (340 reactions vs 617 for the smallest GSMN of the gut dataset). The similarity in the characteristics displayed by both datasets suggests a level of quality of the rumen MAGs close to the one of the gut reference genomes regarding the genes associated to metabolism. This is consistent with the high-quality scores of the MAGs described in the original publication: the 913 MAGs exhibited a CheckM (<xref ref-type="bibr" rid="bib76">Parks et al., 2015</xref>) completeness score between 80% and 100% (average: 90.61%, standard deviation: 5.26%, median: 91.03%) (<xref ref-type="bibr" rid="bib98">Stewart et al., 2018</xref>).</p><p>M2M modelling analyses were run on the reconstructed GSMNs. Appendix 1 (<xref ref-type="fig" rid="fig1">Figure 1</xref>; <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref>) displays the distributions of the individual scopes for each GSMN. We identified a cooperation potential of 296 metabolic end-products only reachable through the community. The minimal community consisted of 44 GSMNs, sufficient to produce all metabolites reachable through cooperation in the initial community composition. These could be described through 127 key species, consisting of 20 essential symbionts and 107 alternative ones. This indicates that each equivalent minimal community for these compounds would consist in the same 20 GSMNs, associated to 24 others selected within the 107 alternative species, thereby reaching a total of 44 GSMNs. Results are displayed in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref> (Table 4), together with those of an equivalent analysis (default settings of M2M with cooperation potential as targets) for the gut reference genomes.</p></sec><sec id="s2-3-2"><title>M2M robustly identifies key species, even with degraded genomes</title><p>A recurring concern in metagenomics is the completeness of reconstructed MAGs due to the possible loss of functions during the genome assembly process (<xref ref-type="bibr" rid="bib76">Parks et al., 2015</xref>). Misidentified genes can impede GSMN reconstruction and consequently the contents of the scopes and cooperation potential. To assess the impact of MAG completeness, we altered the rumen MAGs dataset by randomly removing genes. We created four altered datasets by removing: (i) 2% of genes in all genomes, (ii) 5% of genes in 80% of the genomes, (iii) 5% of genes in all genomes and (iv) 10% of genes in 70% of the genomes. We analysed these degraded datasets with the same M2M workflow, using a community selection with the metabolic cooperation potential as a community objective.</p><p>The metabolic cooperation potential, the global set of reachable metabolites in the community and the key species (essential and alternative symbionts) were computed and compared between the four altered datasets and the original one. Results are depicted in <xref ref-type="fig" rid="fig3">Figure 3</xref>. The global set of producible metabolites in the community and the contents of the metabolic cooperation potential remain stable between datasets. In both we observe a single subset of 36 metabolites that is only reachable by the original dataset. It consists in a variety of metabolites mostly from secondary metabolism. Discrepancies appear between datasets when studying key species with respect to the original dataset, with an overall stability of the datasets to 2% degradation and to 5% degradation in 80% of genomes. The main discrepancies are observed for alternative symbionts with an additional small set of symbionts that are selected in altered datasets but not in the original one. For the most degraded genomes (10% degradation in 70% of MAGs), key species composition is altered compared to original genomes: a set of 31 key species is no longer identified. However, producibility analyses and community selections performed by M2M are stable to small genome degradations of up to 2% of random gene loss in all genomes or 5% in 80% of the genomes. Altogether, <xref ref-type="fig" rid="fig3">Figure 3</xref> illustrates relative stability of the information computed by M2M to missing genes. The criteria typically used for MAG quality (&gt;80% completeness, &lt;10% degradation) are likely sufficient to get a coarse-grained, yet valuable first picture of the metabolism. This robustness in our algorithms could be explained by the fact that (i) missing genes in degraded MAGs may not be related to metabolism, (ii) by the reported stability of the network expansion algorithm to missing reactions (<xref ref-type="bibr" rid="bib39">Handorf et al., 2005</xref>), and (iii) by the fact that multiple genes can be associated to the same metabolic reaction (redundancy in pathway representation). Additional analyses (Appendix 1) enable the refutation of the first hypothesis as the average gene loss in metabolic networks is similar to the genomic loss. Yet, the percentage of reactions associated to genes is similar in every experiments, which goes in the direction of the redundancy loss hypothesis. Likewise, we observed that the loss in reactions for degraded genomes is lower than the loss of genes.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Robustness analysis of Metage2Metabo (M2M) results on datasets of altered metagenome-assembled genomes (MAGs).</title><p>A proportion of genes were randomly removed from all or a random subset of the 913 rumen MAGs: 2% from all genomes (<italic>2pc100</italic>), 5% from 80% of the genomes (<italic>5pc80</italic>), 5% from all genomes (<italic>5pc100</italic>) and 10% from 70% of the genomes (<italic>10pc70</italic>). M2M pipeline was ran on these four datasets and comparison was made with respect to the initial non-altered dataset of MAGs (<italic>original</italic>). Subfigures <italic>a</italic> to <italic>e</italic> each represent one piece of information computed by M2M and compared between the five experiments. (<bold>a</bold>) Set of producible compounds by all metabolic networks in a cooperative system (community scope); supervenn representation. Each dataset of metabolic networks obtained from the original or degraded genomes is represented horizontally, with a unique colour. The right panel of the supervenn diagram indicates the number of metabolites in the community scope of the corresponding dataset. Vertical overlaps between sets represent intersections (e.g groups of metabolites retrieved in several datasets) whose size is indicated on the X axis. For example, there is a set of 37 metabolites that are producible in the original dataset only, and a set of 5 metabolites predicted as producible in all datasets but the one where 70% of genomes were 10%-degraded. A full superimposition of all the coloured bars would indicate a complete stability of the community scope between datasets. (<bold>b</bold>) Comparison of the cooperation potential between the five experiments. (<bold>c</bold>) Comparison of key species that gather essential symbionts (<bold>d</bold>) and alternative symbionts (<bold>e</bold>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61968-fig3-v2.tif"/></fig></sec></sec><sec id="s2-4"><title>Application of M2M to human shotgun metagenomic data from diabetic and healthy individuals</title><sec id="s2-4-1"><title>Protocols and cohort effect</title><p>In order to illustrate the applicability of M2M to metagenomic samples and cohorts of individuals, we reused the work presented in <xref ref-type="bibr" rid="bib26">Diener et al., 2020</xref> and analysed the gut metagenomes of 170 individuals from a Danish (MHD) cohort and a Swedish (SWE) cohort (<xref ref-type="bibr" rid="bib32">Forslund et al., 2015</xref>) in the context of Type-1 (T1D) and Type-2 (T2D) diabetes. Based on species-level dereplicated MAGs, metagenomic species (MGS), we built GSMNs and bacterial communities for each individual. We relied only on the available metagenomic data to perform analyses, and used qualitative information (presence/absence of MGS or species in the sample) to build the communities as M2M works with qualitative information. Two experiments were performed: firstly, M2M was run on each sample using communities of newly reconstructed GSMN from MGS, and secondly using communities consisting of curated GSMNs of the AGORA resources (<xref ref-type="bibr" rid="bib59">Magnúsdóttir et al., 2017</xref>) mapped to OTUs at the species level as described in <xref ref-type="bibr" rid="bib26">Diener et al., 2020</xref>. A total of 778 MGS were retrieved from the dataset and used to build GSMNs (<xref ref-type="table" rid="table2">Table 2</xref>), whereas when using the mapping of OTUs to existing curated GSMNs, only 289 GSMNs were used. The distribution of phyla in the two cases is illustrated in <xref ref-type="fig" rid="app2fig2">Appendix 2—figure 2</xref>. We first focus on the results obtained with the MGS-based protocol.</p><p>In average, communities were composed of 108 (±29) GSMNs. The median community size was 111 (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref> - Table 20). Diversity and richness analyses are available in Appendix 2 The effect of the cohort (MHD, SWE) was strong in the analyses performed with MGS, impacting community sizes, size and composition (in families of metabolites) of the set of metabolites producible by the community, as well as the cooperation potential. Results are depicted in <xref ref-type="fig" rid="app2fig3">Appendix 2—figure 3</xref>. A classification experiment using the composition of the community scope or the composition of the cooperation potential can efficiently determine the cohort of the samples (<xref ref-type="fig" rid="app2fig3">Appendix 2—figure 3</xref> panels c and g). Similar differences between cohorts were also observed in <xref ref-type="bibr" rid="bib26">Diener et al., 2020</xref> and in <xref ref-type="bibr" rid="bib32">Forslund et al., 2015</xref> based on functional or taxonomic annotations, likely driven by the different sampling protocols used in the two datasets (<xref ref-type="bibr" rid="bib32">Forslund et al., 2015</xref>). This indicates that the commonly observed cohort effect in metagenomics is also reflected at the metabolic modelling scale, which could be explained by the observed GSMN redundancies shared within phyla.</p></sec><sec id="s2-4-2"><title>Impact of the disease status</title><p>We studied the impact of the disease status on the community metabolism for the 115 samples of the MHD cohort. The community diversity varied between disease statuses, with a significantly higher number of MGS observed in T1D individuals forming the initial communities (anova F(2,112) = 8.346, p&lt;0.01, eta-squared = 0.13, Tukey HSD test p&lt;0.01 vs control). We observe that the distribution of the community sizes is broader for control individuals. The higher diversity for diseased individuals is reflected at the metabolic level through the putative producibility of a wider set of metabolites for T1D (anova F(2,112) = 6.606, p&lt;0.01, eta-squared = 0.11, Tukey HSD p&lt;0.01 vs control) and to a lesser extent for T2D communities (Tukey HSD p=0.05 vs control). The putative producibility of some families of metabolites (alcohols, esters, carbohydrates, amino acids, acids) in the community scopes also differed between metabolic communities derived from diseased and healthy individuals (anova p&lt;0.05), whereas other metabolic families like lipids remained stable between cohorts. This can be at least partly explained by the number of metabolites matching these categories according to the Metacyc database (e.g. 191 metabolites tagged as 'All-carbohydrates’ in average in community scopes, and only 10 tagged as 'Lipids’ as the remaining of them are scattered in other categories). No clear difference appears between the three statuses (<xref ref-type="fig" rid="fig4">Figure 4e</xref>) in terms of community scope composition. Regarding the cooperation potential, two groups tend to appear, separated due to diverse secondary metabolites, but they are not driven by the disease status of the individual (<xref ref-type="fig" rid="fig4">Figure 4f</xref>). A classification experiment on the composition of the community scope can, to some extent (AUC = 0.75 ± 0.15), decipher between healthy or diabetes statuses (<xref ref-type="fig" rid="fig4">Figure 4d</xref>) but classification between T1D and T2D was not achievable (<xref ref-type="fig" rid="app2fig4">Appendix 2—figure 4</xref>). Although metagenomic data would more precisely perform such a separation, it is informative to observe that despite metabolic redundancy in the gut microbiota, there are differences at the metabolic modelling level. Qualitative differences are noticeable between healthy and diabetic individuals: it is possible to distinguish them to some extent using the set of metabolites predicted to be producible by the microorganisms found in their faeces.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Effect of the disease status on the metabolism of communities in MHD samples.</title><p>M2M was run on collections of genome-scale metabolic networks (GSMNs) associated to metagenome-assembled genomes (MAGs) identified in metagenomic samples from a cohort of healthy and diabetic individuals. Panel (<bold>a</bold>) describes the distributions of community sizes for all metagenomic samples according to the disease status: T1D: Type-1 Diabetes, T2D: Type-2 Diabetes. Panels (<bold>b</bold>) and (<bold>c</bold>) show the distribution of the community scope sizes and cooperation potential sizes respectively, according to the disease status. Panel (<bold>d</bold>) is the receiver operating curve (ROC) of an SVM classification experiment aiming at predicting the disease status for the MHD cohort (control n = 49 or diabetes n = 66) based on the community scope composition. Panel (<bold>e</bold>) illustrates the community scope composition in terms of metabolites for all samples. Disease status is indicated by the colour at the left side of each row. Panel (<bold>f</bold>) illustrates the composition of the cooperation potential according to the belonging of metabolites to Metacyc families of compounds. Disease status is indicated by the colour at the left side of each row. Panel (<bold>g</bold>) describes the taxonomic distribution at the phylum level of groups of species before and after community reduction, according to the disease status. Selection of communities was performed with the objective of making producible by the reduced communities the set of metabolites in the cooperation potential. init: initial composition of communities, KS: key species, AS: alternative symbionts, ES: essential symbionts. T1D: Type-1 Diabetes, T2D: Type-2 Diabetes.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61968-fig4-v2.tif"/></fig><p>We then computed for each sample the key species (essential and alternative symbionts) associated to the cooperation potential. The ratio of key species (KS), essential symbionts (ES) and alternative symbionts (AS) with respect to the initial community size did not vary altogether between statuses. The exception was the ratio of AS (and of KS, which include AS) when comparing diabetes individuals and controls, differences that were not significant when distinguishing the two types of diabetes. Comparing the phylum-level taxonomy of these putative key species, in the initial communities, we noted that the occurrence of Firmicutes was broader compared to other phyla (Bacteroidota, Proteobacteria, Actinobacteria). Firmicutes are known to be phylogenetically diverse (<xref ref-type="bibr" rid="bib21">Costea et al., 2018</xref>), and therefore their combined metabolism could also be more diverse. A notable change is the narrower distribution of Bacteroidota in the initial communities as well as in selected symbionts in diseased individuals compared to control (<xref ref-type="fig" rid="fig4">Figure 4g</xref>). Altogether, no clear trend was observable from metabolic modelling analyses between disease states, but we observed some difference for the taxonomic composition of minimal communities, which could be explained by the diversity discrepancies in microbiome compositions (<xref ref-type="bibr" rid="bib32">Forslund et al., 2015</xref>).</p></sec><sec id="s2-4-3"><title>Focus on short-chain fatty acids production</title><p>Given the importance of SCFAs in human health (<xref ref-type="bibr" rid="bib9">Baxter et al., 2019</xref>), we focused on the production of butyrate, propionate and acetate in communities for each sample of the dataset. A small number of MGS (N = 11) GSMNs were predicted to be able to individually produce butyrate from the nutrients. All 778 MGS were capable to ferment acetate and most of them propionate (N = 515). The putative production of butyrate in the 170 communities when allowing cooperation between GSMNs was systematic. As expected (<xref ref-type="bibr" rid="bib85">Rivière et al., 2016</xref>), a majority (54.1%) of the unique MGS predicted as possible butyrate producers in communities (GSMNs comprising a reaction producing butyrate that could be activated in a community) belonged to the Firmicutes phylum. Altogether, in 62.6% of cases, the putative butyrate producers observed in the communities were Firmicutes. We compared the number of putative butyrate producers in communities from MHD samples according to the disease status of the individuals. Their number was significantly higher in the communities of T1D individuals compared to control and T2D (anova F(2,111) = 9.27, p&lt;0.01, eta-squared = 0.14, and Tukey HSD test p&lt;0.01 vs control and p=0.02 vs T2D) which could be explained by the higher MGS diversity observed in T1D communities compared to the others. We then analysed the difference between using GSMNs of MGS reconstructed from metagenomic data and using curated GSMNs mapped at the species level to OTUs as performed in <xref ref-type="bibr" rid="bib26">Diener et al., 2020</xref>. The same increase in butyrate producers was observed when running M2M on MHD communities consisting of the mapped AGORA GSMNs (anova F(2,112) = 5.368, p&lt;0.01, eta-squared = 0.11, and Tukey HSD test p&lt;0.01 vs control). To conclude, similar to the analyses of <xref ref-type="bibr" rid="bib26">Diener et al., 2020</xref>, we observe that the producibility of SCFAs, particularly butyrate, is highly driven by cooperation in the microbial communities of individuals and can be performed by heterogenous sets of commensal species. The MGS-driven approach and the systematic GSMN reconstruction permit taking advantage of the whole metagenomic information and capturing the metabolic complementarity in each sample.</p></sec></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>M2M is a new software system for the functional analysis of metagenomic datasets at the metabolic level. M2M can be used as an all-in-one pipeline or as independent steps in order to depict an initial picture of metabolic complementarity within a community. It connects directly to metagenomics through the automation of GSMN reconstruction, and integrates in this collective analysis community reduction with respect to targeted functions. M2M was applied to a large collection of gut microbiota reference genomes, demonstrating the scalability of the methods and how it can help identifying equivalence classes among species for the producibility of metabolite families. We showed that metabolic networks reconstructed from reference genomes and MAGs display similar characteristics and that M2M modelling predictions are robust to missing genes in the original genomes. Finally, application to real metagenomic samples of individuals demonstrated that qualitative modelling of metabolism retrieves known features from metagenomics and quantitative modelling analyses. M2M provides a first order analysis with a minimal cost in terms of required data and computational effort.</p><p>The identification of cornerstone taxa in microbiota is a challenge with many applications, for instance restoring balance in dysbiotic environments. Keystone species, a concept introduced in ecology, are particularly looked for as they are key drivers of communities with respect to functions of interest (<xref ref-type="bibr" rid="bib7">Banerjee et al., 2018</xref>). There is a variety of techniques to identify them (<xref ref-type="bibr" rid="bib16">Carlström et al., 2019</xref>; <xref ref-type="bibr" rid="bib31">Floc'h et al., 2020</xref>), and computational biology has a major role in it (<xref ref-type="bibr" rid="bib30">Fisher and Mehta, 2014</xref>; <xref ref-type="bibr" rid="bib12">Berry and Widder, 2014</xref>). The identification of alternative and essential symbionts by M2M is an additional solution to help identify these critical species. In particular, essential symbionts are close to the concept of keystone species as they are predicted to have a role in every minimal community associated to a function. Additionally, alternative species and the study of their combinations in minimal communities, for example with power graphs, are also informative as they reveal equivalence groups among species.</p><p>M2M functionally analyses large collections of genomes in order to obtain metabolic insights into the metabolic complementarity between them. While the functionality of metagenomic sequences is commonly analysed at higher levels by directly computing functional profiles from reads (<xref ref-type="bibr" rid="bib34">Franzosa et al., 2018</xref>; <xref ref-type="bibr" rid="bib95">Silva et al., 2016</xref>; <xref ref-type="bibr" rid="bib94">Sharma et al., 2015</xref>; <xref ref-type="bibr" rid="bib80">Petrenko et al., 2015</xref>), the metabolic modelling oriented approach provides more in-depth predictions on reactions and pathways organisms could catalyse in given environmental conditions. M2M answers to the upscaling limitation of individual GSMN reconstruction with Pathway Tools by automating this task using the Mpwt wrapper. GSMNs in SBML format obtained from other platforms such as Kbase (<xref ref-type="bibr" rid="bib6">Arkin et al., 2018</xref>), ModelSEED (<xref ref-type="bibr" rid="bib40">Henry et al., 2010</xref>; <xref ref-type="bibr" rid="bib90">Seaver et al., 2020</xref>), or CarveMe (<xref ref-type="bibr" rid="bib58">Machado et al., 2018</xref>), can also be used as inputs to M2M for all metabolic analyses. For instance, we used highly curated models from AGORA in the application of M2M to metagenomic datasets. The above reconstruction platforms already implement solutions to facilitate the treatment of large genomic collections. There is no universal implementation for GSMN reconstruction (<xref ref-type="bibr" rid="bib66">Mendoza et al., 2019</xref>); depending on their needs (local run, external platform, curated, or non-curated GSMNs…), users can choose either method and connect it to M2M.</p><p>Most metabolic modelling methods rely on flux analyses (<xref ref-type="bibr" rid="bib75">Orth et al., 2010</xref>) solved with linear programming, which may turn out to be challenging to implement for simulations of large communities (<xref ref-type="bibr" rid="bib8">Basile et al., 2020</xref>), although recent efforts in that direction are encouraging (<xref ref-type="bibr" rid="bib81">Popp and Centler, 2020</xref>). M2M uses the network expansion algorithm and solves combinatorial optimisation problems with Answer Set Programming, thereby ensuring fast simulations and community predictions, suitable when performing systematic screening and multiple experiments. Network expansion has been widely used to analyse and refine metabolic networks (<xref ref-type="bibr" rid="bib63">Matthäus et al., 2008</xref>; <xref ref-type="bibr" rid="bib55">Laniau et al., 2017</xref>; <xref ref-type="bibr" rid="bib20">Christian et al., 2009</xref>; <xref ref-type="bibr" rid="bib83">Prigent et al., 2017</xref>), including for microbiota analysis (<xref ref-type="bibr" rid="bib19">Christian et al., 2007</xref>; <xref ref-type="bibr" rid="bib73">Ofaim et al., 2017</xref>; <xref ref-type="bibr" rid="bib74">Opatovsky et al., 2018</xref>; <xref ref-type="bibr" rid="bib35">Frioux et al., 2018</xref>). Network expansion is a complementary alternative to quantitative constraint-based methods (<xref ref-type="bibr" rid="bib27">Ebenhöh et al., 2004</xref>; <xref ref-type="bibr" rid="bib39">Handorf et al., 2005</xref>) such as flux balance analysis as it does not require biomass reactions nor accurate stoichiometry. This algorithm offers a good trade-off between the accuracy of metabolic predictions and the precision required for the input data, adapted to the challenges in studying non-model organisms and their likely incomplete models of metabolism (<xref ref-type="bibr" rid="bib11">Bernstein et al., 2019</xref>).</p><p>Answer Set Programming can easily scale the analysis of minimal communities among thousands of networks considered in interaction and ensures with efficient solving heuristics that the whole space of solutions is parsed to retrieve key species for chosen end-products. M2M therefore suggests (metagenomic) species for further analyses such as targeted curation of metabolic networks and deeper analysis of the genomes or quantitative flux predictions. The relevance of MiSCoTo (<xref ref-type="bibr" rid="bib35">Frioux et al., 2018</xref>), the algorithm for minimal community selection used in M2M, has been recently experimentally demonstrated. It was applied to design bacterial communities to support the growth of a brown alga in nearly axenic conditions (<xref ref-type="bibr" rid="bib15">Burgunter-Delamare et al., 2019</xref>). Despite the difficulty inherent to controlling the communities for a complex alga, the inoculated algae exhibited a significant increase in growth and metabolic profiles that at least partially aligned with the predictions, demonstrating the versatility in application fields of our methods.</p><p>There are limitations associated to the software solution described in this paper. One challenge in applying our tool is to accurately estimate the nutrients available in a given environment (seeds), on which the computation of network expansion relies. The algorithm provides a snapshot of producible metabolites, representing the sub-network that can be activated under given nutritional conditions. However, network expansion has been shown to be sensitive to cycles in GSMNs and it is therefore relevant to include some cofactors (or currency metabolites e.g. ADP) in the seeds to activate such cycles, the way many studies proceed (<xref ref-type="bibr" rid="bib22">Cottret et al., 2010</xref>; <xref ref-type="bibr" rid="bib38">Greenblum et al., 2012</xref>; <xref ref-type="bibr" rid="bib28">Eng and Borenstein, 2016</xref>; <xref ref-type="bibr" rid="bib49">Julien-Laferrière et al., 2016</xref>). In addition, it has to be noted that the cost of exchanges or their number are not taken into account in M2M. Transport reactions are hardly recovered by automatic methods (<xref ref-type="bibr" rid="bib11">Bernstein et al., 2019</xref>) and validation of cross-feedings implies an additional work on transporters identification. The standalone MiSCoTo package used in M2M has a solving mode taking into account exchanges: it can compute communities while minimising and suggesting metabolic exchanges, although this comes with additional computational costs and a need for validation. Another limitation of our approach for studying communities of individuals from metagenomic experiments is that we do not take the microbial load or abundance of MGS into account in the pipeline. Considering the presence/absence of MGS might lead to overestimate the production of some metabolites. In addition, we infer phenotypes directly from genotypes, thereby ignoring the possible non-expression of metabolic-related genes in specific conditions and the regulation of those genes. Metaproteomic and metatranscriptomic data could partly overcome these shortcomings but such experiments are not yet routinely performed. Finally, another aspect to be considered in the future is the competition between species, especially for nutrients, as we only focus here on metabolic complementarity and positive interactions.</p><p>Despite the above mentioned limitations, M2M has multiple applications for the de novo screening of metabolism in microbial communities. The number of curated GSMNs for species found in microbiotas increases (<xref ref-type="bibr" rid="bib59">Magnúsdóttir et al., 2017</xref>), constituting a highly valuable resource for the study of interactions by mapping metagenomic data or OTUs to the taxonomy of genomes associated to these GSMNs. Yet, the variety of (reference) genomes obtained from shotgun metagenomic experiments is such than species and strains may not belong to the ones for which a curated GSMN is available. In that case, the proportion of reads that are not mapped to a genome with an associated GSMN can be very high (<xref ref-type="bibr" rid="bib26">Diener et al., 2020</xref>). In addition, predictions from GSMN mapping can be misleading as it is known that genomes vary a lot between genera, species, and even strains, (<xref ref-type="bibr" rid="bib5">Ansorge et al., 2019</xref>) and so can the metabolism. Recent methods for assembling genomes directly from metagenomes lead to nearly complete genomes for possibly unknown species on which one may still want to get metabolic insights (<xref ref-type="bibr" rid="bib2">Almeida et al., 2019</xref>). Long-reads sequencing associated with short-reads sequencing can also give access to complete microbial genomes (<xref ref-type="bibr" rid="bib69">Moss et al., 2020</xref>). Finally, single-cell methods can be useful for the acquisition of genomes and metagenomes (<xref ref-type="bibr" rid="bib102">Treitli et al., 2019</xref>). M2M answers to the need for de novo metabolic inference and screening, which is likely to become a routine in the rapidly evolving context of microbiota genome sequencing. While studying the metabolic potential of large communities is an iterative process that still requires biological expertise, we provide with this work means to facilitate the screening of metagenomes and reduce these large communities to key members.</p><sec id="s3-1"><title>Conclusion</title><p>M2M allows metabolic modelling of large-scale communities, based on reference genomes or de novo constructed MAGs, inferring metabolic complementarity found within communities. M2M is a flexible framework that automates GSMN reconstruction, individually and collectively analyse GSMNs, and performs community selection for targeted functions. The large combinatorics of minimal communities due to functional redundancy in microbiotas is addressed by providing key species associated to metabolic end-products. This could allow targeting specific members of the community through pro- or prebiotics, to model the metabolites the human host will be exposed to.</p><p>We validated the flexibility of the software and the range of analyses it can offer with several datasets, corresponding to multiple use-cases in the microbiome field. This allowed us to characterise metabolic complementarity in a large collection of draft reference genomes. We further assessed the robustness of M2M to data incompleteness by performing analyses on collections of MAGs. Finally, we applied M2M to a common use-case in metagenomics: the study of communities associated to individuals, in a disease context.</p><p>Our method is robust against the uncertainty inherent to metagenomics data. It scales to typical microbial communities found in the gut and predicts key species for functions of interest at the metabolic level. Future developments will broaden the range of interactions to be modelled and facilitate the incorporation of abundance data. This software is an answer to the need for scalable predictive methods in the context of metagenomics where the number of available genomes continues to rise.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><p>M2M is a Python package. It can be used on a workstation or on a cluster using Docker or Singularity. M2M’s source code is available on <ext-link ext-link-type="uri" xlink:href="https://github.com/AuReMe/metage2metabo">github.com/AuReMe/metage2metabo</ext-link>, (<xref ref-type="bibr" rid="bib10">Belcour and Frioux, 2020</xref>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:fde183de545ee3701bb4ee9e25475795d371e2cb;origin=https://github.com/AuReMe/metage2metabo;visit=swh:1:snp:967aca5ba250a62ec2a931a77d065bd9ae2087a1;anchor=swh:1:rev:2cab4c79acd814eb177a370602c07599a93bc947/">swh:1:rev:2cab4c79acd814eb177a370602c07599a93bc947</ext-link>) and the package is available though the Python Package Index at <ext-link ext-link-type="uri" xlink:href="https://pypi.org/project/Metage2Metabo/">pypi.org/project/Metage2Metabo/</ext-link>. A detailed documentation is available on <ext-link ext-link-type="uri" xlink:href="https://metage2metabo.readthedocs.io">metage2metabo.readthedocs.io</ext-link>.</p><p>We detail below the characteristics of M2M through a description of its main steps.</p><sec id="s4-1"><title>Parallel and large-scale metabolic network reconstruction</title><p>M2M can process existing metabolic networks in SBML format or proposes the automatic reconstruction of non-curated metabolic networks (<monospace>m2m recon</monospace>). As a multi-processing solution, it facilitates the treatment of hundreds or thousands of genomes that can be retrieved from metagenomic experiments. The underlying GSMN reconstruction software is Pathway Tools (<xref ref-type="bibr" rid="bib51">Karp et al., 2016</xref>), a graphical user interface (GUI) based software suite for the generation of individual GSMNs, called Pathway/Genome Databases (PGDBs). Typically, a PGDB is obtained from an annotated genome using PathoLogic, the software prediction component of Pathway Tools, and curated afterwards.</p><p>We developed <ext-link ext-link-type="uri" xlink:href="https://github.com/AuReMe/mpwt">Mpwt</ext-link> (Multiprocessing Pathway Tools), a command-line Python wrapper (also available as a standalone tool) for Pathway Tools. Mpwt and M2M (i) format the genomic inputs, (ii) automate the reconstruction step by initialising a PathoLogic environment for each genome, and (iii) extract and convert the resulting GSMNs in PGDB and SBML (<xref ref-type="bibr" rid="bib43">Hucka et al., 2003</xref>; <xref ref-type="bibr" rid="bib44">Hucka et al., 2018</xref>) formats using the PADMet library (<xref ref-type="bibr" rid="bib1">Aite et al., 2018</xref>). Mpwt handles three types of genomic inputs (Genbank, Generic Feature Format (GFF) or PathoLogic format) that must contain GO-terms and EC-numbers annotations necessary for Pathway Tools. These annotations are for example found in the Genbank files generated by Prokka (<xref ref-type="bibr" rid="bib91">Seemann, 2014</xref>). In addition, we specifically developed <ext-link ext-link-type="uri" xlink:href="https://github.com/AuReMe/emapper_to_gbk">Emapper2gbk</ext-link>, a Python package dedicated to the connection between the Eggnog-mapper annotation tool (<xref ref-type="bibr" rid="bib45">Huerta-Cepas et al., 2017</xref>) and Mpwt in order to generate these inputs.</p></sec><sec id="s4-2"><title>Analysis of metabolic producibility and calculation of the cooperation potential</title><p>This part of the workflow encompasses three steps: computation of the (i) individual (<monospace>m2m iscope</monospace>) and (ii) collective (<monospace>m2m cscope</monospace>) metabolic potentials, and (iii) the characterisation of the cooperation potential of the GSMN collection (<monospace>m2m addedvalue</monospace>). The former two rely on the network expansion algorithm (<xref ref-type="bibr" rid="bib27">Ebenhöh et al., 2004</xref>), the latter being a set difference between the results of the first two steps.</p><p>The network expansion algorithm computes the <italic>scope</italic> of a metabolic network from a description of the growth medium called <italic>seeds</italic>. The scope consists in the set of metabolic compounds which are reachable, or producible, according to a boolean abstraction of the network dynamics assuming that cycles cannot be self-activated. More precisely, the algorithm recursively considers products of reactions to be producible if all reactants of the reactions are producible, provided an initiation with a set of seed nutrients. The underlying implementation of the network expansion algorithm used in M2M relies on Answer Set Programming (ASP) (<xref ref-type="bibr" rid="bib87">Schaub and Thiele, 2009</xref>).</p><p>We define a metabolic network as a bipartite graph <inline-formula><mml:math id="inf1"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mo>∪</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf2"><mml:mi>R</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf3"><mml:mi>M</mml:mi></mml:math></inline-formula> stand for reaction and metabolite nodes. When <inline-formula><mml:math id="inf4"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> (respectively <inline-formula><mml:math id="inf5"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula>), with <inline-formula><mml:math id="inf6"><mml:mrow><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf7"><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:math></inline-formula>, the metabolite is called a <italic>reactant</italic> (respectively <italic>product</italic>) of the reaction <inline-formula><mml:math id="inf8"><mml:mi>r</mml:mi></mml:math></inline-formula>. The scope of a set of seed compounds <inline-formula><mml:math id="inf9"><mml:mi>S</mml:mi></mml:math></inline-formula> according to a metabolic network <inline-formula><mml:math id="inf10"><mml:mi>G</mml:mi></mml:math></inline-formula>, denoted by <inline-formula><mml:math id="inf11"><mml:mrow><mml:mo movablelimits="false">scope</mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, is iteratively computed until it reaches a fixed point (<xref ref-type="bibr" rid="bib39">Handorf et al., 2005</xref>). It is formally defined by<disp-formula id="equ2"><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>⋃</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext> where </mml:mtext></mml:mstyle><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext> and </mml:mtext></mml:mstyle><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∪</mml:mo><mml:mrow><mml:mi mathvariant="italic">p</mml:mi><mml:mi mathvariant="italic">r</mml:mi><mml:mi mathvariant="italic">o</mml:mi><mml:mi mathvariant="italic">d</mml:mi><mml:mi mathvariant="italic">u</mml:mi><mml:mi mathvariant="italic">c</mml:mi><mml:mi mathvariant="italic">t</mml:mi><mml:mi mathvariant="italic">s</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi>R</mml:mi><mml:mo>∣</mml:mo><mml:mrow><mml:mi mathvariant="italic">r</mml:mi><mml:mi mathvariant="italic">e</mml:mi><mml:mi mathvariant="italic">a</mml:mi><mml:mi mathvariant="italic">c</mml:mi><mml:mi mathvariant="italic">t</mml:mi><mml:mi mathvariant="italic">a</mml:mi><mml:mi mathvariant="italic">n</mml:mi><mml:mi mathvariant="italic">t</mml:mi><mml:mi mathvariant="italic">s</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⊆</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><sec id="s4-2-1"><title>Individual metabolic capabilities</title><p>The <monospace>m2m iscope</monospace> command predicts the set of reachable metabolites for each GSMN using the network expansion algorithm and the given nutrients as seeds. The content of each scope is exported to a json file. A summary is also provided to the user comprising the intersection (metabolites reachable by all GSMNs) and the union of all scopes, as well as the average size of the scopes, the minimal size and the maximal size of all. This command extends core functions implemented in <ext-link ext-link-type="uri" xlink:href="https://github.com/cfrioux/MeneTools">Menetools</ext-link> for individual GSMNs, a Python package (also available as a standalone tool) that was previously used in <xref ref-type="bibr" rid="bib1">Aite et al., 2018</xref>.</p></sec><sec id="s4-2-2"><title>Collective metabolic capabilities</title><p>The <monospace>m2m cscope</monospace> command computes the metabolic capabilities of the whole microbiota by taking into account the metabolic complementarity between GSMNs. This step simulates the sharing of metabolic biosynthesis through a meta-organism composed of all GSMNs, and assesses the metabolic compounds that can be reached using network expansion. This calculation is an extension of the features of <ext-link ext-link-type="uri" xlink:href="https://github.com/cfrioux/miscoto">MiSCoTo</ext-link> (also available as a standalone tool) (<xref ref-type="bibr" rid="bib35">Frioux et al., 2018</xref>) in which the collective scope of a collection of metabolic networks <inline-formula><mml:math id="inf12"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> is introduced. We define<disp-formula id="equ3"><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mo>⋃</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>1...</mml:mn><mml:mi>n</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:munder><mml:mo>⋃</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>1...</mml:mn><mml:mi>n</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:munder><mml:mo>⋃</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>1...</mml:mn><mml:mi>n</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p></sec><sec id="s4-2-3"><title>Target producers</title><p>If metabolic compounds of interest or <italic>targets</italic> are provided by the user, a summary of the producers for each target is generated by <monospace>m2m workflow</monospace>, <monospace>m2m metacom</monospace>, and <monospace>m2m cscope</monospace>: it identifies the GSMNs that are predicted to produce the targets, either intrinsically, or through cooperation with other members of the community.</p><p>A metabolic network <inline-formula><mml:math id="inf13"><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is an <italic>individual target producer</italic> of <inline-formula><mml:math id="inf14"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> if <inline-formula><mml:math id="inf15"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo movablelimits="false">scope</mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. The metabolic network <inline-formula><mml:math id="inf16"><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is a <italic>community target producer</italic> if (<italic>a</italic>) <inline-formula><mml:math id="inf17"><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is not an individual target producer of <inline-formula><mml:math id="inf18"><mml:mi>t</mml:mi></mml:math></inline-formula> (i.e. <inline-formula><mml:math id="inf19"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∉</mml:mo><mml:mrow><mml:mo movablelimits="false">scope</mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>), but (<italic>b</italic>) <inline-formula><mml:math id="inf20"><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> contains a reaction <inline-formula><mml:math id="inf21"><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> which produces <inline-formula><mml:math id="inf22"><mml:mi>t</mml:mi></mml:math></inline-formula> (i.e. <inline-formula><mml:math id="inf23"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mi>𝑝𝑟𝑜𝑑𝑢𝑐𝑡𝑠</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>) such that (<italic>c</italic>) all reactants are producible by the community (<inline-formula><mml:math id="inf24"><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> and the other metabolic networks): <inline-formula><mml:math id="inf25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="italic">r</mml:mi><mml:mi mathvariant="italic">e</mml:mi><mml:mi mathvariant="italic">a</mml:mi><mml:mi mathvariant="italic">c</mml:mi><mml:mi mathvariant="italic">t</mml:mi><mml:mi mathvariant="italic">a</mml:mi><mml:mi mathvariant="italic">n</mml:mi><mml:mi mathvariant="italic">t</mml:mi><mml:mi mathvariant="italic">s</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⊂</mml:mo><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. This means that the metabolic network <inline-formula><mml:math id="inf26"><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> has the capability of producing <inline-formula><mml:math id="inf27"><mml:mi>t</mml:mi></mml:math></inline-formula> through the reaction <inline-formula><mml:math id="inf28"><mml:mi>r</mml:mi></mml:math></inline-formula> in a cooperation context.</p><p>This information can be retrieved in practice in the file 'producibility_targets.json’ under the keys 'individual_producers’ and 'com_only_producers’.</p></sec><sec id="s4-2-4"><title>Cooperation potential</title><p>Given individual and community metabolic potentials, the <italic>cooperation potential</italic> consists in the set of metabolites whose producibility can only occur if several organisms participate in the biosynthesis. <monospace>m2m addedvalue</monospace> computes the cooperation potential by performing a set difference between the community scope and the union of individual scopes, and produces an SBML file with the resulting metabolites. This list of compounds is inclusive and could comprise false positives not necessitating cooperation for production, but selected due to missing annotations in the initial genomes. One can modify the SBML file accordingly, prior to the following M2M community reduction step.</p><p>The cooperation potential <inline-formula><mml:math id="inf29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> of a collection of metabolic networks <inline-formula><mml:math id="inf30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is defined by<disp-formula id="equ4"><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∖</mml:mo><mml:munder><mml:mo>⋃</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>1...</mml:mn><mml:mi>n</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p></sec></sec><sec id="s4-3"><title>Computation of minimal communities and identification of key species</title><p>A minimal community <inline-formula><mml:math id="inf31"><mml:mi class="ltx_font_mathcaligraphic">𝒞</mml:mi></mml:math></inline-formula> enabling the producibility of a set of targets <inline-formula><mml:math id="inf32"><mml:mi>T</mml:mi></mml:math></inline-formula> from the seeds <inline-formula><mml:math id="inf33"><mml:mi>S</mml:mi></mml:math></inline-formula> is a sub-family of the community <inline-formula><mml:math id="inf34"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> which is solution of the following optimisation problem:<disp-formula id="equ5"><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">z</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mtext> </mml:mtext><mml:mo>⊂</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:munder></mml:mstyle></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">z</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">j</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mi>T</mml:mi><mml:mo>⊂</mml:mo><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Solutions to this optimisation problem are communities <inline-formula><mml:math id="inf35"><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">𝒞</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>G</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of minimal size. We define <inline-formula><mml:math id="inf36"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> to be the set of all such minimal communities. A first output of the <monospace>m2m mincom</monospace> command is the (minimal) size <inline-formula><mml:math id="inf37"><mml:mi>L</mml:mi></mml:math></inline-formula> of communities solution of the optimisation problem. The composition of one optimal community is also provided. The targets are by default the components of the cooperation potential, <inline-formula><mml:math id="inf38"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, but can also be a group of target metabolites defined by the user.</p><p>Many minimal communities are expected to be equivalent for a given metabolic objective but their enumeration can be computationally costly. We define <italic>key species</italic> which are organisms occurring in at least one community among all the optimal ones. Key species can be further distinguished into <italic>essential symbionts</italic> and <italic>alternative symbionts</italic>. The former occur in every minimal community whereas the latter occur only in some minimal communities. More precisely, the key species <inline-formula><mml:math id="inf39"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, the essential symbionts <inline-formula><mml:math id="inf40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, and the alternative symbionts <inline-formula><mml:math id="inf41"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> associated to a set of metabolic networks, seeds <inline-formula><mml:math id="inf42"><mml:mi>S</mml:mi></mml:math></inline-formula> and a set of target metabolites <inline-formula><mml:math id="inf43"><mml:mi>T</mml:mi></mml:math></inline-formula> are defined by<disp-formula id="equ6"><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mi>G</mml:mi><mml:mo>∣</mml:mo><mml:mi mathvariant="normal">∃</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="script">𝒞</mml:mi></mml:mrow></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>G</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="script">𝒞</mml:mi></mml:mrow></mml:mrow><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mi>G</mml:mi><mml:mo>∣</mml:mo><mml:mi mathvariant="normal">∀</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="script">𝒞</mml:mi></mml:mrow></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>G</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="script">𝒞</mml:mi></mml:mrow></mml:mrow><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∖</mml:mo><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>As a strategy layer over MiSCoTo, M2M relies on the Clasp solver (<xref ref-type="bibr" rid="bib37">Gebser et al., 2012</xref>) for efficient resolution of the underlying grounded ASP instances. Although this type of decision problem is NP-hard (<xref ref-type="bibr" rid="bib49">Julien-Laferrière et al., 2016</xref>), as with many real-world optimisation problems worst-case asymptomatic complexity is less informative for applications than practical performance using heuristic methods. The Clasp solver implements a robust collection of heuristics (<xref ref-type="bibr" rid="bib36">Gebser et al., 2007</xref>; <xref ref-type="bibr" rid="bib4">Andres et al., 2012</xref>) for core-guided weighted MaxSAT (<xref ref-type="bibr" rid="bib60">Manquinho et al., 2009</xref>; <xref ref-type="bibr" rid="bib68">Morgado et al., 2012</xref>) that provide rapid set-based solutions to combinatorial optimisation problems, much in the same way that heuristic solvers like CPlex provide rapid numerical solutions to mixed integer programming optimisation problems. The kinds of ASP instances constructed by MiSCoTo for M2M are solved in a matter of minutes for the identification of key species and essential/alternative symbionts. Indeed the space of solutions is efficiently sampled using adequate projection modes in ASP, which enables the computation of these groups of species without the need for a full enumeration.</p><sec id="s4-3-1"><title>Analysis of enumerated communities</title><p>The <monospace>m2m_analysis</monospace> command permits the enumeration of minimal communities. If the taxonomy of species associated to the metabolic networks is provided, descriptive statistics are performed. In addition, minimal communities can be visualised as an association graph connecting GSMNs that co-occur in at least one minimal community. The association graph can itself be compressed in a power graph that enables visualising motifs such as cliques, bicliques and stars. Power graphs are generated using PowerGrASP (<xref ref-type="bibr" rid="bib13">Bourneuf and Nicolas, 2017</xref>). In this paper, they were visualised with Cytoscape (v.2.8.3) (<xref ref-type="bibr" rid="bib93">Shannon et al., 2003</xref>) and the CyOog plugin (v.2.8.2) developed by <xref ref-type="bibr" rid="bib86">Royer et al., 2008</xref>.</p></sec></sec><sec id="s4-4"><title>Application to datasets</title><sec id="s4-4-1"><title>Analysis of human gut and cow rumen published collections of genomes</title><p>In order to evaluate the influence of genome collections based on sequencing cultured isolates or metagenomic genome reconstructions, we used 1,520 high-quality draft reference genomes of bacteria from the human gut microbiota retrieved from <xref ref-type="bibr" rid="bib109">Zou et al., 2019</xref> and 913 MAGs from the cow rumen published in <xref ref-type="bibr" rid="bib98">Stewart et al., 2018</xref>. The genomes from the former set were already annotated.</p><p>We designed a set of seed metabolites representing a nutritional environment which is required for the metabolic modelling analyses. Seeds (93 metabolites) consist in components of a classical diet for the gut microbiota, EU average from the VMH resource (<xref ref-type="bibr" rid="bib72">Noronha et al., 2019</xref>), and a small number of currency metabolites (<xref ref-type="bibr" rid="bib89">Schilling et al., 2000</xref>; <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref> - Table 1 and <ext-link ext-link-type="uri" xlink:href="https://github.com/AuReMe/metage2metabo/tree/master/article_data">Github repository</ext-link> of M2M). M2M was run using version 23.0 of Pathway Tools.</p><p>The cow rumen dataset of MAGs was not functionally annotated. Therefore, as a preliminary step of analysis, we annotated the genomic contigs using Prokka (v.1.13.4) (<xref ref-type="bibr" rid="bib91">Seemann, 2014</xref>). M2M was run using version 23.0 of Pathway Tools. The nutritional environment for modelling experiments consisted in basic nutrients: 26 metabolites including inorganic compounds, carbon dioxide, glucose, and cellobiose and a small number of currency metabolites (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref> - Table 2).</p><p>The rumen MAGs were artificially degraded to assess the robustness of M2M with respect to incomplete MAGs. This was done by randomly removing genes in all or a fraction of genomes. Four degradation scenarios were tested: removal of 2% of genes in all MAGs, removal of 5% of genes in 80% of the genomes, removal of 5% of genes in all genomes and removal of 10% of genes in 70% of the genomes. The subsequent parts of the analysis (annotation with Prokka, M2M runs) were done as described above. Supervenn diagrams presented in <xref ref-type="fig" rid="fig2">Figure 2</xref> to compare the results were obtained using the <ext-link ext-link-type="uri" xlink:href="https://github.com/gecko984/supervenn">Supervenn Python package</ext-link> (<xref ref-type="bibr" rid="bib29">Fedor, 2021</xref>).</p></sec><sec id="s4-4-2"><title>Shotgun metagenomic analysis of individuals</title><p>Metagenomic shotgun data from samples previously studied in <xref ref-type="bibr" rid="bib26">Diener et al., 2020</xref> from 186 Danish and Swedish individuals (<xref ref-type="bibr" rid="bib32">Forslund et al., 2015</xref>) were used in this paper. Genomes were de novo reconstructed from the dataset using the MATAFILER pipeline described in <xref ref-type="bibr" rid="bib42">Hildebrand et al., 2019</xref>. Briefly, metagenomic samples were quality-filtered using sdm (<xref ref-type="bibr" rid="bib41">Hildebrand et al., 2014</xref>), assembled using MEGAHIT (<xref ref-type="bibr" rid="bib57">Li et al., 2015</xref>), genes were predicted using Prodigal (<xref ref-type="bibr" rid="bib47">Hyatt et al., 2010</xref>), and a non-redundant gene catalogue was constructed across all samples using MMseqs2 (<xref ref-type="bibr" rid="bib97">Steinegger and Söding, 2017</xref>). MAGs were predicted from metagenomic assemblies using MetaBAT2 (<xref ref-type="bibr" rid="bib50">Kang et al., 2019</xref>) and dereplicated into species level metagenomic species (MGS), using a combination of shared genes among MetaBAT2 bins, canopy clustering (<xref ref-type="bibr" rid="bib71">Nielsen et al., 2014</xref>) and custom R scripts (<xref ref-type="bibr" rid="bib42">Hildebrand et al., 2019</xref>). Abundance of MGS was estimated across samples by using the average coverage of 40 conserved, single copy marker genes associated to each MGS (<xref ref-type="bibr" rid="bib64">Mende et al., 2013</xref>). This abundance matrix was further populated with specI species from the proGenomes database (<xref ref-type="bibr" rid="bib65">Mende et al., 2020</xref>), that were not represented by MGS and are high-quality genomes from cultured bacteria. This pipeline is described in further detail in <xref ref-type="bibr" rid="bib42">Hildebrand et al., 2019</xref>.</p><p>Samples for which the global estimated abundance of MGS was lower than 1000 in accumulated coverage of all species were removed. This corresponds to a low number of reads passing the upstream quality checks for these samples (&lt;9.10e6). 170 samples were kept for analysis. The initial bacterial community of each sample was determined using the estimated abundance matrix provided by the MATAFILER pipeline, following a boolean rule of presence/absence of MGS and specI species in samples. Genomes consisted in MGS obtained with MATAFILER as well as SpecI genomes from the Progenomes database (<xref ref-type="bibr" rid="bib65">Mende et al., 2020</xref>) that were identified in the samples. For the latter case, we downloaded the genes and proteins of the corresponding representative genome from the database (SpecI v3). Functional annotation of genes from both specI genomes and MGS core genomes was performed using EggNOG-mapper v2.0.0 (<xref ref-type="bibr" rid="bib45">Huerta-Cepas et al., 2017</xref>) based on eggNOG orthology data (<xref ref-type="bibr" rid="bib46">Huerta-Cepas et al., 2019</xref>). Sequence searches were performed using Diamond v0.9.24.125 (<xref ref-type="bibr" rid="bib14">Buchfink et al., 2015</xref>). Treatment of EggNOG-mapper annotation and creation of M2M Genbank inputs was done with the package <ext-link ext-link-type="uri" xlink:href="https://github.com/AuReMe/emapper_to_gbk">Emapper2gbk</ext-link> that we developed for the project. Seeds describing the nutritional environment were compounds of the western diet as presented in the study by <xref ref-type="bibr" rid="bib26">Diener et al., 2020</xref>. These metabolites were translated into identifiers from the Metacyc database (<xref ref-type="bibr" rid="bib17">Caspi et al., 2020</xref>), to which were added a small number of currency metabolites. The seeds are available on the <ext-link ext-link-type="uri" xlink:href="https://github.com/AuReMe/metage2metabo/tree/master/article_data">Github repository</ext-link> of M2M.</p><p>M2M was run for each sample and community selection was performed with different sets of targets (SCFAs, cooperation potential in each community). The cohort and disease status of each sample was known, enabling the comparison of scopes and cooperation potentials contents between statuses. M2M was also run using the approach presented in MICOM (<xref ref-type="bibr" rid="bib26">Diener et al., 2020</xref>) building sample communities, as presented in the paper and associated data repository, through the attribution of curated GSMN (<xref ref-type="bibr" rid="bib59">Magnúsdóttir et al., 2017</xref>) to operational taxonomic units (OTUs) identified in samples. We reused the mapping at species-level provided in the MICOM paper to build the communities.</p><p>Downstream analyses were performed in R (<xref ref-type="bibr" rid="bib84">R Development Core Team, 2017</xref>) and Python. Figures were produced using the package ggplot2 (<xref ref-type="bibr" rid="bib106">Wickham, 2009</xref>) and diversity measures were computed with the vegan R package (v2.5–6). Classifications of disease statuses or cohorts using sets of predicted producible metabolites were made using the Python package Scikit-learn (v0.23.1) (<xref ref-type="bibr" rid="bib78">Pedregosa et al., 2011</xref>). Briefly, redundancy between features were removed with a Multidimensional scaling (MDS), Support Vector Machine (SVM) classifications with Stratified K-Folds cross-validations were performed using the MDS results. Finally, receiver operating characteristic curve (ROC-AUC) were computed and visualised with tools from the package.</p></sec></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>The authors acknowledge the <ext-link ext-link-type="uri" xlink:href="https://www.genouest.org">GenOuest bioinformatics core facility</ext-link> for providing the computing infrastructure. This research was supported in part by the NBI Computing infrastructure for Science (CiS) group. FH and CF’s salaries have been funded by the BBSRC Institute Strategic Programme Gut Microbes and Health BB/r012490/1, its constituent project BBS/e/F/000Pr10355. AB’s, CF,and MA’s salaries have been funded by the ANR project IDEALG (ANR-10-BTBR-04) 'Investissements d'Avenir, Biotechnologies-Bioressources'. The authors acknowledge P Karp, S Paley, M Krummenacker, R Billington, A Kothari from the Bioinformatics Research Group of SRI International for their help regarding Pathway Tools. The authors also thank Lucas Bourneuf for his help on power graph analyses, Yann Le Cunff for his help regarding statistical analyses, and Samuel Blanquart and David Sherman for their useful comments on the manuscript.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Validation, Investigation, Visualization, Methodology, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Data curation, Software, Supervision, Validation, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Software</p></fn><fn fn-type="con" id="con4"><p>Software</p></fn><fn fn-type="con" id="con5"><p>Resources, Data curation, Software, Validation, Writing - review and editing</p></fn><fn fn-type="con" id="con6"><p>Conceptualization, Supervision, Funding acquisition, Writing - review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Supplementary tables 1 to 25.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-61968-supp1-v2.xlsx"/></supplementary-material><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-61968-transrepform-v2.pdf"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>Source code and data related to this article are available in <ext-link ext-link-type="uri" xlink:href="https://github.com/AuReMe/metage2metabo/tree/master/article_data">https://github.com/AuReMe/metage2metabo/tree/master/article_data</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:rev:2cab4c79acd814eb177a370602c07599a93bc947/">https://archive.softwareheritage.org/swh:1:rev:2cab4c79acd814eb177a370602c07599a93bc947/</ext-link>).</p><p>The following previously published datasets were used:</p><p><element-citation id="dataset1" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Zou</surname><given-names>Y</given-names></name><name><surname>Xue</surname><given-names>W</given-names></name><name><surname>Luo</surname><given-names>G</given-names></name><name><surname>Deng</surname><given-names>Z</given-names></name><name><surname>Qin</surname><given-names>P</given-names></name><name><surname>Guo</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>Genome Sequencing and Assembly for Cultivated Species of the Human Gut Microbiota</data-title><source>NCBI BioProject</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA482748">PRJNA482748</pub-id></element-citation></p><p><element-citation id="dataset2" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Stewart</surname><given-names>RD</given-names></name><name><surname>Auffret</surname><given-names>MD</given-names></name><name><surname>Warr</surname><given-names>A</given-names></name><name><surname>Wiser</surname><given-names>AH</given-names></name><name><surname>Press</surname><given-names>MO</given-names></name><name><surname>Langford</surname><given-names>KW</given-names></name></person-group><year iso-8601-date="2017">2017</year><data-title>Metagenomic sequencing of the rumen of Scottish cattle</data-title><source>NCBI BioProject</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJEB21624">PRJEB21624</pub-id></element-citation></p><p><element-citation id="dataset3" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Karlsson</surname><given-names>FH</given-names></name><name><surname>Tremaroli</surname><given-names>V</given-names></name><name><surname>Nookaew</surname><given-names>I</given-names></name><name><surname>Bergström</surname><given-names>G</given-names></name><name><surname>Behre</surname><given-names>CJ</given-names></name><name><surname>Fagerberg</surname><given-names>B</given-names></name><name><surname>Nielsen</surname><given-names>J</given-names></name><name><surname>Bäckhed</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2013">2013</year><data-title>Gut metagenome in European women with normal, impaired and diabetic glucose control</data-title><source>European Nucleotide Archive</source><pub-id assigning-authority="other" pub-id-type="accession" xlink:href="https://www.ebi.ac.uk/ena/browser/view/PRJEB1786">PRJEB1786</pub-id></element-citation></p><p><element-citation id="dataset4" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Li</surname><given-names>J</given-names></name><name><surname>Jia</surname><given-names>H</given-names></name><name><surname>Cai</surname><given-names>X</given-names></name><name><surname>Zhong</surname><given-names>H</given-names></name><name><surname>Feng</surname><given-names>Q</given-names></name><name><surname>Sunagawa</surname><given-names>S</given-names></name><name><surname>Arumugam</surname><given-names>M</given-names></name><name><surname>Kultima</surname><given-names>JR</given-names></name><name><surname>Prifti</surname><given-names>E</given-names></name><name><surname>Nielsen</surname><given-names>T</given-names></name><name><surname>Juncker</surname><given-names>AS</given-names></name><name><surname>Manichanh</surname><given-names>C</given-names></name><name><surname>Chen</surname><given-names>B</given-names></name><name><surname>Zhang</surname><given-names>W</given-names></name><name><surname>Levenez</surname><given-names>F</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Xu</surname><given-names>X</given-names></name><name><surname>Xiao</surname><given-names>L</given-names></name><name><surname>Liang</surname><given-names>S</given-names></name><name><surname>Zhang</surname><given-names>D</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Chen</surname><given-names>W</given-names></name><name><surname>Zhao</surname><given-names>H</given-names></name><name><surname>Al-Aama</surname><given-names>JY</given-names></name><name><surname>Edris</surname><given-names>S</given-names></name><name><surname>Yang</surname><given-names>H</given-names></name><name><surname>Hansen</surname><given-names>T</given-names></name><name><surname>Nielsen</surname><given-names>HB</given-names></name><name><surname>Brunak</surname><given-names>S</given-names></name><name><surname>Kristiansen</surname><given-names>K</given-names></name><name><surname>Guarner</surname><given-names>F</given-names></name><name><surname>Pedersen</surname><given-names>O</given-names></name><name><surname>Doré</surname><given-names>J</given-names></name><name><surname>Ehrlich</surname><given-names>SD</given-names></name><collab>MetaHIT Consortium</collab><name><surname>Bork</surname><given-names>P</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2013">2013</year><data-title>Gut metagenome in European women with normal, impaired and diabetic glucose control</data-title><source>European Nucleotide Archive</source><pub-id assigning-authority="other" pub-id-type="accession" xlink:href="https://www.ebi.ac.uk/ena/browser/view/PRJEB5224">PRJEB5224</pub-id></element-citation></p><p><element-citation id="dataset5" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Le Chatelier</surname><given-names>E</given-names></name><name><surname>Nielsen</surname><given-names>T</given-names></name><name><surname>Qin</surname><given-names>J</given-names></name><name><surname>Prifti</surname><given-names>E</given-names></name><name><surname>Hildebrand</surname><given-names>F</given-names></name><name><surname>Falony</surname><given-names>G</given-names></name><name><surname>Almeida</surname><given-names>M</given-names></name><name><surname>Arumugam</surname><given-names>M</given-names></name><name><surname>Batto</surname><given-names>JM</given-names></name><name><surname>Kennedy</surname><given-names>S</given-names></name><name><surname>Leonard</surname><given-names>P</given-names></name><name><surname>Li</surname><given-names>J</given-names></name><name><surname>Burgdorf</surname><given-names>K</given-names></name><name><surname>Grarup</surname><given-names>N</given-names></name><name><surname>Jørgensen</surname><given-names>T</given-names></name><name><surname>Brandslund</surname><given-names>I</given-names></name><name><surname>Nielsen</surname><given-names>HB</given-names></name><name><surname>Juncker</surname><given-names>AS</given-names></name><name><surname>Bertalan</surname><given-names>M</given-names></name><name><surname>Levenez</surname><given-names>F</given-names></name><name><surname>Pons</surname><given-names>N</given-names></name><name><surname>Rasmussen</surname><given-names>S</given-names></name><name><surname>Sunagawa</surname><given-names>S</given-names></name><name><surname>Tap</surname><given-names>J</given-names></name><name><surname>Tims</surname><given-names>S</given-names></name><name><surname>Zoetendal</surname><given-names>EG</given-names></name><name><surname>Brunak</surname><given-names>S</given-names></name><name><surname>Clément</surname><given-names>K</given-names></name><name><surname>Doré</surname><given-names>J</given-names></name><name><surname>Kleerebezem</surname><given-names>M</given-names></name><name><surname>Kristiansen</surname><given-names>K</given-names></name><name><surname>Renault</surname><given-names>P</given-names></name><name><surname>Sicheritz-Ponten</surname><given-names>T</given-names></name><name><surname>de Vos</surname><given-names>WM</given-names></name><name><surname>Zucker</surname><given-names>JD</given-names></name><name><surname>Raes</surname><given-names>J</given-names></name><name><surname>Hansen</surname><given-names>T</given-names></name><collab>MetaHIT consortium</collab><name><surname>Bork</surname><given-names>P</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Ehrlich</surname><given-names>SD</given-names></name><name><surname>Pedersen</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2013">2013</year><data-title>Richness of human gut microbiome correlates with metabolic markers</data-title><source>European Nucleotide Archive</source><pub-id assigning-authority="other" pub-id-type="accession" xlink:href="https://www.ebi.ac.uk/ena/browser/view/PRJEB4336">PRJEB4336</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aite</surname> <given-names>M</given-names></name><name><surname>Chevallier</surname> <given-names>M</given-names></name><name><surname>Frioux</surname> <given-names>C</given-names></name><name><surname>Trottier</surname> <given-names>C</given-names></name><name><surname>Got</surname> <given-names>J</given-names></name><name><surname>Cortés</surname> <given-names>MP</given-names></name><name><surname>Mendoza</surname> <given-names>SN</given-names></name><name><surname>Carrier</surname> <given-names>G</given-names></name><name><surname>Dameron</surname> <given-names>O</given-names></name><name><surname>Guillaudeux</surname> <given-names>N</given-names></name><name><surname>Latorre</surname> <given-names>M</given-names></name><name><surname>Loira</surname> <given-names>N</given-names></name><name><surname>Markov</surname> <given-names>GV</given-names></name><name><surname>Maass</surname> <given-names>A</given-names></name><name><surname>Siegel</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Traceability, reproducibility and wiki-exploration for &quot;à-la-carte&quot; reconstructions of genome-scale metabolic models</article-title><source>PLOS Computational Biology</source><volume>14</volume><elocation-id>e1006146</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006146</pub-id><pub-id pub-id-type="pmid">29791443</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Almeida</surname> <given-names>A</given-names></name><name><surname>Mitchell</surname> <given-names>AL</given-names></name><name><surname>Boland</surname> <given-names>M</given-names></name><name><surname>Forster</surname> <given-names>SC</given-names></name><name><surname>Gloor</surname> <given-names>GB</given-names></name><name><surname>Tarkowska</surname> <given-names>A</given-names></name><name><surname>Lawley</surname> <given-names>TD</given-names></name><name><surname>Finn</surname> <given-names>RD</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>A new genomic blueprint of the human gut microbiota</article-title><source>Nature</source><volume>568</volume><fpage>499</fpage><lpage>504</lpage><pub-id pub-id-type="doi">10.1038/s41586-019-0965-1</pub-id><pub-id pub-id-type="pmid">30745586</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Almeida</surname> <given-names>A</given-names></name><name><surname>Nayfach</surname> <given-names>S</given-names></name><name><surname>Boland</surname> <given-names>M</given-names></name><name><surname>Strozzi</surname> <given-names>F</given-names></name><name><surname>Beracochea</surname> <given-names>M</given-names></name><name><surname>Shi</surname> <given-names>ZJ</given-names></name><name><surname>Pollard</surname> <given-names>KS</given-names></name><name><surname>Sakharova</surname> <given-names>E</given-names></name><name><surname>Parks</surname> <given-names>DH</given-names></name><name><surname>Hugenholtz</surname> <given-names>P</given-names></name><name><surname>Segata</surname> <given-names>N</given-names></name><name><surname>Kyrpides</surname> <given-names>NC</given-names></name><name><surname>Finn</surname> <given-names>RD</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>A unified catalog of 204,938 reference genomes from the human gut microbiome</article-title><source>Nature Biotechnology</source><volume>1</volume><elocation-id>3</elocation-id><pub-id pub-id-type="doi">10.1038/s41587-020-0603-3</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Andres</surname> <given-names>B</given-names></name><name><surname>Kaufmann</surname> <given-names>B</given-names></name><name><surname>Matheis</surname> <given-names>O</given-names></name><name><surname>Schaub</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Unsatisfiability-based optimization in clasp Schloss Dagstuhl–Leibniz-Zentrum fuer Informatik , volume 17 of Leibniz International Proceedings in Informatics (LIPIcs)</article-title><conf-name>Schloss Dagstuhl–Leibniz-Zentrum Fuer Informatik Technical Communications of the 28th International Conference on Logic Programming (ICLP’12)</conf-name><fpage>211</fpage><lpage>221</lpage></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ansorge</surname> <given-names>R</given-names></name><name><surname>Romano</surname> <given-names>S</given-names></name><name><surname>Sayavedra</surname> <given-names>L</given-names></name><name><surname>Porras</surname> <given-names>MÁG</given-names></name><name><surname>Kupczok</surname> <given-names>A</given-names></name><name><surname>Tegetmeyer</surname> <given-names>HE</given-names></name><name><surname>Dubilier</surname> <given-names>N</given-names></name><name><surname>Petersen</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Functional diversity enables multiple symbiont strains to coexist in deep-sea mussels</article-title><source>Nature Microbiology</source><volume>4</volume><fpage>2487</fpage><lpage>2497</lpage><pub-id pub-id-type="doi">10.1038/s41564-019-0572-9</pub-id><pub-id pub-id-type="pmid">31611646</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arkin</surname> <given-names>AP</given-names></name><name><surname>Cottingham</surname> <given-names>RW</given-names></name><name><surname>Henry</surname> <given-names>CS</given-names></name><name><surname>Harris</surname> <given-names>NL</given-names></name><name><surname>Stevens</surname> <given-names>RL</given-names></name><name><surname>Maslov</surname> <given-names>S</given-names></name><name><surname>Dehal</surname> <given-names>P</given-names></name><name><surname>Ware</surname> <given-names>D</given-names></name><name><surname>Perez</surname> <given-names>F</given-names></name><name><surname>Canon</surname> <given-names>S</given-names></name><name><surname>Sneddon</surname> <given-names>MW</given-names></name><name><surname>Henderson</surname> <given-names>ML</given-names></name><name><surname>Riehl</surname> <given-names>WJ</given-names></name><name><surname>Murphy-Olson</surname> <given-names>D</given-names></name><name><surname>Chan</surname> <given-names>SY</given-names></name><name><surname>Kamimura</surname> <given-names>RT</given-names></name><name><surname>Kumari</surname> <given-names>S</given-names></name><name><surname>Drake</surname> <given-names>MM</given-names></name><name><surname>Brettin</surname> <given-names>TS</given-names></name><name><surname>Glass</surname> <given-names>EM</given-names></name><name><surname>Chivian</surname> <given-names>D</given-names></name><name><surname>Gunter</surname> <given-names>D</given-names></name><name><surname>Weston</surname> <given-names>DJ</given-names></name><name><surname>Allen</surname> <given-names>BH</given-names></name><name><surname>Baumohl</surname> <given-names>J</given-names></name><name><surname>Best</surname> <given-names>AA</given-names></name><name><surname>Bowen</surname> <given-names>B</given-names></name><name><surname>Brenner</surname> <given-names>SE</given-names></name><name><surname>Bun</surname> <given-names>CC</given-names></name><name><surname>Chandonia</surname> <given-names>JM</given-names></name><name><surname>Chia</surname> <given-names>JM</given-names></name><name><surname>Colasanti</surname> <given-names>R</given-names></name><name><surname>Conrad</surname> <given-names>N</given-names></name><name><surname>Davis</surname> <given-names>JJ</given-names></name><name><surname>Davison</surname> <given-names>BH</given-names></name><name><surname>DeJongh</surname> <given-names>M</given-names></name><name><surname>Devoid</surname> <given-names>S</given-names></name><name><surname>Dietrich</surname> <given-names>E</given-names></name><name><surname>Dubchak</surname> <given-names>I</given-names></name><name><surname>Edirisinghe</surname> <given-names>JN</given-names></name><name><surname>Fang</surname> <given-names>G</given-names></name><name><surname>Faria</surname> <given-names>JP</given-names></name><name><surname>Frybarger</surname> <given-names>PM</given-names></name><name><surname>Gerlach</surname> <given-names>W</given-names></name><name><surname>Gerstein</surname> <given-names>M</given-names></name><name><surname>Greiner</surname> <given-names>A</given-names></name><name><surname>Gurtowski</surname> <given-names>J</given-names></name><name><surname>Haun</surname> <given-names>HL</given-names></name><name><surname>He</surname> <given-names>F</given-names></name><name><surname>Jain</surname> <given-names>R</given-names></name><name><surname>Joachimiak</surname> <given-names>MP</given-names></name><name><surname>Keegan</surname> <given-names>KP</given-names></name><name><surname>Kondo</surname> <given-names>S</given-names></name><name><surname>Kumar</surname> <given-names>V</given-names></name><name><surname>Land</surname> <given-names>ML</given-names></name><name><surname>Meyer</surname> <given-names>F</given-names></name><name><surname>Mills</surname> <given-names>M</given-names></name><name><surname>Novichkov</surname> <given-names>PS</given-names></name><name><surname>Oh</surname> <given-names>T</given-names></name><name><surname>Olsen</surname> <given-names>GJ</given-names></name><name><surname>Olson</surname> <given-names>R</given-names></name><name><surname>Parrello</surname> <given-names>B</given-names></name><name><surname>Pasternak</surname> <given-names>S</given-names></name><name><surname>Pearson</surname> <given-names>E</given-names></name><name><surname>Poon</surname> <given-names>SS</given-names></name><name><surname>Price</surname> <given-names>GA</given-names></name><name><surname>Ramakrishnan</surname> <given-names>S</given-names></name><name><surname>Ranjan</surname> <given-names>P</given-names></name><name><surname>Ronald</surname> <given-names>PC</given-names></name><name><surname>Schatz</surname> <given-names>MC</given-names></name><name><surname>Seaver</surname> <given-names>SMD</given-names></name><name><surname>Shukla</surname> <given-names>M</given-names></name><name><surname>Sutormin</surname> <given-names>RA</given-names></name><name><surname>Syed</surname> <given-names>MH</given-names></name><name><surname>Thomason</surname> <given-names>J</given-names></name><name><surname>Tintle</surname> <given-names>NL</given-names></name><name><surname>Wang</surname> <given-names>D</given-names></name><name><surname>Xia</surname> <given-names>F</given-names></name><name><surname>Yoo</surname> <given-names>H</given-names></name><name><surname>Yoo</surname> <given-names>S</given-names></name><name><surname>Yu</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>KBase: the united states department of energy systems biology knowledgebase</article-title><source>Nature Biotechnology</source><volume>36</volume><fpage>566</fpage><lpage>569</lpage><pub-id pub-id-type="doi">10.1038/nbt.4163</pub-id><pub-id pub-id-type="pmid">29979655</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Banerjee</surname> <given-names>S</given-names></name><name><surname>Schlaeppi</surname> <given-names>K</given-names></name><name><surname>van der Heijden</surname> <given-names>MGA</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Keystone taxa as drivers of microbiome structure and functioning</article-title><source>Nature Reviews Microbiology</source><volume>16</volume><fpage>567</fpage><lpage>576</lpage><pub-id pub-id-type="doi">10.1038/s41579-018-0024-1</pub-id><pub-id pub-id-type="pmid">29789680</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Basile</surname> <given-names>A</given-names></name><name><surname>Campanaro</surname> <given-names>S</given-names></name><name><surname>Kovalovszki</surname> <given-names>A</given-names></name><name><surname>Zampieri</surname> <given-names>G</given-names></name><name><surname>Rossi</surname> <given-names>A</given-names></name><name><surname>Angelidaki</surname> <given-names>I</given-names></name><name><surname>Valle</surname> <given-names>G</given-names></name><name><surname>Treu</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Revealing metabolic mechanisms of interaction in the anaerobic digestion microbiome by flux balance analysis</article-title><source>Metabolic Engineering</source><volume>62</volume><fpage>138</fpage><lpage>149</lpage><pub-id pub-id-type="doi">10.1016/j.ymben.2020.08.013</pub-id><pub-id pub-id-type="pmid">32905861</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baxter</surname> <given-names>NT</given-names></name><name><surname>Schmidt</surname> <given-names>AW</given-names></name><name><surname>Venkataraman</surname> <given-names>A</given-names></name><name><surname>Kim</surname> <given-names>KS</given-names></name><name><surname>Waldron</surname> <given-names>C</given-names></name><name><surname>Schmidt</surname> <given-names>TM</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Dynamics of human gut Microbiota and Short-Chain fatty acids in response to dietary interventions with three fermentable fibers</article-title><source>mBio</source><volume>10</volume><elocation-id>e02566-18</elocation-id><pub-id pub-id-type="doi">10.1128/mBio.02566-18</pub-id><pub-id pub-id-type="pmid">30696735</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Belcour</surname> <given-names>A</given-names></name><name><surname>Frioux</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>M2M - metage2metabo</data-title><source>Software Heritage</source><version designator="swh:1:rev:2cab4c79acd814eb177a370602c07599a93bc947">swh:1:rev:2cab4c79acd814eb177a370602c07599a93bc947</version><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:fde183de545ee3701bb4ee9e25475795d371e2cb;origin=https://github.com/AuReMe/metage2metabo;visit=swh:1:snp:967aca5ba250a62ec2a931a77d065bd9ae2087a1;anchor=swh:1:rev:2cab4c79acd814eb177a370602c07599a93bc947/">https://archive.softwareheritage.org/swh:1:dir:fde183de545ee3701bb4ee9e25475795d371e2cb;origin=https://github.com/AuReMe/metage2metabo;visit=swh:1:snp:967aca5ba250a62ec2a931a77d065bd9ae2087a1;anchor=swh:1:rev:2cab4c79acd814eb177a370602c07599a93bc947/</ext-link></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bernstein</surname> <given-names>DB</given-names></name><name><surname>Dewhirst</surname> <given-names>FE</given-names></name><name><surname>Segrè</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Metabolic network percolation quantifies biosynthetic capabilities across the human oral microbiome</article-title><source>eLife</source><volume>8</volume><elocation-id>e39733</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.39733</pub-id><pub-id pub-id-type="pmid">31194675</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berry</surname> <given-names>D</given-names></name><name><surname>Widder</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Deciphering microbial interactions and detecting keystone species with co-occurrence networks</article-title><source>Frontiers in Microbiology</source><volume>5</volume><elocation-id>219</elocation-id><pub-id pub-id-type="doi">10.3389/fmicb.2014.00219</pub-id><pub-id pub-id-type="pmid">24904535</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bourneuf</surname> <given-names>L</given-names></name><name><surname>Nicolas</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2017">2017</year><chapter-title>FCA in a Logical Programming Setting for Visualization-Oriented Graph Compression</chapter-title><person-group person-group-type="editor"><name><surname>Bertet</surname> <given-names>K</given-names></name><name><surname>Borchmann</surname> <given-names>D</given-names></name><name><surname>Cellier</surname> <given-names>P</given-names></name><name><surname>Ferré</surname> <given-names>S</given-names></name></person-group><source>ICFCA 2017: Formal Concept Analysis</source><publisher-name>Springer</publisher-name><fpage>89</fpage><lpage>105</lpage><pub-id pub-id-type="doi">10.1007/978-3-319-59271-8_6</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buchfink</surname> <given-names>B</given-names></name><name><surname>Xie</surname> <given-names>C</given-names></name><name><surname>Huson</surname> <given-names>DH</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Fast and sensitive protein alignment using DIAMOND</article-title><source>Nature Methods</source><volume>12</volume><fpage>59</fpage><lpage>60</lpage><pub-id pub-id-type="doi">10.1038/nmeth.3176</pub-id><pub-id pub-id-type="pmid">25402007</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Burgunter-Delamare</surname> <given-names>B</given-names></name><name><surname>KleinJan</surname> <given-names>H</given-names></name><name><surname>Frioux</surname> <given-names>C</given-names></name><name><surname>Fremy</surname> <given-names>E</given-names></name><name><surname>Wagner</surname> <given-names>M</given-names></name><name><surname>Corre</surname> <given-names>E</given-names></name><name><surname>Salver</surname> <given-names>AL</given-names></name><name><surname>Leroux</surname> <given-names>C</given-names></name><name><surname>Leblanc</surname> <given-names>C</given-names></name><name><surname>Boyen</surname> <given-names>C</given-names></name><name><surname>Siegel</surname> <given-names>A</given-names></name><name><surname>Dittami</surname> <given-names>SM</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Metabolic complementarity between a Brown alga and associated cultivable Bacteria provide indications of beneficial interactions</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/813683</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carlström</surname> <given-names>CI</given-names></name><name><surname>Field</surname> <given-names>CM</given-names></name><name><surname>Bortfeld-Miller</surname> <given-names>M</given-names></name><name><surname>Müller</surname> <given-names>B</given-names></name><name><surname>Sunagawa</surname> <given-names>S</given-names></name><name><surname>Vorholt</surname> <given-names>JA</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Synthetic microbiota reveal priority effects and keystone strains in the Arabidopsis phyllosphere</article-title><source>Nature Ecology &amp; Evolution</source><volume>3</volume><fpage>1445</fpage><lpage>1454</lpage><pub-id pub-id-type="doi">10.1038/s41559-019-0994-z</pub-id><pub-id pub-id-type="pmid">31558832</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Caspi</surname> <given-names>R</given-names></name><name><surname>Billington</surname> <given-names>R</given-names></name><name><surname>Keseler</surname> <given-names>IM</given-names></name><name><surname>Kothari</surname> <given-names>A</given-names></name><name><surname>Krummenacker</surname> <given-names>M</given-names></name><name><surname>Midford</surname> <given-names>PE</given-names></name><name><surname>Ong</surname> <given-names>WK</given-names></name><name><surname>Paley</surname> <given-names>S</given-names></name><name><surname>Subhraveti</surname> <given-names>P</given-names></name><name><surname>Karp</surname> <given-names>PD</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>The MetaCyc database of metabolic pathways and enzymes - a 2019 update</article-title><source>Nucleic Acids Research</source><volume>48</volume><fpage>D445</fpage><lpage>D453</lpage><pub-id pub-id-type="doi">10.1093/nar/gkz862</pub-id><pub-id pub-id-type="pmid">31586394</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chan</surname> <given-names>SHJ</given-names></name><name><surname>Simons</surname> <given-names>MN</given-names></name><name><surname>Maranas</surname> <given-names>CD</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>SteadyCom: predicting microbial abundances while ensuring community stability</article-title><source>PLOS Computational Biology</source><volume>13</volume><elocation-id>e1005539</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005539</pub-id><pub-id pub-id-type="pmid">28505184</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Christian</surname> <given-names>N</given-names></name><name><surname>Handorf</surname> <given-names>T</given-names></name><name><surname>Ebenhöh</surname> <given-names>O</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Metabolic synergy: increasing biosynthetic capabilities by network cooperation</article-title><conf-name>Genome Informatics. International Conference on Genome Informatics</conf-name><fpage>320</fpage><lpage>329</lpage></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Christian</surname> <given-names>N</given-names></name><name><surname>May</surname> <given-names>P</given-names></name><name><surname>Kempa</surname> <given-names>S</given-names></name><name><surname>Handorf</surname> <given-names>T</given-names></name><name><surname>Ebenhöh</surname> <given-names>O</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>An integrative approach towards completing genome-scale metabolic networks</article-title><source>Molecular BioSystems</source><volume>5</volume><fpage>1889</fpage><lpage>1903</lpage><pub-id pub-id-type="doi">10.1039/b915913b</pub-id><pub-id pub-id-type="pmid">19763335</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Costea</surname> <given-names>PI</given-names></name><name><surname>Hildebrand</surname> <given-names>F</given-names></name><name><surname>Arumugam</surname> <given-names>M</given-names></name><name><surname>Bäckhed</surname> <given-names>F</given-names></name><name><surname>Blaser</surname> <given-names>MJ</given-names></name><name><surname>Bushman</surname> <given-names>FD</given-names></name><name><surname>de Vos</surname> <given-names>WM</given-names></name><name><surname>Ehrlich</surname> <given-names>SD</given-names></name><name><surname>Fraser</surname> <given-names>CM</given-names></name><name><surname>Hattori</surname> <given-names>M</given-names></name><name><surname>Huttenhower</surname> <given-names>C</given-names></name><name><surname>Jeffery</surname> <given-names>IB</given-names></name><name><surname>Knights</surname> <given-names>D</given-names></name><name><surname>Lewis</surname> <given-names>JD</given-names></name><name><surname>Ley</surname> <given-names>RE</given-names></name><name><surname>Ochman</surname> <given-names>H</given-names></name><name><surname>O'Toole</surname> <given-names>PW</given-names></name><name><surname>Quince</surname> <given-names>C</given-names></name><name><surname>Relman</surname> <given-names>DA</given-names></name><name><surname>Shanahan</surname> <given-names>F</given-names></name><name><surname>Sunagawa</surname> <given-names>S</given-names></name><name><surname>Wang</surname> <given-names>J</given-names></name><name><surname>Weinstock</surname> <given-names>GM</given-names></name><name><surname>Wu</surname> <given-names>GD</given-names></name><name><surname>Zeller</surname> <given-names>G</given-names></name><name><surname>Zhao</surname> <given-names>L</given-names></name><name><surname>Raes</surname> <given-names>J</given-names></name><name><surname>Knight</surname> <given-names>R</given-names></name><name><surname>Bork</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Enterotypes in the landscape of gut microbial community composition</article-title><source>Nature Microbiology</source><volume>3</volume><fpage>8</fpage><lpage>16</lpage><pub-id pub-id-type="doi">10.1038/s41564-017-0072-8</pub-id><pub-id pub-id-type="pmid">29255284</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cottret</surname> <given-names>L</given-names></name><name><surname>Milreu</surname> <given-names>PV</given-names></name><name><surname>Acuña</surname> <given-names>V</given-names></name><name><surname>Marchetti-Spaccamela</surname> <given-names>A</given-names></name><name><surname>Stougie</surname> <given-names>L</given-names></name><name><surname>Charles</surname> <given-names>H</given-names></name><name><surname>Sagot</surname> <given-names>MF</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Graph-based analysis of the metabolic exchanges between two co-resident intracellular symbionts, Baumannia cicadellinicola and Sulcia muelleri, with their insect host, Homalodisca coagulata</article-title><source>PLOS Computational Biology</source><volume>6</volume><elocation-id>e1000904</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000904</pub-id><pub-id pub-id-type="pmid">20838465</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Coyte</surname> <given-names>KZ</given-names></name><name><surname>Rakoff-Nahoum</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Understanding competition and cooperation within the Mammalian Gut Microbiome</article-title><source>Current Biology</source><volume>29</volume><fpage>R538</fpage><lpage>R544</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2019.04.017</pub-id><pub-id pub-id-type="pmid">31163167</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cutting</surname> <given-names>SM</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Bacillus probiotics</article-title><source>Food Microbiology</source><volume>28</volume><fpage>214</fpage><lpage>220</lpage><pub-id pub-id-type="doi">10.1016/j.fm.2010.03.007</pub-id><pub-id pub-id-type="pmid">21315976</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Vries</surname> <given-names>MC</given-names></name><name><surname>Vaughan</surname> <given-names>EE</given-names></name><name><surname>Kleerebezem</surname> <given-names>M</given-names></name><name><surname>de Vos</surname> <given-names>WM</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Lactobacillus plantarum—survival, functional and potential probiotic properties in the human intestinal tract</article-title><source>International Dairy Journal</source><volume>16</volume><fpage>1018</fpage><lpage>1028</lpage><pub-id pub-id-type="doi">10.1016/j.idairyj.2005.09.003</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Diener</surname> <given-names>C</given-names></name><name><surname>Gibbons</surname> <given-names>SM</given-names></name><name><surname>Resendis-Antonio</surname> <given-names>O</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>MICOM: metagenome-scale modeling to infer metabolic interactions in the gut Microbiota</article-title><source>mSystems</source><volume>5</volume><elocation-id>e00606-19</elocation-id><pub-id pub-id-type="doi">10.1128/mSystems.00606-19</pub-id><pub-id pub-id-type="pmid">31964767</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Ebenhöh</surname> <given-names>O</given-names></name><name><surname>Handorf</surname> <given-names>T</given-names></name><name><surname>Heinrich</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Structural analysis of expanding metabolic networks</article-title><conf-name>Genome Informatics. International Conference on Genome Informatics</conf-name><fpage>35</fpage><lpage>45</lpage></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eng</surname> <given-names>A</given-names></name><name><surname>Borenstein</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>An algorithm for designing minimal microbial communities with desired metabolic capacities</article-title><source>Bioinformatics</source><volume>32</volume><fpage>2008</fpage><lpage>2016</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btw107</pub-id><pub-id pub-id-type="pmid">27153571</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Fedor</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>gecko984/supervenn: Fontsize applies to side plots as well</data-title><source>Zenodo</source><version designator="0.3.2">v0.3.2</version><ext-link ext-link-type="uri" xlink:href="http://doi.org/10.5281/zenodo.4424381">http://doi.org/10.5281/zenodo.4424381</ext-link></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fisher</surname> <given-names>CK</given-names></name><name><surname>Mehta</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Identifying keystone species in the human gut microbiome from metagenomic timeseries using sparse linear regression</article-title><source>PLOS ONE</source><volume>9</volume><elocation-id>e102451</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0102451</pub-id><pub-id pub-id-type="pmid">25054627</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Floc'h</surname> <given-names>JB</given-names></name><name><surname>Hamel</surname> <given-names>C</given-names></name><name><surname>Harker</surname> <given-names>KN</given-names></name><name><surname>St-Arnaud</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Fungal communities of the canola rhizosphere: keystone species and substantial Between-Year variation of the rhizosphere microbiome</article-title><source>Microbial Ecology</source><volume>80</volume><fpage>762</fpage><lpage>777</lpage><pub-id pub-id-type="doi">10.1007/s00248-019-01475-8</pub-id><pub-id pub-id-type="pmid">31897569</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Forslund</surname> <given-names>K</given-names></name><name><surname>Hildebrand</surname> <given-names>F</given-names></name><name><surname>Nielsen</surname> <given-names>T</given-names></name><name><surname>Falony</surname> <given-names>G</given-names></name><name><surname>Le Chatelier</surname> <given-names>E</given-names></name><name><surname>Sunagawa</surname> <given-names>S</given-names></name><name><surname>Prifti</surname> <given-names>E</given-names></name><name><surname>Vieira-Silva</surname> <given-names>S</given-names></name><name><surname>Gudmundsdottir</surname> <given-names>V</given-names></name><name><surname>Pedersen</surname> <given-names>HK</given-names></name><name><surname>Arumugam</surname> <given-names>M</given-names></name><name><surname>Kristiansen</surname> <given-names>K</given-names></name><name><surname>Voigt</surname> <given-names>AY</given-names></name><name><surname>Vestergaard</surname> <given-names>H</given-names></name><name><surname>Hercog</surname> <given-names>R</given-names></name><name><surname>Costea</surname> <given-names>PI</given-names></name><name><surname>Kultima</surname> <given-names>JR</given-names></name><name><surname>Li</surname> <given-names>J</given-names></name><name><surname>Jørgensen</surname> <given-names>T</given-names></name><name><surname>Levenez</surname> <given-names>F</given-names></name><name><surname>Dore</surname> <given-names>J</given-names></name><name><surname>Nielsen</surname> <given-names>HB</given-names></name><name><surname>Brunak</surname> <given-names>S</given-names></name><name><surname>Raes</surname> <given-names>J</given-names></name><name><surname>Hansen</surname> <given-names>T</given-names></name><name><surname>Wang</surname> <given-names>J</given-names></name><name><surname>Ehrlich</surname> <given-names>SD</given-names></name><name><surname>Bork</surname> <given-names>P</given-names></name><name><surname>Pedersen</surname> <given-names>O</given-names></name><collab>MetaHIT consortium</collab></person-group><year iso-8601-date="2015">2015</year><article-title>Disentangling type 2 diabetes and metformin treatment signatures in the human gut Microbiota</article-title><source>Nature</source><volume>528</volume><fpage>262</fpage><lpage>266</lpage><pub-id pub-id-type="doi">10.1038/nature15766</pub-id><pub-id pub-id-type="pmid">26633628</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Forster</surname> <given-names>SC</given-names></name><name><surname>Kumar</surname> <given-names>N</given-names></name><name><surname>Anonye</surname> <given-names>BO</given-names></name><name><surname>Almeida</surname> <given-names>A</given-names></name><name><surname>Viciani</surname> <given-names>E</given-names></name><name><surname>Stares</surname> <given-names>MD</given-names></name><name><surname>Dunn</surname> <given-names>M</given-names></name><name><surname>Mkandawire</surname> <given-names>TT</given-names></name><name><surname>Zhu</surname> <given-names>A</given-names></name><name><surname>Shao</surname> <given-names>Y</given-names></name><name><surname>Pike</surname> <given-names>LJ</given-names></name><name><surname>Louie</surname> <given-names>T</given-names></name><name><surname>Browne</surname> <given-names>HP</given-names></name><name><surname>Mitchell</surname> <given-names>AL</given-names></name><name><surname>Neville</surname> <given-names>BA</given-names></name><name><surname>Finn</surname> <given-names>RD</given-names></name><name><surname>Lawley</surname> <given-names>TD</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>A human gut bacterial genome and culture collection for improved metagenomic analyses</article-title><source>Nature Biotechnology</source><volume>37</volume><fpage>186</fpage><lpage>192</lpage><pub-id pub-id-type="doi">10.1038/s41587-018-0009-7</pub-id><pub-id pub-id-type="pmid">30718869</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Franzosa</surname> <given-names>EA</given-names></name><name><surname>McIver</surname> <given-names>LJ</given-names></name><name><surname>Rahnavard</surname> <given-names>G</given-names></name><name><surname>Thompson</surname> <given-names>LR</given-names></name><name><surname>Schirmer</surname> <given-names>M</given-names></name><name><surname>Weingart</surname> <given-names>G</given-names></name><name><surname>Lipson</surname> <given-names>KS</given-names></name><name><surname>Knight</surname> <given-names>R</given-names></name><name><surname>Caporaso</surname> <given-names>JG</given-names></name><name><surname>Segata</surname> <given-names>N</given-names></name><name><surname>Huttenhower</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Species-level functional profiling of metagenomes and metatranscriptomes</article-title><source>Nature Methods</source><volume>15</volume><fpage>962</fpage><lpage>968</lpage><pub-id pub-id-type="doi">10.1038/s41592-018-0176-y</pub-id><pub-id pub-id-type="pmid">30377376</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frioux</surname> <given-names>C</given-names></name><name><surname>Fremy</surname> <given-names>E</given-names></name><name><surname>Trottier</surname> <given-names>C</given-names></name><name><surname>Siegel</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Scalable and exhaustive screening of metabolic functions carried out by microbial consortia</article-title><source>Bioinformatics</source><volume>34</volume><fpage>i934</fpage><lpage>i943</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bty588</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Gebser</surname> <given-names>M</given-names></name><name><surname>Kaufmann</surname> <given-names>B</given-names></name><name><surname>Neumann</surname> <given-names>A</given-names></name><name><surname>Schaub</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Conflict-driven answer set solving</article-title><conf-name>Proceedings of the 20th International Joint Conference on Artifical Intelligence</conf-name><fpage>386</fpage><lpage>392</lpage></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gebser</surname> <given-names>M</given-names></name><name><surname>Kaminski</surname> <given-names>R</given-names></name><name><surname>Kaufmann</surname> <given-names>B</given-names></name><name><surname>Schaub</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Answer Set Solving in Practice</article-title><source>Synthesis Lectures on Artificial Intelligence and Machine Learning</source><volume>6</volume><fpage>1</fpage><lpage>238</lpage><pub-id pub-id-type="doi">10.2200/S00457ED1V01Y201211AIM019</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greenblum</surname> <given-names>S</given-names></name><name><surname>Turnbaugh</surname> <given-names>PJ</given-names></name><name><surname>Borenstein</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Metagenomic systems biology of the human gut microbiome reveals topological shifts associated with obesity and inflammatory bowel disease</article-title><source>PNAS</source><volume>109</volume><fpage>594</fpage><lpage>599</lpage><pub-id pub-id-type="doi">10.1073/pnas.1116053109</pub-id><pub-id pub-id-type="pmid">22184244</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Handorf</surname> <given-names>T</given-names></name><name><surname>Ebenhöh</surname> <given-names>O</given-names></name><name><surname>Heinrich</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Expanding metabolic networks: scopes of compounds, robustness, and evolution</article-title><source>Journal of Molecular Evolution</source><volume>61</volume><fpage>498</fpage><lpage>512</lpage><pub-id pub-id-type="doi">10.1007/s00239-005-0027-1</pub-id><pub-id pub-id-type="pmid">16155745</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Henry</surname> <given-names>CS</given-names></name><name><surname>DeJongh</surname> <given-names>M</given-names></name><name><surname>Best</surname> <given-names>AA</given-names></name><name><surname>Frybarger</surname> <given-names>PM</given-names></name><name><surname>Linsay</surname> <given-names>B</given-names></name><name><surname>Stevens</surname> <given-names>RL</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>High-throughput generation, optimization and analysis of genome-scale metabolic models</article-title><source>Nature Biotechnology</source><volume>28</volume><fpage>977</fpage><lpage>982</lpage><pub-id pub-id-type="doi">10.1038/nbt.1672</pub-id><pub-id pub-id-type="pmid">20802497</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hildebrand</surname> <given-names>F</given-names></name><name><surname>Tadeo</surname> <given-names>R</given-names></name><name><surname>Voigt</surname> <given-names>AY</given-names></name><name><surname>Bork</surname> <given-names>P</given-names></name><name><surname>Raes</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>LotuS: an efficient and user-friendly OTU processing pipeline</article-title><source>Microbiome</source><volume>2</volume><elocation-id>30</elocation-id><pub-id pub-id-type="doi">10.1186/2049-2618-2-30</pub-id><pub-id pub-id-type="pmid">27367037</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hildebrand</surname> <given-names>F</given-names></name><name><surname>Moitinho-Silva</surname> <given-names>L</given-names></name><name><surname>Blasche</surname> <given-names>S</given-names></name><name><surname>Jahn</surname> <given-names>MT</given-names></name><name><surname>Gossmann</surname> <given-names>TI</given-names></name><name><surname>Huerta-Cepas</surname> <given-names>J</given-names></name><name><surname>Hercog</surname> <given-names>R</given-names></name><name><surname>Luetge</surname> <given-names>M</given-names></name><name><surname>Bahram</surname> <given-names>M</given-names></name><name><surname>Pryszlak</surname> <given-names>A</given-names></name><name><surname>Alves</surname> <given-names>RJ</given-names></name><name><surname>Waszak</surname> <given-names>SM</given-names></name><name><surname>Zhu</surname> <given-names>A</given-names></name><name><surname>Ye</surname> <given-names>L</given-names></name><name><surname>Costea</surname> <given-names>PI</given-names></name><name><surname>Aalvink</surname> <given-names>S</given-names></name><name><surname>Belzer</surname> <given-names>C</given-names></name><name><surname>Forslund</surname> <given-names>SK</given-names></name><name><surname>Sunagawa</surname> <given-names>S</given-names></name><name><surname>Hentschel</surname> <given-names>U</given-names></name><name><surname>Merten</surname> <given-names>C</given-names></name><name><surname>Patil</surname> <given-names>KR</given-names></name><name><surname>Benes</surname> <given-names>V</given-names></name><name><surname>Bork</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Antibiotics-induced monodominance of a novel gut bacterial order</article-title><source>Gut</source><volume>68</volume><fpage>1781</fpage><lpage>1790</lpage><pub-id pub-id-type="doi">10.1136/gutjnl-2018-317715</pub-id><pub-id pub-id-type="pmid">30658995</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hucka</surname> <given-names>M</given-names></name><name><surname>Finney</surname> <given-names>A</given-names></name><name><surname>Sauro</surname> <given-names>HM</given-names></name><name><surname>Bolouri</surname> <given-names>H</given-names></name><name><surname>Doyle</surname> <given-names>JC</given-names></name><name><surname>Kitano</surname> <given-names>H</given-names></name><name><surname>Arkin</surname> <given-names>AP</given-names></name><name><surname>Bornstein</surname> <given-names>BJ</given-names></name><name><surname>Bray</surname> <given-names>D</given-names></name><name><surname>Cornish-Bowden</surname> <given-names>A</given-names></name><name><surname>Cuellar</surname> <given-names>AA</given-names></name><name><surname>Dronov</surname> <given-names>S</given-names></name><name><surname>Gilles</surname> <given-names>ED</given-names></name><name><surname>Ginkel</surname> <given-names>M</given-names></name><name><surname>Gor</surname> <given-names>V</given-names></name><name><surname>Goryanin</surname> <given-names>II</given-names></name><name><surname>Hedley</surname> <given-names>WJ</given-names></name><name><surname>Hodgman</surname> <given-names>TC</given-names></name><name><surname>Hofmeyr</surname> <given-names>JH</given-names></name><name><surname>Hunter</surname> <given-names>PJ</given-names></name><name><surname>Juty</surname> <given-names>NS</given-names></name><name><surname>Kasberger</surname> <given-names>JL</given-names></name><name><surname>Kremling</surname> <given-names>A</given-names></name><name><surname>Kummer</surname> <given-names>U</given-names></name><name><surname>Le Novère</surname> <given-names>N</given-names></name><name><surname>Loew</surname> <given-names>LM</given-names></name><name><surname>Lucio</surname> <given-names>D</given-names></name><name><surname>Mendes</surname> <given-names>P</given-names></name><name><surname>Minch</surname> <given-names>E</given-names></name><name><surname>Mjolsness</surname> <given-names>ED</given-names></name><name><surname>Nakayama</surname> <given-names>Y</given-names></name><name><surname>Nelson</surname> <given-names>MR</given-names></name><name><surname>Nielsen</surname> <given-names>PF</given-names></name><name><surname>Sakurada</surname> <given-names>T</given-names></name><name><surname>Schaff</surname> <given-names>JC</given-names></name><name><surname>Shapiro</surname> <given-names>BE</given-names></name><name><surname>Shimizu</surname> <given-names>TS</given-names></name><name><surname>Spence</surname> <given-names>HD</given-names></name><name><surname>Stelling</surname> <given-names>J</given-names></name><name><surname>Takahashi</surname> <given-names>K</given-names></name><name><surname>Tomita</surname> <given-names>M</given-names></name><name><surname>Wagner</surname> <given-names>J</given-names></name><name><surname>Wang</surname> <given-names>J</given-names></name><collab>SBML Forum</collab></person-group><year iso-8601-date="2003">2003</year><article-title>The systems biology markup language (SBML): a medium for representation and exchange of biochemical network models</article-title><source>Bioinformatics</source><volume>19</volume><fpage>524</fpage><lpage>531</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btg015</pub-id><pub-id pub-id-type="pmid">12611808</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hucka</surname> <given-names>M</given-names></name><name><surname>Bergmann</surname> <given-names>FT</given-names></name><name><surname>Dräger</surname> <given-names>A</given-names></name><name><surname>Hoops</surname> <given-names>S</given-names></name><name><surname>Keating</surname> <given-names>SM</given-names></name><name><surname>Le Novère</surname> <given-names>N</given-names></name><name><surname>Myers</surname> <given-names>CJ</given-names></name><name><surname>Olivier</surname> <given-names>BG</given-names></name><name><surname>Sahle</surname> <given-names>S</given-names></name><name><surname>Schaff</surname> <given-names>JC</given-names></name><name><surname>Smith</surname> <given-names>LP</given-names></name><name><surname>Waltemath</surname> <given-names>D</given-names></name><name><surname>Wilkinson</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>The systems biology markup Language (SBML): Language specification for level 3 version 2 core</article-title><source>Journal of Integrative Bioinformatics</source><volume>15</volume><elocation-id>20170081</elocation-id><pub-id pub-id-type="doi">10.1515/jib-2017-0081</pub-id><pub-id pub-id-type="pmid">29522418</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huerta-Cepas</surname> <given-names>J</given-names></name><name><surname>Forslund</surname> <given-names>K</given-names></name><name><surname>Coelho</surname> <given-names>LP</given-names></name><name><surname>Szklarczyk</surname> <given-names>D</given-names></name><name><surname>Jensen</surname> <given-names>LJ</given-names></name><name><surname>von Mering</surname> <given-names>C</given-names></name><name><surname>Bork</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Fast Genome-Wide functional annotation through orthology assignment by eggNOG-Mapper</article-title><source>Molecular Biology and Evolution</source><volume>34</volume><fpage>2115</fpage><lpage>2122</lpage><pub-id pub-id-type="doi">10.1093/molbev/msx148</pub-id><pub-id pub-id-type="pmid">28460117</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huerta-Cepas</surname> <given-names>J</given-names></name><name><surname>Szklarczyk</surname> <given-names>D</given-names></name><name><surname>Heller</surname> <given-names>D</given-names></name><name><surname>Hernández-Plaza</surname> <given-names>A</given-names></name><name><surname>Forslund</surname> <given-names>SK</given-names></name><name><surname>Cook</surname> <given-names>H</given-names></name><name><surname>Mende</surname> <given-names>DR</given-names></name><name><surname>Letunic</surname> <given-names>I</given-names></name><name><surname>Rattei</surname> <given-names>T</given-names></name><name><surname>Jensen</surname> <given-names>LJ</given-names></name><name><surname>von Mering</surname> <given-names>C</given-names></name><name><surname>Bork</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>eggNOG 5.0: a hierarchical, functionally and phylogenetically annotated orthology resource based on 5090 organisms and 2502 viruses</article-title><source>Nucleic Acids Research</source><volume>47</volume><fpage>D309</fpage><lpage>D314</lpage><pub-id pub-id-type="doi">10.1093/nar/gky1085</pub-id><pub-id pub-id-type="pmid">30418610</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hyatt</surname> <given-names>D</given-names></name><name><surname>Chen</surname> <given-names>GL</given-names></name><name><surname>Locascio</surname> <given-names>PF</given-names></name><name><surname>Land</surname> <given-names>ML</given-names></name><name><surname>Larimer</surname> <given-names>FW</given-names></name><name><surname>Hauser</surname> <given-names>LJ</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Prodigal: prokaryotic gene recognition and translation initiation site identification</article-title><source>BMC Bioinformatics</source><volume>11</volume><elocation-id>119</elocation-id><pub-id pub-id-type="doi">10.1186/1471-2105-11-119</pub-id><pub-id pub-id-type="pmid">20211023</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><collab>Integrative HMP (iHMP) Research Network Consortium</collab></person-group><year iso-8601-date="2014">2014</year><article-title>The integrative human microbiome project: dynamic analysis of microbiome-host omics profiles during periods of human health and disease</article-title><source>Cell Host &amp; Microbe</source><volume>16</volume><fpage>276</fpage><lpage>289</lpage><pub-id pub-id-type="doi">10.1016/j.chom.2014.08.014</pub-id><pub-id pub-id-type="pmid">25211071</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Julien-Laferrière</surname> <given-names>A</given-names></name><name><surname>Bulteau</surname> <given-names>L</given-names></name><name><surname>Parrot</surname> <given-names>D</given-names></name><name><surname>Marchetti-Spaccamela</surname> <given-names>A</given-names></name><name><surname>Stougie</surname> <given-names>L</given-names></name><name><surname>Vinga</surname> <given-names>S</given-names></name><name><surname>Mary</surname> <given-names>A</given-names></name><name><surname>Sagot</surname> <given-names>MF</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>A combinatorial algorithm for microbial consortia synthetic design</article-title><source>Scientific Reports</source><volume>6</volume><elocation-id>29182</elocation-id><pub-id pub-id-type="doi">10.1038/srep29182</pub-id><pub-id pub-id-type="pmid">27373593</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kang</surname> <given-names>DD</given-names></name><name><surname>Li</surname> <given-names>F</given-names></name><name><surname>Kirton</surname> <given-names>E</given-names></name><name><surname>Thomas</surname> <given-names>A</given-names></name><name><surname>Egan</surname> <given-names>R</given-names></name><name><surname>An</surname> <given-names>H</given-names></name><name><surname>Wang</surname> <given-names>Z</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>MetaBAT 2: an adaptive binning algorithm for robust and efficient genome reconstruction from metagenome assemblies</article-title><source>PeerJ</source><volume>7</volume><elocation-id>e7359</elocation-id><pub-id pub-id-type="doi">10.7717/peerj.7359</pub-id><pub-id pub-id-type="pmid">31388474</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karp</surname> <given-names>PD</given-names></name><name><surname>Latendresse</surname> <given-names>M</given-names></name><name><surname>Paley</surname> <given-names>SM</given-names></name><name><surname>Krummenacker</surname> <given-names>M</given-names></name><name><surname>Ong</surname> <given-names>QD</given-names></name><name><surname>Billington</surname> <given-names>R</given-names></name><name><surname>Kothari</surname> <given-names>A</given-names></name><name><surname>Weaver</surname> <given-names>D</given-names></name><name><surname>Lee</surname> <given-names>T</given-names></name><name><surname>Subhraveti</surname> <given-names>P</given-names></name><name><surname>Spaulding</surname> <given-names>A</given-names></name><name><surname>Fulcher</surname> <given-names>C</given-names></name><name><surname>Keseler</surname> <given-names>IM</given-names></name><name><surname>Caspi</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Pathway tools version 19.0 update: software for pathway/genome informatics and systems biology</article-title><source>Briefings in Bioinformatics</source><volume>17</volume><fpage>877</fpage><lpage>890</lpage><pub-id pub-id-type="doi">10.1093/bib/bbv079</pub-id><pub-id pub-id-type="pmid">26454094</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khandelwal</surname> <given-names>RA</given-names></name><name><surname>Olivier</surname> <given-names>BG</given-names></name><name><surname>Röling</surname> <given-names>WF</given-names></name><name><surname>Teusink</surname> <given-names>B</given-names></name><name><surname>Bruggeman</surname> <given-names>FJ</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Community flux balance analysis for microbial consortia at balanced growth</article-title><source>PLOS ONE</source><volume>8</volume><elocation-id>e64567</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0064567</pub-id><pub-id pub-id-type="pmid">23741341</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Kruse</surname> <given-names>K</given-names></name><name><surname>Ebenhöh</surname> <given-names>O</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Comparing flux balance analysis to network expansion: producibility, sustainability and the scope of compounds</article-title><conf-name>Genome Informatics. International Conference on Genome Informatics</conf-name></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kumar</surname> <given-names>M</given-names></name><name><surname>Ji</surname> <given-names>B</given-names></name><name><surname>Zengler</surname> <given-names>K</given-names></name><name><surname>Nielsen</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Modelling approaches for studying the microbiome</article-title><source>Nature Microbiology</source><volume>4</volume><fpage>1253</fpage><lpage>1267</lpage><pub-id pub-id-type="doi">10.1038/s41564-019-0491-9</pub-id><pub-id pub-id-type="pmid">31337891</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laniau</surname> <given-names>J</given-names></name><name><surname>Frioux</surname> <given-names>C</given-names></name><name><surname>Nicolas</surname> <given-names>J</given-names></name><name><surname>Baroukh</surname> <given-names>C</given-names></name><name><surname>Cortes</surname> <given-names>MP</given-names></name><name><surname>Got</surname> <given-names>J</given-names></name><name><surname>Trottier</surname> <given-names>C</given-names></name><name><surname>Eveillard</surname> <given-names>D</given-names></name><name><surname>Siegel</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Combining graph and flux-based structures to decipher phenotypic essential metabolites within metabolic networks</article-title><source>PeerJ</source><volume>5</volume><elocation-id>e3860</elocation-id><pub-id pub-id-type="doi">10.7717/peerj.3860</pub-id><pub-id pub-id-type="pmid">29038751</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levy</surname> <given-names>R</given-names></name><name><surname>Carr</surname> <given-names>R</given-names></name><name><surname>Kreimer</surname> <given-names>A</given-names></name><name><surname>Freilich</surname> <given-names>S</given-names></name><name><surname>Borenstein</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>NetCooperate: a network-based tool for inferring host-microbe and microbe-microbe cooperation</article-title><source>BMC Bioinformatics</source><volume>16</volume><elocation-id>164</elocation-id><pub-id pub-id-type="doi">10.1186/s12859-015-0588-y</pub-id><pub-id pub-id-type="pmid">25980407</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname> <given-names>D</given-names></name><name><surname>Liu</surname> <given-names>CM</given-names></name><name><surname>Luo</surname> <given-names>R</given-names></name><name><surname>Sadakane</surname> <given-names>K</given-names></name><name><surname>Lam</surname> <given-names>TW</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>MEGAHIT: an ultra-fast single-node solution for large and complex metagenomics assembly via succinct de bruijn graph</article-title><source>Bioinformatics</source><volume>31</volume><fpage>1674</fpage><lpage>1676</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btv033</pub-id><pub-id pub-id-type="pmid">25609793</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Machado</surname> <given-names>D</given-names></name><name><surname>Andrejev</surname> <given-names>S</given-names></name><name><surname>Tramontano</surname> <given-names>M</given-names></name><name><surname>Patil</surname> <given-names>KR</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Fast automated reconstruction of genome-scale metabolic models for microbial species and communities</article-title><source>Nucleic Acids Research</source><volume>46</volume><fpage>7542</fpage><lpage>7553</lpage><pub-id pub-id-type="doi">10.1093/nar/gky537</pub-id><pub-id pub-id-type="pmid">30192979</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Magnúsdóttir</surname> <given-names>S</given-names></name><name><surname>Heinken</surname> <given-names>A</given-names></name><name><surname>Kutt</surname> <given-names>L</given-names></name><name><surname>Ravcheev</surname> <given-names>DA</given-names></name><name><surname>Bauer</surname> <given-names>E</given-names></name><name><surname>Noronha</surname> <given-names>A</given-names></name><name><surname>Greenhalgh</surname> <given-names>K</given-names></name><name><surname>Jäger</surname> <given-names>C</given-names></name><name><surname>Baginska</surname> <given-names>J</given-names></name><name><surname>Wilmes</surname> <given-names>P</given-names></name><name><surname>Fleming</surname> <given-names>RM</given-names></name><name><surname>Thiele</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Generation of genome-scale metabolic reconstructions for 773 members of the human gut Microbiota</article-title><source>Nature Biotechnology</source><volume>35</volume><fpage>81</fpage><lpage>89</lpage><pub-id pub-id-type="doi">10.1038/nbt.3703</pub-id><pub-id pub-id-type="pmid">27893703</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Manquinho</surname> <given-names>V</given-names></name><name><surname>Marques-Silva</surname> <given-names>J</given-names></name><name><surname>Planes</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2009">2009</year><chapter-title>Algorithms for weighted boolean optimization</chapter-title><person-group person-group-type="editor"><name><surname>Kullmann</surname> <given-names>O</given-names></name></person-group><source>Theory and Applications of Satisfiability Testing - SAT 2009</source><publisher-loc>Berlin, Heidelberg</publisher-loc><publisher-name>Springer Berlin Heidelberg</publisher-name><fpage>pages 495</fpage><lpage>508</lpage></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Manzoor</surname> <given-names>SE</given-names></name><name><surname>McNulty</surname> <given-names>CAM</given-names></name><name><surname>Nakiboneka-Ssenabulya</surname> <given-names>D</given-names></name><name><surname>Lecky</surname> <given-names>DM</given-names></name><name><surname>Hardy</surname> <given-names>KJ</given-names></name><name><surname>Hawkey</surname> <given-names>PM</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Investigation of community carriage rates of Clostridium difficile and Hungatella hathewayi in healthy volunteers from four regions of England</article-title><source>Journal of Hospital Infection</source><volume>97</volume><fpage>153</fpage><lpage>155</lpage><pub-id pub-id-type="doi">10.1016/j.jhin.2017.05.014</pub-id><pub-id pub-id-type="pmid">28549779</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marco</surname> <given-names>ML</given-names></name><name><surname>de Vries</surname> <given-names>MC</given-names></name><name><surname>Wels</surname> <given-names>M</given-names></name><name><surname>Molenaar</surname> <given-names>D</given-names></name><name><surname>Mangell</surname> <given-names>P</given-names></name><name><surname>Ahrne</surname> <given-names>S</given-names></name><name><surname>de Vos</surname> <given-names>WM</given-names></name><name><surname>Vaughan</surname> <given-names>EE</given-names></name><name><surname>Kleerebezem</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Convergence in Probiotic Lactobacillus gut-adaptive responses in humans and mice</article-title><source>The ISME Journal</source><volume>4</volume><fpage>1481</fpage><lpage>1484</lpage><pub-id pub-id-type="doi">10.1038/ismej.2010.61</pub-id><pub-id pub-id-type="pmid">20505752</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matthäus</surname> <given-names>F</given-names></name><name><surname>Salazar</surname> <given-names>C</given-names></name><name><surname>Ebenhöh</surname> <given-names>O</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Biosynthetic potentials of metabolites and their hierarchical organization</article-title><source>PLOS Computational Biology</source><volume>4</volume><elocation-id>e1000049</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000049</pub-id><pub-id pub-id-type="pmid">18392147</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mende</surname> <given-names>DR</given-names></name><name><surname>Sunagawa</surname> <given-names>S</given-names></name><name><surname>Zeller</surname> <given-names>G</given-names></name><name><surname>Bork</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Accurate and universal delineation of prokaryotic species</article-title><source>Nature Methods</source><volume>10</volume><fpage>881</fpage><lpage>884</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2575</pub-id><pub-id pub-id-type="pmid">23892899</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mende</surname> <given-names>DR</given-names></name><name><surname>Letunic</surname> <given-names>I</given-names></name><name><surname>Maistrenko</surname> <given-names>OM</given-names></name><name><surname>Schmidt</surname> <given-names>TSB</given-names></name><name><surname>Milanese</surname> <given-names>A</given-names></name><name><surname>Paoli</surname> <given-names>L</given-names></name><name><surname>Hernández-Plaza</surname> <given-names>A</given-names></name><name><surname>Orakov</surname> <given-names>AN</given-names></name><name><surname>Forslund</surname> <given-names>SK</given-names></name><name><surname>Sunagawa</surname> <given-names>S</given-names></name><name><surname>Zeller</surname> <given-names>G</given-names></name><name><surname>Huerta-Cepas</surname> <given-names>J</given-names></name><name><surname>Coelho</surname> <given-names>LP</given-names></name><name><surname>Bork</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>proGenomes2: an improved database for accurate and consistent habitat, taxonomic and functional annotations of prokaryotic genomes</article-title><source>Nucleic Acids Research</source><volume>48</volume><fpage>D621</fpage><lpage>D625</lpage><pub-id pub-id-type="doi">10.1093/nar/gkz1002</pub-id><pub-id pub-id-type="pmid">31647096</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mendoza</surname> <given-names>SN</given-names></name><name><surname>Olivier</surname> <given-names>BG</given-names></name><name><surname>Molenaar</surname> <given-names>D</given-names></name><name><surname>Teusink</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>A systematic assessment of current genome-scale metabolic reconstruction tools</article-title><source>Genome Biology</source><volume>20</volume><elocation-id>158</elocation-id><pub-id pub-id-type="doi">10.1186/s13059-019-1769-1</pub-id><pub-id pub-id-type="pmid">31391098</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Monteagudo-Mera</surname> <given-names>A</given-names></name><name><surname>Rodríguez-Aparicio</surname> <given-names>L</given-names></name><name><surname>Rúa</surname> <given-names>J</given-names></name><name><surname>Martínez-Blanco</surname> <given-names>H</given-names></name><name><surname>Navasa</surname> <given-names>N</given-names></name><name><surname>García-Armesto</surname> <given-names>MR</given-names></name><name><surname>Ferrero</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>In vitro evaluation of physiological probiotic properties of different lactic acid Bacteria strains of dairy and human origin</article-title><source>Journal of Functional Foods</source><volume>4</volume><fpage>531</fpage><lpage>541</lpage><pub-id pub-id-type="doi">10.1016/j.jff.2012.02.014</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Morgado</surname> <given-names>A</given-names></name><name><surname>Heras</surname> <given-names>F</given-names></name><name><surname>Marques-Silva</surname> <given-names>J</given-names></name><name><surname>Sebastiani</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2012">2012</year><chapter-title>Improvements to core-guided binary search for maxsat</chapter-title><person-group person-group-type="editor"><name><surname>Cimatti</surname> <given-names>A</given-names></name></person-group><source>Theory and Applications of Satisfiability Testing – SAT 2012</source><publisher-loc>Berlin, Heidelberg</publisher-loc><publisher-name>Springer Berlin Heidelberg</publisher-name><fpage>pages 284</fpage><lpage>297</lpage></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moss</surname> <given-names>EL</given-names></name><name><surname>Maghini</surname> <given-names>DG</given-names></name><name><surname>Bhatt</surname> <given-names>AS</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Complete, closed bacterial genomes from microbiomes using nanopore sequencing</article-title><source>Nature Biotechnology</source><volume>38</volume><fpage>701</fpage><lpage>707</lpage><pub-id pub-id-type="doi">10.1038/s41587-020-0422-6</pub-id><pub-id pub-id-type="pmid">32042169</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moya</surname> <given-names>A</given-names></name><name><surname>Ferrer</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Functional Redundancy-Induced stability of gut Microbiota subjected to disturbance</article-title><source>Trends in Microbiology</source><volume>24</volume><fpage>402</fpage><lpage>413</lpage><pub-id pub-id-type="doi">10.1016/j.tim.2016.02.002</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nielsen</surname> <given-names>HB</given-names></name><name><surname>Almeida</surname> <given-names>M</given-names></name><name><surname>Juncker</surname> <given-names>AS</given-names></name><name><surname>Rasmussen</surname> <given-names>S</given-names></name><name><surname>Li</surname> <given-names>J</given-names></name><name><surname>Sunagawa</surname> <given-names>S</given-names></name><name><surname>Plichta</surname> <given-names>DR</given-names></name><name><surname>Gautier</surname> <given-names>L</given-names></name><name><surname>Pedersen</surname> <given-names>AG</given-names></name><name><surname>Le Chatelier</surname> <given-names>E</given-names></name><name><surname>Pelletier</surname> <given-names>E</given-names></name><name><surname>Bonde</surname> <given-names>I</given-names></name><name><surname>Nielsen</surname> <given-names>T</given-names></name><name><surname>Manichanh</surname> <given-names>C</given-names></name><name><surname>Arumugam</surname> <given-names>M</given-names></name><name><surname>Batto</surname> <given-names>J-M</given-names></name><name><surname>Quintanilha dos Santos</surname> <given-names>MB</given-names></name><name><surname>Blom</surname> <given-names>N</given-names></name><name><surname>Borruel</surname> <given-names>N</given-names></name><name><surname>Burgdorf</surname> <given-names>KS</given-names></name><name><surname>Boumezbeur</surname> <given-names>F</given-names></name><name><surname>Casellas</surname> <given-names>F</given-names></name><name><surname>Doré</surname> <given-names>J</given-names></name><name><surname>Dworzynski</surname> <given-names>P</given-names></name><name><surname>Guarner</surname> <given-names>F</given-names></name><name><surname>Hansen</surname> <given-names>T</given-names></name><name><surname>Hildebrand</surname> <given-names>F</given-names></name><name><surname>Kaas</surname> <given-names>RS</given-names></name><name><surname>Kennedy</surname> <given-names>S</given-names></name><name><surname>Kristiansen</surname> <given-names>K</given-names></name><name><surname>Kultima</surname> <given-names>JR</given-names></name><name><surname>Léonard</surname> <given-names>P</given-names></name><name><surname>Levenez</surname> <given-names>F</given-names></name><name><surname>Lund</surname> <given-names>O</given-names></name><name><surname>Moumen</surname> <given-names>B</given-names></name><name><surname>Le Paslier</surname> <given-names>D</given-names></name><name><surname>Pons</surname> <given-names>N</given-names></name><name><surname>Pedersen</surname> <given-names>O</given-names></name><name><surname>Prifti</surname> <given-names>E</given-names></name><name><surname>Qin</surname> <given-names>J</given-names></name><name><surname>Raes</surname> <given-names>J</given-names></name><name><surname>Sørensen</surname> <given-names>S</given-names></name><name><surname>Tap</surname> <given-names>J</given-names></name><name><surname>Tims</surname> <given-names>S</given-names></name><name><surname>Ussery</surname> <given-names>DW</given-names></name><name><surname>Yamada</surname> <given-names>T</given-names></name><name><surname>Renault</surname> <given-names>P</given-names></name><name><surname>Sicheritz-Ponten</surname> <given-names>T</given-names></name><name><surname>Bork</surname> <given-names>P</given-names></name><name><surname>Wang</surname> <given-names>J</given-names></name><name><surname>Brunak</surname> <given-names>S</given-names></name><name><surname>Ehrlich</surname> <given-names>SD</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Identification and assembly of genomes and genetic elements in complex metagenomic samples without using reference genomes</article-title><source>Nature Biotechnology</source><volume>32</volume><fpage>822</fpage><lpage>828</lpage><pub-id pub-id-type="doi">10.1038/nbt.2939</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Noronha</surname> <given-names>A</given-names></name><name><surname>Modamio</surname> <given-names>J</given-names></name><name><surname>Jarosz</surname> <given-names>Y</given-names></name><name><surname>Guerard</surname> <given-names>E</given-names></name><name><surname>Sompairac</surname> <given-names>N</given-names></name><name><surname>Preciat</surname> <given-names>G</given-names></name><name><surname>Daníelsdóttir</surname> <given-names>AD</given-names></name><name><surname>Krecke</surname> <given-names>M</given-names></name><name><surname>Merten</surname> <given-names>D</given-names></name><name><surname>Haraldsdóttir</surname> <given-names>HS</given-names></name><name><surname>Heinken</surname> <given-names>A</given-names></name><name><surname>Heirendt</surname> <given-names>L</given-names></name><name><surname>Magnúsdóttir</surname> <given-names>S</given-names></name><name><surname>Ravcheev</surname> <given-names>DA</given-names></name><name><surname>Sahoo</surname> <given-names>S</given-names></name><name><surname>Gawron</surname> <given-names>P</given-names></name><name><surname>Friscioni</surname> <given-names>L</given-names></name><name><surname>Garcia</surname> <given-names>B</given-names></name><name><surname>Prendergast</surname> <given-names>M</given-names></name><name><surname>Puente</surname> <given-names>A</given-names></name><name><surname>Rodrigues</surname> <given-names>M</given-names></name><name><surname>Roy</surname> <given-names>A</given-names></name><name><surname>Rouquaya</surname> <given-names>M</given-names></name><name><surname>Wiltgen</surname> <given-names>L</given-names></name><name><surname>Žagare</surname> <given-names>A</given-names></name><name><surname>John</surname> <given-names>E</given-names></name><name><surname>Krueger</surname> <given-names>M</given-names></name><name><surname>Kuperstein</surname> <given-names>I</given-names></name><name><surname>Zinovyev</surname> <given-names>A</given-names></name><name><surname>Schneider</surname> <given-names>R</given-names></name><name><surname>Fleming</surname> <given-names>RMT</given-names></name><name><surname>Thiele</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The virtual metabolic human database: integrating human and gut microbiome metabolism with nutrition and disease</article-title><source>Nucleic Acids Research</source><volume>47</volume><fpage>D614</fpage><lpage>D624</lpage><pub-id pub-id-type="doi">10.1093/nar/gky992</pub-id><pub-id pub-id-type="pmid">30371894</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ofaim</surname> <given-names>S</given-names></name><name><surname>Ofek-Lalzar</surname> <given-names>M</given-names></name><name><surname>Sela</surname> <given-names>N</given-names></name><name><surname>Jinag</surname> <given-names>J</given-names></name><name><surname>Kashi</surname> <given-names>Y</given-names></name><name><surname>Minz</surname> <given-names>D</given-names></name><name><surname>Freilich</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Analysis of microbial functions in the rhizosphere using a Metabolic-Network based framework for metagenomics interpretation</article-title><source>Frontiers in Microbiology</source><volume>8</volume><elocation-id>1606</elocation-id><pub-id pub-id-type="doi">10.3389/fmicb.2017.01606</pub-id><pub-id pub-id-type="pmid">28878756</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Opatovsky</surname> <given-names>I</given-names></name><name><surname>Santos-Garcia</surname> <given-names>D</given-names></name><name><surname>Ruan</surname> <given-names>Z</given-names></name><name><surname>Lahav</surname> <given-names>T</given-names></name><name><surname>Ofaim</surname> <given-names>S</given-names></name><name><surname>Mouton</surname> <given-names>L</given-names></name><name><surname>Barbe</surname> <given-names>V</given-names></name><name><surname>Jiang</surname> <given-names>J</given-names></name><name><surname>Zchori-Fein</surname> <given-names>E</given-names></name><name><surname>Freilich</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Modeling trophic dependencies and exchanges among insects' bacterial symbionts in a host-simulated environment</article-title><source>BMC Genomics</source><volume>19</volume><elocation-id>402</elocation-id><pub-id pub-id-type="doi">10.1186/s12864-018-4786-7</pub-id><pub-id pub-id-type="pmid">29801436</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Orth</surname> <given-names>JD</given-names></name><name><surname>Thiele</surname> <given-names>I</given-names></name><name><surname>Palsson</surname> <given-names>BØ</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>What is flux balance analysis?</article-title><source>Nature Biotechnology</source><volume>28</volume><fpage>245</fpage><lpage>248</lpage><pub-id pub-id-type="doi">10.1038/nbt.1614</pub-id><pub-id pub-id-type="pmid">20212490</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parks</surname> <given-names>DH</given-names></name><name><surname>Imelfort</surname> <given-names>M</given-names></name><name><surname>Skennerton</surname> <given-names>CT</given-names></name><name><surname>Hugenholtz</surname> <given-names>P</given-names></name><name><surname>Tyson</surname> <given-names>GW</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>CheckM: assessing the quality of microbial genomes recovered from isolates, single cells, and metagenomes</article-title><source>Genome Research</source><volume>25</volume><fpage>1043</fpage><lpage>1055</lpage><pub-id pub-id-type="doi">10.1101/gr.186072.114</pub-id><pub-id pub-id-type="pmid">25977477</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pasolli</surname> <given-names>E</given-names></name><name><surname>Asnicar</surname> <given-names>F</given-names></name><name><surname>Manara</surname> <given-names>S</given-names></name><name><surname>Zolfo</surname> <given-names>M</given-names></name><name><surname>Karcher</surname> <given-names>N</given-names></name><name><surname>Armanini</surname> <given-names>F</given-names></name><name><surname>Beghini</surname> <given-names>F</given-names></name><name><surname>Manghi</surname> <given-names>P</given-names></name><name><surname>Tett</surname> <given-names>A</given-names></name><name><surname>Ghensi</surname> <given-names>P</given-names></name><name><surname>Collado</surname> <given-names>MC</given-names></name><name><surname>Rice</surname> <given-names>BL</given-names></name><name><surname>DuLong</surname> <given-names>C</given-names></name><name><surname>Morgan</surname> <given-names>XC</given-names></name><name><surname>Golden</surname> <given-names>CD</given-names></name><name><surname>Quince</surname> <given-names>C</given-names></name><name><surname>Huttenhower</surname> <given-names>C</given-names></name><name><surname>Segata</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Extensive unexplored human microbiome diversity revealed by over 150,000 genomes from metagenomes spanning age, geography, and lifestyle</article-title><source>Cell</source><volume>176</volume><fpage>649</fpage><lpage>662</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2019.01.001</pub-id><pub-id pub-id-type="pmid">30661755</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pedregosa</surname> <given-names>F</given-names></name><name><surname>Varoquaux</surname> <given-names>G</given-names></name><name><surname>Gramfort</surname> <given-names>A</given-names></name><name><surname>Michel</surname> <given-names>V</given-names></name><name><surname>Thirion</surname> <given-names>B</given-names></name><name><surname>Grisel</surname> <given-names>O</given-names></name><name><surname>Blondel</surname> <given-names>M</given-names></name><name><surname>Prettenhofer</surname> <given-names>P</given-names></name><name><surname>Weiss</surname> <given-names>R</given-names></name><name><surname>Dubourg</surname> <given-names>V</given-names></name><name><surname>Vanderplas</surname> <given-names>J</given-names></name><name><surname>Passos</surname> <given-names>A</given-names></name><name><surname>Cournapeau</surname> <given-names>D</given-names></name><name><surname>Brucher</surname> <given-names>M</given-names></name><name><surname>Perrot</surname> <given-names>M</given-names></name><name><surname>Duchesnay</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Scikit-learn: machine learning in Python</article-title><source>Journal of Machine Learning Research</source><volume>12</volume><fpage>2825</fpage><lpage>2830</lpage></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pérez-Pantoja</surname> <given-names>D</given-names></name><name><surname>Donoso</surname> <given-names>R</given-names></name><name><surname>Agulló</surname> <given-names>L</given-names></name><name><surname>Córdova</surname> <given-names>M</given-names></name><name><surname>Seeger</surname> <given-names>M</given-names></name><name><surname>Pieper</surname> <given-names>DH</given-names></name><name><surname>González</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Genomic analysis of the potential for aromatic compounds biodegradation in burkholderiales</article-title><source>Environmental Microbiology</source><volume>14</volume><fpage>1091</fpage><lpage>1117</lpage><pub-id pub-id-type="doi">10.1111/j.1462-2920.2011.02613.x</pub-id><pub-id pub-id-type="pmid">22026719</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Petrenko</surname> <given-names>P</given-names></name><name><surname>Lobb</surname> <given-names>B</given-names></name><name><surname>Kurtz</surname> <given-names>DA</given-names></name><name><surname>Neufeld</surname> <given-names>JD</given-names></name><name><surname>Doxey</surname> <given-names>AC</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>MetAnnotate: function-specific taxonomic profiling and comparison of metagenomes</article-title><source>BMC Biology</source><volume>13</volume><elocation-id>92</elocation-id><pub-id pub-id-type="doi">10.1186/s12915-015-0195-4</pub-id><pub-id pub-id-type="pmid">26541816</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Popp</surname> <given-names>D</given-names></name><name><surname>Centler</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>μbialsim: constraint-based dynamic simulation of complex microbiomes</article-title><source>Frontiers in Bioengineering and Biotechnology</source><volume>8</volume><elocation-id>574</elocation-id><pub-id pub-id-type="doi">10.3389/fbioe.2020.00574</pub-id><pub-id pub-id-type="pmid">32656192</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Potrykus</surname> <given-names>J</given-names></name><name><surname>White</surname> <given-names>RL</given-names></name><name><surname>Bearne</surname> <given-names>SL</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Proteomic investigation of amino acid catabolism in the indigenous gut anaerobe Fusobacterium varium</article-title><source>Proteomics</source><volume>8</volume><fpage>2691</fpage><lpage>2703</lpage><pub-id pub-id-type="doi">10.1002/pmic.200700437</pub-id><pub-id pub-id-type="pmid">18546150</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Prigent</surname> <given-names>S</given-names></name><name><surname>Frioux</surname> <given-names>C</given-names></name><name><surname>Dittami</surname> <given-names>SM</given-names></name><name><surname>Thiele</surname> <given-names>S</given-names></name><name><surname>Larhlimi</surname> <given-names>A</given-names></name><name><surname>Collet</surname> <given-names>G</given-names></name><name><surname>Gutknecht</surname> <given-names>F</given-names></name><name><surname>Got</surname> <given-names>J</given-names></name><name><surname>Eveillard</surname> <given-names>D</given-names></name><name><surname>Bourdon</surname> <given-names>J</given-names></name><name><surname>Plewniak</surname> <given-names>F</given-names></name><name><surname>Tonon</surname> <given-names>T</given-names></name><name><surname>Siegel</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Meneco, a Topology-Based Gap-Filling tool applicable to degraded Genome-Wide metabolic networks</article-title><source>PLOS Computational Biology</source><volume>13</volume><elocation-id>e1005276</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005276</pub-id><pub-id pub-id-type="pmid">28129330</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="software"><person-group person-group-type="author"><collab>R Development Core Team</collab></person-group><year iso-8601-date="2017">2017</year><data-title>R: A Language and Environment for Statistical Computing</data-title><version designator="3.3.3">3.3.3</version><publisher-loc>Vienna, Austria</publisher-loc><publisher-name>R Foundation for Statistical Computing</publisher-name><ext-link ext-link-type="uri" xlink:href="http://www.R-project.org">http://www.R-project.org</ext-link></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rivière</surname> <given-names>A</given-names></name><name><surname>Selak</surname> <given-names>M</given-names></name><name><surname>Lantin</surname> <given-names>D</given-names></name><name><surname>Leroy</surname> <given-names>F</given-names></name><name><surname>De Vuyst</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Bifidobacteria and Butyrate-Producing Colon bacteria: importance and strategies for their stimulation in the human gut</article-title><source>Frontiers in Microbiology</source><volume>7</volume><elocation-id>979</elocation-id><pub-id pub-id-type="doi">10.3389/fmicb.2016.00979</pub-id><pub-id pub-id-type="pmid">27446020</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Royer</surname> <given-names>L</given-names></name><name><surname>Reimann</surname> <given-names>M</given-names></name><name><surname>Andreopoulos</surname> <given-names>B</given-names></name><name><surname>Schroeder</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Unraveling protein networks with power graph analysis</article-title><source>PLOS Computational Biology</source><volume>4</volume><elocation-id>e1000108</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000108</pub-id><pub-id pub-id-type="pmid">18617988</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Schaub</surname> <given-names>T</given-names></name><name><surname>Thiele</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2009">2009</year><chapter-title>Metabolic network expansion with answer set programming</chapter-title><person-group person-group-type="editor"><name><surname>Hill</surname> <given-names>P. M</given-names></name><name><surname>Warren</surname> <given-names>D. S</given-names></name></person-group><source>Lecture Notes in Computer Science (Including Subseries Lecture Notes in Artificial Intelligence and Lecture Notes in Bioinformatics), Volume 5649 LNCS</source><publisher-name>Springer Berlin Heidelberg</publisher-name><fpage>312</fpage><lpage>326</lpage><pub-id pub-id-type="doi">10.1007/978-3-642-02846-5_27</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schellenberger</surname> <given-names>J</given-names></name><name><surname>Que</surname> <given-names>R</given-names></name><name><surname>Fleming</surname> <given-names>RM</given-names></name><name><surname>Thiele</surname> <given-names>I</given-names></name><name><surname>Orth</surname> <given-names>JD</given-names></name><name><surname>Feist</surname> <given-names>AM</given-names></name><name><surname>Zielinski</surname> <given-names>DC</given-names></name><name><surname>Bordbar</surname> <given-names>A</given-names></name><name><surname>Lewis</surname> <given-names>NE</given-names></name><name><surname>Rahmanian</surname> <given-names>S</given-names></name><name><surname>Kang</surname> <given-names>J</given-names></name><name><surname>Hyduke</surname> <given-names>DR</given-names></name><name><surname>Palsson</surname> <given-names>BØ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Quantitative prediction of cellular metabolism with constraint-based models: the COBRA toolbox v2.0</article-title><source>Nature Protocols</source><volume>6</volume><fpage>1290</fpage><lpage>1307</lpage><pub-id pub-id-type="doi">10.1038/nprot.2011.308</pub-id><pub-id pub-id-type="pmid">21886097</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schilling</surname> <given-names>CH</given-names></name><name><surname>Letscher</surname> <given-names>D</given-names></name><name><surname>Palsson</surname> <given-names>BO</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Theory for the systemic definition of metabolic pathways and their use in interpreting metabolic function from a pathway-oriented perspective</article-title><source>Journal of Theoretical Biology</source><volume>203</volume><fpage>229</fpage><lpage>248</lpage><pub-id pub-id-type="doi">10.1006/jtbi.2000.1073</pub-id><pub-id pub-id-type="pmid">10716907</pub-id></element-citation></ref><ref id="bib90"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seaver</surname> <given-names>SMD</given-names></name><name><surname>Liu</surname> <given-names>F</given-names></name><name><surname>Zhang</surname> <given-names>Q</given-names></name><name><surname>Jeffryes</surname> <given-names>J</given-names></name><name><surname>Faria</surname> <given-names>JP</given-names></name><name><surname>Edirisinghe</surname> <given-names>JN</given-names></name><name><surname>Mundy</surname> <given-names>M</given-names></name><name><surname>Chia</surname> <given-names>N</given-names></name><name><surname>Noor</surname> <given-names>E</given-names></name><name><surname>Beber</surname> <given-names>ME</given-names></name><name><surname>Best</surname> <given-names>AA</given-names></name><name><surname>DeJongh</surname> <given-names>M</given-names></name><name><surname>Kimbrel</surname> <given-names>JA</given-names></name><name><surname>D'haeseleer</surname> <given-names>P</given-names></name><name><surname>McCorkle</surname> <given-names>SR</given-names></name><name><surname>Bolton</surname> <given-names>JR</given-names></name><name><surname>Pearson</surname> <given-names>E</given-names></name><name><surname>Canon</surname> <given-names>S</given-names></name><name><surname>Wood-Charlson</surname> <given-names>EM</given-names></name><name><surname>Cottingham</surname> <given-names>RW</given-names></name><name><surname>Arkin</surname> <given-names>AP</given-names></name><name><surname>Henry</surname> <given-names>CS</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>The ModelSEED biochemistry database for the integration of metabolic annotations and the reconstruction, comparison and analysis of metabolic models for plants, fungi and microbes</article-title><source>Nucleic Acids Research</source><volume>49</volume><elocation-id>gkaa746</elocation-id><pub-id pub-id-type="doi">10.1093/nar/gkaa746</pub-id></element-citation></ref><ref id="bib91"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seemann</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Prokka: rapid prokaryotic genome annotation</article-title><source>Bioinformatics</source><volume>30</volume><fpage>2068</fpage><lpage>2069</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btu153</pub-id><pub-id pub-id-type="pmid">24642063</pub-id></element-citation></ref><ref id="bib92"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sen</surname> <given-names>P</given-names></name><name><surname>Orešič</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Metabolic modeling of human gut Microbiota on a genome scale: an overview</article-title><source>Metabolites</source><volume>9</volume><elocation-id>22</elocation-id><pub-id pub-id-type="doi">10.3390/metabo9020022</pub-id><pub-id pub-id-type="pmid">30695998</pub-id></element-citation></ref><ref id="bib93"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shannon</surname> <given-names>P</given-names></name><name><surname>Markiel</surname> <given-names>A</given-names></name><name><surname>Ozier</surname> <given-names>O</given-names></name><name><surname>Baliga</surname> <given-names>NS</given-names></name><name><surname>Wang</surname> <given-names>JT</given-names></name><name><surname>Ramage</surname> <given-names>D</given-names></name><name><surname>Amin</surname> <given-names>N</given-names></name><name><surname>Schwikowski</surname> <given-names>B</given-names></name><name><surname>Ideker</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Cytoscape: a software environment for integrated models of biomolecular interaction networks</article-title><source>Genome Research</source><volume>13</volume><fpage>2498</fpage><lpage>2504</lpage><pub-id pub-id-type="doi">10.1101/gr.1239303</pub-id><pub-id pub-id-type="pmid">14597658</pub-id></element-citation></ref><ref id="bib94"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sharma</surname> <given-names>AK</given-names></name><name><surname>Gupta</surname> <given-names>A</given-names></name><name><surname>Kumar</surname> <given-names>S</given-names></name><name><surname>Dhakan</surname> <given-names>DB</given-names></name><name><surname>Sharma</surname> <given-names>VK</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Woods: a fast and accurate functional annotator and classifier of genomic and metagenomic sequences</article-title><source>Genomics</source><volume>106</volume><fpage>1</fpage><lpage>6</lpage><pub-id pub-id-type="doi">10.1016/j.ygeno.2015.04.001</pub-id><pub-id pub-id-type="pmid">25863333</pub-id></element-citation></ref><ref id="bib95"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Silva</surname> <given-names>GG</given-names></name><name><surname>Green</surname> <given-names>KT</given-names></name><name><surname>Dutilh</surname> <given-names>BE</given-names></name><name><surname>Edwards</surname> <given-names>RA</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>SUPER-FOCUS: a tool for agile functional analysis of shotgun metagenomic data</article-title><source>Bioinformatics</source><volume>32</volume><fpage>354</fpage><lpage>361</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btv584</pub-id><pub-id pub-id-type="pmid">26454280</pub-id></element-citation></ref><ref id="bib96"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soni</surname> <given-names>R</given-names></name><name><surname>Nanjani</surname> <given-names>S</given-names></name><name><surname>Keharia</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Genome analysis reveals probiotic prop-ensities of Paenibacillus polymyxa HK4</article-title><source>Genomics</source><volume>S0888-7543</volume><elocation-id>31976-5</elocation-id><pub-id pub-id-type="doi">10.1016/j.ygeno.2020.10.017</pub-id></element-citation></ref><ref id="bib97"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steinegger</surname> <given-names>M</given-names></name><name><surname>Söding</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>MMseqs2 enables sensitive protein sequence searching for the analysis of massive data sets</article-title><source>Nature Biotechnology</source><volume>35</volume><fpage>1026</fpage><lpage>1028</lpage><pub-id pub-id-type="doi">10.1038/nbt.3988</pub-id><pub-id pub-id-type="pmid">29035372</pub-id></element-citation></ref><ref id="bib98"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stewart</surname> <given-names>RD</given-names></name><name><surname>Auffret</surname> <given-names>MD</given-names></name><name><surname>Warr</surname> <given-names>A</given-names></name><name><surname>Wiser</surname> <given-names>AH</given-names></name><name><surname>Press</surname> <given-names>MO</given-names></name><name><surname>Langford</surname> <given-names>KW</given-names></name><name><surname>Liachko</surname> <given-names>I</given-names></name><name><surname>Snelling</surname> <given-names>TJ</given-names></name><name><surname>Dewhurst</surname> <given-names>RJ</given-names></name><name><surname>Walker</surname> <given-names>AW</given-names></name><name><surname>Roehe</surname> <given-names>R</given-names></name><name><surname>Watson</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Assembly of 913 microbial genomes from metagenomic sequencing of the cow rumen</article-title><source>Nature Communications</source><volume>9</volume><elocation-id>870</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-03317-6</pub-id><pub-id pub-id-type="pmid">29491419</pub-id></element-citation></ref><ref id="bib99"><element-citation publication-type="journal"><person-group person-group-type="author"><collab>Tara Oceans coordinators</collab><name><surname>Sunagawa</surname> <given-names>S</given-names></name><name><surname>Coelho</surname> <given-names>LP</given-names></name><name><surname>Chaffron</surname> <given-names>S</given-names></name><name><surname>Kultima</surname> <given-names>JR</given-names></name><name><surname>Labadie</surname> <given-names>K</given-names></name><name><surname>Salazar</surname> <given-names>G</given-names></name><name><surname>Djahanschiri</surname> <given-names>B</given-names></name><name><surname>Zeller</surname> <given-names>G</given-names></name><name><surname>Mende</surname> <given-names>DR</given-names></name><name><surname>Alberti</surname> <given-names>A</given-names></name><name><surname>Cornejo-Castillo</surname> <given-names>FM</given-names></name><name><surname>Costea</surname> <given-names>PI</given-names></name><name><surname>Cruaud</surname> <given-names>C</given-names></name><name><surname>d'Ovidio</surname> <given-names>F</given-names></name><name><surname>Engelen</surname> <given-names>S</given-names></name><name><surname>Ferrera</surname> <given-names>I</given-names></name><name><surname>Gasol</surname> <given-names>JM</given-names></name><name><surname>Guidi</surname> <given-names>L</given-names></name><name><surname>Hildebrand</surname> <given-names>F</given-names></name><name><surname>Kokoszka</surname> <given-names>F</given-names></name><name><surname>Lepoivre</surname> <given-names>C</given-names></name><name><surname>Lima-Mendez</surname> <given-names>G</given-names></name><name><surname>Poulain</surname> <given-names>J</given-names></name><name><surname>Poulos</surname> <given-names>BT</given-names></name><name><surname>Royo-Llonch</surname> <given-names>M</given-names></name><name><surname>Sarmento</surname> <given-names>H</given-names></name><name><surname>Vieira-Silva</surname> <given-names>S</given-names></name><name><surname>Dimier</surname> <given-names>C</given-names></name><name><surname>Picheral</surname> <given-names>M</given-names></name><name><surname>Searson</surname> <given-names>S</given-names></name><name><surname>Kandels-Lewis</surname> <given-names>S</given-names></name><name><surname>Bowler</surname> <given-names>C</given-names></name><name><surname>de Vargas</surname> <given-names>C</given-names></name><name><surname>Gorsky</surname> <given-names>G</given-names></name><name><surname>Grimsley</surname> <given-names>N</given-names></name><name><surname>Hingamp</surname> <given-names>P</given-names></name><name><surname>Iudicone</surname> <given-names>D</given-names></name><name><surname>Jaillon</surname> <given-names>O</given-names></name><name><surname>Not</surname> <given-names>F</given-names></name><name><surname>Ogata</surname> <given-names>H</given-names></name><name><surname>Pesant</surname> <given-names>S</given-names></name><name><surname>Speich</surname> <given-names>S</given-names></name><name><surname>Stemmann</surname> <given-names>L</given-names></name><name><surname>Sullivan</surname> <given-names>MB</given-names></name><name><surname>Weissenbach</surname> <given-names>J</given-names></name><name><surname>Wincker</surname> <given-names>P</given-names></name><name><surname>Karsenti</surname> <given-names>E</given-names></name><name><surname>Raes</surname> <given-names>J</given-names></name><name><surname>Acinas</surname> <given-names>SG</given-names></name><name><surname>Bork</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Structure and function of the global ocean microbiome</article-title><source>Science</source><volume>348</volume><elocation-id>1261359</elocation-id><pub-id pub-id-type="doi">10.1126/science.1261359</pub-id><pub-id pub-id-type="pmid">25999513</pub-id></element-citation></ref><ref id="bib100"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thiele</surname> <given-names>I</given-names></name><name><surname>Vlassis</surname> <given-names>N</given-names></name><name><surname>Fleming</surname> <given-names>RM</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>fastGapFill: efficient gap filling in metabolic networks</article-title><source>Bioinformatics</source><volume>30</volume><fpage>2529</fpage><lpage>2531</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btu321</pub-id><pub-id pub-id-type="pmid">24812336</pub-id></element-citation></ref><ref id="bib101"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thiele</surname> <given-names>I</given-names></name><name><surname>Palsson</surname> <given-names>BØ</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>A protocol for generating a high-quality genome-scale metabolic reconstruction</article-title><source>Nature Protocols</source><volume>5</volume><fpage>93</fpage><lpage>121</lpage><pub-id pub-id-type="doi">10.1038/nprot.2009.203</pub-id><pub-id pub-id-type="pmid">20057383</pub-id></element-citation></ref><ref id="bib102"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Treitli</surname> <given-names>SC</given-names></name><name><surname>Kolisko</surname> <given-names>M</given-names></name><name><surname>Husník</surname> <given-names>F</given-names></name><name><surname>Keeling</surname> <given-names>PJ</given-names></name><name><surname>Hampl</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Revealing the metabolic capacity of <italic>Streblomastix strix</italic> and its bacterial symbionts using single-cell metagenomics</article-title><source>PNAS</source><volume>116</volume><fpage>19675</fpage><lpage>19684</lpage><pub-id pub-id-type="doi">10.1073/pnas.1910793116</pub-id><pub-id pub-id-type="pmid">31492817</pub-id></element-citation></ref><ref id="bib103"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vieira-Silva</surname> <given-names>S</given-names></name><name><surname>Falony</surname> <given-names>G</given-names></name><name><surname>Darzi</surname> <given-names>Y</given-names></name><name><surname>Lima-Mendez</surname> <given-names>G</given-names></name><name><surname>Garcia Yunta</surname> <given-names>R</given-names></name><name><surname>Okuda</surname> <given-names>S</given-names></name><name><surname>Vandeputte</surname> <given-names>D</given-names></name><name><surname>Valles-Colomer</surname> <given-names>M</given-names></name><name><surname>Hildebrand</surname> <given-names>F</given-names></name><name><surname>Chaffron</surname> <given-names>S</given-names></name><name><surname>Raes</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Species-function relationships shape ecological properties of the human gut microbiome</article-title><source>Nature Microbiology</source><volume>1</volume><elocation-id>16088</elocation-id><pub-id pub-id-type="doi">10.1038/nmicrobiol.2016.88</pub-id><pub-id pub-id-type="pmid">27573110</pub-id></element-citation></ref><ref id="bib104"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vitkin</surname> <given-names>E</given-names></name><name><surname>Shlomi</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>MIRAGE: a functional genomics-based approach for metabolic network model reconstruction and its application to cyanobacteria networks</article-title><source>Genome Biology</source><volume>13</volume><elocation-id>R111</elocation-id><pub-id pub-id-type="doi">10.1186/gb-2012-13-11-r111</pub-id><pub-id pub-id-type="pmid">23194418</pub-id></element-citation></ref><ref id="bib105"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname> <given-names>H</given-names></name><name><surname>Marcišauskas</surname> <given-names>S</given-names></name><name><surname>Sánchez</surname> <given-names>BJ</given-names></name><name><surname>Domenzain</surname> <given-names>I</given-names></name><name><surname>Hermansson</surname> <given-names>D</given-names></name><name><surname>Agren</surname> <given-names>R</given-names></name><name><surname>Nielsen</surname> <given-names>J</given-names></name><name><surname>Kerkhoven</surname> <given-names>EJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>RAVEN 2.0: a versatile toolbox for metabolic network reconstruction and a case study on Streptomyces coelicolor</article-title><source>PLOS Computational Biology</source><volume>14</volume><elocation-id>e1006541</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006541</pub-id><pub-id pub-id-type="pmid">30335785</pub-id></element-citation></ref><ref id="bib106"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Wickham</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2009">2009</year><source>Ggplot2: Elegant Graphics for Data Analysis</source><publisher-name>Springer-Verlag</publisher-name><pub-id pub-id-type="doi">10.1007/978-3-319-24277-4</pub-id></element-citation></ref><ref id="bib107"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zelezniak</surname> <given-names>A</given-names></name><name><surname>Andrejev</surname> <given-names>S</given-names></name><name><surname>Ponomarova</surname> <given-names>O</given-names></name><name><surname>Mende</surname> <given-names>DR</given-names></name><name><surname>Bork</surname> <given-names>P</given-names></name><name><surname>Patil</surname> <given-names>KR</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Metabolic dependencies drive species co-occurrence in diverse microbial communities</article-title><source>PNAS</source><volume>112</volume><fpage>6449</fpage><lpage>6454</lpage><pub-id pub-id-type="doi">10.1073/pnas.1421834112</pub-id><pub-id pub-id-type="pmid">25941371</pub-id></element-citation></ref><ref id="bib108"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zomorrodi</surname> <given-names>AR</given-names></name><name><surname>Maranas</surname> <given-names>CD</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>OptCom: a multi-level optimization framework for the metabolic modeling and analysis of microbial communities</article-title><source>PLOS Computational Biology</source><volume>8</volume><elocation-id>e1002363</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002363</pub-id><pub-id pub-id-type="pmid">22319433</pub-id></element-citation></ref><ref id="bib109"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zou</surname> <given-names>Y</given-names></name><name><surname>Xue</surname> <given-names>W</given-names></name><name><surname>Luo</surname> <given-names>G</given-names></name><name><surname>Deng</surname> <given-names>Z</given-names></name><name><surname>Qin</surname> <given-names>P</given-names></name><name><surname>Guo</surname> <given-names>R</given-names></name><name><surname>Sun</surname> <given-names>H</given-names></name><name><surname>Xia</surname> <given-names>Y</given-names></name><name><surname>Liang</surname> <given-names>S</given-names></name><name><surname>Dai</surname> <given-names>Y</given-names></name><name><surname>Wan</surname> <given-names>D</given-names></name><name><surname>Jiang</surname> <given-names>R</given-names></name><name><surname>Su</surname> <given-names>L</given-names></name><name><surname>Feng</surname> <given-names>Q</given-names></name><name><surname>Jie</surname> <given-names>Z</given-names></name><name><surname>Guo</surname> <given-names>T</given-names></name><name><surname>Xia</surname> <given-names>Z</given-names></name><name><surname>Liu</surname> <given-names>C</given-names></name><name><surname>Yu</surname> <given-names>J</given-names></name><name><surname>Lin</surname> <given-names>Y</given-names></name><name><surname>Tang</surname> <given-names>S</given-names></name><name><surname>Huo</surname> <given-names>G</given-names></name><name><surname>Xu</surname> <given-names>X</given-names></name><name><surname>Hou</surname> <given-names>Y</given-names></name><name><surname>Liu</surname> <given-names>X</given-names></name><name><surname>Wang</surname> <given-names>J</given-names></name><name><surname>Yang</surname> <given-names>H</given-names></name><name><surname>Kristiansen</surname> <given-names>K</given-names></name><name><surname>Li</surname> <given-names>J</given-names></name><name><surname>Jia</surname> <given-names>H</given-names></name><name><surname>Xiao</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>1,520 reference genomes from cultivated human gut Bacteria enable functional microbiome analyses</article-title><source>Nature Biotechnology</source><volume>37</volume><fpage>179</fpage><lpage>185</lpage><pub-id pub-id-type="doi">10.1038/s41587-018-0008-8</pub-id><pub-id pub-id-type="pmid">30718868</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><boxed-text><sec id="s8" sec-type="appendix"><title>Analysis of GSMNs from the human gut reference genomes and rumen MAGs collections</title><sec id="s8-1"><title>Comparison of GSMNs reconstructed from MAGs and from reference genomes</title><p>Main characteristics of GSMNs reconstructed from the human gut microbiota reference genomes and the rumen MAGs are compared in <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref>.</p><fig id="app1fig1" position="float"><label>Appendix 1—figure 1.</label><caption><title>Characteristics of the metabolic networks built for the gut and the rumen datasets.</title><p>(<bold>a</bold>) Distribution of the number of metabolic compounds in genome-scale metabolic networks (GSMNs) reconstructed for the gut dataset (purple) and the rumen dataset (green). (<bold>b</bold>) Distribution of the number of metabolic reactions. (<bold>c</bold>) Distribution of the number of complete pathways according to the MetaCyc database. (<bold>d</bold>) Distribution of the number of genes included into the GSMNs. (<bold>e</bold>) Distribution of the number of reactions associated to genes. (f) Principal component analysis of the GSMNs reconstructions based on the previous characteristics (a. to e.). (<bold>g</bold>) Distribution of the number of genes (not necessarily related to metabolism) in the initial genomes/MAGs. (<bold>h</bold>) Individual metabolic potentials (scopes) for the gut bacteria, dotted line represents the number of seeds (nutrients) used in the algorithm. (<bold>i</bold>) Reachability of metabolites by gut bacteria. (<bold>j</bold>) Individual metabolic potentials (scopes) for the rumen bacteria, dotted line represents the number of seeds (nutrients) used in the algorithm. (<bold>k</bold>) Reachability of metabolites by rumen bacteria.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61968-app1-fig1-v2.tif"/></fig></sec><sec id="s8-2"><title>Robustness analysis of GSMN reconstruction with MAGs</title><p>MAGs from the rumen dataset were degraded by randomly removing contigs. The following degradations were tested: removal of 2% of genes in all MAGs, removal of 5% of genes in 80% of MAGs, removal of 5% of genes in all MAGs, removal of 10% of genes in 70% of MAGs.</p><p><xref ref-type="table" rid="app1table1">Appendix 1—table 1</xref> summarises the characteristics of the genomes and GSMNs for all experiments. The average gene loss in genomes is similar to the average gene loss in metabolic networks. However, the average loss of metabolites and reactions is lower than the genetic loss: it increases more slowly than the loss of genes. For instance, the 2% degradation of MAGs leads to a nearly 2% decrease in reaction numbers in GSMNs. However, the 10% degradation in 70% of genomes (average gene loss of 7% in the initial community) only leads to a 5% decrease in reaction numbers. One notable observation is the stability in the percentage of reactions associated to genes, suggesting that the loss of reactions in degraded genomes mainly occurs among reactions that are not associated to genes. It is also possible that the loss of genes in GSMNs is due to the redundancy loss: some reactions associated to several genes before degradation lose some of these gene associations after degradation. Data for each genome and GSMN is available in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref> - Tables 16, 21-24. </p><table-wrap id="app1table1" position="float"><label>Appendix 1—table 1.</label><caption><title>Effect of MAG degradation on genome-scale metabolic network (GSMN) reconstructions.</title><p>Numbers are averages. '±' precedes standard deviation values. 'original’: initial MAGs prior degradation, '2pc100’: 2% gene removal in all MAGs, '5pc80’: 5% gene removal in 80% of MAGs, '5pc100’: 5% gene removal in all MAGs, '10pc70’: 10% gene removal in 70% of MAGs.</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>Original</th><th>2pc100</th><th>5pc80</th><th>5pc100</th><th>10pc70</th></tr></thead><tbody><tr><td>Genes in MAGs</td><td>2100 (±501)</td><td>2058 (±491)</td><td>2016 (±484)</td><td>1994 (±478)</td><td>1954 (±480)</td></tr><tr><td>Reactions in GSMNs</td><td>1155 (±199)</td><td>1131 (±192)</td><td>1116 (±192)</td><td>1108 (±190)</td><td>1094 (±192)</td></tr><tr><td>Metabolites in GSMNs</td><td>1422 (±212)</td><td>1402 (±207)</td><td>1388 (±208)</td><td>1381 (±206)</td><td>1366 (±208)</td></tr><tr><td>Genes in GSMNs</td><td>543 (±108)</td><td>532 (±106)</td><td>521 (±105)</td><td>515 (±103)</td><td>505 (±105)</td></tr><tr><td>% reactions with genes</td><td>73.84%</td><td>74.05%</td><td>73.82%</td><td>73.72%</td><td>73.61%</td></tr><tr><td>Gene loss in MAGs</td><td>—</td><td>1.98%</td><td>4.01%</td><td>5.03%</td><td>6.94%</td></tr><tr><td>Reaction loss in GSMNs</td><td>—</td><td>1.96%</td><td>3.30%</td><td>3.89%</td><td>5.17%</td></tr><tr><td>Metabolite loss in GSMNs</td><td>—</td><td>1.37%</td><td>2.41%</td><td>2.91%</td><td>3.92%</td></tr><tr><td>Gene loss in GSMNs</td><td>—</td><td>2.09%</td><td>4.17%</td><td>5.11%</td><td>7.02%</td></tr></tbody></table></table-wrap></sec></sec></boxed-text></app><app id="appendix-2"><title>Appendix 2</title><boxed-text><sec id="s9" sec-type="appendix"><title>Supplementary information to the Diabetes experiment</title><sec id="s9-1"><title>Diversity and richness of the samples</title><p>The Shannon diversity index and richness of the 170 samples are illustrated in <xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1</xref> a and b. We relied on species present in the abundance matrix to define communities for the metabolic analysis. The phylum-level composition of the matrix is illustrated in <xref ref-type="fig" rid="app2fig2">Appendix 2—figure 2</xref>. The average size of the community was 108 GSMNs. Their median size was 111. In order to compute a metabolic distance between samples, we retrieved for each genome its KO annotations obtained with Eggnog-Mapper. Using the abundance (normalised by sample) of the genomes in each sample, we were able to retrieve the KO content of samples. We then calculated the Bray-Curtis distance between samples before computing a PCoA (<xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1</xref>). The PCoA shows a clear distinction between the two datasets, thus motivating their distinct analysis, as performed in the main results of the article. However, there are no distinction between the control and diabetes status of the samples.</p><fig id="app2fig1" position="float"><label>Appendix 2—figure 1.</label><caption><title>Shannon diversity index, richness, and metabolic distance of the samples.</title><p>(<bold>a</bold>) Histogram depicting the Shannon diversity index of the samples. (<bold>b</bold>) Histogram depicting the richness of the samples. (<bold>c</bold> and <bold>d</bold>) Principal coordinate analysis (PCoA) of the Bray-Curtis distance calculated on the KO composition of samples coloured by dataset (<bold>c</bold>) or disease status (<bold>d</bold>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61968-app2-fig1-v2.tif"/></fig><fig id="app2fig2" position="float"><label>Appendix 2—figure 2.</label><caption><title>Taxonomic diversity of the genomes used for genome-scale metabolic networks (GSMNs) reconstruction using OTU mapping (at species level) to curated metabolic models (a), or reconstructed metagenomic species (MGS) (b).</title><p>Phyla composition of the genomes, and number of distinct representatives for each phylum.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61968-app2-fig2-v2.tif"/></fig></sec><sec id="s9-2"><title>Cohort effect at the metabolic level</title><p>The cohort effect is illustrated in <xref ref-type="fig" rid="app2fig3">Appendix 2—figure 3</xref>.</p><fig id="app2fig3" position="float"><label>Appendix 2—figure 3.</label><caption><title>Impact of the cohort when studying the metabolisms of individuals from the metagenomic dataset.</title><p>Panels (<bold>a</bold>) to (<bold>d</bold>) focus on the community scope, that is the set of metabolites reachable by the community associated to a sample. Panel (<bold>d</bold>) shows the representation of a multidimensional scaling (MDS) on the community scope composition between cohorts. Panels (<bold>e</bold>) to (<bold>g</bold>) focus on the cooperation potential, that is the set of metabolites that are not expected to be produced by individual members of communities and instead require cooperation. Panels (<bold>a</bold>) and (<bold>e</bold>) describe families of metabolites whose occurrences significantly differ between cohorts in the corresponding group (community scope or cooperation potential). Panels (<bold>b</bold>) and (f) illustrate the size of the community scope and cooperation potential respectively in samples from the two cohorts. Panels <bold>c</bold> (resp. g) are receiving operating curves (ROC) of a classification experiment aiming at separating the cohort (MHD n = 115, SWE n = 55) based on the occurrences of metabolites in the community scope (resp. cooperation potential). Panel (<bold>h</bold>) describes the size of the initial community associated to samples of both cohorts according to abundance data of MGS.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61968-app2-fig3-v2.tif"/></fig></sec><sec id="s9-3"><title>Status effect at the metabolic level</title><p>The effect of the disease status is illustrated in <xref ref-type="fig" rid="app2fig4">Appendix 2—figure 4</xref>.</p><fig id="app2fig4" position="float"><label>Appendix 2—figure 4.</label><caption><title>Impact of the status when studying the metabolisms of individuals from the MHD metagenomic dataset.</title><p>Panel (<bold>a</bold>) is the receiver operating curve (ROC) of the classification experiment aiming at deciphering the disease status for the MHD cohort (control n = 49, Type-1 Diabetes n = 31 or Type-2 Diabetes n = 35) based on the cooperation potential composition. Panel (<bold>b</bold>) illustrates the cooperation potential composition in terms of metabolites for all samples. Disease status is indicated by the colour at the left side of each row. Panel (<bold>c</bold>) describes the taxonomic distribution at the phylum level of groups of species before and after community reduction, according to the disease status. Selection of communities was performed with the objective of making producible by the reduced communities the set of metabolites in the cooperation potential. init: initial composition of communities, KS: key species, AS: alternative symbionts, ES: essential symbionts. T1D: Type-1 Diabetes, T2D: Type-2 Diabetes.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61968-app2-fig4-v2.tif"/></fig></sec></sec></boxed-text></app></app-group></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.61968.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Zambrano</surname><given-names>María Mercedes</given-names></name><role>Reviewing Editor</role><aff><institution>CorpoGen</institution><country>Colombia</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Machado</surname><given-names>Daniel</given-names> </name><role>Reviewer</role><aff><institution>Norwegian University of Science and Technology</institution></aff></contrib><contrib contrib-type="reviewer"><name><surname>Ebenhoh</surname><given-names>Oliver</given-names> </name><role>Reviewer</role><aff><institution/></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>Knowledge of the functions and interactions among members of a complex microbial community is crucial to understanding their roles and ecological relevance. This work presents a flexible workflow, M2M, tailored to the metabolic analysis of microbiomes from metagenomics data. It integrates several tools that allow metabolic modelling of large-scale communities, inferring metabolic complementarity and identification of species key to a given community.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Metage2Metabo: microbiota-scale metabolic complementarity for the identication of keystone species&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Gisela Storz as the Senior Editor. The following individuals involved in review of your submission have agreed to reveal their identity: Daniel Machado (Reviewer #1); Oliver Ebenhoh (Reviewer #2).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>We would like to draw your attention to changes in our revision policy that we have made in response to COVID-19 (https://elifesciences.org/articles/57162). Specifically, when editors judge that a submitted work as a whole belongs in <italic>eLife</italic> but that some conclusions require a modest amount of additional new data, as they do with your paper, we are asking that the manuscript be revised to either limit claims to those supported by data in hand, or to explicitly state that the relevant conclusions require additional supporting data.</p><p>Our expectation is that the authors will eventually carry out the additional experiments and report on how they affect the relevant conclusions either in a preprint on bioRxiv or medRxiv, or if appropriate, as a Research Advance in <italic>eLife</italic>, either of which would be linked to the original paper.</p><p>Summary:</p><p>This study presents a pipeline for large-scale metabolic analysis of genomes and metagenomic data. When evaluated on gut microbiome genomes from cultured species and metagenome-assembled genomes, this pipeline was able to reconstruct metabolic networks, identify potential metabolites, and provide information on minimal communities for a given target production and keystone species, defined here as species that are essential for a community to perform a certain metabolic function. The manuscript clearly formulates limitations, explains the software and functionality, and provides source code in a well-structured and clear git repository.</p><p>Essential revisions:</p><p>The paper could benefit from revisions to improve clarity, and to showcase the tool's versatility and performance. While aspects of the pipeline are novel, such as relying on topological methods and the use of Answer Set Programming to solve the problems of finding minimal sets of reactions or minimal sets of organisms, the authors need to revise some of the novelty claims in light of previous work and existing tools.</p><p>Please address the following concerns regarding the novelty of the pipeline and its automation, as well as comparison with existing tools and annotation:</p><p>1) There are already some tools that can automate GSMN reconstruction from genomes and MAGs (for example, ModelSEED and CarveMe, this one mentioned), calculate cooperation from GSMNs (SMETANA; Zelezniak et al., 2015), and workflows that automate some tasks such as metaBAGpipes (https://github.com/franciscozorrilla/metaBAGpipes), which assembles MAGs from raw metagenomics data, CarveMe, MEMOTE (model quality control) and SMETANA) and in KBase it is possible to assemble MAGs, run ModelSEED, and merge the single species models into community models for further analysis. These options go from raw metagenomic data (which the m2m software apparently doesn't) to community GSMN analysis and simulation.</p><p>2) It seems incorrect to state that their network-expansion algorithm can scale to large communities, unlike other simulation methods based on flux balance analysis. There are LP and MILP implementations of FBA community simulation methods. The LP methods scale linearly with the number of species (Popp and Centler, 2020 recently simulated a 773-species community with FBA). The MILP-based methods are worst-case exponential, but commercial solvers like CPLEX and Gurobi implement very efficient heuristics that allow for fast simulation. To make this claim, the authors should clearly state what is the computational cost (using Big O notation) of their method and show that it is lower than FBA based methods.</p><p>3) Different databases are functionally annotated by different tools (Prokka and EGGNOG). Annotation method for the third dataset is unclear. Different methods are employed on different datasets which in turn might hurt the analysis due to lack of standardization of the inputs.</p><p>4) Please clarify what is meant when stating that their network expansion algorithm is more robust &quot;in the face of missing reactions&quot;. If this means that the algorithm doesn't fail to compute, then it might lead to results that may represent an incorrect metabolic landscape. As such, robustness may not necessarily be correct (or desirable). It could also be that the metabolic end-products obtained with FBA (by performing flux variability analysis of the exchange reactions) would in the end be the same, since in both cases they have to be topologically reachable regardless of the stoichiometry being accounted for or not.</p><p>5) While the authors mention reasons for robustness of their algorithms, they do not test these possibilities. Perhaps these could be addressed given that they have all the data required to answer the question.</p><p>Please take into account the following points in order to improve the manuscript.</p><p>6) The Materials and methods section could benefit from a major revision as it is going back and forth from describing the datasets and the pipeline (the focus is unclear). It'll be useful to have more details on critical steps in the pipeline such as the metabolic objective and community reduction steps and keystone species discovery.</p><p>7) The average number of metabolites per model is higher than the average number of reactions (1366 vs 1144 for the gut dataset). GSMNs usually have a lot more reactions than metabolites, hence their underdetermined stoichiometric matrices, and large number of degrees of freedom. Also, the average number of reachable metabolites is only 286, i.e. only about 20% of the metabolic network is reached. How is this possible, and how can one trust such models?</p><p>8) There are multiple instances in the Results section where the authors present the p-value for a statistical test without presenting also the effect size and/or test statistic. Knowing the statistical significance is not helpful without knowing the effect size. For instance: &quot;The community diversity varied between disease statuses, with a significantly higher number of MGS observed in T1D individuals forming the initial communities (anova p &lt; 0.01, Tukey HSD test p &lt; 0.01 vs control).&quot;</p><p>9) The authors mention that &quot;A classification experiment on the composition of the community scope can, to some extent, (AUC = 0.73 +/- 0.15) decipher between healthy or diabetes statuses.&quot; But is this better than a classification based, for instance, on OTU analysis, or functional meta-genome analysis? Although the results are interesting, in the end it is hard to convince the reader that using GSMN reconstruction provides an advantage compared to using the metagenomics data directly.</p><p>10) In general, results are not compared to the state of the art and the Results section should contain more specific examples of metabolites/pathways of interest, bacterial species and their known or novel interactions. Additionally, it is mentioned that the datasets are similar – it'll be useful to have a section summarizing the results from all analyses.</p><p>11) The utilization of keystone species in this work is not entirely correct. Here the authors use keystone species to mention species that are always present in the set of minimal communities enumerated to produce a given set of metabolites. The definition of keystone species in a community are those whose removal would cause the collapse of the community. Since the simulation method used by the authors doesn't allow to test for community stability, the application of this term does not seem appropriate.</p><p>12) Keystone species are also described as the output of the tool and could use a more detailed report and examples in the Results section. These are very interesting and currently get lost between the lines.</p><p>13) There are several aspects of the figures that can be improved.</p><p>– Figure 1 is confusing could use some reorganization, so the pipeline steps are clear, consider adding numbers to the different steps.</p><p>– Figure 2 is very hard to digest. I have difficulties understanding what the figure actually tells me. What is the meaning of the white fields, are the sub-figures connected despite having a different x-axis, and what is the overall message?</p><p>– The power graphs are interesting, but it is unclear if they were generated by the tool since this is not clear in the manuscript. In addition, the usefulness of the power graphs in Figure 3 is not fully evident. What do we learn from them and what are the large number of circles? If three subgroups are connected, why are two of them encircled in an extra circle?</p><p>– Figure 4 presents an analysis that is downstream of the presented software paper since it illustrates how the output of the software can be further analyzed. In order to appear in the main text of the manuscript, it needs to be better explained since it is hard to understand with the information given. For example, what do the Receiver Operator Curves (ROC) actually represent? More background information is required.</p><p>14) The authors should define the essential and non-essential symbionts and add more context on their known interactions in the Introduction and Results sections.</p><p>15) The comparison to other platforms such as Kbase and other genome scale models should be discussed in more detail in the Introduction and Discussion sections. It is unclear how this tool can make use of available good quality curated reconstructions as input.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.61968.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>The paper could benefit from revisions to improve clarity, and to showcase the tool's versatility and performance. While aspects of the pipeline are novel, such as relying on topological methods and the use of Answer Set Programming to solve the problems of finding minimal sets of reactions or minimal sets of organisms, the authors need to revise some of the novelty claims in light of previous work and existing tools.</p></disp-quote><p>In this manuscript we present Metage2Metabo, a flexible workflow dedicated to the metabolic screening of large communities. This workflow assembles several steps of analysis starting from the automation of metabolic network reconstruction with Pathway Tools. This step of command-line automation of Pathway Tools is a novelty of the paper, we developed a Python package ensuring a transparent reconstruction for a set of annotated genomes. The subsequent analyses of the workflow rely on the network expansion algorithm that was previously published (Ebenhöh et al., 2004). Modelling of network expansion in Answer Set Programming has been previously applied to gap-filling (Schaub and Thiele, 2009, Prigent et al., 2017). Here we designed tools to directly apply network expansion to the study of individual GSMNs in order to retrieve activated reactions and producible metabolites. In addition, an Answer Set Programming algorithm relying on network expansion is used for community reduction. This particular algorithm was already published in 2018 (Frioux et al., Bioinformatics) as a Python package (MiSCoTo). Data management, encapsulation and outputs of MiSCoTo were extensively enhanced in the context of M2M development. The core algorithm remained, but we added logic programming enhancements notably for the identification of target metabolite producers in initial or selected communities. In addition, the use of the algorithm in M2M is facilitated as it occurs in the general context of the pipeline and results are directly analysed in the light of the initial microbiota. The combination of all these individual tools into a complete and automatic, yet flexible, pipeline is a novelty of the manuscript: performing individual then collective analysis of the metabolic potential, identifying the newly producible metabolites as a cooperation potential, defining key species and essential/alternative symbionts by analysing the search space of minimal communities, validating the usage to metagenome-derived datasets.</p><p>We used the comments and advice of the reviewers to enhance the manuscript and clarify the novelty it brings. We have notably reorganised the Materials and methods (now at the end of the manuscript) with respect to the Result section. We mathematically formalised the concepts in the methods, and clarified the new concepts brought by the manuscript: key species, essential and alternative symbionts, cooperation potential. We reorganised the results around the main object of the manuscript which is the pipeline: how does every experiment gives information on the usability and applicability of the pipeline. Finally, we rewrote parts of the Discussion to underline important comments raised by the reviewers. Altogether, we believe the manuscript gained clarity after this step of review and we thank the reviewers for leading us in this direction.</p><disp-quote content-type="editor-comment"><p>Please address the following concerns regarding the novelty of the pipeline and its automation, as well as comparison with existing tools and annotation:</p><p>1) There are already some tools that can automate GSMN reconstruction from genomes and MAGs (for example, ModelSEED and CarveMe, this one mentioned), calculate cooperation from GSMNs (SMETANA; Zelezniak et al., 2015), and workflows that automate some tasks such as metaBAGpipes (https://github.com/franciscozorrilla/metaBAGpipes), which assembles MAGs from raw metagenomics data, CarveMe, MEMOTE (model quality control) and SMETANA) and in KBase it is possible to assemble MAGs, run ModelSEED, and merge the single species models into community models for further analysis. These options go from raw metagenomic data (which the m2m software apparently doesn't) to community GSMN analysis and simulation.</p></disp-quote><p>We agree with the observations of the reviewers and clarified the existing tools in the manuscript. We want to emphasize that we designed M2M to be flexible and suitable to metabolic models of any database, reconstructed with any tool. A module of M2M focuses on the automation of Pathway Tools to fill a gap in the usage of the software at a large scale. Pathway Tools is a widely used tool for GSMN reconstruction, we aimed at facilitating its usage from command-line in order to ease its scalability. The other tools, as stated by reviewers can already be used with these objectives, and possibly extend the usage to raw metagenomic data.</p><p>The references for KBase, SMETANA, ModelSeed were all already provided in the Introduction, although the names of the tools were not explicitely cited. This is the case now.</p><p>“There now exist a variety of GSMN reconstruction implementations: all-in-one platforms such as Pathway Tools (Karp et al., 2016), CarveMe (Machado et al., 2018a) or KBase that provides narratives from metagenomic datasets analysis up to GSMN reconstruction with ModelSeed (Henry et al., 2010)”</p><p>“SMETANA (Zelezniak et al., 2015) estimates the cooperation potential and simulates fluxes exchanges within communities. MiSCoTo (Frioux et al., 2018b) computes the metabolic potential of interacting species and performs community reduction. NetCooperate (Levy et al., 2015) predicts the metabolic complementarity between species.”</p><p>We emphasised in the Discussion on the possible use of metabolic models from other databases.</p><p>“GSMNs in SBML format obtained from other platforms such as Kbase (Arkin et al., 2018), ModelSEED (Henry et al., 2010) or CarveMe (Machado et al., 2018a), can also be used as inputs to M2M for all metabolic analyses. For instance, we used highly curated models from AGORA in the application of M2M to metagenomic datasets. The above reconstruction platforms already implement solution to facilitate the treatment of large genomic collections. There is no universal implementation for GSMN reconstruction (Mendoza et al., 2019); depending on their needs (local run, external platform, curated or non-curated GSMNs…), users can choose either method and connect it to M2M.”</p><disp-quote content-type="editor-comment"><p>2) It seems incorrect to state that their network-expansion algorithm can scale to large communities, unlike other simulation methods based on flux balance analysis. There are LP and MILP implementations of FBA community simulation methods. The LP methods scale linearly with the number of species (Popp and Centler, 2020 recently simulated a 773-species community with FBA). The MILP-based methods are worst-case exponential, but commercial solvers like CPLEX and Gurobi implement very efficient heuristics that allow for fast simulation. To make this claim, the authors should clearly state what is the computational cost (using Big O notation) of their method and show that it is lower than FBA based methods.</p></disp-quote><p>M2M falls in the category of optimization problems for which worst-case asymptotic complexity is not as informative as practical performance using heuristic methods. The same is true of mixed-integer linear programming methods.</p><p>As a strategy layer over MiSCoTo (Frioux et al., 2018), metage2metabo relies on the Clasp solver (Gebser et al., 2012) for efficient resolution of the underlying grounded ASP instances. Although this type of decision problem is NP-hard (Julien-Laferriere et al., 2016), as with many real-world optimisation problems worst-case asymptomatic complexity is less informative for applications than practical performance using heuristic methods. The Clasp solver implements a robust collection of heuristics (Gebser et al., 2007, Andres et al., 2012) for core-guided weighted MaxSAT (Manquinho et al., 2009, Morgado et al., 2012) that provide rapid set-based solutions to combinatorial optimization problems, much in the same way that heuristic polytope solvers like CPlex [<ext-link ext-link-type="uri" xlink:href="http://www.ibm.com/analytics/cplex-optimizer">www.ibm.com/analytics/cplex-optimizer</ext-link>] provide rapid numerical solutions to mixed integer programming optimization problems. The kinds of ASP instances constructed by MiSCoTo for metage2metabo are solved in a matter of minutes. In addition, the computation of key species uses projection modes (brave and cautious reasoning) that do not necessitate the enumeration of solutions. These reasoning modes are used in addition to the solving heuristics that enable the solving of the optimisation problem in the first place.</p><p>We thank the reviewers for pointing out the work of Popp and Centler. Let us emphasize that we do not think M2M has the exact same usage as such methods. M2M is suitable for screening, applicable in the absence of biomass reaction, and easily ran, with computation lengths of minutes without the reconstruction part, with various target metabolites. Simulations as in the above article take days and are, to our opinion, less flexible in the set-up than M2M, which makes us suggest to use them in second intention, after screening of the community metabolic complementarity with M2M, and possibly pre-isolation of species of interest. Recent works also emphasise on the difficulty of using simulations taking many species into account. For example, Basile et al. (2020) instead performed pairwise simulations.</p><p>Finally, in our case, the optimisation occurs in the community reduction step. Finding what is producible in each community does not require optimisation, it is governed by logic rules in Answer Set Programming. Julien-Laferrière and co-workers designed an algorithm solving the Directed Steiner Hypertree problem for the design of minimal synthetic consortia and studied its complexity. In practice however, it was the description of the problem in ASP that led to an efficient solving.</p><p>“As a strategy layer over MiSCoTo, M2M relies on the Clasp solver (Gebser et al., 2012) for efficient resolution of the underlying grounded ASP instances. Although this type of decision problem is NP-hard (Julien-Laferriere et al., 2016), as with many real-world optimisation problems worst-case asymptomatic complexity is less informative for applications than practical performance using heuristic methods. The Clasp solver implements a robust collection of heuristics (Gebser et al., 2007, Andres et al., 2012) for core-guided weighted MaxSAT (Manquinho et al., 2009, Morgado et al., 2012) that provide rapid set-based solutions to combinatorial optimisation problems, much in the same way that heuristic solvers like CPlex provide rapid numerical solutions to mixed integer programming optimisation problems. The kinds of ASP instances constructed by MiSCoTo for M2M are solved in a matter of minutes for the identification of key species and essential/alternative symbionts. Indeed the space of solutions is efficiently sampled using adequate projection modes in ASP, which enables the computation of these groups of species without the need for a full enumeration by taking advantage of the underlying ASP solver and associated projection modes.”</p><p>In addition, we clarified our statement in Discussion:</p><p>“Most metabolic modelling methods rely on flux analyses (Orth et al., 2010) solved with linear programming, which may turn out to be challenging to implement for simulations of large communities (Basile et al., 2020), although recent efforts in that direction are encouraging (Popp et al., 2020). M2M uses the network expansion algorithm and solves combinatorial optimisation problems with Answer Set Programming, thereby ensuring fast simulations and community predictions, suitable when performing systematic screening and multiple experiments.”</p><disp-quote content-type="editor-comment"><p>3) Different databases are functionally annotated by different tools (Prokka and EGGNOG). Annotation method for the third dataset is unclear. Different methods are employed on different datasets which in turn might hurt the analysis due to lack of standardization of the inputs.</p></disp-quote><p>M2M expects as input annotated genomes in GenBank formats (with m2m workflow) or SBML format (with m2m metacom). We have applied the tool to four datasets, three with GenBank as inputs (gut, rumen and diabete datasets) and one with SBML as input (AGORA datasets).</p><p>The GenBanks were obtained using several annotation pipelines depending on the input data. All the annotation pipelines we used were previously published and are extensively used by the community. The genomic data differed for each dataset: one consisted in already annotated genomes (gut reference genomes dataset), one was a collection of contigs binned into MAGs (rumen dataset) and the last one consisted in lists of genes for metagenomic species (diabetes dataset).</p><p>The gut reference genomes was already annotated by the authors of the work. So we directly reused this annotation by feeding the annotated GenBank files extracted from NCBI to M2M.</p><p>Regarding the rumen dataset, the initial dataset consisted in a set of contigs for each MAG. Among the pipelines suitable for contig annotation, Prokka is widely used. We annotated the MAGs using Prokka and directly used the GenBank created by the tool as an input to M2M.</p><p>Finally in the diabetes dataset, the data consisted in core genes of MGS on one hand, and for species that could be mapped to the Progenomes database, in the representative genome of each, for which we downloaded the genes and proteins. We used Eggnog-mapper to functionally annotate the genes. Then with these lists of genes and their annotations we used the package emapper_to_gbk to produce GenBank file compatible with M2M.</p><p>“Users can use the annotation pipeline of their choice prior running M2M.”</p><p>“The genomes were already annotated and could therefore directly enter M2M pipeline.”</p><disp-quote content-type="editor-comment"><p>4) Please clarify what is meant when stating that their network expansion algorithm is more robust &quot;in the face of missing reactions&quot;. If this means that the algorithm doesn't fail to compute, then it might lead to results that may represent an incorrect metabolic landscape. As such, robustness may not necessarily be correct (or desirable). It could also be that the metabolic end-products obtained with FBA (by performing flux variability analysis of the exchange reactions) would in the end be the same, since in both cases they have to be topologically reachable regardless of the stoichiometry being accounted for or not.</p></disp-quote><p>Our objective with this sentence was to highlight previous results of network expansion analyses that demonstrated the stability of the scope even in the case of missing reactions in the metabolic network. This seemed adequate in the metagenomic context as genomes used for GSMN reconstruction are associated to species or strains that are poorly studied and can therefore be incomplete or face incomplete annotation. In addition, the metabolic network draft automatically constructed can have gaps that one does not want to automatically fill as it could lead to adding possibly false positive reactions that would hide metabolic complementarity with other species.</p><p>We rewrote the sentence in the Introduction.</p><p>“The robustness of the algorithm was demonstrated by the stability of the set of reachable metabolites despite missing reactions (Handorf et al., 2005, Kruse et al., 2008)”</p><disp-quote content-type="editor-comment"><p>5) While the authors mention reasons for robustness of their algorithms, they do not test these possibilities. Perhaps these could be addressed given that they have all the data required to answer the question.</p></disp-quote><p>The second hypothesis described in the text, which is the robustness of the algorithm to missing reactions, has already been validated and tested in the context of robustness (Handorf et al., 2005, Kruse et al., 2008). In that sense, it seems out of the scope of the paper to make an additional validation of the algorithm.</p><p>Regarding the other possibilities we proposed, we calculated the effect of genome degradation on the resulting GSMNs. The results are in Supplementary file 1—tables 16 and 21-23. Interestingly, the number of genes included in metabolic networks follows a decrease that is similar to the decrease of genes in the original genomes. So our first hypothesis, degraded genes are not related to metabolism, is refuted. The average number of reactions and metabolites in GSMNs decreases in degraded metabolic networks but the decrease is slower than the gene loss in associated MAGs. For instance in the experiment where 70% of genomes were 10 percent degraded, the average loss of genes in the dataset is of 6.94%, similar to the gene loss in GSMNs (7.02%). The average reaction loss in associated GSMNs is only of 3.92%. We also observe that the percentage of reactions associated to a gene is remarkably stable in all experiments. This suggests that the loss of reactions mainly occurs among reactions that are not associated to genes. It is also possible that the loss of genes in GSMNs is due to the redundancy loss: some reactions associated to several genes before degradation lose some of these gene associations after degradation.</p><p>We also added a few sentences in the main text, with reference to the Appendix.</p><p>“Additional analyses (Appendix 1) enable the refutation of the first hypothesis as the average gene loss in metabolic networks is similar to the genomic loss. Yet, the percentage of reactions associated to genes is similar in every experiments, which goes in the direction of the redundancy loss hypothesis. Likewise, we observed that the loss in reactions for degraded genomes is lower than the loss of genes.”</p><p>Appendix 1: Table 1 + the following text:</p><p>“MAGs from the rumen dataset were degraded by randomly removing contigs. The following degradations were tested: removal of 2% of genes in all MAGs, removal of 5% of genes in 80% of MAGs, removal of 5% of genes in all MAGs, removal of 10% of genes in 70% of MAGs. Table 1 summarises the characteristics of the genomes and GSMNs for all experiments. The average gene loss in genomes is similar to the average gene loss in metabolic networks. However, the average loss of metabolites and reactions is lower than the genetic loss: it increases more slowly than the loss of genes. For instance, the 2-percent degradation of MAGs leads to a nearly 2 percent decrease in reaction numbers in GSMNs. However, the 10-percent degradation in 70% of genomes (average gene loss of 7% in the initial community) only leads to a 5% decrease in reaction numbers. One notable observation is the stability in the percentage of reactions associated to genes, suggesting that the loss of reactions in degraded genomes mainly occurs among reactions that are not associated to genes. It is also possible that the loss of genes in GSMNs is due to the redundancy loss: some reactions associated to several genes before degradation lose some of these gene associations after degradation. Data for each genome and GSMN is available in Supplementary file 1—tables 16, 21-24.”</p><disp-quote content-type="editor-comment"><p>Please take into account the following points in order to improve the manuscript.</p><p>6) The methods section could benefit from a major revision as it is going back and forth from describing the datasets and the pipeline (the focus is unclear). It'll be useful to have more details on critical steps in the pipeline such as the metabolic objective and community reduction steps and keystone species discovery.</p></disp-quote><p>We thank the reviewers for the suggestion. We accordingly reorganised the sections and subsections. The Materials and methods are now at the end of the manuscript. Key concepts brought by the paper are moved in the first part of the Results section. We clarified the organisation of the Materials and methods. There is now one main section dedicated to the implementation of the pipeline, with subsections addressing its main steps, and mathematical formalisms to describe what is done by each step. The second part of the Materials and methods now describes the details regarding the applications of M2M to various datasets. One subsection describes the two collections of genomes and MAGs, including protocols for the robustness analysis, and a second subsection on the de novo reconstruction of MAGs and subsequent M2M analysis on individual samples.</p><disp-quote content-type="editor-comment"><p>7) The average number of metabolites per model is higher than the average number of reactions (1366 vs 1144 for the gut dataset). GSMNs usually have a lot more reactions than metabolites, hence their underdetermined stoichiometric matrices, and large number of degrees of freedom. Also, the average number of reachable metabolites is only 286, i.e. only about 20% of the metabolic network is reached. How is this possible, and how can one trust such models?</p></disp-quote><p>In order to build the SBML for the metabolic networks associated to the collections of genomes, the Padmet dependency of M2M (Aite et al., 2018) retrieves the list of metabolic reactions predicted by Pathway Tools and available in the reactions.dat file of the PGDBs. We built the list of metabolites by retrieving the reactants and products of all the reactions. That list of metabolites is consistently larger than the number of reactions for all PGDBs built by Pathway Tools. The reason for this observation is that metabolites contains both regular species, and classes of metabolites (for example “a-fatty-acid”). This therefore artificially increases the ratio of the number of metabolites to the number of reactions. We did not want to systematically “instantiate” each reaction involving a class of metabolites with all the instances of that class to prevent adding reactions that would not have genetic support.</p><p>The reachable metabolites as stated in the manuscript do not indicate that no other metabolite of the model could be producible. It is directly bound to the seeds (nutrients) that are provided to the algorithm. We chose small sets of nutrients for the gut reference genomes and rumen MAGs analyses. In addition to the small sets of seeds, it has to be noted that GSMN are considered individually for the computation of these metrics. In an ecosystem context, the associated species would instead benefit from the changes in the medium brought by the other species, widening the set of available nutrients. Additionally, the metabolic models are not gap-filled nor curated thereby not hiding the putative auxotrophies of the species that are not covered by our minimal medium (Bernstein et al., 2018).</p><disp-quote content-type="editor-comment"><p>8) There are multiple instances in the Results section where the authors present the p-value for a statistical test without presenting also the effect size and/or test statistic. Knowing the statistical significance is not helpful without knowing the effect size. For instance: &quot;The community diversity varied between disease statuses, with a significantly higher number of MGS observed in T1D individuals forming the initial communities (anova p &lt; 0.01, Tukey HSD test p &lt; 0.01 vs control).&quot;</p></disp-quote><p>We apologise for the missing information. We added the test statistic value and the Eta squared to all of our tests. Additionally, the tests and their results are summarised in Supplementary file 1—table 17.</p><disp-quote content-type="editor-comment"><p>9) The authors mention that &quot;A classification experiment on the composition of the community scope can, to some extent, (AUC = 0.73 +/- 0.15) decipher between healthy or diabetes statuses.&quot; But is this better than a classification based, for instance, on OTU analysis, or functional meta-genome analysis? Although the results are interesting, in the end it is hard to convince the reader that using GSMN reconstruction provides an advantage compared to using the metagenomics data directly.</p></disp-quote><p>We did not want this analysis to illustrate an advantage of GSMN reconstruction. We rather wanted to illustrate that despite metabolic redundancy in the gut microbiota and the automatic reconstruction of metabolic networks, qualitative differences are still noticeable at the level of metabolism between healthy and diabetic individuals: it is possible to distinguish to some extent the set of metabolites predicted to be producible by the microorganisms found in their faeces.</p><p>“Although metagenomic data would more precisely perform such a separation, it is informative to observe that despite metabolic redundancy in the gut microbiota, there are differences at the metabolic modelling level. Qualitative differences are noticeable between healthy and diabetic individuals: it is possible to distinguish them to some extent using the set of metabolites predicted to be producible by the microorganisms found in their faeces.”</p><disp-quote content-type="editor-comment"><p>10) In general, results are not compared to the state of the art and the Results section should contain more specific examples of metabolites/pathways of interest, bacterial species and their known or novel interactions. Additionally, it is mentioned that the datasets are similar – it'll be useful to have a section summarizing the results from all analyses.</p></disp-quote><p>We performed a literature analysis of species identified as essential symbionts in the gut collection of reference genomes and further studied with the power graph analysis. We retrieved some known features of species, consistent with our predictions, notably the ability of the <italic>Burkholderiales</italic> order to degrade aromatic compounds, or the variety of carbohydrates that <italic>Paenibacillus polymyxa</italic> could degrade.</p><p>We added the following paragraph to our results:</p><p>“We further investigated the essential symbionts associated to carbohydrate-derived metabolites in our study: <italic>Paenibacillus polymyxa</italic>, <italic>Lactobacilluslactis</italic>, <italic>Bacilluslicheniformis</italic>, <italic>Lactobacillusplantarum</italic>, and <italic>Dorea longicatena</italic>. […] Finally, the only essential symbiont predicted for the coA-related metabolites is Fusobacterium varium, a butyrate producer known for its ability to ferment both sugars and amino acids (Potrykus et al.,2008).”</p><p>In addition, we added the third dataset (diabetes) results to the Table 2 so that the three datasets can be compared together.</p><p>We understand the comment of the reviewers regarding comparison to state of the art methods. The underlying algorithms of M2M have already been validated and compared: the network expansion algorithm, but also the community selection algorithm (Frioux et al. Bioinformatics 2018) so we believe their comparison is out of the scope of the paper. We identified MICOM as a suitable pipeline for comparison to M2M in this manuscript and illustrated that despite the limited comparability of both tools, there are similarities between their predictions.</p><disp-quote content-type="editor-comment"><p>11) The utilization of keystone species in this work is not entirely correct. Here the authors use keystone species to mention species that are always present in the set of minimal communities enumerated to produce a given set of metabolites. The definition of keystone species in a community are those whose removal would cause the collapse of the community. Since the simulation method used by the authors doesn't allow to test for community stability, the application of this term does not seem appropriate.</p></disp-quote><p>We understand the concern raised by the reviewers. The ecological concept of keystone species used in the literature would be closer to our concept of essential symbiont, although the latter one is defined in a context of <italic>minimal</italic> communities. In order to remove this confusion, we chose “key species” to describe what we previously described as keystone species. We believe that while being close to the old name which will retain consistency for our users, this change removes the possible misunderstanding between the ecological concept and our output.</p><p>We therefore removed “keystone species” from the title, the figures and the manuscript and replaced it with “key species”.</p><p>In addition, we discussed these concepts:</p><p>“The identification of cornerstone taxa in microbiota is a challenge with many applications, for instance restoring balance in dysbiotic environments. Keystone species in particular are thoroughly looked for as they are key drivers of communities with respect to functions of interest (Banerjee et al., 2018). There is a variety of techniques to identify them (Carlstrom et al., 2019, Floch et al., 2020), and computational biology has a major role in it (Fisher et al., 2014, Berry et al., 2014). The identification of alternative and essential symbionts by M2M is an additional solution to help identify these critical species. In particular, essential symbionts are close to the concept of keystone species as they are predicted to have a role in every minimal community associated to a function. Additionally, alternative species and the study of their combinations in minimal communities, for example with power graphs, are also informative as they reveal equivalence groups among species.”</p><disp-quote content-type="editor-comment"><p>12) Keystone species are also described as the output of the tool and could use a more detailed report and examples in the Results section. These are very interesting and currently get lost between the lines.</p></disp-quote><p>The novel concepts brought by M2M on essential and alternative symbionts were described in Materials and methods but not in results in the first submission of the manuscript. We reorganised these sections and notably added a first result section that describes the pipeline <italic>per se</italic> as it is the main novelty brought by the paper. We describe the steps of the pipelines, its flexibility and focus on the definition of key species. The latter is also illustrated in a subfigure of Figure 1 to ease the understanding of the concepts on a small example. We also added in the Materials and methods section mathematical descriptions of the concepts used in the pipelines.</p><p>“A main characteristic of M2M is to provide at the end of the pipeline a set of key species associated to a metabolic function together with one minimal community predicted to satisfy this function. We define as key species organisms whose GSMNs s are selected in at least one of the minimal communities predicted to fulfil the metabolic objective. Among key species, we distinguish those that occur in every minimal community, suggesting that they possess key functions associated to the objective, from those that occur only in some communities. We call the former essential symbionts, and the latter alternative symbionts. These terms were inspired by the terminology used in flux variability analysis (Orth et al., 2010) for the description of reactions in all optimal flux distributions. If interested, one can compute the enumeration of all minimal communities with m2m-analysis, which will provide the total number of minimal communities as well as the composition of each. Figure 1B. illustrates these concepts. The initial community is formed of eight species. There are four minimal communities satisfying the metabolic objective. Each includes three species, and in particular the yellow one is systematically a member. Therefore the yellow species is an essential symbiont whereas the four other species involved in minimal communities constitute the set of alternative symbiont. As key species represent the diversity associated to all minimal communities, it is likely that their number is greater than the size of a minimal community, as this is the case in Figure 1B.”</p><disp-quote content-type="editor-comment"><p>13) There are several aspects of the figures that can be improved.</p><p>– Figure 1 is confusing could use some reorganization, so the pipeline steps are clear, consider adding numbers to the different steps.</p></disp-quote><p>Thank you for the suggestion. Accordingly, we reorganised Figure 1 with numbered steps and boxes to distinguish them. In addition, we illustrated the concept of key species, essential symbionts and alternative symbionts in Figure 1B and in the beginning of the Results section.</p><p>“Legend of Figure 1: a. Main steps of the M2M pipeline and associated tools. The software's main pipeline (m2m workflow) takes as inputs a collection of annotated genomes that can be reference genomes or metagenomics-assembled genomes. The first step of M2M consists in reconstructing metabolic networks with Pathway Tools (step 0). This first step can be bypassed and GSMN s can be directly loaded in M2M. The resulting metabolic networks are analysed to identify individual (step 1) and collective (step 2) metabolic capabilities. The added-value of cooperation is calculated (step 3) and used as a metabolic objective to compute a minimal community and key species (step 4). Optionally, one can customise the metabolic targets for community reduction. The pipeline without GSMN reconstruction can be called with m2m metacom, and each step can also be called independently (m2m iscope, m2m cscope, m2m added value, m2m mincom). b. Description of key species. Community reduction performed at step 4 can lead to multiple equivalent communities. M2M provides one minimal community and efficiently computes the full set of species that occur in all minimal communities, without the need for a full enumeration, thanks to solving heuristics. It is possible to distinguish the species occurring in every minimal community (essential symbionts), from those occurring in some (alternative symbionts). Altogether, these two groups form the key species.”</p><disp-quote content-type="editor-comment"><p>– Figure 2 is very hard to digest. I have difficulties understanding what the figure actually tells me. What is the meaning of the white fields, are the sub-figures connected despite having a different x-axis, and what is the overall message?</p></disp-quote><p>The representations in Figure 2 are alternatives to Venn diagrams. The white fields indicate missing elements in the corresponding dataset. For example in a), there is a set of 37 metabolites (on the right) that the original dataset can produce, but not the other datasets. On the left of subfigure c), there is a set of 11 species that are key species in all datasets except in the one where all genomes were degraded at 5%. We added examples to ease the reading in subfigure a). All subfigures illustrate some information that M2M provided when run on each of the five datasets. We added a sentence to clarify the independence between all subfigures. We removed the “Number of” in the legend titles of all subfigures. The overall message from this figure is the relative stability of the information computed by M2M to small degradations of genomes.</p><p>“Legend of Figure 2: Subfigures A to E each represent one piece of information computed by M2M and compared between the five experiments. […] Vertical overlaps between sets represent intersections (e.g groups of metabolites retrieved in several datasets) whose size is indicated on the X axis. For example, there is a set of 37 metabolites that are producible in the original dataset only, and a set of 5 metabolites predicted as producible in all datasets but the one where 70% of genomes were 10%-degraded. A full superimposition of all the coloured bars would indicate a complete stability of the community scope between datasets.”</p><p>“Altogether, Figure 2 illustrates relative stability of the information computed by M2M to missing genes. The criteria typically used for MAG quality (&gt;80% completeness, &lt;10% degradation) are likely sufficient to get a coarse-grained, yet valuable first picture of the metabolism.”</p><disp-quote content-type="editor-comment"><p>– The power graphs are interesting, but it is unclear if they were generated by the tool since this is not clear in the manuscript. In addition, the usefulness of the power graphs in Figure 3 is not fully evident. What do we learn from them and what are the large number of circles? If three subgroups are connected, why are two of them encircled in an extra circle?</p></disp-quote><p>We implemented the generation of power graphs in <italic>m2m-analysis</italic>. We added this information in the legend of Figure 3. The colouring of the power graph in Figure 3 was nonetheless done manually. The power graph analysis is informative as it pinpoints groups of equivalent species among the key species. Visualising the association between members of thousands of equivalent minimal communities is a challenge. Here we compressed graph describing these associations. Specific patterns from the original graph are therefore illustrated as links between power nodes (the circles) and we retrieve in the power nodes key species that play the same role in all minimal communities (and therefore are interchangeable with respect to the metabolic objective). Some circles can be included into others to limit the number of edges to be represented. Indeed, there is not a unique representation of a power graph, the algorithm we use provides one solution. The number of power edges is minimal, which leads to nesting of (power) nodes. For example, in power graph a), power node 1 is linked to power nodes 2, 3, 4 and 5. Including the latter four in a larger power node makes it possible to represent the associations with a single edge.</p><p>We added details in the legend of Figure 3. We also explicated that power graphs can be created by m2m-analysis in the Materials and methods.</p><disp-quote content-type="editor-comment"><p>– Figure 4 presents an analysis that is downstream of the presented software paper since it illustrates how the output of the software can be further analyzed. In order to appear in the main text of the manuscript, it needs to be better explained since it is hard to understand with the information given. For example, what do the Receiver Operator Curves (ROC) actually represent? More background information is required.</p></disp-quote><p>We added some context on the analysis in the beginning of the legend: “M2M was run on collections of GSMNs associated to MAGs identified in metagenomic samples from a cohort of healthy and diabetic individuals.”. The experiment that led to the ROC curve aimed at identifying whether differences occur in the contents of producible metabolites between healthy and diseased individuals. Indeed, it is not straightforward whether the set of producible metabolites predicted for the intestinal community would qualitatively differ between healthy and diseased individual, notably because the metabolism of the gut microbiota is redundant, and because differences are likely to be quantitative. Here, the classification experiments that there are qualitative differences, that can to some extent, distinguish the two categories. “Figure d is the receiver operating curve (ROC) of a SVM classification experiment aiming at predicting the disease status for the MHD cohort (control n=49 or diabetes n=66) based on the community scope composition.”</p><disp-quote content-type="editor-comment"><p>14) The authors should define the essential and non-essential symbionts and add more context on their known interactions in the introduction and Results sections.</p></disp-quote><p>The novel concepts brought by M2M on essential and alternative symbionts were described in Materials and methods but not in results in the first submission of the manuscript. We reorganised these sections in order to define key concepts that are novel in the results.</p><p>We added a subfigure to Figure 1 to illustrate the concept of key species, essential and alternative symbionts.</p><p>“A main characteristic of M2M is to provide at the end of the pipeline a set of key species associated to a metabolic function together with one minimal community predicted to satisfy this function. We define as key species organisms whose GSMNs s are selected in at least one of the minimal communities predicted to fulfil the metabolic objective. Among key species, we distinguish those that occur in every minimal community, suggesting that they possess key functions associated to the objective, from those that occur only in some communities. We call the former essential symbionts, and the latter alternative symbionts. These terms were inspired by the terminology used in flux variability analysis (Orth et al., 2010) for the description of reactions in all optimal flux distributions. If interested, one can compute the enumeration of all minimal communities with m2m-analysis, which will provide the total number of minimal communities as well as the composition of each. Figure 1B. illustrates these concepts. The initial community is formed of eight species. There are four minimal communities satisfying the metabolic objective. Each includes three species, and in particular the yellow one is systematically a member. Therefore the yellow species is an essential symbiont whereas the four other species involved in minimal communities constitute the set of alternative symbiont. As key species represent the diversity associated to all minimal communities, it is likely that their number is greater than the size of a minimal community, as this is the case in Figure 1B.”</p><disp-quote content-type="editor-comment"><p>15) The comparison to other platforms such as Kbase and other genome scale models should be discussed in more detail in the introduction and Discussion sections. It is unclear how this tool can make use of available good quality curated reconstructions as input.</p></disp-quote><p>M2M proposes a solution based on the MetaCyc database and its associated software Pathway Tools for GSMN reconstruction. We developed this solution to facilitate the automatic use of Pathway Tools on a large number of genomes. However, we are aware that several software solutions coexist for this objective. This is why one can provide to M2M SBML files of metabolic networks that were previously reconstructed. This is what we did when we tested the AGORA metabolic models on the diabetes dataset. The analyses of M2M without reconstruction can be done with the m2m metacom command.</p><p>We clarified the possibility to use external data with M2M in the legend of Figure 1.</p><p>Legend of Figure 1: “The first step of M2M consists in reconstructing metabolic networks with Pathway Tools (step 0). This first step can be bypassed and GSMNs can be directly loaded in M2M.”</p><p>“GSMNs obtained from other platforms such as Kbase (Arkin et al., 2018), ModelSEED (Henry et al., 2010) or CarveMe (Machado et al., 2018a), can also be used as inputs to M2M for all metabolic analyses. For instance, we used highly curated models from AGORA in the application of M2M to metagenomic datasets. The above reconstruction platforms already implement solution to facilitate the treatment of large genomic collections. There is no universal implementation for GSMN reconstruction (Mendoza et al., 2019); depending on their needs (local run, external platform, curated or non-curated GSMNs…), users can choose either method and connect it to M2M.”</p></body></sub-article></article>