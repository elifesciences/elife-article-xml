<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN"  "JATS-archivearticle1-3-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">89151</article-id><article-id pub-id-type="doi">10.7554/eLife.89151</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Disrupting abnormal neuronal oscillations with adaptive delayed feedback control</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-320660"><name><surname>Leite de Castro</surname><given-names>Domingos</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2539-0311</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-320661"><name><surname>Aroso</surname><given-names>Miguel</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-3118-0185</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-320662"><name><surname>Aguiar</surname><given-names>A Pedro</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-320663"><name><surname>Grayden</surname><given-names>David B</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-191416"><name><surname>Aguiar</surname><given-names>Paulo</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4164-5713</contrib-id><email>pauloaguiar@i3s.up.pt</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/043pwc612</institution-id><institution>Neuroengineering and Computational Neuroscience Lab, i3S - Instituto de Investigação e Inovação em Saúde, Universidade do Porto</institution></institution-wrap><addr-line><named-content content-type="city">Porto</named-content></addr-line><country>Portugal</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/043pwc612</institution-id><institution>Faculdade de Engenharia, Universidade do Porto</institution></institution-wrap><addr-line><named-content content-type="city">Porto</named-content></addr-line><country>Portugal</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01ej9dk98</institution-id><institution>Department of Biomedical Engineering, University of Melbourne</institution></institution-wrap><addr-line><named-content content-type="city">Melbourne</named-content></addr-line><country>Australia</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Bathellier</surname><given-names>Brice</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02feahw73</institution-id><institution>CNRS</institution></institution-wrap><country>France</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Poirazi</surname><given-names>Panayiota</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01gzszr18</institution-id><institution>FORTH Institute of Molecular Biology and Biotechnology</institution></institution-wrap><country>Greece</country></aff></contrib></contrib-group><pub-date publication-format="electronic" date-type="publication"><day>07</day><month>03</month><year>2024</year></pub-date><volume>13</volume><elocation-id>e89151</elocation-id><history><date date-type="received" iso-8601-date="2023-05-05"><day>05</day><month>05</month><year>2023</year></date><date date-type="accepted" iso-8601-date="2024-03-05"><day>05</day><month>03</month><year>2024</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at .</event-desc><date date-type="preprint" iso-8601-date="2022-07-06"><day>06</day><month>07</month><year>2022</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2022.07.05.498735"/></event></pub-history><permissions><copyright-statement>© 2024, Leite de Castro et al</copyright-statement><copyright-year>2024</copyright-year><copyright-holder>Leite de Castro et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-89151-v2.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-89151-figures-v2.pdf"/><abstract><p>Closed-loop neuronal stimulation has a strong therapeutic potential for neurological disorders such as Parkinson’s disease. However, at the moment, standard stimulation protocols rely on continuous open-loop stimulation and the design of adaptive controllers is an active field of research. Delayed feedback control (DFC), a popular method used to control chaotic systems, has been proposed as a closed-loop technique for desynchronisation of neuronal populations but, so far, was only tested in computational studies. We implement DFC for the first time in neuronal populations and access its efficacy in disrupting unwanted neuronal oscillations. To analyse in detail the performance of this activity control algorithm, we used specialised in vitro platforms with high spatiotemporal monitoring/stimulating capabilities. We show that the conventional DFC in fact worsens the neuronal population oscillatory behaviour, which was never reported before. Conversely, we present an improved control algorithm, adaptive DFC (aDFC), which monitors the ongoing oscillation periodicity and self-tunes accordingly. aDFC effectively disrupts collective neuronal oscillations restoring a more physiological state. Overall, these results support aDFC as a better candidate for therapeutic closed-loop brain stimulation.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>neuromodulation</kwd><kwd>closed-loop control</kwd><kwd>neuronal oscillations</kwd><kwd>delayed feedback control</kwd><kwd>neurostimulation</kwd><kwd>microelectrode arrays</kwd><kwd>DFC</kwd><kwd>MEAs</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Rat</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution>La Caixa Foundation</institution></institution-wrap></funding-source><award-id>HR22-00189</award-id><principal-award-recipient><name><surname>Aguiar</surname><given-names>Paulo</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100020405</institution-id><institution>Santa Casa da Misericórdia de Lisboa</institution></institution-wrap></funding-source><award-id>MB-12-2022</award-id><principal-award-recipient><name><surname>Aguiar</surname><given-names>Paulo</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001871</institution-id><institution>Fundação para a Ciência e a Tecnologia</institution></institution-wrap></funding-source><award-id>SFRH/BD/143956/2019</award-id><principal-award-recipient><name><surname>Leite de Castro</surname><given-names>Domingos</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001871</institution-id><institution>Fundação para a Ciência e a Tecnologia</institution></institution-wrap></funding-source><award-id>CEECIND/03415/2017/CP1392/CT0003</award-id><principal-award-recipient><name><surname>Aroso</surname><given-names>Miguel</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Adaptive delayed feedback control is presented as a new real-time, closed-loop control algorithm for neurostimulation which can disrupt oscillations and reduce network synchrony in neuronal populations.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>The excessive oscillatory synchronisation that emerges in neurological disorders, such as Parkinson’s disease and epilepsy (<xref ref-type="bibr" rid="bib20">Uhlhaas and Singer, 2006</xref>), can be disrupted using direct electrical stimulation (<xref ref-type="bibr" rid="bib5">Edwards et al., 2017</xref>). Despite its potential, conventional brain stimulation, therapies still rely on continuous open-loop stimulation, leading to excessive stimulation and burdensome side-effects (<xref ref-type="bibr" rid="bib9">Kuo et al., 2018</xref>). In theory, closed-loop stimulation guided by an efficient control algorithm should provide better outcomes, disrupting the pathological neuronal dynamics with minimal intervention. But, given the complexity of neuronal systems, it is very challenging to foresee what type of control algorithms would be effective. Multiple in silico studies focused on employing closed-loop control methods to desynchronise pathological oscillations in computational models of neurological disorders (<xref ref-type="bibr" rid="bib1">Beverlin Ii and Netoff, 2012</xref>; <xref ref-type="bibr" rid="bib7">Holt et al., 2016</xref>; <xref ref-type="bibr" rid="bib12">Nabi et al., 2013</xref>; <xref ref-type="bibr" rid="bib23">Weerasinghe et al., 2021</xref>; <xref ref-type="bibr" rid="bib24">Witt et al., 2013</xref>), but these have not been translated into studies with real neuronal systems to access its viability.</p><p>A particularly prevalent method in the field is delayed feedback control (DFC), a technique from chaos theory developed to stabilise/destabilise chaotic systems using minimal perturbations (<xref ref-type="bibr" rid="bib16">Pyragas, 1992</xref>; <xref ref-type="bibr" rid="bib18">Rosenblum and Pikovsky, 2004a</xref>). DFC controls the system by applying a feedback signal proportional to the difference between the current oscillation amplitude and the oscillation amplitude from a fixed delay into the past. DFC has been extensively applied in the context of in silico neuroscience, with studies focusing on specific disorders such as Parkinson’s disease (<xref ref-type="bibr" rid="bib19">Rosenblum and Pikovsky, 2004b</xref>; <xref ref-type="bibr" rid="bib21">Vlachos et al., 2016</xref>; <xref ref-type="bibr" rid="bib14">Popovych et al., 2017</xref>; <xref ref-type="bibr" rid="bib3">Daneshzand et al., 2018</xref>; <xref ref-type="bibr" rid="bib15">Popovych and Tass, 2019</xref>; <xref ref-type="bibr" rid="bib25">Yu et al., 2021</xref>) and epilepsy (<xref ref-type="bibr" rid="bib26">Zhou et al., 2020</xref>). However, there is still controversy in the literature regarding its efficacy and whether it may instead promote synchronisation, depending on the baseline levels of synchrony of the modelled network (<xref ref-type="bibr" rid="bib4">Dovzhenok et al., 2013</xref>). Thus, it is critical to test the effectiveness of DFC with biological neuronal networks that display synchronised oscillatory firing. Neuronal cultures on microelectrode arrays (MEAs) are a useful testbed for this task: these cultures self-organise into complex interconnected networks with quasiperiodic synchronised bursting, and MEAs enable closed-loop modulation of the neuronal activity, providing concurrent recording and stimulation at multiple points of the population with high spatial and temporal resolution (<xref ref-type="bibr" rid="bib13">Obien et al., 2014</xref>).</p><p>In this work, we implemented, for the first time, the DFC algorithm to disrupt the synchronised oscillatory bursting of biological neuronal populations. The cells were cultured on MEAs and the network activity was monitored and controlled in real time with electrical stimulation. We show that traditional DFC lacks the adaptability to cope with the malleable dynamics of biological networks and may actually impose a new firing periodicity. As an alternative, we developed and implemented an adaptive DFC (aDFC) algorithm that self-tunes to better predict the current oscillation phase and periodicity. We demonstrate that aDFC reduces the synchronisation of the network and efficiently disrupts the baseline oscillation. While doing so, we identified and characterised a new feature of biological neuronal networks: the intrinsic firing dynamics of a network unveils its propensity for neuromodulation. To better understand this relationship, we went back to the in silico neuronal networks and revealed that their controllability can be conditioned by specific parameters of the network architecture, such as the excitatory/inhibitory balance and overall synaptic weights of the network connections. Taking all together, we show that theoretical predictions regarding the efficacy of DFC might be misleading and we present an improved algorithm for closed-loop electrical stimulation. The knowledge gathered while testing these algorithms in vitro was relevant to recognise shortcomings of in silico simulations and may guide the development of better computational neuronal models. Our results revealed fundamental properties and considerations regarding the controllability of neuronal systems.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>To assess the potential of DFC as a closed-loop brain stimulation protocol (<xref ref-type="fig" rid="fig1">Figure 1A</xref>, top) for suppressing pathological neuronal oscillations, we developed an in vitro setup composed of hippocampal networks cultured on MEAs, a workstation running the control algorithms and specialised hardware (2100MEA-System, Multichannel Systems [MCS]) interfacing both environments at very low latencies (<xref ref-type="fig" rid="fig1">Figure 1A</xref>, bottom). Our in vitro setup provides a powerful testbed to analyse DFC algorithms as it incorporates neuronal populations that display synchronous oscillations (here in the form of quasiperiodic network bursts [NB] with periodicities in the seconds range), an acquisition system that measures the population’s extracellular activity at high spatiotemporal resolution enabling the inference of synchrony among neurons, on-demand electrical pulse generators to stimulate the network at high spatiotemporal resolution, and a feedback loop with low actuation latency in the milliseconds range (orders of magnitude below that of the neuronal dynamics under control).</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Controlling pathological oscillations with adaptive delayed feedback control (aDFC).</title><p>(<bold>A</bold>) In vivo concept of implantable closed-loop neurostimulation and the analogous in vitro setup developed. Here, we have dissociated hippocampal neurons as a brain, microelectrode arrays as implantable electrodes, emergent periodic network bursting as pathological synchronous oscillations, a workstation as an implantable chip, and an external stimulator as an implantable neurostimulator. (<bold>B</bold>) Scheme of the DFC algorithms. The instantaneous population firing rate is calculated and filtered by a damped oscillator. The actuation signal (stimulation frequency) is obtained by subtracting the ongoing oscillation from the past half-cycle delayed oscillation. The natural frequency of the oscillator, <italic>ω</italic>, and the duration of the half-cycle delay are updated online (adaptive component in blue) by detecting the synchronous events and their current periodicity, <italic>T</italic>. (<bold>C</bold>) Controller computations under different firing regimes – oscillatory (left), asynchronous (right), and mixed, i.e., oscillatory with induced sparse activity (middle). Spike detection is performed for the monitoring electrodes (top) and the spike train is convolved online with a square window to compute the instantaneous population firing rate (middle). Synchronous events (black circles) are detected using a threshold crossing method and used to update the oscillation periodicity. The actuation signal (red) is built by subtracting the oscillator and delayed oscillator signals (blue and grey, respectively) and translated to a stimulation frequency signal.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-89151-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Representative example of adaptive delayed feedback control (aDFC) adaptability in a network with fast-changing dynamics.</title><p>(<bold>A</bold>) Instantaneous network firing rate during spontaneous activity. The black dots represent the real-time detection of network bursts performed by the adaptive controller. (<bold>B</bold>) Inter-burst interval predicted by the aDFC controller and the associated real inter-bursts. Every time the controller detects a new network burst (black dots in A) it estimates when the next burst would spontaneously occur by calculating the median of the previous five inter-burst intervals. This prediction is used to properly tune the controller’s half-cycle delay and the natural frequency of the oscillators used to create the actuation signal. In this example the stimulation is turned OFF, so the controller is simply tracking the neuronal activity without interfering with it. (<bold>C</bold>) Histogram of the prediction error for the representative example shown in A and B. The largest errors result from the prediction lag associated with the fast transitions between bursting regimes. The fact that the prediction error is typically small, even under these fast-changing network dynamics, means that the half-cycle delay and the oscillator’s natural frequency of aDFC are properly self-tuned in real time.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-89151-fig1-figsupp1-v2.tif"/></fig></fig-group><p>The core of the DFC algorithm used (<xref ref-type="fig" rid="fig1">Figure 1B</xref>, black) is analogous to implementations reported in the literature (see Methods section for details). After spike detection (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, top row), the instantaneous population firing rate is calculated (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, middle row) and filtered by a damped oscillator (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, bottom row in blue). The resulting signal is a good representation of the oscillatory behaviour of the network, such as that exhibited while the stimulation is turned OFF (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, left). The feedback signal (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, left, bottom in red) is then created by subtracting the ongoing oscillation from the half-cycle delayed oscillation (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, bottom row in grey). This way, when the activity is oscillatory, the actuation signal is maximal at the antiphase of the neuronal oscillation (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, left and middle). The obtained feedback signal is linearly translated to stimulation frequency by applying a fixed gain. Since the actuation signal is explicitly dependent on the neuronal oscillation, stimulation is highly activated when synchrony is high (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, middle) and decreases as this firing pattern vanishes (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, right). Expanding on the DFC algorithm, and to respond to the dynamic nature of biological neuronal systems, we improved canonical DFC to aDFC by adding an extra component that detects the synchronous firing events (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, black circles in middle row). This way, aDFC monitors the current periodicity of the neuronal oscillation (<italic>T</italic>) and updates the delay duration (<italic>T</italic>/2) and natural frequency of the oscillator (<italic>ω</italic>) accordingly (<xref ref-type="fig" rid="fig1">Figure 1B</xref>, blue and <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>).</p><p>The neuromodulation performance of the control algorithms was analysed in a series of experiments with multiple neuronal populations on MEAs. Each experiment had three stages: 5 min of spontaneous activity pre-stimulation (OFF), 5 min under stimulation (ON), and 5 min of spontaneous activity post-stimulation (OFF). Every network, here defined as a neuronal culture on a given day in vitro, was submitted to three different stimulation algorithms: standard DFC, aDFC, and random stimulation. During random stimulation, the electrical pulses were triggered by a Poisson process with an average frequency identical to that obtained in the preceding aDFC test. In all algorithms, stimulation was provided as monophasic negative voltage pulses at controlled timings. To ensure that the individual pulses had a comparable effect on the different neuronal networks, we chose a single stimulation electrode that triggered a neuronal response measured by neighbouring electrodes and the minimum voltage amplitude that achieved that response (see Methods section).</p><sec id="s2-1"><title>Adaptive component is required due to the dynamic nature of neuronal populations</title><p>Changes in the neuronal dynamics caused by the stimulation protocols can be evaluated using the wavelet transform of the instantaneous network firing rate (<xref ref-type="fig" rid="fig2">Figure 2A and B</xref>). This representation evidences how the bursting periodicity of the network changes over time. Consistent inter-burst intervals (i.e. consistent neuronal oscillations) will appear as an horizontal line in the wavelet domain, corresponding to the fundamental frequency of the oscillation. When stimulation was activated, both DFC and aDFC showed clear effects on the neuronal dynamics. DFC stimulation imposed a change to a faster and very consistent oscillation (DFC periods in <xref ref-type="fig" rid="fig2">Figure 2A and C</xref>). This happens because DFC initially forces the network to fire in its antiphase, creating a change in the bursting periodicity. Since this change is not monitored to update the controller’s delay, the delayed oscillator (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, grey) no longer matches the antiphase of the ongoing oscillation. Therefore, stimulation becomes prejudicial as it is sent in phase with the new oscillation, reinforcing it (DFC period in <xref ref-type="fig" rid="fig2">Figure 2C</xref>).</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Representative example of the effect of delayed feedback control (DFC) and adaptive DFC (aDFC) stimulation protocols.</title><p>(<bold>A, B</bold>) Wavelet transform of the instantaneous firing rate of a network under DFC (<bold>A</bold>) and aDFC (<bold>B</bold>) protocols. (<bold>C, E</bold>) Example of the instantaneous firing rate of the network before stimulation (black) and during DFC (<bold>C</bold>, green) and aDFC (<bold>E</bold>, blue) stimulation. The signals shown in C and E correspond to the narrow time windows marked in A and B, respectively. (<bold>D, F</bold>) Power spectrum density of the instantaneous firing rate of the network before stimulation (black) and during DFC (<bold>D</bold>, green) and aDFC (<bold>F</bold>, blue) stimulation.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-89151-fig2-v2.tif"/></fig><p>On the other hand, aDFC disrupts the spontaneous oscillation frequency exhibited by the network, creating a firing regime where there is no predominant oscillation (aDFC periods in <xref ref-type="fig" rid="fig2">Figure 2B and E</xref>). In this case, the controller is constantly forcing the network to fire in antiphase and aDFC adapts as the network oscillation changes with the stimulation. To quantify this effect, we calculated the magnitude of the main oscillation by calculating the signal-to-noise ratio (SNR) of the power spectrum density (PSD) of the instantaneous firing rate for the ON and OFF segments (<xref ref-type="fig" rid="fig2">Figure 2D and F</xref>).</p></sec><sec id="s2-2"><title>Network controllability is conditioned by intrinsic population dynamics</title><p>The effect of the different stimulation protocols was evaluated using three metrics calculated for the OFF and ON periods: synchrony, firing rate, and oscillation intensity. Synchrony measures the degree of co-activation of multiple electrodes (see Methods); firing rate corresponds to the average number of spikes per electrode per unit of time (not to be confused with the instantaneous network firing rate signal presented in <xref ref-type="fig" rid="fig2">Figure 2C and E</xref>); oscillation intensity corresponds to the SNR of the PSD of the instantaneous firing rate signal (<xref ref-type="fig" rid="fig2">Figure 2D and F</xref>).</p><p>The three stimulation protocols were repeated multiple times for each network following the OFF-ON-OFF routine. Their effects on a given network are evidenced by normalising the values of each feature to the initial OFF period (before stimulation) across the multiple trials (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). This also reveals how the dynamics are recovered once the stimulation is turned OFF. Note that, for the oscillation intensity, this normalisation corresponds to the difference between the ON and OFF periods, since the SNR scale is logarithmic [dB].</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Comparison of controllable and uncontrollable networks.</title><p>(<bold>A</bold>) Results obtained from multiple repetitions of the three stimulation protocols for a single network. We calculated the synchrony, firing rate, and oscillation intensity for the three segments – pre-stimulation (OFF), stimulation (ON), post-stimulation (OFF) – of each experiment and normalised each metric to the value of the pre-stimulation period. For the oscillation intensity, this normalisation corresponds to the difference and not ratio, since the signal-to-noise ratio (SNR) is given in dB (logarithmic scale). Each triplet of points corresponds to one experiment performed with either adaptive delayed feedback control (aDFC) (blue), DFC (green), or Poisson (red) stimulation. (<bold>B</bold>) Three-dimensional (3D) feature space – firing rate vs. synchrony vs. oscillation intensity – for the network in A. Each line corresponds to the metrics evolution from the initial OFF to ON (from the first to the second point in A). This network is considered controllable since each protocol consistently drove the network to a distinct subspace, meaning that it had a unique and reproducible effect. (<bold>C</bold>) Representative example of the 3D feature space for an uncontrollable network where the effect of each stimulation protocol is indistinguishable from the others. (<bold>D</bold>) Networks were separated into controllable (blue) and uncontrollable (grey) by computing the multivariate ANOVA (MANOVA) of the ON metrics for the different stimulation protocols. Networks with p-values lower than 0.05 had separable effects in the 3D feature space of the metrics and were thus considered controllable (8/13). (<bold>E</bold>) Pre-stimulation firing rate and synchrony for all experiments performed with each network, divided into controllable and uncontrollable networks. Each dot corresponds to one experiment performed with either DFC, aDFC, or Poisson in a given network. The experiments performed with the same network are confined in a polygon. The black traced line corresponds to the first principal component (PC1) of the standardised (z-score, i.e. mean equals zero and standard deviation equals one) synchrony and firing rate defining a relevant descriptor of the neuronal dynamics. (<bold>F</bold>) Distribution of the baseline neuronal dynamics along PC1, defined in E, showing that the controllable networks have an intermediate level of spontaneous firing rate and synchrony.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-89151-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Controllable and uncontrollable networks across cultures, DIVs, and animal preparations.</title><p>(<bold>A</bold>) Dendrogram of the networks according to the controllability measure (multivariate ANOVA [MANOVA] p-values of the modulation results obtained with the different stimulation protocols). This representation shows that the controllable networks (p-values &lt;0.05) are more similar to each other than to the uncontrollable ones. (<bold>B</bold>) Spontaneous firing rate and synchrony for the all the trials of the different networks, separated into controllable and uncontrollable networks. (<bold>C</bold>) Detail of B, evidencing how some cultures have very well-confined spontaneous dynamics. (<bold>D</bold>) Division of the networks according to the associated neuronal culture. When probed in different days, the same neuronal culture can be considered a different dynamical system because the spontaneous dynamics are clearly different. Therefore, we consider these to be different networks. For example, culture 1 (blue) and culture 2 (orange) led to two different networks each and, in the case of culture 2 one network is controllable whereas the other is not. Cultures 3–11 (grey) only have one network each and are represented with the same colour for clarity. (<bold>E</bold>) Evolution of the networks with the DIV. Also, the DIV by itself does not predict which networks are controllable and uncontrollable as these groups span multiple overlapping DIVs. (<bold>F</bold>) The networks used came from a total of five different animal preparations. The distinction of controllable and uncontrollable networks cannot be attributed to any particular preparation, as the same preparation can lead to both types of networks.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-89151-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Representative example of the effect of Poisson stimulation in the frequency domain.</title><p>(<bold>A</bold>) Wavelet transform of the instantaneous network firing rate during the OFF and ON periods. (<bold>B</bold>) Example of the instantaneous firing rate of the network before stimulation (black) and during Poisson stimulation. The signals shown in B correspond to the narrow time windows marked in A. (<bold>C</bold>) Power spectrum density of the instantaneous firing rate of the network before stimulation (black) and during Poisson stimulation. Since the random Poisson stimulation is an open-loop control algorithm, i.e., it does not adapt to the ongoing network dynamics, the frequency of the Poisson process (which triggers the stimulation) had tuned beforehand. For that, we set the average stimulation frequency to match the average stimulation frequency used in the antecedent adaptive delayed feedback control (aDFC) experiment. It is important to note that, even if properly tuned, open-loop Poisson stimulation will not adjust as the network approaches the desired state or stop stimulating once it is reached. This is relevant for cases like the one displayed in <xref ref-type="fig" rid="fig7">Figure 7</xref>, where aDFC and Poisson stimulation led to very different network responses.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-89151-fig3-figsupp2-v2.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 3.</label><caption><title>Delayed feedback control (DFC) leads to an increase in oscillation intensity and frequency.</title><p>(<bold>A</bold>) Change in oscillation frequency (fold change) as a function of the change in oscillation intensity (signal-to-noise ratio [SNR] difference) from the OFF to ON periods. In this representation, the left and right quadrants are respectively associated with a decrease and increase in oscillation intensity when stimulation is turned ON. The lower and upper quadrants are respectively associated with a reduction and increase in the oscillation frequency during stimulation. The oscillation frequency corresponds to the frequency at the peak of the power spectrum density (PSD). To account for the fact that oscillations with very low SNR may not have a meaningfull value of oscillation frequency, the opacity of the datapoints is proportional to the value of SNR during the ON period. Thus, the more transparent points have less meaningful values of oscillation frequency. Each datapoint corresponds to an individual experiment performed with a given controllable network and stimulation protocol (adaptive DFC [aDFC] in blue, DFC in green, Poisson in red, and control in grey). The experiments performed with DFC are mostly located on the upper right quadrant, meaning that it consistently leads faster and more consistent oscillations. aDFC and random stimulation lead to a decrease in oscillation intensity, and the oscillation frequency is typically neglectable (datapoints are mostly transparent). As expected, the control group, where no stimulation is applied, is located at the centre of the map, since the activity is similar during the ON and OFF periods. (<bold>B</bold>) Representative examples of the PSD, from where the oscillation intensity and frequency are calculated, during the OFF and ON periods for the three stimulation protocols and control, marked with arrows in panel A.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-89151-fig3-figsupp3-v2.tif"/></fig></fig-group><p>Some networks were consistently driven to distinct regions of the features space with each stimulation protocol (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). We refer to these as <italic>controllable</italic> networks – hypothetically, an ideal controller could lead such networks to any desired reachable state. On the other hand, some networks did not exhibit consistent modulation when stimulated using the different protocols (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). We termed these <italic>uncontrollable</italic> networks. Based on this definition, each network was classified as either controllable or uncontrollable by calculating the multivariate ANOVA (MANOVA) for the ON values of the three metrics (see Methods for details). Networks with low p-values (p&lt;0.05) (i.e. networks with significantly distinct neuromodulation results for the different stimulation protocols) were considered controllable (<xref ref-type="fig" rid="fig3">Figure 3D</xref>). Conceptually, controllability of a network is dependent on the assumed stimulation configuration: a network may be controllable with an array of stimulating electrodes, and uncontrollable using a single stimulating electrode.</p><p>Having recognised that some networks are controllable, we questioned if there are any common traits that make them more prone to neuromodulation. Even though there may be an indefinite number of hidden variables that influence the controllability of a neuronal population, some of these properties could be translated into specific firing dynamics, which we can access with the MEAs. If that is the case, then we expect the controllable and uncontrollable networks to have distinct fingerprints in their spontaneous firing dynamics. To evaluate this hypothesis, as well as ensure that the uncontrollable networks did not simply result from an ineffective stimulation electrode, we compared the spontaneous firing rate and synchrony during the initial OFF period (before stimulation) for all the experiments performed with all networks. This revealed that, as hypothesised, controllable and uncontrollable networks lie in different regions of the feature space (<xref ref-type="fig" rid="fig3">Figure 3E</xref> and <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). Furthermore, controllable networks are in the centre, which is associated with intermediate levels of spontaneous firing rate and synchrony. This can be further evidenced by calculating the principal components (using principal components analysis) of the standardised map and projecting the values of each experiment along the principal component. A histogram shows that the experiments performed with controllable networks are in the centre, surrounded by a bimodal distribution of the experiments performed with uncontrollable networks (<xref ref-type="fig" rid="fig3">Figure 3F</xref>).</p></sec><sec id="s2-3"><title>aDFC disrupts oscillations and decreases overall synchrony in controllable networks</title><p>The performances of DFC, aDFC, and Poisson stimulation were evaluated by comparing their average effects on the three metrics across all the controllable network (<xref ref-type="fig" rid="fig4">Figure 4</xref>), where each datapoint corresponds to the metric’s mean for all the experiments performed with a given network and stimulation protocol. Uncontrollable networks are not considered here as their results are, by definition, not reproducible. We included trials without stimulation for each network as a control group to capture the natural variability of each metric; in these, we calculated the metrics for two consecutive 5 min blocks of spontaneous activity, representing the initial OFF and ON periods.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Effect of adaptive delayed feedback control (aDFC), DFC, and Poisson stimulation in controllable networks.</title><p>Fold change in oscillation intensity (<bold>A</bold>), synchrony (<bold>B</bold>), and firing rate (<bold>C</bold>) of the 5 min stimulation period compared to the 5 min pre-stimulation period with aDFC (blue), DFC (green), and Poisson (red) stimulation. The control group (grey) corresponds to baseline recordings where there is no stimulation and thus portrays the natural variability of each metric within two subsequent 5 min blocks. Each point represents the average effect of a stimulation protocol across all trials for a given network. We used the one-way ANOVA with repeated measures as statistical test (<italic>n</italic>=8; *p&lt;0.05; **p&lt;0.01; details of statistical tests in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref> [Table S1]).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-89151-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Adaptive delayed feedback control (aDFC) allows the network to maintain some autonomous firing whereas DFC and Poisson tend to confine most network activity to stimulus responses.</title><p>(<bold>A</bold>) Stimuli (red) and respective response windows of 400 ms (blue) for representative examples of aDFC (top), DFC (middle), and Poisson (bottom) applied to the same network. (<bold>B</bold>) Detail of the spikes (black) evoked after stimulation (red) inside the response window (blue). (<bold>C</bold>) Fraction of evoked spikes during stimulation for all the trials performed with the three protocols for each controllable network (one plot per network). When the fraction of evoked spikes is close to 1, the network has almost no spontaneous activity and is simply replicating the actuation signal, which is not ideal. (<bold>D</bold>) Comparison of the mean fraction of evoked spikes for the controllable networks. Each triplet of point corresponds to one network. aDFC has a significantly lower percentage of evoked activity, meaning that it allows the network to maintain some intrinsic activity. We used the one-way ANOVA with repeated measures as statistical test (<italic>n</italic>=p&lt;0.05; **p&lt;0.01; details of statistical tests in <xref ref-type="supplementary-material" rid="supp3">Supplementary file 3</xref> [Table S3]). (<bold>E</bold>) Average stimulation frequency used by each method for all trials performed with all networks. The overall stimulation frequency is within the same range for all methods. This shows that the results found in D are not explained by differences in the amount of stimulation but are rather due to the specific timing of the stimuli determined by each algorithm.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-89151-fig4-figsupp1-v2.tif"/></fig></fig-group><p>The most significant distinction between control algorithms was evidenced at the level of the bursting oscillations (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). Both aDFC and random stimulation led to a significant decrease in oscillation intensity (see also <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref> for a representative wavelet transform under Poisson stimulation). The standard DFC algorithm, on the other hand, led to a significant increase in the oscillations. This increase in magnitude was followed by an increase in the oscillation frequency (<xref ref-type="fig" rid="fig2">Figure 2A, C and D</xref> and <xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>). The only stimulation protocol that led to a significant decrease in synchrony was aDFC (<xref ref-type="fig" rid="fig4">Figure 4B</xref>) and its effect was significantly different from that of random stimulation. On the other hand, it was also the only method that significantly increased the average firing rate (<xref ref-type="fig" rid="fig4">Figure 4D</xref>), even though the average stimulation frequency was similar for the three methods (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>).</p></sec><sec id="s2-4"><title>Controllability is affected by synaptic strength and balance between excitation and inhibition</title><p>We then sought to understand whether the controllability subspace found for the neuronal cultures portrayed any fundamental property of these types of systems and what parameters could govern such behaviour. We modelled randomly connected networks of 1000 Izhikevich neurons (<xref ref-type="bibr" rid="bib8">Izhikevich, 2003</xref>) with different proportions of regular spiking excitatory neurons and fast-spiking inhibitory neurons. We also varied the overall synaptic weight (see Methods for details). Each condition was simulated five times. The simulations were composed of two different periods: spontaneous activity (OFF) and controlled activity (aDFC ON). For each simulation, we computed the overall synchrony and firing rate for the OFF (<xref ref-type="fig" rid="fig5">Figure 5A</xref>) and aDFC ON periods (<xref ref-type="fig" rid="fig5">Figure 5B</xref>).</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>In silico networks also present a controllable subspace for intermediate baseline levels of firing rate and synchrony.</title><p>(<bold>A</bold>) Level of synchrony (left) and firing rate (right) for the period of spontaneous activity. Each pixel represents the average synchrony and firing rate of five different simulations under the same conditions of excitatory/inhibitory balance and synaptic weight. (<bold>B</bold>) Average change in synchrony (left) and firing rate (right) of adaptive delayed feedback control (aDFC) ON period compared to the OFF period. (<bold>C</bold>) Representative example of the simulations under three distinct network parameterisations (1, 2, and 3 in A and B). Each panel has the instant spike count at the top, the raster plot at the bottom, and the network bursts (green) and triggered stimuli (red) in the middle.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-89151-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>The controllable region of in silico networks is also associated with intermediate levels of spontaneous firing rate and synchrony.</title><p>The values of synchrony and firing rate during the initial OFF period were plotted for all the simulations performed, covering all the network parameterisations. The datapoints are coloured according to the change in synchrony level from OFF to ON, as a proxy for controllability. The in silico simulations cover a much larger metric space than the in vitro results, which are confined to the regions between a spontaneous synchrony of 10<sup>–1</sup> and 10<sup>0</sup> and spontaneous firing rate of 10<sup>0</sup> and 10<sup>1</sup> (the in silico simulations with very low spontaneous synchrony generated firing dynamics that would not be elected for in vitro experiments).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-89151-fig5-figsupp1-v2.tif"/></fig></fig-group><p>Low percentages of excitatory neurons and weak synaptic weights within the network led to sparse and chaotic activity (region 1 in <xref ref-type="fig" rid="fig5">Figure 5A–C</xref>). In this scenario, the controller is sporadically activated due to fluctuations of neuronal activity, creating brief moments of synchronisation (<xref ref-type="fig" rid="fig5">Figure 5C</xref>, top). High percentages of excitatory neurons and strong synaptic weights led to highly ordered network dynamics with strong bursting activity (region 3 in <xref ref-type="fig" rid="fig5">Figure 5A–C</xref>). Here, the controller could not disrupt the dominating spontaneous activity (<xref ref-type="fig" rid="fig5">Figure 5C</xref>, bottom). However, in the transition between these two network states, there was a parameter subspace that generated intermediate baseline levels of firing rate and synchrony (region 2 in <xref ref-type="fig" rid="fig5">Figure 5A–C</xref>). In parallel to what was found in vitro, the networks were controllable in this intermediate region (see also <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). Here, aDFC could desynchronise the network shortly after activating the stimulation (<xref ref-type="fig" rid="fig5">Figure 5C</xref>, middle). Thus, among the multiple possible parameters governing network controllability, the excitatory/inhibitory balance and overall network connectivity strength could explain the separation into controllable and uncontrollable networks seen in vitro.</p></sec><sec id="s2-5"><title>aDFC can promote transitions to stable asynchronous states</title><p>The majority of the in vitro cultures had monostable dynamics, presenting a very consistent firing pattern over time (e.g. OFF periods of <xref ref-type="fig" rid="fig2">Figure 2</xref>). In these networks, even though aDFC reduced neuronal synchronisation (<xref ref-type="fig" rid="fig4">Figure 4C</xref>) and disrupted baseline oscillatory activity (<xref ref-type="fig" rid="fig2">Figure 2B, E and F</xref> and <xref ref-type="fig" rid="fig4">Figure 4A</xref>), it generally did so by creating sparser bursting with no particular periodicity. In monostable networks, aDFC did not promote a phase transition to a stable asynchronous state (AS) as opposed to what is typically seen in DFC computational studies (<xref ref-type="bibr" rid="bib18">Rosenblum and Pikovsky, 2004a</xref>; <xref ref-type="bibr" rid="bib21">Vlachos et al., 2016</xref>; <xref ref-type="bibr" rid="bib14">Popovych et al., 2017</xref>; <xref ref-type="bibr" rid="bib3">Daneshzand et al., 2018</xref>; <xref ref-type="bibr" rid="bib15">Popovych and Tass, 2019</xref>; <xref ref-type="bibr" rid="bib25">Yu et al., 2021</xref>; <xref ref-type="bibr" rid="bib26">Zhou et al., 2020</xref>).</p><p>We also found a less common type of networks that had multi-stable dynamics, spontaneously transitioning between different firing regimes. Multi-stable networks were particularly interesting when they presented sporadic transitions to an AS as it showed that these networks could autonomously sustain asynchronous activity, even if only for short periods of time (<xref ref-type="fig" rid="fig6">Figure 6</xref>). The different stable states were identified using unsupervised clustering on the values of firing rate and synchrony calculated over a sliding window (<xref ref-type="fig" rid="fig6">Figure 6A and B</xref>). A given state was considered asynchronous if its average synchrony was below 0.5 and the mean firing rate was below the average of that network. The obtained clusters correlate with the different regimes seen in the frequency domain (<xref ref-type="fig" rid="fig6">Figure 6C</xref>).</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Multi-stable network with sporadic transitions to asynchronous state.</title><p>(<bold>A</bold>) Spontaneous synchrony and firing rate over time (middle). Representative raster plots of the synchronous (top) and asynchronous states (bottom). The coloured boxes represent the sliding window over which the firing rate and synchrony are calculated. (<bold>B</bold>) Synchrony vs. firing rate phase plot evidencing the cyclic behaviour of the network, with sporadic transitions to the asynchronous state (blue cluster). The clusters were identified using unsupervised Gaussian mixture models. (<bold>C</bold>) Changes in the frequency domain correlate with the automatically identified clusters (top bar).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-89151-fig6-v2.tif"/></fig><p>To evaluate the effectiveness of each stimulation protocol in promoting transitions to AS, we compared the percentage of time spent in AS during the OFF and ON periods in multi-stable networks (<xref ref-type="fig" rid="fig6">Figure 6</xref>). Since our experimental protocol was composed of 5 min blocks (OFF-ON-OFF), the desynchronising effect of the closed-loop stimulation was only clear for networks that spontaneously exhibited rare and brief (considerably less than 5 min) AS. This way, a significant increase in the time spent in AS during the ON periods was most likely caused by the closed-loop stimulation. Out of all the networks tested, one presented the required criteria to evaluate this effect (<xref ref-type="fig" rid="fig7">Figure 7A and B</xref>).</p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Adaptive delayed feedback control (aDFC) can promote transition to asynchronous state (AS).</title><p>(<bold>A</bold>) States of spontaneous activity for a given multi-stable network. Blue cluster represents the sporadically reached AS. (<bold>B</bold>) Frequency domain of the recording considered in A. Blue rectangles represent the regions associated with the automatically identified AS. (<bold>C, E, G</bold>) Percentage of time in AS during the OFF-ON-OFF protocols for aDFC (<bold>C</bold>), DFC (<bold>E</bold>), and Poisson (<bold>G</bold>) stimulation. Each triplet of points represents an experiment performed with the corresponding stimulation protocol. We compared the time spent in AS during the ON and OFF periods using one-way ANOVA with repeated measures (****p&lt;0.0001; details of statistical tests in <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref> [Table S2]). (<bold>D, F, H</bold>) Representative example of an experiment performed with aDFC (<bold>D</bold>), DFC (<bold>F</bold>), and Poisson (<bold>H</bold>) stimulation portrayed in the frequency domain. The stimulation period is represented with the associated coloured bar on the top. The identified AS are represented by the blue rectangles, as in B.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-89151-fig7-v2.tif"/></fig><p>aDFC consistently promoted desynchronisation in all the trials performed with this network, leading to a considerable increase of time spent in AS (<xref ref-type="fig" rid="fig7">Figure 7C and D</xref>). DFC stimulation, on the other hand, tended to impose a new bursting periodicity (as already reported), sometimes interrupted by transitions to AS (<xref ref-type="fig" rid="fig7">Figure 7E and F</xref>). However, the percentage of time spent in AS during DFC stimulation is within the range of spontaneous transitions and thus cannot be directly attributed to DFC. Random Poisson stimulation with identical stimulation frequency promoted sparser bursting with some transitions to AS, but these are also within the range of spontaneous transitions (<xref ref-type="fig" rid="fig7">Figure 7G and H</xref>). This means that the precisely timed stimuli determined by aDFC are causing the transitions to the AS. Also, the random Poisson stimulation, being an open-loop protocol, does not stop once the desired AS is achieved, which could be a significant drawback in a clinical setting.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Controlling brain activity is a long-standing goal in neuroengineering and holds great potential for multiple clinical applications. This is a challenging problem because neuronal systems have complex dynamics, virtually impossible to fully observe, and the space of actions available to an external controller is highly restricted. Most of these constraints are circumvented in computational studies, allowing researchers to explore solutions in a highly controlled environment. However, under such simplified conditions, these solutions may converge to algorithms that fail when applied to biological neuronal populations. It is, therefore, important to assess the performance of such algorithms with simple biological neuronal systems before moving to in vivo trials. In this work, we tested, for the first time, the efficacy of conventional DFC in an in vitro setting and reported that it promoted a new bursting frequency, instead of ablating it. This is in line with the claim that linear DFC could lead to synchronisation if the delay deviated substantially from the half-period (<xref ref-type="bibr" rid="bib17">Pyragas, 2006</xref>). This was shown in silico by testing different delays with the same network. Here, however, the deviation from the half-period delay was caused by the fact that DFC stimulation induced a faster periodicity, while the delay was kept constant. The neuronal dynamics aligned with the non-adaptive controller to the point that almost all activity was confined to stimulus responses (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). This was not predicted by computational studies, possibly because the simple in silico networks used were not as dynamic as biological ones and, therefore, could not sustain different synchronisation periodicities.</p><p>The adaptive version, aDFC, effectively disrupted the oscillations and decreased network synchrony. Interestingly, random stimulation, using similar stimulation frequency, was also able to achieve this, although without significantly decreasing synchronisation. Electrical stimulation may be acting as a disrupter of the network dynamics, as it has been proposed for high-frequency deep brain stimulation (<xref ref-type="bibr" rid="bib2">Chiken and Nambu, 2016</xref>).</p><p>We showed that not all networks could be effectively modulated by each stimulation protocol. However, it is important to note that controllability is contingent on the neurostimulation conditions. In particular, the fact that we only used one stimulating electrode may restrict the pool of controllable networks. We did so to follow the principle that DFC should control the system using minimal intervention (<xref ref-type="bibr" rid="bib18">Rosenblum and Pikovsky, 2004a</xref>). Also, despite the fact that aDFC decreased the synchrony of controllable networks, the neuronal activity was still mostly dominated by synchronous events. These results were far from those obtained in previous in silico studies, where the synchronous events vanish almost completely. We point to two possible causes. First, with our setup, we could only apply excitatory electrical stimulation, much like existing implantable stimulators. For this reason, when the actuation signal (here modulated as a stimulation frequency) was negative, we sent no input to the network. Nonetheless, in theory, using only the positive phase of the actuation signal should still prevent the formation of synchronous events, as it did in our in silico tests. So, it is possible that the limiting factor is the neuronal model itself. The unconstrained growth of our hippocampal cultures may have led to highly interconnected networks whose neurons simply cannot fire asynchronously. This is further supported by the fact that aDFC consistently promoted the AS in a network that could already sustain it autonomously. Again, these considerations are conditioned to the method used, whose main goal was to achieve desynchronisation with minimal intervention. Other methods can achieve network desynchronisation by following approaches that are more aggressive. Namely, it was already shown that continuous stimulation at higher frequencies (10–50 Hz), distributed across multiple electrodes, can prevent network synchronisation (<xref ref-type="bibr" rid="bib22">Wagenaar et al., 2005</xref>). This is done, however, at the cost of highly increasing the overall network’s firing rate, thus possibly establishing yet another non-physiological state. The goal of avoiding an abnormal prolonged increase in the population’s firing rate is grounded on the understanding that excessive activity is also detrimental in a neuronal circuit. Whether aDFC is more efficient in disrupting pathological oscillations than high-frequency stimulation (HFS) used in current stimulation therapies remains unknown. Nevertheless, as opposed to fixed/continuous HFS, aDFC stimulation adapts to the population oscillation frequency and ceases once the network is desynchronised.</p><p>Despite being able to disrupt the baseline oscillation and decreasing synchrony levels, there is still margin to improve the aDFC algorithm by making it self-adaptive in terms of the actuation gain, pulse amplitude, and selection of stimulation electrode(s), all of which were tuned manually before starting the experiments. It remains to be explored whether such an adaptive controller would consistently achieve full desynchronisation in this type of networks.</p><p>To conclude, the technological advances made in implantable neurostimulators open the door for the use of algorithms capable of controlling pathological neuronal dynamics. We show that aDFC has the potential to be a promising candidate and believe that the considerations extracted from this in vitro study will support the translation to future in vivo experiments.</p></sec><sec id="s4" sec-type="methods"><title>Methods</title><sec id="s4-1"><title>Cell cultures</title><p>The experiments followed both the European legislation regarding the use of animals for scientific purposes and the protocols approved by the ethical committee of i3S. The Animal Facility of i3S follows the FELASA guidelines and recommendations concerning laboratory animal welfare, complies with the European Guidelines (Directive 2010/63/EU) transposed to Portuguese legislation by Decreto-Lei no 113/2013, and is licensed by the Portuguese official veterinary department (DGAV, Ref 004461). Embryonic (E18) rat hippocampal neurons were cultured on six-well or nine-well chamber MEA (256-6well MEA200/30iR-ITO-rcr and 256-9wellMEA300/30iR-ITO, respectively) (MCS, Germany) with a density of 5×10<sup>4</sup> cells/well and 3×10<sup>4</sup> cells/well, respectively. Each well of the six-well MEA has 42 TiN circular electrodes (array of 7×6), and the nine-well contains arrays of 26 TiN circular electrodes (6×5 without corners), each with a diameter of 30 µm. The experiments were performed between 13 and 55 days in vitro.</p></sec><sec id="s4-2"><title>Electrophysiological recordings</title><p>The recordings were performed with the MEA2100-256 System (MCS, Germany). The cell cultures were kept at 37°C and 5% CO<sub>2</sub> using a stage-top incubator (ibidi GmbH, Germany) adapted to the headstage of the MEA2100-256 System. The electrophysiology signals were sampled at 10 kHz and filtered with an HP at 200 Hz (second-order high-pass Butterworth filter). The neuronal spikes were detected and recorded using the Experimenter software from MCS. Peaks that were six STD (sometimes up to eight STD, depending on the background noise) below or above baseline were considered neuronal spikes. There was a deadtime of 3 ms after each detection to prevent biphasic spikes from being identified twice. This spike data was used for posterior offline analysis.</p></sec><sec id="s4-3"><title>Closed-loop computer application</title><p>The developed C# software was built using the McsUsbNet dynamic link library from MCS (<ext-link ext-link-type="uri" xlink:href="https://github.com/multichannelsystems/McsUsbNet">https://github.com/multichannelsystems/McsUsbNet</ext-link>; <xref ref-type="bibr" rid="bib11">Multi Channel Systems MCS GmbH, 2023</xref>). The software ran in parallel with the Experimenter software in a quad-core Intel i7-6700 with 32.0 GB RAM workstation. The raw neuronal stream of data was received in batches at 10 kHz. Each batch had one sample point per electrode and was transferred directly from MEA2100-256 System via USB 3.0 high-speed cable. The signal processing was analogous to that running on Experimenter: the raw data was high-pass filtered at 200 Hz and the spike detection was performed using the same algorithm (see Electrophysiology recordings section). The C# application had access to the MEA2100-256 System stimulators via USB 3.0, allowing us to trigger stimulation by software. The app also commanded the beginning of the recordings in Experimenter. The overall closed-loop latency associated with the activation of the stimulus was below 40 ms. The application can be freely available for download in GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/NCN-Lab/aDFC">https://github.com/NCN-Lab/aDFC</ext-link>, copy archived at <xref ref-type="bibr" rid="bib10">Leite de Castro and Neuroengineering and Computational Neuroscience Lab, 2024</xref>, GNU General Public License v3.0).</p></sec><sec id="s4-4"><title>DFC algorithm</title><p>The C# application ran the DFC algorithm online. The application only monitored electrodes that had an average firing rate of above 0.1 Hz, measured before starting the experiments. The instantaneous firing rate (<italic>FR</italic>) of an active electrode was calculated in a square moving window of 0.1 s (sometimes tuned to 0.2 or 0.5 before starting the experiments depending on the dynamics of the network). The <italic>FR</italic> signal corresponds to the number of spikes per active electrode per unit of time. The <italic>FR</italic> of the monitored network was filtered using a damped oscillator (<xref ref-type="bibr" rid="bib14">Popovych et al., 2017</xref>; <xref ref-type="bibr" rid="bib3">Daneshzand et al., 2018</xref>),<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo>¨</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mi>ω</mml:mi><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mi>ω</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mi>F</mml:mi><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf1"><mml:mi>ω</mml:mi></mml:math></inline-formula> denotes the natural frequency of the oscillator and <inline-formula><mml:math id="inf2"><mml:mi>k</mml:mi></mml:math></inline-formula> is a scaling coefficient. Here, we considered <inline-formula><mml:math id="inf3"><mml:mi>k</mml:mi></mml:math></inline-formula> = <italic>ω</italic>, which prevents the oscillator amplitude from scaling with the different ranges of periodicities exhibited by different cultures. We used <inline-formula><mml:math id="inf4"><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula> as the output of <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>. The stimulation frequency (<inline-formula><mml:math id="inf5"><mml:mi>S</mml:mi><mml:mi>F</mml:mi></mml:math></inline-formula>) is obtained by subtracting the current oscillation from the half-period shifted oscillation,<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mi>S</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>K</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mrow><mml:mo>˙</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mover><mml:mi>x</mml:mi><mml:mrow><mml:mo>˙</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <italic>K</italic> represents the stimulation gain and <italic>T</italic> is the oscillation period. A stimulus is triggered when<disp-formula id="equ3"> <label>(3)</label><mml:math id="m3"><mml:mrow><mml:mi>t</mml:mi><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>S</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>where <italic>t</italic> is the current time and <italic>t</italic><sub><italic>last stim</italic></sub> is the time stamp of the last stimulus. <xref ref-type="disp-formula" rid="equ3">Equation 3</xref> was bounded so that the stimulus was only sent when <inline-formula><mml:math id="inf6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>1</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>S</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. The upper bound is required due to the latency in the stimulus activation (below 40 ms) and the lower bound guarantees that low background values of <inline-formula><mml:math id="inf7"><mml:mi>S</mml:mi><mml:mi>F</mml:mi></mml:math></inline-formula> do not trigger stimulation (and that there is no negative stimulation frequency). Here, <italic>T</italic> and <italic>ω</italic> are adapted based on the real-time detection of synchronous events. The synchronous events (NB) were detected when the <italic>FR</italic> signal was above a certain threshold, typically 10 Hz, considering a minimum interval between NB of 0.1 s. The threshold and minimum NB interval were sometimes adjusted before starting the experiments to better suit the observed data.</p></sec><sec id="s4-5"><title>Experimental protocol</title><p>Before starting the experiments, we monitored the networks for up to 10 min to identify the active electrodes. The application calculates the average firing rate for all the electrodes and selects those firing above 0.1 Hz. During this preliminary period, we also tuned the parameters for the detection of synchronous events, if necessary.</p><p>Each stimulus unit was a negative electrical pulse with 200 µs duration. The choice of stimulation electrode and pulse amplitude was based on the premise that the stimulus should promote a response in the neighbouring electrodes using minimal stimulation. We probed different electrodes manually using Experimenter software, starting with the most active ones. For each electrode, we tested different stimulus amplitudes from –400 to –1000 mV in steps of –100 mV. When a given electrode and stimulation amplitude evoked a consistent response in nearby neurons, we fixed the stimulus amplitude to 120% of that value to account for eventual adaptations of the network, which could render the stimulation ineffective.</p><p>The experiments started with a recording of 15 min of spontaneous activity. The choice of stimulation protocols – DFC, aDFC, and Poisson – for the following trials was randomised. Each trial had three periods: 5 min without stimulation (OFF), 5 min with stimulation (ON), and 5 min without stimulation again (OFF). For the DFC and aDFC protocols, the stimulation followed the <italic>SF</italic> (<italic>t</italic>) signal determined by each algorithm. For the Poisson protocol, the stimulation followed a Poisson distribution of stimuli with an average frequency equivalent to that used in the previous aDFC trial. The time interval between consecutive trials was in the order of 5 min. A precise time interval between trials was not required/imposed as, once stimulation stopped, the firing dynamics returned to the baseline regime very quickly (<xref ref-type="fig" rid="fig2">Figure 2A and B</xref> and <xref ref-type="fig" rid="fig3">Figure 3A</xref>).</p></sec><sec id="s4-6"><title>Selection criteria</title><p>We only performed experiments on networks that displayed consistent oscillatory bursting activity with periodicities between 0.5 and 5 s, approximately. Some cultures presented the required dynamics but were rejected because they were (or became) irresponsive to stimulation. In order to have statistical robustness in the evaluation of the different stimulation protocols, we only analysed networks that were submitted to at least three trials with each protocol. A total of 14 networks fulfilled the criteria to proceed with the experiments and analysis. Here, we define a network as being a neuronal culture in a given day in vitro. We did this because the neuronal dynamics of the same culture of neurons may change drastically from day to day, so we considered it a different dynamical system. The 14 networks came from 11 independent cultures, from a total of five different animal preparations (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>).</p></sec><sec id="s4-7"><title>Signal processing</title><sec id="s4-7-1"><title>Features of neuronal activity</title><p>The offline analysis of neuronal data was based on the spikes recorded with Experimenter. We used three features to characterise the activity of the different networks: average firing rate, synchrony, and the oscillation intensity. The average firing rate corresponds to the average number of spikes per electrode per unit of time. The synchrony measure is based on the <italic>χ</italic> metric, which compares the variance of the network activity with the variance of each neuron’s activity (<xref ref-type="bibr" rid="bib6">Golomb and Rinzel, 1994</xref>),<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>χ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf8"><mml:mi>N</mml:mi></mml:math></inline-formula> is typically the number of neurons, but here corresponds to the number of electrodes, and <inline-formula><mml:math id="inf9"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (<italic>t</italic>) is typically the voltage of neuron <inline-formula><mml:math id="inf10"><mml:mi>i</mml:mi></mml:math></inline-formula>, but here corresponds to the spike train of electrode <inline-formula><mml:math id="inf11"><mml:mi>i</mml:mi></mml:math></inline-formula> convolved with a square wave of 50 ms and binarised. This signal defines the periods on which a given electrode is considered active. We are thus measuring the degree of co-activation of the multiple electrodes, regardless of the number spikes exhibited by different electrodes at the moment of synchronisation. We did not want this factor to leak to the synchrony measure because different electrodes may be synchronised but with different number of spikes per activation (which could be due to different number of neurons surrounding each electrode, for example).</p><p>The oscillation intensity is measured by calculating SNR of fundamental frequency of the PSD. This was calculated using the MATLAB functions <italic>pwelch</italic> for the PSD and <italic>snr</italic> for the SNR, which computes the ratio of the summed squared magnitude of the fundamental frequency to that of the noise. The <italic>snr</italic> function automatically detects the fundamental frequency and assures that the harmonics and DC component are not mistaken as noise. The fundamental frequency corresponds to the frequency at the peak of the PSD.</p><p>For the firing rate and synchrony, the effect of each stimulation protocol was evaluated by calculating the metric’s fold change from OFF to ON. For the oscillation intensity we calculated the difference between the OFF and ON periods, since it is measured in dB, which is a logarithmic scale.</p></sec><sec id="s4-7-2"><title>Unsupervised clustering of neuronal dynamics</title><p>The different states of neuronal activity of a given recording (<xref ref-type="fig" rid="fig6">Figure 6</xref>) were identified by calculating the firing rate and synchrony in a moving window. The width of the moving window corresponded to the average duration of five periodic events in the analysed recording. The moving step was half the window width. The clusters of neuronal dynamics were automatically identified with Gaussian mixture models (GMMs) applied to the bidimensional matrix of firing rate and synchrony. We tested GMMs with one to four groups and each condition was repeated 10 times with different initial values. The ideal clustering was chosen based on the Bayesian informative criterion. We calculated the centroid of each cluster and considered the AS as being those with mean synchrony below 0.5 and mean firing rate below the average for that network.</p></sec></sec><sec id="s4-8"><title>Statistical analysis</title><sec id="s4-8-1"><title>Controllable and uncontrollable networks</title><p>The classification of networks as controllable or uncontrollable (<xref ref-type="fig" rid="fig3">Figure 3</xref>) was based on the assumption that controllable networks could be driven to specific subspaces of neuronal activity with a given stimulation protocol whereas the uncontrollable networks could not. We started by calculating the fold change of the four metrics (synchrony, firing rate, oscillation frequency, and intensity) for all trials performed with each network. To evaluate whether the spaces reached during stimulation were statistically different, we calculated the MANOVA considering the fold change of the three metrics, simultaneously. Here, the null hypothesis was that the modulation results were identical for all stimulation protocols.</p></sec><sec id="s4-8-2"><title>Neuromodulation results for controllable networks</title><p>For a given network, we calculated the average fold change in synchrony and firing rate, and the difference in SNR of the main oscillation across all the trials performed with each stimulation protocol. Then, the comparisons between groups were performed using one-way ANOVA with repeated measures.</p></sec><sec id="s4-8-3"><title>Time spent in AS</title><p>To compare the efficacy of the different stimulation protocols in promoting the transition to a stable AS in a multi-stable network, we calculated the percentage of time spent in the AS during the OFF and ON periods for all the trials. We then compared if there was a significant change from OFF pre-stimulation to ON, from ON to OFF post-stimulation and from OFF pre-stimulation to OFF post-stimulation using one-way ANOVA with repeated measures.</p></sec></sec><sec id="s4-9"><title>In silico model</title><p>Our in silico networks were composed of 1000 randomly connected Izhikevich neurons with varying percentages of regular spiking excitatory neurons (<italic>a</italic>=0.02; <italic>b</italic>=0.2; <italic>c</italic> = –65; <italic>d</italic>=8) and fast-spiking inhibitory neurons (<italic>a</italic>=0.1; <italic>b</italic>=0.2; <italic>c</italic> = –65; <italic>d</italic>=2) (<xref ref-type="bibr" rid="bib8">Izhikevich, 2003</xref>). The neurons were connected in an all-to-all architecture of varying synaptic weights according to the connectivity matrix <italic>S</italic>. The overall synaptic weights of the different simulations were modulated by scaling <italic>S</italic>. Each condition was simulated five times. The model was based on the script provided in <ext-link ext-link-type="uri" xlink:href="https://www.izhikevich.org/publications/net.m">https://www.izhikevich.org/publications/net.m</ext-link>.</p><p>The simulations had an initial period of 500 ms for the network activity to stabilise. After the stabilisation period, we had 2000 ms of spontaneous activity and 2000 ms under the aDFC stimulation protocol. The aDFC algorithm was identical to that applied in vitro, considering only the positive component of the actuation signal. A pool of 100 neurons was randomly selected for stimulation. Each electrical pulse corresponded to an instantaneous input of 20 mA to the stimulated neurons. The firing rate and synchrony measures were computed using the same algorithms as those used in vitro (see Signal processing section) and averaged across the five repetitions of each simulation condition.</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Software, Formal analysis, Investigation, Visualization, Methodology, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Investigation, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con4"><p>Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Resources, Supervision, Funding acquisition, Investigation, Methodology, Project administration, Writing – review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>The experiments followed both the European legislation regarding the use of animals for scientific purposes and the protocols approved by the ethical committee of i3S. The Animal Facility of i3S follows the FELASA guidelines and recommendations concerning laboratory animal welfare, complies with the European Guidelines (Directive 2010/63/EU) transposed to Portuguese legislation by Decreto-Lei no 113/2013 and is licensed by the Portuguese official veterinary department (DGAV, Ref 004461).</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Details of the statistical tests used in <xref ref-type="fig" rid="fig4">Figure 4</xref> to compare the modulation results of the different stimulation protocols in controllable networks.</title><p>We used repeated measures one-way ANOVA with multiple comparisons.</p></caption><media xlink:href="elife-89151-supp1-v2.docx" mimetype="application" mime-subtype="docx"/></supplementary-material><supplementary-material id="supp2"><label>Supplementary file 2.</label><caption><title>Details of the statistical tests used in <xref ref-type="fig" rid="fig7">Figure 7</xref> to compare percentage of time spent in asynchronous state for each stimulation protocol in a multi-stable network.</title><p>We used repeated measures one-way ANOVA with multiple comparisons.</p></caption><media xlink:href="elife-89151-supp2-v2.docx" mimetype="application" mime-subtype="docx"/></supplementary-material><supplementary-material id="supp3"><label>Supplementary file 3.</label><caption><title>Details of the statistical tests used in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref> to compare fraction of spontaneous spikes during stimulation for the three stimulation protocols.</title><p>We used repeated measures one-way ANOVA with multiple comparisons.</p></caption><media xlink:href="elife-89151-supp3-v2.docx" mimetype="application" mime-subtype="docx"/></supplementary-material><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-89151-mdarchecklist1-v2.pdf" mimetype="application" mime-subtype="pdf"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>The data that support the findings of this study are openly available in ZENODO at the following URL/DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.10138446">https://doi.org/10.5281/zenodo.10138445</ext-link>.</p><p>The following dataset was generated:</p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset1"><person-group person-group-type="author"><name><surname>Leite de Castro</surname><given-names>D</given-names></name><name><surname>Aguiar</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>Disrupting abnormal neuronal oscillations with adaptive delayed feedback control</data-title><source>Zenodo</source><pub-id pub-id-type="doi">10.5281/zenodo.10138445</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>This work was supported by la Caixa Foundation, in the scope of the grant CaixaResearch Health 2022 HR22-00189, and by Prémio Mantero Belard, Santa Casa da Misericordia de Lisboa MB-12-2022. Domingos Castro was funded by FCT – Fundação para a Ciência e a Tecnologia, grant contract SFRH/BD/143956/2019.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beverlin Ii</surname><given-names>B</given-names></name><name><surname>Netoff</surname><given-names>TI</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Dynamic control of modeled tonic-clonic seizure states with closed-loop stimulation</article-title><source>Frontiers in Neural Circuits</source><volume>6</volume><elocation-id>126</elocation-id><pub-id pub-id-type="doi">10.3389/fncir.2012.00126</pub-id><pub-id pub-id-type="pmid">23390413</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chiken</surname><given-names>S</given-names></name><name><surname>Nambu</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Mechanism of deep brain stimulation: inhibition, excitation, or disruption?</article-title><source>The Neuroscientist</source><volume>22</volume><fpage>313</fpage><lpage>322</lpage><pub-id pub-id-type="doi">10.1177/1073858415581986</pub-id><pub-id pub-id-type="pmid">25888630</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Daneshzand</surname><given-names>M</given-names></name><name><surname>Faezipour</surname><given-names>M</given-names></name><name><surname>Barkana</surname><given-names>BD</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Robust desynchronization of Parkinson’s disease pathological oscillations by frequency modulation of delayed feedback deep brain stimulation</article-title><source>PLOS ONE</source><volume>13</volume><elocation-id>e0207761</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0207761</pub-id><pub-id pub-id-type="pmid">30458039</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dovzhenok</surname><given-names>A</given-names></name><name><surname>Park</surname><given-names>C</given-names></name><name><surname>Worth</surname><given-names>RM</given-names></name><name><surname>Rubchinsky</surname><given-names>LL</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Failure of delayed feedback deep brain stimulation for intermittent pathological synchronization in Parkinson’s disease</article-title><source>PLOS ONE</source><volume>8</volume><elocation-id>e58264</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0058264</pub-id><pub-id pub-id-type="pmid">23469272</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Edwards</surname><given-names>CA</given-names></name><name><surname>Kouzani</surname><given-names>A</given-names></name><name><surname>Lee</surname><given-names>KH</given-names></name><name><surname>Ross</surname><given-names>EK</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Neurostimulation devices for the treatment of neurologic disorders</article-title><source>Mayo Clinic Proceedings</source><volume>92</volume><fpage>1427</fpage><lpage>1444</lpage><pub-id pub-id-type="doi">10.1016/j.mayocp.2017.05.005</pub-id><pub-id pub-id-type="pmid">28870357</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Golomb</surname><given-names>D</given-names></name><name><surname>Rinzel</surname><given-names>J</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Clustering in globally coupled inhibitory neurons</article-title><source>Physica D</source><volume>72</volume><fpage>259</fpage><lpage>282</lpage><pub-id pub-id-type="doi">10.1016/0167-2789(94)90214-3</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Holt</surname><given-names>AB</given-names></name><name><surname>Wilson</surname><given-names>D</given-names></name><name><surname>Shinn</surname><given-names>M</given-names></name><name><surname>Moehlis</surname><given-names>J</given-names></name><name><surname>Netoff</surname><given-names>TI</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Phasic burst stimulation: a closed-loop approach to tuning deep brain stimulation parameters for parkinson’s disease</article-title><source>PLOS Computational Biology</source><volume>12</volume><elocation-id>e1005011</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005011</pub-id><pub-id pub-id-type="pmid">27415832</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Izhikevich</surname><given-names>EM</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Simple model of spiking neurons</article-title><source>IEEE Transactions on Neural Networks</source><volume>14</volume><fpage>1569</fpage><lpage>1572</lpage><pub-id pub-id-type="doi">10.1109/TNN.2003.820440</pub-id><pub-id pub-id-type="pmid">18244602</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuo</surname><given-names>CH</given-names></name><name><surname>White-Dzuro</surname><given-names>GA</given-names></name><name><surname>Ko</surname><given-names>AL</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Approaches to closed-loop deep brain stimulation for movement disorders</article-title><source>Neurosurgical Focus</source><volume>45</volume><elocation-id>E2</elocation-id><pub-id pub-id-type="doi">10.3171/2018.5.FOCUS18173</pub-id><pub-id pub-id-type="pmid">30064321</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Leite de Castro</surname><given-names>D</given-names></name><collab>Neuroengineering and Computational Neuroscience Lab</collab></person-group><year iso-8601-date="2024">2024</year><data-title>aDFC adaptive delayed feedback control in neuronal populations</data-title><version designator="swh:1:rev:c046cc5e103f347d1023ce1134193c29a70e0c04">swh:1:rev:c046cc5e103f347d1023ce1134193c29a70e0c04</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:e91c59deb7ef573cca7b2e84bdaf942de4530937;origin=https://github.com/NCN-Lab/aDFC;visit=swh:1:snp:6c0e5a94fdd73e16de86d5e9e71695dfe3458c29;anchor=swh:1:rev:c046cc5e103f347d1023ce1134193c29a70e0c04">https://archive.softwareheritage.org/swh:1:dir:e91c59deb7ef573cca7b2e84bdaf942de4530937;origin=https://github.com/NCN-Lab/aDFC;visit=swh:1:snp:6c0e5a94fdd73e16de86d5e9e71695dfe3458c29;anchor=swh:1:rev:c046cc5e103f347d1023ce1134193c29a70e0c04</ext-link></element-citation></ref><ref id="bib11"><element-citation publication-type="software"><person-group person-group-type="author"><collab>Multi Channel Systems MCS GmbH</collab></person-group><year iso-8601-date="2023">2023</year><data-title>Mcsusbnet</data-title><version designator="0440a7c">0440a7c</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/multichannelsystems/McsUsbNet">https://github.com/multichannelsystems/McsUsbNet</ext-link></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nabi</surname><given-names>A</given-names></name><name><surname>Mirzadeh</surname><given-names>M</given-names></name><name><surname>Gibou</surname><given-names>F</given-names></name><name><surname>Moehlis</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Minimum energy desynchronizing control for coupled neurons</article-title><source>Journal of Computational Neuroscience</source><volume>34</volume><fpage>259</fpage><lpage>271</lpage><pub-id pub-id-type="doi">10.1007/s10827-012-0419-3</pub-id><pub-id pub-id-type="pmid">22903565</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Obien</surname><given-names>MEJ</given-names></name><name><surname>Deligkaris</surname><given-names>K</given-names></name><name><surname>Bullmann</surname><given-names>T</given-names></name><name><surname>Bakkum</surname><given-names>DJ</given-names></name><name><surname>Frey</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Revealing neuronal function through microelectrode array recordings</article-title><source>Frontiers in Neuroscience</source><volume>8</volume><elocation-id>423</elocation-id><pub-id pub-id-type="doi">10.3389/fnins.2014.00423</pub-id><pub-id pub-id-type="pmid">25610364</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Popovych</surname><given-names>OV</given-names></name><name><surname>Lysyansky</surname><given-names>B</given-names></name><name><surname>Rosenblum</surname><given-names>M</given-names></name><name><surname>Pikovsky</surname><given-names>A</given-names></name><name><surname>Tass</surname><given-names>PA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Pulsatile desynchronizing delayed feedback for closed-loop deep brain stimulation</article-title><source>PLOS ONE</source><volume>12</volume><elocation-id>e0173363</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0173363</pub-id><pub-id pub-id-type="pmid">28273176</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Popovych</surname><given-names>OV</given-names></name><name><surname>Tass</surname><given-names>PA</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Adaptive delivery of continuous and delayed feedback deep brain stimulation - a computational study</article-title><source>Scientific Reports</source><volume>9</volume><elocation-id>10585</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-019-47036-4</pub-id><pub-id pub-id-type="pmid">31332226</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pyragas</surname><given-names>K</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Continuous control of chaos by self-controlling feedback</article-title><source>Physics Letters A</source><volume>170</volume><fpage>421</fpage><lpage>428</lpage><pub-id pub-id-type="doi">10.1016/0375-9601(92)90745-8</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pyragas</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Delayed feedback control of chaos</article-title><source>Philosophical Transactions. Series A, Mathematical, Physical, and Engineering Sciences</source><volume>364</volume><fpage>2309</fpage><lpage>2334</lpage><pub-id pub-id-type="doi">10.1098/rsta.2006.1827</pub-id><pub-id pub-id-type="pmid">16893790</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosenblum</surname><given-names>MG</given-names></name><name><surname>Pikovsky</surname><given-names>AS</given-names></name></person-group><year iso-8601-date="2004">2004a</year><article-title>Controlling synchronization in an ensemble of globally coupled oscillators</article-title><source>Physical Review Letters</source><volume>92</volume><elocation-id>114102</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.92.114102</pub-id><pub-id pub-id-type="pmid">15089140</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosenblum</surname><given-names>M</given-names></name><name><surname>Pikovsky</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2004">2004b</year><article-title>Delayed feedback control of collective synchrony: an approach to suppression of pathological brain rhythms</article-title><source>Physical Review. E, Statistical, Nonlinear, and Soft Matter Physics</source><volume>70</volume><elocation-id>041904</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.70.041904</pub-id><pub-id pub-id-type="pmid">15600432</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Uhlhaas</surname><given-names>PJ</given-names></name><name><surname>Singer</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Neural synchrony in brain disorders: relevance for cognitive dysfunctions and pathophysiology</article-title><source>Neuron</source><volume>52</volume><fpage>155</fpage><lpage>168</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2006.09.020</pub-id><pub-id pub-id-type="pmid">17015233</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vlachos</surname><given-names>I</given-names></name><name><surname>Deniz</surname><given-names>T</given-names></name><name><surname>Aertsen</surname><given-names>A</given-names></name><name><surname>Kumar</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Recovery of dynamics and function in spiking neural networks with closed-loop control</article-title><source>PLOS Computational Biology</source><volume>12</volume><elocation-id>e1004720</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004720</pub-id><pub-id pub-id-type="pmid">26829673</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wagenaar</surname><given-names>DA</given-names></name><name><surname>Madhavan</surname><given-names>R</given-names></name><name><surname>Pine</surname><given-names>J</given-names></name><name><surname>Potter</surname><given-names>SM</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Controlling bursting in cortical cultures with closed-loop multi-electrode stimulation</article-title><source>The Journal of Neuroscience</source><volume>25</volume><fpage>680</fpage><lpage>688</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4209-04.2005</pub-id><pub-id pub-id-type="pmid">15659605</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weerasinghe</surname><given-names>G</given-names></name><name><surname>Duchet</surname><given-names>B</given-names></name><name><surname>Bick</surname><given-names>C</given-names></name><name><surname>Bogacz</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Optimal closed-loop deep brain stimulation using multiple independently controlled contacts</article-title><source>PLOS Computational Biology</source><volume>17</volume><elocation-id>e1009281</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1009281</pub-id><pub-id pub-id-type="pmid">34358224</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Witt</surname><given-names>A</given-names></name><name><surname>Palmigiano</surname><given-names>A</given-names></name><name><surname>Neef</surname><given-names>A</given-names></name><name><surname>El Hady</surname><given-names>A</given-names></name><name><surname>Wolf</surname><given-names>F</given-names></name><name><surname>Battaglia</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Controlling the oscillation phase through precisely timed closed-loop optogenetic stimulation: a computational study</article-title><source>Frontiers in Neural Circuits</source><volume>7</volume><elocation-id>49</elocation-id><pub-id pub-id-type="doi">10.3389/fncir.2013.00049</pub-id><pub-id pub-id-type="pmid">23616748</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>H</given-names></name><name><surname>Meng</surname><given-names>Z</given-names></name><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Liu</surname><given-names>C</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Intensity-varied closed-loop noise stimulation for oscillation suppression in the parkinsonian state</article-title><source>IEEE Transactions on Cybernetics</source><volume>52</volume><fpage>9861</fpage><lpage>9870</lpage><pub-id pub-id-type="doi">10.1109/TCYB.2021.3079100</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>B</given-names></name><name><surname>Che</surname><given-names>Y</given-names></name><name><surname>Qin</surname><given-names>Q</given-names></name><name><surname>Qin</surname><given-names>Y</given-names></name><name><surname>Han</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Seizure suppression in a thalamocortical computational model of absence epilepsy by linear delayed feedback control</article-title><conf-name>2020 13th International Congress on Image and Signal Processing, BioMedical Engineering and Informatics (CISP-BMEI</conf-name><conf-loc>Chengdu, China</conf-loc><pub-id pub-id-type="doi">10.1109/CISP-BMEI51763.2020.9263605</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.89151.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Bathellier</surname><given-names>Brice</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02feahw73</institution-id><institution>CNRS</institution></institution-wrap><country>France</country></aff></contrib></contrib-group><related-object id="sa0ro1" object-id-type="id" object-id="10.1101/2022.07.05.498735" link-type="continued-by" xlink:href="https://sciety.org/articles/activity/10.1101/2022.07.05.498735"/></front-stub><body><p>Large populations of neurons are capable of entering pathological synchronous oscillations under a variety of conditions and work over many decades has found ways to disrupt such oscillations using stimulation in both open loop and closed loop configurations. This study adds useful results and methodology to this line of research, by providing solid evidence that delayed feedback control via electrical stimulation can, under certain conditions, terminate network level oscillations in cultured hippocampal neurons. The study provides analyses and simulation results that shed light on why some networks respond to such feedback control while others do not.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.89151.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Bathellier</surname><given-names>Brice</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02feahw73</institution-id><institution>CNRS</institution></institution-wrap><country>France</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Khanna</surname><given-names>Preeya</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01an7q238</institution-id><institution>University of California, Berkeley</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>Our editorial process produces two outputs: (i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2022.07.05.498735">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2022.07.05.498735v2">the preprint</ext-link> for the benefit of readers; (ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Disrupting abnormal neuronal oscillations with adaptive delayed feedback control&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 2 peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Panayiota Poirazi as the Senior Editor.</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>Suggestions for improved or additional experiments, data or analyses, especially those directed at increasing the impact of the work and making it suitable for <italic>eLife</italic>:</p><p>Page 4:</p><p>In the text, the Figure 1C middle part is never mentioned, indeed the &quot;mixed&quot; is also not explained and its meaning is not fully clear.</p><p>&quot;In all algorithms, stimulation was provided as monophasic negative voltage pulses at controlled timings.&quot;</p><p>Why was this type of stimulation chosen? Was it based on current literature? What is the advantage of this type of stimulation vs a biphasic pulse?</p><p>Section 2.1:</p><p>It was not clear to me the advantage of representing the neuronal dynamics using the wavelet transform of the firing rate, since in the rest of the article this is represented by the DFT. Could you elucidate this choice?</p><p>&quot;Consistent inter-burst intervals will appear as a low frequency horizontal line&quot; – Why? If the ISI is constant but the firing rate is high, shouldn't it appear as a higher frequency horizontal line?</p><p>Figure 2:</p><p>I missed seeing the same analysis performed in the random stimulation condition – it could be included as a supporting figure just for completeness.</p><p>Section 2.2:</p><p>The definition of firing rate should appear before, since it is one of the main variables used in the previous section.</p><p>Defining the oscillation frequency and intensity based on the main peak does not seem to make sense for the aDFC condition. Your premise is that this treatment disrupts periodicity (which it appears to do) then, in theory, there should not be a defined &quot;peak&quot; in the frequency domain. This identified peak will rest within the noise levels, rendering it &quot;random&quot;. Maybe a threshold could be set, i.e., if the signal-to-noise ratio of a peak is X, then it is considered, otherwise the frequency and intensity of the oscillation are respectively none and zero. Furthermore, the &quot;randomness&quot; of this oscillation frequency can be seen in Figure 3, where the trials with aDFC show a very large range of main frequencies.</p><p>Figure 3:</p><p>How is the z-score calculated?</p><p>Section 2.3:</p><p>Figure 4A show oscillation intensity yet, in the main text, you claim that &quot;standard DFC led to more consistent oscillations&quot;. How does intensity relate to consistency? DFC shows a higher inter-trial variance than the other conditions (less consistent?)</p><p>Figure 4:</p><p>All variables are studied in four different conditions, yet the authors use t-tests to evaluate statistical significance. This is the wrong statistical test to use – an ANOVA should be used. In this situation, multiple t-tests will lead to an increase in false positives.</p><p>Section 2.4:</p><p>Did you quantify the excitatory/inhibitory balance in your MEA cultures? Could be interesting to compare to the simulation results.</p><p>Section 2.5:</p><p>The authors state that multiple trials were conducted in the same network but do not mention how long the network was allowed to recover in between trials, which is necessary information.</p><p>Furthermore, the authors state that only one network showed this effect (spontaneous AS time prior to stimulation). If only one network showed this among 14, how biologically relevant is this? How can you be sure that this is not a consequence of a confounding variable (not properly developed network, etc). How old was this network? Was it also used in other DIVs?</p><p>Figure 7:</p><p>The effect of the Poisson stimulation appears to be more similar to aDFC than random. A more in depth discussion would be helpful to better understand how a &quot;random&quot; stimulation could cause such a &quot;block-type&quot; effect.</p><p>The comparison between OFF-ON-OFF states refers to a comparison of the same object in different timepoints. Thus, t-tests are not the correct statistical test here, but rather a repeated measures ANOVA (or non-parametric equivalent) must be used.</p><p>Methods:</p><p>The authors state that experiments were performed between 13 and 55 DIV. When considering cultured neuron networks, this range makes a gigantic difference in their behavior, since the culture will not be fully mature at DIV 13, and the neuronal health at DIV 55 will already have declined. Only cultures at equivalent maturity levels should be compared.</p><p>Authors define &quot;network as a neuronal culture in a given day in vitro&quot;. This needs to be clarified for statistical analysis. With this definition, does it mean that if two experiments are performed in the same neuronal culture but in two different days, they are considered two independent networks? While the network behavior might change throughout days in vitro (and network maturity), it is not possible to state that the behavior of the network is independent from its previous state. Extra care should be had when performing statistical analysis on those data – they should be handled as the same &quot;object&quot; at different timepoints, NOT independent networks.</p><p>The method used to determine the main frequency and intensity of the oscillation ASSUMES that there is a peak frequency, which may not be true and lead to erroneous results and conclusions.</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>This was a clear, well-written study. I only have a few suggestions/comments to the authors:</p><p>0) Can you discuss whether you expect brain networks to operate in uncontrollable vs. controllable regimes? Is there evidence that brain networks should be controllable?</p><p>1) Can you establish a correspondence between the controllable subspace in the in silico model in Figure 5 and the controllable network properties in Figure 3? For example, can you make Figure 5B left (change in synchrony as a function of synaptic weight vs. excitatory neurons) into a synchrony as a function of firing rate vs. synchrony plot? Then superimpose data from Figure 3E so that one can see whether the in silico network properties are similarly predictive of controllable vs. uncontrollable networks as the in vitro network properties. If there isn't a clear correspondence between the in silico and in vitro networks, please discuss.</p><p>2) Could you either provide experimental data or a discussion of previous studies that have tested conventional high frequency stimulation (~100-120 Hz) and studied its effects on neural synchronization? How might you expect your aDFC results to compare to conventional high frequency stimulation? There is some mention in the discussion of a study that uses 10-50 Hz and is able to prevent synchronous states from forming at the cost of a high firing rate. Why is the high firing rate a problem? Might this be the source of undesirable side effects of stimulation? Please discuss this in more detail in the discussion as it directly sheds light on how useful your algorithm may be compared to conventional stimulation.</p><p>3) Please discuss in the discussion the limits of the in vitro model, particularly in reference to the low frequency synchrony that the populations exhibit (~1 hz) compared to the pathological oscillatory activity thought to be relevant to PD (15-30 hz) or ET (5-7 Hz). Do you expect your algorithm to have difficulties suppressing these higher frequency oscillations ? Are there in vitro models that exhibit higher frequency oscillations that could be used to test this algorithm?</p><p>4) Can the authors comment on how many units must be monitored from in order to make an accurate estimate of the underlying neural population's oscillatory frequency? Can LFP features be used instead of multiple single neuron recordings? This has a direct bearing on how readily translatable this technology is to current neurostimulation devices.</p><p>5) During aDFC how often were the frequency (w) and period time (T) updated?</p><p>6) Where was the ground for the stimulation electrode? Does your stimulation better mimic bipolar or monopolar stimulation in current therapeutic DBS therapies? What was the impedance of the stimulation electrode? Some neuromodulation fields use current (not volts) to report their stimulation amplitude and it would be helpful for those building on this study to have both quantities reported. In addition, please report the electrode surface area so that current density calculations can be made.</p><p>7) Why was stimulation frequency the metric that was updated by DFC and aDFC as opposed to stimulation amplitude?</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.89151.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Reviewer #1 (Recommendations for the authors):</p><p>Suggestions for improved or additional experiments, data or analyses, especially those directed at increasing the impact of the work and making it suitable for eLife:</p><p>Page 4:</p><p>In the text, the Figure 1C middle part is never mentioned, indeed the &quot;mixed&quot; is also not explained and its meaning is not fully clear.</p></disp-quote><p>The middle part depicts the initial instants after stimulation is turned ON. There is still a strong oscillatory component, interleaved with invoked activity, allowing the reader to understand the concept that DFC tends to force the network to fire out of phase. We used the term “mixed” because the activity is still oscillatory, but with moments of sparser activity. This middle part also helps the reader understand that the stimulation is highly activated when the synchrony is high, and vanishes as the synchrony disappears, as shown on the image on the right.</p><p>Added to the manuscript:</p><p>Page 4: “This way, when the activity is oscillatory, the actuation signal is maximal at the antiphase of the neuronal oscillation (Figure 1.C, left and middle). The obtained feedback signal is linearly translated to stimulation frequency by applying a fixed gain. Since the actuation signal is explicitly dependent on the neuronal oscillation, stimulation is highly activated when synchrony is high (Figure 1.C, middle) and decreases as this firing pattern vanishes (Figure 1.C, right).”</p><p>Legend of Figure 1. “(C) Controller computations under different firing regimes – oscillatory (left), asynchronous (right) and mixed, i.e., oscillatory with induced sparse activity (middle).”</p><disp-quote content-type="editor-comment"><p>&quot;In all algorithms, stimulation was provided as monophasic negative voltage pulses at controlled timings.&quot;</p><p>Why was this type of stimulation chosen? Was it based on current literature? What is the advantage of this type of stimulation vs a biphasic pulse?</p></disp-quote><p>When using voltage pulses, the advice from the manufacturer (Multichannel Systems) for titanium nitrite (TiN) electrodes (as in our MEAs) is to use monophasic negative pulses to assure charge balance at the electrode surface: <italic>“When using TiN electrodes, it is extremely important to not charge the electrodes positively, as this will lead to electrolysis. (…). Therefore, when using voltage driven stimulation, it is important to apply negative voltages only. Positive voltages will shortly charge the electrodes positively, even though the electrode is discharged at the end of the pulse. As a consequence, biphasic voltage driven stimulation is not recommended.”</italic>, MEA2100-System User Manual, page 49</p><disp-quote content-type="editor-comment"><p>https://www.multichannelsystems.com/sites/multichannelsystems.com/files/documents/manuals/MCS_MEA2100-System_Manual.pdf</p><p>Section 2.1:</p><p>It was not clear to me the advantage of representing the neuronal dynamics using the wavelet transform of the firing rate, since in the rest of the article this is represented by the DFT. Could you elucidate this choice?</p></disp-quote><p>The wavelet transform allows the reader to interpret visually the changes in frequency components across time, which is not possible with the Fourier transform. With the wavelet transform, it is clear that DFC and aDFC produce very different modulation outcomes as soon as the stimulation is turned ON, and that the spontaneous activity is quickly recovered when stimulation is turned OFF. In addition, introducing this concept makes the interpretation of results compiled in Figures 6 and 7 much more intuitive. In these figures, the wavelet transform is crucial to reveal how the different firing regimes change across time. Finally, we believe that this type of representation – the wavelet transform of the instantaneous firing rate of the entire population – is a very useful technique to analyse the population dynamics in long-term recordings and is not yet rightfully explored in the in vitro MEA literature. The raster plot typically used to represent spike data of neuronal populations is only useful in the seconds range; with the wavelet transform, we can analyse the populations’ dynamics across minutes and even hours.</p><disp-quote content-type="editor-comment"><p>&quot;Consistent inter-burst intervals will appear as a low frequency horizontal line&quot; – Why? If the ISI is constant but the firing rate is high, shouldn't it appear as a higher frequency horizontal line?</p></disp-quote><p>In the manuscript, we use two complementary by distinct metrics for the firing rate: the network instantaneous firing rate (the signals shown in Figure 2.C and E) and the average firing rate (shown in Figure 3). The network instantaneous firing rate is a time series that shows the number of spikes occurring in the network per electrode at each instant in time. The average firing rate is a scalar that represents the average number of spikes per electrode per second in the considered 5 min block (ON or OFF).</p><p>The wavelet transform is calculated based the network instantaneous firing rate. If there is a consistent inter-burst interval (let us say 1 second interval, for example) that means that there is a well-defined fundamental frequency (1 Hz, in this example) in the instantaneous firing rate signal. When calculating the wavelet transform of this signal, the fundamental frequency will be the lowest (and strongest) frequency component, at 1 Hz. Since the wavelet transform shows the frequency across time, this 1 Hz component will show up spread across time, appearing as a consistent horizontal line. We say “low frequency horizontal line” because, since it is the fundamental frequency, it is at the lowest frequency clearly present in the wavelet transform.</p><p>The wavelet transform can reveal the bursting periodicity of the collective network firing. Having high spike count in a given time block says nothing about the regularity of these spikes across time. The firing rate can be high due to powerful bursts that engage the entire network but, if these bursts do not occur at periodically, then the wavelet transform will not reveal a clear frequency component across time. On the other hand, if these occur at a pace of 1 burst per second, for example, the wavelet transform will show the well-defined 1 Hz component at its base. We added the following clarification to the manuscript:</p><p>Page 5: “<italic>Consistent inter-burst intervals (i.e., consistent neuronal oscillations) will appear as an horizontal line in the wavelet domain, corresponding to the fundamental frequency of the oscillation.”</italic></p><disp-quote content-type="editor-comment"><p>Figure 2:</p><p>I missed seeing the same analysis performed in the random stimulation condition – it could be included as a supporting figure just for completeness.</p></disp-quote><p>We have now included it as a supporting Figure 3—figure supplement 2. We do not show it in Figure 2 because the main goal of this figure was to show that, in biological neurons (as opposed to computational models), conventional DFC may lead to worse oscillatory behaviour, which justifies the need for an adaptive algorithm. Here, we purposely present only qualitative analysis, leaving the quantitative results for the next sections, where we also include the comparison with random stimulation.</p><disp-quote content-type="editor-comment"><p>Section 2.2:</p><p>The definition of firing rate should appear before, since it is one of the main variables used in the previous section.</p></disp-quote><p>As mentioned in a previous answer, we use both the notions of instantaneous firing rate and average firing rate. In the mentioned previous section of the manuscript, we refer to the instantaneous network firing rate, whereas in Section 2.2 we refer to the average firing rate over an entire 5 min block. We understand this difference may be overlooked by the reader, given the similarity of the names, and further clarified this distinction:</p><p>Page 6: “Synchrony measures the degree of co-activation of multiple electrodes (see Methods); firing rate corresponds to the average number of spikes per electrode per unit of time (not to be confused with the instantaneous network firing rate signal presented in Figures 2.C and D);”</p><disp-quote content-type="editor-comment"><p>Defining the oscillation frequency and intensity based on the main peak does not seem to make sense for the aDFC condition. Your premise is that this treatment disrupts periodicity (which it appears to do) then, in theory, there should not be a defined &quot;peak&quot; in the frequency domain. This identified peak will rest within the noise levels, rendering it &quot;random&quot;. Maybe a threshold could be set, i.e., if the signal-to-noise ratio of a peak is X, then it is considered, otherwise the frequency and intensity of the oscillation are respectively none and zero. Furthermore, the &quot;randomness&quot; of this oscillation frequency can be seen in Figure 3, where the trials with aDFC show a very large range of main frequencies.</p></disp-quote><p>After inspecting in detail all the FFTs obtained for all the experiments performed, we noted that some of the results obtained with aDFC and Poisson were indeed capturing noise, as well-pointed by Reviewer #1. Following the suggestion, we decided to upgrade the analysis of the frequency domain, so that it takes into account the background noise. This has led to some important modifications in the manuscript and has improved, in fact, several of our results. We thank Reviewer #1 for this important comment/suggestion. These modifications are described below:</p><p>Regarding the Oscillation Intensity, instead of using the magnitude of the peak of the FFT as metric, we calculated the Power Spectrum Density (PSD) and calculated the signal-to-noise ratio (SNR) of the fundamental frequency. This method is more robust since it takes into account how the power of the peak compares with the power of the background noise. Also, the SNR is calculated assuring that the DC component and harmonics are not mistaken as background noise (MATLAB function <bold>snr</bold>). Therefore, the new metric of Oscillation Intensity is the difference between the SNR of the ON period (under stimulation) and the OFF period (before stimulation). Note that for the metrics Firing Rate and Synchrony, we calculated the ratio between the ON and OFF metrics, whereas here we calculate the difference. That is simply because the SNR is expressed in logarithmic scale, and so, to compare the evolution from OFF to ON we must calculate the difference. We updated the manuscript accordingly:</p><p>Page 6: “To quantify this effect, we calculated the magnitude of the main oscillation by calculating the signal-to-noise ratio (SNR) of the Power Spectrum Density (PSD) of the instantaneous firing rate for the ON and OFF segments (Figure 2.D and F).”</p><p>Page 7: “Their effects on a given network are evidenced by normalizing the values of each feature to the initial OFF period (before stimulation) across the multiple trials (Figure 3.A). This also reveals how the dynamics are recovered once the stimulation is turned OFF. Note that, for the Oscillation Intensity, this normalization corresponds to the difference between the ON and OFF periods, since the scale is logarithmic.”</p><p>Page 19: “The oscillation intensity is measured by calculating SNR of fundamental frequency of the Power Spectrum Density. This was calculated using the Matlab functions pwelch for the PSD and snr for the SNR, which computes the ratio of the summed squared magnitude of the fundamental frequency to that of the noise. The snr function automatically detects the fundamental frequency and assures that the harmonics and DC component are not mistaken as noise. The fundamental frequency corresponds to the frequency at the peak of the PSD.</p><p>For the firing rate and synchrony, the effect of each stimulation protocol was evaluated by calculating the metric’s fold change form OFF to ON. For the oscillation intensity we calculated the difference between the OFF and ON periods, since it is measured in dB, which is a logarithmic scale.”</p><p>Regarding the Oscillation Frequency metric, it is indeed problematic to attribute a value that could be just noise. Reviewer #1 suggested establishing a threshold for the SNR of the peak and considering only the cases where the SNR is above the threshold. However, we were afraid that the value chosen for the threshold could be quite arbitrary. Consequently, we decided to remove this problematic metric from the main analysis. This means that the definition of Controllable Network is no longer based on four metrics, but only the remaining three: Firing Rate, Synchrony and (the updated and more robust) Oscillation Intensity. Using these three metrics led to slight changes in Figures 3 and 4 (one network went from Controllable to Uncontrollable, and another from Uncontrollable to Controllable), but made no significant difference in the overall conclusions. Nonetheless, it is still interesting to comment on the alteration of the Oscillation Frequency (the frequency at the PSD peak), particularly when using the standard DFC, where it tends to increase. Following this, we included another figure in Supplementary Materials, Figure 3—figure supplement 3, where we plotted the change in Oscillation Frequency as a function of the SNR difference for all experiments. Our goal was to show that, at least for DFC, an increase in the SNR of the oscillation is followed by an increase in the oscillation frequency.</p><p>We thank again Reviewer #1 for this important comment which improved the clarity and the quality of our results. Re-analysing this data, and doing again several figures, was the reason why the submission of this revised version took longer. We would also like to state that, in the process of thoroughly revising these calculations and preparing the dataset for Zenodo, we found a couple of misplaced files in the original analysis (from a universe of 237 files). In the previous version, one of the uncontrollable networks in Figure 3E had three experiments (datapoints) that belonged to another network. After removing these three datapoints, this network no longer obeyed the criteria of having at least three experiments performed with each protocol (as stated in our Methods section). Consequently, we had to remove this uncontrollable network from the Figure 3. Since it was an uncontrollable network, it did not affect the results from Figure 4 (nor had any impact on the other results/conclusions of the paper). We also noticed that three files from the network in Figure 7 had not been included in the analysis, corresponding to two experiments with Poisson stimulation and one experiment with aDFC. Adding these experiments strengthened the conclusions, in fact, as the difference between aDFC and Poisson became even clearer.</p><disp-quote content-type="editor-comment"><p>Figure 3:</p><p>How is the z-score calculated?</p></disp-quote><p>The z-score normalization centres the data to have mean 0, and scales it to have standard deviation of 1.</p><p>Legend of Figure 3E was updated to: “[…] The black traced line corresponds to the first principal component (PC1) of the standardized (z-score, i.e., mean equals zero and standard deviation equals one) synchrony and firing rate defining a relevant descriptor of the neuronal dynamics.”</p><disp-quote content-type="editor-comment"><p>Section 2.3:</p><p>Figure 4A show oscillation intensity yet, in the main text, you claim that &quot;standard DFC led to more consistent oscillations&quot;. How does intensity relate to consistency? DFC shows a higher inter-trial variance than the other conditions (less consistent?)</p></disp-quote><p>By “consistent oscillations”, we mean that the oscillation frequency becomes very stable during a given experiment with DFC (regardless of whether or not the frequency value itself is consistent across experiments). A very consistent oscillation periodicity will lead to a peak with high power in the Power Spectrum Density. We are now referring to SNR of the PSD peak as the Oscillation Intensity because it relates to how much the overall signal is dominated by the oscillatory component (note that before, we were evaluating the Oscillation Intensity by the amplitude of the peak of the Fourier Transform, but changed to the SNR of the peak because it is more robust and takes into account the background noise).</p><p>Indeed, DFC presents high inter-trial variance in the Oscillation Intensity (which is smaller now it the SNR measure) but, when we mentioned “standard DFC led to more consistent oscillations”, we were referring to the fact that there is an increase in the oscillation intensity. This entire paragraph re-written to clarify this point and to account for the fact that we updated the metrics and the statistical tests. It now reads:</p><p>Page 9: “The performances of DFC, aDFC and Poisson stimulation were evaluated by comparing their average effect on the three metrics across all the controllable network (Figure 4), where each datapoint corresponds to the metric’s mean for all the experiments performed with a given network and stimulation protocol (in Figure 3—figure supplement 2 we show all the datapoints of network, from which the means are extracted). Uncontrollable networks are not considered here as their results are, by definition, not reproducible. We included trials without stimulation for each network as a control group to capture the natural variability of each metric; in these, we calculated the metrics for two consecutive 5 min blocks of spontaneous activity, representing the initial OFF and ON periods.</p><p>The most significant distinction between control algorithms was evidenced at the level of the bursting oscillations (Figure 4.A). Both aDFC and random stimulation led to a significant decrease in Oscillation Intensity. The standard DFC algorithm, on the other hand, led to a significant increase in Oscillation Magnitude. This increase in magnitude was followed by an increase in the oscillation frequency (Figure 2A-C and Figure 3—figure supplement 3). The only stimulation protocol that led to a significant decrease in synchrony was aDFC (Figure 4.B) and its effect was significantly different form that of random stimulation. On the other hand, it was also the only method that significantly increased the average firing rate (Figure 4.D), even though the average stimulation frequency was similar for the three methods (Figure 3—figure supplement 3).”</p><disp-quote content-type="editor-comment"><p>Figure 4:</p><p>All variables are studied in four different conditions, yet the authors use t-tests to evaluate statistical significance. This is the wrong statistical test to use – an ANOVA should be used. In this situation, multiple t-tests will lead to an increase in false positives.</p></disp-quote><p>We repeated the tests using ANOVA and updated the results in the manuscript. This did not affect the results/conclusions of the work. The changes made in the manuscript are already mentioned in the previous answer. We also updated the supplementary table with details of the statistical test. We thank Reviewer #1 for this correction.</p><disp-quote content-type="editor-comment"><p>Section 2.4:</p><p>Did you quantify the excitatory/inhibitory balance in your MEA cultures? Could be interesting to compare to the simulation results.</p></disp-quote><p>We did not have access to the excitatory/inhibitory balance in the in vitro experiments, but it is an interesting point to consider in future experiments.</p><disp-quote content-type="editor-comment"><p>Section 2.5:</p><p>The authors state that multiple trials were conducted in the same network but do not mention how long the network was allowed to recover in between trials, which is necessary information.</p></disp-quote><p>have been important to precisely control the period between experiments if the cultures took a long time to recover from the previous stimulation period. However, we saw that, once stimulation stopped, the firing dynamics returned to the baseline regime very quickly (Figure 2.A and B and Figure 3.A). We have added the following text to subsection 5.5 in the Methods:</p><p>Page 22, Methods: “The time interval between consecutive trials was in the order of 5 minutes. A precise time interval between trials was not required/imposed as, once stimulation stopped, the firing dynamics returned to the baseline regime very quickly (Figure 2.A and B and Figure 3.A).”</p><disp-quote content-type="editor-comment"><p>Furthermore, the authors state that only one network showed this effect (spontaneous AS time prior to stimulation). If only one network showed this among 14, how biologically relevant is this?</p></disp-quote><p>Indeed, from all the networks whose dynamics changed over time, only one showed brief and sporadic periods of spontaneous asynchrony consistently across the entire day of experiments. Still, the goal of this section is not on how biologically relevant (or frequent) this type of dynamics is but, instead, to show that aDFC could perform particularly well in this network that natively showed spontaneous transitions to brief periods of asynchrony. We hypothesize in the manuscript that the good performance could be due to the fact that this network could sustain asynchronous activity, while most networks cannot (at least with this minimally invasive stimulation protocol). In this situation, aDFC “just” have to promote the transition to the asynchronous activity state (already available), instead of creating and continuously forcing asynchronous activity. We believe this is an important idea, even if speculative.</p><p>This particular case also allows us to show that, once aDFC promoted the state transition, this state was maintained with almost no stimulation, a feature that is desirable for brain stimulation protocols. Also, this fact significantly differentiates aDFC from random Poisson which, as an open-loop protocol, thus does not adapt to the changing dynamics of the network. We expect this factor to be particularly relevant when moving to in vivo experiments, because brain networks are considerably more dynamic than in vitro networks and alternate between different synchrony states.</p><disp-quote content-type="editor-comment"><p>How can you be sure that this is not a consequence of a confounding variable (not properly developed network, etc). How old was this network?</p></disp-quote><p>We did not speculate on the reasons that the network displayed this multi-stability. Indeed, there may be many relevant variables governing the network dynamics, but it is unlikely that the network is underdeveloped because this experiment was performed on the 32 DIV and the network still exhibited abundant firing. However, the reasons behind the dynamics of such network were not the focus on this section, but rather to recognize that only aDFC forced the intended state transition in a network with such particular dynamics.</p><disp-quote content-type="editor-comment"><p>Was it also used in other DIVs?</p></disp-quote><p>Yes, this culture was used in both DIVs 32 and 37. This network is the one represented in blue in Figure 3—figure supplement 1.D. Its firing dynamics, and the way stimulation interfered with them, changed from day 32 to day 37. For example, in DIV 32 the network was multi-stable, and in DIV 37 it was not. Also the spontaneous dynamics occupy different regions of the spontaneous Synchrony vs Firing Rate map (Figure 3—figure supplement 1.D blue network).</p><disp-quote content-type="editor-comment"><p>Figure 7:</p><p>The effect of the Poisson stimulation appears to be more similar to aDFC than random. A more in depth discussion would be helpful to better understand how a &quot;random&quot; stimulation could cause such a &quot;block-type&quot; effect.</p></disp-quote><p>Indeed, there are periods of asynchrony during random Poisson stimulation, but their prevalence is similar to what is found in spontaneous activity (Figure 7.G). So, it is not possible to say whether the asynchronous states were achieved due to the random Poisson stimulation or if they would still occur even without stimulation. On the other hand, with aDFC, the time spent in asynchronous state increased significantly.</p><p>Still, it is possible that a properly tuned random stimulation (as the one used here, regarding the frequency parameters of the Poisson process) could induce an asynchronous state. Maybe not through a “block-type” effect, such as the depolarization block mechanism proposed to occur in high-frequency deep brain stimulation [1], but instead by simply perturbing the spontaneously sustained firing oscillation; perhaps through an analogous mechanism to the “disruption” hypothesis that has been proposed to explain the effects of deep brain stimulation [1]. The “therapeutic” effect of adding noise is not particular to this situation. It is a “snow globe effect”: the dynamics are so affected that noise can be beneficial to bring it closer to “physiological” state (better than a patterned stimulus that imposes different but still pathological dynamics). Independently of the discussion on the mechanism(s), it is important to emphasize that, unlike aDFC, random stimulation is open loop, meaning that it does not adjust to the changing firing dynamics, nor does it stop stimulating once the desired state is achieved.</p><p>We added the following to the manuscript:</p><p>Page 15, Discussion: “The adaptive version, aDFC, effectively disrupted the oscillations and decreased network synchrony. Interestingly, random stimulation, using similar stimulation frequency, was also able to achieve this, although without significantly decreasing synchronization. Electrical stimulation may be acting as a disrupter of the emergent network dynamics, as it has been proposed for high-frequency deep brain stimulation (Chiken et al. 2016).”</p><p>[new REF] Chiken, Satomi, and Atsushi Nambu. &quot;Mechanism of deep brain stimulation: inhibition, excitation, or disruption?&quot; The neuroscientist 22.3 (2016): 313-322.</p><disp-quote content-type="editor-comment"><p>The comparison between OFF-ON-OFF states refers to a comparison of the same object in different timepoints. Thus, t-tests are not the correct statistical test here, but rather a repeated measures ANOVA (or non-parametric equivalent) must be used.</p></disp-quote><p>The statistical tests were repeated with ANOVA. Consequently, Figure 7 was updated as well as the supplementary tables with details of the statistical tests. There were no differences in the conclusions. We thank Reviewer #1 for this correction.</p><disp-quote content-type="editor-comment"><p>Methods:</p><p>The authors state that experiments were performed between 13 and 55 DIV. When considering cultured neuron networks, this range makes a gigantic difference in their behavior, since the culture will not be fully mature at DIV 13, and the neuronal health at DIV 55 will already have declined. Only cultures at equivalent maturity levels should be compared.</p></disp-quote><p>The goal of this paper was to test/assess control algorithms on networks that exhibited synchronous oscillations. We believe we would have a less convincing work if we showed aDFC working only on cultures with equivalent maturity levels: by covering a wider range of situations, we can claim that the quality of the control is more related to the properties of the algorithm and less related to the specificities of the mechanism giving rise to the synchronous oscillations (the target behaviour of the control). So, our criteria to decide on which networks to perform the experiments were the firing dynamics exhibited by the culture, regardless of the DIV. We were selective by only choosing networks that presented synchronous oscillations with consistent inter-bursts intervals, ranging between 1-5 seconds.</p><p>We do not exclude the possibility that aDFC (or DFC, or Poisson) performs better/worse at specific maturity ranges, but we believe we present a more solid claim by covering multiple maturity levels (given that the focus is on the capabilities of the algorithm for disrupting synchronous oscillations). Also, we did not see any correlation between DIV of the selected networks and controllability (see Figure 3—figure supplement 1.E).</p><disp-quote content-type="editor-comment"><p>Authors define &quot;network as a neuronal culture in a given day in vitro&quot;. This needs to be clarified for statistical analysis. With this definition, does it mean that if two experiments are performed in the same neuronal culture but in two different days, they are considered two independent networks? While the network behavior might change throughout days in vitro (and network maturity), it is not possible to state that the behavior of the network is independent from its previous state. Extra care should be had when performing statistical analysis on those data – they should be handled as the same &quot;object&quot; at different timepoints, NOT independent networks.</p></disp-quote><p>As stated, we are considering the same culture in a different DIV to be a different network. We refer to “network” as the dynamic system that is being subject to control. And, indeed, in different DIVs, the same culture does behave like a different dynamical system in the sense that the spontaneous dynamics are very different, as well as its controllability. This can be seen in Figure 3—figure supplement 1.D. Please notice that this distinction between culture and network in the context of controlling neuronal networks is not uncommon (see, for example, [1]). In our study, from the perspective of evaluating the effect of the different control algorithms, the same culture at different DIVs (with changed circuitry, connectivity level, baseline activity intensity, etc..), provide distinct dynamical systems. The statistical analysis was improved following the previous comments from Reviewer #1.</p><p>[1] Wülfing, Jan M., et al. &quot;Adaptive long-term control of biological neural networks with deep reinforcement learning.&quot; <italic>Neurocomputing</italic> 342 (2019): 66-74.</p><disp-quote content-type="editor-comment"><p>The method used to determine the main frequency and intensity of the oscillation ASSUMES that there is a peak frequency, which may not be true and lead to erroneous results and conclusions.</p></disp-quote><p>Reviewer #1 is correct, and this was already addressed in a previous answer.</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>This was a clear, well-written study. I only have a few suggestions/comments to the authors:</p><p>0) Can you discuss whether you expect brain networks to operate in uncontrollable vs. controllable regimes? Is there evidence that brain networks should be controllable?</p></disp-quote><p>Our definition of controllable/uncontrollable networks can also be applied to brain networks in the sense that stimulating a particular brain networks will either generate a reproducible neuromodulation effect or not. In that sense, when deep brain stimulation is effective, it must be targeting a controllable network since it is consistently modulating the neuronal activity.</p><p>Neurostimulation controllability will depend, of course, on the particular brain network/circuit but also on the stimulation system: a network may be controllable with an array of stimulating electrodes, and uncontrollable using a single stimulating electrode.</p><p>Another interesting question is whether or not the spontaneous dynamics of a given brain network predict its propensity for neuromodulation (analogously to what we saw in vitro and <italic>in silico</italic>). The identification of such correlation would enable a more meticulous planning of the placement of neural stimulators. But, as far as we know, there is no evidence for that in vivo.</p><disp-quote content-type="editor-comment"><p>1) Can you establish a correspondence between the controllable subspace in the in silico model in Figure 5 and the controllable network properties in Figure 3? For example, can you make Figure 5B left (change in synchrony as a function of synaptic weight vs. excitatory neurons) into a synchrony as a function of firing rate vs. synchrony plot? Then superimpose data from Figure 3E so that one can see whether the in silico network properties are similarly predictive of controllable vs. uncontrollable networks as the in vitro network properties. If there isn't a clear correspondence between the in silico and in vitro networks, please discuss.</p></disp-quote><p>We added a supplementary figure (Figure 5—figure supplement 1) analogous to Figure 3 for the <italic>in silico</italic> results, where the X and Y axis correspond to the level of spontaneous synchrony and firing rate, respectively. The in vitro data is in the same order of magnitude as the controllable region seen <italic>in silico</italic> (spontaneous synchrony between 10<sup>-1</sup> and 10<sup>0</sup> and spontaneous firing rate between 10<sup>0</sup> and 10<sup>1</sup>). But it is important to mention that the purpose of the <italic>in silico</italic> tests was not to exactly reproduce the results seen in vitro, but rather to test if specific network parameters could restrict/enable neuronal modulation. Still, on this new figure (Figure 5—figure supplement 1, analogous to Figure 3) it is possible to see a correspondence between the <italic>in silico</italic> model and in vitro networks.</p><disp-quote content-type="editor-comment"><p>2) Could you either provide experimental data or a discussion of previous studies that have tested conventional high frequency stimulation (~100-120 Hz) and studied its effects on neural synchronization? How might you expect your aDFC results to compare to conventional high frequency stimulation?</p></disp-quote><p>High-frequency stimulation (HFS) has been shown to disrupt pathological synchronization in disorders such as Parkinson’s disease [1] and epilepsy [2]. The question of whether aDFC would be more efficient in disrupting pathological oscillations than a properly tuned HFS remains unanswered. What can be expected is the fact that, once the network is desynchronized, aDFC will no longer impose strong stimulation on the network (some stimulation may still occur due to fluctuations of the actuation signal, but these may be advantageous in preventing synchronization to emerge again); HFS, on the other hand, would continue to stimulate regardless of its effect on the network. Also, if aDFC has the same efficacy as HFS, it will achieve that with a much less “aggressive” approach, since the premise of DFC algorithms is to disrupt the oscillation using small perturbations [3].</p><p>[1] Eusebio, Alexandre, et al. &quot;Deep brain stimulation can suppress pathological synchronisation in parkinsonian patients.&quot; <italic>Journal of Neurology, Neurosurgery &amp; Psychiatry</italic> 82.5 (2011): 569-573.</p><p>[2] Yu, Tao, et al. &quot;High-frequency stimulation of anterior nucleus of thalamus desynchronizes epileptic network in humans.&quot; <italic>Brain</italic> 141.9 (2018): 2631-2643.</p><p>[3] Pyragas, Kestutis. &quot;Delayed feedback control of chaos.&quot; <italic>Philosophical Transactions of the Royal Society A: Mathematical, Physical and Engineering Sciences</italic> 364.1846 (2006): 2309-2334.</p><p>We added the following information to the Discussion:</p><p>Page 15: “Whether aDFC is more efficient in disrupting pathological oscillations than high-frequency stimulation (HFS) remains unknown but, as opposed to fixed/continuous HFS, aDFC stimulation adapts to the population oscillation frequency and ceases once the network is desynchronized.”</p><disp-quote content-type="editor-comment"><p>There is some mention in the discussion of a study that uses 10-50 Hz and is able to prevent synchronous states from forming at the cost of a high firing rate. Why is the high firing rate a problem? Might this be the source of undesirable side effects of stimulation? Please discuss this in more detail in the discussion as it directly sheds light on how useful your algorithm may be compared to conventional stimulation.</p></disp-quote><p>The pathological neuronal synchronization seen in many neurological disorders is typically associated with an increased firing rate. As such, an algorithm that disrupts the pathological oscillation at the cost of increasing the firing rate even further may not be ideal, as it may be pushing the network into another pathological state. In that study mentioned in the discussion [1] they noticed that, when the networks were forced to fire at a rate much higher than the baseline levels (from the spontaneous 20 spikes per second array-wide to 400 spikes per second), the networks could no longer sustain synchronized activity. This is an interesting result, but it could be argued that the pathological synchronization was replaced by another abnormal firing pattern. Our aDFC protocol also increased the firing rate of the network, but only by 16% (see Supplementary File 1 (Table S1)). As a side note, the average increase in firing rate for the other two algorithms was higher (33% and 23% for DFC and Poisson, respectively), although with low statistical significance. Still, a slight increase in firing rate is not surprising considering that we are providing an excitatory signal to the network. The ideal scenario where excitatory electrical stimulation can actually decrease the firing rate is when a closed-loop algorithm can force a transition to an asynchronous state and stops/reduces stimulation as a consequence of that, just like it happed for the multi-stable network under aDFC (Figure 7).</p><p>[1] Wagenaar, Daniel A., et al. &quot;Controlling bursting in cortical cultures with closed-loop multi-electrode stimulation.&quot; <italic>Journal of Neuroscience</italic> 25.3 (2005): 680-688.</p><p>We added the following information to the Discussion:</p><p>Page 15: “Other methods can achieve network desynchronization by following approaches that are more aggressive. Namely, it was already shown that continuous high frequency stimulation (10-50 Hz), distributed across multiple electrodes, can prevent network synchronization (Wagenaar 2005). This is done, however, at the cost of highly increasing the overall network’s firing rate, thus possibly establishing yet another non-physiological state. The goal of avoiding an abnormal prolonged increase in the population’s firing rate is grounded on the understanding that excessive activity is also detrimental in a neuronal circuit.”</p><disp-quote content-type="editor-comment"><p>3) Please discuss in the discussion the limits of the in vitro model, particularly in reference to the low frequency synchrony that the populations exhibit (~1 hz) compared to the pathological oscillatory activity thought to be relevant to PD (15-30 hz) or ET (5-7 Hz). Do you expect your algorithm to have difficulties suppressing these higher frequency oscillations?</p></disp-quote><p>Our in vitro model exhibited oscillations that are slower than those occurring in neuronal disorders such as Parkinson’s Disease or Essential Tremor. But there is nothing in the DFC method itself forcing it to work only within certain frequency ranges. Please notice that, by construction, DFC responds directly to the system frequency, be it 1 Hz or 30 Hz. In fact, DFC has been already implemented in many different non-neurological substrates, with a with range of oscillation frequencies, such as electrochemical systems, electrical oscillators, mechanical pendulums, among others [1].</p><p>Having said that, it is possible that the faster pathological oscillations seen in vivo may be harder to disrupt, not necessarily for being faster, but because the mechanisms underlying the oscillations may be very different from those occurring in vitro. Nonetheless, it is important to note that the oscillations seen in the in vitro models are more prominent than those seen in vivo, which only last brief periods of time [2]. The more consistent in vitro oscillations could be due to the exacerbated neuronal connectivity that emerges in these unconstrained cultures. It is reasonable to admit that a network whose spontaneous activity consists only of synchronized firing poses a more difficult challenge for the aDFC algorithm (or any other) than a network that can naturally sustain different firing regimes, such as in vivo networks.</p><p>[1] Pyragas, Kestutis. &quot;Delayed feedback control of chaos.&quot; <italic>Philosophical Transactions of the Royal Society A: Mathematical, Physical and Engineering Sciences</italic> 364.1846 (2006): 2309-2334.</p><p>[2] Tinkhauser, Gerd, et al. &quot;The modulatory effect of adaptive deep brain stimulation on β bursts in Parkinson’s disease.&quot; <italic>Brain</italic> 140.4 (2017): 1053-1067.</p><disp-quote content-type="editor-comment"><p>Are there in vitro models that exhibit higher frequency oscillations that could be used to test this algorithm?</p></disp-quote><p>Dissociated neuronal cultures present this type of slower oscillations [3], but in vitro brain slices can display much faster oscillations, in the orders of dozens of Hz [4]. Organotypic brain slices can be cultured on MEAs and be viable for several weeks. This would be an interesting model to further test the algorithm, but we hope Reviewer #2 agrees that this would be another study by itself.</p><p>[3] Wagenaar, Daniel A., Jerome Pine, and Steve M. Potter. &quot;An extremely rich repertoire of bursting patterns during the development of cortical cultures.&quot; <italic>BMC Neurosc.</italic> 7.1 (2006): 1-18.</p><p>[4] Dulla, Chris G., et al. &quot;How do we use in vitro models to understand epileptiform and ictal activity? A report of the TASK 1‐WG 4 group of the ILAE/AES Joint Translational Task Force.&quot; <italic>Epilepsia Open</italic> 3.4 (2018): 460-473.</p><disp-quote content-type="editor-comment"><p>4) Can the authors comment on how many units must be monitored from in order to make an accurate estimate of the underlying neural population's oscillatory frequency?</p></disp-quote><p>Interesting question. If most of the recording electrodes are capturing synchronous oscillatory activity, then the (population) instantaneous firing rate will show clear periodic peaks from which the oscillation frequency can be accurately estimated (and, on the limit, a single recording unit would suffice). On the other hand, if only a small percentage of the recording electrodes capture synchronized firing and the rest capture sparse firing, then the instantaneous population firing rate may not show a clear periodic signal (and more recording units are required). Thus, it is not only a matter of how many recording units are available but also, how present the oscillation is compared with the sparse firing.</p><disp-quote content-type="editor-comment"><p>Can LFP features be used instead of multiple single neuron recordings? This has a direct bearing on how readily translatable this technology is to current neurostimulation devices.</p></disp-quote><p>The <italic>in silico</italic> studies use LFP as the tracked variable [1-3]. In our study, since we were working with dissociated cultures over MEAs, we had access to the extracellular spikes. That is why our DFC and aDFC algorithms are based on the instantaneous population firing rate signal, calculated from the spike data. But LFPs could have been used instead: analogously to the instantaneous population firing rate, LFPs will have a peak when the population fires in synchrony. Working with the LFP instead of individual spikes would actually make the workflow simpler, since this signal could be used directly to feed the DFC algorithms.</p><p>[1] Liu, Chen, et al. &quot;Delayed feedback-based suppression of pathological oscillations in a neural mass model.&quot; <italic>IEEE Transactions on Cybernetics</italic> 51.10 (2019): 5046-5056.</p><p>[2] Daneshzand, Mohammad, Miad Faezipour, and Buket D. Barkana. &quot;Robust desynchronization of Parkinson’s disease pathological oscillations by frequency modulation of delayed feedback deep brain stimulation.&quot; <italic>PloS one</italic> 13.11 (2018): e0207761.</p><p>[3] Popovych, Oleksandr V., Christian Hauptmann, and Peter A. Tass. &quot;Control of neuronal synchrony by nonlinear delayed feedback.&quot; <italic>Biological cybernetics</italic> 95.1 (2006): 69-85.</p><disp-quote content-type="editor-comment"><p>5) During aDFC how often were the frequency (w) and period time (T) updated?</p></disp-quote><p>As described in the manuscript, the frequency and period are updated whenever the median of the last 5 inter-burst interval changes. The median is calculated when a new burst is detected, meaning that, in theory, the value of <italic>w</italic> and <italic>T</italic> can change every time a new burst arrives. However, for a drastic change in the values of <italic>w</italic> and <italic>T</italic> – for example, the population was firing consistently at 1Hz and suddenly changes to 2Hz – the algorithm requires three 1/(2Hz) = 0.5s intervals between bursts for the median T to be updated to 0.5s, and the w to 2Hs: [1, 1, <bold>0.5</bold>, 0.5, 0.5]s. This can be seen in the Figure 1—figure supplement 1.</p><disp-quote content-type="editor-comment"><p>6) Where was the ground for the stimulation electrode?</p></disp-quote><p>The experiments were performed on 9well and 6well MEAs. Each well has an independent culture with recording/stimulating electrodes and a ground electrode. The ground electrodes are placed as shown here:</p><p>9 well MEA: <ext-link ext-link-type="uri" xlink:href="https://www.multichannelsystems.com/products/256-9wellmea30030ir-ito-mq">https://www.multichannelsystems.com/products/256-9wellmea30030ir-ito-mq</ext-link></p><p>6 well MEA: <ext-link ext-link-type="uri" xlink:href="https://www.multichannelsystems.com/products/256-6wellmea20030ir-ito-rcr">https://www.multichannelsystems.com/products/256-6wellmea20030ir-ito-rcr</ext-link></p><disp-quote content-type="editor-comment"><p>Does your stimulation better mimic bipolar or monopolar stimulation in current therapeutic DBS therapies?</p></disp-quote><p>Our stimulation is monopolar: the circuit is closed between each stimulating electrode and a common GND. Still, one needs to be careful on a direct comparison between in vivo DBS and in vitro stimulation, as conditions are different.</p><disp-quote content-type="editor-comment"><p>What was the impedance of the stimulation electrode?</p></disp-quote><p>For the used electrodes (titanium nitride, planar and with 30 µm diameter) the impedance is &lt; 100 kΩ.</p><disp-quote content-type="editor-comment"><p>Some neuromodulation fields use current (not volts) to report their stimulation amplitude and it would be helpful for those building on this study to have both quantities reported. In addition, please report the electrode surface area so that current density calculations can be made.</p></disp-quote><p>As described, in this study stimulation is provided as voltage pulses. Stimulation amplitude, either I or V, is set at the level of robustly eliciting a neuronal response but still within physiological ranges. For in vitro cultures, V stim is typically in the order of 500-800 µV amplitude and duration of tenths of µs, whereas I stim amplitude is in the order of tenths of µA.</p><p>We added the following information to the Discussion:</p><p>Page 17: “Each well of the 6-well MEA has 42 TiN circular electrodes (array of 7 × 6), and the 9-well contain arrays of 26 TiN circular electrodes (6 x 5 without corners), each with a diameter of 30 µm.”</p><disp-quote content-type="editor-comment"><p>7) Why was stimulation frequency the metric that was updated by DFC and aDFC as opposed to stimulation amplitude?</p></disp-quote><p>We had two options: either keep the amplitude fixed and modulate the stimulation frequency, or keep a constant stimulation frequency and modulate the stimulus amplitude. We chose the former for two main reasons. First, it was easier to stablish a pertinent stimulation amplitude, following our protocol of setting the minimum amplitude that elicited a neuronal response. Fixing the stimulation frequency would require a somewhat arbitrary choice of stimulation frequency, or would force us to test different frequencies, which would unnecessarily expand the testing conditions. The second reason is practical: given the way the hardware and software were set up, it was easier to fix the amplitude and have the computer trigger the stimulus than to have a new stimulus waveform being download to the stimulus generator at every stimulation instance.</p></body></sub-article></article>