<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.2"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">86585</article-id><article-id pub-id-type="doi">10.7554/eLife.86585</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group><subj-group subj-group-type="heading"><subject>Physics of Living Systems</subject></subj-group></article-categories><title-group><article-title>Continuous, long-term crawling behavior characterized by a robotic transport system</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-308409"><name><surname>Yu</surname><given-names>James</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6247-0433</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-308410"><name><surname>Dancausse</surname><given-names>Stephanie</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-308412"><name><surname>Paz</surname><given-names>Maria</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-308828"><name><surname>Faderin</surname><given-names>Tolu</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-308413"><name><surname>Gaviria</surname><given-names>Melissa</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-235730"><name><surname>Shomar</surname><given-names>Joseph W</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0009-0000-9534-6263</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-111434"><name><surname>Zucker</surname><given-names>Dave</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-0259-6293</contrib-id><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" corresp="yes" id="author-169960"><name><surname>Venkatachalam</surname><given-names>Vivek</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2414-7416</contrib-id><email>v.venkatachalam@northeastern.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-47039"><name><surname>Klein</surname><given-names>Mason</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8211-077X</contrib-id><email>klein@miami.edu</email><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04t5xt781</institution-id><institution>Department of Physics, Northeastern University</institution></institution-wrap><addr-line><named-content content-type="city">Boston</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02dgjyy92</institution-id><institution>Department of Physics and Department of Biology, University of Miami</institution></institution-wrap><addr-line><named-content content-type="city">Coral Gables</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution>FlySorter, LLC</institution><addr-line><named-content content-type="city">Seattle</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Louis</surname><given-names>Matthieu</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02t274463</institution-id><institution>University of California, Santa Barbara</institution></institution-wrap><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>VijayRaghavan</surname><given-names>K</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03ht1xw27</institution-id><institution>National Centre for Biological Sciences, Tata Institute of Fundamental Research</institution></institution-wrap><country>India</country></aff></contrib></contrib-group><pub-date publication-format="electronic" date-type="publication"><day>03</day><month>08</month><year>2023</year></pub-date><pub-date pub-type="collection"><year>2023</year></pub-date><volume>12</volume><elocation-id>e86585</elocation-id><history><date date-type="received" iso-8601-date="2023-02-01"><day>01</day><month>02</month><year>2023</year></date><date date-type="accepted" iso-8601-date="2023-07-19"><day>19</day><month>07</month><year>2023</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at bioRxiv.</event-desc><date date-type="preprint" iso-8601-date="2023-02-28"><day>28</day><month>02</month><year>2023</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.02.27.530235"/></event></pub-history><permissions><copyright-statement>© 2023, Yu et al</copyright-statement><copyright-year>2023</copyright-year><copyright-holder>Yu et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-86585-v1.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-86585-figures-v1.pdf"/><abstract><p>Detailed descriptions of behavior provide critical insight into the structure and function of nervous systems. In <italic>Drosophila</italic> larvae and many other systems, short behavioral experiments have been successful in characterizing rapid responses to a range of stimuli at the population level. However, the lack of long-term continuous observation makes it difficult to dissect comprehensive behavioral dynamics of individual animals and how behavior (and therefore the nervous system) develops over time. To allow for long-term continuous observations in individual fly larvae, we have engineered a robotic instrument that automatically tracks and transports larvae throughout an arena. The flexibility and reliability of its design enables controlled stimulus delivery and continuous measurement over developmental time scales, yielding an unprecedented level of detailed locomotion data. We utilize the new system’s capabilities to perform continuous observation of exploratory search behavior over a duration of 6 hr with and without a thermal gradient present, and in a single larva for over 30 hr. Long-term free-roaming behavior and analogous short-term experiments show similar dynamics that take place at the beginning of each experiment. Finally, characterization of larval thermotaxis in individuals reveals a bimodal distribution in navigation efficiency, identifying distinct phenotypes that are obfuscated when only analyzing population averages.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>exploration</kwd><kwd>navigation</kwd><kwd>automation</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>D. melanogaster</italic></kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000861</institution-id><institution>Burroughs Wellcome Fund</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Venkatachalam</surname><given-names>Vivek</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>NIH R01 NS126334</award-id><principal-award-recipient><name><surname>Venkatachalam</surname><given-names>Vivek</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>NSF CAREER 2144385</award-id><principal-award-recipient><name><surname>Klein</surname><given-names>Mason</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value><italic>Drosophila</italic> larvae manipulated by an automated system can be observed for 30+ hr, and new analysis methods of long-timescale trajectories reveal behavioral features previously inaccessible, such as a bimodal distribution of thermal navigation efficiency in individual animals.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>A complete description of an organism’s behavior, or any responsive system more generally, would include a map of how inputs transform into outputs. Reflexes or decisions made by the peripheral and central nervous systems, for example, can be characterized as functions that take surrounding environmental (and internal) stimulus information, process it, and lead to a physical behavior. An organism’s transformation properties are rarely constant, and instead change over short and long time scales, determined by its stimulus history and development. A comprehensive understanding of animal behavior and its underlying mechanisms would ideally address all time scales between fast neural responses through the slow physiological changes associated with development. Short-term responses to individual stimuli have been characterized in many organisms, but a high-bandwidth treatment with continuous measurement of behavior through the entire time course of an animal’s development has been prohibitive. The lack of continuous observation makes it difficult to dissect individual behavioral dynamics and their development over time. In most organisms, behavior is too fast, too complicated, is performed in too large of a space, or otherwise too difficult to observe with sufficient resolution over a long time.</p><p>Recent work in several model systems has begun to dramatically increase the duration of behavioral recording. Roaming and dwelling behavior in worms has been recorded with high spatiotemporal resolution through larval development by via isolation of individuals in small arenas (<xref ref-type="bibr" rid="bib58">Stern et al., 2017</xref>). The multi-camera imaging system has observed changes in roaming behaviors across and within developmental stages in the same animal along with providing insight into the variation of these behaviors between individuals in a population. Long-term home-cage behavior in both mice (<xref ref-type="bibr" rid="bib20">Goulding et al., 2008</xref>) and rats (<xref ref-type="bibr" rid="bib48">Poddar et al., 2013</xref>) has been studied using a combination of behavior-specific sensors and cameras. The home-cage systems include automated monitoring and training of multiple animals in parallel, increasing overall throughput and minimizing the human assistance required for such tasks, and have been successful in elucidating new determinants in behaviors across multiple time scales, including feeding, daily activity patterns, and learning novel motor tasks. Finally, long-duration recording of 1D walking in adult fruit flies (<italic>Drosophila melanogaster</italic>) has been recorded using a simple photobeam interrupt (<xref ref-type="bibr" rid="bib47">Pfeiffenberger et al., 2010</xref>), and more complex behaviors have been recorded using video monitoring (<xref ref-type="bibr" rid="bib17">Geissmann et al., 2017</xref>) and robotic manipulation (<xref ref-type="bibr" rid="bib1">Alisch et al., 2018</xref>). Our goal in the present work is to investigate long-term locomotion in a free, open physical space, by continuously monitoring a simple model organism with a short life cycle, which will allow us to characterize exploratory search and directed navigation over a sizable fraction of the organism’s life cycle.</p><p>The <italic>D. melanogaster</italic> larva model system (hereafter referred to as <italic>Drosophila</italic> or larva) presents an opportunity to study navigational behavioral dynamics over long time scales, and is well suited to a detailed quantitative treatment. It possesses a well-defined, slow behavioral repertoire and robust response to many stimuli (<xref ref-type="bibr" rid="bib55">Sokolowski, 1980</xref>, <xref ref-type="bibr" rid="bib41">Louis and de Polavieja, 2017</xref>, <xref ref-type="bibr" rid="bib49">Riedl and Louis, 2012</xref>). The fruit fly has a relatively short life cycle with high accessibility to their three short larval stages (<xref ref-type="bibr" rid="bib14">Fernández-Moreno et al., 2007</xref>). During these stages, larvae are highly food-motivated and thus in the absence of food engage in nearly continuous exploratory search movement, which facilitates behavioral studies of locomotion over long times (<xref ref-type="bibr" rid="bib62">Wosniack et al., 2022</xref>). They also demonstrate responses to chemosensory cues (<xref ref-type="bibr" rid="bib54">Schumann et al., 2021</xref>, <xref ref-type="bibr" rid="bib33">Kim et al., 2017</xref>, <xref ref-type="bibr" rid="bib60">Vogt et al., 2021</xref>, <xref ref-type="bibr" rid="bib12">Colomb et al., 2007</xref>), mechanical and nociceptive stimulation (<xref ref-type="bibr" rid="bib2">Almeida-Carvalho et al., 2017</xref>, <xref ref-type="bibr" rid="bib3">Almeida-Oliveira et al., 2021</xref>, <xref ref-type="bibr" rid="bib36">Kudow et al., 2019</xref>), light (<xref ref-type="bibr" rid="bib31">Kane et al., 2013</xref>), as well as the ability to retain memory and change their behaviors in accordance with learned experiences, and habituate to prolonged stimuli (<xref ref-type="bibr" rid="bib44">McGuire et al., 2003</xref>; <xref ref-type="bibr" rid="bib45">McGuire et al., 2004</xref>, <xref ref-type="bibr" rid="bib39">Larkin et al., 2015</xref>, <xref ref-type="bibr" rid="bib7">Berne et al., 2021</xref>). Larvae also perform robust behavioral responses to temperature changes, engaging in thermotaxis along thermal gradients, and modulating aspects of their locomotive behavior, in particular their turning rate, in order to reach optimal conditions (<xref ref-type="bibr" rid="bib42">Luo et al., 2010</xref>, <xref ref-type="bibr" rid="bib34">Klein et al., 2015</xref>). The recent availability of a connectome brain wiring diagram (<xref ref-type="bibr" rid="bib28">Huser et al., 2012</xref>, <xref ref-type="bibr" rid="bib38">Larderet et al., 2017</xref>) and numerous genetic tools have facilitated probing the neural circuits and molecular mechanisms that underlie these behaviors (<xref ref-type="bibr" rid="bib26">Hernandez-Nunez et al., 2020</xref>, <xref ref-type="bibr" rid="bib32">Kaun et al., 2012</xref>, <xref ref-type="bibr" rid="bib18">Gepner et al., 2015</xref>, <xref ref-type="bibr" rid="bib55">Sokolowski, 1980</xref>, <xref ref-type="bibr" rid="bib59">Tian et al., 2009</xref>, <xref ref-type="bibr" rid="bib63">Xie et al., 2018</xref>, <xref ref-type="bibr" rid="bib29">Inada et al., 2011</xref>). Here, we focus on directly observed free-moving exploratory search and navigation behavior and seek to continuously measure fly larva crawling over times scales of many hours.</p><p>Responses to a wide range of stimuli in larvae typically occur through changes in their navigation and locomotion. Their navigation behavior, when confined to flat 2D spaces, is akin to an organism-scale 2D random walk (<xref ref-type="bibr" rid="bib5">Berg and Brown, 1972</xref>, <xref ref-type="bibr" rid="bib6">Berg, 2004</xref>), characterized as an alternating sequence of forward crawling ‘runs’ and direction-altering ‘turns’, making the animal’s behavior and response to stimuli straightforward to quantify (<xref ref-type="bibr" rid="bib11">Codling et al., 2008</xref>, <xref ref-type="bibr" rid="bib23">Günther et al., 2016</xref>, <xref ref-type="bibr" rid="bib37">Lahiri et al., 2011</xref>, <xref ref-type="bibr" rid="bib35">Klein et al., 2017</xref>; <xref ref-type="fig" rid="fig1">Figure 1A</xref>). However, larvae crawl away and typically remain at the edges of confining barriers, or climb walls or bury into a substrates (<xref ref-type="bibr" rid="bib41">Louis and de Polavieja, 2017</xref>) (see <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). Any such scenario results in the termination of exploratory search behavior, limiting most experiments to shorter snapshots of larval behavior, typically on the order of 10 min (<xref ref-type="bibr" rid="bib30">Jaime et al., 2018</xref>, <xref ref-type="bibr" rid="bib34">Klein et al., 2015</xref>, <xref ref-type="bibr" rid="bib1">Alisch et al., 2018</xref>, <xref ref-type="bibr" rid="bib35">Klein et al., 2017</xref>). A similar issue arises with directed navigation, for example along a 1D stimulus gradient, where larvae reach their preferred stimulus location or the edge of the arena after a short time, after which they no longer navigate toward anything. Thus, we desire a system that can prolong the behavior under investigation. Manually prolonging exploratory crawling behavior, such as picking up a larva with a wet paintbrush and placing them back at the center, is inefficient, difficult to perform consistently, and too labor-intensive over long times, and thus not very practical. Longer experiments with adult <italic>Drosophila</italic> have successfully been automated to allow higher throughput, although with confinement (<xref ref-type="bibr" rid="bib30">Jaime et al., 2018</xref>, <xref ref-type="bibr" rid="bib1">Alisch et al., 2018</xref>, <xref ref-type="bibr" rid="bib9">Buchanan et al., 2015</xref>), but no such system has previously been developed for freely crawling larvae.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>The automated larva transport robot enables continuous, long-term observation of fly larva crawling behavior.</title><p>(<bold>A</bold>) Schematic illustrating the fly larva’s simple search behavior. They search their environment in a modified 2D random walk, with 20 example paths (black) shown. Trajectories are characterized by an alternating series of forward crawling runs (red) and turns (blue). (<bold>B</bold>) Isometric CAD schematic of the transport robot. The robot is built from a modified 3D printer with a custom nozzle. Feedback from a mounted overhead camera allows for tight coordination with the moving arm to safely and robustly interact with the experimental arena. (<bold>C</bold>) The nozzle is built as a narrow tube that allows air and vacuum flow with a flat plastic disk fitted at the bottom. The disk provides ample surface area for a water droplet to form, and the droplet’s surface pressure can pick up larvae while minimizing stress on the animal during the interaction. (<bold>D</bold>) Top and side view schematics of the flat crawling arena. Larvae crawl atop an agar substrate, which is kept hydrated by a surrounding moat. The robot nozzle picks up larvae as they approach the edge of the arena and transports them back to the center to continue their freeroaming behavior. (<bold>E</bold>) Flowchart of the larva pick-up feedback process. In standby mode, the camera records a video of larval behavior. When it detects a larva nearing the perimeter, it triggers the pick-up protocol for the robot. The manipulator arm moves to a point in the moat nearest to the larva and dips the nozzle in, forming a droplet at the tip to be used for pick-up. The camera provides a more recent position for the moving larva as the robot attempts a pick-up. If feedback from the camera suggests a successful pick-up, it attempts a drop-off. Otherwise, the manipulator repeats its attempt after receiving an updated larval position. Multiple failed attempts can trigger small perturbations to robot calibration parameters to allow better flexibility through reinforcement learning before continuing pick-up attempts. Similarly, the robot performs multiple drop-off attempts at the center of the arena until it receives a positive confirmation from the camera, at which point the system returns to its original standby mode. (<bold>F</bold>) Photographs before (top) and after (bottom) the robot moves a larva from the perimeter to the center of the arena.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-86585-fig1-v1.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Time lapse from a movie of 22 larvae crawling on a 60 mm agar dish.</title><p>Larvae move freely until they are near the edges, where they dwell. Circles segment the arena into equal areas (1/3 in each region). Blue numbers indicate the number of larvae in the region.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-86585-fig1-figsupp1-v1.tif"/></fig><media mimetype="video" mime-subtype="mp4" xlink:href="elife-86585-fig1-video1.mp4" id="fig1video1"><label>Figure 1—video 1.</label><caption><title>Real-time video showing pick-up and drop-off as in panel F, three larvae transported from the edge of the arena to the center.</title></caption></media></fig-group><p>Here, we present the design and operation of an automated ‘larva picker’ robot and demonstrate its capabilities through continuous observation of larval exploratory searching and navigation behavioral response with high detail and over unprecedented duration. Importantly, identity is maintained throughout tracking, so we can characterize exploration and navigation at the population and individual animal levels together, as larvae search for food under varying hunger conditions, or negotiate variable temperature environments. In doing so, we are able to reveal new behavioral dynamics, where the animals’ search strategy is modulated over hours and we can discriminate between different individual statistics that are otherwise hidden by population averages.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>A robotic system transports larvae throughout an arena</title><p>To perform long-term behavioral studies with the larva, we have designed and fabricated a robotic instrument that automatically tracks, transports, and feeds larvae throughout a large arena. The flexibility of its design enables arbitrary stimulus delivery alongside continuous measurement of behavior, yielding an unprecedented level of detailed locomotion data and a comprehensive view of locomotion strategies at the population and individual animal levels together.</p><p>The system operates by tightly coordinating video acquisition from an overhead camera with a manipulator arm capable of traversing three dimensions and a custom nozzle that can manipulate larvae (<xref ref-type="fig" rid="fig1">Figure 1B</xref>).</p><p>A small number of larvae crawl on an agar gel are illuminated by red LEDs from the side, and a camera records their activity. The camera detects when a larva nears the edge of the crawling arena, and the robot arm and nozzle pick up the larva with the aid of a water droplet and place the larva back in the center. This process is shown in <xref ref-type="fig" rid="fig1">Figure 1E</xref>.</p><p>Meanwhile, the mounted camera refreshes the image and therefore the position of the larva before and after each step of any protocol, ensuring that the process is robust to variations in crawling speed and behavior and to failed attempts, which are detected and repeated (<xref ref-type="fig" rid="fig1">Figure 1E</xref>). The pick-up/drop-off procedure is triggered at an average rate of 0.87 times per hour per animal, and is 99.8%/99.9% successful (90%/95% on the first try), highly important for the viability of long-term experiments.</p><p>Our system must also address desiccation of the agar gel substrate and animal starvation, which limit experiment times and affect behavior. To address the former, we have built an auto-replenishing water moat (<xref ref-type="fig" rid="fig1">Figure 1D</xref>) in direct contact with the gel, which then maintains its water content and physical shape. In addition, the moat also provides a convenient and readily available water source for the nozzle. To address the latter, the robot can automatically administer a drop of apple juice (≈0.1 g/mL sugar concentration) directly to the larva on a predetermined schedule. The larva is allowed to eat for a fixed time, then rinsed with water so that it can return to a free-crawling state.</p><p>With these features in place, our system has so far achieved more than 30 hr of continuous observation of individual larva behavior.</p><p>In some experiments we observe how larvae navigate a variable sensory environment. We use a similar system as outlined in <xref ref-type="bibr" rid="bib34">Klein et al., 2015</xref>, to generate a 1D linear spatial thermal gradient of 0.035°C/mm with 13°C on one side and 21°C on the other.</p></sec><sec id="s2-2"><title>Video analysis identifies key behavioral features</title><p>Our data analysis pipeline extracts numerous behavioral features from video recordings of crawling larvae (<xref ref-type="fig" rid="fig2">Figure 2</xref>). Custom computer vision software takes raw movies and extracts the position and body contour of each larva while preserving individual animal identities (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). Because the robot arm can briefly block the camera during pick-up events (average of ≈4.5 s of occlusion duration per pick-up event), resulting in dropped frames, the software interpolates larval positions in these frames to maintain continuous observation. Since the larva’s body length is roughly 1 mm and it crawls with an average speed well below 1 mm/s, significant behavior events are unlikely to occur during dropped frames and interpolation is sufficient to rebuild trajectories.</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Analysis pipeline.</title><p>(<bold>A</bold>) Raw video acquired during the experiment is fed into computer vision software that tracks each larva while maintaining their identity. (<bold>B</bold>) A posture tracker analyzes the isolated crops of each larva to determine its posture and orientation. (<bold>C</bold>) A state tracker determines the behavioral state of each animal at each time point. (<bold>D</bold>) Compiling all information from the preceding algorithms allows the pipeline to identify and calculate a wide variety of behavioral features.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-86585-fig2-v1.tif"/></fig><p>The isolated crops of each larva are run through a recurrent U-Net <xref ref-type="bibr" rid="bib52">Ronneberger et al., 2015</xref> convolutional neural network (<xref ref-type="fig" rid="fig2">Figure 2B</xref>) to determine the posture and orientation. Using all available information (position, contour, and posture), we use a densely connected neural network with bidirectional recurrence to classify the behavioral state of the larva (‘run’, ‘turn’) at each time point (<xref ref-type="fig" rid="fig2">Figure 2C</xref>; <xref ref-type="bibr" rid="bib23">Günther et al., 2016</xref>). From here, we can identify a wide range of behavioral features and track them over extended time periods.</p></sec><sec id="s2-3"><title>The robot enables continuous observation of free exploratory searching over 6 hr</title><p>Optimizing searches by modulating behavior is essential to the larva’s ability to find a food source efficiently. While previous studies with <italic>Drosophila</italic> larvae have revealed some changes to its navigation over the first few minutes of exploratory search of an isotropic environment, how and whether their behavior evolves or persists afterward remains unknown (<xref ref-type="bibr" rid="bib35">Klein et al., 2017</xref>). Studies on another small organism with qualitatively comparable navigation dynamics, the nematode <italic>Caenorhabditis elegans</italic>, show similar changes in behavior during the first ≈ 100 s. Some longer-duration experiments (1 hr vs 15 min) reveal a transition in navigation strategy between two distinct modes of local and global searches, but transitions across similar or longer time scales have yet to be observed in <italic>Drosophila</italic> (<xref ref-type="bibr" rid="bib10">Calhoun et al., 2014</xref>, <xref ref-type="bibr" rid="bib35">Klein et al., 2017</xref>). Here, we demonstrate how our larva picker robot enables continuous observation and analysis of larval locomotive behavior on very long time scales to study changes in its search strategy in an isotropic environment.</p><p>In <xref ref-type="fig" rid="fig3">Figure 3</xref>, we present the results from continuous observation of second instar wild type (Canton-S) larvae (<inline-formula><mml:math id="inf1"><mml:mrow><mml:mi mathsize="80%">N</mml:mi><mml:mo mathsize="80%" stretchy="false">=</mml:mo><mml:mn mathsize="80%">42</mml:mn></mml:mrow></mml:math></inline-formula>) freely roaming the experimental stage for a 6 hr time duration. <xref ref-type="fig" rid="fig3">Figure 3A and C</xref> shows the speed and the turn rate of the larvae, respectively, exhibiting the dynamics of their behavior. Notably, there is a significant drop in activity (both speed and turn rate) over the first hour before settling into a plateau that lasts for the following few hours. The correlation between larval crawl speed and turn rate over time has been previously observed (<xref ref-type="bibr" rid="bib23">Günther et al., 2016</xref>) and is clearly evident here, and we measure a correlation coefficient of 0.572 in the population mean speeds and turn rates. With the large amount of data gathered on each individual, we confirm that this correlation also exists at the individual level with an average correlation coefficient of 0.348 ± 0.098.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Observations of continuous free roaming for 6 hr.</title><p>(<bold>A</bold>) Larval crawl speed over time, comparing the results from continuous 6 hr observation recorded on the robot system (blue, <inline-formula><mml:math id="inf2"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>42</mml:mn></mml:mrow></mml:math></inline-formula>) to shorter 10 min observation of larger numbers of starved larvae (colored, <inline-formula><mml:math id="inf3"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math></inline-formula> per bar, from 10 experiments with 20 larvae each). (<bold>B</bold>) Larval crawl speed over 10 min after starvation. We observe a decline in crawl speed (<inline-formula><mml:math id="inf4"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>7.7</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> mm/s<sup>2</sup>) comparable to that observed during the first hour of the continuous observation (<inline-formula><mml:math id="inf5"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>6.9</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> mm/s<sup>2</sup>). (<bold>C</bold>) Larval turn rate over time. Similar to larval crawl speed (<bold>A</bold>), there is a noticeable drop in turn rate over the first hour, indicating an overall decrease in activity. (<bold>D</bold>) Analysis of larval crawl speed before and after an interaction with the larva picker robot. We plot larval crawl speed during the 5 min immediately before (purple) and the 5 min immediately after (red) an interaction with the robot, that is, a pick-up and drop-off event (vertical black dashed line). After a 1–2 min transient (<inline-formula><mml:math id="inf6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, Student’s t-test), speed returns to the mean pre-interaction level (horizontal black line). For all panels, shaded regions indicate standard deviation from the mean.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-86585-fig3-v1.tif"/></fig></sec><sec id="s2-4"><title>Long-term free-roaming behavior is consistent with analogous snapshot observations</title><p>Since the larva were not fed over the duration of the experiment, we compare continuous observations with short ‘snapshot’ observations of larvae at various stages of starvation (<inline-formula><mml:math id="inf7"><mml:mrow><mml:mi mathsize="80%">N</mml:mi><mml:mo mathsize="80%" stretchy="false">=</mml:mo><mml:mn mathsize="80%">200</mml:mn></mml:mrow></mml:math></inline-formula> per stage). Larvae were removed from food and starved over a certain number of hours, then placed on an agar gel arena to be observe for 10 min without interruption, and with no interaction with the robot. The decline in activity seen in the robot-mediated experiments is not present when observing crawl speeds averaged over the 10 min duration (<xref ref-type="fig" rid="fig3">Figure 3A</xref>, colored bars). Upon closer inspection, however, larval crawl speed measured in the starvation studies (<xref ref-type="fig" rid="fig3">Figure 3B</xref>) reveal a trend over time that mirrors what we observe in the first hour of continuous observations. Over these 10 min snapshot observations, we measure an average decline of <inline-formula><mml:math id="inf8"><mml:mrow><mml:mo mathsize="80%" stretchy="false">-</mml:mo><mml:mrow><mml:mn mathsize="80%">7.7</mml:mn><mml:mo mathsize="80%" stretchy="false">×</mml:mo><mml:msup><mml:mn mathsize="80%">10</mml:mn><mml:mrow><mml:mo mathsize="80%" stretchy="false">-</mml:mo><mml:mn mathsize="80%">5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> mm/s<sup>2</sup>, comparable to the average of <inline-formula><mml:math id="inf9"><mml:mrow><mml:mo mathsize="80%" stretchy="false">-</mml:mo><mml:mrow><mml:mn mathsize="80%">6.9</mml:mn><mml:mo mathsize="80%" stretchy="false">×</mml:mo><mml:msup><mml:mn mathsize="80%">10</mml:mn><mml:mrow><mml:mo mathsize="80%" stretchy="false">-</mml:mo><mml:mn mathsize="80%">5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> mm/s<sup>2</sup> seen over the first hour of continuous observations. The similarity offers confidence that the behavioral dynamics present here are not caused by transport robot actions but are real features of the animal that continue to persist and develop over a period that is more than 30 times longer than what snapshot observations can capture.</p><p>To further ensure that disruptions to behavior due to the robot’s interference have minimal influence, we analyzed larval behavior before and after each interaction with the robot (i.e. a pick-up and drop-off event). <xref ref-type="fig" rid="fig3">Figure 3D</xref> shows averaged larval crawl speeds 5 min before and 5 min after an interaction event (vertical dashed line). As expected, mean larval speeds before the interaction shows little change over the small window. We do observe a transient of approximately 1–2 min just after the interaction, where there is a noticeable increase in speed (<inline-formula><mml:math id="inf10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, Student’s t-test), but it quickly returns to the same mean as before (horizontal line).</p></sec><sec id="s2-5"><title>A freely crawling single larva is continuously monitored for more than 30 hr</title><p>As noted in the previous section, the robot is also capable of automatic scheduled feeding. To keep the larva alive as long as possible, the robot administers a drop of sugar-rich solution directly to the larva once every hour. The larva is allowed to feed for 1 min, then the animal and the drop site is rinsed with water, and the larva resumes its exploratory search. Using this protocol, we are able to study larval locomotive behavior for over 30 hr, yielding an unprecedented amount of behavioral and developmental information on an individual animal. <xref ref-type="fig" rid="fig4">Figure 4</xref> presents the trajectory of a single larva and some of its behavior features observed over a duration of 30 hr, where the individual animal crawls for more than 48 m. Some behavioral features exhibit steady change, like a decreasing speed throughout the experiment. Notable differences in path shape occur approximately half way through the long observation, with dramatic increases in curvature and turn size, consistent with the tight loops seen in the full trajectory plot (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). It is unclear what caused the change in behavior. In addition to biological triggers, possible causes include changes in the environment, such as changes in the ambient humidity and uneven changes in agar desiccation or temperature profile producing subtle gradients over the experiment duration. We also note that this larva maintains a left-turning bias throughout the experiment.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Long-term observation of a single larva.</title><p>In order to maintain exploratory search behavior in a fly larva without starving it, the robot automatically delivers a drop of apple juice (≈0.1 g/mL sugar concentration). The larva is allowed to eat for 1−2 min, after which the robot uses water and air to rinse the larva, which then continues roaming freely. This protocol allows for continuous observation of larval behavior over developmental time scales. (<bold>A</bold>) The larva’s trajectory over a 30 hr duration, with its path (green) stitched together by matching each corresponding robot pick-up and drop-off positions (orange markers) by translation (no rotation, e.g. up is always toward same edge of agar) to produce a continuous trajectory. The larva begins at the top right and ends its run at the bottom (purple markers). (<bold>B</bold>) A ×20 magnification on a small section of the path, showing the scale of the path compared to the larva’s body (black bar, ≈ 1 mm). (<bold>C</bold>) We plot a number of behavioral features observed during its search trajectory, including its speed (red), body bend angle (orange), trajectory curvature (green), turn rate (blue), turn size (purple), and turn handedness (olive). Turn handedness is calculated as <inline-formula><mml:math id="inf11"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, such that a handedness of 1.0 indicates all left turns, and a handedness of −1.0 indicates all right turns. Dotted gray lines indicate time of robot pick-up events.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-86585-fig4-v1.tif"/></fig></sec><sec id="s2-6"><title>Larval thermotaxis is maintained over long periods</title><p>By leveraging the automated transport system’s flexible design to deliver and study responses to stimuli, we manipulate the temperature of the agar arena to study larval thermotaxis behavior. <italic>Drosophila</italic> larvae have robust, highly sensitive, and well-documented response to changes in temperature, and work has been done to decipher the behavioral strategy utilized to efficiently navigate thermal gradients (<xref ref-type="bibr" rid="bib42">Luo et al., 2010</xref>, <xref ref-type="bibr" rid="bib34">Klein et al., 2015</xref>). However, there is a lack of abundant data on individual animals, since single experiments last on the order of 10 min, and thus a lack of understanding of the differences in thermotaxis strategy and its development between individuals. It is also unknown how thermotaxis might evolve over long times. The automated transport system here provides an opportunity to delve deeper into these questions.</p><p>Navigational efficiency can be captured by a dimensionless navigation index equal to <inline-formula><mml:math id="inf12"><mml:mrow><mml:mrow><mml:mo maxsize="80%" minsize="80%">⟨</mml:mo><mml:msub><mml:mi mathsize="80%">v</mml:mi><mml:mi mathsize="80%">x</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">⟩</mml:mo></mml:mrow><mml:mo mathsize="80%" stretchy="false">/</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">⟨</mml:mo><mml:mi mathsize="80%">v</mml:mi><mml:mo maxsize="80%" minsize="80%">⟩</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, the average of the component of crawling velocity along the thermal gradient normalized to the average speed. The resulting navigation index ranges from +1.o (parallel to gradient, i.e. crawling directly toward the warm side of the arena) to −1.0 (anti-parallel to gradient, i.e. crawling directly toward the cold side of the arena) (<xref ref-type="bibr" rid="bib34">Klein et al., 2015</xref>, <xref ref-type="bibr" rid="bib42">Luo et al., 2010</xref>, <xref ref-type="bibr" rid="bib16">Gallio et al., 2011</xref>). <xref ref-type="fig" rid="fig5">Figure 5</xref> shows the navigation index of second instar wild type (Canton-S) larvae as they crawl across the experiment arena for 6 hr, both with (<inline-formula><mml:math id="inf13"><mml:mrow><mml:mi mathsize="80%">N</mml:mi><mml:mo mathsize="80%" stretchy="false">=</mml:mo><mml:mn mathsize="80%">38</mml:mn></mml:mrow></mml:math></inline-formula>) and without (<inline-formula><mml:math id="inf14"><mml:mrow><mml:mi mathsize="80%">N</mml:mi><mml:mo mathsize="80%" stretchy="false">=</mml:mo><mml:mn mathsize="80%">42</mml:mn></mml:mrow></mml:math></inline-formula>) a thermal gradient present. The thermal gradient is centered at 17°C with a steepness of 0.032°C/mm, which would normally evoke robust cold avoidance behavior (<xref ref-type="bibr" rid="bib42">Luo et al., 2010</xref>).</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Comparison of navigation index in a zero gradient environment (<bold>A</bold>, <inline-formula><mml:math id="inf15"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>42</mml:mn></mml:mrow></mml:math></inline-formula>) and in a presence of a linear thermal gradient of 0.035°C/mm (<bold>B</bold>, <inline-formula><mml:math id="inf16"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>38</mml:mn></mml:mrow></mml:math></inline-formula>).</title><p>Navigation efficiency is calculated as a dimensionless index equal to <inline-formula><mml:math id="inf17"><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, such that +1.0 is parallel to gradient, 0.0 is normal to gradient, and −1.0 is anti-parallel to gradient. We observe a clear increase in average navigation index (dashed lines) when exposed to a thermal gradient (increase from <inline-formula><mml:math id="inf18"><mml:mrow><mml:mn>0.032</mml:mn><mml:mo>±</mml:mo><mml:mn>0.020</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf19"><mml:mrow><mml:mn>0.130</mml:mn><mml:mo>±</mml:mo><mml:mn>0.017</mml:mn></mml:mrow></mml:math></inline-formula> [<inline-formula><mml:math id="inf20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, Student’s t-test]), but we do not observe any significant pattern of change in that index over time. Solid line indicates a navigation index of zero, indicative of no preference in crawling direction. Shaded region indicates one standard deviation.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-86585-fig5-v1.tif"/></fig><p>When roaming freely with no gradient present, we observe an average navigation index of <inline-formula><mml:math id="inf21"><mml:mrow><mml:mn mathsize="80%">0.032</mml:mn><mml:mo mathsize="80%" stretchy="false">±</mml:mo><mml:mn mathsize="80%">0.020</mml:mn></mml:mrow></mml:math></inline-formula> (range indicating standard deviation). When a thermal gradient is applied to the arena, we observe a clear increase in navigation index to an average of <inline-formula><mml:math id="inf22"><mml:mrow><mml:mn mathsize="80%">0.130</mml:mn><mml:mo mathsize="80%" stretchy="false">±</mml:mo><mml:mn mathsize="80%">0.017</mml:mn></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="inf23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, Student’s t-test). The navigation index also remains steady over the 6 hr measurement time.</p></sec><sec id="s2-7"><title>Navigation efficiency of individuals exhibits distinct behavioral phenotypes</title><p>Short snapshot observations produce limited information on any single animal, therefore limiting most thermotaxis analysis to population-level statistics. Long continuous observation enabled by the transport robot uncovers much more detailed information about individual animals, allowing us to analyze behavioral features at the individual level as well (<xref ref-type="fig" rid="fig6">Figure 6</xref>). Importantly, averaging over a population necessarily results in some loss of information such that different statistics at the individual level can generate the same population mean.</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Examination of inter- and intra-animal variability via analysis of the probability distribution of observed larval thermal navigation index.</title><p>Each distribution shows the probability (vertical axis) of observing a certain navigation index (horizontal axis) at any given time in a series of observations for single individuals (purple), or a series of average observations for the population at each time point (red). When dissecting probability distributions of observed behavior, we notice that the same population (inter-animal) mean can be produced by two individual (intra-animal) distributions. (<bold>A</bold>) Simulated example of individual probability distributions with high intra-animal variability. The thin, lighter traces are probability distributions of eight individual animals. The resulting mean of intra-animal distribution (thick purple) closely resembles the population mean (thick red). (<bold>B</bold>) Simulated example of individual probability distributions with high inter-animal variability. The thin, lighter traces are probability distributions of eight individual animals. The resulting mean of intra-animal distribution (purple) forms a multimodal distribution despite a similar population mean (red) as (<bold>A</bold>, <bold>C</bold>). Empirical probability distribution of navigation index observed without a thermal gradient. There is high intra-animal variability but low inter-animal variability, such that the intra-animal mean forms a similar distribution to the population mean, as in the simulated results in panel A. <inline-formula><mml:math id="inf24"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>42</mml:mn></mml:mrow></mml:math></inline-formula> individual larvae. (<bold>D</bold>) Empirical probability distribution of navigation index observed in presence of a thermal gradient (0.035°C/mm). In contrast to (C), during thermotaxis, the intra-animal mean forms a bimodal distribution (<inline-formula><mml:math id="inf25"><mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.67</mml:mn></mml:mrow></mml:math></inline-formula>, compared to <inline-formula><mml:math id="inf26"><mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.48</mml:mn></mml:mrow></mml:math></inline-formula> in <bold>C</bold>) despite each individual distribution remaining unimodal (<inline-formula><mml:math id="inf27"><mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.51</mml:mn><mml:mo>±</mml:mo><mml:mn>0.06</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> with gradient, <inline-formula><mml:math id="inf28"><mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.50</mml:mn><mml:mo>±</mml:mo><mml:mn>0.04</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> without). <inline-formula><mml:math id="inf29"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>38</mml:mn></mml:mrow></mml:math></inline-formula> individual larvae. This more closely resembles a distribution with high inter-animal variability as in the simulated results in panel B. (<bold>E</bold>) Individual empirical probability distribution of navigation index observed without a thermal gradient, displaying the same data used to generate panel C. (<bold>F</bold>) Individual empirical probability distribution of navigation index observed in presence of a thermal gradient, displaying the same data used to generate (<bold>D</bold>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-86585-fig6-v1.tif"/></fig><p><xref ref-type="fig" rid="fig6">Figure 6A–B</xref> demonstrates the differences between two such cases by examining simulated toy examples of a probability distribution of observations of a navigation index, where a point on the distribution represents the probability of observing a certain navigation index at any given time. Each series of observations (one series of observation represents behavior of a single individual) is sampled from a Gaussian distribution, whose mean and standard deviation are randomly determined with two different statistics. In the first simulation (<xref ref-type="fig" rid="fig6">Figure 6A</xref>), the Gaussian mean and standard deviations for each animal have low inter-animal variability, producing a mean of intra-animal distributions that is similar to the population mean distribution. In the second (<xref ref-type="fig" rid="fig6">Figure 6B</xref>), high inter-animal variability in the same instead produces a multi-modal distribution for individuals despite the extra modes not being present at the population level. While the two simulations show distinct means of intra-animal probability distributions (purple), that is variability between individuals is different, both simulations still produce similar distributions when analyzing probability of navigation index observations at the population level (red). Because our long timescale thermotaxis experiments generate enough data to establish both population-level and individual-level navigation indices, we can examine how similar distributions of larval thermal navigation behavior may compare between the population and individual levels.</p><p>Interestingly, we find that larval navigation index behavior switches from one model to the other when a thermal gradient is applied (<xref ref-type="fig" rid="fig6">Figure 6C and D</xref>). The population means have a similar shape and spread in both gradient and gradient-free contexts (red traces in <xref ref-type="fig" rid="fig6">Figure 6C and D</xref>). However, without a thermal gradient (<xref ref-type="fig" rid="fig6">Figure 6C</xref>), the individual distributions exhibit high intra-animal variability and low inter-animal variability, mirroring those seen in the first simulation (<xref ref-type="fig" rid="fig6">Figure 6A</xref>). In the presence of a thermal gradient (<xref ref-type="fig" rid="fig6">Figure 6D</xref>), we observe a bimodal intra-animal distribution despite each individual distribution remaining unimodal (<inline-formula><mml:math id="inf30"><mml:mrow><mml:mrow><mml:mi mathsize="80%">B</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="80%">C</mml:mi></mml:mrow><mml:mo mathsize="80%" stretchy="false">=</mml:mo><mml:mrow><mml:mn mathsize="80%">0.51</mml:mn><mml:mo mathsize="80%" stretchy="false">±</mml:mo><mml:mn mathsize="80%">0.06</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> with gradient, <inline-formula><mml:math id="inf31"><mml:mrow><mml:mrow><mml:mi mathsize="80%">B</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="80%">C</mml:mi></mml:mrow><mml:mo mathsize="80%" stretchy="false">=</mml:mo><mml:mrow><mml:mn mathsize="80%">0.50</mml:mn><mml:mo mathsize="80%" stretchy="false">±</mml:mo><mml:mn mathsize="80%">0.04</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> without), more closely resembling the second simulation (<xref ref-type="fig" rid="fig6">Figure 6B</xref>) instead. We measure a binomial coefficient (BC) (<xref ref-type="bibr" rid="bib15">Freeman and Dale, 2013</xref>, <xref ref-type="bibr" rid="bib11">Codling et al., 2008</xref>) of 0.67 in a thermal gradient, compared to <inline-formula><mml:math id="inf32"><mml:mrow><mml:mrow><mml:mi mathsize="80%">B</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="80%">C</mml:mi></mml:mrow><mml:mo mathsize="80%" stretchy="false">=</mml:mo><mml:mn mathsize="80%">0.48</mml:mn></mml:mrow></mml:math></inline-formula> when there is no gradient present. This is a significant increase (<inline-formula><mml:math id="inf33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, Student’s t-test) that crosses the critical value for detecting bimodality (<inline-formula><mml:math id="inf34"><mml:mrow><mml:mrow><mml:mi mathsize="80%">B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi mathsize="80%">C</mml:mi><mml:mrow><mml:mi mathsize="80%">c</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="80%">r</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="80%">i</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="80%">t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo mathsize="80%" stretchy="false">=</mml:mo><mml:mrow><mml:mn mathsize="80%">5</mml:mn><mml:mo mathsize="80%" stretchy="false">/</mml:mo><mml:mn mathsize="80%">9</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>), clearly indicating a shift in the shape of the distribution.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We have developed an automated system for long-term observation of <italic>Drosophila</italic> larvae (<xref ref-type="fig" rid="fig1">Figure 1</xref>). The robotic arm is capable of transporting larvae as they approach the edge of the experiment arena back to the center, allowing continuous observation of exploratory search or directed navigation behavior from an overhead camera. Through coordination and constant feedback between the robot and video acquisition, the system maintains larvae within the arena with high reliability, and we are able to achieve continuous observation over developmental time scales. The accompanying analysis pipeline takes the output video from these experiments to track larval posture and behavioral state while maintaining individual identities. The analysis compensates for the output video’s low resolution and lack of detailed features of the larvae through a combination of local and global features and the use of recurrent neural networks (<xref ref-type="fig" rid="fig2">Figure 2</xref>).</p><p>We present a study of free-roaming behavior in larvae over 6 hr of continuous observation, comparing results to short 10 min snapshot observations of larvae at various stages of starvation (<xref ref-type="fig" rid="fig3">Figure 3</xref>). The comparison yields dissimilar patterns when considering the 10 min averages, but similar dynamics when considering the change in behavior over time, such that the 10 min trajectory in larval crawl speed resembles that seen in the first hour of continuous observation. The similarity suggests behavioral dynamics that are present in both experiments, but persist and develop over a duration that is an order of magnitude longer than what snapshot observations can capture.</p><p>Since our analysis maintains animal identities throughout the video, we are able to capture behavioral information on single individuals with unprecedented detail. We leverage this new trove of data to analyze larval response to a thermal gradient and examine the probability distribution of the observed navigation index over time (<xref ref-type="fig" rid="fig6">Figure 6</xref>). In particular, we note that the same population (inter-animal) mean can be produced by different individual (intra-animal) distributions. Interestingly, larvae seem to switch to a different distribution shape upon encountering a thermal gradient. The individual distributions of navigation index without a thermal gradient exhibits high intra-animal variability but low inter-animal variability, forming a unimodal mean distribution that is similar to the population mean. In contrast, during thermotaxis the individual distributions exhibit high inter-animal variability, such that it become bimodal when a gradient is applied, despite the distribution shape remaining unimodal at the individual and population level. Thermotaxis behavior of individual crawlers approximately falls into two categories of neutral and strong crawlers (bimodal distribution), but this phenomenon was masked in past research because analysis focused on population averages and the experiments were too short. With our individual-focused and long-term experiments, we were able to see this phenomenon more clearly. This result is consistent with recent findings that suggest a switch-like (all-or-none) learning behavior in larval <italic>Drosophila</italic>, which is also not apparent when only analyzing population means. By observing decision-making behavior of individual larvae over several cycles of stimulus and reward, <xref ref-type="bibr" rid="bib40">Lesar et al., 2021</xref>, find that Pavlovian training of preference for carbon dioxide is similarly quantized to two states (all-or-none), each centered at a fixed preference index. While the context and modality for the learning assays are different than our observation of larval thermotaxis, both results reveal new features of larval behavior that were previously obscured in population averages. Both results also suggest the existence of larval ‘personality types’, or distinct, quantized behavioral phenotypes that vary between individual animals (<xref ref-type="bibr" rid="bib40">Lesar et al., 2021</xref>, <xref ref-type="bibr" rid="bib34">Klein et al., 2015</xref>, <xref ref-type="bibr" rid="bib23">Günther et al., 2016</xref>, <xref ref-type="bibr" rid="bib46">Ohyama et al., 2013</xref>). Our present work provides some progress in uncovering such phenotypes and furthering our understanding of learning and development of navigational strategies in individual animals in addition to population averages.</p><p>With the robot’s flexible design, we can continue to probe these questions in many different contexts. For example, the robot could deliver food or soluble drugs directly to the larvae on a predetermined schedule to measure both the acute and chronic effects on the animal’s behavior and physiology (<xref ref-type="bibr" rid="bib61">Wolf and Heberlein, 2003</xref>, <xref ref-type="bibr" rid="bib4">Bainton et al., 2000</xref>, <xref ref-type="bibr" rid="bib8">Besson and Martin, 2005</xref>, <xref ref-type="bibr" rid="bib19">Gerber and Stocker, 2007</xref>, <xref ref-type="bibr" rid="bib13">Fayyazuddin et al., 2006</xref>, <xref ref-type="bibr" rid="bib51">Robinson et al., 2012</xref>, <xref ref-type="bibr" rid="bib32">Kaun et al., 2012</xref>). We could also leverage the existing lighting system to implement optogenetic activation or suppression of specific neurons, allowing delivery of fictive stimuli or studies of the effects of certain neuronal circuits on larval behavior and development (<xref ref-type="bibr" rid="bib21">Gradinaru et al., 2010</xref>, <xref ref-type="bibr" rid="bib29">Inada et al., 2011</xref>, <xref ref-type="bibr" rid="bib53">Salvaterra and Kitamoto, 2001</xref>, <xref ref-type="bibr" rid="bib25">Hernandez-Nunez et al., 2015</xref>, <xref ref-type="bibr" rid="bib31">Kane et al., 2013</xref>). This could either be activated on a predetermined schedule, or integrated directly with the existing robot and camera feedback system to enable activation triggers based on specific conditions such as larval behavior (e.g. activate upon larva initiating a turn).</p><p>Our study has sought to characterize very-long-timescale free-crawling behavior, both with and without a single stimulus that influences crawling direction. The larva picker robot effectively acts as a 2D conveyor belt, rapidly (on the order of seconds) repositioning a larva each time it reaches the edge of the arena (on the order of every 60 min). Although this method enables continuous measurement of free crawling, it does have inherent limitations.</p><p>First, the behavior we measure is far removed from what larva behavior looks like in an ecological setting. In nature, larvae search for rotting fruit to consume, and if they find it, tend to stay in it during larval development, then typically move to drier areas to pupate (<xref ref-type="bibr" rid="bib56">Sokolowski et al., 1986</xref>). During this process they sense and respond to many stimuli (odors, humidity, light, vibration, temperature, etc.). In the present work we isolate the larvae from stimuli, placing them on a flat substrate with no visible light, food, or temperature changes, thus providing an environment where larvae are always searching, in a state of near-constant locomotion. This could affect larval development times and other behavioral features, which will be in a better position to study with a more rigorous feeding system and a larger data set. As an early fundamental step in what we hope becomes a more complete understanding of multisensory integration and behavior in realistic settings, we have focused on understanding high-bandwidth 2D crawling trajectories and the basic behavior sequences that form them.</p><p>Second, there are limitations to how well we can truly isolate crawling larvae from outside stimuli. Although experiments are run with red lights (not visible to larvae), other light from the surrounding lab could reach the animals, and the room is not precisely temperature stabilized. Similarly, vibrations or air currents in the building were not measured or directly controlled. The most blatant outside stimulus is the pick-up and drop-off process from the robot. Although we have determined that the short-term effects of this disturbance fade after less than 60 s, we do not yet have sufficient data to study long-term effects, and repeated transport from the robot arm could introduce important changes. We do have several reasons to believe these effects will be minimal, however. In one of our previous studies (<xref ref-type="bibr" rid="bib34">Klein et al., 2015</xref>) we observed that a larva’s thermal response behavior becomes uncorrelated with its stimulus history after approximately 10 s; and in another <xref ref-type="bibr" rid="bib7">Berne et al., 2021</xref> found that physical behavior returns to normal within approximately 20 s of a stimulus introduction, even in presence of very strong vertical vibration. Further, although fly larvae can form associative memories, particularly in pairing conditioned stimuli with odors or tastes (<xref ref-type="bibr" rid="bib19">Gerber and Stocker, 2007</xref>), our arenas are free of salient stimuli that would be likely to induce this such memory formation. Since larvae do not see in our environment and do not make spatial maps, we consider the larva’s behavior to be exploratory, even though in a literal sense they are exploring the same space repeatedly. Because the animal is highly food-motivated, it will continuously execute search patterns even after many hours of failure to locate food.</p><p>A major obstacle in way of achieving continuous observation of the entire larval life cycle (≈ 100 hr) is a reliable method of delivering enough nutrition and ensuring the larva has sufficiently fed. The current method of delivering drops of sugar-rich solutions has not been sufficient to trigger molting into the next instar stage, thus limiting us to a single instar. Feeding larvae on their primary behavior arena can also introduce new stimuli, as remnants of the food solutions can be sensed by the olfactory or gustatory systems in the larvae. Future improvements to the apparatus may include a separate short-term feeding station away from the main navigation area. We hope to solve this problem and others as we continue to develop the system and expand its capabilities, for example with a second adjacent arena with more nutritive food where larvae could experience longer feeding times before being returned by the robot to the primary behavioral arena. Such rich detail covering the entire development of the larva would provide powerful insight into the long-term learning, memory, and behavioral adaptations in tandem with the physiological developments that take place between instar stages.</p><p>We hope that this study has highlighted some advantages of long-term continuous measurement, and that similar instrumentation and analysis method could be applied to other organisms, along with a wide range of investigations in the fly larva.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Larva picker robot</title><p>The manipulator arm is translated by stepper motors (Nema 8) in the X- and Y-axes and a 5V solenoid (SparkFun) for the Z-axis, which are driven by a programmable controller board (SmoothieBoard) with physical and software limits in place to prevent overtravel. At the end of the arm is a custom 18-gauge nozzle (<xref ref-type="fig" rid="fig1">Figure 1C</xref>) that can interact with the larva and the experimental arena (<xref ref-type="fig" rid="fig1">Figure 1D</xref>) that sit below the camera and manipulator assembly.</p><p>A 2.3-megapixel CMOS camera (Grasshopper3) observes a small number (4–6) of larvae crawling on a 22 × 22 cm<sup>2</sup> agar gel (2.5% wt/vol agar in water, with 0.75% charcoal added for improved contrast) and records at 10 Hz. Larvae are illuminated with four strips of red LEDs (dominant wavelength around 620 nm), which is outside the visible range of the larva (<xref ref-type="bibr" rid="bib57">Sprecher et al., 2007</xref>), arranged in a square around the agar gel. To maintain larval exploratory searching behavior over a long duration, the camera detects when one nears the edge of the arena. This triggers the manipulator to pick up the larva with the nozzle. The larva is maintained on the nozzle via the surface tension of a water droplet. The water droplet provides a way to indirectly interact with the larva to prevent causing damage to the animal. After the manipulator arm moves to the center of the arena, it drops off the larva with a slow horizontal motion, effectively rolling it off the nozzle (<xref ref-type="fig" rid="fig1">Figure 1E</xref>). The manipulator replenishes the water droplet before each pick-up, and a small flat Delrin plastic disk (2 mm diameter) at the bottom of the nozzle provides more surface area for the droplet to form (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). When the surface tension of the water is insufficient to pick up the larva, the nozzle is capable of exerting vacuum suction to assist in pick-up, as well as allowing air flow to release the larva during drop-off.</p><p>In some experiments we observe how larvae navigate a variable sensory environment. We use a similar system as outlined in <xref ref-type="bibr" rid="bib34">Klein et al., 2015</xref>, to generate a 1D linear spatial thermal gradient.</p><p>We fit the underside of the experimental arena’s aluminium base with hot and cold reservoirs on opposite sides, each equipped with two liquid-cooled water blocks. PID (proportional-integral-derivative) controllers drive thermoelectric coolers between each water block and its reservoir to maintain a thermal gradient of 0.035°C/mm across the agar gel in the arena, with 13°C on one side and 21°C on the other.</p></sec><sec id="s4-2"><title>Constrained larval behavior</title><p><italic>Drosophila</italic> larvae tend to spend a lot of time near the edges of conventional cultivation dishes. To demonstrate this, we monitored larvae crawling in a 60 mm agar dish for 20 min. An example time lapse showing the distribution of animals moving toward, and dwelling at, the perimeter is shown in <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>.</p></sec><sec id="s4-3"><title>Analysis pipeline</title><sec id="s4-3-1"><title>Position tracking</title><p>Custom computer vision software takes raw movies and extracts the position and body contour of each larva while preserving individual animal identities.</p><p>Each frame is prepared with increased contrast with dynamic background subtraction. Over long duration experiments, the background that the larvae navigate may change slowly over time due to interactions with the animals or environmental effects such as condensation or dust. With this in mind, we update a dynamic background that will be subtracted from each frame using an infinite impulse response filter. The background, <inline-formula><mml:math id="inf35"><mml:msub><mml:mi mathsize="80%">B</mml:mi><mml:mi mathsize="80%">t</mml:mi></mml:msub></mml:math></inline-formula>, for the frame, <inline-formula><mml:math id="inf36"><mml:msub><mml:mi mathsize="80%">F</mml:mi><mml:mi mathsize="80%">t</mml:mi></mml:msub></mml:math></inline-formula>, is calculated as:<disp-formula id="equ1"><mml:math id="m1"><mml:mrow><mml:msub><mml:mi mathsize="80%">B</mml:mi><mml:mi mathsize="80%">t</mml:mi></mml:msub><mml:mo mathsize="80%" stretchy="false">=</mml:mo><mml:mrow><mml:mrow><mml:mi mathsize="80%">α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi mathsize="80%">F</mml:mi><mml:mi mathsize="80%">t</mml:mi></mml:msub></mml:mrow><mml:mo mathsize="80%" stretchy="false">+</mml:mo><mml:mrow><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:mrow><mml:mn mathsize="80%">1</mml:mn><mml:mo mathsize="80%" stretchy="false">-</mml:mo><mml:mi mathsize="80%">α</mml:mi></mml:mrow><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi mathsize="80%">B</mml:mi><mml:mrow><mml:mi mathsize="80%">t</mml:mi><mml:mo mathsize="80%" stretchy="false">-</mml:mo><mml:mn mathsize="80%">1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf37"><mml:mi mathsize="80%">α</mml:mi></mml:math></inline-formula> defines the feedforward coefficient that is chosen heuristically based on the imaging rate and experimental conditions.</p><p>After preprocessing, larvae in each frame are detected by isolating outermost contours around clusters of bright pixels. Contours within a size range are identified as individual larvae, where the size range is manually adjusted to match the camera resolution and the current larval development stage. Animal identities are linked frame-to-frame by minimizing a pairwise loss that is calculated using a weighted sum of distances between heuristically chosen features from the previous frame to the next. The loss between a detected contour, <inline-formula><mml:math id="inf38"><mml:mi mathsize="80%">i</mml:mi></mml:math></inline-formula>, and a larva from the preceding frame, <inline-formula><mml:math id="inf39"><mml:mi mathsize="80%">j</mml:mi></mml:math></inline-formula>, is calculated as:<disp-formula id="equ2"><mml:math id="m2"><mml:mrow><mml:msub><mml:mi mathsize="80%">L</mml:mi><mml:mrow><mml:mi mathsize="80%">i</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="80%">j</mml:mi></mml:mrow></mml:msub><mml:mo mathsize="80%" stretchy="false">=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi mathsize="80%">β</mml:mi><mml:mi mathsize="80%">r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi mathsize="80%">D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">r</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo mathsize="80%" stretchy="false">,</mml:mo><mml:msub><mml:mi mathsize="80%">r</mml:mi><mml:mi mathsize="80%">j</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow><mml:mo mathsize="80%" stretchy="false">+</mml:mo><mml:mrow><mml:msub><mml:mi mathsize="80%">β</mml:mi><mml:mi mathsize="80%">p</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi mathsize="80%">D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">p</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo mathsize="80%" stretchy="false">,</mml:mo><mml:msub><mml:mi mathsize="80%">p</mml:mi><mml:mi mathsize="80%">j</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow><mml:mo mathsize="80%" stretchy="false">+</mml:mo><mml:mrow><mml:msub><mml:mi mathsize="80%">β</mml:mi><mml:mi mathsize="80%">a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi mathsize="80%">D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:msub><mml:mi mathsize="80%">a</mml:mi><mml:mi mathsize="80%">i</mml:mi></mml:msub><mml:mo mathsize="80%" stretchy="false">,</mml:mo><mml:msub><mml:mi mathsize="80%">a</mml:mi><mml:mi mathsize="80%">j</mml:mi></mml:msub><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf40"><mml:mi mathsize="80%">r</mml:mi></mml:math></inline-formula> is position of the larva’s center of mass, <inline-formula><mml:math id="inf41"><mml:mi mathsize="80%">p</mml:mi></mml:math></inline-formula> is momentum, <inline-formula><mml:math id="inf42"><mml:mi mathsize="80%">a</mml:mi></mml:math></inline-formula> is the contour area (i.e. animal size), and <inline-formula><mml:math id="inf43"><mml:mrow><mml:mi mathsize="80%">D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="80%" minsize="80%">(</mml:mo><mml:mi mathsize="80%">x</mml:mi><mml:mo mathsize="80%" stretchy="false">,</mml:mo><mml:mi mathsize="80%">y</mml:mi><mml:mo maxsize="80%" minsize="80%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the Euclidean distance between vectors <inline-formula><mml:math id="inf44"><mml:mi mathsize="80%">x</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf45"><mml:mi mathsize="80%">y</mml:mi></mml:math></inline-formula>. The coefficients, <italic>β</italic>, weigh each distance term and can be adjusted for different animals and imaging conditions. Each new contour, <inline-formula><mml:math id="inf46"><mml:mi mathsize="80%">i</mml:mi></mml:math></inline-formula>, is uniquely assigned to an ID, <inline-formula><mml:math id="inf47"><mml:mi mathsize="80%">j</mml:mi></mml:math></inline-formula>, beginning with the pair with the lowest loss, then the next lowest loss out of the remaining possible pairs, etc. Any larvae without an assignment in the current frame is given interpolated properties based on the previous few frames to compensate for occlusions or other cases when it is missing from view. Since the linking is sequential, doing so also helps avoid some cases of undesirable identity swaps. With contours in each frame assigned to a unique larva, the centroid of each contour is recorded as the position of the animal and is used to produce a crop around each larva.</p><p>We observe collision events occurring at an average rate of 0.63 events per hour in an arena of six larvae. In frames where two or more animals are colliding, that is their contours are on top of each other to form a single large contour, the contours for the colliding animals from previous frames are translated and combined to generate a similarly large contour. The translation of each contour is initialized using the momentum of the larva in preceding frames, and is optimized for a small number of epochs (<inline-formula><mml:math id="inf48"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) such that the resulting combination best matches the large contour seen in the current frame. The coordinates resulting from this optimization are used as the position of the animal in these frames instead. Through this method, identities are preserved across collision events with an accuracy of 91%, or &lt;1 misidentifications per 6 hr experiment, which can be manually verified and corrected.</p></sec><sec id="s4-3-2"><title>Posture analysis</title><p>The isolated crops (64 × 64 in pixels) around each animal are run through a recurrent U-Net (<xref ref-type="bibr" rid="bib52">Ronneberger et al., 2015</xref>) convolutional neural network to determine the posture and orientation. The U-Net architecture has been shown to be highly effective at tasks that preserve spatial structure in an image by taking advantage of both global and local features (<xref ref-type="bibr" rid="bib52">Ronneberger et al., 2015</xref>, <xref ref-type="bibr" rid="bib50">Risse et al., 2017</xref>, <xref ref-type="bibr" rid="bib24">He et al., 2015</xref>). We design our model such that the output is a probability heat map of the head and tail of the larva, which preserves the global spatial structure of the larva’s body.</p><p>Traditional convolutional neural networks, including U-Net, often fail when analyzing sparse images with low-resolution features (<xref ref-type="bibr" rid="bib50">Risse et al., 2017</xref>). This is particularly pronounced in our case since each larva is generally captured as clusters of only ≈30 uniformly bright pixels surrounded by black pixels. To compensate for this, we utilize more temporal information, such as the current momentum of the centroid. Since larval posture does not deviate much from frame to frame, we add recurrence in the form of long short-term memory (LSTM) cells (<xref ref-type="bibr" rid="bib27">Hochreiter and Schmidhuber, 1997</xref>) at the beginning, middle, and final layers of the network to simplify the problem at each subsequent time step. The recurrence also creates an additional cost for head-tail flips which we have found to be a common issue with previous approaches to the problem (<xref ref-type="bibr" rid="bib50">Risse et al., 2017</xref>, <xref ref-type="bibr" rid="bib43">Mathis et al., 2018</xref>, <xref ref-type="bibr" rid="bib22">Günel et al., 2019</xref>).</p><p>Our implementation of the network comprises two main modules: an encoder and a decoder. The encoder is composed of four submodules of alternating convolutional neural network layers and nonlinear activation layers, including a rectified linear unit (ReLU) and a pooling layer. This is mirrored by the decoder on the other side with the same submodules with upsampling layers replacing the pooling ones. We follow the U-Net architecture to add information ‘highways’ between corresponding layers on the encoder and decoder side, passing outputs from each submodule of the encoder into the corresponding submodule of the decoder. We further modify this architecture by adding recurrence in the form of LSTM cells in the convolutional layers at the beginning of the encoder, the center-most layers between the two modules, and the end of the decoder to simplify the problem at each subsequent time step.</p><p>We formulate the output as a probability heat map of keypoints that define the posture of the animal (e.g. head and tail of the <italic>Drosophila</italic> larva), which preserves the global spatial structure of the larva’s body. The network is trained using manually labeled videos of larvae with ≈1000 frames per animal undergoing several posture changes, including at least one turning event. Upon verification with a small number of such videos withheld during training, we measure of RMSE of <inline-formula><mml:math id="inf49"><mml:mrow><mml:mn mathsize="80%">1.60</mml:mn><mml:mo mathsize="80%" stretchy="false">±</mml:mo><mml:mn mathsize="80%">0.66</mml:mn></mml:mrow></mml:math></inline-formula> px for the head and tail coordinates.</p><p>We may also estimate the ‘spine’ of the animal that characterizes the curvature of the body by using the head and tail points as shown in <xref ref-type="bibr" rid="bib50">Risse et al., 2017</xref>. The contour of the animal is split into two halves, <inline-formula><mml:math id="inf50"><mml:msub><mml:mi mathsize="80%">c</mml:mi><mml:mn mathsize="80%">1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf51"><mml:msub><mml:mi mathsize="80%">c</mml:mi><mml:mn mathsize="80%">2</mml:mn></mml:msub></mml:math></inline-formula>, such that both connect the head and tail along either side of the body. We resample the half-contours at equal rates via linear interpolation such that each point along <inline-formula><mml:math id="inf52"><mml:msub><mml:mi mathsize="80%">c</mml:mi><mml:mn mathsize="80%">1</mml:mn></mml:msub></mml:math></inline-formula> has a unique match along <inline-formula><mml:math id="inf53"><mml:msub><mml:mi mathsize="80%">c</mml:mi><mml:mn mathsize="80%">2</mml:mn></mml:msub></mml:math></inline-formula>. Spine points can then be calculated as the midpoint between equidistant pairs along the two contours. We use the resulting ‘midspine’ point as a more accurate position of the animal, <inline-formula><mml:math id="inf54"><mml:msub><mml:mi mathsize="80%">r</mml:mi><mml:mi mathsize="80%">t</mml:mi></mml:msub></mml:math></inline-formula>, which is favored for subsequent downstream analysis of behavior over the centroid of the animal contour in image space.</p></sec><sec id="s4-3-3"><title>Behavior classification</title><p>Using all available information (position, contour, and posture), we use a densely connected neural network with bidirectional recurrence to classify the behavioral state of the animal (e.g. ‘forward crawl’, ‘turn’) at each time point (<xref ref-type="bibr" rid="bib23">Günther et al., 2016</xref>). The network is a sequence of nine densely connected linear layers alternating with ReLU activation layers, and a bidirectional LSTM layer at the beginning and middle of the sequence for a total of 11 layers. The bidirectional recurrence here allows the network to identify the bends in the animal’s path and particular postural dynamics by comparing frames both before and after. A softmax activation layer at the end of the network scales the output between 0 and 1, representing the probability of each possible larval behavior exhibited in the current frame. The state with the highest assigned probability is selected as the current behavioral state, with some additional cost for switching between behavioral states. From here, we can identify a wide range of behavioral features and track them over extended time periods.</p><p>The network is trained using manually labeled videos of individual larvae crawling for 1 hr. Since the larva is likely to be crawling forward for a large majority of frames, the loss is weighted 10-fold toward frames during turning events. Upon verification with a small number of such videos withheld during training, we measure of an accuracy of 99.8% of frames labeled with the correct behavioral state.</p></sec></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>Dave Zucker is affiliated with FlySorter, LLC. The author has no financial interests to declare</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Formal analysis, Validation, Investigation, Visualization, Methodology, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Investigation, Methodology</p></fn><fn fn-type="con" id="con4"><p>Investigation</p></fn><fn fn-type="con" id="con5"><p>Investigation</p></fn><fn fn-type="con" id="con6"><p>Resources, Methodology</p></fn><fn fn-type="con" id="con7"><p>Conceptualization, Resources, Software</p></fn><fn fn-type="con" id="con8"><p>Conceptualization, Resources, Supervision, Funding acquisition, Investigation, Methodology, Writing - original draft, Project administration, Writing - review and editing</p></fn><fn fn-type="con" id="con9"><p>Conceptualization, Resources, Supervision, Funding acquisition, Investigation, Methodology, Writing - original draft, Project administration, Writing - review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-86585-mdarchecklist1-v1.docx" mimetype="application" mime-subtype="docx"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>Software drivers and analysis tools are hosted in the repository <ext-link ext-link-type="uri" xlink:href="https://github.com/venkatachalamlab/LarvaPickerRobot">https://github.com/venkatachalamlab/LarvaPickerRobot</ext-link> (copy archived at <xref ref-type="bibr" rid="bib64">Yu, 2023</xref>). Mildly compressed versions of all video recordings can be found hosted on Zenodo.</p><p>The following dataset was generated:</p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset1"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>J</given-names></name><name><surname>Dancausse</surname><given-names>S</given-names></name><name><surname>Paz</surname><given-names>M</given-names></name><name><surname>Faderin</surname><given-names>T</given-names></name><name><surname>Gaviria</surname><given-names>M</given-names></name><name><surname>Shomar</surname><given-names>JW</given-names></name><name><surname>Zucker</surname><given-names>D</given-names></name><name><surname>Venkatachalam</surname><given-names>V</given-names></name><name><surname>Klein</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>Videos of long-term <italic>Drosophila melanogaster</italic> crawling behavior</data-title><source>Zenodo</source><pub-id pub-id-type="doi">10.5281/zenodo.8208884</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>VV acknowledges support from the Burroughs Wellcome Fund and NIH R01 NS126334. MK acknowledges support from the NSF CAREER Award 2144385.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alisch</surname><given-names>T</given-names></name><name><surname>Crall</surname><given-names>JD</given-names></name><name><surname>Kao</surname><given-names>AB</given-names></name><name><surname>Zucker</surname><given-names>D</given-names></name><name><surname>de Bivort</surname><given-names>BL</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>MAPLE (modular automated platform for large-scale experiments), a robot for integrated organism-handling and phenotyping</article-title><source>eLife</source><volume>7</volume><elocation-id>e37166</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.37166</pub-id><pub-id pub-id-type="pmid">30117804</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Almeida-Carvalho</surname><given-names>MJ</given-names></name><name><surname>Berh</surname><given-names>D</given-names></name><name><surname>Braun</surname><given-names>A</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Eichler</surname><given-names>K</given-names></name><name><surname>Eschbach</surname><given-names>C</given-names></name><name><surname>Fritsch</surname><given-names>PMJ</given-names></name><name><surname>Gerber</surname><given-names>B</given-names></name><name><surname>Hoyer</surname><given-names>N</given-names></name><name><surname>Jiang</surname><given-names>X</given-names></name><name><surname>Kleber</surname><given-names>J</given-names></name><name><surname>Klämbt</surname><given-names>C</given-names></name><name><surname>König</surname><given-names>C</given-names></name><name><surname>Louis</surname><given-names>M</given-names></name><name><surname>Michels</surname><given-names>B</given-names></name><name><surname>Miroschnikow</surname><given-names>A</given-names></name><name><surname>Mirth</surname><given-names>C</given-names></name><name><surname>Miura</surname><given-names>D</given-names></name><name><surname>Niewalda</surname><given-names>T</given-names></name><name><surname>Otto</surname><given-names>N</given-names></name><name><surname>Paisios</surname><given-names>E</given-names></name><name><surname>Pankratz</surname><given-names>MJ</given-names></name><name><surname>Petersen</surname><given-names>M</given-names></name><name><surname>Ramsperger</surname><given-names>N</given-names></name><name><surname>Randel</surname><given-names>N</given-names></name><name><surname>Risse</surname><given-names>B</given-names></name><name><surname>Saumweber</surname><given-names>T</given-names></name><name><surname>Schlegel</surname><given-names>P</given-names></name><name><surname>Schleyer</surname><given-names>M</given-names></name><name><surname>Soba</surname><given-names>P</given-names></name><name><surname>Sprecher</surname><given-names>SG</given-names></name><name><surname>Tanimura</surname><given-names>T</given-names></name><name><surname>Thum</surname><given-names>AS</given-names></name><name><surname>Toshima</surname><given-names>N</given-names></name><name><surname>Truman</surname><given-names>JW</given-names></name><name><surname>Yarali</surname><given-names>A</given-names></name><name><surname>Zlatic</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>The Ol1mpiad: concordance of behavioural faculties of stage 1 and stage 3 <italic>Drosophila</italic> larvae</article-title><source>Journal of Experimental Biology</source><volume>220</volume><fpage>2452</fpage><lpage>2475</lpage><pub-id pub-id-type="doi">10.1242/jeb.156646</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Almeida-Oliveira</surname><given-names>F</given-names></name><name><surname>Tuthill</surname><given-names>BF</given-names></name><name><surname>Gondim</surname><given-names>KC</given-names></name><name><surname>Majerowicz</surname><given-names>D</given-names></name><name><surname>Musselman</surname><given-names>LP</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>dHNF4 regulates lipid homeostasis and oogenesis in <italic>Drosophila melanogaster</italic></article-title><source>Insect Biochemistry and Molecular Biology</source><volume>133</volume><elocation-id>103569</elocation-id><pub-id pub-id-type="doi">10.1016/j.ibmb.2021.103569</pub-id><pub-id pub-id-type="pmid">33753225</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bainton</surname><given-names>RJ</given-names></name><name><surname>Tsai</surname><given-names>LT</given-names></name><name><surname>Singh</surname><given-names>CM</given-names></name><name><surname>Moore</surname><given-names>MS</given-names></name><name><surname>Neckameyer</surname><given-names>WS</given-names></name><name><surname>Heberlein</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Dopamine modulates acute responses to cocaine, nicotine and ethanol in <italic>Drosophila</italic></article-title><source>Current Biology</source><volume>10</volume><fpage>187</fpage><lpage>194</lpage><pub-id pub-id-type="doi">10.1016/s0960-9822(00)00336-5</pub-id><pub-id pub-id-type="pmid">10704411</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berg</surname><given-names>HC</given-names></name><name><surname>Brown</surname><given-names>DA</given-names></name></person-group><year iso-8601-date="1972">1972</year><article-title>Chemotaxis in <italic>Escherichia coli</italic> analysed by three-dimensional tracking</article-title><source>Nature</source><volume>239</volume><fpage>500</fpage><lpage>504</lpage><pub-id pub-id-type="doi">10.1038/239500a0</pub-id><pub-id pub-id-type="pmid">4563019</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Berg</surname><given-names>HC</given-names></name></person-group><year iso-8601-date="2004">2004</year><source>E. coli in Motion</source><publisher-name>Springer</publisher-name><pub-id pub-id-type="doi">10.1007/b97370</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Berne</surname><given-names>A</given-names></name><name><surname>Zhang</surname><given-names>T</given-names></name><name><surname>Shomar</surname><given-names>J</given-names></name><name><surname>Ferrer</surname><given-names>AJ</given-names></name><name><surname>Valdes</surname><given-names>A</given-names></name><name><surname>Ohyama</surname><given-names>T</given-names></name><name><surname>Klein</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Mechanical vibration patterns elicit behavioral transitions and habituation in crawling <italic>Drosophila</italic> Larvae</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.04.26.441415</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Besson</surname><given-names>M</given-names></name><name><surname>Martin</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Centrophobism/thigmotaxis, a new role for the mushroom bodies in <italic>Drosophila</italic></article-title><source>Journal of Neurobiology</source><volume>62</volume><fpage>386</fpage><lpage>396</lpage><pub-id pub-id-type="doi">10.1002/neu.20111</pub-id><pub-id pub-id-type="pmid">15547935</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buchanan</surname><given-names>SM</given-names></name><name><surname>Kain</surname><given-names>JS</given-names></name><name><surname>de Bivort</surname><given-names>BL</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Neuronal control of locomotor handedness in <italic>Drosophila</italic></article-title><source>PNAS</source><volume>112</volume><fpage>6700</fpage><lpage>6705</lpage><pub-id pub-id-type="doi">10.1073/pnas.1500804112</pub-id><pub-id pub-id-type="pmid">25953337</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Calhoun</surname><given-names>AJ</given-names></name><name><surname>Chalasani</surname><given-names>SH</given-names></name><name><surname>Sharpee</surname><given-names>TO</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Maximally informative foraging by <italic>Caenorhabditis elegans</italic></article-title><source>eLife</source><volume>3</volume><elocation-id>e04220</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.04220</pub-id><pub-id pub-id-type="pmid">25490069</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Codling</surname><given-names>EA</given-names></name><name><surname>Plank</surname><given-names>MJ</given-names></name><name><surname>Benhamou</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Random walk models in biology</article-title><source>Journal of the Royal Society, Interface</source><volume>5</volume><fpage>813</fpage><lpage>834</lpage><pub-id pub-id-type="doi">10.1098/rsif.2008.0014</pub-id><pub-id pub-id-type="pmid">18426776</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Colomb</surname><given-names>J</given-names></name><name><surname>Grillenzoni</surname><given-names>N</given-names></name><name><surname>Stocker</surname><given-names>RF</given-names></name><name><surname>Ramaekers</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Complex behavioural changes after odour exposure in <italic>Drosophila</italic> larvae</article-title><source>Animal Behaviour</source><volume>73</volume><fpage>587</fpage><lpage>594</lpage><pub-id pub-id-type="doi">10.1016/j.anbehav.2006.04.016</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fayyazuddin</surname><given-names>A</given-names></name><name><surname>Zaheer</surname><given-names>MA</given-names></name><name><surname>Hiesinger</surname><given-names>PR</given-names></name><name><surname>Bellen</surname><given-names>HJ</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>The nicotinic acetylcholine receptor Dalpha7 is required for an escape behavior in <italic>Drosophila</italic></article-title><source>PLOS Biology</source><volume>4</volume><elocation-id>e63</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.0040063</pub-id><pub-id pub-id-type="pmid">16494528</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fernández-Moreno</surname><given-names>MA</given-names></name><name><surname>Farr</surname><given-names>CL</given-names></name><name><surname>Kaguni</surname><given-names>LS</given-names></name><name><surname>Garesse</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title><italic>Drosophila melanogaster</italic> as a model system to study mitochondrial biology</article-title><source>Methods in Molecular Biology</source><volume>372</volume><fpage>33</fpage><lpage>49</lpage><pub-id pub-id-type="doi">10.1007/978-1-59745-365-3_3</pub-id><pub-id pub-id-type="pmid">18314716</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Freeman</surname><given-names>JB</given-names></name><name><surname>Dale</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Assessing bimodality to detect the presence of a dual cognitive process</article-title><source>Behavior Research Methods</source><volume>45</volume><fpage>83</fpage><lpage>97</lpage><pub-id pub-id-type="doi">10.3758/s13428-012-0225-x</pub-id><pub-id pub-id-type="pmid">22806703</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gallio</surname><given-names>M</given-names></name><name><surname>Ofstad</surname><given-names>TA</given-names></name><name><surname>Macpherson</surname><given-names>LJ</given-names></name><name><surname>Wang</surname><given-names>JW</given-names></name><name><surname>Zuker</surname><given-names>CS</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The coding of temperature in the <italic>Drosophila</italic> brain</article-title><source>Cell</source><volume>144</volume><fpage>614</fpage><lpage>624</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2011.01.028</pub-id><pub-id pub-id-type="pmid">21335241</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Geissmann</surname><given-names>Q</given-names></name><name><surname>Garcia Rodriguez</surname><given-names>L</given-names></name><name><surname>Beckwith</surname><given-names>EJ</given-names></name><name><surname>French</surname><given-names>AS</given-names></name><name><surname>Jamasb</surname><given-names>AR</given-names></name><name><surname>Gilestro</surname><given-names>GF</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Ethoscopes: An open platform for high-throughput ethomics</article-title><source>PLOS Biology</source><volume>15</volume><elocation-id>e2003026</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.2003026</pub-id><pub-id pub-id-type="pmid">29049280</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gepner</surname><given-names>R</given-names></name><name><surname>Mihovilovic Skanata</surname><given-names>M</given-names></name><name><surname>Bernat</surname><given-names>NM</given-names></name><name><surname>Kaplow</surname><given-names>M</given-names></name><name><surname>Gershow</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Computations underlying <italic>Drosophila</italic> photo-taxis, odor-taxis, and multi-sensory integration</article-title><source>eLife</source><volume>4</volume><elocation-id>e06229</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.06229</pub-id><pub-id pub-id-type="pmid">25945916</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gerber</surname><given-names>B</given-names></name><name><surname>Stocker</surname><given-names>RF</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>The <italic>Drosophila</italic> larva as A model for studying chemosensation and chemosensory learning: A review</article-title><source>Chemical Senses</source><volume>32</volume><fpage>65</fpage><lpage>89</lpage><pub-id pub-id-type="doi">10.1093/chemse/bjl030</pub-id><pub-id pub-id-type="pmid">17071942</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goulding</surname><given-names>EH</given-names></name><name><surname>Schenk</surname><given-names>AK</given-names></name><name><surname>Juneja</surname><given-names>P</given-names></name><name><surname>MacKay</surname><given-names>AW</given-names></name><name><surname>Wade</surname><given-names>JM</given-names></name><name><surname>Tecott</surname><given-names>LH</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>A robust automated system elucidates mouse home cage behavioral structure</article-title><source>PNAS</source><volume>105</volume><fpage>20575</fpage><lpage>20582</lpage><pub-id pub-id-type="doi">10.1073/pnas.0809053106</pub-id><pub-id pub-id-type="pmid">19106295</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gradinaru</surname><given-names>V</given-names></name><name><surname>Zhang</surname><given-names>F</given-names></name><name><surname>Ramakrishnan</surname><given-names>C</given-names></name><name><surname>Mattis</surname><given-names>J</given-names></name><name><surname>Prakash</surname><given-names>R</given-names></name><name><surname>Diester</surname><given-names>I</given-names></name><name><surname>Goshen</surname><given-names>I</given-names></name><name><surname>Thompson</surname><given-names>KR</given-names></name><name><surname>Deisseroth</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Molecular and cellular approaches for diversifying and extending optogenetics</article-title><source>Cell</source><volume>141</volume><fpage>154</fpage><lpage>165</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2010.02.037</pub-id><pub-id pub-id-type="pmid">20303157</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Günel</surname><given-names>S</given-names></name><name><surname>Rhodin</surname><given-names>H</given-names></name><name><surname>Morales</surname><given-names>D</given-names></name><name><surname>Campagnolo</surname><given-names>J</given-names></name><name><surname>Ramdya</surname><given-names>P</given-names></name><name><surname>Fua</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Deepfly3d: A deep learning-based approach for 3D limb and appendage tracking in tethered, adult <italic>Drosophila</italic></article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/640375</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Günther</surname><given-names>MN</given-names></name><name><surname>Nettesheim</surname><given-names>G</given-names></name><name><surname>Shubeita</surname><given-names>GT</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Quantifying and predicting <italic>Drosophila</italic> larvae crawling phenotypes</article-title><source>Scientific Reports</source><volume>6</volume><elocation-id>27972</elocation-id><pub-id pub-id-type="doi">10.1038/srep27972</pub-id><pub-id pub-id-type="pmid">27323901</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>He</surname><given-names>K</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Ren</surname><given-names>S</given-names></name><name><surname>Sun</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Deep residual learning for image recognition</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1512.03385">https://arxiv.org/abs/1512.03385</ext-link><pub-id pub-id-type="doi">10.1109/CVPR.2016.90</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hernandez-Nunez</surname><given-names>L</given-names></name><name><surname>Belina</surname><given-names>J</given-names></name><name><surname>Klein</surname><given-names>M</given-names></name><name><surname>Si</surname><given-names>G</given-names></name><name><surname>Claus</surname><given-names>L</given-names></name><name><surname>Carlson</surname><given-names>JR</given-names></name><name><surname>Samuel</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Reverse-correlation analysis of navigation dynamics in <italic>Drosophila</italic> larva using optogenetics</article-title><source>eLife</source><volume>4</volume><elocation-id>e06225</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.06225</pub-id><pub-id pub-id-type="pmid">25942453</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Hernandez-Nunez</surname><given-names>L</given-names></name><name><surname>Chen</surname><given-names>A</given-names></name><name><surname>Budelli</surname><given-names>G</given-names></name><name><surname>Richter</surname><given-names>V</given-names></name><name><surname>Rist</surname><given-names>A</given-names></name><name><surname>Thum</surname><given-names>AS</given-names></name><name><surname>Klein</surname><given-names>M</given-names></name><name><surname>Garrity</surname><given-names>P</given-names></name><name><surname>Samuel</surname><given-names>ADT</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Synchronous and opponent thermosensors use flexible cross-inhibition to orchestrate thermal homeostasis</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2020.07.09.196428</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hochreiter</surname><given-names>S</given-names></name><name><surname>Schmidhuber</surname><given-names>J</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Long short-term memory</article-title><source>Neural Computation</source><volume>9</volume><fpage>1735</fpage><lpage>1780</lpage><pub-id pub-id-type="doi">10.1162/neco.1997.9.8.1735</pub-id><pub-id pub-id-type="pmid">9377276</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huser</surname><given-names>A</given-names></name><name><surname>Rohwedder</surname><given-names>A</given-names></name><name><surname>Apostolopoulou</surname><given-names>AA</given-names></name><name><surname>Widmann</surname><given-names>A</given-names></name><name><surname>Pfitzenmaier</surname><given-names>JE</given-names></name><name><surname>Maiolo</surname><given-names>EM</given-names></name><name><surname>Selcho</surname><given-names>M</given-names></name><name><surname>Pauls</surname><given-names>D</given-names></name><name><surname>von Essen</surname><given-names>A</given-names></name><name><surname>Gupta</surname><given-names>T</given-names></name><name><surname>Sprecher</surname><given-names>SG</given-names></name><name><surname>Birman</surname><given-names>S</given-names></name><name><surname>Riemensperger</surname><given-names>T</given-names></name><name><surname>Stocker</surname><given-names>RF</given-names></name><name><surname>Thum</surname><given-names>AS</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The serotonergic central nervous system of the <italic>Drosophila</italic> larva: anatomy and behavioral function</article-title><source>PLOS ONE</source><volume>7</volume><elocation-id>e47518</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0047518</pub-id><pub-id pub-id-type="pmid">23082175</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Inada</surname><given-names>K</given-names></name><name><surname>Kohsaka</surname><given-names>H</given-names></name><name><surname>Takasu</surname><given-names>E</given-names></name><name><surname>Matsunaga</surname><given-names>T</given-names></name><name><surname>Nose</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Optical dissection of neural circuits responsible for <italic>Drosophila</italic> larval locomotion with halorhodopsin</article-title><source>PLOS ONE</source><volume>6</volume><elocation-id>e29019</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0029019</pub-id><pub-id pub-id-type="pmid">22216159</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Jaime</surname><given-names>MDLA</given-names></name><name><surname>Karott</surname><given-names>S</given-names></name><name><surname>Salem</surname><given-names>GH</given-names></name><name><surname>Krynitsky</surname><given-names>J</given-names></name><name><surname>Garmendia-Cedillos</surname><given-names>M</given-names></name><name><surname>Anderson</surname><given-names>S</given-names></name><name><surname>Harbison</surname><given-names>S</given-names></name><name><surname>Pohida</surname><given-names>TJ</given-names></name><name><surname>Oliver</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>The high-throughput WAFFL system for treating and monitoring individual <italic>Drosophila melanogaster</italic> adults</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/428037</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kane</surname><given-names>EA</given-names></name><name><surname>Gershow</surname><given-names>M</given-names></name><name><surname>Afonso</surname><given-names>B</given-names></name><name><surname>Larderet</surname><given-names>I</given-names></name><name><surname>Klein</surname><given-names>M</given-names></name><name><surname>Carter</surname><given-names>AR</given-names></name><name><surname>de Bivort</surname><given-names>BL</given-names></name><name><surname>Sprecher</surname><given-names>SG</given-names></name><name><surname>Samuel</surname><given-names>ADT</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Sensorimotor structure of <italic>Drosophila</italic> larva phototaxis</article-title><source>PNAS</source><volume>110</volume><fpage>E3868</fpage><lpage>E3877</lpage><pub-id pub-id-type="doi">10.1073/pnas.1215295110</pub-id><pub-id pub-id-type="pmid">24043822</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kaun</surname><given-names>KR</given-names></name><name><surname>Devineni</surname><given-names>AV</given-names></name><name><surname>Heberlein</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title><italic>Drosophila melanogaster</italic> as a model to study drug addiction</article-title><source>Human Genetics</source><volume>131</volume><fpage>959</fpage><lpage>975</lpage><pub-id pub-id-type="doi">10.1007/s00439-012-1146-6</pub-id><pub-id pub-id-type="pmid">22350798</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>D</given-names></name><name><surname>Alvarez</surname><given-names>M</given-names></name><name><surname>Lechuga</surname><given-names>LM</given-names></name><name><surname>Louis</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Species-specific modulation of food-search behavior by respiration and chemosensation in <italic>Drosophila</italic> larvae</article-title><source>eLife</source><volume>6</volume><elocation-id>e27057</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.27057</pub-id><pub-id pub-id-type="pmid">28871963</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klein</surname><given-names>M</given-names></name><name><surname>Afonso</surname><given-names>B</given-names></name><name><surname>Vonner</surname><given-names>AJ</given-names></name><name><surname>Hernandez-Nunez</surname><given-names>L</given-names></name><name><surname>Berck</surname><given-names>M</given-names></name><name><surname>Tabone</surname><given-names>CJ</given-names></name><name><surname>Kane</surname><given-names>EA</given-names></name><name><surname>Pieribone</surname><given-names>VA</given-names></name><name><surname>Nitabach</surname><given-names>MN</given-names></name><name><surname>Cardona</surname><given-names>A</given-names></name><name><surname>Zlatic</surname><given-names>M</given-names></name><name><surname>Sprecher</surname><given-names>SG</given-names></name><name><surname>Gershow</surname><given-names>M</given-names></name><name><surname>Garrity</surname><given-names>PA</given-names></name><name><surname>Samuel</surname><given-names>ADT</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Sensory determinants of behavioral dynamics in <italic>Drosophila</italic> thermotaxis</article-title><source>PNAS</source><volume>112</volume><fpage>E220</fpage><lpage>E229</lpage><pub-id pub-id-type="doi">10.1073/pnas.1416212112</pub-id><pub-id pub-id-type="pmid">25550513</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klein</surname><given-names>M</given-names></name><name><surname>Krivov</surname><given-names>SV</given-names></name><name><surname>Ferrer</surname><given-names>AJ</given-names></name><name><surname>Luo</surname><given-names>L</given-names></name><name><surname>Samuel</surname><given-names>AD</given-names></name><name><surname>Karplus</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Exploratory search during directed navigation in <italic>C. elegans</italic> and <italic>Drosophila</italic> larva</article-title><source>eLife</source><volume>6</volume><elocation-id>30503</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.30503</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kudow</surname><given-names>N</given-names></name><name><surname>Kamikouchi</surname><given-names>A</given-names></name><name><surname>Tanimura</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Softness sensing and learning in <italic>Drosophila</italic> larvae</article-title><source>Journal of Experimental Biology</source><volume>222</volume><elocation-id>196329</elocation-id><pub-id pub-id-type="doi">10.1242/jeb.196329</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lahiri</surname><given-names>S</given-names></name><name><surname>Shen</surname><given-names>K</given-names></name><name><surname>Klein</surname><given-names>M</given-names></name><name><surname>Tang</surname><given-names>A</given-names></name><name><surname>Kane</surname><given-names>E</given-names></name><name><surname>Gershow</surname><given-names>M</given-names></name><name><surname>Garrity</surname><given-names>P</given-names></name><name><surname>Samuel</surname><given-names>ADT</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Two alternating motor programs drive navigation in <italic>Drosophila</italic> larva</article-title><source>PLOS ONE</source><volume>6</volume><elocation-id>e23180</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0023180</pub-id><pub-id pub-id-type="pmid">21858019</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Larderet</surname><given-names>I</given-names></name><name><surname>Fritsch</surname><given-names>PM</given-names></name><name><surname>Gendre</surname><given-names>N</given-names></name><name><surname>Neagu-Maier</surname><given-names>GL</given-names></name><name><surname>Fetter</surname><given-names>RD</given-names></name><name><surname>Schneider-Mizell</surname><given-names>CM</given-names></name><name><surname>Truman</surname><given-names>JW</given-names></name><name><surname>Zlatic</surname><given-names>M</given-names></name><name><surname>Cardona</surname><given-names>A</given-names></name><name><surname>Sprecher</surname><given-names>SG</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Organization of the <italic>Drosophila</italic> larval visual circuit</article-title><source>eLife</source><volume>6</volume><elocation-id>e28387</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.28387</pub-id><pub-id pub-id-type="pmid">30726702</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Larkin</surname><given-names>A</given-names></name><name><surname>Chen</surname><given-names>M-Y</given-names></name><name><surname>Kirszenblat</surname><given-names>L</given-names></name><name><surname>Reinhard</surname><given-names>J</given-names></name><name><surname>van Swinderen</surname><given-names>B</given-names></name><name><surname>Claudianos</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Neurexin-1 regulates sleep and synaptic plasticity in <italic>Drosophila melanogaster</italic></article-title><source>The European Journal of Neuroscience</source><volume>42</volume><fpage>2455</fpage><lpage>2466</lpage><pub-id pub-id-type="doi">10.1111/ejn.13023</pub-id><pub-id pub-id-type="pmid">26201245</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lesar</surname><given-names>A</given-names></name><name><surname>Tahir</surname><given-names>J</given-names></name><name><surname>Wolk</surname><given-names>J</given-names></name><name><surname>Gershow</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Switch-like and persistent memory formation in individual <italic>Drosophila larvae</italic></article-title><source>eLife</source><volume>10</volume><elocation-id>e70317</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.70317</pub-id><pub-id pub-id-type="pmid">34636720</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Louis</surname><given-names>M</given-names></name><name><surname>de Polavieja</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Collective behavior: Social digging in <italic>Drosophila</italic> larvae</article-title><source>Current Biology</source><volume>27</volume><fpage>R1010</fpage><lpage>R1012</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2017.08.023</pub-id><pub-id pub-id-type="pmid">28950082</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luo</surname><given-names>L</given-names></name><name><surname>Gershow</surname><given-names>M</given-names></name><name><surname>Rosenzweig</surname><given-names>M</given-names></name><name><surname>Kang</surname><given-names>K</given-names></name><name><surname>Fang-Yen</surname><given-names>C</given-names></name><name><surname>Garrity</surname><given-names>PA</given-names></name><name><surname>Samuel</surname><given-names>ADT</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Navigational decision making in <italic>Drosophila</italic> thermotaxis</article-title><source>The Journal of Neuroscience</source><volume>30</volume><fpage>4261</fpage><lpage>4272</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4090-09.2010</pub-id><pub-id pub-id-type="pmid">20335462</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mathis</surname><given-names>A</given-names></name><name><surname>Mamidanna</surname><given-names>P</given-names></name><name><surname>Cury</surname><given-names>KM</given-names></name><name><surname>Abe</surname><given-names>T</given-names></name><name><surname>Murthy</surname><given-names>VN</given-names></name><name><surname>Mathis</surname><given-names>MW</given-names></name><name><surname>Bethge</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>DeepLabCut: markerless pose estimation of user-defined body parts with deep learning</article-title><source>Nature Neuroscience</source><volume>21</volume><fpage>1281</fpage><lpage>1289</lpage><pub-id pub-id-type="doi">10.1038/s41593-018-0209-y</pub-id><pub-id pub-id-type="pmid">30127430</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McGuire</surname><given-names>SE</given-names></name><name><surname>Le</surname><given-names>PT</given-names></name><name><surname>Osborn</surname><given-names>AJ</given-names></name><name><surname>Matsumoto</surname><given-names>K</given-names></name><name><surname>Davis</surname><given-names>RL</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Spatiotemporal rescue of memory dysfunction in <italic>Drosophila</italic></article-title><source>Science</source><volume>302</volume><fpage>1765</fpage><lpage>1768</lpage><pub-id pub-id-type="doi">10.1126/science.1089035</pub-id><pub-id pub-id-type="pmid">14657498</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McGuire</surname><given-names>SE</given-names></name><name><surname>Roman</surname><given-names>G</given-names></name><name><surname>Davis</surname><given-names>RL</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Gene expression systems in <italic>Drosophila</italic>: a synthesis of time and space</article-title><source>Trends in Genetics</source><volume>20</volume><fpage>384</fpage><lpage>391</lpage><pub-id pub-id-type="doi">10.1016/j.tig.2004.06.012</pub-id><pub-id pub-id-type="pmid">15262411</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ohyama</surname><given-names>T</given-names></name><name><surname>Jovanic</surname><given-names>T</given-names></name><name><surname>Denisov</surname><given-names>G</given-names></name><name><surname>Dang</surname><given-names>TC</given-names></name><name><surname>Hoffmann</surname><given-names>D</given-names></name><name><surname>Kerr</surname><given-names>RA</given-names></name><name><surname>Zlatic</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>High-throughput analysis of stimulus-evoked behaviors in <italic>Drosophila</italic> larva reveals multiple modality-specific escape strategies</article-title><source>PLOS ONE</source><volume>8</volume><elocation-id>e71706</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0071706</pub-id><pub-id pub-id-type="pmid">23977118</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pfeiffenberger</surname><given-names>C</given-names></name><name><surname>Lear</surname><given-names>BC</given-names></name><name><surname>Keegan</surname><given-names>KP</given-names></name><name><surname>Allada</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Locomotor activity level monitoring using the <italic>Drosophila</italic> Activity Monitoring (DAM) system</article-title><source>Cold Spring Harbor Protocols</source><volume>2010</volume><elocation-id>db</elocation-id><pub-id pub-id-type="doi">10.1101/pdb.prot5518</pub-id><pub-id pub-id-type="pmid">21041391</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poddar</surname><given-names>R</given-names></name><name><surname>Kawai</surname><given-names>R</given-names></name><name><surname>Ölveczky</surname><given-names>BP</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A fully automated high-throughput training system for rodents</article-title><source>PLOS ONE</source><volume>8</volume><elocation-id>e83171</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0083171</pub-id><pub-id pub-id-type="pmid">24349451</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Riedl</surname><given-names>J</given-names></name><name><surname>Louis</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Behavioral neuroscience: Crawling is a no-brainer for fruit fly larvae</article-title><source>Current Biology</source><volume>22</volume><fpage>R867</fpage><lpage>R869</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2012.08.018</pub-id><pub-id pub-id-type="pmid">23098592</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Risse</surname><given-names>B</given-names></name><name><surname>Berh</surname><given-names>D</given-names></name><name><surname>Otto</surname><given-names>N</given-names></name><name><surname>Klämbt</surname><given-names>C</given-names></name><name><surname>Jiang</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>FIMTrack: An open source tracking and locomotion analysis software for small animals</article-title><source>PLOS Computational Biology</source><volume>13</volume><elocation-id>e1005530</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005530</pub-id><pub-id pub-id-type="pmid">28493862</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>BG</given-names></name><name><surname>Khurana</surname><given-names>S</given-names></name><name><surname>Pohl</surname><given-names>JB</given-names></name><name><surname>Li</surname><given-names>W</given-names></name><name><surname>Ghezzi</surname><given-names>A</given-names></name><name><surname>Cady</surname><given-names>AM</given-names></name><name><surname>Najjar</surname><given-names>K</given-names></name><name><surname>Hatch</surname><given-names>MM</given-names></name><name><surname>Shah</surname><given-names>RR</given-names></name><name><surname>Bhat</surname><given-names>A</given-names></name><name><surname>Hariri</surname><given-names>O</given-names></name><name><surname>Haroun</surname><given-names>KB</given-names></name><name><surname>Young</surname><given-names>MC</given-names></name><name><surname>Fife</surname><given-names>K</given-names></name><name><surname>Hooten</surname><given-names>J</given-names></name><name><surname>Tran</surname><given-names>T</given-names></name><name><surname>Goan</surname><given-names>D</given-names></name><name><surname>Desai</surname><given-names>F</given-names></name><name><surname>Husain</surname><given-names>F</given-names></name><name><surname>Godinez</surname><given-names>RM</given-names></name><name><surname>Sun</surname><given-names>JC</given-names></name><name><surname>Corpuz</surname><given-names>J</given-names></name><name><surname>Moran</surname><given-names>J</given-names></name><name><surname>Zhong</surname><given-names>AC</given-names></name><name><surname>Chen</surname><given-names>WY</given-names></name><name><surname>Atkinson</surname><given-names>NS</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>A low concentration of ethanol impairs learning but not motor and sensory behavior in <italic>Drosophila larvae</italic></article-title><source>PLOS ONE</source><volume>7</volume><elocation-id>e37394</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0037394</pub-id><pub-id pub-id-type="pmid">22624024</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Ronneberger</surname><given-names>O</given-names></name><name><surname>Fischer</surname><given-names>P</given-names></name><name><surname>Brox</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2015">2015</year><chapter-title>U-Net: Convolutional Networks for Biomedical Image Segmentation</chapter-title><person-group person-group-type="editor"><name><surname>Navab</surname><given-names>N</given-names></name><name><surname>Hornegger</surname><given-names>J</given-names></name><name><surname>Wells</surname><given-names>WM</given-names></name><name><surname>Frangi</surname><given-names>AF</given-names></name></person-group><source>Edical Image Computing and Computer-Assisted Intervention – MICCAI 2015. MICCAI 2015. Lecture Notes in Computer Science</source><publisher-name>Springer International Publishing</publisher-name><fpage>234</fpage><lpage>241</lpage><pub-id pub-id-type="doi">10.1007/978-3-319-24574-4</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Salvaterra</surname><given-names>PM</given-names></name><name><surname>Kitamoto</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title><italic>Drosophila</italic> cholinergic neurons and processes visualized with Gal4/UAS–GFP</article-title><source>Gene Expression Patterns</source><volume>1</volume><fpage>73</fpage><lpage>82</lpage><pub-id pub-id-type="doi">10.1016/S1567-133X(01)00011-4</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schumann</surname><given-names>I</given-names></name><name><surname>Berger</surname><given-names>M</given-names></name><name><surname>Nowag</surname><given-names>N</given-names></name><name><surname>Schäfer</surname><given-names>Y</given-names></name><name><surname>Saumweber</surname><given-names>J</given-names></name><name><surname>Scholz</surname><given-names>H</given-names></name><name><surname>Thum</surname><given-names>AS</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Ethanol-guided behavior in <italic>Drosophila</italic> larvae</article-title><source>Scientific Reports</source><volume>11</volume><elocation-id>12307</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-021-91677-3</pub-id><pub-id pub-id-type="pmid">34112872</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sokolowski</surname><given-names>MB</given-names></name></person-group><year iso-8601-date="1980">1980</year><article-title>Foraging strategies of <italic>Drosophila melanogaster</italic>: A chromosomal analysis</article-title><source>Behavior Genetics</source><volume>10</volume><fpage>291</fpage><lpage>302</lpage><pub-id pub-id-type="doi">10.1007/BF01067774</pub-id><pub-id pub-id-type="pmid">6783027</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sokolowski</surname><given-names>MB</given-names></name><name><surname>Bauer</surname><given-names>SJ</given-names></name><name><surname>Wai-Ping</surname><given-names>V</given-names></name><name><surname>Rodriguez</surname><given-names>L</given-names></name><name><surname>Wong</surname><given-names>JL</given-names></name><name><surname>Kent</surname><given-names>C</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>Ecological genetics and behaviour of <italic>Drosophila melanogaster</italic> larvae in nature</article-title><source>Animal Behaviour</source><volume>34</volume><fpage>403</fpage><lpage>408</lpage><pub-id pub-id-type="doi">10.1016/S0003-3472(86)80109-9</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sprecher</surname><given-names>SG</given-names></name><name><surname>Pichaud</surname><given-names>F</given-names></name><name><surname>Desplan</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Adult and larval photoreceptors use different mechanisms to specify the same Rhodopsin fates</article-title><source>Genes &amp; Development</source><volume>21</volume><fpage>2182</fpage><lpage>2195</lpage><pub-id pub-id-type="doi">10.1101/gad.1565407</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stern</surname><given-names>S</given-names></name><name><surname>Kirst</surname><given-names>C</given-names></name><name><surname>Bargmann</surname><given-names>CI</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Neuromodulatory control of long-term behavioral patterns and individuality across development</article-title><source>Cell</source><volume>171</volume><fpage>1649</fpage><lpage>1662</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2017.10.041</pub-id><pub-id pub-id-type="pmid">29198526</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tian</surname><given-names>L</given-names></name><name><surname>Hires</surname><given-names>SA</given-names></name><name><surname>Mao</surname><given-names>T</given-names></name><name><surname>Huber</surname><given-names>D</given-names></name><name><surname>Chiappe</surname><given-names>ME</given-names></name><name><surname>Chalasani</surname><given-names>SH</given-names></name><name><surname>Petreanu</surname><given-names>L</given-names></name><name><surname>Akerboom</surname><given-names>J</given-names></name><name><surname>McKinney</surname><given-names>SA</given-names></name><name><surname>Schreiter</surname><given-names>ER</given-names></name><name><surname>Bargmann</surname><given-names>CI</given-names></name><name><surname>Jayaraman</surname><given-names>V</given-names></name><name><surname>Svoboda</surname><given-names>K</given-names></name><name><surname>Looger</surname><given-names>LL</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Imaging neural activity in worms, flies and mice with improved GCaMP calcium indicators</article-title><source>Nature Methods</source><volume>6</volume><fpage>875</fpage><lpage>881</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1398</pub-id><pub-id pub-id-type="pmid">19898485</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vogt</surname><given-names>K</given-names></name><name><surname>Zimmerman</surname><given-names>DM</given-names></name><name><surname>Schlichting</surname><given-names>M</given-names></name><name><surname>Hernandez-Nunez</surname><given-names>L</given-names></name><name><surname>Qin</surname><given-names>S</given-names></name><name><surname>Malacon</surname><given-names>K</given-names></name><name><surname>Rosbash</surname><given-names>M</given-names></name><name><surname>Pehlevan</surname><given-names>C</given-names></name><name><surname>Cardona</surname><given-names>A</given-names></name><name><surname>Samuel</surname><given-names>ADT</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Internal state configures olfactory behavior and early sensory processing in <italic>Drosophila</italic> larvae</article-title><source>Science Advances</source><volume>7</volume><elocation-id>eabd6900</elocation-id><pub-id pub-id-type="doi">10.1126/sciadv.abd6900</pub-id><pub-id pub-id-type="pmid">33523854</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolf</surname><given-names>FW</given-names></name><name><surname>Heberlein</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Invertebrate models of drug abuse</article-title><source>Journal of Neurobiology</source><volume>54</volume><fpage>161</fpage><lpage>178</lpage><pub-id pub-id-type="doi">10.1002/neu.10166</pub-id><pub-id pub-id-type="pmid">12486703</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wosniack</surname><given-names>ME</given-names></name><name><surname>Festa</surname><given-names>D</given-names></name><name><surname>Hu</surname><given-names>N</given-names></name><name><surname>Gjorgjieva</surname><given-names>J</given-names></name><name><surname>Berni</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Adaptation of <italic>Drosophila</italic> larva foraging in response to changes in food resources</article-title><source>eLife</source><volume>11</volume><elocation-id>e75826</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.75826</pub-id><pub-id pub-id-type="pmid">36458693</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xie</surname><given-names>T</given-names></name><name><surname>Ho</surname><given-names>MCW</given-names></name><name><surname>Liu</surname><given-names>Q</given-names></name><name><surname>Horiuchi</surname><given-names>W</given-names></name><name><surname>Lin</surname><given-names>C-C</given-names></name><name><surname>Task</surname><given-names>D</given-names></name><name><surname>Luan</surname><given-names>H</given-names></name><name><surname>White</surname><given-names>BH</given-names></name><name><surname>Potter</surname><given-names>CJ</given-names></name><name><surname>Wu</surname><given-names>MN</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A genetic toolkit for dissecting dopamine circuit function in <italic>Drosophila</italic></article-title><source>Cell Reports</source><volume>23</volume><fpage>652</fpage><lpage>665</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2018.03.068</pub-id><pub-id pub-id-type="pmid">29642019</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>Larvapickerrobot</data-title><version designator="swh:1:rev:e4ed4522df2e11796062e717e768e301e9939611">swh:1:rev:e4ed4522df2e11796062e717e768e301e9939611</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:b862c1f016ca534f9c3189985c04dde791a3c4da;origin=https://github.com/venkatachalamlab/LarvaPickerRobot;visit=swh:1:snp:236da394baec627f2ae74f9e11f225910fc70a6c;anchor=swh:1:rev:e4ed4522df2e11796062e717e768e301e9939611">https://archive.softwareheritage.org/swh:1:dir:b862c1f016ca534f9c3189985c04dde791a3c4da;origin=https://github.com/venkatachalamlab/LarvaPickerRobot;visit=swh:1:snp:236da394baec627f2ae74f9e11f225910fc70a6c;anchor=swh:1:rev:e4ed4522df2e11796062e717e768e301e9939611</ext-link></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.86585.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Louis</surname><given-names>Matthieu</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02t274463</institution-id><institution>University of California, Santa Barbara</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><related-object id="sa0ro1" object-id-type="id" object-id="10.1101/2023.02.27.530235" link-type="continued-by" xlink:href="https://sciety.org/articles/10.1101/2023.02.27.530235"/></front-stub><body><p>This study describes a useful method to monitor the behavior of <italic>Drosophila</italic> larvae in a uniform environment over much longer time scales than was possible with previous methods. The authors provide a solid characterization of aspects of the method and show that the behavior of single larvae can be quantified over several hours. The experiments offer a proof-of-concept for a robotic device that will enable the investigation of behavior in long-term experiments in ways that were previously unimaginable.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.86585.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Louis</surname><given-names>Matthieu</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02t274463</institution-id><institution>University of California, Santa Barbara</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>Our editorial process produces two outputs: i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/10.1101/2023.02.27.530235">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2023.02.27.530235v1">the preprint</ext-link> for the benefit of readers; ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Continuous, long-term crawling behavior characterized by a robotic transport system&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, and the evaluation has been overseen by a Reviewing Editor and K VijayRaghavan as the Senior Editor.</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>The reviewers appreciate the qualities and future impact of the method you have developed to study the long-term behavior of <italic>Drosophila</italic> larvae. The observation of a bimodal distribution in the navigation index of single larvae highlights that mean behaviors measured over short observation times can mask diversity in the behaviors of individual animals. You provide strong evidence that your system will be useful to other laboratories interested in prolonged recording of larval activity. However, several weaknesses of the manuscript should be addressed prior to its publication. The revision does not require the collection of additional data. Generally, you should provide a more thorough description of where your method fits with respect to published work and how the method itself works. More specifically, we recommend that you implement the following changes:</p><p>– Improve the introduction to more accurately reflect previous work done to study behavior in worms and rodents over long durations.</p><p>– Provide additional information about the training process of the neural network used to track larvae. Please ensure that the method is reproducible and customizable by other labs.</p><p>– Discuss the implications of physical perturbations during the picking and transportation of an animal. These perturbations are likely to affect subsequent behavior, which might preclude the study of prolonged free-moving exploration. These limitations should be discussed in the manuscript.</p><p>– Comment on the ability of the tracker to maintain the identity of single larvae over prolonged periods of time.</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>Introduction:</p><p>43: More focus is needed for clarification. What is the problem you are trying to solve? It is very much larva-specific but that is not clear at all from the introduction. Both the aim of the work and the relative background in the literature can be defined in greater detail. High throughput analysis of behavior, in general, is possible and not prohibitive at all. Examples are the <italic>Drosophila</italic> activity monitors (commercial) and the ethoscope (open source). Both are able to record the activity of adult animals throughout their lifespan, in high throughput.</p><p>87: There is an issue here with how you define exploration. Picking an animal from the border of an arena to place it back in the center is not a way to prolong exploration. It's certainly a way to prolong crawling behaviour but not necessarily exploration. You are basically mimicking a conveyor belt here: it can certainly be useful but I don't think it has much to do with exploration. In fact, it would be important to think of this concept in ecological terms and ask: for how long will a larva crawl/explore its natural environment? Will a larva in an apple crawl continuously for 30 hours, as it does in this device?</p><p>315: I suppose you refer to <italic>melanogaster</italic> only, or do you mean all <italic>Drosophila</italic> species?</p><p>Figure 1: I don't think the concept exposed in E is so difficult to require illustrations. F is really difficult to understand and thus not informative. Perhaps replace it with a supplementary video of the picking process?</p><p>Figure 5: Not clear how to interpret this figure. What are the dashed and continuous lines? What does the P*** refer to? You refer to a &quot;clear increase in navigation index&quot; but this is not clear by looking at the figure.</p><p>Figure 6: I am afraid I do not understand the reasoning behind this experiment. This would really benefit from a clearer and more accessible explanation, in terms of aims and methods.</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>My only comment to the authors is that it would nice to see additional paths in the very long duration recordings. Are some larvae right-handed while others are predominantly left-handed?</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>– I don't think Figure 1A is cited in the text.</p><p>– Line 185: How long are the occlusions by the robot arm and how far does a typical larva move (perhaps as a fraction of body length) during the occlusions?</p><p>– Line 326: Is &quot;navigational effectiveness&quot; a standard term? If not, I wonder if a better term might be something like navigational cosine? The reason I ask is that if a larva has reached a desired temperature in a gradient then the &quot;effective&quot; thing to do might be to stop moving or move orthogonally to the gradient which would have a Navigational Effectiveness of 0.</p><p>– Line 343: include details of statistical test.</p><p>Suggestions for improvement:</p><p>– Include lines on the time series in Figure 4 to show the picking times.</p><p>– In general, the data in Figure 4 is tantalizing, but because it's based on a single observation we can't rule out the increase in speed later in the recording isn't due to chance or some environmental change in the room. The most interesting thing would be to include some more data, but if that's not possible, including some more discussion of possible causes (including those that don't have anything to do with larval biology) in the text might help.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.86585.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>The reviewers appreciate the qualities and future impact of the method you have developed to study the long-term behavior of <italic>Drosophila</italic> larvae. The observation of a bimodal distribution in the navigation index of single larvae highlights that mean behaviors measured over short observation times can mask diversity in the behaviors of individual animals. You provide strong evidence that your system will be useful to other laboratories interested in prolonged recording of larval activity. However, several weaknesses of the manuscript should be addressed prior to its publication. The revision does not require the collection of additional data. Generally, you should provide a more thorough description of where your method fits with respect to published work and how the method itself works. More specifically, we recommend that you implement the following changes:</p><p>– Improve the introduction to more accurately reflect previous work done to study behavior in worms and rodents over long durations.</p></disp-quote><p>The Introduction section has been significantly reworked, to better explain how our work fits into the context of studies in other organisms, and highlighting what makes our project unique – both because of the animal we use and because we create an environment of prolonged free exploration, and we make more sound arguments for why this is important. See in particular the second paragraph of the introduction (all new) and a heavily changed fourth paragraph.</p><disp-quote content-type="editor-comment"><p>– Provide additional information about the training process of the neural network used to track larvae. Please ensure that the method is reproducible and customizable by other labs.</p></disp-quote><p>We have added a new section in Materials and methods devoted to our analysis pipeline, providing details for position tracking, posture analysis, and behavioral classification (1-1.5 new pages total). As noted in the previous submission, all code for the manuscript will be provided to any reader, hosted on GitHub.</p><disp-quote content-type="editor-comment"><p>– Discuss the implications of physical perturbations during the picking and transportation of an animal. These perturbations are likely to affect subsequent behavior, which might preclude the study of prolonged free-moving exploration. These limitations should be discussed in the manuscript.</p></disp-quote><p>We have expanded the Discussion section of the manuscript to include a more direct discussion of the limitations imposed by the robot arm pick-ups/drop-offs and external environmental conditions. We enumerate a few reasons why we believe the perturbations’ effects will be minimal, but also openly state that we do not have sufficient information to claim that physical perturbations are not important. Most of the new text is found in the 6<sup>th</sup> and 7<sup>th</sup> paragraphs of Discussion.</p><disp-quote content-type="editor-comment"><p>– Comment on the ability of the tracker to maintain the identity of single larvae over prolonged periods of time.</p></disp-quote><p>We now discuss this in detail in the Materials and methods section (last two paragraphs of the Position Tracking sub-section). We describe how identity is maintained, and also provide quantitative measures of collision rates between larvae and the overall accuracy of identity maintenance after collisions.</p><disp-quote content-type="editor-comment"><p>Reviewer #1 (Recommendations for the authors):</p><p>Introduction:</p><p>43: More focus is needed for clarification. What is the problem you are trying to solve? It is very much larva-specific but that is not clear at all from the introduction. Both the aim of the work and the relative background in the literature can be defined in greater detail. High throughput analysis of behavior, in general, is possible and not prohibitive at all. Examples are the <italic>Drosophila</italic> activity monitors (commercial) and the ethoscope (open source). Both are able to record the activity of adult animals throughout their lifespan, in high throughput.</p></disp-quote><p>This is absolutely right, the introduction to our work needed to be placed in a much broader context that included other organisms and prior work over long time scales. We have rewritten our Introduction (2<sup>nd</sup> paragraph in particular), looking at adult flies, worms, mice, and rats. We have also tried to make it much more clear that our primary goal is to (1) measure larva behavior over extended periods, which has its own unique challenges as any animal does, and also (2) measure long term behavior in a non-confined space, to observe what happens to search and navigation strategies on previously unseen time scales.</p><disp-quote content-type="editor-comment"><p>87: There is an issue here with how you define exploration. Picking an animal from the border of an arena to place it back in the center is not a way to prolong exploration. It's certainly a way to prolong crawling behaviour but not necessarily exploration. You are basically mimicking a conveyor belt here: it can certainly be useful but I don't think it has much to do with exploration. In fact, it would be important to think of this concept in ecological terms and ask: for how long will a larva crawl/explore its natural environment? Will a larva in an apple crawl continuously for 30 hours, as it does in this device?</p></disp-quote><p>This is a very good point also. We were loosely conflating searching and exploration. Throughout the manuscript text we have changed every reference to exploration to either “search” or “exploratory search” and clarified the terms better. We also suggested why, for larvae in particular, their motion could be thought of as exploratory even when traversing the same space repeatedly (as far as we know they do not form spatial maps of their environment and their non-associative memories are very short). But we agree the term suggests something rather different and have adjusted accordingly.</p><disp-quote content-type="editor-comment"><p>315: I suppose you refer to melanogaster only, or do you mean all <italic>Drosophila</italic> species?</p></disp-quote><p>We meant <italic>Drosophila melanogaster</italic> only, and have made this explicit at the beginning of the manuscript. Thank you.</p><disp-quote content-type="editor-comment"><p>Figure 1: I don't think the concept exposed in E is so difficult to require illustrations. F is really difficult to understand and thus not informative. Perhaps replace it with a supplementary video of the picking process?</p></disp-quote><p>We do prefer to keep panel E if that is acceptable. We agree about F, which we are leaving in place but with a new supplemental video of the picking process, as you suggest. The video shows the robot arm picking up three larva from the edge of the arena and placing them in the center.</p><disp-quote content-type="editor-comment"><p>Figure 5: Not clear how to interpret this figure. What are the dashed and continuous lines? What does the P*** refer to? You refer to a &quot;clear increase in navigation index&quot; but this is not clear by looking at the figure.</p></disp-quote><p>Thank you for pointing this out. The caption to Figure 5 has been updated to define the dashed and solid lines. The solid line marks 0 (no net navigation), and the dashed lines are the average values of navigation index throughout the 6-hour experiments. The p-value refers to the difference in navigation index between the control (no thermal gradient, purple) and thermotaxis behavior (0.035 C/mm gradient, red).</p><disp-quote content-type="editor-comment"><p>Figure 6: I am afraid I do not understand the reasoning behind this experiment. This would really benefit from a clearer and more accessible explanation, in terms of aims and methods.</p></disp-quote><p>We have rewritten the text of the “Navigation efficiency of individuals exhibits distinct behavioral phenotypes” subsection in the Results section, and also the caption of Figure 6 for clarity, in addition to expanded writing in the Discussion section. The short version is that the thermotaxis behavior of individual crawlers approximately falls into two categories of neutral and strong crawlers (bimodal distribution), but this phenomenon was masked in past research because analysis focused on population averages and the experiments were too short. With our individual-focused and long-term experiments we were able to see this phenomenon more clearly.</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>My only comment to the authors is that it would nice to see additional paths in the very long duration recordings. Are some larvae right-handed while others are predominantly left-handed?</p></disp-quote><p>Additional videos with the 30+ hour time frame are not doable at present, although we are making changes to the system to allow for many more of these in the future. The handedness question is a really good one – the short answer is yes, individual animals exhibit handedness, in the sense that the distribution of handedness is wider than the binomial distribution for the sample size (this is also true in previously published work in adult flies). But complications (persistence of handedness, handedness during crawling vs. during turns) make the question a bit beyond the scope of this manuscript. We do plan to write a new paper entirely about handedness though!</p><disp-quote content-type="editor-comment"><p>Reviewer #3 (Recommendations for the authors):</p><p>– I don't think Figure 1A is cited in the text.</p></disp-quote><p>Fixed, thank you. It is now cited in the 4<sup>th</sup> paragraph of the Introduction.</p><disp-quote content-type="editor-comment"><p>– Line 185: How long are the occlusions by the robot arm and how far does a typical larva move (perhaps as a fraction of body length) during the occlusions?</p></disp-quote><p>This information is now provided in the Analysis Pipeline subsection of Materials and methods. It’s around 4.5 seconds of occlusion, which translates to a sufficiently small fraction of body length traveled, such that interpolating the crawling trajectories during dropped frames works well.</p><disp-quote content-type="editor-comment"><p>– Line 326: Is &quot;navigational effectiveness&quot; a standard term? If not, I wonder if a better term might be something like navigational cosine? The reason I ask is that if a larva has reached a desired temperature in a gradient then the &quot;effective&quot; thing to do might be to stop moving or move orthogonally to the gradient which would have a Navigational Effectiveness of 0.</p></disp-quote><p>We have rewritten effectiveness as “navigational efficiency,” which is a bit more accurate, describing how close to “straight line in the +x direction” navigation gets. Using &lt;v_x&gt;/&lt;v&gt; as the metric is consistent with the literature of larva crawling behavior. We like navigational cosine too (I describe it that way in talks sometimes), but will stay with the standard here if that is acceptable. It’s a good point about temperature gradients too, which is why in these experiments we always return animals to the center so they do not dwell at their desired temperature or edge of the arena – we mention this now in our justification for the pick-up/drop-off approach to extended experiments in the Introduction.</p><disp-quote content-type="editor-comment"><p>– Line 343: include details of statistical test.</p></disp-quote><p>Fixed, thank you.</p><disp-quote content-type="editor-comment"><p>Suggestions for improvement:</p><p>– Include lines on the time series in Figure 4 to show the picking times.</p></disp-quote><p>Also added, thank you.</p><disp-quote content-type="editor-comment"><p>– In general, the data in Figure 4 is tantalizing, but because it's based on a single observation we can't rule out the increase in speed later in the recording isn't due to chance or some environmental change in the room. The most interesting thing would be to include some more data, but if that's not possible, including some more discussion of possible causes (including those that don't have anything to do with larval biology) in the text might help.</p></disp-quote><p>Additional experiments of this length are not doable at the moment, but there should be many more to come! We have added substantially to the Discussion section to talk about limitations of the experiments and changes in the surrounding laboratory environment. We don’t want to speculate too much with N=1 in this type of experiment.</p></body></sub-article></article>