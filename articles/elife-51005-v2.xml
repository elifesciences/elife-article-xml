<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">51005</article-id><article-id pub-id-type="doi">10.7554/eLife.51005</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Can sleep protect memories from catastrophic forgetting?</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" id="author-171760"><name><surname>González</surname><given-names>Oscar C</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1302-1911</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-171761"><name><surname>Sokolov</surname><given-names>Yury</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4590-3321</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-171762"><name><surname>Krishnan</surname><given-names>Giri P</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-3931-7633</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-171765"><name><surname>Delanois</surname><given-names>Jean Erik</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-8680-3239</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-14811"><name><surname>Bazhenov</surname><given-names>Maxim</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1936-0570</contrib-id><email>mbazhenov@ucsd.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>Department of Medicine, University of California, San Diego</institution><addr-line><named-content content-type="city">San Diego</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution>Department of Computer Science and Engineering, University of California, San Diego</institution><addr-line><named-content content-type="city">San Diego</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>van Rossum</surname><given-names>Mark CW</given-names></name><role>Reviewing Editor</role><aff><institution>University of Nottingham</institution><country>United Kingdom</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Colgin</surname><given-names>Laura L</given-names></name><role>Senior Editor</role><aff><institution>University of Texas at Austin</institution><country>United States</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>04</day><month>08</month><year>2020</year></pub-date><pub-date pub-type="collection"><year>2020</year></pub-date><volume>9</volume><elocation-id>e51005</elocation-id><history><date date-type="received" iso-8601-date="2020-01-19"><day>19</day><month>01</month><year>2020</year></date><date date-type="accepted" iso-8601-date="2020-07-19"><day>19</day><month>07</month><year>2020</year></date></history><permissions><copyright-statement>© 2020, González et al</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>González et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-51005-v2.pdf"/><abstract><p>Continual learning remains an unsolved problem in artificial neural networks. The brain has evolved mechanisms to prevent catastrophic forgetting of old knowledge during new training. Building upon data suggesting the importance of sleep in learning and memory, we tested a hypothesis that sleep protects old memories from being forgotten after new learning. In the thalamocortical model, training a new memory interfered with previously learned old memories leading to degradation and forgetting of the old memory traces. Simulating sleep after new learning reversed the damage and enhanced old and new memories. We found that when a new memory competed for previously allocated neuronal/synaptic resources, sleep replay changed the synaptic footprint of the old memory to allow overlapping neuronal populations to store multiple memories. Our study predicts that memory storage is dynamic, and sleep enables continual learning by combining consolidation of new memory traces with reconsolidation of old memory traces to minimize interference.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>sleep</kwd><kwd>memory consolidation</kwd><kwd>continual learning</kwd><kwd>neural network</kwd><kwd>catastrophic forgetting</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000185</institution-id><institution>Defense Advanced Research Projects Agency</institution></institution-wrap></funding-source><award-id>HR0011-18-2-0021</award-id><principal-award-recipient><name><surname>Bazhenov</surname><given-names>Maxim</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000006</institution-id><institution>Office of Naval Research</institution></institution-wrap></funding-source><award-id>MURI: N00014-16-1-2829</award-id><principal-award-recipient><name><surname>Bazhenov</surname><given-names>Maxim</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Computational modeling predicts that sleep replay plays a protective role against catastrophic forgetting by revealing synaptic mechanisms allowing overlapping populations of neurons to store multiple interfering memories.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Animals and humans are capable of continuous, sequential learning. In contrast, modern artificial neural networks suffer from the inability to perform continual learning (<xref ref-type="bibr" rid="bib51">Ratcliff, 1990</xref>; <xref ref-type="bibr" rid="bib11">French, 1999</xref>; <xref ref-type="bibr" rid="bib16">Hassabis et al., 2017</xref>; <xref ref-type="bibr" rid="bib17">Hasselmo, 2017</xref>; <xref ref-type="bibr" rid="bib21">Kirkpatrick et al., 2017</xref>). Training a new task results in interference and catastrophic forgetting of old memories (<xref ref-type="bibr" rid="bib51">Ratcliff, 1990</xref>; <xref ref-type="bibr" rid="bib32">McClelland et al., 1995</xref>; <xref ref-type="bibr" rid="bib11">French, 1999</xref>; <xref ref-type="bibr" rid="bib17">Hasselmo, 2017</xref>). Several attempts have been made to overcome this problem including (a) explicit retraining of all previously learned memories – interleaved training (<xref ref-type="bibr" rid="bib17">Hasselmo, 2017</xref>), (b) using generative models to reactivate previous inputs (<xref ref-type="bibr" rid="bib20">Kemker and Kanan, 2017</xref>), or (c) artificially ‘freezing’ subsets of synapses important for the old memories (<xref ref-type="bibr" rid="bib21">Kirkpatrick et al., 2017</xref>). These solutions help prevent new memories from interfering with previously stored old memories, however they either require explicit retraining of all past memories using the original data or have limitations on the types of trainable new memories and network architectures (<xref ref-type="bibr" rid="bib20">Kemker and Kanan, 2017</xref>). How biological systems avoid catastrophic forgetting remains to be understood. In this paper, we propose a mechanism for how sleep modifies network synaptic connectivity to minimize interference of competing memory traces enabling continual learning.</p><p>Sleep has been suggested to play an important role in learning and memory (<xref ref-type="bibr" rid="bib47">Paller and Voss, 2004</xref>; <xref ref-type="bibr" rid="bib70">Walker and Stickgold, 2004</xref>; <xref ref-type="bibr" rid="bib45">Oudiette et al., 2013</xref>; <xref ref-type="bibr" rid="bib50">Rasch and Born, 2013</xref>; <xref ref-type="bibr" rid="bib62">Stickgold, 2013</xref>; <xref ref-type="bibr" rid="bib74">Weigenand et al., 2016</xref>; <xref ref-type="bibr" rid="bib72">Wei et al., 2018</xref>). Specifically, the role of stage 2 (N2) and stage 3 (N3) of Non-Rapid Eye Movement (NREM) sleep has been shown to help with the consolidation of newly encoded memories (<xref ref-type="bibr" rid="bib47">Paller and Voss, 2004</xref>; <xref ref-type="bibr" rid="bib70">Walker and Stickgold, 2004</xref>; <xref ref-type="bibr" rid="bib50">Rasch and Born, 2013</xref>; <xref ref-type="bibr" rid="bib62">Stickgold, 2013</xref>). The mechanism by which memory consolidation is influenced by sleep is still debated, however, a number of hypotheses have been put forward. Sleep may enable memory consolidation through repeated reactivation or <italic>replay</italic> of specific memory traces during characteristic sleep rhythms such as spindles and slow oscillations (<xref ref-type="bibr" rid="bib47">Paller and Voss, 2004</xref>; <xref ref-type="bibr" rid="bib5">Clemens et al., 2005</xref>; <xref ref-type="bibr" rid="bib31">Marshall et al., 2006</xref>; <xref ref-type="bibr" rid="bib45">Oudiette et al., 2013</xref>; <xref ref-type="bibr" rid="bib50">Rasch and Born, 2013</xref>; <xref ref-type="bibr" rid="bib74">Weigenand et al., 2016</xref>; <xref ref-type="bibr" rid="bib25">Ladenbauer et al., 2017</xref>; <xref ref-type="bibr" rid="bib72">Wei et al., 2018</xref>; <xref ref-type="bibr" rid="bib77">Xu et al., 2019</xref>). Memory replay during NREM sleep could help strengthen previously stored memories and map memory traces between brain structures. Previous work using electrical (<xref ref-type="bibr" rid="bib30">Marshall et al., 2004</xref>; <xref ref-type="bibr" rid="bib31">Marshall et al., 2006</xref>; <xref ref-type="bibr" rid="bib25">Ladenbauer et al., 2017</xref>) or auditory (<xref ref-type="bibr" rid="bib41">Ngo et al., 2013</xref>) stimulation showed that increasing neocortical oscillations during NREM sleep resulted in improved consolidation of declarative memories. Similarly, spatial memory consolidation has been shown to improve following cued reactivation of memory traces during NREM sleep (<xref ref-type="bibr" rid="bib47">Paller and Voss, 2004</xref>; <xref ref-type="bibr" rid="bib45">Oudiette et al., 2013</xref>; <xref ref-type="bibr" rid="bib46">Oudiette and Paller, 2013</xref>; <xref ref-type="bibr" rid="bib48">Papalambros et al., 2017</xref>). Our recent computational studies found that sleep dynamics can lead to replay and strengthening of recently learned memory traces (<xref ref-type="bibr" rid="bib71">Wei et al., 2016</xref>; <xref ref-type="bibr" rid="bib72">Wei et al., 2018</xref>; <xref ref-type="bibr" rid="bib73">Wei et al., 2020</xref>). These studies point to the critical role of sleep in memory consolidation.</p><p>Can neuroscience inspired ideas help solve the catastrophic forgetting problem in artificial neuronal networks? The most common machine learning training algorithm – backpropagation (<xref ref-type="bibr" rid="bib54">Rumelhart et al., 1986</xref>; <xref ref-type="bibr" rid="bib75">Werbos, 1990</xref>; <xref ref-type="bibr" rid="bib22">Kriegeskorte, 2015</xref>) – is very different from plasticity rules utilized by brain networks. Nevertheless, we have recently seen a number of successful attempts to implement high level principles of biological learning in artificial network designs, including implementation of the ideas from ‘Complementary Learning System Theory’ (<xref ref-type="bibr" rid="bib32">McClelland et al., 1995</xref>), according to which the hippocampus is responsible for the fast acquisition of new information, while the neocortex would more gradually learn a generalized and distributed representation. These ideas led to interesting attempts of solving the catastrophic forgetting problem in artificial neural networks (<xref ref-type="bibr" rid="bib20">Kemker and Kanan, 2017</xref>). While few attempts have been made to implement sleep in artificial networks, one study suggested that sleep-like activity can increase storage capacity in artificial networks (<xref ref-type="bibr" rid="bib8">Fachechi et al., 2019</xref>). We recently found that implementation of a sleep-like phase in artificial networks trained using backpropagation can dramatically reduce catastrophic forgetting, as well as improve generalization performance and transfer of knowledge (<xref ref-type="bibr" rid="bib24">Krishnan et al., 2019</xref>). However, despite this progress, we are still lacking a basic understanding of the mechanisms by which sleep replay affects memories, especially when new learning interferes with old knowledge.</p><p>The ability to store and retrieve sequentially related information is arguably the foundation of intelligent behavior. It allows us to predict the outcomes of sensory situations, to achieve goals by generating sequences of motor actions, to ‘mentally’ explore the possible outcomes of different navigational or motor choices, and ultimately to communicate through complex verbal sequences generated by flexibly chaining simpler elemental sequences learned in childhood. In our new study, we trained a network, capable of transitioning between sleep-like and wake-like states, to learn spike sequences in order to identify mechanisms by which sleep allows consolidation of newly encoded memory sequences and prevents damage to old memories. Our study predicts that during a period of sleep, following training of a new memory sequence in awake, both old and new memory traces are spontaneously replayed, preventing forgetting and increasing recall performance. We found that sleep replay results in fine tuning of the synaptic connectivity matrix encoding the interfering memory sequences to allow overlapping populations of neurons to store multiple competing memories.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>The network model, used in our study, represents a minimal thalamocortical architecture implementing one cortical layer (consisting of excitatory pyramidal (PY) and inhibitory (IN) neurons) and one thalamic layer (consisting of excitatory thalamic relay (TC) and inhibitory reticular thalamic (RE) neurons) – with all neurons simulated by Hodgkin-Huxley models (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). These models were built upon neuron models we used in our earlier work (<xref ref-type="bibr" rid="bib23">Krishnan et al., 2016</xref>; <xref ref-type="bibr" rid="bib71">Wei et al., 2016</xref>; <xref ref-type="bibr" rid="bib72">Wei et al., 2018</xref>). This model exhibits two primary dynamical states of the thalamocortical system – awake, characterized by random asynchronous firing of all cortical neurons, and slow-wave sleep (SWS), characterized by slow (&lt;1 Hz) oscillations between Up (active) and Down (silent) states (<xref ref-type="bibr" rid="bib3">Blake and Gerard, 1937</xref>; <xref ref-type="bibr" rid="bib60">Steriade et al., 1993</xref>; <xref ref-type="bibr" rid="bib61">Steriade et al., 2001</xref>). Transitions between sleep and awake (<xref ref-type="fig" rid="fig1">Figure 1B/C</xref>) were simulated by changing network parameters to model effect of neuromodulators (<xref ref-type="bibr" rid="bib23">Krishnan et al., 2016</xref>). While the thalamic population was part of the network, its role was limited to help simulate realistic Up and Down state activity (<xref ref-type="bibr" rid="bib2">Bazhenov et al., 2002</xref>), as all synaptic changes occurred in the cortical population. The initial strength of the synaptic connections between cortical PY neurons was Gaussian distributed (<xref ref-type="fig" rid="fig1">Figure 1D</xref>).</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Network architecture and baseline dynamics.</title><p>(<bold>A</bold>) Basic network architecture (PY: excitatory pyramidal neurons; IN: inhibitory interneurons; TC: excitatory thalamocortical neurons; RE: inhibitory thalamic reticular neurons). Excitatory synapses are represented by lines terminating in a dot, while inhibitory synapses are represented by lines terminating in bars. Arrows indicate the direction of the connection. (<bold>B</bold>) Behavior of a control network exhibiting wake-sleep transitions. Cortical PY neurons are shown. Color represents the voltage of a neuron at a given time during the simulation (dark blue – hyperpolarized potential; light blue / yellow – depolarized potential; red - spike). (<bold>C</bold>) Zoom-in of a subset of neurons from the network in B (time is indicated by arrows). Left and right panels show spontaneous activity during awake-like state before and after sleep, respectively. Middle panel shows example of activity during sleep. (<bold>D</bold>) Left panel shows the initial weighted adjacency matrix for the network in B. The color in this plot represents the strength of the AMPA connections between PY neurons, with white indicating the lack of synaptic connection. Right panel shows the initial weighted adjacency matrix for the subregion indicated on the left.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51005-fig1-v2.tif"/></fig><p>We set probabilistic connectivity (p=0.6) between excitatory cortical neurons within a defined radius (R<sub>AMPA(PY-PY)</sub>=20). Only cortical PY-PY connections were plastic and regulated by spike-timing dependent plasticity (STDP). During initial training, STDP was biased for potentiation to simulate elevated levels of acetylcholine (<xref ref-type="bibr" rid="bib4">Blokland, 1995</xref>; <xref ref-type="bibr" rid="bib56">Shinoe et al., 2005</xref>; <xref ref-type="bibr" rid="bib63">Sugisaki et al., 2016</xref>). During testing/retrieval, STDP was balanced (LTD/LTP = 1). STDP remained balanced during both sleep and interleaved training (except for few selected simulations where we tested effect of unbalancing STDP) to allow side by side comparisons. For details, please see <italic>Methods and Materials</italic>.</p><p>Temporally structured sequences of events are a common type of information we learn, and they are believed to be represented in the brain by sequences of neuronal firing. Therefore, in this study we represent each memory pattern as an ordered sequence, S, of activations of populations of cortical neurons (e.g., A→B→…), where each ‘letter’ (e.g., A) labels a population of neurons, so each memory could be labeled by a unique ‘word’ of such ‘letters’. We considered memory patterns represented by non-overlapping populations of neurons as well as memory patterns sharing neurons but with a different activation order, for example, A→B→C vs. C→B→A. This setup can mimic, for example, <italic>in vivo</italic> experiments with a rat learning a track, including: (a) running in one direction on a linear track (<xref ref-type="bibr" rid="bib38">Mehta et al., 1997</xref>) would be equivalent to a sequence training (‘A→B→C’, 'A→B→C’,…); (b) forwards and backwards running on a linear track (<xref ref-type="bibr" rid="bib40">Navratilova et al., 2012</xref>) would be equivalent to interleaved sequences training (‘A→B→C’, 'C→B→A’, 'A→B→C’,…); (c) running on a belt track first only in one direction and then in reverse one (e.g., using Virtual Reality (VR) apparatus) would be equivalent to first learning a sequence (‘A→B→C’, 'A→B→C’,…) and then the opposite one (‘C→B→A’, 'C→B→A’,…).</p><p>In our model, training always occurred in the awake state and no input was delivered to the network in the sleep state. Testing was also done in the awake state; during test sessions, the model was only presented with input to the first group (e.g., A) to test for pattern completion for the trained sequence (e.g., A→B→C→…). Performance was calculated based on the distance between the trained pattern (template) and the response during testing. The awake state included multiple testing sessions: before training, after training/before sleep, and after sleep. For details, please see <italic>Methods and Materials</italic>.</p><p>The paper is organized as follows. We first consider the scenario of two memory sequences trained at different (non-overlapping) network locations. We show that SWS-like activity after training leads to sequence replay, synaptic weight changes, and performance increases during testing after sleep. Next, we focus on the case of two sequences trained in opposite directions over the same population of neurons. We show that in such a case training a new sequence in awake would ‘erase’ an old memory. However, if a sleep phase is implemented before complete destruction of the old memory, both memory sequences are spontaneously replayed during sleep. As a result of replay, each sequence allocates its own subset of neurons/synapses, and performance increases for both sequences during testing after sleep. We complete the study with a detailed analysis of synaptic weight changes and replay dynamics during the sleep state to identify mechanisms of memory consolidation and performance increase. In supplementary figures, we compare sleep replay with interleaved training and show that sleep achieves similar or better performance but without explicit access to the training data.</p><sec id="s2-1"><title>Training of spatially separated memory sequences does not lead to interference</title><p>First, we trained two memory patterns, S1 and S2, sequentially (first S1 and then S2) in spatially distinct regions of the network as shown in <xref ref-type="fig" rid="fig2">Figure 2A</xref>. Each memory sequence was represented by the spatio-temporal pattern of 5 sequentially activated groups of 10 neurons per group. A 5 ms delay was included between stimulations of subsequent groups within a sequence. S1 was trained in the population of cortical neurons 200–249 (<xref ref-type="fig" rid="fig2">Figure 2B</xref>, top). Training S1 resulted in an increase of synaptic weights between participating neurons (<xref ref-type="fig" rid="fig2">Figure 2D</xref>, left) and an increase in performance on sequence completion (<xref ref-type="fig" rid="fig2">Figure 2B/C</xref>, top). When the strength of the synapses in the direction of S1 increased, synapses in the opposite direction showed a reduction consistent with the STDP rule (see <italic>Methods and Materials</italic>). The second sequence, S2, was trained for an equal amount of time as S1 but in a different population of neurons 350–399 (W-V-X-Y-Z, <xref ref-type="fig" rid="fig2">Figure 2B</xref>, bottom). Training of S2 also resulted in synaptic weight changes (<xref ref-type="fig" rid="fig2">Figure 2D</xref>, middle) and improvement in performance (<xref ref-type="fig" rid="fig2">Figure 2B/C</xref>, bottom). Importantly, training of S2 did not interfere with the weight changes encoding S1 because both sequences involved spatially distinct populations of neurons (compare <xref ref-type="fig" rid="fig2">Figure 2D</xref>, left and middle). It should be noted that though testing resulted in reactivation of memory traces, there was little change in synaptic weights during testing periods because of a relatively small number of pre/post spike events. (Simulations where STDP was explicitly turned off during all testing periods exhibited similar results to those presented here.)</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Two spatially separated memory sequences show no interference during training and both are strengthened by subsequent sleep.</title><p>(<bold>A</bold>) Network activity during periods of testing (T), training of two spatially separated memory sequences (S1/S2), and sleep (N3). Cortical PY neurons are shown. Color indicates voltage of neurons at a given time. (<bold>B</bold>) Left panels show an example of training sequence 1 (S1, top) and sequence 2 (S2, bottom). Middle panels show examples of testing both sequences prior to sleep. Right panels show examples of testing after sleep. Note, after sleep, both sequences show better completion. (<bold>C</bold>) Performance of S1 and S2 completion before any training (baseline), after S1 training, after S2 training, and after sleep (red). (<bold>D</bold>) Synaptic weight matrices show changes of synaptic weights in the regions trained for S1 and S2. Left panel shows weights after training S1; middle panel shows weights after training S2; right panel shows weights after sleep. Color indicates strength of AMPA synaptic connections. (<bold>E</bold>) Distributions of the net sum of synaptic weights each neuron receives from all the neurons belonging to its left neighboring group (S1 direction) vs its right neighboring group (opposite direction, defined as S1* direction below) within a trained region at baseline (left), after S1 training (middle) and after sleep (right). (<bold>F</bold>) Synaptic weight-based directionality index before/after training (gray bars) and after sleep (red bar).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51005-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Sleep replay improves performance for complex non-linear sequences.</title><p>(<bold>A</bold>) Example of the training protocol used for training a long non-linear sequence - BACEDFHGIJ. (<bold>B</bold>) Average group activations during baseline testing (left), after sequence training (middle), and after sleep (right). Top panels show average group firing rates during testing periods. Letters above each line indicate the group in the sequence. Sleep results in increase of the firing rates (higher peaks) and sharpening of the response times (narrower distribution) as compared to &quot;before sleep&quot;. Bottom panels show normalized average group responses during testing periods. Sleep leads to an improvement and tuning of the responses such that testing after sleep results in the correct ordering of group activations and faster completion of the sequence. (<bold>C</bold>) Synaptic weight matrices in the trained region of the network before (left) and after (right) sleep. Color indicates synaptic strength. (<bold>D</bold>) Performance of the sequence completion at baseline, after training, and after sleep (red).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51005-fig2-figsupp1-v2.tif"/></fig></fig-group><p>We next calculated the net sum of synaptic weights each neuron received from all neurons belonging to its left vs right neighboring populations (e.g., total input to a neuron B<sub>i</sub>, belonging to group B, that it received from all the neurons in group A vs all the neurons in group C) and we analyzed the difference of these net weights. The initial distribution was symmetric reflecting the initial state of the network (<xref ref-type="fig" rid="fig2">Figure 2E</xref>, left). After training, it became asymmetric, indicating stronger input from the left groups (i.e., total input to B<sub>i</sub> from all the neurons in group A was larger than that from all the neurons in group C) (<xref ref-type="fig" rid="fig2">Figure 2E</xref>, middle). These results are consistent with <italic>in vivo</italic> recordings from a rat running in one direction on a linear track (<xref ref-type="bibr" rid="bib38">Mehta et al., 1997</xref>), where this phenomenon was called ‘receptive field backwards expansion’, i.e., neurons representing locations along the track became asymmetrically coupled such that activity in one group of neurons (one location) led to activation of the next group of neurons (new location) even before the corresponding input occurred (before the animal moved to the new location).</p><p>After successful training of both sequences, the network went through a period of sleep (N3 in <xref ref-type="fig" rid="fig2">Figure 2A</xref>) when no stimulation was applied. After sleep, synaptic weights for both memory sequences revealed strong increases in the direction of their respective activation patterns and further decreases in the opposing directions (<xref ref-type="fig" rid="fig2">Figure 2D</xref>, right). In line with our previous work (<xref ref-type="bibr" rid="bib72">Wei et al., 2018</xref>), these changes were a result of sequence replay during the Up states of slow oscillation (see next section for details). Synaptic strengthening increased the performance on sequence completion after sleep (<xref ref-type="fig" rid="fig2">Figure 2B</xref>, right; 2C, red bar). Analysis of the net synaptic input to each neuron from its left vs right neighboring groups, revealed further shift of the synaptic weight distribution (<xref ref-type="fig" rid="fig2">Figure 2E</xref>, right). This predicts that SWS following linear track training would lead to further receptive field backwards expansion in the cortical neurons. To quantify this asymmetry we calculated a ‘directionality index’, <italic>I</italic>, for synaptic weights (similar to <xref ref-type="bibr" rid="bib40">Navratilova et al., 2012</xref> but using synaptic weights), based on synaptic input to each neuron from its left vs right neighboring populations (<italic>‘Directionality Index’=0</italic> if all the neurons receive the same input from its left vs right neighboring groups and <italic>‘Directionality Index’=1</italic> if all the neurons receive input from one ‘side’ only; see <italic>Methods and Materials</italic> for details). This analysis showed an increase in the directionality index from naive to trained cortical networks and further increase after sleep (<xref ref-type="fig" rid="fig2">Figure 2F</xref>). Note, that the backwards expansion of the place fields was reset between sessions in CA1 (<xref ref-type="bibr" rid="bib38">Mehta et al., 1997</xref>), but not in CA3 (<xref ref-type="bibr" rid="bib52">Roth et al., 2012</xref>), where the backward shift gradually diminished across days, possibly as memories became hippocampus independent (see <italic>Discussion</italic>).</p><p>The goal of this study was to reveal basic mechanisms of replay and therefore we focus on the ‘simple’ linear (e.g., S1) memory sequences. Our results, however, can be generalized to much more complex non-linear sequences (see <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). In simulations from <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>, training a sequence in awake was not long enough to ensure reliable pattern completion, however, performance was significantly improved after replay during SWS.</p></sec><sec id="s2-2"><title>Sleep replay improves pattern completion performance for memory sequencies</title><p>Why do SWS dynamics lead to improvement in memory performance? The hypothesis is that memory patterns trained in awake are spontaneously replayed during sleep. With this in mind, we next analyzed the network firing patterns during Up states of the slow oscillation to identify replay. We focused our analysis on pairs of neurons (as opposed to the longer sequences) because (a) having different elementary units of a sequence (neuronal pairs) replayed independently would still be sufficient to strengthen the entire sequence; (b) <italic>in vivo</italic> data suggest that memory sequence replay often involves random subsets of the entire sequence (e.g., <xref ref-type="bibr" rid="bib7">Euston et al., 2007</xref>; <xref ref-type="bibr" rid="bib53">Roumis and Frank, 2015</xref>; <xref ref-type="bibr" rid="bib19">Joo and Frank, 2018</xref>; <xref ref-type="bibr" rid="bib64">Swanson et al., 2020</xref>); (c) we want to compare results in this section to the analysis of the overlapping opposite sequences in the following sections, however, we could not reliably detect replay of the full sequences in the latter case possibly because of highly overlapping spiking between sequences.</p><p>For each synapse in direction S1 (we refer to it below as S1 synapse) and each Up state, we (a) calculated the time delay between nearest pre/post spikes; (b) transformed this time delay through an STDP-like function to obtain a value characterizing its effect on synaptic weight; and (c) calculated the total net effect of all such spike events. This gave us a net weight change for a given synapse during a given Up state. If we observed a net weight increase, we labeled this S1 synapse as being preferentially replayed during a given Up state. Finally, we counted all the Up states where a given synapse was replayed as defined above. This procedure is similar to off-line STDP, however, instead of weight change over entire sleep, we obtained the number of Up states where a synapse in the direction of S1 was (preferentially) replayed.</p><p><xref ref-type="fig" rid="fig3">Figure 3A</xref> shows, for each synapse in the direction of S1, the total change of its synaptic strength across entire sleep (Y-axis) vs number of Up states when that synapse was replayed (X-axis). As expected, it shows a strong positive correlation. Synaptic weight changes became negative when the number of Up states where an S1 synapse was replayed dropped below half of the total number of Up states (blue vertical line in <xref ref-type="fig" rid="fig3">Figure 3A</xref>). In <xref ref-type="fig" rid="fig3">Figure 3B</xref> we plotted only those S1 synapses which were replayed reliably – for more that 66% of all Up states (dotted line in <xref ref-type="fig" rid="fig3">Figure 3A</xref>). We found such synapses between all neuronal groups (gray boxes in <xref ref-type="fig" rid="fig3">Figure 3B</xref>) as well as between neurons within groups.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Sleep replay strengthens synapses to improve memory recall.</title><p>(<bold>A</bold>) Change in synaptic weight over entire sleep period as a function of the number of Up states where a given synapse was replayed. Each star represents a synapse in the direction of S1. Dashed line indicates the threshold (66% of Up states) used to identify synapses that are replayed reliably for analysis in B; purple line indicates the maximum number of Up states; blue line demarcates the 50% mark of the total number of Up states. (<bold>B</bold>) Thresholded connectivity matrix indicating synaptic connections (blue) showing reliable replays in the trained region. Grey boxes highlight between group connections. (<bold>C</bold>) Network's graph showing between group (top) and within group (bottom) connections. Edges shown here are those synapses which revealed reliable replays of S1 as shown in B. Nodes are colored blue if they receive at least one of the synapses identified in panel B.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51005-fig3-v2.tif"/></fig><p>In <xref ref-type="fig" rid="fig3">Figure 3C</xref>, we illustrated all the synapses identified in the analysis in <xref ref-type="fig" rid="fig3">Figure 3B</xref>, that is, synapses that were replayed reliably (in more than 66% of all Up states) in direction of S1. We also colored in blue neurons receiving at least one of these synapses as identified in <xref ref-type="fig" rid="fig3">Figure 3B</xref>. We concluded that there were multiple direct and indirect synaptic pathways connecting the first (A) and last (E) groups of neurons that were replayed reliably during sleep. These synapses increased their strength which explains reliable memory recall during testing after sleep.</p></sec><sec id="s2-3"><title>Sequential training of overlapping memory sequences results in interference</title><p>We next tested whether our network model shows interference during awake when a new sequence (S1*) (<xref ref-type="fig" rid="fig4">Figure 4A</xref>) is trained in the same population of neurons as the earlier old sequence (S1). S1* included the same exact groups of neurons as S1, but the order of activation was reversed, that is, the stimulation order was E-D-C-B-A (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). S2 was once again trained in a spatially distinct region of the network (<xref ref-type="fig" rid="fig4">Figure 4A/B</xref>). Testing for sequence completion was performed immediately after each training period. This protocol can represent two somewhat different training scenarios: (a) two competing memory traces (S1 and S1*) are trained sequentially before sleep; (b) the first (old) memory S1 is trained and then consolidated during sleep followed by training of the second (new) memory S1* followed by another episode of sleep. We explicitly tested both scenarios and they behaved similarly, so in the following we discuss the simpler case of two sequentially trained memories followed by sleep. This setup can simulate <italic>in vivo</italic> experiments with a rat running on a belt in a VR apparatus, first in one direction only (learning S1) and then in the opposite direction (learning S1*). An example of the second scenario is presented in <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref> and discussed below.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Training of overlapping memory sequences results in catastrophic interference.</title><p>(<bold>A</bold>) Network activity (PY neurons) during training and testing periods for three memory sequences in awake-like state. Note, sequence 1 (S1) and sequence 1* (S1*) are trained over the same population of neurons. Color indicates the voltage of the neurons at a given time. (<bold>B</bold>) Examples of sequence training protocol for S1 (left), S2 (middle), and S1* (right). (<bold>C</bold>) Performances for the three sequences at baseline, and after S1, S2 and S1* training. Training of S1* leads to reduction of S1 performance. (<bold>D</bold>) Performance of S1 (black) and S1* (red) as a function of S1* training duration. Note that longer S1* training increases degradation of S1 performance.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51005-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Interleaved training of the old and new memory sequences prevents the old sequence from forgetting and improves performance for both memories.</title><p>(<bold>A</bold>) Network activity during sequential training of memory sequences S1→ S2→ S1* (blue bars) followed by interleaved training of S1/S1* (green bar). (<bold>B</bold>) Example of stimulation protocol used for interleaved training of S1/S1*. (<bold>C</bold>) Testing of S1, S2, and S1* shows increase in performance of S1 and S1* after interleaved training (green). (<bold>D</bold>) Weighted adjacency matrices showing changes after initial sequential training of S1 and S1*, and after interleaved S1/S1* training. (<bold>E</bold>) Distributions of the net sum of synaptic weights each neuron receives from all the neurons belonging to its left vs right neighboring groups within a trained region at baseline (left), after training S1 (middle/left), after training S1* (middle/right), and after interleaved training (right). (<bold>F</bold>) Synaptic weight-based directionality index before/after training both sequences (gray bars) and after interleaved training (green bar).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51005-fig4-figsupp1-v2.tif"/></fig></fig-group><p>In the model, training S1 increased performance of S1 completion (<xref ref-type="fig" rid="fig4">Figure 4C</xref>, top/left). It also led to decrease in performance for S1* below its baseline level in the ‘naive’ network (<xref ref-type="fig" rid="fig4">Figure 4C</xref>, bottom/left). (Note that even a naive network displayed some above zero probability to complete a sequence depending on the initial strength of synapses and spontaneous network activity). Training S2 led to an increase in S2 performance (S1 performance also increased, most-likely due to the random reactivation of S1 in awake). Subsequent training of S1* resulted in both a significant increase in S1* performance and a significant reduction of S1 performance (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). To evaluate the impact of S1* training on S1 performance, we varied the duration of S1* (later memory) training (<xref ref-type="fig" rid="fig4">Figure 4D</xref>). Increasing the duration of S1* training correlated with a reduction of S1 performance up to the point when S1 performance was reduced to its baseline level (<xref ref-type="fig" rid="fig4">Figures 4D</xref> and 400 sec training duration of S1*). This suggests that sequential training of two memories competing for the same population of neurons results in memory interference and catastrophic forgetting of the earlier memory sequence.</p><p>The model predicts that in experiments with a rat running on a belt in a VR apparatus, training the backward direction after training the forward one would ‘erase’ the effect of the forward training. While we are not aware of such experiments, studies done with a rat running forward and backward on a liner track (<xref ref-type="bibr" rid="bib40">Navratilova et al., 2012</xref>), which would be equivalent to interleaved training S1→ S1*→ S1→ S1*…., revealed that, in the hippocampus, spatial sequences of opposite direction are rapidly orthogonalized, largely on the basis of differential head direction system input, to accommodate both trainings. Thus, at each location, some neurons had their receptive field expanded in one direction and others in the opposite direction (<xref ref-type="bibr" rid="bib40">Navratilova et al., 2012</xref>). To compare our model with these data, we tested interleaved training of S1 and S1* (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>) and found performance increase for both sequences. Importantly, in agreement with <italic>in vivo</italic> data, different neurons became specific for S1 vs S1* as reflected in the overall increase of the directionality index (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1F</xref>). In the next section we test if sleep can achieve the same goal.</p></sec><sec id="s2-4"><title>Sleep prevents interference and leads to performance improvement for overlapping memories</title><p>So far we found that when a single sequence was trained, it replayed spontaneously during sleep resulting in improvement in performance (<xref ref-type="fig" rid="fig2">Figures 2</xref> and <xref ref-type="fig" rid="fig3">3</xref>). For two opposite sequences trained in the same network location we found competition and interference during sequential training in awake (<xref ref-type="fig" rid="fig4">Figure 4</xref>). However, when the same two sequences were trained using alternating protocol (interleaved training), both increased in performance (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1C</xref>). We next tested the effect of SWS following sequential training of two opposite sequences in awake. Two outcomes are possible: (a) the stronger sequence could dominate replay and eventually suppress the weaker one, or (b) both sequences can be replayed during sleep and increase in performance after sleep. To test these possibilities, we simulated SWS (N3) after the sequences S1/S2/S1* were trained sequentially in the awake state (S1→ S1→…→ S2→ S2→…→ S1*→ S1*→…) (<xref ref-type="fig" rid="fig5">Figure 5A</xref>), as described in the previous sections (<xref ref-type="fig" rid="fig2">Figures 2</xref> and <xref ref-type="fig" rid="fig4">4</xref>). We stopped training the new memory S1* before the old memory trace S1 was completely erased (300 sec of S1* training, see <xref ref-type="fig" rid="fig4">Figure 4D</xref>). Since we biased STDP towards LTP during awake, both memories S1 and S1* showed above baseline performance after training.</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Sleep prevents the old memory sequence from forgetting and improves performance for all memories.</title><p>(<bold>A</bold>) Network activity (PY neurons) during sequential training of sequencies S1/S2/S1* (blue bars) followed by N3 sleep (red bar). No stimulation was applied during sleep. (<bold>B</bold>) Examples of testing for each trained memory at different times. The top row corresponds to the testing of S1, middle is testing of S2, and bottom is testing of S1*. Heatmap shows characteristic cortical Up state during SWS. (<bold>C</bold>) Testing of S1, S2, and S1* shows damage to S1 after training S1*, and increase in performance for all three sequences after sleep (red bars). (<bold>D</bold>) Distributions of the net sum of synaptic weights each neuron receives from all the neurons belonging to its left vs right neighboring groups within a trained region at baseline (left), after training S1 (middle/left), after training S1* (middle/right), and after sleep (right). Wider distribution indicates presence of neurons that are strongly biased to one sequence or the other. (<bold>E</bold>) Synaptic weight-based directionality index before/after training (gray bars) and after sleep (red bar).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51005-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Training of a new memory that interferes with previously consolidated old memory leads to forgetting that can be reversed by subsequent sleep.</title><p>(<bold>A</bold>) Network activity (PY neurons) during training of S1 (150 s), S1* (350 s) (blue bars) and N3 sleep (red bars). No stimulation was applied during sleep. (<bold>B</bold>) Examples of testing periods for each trained memory at different times. The top row corresponds to the testing of sequence 1 (S1) and bottom is testing of sequence 1* (S1*). Arrows indicate time of specific testing period. (<bold>C</bold>) Performance of S1 (S1*) at baseline, after each training period and after each sleep period (red) for the network shown in A and B. (<bold>D</bold>) Performance of S1 (S1*) at baseline, after each training period and after each sleep period (red) for a network with longer (450 s) S1* training.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51005-fig5-figsupp1-v2.tif"/></fig></fig-group><p>We found that sleep improves sequence completion performance for all three memories, including competing memory traces – S1 and S1*. <xref ref-type="fig" rid="fig5">Figure 5B</xref> shows raster plots of the spiking activity before vs after sleep, which revealed significant improvements in sequence completion. These results are summarized in (<xref ref-type="fig" rid="fig5">Figure 5C</xref>). Thus, we predict that sleep replay is not only able to reverse the damage caused to the old memory (S1) following S1* training, but it can enhance S1 performance at the same time as it enhances performance of S1*.</p><p>As for a single sequence, we next calculated the net sum of synaptic weights each neuron received from all the neurons belonging to its left vs right neighboring groups, and we analyzed the difference of these net weights. The initial distribution was symmetric reflecting the initial state of the network (<xref ref-type="fig" rid="fig5">Figure 5D</xref>, left). After S1 training, the distribution became asymmetric, indicating stronger input from the left (<xref ref-type="fig" rid="fig5">Figure 5D</xref>, middle/left). Training the opposite sequence, S1*, reversed the process and the distribution became more symmetric again, however, it also became wider with some neurons in each population preferring sequence S1 (i.e., for some group B neurons, B<sub>i</sub>, input from group A was stronger than input from group C) and others preferring S1* (i.e., for other group B neurons, B<sub>j</sub>, input from group C was stronger than input from group A) (<xref ref-type="fig" rid="fig5">Figure 5D</xref>, middle/right). After SWS, the width of the distribution further increased indicating that sleep, similar to interleaved training, changes the network connectivity to develop neurons which become strongly specific for one sequence or another (<xref ref-type="fig" rid="fig5">Figure 5D</xref>, right). The synaptic weight-based directionality index that summarizes these changes (see above and <italic>Methods and Materials</italic> for details) also increased after sleep (<xref ref-type="fig" rid="fig5">Figure 5E</xref>).</p><p>Our study predicts that in experiments with a rat running on a belt in a VR apparatus, training the backward direction after training the forward one can damage (erase) the effect of forward training, however, SWS following training can reverse the damage. Additionally, similar to interleaved training (<xref ref-type="bibr" rid="bib40">Navratilova et al., 2012</xref>), directionality index should increase after SWS.</p><p>As we mentioned previously, the training protocol we have focused on in this study was of two memories trained sequentially before sleep. We have also tested the scenario where the first (old) memory is trained and consolidated during sleep before the second (new) memory is trained and then consolidated during a second period of sleep (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). The main results from both training protocols remain the same. Thus, performance for S1 improved after first episode of sleep (initial consolidation) (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1B,C</xref>). Training new memory S1* in the same population of neurons damaged S1 and led to improvement of S1*. Consistent with empirical results on proactive interference (<xref ref-type="bibr" rid="bib36">McDevitt et al., 2015</xref>), training S1* took longer in that scenario to achieve a high level of performance. Note, that even longer training of S1* further improved its performance but could also completely erase S1 (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1D</xref>). Finally, both S1 and S1* showed an improvement after a subsequent episode of sleep (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1B,C</xref>). Thus, the training paradigm ‘S1→ sleep→ S1*→ sleep’ shows qualitatively similar results to the ‘S1→ S1*→ sleep’ paradigm. This result is also consistent with the ‘Complementary Learning Systems Theory’ prediction that the old memories interfering with new learning have to be replayed during new phase of memory consolidation to avoid forgetting (<xref ref-type="bibr" rid="bib33">McClelland et al., 2020</xref>).</p></sec><sec id="s2-5"><title>Competing memories are replayed spontaneously during Up states of slow oscillation</title><p>In this section we focus our analysis on the competing sequences S1 and S1*. We asked the following questions: (a) What kind of network dynamics during Up states of SWS allows for replay and improvement of both memory traces S1 and S1*? (b) Do the same neurons participate in replay of both sequences or do different subsets of neurons uniquely represent each memory? (c) Do both memory sequences replay during the same Up state or do different Up states become biased for replay of one memory or the other?</p><p>We performed spike timing analysis similar to what we did for S1 alone (<xref ref-type="fig" rid="fig3">Figure 3</xref>), but we now analyzed separately synaptic connections in direction of S1 and S1*. <xref ref-type="fig" rid="fig6">Figure 6A</xref> plots, for each synapse in direction of S1 (left) and S1* (right), the net change in synaptic strength across the entire sleep period vs total number of Up states (slow-waves) where that synapse was preferentially replayed. As before, we found a strong positive correlation. We next plotted only those synapses which replayed reliably – more that 66% of all Up states (<xref ref-type="fig" rid="fig6">Figure 6B</xref>). We found that such synapses exist between all neuronal groups and for both sequences (in <xref ref-type="fig" rid="fig6">Figure 6B</xref> blue color indicates synapses in the direction of S1 and red in the direction of S1*). This analysis revealed two important properties. First, after sleep, each pair of neurons preferentially supported only one sequence, S1 or S1* (note that the connectivity matrix in <xref ref-type="fig" rid="fig6">Figure 6B</xref> is strictly asymmetric). Second, individual neurons can be divided into two groups - those participating reliably in only one sequence replay (either S1 or S1*) and those participating in both sequences replays (see <xref ref-type="fig" rid="fig6">Figure 6B</xref>, where some target neurons (X-axis) receive input from source neurons (Y-axis) in only one network ‘direction’, left (blue) or right (red), and others receive input from both ‘directions’).</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Sleep promotes replay of both overlapping memory sequences during each Up state.</title><p>(<bold>A</bold>) Change in synaptic weight over entire sleep period as a function of the number of Up states where a given synapse was preferentially replayed. Each star represents a synapse in the direction of S1 (left) or S1* (right). Dashed line indicates the threshold (66% of Up states) used to identify synapses that are replayed reliably for analysis in (B); purple line indicates the maximum number of Up states; blue line demarcates the 50% mark of the total number of Up states. (<bold>B</bold>) Thresholded connectivity matrix indicating synaptic connections showing reliable replays for S1 (blue) or S1* (red). Grey boxes highlight between group connections. (<bold>C</bold>) Number of replay events for inter-group synapses per Up state across all Up states (left) and a subset of Up states (right) for S1 (blue) and S1* (red). Note that both sequences show similar high number of replays across all Up states, suggesting that both sequences are replayed during each Up state. (<bold>D</bold>) Network's graphs showing between group (top/middle) and within group (bottom) connections after sleep. Edges shown here are those which revealed reliable replays of S1 (blue) and S1* (red) as shown in <bold>B</bold> (right). Nodes are colored blue (red) if more than 50% of their incoming connections show reliable replay in direction of S1 (S1*). Green nodes indicate neurons with high in-degrees, receiving the same number of ‘replayed’ synapses from left and right, and black indicates that none of these conditions are met.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51005-fig6-v2.tif"/></fig><p>To confirm that both memories are replayed within the same Up state (i.e., some synapses replay S1 and others replay S1* during a given Up state), we counted, for each Up state, the total number of individual replay events across all synapses that were identified to replay S1 and S1* reliably (<xref ref-type="fig" rid="fig6">Figure 6C</xref>). This revealed fluctuations from one Up state to another, but the count remained high for both S1 and S1* confirming our prediction that partial replays of both sequences occur during the same Up state, that is, any given Up state participates in replay of both memories. Still, zoom-in to the replay count diagram (<xref ref-type="fig" rid="fig6">Figure 6C</xref>, right) revealed an antiphase oscillation, that is, one Up state would replay more S1 synapses, while another one (commonly next one) would replay more S1* synapses. Note, our model predicts that partial sequences (specifically spike doubles) of both memories can be replayed during <italic>the same Up state</italic> and not that both are replayed <italic>simultaneously</italic> (at the same exact time). Comparing replays during first vs second half of an Up state, we found that more replay events happened during the first half of any given Up state (particularly near the Down to Up transition) compared to the second half (not shown). This result is consistent with electrophysiological data suggesting that memory replay is strongest at the Down to Up state transition (<xref ref-type="bibr" rid="bib18">Johnson et al., 2010</xref>).</p><p>Finally, in <xref ref-type="fig" rid="fig6">Figure 6D</xref>, we plotted all the synapses identified by the analysis in <xref ref-type="fig" rid="fig6">Figure 6B</xref>, that is, those involved in reliable (in more than 66% of all Up states) replay during sleep: top plot shows synapses in S1 direction (in blue) and bottom one shows synapses in S1* direction (in red). For each neuron we compared the number of such synapses it received from its left (S1 direction) vs right (S1* direction) neighboring population (e.g., for a neuron in group B, we compared if it received more synapses demonstrating reliable replay from group A or from group C). We then colored in blue (red) neurons receiving more synapses demonstrating reliable replay from its left (right) neighbors (<xref ref-type="fig" rid="fig6">Figure 6D</xref>). In green we colored neurons receiving the same number of ‘replayed’ synapses from left and right. While we found that many neurons (blue or red) participated reliably in only one sequence replay, S1 or S1*, a few neurons (green) participated equally in replay of both sequences, creating ‘network hubs’.</p></sec><sec id="s2-6"><title>Sleep replay leads to competition between synapses</title><p>In order to further understand how sleep replay affects S1 and S1* memory traces to allow enhancement of both memories, we next analyzed the dynamics of individual synaptic weights within the population of neurons containing the overlapping memory sequences (i.e. neurons 200–249). <xref ref-type="fig" rid="fig7">Figure 7A</xref> shows distributions of synaptic weights for synapses in the direction of S1 (top row) and in the direction of S1* (bottom row) before (blue) and after (red) specific events. Different columns correspond to different events, i.e. after S1 training (<xref ref-type="fig" rid="fig7">Figure 7A</xref>, left), after S1* training (<xref ref-type="fig" rid="fig7">Figure 7A</xref>, middle), after sleep (<xref ref-type="fig" rid="fig7">Figure 7C</xref>, right). Prior to any training, synaptic weights in the direction of either memory sequence were Gaussian distributed (<xref ref-type="fig" rid="fig7">Figure 7A</xref>, blue histogram, left). After S1 training, the weights for S1 strengthened (shifted to the right), while the weights for S1* weakened (shifted to the left). As expected, this trend was reversed when S1* was trained (<xref ref-type="fig" rid="fig7">Figure 7A</xref>, middle). After sleep, for each sequence (S1 or S1*) there was a subset of synapses that were further strengthened, while the rest of synapses were weakened (<xref ref-type="fig" rid="fig7">Figure 7A</xref>, right). This suggests that sleep promotes competition between synapses, so that specific subsets of synapses uniquely representing each memory trace can reach the upper bound to maximize recall performance while other synapses would become extinct to minimize interference.</p><fig-group><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Sleep promotes unidirectional synaptic connectivity with different subsets of synapses becoming specific to the old or new memory sequences.</title><p>(<bold>A</bold>) Dynamics of synaptic weight distributions from the trained region. Top row shows strength of synapses in direction of S1. Bottom row shows strength of synapses in direction of S1*. Blue shows the starting points for weights, and red shows new weights after different specific events, for example, S1 training, S1* training, sleep. (<bold>B</bold>) Scatter plots show synaptic weights for all reciprocally connected pairs of neurons before and after training (left/middle) and after sleep (right). For each pair of neurons (e.g., n1-n2), the X-coordinate shows the strength of W<sub>n1→n2</sub> synapse and the Y-coordinate shows the strength of W<sub>n2→n1</sub> synapse. The green (K<sub>01</sub>) and purple (K<sub>10</sub>) boxes show the locations in the scatter plot representing synaptic pairs with strong preference for S1* (green) or S1 (purple). (<bold>C</bold>) The evolution of the mean synaptic strength (solid line) and the standard deviation (dashed line) of recurrent connections in S1 (blue) and S1* (red) direction. Note the large standard deviation after sleep indicating strong synaptic weight separation, so each recurrent neuronal pair supports preferentially either S1 or S1*. (<bold>D</bold>) The evolution of the mean synaptic weight (solid line) and the standard deviation (dashed line) of unidirectional connections in S1 (blue) and S1* (red) direction. Note the overall increase in synaptic strength after sleep. (<bold>E</bold>) The number of functionally recurrent and unidirectional connections in the trained region of the network as a function of time, obtained after thresholding the network connectivity matrix with threshold 0.065 (which is smaller than the initial mean synaptic strength). Note the decrease of functionally recurrent connections and increase of functionally unidirectional connections after sleep.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51005-fig7-v2.tif"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 1.</label><caption><title>Interleaved training revealed synaptic weight dynamics that are similar to sleep but result in less segregation of synaptic weights.</title><p>(<bold>A</bold>) Dynamics of synaptic weight distributions from the trained region. Top row shows strength of synapses in direction of S1. Bottom row shows strength of synapses in direction of S1*. Blue shows the starting points for weights, and red shows new weights after different specific events, for example, S1 training, S1* training, interleaved training. (<bold>B</bold>) Scatter plots show synaptic weights for all pairs of neurons contributing to both S1 and S1* before and after training (left/middle) and after interleaved training (right). For each pair of neurons (e.g., n1-n2), the X-coordinate shows the strength of W<sub>n1→n2</sub> synapse and the Y-coordinate shows the strength of W<sub>n2→n1</sub> synapse. The green (K<sub>01</sub>) and purple (K<sub>10</sub>) boxes show the locations in the scatter plot representing synaptic pairs with strong preference for S1* (green) or S1 (purple). (<bold>C</bold>) The evolution of the mean synaptic strength (solid line) and the standard deviation (dashed line) of recurrent connections in S1 (blue) and S1* (red) direction. (<bold>D</bold>) The evolution of the mean synaptic weight (solid line) and the standard deviation (dashed line) of unidirectional connections in S1 (blue) and S1* (red) direction. Note the lack of overall increase in synaptic strength after interleaved training as compared to sleep (<xref ref-type="fig" rid="fig7">Figure 7C</xref>). (<bold>E</bold>) The number of functionally recurrent and unidirectional connections in the trained region of the network as a function of time obtained after thresholding connectivity matrix with threshold 0.065 (which is smaller than the initial mean synaptic strength).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51005-fig7-figsupp1-v2.tif"/></fig><fig id="fig7s2" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 2.</label><caption><title>Synaptic plasticity that is biased towards LTP or LTD also results in memory orthogonalization during sleep .</title><p>Synaptic dynamics for LTP/LTD ratio biased towards LTD (A<sub>+</sub>/A<sub>-</sub>=0.0019/0.002) (<bold>A</bold>) or LTP (A<sub>+</sub>/A<sub>-</sub>=0.0021/0.002) (<bold>B</bold>). Top, Scatter plots showing synaptic weights for all reciprocally connected pairs of neurons before and after training (left/middle) and after sleep (right). For each pair of neurons (e.g., n1-n2), the X-coordinate shows the strength of W<sub>n1→n2</sub> synapse and the Y-coordinate shows the strength of W<sub>n2→n1</sub> synapse. The red lines indicate the thresholds used to determine synapses which are preferentially strong for S1 (bottom right ) or S1* (top left ). Middle, Vector fields summarizing the average synaptic weights dynamics of the scatter plots in the top panel. Arrows point in the direction of the average movement of synaptic weights and length of the arrows indicates the amplitude of the movement. Bottom, Total number of synapses which are preferentially strong for S1 (blue) or S1* (red) after training S1*/before sleep (left) and after sleep (right). Thresholds for determining preference for either sequence are indicated by red lines in the scatter plots.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51005-fig7-figsupp2-v2.tif"/></fig></fig-group><p>Because of the random ‘anatomical’ connectivity, the cortical network model included two classes of synapses: <italic>recurrent/bidirectional</italic>, when a pair of neurons (e.g., n1 and n2) are connected by opposite synapses (n1→ n2 <italic>and</italic> n2→ n1) and <italic>unidirectional</italic> (n1→ n2 <italic>or</italic> n2→ n1). In the following we looked separately at these two classes. We also compared synaptic weights dynamics during sleep (<xref ref-type="fig" rid="fig7">Figure 7</xref>) vs interleaved training (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>).</p><p>In the scatter plots of synaptic weights for the recurrent synapses (<xref ref-type="fig" rid="fig7">Figure 7B</xref>), for each pair of neurons (e.g., n1-n2), we plotted a point with the X-coordinate representing the weight of n1→ n2 synapse and the Y-coordinate representing the weight of n2→ n1 synapse. Any point with X- (Y-) coordinate close to zero would, therefore, indicate a pair of neurons with functionally unidirectional coupling in S1* (S1) direction. The initial Gaussian distribution of weights (<xref ref-type="fig" rid="fig7">Figure 7B</xref>, left) was pushed towards the bottom right corner of the plot (K<sub>10</sub>, purple box), indicating increases in S1 weights and relative decrease of S1* weights in response to S1 training (<xref ref-type="fig" rid="fig7">Figure 7B</xref>, middle/left). It should be noted that a small subset of synaptic weights increased in the direction of S1* during S1 training. Analysis of this population of synaptic weights revealed that these connections were comprised solely of ‘within group’ connections. It is important to note that these synapses did not impair the consolidation of the trained memory but instead helped to increase activity <italic>within each group</italic> regardless of which sequence was recalled.</p><p>Training of S1* caused an upward/left shift representing strengthening of S1* weights and weakening of S1 weights (<xref ref-type="fig" rid="fig7">Figure 7B</xref>, middle/right). For very long S1* training (not shown) almost all the weights would be pushed to the upper left corner (K<sub>01</sub>, green box). Sleep appears to have taken most of the weights located in the center of the plot (i.e., strongly bidirectional synapses) and separated them by pushing them to the opposite corners (K<sub>01</sub>, green box, and K<sub>10</sub>, purple box) (<xref ref-type="fig" rid="fig7">Figure 7B</xref>, right). In doing so, sleep effectively converted recurrent connections into unidirectional connections which preferentially contributed to one memory sequence or another. It should be noted that interleaved training resulted in similar separation of weights such that some previously recurrent synapses became functionally unidirectional (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1A, B</xref>). Interleaved training, however, retained more recurrent weights than sleep likely contributing to the smaller improvement in performance during post-interleaved training testing (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1C</xref>).</p><p>Sleep-dependent synaptic weight dynamics are further illustrated in <xref ref-type="fig" rid="fig7">Figure 7</xref> panels C-E. The mean strength of all recurrent connections in the trained region decreased slightly during sleep (<xref ref-type="fig" rid="fig7">Figure 7C</xref>), however the standard deviation increased significantly (see dashed lines in <xref ref-type="fig" rid="fig7">Figure 7C</xref>). The last reflected strong asymmetry of the connection strength for recurrent pairs after sleep, again indicating that sleep effectively converts recurrent connections into unidirectional ones. Indeed, the mean strength of all unidirectional connections increased during sleep (<xref ref-type="fig" rid="fig7">Figure 7D</xref>, blue and red lines). We next counted the total number of functionally recurrent and unidirectional connections after training and after sleep (<xref ref-type="fig" rid="fig7">Figure 7E</xref>). In this analysis if one branch of a recurrent pair reduced in strength below the threshold, it was counted as unidirectional. After sleep, the number of recurrent connections dropped to just about 15% of what it was after training. Interleaved training resulted in similar but smaller changes to unidirectional and bidirectional connections (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1C, D, E</xref>). Together these results suggest that sleep decreases the density of recurrent connections and increases the density of unidirectional connections, both by increasing the <italic>strength</italic> of anatomical unidirectional connections and by <italic>converting</italic> anatomical recurrent connections to functionally unidirectional connections. This allows the assignment of individual neurons to unique memories, that is, orthogonalization of memory representations, so that multiple memories could replay without interference during the same Up states of slow oscillations and can be recalled successfully after sleep.</p></sec><sec id="s2-7"><title>LTP or LTD biased synaptic plasticity still leads to orthogonalization of memory representations during sleep</title><p>In all previous simulations, LTP and LTD were balanced during sleep and interleaved training. To test that the orthogonalization of the memory traces during sleep is independent of the specific balance of LTP/LTD (A<sub>+</sub>/A<sub>-</sub>, see <italic>Methods and Materials</italic>), we performed additional simulations biasing the LTP/LTD ratio during sleep towards either LTD (<xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2A</xref>; A<sub>+</sub>/A<sub>-</sub>=0.0019/0.002) or LTP (<xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2B</xref>; A<sub>+</sub>/A<sub>-</sub>=0.0021/0.002). We found that in both cases, sleep resulted in the orthogonalization of memory representations. Scatter plots of bidirectional synaptic connections (the same analysis as in <xref ref-type="fig" rid="fig7">Figure 7B</xref>) revealed that sleep formed strongly memory specific configurations of weights by pushing some of the recurrent connections to either the top left (S1* preferential) or bottom right (S1 preferential) corners of the plot. The red lines on these plots depict the threshold used to identify neuronal pairs that are either strongly preferential for S1 (bottom right corner) or S1* (top left corner). The number of synapses above these thresholds were quantified in the bar plots below showing that sleep increases the density of the memory specific connections between neurons regardless of the LTP/LTD ratio (<xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2</xref>, bottom panels). The vector field plots (<xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2</xref>, middle panels) provide a summary of the average synaptic weight dynamics during training (left and middle plots) and during sleep (right plot). It revealed convergence towards the corners (note arrows pointing to the corners during sleep phase) which represent cell pairs being strongly enrolled either to sequence S1 or sequence S1* encoding.</p><p>It should be noted that because our model does not have homeostatic mechanisms to regulate ‘average’ synaptic strength during sleep, the case of LTD biased sleep revealed a net reduction of synaptic strengths, while the LTP biased condition showed a net increase. For LTD biased sleep, many recurrent synapses decreased the strength while a fraction of synapses kept or even increased the strength. These synapses became memory specific after sleep. This observation may be in line with ideas from Tononi and colleagues showing net reductions of synaptic weights during sleep (<xref ref-type="bibr" rid="bib66">Tononi and Cirelli, 2014</xref>) however, more analysis of the model including additional homeostatic rules is need to make this conclusion based on model simulations.</p></sec><sec id="s2-8"><title>Neurons participating in sleep replay are the same as those responding earlier during memory recall</title><p>In the previous sections, we found that for overlapping memories sleep leads to segregation of the entire population of neurons into two subsets based on (a) asymmetric synaptic input from left/right neighboring groups (e.g., subset B<sub>i</sub> of neurons from group B receives stronger total synaptic input from group A compare with total input from group C; subset B<sub>j</sub> of neurons from group B receives stronger input from C than from A) (<xref ref-type="fig" rid="fig5">Figure 5D,E</xref>); (b) preference to participate reliably in only one specific sequence replay during sleep (e.g., subset B<sub>k</sub> of neurons from group B receives more synapses demonstrating reliable replay from group A than from group C; this is reversed for subset B<sub>l</sub> of neurons from group B) (<xref ref-type="fig" rid="fig6">Figure 6D</xref>). Here we tested if these groups of neurons, identified by synaptic strength and replay, overlap. We also compared them to the subset of neurons responding earliest within each group during memory recall.</p><p>Instead of stimulating only groups A or E, here we stimulated independently every single group - A, B, C, D, E (<xref ref-type="fig" rid="fig8">Figure 8A</xref>). We then obtained the response delay for each neuron in groups B, C, D when its respective left vs right neighboring groups were stimulated, and we calculated the difference of delays. Thus, for example, we measured a difference of response delays for each neuron in group B when either group A or group C was stimulated. This analysis is similar to what was done in (<xref ref-type="bibr" rid="bib40">Navratilova et al., 2012</xref>), where the difference of place cell responses at a specific location on a linear track was calculated when a rat was approaching that location from one direction vs the other. <xref ref-type="fig" rid="fig8">Figure 8B</xref> shows the distribution of delays at different times. As expected, it became asymmetric after S1 training (e.g., in group B more neurons responded earlier upon stimulation of group A vs stimulation of group C), symmetric again after S1* training, and finally symmetric but wider after sleep. The last suggests that sleep increases segregation of neurons into two groups specific to each memory based on response delay (e.g., in group B some neurons, B<sub>n</sub>, responded earlier upon stimulation of group A vs stimulation of group C; while other neurons, B<sub>m</sub>, responded earlier upon stimulation of group C vs stimulation of group A). Indeed, the directionality index based on delays (<xref ref-type="fig" rid="fig8">Figure 8C</xref>) revealed an increase after S1 training, drop after S1* training, and increase again after sleep.</p><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Population of neurons participating in reliable replay during sleep overlaps with the early responders during memory recall.</title><p>(<bold>A</bold>) Characteristic examples of the network activity showing spiking events during stimulations of each individual ‘letter’ of a memory sequence in awake. (<bold>B</bold>) Distributions of the differences in response delay for all neurons from the trained region when the respective left vs right neighboring groups are stimulated, as shown in <bold>A</bold>. (<bold>C</bold>) Response delay-based directionality index before/after training of each sequence (S1/S1*) in gray, and after sleep (red). (<bold>D</bold>) 3-D surface plot showing, for each neuron from a trained region, the number of incoming synapses demonstrating reliable replays during sleep (z-axis), mean response delay during testing (as in panel A) after sleep (y-axis), and total synaptic input to a neuron after sleep (x-axis). Note that neurons receiving highest total synaptic inputs in specific network direction after sleep are also those who respond with shortest delay during testing recall in that direction after sleep and also those who receive the highest number of synapses demonstrating reliable replay during sleep. (<bold>E</bold>) Simplified cartoon of the network connectivity after different training phases followed by sleep. Arrows indicate connections between neurons (nodes) with blue arrows being connections strong for S1 and red for S1*. Blue and red nodes represent neurons that contribute (weakly - light colors; strongly - dark colors) to recall of S1 and S1*, respectively. Top, network configuration after S1 training – all nodes and connections are allocated to S1. Middle/Top, network configuration after initial S1* training – nodes/connections start to learn S1* and ‘unlearn’ S1. The information about the old memory S1 is still available. Middle/Bottom, network configuration after continuing S1* training – all nodes/connections are allocated to S1*. All information about S1 is lost. Bottom, network configuration when initial S1* training is followed by sleep – orthogonalization of memory traces, some nodes/connection are allocated to S1 and others to S1*.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51005-fig8-v2.tif"/></fig><p>In <xref ref-type="fig" rid="fig8">Figure 8D</xref>, we summarized our results by putting together three main characteristics we discussed in this study: Mean response delay of a neuron during stimulation of its neighboring group, Total synaptic input a neuron receives from that neighboring group, and Number of connections to a neuron from that neighboring group that are replayed reliably during sleep. We found a strong correlation between these three measures, that is, the neurons who responded with a shortest delay during a given sequence recall after sleep are the same neurons who received strongest synaptic input in that sequence direction after sleep and were involved in most of that sequence replays during sleep.</p><p>Together, our study proposes the following network connectivity dynamics during learning and sleep (<xref ref-type="fig" rid="fig8">Figure 8E</xref>). Initial training allocates all available neuronal/synaptic resources to a single memory (S1) (<xref ref-type="fig" rid="fig8">Figure 8E</xref>, top); some neurons contribute stronger than others (light vs dart colors in <xref ref-type="fig" rid="fig8">Figure 8E</xref>; based on <xref ref-type="fig" rid="fig7">Figure 7B</xref>). Subsequent training of a competing memory (S1*) progressively erases the initial memory trace by reallocating synaptic resources to the new memory; an initial segregation of neurons is formed (<xref ref-type="fig" rid="fig8">Figure 8E</xref>, middle/top). Continuing training of a competing memory (S1*) leads to complete and irreversible damage to the old memory (S1) – catastrophic forgetting (<xref ref-type="fig" rid="fig8">Figure 8E</xref>, middle/bottom). A sleep phase implemented before the old memory is erased allows replay of both old and new memory traces; this divides resources between competing memories leading to the formation of the orthogonal memory representations which allows the co-existence of multiple memories within overlapping populations of neurons (<xref ref-type="fig" rid="fig8">Figure 8E</xref>, bottom).</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We report here that sleep can reverse catastrophic forgetting of previously learned (old) memories after damage by new training. Sleep is able to accomplish this task through spontaneous reactivation (replay) of both old and new memory traces, leading to reorganization and fine-tuning of synaptic connectivity. As a result, sleep creates unique orthogonal representations of the competing memories that allow their co-existence without interference within overlapping ensembles of neurons. Thus, if without competition, a memory is represented by the entire available population of neurons and synapses, in the presence of competition, its representation is reduced to a <italic>subset</italic> of neurons/synapses which selectively encode a given memory trace. Our study predicts that memory representations in the brain are dynamic; after each new episode of training followed by sleep, the synaptic representations of the old memories, sharing resources with the new task, may change to achieve an optimal separation among the memory traces occupying overlapping ensembles of neurons. Our study suggests that sleep, by being able to directly reactivate memory traces encoded in synaptic weight patterns, provides a powerful mechanism to prevent catastrophic forgetting and enable continual learning.</p><sec id="s3-1"><title>Catastrophic forgetting and continual learning</title><p>The work on catastrophic forgetting and interference in connectionist networks was pioneered by <xref ref-type="bibr" rid="bib34">Mccloskey and Cohen, 1989</xref> and <xref ref-type="bibr" rid="bib51">Ratcliff, 1990</xref>. Catastrophic interference is observed when a previously trained network is required to learn new data, e.g., a new set of patterns. When learning new data, the network can suddenly erase the memory of the old, previously learned inputs (<xref ref-type="bibr" rid="bib11">French, 1999</xref>; <xref ref-type="bibr" rid="bib17">Hasselmo, 2017</xref>; <xref ref-type="bibr" rid="bib21">Kirkpatrick et al., 2017</xref>). Catastrophic interference is thought to be related to the so-called ‘plasticity-stability’ problem. This problem comes from the difficulty of creating a network with connections which are plastic enough to learn new data, while stable enough to prevent damage to the old memories. Due to the inherent trade-off between plasticity and memory stability, catastrophic interference and forgetting remains to be a difficult problem to overcome in connectionist networks (<xref ref-type="bibr" rid="bib11">French, 1999</xref>; <xref ref-type="bibr" rid="bib17">Hasselmo, 2017</xref>; <xref ref-type="bibr" rid="bib21">Kirkpatrick et al., 2017</xref>).</p><p>A number of attempts have been made to overcome catastrophic interference (<xref ref-type="bibr" rid="bib11">French, 1999</xref>; <xref ref-type="bibr" rid="bib17">Hasselmo, 2017</xref>; <xref ref-type="bibr" rid="bib21">Kirkpatrick et al., 2017</xref>). Early attempts included changes to the backpropagation algorithm, implementations of a ‘sharpening algorithm’ in which a decrease in the overlap of internal representations was achieved by making hidden-layer representations sparse, or changes to the internal structure of the network (<xref ref-type="bibr" rid="bib11">French, 1999</xref>; <xref ref-type="bibr" rid="bib17">Hasselmo, 2017</xref>; <xref ref-type="bibr" rid="bib21">Kirkpatrick et al., 2017</xref>). These attempts were able to reduce the severity of catastrophic interference in specific cases but could not provide a complete and generic solution to the problem. Another popular method for preventing interference and forgetting is to explicitly retrain or rehearse all the previously learned inputs while training the network on the new data – interleaved training (<xref ref-type="bibr" rid="bib17">Hasselmo, 2017</xref>). This idea recently led to a number of successful algorithms to constrain the catastrophic forgetting problem, including interleaved training focusing on the previously known items overlapping with new training data (<xref ref-type="bibr" rid="bib33">McClelland et al., 2020</xref>), generative algorithms to generate previously experienced stimuli during the next training period (<xref ref-type="bibr" rid="bib78">Zz and Hoiem, 2018</xref>; <xref ref-type="bibr" rid="bib67">van de Ven and Tolias, 2018</xref>) and generative models of the hippocampus and cortex to generate examples from a distribution of previously learned tasks in order to retrain (replay) these tasks during a sleep phase (<xref ref-type="bibr" rid="bib20">Kemker and Kanan, 2017</xref>).</p><p>In agreement with these previous studies, we show that interleaved training can prevent catastrophic forgetting resulted from sequential training of the overlapping spike patterns. This method, however, does not necessarily achieve optimal separation between old and new overlapping memory traces. Indeed, interleaved training requires repetitive activation of the entire memory patterns, so if different memory patterns compete for synaptic resources (as for the opposite sequences studied here) each phase of interleaved training will enhance one memory trace but damage the others. This is in contrast to replay during sleep when only memory specific subsets of neurons and synapses may be involved in each replay episode. Another primary concern with interleaved training is that it becomes increasingly difficult/cumbersome to retrain all the memories as the number of stored memories continues to increase and access to the earlier training data may no longer be available. As previously mentioned, biological systems have evolved a mechanism to prevent this form of forgetting without the need to explicitly retrain the network on all previously encoded memories. Studying how biological systems overcome catastrophic forgetting can provide insights into novel techniques to combat this problem in artificial neural networks.</p></sec><sec id="s3-2"><title>Sleep and memory consolidation</title><p>Though a variety of sleep functions remain to be understood, there is growing evidence for the role of sleep in consolidation of newly encoded memories (<xref ref-type="bibr" rid="bib47">Paller and Voss, 2004</xref>; <xref ref-type="bibr" rid="bib70">Walker and Stickgold, 2004</xref>; <xref ref-type="bibr" rid="bib45">Oudiette et al., 2013</xref>; <xref ref-type="bibr" rid="bib50">Rasch and Born, 2013</xref>; <xref ref-type="bibr" rid="bib62">Stickgold, 2013</xref>; <xref ref-type="bibr" rid="bib74">Weigenand et al., 2016</xref>; <xref ref-type="bibr" rid="bib72">Wei et al., 2018</xref>). The mechanism by which memory consolidation is influenced by sleep is still debated, however a number of hypotheses have been put forward. One such hypothesis is the ‘Active System Consolidation Hypothesis’ (<xref ref-type="bibr" rid="bib50">Rasch and Born, 2013</xref>). Central to this hypothesis is the idea of repeated memory reactivation (<xref ref-type="bibr" rid="bib76">Wilson and McNaughton, 1994</xref>; <xref ref-type="bibr" rid="bib57">Skaggs and McNaughton, 1996</xref>; <xref ref-type="bibr" rid="bib47">Paller and Voss, 2004</xref>; <xref ref-type="bibr" rid="bib37">Mednick et al., 2013</xref>; <xref ref-type="bibr" rid="bib45">Oudiette et al., 2013</xref>; <xref ref-type="bibr" rid="bib46">Oudiette and Paller, 2013</xref>; <xref ref-type="bibr" rid="bib50">Rasch and Born, 2013</xref>; <xref ref-type="bibr" rid="bib62">Stickgold, 2013</xref>; <xref ref-type="bibr" rid="bib74">Weigenand et al., 2016</xref>). Although NREM sleep was shown to be particularly important for reactivation of declarative (hippocampus-dependent) memories (<xref ref-type="bibr" rid="bib31">Marshall et al., 2006</xref>; <xref ref-type="bibr" rid="bib37">Mednick et al., 2013</xref>), human studies suggest that NREM sleep may be also involved in the consolidation of the procedural (hippocampus-independent) memories. This includes, for example simple motor tasks (<xref ref-type="bibr" rid="bib9">Fogel and Smith, 2006</xref>), or finger-sequence tapping tasks (<xref ref-type="bibr" rid="bib69">Walker et al., 2002</xref>; <xref ref-type="bibr" rid="bib27">Laventure et al., 2016</xref>). Selective deprivation of NREM sleep, but not REM sleep, reduced memory improvement for the rotor pursuit task (<xref ref-type="bibr" rid="bib59">Smith and MacNeill, 1994</xref>). Following a period of motor task learning, the duration of NREM sleep (<xref ref-type="bibr" rid="bib9">Fogel and Smith, 2006</xref>) and the number of sleep spindles (<xref ref-type="bibr" rid="bib39">Morin et al., 2008</xref>) increased. The amount of performance increase in the finger tapping task correlated with the amount of NREM sleep (<xref ref-type="bibr" rid="bib69">Walker et al., 2002</xref>), spindle density (<xref ref-type="bibr" rid="bib42">Nishida and Walker, 2007</xref>) and delta power (<xref ref-type="bibr" rid="bib65">Tamaki et al., 2013</xref>). In a recent animal study (<xref ref-type="bibr" rid="bib49">Ramanathan et al., 2015</xref>), consolidation of the procedural (skilled upper-limb) memory depended on bursts of spindle activity and slow oscillations during NREM sleep.</p></sec><sec id="s3-3"><title>Model predictions</title><p>The model of awake training and sleep consolidation presented in our new study was designed to simulate learning and consolidation of procedural memory tasks. Indeed, in our model, training a new task directly impacts cortical synaptic connectivity that may be already allocated to other (old) memories. We found that as long as damage to the old memory is not sufficient to completely erase its synaptic footprint, sleep can enable replay of both old and newer memory traces and reverse the damage while improving performance. Thus, to avoid irreversible damage, new learning in our model is assumed to be slow which may correspond to learning a procedural task, for example, new motor skill, over multiple days allowing sleep to recover old memory traces that are damaged by each new episodes of learning.</p><p>Nevertheless, we suggest that our model predictions, at least at the synaptic level, are not limited to a specific type of memory (declarative vs procedural) or specific type of sleep (NREM vs REM). Replay during REM sleep (<xref ref-type="bibr" rid="bib29">Louie and Wilson, 2001</xref>) may trigger synaptic weight dynamics similar to that we described here. Though REM is characterized by less synchronized spiking activity, the occurrence of memory replay during REM is supported by place cell recordings (<xref ref-type="bibr" rid="bib29">Louie and Wilson, 2001</xref>) and electroencephalography studies in humans (<xref ref-type="bibr" rid="bib1">Atienza and Cantero, 2001</xref>). While synchronized activity is helpful for replay and may allow (because of high spike precision) for replay to occur at compressed time scales, as observed during NREM sleep (<xref ref-type="bibr" rid="bib7">Euston et al., 2007</xref>), the crucial component of replay is the defined spike ordering which may be happening during REM sleep even when the overall network synchronization is low. Indeed, we observed similar synaptic weight dynamics and orthogonalization of memory representations when periodic Up/Down state oscillations were replaced by continuous REM-like spiking activity. While our model lacks hippocampal input, we showed previously (<xref ref-type="bibr" rid="bib71">Wei et al., 2016</xref>; <xref ref-type="bibr" rid="bib55">Sanda et al., 2019</xref>) that sharp wave-ripple (SWR) like input to the cortical network would trigger replay of previously learned cortical sequences during SWS. This suggests, in agreement with (<xref ref-type="bibr" rid="bib58">Skelin et al., 2019</xref>), that replay driven by hippocampal inputs may reorganize the cortical synaptic connectivity in a matter similar to spontaneous replay we described here.</p><p>Our model predicts the possibility of the partial sequence replays, that is, when short snippets of a sequence are replayed independently, within the cortex. Furthermore, we showed that reliable partial replays of overlapping memory traces can occur during the same cortical Up state. That is to say, during an Up state rather than replaying the entire sequence A-B-C-D-E, we observed replay of individual transitions (e.g. A-B, D-E, C-D). We can speculate that for strongly overlapping sequences, as we modeled in this study, such partial replay would allow to replay snippets of both sequences with less interference during the same Up state. Indeed, recent data (<xref ref-type="bibr" rid="bib12">Ghandour et al., 2019</xref>) have shown evidence for partial memory replay during NREM sleep (also see <xref ref-type="bibr" rid="bib64">Swanson et al., 2020</xref>).</p><p>Importantly, our model of sleep consolidation predicts that the critical synaptic weight information from previous episodes of learning is still preserved after new training even if recall performance for the older task is significantly reduced. Because of this, spontaneous activity during sleep combined with unsupervised plasticity can trigger reactivation of the previously learned memory patterns and modify synaptic weights reversing damage from the new learning. It further suggests that the apparent loss of performance for older tasks in the artificial neuronal networks after new training – catastrophic forgetting – may not imply irreversible loss of information as it is generally assumed. Indeed, our recent work (<xref ref-type="bibr" rid="bib24">Krishnan et al., 2019</xref>) revealed that simulating a sleep-like phase in feedforward artificial networks trained using backpropagation can provide a solution for the catastrophic forgetting problem in agreement with our results from the biophysical model presented here. Few changes to the network properties, normally associated with transition to sleep, were critical to accomplish this goal: relative hyperpolarization of the pyramidal neurons and increasing strength of excitatory synaptic connectivity. Both are associated with known effects of neuromodulators during wake-sleep transitions (<xref ref-type="bibr" rid="bib35">McCormick, 1992</xref>) and were previously implemented in the thalamocortical model (<xref ref-type="bibr" rid="bib23">Krishnan et al., 2016</xref>) that we used in our new study. Interestingly, these changes would make neurons relatively less excitable and, at the same time, increase contribution of the strongest synapses, effectively enhancing the dynamical range for the trained synaptic patterns and reducing contribution of synaptic noise; together this would promote replay of the previously learned memories.</p><p>The ‘Sleep Homeostasis Hypothesis’ (<xref ref-type="bibr" rid="bib66">Tononi and Cirelli, 2014</xref>) suggests that homeostatic mechanisms active during sleep should result in a net synaptic depression to renormalize synaptic weights and to stabilize network dynamics. In our model, LTP and LTD were generally balanced during sleep and no homeostatic mechanisms were implemented to control net synaptic dynamics. However, when synaptic plasticity during sleep was explicitly biased towards LTD, sleep was still able to selectively increase a subset of synaptic weights, thus making them memory specific, while reducing the strength of other synapses. We predict that this mechanism may aid in increasing the memory capacity of the network by only strengthening the minimal number of connections required for the preservation of memories and resetting other synapses towards baseline strength during sleep. The network would then be able to use these synapses to encode new memories thus potentially facilitating continual learning without the consequence of retroactive interference.</p></sec><sec id="s3-4"><title>Comparison to experimental data and model limitations</title><p>There are evidences that memory replay during SWS occurs predominantly near the Down to Up state transitions (<xref ref-type="bibr" rid="bib18">Johnson et al., 2010</xref>). This observation comes from <italic>in vivo</italic> studies in which multiple brain regions, including the hippocampus and cortex, are in continual communication during SWS. It has been shown that sharp-wave ripples tend to occur at the Down to Up state transition (<xref ref-type="bibr" rid="bib55">Sanda et al., 2019</xref>; <xref ref-type="bibr" rid="bib58">Skelin et al., 2019</xref>), which may explain the predomiance of the hippocampus driven replay at the beginning of cortical Up states. We did not explicitly model the hippocampus or hippocampal inputs in our study. Rather, we assumed that memory traces are already embedded to the cortical connectivity matrix either because of the earlier hippocampal-dependent consolidation or because these memories are hippocampal-independent (as for procedural memories). We found that such cortical memory traces also tend to replay more during the initial phase of an Up state, possibly because of the higher firing rate, but replay continues throughout the entire Up state duration. This predicts that hippocampal dependent replay of new memories, that are not yet encoded in the cortex, may occur earlier in the Up state compared to the spontaneous replay of the old memory traces, which may occur later in the Up state.</p><p>Our results are consistent with <italic>in vivo</italic> experiments with rats running on a linear track and we make several specific predictions for future experiments. Specifically, our model predicts: (a) running in one direction on a linear track would lead to backwards receptive field expansion (confirmed for hippocampus [<xref ref-type="bibr" rid="bib38">Mehta et al., 1997</xref>]); (b) forwards and backwards running on a linear track would lead to developing asymmetric receptive fields for different neurons (confirmed for hippocampus [<xref ref-type="bibr" rid="bib40">Navratilova et al., 2012</xref>]); (c) running on a belt track in a VR apparatus first only in one direction and then in reverse one could damage the learning associated with first task; (d) SWS implemented after training would reverse damage and further enhance task specificity of neurons.</p><p>It is important to note that (<xref ref-type="bibr" rid="bib38">Mehta et al., 1997</xref>) found that backwards expansion of the place fields was reset between sessions. Later, (<xref ref-type="bibr" rid="bib52">Roth et al., 2012</xref>) found that the resetting of the backwards expanded place fields between sessions was a phenomenon specific to the CA1 and place fields did not reset in CA3. These results suggest that synapses in CA3 vs CA1 may have different plasticity properties. Furthermore, the neocortex may have entirely different synaptic dynamics since its goal is long term storage as opposed to temporal memory encoding. With successive sleep periods, cortical memories become hippocampal independent (<xref ref-type="bibr" rid="bib28">Lehmann and McNamara, 2011</xref>) and this may explain why resetting of the place fields was observed in CA1 (<xref ref-type="bibr" rid="bib38">Mehta et al., 1997</xref>). Our study predicts that the cortical (such as associate cortex) representations of the sequence memories undergo a similar form of backwards expansion as it was observed in CA1. This form of backwards expansion, however, persists and even increases after sleep.</p><p>The phenomena of backwards memory replay and decrease in number of memory replays over time have been observed in rat hippocampus for recent memories. Within the hippocampus, backwards replay is predominantly observed during a post-task awake resting period (<xref ref-type="bibr" rid="bib10">Foster and Wilson, 2006</xref>). The studies of hippocampal replay (<xref ref-type="bibr" rid="bib44">O'Neill et al., 2008</xref>; <xref ref-type="bibr" rid="bib13">Giri et al., 2019</xref>) found decreases in replay of familiar sequences over time, which may occur because of the hippocampal SWRs inducing persistent synaptic depression within the hippocampus (<xref ref-type="bibr" rid="bib43">Norimoto et al., 2018</xref>). We did not observe backwards replay; rather, forward replay in the model persisted during sleep. However, we believe there is no definitive evidence for either backwards replay or decrease in memory replays in the cortex. The opposite, in fact, may be true. Cortical replay of recently formed memories results in a tagging of synapses involved in consolidation of those memories by increasing their synaptic efficacy (<xref ref-type="bibr" rid="bib26">Langille, 2019</xref>). These tagged synapses may likely be reactivated throughout sleep thereby resulting in more cortical replay during both NREM and REM sleep (<xref ref-type="bibr" rid="bib6">Diekelmann and Born, 2010</xref>; <xref ref-type="bibr" rid="bib26">Langille, 2019</xref>).</p><p>To summarize, our study predicts that sleep could prevent catastrophic forgetting and reverse memory damage through replay of old and new memory traces. By selectively replaying new and competing old memories, sleep dynamics not only achieve consolidation of new memories but also provide a mechanism for reorganizing the synaptic connectivity responsible for previously learned memories – re-consolidation of old memory traces – to maximize separation between memory representations. By assigning different subsets of neurons and synapses to primarily represent different memory traces, sleep effectively orthogonalizes memory representations to allow for overlapping populations of neurons to store competing memories and to enable continual learning.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Thalamocortical network model</title><sec id="s4-1-1"><title>Network architecture</title><p>The thalamocortical network model used in this study has been previously described in detail (<xref ref-type="bibr" rid="bib23">Krishnan et al., 2016</xref>; <xref ref-type="bibr" rid="bib71">Wei et al., 2016</xref>; <xref ref-type="bibr" rid="bib72">Wei et al., 2018</xref>) and the code is available in (<ext-link ext-link-type="uri" xlink:href="https://github.com/o2gonzalez/sequenceLearningSleepCode">https://github.com/o2gonzalez/sequenceLearningSleepCode</ext-link>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/sequenceLearningSleepCode">https://github.com/elifesciences-publications/sequenceLearningSleepCode</ext-link>; <xref ref-type="bibr" rid="bib15">González, 2020b</xref>). Briefly, the network was comprised of a thalamus which contained 100 thalamocortical relay neurons (TC) and 100 reticular neurons (RE), and a cortex containing 500 pyramidal neurons (PY) and 100 inhibitory interneurons (IN). The model contained only local network connectivity as described in <xref ref-type="fig" rid="fig1">Figure 1</xref>. Excitatory synaptic connections were mediated by AMPA and NMDA connections, while inhibitory synapses were mediated through GABA<sub>A</sub> and GABA<sub>B</sub>. Starting with the thalamus, TC neurons formed AMPA connections onto RE neurons with a connection radius of 8 (R<sub>AMPA(TC-RE)</sub>=8). RE neurons then projected inhibitory GABA<sub>A</sub> and GABA<sub>B</sub> connections onto TC neurons with R<sub>GABA-A(RE-TC)</sub>=8 and R<sub>GABA-B(RE-TC)</sub>=8. Inhibitory connections between RE-RE neurons were mediated by GABA<sub>A</sub> connections with R<sub>GABA-A(RE-RE)</sub>=5. Within the cortex, PY neurons formed AMPA and NMDA connections onto PYs and INs with R<sub>AMPA(PY-PY)</sub>=20, R<sub>NMDA(PY-PY)</sub>=5, R<sub>AMPA(PY-IN)</sub>=1, and R<sub>NMDA(PY-IN)</sub>=1. PY-PY AMPA connections had a 60% connection probability, while all other connections were deterministic. Cortical inhibitory IN-PY connections were mediated by GABA<sub>A</sub> with R<sub>GABA-A(IN-PY)</sub>=5. Finally, connections between thalamus and cortex were mediated by AMPA connections with R<sub>AMPA(TC-PY)</sub>=15, R<sub>AMPA(TC-IN)</sub>=3, R<sub>AMPA(PY-TC)</sub>=10, and R<sub>AMPA(PY-RE)</sub>=8.</p></sec><sec id="s4-1-2"><title>Wake - Sleep transition</title><p>To model the transitions between wake and sleep states the model included synaptic and intrinsic mechanisms which reflect the changes in neuromodulatory tone during these different arousal states as previously described in <xref ref-type="bibr" rid="bib23">Krishnan et al., 2016</xref>. We included the effects of acetylcholine (ACh), histamine (HA), and GABA. ACh modulated potassium leak currents in all neuron types and excitatory AMPA connections within the cortex only. HA modulated the activation of the hyperpolarization-activated mixed cation current in TC neurons only, and GABA modulated the strength of inhibitory GABAergic synapses in both cortex and thalamus. As compared to the awake state, the levels of ACh and HA were reduced during NREM slow wave sleep, while the level of GABA was increased. This was done to reflect experimental observations of changes in the relative concentrations of ACh, HA, and GABA during different sleep stages (<xref ref-type="bibr" rid="bib68">Vanini et al., 2012</xref>).</p></sec><sec id="s4-1-3"><title>Intrinsic currents</title><p>All neurons were modeled with Hodgkin-Huxley kinetics. Cortical PY and IN neurons contained dendritic and axo-somatic compartments as previously described (<xref ref-type="bibr" rid="bib72">Wei et al., 2018</xref>). The membrane potential dynamics were modeled by the following equation:<disp-formula id="equ1"><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mo>−</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>a</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mi>V</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ2"><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>a</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf1"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the membrane capacitance, <inline-formula><mml:math id="inf2"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>,</mml:mo></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are the dendritic and axo-somatic membrane voltages respectively, <inline-formula><mml:math id="inf3"><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is the fast sodium (Na<sup>+</sup>) current, <inline-formula><mml:math id="inf4"><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>a</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is the persistent Na<sup>+</sup> current, <inline-formula><mml:math id="inf5"><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is the slow voltage-dependent non-inactivating potassium (K<sup>+</sup>) current, <inline-formula><mml:math id="inf6"><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is the slow calcium (Ca<sup>2+</sup>)-dependent K<sup>+</sup> current, <inline-formula><mml:math id="inf7"><mml:mi>A</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> represents the change in K<sup>+</sup> leak current <inline-formula><mml:math id="inf8"><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> which is dependent on the level of acetylcholine (ACh) during the different stages of wake and sleep, <inline-formula><mml:math id="inf9"><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mi>V</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is the high-threshold Ca<sup>2+</sup> current, <inline-formula><mml:math id="inf10"><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is the chloride (Cl<sup>-</sup>) leak current, <inline-formula><mml:math id="inf11"><mml:mi>g</mml:mi></mml:math></inline-formula> is the conductance between the dendritic and axo-somatic compartments, and <inline-formula><mml:math id="inf12"><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is the total synaptic current input to the neuron (see next section for details). IN neurons contained all intrinsic currents present in PY with the exception of the <inline-formula><mml:math id="inf13"><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>a</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>. All intrinsic ionic currents (<inline-formula><mml:math id="inf14"><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>) were modeled in a similar form:<disp-formula id="equ3"><mml:math id="m3"><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msup><mml:mfenced separators="|"><mml:mrow><mml:mi>V</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></disp-formula>where <inline-formula><mml:math id="inf15"><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the maximal conductance, <inline-formula><mml:math id="inf16"><mml:mi>m</mml:mi></mml:math></inline-formula> (activation) and <inline-formula><mml:math id="inf17"><mml:mi>h</mml:mi></mml:math></inline-formula> (inactivation) are the gating variables, <inline-formula><mml:math id="inf18"><mml:mi>V</mml:mi></mml:math></inline-formula> is the voltage of the corresponding compartment, and <inline-formula><mml:math id="inf19"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the reversal potential of the ionic current. The gating variable dynamics are described as follows:<disp-formula id="equ4"><mml:math id="m4"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>∞</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mi/><mml:mo>,</mml:mo></mml:math></disp-formula><disp-formula id="equ5"><mml:math id="m5"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math></disp-formula><disp-formula id="equ6"><mml:math id="m6"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>∞</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula><mml:math id="inf20"><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>m</mml:mi></mml:math></inline-formula> or <inline-formula><mml:math id="inf21"><mml:mi>h</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf22"><mml:mi>τ</mml:mi></mml:math></inline-formula> is the time constant, <inline-formula><mml:math id="inf23"><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the temperature related term, <inline-formula><mml:math id="inf24"><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo> <mml:mi/><mml:msup><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>23</mml:mn><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mn>10</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>2.9529</mml:mn></mml:math></inline-formula>, with <inline-formula><mml:math id="inf25"><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mn>2.3</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf26"><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>36</mml:mn><mml:mo>.</mml:mo></mml:math></inline-formula></p><p>Thalamic neurons (TC and RE) were modeled as single compartment neurons with membrane potential dynamics mediated by the following equation:<disp-formula id="equ7"><mml:math id="m7"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo> <mml:mi/><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mi>A</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msup><mml:mo>-</mml:mo> <mml:mi/><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula><mml:math id="inf27"><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is the fast Na<sup>+</sup> current, <inline-formula><mml:math id="inf28"><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is the fast K<sup>+</sup> current, <inline-formula><mml:math id="inf29"><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is the K<sup>+</sup> leak current, <inline-formula><mml:math id="inf30"><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is the low-threshold Ca<sup>2+</sup> current, <inline-formula><mml:math id="inf31"><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is the hyperpolarization-activated mixed cation current, <inline-formula><mml:math id="inf32"><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is the Cl<sup>-</sup> leak current, and <inline-formula><mml:math id="inf33"><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is the total synaptic current input to the neurons (see next section for details). The <inline-formula><mml:math id="inf34"><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> was only expressed in the TC neurons and not the RE neurons. The influence of histamine (HA) on <inline-formula><mml:math id="inf35"><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> was implemented as a shift in the activation curve by <inline-formula><mml:math id="inf36"><mml:mi>H</mml:mi><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> as described by:<disp-formula id="equ8"><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>V</mml:mi><mml:mo>+</mml:mo><mml:mn>75</mml:mn><mml:mo>+</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mn>5.5</mml:mn></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>A detailed description of the individual currents can be found in our previous studies (<xref ref-type="bibr" rid="bib23">Krishnan et al., 2016</xref>; <xref ref-type="bibr" rid="bib72">Wei et al., 2018</xref>).</p></sec><sec id="s4-1-4"><title>Synaptic currents and spike-timing dependent plasticity (STDP)</title><p>AMPA, NMDA, and GABA<sub>A</sub> synaptic current equations were described in detail in our previous studies (<xref ref-type="bibr" rid="bib23">Krishnan et al., 2016</xref>; <xref ref-type="bibr" rid="bib72">Wei et al., 2018</xref>). The effects of ACh on GABA<sub>A</sub> and AMPA synaptic currents in our model are described by the following equations:<disp-formula id="equ9"><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mi>O</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ10"><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mi>M</mml:mi><mml:mi>P</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>A</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>M</mml:mi><mml:mi>P</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mi>O</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf37"><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the maximal conductance at the synapse, <inline-formula><mml:math id="inf38"><mml:mo>[</mml:mo><mml:mi>O</mml:mi><mml:mo>]</mml:mo></mml:math></inline-formula> is the fraction of open channels, and <inline-formula><mml:math id="inf39"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the channel reversal potential (E<sub>GABA-A</sub> = -70 mV, E<sub>AMPA</sub> = 0 mV, and E<sub>NMDA</sub> = 0 mv). Parameter <inline-formula><mml:math id="inf40"><mml:mi>γ</mml:mi><mml:msub><mml:mrow/><mml:mrow><mml:mi>G</mml:mi><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> modulates the GABA synaptic currents for IN-PY, RE-RE, and RE-TC connections. For IN neurons <inline-formula><mml:math id="inf41"><mml:mi>γ</mml:mi><mml:msub><mml:mrow/><mml:mrow><mml:mi>G</mml:mi><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> was 0.22 and 0.44 for awake and N3 sleep, respectively; <inline-formula><mml:math id="inf42"><mml:mi>γ</mml:mi><mml:msub><mml:mrow/><mml:mrow><mml:mi>G</mml:mi><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> for RE was 0.6 and 1.2 for awake and N3 sleep. <inline-formula><mml:math id="inf43"><mml:mi>A</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mi>M</mml:mi><mml:mi>P</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> defines the influence of ACh levels on AMPA synaptic currents for PY-PY, TC-PY, and TC-IN. <inline-formula><mml:math id="inf44"><mml:mi>A</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mi>M</mml:mi><mml:mi>P</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for PY was 0.133 and 0.4332 for awake and N3 sleep. <inline-formula><mml:math id="inf45"><mml:mi>A</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mi>M</mml:mi><mml:mi>P</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for TC is 0.6 and1.2 for awake and N3 sleep.</p><p>Spontaneous miniature excitatory post-synaptic potentials (EPSPs) and inhibitory post-synaptic potentials (IPSPs) were implemented for PY-PY, PY-IN, and IN-PY connections. The synaptic dynamics were similar to regular post-synaptic potentials (PSPs) described above and their arrival times were modeled by a Poisson process with time-dependent mean rate, with next release time <inline-formula><mml:math id="inf46"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> given by:<disp-formula id="equ11"><mml:math id="m11"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo> <mml:mi/><mml:mi>﻿</mml:mi><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn> <mml:mi/><mml:mo>+</mml:mo> <mml:mi/><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mi>υ</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mn>250</mml:mn> <mml:mi/><mml:mo>,</mml:mo></mml:math></disp-formula>where ﻿<inline-formula><mml:math id="inf47"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is the time of the last presynaptic spike. The maximal conductances for miniature PSPs were <inline-formula><mml:math id="inf48"><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mi>Y</mml:mi><mml:mo>-</mml:mo><mml:mi>P</mml:mi><mml:mi>Y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mi>M</mml:mi><mml:mi>P</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.03</mml:mn> <mml:mi/><mml:mi>μ</mml:mi><mml:mi>S</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf49"><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mi>Y</mml:mi><mml:mo>-</mml:mo><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mi>M</mml:mi><mml:mi>P</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.02</mml:mn> <mml:mi/><mml:mi>μ</mml:mi><mml:mi>S</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf50"><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mi>P</mml:mi><mml:mi>Y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.02</mml:mn> <mml:mi/><mml:mi>μ</mml:mi><mml:mi>S</mml:mi></mml:math></inline-formula>. <inline-formula><mml:math id="inf51"><mml:mi>υ</mml:mi></mml:math></inline-formula> is the mini PSP frequency: <inline-formula><mml:math id="inf52"><mml:msubsup><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mi>Y</mml:mi><mml:mo>-</mml:mo><mml:mi>P</mml:mi><mml:mi>Y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mi>M</mml:mi><mml:mi>P</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo> <mml:mi/><mml:mn>30</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf53"><mml:msubsup><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mi>Y</mml:mi><mml:mo>-</mml:mo><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mi>M</mml:mi><mml:mi>P</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo> <mml:mi/><mml:mn>30</mml:mn></mml:math></inline-formula>, and <inline-formula><mml:math id="inf54"><mml:msubsup><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mi>P</mml:mi><mml:mi>Y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo> <mml:mi/><mml:mn>30</mml:mn></mml:math></inline-formula>. Short-term depression of intracortical AMPA synapses was included. The maximal synaptic conductance was multiplied by a depression variable (<inline-formula><mml:math id="inf55"><mml:mi>D</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>), which represents the amount of available 'synaptic resources' as described in <xref ref-type="bibr" rid="bib2">Bazhenov et al., 2002</xref>. This short-term depression was modeled as follows:<disp-formula id="equ12"><mml:math id="m12"><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>U</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math></disp-formula>where <inline-formula><mml:math id="inf56"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the value of <inline-formula><mml:math id="inf57"><mml:mi>D</mml:mi></mml:math></inline-formula> immediately before the <inline-formula><mml:math id="inf58"><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> event, <inline-formula><mml:math id="inf59"><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> is the time after the <inline-formula><mml:math id="inf60"><mml:msub><mml:mrow><mml:mi>i</mml:mi> <mml:mi/></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> event, <inline-formula><mml:math id="inf61"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:mn>0.073</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> is the fraction of synaptic resources used per action potential, and <inline-formula><mml:math id="inf62"><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>700</mml:mn><mml:mi>m</mml:mi><mml:mi>s</mml:mi></mml:math></inline-formula> is time constant of recovery of synaptic resources.</p><p>Potentiation and depression of synaptic weights between PY neurons were regulated by spike-timing dependent plasticity (STDP). The changes in synaptic strength (g<sub>AMPA</sub>) and the amplitude of miniature EPSPs (A<sub>mEPSP</sub>) have been described previously (<xref ref-type="bibr" rid="bib72">Wei et al., 2018</xref>):<disp-formula id="equ13"><mml:math id="m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>M</mml:mi><mml:mi>P</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>M</mml:mi><mml:mi>P</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ14"><mml:math id="m14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>E</mml:mi><mml:mi>P</mml:mi><mml:mi>S</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>E</mml:mi><mml:mi>P</mml:mi><mml:mi>S</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>Y</mml:mi><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf63"><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the maximal conductance of <inline-formula><mml:math id="inf64"><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mi>M</mml:mi><mml:mi>P</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and f = 0.01 represents the slower change of STDP on <inline-formula><mml:math id="inf65"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>E</mml:mi><mml:mi>P</mml:mi><mml:mi>S</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> as compared to <inline-formula><mml:math id="inf66"><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mi>M</mml:mi><mml:mi>P</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. The STDP function F is dependent on the relative timing (Δt) of the pre- and post-synaptic spikes and is defined by:<disp-formula id="equ15"><mml:math id="m15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" displaystyle="false" rowspacing=".2em"><mml:mtr><mml:mtd><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>−</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>&lt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where A<sub>+/-</sub> set the maximum amplitude of synaptic change. A<sub>+/-</sub> = 0.002 and τ<sub>+/-</sub> = 20 ms. A<sub>-</sub> was reduced to 0.001 during training to reflect the effects of changes in acetylcholine concentration during focused attention on synaptic depression during task learning observed experimentally (<xref ref-type="bibr" rid="bib4">Blokland, 1995</xref>; <xref ref-type="bibr" rid="bib56">Shinoe et al., 2005</xref>; <xref ref-type="bibr" rid="bib63">Sugisaki et al., 2016</xref>).</p></sec><sec id="s4-1-5"><title>Sequence training and testing</title><p>Training and testing of memory sequences was performed similar to our previous study (<xref ref-type="bibr" rid="bib72">Wei et al., 2018</xref>). Briefly, trained sequences were comprised of 5 groups of 10 sequential PY neurons. Each group of 10 were sequentially activated by a 10 ms DC pulse with 5 ms delay between subsequent group pulses. This activation scheme was applied every 1 s throughout the duration of the training period. Sequence 1 (S1) consisted of PY groups (in order of activation): A(200-209), B(210-219), C(220-229), D(230-239), E(240-249). Sequence 2 (S2) consisted of PY groups (in order of activation): W(360-369), V(350-359), X(370-379), Y(380-389), Z(390-399) and can be referred as non-linear due to the non-spatially sequential activations of group W, V, and X. Sequence 1* (S1*) was trained over the same population of neurons trained on S1 but in the reverse activation order (i.e. E-D-C-B-A). During testing, the network was presented with only the activation of the first group of a given sequence (A for S1, W for S2, and E for S1*). Performance was measured based on the network’s ability to recall/complete the remainder of the sequence (i.e. A-B-C-D-E for S1) within a 350 ms time window. Similar to training, test activation pulses were applied every 1 s throughout the testing period. Training and testing of the sequences occurred sequentially as opposed to simultaneously as in our previous study (<xref ref-type="bibr" rid="bib72">Wei et al., 2018</xref>).</p></sec></sec><sec id="s4-2"><title>Data analysis</title><p>All analyses were performed with standard MatLab and Python functions. Data are presented as mean ± standard error of the mean (SEM) unless otherwise stated. For each experiment a total of 10 simulations with different random seeds were used for statistical analysis.</p><sec id="s4-2-1"><title>Sequence performance measure</title><p>A detailed description of the performance measure used during testing can be found in <xref ref-type="bibr" rid="bib72">Wei et al., 2018</xref> and the code is available in (<ext-link ext-link-type="uri" xlink:href="https://github.com/o2gonzalez/sequencePerformanceAnalysis">https://github.com/o2gonzalez/sequencePerformanceAnalysis</ext-link>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/sequencePerformanceAnalysis">https://github.com/elifesciences-publications/sequencePerformanceAnalysis</ext-link>; <xref ref-type="bibr" rid="bib14">González, 2020a</xref>). Briefly, the performance of the network on recalling a given sequence following activation of the first group of that sequence (see <italic>Methods and Materials</italic>: <italic>Sequence training and testing</italic>) was measured by the percent of successful sequence recalls. We first detected all spikes within the predefined 350 ms time window for all 5 groups of neurons in a sequence. The firing rate of each group was then smoothed by convolving the average instantaneous firing rate of the group’s 10 neurons with a Gaussian kernel with window size of 50 ms. We then sorted the peaks of the smoothed firing rates during the 350 ms window to determine the ordering of group activations. Next, we applied a string match (SM) method to determine the similarity between the detected sequences and an ideal sequence (ie. A-B-C-D-E for S1). SM was calculated using the following equation:<disp-formula id="equ16"><mml:math id="m16"><mml:mi>S</mml:mi><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>*</mml:mi><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mfenced close="|" open="|" separators="|"><mml:mrow><mml:mi>L</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>where N is the sequence length of S<sub>test</sub>, S<sub>test</sub> is the test sequence generated by the network during testing, S<sub>sub</sub> is a subset of the ideal sequence that only contains the same elements of S<sub>test</sub>, and <inline-formula><mml:math id="inf67"><mml:mi>L</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math></inline-formula> is the location of the element S<sub>sub</sub>[i] in sequence S<sub>test</sub>. SM was then normalized by double the length of the ideal sequence. Finally, the performance was calculated as the percent of recalled sequences with SM≥Th, where Th is the selected threshold (here, Th = 0.8) indicating that the recalled sequence must be at least 80% similar to the ideal sequence to be counted as a successful recall as previously done in <xref ref-type="bibr" rid="bib72">Wei et al., 2018</xref>.</p></sec><sec id="s4-2-2"><title>Sequence replay during N3 sleep</title><p>To find out whether a trained sequence is replayed in the trained region of the network during the Up state of a slow-wave in N3 sleep, we first identified the beginning and the end of each Up state by considering sorted spike times of neurons in each group. For each group, the time instances of consecutive spikes that occur within a 15 ms window were considered as candidate members of an Up state, where the window size was determined to decrease the chance of two spikes of the same neuron within the window. To eliminate spontaneous spiking activity of a group that satisfies the above condition but is not part of an Up state, we additionally required that the period between two upstate was at least 300 ms, which corresponds to a cortical Down state. The values for window durations reported above were identified to maximize the performance of the Up state search algorithm.</p><p>Once all Up states were determined, we defined the time instances when groups were active in each Up state. A group was defined as active if the number of neurons from the group that spikes during 15 ms exceeded the activation threshold, and the instance when the group is active was defined as the average over spike times of a subgroup of neurons with the size equals to the activation threshold within the 15 ms window. In our study the activation threshold was selected to be half of a group size (i.e. five neurons). Using sorted time instances when groups are active, we counted the number of times a possible transition between arbitrary groups, and if all four transitions of a sequence were observed sequentially in the right order then we counted that as a replay of the sequence.</p></sec><sec id="s4-2-3"><title>Analysis of total sequence specific synaptic input</title><p>For every neuron from a group we computed the total synaptic weight ‘from left’ and ‘to right’, by considering the sum of all weights of synapses projecting to the neuron from neurons in preceding group, with respect to propagation of activity within a memory sequence if such a group exists, and the sum of all weights of synaptic connections from the neuron to the following group, if there is such a group. We omitted all synaptic connections within the group to which the neuron, for which the total synaptic weight is computed, belongs.</p></sec><sec id="s4-2-4"><title>Weight directionality index</title><p>To see how learning recruits neurons in encoding one of the competing sequences, we looked at the evolution of deviation from the center of unit square in a two dimensional subspace of total synaptic input from left and right neighboring neuronal groups. For this, we first found the total synaptic input from both sides, embedded it into a unit square, and computed Euclidean distance from the center of the square.<disp-formula id="equ17"><mml:math id="m17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>W</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>t</mml:mi><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mtext> </mml:mtext><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>0.5</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>0.5</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf68"><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:math></inline-formula> (<inline-formula><mml:math id="inf69"><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:math></inline-formula>) is the total synaptic input to a neuron from its left (right) neighboring neuronal group.</p></sec><sec id="s4-2-5"><title>Delay directionality index</title><p>To see whether neurons respond preferentially to one of the sequences, we evaluated signed (<xref ref-type="fig" rid="fig8">Figure 8B</xref>) and unsigned (<xref ref-type="fig" rid="fig8">Figure 8C, D</xref>) delay directionality indices, which are defined as follows. For each neuron, we found its response delays, <inline-formula><mml:math id="inf70"><mml:mo>∆</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf71"><mml:mo>∆</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mi>*</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, after corresponding left and right neighboring neuronal groups were stimulated, respectively. Using these quantities, we computed the indices as<disp-formula id="equ18"><mml:math id="m18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mo>∗</mml:mo></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mo>∗</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ19"><mml:math id="m19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mo>∗</mml:mo></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mo>∗</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p></sec></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>This work was supported by the Lifelong Learning Machines program from DARPA/MTO (HR0011-18-2-0021) and ONR (MURI: N00014-16-1-2829).</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Data curation, Software, Formal analysis, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Software, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con4"><p>Data curation, Software, Formal analysis, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Supervision, Funding acquisition, Writing - original draft, Project administration, Writing - review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-51005-transrepform-v2.pdf"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>Computational models were used exclusively in this study. The model is fully described in the Methods section and code has been deposited to <ext-link ext-link-type="uri" xlink:href="https://github.com/o2gonzalez/sequenceLearningSleepCode">https://github.com/o2gonzalez/sequenceLearningSleepCode</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/sequenceLearningSleepCode">https://github.com/elifesciences-publications/sequenceLearningSleepCode</ext-link>).</p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Atienza</surname> <given-names>M</given-names></name><name><surname>Cantero</surname> <given-names>JL</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Complex sound processing during human REM sleep by recovering information from long-term memory as revealed by the mismatch negativity (MMN)</article-title><source>Brain Research</source><volume>901</volume><fpage>151</fpage><lpage>160</lpage><pub-id pub-id-type="doi">10.1016/S0006-8993(01)02340-X</pub-id><pub-id pub-id-type="pmid">11368962</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bazhenov</surname> <given-names>M</given-names></name><name><surname>Timofeev</surname> <given-names>I</given-names></name><name><surname>Steriade</surname> <given-names>M</given-names></name><name><surname>Sejnowski</surname> <given-names>TJ</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Model of thalamocortical slow-wave sleep oscillations and transitions to activated states</article-title><source>The Journal of Neuroscience</source><volume>22</volume><fpage>8691</fpage><lpage>8704</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.22-19-08691.2002</pub-id><pub-id pub-id-type="pmid">12351744</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blake</surname> <given-names>H</given-names></name><name><surname>Gerard</surname> <given-names>RW</given-names></name></person-group><year iso-8601-date="1937">1937</year><article-title>Brain potentials during sleep</article-title><source>American Journal of Physiology-Legacy Content</source><volume>119</volume><fpage>692</fpage><lpage>703</lpage><pub-id pub-id-type="doi">10.1152/ajplegacy.1937.119.4.692</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blokland</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Acetylcholine: a neurotransmitter for learning and memory?</article-title><source>Brain Research Reviews</source><volume>21</volume><fpage>285</fpage><lpage>300</lpage><pub-id pub-id-type="doi">10.1016/0165-0173(95)00016-X</pub-id><pub-id pub-id-type="pmid">8806017</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clemens</surname> <given-names>Z</given-names></name><name><surname>Fabó</surname> <given-names>D</given-names></name><name><surname>Halász</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Overnight verbal memory retention correlates with the number of sleep spindles</article-title><source>Neuroscience</source><volume>132</volume><fpage>529</fpage><lpage>535</lpage><pub-id pub-id-type="doi">10.1016/j.neuroscience.2005.01.011</pub-id><pub-id pub-id-type="pmid">15802203</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Diekelmann</surname> <given-names>S</given-names></name><name><surname>Born</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>The memory function of sleep</article-title><source>Nature Reviews Neuroscience</source><volume>11</volume><fpage>114</fpage><lpage>126</lpage><pub-id pub-id-type="doi">10.1038/nrn2762</pub-id><pub-id pub-id-type="pmid">20046194</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Euston</surname> <given-names>DR</given-names></name><name><surname>Tatsuno</surname> <given-names>M</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Fast-forward playback of recent memory sequences in prefrontal cortex during sleep</article-title><source>Science</source><volume>318</volume><fpage>1147</fpage><lpage>1150</lpage><pub-id pub-id-type="doi">10.1126/science.1148979</pub-id><pub-id pub-id-type="pmid">18006749</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fachechi</surname> <given-names>A</given-names></name><name><surname>Agliari</surname> <given-names>E</given-names></name><name><surname>Barra</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Dreaming neural networks: forgetting spurious memories and reinforcing pure ones</article-title><source>Neural Networks</source><volume>112</volume><fpage>24</fpage><lpage>40</lpage><pub-id pub-id-type="doi">10.1016/j.neunet.2019.01.006</pub-id><pub-id pub-id-type="pmid">30735914</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fogel</surname> <given-names>SM</given-names></name><name><surname>Smith</surname> <given-names>CT</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Learning-dependent changes in sleep spindles and stage 2 sleep</article-title><source>Journal of Sleep Research</source><volume>15</volume><fpage>250</fpage><lpage>255</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2869.2006.00522.x</pub-id><pub-id pub-id-type="pmid">16911026</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foster</surname> <given-names>DJ</given-names></name><name><surname>Wilson</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Reverse replay of behavioural sequences in hippocampal place cells during the awake state</article-title><source>Nature</source><volume>440</volume><fpage>680</fpage><lpage>683</lpage><pub-id pub-id-type="doi">10.1038/nature04587</pub-id><pub-id pub-id-type="pmid">16474382</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>French</surname> <given-names>RM</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Catastrophic forgetting in connectionist networks</article-title><source>Trends in Cognitive Sciences</source><volume>3</volume><fpage>128</fpage><lpage>135</lpage><pub-id pub-id-type="doi">10.1016/S1364-6613(99)01294-2</pub-id><pub-id pub-id-type="pmid">10322466</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ghandour</surname> <given-names>K</given-names></name><name><surname>Ohkawa</surname> <given-names>N</given-names></name><name><surname>Fung</surname> <given-names>CCA</given-names></name><name><surname>Asai</surname> <given-names>H</given-names></name><name><surname>Saitoh</surname> <given-names>Y</given-names></name><name><surname>Takekawa</surname> <given-names>T</given-names></name><name><surname>Okubo-Suzuki</surname> <given-names>R</given-names></name><name><surname>Soya</surname> <given-names>S</given-names></name><name><surname>Nishizono</surname> <given-names>H</given-names></name><name><surname>Matsuo</surname> <given-names>M</given-names></name><name><surname>Osanai</surname> <given-names>M</given-names></name><name><surname>Sato</surname> <given-names>M</given-names></name><name><surname>Ohkura</surname> <given-names>M</given-names></name><name><surname>Nakai</surname> <given-names>J</given-names></name><name><surname>Hayashi</surname> <given-names>Y</given-names></name><name><surname>Sakurai</surname> <given-names>T</given-names></name><name><surname>Kitamura</surname> <given-names>T</given-names></name><name><surname>Fukai</surname> <given-names>T</given-names></name><name><surname>Inokuchi</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Orchestrated ensemble activities constitute a hippocampal memory engram</article-title><source>Nature Communications</source><volume>10</volume><elocation-id>2637</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-019-10683-2</pub-id><pub-id pub-id-type="pmid">31201332</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Giri</surname> <given-names>B</given-names></name><name><surname>Miyawaki</surname> <given-names>H</given-names></name><name><surname>Mizuseki</surname> <given-names>K</given-names></name><name><surname>Cheng</surname> <given-names>S</given-names></name><name><surname>Diba</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Hippocampal reactivation extends for several hours following novel experience</article-title><source>The Journal of Neuroscience</source><volume>39</volume><fpage>866</fpage><lpage>875</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1950-18.2018</pub-id><pub-id pub-id-type="pmid">30530857</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>González</surname> <given-names>OC</given-names></name></person-group><year iso-8601-date="2020">2020a</year><data-title>sequence Performancen Analysis</data-title><source>GitHub</source><version designator="094c4be">094c4be</version><ext-link ext-link-type="uri" xlink:href="https://github.com/o2gonzalez/sequencePerformanceAnalysis">https://github.com/o2gonzalez/sequencePerformanceAnalysis</ext-link></element-citation></ref><ref id="bib15"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>González</surname> <given-names>OC</given-names></name></person-group><year iso-8601-date="2020">2020b</year><data-title><italic>sequence Learning SleepCode</italic></data-title><source>GitHub</source><version designator="a1eaace">a1eaace</version><ext-link ext-link-type="uri" xlink:href="https://github.com/o2gonzalez/sequenceLearningSleepCode">https://github.com/o2gonzalez/sequenceLearningSleepCode</ext-link></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hassabis</surname> <given-names>D</given-names></name><name><surname>Kumaran</surname> <given-names>D</given-names></name><name><surname>Summerfield</surname> <given-names>C</given-names></name><name><surname>Botvinick</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Neuroscience-Inspired artificial intelligence</article-title><source>Neuron</source><volume>95</volume><fpage>245</fpage><lpage>258</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.06.011</pub-id><pub-id pub-id-type="pmid">28728020</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hasselmo</surname> <given-names>ME</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Avoiding catastrophic forgetting</article-title><source>Trends in Cognitive Sciences</source><volume>21</volume><fpage>407</fpage><lpage>408</lpage><pub-id pub-id-type="doi">10.1016/j.tics.2017.04.001</pub-id><pub-id pub-id-type="pmid">28442279</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname> <given-names>LA</given-names></name><name><surname>Euston</surname> <given-names>DR</given-names></name><name><surname>Tatsuno</surname> <given-names>M</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Stored-trace reactivation in rat prefrontal cortex is correlated with down-to-up state fluctuation density</article-title><source>Journal of Neuroscience</source><volume>30</volume><fpage>2650</fpage><lpage>2661</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1617-09.2010</pub-id><pub-id pub-id-type="pmid">20164349</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Joo</surname> <given-names>HR</given-names></name><name><surname>Frank</surname> <given-names>LM</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>The hippocampal sharp wave-ripple in memory retrieval for immediate use and consolidation</article-title><source>Nature Reviews Neuroscience</source><volume>19</volume><fpage>744</fpage><lpage>757</lpage><pub-id pub-id-type="doi">10.1038/s41583-018-0077-1</pub-id><pub-id pub-id-type="pmid">30356103</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Kemker</surname> <given-names>R</given-names></name><name><surname>Kanan</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>FearNet: brain-inspired model for incremental learning</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1711.10563">https://arxiv.org/abs/1711.10563</ext-link></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kirkpatrick</surname> <given-names>J</given-names></name><name><surname>Pascanu</surname> <given-names>R</given-names></name><name><surname>Rabinowitz</surname> <given-names>N</given-names></name><name><surname>Veness</surname> <given-names>J</given-names></name><name><surname>Desjardins</surname> <given-names>G</given-names></name><name><surname>Rusu</surname> <given-names>AA</given-names></name><name><surname>Milan</surname> <given-names>K</given-names></name><name><surname>Quan</surname> <given-names>J</given-names></name><name><surname>Ramalho</surname> <given-names>T</given-names></name><name><surname>Grabska-Barwinska</surname> <given-names>A</given-names></name><name><surname>Hassabis</surname> <given-names>D</given-names></name><name><surname>Clopath</surname> <given-names>C</given-names></name><name><surname>Kumaran</surname> <given-names>D</given-names></name><name><surname>Hadsell</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Overcoming catastrophic forgetting in neural networks</article-title><source>PNAS</source><volume>114</volume><fpage>3521</fpage><lpage>3526</lpage><pub-id pub-id-type="doi">10.1073/pnas.1611835114</pub-id><pub-id pub-id-type="pmid">28292907</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kriegeskorte</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Deep neural networks: a new framework for modeling biological vision and brain information processing</article-title><source>Annual Review of Vision Science</source><volume>1</volume><fpage>417</fpage><lpage>446</lpage><pub-id pub-id-type="doi">10.1146/annurev-vision-082114-035447</pub-id><pub-id pub-id-type="pmid">28532370</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krishnan</surname> <given-names>GP</given-names></name><name><surname>Chauvette</surname> <given-names>S</given-names></name><name><surname>Shamie</surname> <given-names>I</given-names></name><name><surname>Soltani</surname> <given-names>S</given-names></name><name><surname>Timofeev</surname> <given-names>I</given-names></name><name><surname>Cash</surname> <given-names>SS</given-names></name><name><surname>Halgren</surname> <given-names>E</given-names></name><name><surname>Bazhenov</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Cellular and neurochemical basis of sleep stages in the thalamocortical network</article-title><source>eLife</source><volume>5</volume><elocation-id>e18607</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.18607</pub-id><pub-id pub-id-type="pmid">27849520</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Krishnan</surname> <given-names>GP</given-names></name><name><surname>Tadros</surname> <given-names>T</given-names></name><name><surname>Ramyaa</surname> <given-names>R</given-names></name><name><surname>Bazhenov</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Biologically inspired sleep algorithm for artificial neural networks</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1908.02240">https://arxiv.org/abs/1908.02240</ext-link></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ladenbauer</surname> <given-names>J</given-names></name><name><surname>Ladenbauer</surname> <given-names>J</given-names></name><name><surname>Külzow</surname> <given-names>N</given-names></name><name><surname>de Boor</surname> <given-names>R</given-names></name><name><surname>Avramova</surname> <given-names>E</given-names></name><name><surname>Grittner</surname> <given-names>U</given-names></name><name><surname>Flöel</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Promoting sleep oscillations and their functional coupling by transcranial stimulation enhances memory consolidation in mild cognitive impairment</article-title><source>The Journal of Neuroscience</source><volume>37</volume><fpage>7111</fpage><lpage>7124</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0260-17.2017</pub-id><pub-id pub-id-type="pmid">28637840</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langille</surname> <given-names>JJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Remembering to forget: a dual role for sleep oscillations in memory consolidation and forgetting</article-title><source>Frontiers in Cellular Neuroscience</source><volume>13</volume><elocation-id>71</elocation-id><pub-id pub-id-type="doi">10.3389/fncel.2019.00071</pub-id><pub-id pub-id-type="pmid">30930746</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laventure</surname> <given-names>S</given-names></name><name><surname>Fogel</surname> <given-names>S</given-names></name><name><surname>Lungu</surname> <given-names>O</given-names></name><name><surname>Albouy</surname> <given-names>G</given-names></name><name><surname>Sévigny-Dupont</surname> <given-names>P</given-names></name><name><surname>Vien</surname> <given-names>C</given-names></name><name><surname>Sayour</surname> <given-names>C</given-names></name><name><surname>Carrier</surname> <given-names>J</given-names></name><name><surname>Benali</surname> <given-names>H</given-names></name><name><surname>Doyon</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>NREM2 and sleep spindles are instrumental to the consolidation of motor sequence memories</article-title><source>PLOS Biology</source><volume>14</volume><elocation-id>e1002429</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1002429</pub-id><pub-id pub-id-type="pmid">27032084</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lehmann</surname> <given-names>H</given-names></name><name><surname>McNamara</surname> <given-names>KC</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Repeatedly reactivated memories become more resistant to hippocampal damage</article-title><source>Learning &amp; Memory</source><volume>18</volume><fpage>132</fpage><lpage>135</lpage><pub-id pub-id-type="doi">10.1101/lm.2000811</pub-id><pub-id pub-id-type="pmid">21325434</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Louie</surname> <given-names>K</given-names></name><name><surname>Wilson</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Temporally structured replay of awake hippocampal ensemble activity during rapid eye movement sleep</article-title><source>Neuron</source><volume>29</volume><fpage>145</fpage><lpage>156</lpage><pub-id pub-id-type="doi">10.1016/S0896-6273(01)00186-6</pub-id><pub-id pub-id-type="pmid">11182087</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marshall</surname> <given-names>L</given-names></name><name><surname>Mölle</surname> <given-names>M</given-names></name><name><surname>Hallschmid</surname> <given-names>M</given-names></name><name><surname>Born</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Transcranial direct current stimulation during sleep improves declarative memory</article-title><source>Journal of Neuroscience</source><volume>24</volume><fpage>9985</fpage><lpage>9992</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2725-04.2004</pub-id><pub-id pub-id-type="pmid">15525784</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marshall</surname> <given-names>L</given-names></name><name><surname>Helgadóttir</surname> <given-names>H</given-names></name><name><surname>Mölle</surname> <given-names>M</given-names></name><name><surname>Born</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Boosting slow oscillations during sleep potentiates memory</article-title><source>Nature</source><volume>444</volume><fpage>610</fpage><lpage>613</lpage><pub-id pub-id-type="doi">10.1038/nature05278</pub-id><pub-id pub-id-type="pmid">17086200</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McClelland</surname> <given-names>JL</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name><name><surname>O'Reilly</surname> <given-names>RC</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Why there are complementary learning systems in the Hippocampus and neocortex: insights from the successes and failures of connectionist models of learning and memory</article-title><source>Psychological Review</source><volume>102</volume><fpage>419</fpage><lpage>457</lpage><pub-id pub-id-type="doi">10.1037/0033-295X.102.3.419</pub-id><pub-id pub-id-type="pmid">7624455</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McClelland</surname> <given-names>JL</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name><name><surname>Lampinen</surname> <given-names>AK</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Integration of new information in memory: new insights from a complementary learning systems perspective</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>375</volume><elocation-id>20190637</elocation-id><pub-id pub-id-type="doi">10.1098/rstb.2019.0637</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mccloskey</surname> <given-names>M</given-names></name><name><surname>Cohen</surname> <given-names>NJ</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>Catastrophic interference in connectionist networks: the sequential learning problem</article-title><source>The Psychology of Learning and Motivation</source><volume>24</volume><fpage>109</fpage><lpage>165</lpage><pub-id pub-id-type="doi">10.1016/S0079-7421(08)60536-8</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McCormick</surname> <given-names>DA</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Neurotransmitter actions in the thalamus and cerebral cortex and their role in neuromodulation of thalamocortical activity</article-title><source>Progress in Neurobiology</source><volume>39</volume><fpage>337</fpage><lpage>388</lpage><pub-id pub-id-type="doi">10.1016/0301-0082(92)90012-4</pub-id><pub-id pub-id-type="pmid">1354387</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McDevitt</surname> <given-names>EA</given-names></name><name><surname>Duggan</surname> <given-names>KA</given-names></name><name><surname>Mednick</surname> <given-names>SC</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>REM sleep rescues learning from interference</article-title><source>Neurobiology of Learning and Memory</source><volume>122</volume><fpage>51</fpage><lpage>62</lpage><pub-id pub-id-type="doi">10.1016/j.nlm.2014.11.015</pub-id><pub-id pub-id-type="pmid">25498222</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mednick</surname> <given-names>SC</given-names></name><name><surname>McDevitt</surname> <given-names>EA</given-names></name><name><surname>Walsh</surname> <given-names>JK</given-names></name><name><surname>Wamsley</surname> <given-names>E</given-names></name><name><surname>Paulus</surname> <given-names>M</given-names></name><name><surname>Kanady</surname> <given-names>JC</given-names></name><name><surname>Drummond</surname> <given-names>SP</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The critical role of sleep spindles in hippocampal-dependent memory: a pharmacology study</article-title><source>Journal of Neuroscience</source><volume>33</volume><fpage>4494</fpage><lpage>4504</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3127-12.2013</pub-id><pub-id pub-id-type="pmid">23467365</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mehta</surname> <given-names>MR</given-names></name><name><surname>Barnes</surname> <given-names>CA</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Experience-dependent, asymmetric expansion of hippocampal place fields</article-title><source>PNAS</source><volume>94</volume><fpage>8918</fpage><lpage>8921</lpage><pub-id pub-id-type="doi">10.1073/pnas.94.16.8918</pub-id><pub-id pub-id-type="pmid">9238078</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morin</surname> <given-names>A</given-names></name><name><surname>Doyon</surname> <given-names>J</given-names></name><name><surname>Dostie</surname> <given-names>V</given-names></name><name><surname>Barakat</surname> <given-names>M</given-names></name><name><surname>Hadj Tahar</surname> <given-names>A</given-names></name><name><surname>Korman</surname> <given-names>M</given-names></name><name><surname>Benali</surname> <given-names>H</given-names></name><name><surname>Karni</surname> <given-names>A</given-names></name><name><surname>Ungerleider</surname> <given-names>LG</given-names></name><name><surname>Carrier</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Motor sequence learning increases sleep spindles and fast frequencies in post-training sleep</article-title><source>Sleep</source><volume>31</volume><fpage>1149</fpage><lpage>1156</lpage><pub-id pub-id-type="pmid">18714787</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Navratilova</surname> <given-names>Z</given-names></name><name><surname>Hoang</surname> <given-names>LT</given-names></name><name><surname>Schwindel</surname> <given-names>CD</given-names></name><name><surname>Tatsuno</surname> <given-names>M</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Experience-dependent firing rate remapping generates directional selectivity in hippocampal place cells</article-title><source>Frontiers in Neural Circuits</source><volume>6</volume><elocation-id>6</elocation-id><pub-id pub-id-type="doi">10.3389/fncir.2012.00006</pub-id><pub-id pub-id-type="pmid">22363267</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ngo</surname> <given-names>HV</given-names></name><name><surname>Martinetz</surname> <given-names>T</given-names></name><name><surname>Born</surname> <given-names>J</given-names></name><name><surname>Mölle</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Auditory closed-loop stimulation of the sleep slow oscillation enhances memory</article-title><source>Neuron</source><volume>78</volume><fpage>545</fpage><lpage>553</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.03.006</pub-id><pub-id pub-id-type="pmid">23583623</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nishida</surname> <given-names>M</given-names></name><name><surname>Walker</surname> <given-names>MP</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Daytime naps, motor memory consolidation and regionally specific sleep spindles</article-title><source>PLOS ONE</source><volume>2</volume><elocation-id>e341</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0000341</pub-id><pub-id pub-id-type="pmid">17406665</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Norimoto</surname> <given-names>H</given-names></name><name><surname>Makino</surname> <given-names>K</given-names></name><name><surname>Gao</surname> <given-names>M</given-names></name><name><surname>Shikano</surname> <given-names>Y</given-names></name><name><surname>Okamoto</surname> <given-names>K</given-names></name><name><surname>Ishikawa</surname> <given-names>T</given-names></name><name><surname>Sasaki</surname> <given-names>T</given-names></name><name><surname>Hioki</surname> <given-names>H</given-names></name><name><surname>Fujisawa</surname> <given-names>S</given-names></name><name><surname>Ikegaya</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Hippocampal ripples down-regulate synapses</article-title><source>Science</source><volume>359</volume><fpage>1524</fpage><lpage>1527</lpage><pub-id pub-id-type="doi">10.1126/science.aao0702</pub-id><pub-id pub-id-type="pmid">29439023</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Neill</surname> <given-names>J</given-names></name><name><surname>Senior</surname> <given-names>TJ</given-names></name><name><surname>Allen</surname> <given-names>K</given-names></name><name><surname>Huxter</surname> <given-names>JR</given-names></name><name><surname>Csicsvari</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Reactivation of experience-dependent cell assembly patterns in the Hippocampus</article-title><source>Nature Neuroscience</source><volume>11</volume><fpage>209</fpage><lpage>215</lpage><pub-id pub-id-type="doi">10.1038/nn2037</pub-id><pub-id pub-id-type="pmid">18193040</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oudiette</surname> <given-names>D</given-names></name><name><surname>Antony</surname> <given-names>JW</given-names></name><name><surname>Creery</surname> <given-names>JD</given-names></name><name><surname>Paller</surname> <given-names>KA</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The role of memory reactivation during wakefulness and sleep in determining which memories endure</article-title><source>Journal of Neuroscience</source><volume>33</volume><fpage>6672</fpage><lpage>6678</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.5497-12.2013</pub-id><pub-id pub-id-type="pmid">23575863</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oudiette</surname> <given-names>D</given-names></name><name><surname>Paller</surname> <given-names>KA</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Upgrading the sleeping brain with targeted memory reactivation</article-title><source>Trends in Cognitive Sciences</source><volume>17</volume><fpage>142</fpage><lpage>149</lpage><pub-id pub-id-type="doi">10.1016/j.tics.2013.01.006</pub-id><pub-id pub-id-type="pmid">23433937</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paller</surname> <given-names>KA</given-names></name><name><surname>Voss</surname> <given-names>JL</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Memory reactivation and consolidation during sleep</article-title><source>Learning &amp; Memory</source><volume>11</volume><fpage>664</fpage><lpage>670</lpage><pub-id pub-id-type="doi">10.1101/lm.75704</pub-id><pub-id pub-id-type="pmid">15576883</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Papalambros</surname> <given-names>NA</given-names></name><name><surname>Santostasi</surname> <given-names>G</given-names></name><name><surname>Malkani</surname> <given-names>RG</given-names></name><name><surname>Braun</surname> <given-names>R</given-names></name><name><surname>Weintraub</surname> <given-names>S</given-names></name><name><surname>Paller</surname> <given-names>KA</given-names></name><name><surname>Zee</surname> <given-names>PC</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Acoustic enhancement of sleep slow oscillations and concomitant memory improvement in older adults</article-title><source>Frontiers in Human Neuroscience</source><volume>11</volume><elocation-id>109</elocation-id><pub-id pub-id-type="doi">10.3389/fnhum.2017.00109</pub-id><pub-id pub-id-type="pmid">28337134</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramanathan</surname> <given-names>DS</given-names></name><name><surname>Gulati</surname> <given-names>T</given-names></name><name><surname>Ganguly</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Sleep-Dependent reactivation of ensembles in motor cortex promotes skill consolidation</article-title><source>PLOS Biology</source><volume>13</volume><elocation-id>e1002263</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1002263</pub-id><pub-id pub-id-type="pmid">26382320</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rasch</surname> <given-names>B</given-names></name><name><surname>Born</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>About sleep's role in memory</article-title><source>Physiological Reviews</source><volume>93</volume><fpage>681</fpage><lpage>766</lpage><pub-id pub-id-type="doi">10.1152/physrev.00032.2012</pub-id><pub-id pub-id-type="pmid">23589831</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ratcliff</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Connectionist models of recognition memory: constraints imposed by learning and forgetting functions</article-title><source>Psychological Review</source><volume>97</volume><fpage>285</fpage><lpage>308</lpage><pub-id pub-id-type="doi">10.1037/0033-295X.97.2.285</pub-id><pub-id pub-id-type="pmid">2186426</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roth</surname> <given-names>ED</given-names></name><name><surname>Yu</surname> <given-names>X</given-names></name><name><surname>Rao</surname> <given-names>G</given-names></name><name><surname>Knierim</surname> <given-names>JJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Functional differences in the backward shifts of CA1 and CA3 place fields in novel and familiar environments</article-title><source>PLOS ONE</source><volume>7</volume><elocation-id>e36035</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0036035</pub-id><pub-id pub-id-type="pmid">22558316</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roumis</surname> <given-names>DK</given-names></name><name><surname>Frank</surname> <given-names>LM</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Hippocampal sharp-wave ripples in waking and sleeping states</article-title><source>Current Opinion in Neurobiology</source><volume>35</volume><fpage>6</fpage><lpage>12</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2015.05.001</pub-id><pub-id pub-id-type="pmid">26011627</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rumelhart</surname> <given-names>DE</given-names></name><name><surname>Hinton</surname> <given-names>GE</given-names></name><name><surname>Williams</surname> <given-names>RJ</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>Learning representations by back-propagating errors</article-title><source>Nature</source><volume>323</volume><fpage>533</fpage><lpage>536</lpage><pub-id pub-id-type="doi">10.1038/323533a0</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Sanda</surname> <given-names>P</given-names></name><name><surname>Malerba</surname> <given-names>P</given-names></name><name><surname>Jiang</surname> <given-names>X</given-names></name><name><surname>Krishnan</surname> <given-names>GP</given-names></name><name><surname>Cash</surname> <given-names>S</given-names></name><name><surname>Halgren</surname> <given-names>E</given-names></name><name><surname>Bazhenov</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Interaction of hippocampal ripples and cortical slow waves leads to coordinated Large-Scale sleep rhythm</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/568881</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shinoe</surname> <given-names>T</given-names></name><name><surname>Matsui</surname> <given-names>M</given-names></name><name><surname>Taketo</surname> <given-names>MM</given-names></name><name><surname>Manabe</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Modulation of synaptic plasticity by physiological activation of M1 muscarinic acetylcholine receptors in the mouse Hippocampus</article-title><source>Journal of Neuroscience</source><volume>25</volume><fpage>11194</fpage><lpage>11200</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2338-05.2005</pub-id><pub-id pub-id-type="pmid">16319319</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skaggs</surname> <given-names>WE</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Replay of neuronal firing sequences in rat Hippocampus during sleep following spatial experience</article-title><source>Science</source><volume>271</volume><fpage>1870</fpage><lpage>1873</lpage><pub-id pub-id-type="doi">10.1126/science.271.5257.1870</pub-id><pub-id pub-id-type="pmid">8596957</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skelin</surname> <given-names>I</given-names></name><name><surname>Kilianski</surname> <given-names>S</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Hippocampal coupling with cortical and subcortical structures in the context of memory consolidation</article-title><source>Neurobiology of Learning and Memory</source><volume>160</volume><fpage>21</fpage><lpage>31</lpage><pub-id pub-id-type="doi">10.1016/j.nlm.2018.04.004</pub-id><pub-id pub-id-type="pmid">29660400</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname> <given-names>C</given-names></name><name><surname>MacNeill</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Impaired motor memory for a pursuit rotor task following stage 2 sleep loss in college students</article-title><source>Journal of Sleep Research</source><volume>3</volume><fpage>206</fpage><lpage>213</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2869.1994.tb00133.x</pub-id><pub-id pub-id-type="pmid">10607127</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steriade</surname> <given-names>M</given-names></name><name><surname>Nunez</surname> <given-names>A</given-names></name><name><surname>Amzica</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Intracellular analysis of relations between the slow</article-title><source>The Neurosci</source><volume>13</volume><fpage>3266</fpage><lpage>3283</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.13-08-03266.1993</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steriade</surname> <given-names>M</given-names></name><name><surname>Timofeev</surname> <given-names>I</given-names></name><name><surname>Grenier</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Natural waking and sleep states: a view from inside neocortical neurons</article-title><source>Journal of Neurophysiology</source><volume>85</volume><fpage>1969</fpage><lpage>1985</lpage><pub-id pub-id-type="doi">10.1152/jn.2001.85.5.1969</pub-id><pub-id pub-id-type="pmid">11353014</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stickgold</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Parsing the role of sleep in memory processing</article-title><source>Current Opinion in Neurobiology</source><volume>23</volume><fpage>847</fpage><lpage>853</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2013.04.002</pub-id><pub-id pub-id-type="pmid">23618558</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sugisaki</surname> <given-names>E</given-names></name><name><surname>Fukushima</surname> <given-names>Y</given-names></name><name><surname>Fujii</surname> <given-names>S</given-names></name><name><surname>Yamazaki</surname> <given-names>Y</given-names></name><name><surname>Aihara</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The effect of coactivation of muscarinic and nicotinic acetylcholine receptors on LTD in the hippocampal CA1 network</article-title><source>Brain Research</source><volume>1649</volume><fpage>44</fpage><lpage>52</lpage><pub-id pub-id-type="doi">10.1016/j.brainres.2016.08.024</pub-id><pub-id pub-id-type="pmid">27545666</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Swanson</surname> <given-names>RA</given-names></name><name><surname>Levenstein</surname> <given-names>D</given-names></name><name><surname>McClain</surname> <given-names>K</given-names></name><name><surname>Tingley</surname> <given-names>D</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Variable specificity of memory trace reactivation during hippocampal sharp wave ripples</article-title><source>Current Opinion in Behavioral Sciences</source><volume>32</volume><fpage>126</fpage><lpage>135</lpage><pub-id pub-id-type="doi">10.1016/j.cobeha.2020.02.008</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tamaki</surname> <given-names>M</given-names></name><name><surname>Huang</surname> <given-names>TR</given-names></name><name><surname>Yotsumoto</surname> <given-names>Y</given-names></name><name><surname>Hämäläinen</surname> <given-names>M</given-names></name><name><surname>Lin</surname> <given-names>FH</given-names></name><name><surname>Náñez</surname> <given-names>JE</given-names></name><name><surname>Watanabe</surname> <given-names>T</given-names></name><name><surname>Sasaki</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Enhanced spontaneous oscillations in the supplementary motor area are associated with sleep-dependent offline learning of finger-tapping motor-sequence task</article-title><source>Journal of Neuroscience</source><volume>33</volume><fpage>13894</fpage><lpage>13902</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1198-13.2013</pub-id><pub-id pub-id-type="pmid">23966709</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tononi</surname> <given-names>G</given-names></name><name><surname>Cirelli</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Sleep and the price of plasticity: from synaptic and cellular homeostasis to memory consolidation and integration</article-title><source>Neuron</source><volume>81</volume><fpage>12</fpage><lpage>34</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.12.025</pub-id><pub-id pub-id-type="pmid">24411729</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>van de Ven</surname> <given-names>GM</given-names></name><name><surname>Tolias</surname> <given-names>AS</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Generative replay with feedback connections as a general strategy for continual learning</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1809.10635">https://arxiv.org/abs/1809.10635</ext-link></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vanini</surname> <given-names>G</given-names></name><name><surname>Lydic</surname> <given-names>R</given-names></name><name><surname>Baghdoyan</surname> <given-names>HA</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>GABA-to-ACh ratio in basal forebrain and cerebral cortex varies significantly during sleep</article-title><source>Sleep</source><volume>35</volume><fpage>1325</fpage><lpage>1334</lpage><pub-id pub-id-type="doi">10.5665/sleep.2106</pub-id><pub-id pub-id-type="pmid">23024430</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Walker</surname> <given-names>MP</given-names></name><name><surname>Brakefield</surname> <given-names>T</given-names></name><name><surname>Morgan</surname> <given-names>A</given-names></name><name><surname>Hobson</surname> <given-names>JA</given-names></name><name><surname>Stickgold</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Practice with sleep makes perfect: sleep-dependent motor skill learning</article-title><source>Neuron</source><volume>35</volume><fpage>205</fpage><lpage>211</lpage><pub-id pub-id-type="doi">10.1016/s0896-6273(02)00746-8</pub-id><pub-id pub-id-type="pmid">12123620</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Walker</surname> <given-names>MP</given-names></name><name><surname>Stickgold</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Sleep-dependent learning and memory consolidation</article-title><source>Neuron</source><volume>44</volume><fpage>121</fpage><lpage>133</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2004.08.031</pub-id><pub-id pub-id-type="pmid">15450165</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wei</surname> <given-names>Y</given-names></name><name><surname>Krishnan</surname> <given-names>GP</given-names></name><name><surname>Bazhenov</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Synaptic mechanisms of memory consolidation during sleep slow oscillations</article-title><source>The Journal of Neuroscience</source><volume>36</volume><fpage>4231</fpage><lpage>4247</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3648-15.2016</pub-id><pub-id pub-id-type="pmid">27076422</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wei</surname> <given-names>Y</given-names></name><name><surname>Krishnan</surname> <given-names>GP</given-names></name><name><surname>Komarov</surname> <given-names>M</given-names></name><name><surname>Bazhenov</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Differential roles of sleep spindles and sleep slow oscillations in memory consolidation</article-title><source>PLOS Computational Biology</source><volume>14</volume><elocation-id>e1006322</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006322</pub-id><pub-id pub-id-type="pmid">29985966</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wei</surname> <given-names>Y</given-names></name><name><surname>Krishnan</surname> <given-names>GP</given-names></name><name><surname>Marshall</surname> <given-names>L</given-names></name><name><surname>Martinetz</surname> <given-names>T</given-names></name><name><surname>Bazhenov</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Stimulation augments spike sequence replay and memory consolidation during Slow-Wave sleep</article-title><source>The Journal of Neuroscience</source><volume>40</volume><fpage>811</fpage><lpage>824</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1427-19.2019</pub-id><pub-id pub-id-type="pmid">31792151</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weigenand</surname> <given-names>A</given-names></name><name><surname>Mölle</surname> <given-names>M</given-names></name><name><surname>Werner</surname> <given-names>F</given-names></name><name><surname>Martinetz</surname> <given-names>T</given-names></name><name><surname>Marshall</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Timing matters: open-loop stimulation does not improve overnight consolidation of word pairs in humans</article-title><source>European Journal of Neuroscience</source><volume>44</volume><fpage>2357</fpage><lpage>2368</lpage><pub-id pub-id-type="doi">10.1111/ejn.13334</pub-id><pub-id pub-id-type="pmid">27422437</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Werbos</surname> <given-names>PJ</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Backpropagation through time: what it does and how to do it</article-title><source>Proceedings of the IEEE</source><volume>78</volume><fpage>1550</fpage><lpage>1560</lpage><pub-id pub-id-type="doi">10.1109/5.58337</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname> <given-names>MA</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Reactivation of hippocampal ensemble memories during sleep</article-title><source>Science</source><volume>265</volume><fpage>676</fpage><lpage>679</lpage><pub-id pub-id-type="doi">10.1126/science.8036517</pub-id><pub-id pub-id-type="pmid">8036517</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname> <given-names>W</given-names></name><name><surname>de Carvalho</surname> <given-names>F</given-names></name><name><surname>Jackson</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Sequential neural activity in primary motor cortex during sleep</article-title><source>The Journal of Neuroscience</source><volume>39</volume><fpage>3698</fpage><lpage>3712</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1408-18.2019</pub-id><pub-id pub-id-type="pmid">30842250</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zz</surname> <given-names>L</given-names></name><name><surname>Hoiem</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Learning without forgetting</article-title><source>Ieee T Pattern Anal</source><volume>40</volume><fpage>2935</fpage><lpage>2947</lpage><pub-id pub-id-type="doi">10.1109/TPAMI.2017.2773081</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.51005.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>van Rossum</surname><given-names>Mark CW</given-names></name><role>Reviewing Editor</role><aff><institution>University of Nottingham</institution><country>United Kingdom</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Battaglia</surname><given-names>Francesco P</given-names></name><role>Reviewer</role><aff><institution>Donders Institute</institution><country>Netherlands</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>That sleep can protect and improve memories is well known, but many details remain unclear. This paper builds a detailed biological computational model to explore and demonstrate such effects.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Can sleep protect memories from catastrophic forgetting?&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, one of whom is a member of our Board of Reviewing Editors, and the evaluation has been overseen by Laura Colgin as the Senior Editor. The following individual involved in review of your submission has agreed to reveal their identity: Francesco P Battaglia (Reviewer #1).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>Gonzalez and colleagues study a computational network model of sequence memory encoding and replay, in a thalamocortical network and find that sleep can untangle stored sequences.</p><p>Essential revisions:</p><p>As you will see there is a rather extensive list of comments and amendments requested. This is not typical for <italic>eLife</italic>, which aims to either reject or have small revisions. But we felt that if the issues are addressable, it would make a very interesting paper.</p><p><italic>Reviewer #1:</italic></p><p>Gonzalez and colleagues study a network model of memory encoding and replay, in a thalamocortical network.</p><p>The model, based on previous work from the same group, is a quite detailed rendition of neural dynamics (including Hodgkin-Huxley spike generation, and a host of other important conductances and neuromodulatory influences). This enables a fairly realistic depiction of the wake-sleep transition and of Up-Down states dynamics during NREM sleep.</p><p>The authors use several different protocols to implement training and replay of overlapping or non-overlapping sequences. Sleep appears to effective at stabilizing and orthogonalizing sequences, preventing catastrophic interference, as much, or in some cases more, than awake training.</p><p>The results are interesting in two ways. First, because they show, for the first time to my knowledge, that memory replay can happen and effectively supports consolidation in a realistic model of neural dynamics, and second because it shows some detail about how replay may support memory reorganization, orthogonalization, and protection from interference. Especially this second aspect could be improved in my view by expanding on some analyses, as detailed below:</p><p>– The Up/Down states are simulated in the network based on thalamocortical interactions. They are used in the analysis to &quot;segment&quot; neural activity. However, electrophysiological evidence (e.g. Johnson and McNaughton) shows that memory replay is strongest/most likely at the Down to Up state transition. Is this the case in these simulations as well?</p><p>– While many of the parameters have different values during wake and sleep, the values of the A<sub>+</sub> constant in the STDP rule seem to be the same. If I understand correctly, A<sub>-</sub> is different in training with respect to sleep (what happens at retrieval?). I was wondering how this affects the higher amount of orthogonalization seen with sleep replay with respect to interleaved awake training.</p><p>– Related to the previous point: is total synaptic strength decreasing, or increasing during NREM sleep? This would parallel ideas from e.g. Tononi and Cirelli or Grosmark and Buzsaki. Is greater synaptic depression during sleep a key ingredient for catastrophic interference protection?</p><p>– The effect of sleep seems to increase the amount of structure in each of the network blocks, with distinct groups of neurons forming for the sequences in the two directions (for example). This is studied mostly by looking at the synaptic level (asymmetry measure), and there, only by looking at an increase in the variability in the measure. That analysis could easily be extended in my view, by looking at neural activity measures (e.g. population vector correlation), more directly comparable with experimental results from neural ensemble recording. Is there evidence for the emergence of new within and across block structures? For example, to make the parallel with place cells (as done throughout the paper), is there evidence for the emergence, with training, of directional place cells from non-directional ones?</p><p>– The retrieval protocol used, in which all neurons in a &quot;block&quot; are strongly activated, may actually downplay the orthogonalizing power of the wake/sleep learning dynamics, because neurons that are assigned to, say, both the S1 and S1* sequences are primed. Is that the case? Wouldn't things look even &quot;better&quot; with a more gentle activation protocol?</p><p>– Figure 7B: after S1 training (second panel) the bulk of the neuron pairs shift, as expected, their asymmetry in the direction of S1, however, a smaller subset of neuron pairs go in the opposite direction, towards the K<sub>01</sub> corner. Why is that?</p><p><italic>Reviewer #2:</italic></p><p>Here Gonzalez et al. implement a thalamocortical model to investigate how sleep rescues forgetting in a group of neurons competing for different memories. The study investigates sleep's role in protecting memories encoded in overlapping groups of neurons and provides important insights about the underlying mechanisms. The manuscript is well-written and easy to follow. They show that training a new sequence in a subpopulation that overlaps with a previous sequence leads to interference with the old sequence. Replay during Up states of sleep following this training however is able to reverse the damage caused by competing memories. This replay of competing memories during sleep creates subsets of strongly unidirectional synaptic connections for each learned sequence and some bidirectional connections that may act like network hubs. The approach is interesting and provides general insights into how spiking networks can create distinct but overlapping memories, and also makes some testable predictions.</p><p>The main issue, however, is that a key test of the effects of sleep replay on catastrophic interference was not performed: under realistic scenarios, sleep takes place after each sequence learning session separately and new memories are formed on top of pre-existing ones. E.g. the order in typical day-to-day experience is S1, sleep, S2, sleep, S1*, sleep, etc. This important scenario should be examined to test whether the results still hold. In the current models, the sequences seem to saturate specific synapses, which may create issues for future learning.</p><p>A second concern is that &quot;replays&quot; are inferred but not explicitly shown. The replay sequence was measured in terms of pairs of neurons active in a given Up state instead of how well the trained sequence is represented. The authors explain that Figure 6C is &quot;suggesting&quot; that two sequences replay simultaneously, but this should be more explicitly shown or better illustrated, as it is an interesting and important prediction of the model. There should also be discussion of how this observation is to be reconciled with the body of literature indicating distinct replay of isolated sequences. Perhaps previous methods based on template matching would fail to detect such overlapping replays? In particular, Wikenheiser and Redish (Hippocampus, 2013) indicate bidirectional replay during sleep, which appears inconsistent with the current results, at least in the hippocampus.</p><p>A third issue concerns how memories are selected for replay. In the model it seems that stronger synapses lead to increased replay. This would suggest that replay begets more replay, until synapses are fully saturated. The effects of multiple sleep sequences and/or longer sleep durations should be simulated to examine this scenario, and (as noted above) whether new learning can take place in synapses saturated by sleep. It is also important to note that studies investigating hippocampal replay (e.g. O'Neill et al., 2007; Giri et al., 2019) show decreasing replay of familiar sequences. Do the authors predict different patterns in the cortex? Please discuss.</p><p>The authors present and discuss an asymmetric expansion of place fields following sleep. However, this result is not consistent with Mehta et al., 1997 as the authors claim. Mehta in fact found that the backwards expansion of place fields was reset at the beginning of each track session (presumably as a result of overnight sleep), but that the place-fields expanded again over the course of a behavioral session. The findings of Mehta et al. are therefore more consistent with net downscaling of memory during sleep, rather than the model presented here. This discrepancy should be addressed.</p><p><italic>Reviewer #3:</italic></p><p>This paper examines the formation of sequence memories in a computational model of hippocampus equipped with STDP, and in particular in the role of sleep.</p><p>Sleep, as well as interleaved training, is shown to separate storage of forward and backward sequences.</p><p>How this relates to catastrophic forgetting is a bit tentative. For instance, I don't think the setup will allow storage of both ABCDE and ABCFG, but it would be nice to be proven wrong.</p><p>I wonder whether the story has a simple interpretation: Balanced STDP (A<sub>+</sub> = A<sub>-</sub>, τ<sub>+</sub> = τ<sub>-</sub>) by itself breaks symmetry and will not allow bidirectional connections between neurons. Therefore during sleep recurrent connections are cleared up. During learning however the symmetry is explicitly broken by hand by reducing the LTD term (subsection “Synaptic currents and spike-timing dependent plasticity (STDP)”).</p><p>I wonder if the mechanism thus requires an extraordinary amount of fine-tuning that could not expected in biology. On the other hand, during interleaved training, during which the symmetry is presumably also broken by hand, bi-directional connections are also removed. As a result I am not fully convinced my explanation is correct. In any case, I think it would be important to show that the mechanism does not require fine-tuning of the A<sub>+</sub>/A<sub>-</sub> ratio.</p><p>The paper could have been presented better. The Materials and methods are particularly poor, as it mentions for instance histamine modulation and minis, however, they are mentioned just once and it remains completely unclear whether these ingredients matter. Now it might well be that this was extensively discussed in previous papers, but that is no excuse.</p><p>Similarly the dynamics of the synaptic input (subsection “Synaptic currents and spike-timing dependent plasticity (STDP)” is not discussed.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.51005.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>Gonzalez and colleagues study a network model of memory encoding and replay, in a thalamocortical network.</p><p>[…] The results are interesting in two ways. First, because they show, for the first time to my knowledge, that memory replay can happen and effectively supports consolidation in a realistic model of neural dynamics, and second because it shows some detail about how replay may support memory reorganization, orthogonalization, and protection from interference. Especially this second aspect could be improved in my view by expanding on some analyses, as detailed below:</p></disp-quote><p>We would like to thank the reviewer for their interest in our study and for highlighting the importance of our work. We would like to add that by abstracting the basic mechanisms of sleep replay as demonstrated in this manuscript, we were able to construct sleep-like algorithms which can be applied to deep learning artificial neural networks to help overcome catastrophic forgetting and interference without the need to explicitly retrain old tasks (arXiv:1908.02240v1).</p><disp-quote content-type="editor-comment"><p>– The Up/Down states are simulated in the network based on thalamocortical interactions. They are used in the analysis to &quot;segment&quot; neural activity. However, electrophysiological evidence (e.g. Johnson and McNaughton) shows that memory replay is strongest/most likely at the Down to Up state transition. Is this the case in these simulations as well?</p></disp-quote><p>We would like to thank the reviewer for this question. Indeed, there is substantial evidence from the McNaughton lab and other groups that replay of the recently encoded memories tends to occur at the Down to Up transition.</p><p>To check what happens in the model, we located individual Up states and counted total number of partial (pair-wised) replays during the 1st vs. 2nd half of all Up states (<xref ref-type="fig" rid="respfig1">Author response image 1</xref>). The majority of these transitions happened during the first half of an Up state. This predicts that the partial replays of the sequences during cortical Up state is strongest near the Down to Up transition but is not limited to that specific phase of an Up state.</p><fig id="respfig1"><label>Author response image 1.</label><caption><title>Total number of partial sequence replays for sequence S1 (blue) and S1* (red) during the first half (left) and last half (right) of up states during sleep.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51005-resp-fig1-v2.tif"/></fig><p>We would like to add that the evidence about replay being dominant near Down-Up state transition comes from <italic>in vivo</italic> studies in which multiple brain regions including the hippocampus and cortex are in continual communication during SWS. Indeed, it has been shown that hippocampal sharp-wave ripples (SWRs) tend to occur at the cortical Down to Up transition (Skelin et al., 2019). As such, the presence of hippocampal ripples, triggering replay, may be an important ingredient in the observation of the new memory replays at the Down to Up transition. In this study, we do not explicitly model the hippocampus or hippocampal input to the cortex. Instead we assumed that memory traces are already embedded to the cortical connectivity matrix either because of the earlier hippocampus-dependent consolidation or because these memories are hippocampus independent (as for procedural memory tasks) and we studied spontaneous cortical replay of these memories. Thus we predict that the cortical memory traces that are already in the cortex also tends to replay more during initial phase of Up state but replay continues through the entire Up state duration. This would further predict that hippocampus dependent replay of the memories that are not yet encoded in the cortex would occur earlier in Up state compare to the spontaneous cortical replay. We included a brief discussion of that topic to the revised text (see below).</p><p>In Results:</p><p>“Note, our model predicts that partial sequences (specifically spike doubles) of both memories can be replayed during the same Up state and not that both are replayed simultaneously (at the same exact time). […] This result is consistent with electrophysiological data suggesting that memory replay is strongest at the Down to Up state transition (Johnson et al., 2010).”</p><p>In Discussion:</p><p>“There are evidences that memory replay during SWS occurs predominantly near the Down to Up state transitions (Johnson et al., 2010). […] This predicts that hippocampus-dependent replay of new memories, that are not yet encoded in the cortex, may occur earlier in the Up state compared to the spontaneous replay of the old memory traces, which may occur later in the Up state.”</p><disp-quote content-type="editor-comment"><p>– While many of the parameters have different values during wake and sleep, the values of the A<sub>+</sub> constant in the STDP rule seem to be the same. If I understand correctly, A<sub>-</sub> is different in training with respect to sleep (what happens at retrieval?). I was wondering how this affects the higher amount of orthogonalization seen with sleep replay with respect to interleaved awake training.</p></disp-quote><p>Thank you for this comment. We should be clearer about how A<sub>-</sub> was changed in the model during wake as compared to sleep. During the training phase, A<sub>-</sub> was reduced to promote LTP, to simulate to some extend effects of local release of acetylcholine during attention learning (Blokland, 1995; Shinoe et al., 2005; Sugisaki et al., 2016). During testing/retrieval phases A<sub>-</sub> was the same as A<sub>+</sub>. However, we want to say that during testing/retrieval reactivations of the memories resulted in very little to no change synaptic changes. (We also tested models where plasticity was completely frozen during testing/retrieval and obtained the same result.) Importantly, A<sub>-</sub> and A<sub>+</sub> were equal both during interleaved training and during sleep, to allow comparison between them. This is now emphasized in the revised text.</p><p>In Results:</p><p>“We set probabilistic connectivity (p = 0.6) between excitatory cortical neurons within a defined radius (RAMPA(PY-PY) = 20). Only cortical PY-PY connections were plastic and regulated by spike-timing dependent plasticity (STDP). […] STDP remained balanced during both sleep and interleaved training (except for few selected simulations where we tested effect of unbalancing STDP) to allow side by side comparisons.”</p><p>“It should be noted that though testing resulted in reactivation of memory traces, there was little change in synaptic weights during testing periods because of a relatively small number of pre/post spike events. (Simulations where STDP was explicitly turned off during all testing periods exhibited similar results to those presented here.)“</p><p>To show that the orthogonalization of the memory traces during sleep is independent of the specific balance of LTP/LTD (A<sub>+</sub>/A<sub>-</sub>), we have performed additional simulations. As shown in Figure 7—figure supplement 2, biasing the LTP/LTD ratio during sleep towards either LTD (Figure 7—figure supplement 2A) or LTP (Figure 7—figure supplement 2B) still results in the orthogonalization of the memory representations as demonstrated by the increase of sequence specific connections after sleep. In these figures, the scatter plots show the distribution of bidirectional synaptic connections in the trained region at baseline (left), after S1 training (middle left), after S1* training (middle right), and after sleep (right). (As in the main paper, for each bidirectional coupling between two neurons A&lt;-&gt;B , we plotted the strength of A-&gt;B synapse on X axis and the strength of B-&gt;A synapse in Y axis.) The red lines on these plots depict the threshold used to identify neuronal pairs that are either strongly preferential for S1 (bottom right corner) or S1* (top left corner). The amount of synapses above this threshold are quantified in the bar plots below showing that sleep increases the density of the memory specific couplings between neurons regardless of the LTP/LTD ratio.</p><p>The vector field plots (Figure 7—figure supplement 2, middle panels) provide summaries of the average synaptic weight dynamics during training of either sequence (left and middle plots) and during sleep. It reveals convergence towards the corners which represent cell pairs being strongly enrolled either to sequence S1 or sequence S1*. It should be noted, because our model does not have homeostatic mechanisms to regulate “average” synaptic strength during sleep, the case of LTD biased sleep shows a net reduction of synaptic strengths (vector fields point towards the origin), while the LTP biased condition shows a net increase (vector fields pointing to top right corner). It is interesting that in the case of net reduction of synaptic weights, there is still strong orthogonalization of the weights. So, what was happening is that the bulk of synapses decreases their strength while fraction of synapses kept or even increased the strength and these synapses became memory specific. This observation may be in line with ideas from the Tononi and colleagues showing net reductions of synaptic weights during sleep (Tononi and Cirelli, 2014), however, more analysis of the model including additional homeostatic rules is need to make this conclusion from our simulations.</p><p>These results are discussed as follows.</p><p>In Results:</p><p>“In all previous simulations, LTP and LTD were balanced during sleep or interleaved training. […] This observation may be in line with ideas from Tononi and colleagues showing net reductions of synaptic weights during sleep (Tononi and Cirelli, 2014) however, more analysis of the model including additional homeostatic rules is need to make this conclusion based on model simulations.”</p><disp-quote content-type="editor-comment"><p>– Related to the previous point: is total synaptic strength decreasing, or increasing during NREM sleep? This would parallel ideas from e.g. Tononi and Cirelli or Grosmark and Buzsaki. Is greater synaptic depression during sleep a key ingredient for catastrophic interference protection?</p></disp-quote><p>Indeed, there has been much debate around the Sleep Homeostasis Hypothesis (SHY) put forward by Tononi and Cirelli (Tononi and Cirelli, 2014). In our current model, there is no explicit homeostatic mechanisms in place to bias towards synaptic depression and total synaptic strength change very little during simulations. As we mentioned in the previous comment, when plasticity was explicitly biased towards LTD during sleep (Figure 7—figure supplement 2A), sleep increased selected subset of synaptic weights which became memory specific while decreased the rest of synapses. This mechanism may aid in increasing the memory capacity of the network by only allowing the minimal number of connections required for the preservation of the sequences and resetting during sleep the other synapses towards the baseline. The network would then be able to use these synapses to encode new memories thus potentially facilitating continual learning without the consequence of retroactive interference. We included a short discussion of this point to the revised version.</p><p>In Discussion:</p><p>“The Sleep Homeostasis Hypothesis (Tononi and Cirelli, 2014) suggests that homeostatic mechanisms active during sleep should result in a net synaptic depression to renormalize synaptic weights and to stabilize network dynamics. […] The network would then be able to use these synapses to encode new memories thus potentially facilitating continual learning without the consequence of retroactive interference.”</p><disp-quote content-type="editor-comment"><p>– The effect of sleep seems to increase the amount of structure in each of the network blocks, with distinct groups of neurons forming for the sequences in the two directions (for example). This is studied mostly by looking at the synaptic level (asymmetry measure), and there, only by looking at an increase in the variability in the measure. That analysis could easily be extended in my view, by looking at neural activity measures (e.g. population vector correlation), more directly comparable with experimental results from neural ensemble recording. Is there evidence for the emergence of new within and across block structures? For example, to make the parallel with place cells (as done throughout the paper), is there evidence for the emergence, with training, of directional place cells from non-directional ones?</p></disp-quote><p>We have looked at activity-based directionality index at the very end of the manuscript (old Figure 8). For that we stimulated independently every single group – A, B, C, D, E – and we measured and compared the response delay for each neuron in groups B-D when its respective left vs. right neighboring groups were stimulated. This analysis is similar to what was done in Navratilova et al., 2012, where the difference of place cell responses at a specific locations on a liner track was calculated when a rat was approaching that location from one direction vs. the other. We used this delay-based measure instead of (spatial) population vector correlation since, due to the dense local connectivity in our model. Because of that, neurons within a group, even when do not encode specific memory explicitly, still would fire in response to elevated activity within that group, however, their response is delayed. As shown in Figure 8C, the directionality index based on neural activity shows a similar result as what was reported by (Navratilova et al., 2012) and it correlates with the asymmetry measured in the weight based directionality index (Figure 5E). In both measures, we see increases in the directionality or asymmetry after sleep (Figures 5E and 8C red bar).</p><disp-quote content-type="editor-comment"><p>– The retrieval protocol used, in which all neurons in a &quot;block&quot; are strongly activated, may actually downplay the orthogonalizing power of the wake/sleep learning dynamics, because neurons that are assigned to, say, both the S1 and S1* sequences are primed. Is that the case? Wouldn't things look even &quot;better&quot; with a more gentle activation protocol?</p></disp-quote><p>This is interesting point. In principle, if stimulation (e.g., group A) would be selective to activate only subset of neurons in A projecting alone the sequence in testing (e.g., sequence S), this should be sufficient to trigger sequence recall. Small difference between that and stimulating entire group A is that while other neurons in A may not project to the next group (group B), their activation could still increase overall spiking of the sequence specific neurons in A because of the intra group connectivity. Also, in many cases, nonspecific synapses between groups still preserve some (low) synaptic strength even after training or sleep, so activating these presynaptic neurons in A helps increasing excitability of the group B neurons. Thus, while the reviewer is correct that sequence specific stimulation is sufficient, activating more neurons at the beginning of the sequence would not have a negative impact on the sequence recall and may even facilitate initiation of the sequence. From practical perspective, to get selective activations would require online detection of neurons which have become preferential for one sequence or the other after sleep and selectively activate them during testing. Alternatively, we could detect these neurons offline, and then rerun the simulation and only stimulate the sequence specific neurons identified offline. Both of which are possible but require repeating many simulation. We would like to test this approach in our future work.</p><disp-quote content-type="editor-comment"><p>– Figure 7B: after S1 training (second panel) the bulk of the neuron pairs shift, as expected, their asymmetry in the direction of S1, however, a smaller subset of neuron pairs go in the opposite direction, towards the K<sub>01</sub> corner. Why is that?</p></disp-quote><p>This is very good question. We checked and we found that a small population of recurrent/bidirectional synaptic weights that change their strength in direction opposite to what is expect from training are “within group” connections (i.e., a subset of synaptic connections formed between neurons within a group, e.g., within group B only). Because of the variability of the neuronal dynamics, when DC pulse is applied to a single group during training, there is some spike time variability of responses within a group. As such, connections may increase in one or another direction based on the exact timing of the spiking of neurons within that group. It is interesting to note that while these within group connections increase in the “opposite” direction, they do not impair the consolidation of the trained memory. This further supports our findings that the segregation of between group connections is main mechanism by which sleep aids in reversing the effects of catastrophic interference. To address this point we have added the following text to the Results section to provide an explanation of this phenomenon.</p><p>In Results:</p><p>“It should be noted that a small subset of synaptic weights increased in the direction of S1* during S1 training. Analysis of this small population of synaptic weights revealed that these connections were comprised solely of “within group” connections. It is interesting to note that these synapses did not impair the consolidation of the trained memory but instead helped to increase activity within each group regardless of which sequence was recalled.”</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>[…] The main issue, however, is that a key test of the effects of sleep replay on catastrophic interference was not performed: under realistic scenarios, sleep takes place after each sequence learning session separately and new memories are formed on top of pre-existing ones. E.g. the order in typical day-to-day experience is S1, sleep, S2, sleep, S1*, sleep, etc. This important scenario should be examined to test whether the results still hold. In the current models, the sequences seem to saturate specific synapses, which may create issues for future learning.</p></disp-quote><p>Thank you for this comment. We believe that our training paradigm represent two potential scenarios: 1) two memories are learned sequentially followed by sleep; 2) first sequence is trained and consolidated during sleep prior to the new sequence training followed by another sleep episode.</p><p>As the reviewer noticed, in the manuscript we focused on the first scenario, however, we explicitly tested both conditions and they show similar results. We now include a new supplementary figure in the revised manuscript (Figure 5—figure supplement 1) presenting “S1, sleep, S1*, sleep” scenario (note we excluded S2 training because this memory does not interfere with other memories). In this simulation, we first trained S1 as described in the main text. Following S1 training the network was put to sleep so that further consolidation of S1 occurred (Figure 5—figure supplement 1A). S1 testing after sleep showed better completion of S1 and increased performance (Figure 5—figure supplement 1B/C).</p><p>Training of the competing memory (S1*) caused damage to the completion of S1 and reduced S1 performance while increasing S1* performance and completion (Figure 5—figure supplement 1B/C). With a period of sleep following S1* training, we once again see the orthogonalization of the memory traces. Performances for both sequences show an improvement after the final sleep episode (Figure 5—figure supplement 1C). Increasing the amount of S1* training from 350s (Figure 5—figure supplement 1A/B/C) to 450s (Figure 5—figure supplement 1D) resulted in further reduction of S1 performance, but both memories still showed increases in performance after the final period of sleep (Figure 5—figure supplement 1D). Thus, the training paradigm “S1, sleep, S1*, sleep” shows qualitatively very similar results of synaptic weights orthogonalization to the “S1, S1*, sleep” paradigm presented in the main text.</p><p>These results are discussed as following.</p><p>In Results:</p><p>“As we mentioned previously, the training protocol we have focused on in this study was of two memories trained sequentially before sleep. […] Thus, the training paradigm “S1 -&gt; sleep -&gt; S1* -&gt; sleep” shows qualitatively similar results to the “S1 -&gt; S1* -&gt; sleep” paradigm.”</p><disp-quote content-type="editor-comment"><p>A second concern is that &quot;replays&quot; are inferred but not explicitly shown. The replay sequence was measured in terms of pairs of neurons active in a given Up state instead of how well the trained sequence is represented. The authors explain that Figure 6C is &quot;suggesting&quot; that two sequences replay simultaneously, but this should be more explicitly shown or better illustrated, as it is an interesting and important prediction of the model. There should also be discussion of how this observation is to be reconciled with the body of literature indicating distinct replay of isolated sequences. Perhaps previous methods based on template matching would fail to detect such overlapping replays? In particular, Wikenheiser and Redish (Hippocampus 2013) indicate bidirectional replay during sleep, which appears inconsistent with the current results, at least in the hippocampus.</p></disp-quote><p>These are very important questions and we will try to address them as follows. By saying in the text that the two sequences are replayed simultaneously, we meant to say that both sequences can be replayed during the same up-state (we clarified this in the revised text).</p><p>In Results:</p><p>“Note, our model predicts that partial sequences (specifically spike doubles) of both memories can be replayed during the same Up state and not that both are replayed simultaneously (at the same exact time).”</p><p>As a proof, we showed in the paper that pairs of neurons belonging to different sequences are found to be spiking in sequence specific order reliably during the same Up state. Part of the reason why we limited our analysis by the neuronal pairs is because, as the reviewer suggested, we had hard time using template matching algorithms to classify strongly overlapping spiking patterns from two sequences in our model. We do not claim that longer sequence replays do not exist in the model and we can actually see examples of triplets or even longer replays in case of single sequence training (<xref ref-type="fig" rid="respfig2">Author response image 2A</xref>, see long sequences of ordered spiking in the trained area selected with red lines even for nonlinear sequence. Note, we reordered blocks on neurons in the trained region to match training pattern), but for two overlapping sequences we had difficulty to detect them reliably. We want to add that in our previous models (e.g., Wei et al., 2018) it was much easier to detect full sequences (e.g., Figure 3) as we had identical number of synapses per cell, so spiking was very reliable. In the new model presented in this paper, connections are probabilistic (see <xref ref-type="fig" rid="respfig2">Author response image 2B</xref> for distribution of number of connections per cell) so different neurons show much higher jitter in spiking delays. Thus, we limited our prediction to stating that cortical replay may occur in the form of partial replays in subsets of the full sequence. That is to say during an up-state, rather than replaying the entire sequence A-B-C-D-E, we would more likely replay individual transitions (e.g. A-B; D-E; C-D) (see <xref ref-type="fig" rid="respfig2">Author response image 2C</xref>). In this way overlapping sequences would be able to coexist in the same population of neurons and replay transitions for both sequences throughout the same Up-state. Recent data (Ghandour et al., 2019) has shown evidence for cortical partial memory replay of both recent and older memories. We discuss these important points in the revised text.</p><p>In Discussion:</p><p>“Our model predicts the possibility of the partial sequence replays, i.e., when short snippets of a sequence are replayed independently, within the cortex. […] Indeed, recent data (Ghandour et al., 2019) have shown evidence for partial memory replay during NREM sleep (also see (Swanson et al., 2020)).”</p><fig id="respfig2"><label>Author response image 2.</label><caption><title>Sequence replays during sleep.</title><p>(<bold>A</bold>) Representative up state showing full sequence replays within the trained region of the network. (<bold>B</bold>) Histogram of the total in-degree of the neurons in our model. The x-axis is the in-degree or total number of synaptic inputs between excitatory neurons. The y-axis indicates the number of excitatory neurons which receive a given number of synaptic inputs. (<bold>C</bold>) Average number of single / partial transition replays across all up states for S1 ( blue) or S1* (red).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51005-resp-fig2-v2.tif"/></fig><p>We also want to say that synaptic weights analysis, if available, gives a reliable measure of the results of replay. The critical role of replay detection <italic>in vivo</italic> is because this is the only practical way of evaluating how synaptic representation of memories become strengthened during sleep. In the model, though we do not explicitly show full sequence replay, we have access to the synaptic weight information of every synapse in the network. As such, we directly measured their dynamics to show how their strengths are modulated during sleep.</p><p>Here we will address the reviewer’s comment regarding bidirectional replay. Forwards and backwards replay has been observed in rat hippocampus for recent memories. Within the hippocampus, it is interesting to note that backwards replay is predominantly observed during a post-task awake resting period (Foster and Wilson, 2006). The usefulness or importance of backwards replay has yet to be established. However, it has been suggested that during post-task quite wakefulness, backwards replay may reflect an evaluation of immediately preceding events (Foster and Wilson, 2006). Additionally, most of the evidence for backwards replay come from hippocampus. The bidirectionality of memory specific replay in the cortex has yet to be established. We would like to note that in our model one can see evidence for some amount of reverse replay (Figure 5—figure supplement 1A, “After S1” training panel). In this figure, we show the distribution of recurrent / bidirectional weights within the trained region. After training of S1, most of the synapses strengthen for S1, that is they move towards the bottom right corner of the plot. There exist a small population of weights which increase in the opposite direction which would suggest some amount of reverse reactivation in our model. However, these changes were mainly limited within group synapses so we should be careful to claim this to be evidence of the backwards replay in the model. As the reviewer mentioned bidirectional replay was reported in the hippocampus only, which may employ specific mechanisms not available in the cortex. We mention this limitation of the model in the revised text.</p><p>In Discussion:</p><p>“The phenomena of backwards memory replay and decrease in number of memory replays over time have been observed in rat hippocampus for recent memories. […] The opposite, in fact, may be true regarding the amount of old memory relays in cortex.”</p><disp-quote content-type="editor-comment"><p>A third issue concerns how memories are selected for replay. In the model it seems that stronger synapses lead to increased replay. This would suggest that replay begets more replay, until synapses are fully saturated. The effects of multiple sleep sequences and/or longer sleep durations should be simulated to examine this scenario, and (as noted above) whether new learning can take place in synapses saturated by sleep. It is also important to note that studies investigating hippocampal replay (e.g. O'Neill et al., 2007; Giri et al., 2019) show decreasing replay of familiar sequences. Do the authors predict different patterns in the cortex? Please discuss.</p></disp-quote><p>Indeed, in hippocampal recordings replay of recent memories decays over time. This may reflect gradual transition of memories from being hippocampus dependent to becoming hippocampus independent. Indeed, recent experimental evidence suggests that hippocampal sharp-wave ripples (SWRs) induce persistent synaptic depression</p><p>within the hippocampus (presumably to make it ready for storing new memories) and silencing of SWRs impairs future learning (Norimoto et al., 2018). We are not familiar with evidence suggesting that cortical memory replays decreases with time. There are experimental data supporting the idea of “replay begets more replay”, as it has been shown that during periods of NREM sleep (particularly stage 3 slow-wave sleep) cortical replay of recently formed memories results in a tagging of synapses involved in consolidation of those memories by increases in their synaptic efficacy (Langille, 2019). As such, it is likely that these tagged synapses will be reactivated throughout sleep thereby resulting in more cortical replay during both NREM and REM sleep periods (Diekelmann and Born, 2010; Langille, 2019).</p><p>As mentioned in our response to an earlier comment by the reviewer, we have explicitly tested the training paradigm of training sequence S1 – sleep – training sequence S1* – sleep. As shown in Figure 5—figure supplement 1, new memory S1* still can be trained and this condition also results in memory orthogonalization and segregation of synaptic weights. This is due to the continuous replays that occur in the model during slow wave sleep. From that perspective, model predicts that the cortex may continuously replay / reactivate subsets of the old memories across individual Up-states throughout sleep in order to maintain existing memories and to properly integrate newly formed memories into the existing framework without the interference with other previously stored memories.</p><p>Saying that, we have to consider the limitations of the model that may be missing some slow time scale mechanisms that control replay in the cortex. One can reasonable argue that continuous replay of everything is not necessary or may be waste of resources (even though cortical neurons are active during slow-wave sleep anyway) and there are ideas that replay should be mainly focusing on the old memories that are in danger of being erased by new learning, so replay should select memories based on similarities to the new knowledge. One possible mechanism of that may involve increase of activity in neural circuits involved in new memory reactivation so it will trigger replay of the old memories sharing the same circuits. We can see signs of that in our model as the region of interference is generally more active during slow-wave sleep but we believe making specific predictions regarding this important question would go beyond the scope of our model that my not include the biophysical mechanisms necessary to account for this phenomenon. We included a brief discussion of this important question to revised paper.</p><p>In Discussion:</p><p>“Cortical replay of recently formed memories results in a tagging of synapses involved in consolidation of those memories by increasing their synaptic efficacy (Langille, 2019). These tagged synapses may likely be reactivated throughout sleep thereby resulting in more cortical replay during both NREM and REM sleep (Diekelmann and Born, 2010; Langille, 2019).”</p><disp-quote content-type="editor-comment"><p>The authors present and discuss an asymmetric expansion of place fields following sleep. However, this result is not consistent with Mehta et al., 1997 as the authors claim. Mehta in fact found that the backwards expansion of place fields was reset at the beginning of each track session (presumably as a result of overnight sleep), but that the place-fields expanded again over the course of a behavioral session. The findings of Mehta et al. are therefore more consistent with net downscaling of memory during sleep, rather than the model presented here. This discrepancy should be addressed.</p></disp-quote><p>We thank the reviewer for this important comment. Indeed, Mehta et al., 1997 stated that the observed backwards expansion of place fields was reset between track sessions. It is important to note that the resetting of the backwards expanded place fields between sessions was a phenomenon specific to the CA1. More recent work found that this resetting effect is diminished in the CA3 (Roth et al., 2012). These results suggest possibility that different synapses (i.e. CA3 vs. CA1) may have different plasticity time constants. Furthermore, the neocortex may have entirely different synaptic dynamic since its goal is long term storage as opposed to temporal indexing. There are evidences that with successive sleep periods, cortical memories become hippocampal independent (Lehmann and McNamara, 2011) and this could explain why the reset of the place fields was observed in Mehta et al., 1997. In our work, we are providing a prediction about cortical memory consolidation as it may relate to similar phenomenon of backwards expansion in the hippocampus. To our knowledge these experiments have not been done yet. In all, we present here a prediction that the cortical (particularly in associate cortex) representation of the sequence memories undergoes a similar form of backwards expansion observed in hippocampus. This form of backwards expansion, however, is not expected to be reset as it is in hippocampus.</p><p>To address the second part of this comment regarding global downscaling, we have conducted additional simulations showing that LTD biasing during sleep still allows sleep in our model to orthogonalize the interfering memories while down scale majority of synapses (which are presumable not critical for that memory storage) (Figure 7—figure supplement 2A). These data predicts that during slow wave sleep many synaptic weights undergo a net reduction of strength, while there are still subsets of synapses which increase strength and become strongly preferential for the learned sequences.</p><p>The following text has been added to the Discussion section in order to address these comments.</p><p>In Discussion:</p><p>“It is important to note that (Mehta et al., 1997) found that backwards expansion of the place fields was reset between sessions. […] Our study predicts that the cortical (such as in associate cortex) representations of the sequence memories undergo a similar form of backwards expansion as it was observed in CA1. This form of backwards expansion, however, persists and even increases after sleep.”</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>This paper examines the formation of sequence memories in a computational model of hippocampus equipped with STDP, and in particular in the role of sleep.</p><p>Sleep, as well as interleaved training, is shown to separate storage of forward and backward sequences.</p><p>How this relates to catastrophic forgetting is a bit tentative. For instance, I don't think the setup will allow storage of both ABCDE and ABCFG, but it would be nice to be proven wrong.</p></disp-quote><p>The reviewer is correct. If all the memory info is compressed to just these sequences, ABCDE and ABCFG, which have identical initial subsequences (ABC), there is no information to decide what the rest of the sequence (DE and FG) should be continued. Perhaps, the main objective in this case would be what types of additional cues are needed to store and retrieve partially identical sequences. If these cues become part of the sequence, then initial segments are not identical and memories can be separated. Example of that may be how we select a path from our office to the parking lot vs. library. Initial segment is the same and we execute it based on previous learning (turn left, go to elevator, get to the exit). The rest (where to go after we left the building) however is different and we dice based on the additional knowledge (going to parking lot vs. library) which in such example should be considered part of the initial memory trace. More specifically, we imagine that it would be impossible for a mouse or a human to follow a specific sequence (ABCDE vs. ABCFG) if they are only presented with the same initial part of the sequence (ABC). What would be necessary for this type of task would be the addition of another “letter” or cue to help guide the trajectory of the rest of the behavior / response. That is to say, the condition proposed by the reviewer would work if, e.g., the sequences were augmented by adding K or L letter to the beginning (KABCDE vs. LABCFG). In this way, the network would have additional information to help guide its activity once it reached the sequence bifurcation point. And this information could be used in the network having appropriate long-range connections. Our main objective in considering two opposite sequences was that such a training protocol should allow forgetting of the originally trained memory after a new memory is trained using the same neuronal and synaptic resources.</p><disp-quote content-type="editor-comment"><p>I wonder if the mechanism thus requires an extraordinary amount of fine-tuning that could not expected in biology. On the other hand, during interleaved training, during which the symmetry is presumably also broken by hand, bi-directional connections are also removed. As a result I am not fully convinced my explanation is correct. In any case, I think it would be important to show that the mechanism does not require fine-tuning of the A<sub>+</sub>/A<sub>-</sub> ratio.</p></disp-quote><p>We would like to thank the reviewer for this important question and insightful comments. Our motivation to use LTD biased STDP during training was because during focused learning the local release of acetylcholine results in a biasing of STDP towards LTP (Blokland, 1995; Shinoe et al., 2005; Sugisaki et al., 2016). STDP in the model was symmetric during sleep. To show that asymmetric STDP would lead to similar weights dynamics in the model during sleep and to address the reviewer’s comment with regards to the mechanism presented here requiring “fine-tuning” of the A<sub>+</sub>/A<sub>-</sub> ratio, we have performed the following simulations and discuss their results below.</p><p>As shown in Figure 7—figure supplement 2, biasing the LTP/LTD ratio during sleep towards either LTD (Figure 7—figure supplement 2A) or LTP (Figure 7—figure supplement 2B) still results in the orthogonalization of the memory representations as demonstrated by the increase of sequence specific connections after sleep. In these figures, the scatter plots show the distribution of bidirectional synaptic connections in the trained region at baseline (left), after S1 training (middle left), after S1* training (middle right), and after sleep (right). (As in the main paper, for each bidirectional coupling between two neurons A&lt;-&gt;B , we plotted the strength of A-&gt;B synapse on X axis and the strength of B-&gt;A synapse in Y axis.) The red lines on these plots depict the threshold used to identify neuronal pairs that are either strongly preferential for S1 (bottom right corner) or S1* (top left corner). The amount of synapses above this threshold are quantified in the bar plots below showing that sleep increases the density of the memory specific couplings between neurons regardless of the LTP/LTD ratio.</p><p>The vector field plots (Figure 7—figure supplement 2, middle panels) provide summaries of the average synaptic weight dynamics during training of either sequence (left and middle plots) and during sleep. It reveals convergence towards the corners which represent cell pairs being strongly enrolled either to sequence S1 or sequence S1*. It should be noted, because our model does not have homeostatic mechanisms to regulate “average” synaptic strength during sleep, the case of LTD biased sleep shows a net reduction of synaptic strengths (vector fields point towards the origin), while the LTP biased condition shows a net increase (vector fields pointing to top right corner). It is interesting that in the case of net reduction of synaptic weights, there is still strong orthogonalization of the weights. So, what was happening is that the bulk of synapses decreases their strength while fraction of synapses kept or even increased the strength and these synapses became memory specific. This observation may be in line with ideas from the Tononi and colleagues showing net reductions of synaptic weights during sleep (Tononi and Cirelli, 2014), however, more analysis of the model including additional homeostatic rules is need to make this conclusion from our simulations.</p><p>These results are discussed as follows:</p><p>In Results:</p><p>“In all previous simulations, LTP and LTD were balanced during sleep or interleaved training. […] This observation may be in line with ideas from Tononi and colleagues showing net reductions of synaptic weights during sleep (Tononi and Cirelli, 2014) however, more analysis of the model including additional homeostatic rules is need to make this conclusion based on model simulations.”</p><p>In Discussion:</p><p>“The Sleep Homeostasis Hypothesis (Tononi and Cirelli, 2014) suggests that homeostatic mechanisms active during sleep should result in a net synaptic depression to renormalize synaptic weights and to stabilize network dynamics. […] The network would then be able to use these synapses to encode new memories thus potentially facilitating continual learning without the consequence of retroactive interference.”</p><disp-quote content-type="editor-comment"><p>The paper could have been presented better. The Materials and methods are particularly poor, as it mentions for instance histamine modulation and minis, however, they are mentioned just once and it remains completely unclear whether these ingredients matter. Now it might well be that this was extensively discussed in previous papers, but that is no excuse.</p><p>Similarly the dynamics of the synaptic input (subsection “Synaptic currents and spike-timing dependent plasticity (STDP)” is not discussed.</p></disp-quote><p>Thank you for this comment. In order to address these comments we have extended our Materials and methods section to reflect more discussion of the model.</p></body></sub-article></article>