<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN"  "JATS-archivearticle1-3-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">102539</article-id><article-id pub-id-type="doi">10.7554/eLife.102539</article-id><article-id pub-id-type="doi" specific-use="version">10.7554/eLife.102539.3</article-id><article-version article-version-type="publication-state">version of record</article-version><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Human brain dynamics and spatiotemporal trajectories during threat processing</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><name><surname>Misra</surname><given-names>Joyneel</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8306-4832</contrib-id><email>joyneelm@umd.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Pessoa</surname><given-names>Luiz</given-names></name><email>pessoa@umd.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/047s2c258</institution-id><institution>Department of Electrical and Computer Engineering, University of Maryland</institution></institution-wrap><addr-line><named-content content-type="city">College Park</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/047s2c258</institution-id><institution>Department of Psychology, University of Maryland</institution></institution-wrap><addr-line><named-content content-type="city">College Park</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/047s2c258</institution-id><institution>Maryland Neuroimaging Center, University of Maryland</institution></institution-wrap><addr-line><named-content content-type="city">College Park</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Büchel</surname><given-names>Christian</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03wjwyj98</institution-id><institution>University Medical Center Hamburg-Eppendorf</institution></institution-wrap><country>Germany</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Büchel</surname><given-names>Christian</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03wjwyj98</institution-id><institution>University Medical Center Hamburg-Eppendorf</institution></institution-wrap><country>Germany</country></aff></contrib></contrib-group><pub-date publication-format="electronic" date-type="publication"><day>29</day><month>01</month><year>2026</year></pub-date><volume>14</volume><elocation-id>RP102539</elocation-id><history><date date-type="sent-for-review" iso-8601-date="2024-10-10"><day>10</day><month>10</month><year>2024</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint.</event-desc><date date-type="preprint" iso-8601-date="2024-11-23"><day>23</day><month>11</month><year>2024</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2024.04.06.588389"/></event><event><event-desc>This manuscript was published as a reviewed preprint.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2025-01-07"><day>07</day><month>01</month><year>2025</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.102539.1"/></event><event><event-desc>The reviewed preprint was revised.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2025-04-23"><day>23</day><month>04</month><year>2025</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.102539.2"/></event></pub-history><permissions><copyright-statement>© 2025, Misra and Pessoa</copyright-statement><copyright-year>2025</copyright-year><copyright-holder>Misra and Pessoa</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-102539-v1.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-102539-figures-v1.pdf"/><abstract><p>Functional MRI (fMRI) research has traditionally investigated task processing using static blocked or event-related designs. Consequently, our understanding of threat processing remains limited to findings from paradigms with restricted dynamics. In this paper, we applied switching linear dynamical systems (SLDSs) to uncover the dynamics of threat processing during a continuous threat-of-shock paradigm. Unlike typical systems neuroscience studies that assume systems are decoupled from external inputs, we characterized both endogenous and exogenous contributions to the dynamics. We first demonstrated that the SLDS model learned the regularities of the experimental paradigm; states and state transitions estimated from fMRI data across 85 regions of interest reflected both threat proximity and direction (approach vs. retreat). After establishing that the model captured key properties of threat-related processing, we characterized the dynamics of states and their transitions. The results reveal how threat processing can be viewed as dynamic multivariate patterns whose trajectories are determined by intrinsic and extrinsic factors that jointly drive how the brain temporally evolves. Furthermore, we developed a measure of region importance to quantify individual brain region contributions to system dynamics, complementing the system-level SLDS formalism. Finally, we demonstrated that an SLDS model trained on one paradigm successfully generalizes to a separate experiment, capturing fMRI dynamics across distinct threat-processing tasks. We propose that viewing threat processing through the lens of dynamical systems offers vital avenues to uncover properties of threat dynamics not unveiled by standard experimental designs.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>threat processing</kwd><kwd>fMRI</kwd><kwd>dynamical systems</kwd><kwd>attractors</kwd><kwd>brain states</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04t0s7x83</institution-id><institution>National Institute of Mental Health</institution></institution-wrap></funding-source><award-id>R01-MH-071589</award-id><principal-award-recipient><name><surname>Pessoa</surname><given-names>Luiz</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Intrinsic neural attractors and extrinsic environmental inputs jointly steer the dynamic trajectories of brain activity during threat processing.</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>publishing-route</meta-name><meta-value>prc</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Historically, systems neuroscience has sought to develop experimental paradigms where an effect of interest is varied while as many other variables remain fixed in an attempt to isolate the impact of the former while controlling for the latter. Such a time-tested strategy has provided deep insights into brain and behavior. However, with the advent of neurotechnologies allowing the study of animals in more freely behaving conditions, more naturalistic paradigms have been introduced (<xref ref-type="bibr" rid="bib26">Hunt et al., 2021</xref>; <xref ref-type="bibr" rid="bib65">Testard et al., 2024</xref>). At the same time, in human neuroimaging, researchers have defended the idea that dynamic and/or naturalistic paradigms are needed to advance our understanding of brain and behavior in a way that is not entirely constrained by rigid paradigms (<xref ref-type="bibr" rid="bib25">Hasson and Honey, 2012</xref>; <xref ref-type="bibr" rid="bib62">Sonkusare et al., 2019</xref>; <xref ref-type="bibr" rid="bib16">Finn et al., 2020</xref>; <xref ref-type="bibr" rid="bib32">Lee Masson and Isik, 2021</xref>; <xref ref-type="bibr" rid="bib22">Grall and Finn, 2022</xref>). While such ideas resonate with those from ecological psychology and ethological approaches (<xref ref-type="bibr" rid="bib21">Gothard et al., 2018</xref>; <xref ref-type="bibr" rid="bib45">Mobbs et al., 2018</xref>; <xref ref-type="bibr" rid="bib14">Evans et al., 2019</xref>), they introduce considerable challenges in the analysis of brain data and associated behaviors. If there are no specific trials or blocks in an experiment, what should constitute the unit of analysis? If the paradigm is more open-ended and lacks specific conditions (e.g. ‘attend to the visual stimulus’ vs. ‘attend to the audio stimulus’), how should brain and behavior be investigated?</p><p>A promising approach is the use of unsupervised methods that consider time series dynamics (<xref ref-type="bibr" rid="bib3">Anderson and Fincham, 2014</xref>; <xref ref-type="bibr" rid="bib70">Vidaurre et al., 2016</xref>; <xref ref-type="bibr" rid="bib5">Baldassano et al., 2017</xref>; <xref ref-type="bibr" rid="bib35">Linderman et al., 2016</xref>; <xref ref-type="bibr" rid="bib63">Taghia et al., 2017</xref>; <xref ref-type="bibr" rid="bib49">Pandarinath et al., 2018</xref>; <xref ref-type="bibr" rid="bib66">Townsend and Gong, 2018</xref>; <xref ref-type="bibr" rid="bib46">Morioka et al., 2020</xref>; <xref ref-type="bibr" rid="bib73">Wu et al., 2021</xref>; <xref ref-type="bibr" rid="bib57">Singh et al., 2022</xref>; <xref ref-type="bibr" rid="bib61">Song et al., 2023</xref>; <xref ref-type="bibr" rid="bib74">Xu et al., 2023</xref>; <xref ref-type="bibr" rid="bib68">Vahidi et al., 2024</xref>; <xref ref-type="bibr" rid="bib9">Chen et al., 2024</xref>). In particular, hidden Markov models (HMMs) can be applied to time series data and partition it into ‘states’ in time. For example, in one study, continuous narratives were presented and state transitions were identified from functional MRI (fMRI) signals (<xref ref-type="bibr" rid="bib5">Baldassano et al., 2017</xref>). Notably, state boundaries corresponded to human-annotated ones better than chance, and the match between model and human boundaries increased for more ‘high-level’ brain regions (e.g. angular gyrus).</p><p>Another study attempted to determine mental states while participants solved novel mathematical problems (<xref ref-type="bibr" rid="bib3">Anderson and Fincham, 2014</xref>). Model states were interpreted as reflecting ‘encoding’, ‘planning’, ‘solving’, and ‘responding’ stages based on fMRI data. Although the authors found evidence for the detected states, the study also highlights some of the challenges of applying unsupervised methods to complex paradigms. The estimated duration of the final responding state correlated well with the measured time participants spent entering their responses (<italic>r</italic>=0.53), providing some validation of that state. However, the mapping between brain signals and putative mental states (e.g. ‘encoding’) remained speculative. More generally, state-based modeling of fMRI data would benefit from evaluation in contexts where the experimental paradigm affords a clearer mapping between discovered states and experimental manipulation, as done here.</p><p>Overall, despite encouraging results (<xref ref-type="bibr" rid="bib3">Anderson and Fincham, 2014</xref>; <xref ref-type="bibr" rid="bib70">Vidaurre et al., 2016</xref>; <xref ref-type="bibr" rid="bib5">Baldassano et al., 2017</xref>; <xref ref-type="bibr" rid="bib63">Taghia et al., 2017</xref>; <xref ref-type="bibr" rid="bib64">Taghia et al., 2018</xref>; <xref ref-type="bibr" rid="bib69">van de Meer et al., 2020</xref>; <xref ref-type="bibr" rid="bib73">Wu et al., 2021</xref>; <xref ref-type="bibr" rid="bib60">Song et al., 2021</xref>; <xref ref-type="bibr" rid="bib61">Song et al., 2023</xref>), the extent to which state-space models successfully parse fMRI data into meaningful mental/brain states remains poorly understood. Critically, while state-space models like HMMs are able to segment time series data, they do not enable discovery of properties of state dynamics. In particular, how do brain signals evolve during a brain state that is maintained for a period of time? In systems neuroscience, progress has been made in this context by studying brain signals via dynamical systems theory (<xref ref-type="bibr" rid="bib76">Yu et al., 2005</xref>; <xref ref-type="bibr" rid="bib11">Deco et al., 2008</xref>; <xref ref-type="bibr" rid="bib56">Shenoy et al., 2013</xref>; <xref ref-type="bibr" rid="bib51">Remington et al., 2018</xref>; <xref ref-type="bibr" rid="bib53">Robson and Li, 2022</xref>). In particular, it has been suggested that attractor dynamics plays important computational functions (<xref ref-type="bibr" rid="bib40">Miller, 2016</xref>; <xref ref-type="bibr" rid="bib29">Khona and Fiete, 2022</xref>). However, comparable progress in fMRI research has lagged behind, perhaps because of the slowly evolving nature of the hemodynamic response (but see <xref ref-type="bibr" rid="bib28">John et al., 2022</xref>).</p><p>Threat processing is typically studied in terms of discrete events and/or blocks that correspond to experimental conditions (but see <xref ref-type="bibr" rid="bib42">Mobbs et al., 2007</xref>; <xref ref-type="bibr" rid="bib43">Mobbs et al., 2009</xref>; <xref ref-type="bibr" rid="bib48">Murty et al., 2023</xref>; <xref ref-type="bibr" rid="bib33">Levitas and James, 2024</xref>). For example, a conditioned threat is presented and associated evoked brain responses determined (<xref ref-type="bibr" rid="bib19">Fullana et al., 2016</xref>). But in many real-world situations, conditions involving threat unfold temporally in a less-discrete manner (<xref ref-type="bibr" rid="bib15">Fanselow and Lester, 1987</xref>). In the present investigation, we investigated brain dynamics during a continuous threat-of-shock paradigm (<xref ref-type="bibr" rid="bib39">Meyer et al., 2019</xref>; <xref ref-type="bibr" rid="bib34">Limbachia et al., 2021</xref>; <xref ref-type="fig" rid="fig1">Figure 1</xref>). We sought to characterize the evolution of brain signals in terms of trajectories in multidimensional space, a framework at times called ‘computing with trajectories’ (<xref ref-type="bibr" rid="bib8">Buonomano and Maass, 2009</xref>). Instead of responses to discrete events possibly observed across multiple brain sites, we determined multivariate and distributed patterns of activity with shared dynamics.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Determining shared dynamics during threat processing.</title><p>Switching linear dynamical systems (SLDSs) were used to model functional MRI (fMRI) time series data (<inline-formula><alternatives><mml:math id="inf1"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft1">\begin{document}$Y_{t}$\end{document}</tex-math></alternatives></inline-formula>) from a set of brain regions of interest (ROIs). The framework assumes that time series data can be segmented into a set of discrete states. The model represents brain signals in terms of a set of latent variables (<inline-formula><alternatives><mml:math id="inf2"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft2">\begin{document}$X_{t}$\end{document}</tex-math></alternatives></inline-formula>). For each state <inline-formula><alternatives><mml:math id="inf3"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>k</mml:mi></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft3">\begin{document}$k$\end{document}</tex-math></alternatives></inline-formula>, the temporal evolution of the system is specified via a linear dynamical system with both intrinsic and input-related components. In the diagram, the system starts in state <inline-formula><alternatives><mml:math id="inf4"><mml:mi>j</mml:mi></mml:math><tex-math id="inft4">\begin{document}$j$\end{document}</tex-math></alternatives></inline-formula> (white star) and transitions to state <inline-formula><alternatives><mml:math id="inf5"><mml:mi>k</mml:mi></mml:math><tex-math id="inft5">\begin{document}$k$\end{document}</tex-math></alternatives></inline-formula> (the colored patches in the middle represent the subspaces associated with the two states). In state <inline-formula><alternatives><mml:math id="inf6"><mml:mi>k</mml:mi></mml:math><tex-math id="inft6">\begin{document}$k$\end{document}</tex-math></alternatives></inline-formula>, the system evolves according to the dynamics matrix <inline-formula><alternatives><mml:math id="inf7"><mml:msub><mml:mi>A</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft7">\begin{document}$A_{k}$\end{document}</tex-math></alternatives></inline-formula> and input contributions (<inline-formula><alternatives><mml:math id="inf8"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft8">\begin{document}$V_{k}$\end{document}</tex-math></alternatives></inline-formula>). Overall, as states switch temporally, so does the corresponding linear dynamical system governing the system’s trajectory.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-102539-fig1-v1.tif"/></fig><p>We employed a switching linear dynamical systems (SLDSs) framework that estimates a generative model of the data with both states and transitions like HMMs (<xref ref-type="bibr" rid="bib1">Ackerson and Fu, 1970</xref>; <xref ref-type="bibr" rid="bib6">Barber, 2006</xref>; <xref ref-type="bibr" rid="bib17">Fox et al., 2008</xref>; <xref ref-type="bibr" rid="bib36">Linderman et al., 2019</xref>). In addition, each state is described in terms of a linear dynamical system that specifies the trajectory of brain activity during the state. Importantly, we estimated both endogenous and exogenous components of the dynamics, whereas some past work has not modeled both contributions (see discussion in <xref ref-type="bibr" rid="bib29">Khona and Fiete, 2022</xref>). A considerable challenge in state-based modeling, including SLDSs, is linking estimated states and dynamics to interpretable processes. Here, we developed a measure of <italic>region importance</italic> that provides a biologically meaningful way to bridge this gap, as it quantifies how individual brain regions contribute to steering state trajectories. Our approach demonstrated that we can recover key properties of threat-related processing in the brain (<xref ref-type="bibr" rid="bib24">Grupe and Nitschke, 2013</xref>), while establishing novel properties of threat and safety dynamics. More generally, the approach can be applied to a broad range of continuous and/or naturalistic fMRI paradigms investigated in humans.</p><p>We also investigated model generalizability: how well does a model estimated in one paradigm generalize to related experiments? Examining this question is of importance because even statistically significant fits do not necessarily generalize well to unseen data, not to mention to related but different paradigms. However, if an SLDS model captures meaningful spatiotemporal regularities associated with behavioral/brain states in a given dataset, the SLDS states should provide good fits to unseen data from a second, related experiment. Here, we investigated the extent to which the SLDS model that was fit to the moving circles paradigm generalized to a second, continuous paradigm involving threat and safety conditions.</p><p>Is the present contribution focused on threat processing or methodological developments for the analysis of more continuous/ecologically valid paradigms? Our answer is ‘both’. One goal was to contribute to the development of a framework that considers brain processing to be inherently dynamic and multivariate. In particular, our goal was to provide the formal basis for conceptualizing threat processing as a dynamic process (see <xref ref-type="bibr" rid="bib15">Fanselow and Lester, 1987</xref>) subject to endogenous and exogenous contributions. At the same time, our study revealed how regions studied individually in the past (e.g. anterior insula, cingulate cortex) contribute to brain states with multiregion dynamics.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Continuous threat processing switches between states</title><p>Participants watched two circles of different colors on the screen, at times moving close to each other, at times moving apart in a smooth but unpredictable fashion (<xref ref-type="bibr" rid="bib39">Meyer et al., 2019</xref>; <xref ref-type="bibr" rid="bib34">Limbachia et al., 2021</xref>). Upon circle collision, the participants received mild but unpleasant electrical stimulation together with an aversive sound. To enhance unpredictability and hence anxious apprehension by participants, the movement of the circles included multiple instances of ‘near misses’ in which the circles nearly touched before retreating from each other.</p><p>Time series data were analyzed according to the SLDS framework (<xref ref-type="fig" rid="fig1">Figure 1</xref>). Briefly, an SLDS estimates a model of the data using a set of unobserved (also called latent) variables assumed to govern system dynamics. The latent space is typically of considerably smaller dimension relative to the original data space (here 10 latent dimensions and 85 region of interest [ROI] time series, respectively). SLDSs consist of one linear dynamical system model per state, such that the trajectory of the system is governed by a single dynamical system at a time. Like HMMs, an SLDS segments the data into a fixed number of states, such that the transitions between states follow a Markov process. At a given time, a single state is considered to be ‘active’. Overall, SLDS models provide a piecewise linear approximation of (potentially nonlinear) dynamics. Time series data were obtained from 85 regions involved in threat-related processing, as defined in a prior study (<xref ref-type="bibr" rid="bib47">Murty et al., 2022</xref>).</p><p>The results reported below were obtained with 92 participants. A separate group of 30 participants was used to define hyperparameters, including the number of states (<inline-formula><alternatives><mml:math id="inf9"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft9">\begin{document}$K=6$\end{document}</tex-math></alternatives></inline-formula>, see Appendix 1) and the dimensionality of the latent space (<inline-formula><alternatives><mml:math id="inf10"><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:math><tex-math id="inft10">\begin{document}$D=10$\end{document}</tex-math></alternatives></inline-formula>, see Appendix 1). Assessing statistical significance when complex models are applied to multi-participant data requires estimating variability of the estimates across participants. We employed a bootstrap procedure such that an SLDS model was estimated for each bootstrap sample, allowing us to estimate how SLDS parameters varied across the population (see Methods), thus allowing generalization beyond the current sample.</p><sec id="s2-1-1"><title>Model states are synchronous with the experimental paradigm</title><p>We evaluated if the states estimated by the model reflected experimental stimuli. For example, when the circles were far from each other, participants were ‘safe’, in contrast to when the circles were rather close and could progress to a collision. We encoded the input based on 20 bins defined in terms of circle proximity and direction: <inline-formula><alternatives><mml:math id="inf11"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft11">\begin{document}$A_{1}-A_{10}$\end{document}</tex-math></alternatives></inline-formula> for approach, <inline-formula><alternatives><mml:math id="inf12"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft12">\begin{document}$R_{1}-R_{10}$\end{document}</tex-math></alternatives></inline-formula> for retreat (see Methods, top inset in <xref ref-type="fig" rid="fig2">Figure 2</xref>). When the circles approached each other, <inline-formula><alternatives><mml:math id="inf13"><mml:msub><mml:mi>A</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="inft13">\begin{document}$A_{1}$\end{document}</tex-math></alternatives></inline-formula> indicated the farthest distance and <inline-formula><alternatives><mml:math id="inf14"><mml:msub><mml:mi>A</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="inft14">\begin{document}$A_{10}$\end{document}</tex-math></alternatives></inline-formula> indicated that they collided; when they retreated from each other, <inline-formula><alternatives><mml:math id="inf15"><mml:msub><mml:mi>R</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="inft15">\begin{document}$R_{10}$\end{document}</tex-math></alternatives></inline-formula> indicated that the circles collided and <inline-formula><alternatives><mml:math id="inf16"><mml:msub><mml:mi>R</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="inft16">\begin{document}$R_{1}$\end{document}</tex-math></alternatives></inline-formula> indicated the farthest distance. We determined the associations between brain states and stimulus categories (i.e. bins) by calculating the probability of a brain state given the stimulus, <inline-formula><alternatives><mml:math id="inf17"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mtext>state</mml:mtext><mml:mo lspace="2.5pt" rspace="7.5pt" stretchy="false">|</mml:mo><mml:mtext>stimulus</mml:mtext></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="inft17">\begin{document}$P(\text{state}\leavevmode\nobreak\ |\leavevmode\nobreak\ \text{stimulus})$\end{document}</tex-math></alternatives></inline-formula> (see Methods). The probabilities are shown in <xref ref-type="fig" rid="fig2">Figure 2A</xref> (e.g. <inline-formula><alternatives><mml:math id="inf18"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mtext mathvariant="monospace">STATE 2</mml:mtext></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0.63</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft18">\begin{document}$P(\texttt{STATE 2} \, |\, A_{10})=0.63$\end{document}</tex-math></alternatives></inline-formula>), where values exceeding those expected by chance are indicated in red outline. A total of five out of six brain states were significantly associated with specific stimuli categories. Examination of <xref ref-type="fig" rid="fig2">Figure 2A</xref> can be used to provide a qualitative description of the estimated brain states. For example, <monospace>STATE 2</monospace> was maximally observed when the circles were approaching and then collided, and thus reflects shock delivery (as well as peri-shock periods). As another example, <monospace>STATE 5</monospace> was observed when the circles were in close proximity but did not touch. This state was particularly interesting given that the experiment was designed such that multiple ‘near-miss’ events would occur during the session, so as to enhance participants’ state of apprehension when the circles approached each other.</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Brain states, state transitions, and input stimuli.</title><p>Stimuli were categorized into 20 bins based on circle distance and movement direction: <inline-formula><alternatives><mml:math id="inf19"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft19">\begin{document}$A_{1}-A_{10}$\end{document}</tex-math></alternatives></inline-formula> for approach, <inline-formula><alternatives><mml:math id="inf20"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft20">\begin{document}$R_{1}-R_{10}$\end{document}</tex-math></alternatives></inline-formula> for retreat (1 indicates circles are farthest and 10 indicates circle collision). (<bold>A</bold>) Table entries indicate the probability of being in a state given the input stimulus category. (<bold>B</bold>) Table entries indicate the probability of a state transition given the input stimulus category. In both tables, cells highlighted in red indicate states/transitions significantly associated with the corresponding stimulus category (<inline-formula><alternatives><mml:math id="inf21"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft21">\begin{document}${\rm p} \lt 0.05$\end{document}</tex-math></alternatives></inline-formula>, corrected for multiple comparisons). The color scale indicates probability.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-102539-fig2-v1.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Brain states, state transitions, and input stimuli: version with 10 stimulus categories.</title><p>Stimuli were categorized into bins based on circle distance and movement direction indicated <inline-formula><alternatives><mml:math id="inf22"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>A</mml:mi></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft22">\begin{document}$A$\end{document}</tex-math></alternatives></inline-formula> with for approach and <inline-formula><alternatives><mml:math id="inf23"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>R</mml:mi></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft23">\begin{document}$R$\end{document}</tex-math></alternatives></inline-formula> for retreat (1 indicates circles are farthest and 5 indicates circle collision). (<bold>A</bold>) Table entries indicate the probability of being in a state given the input stimulus category. (<bold>B</bold>) Table entries indicate the probability of a state transition given the input stimulus category. In both tables, cells highlighted in red indicate states/transitions significantly associated with the corresponding stimulus category (p&lt;0.05, corrected for multiple comparisons). The color scale indicates probability.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-102539-fig2-figsupp1-v1.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Brain states, state transitions, and input stimuli: version with 30 stimulus categories.</title><p>Stimuli were categorized into bins based on circle distance and movement direction indicated with <inline-formula><alternatives><mml:math id="inf24"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>A</mml:mi></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft24">\begin{document}$A$\end{document}</tex-math></alternatives></inline-formula> for approach and <inline-formula><alternatives><mml:math id="inf25"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>R</mml:mi></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft25">\begin{document}$R$\end{document}</tex-math></alternatives></inline-formula> for retreat (1 indicates circles are farthest and 15 indicates circle collision). (<bold>A</bold>) Table entries indicate the probability of being in a state given the input stimulus category. (<bold>B</bold>) Table entries indicate the probability of a state transition given the input stimulus category. In both tables, cells highlighted in red indicate states/transitions significantly associated with the corresponding stimulus category (p&lt;0.05, corrected for multiple comparisons). The color scale indicates probability.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-102539-fig2-figsupp2-v1.tif"/></fig></fig-group><p>We found that brain states were observed under specific stimulus conditions. But as the stimulus conditions change, do states transition in a systematic fashion? To evaluate this question, we determined the probability of a state transition given a specific stimulus category (<xref ref-type="fig" rid="fig2">Figure 2B</xref>, e.g., <inline-formula><alternatives><mml:math id="inf26"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mtext mathvariant="monospace">STATE 2</mml:mtext></mml:mrow><mml:mo stretchy="false">↦</mml:mo><mml:mrow><mml:mtext mathvariant="monospace">STATE 1</mml:mtext></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0.88</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft26">\begin{document}$P([\texttt{STATE 2}\mapsto\texttt{STATE 1}]\, |\, A_{10})=0.88$\end{document}</tex-math></alternatives></inline-formula>; see Methods). <xref ref-type="fig" rid="fig2">Figure 2B</xref> shows state transitions that were significantly associated with a stimulus category. For example, <monospace>STATE 2</monospace> (centered on the collision event) transitioned to <monospace>STATE 1</monospace> (‘post-shock’) with very high probability for both stimulus categories <inline-formula><alternatives><mml:math id="inf27"><mml:msub><mml:mi>A</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="inft27">\begin{document}$A_{10}$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf28"><mml:msub><mml:mi>R</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="inft28">\begin{document}$R_{10}$\end{document}</tex-math></alternatives></inline-formula> (i.e. when the circles collided). In <xref ref-type="fig" rid="fig2">Figure 2B</xref>, to facilitate understanding, we ordered the rows by starting with the <monospace>STATE 1</monospace> to <monospace>STATE 3</monospace> transition (from ‘post-shock’ to ‘not close’) and then chained the transitions in a manner that reflected the movement of the circles. Thus, the second row shows <inline-formula><alternatives><mml:math id="inf29"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">E</mml:mi><mml:mspace width="thinmathspace"/><mml:mn>3</mml:mn><mml:mo stretchy="false">↦</mml:mo><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">E</mml:mi><mml:mspace width="thinmathspace"/><mml:mn>5</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft29">\begin{document}$\rm STATE\, 3 \mapsto STATE\, 5$\end{document}</tex-math></alternatives></inline-formula> (from ‘not close’ to ‘near miss’) and so on. For ease of reference, we summarize state descriptions in <xref ref-type="box" rid="box1">Box 1</xref>.</p><boxed-text id="box1"><label>Box 1.</label><caption><title>SLDS state descriptions</title></caption><list list-type="bullet" id="list1"><list-item><p><monospace>STATE 1</monospace>: ‘post-shock’. Observed right after the circles collided; only state that followed <monospace>STATE 2</monospace> in <xref ref-type="fig" rid="fig2">Figure 2B</xref>.</p></list-item><list-item><p><monospace>STATE 2</monospace>: ‘shock/peri-shock’. Observed during shock and peri-shock inputs.</p></list-item><list-item><p><monospace>STATE 3</monospace>: ‘not near’. Observed when the circles were not near.</p></list-item><list-item><p><monospace>STATE 4</monospace>: ‘not near’. Observed when the circles were not near and similar to <monospace>STATE 3</monospace> in terms of inputs; <monospace>STATE 4</monospace> followed STATE 5 when, after a near-miss collision, the circles continued to move apart from each other.</p></list-item><list-item><p><monospace>STATE 5</monospace>: ‘near miss’. Observed when circles approached, came close to colliding, and then retreated.</p></list-item></list></boxed-text><p>Together, brain states and state transitions were systematically related to external stimuli, demonstrating that the model captured important properties of the experimental paradigm in an unsupervised manner.</p></sec><sec id="s2-1-2"><title>Model states capture threat processing</title><p>We reasoned that if states detected by the model reflect known mental states, they should be associated with brain activity with coherent spatial patterns consistent with those observed with standard fMRI designs (such as block and event-related designs). SLDS states and state transitions are defined in a latent space of dimensionality considerably lower than the original brain data space (here, 85 brain regions). Thus, to determine brain maps associated with specific states, we performed linear regression with a regressor that was on during the state in question and off otherwise (see Methods). <xref ref-type="fig" rid="fig3">Figure 3</xref> illustrates some of the states (see <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> for all states). For <monospace>STATE 5</monospace>, consistent with the ‘near-miss’ interpretation, multiple brain areas linked to increased anxious apprehension were positively engaged, including the anterior insula and cingulate cortex (<xref ref-type="bibr" rid="bib43">Mobbs et al., 2009</xref>; <xref ref-type="bibr" rid="bib44">Mobbs et al., 2010</xref>; <xref ref-type="bibr" rid="bib2">Alvarez et al., 2011</xref>; <xref ref-type="bibr" rid="bib24">Grupe and Nitschke, 2013</xref>; <xref ref-type="bibr" rid="bib59">Somerville et al., 2013</xref>; <xref ref-type="bibr" rid="bib39">Meyer et al., 2019</xref>; <xref ref-type="bibr" rid="bib27">Hur et al., 2020</xref>; <xref ref-type="bibr" rid="bib47">Murty et al., 2022</xref>; <xref ref-type="bibr" rid="bib48">Murty et al., 2023</xref>). <monospace>STATE 4</monospace>, which tended to follow <monospace>STATE 5</monospace>, exhibited a deactivation of these regions, consistent with the notion that participants experienced relative safety following a near collision (<xref ref-type="bibr" rid="bib55">Schiller et al., 2008</xref>; <xref ref-type="bibr" rid="bib24">Grupe and Nitschke, 2013</xref>; <xref ref-type="bibr" rid="bib59">Somerville et al., 2013</xref>).</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Voxelwise state activity maps and state contrast maps.</title><p>State activity maps for <monospace>STATE 4</monospace> and <monospace>STATE 5</monospace> and the contrast of the two states. Maps were corrected for multiple comparisons by thresholding voxels at <inline-formula><alternatives><mml:math id="inf30"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.001</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft30">\begin{document}${\rm p} \lt 0.001$\end{document}</tex-math></alternatives></inline-formula> and at the cluster level at <inline-formula><alternatives><mml:math id="inf31"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft31">\begin{document}${\rm p} \lt 0.05$\end{document}</tex-math></alternatives></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-102539-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Voxelwise state activity maps for all states.</title><p>Activity maps indicate signal intensity at a voxel when the state was ‘on’. Maps were corrected for multiple comparisons by thresholding voxels at <inline-formula><alternatives><mml:math id="inf32"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.001</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft32">\begin{document}${\rm p} \lt 0.001$\end{document}</tex-math></alternatives></inline-formula> and cluster level at <inline-formula><alternatives><mml:math id="inf33"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft33">\begin{document}${\rm p} \lt 0.05$\end{document}</tex-math></alternatives></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-102539-fig3-figsupp1-v1.tif"/></fig></fig-group><p>We further investigated the spatial properties of brain states by contrasting states. For example, the contrast of <monospace>STATE 5</monospace> vs. <monospace>STATE 4</monospace> revealed a pattern of activation very similar to that obtained in the literature for the contrast of higher vs. lower levels of threat. In particular, the contrast identified sectors of ventromedial PFC and posterior cingulate that have been linked to relative safety (<xref ref-type="bibr" rid="bib55">Schiller et al., 2008</xref>; <xref ref-type="bibr" rid="bib24">Grupe and Nitschke, 2013</xref>).</p></sec><sec id="s2-1-3"><title>Temporal evolution of activity</title><p>In the threat paradigm, as the circles moved continuously, we expected that brain signals would also vary temporally. If SLDS states captured meaningful information, state transitions should be associated with relevant activity change. To evaluate this possibility, we determined signal evolution during temporal windows centered around state transitions (see Methods). <xref ref-type="fig" rid="fig4">Figure 4</xref> shows signal evolution in the same order as the state transitions of <xref ref-type="fig" rid="fig2">Figure 2B</xref> in two key regions involved in threat-related processing, the dorsal anterior insula and the ventromedial PFC. For example, the transition from <monospace>STATE 2</monospace> to <monospace>STATE 1</monospace> reflected transitioning from a shock event to post-shock period. Accordingly, activity in the dorsal anterior insula, which is very sensitive to threat level (<xref ref-type="bibr" rid="bib43">Mobbs et al., 2009</xref>; <xref ref-type="bibr" rid="bib44">Mobbs et al., 2010</xref>; <xref ref-type="bibr" rid="bib2">Alvarez et al., 2011</xref>; <xref ref-type="bibr" rid="bib24">Grupe and Nitschke, 2013</xref>; <xref ref-type="bibr" rid="bib59">Somerville et al., 2013</xref>; <xref ref-type="bibr" rid="bib39">Meyer et al., 2019</xref>; <xref ref-type="bibr" rid="bib27">Hur et al., 2020</xref>; <xref ref-type="bibr" rid="bib47">Murty et al., 2022</xref>; <xref ref-type="bibr" rid="bib48">Murty et al., 2023</xref>), underwent a drastic decrease. Likewise, when <monospace>STATE 5</monospace> transitioned to <monospace>STATE 4</monospace>, activity in the dorsal anterior insula decreased, consistent with a transition from higher to lower threat and findings about responses in these two regions. In contrast, the transition from <monospace>STATE 3</monospace> (‘not close’) to <monospace>STATE 2</monospace> (peri-shock/shock) was associated with a sharp increase in activity strength in the dorsal anterior insula.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Region and network responses during state transitions.</title><p>Vertical lines indicate the time of state transition. State transitions are arranged in a chained manner: <inline-formula><alternatives><mml:math id="inf34"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mtext mathvariant="monospace">STATE 1</mml:mtext></mml:mrow><mml:mo stretchy="false">↦</mml:mo><mml:mrow><mml:mtext mathvariant="monospace">STATE 3</mml:mtext></mml:mrow><mml:mo stretchy="false">↦</mml:mo><mml:mrow><mml:mtext mathvariant="monospace">STATE 5</mml:mtext></mml:mrow><mml:mo stretchy="false">↦</mml:mo><mml:mrow><mml:mtext mathvariant="monospace"> STATE 4</mml:mtext></mml:mrow><mml:mo stretchy="false">↦</mml:mo><mml:mrow><mml:mtext mathvariant="monospace">STATE 3</mml:mtext></mml:mrow><mml:mo stretchy="false">↦</mml:mo><mml:mrow><mml:mtext mathvariant="monospace">STATE 2</mml:mtext></mml:mrow><mml:mo stretchy="false">↦</mml:mo><mml:mrow><mml:mtext mathvariant="monospace">STATE 1</mml:mtext></mml:mrow><mml:mo stretchy="false">↦</mml:mo><mml:mrow><mml:mtext mathvariant="monospace">STATE 4</mml:mtext></mml:mrow><mml:mo stretchy="false">↦</mml:mo><mml:mrow><mml:mtext mathvariant="monospace">STATE 5</mml:mtext></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft34">\begin{document}$\texttt{STATE 1}\mapsto\texttt{STATE 3}\mapsto\texttt{STATE 5}\mapsto\texttt{ STATE 4}\mapsto\texttt{STATE 3}\mapsto\texttt{STATE 2}\mapsto\texttt{STATE 1} \mapsto\texttt{STATE 4}\mapsto\texttt{STATE 5}$\end{document}</tex-math></alternatives></inline-formula> to facilitate continuity in reading responses across state transitions. Error bars correspond to the 95% confidence interval based on the standard error of the mean across participants.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-102539-fig4-v1.tif"/></fig><p>SLDS models states and state transitions in a latent space, which makes it possible to investigate activity dynamics in regions <italic>not</italic> used for estimating the models, because once a sequence of states is determined, one can examine activity in such regions at those times. Furthermore, activity can be determined at different spatial units, including ROI, voxel, or voxel cluster. In <xref ref-type="fig" rid="fig4">Figure 4</xref>, we probed the average signals from two resting-state networks engaged during threat-related processing, the salience network, which is particularly engaged during higher threat, and the default network, which is engaged during conditions of relative safety. As anticipated, signal evolution during the transition <inline-formula><alternatives><mml:math id="inf35"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mtext mathvariant="monospace">STATE 5</mml:mtext></mml:mrow><mml:mo stretchy="false">↦</mml:mo><mml:mrow><mml:mtext mathvariant="monospace">STATE 4</mml:mtext></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft35">\begin{document}$\texttt{STATE 5}\mapsto\texttt{STATE 4}$\end{document}</tex-math></alternatives></inline-formula> was similar to that observed for the dorsal anterior insula and the ventromedial PFC, although signal evolution for the default network deviated to some extent from that of the ventromedial PFC (note that the ROIs and networks discussed here spatially overlapped; they were not selected to be independent).</p><p>Overall, the model captured regularities of the experimental paradigm reflected in systematic changes in activity levels across the brain. For example, state transitions <inline-formula><alternatives><mml:math id="inf36"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mtext mathvariant="monospace">STATE 3</mml:mtext></mml:mrow><mml:mo stretchy="false">↦</mml:mo><mml:mrow><mml:mtext mathvariant="monospace">STATE 5</mml:mtext></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft36">\begin{document}$\texttt{STATE 3}\mapsto\texttt{STATE 5}$\end{document}</tex-math></alternatives></inline-formula>, <inline-formula><alternatives><mml:math id="inf37"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mtext mathvariant="monospace">STATE 4</mml:mtext></mml:mrow><mml:mo stretchy="false">↦</mml:mo><mml:mrow><mml:mtext mathvariant="monospace">STATE 3</mml:mtext></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft37">\begin{document}$\texttt{STATE 4}\mapsto\texttt{STATE 3}$\end{document}</tex-math></alternatives></inline-formula>, and <inline-formula><alternatives><mml:math id="inf38"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mtext mathvariant="monospace">STATE 4</mml:mtext></mml:mrow><mml:mo stretchy="false">↦</mml:mo><mml:mrow><mml:mtext mathvariant="monospace">STATE 5</mml:mtext></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft38">\begin{document}$\texttt{STATE 4}\mapsto\texttt{STATE 5}$\end{document}</tex-math></alternatives></inline-formula> were associated with approaching circles (increased threat) and increased responses in the dorsal anterior insula and salience network following the state transition. Similarly, the transition <inline-formula><alternatives><mml:math id="inf39"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mtext mathvariant="monospace">STATE 5</mml:mtext></mml:mrow><mml:mo stretchy="false">↦</mml:mo><mml:mrow><mml:mtext mathvariant="monospace">STATE 4</mml:mtext></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft39">\begin{document}$\texttt{STATE 5}\mapsto\texttt{STATE 4}$\end{document}</tex-math></alternatives></inline-formula> was associated with retreating circles (decreased threat) and increased responses in the ventromedial PFC and default network following the state transition. Furthermore, responses of the right anterior insula and salience network during <monospace>STATE 2</monospace> (‘shock/peri-shock’) ramped up to the highest activity level with the <inline-formula><alternatives><mml:math id="inf40"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mtext mathvariant="monospace">STATE 3</mml:mtext></mml:mrow><mml:mo stretchy="false">↦</mml:mo><mml:mrow><mml:mtext mathvariant="monospace">STATE 2</mml:mtext></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft40">\begin{document}$\texttt{STATE 3}\mapsto\texttt{STATE 2}$\end{document}</tex-math></alternatives></inline-formula> transition from low to very high threat followed by a sharp decay with the <inline-formula><alternatives><mml:math id="inf41"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mtext mathvariant="monospace">STATE 2</mml:mtext></mml:mrow><mml:mo stretchy="false">↦</mml:mo><mml:mrow><mml:mtext mathvariant="monospace">STATE 1</mml:mtext></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft41">\begin{document}$\texttt{STATE 2}\mapsto\texttt{STATE 1}$\end{document}</tex-math></alternatives></inline-formula> transition that reflected the end of shock delivery.</p></sec></sec><sec id="s2-2"><title>Threat dynamics</title><p>Each state is characterized by a state-specific trajectory in latent space. Such state dynamics are defined by an intrinsic component and an external-input component, which additively define the system’s evolution (see <xref ref-type="fig" rid="fig1">Figure 1</xref> and Methods). In this section, we characterized the dynamics of threat processing based on state trajectories.</p><sec id="s2-2-1"><title>Intrinsic state dynamics evolve toward fixed-point attractors</title><p>First, we examined <italic>intrinsic</italic> state dynamics, namely the component of the dynamics that is separate from external input contributions. Does intrinsic dynamics converge to an attractor, or does it diverge away from a fixed point? It is possible to test the stability of dynamics by evaluating properties of the dynamics matrix (matrix <inline-formula><alternatives><mml:math id="inf42"><mml:mi>A</mml:mi></mml:math><tex-math id="inft42">\begin{document}$A$\end{document}</tex-math></alternatives></inline-formula>; see Methods). We found that the intrinsic dynamics of all states studied were attractors (see <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>).</p><p>An attractor state corresponds to a point in latent space. Such a vector can be visualized as a map, which we call an ‘attractor spatial map’ by projecting it onto the original brain data space in terms of ROI activity on a brain surface (<xref ref-type="fig" rid="fig5">Figure 5</xref>; see Methods). For example, <monospace>STATE 5</monospace> corresponded to ‘near-miss’ events and an attractor map with increased responses in the anterior insula/cingulate cortex and decreased responses in the ventromedial PFC and precuneus. The attractor for <monospace>STATE 4</monospace> (‘not near’) exhibited an opposite organization consistent with the context of increased safety/lower threat.</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Attractor maps.</title><p>State attractors projected onto the space of regions of interest (85 ROIs) visualized on a brain surface map. At each ROI, the color scale represents activity strength at the attractor’s fixed point. ROI boundaries are marked in black.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-102539-fig5-v1.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Stability of states.</title><p>Distribution of the norms of the largest eigenvalue of the dynamics matrix (<inline-formula><alternatives><mml:math id="inf43"><mml:mi>A</mml:mi></mml:math><tex-math id="inft43">\begin{document}$A$\end{document}</tex-math></alternatives></inline-formula>) across bootstrap samples. A state was considered an attractor if 95% of the norms were smaller than 1.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-102539-fig5-figsupp1-v1.tif"/></fig></fig-group><p>Given that the SLDS model learns a generative model of the fMRI data during the experimental paradigm, state trajectories are based on both endogenous and exogenous contributions. How do these trajectories evolve relative to the state attractor? To investigate this question, we determined the vector field defined by the state’s endogenous dynamics, where vectors represent the direction and magnitude of how a system evolves if started at specific points (<xref ref-type="fig" rid="fig6">Figure 6</xref>). Starting at a given point, trajectories evolved for multiple time steps in the overall direction of the attractor but after some time transitioned to other states (the green part of the trajectory indicates the mean lifetime of each state). The plots describe how, in a given state, the effective trajectory was determined by a combination of the endogenous flow and perturbations provided by the input. For example, in STATE 2 (shock/peri-shock), the vector field exhibited less curvature than several other states, but trajectories were quickly steered away from the attractor because of inputs.</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Evolution of state-specific trajectories.</title><p>Trajectories were determined in the latent space and projected onto a two-dimensional vector field for illustration (coordinate axes are specific to each state). The average trajectory across participants, starting at the white star, is initially shown in green and switches to red when the majority of trajectories (across participants) switch to another state. Whereas the trajectory includes endogenous and exogenous contributions to temporal evolution, the vector field represents the endogenous contribution only. The gray arrows indicate the effect of the state’s endogenous dynamics matrix, showing the direction and magnitude of evolution after a single time step. The blue cross indicates the state’s fixed point attractor; the star indicates the start of the trajectory. PC: principal component.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-102539-fig6-v1.tif"/></fig></sec><sec id="s2-2-2"><title>Exogenous contributions to state trajectories</title><p>Following the qualitative description above (<xref ref-type="fig" rid="fig6">Figure 6</xref>), we next quantified the contributions of external inputs in steering system trajectories. For each state, we determined the state’s centroid, namely, the centroid coordinate of all locations visited by the system during a specific state. Such geometrical location provided a reference position to investigate the input contributions. We considered the state centroid as a reference location because we sought to determine how the inputs steered trajectories relative to the ‘most typical’ position of a state.</p><p>We considered two scenarios. First, when the system was in state <inline-formula><alternatives><mml:math id="inf44"><mml:mi>i</mml:mi></mml:math><tex-math id="inft44">\begin{document}$i$\end{document}</tex-math></alternatives></inline-formula>, the input could drive the trajectory toward state <inline-formula><alternatives><mml:math id="inf45"><mml:mi>i</mml:mi></mml:math><tex-math id="inft45">\begin{document}$i$\end{document}</tex-math></alternatives></inline-formula>’s centroid or away from it (<xref ref-type="fig" rid="fig7">Figure 7A</xref>).</p><fig-group><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Effect of external inputs on steering state trajectories and driving state transitions.</title><p>(<bold>A</bold>) Left: Trajectory at <inline-formula><alternatives><mml:math id="inf46"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft46">\begin{document}$t-1$\end{document}</tex-math></alternatives></inline-formula> in state <inline-formula><alternatives><mml:math id="inf47"><mml:mi>i</mml:mi></mml:math><tex-math id="inft47">\begin{document}$i$\end{document}</tex-math></alternatives></inline-formula>. Inputs (colored arrows) could perturb the trajectory (translucent paths of the same color) by steering the evolution toward the state’s centroid (green) or away from it (pink). When the input directed it away from the state’s centroid, the input could push the system to switch into state <inline-formula><alternatives><mml:math id="inf48"><mml:mi>j</mml:mi></mml:math><tex-math id="inft48">\begin{document}$j$\end{document}</tex-math></alternatives></inline-formula> (red). Right: The input effect was measured via the cosine of the angle <inline-formula><alternatives><mml:math id="inf49"><mml:mi>ϕ</mml:mi></mml:math><tex-math id="inft49">\begin{document}$\phi$\end{document}</tex-math></alternatives></inline-formula> between the input vector and the line joining <inline-formula><alternatives><mml:math id="inf50"><mml:msub><mml:mi>X</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="inft50">\begin{document}$X_{t-1}$\end{document}</tex-math></alternatives></inline-formula> and state centroids. (<bold>B and C</bold>) Input effects with rows and columns representing states/state-transitions and input categories, respectively. Only states with significant association with inputs and only significant state transitions are shown (see <xref ref-type="fig" rid="fig2">Figure 2</xref>). Cells with significant effects are highlighted in blue (<inline-formula><alternatives><mml:math id="inf51"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft51">\begin{document}${\rm p} \lt 0.05$\end{document}</tex-math></alternatives></inline-formula>, corrected for multiple comparisons).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-102539-fig7-v1.tif"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 1.</label><caption><title>Effect of external inputs on steering state trajectories and driving state transitions: version with 10 stimulus categories.</title><p>(<bold>A and B</bold>) Input effects with rows and columns representing states/state-transitions and input categories, respectively. Only states with significant associations with inputs and only significant state transitions are shown. Cells with significant effects are highlighted in blue (<inline-formula><alternatives><mml:math id="inf52"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft52">\begin{document}${\rm p} \lt 0.05$\end{document}</tex-math></alternatives></inline-formula>, corrected for multiple comparisons).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-102539-fig7-figsupp1-v1.tif"/></fig><fig id="fig7s2" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 2.</label><caption><title>Effect of external inputs on steering state trajectories and driving state transitions: version with 30 stimulus categories.</title><p>(<bold>A and B</bold>) Input effects with rows and columns representing states/state-transitions and input categories, respectively. Only states with significant associations with inputs and only significant state transitions are shown. Cells with significant effects are highlighted in blue (<inline-formula><alternatives><mml:math id="inf53"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft53">\begin{document}${\rm p} \lt 0.05$\end{document}</tex-math></alternatives></inline-formula>, corrected for multiple comparisons).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-102539-fig7-figsupp2-v1.tif"/></fig></fig-group><p>The ‘effective contribution’ was determined by considering both direction and magnitude components (see Methods). We investigated the stimulus categories defined previously (<inline-formula><alternatives><mml:math id="inf54"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft54">\begin{document}$A_{1}-A_{10}$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf55"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft55">\begin{document}$R_{10}-R_1$\end{document}</tex-math></alternatives></inline-formula>). Consider <monospace>STATE 1</monospace> (post-shock), for example (<xref ref-type="fig" rid="fig7">Figure 7B</xref>). When the stimulus was <inline-formula><alternatives><mml:math id="inf56"><mml:msub><mml:mi>R</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="inft56">\begin{document}$R_{10}$\end{document}</tex-math></alternatives></inline-formula> or <inline-formula><alternatives><mml:math id="inf57"><mml:msub><mml:mi>R</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>9</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="inft57">\begin{document}$R_{9}$\end{document}</tex-math></alternatives></inline-formula>, those inputs tended to push the system in the direction of <monospace>STATE 1</monospace>’s centroid; when the stimulus was <inline-formula><alternatives><mml:math id="inf58"><mml:msub><mml:mi>R</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>8</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="inft58">\begin{document}$R_{8}$\end{document}</tex-math></alternatives></inline-formula>, the trajectory was pushed away from the centroid by the input but very weakly. In addition, for <monospace>STATE 2</monospace> (shock/peri-shock), we found that stimuli <inline-formula><alternatives><mml:math id="inf59"><mml:msub><mml:mi>A</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>8</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="inft59">\begin{document}$A_{8}$\end{document}</tex-math></alternatives></inline-formula> to <inline-formula><alternatives><mml:math id="inf60"><mml:msub><mml:mi>R</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="inft60">\begin{document}$R_{10}$\end{document}</tex-math></alternatives></inline-formula> pushed the system toward the centroid, but stimulus <inline-formula><alternatives><mml:math id="inf61"><mml:msub><mml:mi>R</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>9</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="inft61">\begin{document}$R_{9}$\end{document}</tex-math></alternatives></inline-formula> moved the trajectory away from it. Overall, <xref ref-type="fig" rid="fig7">Figure 7B</xref> displays how inputs steered state trajectories in the direction of the centroid (green cells) or away from it (purple cells). Note that in <xref ref-type="fig" rid="fig7">Figure 7B/C</xref>, we evaluated exogenous contributions only for stimuli associated with each state/state-transition reported in <xref ref-type="fig" rid="fig2">Figure 2A/B</xref> (see also Methods).</p><p>Next, we investigated how inputs contributed to state transitions by steering trajectories in the direction of a new state’s centroid (see Methods). Consider the <inline-formula><alternatives><mml:math id="inf62"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mtext mathvariant="monospace">STATE 2</mml:mtext></mml:mrow><mml:mo stretchy="false">↦</mml:mo><mml:mrow><mml:mtext mathvariant="monospace">STATE 1</mml:mtext></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft62">\begin{document}$\texttt{STATE 2}\mapsto\texttt{STATE 1}$\end{document}</tex-math></alternatives></inline-formula> transition (i.e. from shock to post-shock). Input perturbations <inline-formula><alternatives><mml:math id="inf63"><mml:msub><mml:mi>R</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="inft63">\begin{document}$R_{10}$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf64"><mml:msub><mml:mi>R</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>9</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="inft64">\begin{document}$R_{9}$\end{document}</tex-math></alternatives></inline-formula> provided the strongest push of the trajectory in the direction of <monospace>STATE 1</monospace>. In addition, when the system was in <monospace>STATE 3</monospace> (‘not near’), multiple inputs tended to direct the system’s evolution in the direction of <monospace>STATE 2</monospace> (‘shock/peri-shock’). Finally, when the system was in <monospace>STATE 4</monospace> (‘not close’) and the circles were approaching, inputs pushed the system in the direction of <monospace>STATE 5</monospace> (‘near miss’).</p><p>Taken together, the results show how external perturbations contributed to the evolution of state trajectories and state transitions.</p></sec></sec><sec id="s2-3"><title>Region importance and steering of dynamics</title><p>Based on time series data and input information, the SLDS approach identifies a set of states and their dynamics. While these states are determined in the latent space, they can be readily mapped back to the brain, allowing for the characterization of spatiotemporal properties across the entire brain. Since not all regions contribute equally to state properties, we propose that a region’s impact on state dynamics serves as a measure of its <italic>importance</italic>.</p><p>We illustrate the concept for <monospace>STATE 5</monospace> (‘near miss’) in <xref ref-type="fig" rid="fig8">Figure 8</xref> (see <xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1</xref> for all states). <xref ref-type="fig" rid="fig8">Figure 8A</xref> shows importance in the top row and activity below as a function of time from state entry. The dynamics of importance and activity can be further visualized (<xref ref-type="fig" rid="fig8">Figure 8B</xref>), where some regions of particularly high importance are illustrated together with the ventromedial PFC, a region that is typically not engaged during high-threat conditions. Notably, the importance of the dorsal anterior insula increased quickly in the first time points and later decreased. In contrast, the importance of the periaqueductal gray was relatively high from the beginning of the state and decreased moderately later.</p><fig-group><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Brain region importance.</title><p>(<bold>A</bold>) Importance measure and average BOLD signal for <monospace>STATE 5</monospace> from state onset (<inline-formula><alternatives><mml:math id="inf65"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><tex-math id="inft65">\begin{document}$t=0$\end{document}</tex-math></alternatives></inline-formula>) until the state’s average lifetime. (<bold>B</bold>) Average importance measure time series (left) and average BOLD signal for all regions of interest (ROIs) during the average lifetime of <monospace>STATE 5</monospace>. (<bold>C</bold>) Spearman’s rank correlation coefficient between average BOLD signal (across participants) and average importance measure (across participants) from state onset (<inline-formula><alternatives><mml:math id="inf66"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><tex-math id="inft66">\begin{document}$t=0$\end{document}</tex-math></alternatives></inline-formula>) until the average lifetime of <monospace>STATE 5</monospace>. PFC: prefrontal cortex.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-102539-fig8-v1.tif"/></fig><fig id="fig8s1" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 1.</label><caption><title>Importance measure of brain regions for all states.</title><p>Average importance time series (top row) and average BOLD signal for all regions of interest (ROIs) during the average lifetime of all states (<inline-formula><alternatives><mml:math id="inf67"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><tex-math id="inft67">\begin{document}$t=0$\end{document}</tex-math></alternatives></inline-formula> indicates onset time for each state). PFC: prefrontal cortex.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-102539-fig8-figsupp1-v1.tif"/></fig></fig-group><p><xref ref-type="fig" rid="fig8">Figure 8C</xref> depicts the correlation between these measures as a function of time. For all but <monospace>STATE 1</monospace>, the correlation increased over time. Interestingly, for <monospace>STATES 4–5</monospace>, the correlation was low at the first and second time points of the state (and for <monospace>STATE 2</monospace> at the first time point), and for <monospace>STATE 3</monospace> the measures were actually anticorrelated; both cases indicate a dissociation between activity and importance. In summary, our results illustrate that univariate region activity can differ from multivariate importance, providing a fruitful path to understand how individual brain regions contribute to collective dynamic properties.</p></sec><sec id="s2-4"><title>States explain threat processing in another threat-related experiment</title><p>If SLDS models capture spatiotemporal regularities associated with behavioral/brain states, determining states in a paradigm (such as the present moving circles paradigm) that shares important elements with a different experiment should be reflected when fitting the data of the latter. In other words, how well does a model estimated in one paradigm generalize to related experiments?</p><p>To test model generalizability, we applied the SLDS model estimated on the moving circles paradigm (call it MOV) to a separate experiment and dataset (call it ESC for ‘escape’) that investigated threat and safety processing. In the ESC experiment, participants manually controlled a rabbit icon using a joystick in a threat-avoidance task. The participant’s goal was to reach a safety area on the opposite end of the screen while avoiding a pursuing devil icon moving at varying speeds. If caught, participants received a mild but unpleasant electrical stimulus. Once a gate was successfully crossed, the participant entered a safe area (no shock was possible) where they remained for a few seconds (see <xref ref-type="fig" rid="fig9">Figure 9A</xref>). Overall, the paradigm induced anxious apprehension during the chase phase and relief during safety.</p><fig id="fig9" position="float"><label>Figure 9.</label><caption><title>Testing generalizability of the switching linear dynamical system (SLDS) model.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-102539-fig9-v1.tif"/></fig><p>Model parameters inferred from the <monospace>MOV</monospace> dataset were used to decode states in the <monospace>ESC</monospace> dataset. We evaluated the extent to which <monospace>MOV</monospace> states could explain fMRI time series data of the esc design. To do so, we focused on a 10-time-step-long temporal window anchored around the event of entering safety (from -6.25 s to 5.0 s, with <inline-formula><alternatives><mml:math id="inf69"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><tex-math id="inft69">\begin{document}$t=0$\end{document}</tex-math></alternatives></inline-formula>, indicating the time of entering safety; see Methods). We determined the probability of being in a given <monospace>MOV</monospace> state given the time step (<xref ref-type="fig" rid="fig9">Figure 9B</xref>). The results indicated that <monospace>STATE 5</monospace> (‘near miss’ in <monospace>MOV</monospace>) was expressed during the chase period; <monospace>STATE 3</monospace> (‘not near’ in <monospace>MOV</monospace>) was detected from <inline-formula><alternatives><mml:math id="inf70"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><tex-math id="inft70">\begin{document}$t=0$\end{document}</tex-math></alternatives></inline-formula> s to the end of the temporal window. We also evaluated whether the system switched from <monospace>STATE 5</monospace> to <monospace>STATE 3</monospace> around <inline-formula><alternatives><mml:math id="inf71"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><tex-math id="inft71">\begin{document}$t=0$\end{document}</tex-math></alternatives></inline-formula> s by determining the probability of observing the transition <inline-formula><alternatives><mml:math id="inf72"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mtext mathvariant="monospace">STATE 5</mml:mtext></mml:mrow><mml:mo stretchy="false">↦</mml:mo><mml:mrow><mml:mtext mathvariant="monospace">STATE 3</mml:mtext></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft72">\begin{document}$\texttt{STATE 5}\mapsto\texttt{STATE 3}$\end{document}</tex-math></alternatives></inline-formula> as a function of time point (<xref ref-type="fig" rid="fig9">Figure 9C</xref>; see Methods).</p><p>In the <monospace>MOV</monospace> paradigm, STATE 5 was associated with a state of apprehension likely experienced by participants during near-miss events. This is consistent with the finding that <monospace>STATE 5</monospace> was detected during the chase phase of the ESC paradigm. <monospace>STATE 3</monospace> (‘not near’ in <monospace>MOV</monospace>) occurred during the safety period (in <monospace>ESC</monospace>) and the transition from <inline-formula><alternatives><mml:math id="inf73"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mtext mathvariant="monospace">STATE 5</mml:mtext></mml:mrow><mml:mo stretchy="false">↦</mml:mo><mml:mrow><mml:mtext mathvariant="monospace">STATE 3</mml:mtext></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft73">\begin{document}$\texttt{STATE 5}\mapsto\texttt{STATE 3}$\end{document}</tex-math></alternatives></inline-formula> at <inline-formula><alternatives><mml:math id="inf74"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><tex-math id="inft74">\begin{document}$t=0$\end{document}</tex-math></alternatives></inline-formula>. These findings indicate that the model trained on MOV was able to generalize in meaningful ways to the new paradigm.</p><p>To facilitate interpretation, no hemodynamic shifts were used in displaying the results shown in <xref ref-type="fig" rid="fig9">Figure 9</xref>. Our choice was motivated by the fact that the ESC paradigm contained a discrete event at <inline-formula><alternatives><mml:math id="inf75"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><tex-math id="inft75">\begin{document}$t=0$\end{document}</tex-math></alternatives></inline-formula>, namely, the transition into safety. However, one concern is that <monospace>STATE 3</monospace> was already detected at safety onset, whereas safety-related processing triggered at <inline-formula><alternatives><mml:math id="inf76"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><tex-math id="inft76">\begin{document}$t=0$\end{document}</tex-math></alternatives></inline-formula> should be expressed in fMRI responses with some lag given that any responses triggered at <inline-formula><alternatives><mml:math id="inf77"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><tex-math id="inft77">\begin{document}$t=0$\end{document}</tex-math></alternatives></inline-formula> should translate to fMRI responses with a lag of around 2 s and peak around 4–6 s post event (<xref ref-type="bibr" rid="bib7">Boynton et al., 1996</xref>). Further analysis, however, helped explain the observed results, as outlined next. Average fMRI responses during the analyzed time window revealed a consistent response pattern across multiple brain regions sensitive to sustained threat in prior studies in the literature (<xref ref-type="bibr" rid="bib43">Mobbs et al., 2009</xref>; <xref ref-type="bibr" rid="bib10">Davis et al., 2010</xref>; <xref ref-type="bibr" rid="bib48">Murty et al., 2023</xref>), as illustrated for the region of interest of the bed nucleus of the stria terminalis (BST; <xref ref-type="fig" rid="fig9">Figure 9D</xref>), a very important brain region involved in sustained threat processing (<xref ref-type="bibr" rid="bib10">Davis et al., 2010</xref>). As shown, the BST response started decreasing before the end of the chase period, not at the end, suggesting that apprehension levels during the chase period decreased before the end of the chase period. To gain further insight concerning the response pattern of sustained-threat processing regions, we investigated the movement pattern of the chasing devil, which revealed a potential problem with the original experimental design. We programmed the chasing speed of the devil icon to be variable, but consistent across trials. In doing so, there was a consistent icon deceleration around the halfway point of the chase, which unintentionally made the final phase of the chase less apprehension-inducing. In all, we believe the expression of <monospace>STATE 3</monospace> (‘not near’ in MOV) right at entry into the safety area, as well as the transition from <inline-formula><alternatives><mml:math id="inf78"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mtext mathvariant="monospace">STATE 5</mml:mtext></mml:mrow><mml:mo stretchy="false">↦</mml:mo><mml:mrow><mml:mtext mathvariant="monospace">STATE 3</mml:mtext></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft78">\begin{document}$\texttt{STATE 5}\mapsto\texttt{STATE 3}$\end{document}</tex-math></alternatives></inline-formula>, is actually consistent with a mental state of relative safety, as also reflected in the activation pattern in the BST (and other brain regions).</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>In the present paper, we applied SLDSs to uncover the dynamics of threat processing during a continuous threat-of-shock paradigm. First, we demonstrated that the SLDS model learned the regularities of the experimental paradigm, such that states and state transitions estimated from fMRI time series data from 85 ROIs reflected both the proximity of the circles and their direction (approach vs. retreat). After establishing that the model captured key properties of threat-related processing, we characterized the dynamics of the states and their transitions. The results revealed that the understanding of threat processing is enhanced by viewing it in terms of dynamic multivariate patterns whose trajectories are a combination of intrinsic and extrinsic factors that jointly determine how the brain temporally evolves during dynamic threat.</p><p>Past work has employed state-space models such as HMMs to estimate states from brain signals in an unsupervised fashion. Previous fMRI studies detected states with blocked design (<xref ref-type="bibr" rid="bib71">Vidaurre et al., 2018</xref>; <xref ref-type="bibr" rid="bib75">Yamashita et al., 2021</xref>), where brain states are expected to align closely with the experimental structure. In continuous experimental paradigms, establishing brain states that meaningfully track experimental variables is considerably more challenging. In fact, in some studies employing HMMs with more unconstrained or naturalistic experiments, states were not explicitly mapped to stimulus events (<xref ref-type="bibr" rid="bib69">van de Meer et al., 2020</xref>; <xref ref-type="bibr" rid="bib60">Song et al., 2021</xref>; <xref ref-type="bibr" rid="bib61">Song et al., 2023</xref>). A recent interesting study applied HMMs to cell recordings in the rat PFC and found states that correlated with hide-and-seek behaviors, as well as states corresponding to previously undetected behaviors (<xref ref-type="bibr" rid="bib4">Bagi et al., 2022</xref>). In general, although HMM models applied to brain data have shown to be a promising strategy to uncover unlabeled states, further work is needed to assess their performance in continuous paradigms in a manner that rigorously establishes the correspondence between states and external stimuli and/or behavior.</p><p>Critically, standard HMMs provide limited information about state dynamics, which is essential in understanding temporally unfolding brain processes supporting complex mental states and behaviors, such as the varying levels of threat and safety studied here. To address this gap, we applied the SLDS framework to our continuous threat-of-shock paradigm. There have been a few applications of SLDS models to brain data (<xref ref-type="bibr" rid="bib50">Petreska et al., 2011</xref>; <xref ref-type="bibr" rid="bib36">Linderman et al., 2019</xref>; <xref ref-type="bibr" rid="bib20">Glaser et al., 2020</xref>), but as far as we know, only one fMRI study investigating a blocked working memory task (<xref ref-type="bibr" rid="bib64">Taghia et al., 2018</xref>). As one of the challenges with unsupervised state-space methods is that there is no ground truth concerning the states, here, we first established that the model estimated states and transitions that captured the structure of the continuous paradigm, namely, circle proximity, shock events, and post-shock period. Of the six states detected by the model, five captured properties of the stimulus in a statistically significant manner. For example, the probability of being in <monospace>STATE 2</monospace> given that the circles collided (input: <inline-formula><alternatives><mml:math id="inf79"><mml:msub><mml:mi>A</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="inft79">\begin{document}$A_{10}$\end{document}</tex-math></alternatives></inline-formula>) was 0.63, consistent with a state indicative of a ‘shock/peri-shock’ period. State transitions were also associated with specific stimuli. More generally, the states captured the structure of the paradigm, which consisted of periods of increased and decreased threat given the proximity of the circles and the unpleasant shock delivered upon collision.</p><p>Further evidence that the states captured important features of threat-related processing was obtained by determining voxelwise brain maps for both individual states and state contrasts. For example, the contrast of <monospace>STATE 5</monospace> (‘near miss’) vs. <monospace>STATE 4</monospace> (‘not close’) revealed a pattern of activation very similar to that obtained in the literature for the contrast of higher vs. lower levels of threat (<xref ref-type="bibr" rid="bib43">Mobbs et al., 2009</xref>; <xref ref-type="bibr" rid="bib44">Mobbs et al., 2010</xref>; <xref ref-type="bibr" rid="bib2">Alvarez et al., 2011</xref>; <xref ref-type="bibr" rid="bib24">Grupe and Nitschke, 2013</xref>; <xref ref-type="bibr" rid="bib59">Somerville et al., 2013</xref>; <xref ref-type="bibr" rid="bib39">Meyer et al., 2019</xref>; <xref ref-type="bibr" rid="bib27">Hur et al., 2020</xref>; <xref ref-type="bibr" rid="bib47">Murty et al., 2022</xref>; <xref ref-type="bibr" rid="bib48">Murty et al., 2023</xref>). In particular, the contrast identified sectors of ventromedial PFC and posterior cingulate that have been linked to relative safety (<xref ref-type="bibr" rid="bib55">Schiller et al., 2008</xref>; <xref ref-type="bibr" rid="bib59">Somerville et al., 2013</xref>; <xref ref-type="bibr" rid="bib24">Grupe and Nitschke, 2013</xref>). In addition, state transitions reflected notable changes in activity levels, such as the transition of the lower-threat <monospace>STATE 4</monospace> to the higher-threat <monospace>STATE 5</monospace>. Taken together, our analyses demonstrated that the model captured key properties of the continuous paradigm, building on previous studies using HMMs (<xref ref-type="bibr" rid="bib71">Vidaurre et al., 2018</xref>; <xref ref-type="bibr" rid="bib69">van de Meer et al., 2020</xref>; <xref ref-type="bibr" rid="bib61">Song et al., 2023</xref>; <xref ref-type="bibr" rid="bib5">Baldassano et al., 2017</xref>; <xref ref-type="bibr" rid="bib72">Williams et al., 2022</xref>).</p><p>Our central goal was to discover and characterize the dynamics of continuous threat-related processing. From the perspective developed here, brain regions jointly participate in state-specific trajectories. An important property of the SLDS framework is that it estimates state dynamics based on separate and additive endogenous and exogenous contributions. Determining the intrinsic dynamics is particularly informative because it uncovers how a brain state would evolve in the absence of additional inputs. In particular, does the state trajectory tend toward a fixed attractor, or does it evolve in some other more complex manner? Based on the properties of the endogenous state dynamics matrix, we determined that indeed all states behaved as attractors. But what do these attractors represent in terms of brain activity? To visualize the corresponding patterns, we determined ‘attractor maps’ by projecting the model attractor (determined in the latent space) onto the brain space (time series data from ROIs). The attractor maps captured essential properties of the states determined by the model. For example, <monospace>STATE 1</monospace> and <monospace>STATE 2</monospace> maps exhibited inverse activity patterns, consistent with the fact that they largely reflected the post-shock and the shock/peri-shock periods, respectively. In addition, comparison of <monospace>STATE 5</monospace> (‘near miss’) and <monospace>STATE 4</monospace> (‘not near’) shows how distributed patterns with shared dynamics are involved in mental states of higher and lower anxious apprehension.</p><p>The endogenous dynamics can be further understood as providing a flow field that channels the temporal evolution of the system in the absence of inputs. However, in our continuous threat-of-shock paradigm, state trajectories were also determined by the inputs acting at each time step. Thus, visualizing the trajectory in terms of vector fields uncovered both contributions to system behavior. In combination with the information obtained from attractor maps, these results provide novel ways to understand the roles of key brain regions involved in threat-related processing. In addition to the qualitative information provided by vector field trajectories, we quantified the input contributions to states and state transitions. We determined how inputs contributed to trajectories in a state’s subspace and to transitions between states. For example, when the system was in <monospace>STATE 2</monospace> (shock/peri-shock), the input perturbation <inline-formula><alternatives><mml:math id="inf80"><mml:msub><mml:mi>R</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="inft80">\begin{document}$R_{10}$\end{document}</tex-math></alternatives></inline-formula> steered the system in the direction of <monospace>STATE 1</monospace> most vigorously, showing that soon after the circles collided, the brain tended to readily transition to a state of decreased activity in the insula and medial PFC. Overall, the analysis revealed how inputs steered a state’s trajectory toward or away from the state’s centroid, as well as how inputs directed a trajectory’s evolution in the direction of a new state.</p><p>Work on dynamics of neural circuits in systems neuroscience at times assumes that the target circuit is driven only by endogenous processes (<xref ref-type="bibr" rid="bib29">Khona and Fiete, 2022</xref>). In other words, the external inputs do not vary significantly over time and therefore do not perturb state trajectories. While such a scenario may be adequate in some experimental paradigms, the assumption is problematic in cases where inputs vary continuously. In the present study, we did not assume that the brain was isolated from the environment. Instead, by parsing the dynamics in terms of endogenous and exogenous contributions, we were able to not only study intrinsic state attractors but also to characterize external inputs as perturbations that drove trajectories along meaningful directions, such as pulling or pushing inputs toward or away from state centroids. Additionally, we also identified input stimuli that effectively steered evolution in the direction of other state subspaces. We propose that our approach can be profitably employed in studying neuronal circuit dynamics in systems neuroscience more broadly.</p><p>In the Introduction, we motivated our study in terms of determining multivariate and distributed patterns of activity with shared dynamics. At one end of the spectrum, it is possible to conceptualize the whole brain as dynamically evolving during a state; at the other end, we could focus on just a few ‘key’ regions or possibly a single one (at which point the description would be univariate). Here, we addressed this gap by studying the importance of regions to state dynamics: To what extent does a region steer the trajectory of the system? From a mathematical standpoint, our proposed measure is not merely a function of activity of a region but also of the coefficients of the dynamics matrix capturing its effect on across-region dynamics (<xref ref-type="bibr" rid="bib13">Eichler, 2005</xref>; <xref ref-type="bibr" rid="bib58">Smith et al., 2010</xref>).</p><p>How distributed should the dynamics of threat be considered? One answer to this question is to consider the distribution of importance values for all states. For <monospace>STATE 1</monospace> (‘post-shock’), a few regions displayed the highest importance values for a few time points. However, for the other states, the distribution of importance values tended to be more uniform at each time point. Thus, based on our proposed importance measure, we conclude that threat-related processing is profitably viewed as substantially distributed. Furthermore, we found that while activity and importance were relatively correlated, they could also diverge substantially. Together, we believe that the proposed importance measure provides a valuable tool for understanding the rich dynamics of threat processing. For example, we discovered that the dorsal anterior insula is important not only during high-anxiety states (such as <monospace>STATE 5</monospace>; ‘near miss’) but also, surprisingly, for a state that followed the aversive shock event (<monospace>STATE 1</monospace>; ‘post-shock’). Additionally, we noted that posterior cingulate cortex, widely known to play a central role in the default mode network, had the highest importance among all other regions in driving dynamics of low-anxiety states (such as <monospace>STATE 3</monospace> and <monospace>STATE 4</monospace>; ‘not near’).</p><p>We believe the generalizability results presented in this study offer a valuable contribution to the ongoing discussion about the applicability of naturalistic paradigms in neuroscience. As highlighted in the Introduction, there is a growing interest in using more dynamic and ecologically valid experimental designs to advance our understanding of brain function. The successful application of the SLDS model, trained on the moving circles paradigm, to the separate escape experiment illustrates the potential of this approach to capture neural dynamics that generalize across related but distinct threat-processing tasks. This finding addresses a key challenge in naturalistic neuroscience: establishing that models derived from one paradigm can meaningfully explain brain activity in another. By showing that states identified in one threat-related task could be meaningfully mapped onto brain activity during a different threat-avoidance scenario, this study provides initial evidence that the SLDS framework can extract robust, task-general representations of threat processing, rather than idiosyncratic features of a particular experimental paradigm. Such cross-paradigm validity (see also <xref ref-type="bibr" rid="bib61">Song et al., 2023</xref>) will be crucial for building a more comprehensive and ecologically relevant understanding of how the brain processes and responds to dynamic threats in real-world scenarios.</p><p>Here, we also discuss some challenges and potential shortcomings of our study. The application of state-space models, including SLDSs, to hemodynamic data is challenging because of the low-pass nature of the response. Specifically, the response to a brief event builds up to a peak around 4–6 s post onset and decays slowly over the next 4–8 s (<xref ref-type="bibr" rid="bib7">Boynton et al., 1996</xref>). In the current study, we assumed a constant hemodynamic lag of approximately 5 s. Although our paradigm involved continuous movement of the circles, both shock events and transitions from approach to retreat (and vice versa) were discrete in nature. These events call for careful interpretation of the results given the potential for blending of hemodynamic responses. However, our experiment was designed such that most periods of circle approach and retreat lasted for 6–9 s so as to minimize consecutive approach/retreat transitions (<xref ref-type="bibr" rid="bib34">Limbachia et al., 2021</xref>). Thus, the concern about the slow nature of the hemodynamic response was somewhat alleviated in the present context. In general, future studies are needed to develop SLDS approaches that can explicitly consider the properties of the hemodynamic response. Another limitation of the framework developed here is that we assumed, as in all state-model applications, that the underlying system is well approximated by a series of states. With SLDS models, this is less severe an assumption because one can consider the (possibly nonlinear) behavior of a system as modeled by a series of linear dynamical systems that approximate the overall behavior. Nevertheless, it will be valuable to investigate other approaches that address this concern, including considering that multiple states can coexist at a time (<xref ref-type="bibr" rid="bib23">Greene et al., 2023</xref>). A further issue that we wish to discuss is related to the distinction between intrinsic and extrinsic dynamics, which is explicitly modeled in our SLDS approach (see Methods, <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>). We believe this is a powerful approach because in experimental designs with experimenter-manipulated inputs, one can profitably investigate both types of contribution to dynamics. However, complete separation between intrinsic and extrinsic dynamics is challenging to ascertain. More generally, one can gain confidence in their separation through controlled experiments where external inputs are manipulated, or by demonstrating time-scale separation of intrinsic and extrinsic dynamics.</p><p>In the present paper, we applied SLDSs to uncover the dynamics of threat processing during a continuous threat-of-shock paradigm. First, we demonstrated that the model learned the regularities of the experimental paradigm, such that states and state transitions estimated from fMRI time series data from 85 ROIs reflected both the proximity of the circles and their direction (approach vs. retreat). After establishing that the model captured key properties of threat-related processing, we characterized the dynamics of the states and their transitions. The results revealed that threat processing can profitably be viewed in terms of dynamic multivariate patterns whose trajectories are a combination of intrinsic and extrinsic factors that jointly determine how the brain temporally evolves during dynamic threat. We propose that viewing threat processing through the lens of dynamical systems offers important avenues to uncover properties of the dynamics of threat that are not uncovered with standard experimental designs and analyses.</p></sec><sec id="s4" sec-type="methods"><title>Methods</title><sec id="s4-1"><title>Moving circles dataset</title><sec id="s4-1-1"><title>Participants</title><p>One hundred and twenty-six participants (63 females, ages 18–30 years; average: 20.87, STD: 2.56) with normal or corrected-to-normal vision and no reported neurological or psychiatric disease were recruited from the University of Maryland community. The project was approved by the University of Maryland College Park Institutional Review Board and all participants provided written informed consent before participation. Data from four participants were not used due to technical issues. For the original publication of these data, see <xref ref-type="bibr" rid="bib34">Limbachia et al., 2021</xref>.</p><p>Out of the 122 participants, we used 30 to perform preliminary testing of the framework and defining model hyperparameters, including the number of states and the dimensionality of the latent space (see following subsections and Appendix 1). In order to avoid circularity in our analyses, data from this exploratory set were not used further. Thus, all results reported here are based on the held-out set of 92 participants.</p></sec><sec id="s4-1-2"><title>Procedure and stimuli</title><p>The experiment was designed to study the role of proximity on threat-of-shock processing. Participants watched two circles of different colors on the screen, at times moving close to each other, at times moving apart in a smooth but unpredictable fashion. Upon circle collision, the participants received a mild but unpleasant electrical stimulation together with an aversive sound. The movement of the circles was defined such that there were segments of approach and retreat that lasted between 2 and 9 s, with most segments lasting more than 6 s. To enhance unpredictability and hence anxious apprehension by participants, the movement of the circles included multiple instances of ‘near misses’ in which the circles nearly touched (distance as close as 1.5 circle diameters between circle centers) before retreating away.</p><p>The experiment consisted of six 8 min runs, each having two 3 min blocks, during which the circles moved. The participants experienced, on average, 4 circle collisions and 7 near misses per run. All runs used different motion paths, but the visual stimulus was fixed across participants. Finally, visual stimuli were presented using PsychoPy (<ext-link ext-link-type="uri" xlink:href="http://www.psychopy.org/">http://www.psychopy.org/</ext-link>) and viewed on a projection screen via a mirror mounted to the scanner’s head coil. For further details about the experiment, the reader may refer to <xref ref-type="bibr" rid="bib39">Meyer et al., 2019</xref>; <xref ref-type="bibr" rid="bib34">Limbachia et al., 2021</xref>.</p></sec></sec><sec id="s4-2"><title>Escape dataset</title><sec id="s4-2-1"><title>Participants</title><p>A total of 57 subjects (24 females, ages 18–54; average: 20.5, STD: 1.9) were recruited from the University of Maryland, College Park, community. All subjects had normal or corrected-to-normal vision and reported no neurological disease or current use of psychoactive drugs. They provided written informed consent before participating in the study and were paid immediately after the experiment. The study was approved by the University of Maryland, College Park, Institutional Review Board.</p></sec><sec id="s4-2-2"><title>Procedure and stimuli</title><p>The experiment sought to study threat processing in the presence of ‘imminent danger’ followed by a period of safety. A total of eight 512-s-long runs were employed, each having 13.8±1.6 trials. Each trial began with a chase period that was followed by a safety period if the participant avoided being caught. Participants controlled a rabbit icon (‘player’), which they could move on the screen at constant speed using a joystick. The player started at the left-hand side of the screen and their objective was to reach a safety area located at the right end of the screen while avoiding a devil icon that pursued the player at time-varying speeds. Participants received an unpleasant but not painful electrical stimulation if the devil caught the player before the player entered the safety region. If the player successfully entered the safety area, this period lasted 6–10 s.</p></sec></sec><sec id="s4-3"><title>Regions of interest</title><p>Time series data used for both datasets consisted of fMRI time series from 85 cortical and subcortical ROIs (defined as the average across voxels for each ROI). The ROIs were defined in a prior study by our group and intended to capture brain regions involved in threat-related processing (<xref ref-type="bibr" rid="bib47">Murty et al., 2022</xref>).</p></sec><sec id="s4-4"><title>Switching linear dynamical systems</title><p>SLDSs are an example of a latent-variable framework that expresses the dynamics of observed signals using a set of unobserved variables assumed to govern system dynamics. The latent space is typically of considerably smaller dimension relative to the original data space (here 10 and 85, respectively). SLDSs consist of one linear dynamical system model per state, such that the trajectory of the system is governed by a single dynamical system at each time step. Switching between states is assumed to follow a Markov process. Overall, SLDS models provide a piecewise linear approximation of (potentially nonlinear) dynamics.</p><p>Consider activity <inline-formula><alternatives><mml:math id="inf81"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft81">\begin{document}$Y_{t}\in\mathbb{R}^{N},t=1,2,\dots,T$\end{document}</tex-math></alternatives></inline-formula> (<inline-formula><alternatives><mml:math id="inf82"><mml:mi>T</mml:mi></mml:math><tex-math id="inft82">\begin{document}$T$\end{document}</tex-math></alternatives></inline-formula> time steps is the duration of a typical run) from <inline-formula><alternatives><mml:math id="inf83"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>85</mml:mn></mml:math><tex-math id="inft83">\begin{document}$N=85$\end{document}</tex-math></alternatives></inline-formula> brain ROIs during an experiment described using <inline-formula><alternatives><mml:math id="inf84"><mml:mi>M</mml:mi></mml:math><tex-math id="inft84">\begin{document}$M$\end{document}</tex-math></alternatives></inline-formula> input variables <inline-formula><alternatives><mml:math id="inf85"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft85">\begin{document}$U_{t}\in\mathbb{R}^{M},t=1,2,\dots,T$\end{document}</tex-math></alternatives></inline-formula>. The model represents brain signals <inline-formula><alternatives><mml:math id="inf86"><mml:msub><mml:mi>Y</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft86">\begin{document}$Y_{t}$\end{document}</tex-math></alternatives></inline-formula> in a low-dimensional subspace as a set of <inline-formula><alternatives><mml:math id="inf87"><mml:mi>D</mml:mi></mml:math><tex-math id="inft87">\begin{document}$D$\end{document}</tex-math></alternatives></inline-formula> latent variables <inline-formula><alternatives><mml:math id="inf88"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft88">\begin{document}$X_{t}\in\mathbb{R}^{D},t=1,2,\dots,T$\end{document}</tex-math></alternatives></inline-formula> (<inline-formula><alternatives><mml:math id="inf89"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>D</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>N</mml:mi></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft89">\begin{document}$D \lt N$\end{document}</tex-math></alternatives></inline-formula>). Observed BOLD activity is related to the latent variables using a linear transformation, such that<disp-formula id="equ1"><label>(1)</label><alternatives><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mrow><mml:mi class="mathcal" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t1">\begin{document}$$\displaystyle  \left(Y_{t}|X_{t}\right) \sim \mathcal{N}\left(CX_{t}+d,\Sigma^{v}\right),$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <inline-formula><alternatives><mml:math id="inf90"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>C</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft90">\begin{document}$C\in\mathbb{R}^{N\times D}$\end{document}</tex-math></alternatives></inline-formula> is the observation matrix, <inline-formula><alternatives><mml:math id="inf91"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>d</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft91">\begin{document}$d\in\mathbb{R}^{N}$\end{document}</tex-math></alternatives></inline-formula> is a bias term, <inline-formula><alternatives><mml:math id="inf92"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft92">\begin{document}$\Sigma^{v}\in\mathbb{R}^{N\times N}$\end{document}</tex-math></alternatives></inline-formula> is a noise covariance matrix, and <inline-formula><alternatives><mml:math id="inf93"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mi class="mathcal" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft93">\begin{document}$\mathcal{N}\left(\mu,\Sigma\right)$\end{document}</tex-math></alternatives></inline-formula> is a multivariate Gaussian distribution with mean <italic>μ</italic> and covariance <inline-formula><alternatives><mml:math id="inf94"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math><tex-math id="inft94">\begin{document}$\Sigma$\end{document}</tex-math></alternatives></inline-formula>. The expression above is called the observation step.</p><p>Latent trajectory dynamics is modeled using a set of <inline-formula><alternatives><mml:math id="inf95"><mml:mi>K</mml:mi></mml:math><tex-math id="inft95">\begin{document}$K$\end{document}</tex-math></alternatives></inline-formula> linear dynamical systems that are indexed by a time-varying switching variable <inline-formula><alternatives><mml:math id="inf96"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft96">\begin{document}$Z_{t}\in\{1,2,\dots,K\}$\end{document}</tex-math></alternatives></inline-formula>, which we call the state. At each time step <inline-formula><alternatives><mml:math id="inf97"><mml:mi>t</mml:mi></mml:math><tex-math id="inft97">\begin{document}$t$\end{document}</tex-math></alternatives></inline-formula>, only the linear dynamical system corresponding to the state <inline-formula><alternatives><mml:math id="inf98"><mml:msub><mml:mi>Z</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft98">\begin{document}$Z_{t}$\end{document}</tex-math></alternatives></inline-formula> drives the temporal evolution of system, such that<disp-formula id="equ2"><label>(2)</label><alternatives><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mrow><mml:mi class="mathcal" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t2">\begin{document}$$\displaystyle  \left(X_{t}|X_{t-1},Z_{t},U_{t}\right)\sim\mathcal{N}\left(A_{Z_t}X_{t-1}+V_{Z_t}U_{t}+b_{Z_t},\Sigma^{h}_{Z_t}\right),$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <inline-formula><alternatives><mml:math id="inf99"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>×</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft99">\begin{document}$A_{Z_{t}}\in\mathbb{R}^{D\times D}$\end{document}</tex-math></alternatives></inline-formula> is the linear dynamics matrix, <inline-formula><alternatives><mml:math id="inf100"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft100">\begin{document}$V_{Z_{t}}\in\mathbb{R}^{D\times M}$\end{document}</tex-math></alternatives></inline-formula> is the input matrix reflecting the experimental paradigm variables, <inline-formula><alternatives><mml:math id="inf101"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft101">\begin{document}$b_{Z_{t}}\in\mathbb{R}^{D}$\end{document}</tex-math></alternatives></inline-formula> is a bias term, and <inline-formula><alternatives><mml:math id="inf102"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>×</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft102">\begin{document}$\Sigma^{h}_{z_{t}}\in\mathbb{R}^{D\times D}$\end{document}</tex-math></alternatives></inline-formula> is a noise covariance matrix. The expression above is called the dynamics step.</p><p>State transition follows a modification of the Markov property, where the probability of switching to state <inline-formula><alternatives><mml:math id="inf103"><mml:msub><mml:mi>Z</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft103">\begin{document}$Z_{t}$\end{document}</tex-math></alternatives></inline-formula> from the previous state <inline-formula><alternatives><mml:math id="inf104"><mml:msub><mml:mi>Z</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="inft104">\begin{document}$Z_{t-1}$\end{document}</tex-math></alternatives></inline-formula> depends on the previous values of the state <inline-formula><alternatives><mml:math id="inf105"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft105">\begin{document}$Z_{t-1}$\end{document}</tex-math></alternatives></inline-formula> and the latent variables at <inline-formula><alternatives><mml:math id="inf106"><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:math><tex-math id="inft106">\begin{document}$t-1$\end{document}</tex-math></alternatives></inline-formula>, <inline-formula><alternatives><mml:math id="inf107"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft107">\begin{document}$X_{t-1}$\end{document}</tex-math></alternatives></inline-formula>:<disp-formula id="equ3"><label>(3)</label><alternatives><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo fence="false" stretchy="false">|</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">⊤</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t3">\begin{document}$$\displaystyle  P\left(Z_{t}=j \vert Z_{t-1}=i,X_{t-1}\right) \propto \text{exp}\left(\text{log}(Q_{ij})+r_{j}^{\top} X_{t-1}\right),$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <inline-formula><alternatives><mml:math id="inf108"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft108">\begin{document}${r_{j}}\in\mathbb{R}^{D}$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf109"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>Q</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft109">\begin{document}$Q\in R^{K\times K}$\end{document}</tex-math></alternatives></inline-formula> is the Markovian transition matrix, whose <italic>i</italic>th row and <italic>j</italic>th column element indicates the transition probability from state <inline-formula><alternatives><mml:math id="inf110"><mml:mi>i</mml:mi></mml:math><tex-math id="inft110">\begin{document}$i$\end{document}</tex-math></alternatives></inline-formula> to state <inline-formula><alternatives><mml:math id="inf111"><mml:mi>j</mml:mi></mml:math><tex-math id="inft111">\begin{document}$j$\end{document}</tex-math></alternatives></inline-formula>. This expression above is called the state switching step. <inline-formula><alternatives><mml:math id="inf112"><mml:msub><mml:mi>r</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft112">\begin{document}$r_{j}$\end{document}</tex-math></alternatives></inline-formula> is a weight vector (indexed by the state label, <inline-formula><alternatives><mml:math id="inf113"><mml:mi>j</mml:mi></mml:math><tex-math id="inft113">\begin{document}$j$\end{document}</tex-math></alternatives></inline-formula>) that specifies the additional dependency of <inline-formula><alternatives><mml:math id="inf114"><mml:msub><mml:mi>Z</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft114">\begin{document}$Z_{t}$\end{document}</tex-math></alternatives></inline-formula> on <inline-formula><alternatives><mml:math id="inf115"><mml:msub><mml:mi>X</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="inft115">\begin{document}$X_{t-1}$\end{document}</tex-math></alternatives></inline-formula> (on top of the Markov dependence of <inline-formula><alternatives><mml:math id="inf116"><mml:msub><mml:mi>Z</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="inft116">\begin{document}$Z_{t-1}$\end{document}</tex-math></alternatives></inline-formula> on <inline-formula><alternatives><mml:math id="inf117"><mml:msub><mml:mi>Z</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft117">\begin{document}$Z_{t}$\end{document}</tex-math></alternatives></inline-formula>), allowing state transitions based on the location of the trajectory in the latent space. SLDS with the above additional dependency is also known as recurrent SLDS (<xref ref-type="bibr" rid="bib35">Linderman et al., 2016</xref>) and is shown to be more suitable to explain realistic time series than SLDSs without the recurrent dependencies (<xref ref-type="bibr" rid="bib36">Linderman et al., 2019</xref>). Note that, on removing <inline-formula><alternatives><mml:math id="inf118"><mml:msub><mml:mi>r</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft118">\begin{document}$r_{j}$\end{document}</tex-math></alternatives></inline-formula> from the above equation, the state transition probability is the same as that of a Markov model.</p><p>A group-level SLDS model was estimated based on the data of 92 participants that participated in the moving circles experiment by using a variational Laplace Expectation-Maximization algorithm (<xref ref-type="bibr" rid="bib35">Linderman et al., 2016</xref>). Specifically, all of the following were estimated: <inline-formula><alternatives><mml:math id="inf119"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft119">\begin{document}$C,d,\Sigma^{v},\{A_{k},V_{k},b_{k},\Sigma^{h}_{k}\}_{k=1}^{K},Q,r$\end{document}</tex-math></alternatives></inline-formula>. In this manner, we obtained model variables <inline-formula><alternatives><mml:math id="inf120"><mml:msub><mml:mi>X</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft120">\begin{document}$X_{t}$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf121"><mml:msub><mml:mi>Z</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft121">\begin{document}$Z_{t}$\end{document}</tex-math></alternatives></inline-formula>. We employed the SLDS implementation provided in the ssm Python library (<ext-link ext-link-type="uri" xlink:href="https://github.com/lindermanlab/ssm">https://github.com/lindermanlab/ssm</ext-link>, copy archived at <xref ref-type="bibr" rid="bib37">Linderman et al., 2025</xref>).</p></sec><sec id="s4-5"><title>Modeling experimental stimuli as SLDS inputs</title><p>To encode the experimental paradigm, we categorized the stimuli based on the proximity and direction of motion of the moving circles. The instantaneous proximity was calculated as the normalized Euclidean distance between the circles, ranging from 0 (farthest) to 1 (touching). Direction was calculated based on the discrete difference of proximity: +1 (approach) or –1 (retreat). Proximity values were quantized into 10 equal-sized bins <inline-formula><alternatives><mml:math id="inf122"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0.0</mml:mn><mml:mo>,</mml:mo><mml:mn>0.1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:mn>0.2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0.9</mml:mn><mml:mo>,</mml:mo><mml:mn>1.0</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft122">\begin{document}$\left([0.0,0.1),[0.1,0.2),\cdots, [0.9,1.0]\right) $\end{document}</tex-math></alternatives></inline-formula>, one per binning per direction, resulting in 20 stimulus categories: <inline-formula><alternatives><mml:math id="inf123"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft123">\begin{document}$A_{1}, A_{2}, \cdots, A_{10}$\end{document}</tex-math></alternatives></inline-formula> for approach; <inline-formula><alternatives><mml:math id="inf124"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft124">\begin{document}$R_{1}, R_{2}, \cdots,R_{10}$\end{document}</tex-math></alternatives></inline-formula> for retreat. The stimulus conditions were thus encoded as a 20-dimensional binary vector <inline-formula><alternatives><mml:math id="inf125"><mml:msub><mml:mi>U</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft125">\begin{document}$U_{t}$\end{document}</tex-math></alternatives></inline-formula> at each time step <inline-formula><alternatives><mml:math id="inf126"><mml:mi>t</mml:mi></mml:math><tex-math id="inft126">\begin{document}$t$\end{document}</tex-math></alternatives></inline-formula>, with a 1 corresponding to the active category and 0 elsewhere. The number of stimulus categories was arbitrarily defined, but we verified that key results were robust to the number of input bins (see <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>; <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>; <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>, and <xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2</xref>).</p><p>For a state <inline-formula><alternatives><mml:math id="inf127"><mml:mi>k</mml:mi></mml:math><tex-math id="inft127">\begin{document}$k$\end{document}</tex-math></alternatives></inline-formula>, the SLDS model represents the contribution of input on dynamics using the term <inline-formula><alternatives><mml:math id="inf128"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft128">\begin{document}$V_{k}U_{t}$\end{document}</tex-math></alternatives></inline-formula> (<xref ref-type="disp-formula" rid="equ2">Equation 2</xref>), where <inline-formula><alternatives><mml:math id="inf129"><mml:msub><mml:mi>U</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft129">\begin{document}$U_{t}$\end{document}</tex-math></alternatives></inline-formula> encodes the stimulus and <inline-formula><alternatives><mml:math id="inf130"><mml:msub><mml:mi>V</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft130">\begin{document}$V_{k}$\end{document}</tex-math></alternatives></inline-formula> maps the input into the latent space. Note <inline-formula><alternatives><mml:math id="inf131"><mml:msub><mml:mi>V</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft131">\begin{document}$V_{k}$\end{document}</tex-math></alternatives></inline-formula> is state-specific, allowing distinct representations of the same stimulus category per state.</p></sec><sec id="s4-6"><title>Assessing statistical significance using bootstrapping</title><p>Data from the held-out set of 92 participants of the moving circles dataset were used to report findings of the study and determine statistical significance, which was determined via bootstrapping (<xref ref-type="bibr" rid="bib12">Efron and Tibshirani, 1994</xref>). A total of 500 bootstrap samples of the dataset were generated by sampling participants with replacement, and an SLDS model was fit on each bootstrap iteration.</p><p>Because state labels are not necessarily preserved across bootstrap samples, we realigned them using a combination of the Hungarian algorithm (<xref ref-type="bibr" rid="bib31">Kuhn, 1955</xref>) and <italic>k</italic>-means clustering. To do so, for each bootstrap sample, state parameters <inline-formula><alternatives><mml:math id="inf132"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft132">\begin{document}${A_{k},b_{k},\Sigma^{h}_{k}}$\end{document}</tex-math></alternatives></inline-formula> were concatenated to form <inline-formula><alternatives><mml:math id="inf133"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:math><tex-math id="inft133">\begin{document}$K=6$\end{document}</tex-math></alternatives></inline-formula> ‘large vectors’ <inline-formula><alternatives><mml:math id="inf134"><mml:mi>θ</mml:mi></mml:math><tex-math id="inft134">\begin{document}$\theta$\end{document}</tex-math></alternatives></inline-formula>, one for each state. The resulting vectors were then clustered into <inline-formula><alternatives><mml:math id="inf135"><mml:mi>K</mml:mi></mml:math><tex-math id="inft135">\begin{document}$K$\end{document}</tex-math></alternatives></inline-formula> clusters. The <inline-formula><alternatives><mml:math id="inf136"><mml:mi>K</mml:mi></mml:math><tex-math id="inft136">\begin{document}$K$\end{document}</tex-math></alternatives></inline-formula> cluster centroids provided representative vectors <inline-formula><alternatives><mml:math id="inf137"><mml:mi>θ</mml:mi></mml:math><tex-math id="inft137">\begin{document}$\theta$\end{document}</tex-math></alternatives></inline-formula> for each state. In this manner, aligning state labels across bootstrap samples amounted to assigning each bootstrap sample’s <inline-formula><alternatives><mml:math id="inf138"><mml:mi>θ</mml:mi></mml:math><tex-math id="inft138">\begin{document}$\theta$\end{document}</tex-math></alternatives></inline-formula> vectors to the <inline-formula><alternatives><mml:math id="inf139"><mml:mi>K</mml:mi></mml:math><tex-math id="inft139">\begin{document}$K$\end{document}</tex-math></alternatives></inline-formula> cluster centroids. The assignment problem was determined by the Hungarian assignment algorithm, such that the bootstrap sample’s state <inline-formula><alternatives><mml:math id="inf140"><mml:mi>θ</mml:mi></mml:math><tex-math id="inft140">\begin{document}$\theta$\end{document}</tex-math></alternatives></inline-formula> vectors were maximally aligned to the <inline-formula><alternatives><mml:math id="inf141"><mml:mi>K</mml:mi></mml:math><tex-math id="inft141">\begin{document}$K$\end{document}</tex-math></alternatives></inline-formula> cluster centroids.</p><p>To determine the number of bootstrap iterations, we generated samples in steps of 100 until the estimates of the above-mentioned <inline-formula><alternatives><mml:math id="inf142"><mml:mi>θ</mml:mi></mml:math><tex-math id="inft142">\begin{document}$\theta$\end{document}</tex-math></alternatives></inline-formula> centroids were stable. Specifically, the elements of each centroid did not change (within 10<sup>–5</sup> precision) upon adding bootstrap samples. The procedure was stopped at 500 bootstrap samples.</p></sec><sec id="s4-7"><title>Calculating the probability of a state given a stimulus</title><p>To determine <inline-formula><alternatives><mml:math id="inf143"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext>state</mml:mtext><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext>input</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft143">\begin{document}$P(\text{state}|\text{input})$\end{document}</tex-math></alternatives></inline-formula>, we defined a state by input table. Each entry corresponded to the proportion of time a state <inline-formula><alternatives><mml:math id="inf144"><mml:msub><mml:mi>Z</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft144">\begin{document}$Z_{t}$\end{document}</tex-math></alternatives></inline-formula> assumed a specific value <inline-formula><alternatives><mml:math id="inf145"><mml:mi>z</mml:mi></mml:math><tex-math id="inft145">\begin{document}$z$\end{document}</tex-math></alternatives></inline-formula> given that the input <inline-formula><alternatives><mml:math id="inf146"><mml:msub><mml:mi>U</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft146">\begin{document}$U_{t}$\end{document}</tex-math></alternatives></inline-formula> assumed a specific value <inline-formula><alternatives><mml:math id="inf147"><mml:mi>u</mml:mi></mml:math><tex-math id="inft147">\begin{document}$u$\end{document}</tex-math></alternatives></inline-formula>. This counting procedure can be briefly summarized in the (somewhat awkward) expression<disp-formula id="equ4"><alternatives><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo fence="false" stretchy="false">|</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mn mathvariant="double-struck">1</mml:mn></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn mathvariant="double-struck">1</mml:mn></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mn mathvariant="double-struck">1</mml:mn></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t4">\begin{document}$$\displaystyle  P(Z_{t}=z\vert U_{t}=u) = \frac{\sum_{t=1}^{T}\mathbb{1}(Z_{t}=z)\mathbb{1}(U_{t}=u)}{\sum_{t=1}^{T}\mathbb{1}(U_{t}=u)},$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <inline-formula><alternatives><mml:math id="inf148"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn mathvariant="double-struck">1</mml:mn></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="inft148">\begin{document}$\mathbb{1}(\cdot)$\end{document}</tex-math></alternatives></inline-formula> represents an indicator function that takes value 1 when the operand is true and 0 otherwise. Given the hemodynamic delay (approximately 2 s to initiate a response and 4–6 s to peak; <xref ref-type="bibr" rid="bib7">Boynton et al., 1996</xref>), we used a time shift of three time steps (3.75 s) in considering the relationship between SLDS state and stimulus category. That is, to facilitate interpretation, we assumed that the effect of circle proximity (as encoded in terms of the discrete stimulus categories) would be expressed in the fMRI time series 3 time steps later.</p><p>We tested the statistical significance of each entry in the state by input table as follows. To account for sampling variability of the sample we studied, we computed a table for each iteration of the bootstrap, allowing us to estimate the variability of our results across the population (group level). Similarly, we obtained surrogate tables, one for each bootstrap resample, by randomly shifting the state sequences by random offsets. In this manner, the relative order of the states was randomized with respect to order of stimuli but the other properties were maintained (transition structure in the sequences). By obtaining bootstrap and surrogate tables for each table cell corresponding to a given state and stimulus, we obtained a population-level distribution of table values and a null distribution.</p><p>Based on these results, each table entry mean was compared to the mean of the corresponding null distribution via a paired Wilcoxon signed-rank test at <inline-formula><alternatives><mml:math id="inf149"><mml:mtext>p</mml:mtext><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:math><tex-math id="inft149">\begin{document}$\text{p} \lt 0.05$\end{document}</tex-math></alternatives></inline-formula>. To correct for multiple comparisons across the number of states and stimulus categories (6×20), Bonferroni correction was applied.</p></sec><sec id="s4-8"><title>Calculating the probability of a state transition given a stimulus</title><p>State transitions were linked to the stimuli using an analogous procedure as that to map states to stimuli. We created a table with 8 state transitions of interest (see Appendix 1) by 20 stimulus categories. Each table entry was calculated by counting the number of times a given state transition was observed given a stimulus category. Formally, this counting procedure can be succinctly described as follows: for a row <inline-formula><alternatives><mml:math id="inf150"><mml:mi>r</mml:mi></mml:math><tex-math id="inft150">\begin{document}$r$\end{document}</tex-math></alternatives></inline-formula> representing transition <inline-formula><alternatives><mml:math id="inf151"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mtext>state </mml:mtext><mml:mi>i</mml:mi><mml:mo stretchy="false">↦</mml:mo><mml:mtext>state</mml:mtext><mml:mspace width="thinmathspace"/><mml:mi>j</mml:mi></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft151">\begin{document}$\text{state }i\mapsto\text{state}\, j$\end{document}</tex-math></alternatives></inline-formula> and column <inline-formula><alternatives><mml:math id="inf152"><mml:mi>u</mml:mi></mml:math><tex-math id="inft152">\begin{document}$u$\end{document}</tex-math></alternatives></inline-formula>, the corresponding table entry measures the probability<disp-formula id="equ5"><alternatives><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo fence="false" stretchy="false">|</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mn mathvariant="double-struck">1</mml:mn></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn mathvariant="double-struck">1</mml:mn></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn mathvariant="double-struck">1</mml:mn></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mn mathvariant="double-struck">1</mml:mn></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t5">\begin{document}$$\displaystyle  P(Z_{t}=i,Z_{t+1}=j\vert U_{t}=u) = \frac{\sum_{t=1}^{T}\mathbb{1}(Z_{t}=i)\mathbb{1}(Z_{t+1}=j)\mathbb{1}(U_{t}=u)}{\sum_{t=1}^{T}\mathbb{1}(U_{t}=u)},$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <inline-formula><alternatives><mml:math id="inf153"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn mathvariant="double-struck">1</mml:mn></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="inft153">\begin{document}$\mathbb{1}(\cdot)$\end{document}</tex-math></alternatives></inline-formula> represents an indicator function. Once again, this is calculated by considering the hemodynamic delay. Finally, statistical inference was performed using a similar approach as described previously for calculating probabilities of states given stimuli.</p></sec><sec id="s4-9"><title>State spatial maps</title><p>We sought to characterize the spatial organization of brain states: for a given state <inline-formula><alternatives><mml:math id="inf154"><mml:mi>k</mml:mi></mml:math><tex-math id="inft154">\begin{document}$k$\end{document}</tex-math></alternatives></inline-formula>, what is the typical pattern of activity throughout the brain. This could be accomplished by using multiple regression with variables for each state: 1 when the state is on, 0 otherwise. We performed multiple regression in this manner in a voxel-wise manner. Note that this was possible because once the states are estimated (based on 85 ROIs), the regression can be applied at any spatial level desired (ROI or voxel). The regression model can be expressed mathematically as<disp-formula id="equ6"><alternatives><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mtext>BOLD</mml:mtext><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mrow><mml:mn mathvariant="double-struck">1</mml:mn></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t6">\begin{document}$$\displaystyle  \text{BOLD}_{t} = \sum_{i=k}^{K}\beta_{i}\times \mathbb{1}(Z_{t}=i) + \varepsilon_{t},$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <inline-formula><alternatives><mml:math id="inf155"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mn mathvariant="double-struck">1</mml:mn></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft155">\begin{document}$\mathbb{1}(Z_{t}=k)$\end{document}</tex-math></alternatives></inline-formula> is an indicator function denoting whether state <inline-formula><alternatives><mml:math id="inf156"><mml:mi>k</mml:mi></mml:math><tex-math id="inft156">\begin{document}$k$\end{document}</tex-math></alternatives></inline-formula> is active at time <inline-formula><alternatives><mml:math id="inf157"><mml:mi>t</mml:mi></mml:math><tex-math id="inft157">\begin{document}$t$\end{document}</tex-math></alternatives></inline-formula>, <inline-formula><alternatives><mml:math id="inf158"><mml:msub><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft158">\begin{document}$\beta_{k}$\end{document}</tex-math></alternatives></inline-formula> is the corresponding regression coefficient, and <inline-formula><alternatives><mml:math id="inf159"><mml:msub><mml:mi>ε</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft159">\begin{document}$\varepsilon_{t}$\end{document}</tex-math></alternatives></inline-formula> is an error term. For notational simplicity, terms accounting for confounds like scanner drift and head motion have been omitted from the above expression but were included in the regression model.</p><p>State maps were evaluated statistically based on the bootstrap approach discussed previously. First, state activity maps were determined for every participant, separately. A group-level map was then obtained by averaging across participants. This procedure was performed for every bootstrap sample, allowing us to estimate sampling variability. Similarly, a set of null state maps was generated by repeating the same procedure but with randomly permuted state sequences. To identify statistically significant voxels, we performed a paired t-test between the participant-based bootstrapped maps and the null maps. To account for multiple comparisons, we employed a cluster-based approach (<xref ref-type="bibr" rid="bib18">Friston et al., 1994</xref>). Voxels were first thresholded at <inline-formula><alternatives><mml:math id="inf160"><mml:mtext>p</mml:mtext><mml:mo>&lt;</mml:mo><mml:mn>0.001</mml:mn></mml:math><tex-math id="inft160">\begin{document}$\text{p} \lt 0.001$\end{document}</tex-math></alternatives></inline-formula>, and clusters with at least <inline-formula><alternatives><mml:math id="inf161"><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>18</mml:mn></mml:math><tex-math id="inft161">\begin{document}$c=18$\end{document}</tex-math></alternatives></inline-formula> voxels were deemed statistically significant at the cluster level. To determine the minimum cluster size <inline-formula><alternatives><mml:math id="inf162"><mml:mi>c</mml:mi></mml:math><tex-math id="inft162">\begin{document}$c$\end{document}</tex-math></alternatives></inline-formula>, we employed null state maps. The cluster size <inline-formula><alternatives><mml:math id="inf163"><mml:mi>c</mml:mi></mml:math><tex-math id="inft163">\begin{document}$c$\end{document}</tex-math></alternatives></inline-formula> was such that only 5% of the clusters in the null state maps would be detected, corresponding to a 5% false-positive rate.</p><p>For contrast maps, an analogous approach was employed, but at the individual level, contrast maps were determined by computing <inline-formula><alternatives><mml:math id="inf164"><mml:msub><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft164">\begin{document}$\beta_{i}-\beta_{j}$\end{document}</tex-math></alternatives></inline-formula>, where <inline-formula><alternatives><mml:math id="inf165"><mml:mi>i</mml:mi></mml:math><tex-math id="inft165">\begin{document}$i$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf166"><mml:mi>j</mml:mi></mml:math><tex-math id="inft166">\begin{document}$j$\end{document}</tex-math></alternatives></inline-formula> are two states in question.</p></sec><sec id="s4-10"><title>Responses during state transitions</title><p>Responses at a given ROI were evaluated during temporal windows centered around state transitions. For transitions from state <inline-formula><alternatives><mml:math id="inf167"><mml:mi>i</mml:mi></mml:math><tex-math id="inft167">\begin{document}$i$\end{document}</tex-math></alternatives></inline-formula> to state <inline-formula><alternatives><mml:math id="inf168"><mml:mi>j</mml:mi></mml:math><tex-math id="inft168">\begin{document}$j$\end{document}</tex-math></alternatives></inline-formula>, we chose windows where the first half of the time steps were labeled as state <inline-formula><alternatives><mml:math id="inf169"><mml:mi>i</mml:mi></mml:math><tex-math id="inft169">\begin{document}$i$\end{document}</tex-math></alternatives></inline-formula> and the final time steps as state <inline-formula><alternatives><mml:math id="inf170"><mml:mi>j</mml:mi></mml:math><tex-math id="inft170">\begin{document}$j$\end{document}</tex-math></alternatives></inline-formula>. We chose windows of length 8 time steps such that they were long enough to reveal activity changes but also observed frequently enough to generate a reliable estimate. For a given state transition, participant-level responses were determined by averaging responses across all qualifying time windows. To estimate variability, group-level responses were determined by averaging participant-level responses for each bootstrap sample.</p><p>We also determined responses at the ‘network’ level, which were obtained by averaging ROI responses across all ROIs inside the network. We considered the salience (ventral attention) and default networks, as defined in the Schaefer 100-region 7-network parcellation (<xref ref-type="bibr" rid="bib54">Schaefer et al., 2018</xref>).</p></sec><sec id="s4-11"><title>State-specific intrinsic dynamics and fixed points</title><p>Each state’s dynamics in the latent space was modeled using a linear dynamical system, which evolves as follows:<disp-formula id="equ7"><label>(4)</label><alternatives><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t7">\begin{document}$$\displaystyle  X_{t}= A_{k} X_{t-1}+ b_{k} + V_{k}U_{t}. $$\end{document}</tex-math></alternatives></disp-formula></p><p>To characterize the intrinsic dynamics exclusively, assume that the input to the system is zero across time:<disp-formula id="equ8"><label>(5)</label><alternatives><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t8">\begin{document}$$\displaystyle  X_{t}= A_{k} X_{t-1}+ b_{k}. $$\end{document}</tex-math></alternatives></disp-formula></p><p>Assuming that the dynamics are stable and approach an equilibrium point <inline-formula><alternatives><mml:math id="inf171"><mml:msub><mml:mover><mml:mi>X</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft171">\begin{document}$\overline{X}_{k}$\end{document}</tex-math></alternatives></inline-formula> as a function of time (also known as a ‘fixed point’ or attractor), we obtain<disp-formula id="equ9"><alternatives><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msub><mml:mover><mml:mi>X</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover><mml:mi>X</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mover><mml:mi>X</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t9">\begin{document}$$\displaystyle  \begin{array}{ll}\overline{X}_{k}= A_{k} \overline{X}_{k} + b_{k}\\ \overline{X}_{k}= [I-A_{k}]^{-1}b_{k},\end{array}$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <inline-formula><alternatives><mml:math id="inf172"><mml:mi>I</mml:mi></mml:math><tex-math id="inft172">\begin{document}$I$\end{document}</tex-math></alternatives></inline-formula> is a <inline-formula><alternatives><mml:math id="inf173"><mml:mi>D</mml:mi><mml:mo>×</mml:mo><mml:mi>D</mml:mi></mml:math><tex-math id="inft173">\begin{document}$D\times D$\end{document}</tex-math></alternatives></inline-formula> identity matrix. All trajectories in the neighborhood of the fixed point (also called the basin of attraction) will eventually converge toward the fixed point.</p></sec><sec id="s4-12"><title>Testing for stable intrinsic dynamics</title><p>The dynamics of a linear dynamical system is determined by the eigenvalues of the dynamics matrix <inline-formula><alternatives><mml:math id="inf174"><mml:msub><mml:mi>A</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft174">\begin{document}$A_{k}$\end{document}</tex-math></alternatives></inline-formula>. In particular, the dynamics is stable if all eigenvalues lie inside a unit circle on the complex plane (refer to <xref ref-type="bibr" rid="bib38">Luenberger, 1979</xref>; <xref ref-type="bibr" rid="bib52">Robinson, 2012</xref>, for detailed accounts on stability of linear dynamical systems). Therefore, it suffices to test whether the norm of the largest eigenvalue is less than unity. Bootstrapping was again used to evaluate the statistical significance of the results. We determined the largest eigenvalues for all bootstrap samples and calculated the p-value as the fraction of the eigenvalues with absolute value greater than 1. States with p-value&lt;0.05 were considered to follow stable dynamics. Bonferroni correction was applied to correct for multiple comparisons across <inline-formula><alternatives><mml:math id="inf175"><mml:mi>K</mml:mi></mml:math><tex-math id="inft175">\begin{document}$K$\end{document}</tex-math></alternatives></inline-formula> states.</p></sec><sec id="s4-13"><title>Visualizing state attractors on the brain</title><p>Given an attractor state <inline-formula><alternatives><mml:math id="inf176"><mml:mi>i</mml:mi></mml:math><tex-math id="inft176">\begin{document}$i$\end{document}</tex-math></alternatives></inline-formula>, its fixed point <inline-formula><alternatives><mml:math id="inf177"><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft177">\begin{document}$\bar{X}_{i}$\end{document}</tex-math></alternatives></inline-formula> is a vector in the <inline-formula><alternatives><mml:math id="inf178"><mml:mi>D</mml:mi></mml:math><tex-math id="inft178">\begin{document}$D$\end{document}</tex-math></alternatives></inline-formula>-dimensional latent space. For the purpose of visualizing state attractors on the brain, we projected them onto the original data space (the time series space of 85 ROIs) using the observation step of the SLDS model (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>).<disp-formula id="equ10"><alternatives><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd/><mml:mtd><mml:msubsup><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>ROI</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:msub><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t10">\begin{document}$$\displaystyle  \begin{array}{ll}&amp;\bar{X}_{i}^{\text{ROI}}= C\bar{X}_{i}+d\quad\quad \quad i=1,2,\cdots,K,\end{array}$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <inline-formula><alternatives><mml:math id="inf179"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msubsup><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>ROI</mml:mtext></mml:mrow></mml:msubsup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft179">\begin{document}$\bar{X}_{i}^{\text{ROI}}$\end{document}</tex-math></alternatives></inline-formula> is state <inline-formula><alternatives><mml:math id="inf180"><mml:mi>i</mml:mi></mml:math><tex-math id="inft180">\begin{document}$i$\end{document}</tex-math></alternatives></inline-formula>’s attractor in ROI space. State attractors in ROI space were estimated across bootstrap samples, and the average pattern was visualized. The average attractor pattern was thresholded at each ROI (<inline-formula><alternatives><mml:math id="inf181"><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:math><tex-math id="inft181">\begin{document}$p \lt 0.05$\end{document}</tex-math></alternatives></inline-formula>) based on a Wilcoxon signed-rank test (<inline-formula><alternatives><mml:math id="inf182"><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:math><tex-math id="inft182">\begin{document}$p \lt 0.05$\end{document}</tex-math></alternatives></inline-formula>), i.e., by comparing the activity levels to zero. Bonferroni correction was applied to correct for multiple comparisons across <inline-formula><alternatives><mml:math id="inf183"><mml:mi>K</mml:mi></mml:math><tex-math id="inft183">\begin{document}$K$\end{document}</tex-math></alternatives></inline-formula> states and 85 ROIs.</p></sec><sec id="s4-14"><title>State trajectories and vector fields</title><p>For each state, trajectories were determined first in the latent space (<inline-formula><alternatives><mml:math id="inf184"><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:math><tex-math id="inft184">\begin{document}$D=10$\end{document}</tex-math></alternatives></inline-formula>). We averaged (across participants) all windows with 10 time steps starting at a specific state <inline-formula><alternatives><mml:math id="inf185"><mml:mi>k</mml:mi></mml:math><tex-math id="inft185">\begin{document}$k$\end{document}</tex-math></alternatives></inline-formula>. Note that trajectories correspond to <xref ref-type="disp-formula" rid="equ7">Equation 4</xref> and consider both endogenous and exogenous terms. At each time step of the average trajectory, a trajectory could continue along a state or switch to a state <inline-formula><alternatives><mml:math id="inf186"><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:math><tex-math id="inft186">\begin{document}$j\neq k$\end{document}</tex-math></alternatives></inline-formula>. The state label for a time step along the trajectory was assigned to the most typical state at that time step, i.e., the modal state. We colored the trajectory green when the state label was <inline-formula><alternatives><mml:math id="inf187"><mml:mi>k</mml:mi></mml:math><tex-math id="inft187">\begin{document}$k$\end{document}</tex-math></alternatives></inline-formula> and red otherwise (state <inline-formula><alternatives><mml:math id="inf188"><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:math><tex-math id="inft188">\begin{document}$j\neq k$\end{document}</tex-math></alternatives></inline-formula>). To illustrate the trajectory, we plotted it in 2D. To do so, we fit principal component analysis on the 10 points constituting the average trajectory and projected it onto the plane spanned by the top two principal components.</p><p>Trajectories were plotted on vector fields that represent how a particle would flow under the endogenous dynamics (i.e. based on <inline-formula><alternatives><mml:math id="inf189"><mml:msub><mml:mi>A</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft189">\begin{document}$A_{k}$\end{document}</tex-math></alternatives></inline-formula>). This allowed us to visualize how external inputs contributed to the evolution of the system (note that, by definition, without inputs trajectories would converge to the state’s attractor). At each point on the 2D plane, the vectors represent the trajectory evolution for a single time step. Vector field points were sampled uniformly on the 2D plane. The points were projected to the latent space using the top two principal components above, evolved according to endogenous dynamics rule (<xref ref-type="disp-formula" rid="equ8">Equation 5</xref>), and projected back onto the 2D plane again using the top two principal components. Finally, the state’s fixed point attractor (a point in the latent space) was also projected onto the 2D plane in the same manner.</p></sec><sec id="s4-15"><title>Quantifying contribution of inputs in state dynamics</title><p>As described above, state <inline-formula><alternatives><mml:math id="inf190"><mml:mi>k</mml:mi></mml:math><tex-math id="inft190">\begin{document}$k$\end{document}</tex-math></alternatives></inline-formula>’s trajectory follows the following dynamical rule given in <xref ref-type="disp-formula" rid="equ7">Equation 4</xref>, with the term <inline-formula><alternatives><mml:math id="inf191"><mml:msub><mml:mi>V</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>U</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft191">\begin{document}$V_{k}U_{t}$\end{document}</tex-math></alternatives></inline-formula> representing contribution of external inputs as a vector in latent space. To investigate the contribution of external inputs to the latent trajectory, we determined how inputs steered the system’s trajectory. For each state, we determined the state’s centroid, namely, the vector <inline-formula><alternatives><mml:math id="inf192"><mml:msup><mml:mi>X</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math><tex-math id="inft192">\begin{document}$X^{c,k}$\end{document}</tex-math></alternatives></inline-formula> that represented the centroid coordinate of all locations visited by the system during state <inline-formula><alternatives><mml:math id="inf193"><mml:mi>k</mml:mi></mml:math><tex-math id="inft193">\begin{document}$k$\end{document}</tex-math></alternatives></inline-formula>. Such geometrical location provided a reference position to investigate the input contributions.</p><p>Given a state, the external input at a given time can either drive latent trajectories toward the state centroid or away from it. To quantify input effects, we measured the length of the projection of the input vector along the direction connecting the position of the state trajectory and the state centroid:<disp-formula id="equ11"><alternatives><mml:math id="m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>eff</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo></mml:mrow><mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">‖</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t11">\begin{document}$$\displaystyle  l_{\text{eff}}= \frac{\langle X^{c,k}- X_{t}, V_{k}U_{t}\rangle}{\Vert X^{c,k}- X_{t}\Vert},$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <inline-formula><alternatives><mml:math id="inf194"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo>⋅</mml:mo><mml:mo>,</mml:mo><mml:mo>⋅</mml:mo><mml:mo fence="false" stretchy="false">⟩</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft194">\begin{document}$\langle\cdot,\cdot\rangle$\end{document}</tex-math></alternatives></inline-formula> indicates the inner product between two vectors and <inline-formula><alternatives><mml:math id="inf195"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mo>⋅</mml:mo><mml:mo fence="false" stretchy="false">‖</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft195">\begin{document}$\|\cdot\|$\end{document}</tex-math></alternatives></inline-formula> indicates the Euclidean norm. Thus, positive (negative) <inline-formula><alternatives><mml:math id="inf196"><mml:msub><mml:mi>l</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mtext>eff</mml:mtext></mml:mrow></mml:msub></mml:math><tex-math id="inft196">\begin{document}$l_{\text{eff}}$\end{document}</tex-math></alternatives></inline-formula> values indicate that the input pushes state trajectories toward (away from) the state centroid. We focused on inputs associated with the given state as defined throughout the paper (methods for mapping states to stimuli, see Methods). Accordingly, the input effects are summarized in a table where the (<italic>i</italic>,<italic>j</italic>)th element represents the effect of input <inline-formula><alternatives><mml:math id="inf197"><mml:mi>j</mml:mi></mml:math><tex-math id="inft197">\begin{document}$j$\end{document}</tex-math></alternatives></inline-formula> on trajectories in state <inline-formula><alternatives><mml:math id="inf198"><mml:mi>i</mml:mi></mml:math><tex-math id="inft198">\begin{document}$i$\end{document}</tex-math></alternatives></inline-formula>.</p><p>Tables were constructed as previously such that each bootstrap iteration generated one instance of the table. The results shown correspond to the average value across bootstrap samples. Statistically, we tested whether the average input effects were significantly different from zero by conducting a Wilcoxon signed-rank test at each table entry (<inline-formula><alternatives><mml:math id="inf199"><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:math><tex-math id="inft199">\begin{document}$p \lt 0.05$\end{document}</tex-math></alternatives></inline-formula>). Bonferroni correction was applied to correct for multiple comparisons across <inline-formula><alternatives><mml:math id="inf200"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:math><tex-math id="inft200">\begin{document}$K=6$\end{document}</tex-math></alternatives></inline-formula> states and 20 input categories.</p></sec><sec id="s4-16"><title>Quantifying the contribution of inputs in state transitions</title><p>Next, we quantified the contributions of input stimuli to state transitions. Specifically, for particular state transitions <inline-formula><alternatives><mml:math id="inf201"><mml:mi>i</mml:mi><mml:mo stretchy="false">↦</mml:mo><mml:mi>j</mml:mi></mml:math><tex-math id="inft201">\begin{document}$i\mapsto j$\end{document}</tex-math></alternatives></inline-formula>, we determined the extent to which input stimuli contributed to such transitions. As above, <inline-formula><alternatives><mml:math id="inf202"><mml:msub><mml:mi>l</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mtext>eff</mml:mtext></mml:mrow></mml:msub></mml:math><tex-math id="inft202">\begin{document}$l_{\text{eff}}$\end{document}</tex-math></alternatives></inline-formula> was used to measure the effect of the external input vector along the direction joining the position of the state trajectory and state <inline-formula><alternatives><mml:math id="inf203"><mml:mi>j</mml:mi></mml:math><tex-math id="inft203">\begin{document}$j$\end{document}</tex-math></alternatives></inline-formula>’s centroid (in place of state <inline-formula><alternatives><mml:math id="inf204"><mml:mi>i</mml:mi></mml:math><tex-math id="inft204">\begin{document}$i$\end{document}</tex-math></alternatives></inline-formula>’s centroid). Positive values indicate that the input pushed the latent vector from state <inline-formula><alternatives><mml:math id="inf205"><mml:mi>i</mml:mi></mml:math><tex-math id="inft205">\begin{document}$i$\end{document}</tex-math></alternatives></inline-formula> toward state <inline-formula><alternatives><mml:math id="inf206"><mml:mi>j</mml:mi></mml:math><tex-math id="inft206">\begin{document}$j$\end{document}</tex-math></alternatives></inline-formula>.</p><p>Tables were constructed as previously, such that each bootstrap iteration generated one instance of the table. The results shown correspond to the average value across bootstrap samples. Statistically, we tested whether average input effects were significantly different from zero by conducting a Wilcoxon signed-rank test at each table entry (<inline-formula><alternatives><mml:math id="inf207"><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:math><tex-math id="inft207">\begin{document}$p \lt 0.05$\end{document}</tex-math></alternatives></inline-formula>). Bonferroni correction was applied to correct for multiple comparisons across 8 state transitions of interest and 20 input categories.</p></sec><sec id="s4-17"><title>Testing SLDS model generalizability</title><p>After fitting the SDLS model based on the data of the moving circles (<monospace>MOV</monospace>) paradigm, we investigated if the model states generalized to another threat-related paradigm, namely, the escape (<monospace>ESC</monospace>) experiment described above (see <xref ref-type="fig" rid="fig9">Figure 9A</xref>). Specifically, after fitting the data to the first dataset, we determined the variables <inline-formula><alternatives><mml:math id="inf208"><mml:msub><mml:mi>X</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft208">\begin{document}$X_{t}$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf209"><mml:msub><mml:mi>Z</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft209">\begin{document}$Z_{t}$\end{document}</tex-math></alternatives></inline-formula> for the <monospace>ESC</monospace> dataset. <monospace>ESC</monospace> time series data was analyzed for temporal windows centered around the time step when the player entered safety (rounded to the nearest data sample). Windows straddled between chase and safety periods, from <inline-formula><alternatives><mml:math id="inf210"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>6.25</mml:mn></mml:math><tex-math id="inft210">\begin{document}$t=-6.25$\end{document}</tex-math></alternatives></inline-formula> to <inline-formula><alternatives><mml:math id="inf211"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>5.0</mml:mn></mml:math><tex-math id="inft211">\begin{document}$t=5.0$\end{document}</tex-math></alternatives></inline-formula> with <inline-formula><alternatives><mml:math id="inf212"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><tex-math id="inft212">\begin{document}$t=0$\end{document}</tex-math></alternatives></inline-formula> being the cross-into-safety point.</p><p>To determine the best-matching MOV states for the ESC time series data, we quantified <inline-formula><alternatives><mml:math id="inf213"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext>state</mml:mtext><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext>time step</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="inft213">\begin{document}$P(\text{state}|\text{time step})$\end{document}</tex-math></alternatives></inline-formula> for all combinations of state by time steps (see <xref ref-type="fig" rid="fig9">Figure 9</xref>). Each value was computed as the normalized frequency of observing a state <inline-formula><alternatives><mml:math id="inf214"><mml:msub><mml:mi>Z</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft214">\begin{document}$Z_{t}$\end{document}</tex-math></alternatives></inline-formula> at a given time step <inline-formula><alternatives><mml:math id="inf215"><mml:msub><mml:mi>t</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mtext>win</mml:mtext></mml:mrow></mml:msub></mml:math><tex-math id="inft215">\begin{document}$t_{\text{win}}$\end{document}</tex-math></alternatives></inline-formula> of the window. Formally:<disp-formula id="equ12"><alternatives><mml:math id="m12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo fence="false" stretchy="false">|</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mtext>win</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mn mathvariant="double-struck">1</mml:mn></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn mathvariant="double-struck">1</mml:mn></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mtext>win</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mn mathvariant="double-struck">1</mml:mn></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mtext>win</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t12">\begin{document}$$\displaystyle  P(Z_{t}=z\vert t_{\text{win}}=i) = \frac{\sum_{t=1}^{T}\mathbb{1}(Z_{t}=z)\mathbb{1}(t_{\text{win}}=i)}{\sum_{t=1}^{T}\mathbb{1}(t_{\text{win}}=i)},$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <inline-formula><alternatives><mml:math id="inf216"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn mathvariant="double-struck">1</mml:mn></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="inft216">\begin{document}$\mathbb{1}(\cdot)$\end{document}</tex-math></alternatives></inline-formula> represents the indicator function.</p><p>We determined the statistical significance of the probability values as follows. To determine the probabilities that would be observed by chance, we determined surrogate tables (states by time step) by shifting the MOV state sequences by random offsets (analogous to the approach used in mapping states to stimuli in MOV, see Methods), which provided a null distribution of probability values. Each probability value was then compared to the mean of the corresponding null distribution via a paired Wilcoxon signed-rank test at <inline-formula><alternatives><mml:math id="inf217"><mml:mtext>p</mml:mtext><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:math><tex-math id="inft217">\begin{document}$\text{p} \lt 0.05$\end{document}</tex-math></alternatives></inline-formula>. To correct for multiple comparisons across the number of states and time steps (6×10), Bonferroni correction was applied. In a similar fashion, the probability of a state transition from <inline-formula><alternatives><mml:math id="inf218"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mn>5</mml:mn><mml:mo stretchy="false">↦</mml:mo><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">E</mml:mi><mml:mspace width="thinmathspace"/><mml:mn>3</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft218">\begin{document}$\rm {STATE}\, 5 \mapsto STATE \, 3$\end{document}</tex-math></alternatives></inline-formula> was tested for statistical significance (analogous to mapping state transitions to stimuli in MOV, see Methods).</p></sec><sec id="s4-18"><title>Region importance</title><p>We performed a ‘lesion study’, where we quantified how brain regions contribute to state dynamics by eliminating (zeroing) model parameters corresponding to a given region and observing the resulting changes in system dynamics. According to our approach, the most important regions are those that cause the greatest change in system dynamics when eliminated.</p><p>The SLDS model represents dynamics in a low-dimensional latent space, and model parameters are not readily available at the level of individual regions. Thus, the first step was to project the dynamics equation onto the brain data prior to computing importance values. Thus, the linear dynamics equation in the latent space (<xref ref-type="disp-formula" rid="equ2">Equation 2</xref>) was mapped to the original data space of <inline-formula><alternatives><mml:math id="inf219"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>85</mml:mn></mml:math><tex-math id="inft219">\begin{document}$N=85$\end{document}</tex-math></alternatives></inline-formula> ROIs using the emissions model (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>):<disp-formula id="equ13"><alternatives><mml:math id="m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mml:mtr><mml:mtd><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>C</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>d</mml:mi></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>d</mml:mi></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>C</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mo>†</mml:mo></mml:mrow></mml:msup><mml:mi>C</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>d</mml:mi></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>C</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mo>†</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>d</mml:mi></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mo>†</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mo>≡</mml:mo><mml:mrow><mml:mover><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:munder><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mo>≡</mml:mo><mml:mrow><mml:mover><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:munder><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>C</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mo>†</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mo>≡</mml:mo><mml:mrow><mml:mover><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:munder></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mover><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mover><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t13">\begin{document}$$\displaystyle  Y_{t}&amp;=  C X_{t} + d \\&amp;=  C \left(A_{Z_t}X_{t-1}+ V_{Z_t}U_{t} + b_{Z_t}\right) + d \\&amp;=  CA_{Z_t}C^{\dagger}CX_{t-1}+ CV_{Z_t}U_{t} + Cb_{Z_t}+ d \\&amp;=  CA_{Z_t}C^{\dagger}\left(CX_{t-1}+d-d\right) + CV_{Z_t}U_{t} + Cb_{Z_t}+ d \\&amp;=  \underbrace{\left(CA_{Z_t}C^{\dagger}\right)}_{\equiv\widehat{A_{Z_t}}}Y_{t-1}+\underbrace{\left(CV_{Z_t}\right)}_{\equiv\widehat{V_{Z_t}}}U_{t} +\underbrace{\left(Cb_{Z_t}+\left(I-CA_{z_t}C^{\dagger}\right)d\right)}_{\equiv\widehat{b_{Z_t}}}\\&amp;=  \widehat{A_{Z_t}}Y_{t-1}+ \widehat{V_{Z_t}}U_{t} + \widehat{b_{Z_t}},$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <inline-formula><alternatives><mml:math id="inf220"><mml:msup><mml:mi>C</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>†</mml:mo></mml:mrow></mml:msup></mml:math><tex-math id="inft220">\begin{document}$C^{\dagger}$\end{document}</tex-math></alternatives></inline-formula> represents the Moore-Penrose pseudoinverse of <inline-formula><alternatives><mml:math id="inf221"><mml:mi>C</mml:mi></mml:math><tex-math id="inft221">\begin{document}$C$\end{document}</tex-math></alternatives></inline-formula>, and <inline-formula><alternatives><mml:math id="inf222"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mover><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft222">\begin{document}$\widehat{A_{Z_{t}}}\in\mathbb{R}^{N\times N}$\end{document}</tex-math></alternatives></inline-formula>, <inline-formula><alternatives><mml:math id="inf223"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mover><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft223">\begin{document}$\widehat{V_{Z_{t}}}\in\mathbb{R}^{N\times M}$\end{document}</tex-math></alternatives></inline-formula>, and <inline-formula><alternatives><mml:math id="inf224"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mover><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft224">\begin{document}$\widehat{b_{Z_{t}}}\in\mathbb{R}^{N}$\end{document}</tex-math></alternatives></inline-formula> denote the corresponding dynamics matrix, input matrix, and bias terms in the original data space.</p><p>Based on the above, we defined the importance of the <inline-formula><alternatives><mml:math id="inf225"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>i</mml:mi><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft225">\begin{document}$i{\text{th}}$\end{document}</tex-math></alternatives></inline-formula> ROI at time <inline-formula><alternatives><mml:math id="inf226"><mml:mi>t</mml:mi></mml:math><tex-math id="inft226">\begin{document}$t$\end{document}</tex-math></alternatives></inline-formula> based on quantifying the impact of ‘lesioning’ the <inline-formula><alternatives><mml:math id="inf227"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>i</mml:mi><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft227">\begin{document}$i{\text{th}}$\end{document}</tex-math></alternatives></inline-formula> ROI, i.e., by setting the <inline-formula><alternatives><mml:math id="inf228"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>i</mml:mi><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft228">\begin{document}$i{\text{th}}$\end{document}</tex-math></alternatives></inline-formula> column of <inline-formula><alternatives><mml:math id="inf229"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mover><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft229">\begin{document}$\widehat{A_{Z_{t}}}$\end{document}</tex-math></alternatives></inline-formula>, the <inline-formula><alternatives><mml:math id="inf230"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>i</mml:mi><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft230">\begin{document}$i{\text{th}}$\end{document}</tex-math></alternatives></inline-formula> row of <inline-formula><alternatives><mml:math id="inf231"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mover><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft231">\begin{document}$\widehat{V_{Z_{t}}}$\end{document}</tex-math></alternatives></inline-formula>, and the <inline-formula><alternatives><mml:math id="inf232"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>i</mml:mi><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft232">\begin{document}$i{\text{th}}$\end{document}</tex-math></alternatives></inline-formula> element of <inline-formula><alternatives><mml:math id="inf233"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mover><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft233">\begin{document}$\widehat{b_{Z_{t}}}$\end{document}</tex-math></alternatives></inline-formula> to 0, denoted <inline-formula><alternatives><mml:math id="inf234"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msup><mml:mrow><mml:mover><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft234">\begin{document}$\widehat{A_{Z_{t}}}^{(-i)}$\end{document}</tex-math></alternatives></inline-formula>, <inline-formula><alternatives><mml:math id="inf235"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msup><mml:mrow><mml:mover><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft235">\begin{document}$\widehat{V_{Z_{t}}}^{(-i)}$\end{document}</tex-math></alternatives></inline-formula>, and <inline-formula><alternatives><mml:math id="inf236"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msup><mml:mrow><mml:mover><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft236">\begin{document}$\widehat{b_{Z_{t}}}^{(-i)}$\end{document}</tex-math></alternatives></inline-formula>, respectively. Formally, the importance of the <inline-formula><alternatives><mml:math id="inf237"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>i</mml:mi><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft237">\begin{document}$i{\text{th}}$\end{document}</tex-math></alternatives></inline-formula> ROI <inline-formula><alternatives><mml:math id="inf238"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msubsup><mml:mi>q</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft238">\begin{document}$q_{t}^{i}$\end{document}</tex-math></alternatives></inline-formula> was defined as:<disp-formula id="equ14"><alternatives><mml:math id="m14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="right left right left right left right left right left right left" rowspacing="0.816em 0.816em 0.3em" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>q</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mo symmetric="true">‖</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>U</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>b</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mi>U</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>b</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo symmetric="true">‖</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mo symmetric="true">‖</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>U</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mi>U</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>b</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>b</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo symmetric="true">‖</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mo symmetric="true">‖</mml:mo><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>∗</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mi>U</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∗</mml:mo><mml:msub><mml:mrow><mml:mn mathvariant="double-struck">1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>b</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∗</mml:mo><mml:msub><mml:mrow><mml:mn mathvariant="double-struck">1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo symmetric="true">‖</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t14">\begin{document}$$\displaystyle  q_t^{i} &amp; =  \left\lVert \left( \widehat{A}_{Z_t} Y_{t-1} + \widehat{V}_{Z_t} U_t + \widehat{b}_{Z_t} \right) - \left( \widehat{A}_{Z_t}^{(-i)} Y_{t-1} + \widehat{V}_{Z_t}^{(-i)} U_t + \widehat{b}_{Z_t}^{(-i)} \right) \right\rVert_2 \\[1.2ex] &amp; =  \left\lVert \left( \widehat{A}_{Z_t} Y_{t-1} - \widehat{A}_{Z_t}^{(-i)} Y_{t-1} \right) + \left( \widehat{V}_{Z_t} U_t - \widehat{V}_{Z_t}^{(-i)} U_t \right) + \left( \widehat{b}_{Z_t} - \widehat{b}_{Z_t}^{(-i)} \right) \right\rVert_2 \\[1.2ex] &amp; =  \left\lVert Y_{t-1}^{i} * \widehat{A}_{Z_t}^{(i)} + \left( \widehat{V}_{Z_t}^{(i)} U_t \right) * \mathbb{1}_i + \widehat{b}_{Z_t}^{(i)} * \mathbb{1}_i \right\rVert_2, $$\end{document}</tex-math></alternatives></disp-formula></p><p>where ‘∗’ indicates element-wise multiplication of a scalar with a vector, <inline-formula><alternatives><mml:math id="inf239"><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math><tex-math id="inft239">\begin{document}$Y_{t-1}^{i}$\end{document}</tex-math></alternatives></inline-formula> is the activity of <inline-formula><alternatives><mml:math id="inf240"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>i</mml:mi><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft240">\begin{document}$i{\text{th}}$\end{document}</tex-math></alternatives></inline-formula> ROI at time <inline-formula><alternatives><mml:math id="inf241"><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:math><tex-math id="inft241">\begin{document}$t-1$\end{document}</tex-math></alternatives></inline-formula>, <inline-formula><alternatives><mml:math id="inf242"><mml:msup><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:msub><mml:mi>A</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:msub><mml:mi>Z</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math><tex-math id="inft242">\begin{document}$\widehat{A_{Z_{t}}}^{(i)}$\end{document}</tex-math></alternatives></inline-formula> corresponds to the <inline-formula><alternatives><mml:math id="inf243"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>i</mml:mi><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft243">\begin{document}$i{\text{th}}$\end{document}</tex-math></alternatives></inline-formula> column of <inline-formula><alternatives><mml:math id="inf244"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:msub><mml:mi>A</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:msub><mml:mi>Z</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math><tex-math id="inft244">\begin{document}$\widehat{A_{Z_{t}}}$\end{document}</tex-math></alternatives></inline-formula>, <inline-formula><alternatives><mml:math id="inf245"><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:msub><mml:mi>V</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:msub><mml:mi>Z</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">⊤</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>U</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math><tex-math id="inft245">\begin{document}$\left(\widehat{V_{Z_{t}}}^{(i)\top}U_{t}\right)$\end{document}</tex-math></alternatives></inline-formula> is the inner product between <inline-formula><alternatives><mml:math id="inf246"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>i</mml:mi><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft246">\begin{document}$i{\text{th}}$\end{document}</tex-math></alternatives></inline-formula> row of <inline-formula><alternatives><mml:math id="inf247"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:msub><mml:mi>V</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:msub><mml:mi>Z</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math><tex-math id="inft247">\begin{document}$\widehat{V_{Z_{t}}}$\end{document}</tex-math></alternatives></inline-formula> and input <inline-formula><alternatives><mml:math id="inf248"><mml:msub><mml:mi>U</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft248">\begin{document}$U_{t}$\end{document}</tex-math></alternatives></inline-formula>, <inline-formula><alternatives><mml:math id="inf249"><mml:msup><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:msub><mml:mi>b</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:msub><mml:mi>Z</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math><tex-math id="inft249">\begin{document}$\widehat{b_{Z_{t}}}^{(i)}$\end{document}</tex-math></alternatives></inline-formula> corresponds to the <inline-formula><alternatives><mml:math id="inf250"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>i</mml:mi><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft250">\begin{document}$i{\text{th}}$\end{document}</tex-math></alternatives></inline-formula> element of <inline-formula><alternatives><mml:math id="inf251"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:msub><mml:mi>b</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:msub><mml:mi>Z</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math><tex-math id="inft251">\begin{document}$\widehat{b_{Z_{t}}}$\end{document}</tex-math></alternatives></inline-formula>, and <inline-formula><alternatives><mml:math id="inf252"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mrow><mml:mn mathvariant="double-struck">1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft252">\begin{document}$\mathbb{1}_{i}\in\mathbb{R}^{N}$\end{document}</tex-math></alternatives></inline-formula> represents an indicator vector corresponding to the <inline-formula><alternatives><mml:math id="inf253"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>i</mml:mi><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft253">\begin{document}$i{\text{th}}$\end{document}</tex-math></alternatives></inline-formula> ROI. Note that the term <inline-formula><alternatives><mml:math id="inf254"><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>∗</mml:mo><mml:msup><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:msub><mml:mi>A</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:msub><mml:mi>Z</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math><tex-math id="inft254">\begin{document}$Y_{t-1}^{i}*\widehat{A_{Z_{t}}}^{(i)}$\end{document}</tex-math></alternatives></inline-formula> is a function of both the <inline-formula><alternatives><mml:math id="inf255"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>i</mml:mi><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft255">\begin{document}$i{\text{th}}$\end{document}</tex-math></alternatives></inline-formula> ROI’s activity and the coefficients of the dynamics matrix capturing the effect of region <inline-formula><alternatives><mml:math id="inf256"><mml:mi>i</mml:mi></mml:math><tex-math id="inft256">\begin{document}$i$\end{document}</tex-math></alternatives></inline-formula> on the one-step dynamics of the entire system (<xref ref-type="bibr" rid="bib13">Eichler, 2005</xref>; <xref ref-type="bibr" rid="bib58">Smith et al., 2010</xref>); the remaining terms capture the effect of the external inputs and the bias term on the one-step dynamics of the <inline-formula><alternatives><mml:math id="inf257"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>i</mml:mi><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft257">\begin{document}$i{\text{th}}$\end{document}</tex-math></alternatives></inline-formula> ROI.</p><p>After computing <inline-formula><alternatives><mml:math id="inf258"><mml:msubsup><mml:mi>q</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math><tex-math id="inft258">\begin{document}$q_{t}^{i}$\end{document}</tex-math></alternatives></inline-formula> for a given run, the resultant importance time series was normalized to zero mean and unit variance.</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing – original draft</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Resources, Data curation, Supervision, Funding acquisition, Investigation, Writing – original draft, Project administration, Writing – review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>Escape Dataset: A total of 57 subjects (24 females, ages 18-54; average: 20.5, STD: 1.9) were recruited from the University of Maryland, College Park, community. All subjects had normal or corrected-to-normal vision and reported no neurological disease or current use of psychoactive drugs. They provided written informed consent before participating in the study and were paid immediately after the experiment. The study was approved by the University of Maryland, College Park, Institutional Review Board. Moving Circles Dataset: One hundred and twenty-six participants (63 females, ages 18-30 years; average: 20.87, STD: 2.56) with normal or corrected-to-normal vision and no reported neurological or psychiatric disease were recruited from the University of Maryland community. The project was approved by the University of Maryland College Park Institutional Review Board and all participants provided written informed consent before participation.</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-102539-mdarchecklist1-v1.pdf" mimetype="application" mime-subtype="pdf"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>All data and code for the analyses presented in this paper are openly accessible at <ext-link ext-link-type="uri" xlink:href="https://github.com/codejoydo/moving_circles_SLDS">https://github.com/codejoydo/moving_circles_SLDS</ext-link>, (copy archived at <xref ref-type="bibr" rid="bib41">Misra, 2025</xref>).</p></sec><ack id="ack"><title>Acknowledgements</title><p>This research was supported by the National Institute of Mental Health (R01-MH-071589). We thank Xiaoyu Zhou for discussions about the statistical approach developed in the paper.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ackerson</surname><given-names>G</given-names></name><name><surname>Fu</surname><given-names>K</given-names></name></person-group><year iso-8601-date="1970">1970</year><article-title>On state estimation in switching environments</article-title><source>IEEE Transactions on Automatic Control</source><volume>15</volume><fpage>10</fpage><lpage>17</lpage><pub-id pub-id-type="doi">10.1109/TAC.1970.1099359</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alvarez</surname><given-names>RP</given-names></name><name><surname>Chen</surname><given-names>G</given-names></name><name><surname>Bodurka</surname><given-names>J</given-names></name><name><surname>Kaplan</surname><given-names>R</given-names></name><name><surname>Grillon</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Phasic and sustained fear in humans elicits distinct patterns of brain activity</article-title><source>NeuroImage</source><volume>55</volume><fpage>389</fpage><lpage>400</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2010.11.057</pub-id><pub-id pub-id-type="pmid">21111828</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anderson</surname><given-names>JR</given-names></name><name><surname>Fincham</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Discovering the sequential structure of thought</article-title><source>Cognitive Science</source><volume>38</volume><fpage>322</fpage><lpage>352</lpage><pub-id pub-id-type="doi">10.1111/cogs.12068</pub-id><pub-id pub-id-type="pmid">23941168</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bagi</surname><given-names>B</given-names></name><name><surname>Brecht</surname><given-names>M</given-names></name><name><surname>Sanguinetti-Scheck</surname><given-names>JI</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Unsupervised discovery of behaviorally relevant brain states in rats playing hide-and-seek</article-title><source>Current Biology</source><volume>32</volume><fpage>2640</fpage><lpage>2653</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2022.04.068</pub-id><pub-id pub-id-type="pmid">35588745</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baldassano</surname><given-names>C</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Zadbood</surname><given-names>A</given-names></name><name><surname>Pillow</surname><given-names>JW</given-names></name><name><surname>Hasson</surname><given-names>U</given-names></name><name><surname>Norman</surname><given-names>KA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Discovering event structure in continuous narrative perception and memory</article-title><source>Neuron</source><volume>95</volume><fpage>709</fpage><lpage>721</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.06.041</pub-id><pub-id pub-id-type="pmid">28772125</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barber</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Expectation correction for smoothed inference in switching linear dynamical systems</article-title><source>Journal of Machine Learning Research</source><volume>7</volume><fpage>2515</fpage><lpage>2540</lpage></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boynton</surname><given-names>GM</given-names></name><name><surname>Engel</surname><given-names>SA</given-names></name><name><surname>Glover</surname><given-names>GH</given-names></name><name><surname>Heeger</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Linear systems analysis of functional magnetic resonance imaging in human V1</article-title><source>The Journal of Neuroscience</source><volume>16</volume><fpage>4207</fpage><lpage>4221</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.16-13-04207.1996</pub-id><pub-id pub-id-type="pmid">8753882</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buonomano</surname><given-names>DV</given-names></name><name><surname>Maass</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>State-dependent computations: spatiotemporal processing in cortical networks</article-title><source>Nature Reviews. Neuroscience</source><volume>10</volume><fpage>113</fpage><lpage>125</lpage><pub-id pub-id-type="doi">10.1038/nrn2558</pub-id><pub-id pub-id-type="pmid">19145235</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>R</given-names></name><name><surname>Singh</surname><given-names>M</given-names></name><name><surname>Braver</surname><given-names>TS</given-names></name><name><surname>Ching</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Dynamical models reveal anatomically reliable attractor landscapes embedded in resting state brain networks</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2024.01.15.575745</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davis</surname><given-names>M</given-names></name><name><surname>Walker</surname><given-names>DL</given-names></name><name><surname>Miles</surname><given-names>L</given-names></name><name><surname>Grillon</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Phasic vs sustained fear in rats and humans: role of the extended amygdala in fear vs anxiety</article-title><source>Neuropsychopharmacology</source><volume>35</volume><fpage>105</fpage><lpage>135</lpage><pub-id pub-id-type="doi">10.1038/npp.2009.109</pub-id><pub-id pub-id-type="pmid">19693004</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deco</surname><given-names>G</given-names></name><name><surname>Jirsa</surname><given-names>VK</given-names></name><name><surname>Robinson</surname><given-names>PA</given-names></name><name><surname>Breakspear</surname><given-names>M</given-names></name><name><surname>Friston</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>The dynamic brain: from spiking neurons to neural masses and cortical fields</article-title><source>PLOS Computational Biology</source><volume>4</volume><elocation-id>e1000092</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000092</pub-id><pub-id pub-id-type="pmid">18769680</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Efron</surname><given-names>B</given-names></name><name><surname>Tibshirani</surname><given-names>RJ</given-names></name></person-group><year iso-8601-date="1994">1994</year><source>An Introduction to the Bootstrap</source><publisher-name>Chapman and Hall/CRC</publisher-name><pub-id pub-id-type="doi">10.1201/9780429246593</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eichler</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>A graphical approach for evaluating effective connectivity in neural systems</article-title><source>Philosophical Transactions of the Royal Society B</source><volume>360</volume><fpage>953</fpage><lpage>967</lpage><pub-id pub-id-type="doi">10.1098/rstb.2005.1641</pub-id><pub-id pub-id-type="pmid">16087440</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Evans</surname><given-names>DA</given-names></name><name><surname>Stempel</surname><given-names>AV</given-names></name><name><surname>Vale</surname><given-names>R</given-names></name><name><surname>Branco</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Cognitive control of escape behaviour</article-title><source>Trends in Cognitive Sciences</source><volume>23</volume><fpage>334</fpage><lpage>348</lpage><pub-id pub-id-type="doi">10.1016/j.tics.2019.01.012</pub-id><pub-id pub-id-type="pmid">30852123</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Fanselow</surname><given-names>MS</given-names></name><name><surname>Lester</surname><given-names>LS</given-names></name></person-group><year iso-8601-date="1987">1987</year><chapter-title>A functional behavioristic approach to aversively motivated behavior:: predatory imminence as a determinant of the topography of defensive behavior</chapter-title><person-group person-group-type="editor"><name><surname>Beecher</surname><given-names>MD</given-names></name></person-group><source>Evolution and Learning</source><publisher-name>Psychology Press</publisher-name><fpage>185</fpage><lpage>211</lpage></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Finn</surname><given-names>ES</given-names></name><name><surname>Glerean</surname><given-names>E</given-names></name><name><surname>Khojandi</surname><given-names>AY</given-names></name><name><surname>Nielson</surname><given-names>D</given-names></name><name><surname>Molfese</surname><given-names>PJ</given-names></name><name><surname>Handwerker</surname><given-names>DA</given-names></name><name><surname>Bandettini</surname><given-names>PA</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Idiosynchrony: from shared responses to individual differences during naturalistic neuroimaging</article-title><source>NeuroImage</source><volume>215</volume><elocation-id>116828</elocation-id><pub-id pub-id-type="doi">10.1016/j.neuroimage.2020.116828</pub-id><pub-id pub-id-type="pmid">32276065</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Fox</surname><given-names>E</given-names></name><name><surname>Sudderth</surname><given-names>E</given-names></name><name><surname>Jordan</surname><given-names>M</given-names></name><name><surname>Willsky</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Nonparametric bayesian learning of switching linear dynamical systems</article-title><conf-name>Advances in Neural Information Processing Systems</conf-name></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friston</surname><given-names>KJ</given-names></name><name><surname>Worsley</surname><given-names>KJ</given-names></name><name><surname>Frackowiak</surname><given-names>RSJ</given-names></name><name><surname>Mazziotta</surname><given-names>JC</given-names></name><name><surname>Evans</surname><given-names>AC</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Assessing the significance of focal activations using their spatial extent</article-title><source>Human Brain Mapping</source><volume>1</volume><fpage>210</fpage><lpage>220</lpage><pub-id pub-id-type="doi">10.1002/hbm.460010306</pub-id><pub-id pub-id-type="pmid">24578041</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fullana</surname><given-names>MA</given-names></name><name><surname>Harrison</surname><given-names>BJ</given-names></name><name><surname>Soriano-Mas</surname><given-names>C</given-names></name><name><surname>Vervliet</surname><given-names>B</given-names></name><name><surname>Cardoner</surname><given-names>N</given-names></name><name><surname>Àvila-Parcet</surname><given-names>A</given-names></name><name><surname>Radua</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Neural signatures of human fear conditioning: an updated and extended meta-analysis of fMRI studies</article-title><source>Molecular Psychiatry</source><volume>21</volume><fpage>500</fpage><lpage>508</lpage><pub-id pub-id-type="doi">10.1038/mp.2015.88</pub-id><pub-id pub-id-type="pmid">26122585</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Glaser</surname><given-names>JI</given-names></name><name><surname>Whiteway</surname><given-names>M</given-names></name><name><surname>Cunningham</surname><given-names>JP</given-names></name><name><surname>Paninski</surname><given-names>L</given-names></name><name><surname>Linderman</surname><given-names>SW</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Recurrent switching dynamical systems models for multiple interacting neural populations</article-title><conf-name>Advances in Neural Information Processing Systems</conf-name><fpage>14867</fpage><lpage>14878</lpage><pub-id pub-id-type="doi">10.1101/2020.10.21.349282</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gothard</surname><given-names>KM</given-names></name><name><surname>Mosher</surname><given-names>CP</given-names></name><name><surname>Zimmerman</surname><given-names>PE</given-names></name><name><surname>Putnam</surname><given-names>PT</given-names></name><name><surname>Morrow</surname><given-names>JK</given-names></name><name><surname>Fuglevand</surname><given-names>AJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>New perspectives on the neurophysiology of primate amygdala emerging from the study of naturalistic social behaviors</article-title><source>WIREs Cognitive Science</source><volume>9</volume><elocation-id>e1449</elocation-id><pub-id pub-id-type="doi">10.1002/wcs.1449</pub-id><pub-id pub-id-type="pmid">28800678</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grall</surname><given-names>C</given-names></name><name><surname>Finn</surname><given-names>ES</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Leveraging the power of media to drive cognition: a media-informed approach to naturalistic neuroscience</article-title><source>Social Cognitive and Affective Neuroscience</source><volume>17</volume><fpage>598</fpage><lpage>608</lpage><pub-id pub-id-type="doi">10.1093/scan/nsac019</pub-id><pub-id pub-id-type="pmid">35257180</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greene</surname><given-names>AS</given-names></name><name><surname>Horien</surname><given-names>C</given-names></name><name><surname>Barson</surname><given-names>D</given-names></name><name><surname>Scheinost</surname><given-names>D</given-names></name><name><surname>Constable</surname><given-names>RT</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Why is everyone talking about brain state?</article-title><source>Trends in Neurosciences</source><volume>46</volume><fpage>508</fpage><lpage>524</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2023.04.001</pub-id><pub-id pub-id-type="pmid">37164869</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grupe</surname><given-names>DW</given-names></name><name><surname>Nitschke</surname><given-names>JB</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Uncertainty and anticipation in anxiety: an integrated neurobiological and psychological perspective</article-title><source>Nature Reviews. Neuroscience</source><volume>14</volume><fpage>488</fpage><lpage>501</lpage><pub-id pub-id-type="doi">10.1038/nrn3524</pub-id><pub-id pub-id-type="pmid">23783199</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hasson</surname><given-names>U</given-names></name><name><surname>Honey</surname><given-names>CJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Future trends in neuroimaging: neural processes as expressed within real-life contexts</article-title><source>NeuroImage</source><volume>62</volume><fpage>1272</fpage><lpage>1278</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2012.02.004</pub-id><pub-id pub-id-type="pmid">22348879</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hunt</surname><given-names>LT</given-names></name><name><surname>Daw</surname><given-names>ND</given-names></name><name><surname>Kaanders</surname><given-names>P</given-names></name><name><surname>MacIver</surname><given-names>MA</given-names></name><name><surname>Mugan</surname><given-names>U</given-names></name><name><surname>Procyk</surname><given-names>E</given-names></name><name><surname>Redish</surname><given-names>AD</given-names></name><name><surname>Russo</surname><given-names>E</given-names></name><name><surname>Scholl</surname><given-names>J</given-names></name><name><surname>Stachenfeld</surname><given-names>K</given-names></name><name><surname>Wilson</surname><given-names>CRE</given-names></name><name><surname>Kolling</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Formalizing planning and information search in naturalistic decision-making</article-title><source>Nature Neuroscience</source><volume>24</volume><fpage>1051</fpage><lpage>1064</lpage><pub-id pub-id-type="doi">10.1038/s41593-021-00866-w</pub-id><pub-id pub-id-type="pmid">34155400</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hur</surname><given-names>J</given-names></name><name><surname>Smith</surname><given-names>JF</given-names></name><name><surname>DeYoung</surname><given-names>KA</given-names></name><name><surname>Anderson</surname><given-names>AS</given-names></name><name><surname>Kuang</surname><given-names>J</given-names></name><name><surname>Kim</surname><given-names>HC</given-names></name><name><surname>Tillman</surname><given-names>RM</given-names></name><name><surname>Kuhn</surname><given-names>M</given-names></name><name><surname>Fox</surname><given-names>AS</given-names></name><name><surname>Shackman</surname><given-names>AJ</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Anxiety and the neurobiology of temporally uncertain threat anticipation</article-title><source>The Journal of Neuroscience</source><volume>40</volume><fpage>7949</fpage><lpage>7964</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0704-20.2020</pub-id><pub-id pub-id-type="pmid">32958570</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>John</surname><given-names>YJ</given-names></name><name><surname>Sawyer</surname><given-names>KS</given-names></name><name><surname>Srinivasan</surname><given-names>K</given-names></name><name><surname>Müller</surname><given-names>EJ</given-names></name><name><surname>Munn</surname><given-names>BR</given-names></name><name><surname>Shine</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>It’s about time: linking dynamical systems with human neuroimaging to understand the brain</article-title><source>Network Neuroscience</source><volume>6</volume><fpage>960</fpage><lpage>979</lpage><pub-id pub-id-type="doi">10.1162/netn_a_00230</pub-id><pub-id pub-id-type="pmid">36875012</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khona</surname><given-names>M</given-names></name><name><surname>Fiete</surname><given-names>IR</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Attractor and integrator networks in the brain</article-title><source>Nature Reviews. Neuroscience</source><volume>23</volume><fpage>744</fpage><lpage>766</lpage><pub-id pub-id-type="doi">10.1038/s41583-022-00642-0</pub-id><pub-id pub-id-type="pmid">36329249</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Kingma</surname><given-names>DP</given-names></name><name><surname>Welling</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Auto-encoding variational bayes</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1312.6114">https://arxiv.org/abs/1312.6114</ext-link></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuhn</surname><given-names>HW</given-names></name></person-group><year iso-8601-date="1955">1955</year><article-title>The Hungarian method for the assignment problem</article-title><source>Naval Research Logistics Quarterly</source><volume>2</volume><fpage>83</fpage><lpage>97</lpage><pub-id pub-id-type="doi">10.1002/nav.3800020109</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee Masson</surname><given-names>H</given-names></name><name><surname>Isik</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Functional selectivity for social interaction perception in the human superior temporal sulcus during natural viewing</article-title><source>NeuroImage</source><volume>245</volume><elocation-id>118741</elocation-id><pub-id pub-id-type="doi">10.1016/j.neuroimage.2021.118741</pub-id><pub-id pub-id-type="pmid">34800663</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levitas</surname><given-names>DJ</given-names></name><name><surname>James</surname><given-names>TW</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Dynamic threat-reward neural processing under semi-naturalistic ecologically relevant scenarios</article-title><source>Human Brain Mapping</source><volume>45</volume><elocation-id>e26648</elocation-id><pub-id pub-id-type="doi">10.1002/hbm.26648</pub-id><pub-id pub-id-type="pmid">38445552</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Limbachia</surname><given-names>C</given-names></name><name><surname>Morrow</surname><given-names>K</given-names></name><name><surname>Khibovska</surname><given-names>A</given-names></name><name><surname>Meyer</surname><given-names>C</given-names></name><name><surname>Padmala</surname><given-names>S</given-names></name><name><surname>Pessoa</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Controllability over stressor decreases responses in key threat-related brain areas</article-title><source>Communications Biology</source><volume>4</volume><elocation-id>42</elocation-id><pub-id pub-id-type="doi">10.1038/s42003-020-01537-5</pub-id><pub-id pub-id-type="pmid">33402686</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Linderman</surname><given-names>SW</given-names></name><name><surname>Miller</surname><given-names>AC</given-names></name><name><surname>Adams</surname><given-names>RP</given-names></name><name><surname>Blei</surname><given-names>DM</given-names></name><name><surname>Paninski</surname><given-names>L</given-names></name><name><surname>Johnson</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Recurrent Switching Linear Dynamical Systems</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1610.08466">http://arxiv.org/abs/1610.08466</ext-link></element-citation></ref><ref id="bib36"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Linderman</surname><given-names>S</given-names></name><name><surname>Nichols</surname><given-names>A</given-names></name><name><surname>Blei</surname><given-names>D</given-names></name><name><surname>Zimmer</surname><given-names>M</given-names></name><name><surname>Paninski</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Hierarchical recurrent state space models reveal discrete and continuous dynamics of neural activity in <italic>C. elegans</italic></article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/621540</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Linderman</surname><given-names>S</given-names></name><name><surname>Antin</surname><given-names>B</given-names></name><name><surname>Zoltowski</surname><given-names>D</given-names></name><name><surname>DuPre</surname><given-names>E</given-names></name><collab>jglaser2</collab></person-group><year iso-8601-date="2025">2025</year><data-title>SSM: bayesian learning and inference for state space models</data-title><version designator="swh:1:rev:6c856ad3967941d176eb348bcd490cfaaa08ba60">swh:1:rev:6c856ad3967941d176eb348bcd490cfaaa08ba60</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:1b81e649ced07d119b65afa46d5119a6c9ef27a4;origin=https://github.com/lindermanlab/ssm;visit=swh:1:snp:c76205c06d1ebcd51e19e8197dda0b4882508237;anchor=swh:1:rev:6c856ad3967941d176eb348bcd490cfaaa08ba60">https://archive.softwareheritage.org/swh:1:dir:1b81e649ced07d119b65afa46d5119a6c9ef27a4;origin=https://github.com/lindermanlab/ssm;visit=swh:1:snp:c76205c06d1ebcd51e19e8197dda0b4882508237;anchor=swh:1:rev:6c856ad3967941d176eb348bcd490cfaaa08ba60</ext-link></element-citation></ref><ref id="bib38"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Luenberger</surname><given-names>DG</given-names></name></person-group><year iso-8601-date="1979">1979</year><source>Introduction to Dynamic Systems: Theory, Models, and Applications</source><publisher-name>Wiley</publisher-name></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meyer</surname><given-names>C</given-names></name><name><surname>Padmala</surname><given-names>S</given-names></name><name><surname>Pessoa</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Dynamic threat processing</article-title><source>Journal of Cognitive Neuroscience</source><volume>31</volume><fpage>522</fpage><lpage>542</lpage><pub-id pub-id-type="doi">10.1162/jocn_a_01363</pub-id><pub-id pub-id-type="pmid">30513044</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miller</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Itinerancy between attractor states in neural systems</article-title><source>Current Opinion in Neurobiology</source><volume>40</volume><fpage>14</fpage><lpage>22</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2016.05.005</pub-id><pub-id pub-id-type="pmid">27318972</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Misra</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2025">2025</year><data-title>Moving_circles_SLDS</data-title><version designator="swh:1:rev:48943e22a23d7b2505c4b863c22a87d9cc26ed02">swh:1:rev:48943e22a23d7b2505c4b863c22a87d9cc26ed02</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:eb5cdfc8202c45c672c10c68f9afef806cfaeb2a;origin=https://github.com/codejoydo/moving_circles_SLDS;visit=swh:1:snp:bafe1d7be5b92e0923339be09ff6c14623b7f360;anchor=swh:1:rev:48943e22a23d7b2505c4b863c22a87d9cc26ed02">https://archive.softwareheritage.org/swh:1:dir:eb5cdfc8202c45c672c10c68f9afef806cfaeb2a;origin=https://github.com/codejoydo/moving_circles_SLDS;visit=swh:1:snp:bafe1d7be5b92e0923339be09ff6c14623b7f360;anchor=swh:1:rev:48943e22a23d7b2505c4b863c22a87d9cc26ed02</ext-link></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mobbs</surname><given-names>D</given-names></name><name><surname>Petrovic</surname><given-names>P</given-names></name><name><surname>Marchant</surname><given-names>JL</given-names></name><name><surname>Hassabis</surname><given-names>D</given-names></name><name><surname>Weiskopf</surname><given-names>N</given-names></name><name><surname>Seymour</surname><given-names>B</given-names></name><name><surname>Dolan</surname><given-names>RJ</given-names></name><name><surname>Frith</surname><given-names>CD</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>When fear is near: threat imminence elicits prefrontal-periaqueductal gray shifts in humans</article-title><source>Science</source><volume>317</volume><fpage>1079</fpage><lpage>1083</lpage><pub-id pub-id-type="doi">10.1126/science.1144298</pub-id><pub-id pub-id-type="pmid">17717184</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mobbs</surname><given-names>D</given-names></name><name><surname>Marchant</surname><given-names>JL</given-names></name><name><surname>Hassabis</surname><given-names>D</given-names></name><name><surname>Seymour</surname><given-names>B</given-names></name><name><surname>Tan</surname><given-names>G</given-names></name><name><surname>Gray</surname><given-names>M</given-names></name><name><surname>Petrovic</surname><given-names>P</given-names></name><name><surname>Dolan</surname><given-names>RJ</given-names></name><name><surname>Frith</surname><given-names>CD</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>From threat to fear: the neural organization of defensive fear systems in humans</article-title><source>The Journal of Neuroscience</source><volume>29</volume><fpage>12236</fpage><lpage>12243</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2378-09.2009</pub-id><pub-id pub-id-type="pmid">19793982</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mobbs</surname><given-names>D</given-names></name><name><surname>Yu</surname><given-names>R</given-names></name><name><surname>Rowe</surname><given-names>JB</given-names></name><name><surname>Eich</surname><given-names>H</given-names></name><name><surname>FeldmanHall</surname><given-names>O</given-names></name><name><surname>Dalgleish</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Neural activity associated with monitoring the oscillating threat value of a tarantula</article-title><source>PNAS</source><volume>107</volume><fpage>20582</fpage><lpage>20586</lpage><pub-id pub-id-type="doi">10.1073/pnas.1009076107</pub-id><pub-id pub-id-type="pmid">21059963</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mobbs</surname><given-names>D</given-names></name><name><surname>Trimmer</surname><given-names>PC</given-names></name><name><surname>Blumstein</surname><given-names>DT</given-names></name><name><surname>Dayan</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Foraging for foundations in decision neuroscience: insights from ethology</article-title><source>Nature Reviews. Neuroscience</source><volume>19</volume><fpage>419</fpage><lpage>427</lpage><pub-id pub-id-type="doi">10.1038/s41583-018-0010-7</pub-id><pub-id pub-id-type="pmid">29752468</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morioka</surname><given-names>H</given-names></name><name><surname>Calhoun</surname><given-names>V</given-names></name><name><surname>Hyvärinen</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Nonlinear ICA of fMRI reveals primitive temporal structures linked to rest, task, and behavioral traits</article-title><source>NeuroImage</source><volume>218</volume><elocation-id>116989</elocation-id><pub-id pub-id-type="doi">10.1016/j.neuroimage.2020.116989</pub-id><pub-id pub-id-type="pmid">32485305</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murty</surname><given-names>DVPS</given-names></name><name><surname>Song</surname><given-names>S</given-names></name><name><surname>Morrow</surname><given-names>K</given-names></name><name><surname>Kim</surname><given-names>J</given-names></name><name><surname>Hu</surname><given-names>K</given-names></name><name><surname>Pessoa</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Distributed and multifaceted effects of threat and safety</article-title><source>Journal of Cognitive Neuroscience</source><volume>34</volume><fpage>495</fpage><lpage>516</lpage><pub-id pub-id-type="doi">10.1162/jocn_a_01807</pub-id><pub-id pub-id-type="pmid">34942650</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murty</surname><given-names>DVPS</given-names></name><name><surname>Song</surname><given-names>S</given-names></name><name><surname>Surampudi</surname><given-names>SG</given-names></name><name><surname>Pessoa</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Threat and reward imminence processing in the human brain</article-title><source>The Journal of Neuroscience</source><volume>43</volume><fpage>2973</fpage><lpage>2987</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1778-22.2023</pub-id><pub-id pub-id-type="pmid">36927571</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pandarinath</surname><given-names>C</given-names></name><name><surname>O’Shea</surname><given-names>DJ</given-names></name><name><surname>Collins</surname><given-names>J</given-names></name><name><surname>Jozefowicz</surname><given-names>R</given-names></name><name><surname>Stavisky</surname><given-names>SD</given-names></name><name><surname>Kao</surname><given-names>JC</given-names></name><name><surname>Trautmann</surname><given-names>EM</given-names></name><name><surname>Kaufman</surname><given-names>MT</given-names></name><name><surname>Ryu</surname><given-names>SI</given-names></name><name><surname>Hochberg</surname><given-names>LR</given-names></name><name><surname>Henderson</surname><given-names>JM</given-names></name><name><surname>Shenoy</surname><given-names>KV</given-names></name><name><surname>Abbott</surname><given-names>LF</given-names></name><name><surname>Sussillo</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Inferring single-trial neural population dynamics using sequential auto-encoders</article-title><source>Nature Methods</source><volume>15</volume><fpage>805</fpage><lpage>815</lpage><pub-id pub-id-type="doi">10.1038/s41592-018-0109-9</pub-id><pub-id pub-id-type="pmid">30224673</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Petreska</surname><given-names>B</given-names></name><name><surname>Yu</surname><given-names>BM</given-names></name><name><surname>Cunningham</surname><given-names>JP</given-names></name><name><surname>Santhanam</surname><given-names>G</given-names></name><name><surname>Ryu</surname><given-names>S</given-names></name><name><surname>Shenoy</surname><given-names>KV</given-names></name><name><surname>Sahani</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Dynamical segmentation of single trials from population neural data</article-title><conf-name>Advances in Neural Information Processing Systems 24</conf-name></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Remington</surname><given-names>ED</given-names></name><name><surname>Egger</surname><given-names>SW</given-names></name><name><surname>Narain</surname><given-names>D</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Jazayeri</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A dynamical systems perspective on flexible motor timing</article-title><source>Trends in Cognitive Sciences</source><volume>22</volume><fpage>938</fpage><lpage>952</lpage><pub-id pub-id-type="doi">10.1016/j.tics.2018.07.010</pub-id><pub-id pub-id-type="pmid">30266152</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>RC</given-names></name></person-group><year iso-8601-date="2012">2012</year><source>An Introduction to Dynamical Systems: Continuous and Discrete</source><publisher-name>American Mathematical Soc</publisher-name></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robson</surname><given-names>DN</given-names></name><name><surname>Li</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>A dynamical systems view of neuroethology: uncovering stateful computation in natural behaviors</article-title><source>Current Opinion in Neurobiology</source><volume>73</volume><elocation-id>102517</elocation-id><pub-id pub-id-type="doi">10.1016/j.conb.2022.01.002</pub-id><pub-id pub-id-type="pmid">35217311</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schaefer</surname><given-names>A</given-names></name><name><surname>Kong</surname><given-names>R</given-names></name><name><surname>Gordon</surname><given-names>EM</given-names></name><name><surname>Laumann</surname><given-names>TO</given-names></name><name><surname>Zuo</surname><given-names>XN</given-names></name><name><surname>Holmes</surname><given-names>AJ</given-names></name><name><surname>Eickhoff</surname><given-names>SB</given-names></name><name><surname>Yeo</surname><given-names>BTT</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Local-global parcellation of the human cerebral cortex from intrinsic functional connectivity MRI</article-title><source>Cerebral Cortex</source><volume>28</volume><fpage>3095</fpage><lpage>3114</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhx179</pub-id><pub-id pub-id-type="pmid">28981612</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schiller</surname><given-names>D</given-names></name><name><surname>Levy</surname><given-names>I</given-names></name><name><surname>Niv</surname><given-names>Y</given-names></name><name><surname>LeDoux</surname><given-names>JE</given-names></name><name><surname>Phelps</surname><given-names>EA</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>From fear to safety and back: reversal of fear in the human brain</article-title><source>The Journal of Neuroscience</source><volume>28</volume><fpage>11517</fpage><lpage>11525</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2265-08.2008</pub-id><pub-id pub-id-type="pmid">18987188</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shenoy</surname><given-names>KV</given-names></name><name><surname>Sahani</surname><given-names>M</given-names></name><name><surname>Churchland</surname><given-names>MM</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Cortical control of arm movements: a dynamical systems perspective</article-title><source>Annual Review of Neuroscience</source><volume>36</volume><fpage>337</fpage><lpage>359</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-062111-150509</pub-id><pub-id pub-id-type="pmid">23725001</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Singh</surname><given-names>MF</given-names></name><name><surname>Wang</surname><given-names>A</given-names></name><name><surname>Cole</surname><given-names>M</given-names></name><name><surname>Ching</surname><given-names>S</given-names></name><name><surname>Braver</surname><given-names>TS</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Enhancing task fMRI preprocessing via individualized model-based filtering of intrinsic activity dynamics</article-title><source>NeuroImage</source><volume>247</volume><elocation-id>118836</elocation-id><pub-id pub-id-type="doi">10.1016/j.neuroimage.2021.118836</pub-id><pub-id pub-id-type="pmid">34942364</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>JF</given-names></name><name><surname>Pillai</surname><given-names>A</given-names></name><name><surname>Chen</surname><given-names>K</given-names></name><name><surname>Horwitz</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Identification and validation of effective connectivity networks in functional magnetic resonance imaging using switching linear dynamic systems</article-title><source>NeuroImage</source><volume>52</volume><fpage>1027</fpage><lpage>1040</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2009.11.081</pub-id><pub-id pub-id-type="pmid">19969092</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Somerville</surname><given-names>LH</given-names></name><name><surname>Wagner</surname><given-names>DD</given-names></name><name><surname>Wig</surname><given-names>GS</given-names></name><name><surname>Moran</surname><given-names>JM</given-names></name><name><surname>Whalen</surname><given-names>PJ</given-names></name><name><surname>Kelley</surname><given-names>WM</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Interactions between transient and sustained neural signals support the generation and regulation of anxious emotion</article-title><source>Cerebral Cortex</source><volume>23</volume><fpage>49</fpage><lpage>60</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhr373</pub-id><pub-id pub-id-type="pmid">22250290</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>H</given-names></name><name><surname>Park</surname><given-names>BY</given-names></name><name><surname>Park</surname><given-names>H</given-names></name><name><surname>Shim</surname><given-names>WM</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Cognitive and neural state dynamics of narrative comprehension</article-title><source>The Journal of Neuroscience</source><volume>41</volume><fpage>8972</fpage><lpage>8990</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0037-21.2021</pub-id><pub-id pub-id-type="pmid">34531284</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>H</given-names></name><name><surname>Shim</surname><given-names>WM</given-names></name><name><surname>Rosenberg</surname><given-names>MD</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Large-scale neural dynamics in a shared low-dimensional state space reflect cognitive and attentional dynamics</article-title><source>eLife</source><volume>12</volume><elocation-id>e85487</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.85487</pub-id><pub-id pub-id-type="pmid">37395724</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sonkusare</surname><given-names>S</given-names></name><name><surname>Breakspear</surname><given-names>M</given-names></name><name><surname>Guo</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Naturalistic stimuli in neuroscience: critically acclaimed</article-title><source>Trends in Cognitive Sciences</source><volume>23</volume><fpage>699</fpage><lpage>714</lpage><pub-id pub-id-type="doi">10.1016/j.tics.2019.05.004</pub-id><pub-id pub-id-type="pmid">31257145</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taghia</surname><given-names>J</given-names></name><name><surname>Ryali</surname><given-names>S</given-names></name><name><surname>Chen</surname><given-names>T</given-names></name><name><surname>Supekar</surname><given-names>K</given-names></name><name><surname>Cai</surname><given-names>W</given-names></name><name><surname>Menon</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Bayesian switching factor analysis for estimating time-varying functional connectivity in fMRI</article-title><source>NeuroImage</source><volume>155</volume><fpage>271</fpage><lpage>290</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2017.02.083</pub-id><pub-id pub-id-type="pmid">28267626</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taghia</surname><given-names>J</given-names></name><name><surname>Cai</surname><given-names>W</given-names></name><name><surname>Ryali</surname><given-names>S</given-names></name><name><surname>Kochalka</surname><given-names>J</given-names></name><name><surname>Nicholas</surname><given-names>J</given-names></name><name><surname>Chen</surname><given-names>T</given-names></name><name><surname>Menon</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Uncovering hidden brain state dynamics that regulate performance and decision-making during cognition</article-title><source>Nature Communications</source><volume>9</volume><elocation-id>2505</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-04723-6</pub-id><pub-id pub-id-type="pmid">29950686</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Testard</surname><given-names>C</given-names></name><name><surname>Tremblay</surname><given-names>S</given-names></name><name><surname>Parodi</surname><given-names>F</given-names></name><name><surname>DiTullio</surname><given-names>RW</given-names></name><name><surname>Acevedo-Ithier</surname><given-names>A</given-names></name><name><surname>Gardiner</surname><given-names>KL</given-names></name><name><surname>Kording</surname><given-names>K</given-names></name><name><surname>Platt</surname><given-names>ML</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Neural signatures of natural behaviour in socializing macaques</article-title><source>Nature</source><volume>628</volume><fpage>381</fpage><lpage>390</lpage><pub-id pub-id-type="doi">10.1038/s41586-024-07178-6</pub-id><pub-id pub-id-type="pmid">38480888</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Townsend</surname><given-names>RG</given-names></name><name><surname>Gong</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Detection and analysis of spatiotemporal patterns in brain activity</article-title><source>PLOS Computational Biology</source><volume>14</volume><elocation-id>e1006643</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006643</pub-id><pub-id pub-id-type="pmid">30507937</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ulrike von</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Clustering stability: an overview</article-title><source>Foundations and Trends in Machine Learning</source><volume>2</volume><fpage>236</fpage><lpage>272</lpage><pub-id pub-id-type="doi">10.1561/2200000008</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vahidi</surname><given-names>P</given-names></name><name><surname>Sani</surname><given-names>OG</given-names></name><name><surname>Shanechi</surname><given-names>MM</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Modeling and dissociation of intrinsic and input-driven neural population dynamics underlying behavior</article-title><source>PNAS</source><volume>121</volume><elocation-id>e2212887121</elocation-id><pub-id pub-id-type="doi">10.1073/pnas.2212887121</pub-id><pub-id pub-id-type="pmid">36993213</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van de Meer</surname><given-names>J</given-names></name><name><surname>Breakspear</surname><given-names>M</given-names></name><name><surname>Chang</surname><given-names>LJ</given-names></name><name><surname>Sonkusare</surname><given-names>S</given-names></name><name><surname>Cocchi</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Movie viewing elicits rich and reliable brain state dynamics</article-title><source>Nature Communications</source><volume>11</volume><elocation-id>18717-w</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-020-18717-w</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vidaurre</surname><given-names>D</given-names></name><name><surname>Quinn</surname><given-names>AJ</given-names></name><name><surname>Baker</surname><given-names>AP</given-names></name><name><surname>Dupret</surname><given-names>D</given-names></name><name><surname>Tejero-Cantero</surname><given-names>A</given-names></name><name><surname>Woolrich</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Spectrally resolved fast transient brain states in electrophysiological data</article-title><source>NeuroImage</source><volume>126</volume><fpage>81</fpage><lpage>95</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2015.11.047</pub-id><pub-id pub-id-type="pmid">26631815</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vidaurre</surname><given-names>D</given-names></name><name><surname>Abeysuriya</surname><given-names>R</given-names></name><name><surname>Becker</surname><given-names>R</given-names></name><name><surname>Quinn</surname><given-names>AJ</given-names></name><name><surname>Alfaro-Almagro</surname><given-names>F</given-names></name><name><surname>Smith</surname><given-names>SM</given-names></name><name><surname>Woolrich</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Discovering dynamic brain networks from big data in rest and task</article-title><source>NeuroImage</source><volume>180</volume><fpage>646</fpage><lpage>656</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2017.06.077</pub-id><pub-id pub-id-type="pmid">28669905</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Williams</surname><given-names>JA</given-names></name><name><surname>Margulis</surname><given-names>EH</given-names></name><name><surname>Nastase</surname><given-names>SA</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Hasson</surname><given-names>U</given-names></name><name><surname>Norman</surname><given-names>KA</given-names></name><name><surname>Baldassano</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>High-order areas and auditory cortex both represent the high-level event structure of music</article-title><source>Journal of Cognitive Neuroscience</source><volume>34</volume><fpage>699</fpage><lpage>714</lpage><pub-id pub-id-type="doi">10.1162/jocn_a_01815</pub-id><pub-id pub-id-type="pmid">35015874</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>L</given-names></name><name><surname>Caprihan</surname><given-names>A</given-names></name><name><surname>Calhoun</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Tracking spatial dynamics of functional connectivity during a task</article-title><source>NeuroImage</source><volume>239</volume><elocation-id>118310</elocation-id><pub-id pub-id-type="doi">10.1016/j.neuroimage.2021.118310</pub-id><pub-id pub-id-type="pmid">34175424</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>Y</given-names></name><name><surname>Long</surname><given-names>X</given-names></name><name><surname>Feng</surname><given-names>J</given-names></name><name><surname>Gong</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Interacting spiral wave patterns underlie complex brain dynamics and are related to cognitive processing</article-title><source>Nature Human Behaviour</source><volume>7</volume><fpage>1196</fpage><lpage>1215</lpage><pub-id pub-id-type="doi">10.1038/s41562-023-01626-5</pub-id><pub-id pub-id-type="pmid">37322235</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yamashita</surname><given-names>A</given-names></name><name><surname>Rothlein</surname><given-names>D</given-names></name><name><surname>Kucyi</surname><given-names>A</given-names></name><name><surname>Valera</surname><given-names>EM</given-names></name><name><surname>Esterman</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Brain state-based detection of attentional fluctuations and their modulation</article-title><source>NeuroImage</source><volume>236</volume><elocation-id>118072</elocation-id><pub-id pub-id-type="doi">10.1016/j.neuroimage.2021.118072</pub-id><pub-id pub-id-type="pmid">33882346</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>BM</given-names></name><name><surname>Afshar</surname><given-names>A</given-names></name><name><surname>Santhanam</surname><given-names>G</given-names></name><name><surname>Ryu</surname><given-names>S</given-names></name><name><surname>Shenoy</surname><given-names>KV</given-names></name><name><surname>Sahani</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2005">2005</year><chapter-title>Extracting dynamical structure embedded in neural activity</chapter-title><person-group person-group-type="editor"><name><surname>Weiss</surname><given-names>Y</given-names></name><name><surname>Schölkopf</surname><given-names>B</given-names></name><name><surname>Platt</surname><given-names>J</given-names></name></person-group><source>Advances in Neural Information Processing Systems</source><publisher-name>MIT Press</publisher-name><fpage>1545</fpage><lpage>1552</lpage></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec sec-type="appendix" id="s8"><title>Determining the number of latent dimensions</title><p>Data from an exploratory set of participants (<italic>N</italic>=30) was used to choose the dimensionality of the latent space. To do so, we computed the evidence lower bound (ELBO) as the optimization criterion of the SLDS fits to the data (<xref ref-type="bibr" rid="bib30">Kingma and Welling, 2022</xref>; <xref ref-type="bibr" rid="bib36">Linderman et al., 2019</xref>). Intuitively, the <monospace>ELBO</monospace> is a lower bound on the log-likelihood of the observed data, therefore capturing the goodness of the model fit (i.e. the ability to explain the observed data). For each value, an SLDS model was fit on 30 leave-one-out participant samples, and the average <monospace>ELBO</monospace> value across leave-one-out samples was determined. <monospace>ELBO</monospace> values in the range were very similar according to the figure below, so we chose <italic>D</italic>=10.</p><fig id="app1fig1" position="float"><label>Appendix 1—figure 1.</label><caption><title>Model fit evidence lower bound (ELBO) criterion as a function of the number of latent dimensions determined for multiple values of the number of states (<inline-formula><alternatives><mml:math id="inf259"><mml:mi>K</mml:mi></mml:math><tex-math id="inft259">\begin{document}$K$\end{document}</tex-math></alternatives></inline-formula>).</title><p>Error bars indicate the 95% confidence interval based on standard error across leave-one-out samples.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-102539-app1-fig1-v1.tif"/></fig></sec><sec sec-type="appendix" id="s9"><title>Determining the number of states</title><p>Data from the exploratory dataset were also used to determine the number of states <inline-formula><alternatives><mml:math id="inf260"><mml:mi>K</mml:mi></mml:math><tex-math id="inft260">\begin{document}$K$\end{document}</tex-math></alternatives></inline-formula>. We investigated values from 2 to 10 and evaluated the consistency of estimated states across leave-one-participant-out folds. Specifically, we determined state sequences (one state per time step) for different <inline-formula><alternatives><mml:math id="inf261"><mml:mi>K</mml:mi></mml:math><tex-math id="inft261">\begin{document}$K$\end{document}</tex-math></alternatives></inline-formula> values. We followed the intuition that state sequences that were most consistent across data samples would be ‘better’ (<xref ref-type="bibr" rid="bib67">Ulrike von, 2010</xref>). Consistency scores were calculated between all pairs of leave-one-participant-out samples using normalized mutual information. We chose the value <inline-formula><alternatives><mml:math id="inf262"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:math><tex-math id="inft262">\begin{document}$K=6$\end{document}</tex-math></alternatives></inline-formula> based on the figure below.</p><fig id="app1fig2" position="float"><label>Appendix 1—figure 2.</label><caption><title>Consistency of state sequences across left-out participants as a function of the number of states (<inline-formula><alternatives><mml:math id="inf263"><mml:mi>K</mml:mi></mml:math><tex-math id="inft263">\begin{document}$K$\end{document}</tex-math></alternatives></inline-formula>).</title><p>Error bars indicate the 95% confidence interval based on standard error across leave-one-out samples.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-102539-app1-fig2-v1.tif"/></fig></sec><sec sec-type="appendix" id="s10"><title>Statistically significant state transitions</title><p>We determined state transitions that occurred with frequencies higher than what would be expected by chance. Recall that state transitions were determined based on the state transition probability matrix. Our procedure was as follows. Transition matrices were estimated for each bootstrap sample. To determine a null distribution of transition matrices, for every bootstrap sample, we temporally shuffled state sequences while preserving self-transitions (here, state transitions were the main object of study, not self-transitions). For each state, randomization of the state sequence was performed by shuffling contiguous blocks attributed to the same state (instead of shuffling at the time step level). Significant state transitions were those for which the mean of the transition probability (based on bootstrap samples) was greater than the mean based on the shuffled versions (paired Wilcoxon signed-rank test, <inline-formula><alternatives><mml:math id="inf264"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft264">\begin{document}${\rm p} \lt 0.05$\end{document}</tex-math></alternatives></inline-formula>). To correct for multiple comparisons (<inline-formula><alternatives><mml:math id="inf265"><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="inft265">\begin{document}$K\times(K-1)$\end{document}</tex-math></alternatives></inline-formula>) transitions while ignoring self-transitions, we applied Bonferroni correction.</p><fig id="app1fig3" position="float"><label>Appendix 1—figure 3.</label><caption><title>Average state transition matrix across bootstrap samples.</title><p>State transitions highlighted in red have occurred more frequently than expected by chance (<inline-formula><alternatives><mml:math id="inf266"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft266">\begin{document}${\rm p} \lt 0.05$\end{document}</tex-math></alternatives></inline-formula>, corrected for multiple comparisons).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-102539-app1-fig3-v1.tif"/></fig></sec><sec sec-type="appendix" id="s11"><title>Effect of the number of input stimulus categories (bins) in the analysis of <xref ref-type="fig" rid="fig2">Figure 2</xref></title><p>We evaluated how the choice of input categories (bins) impacted the results shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>. Overall, the results generalized well to 10 and 30 bins, instead of the original 20. However, we also note that a ‘near-miss’ state (<monospace>STATE 5</monospace>) was not well captured with only 10 bins given that it included an input (<inline-formula><alternatives><mml:math id="inf267"><mml:msub><mml:mi>A</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="inft267">\begin{document}$A_{5}$\end{document}</tex-math></alternatives></inline-formula>) that included the circle collision, and it did not include the retreat input that was closest to the collision (<inline-formula><alternatives><mml:math id="inf268"><mml:msub><mml:mi>R</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="inft268">\begin{document}$R_{4}$\end{document}</tex-math></alternatives></inline-formula>).</p></sec><sec sec-type="appendix" id="s12"><title>Effect of the number of stimulus categories (bins) in the analysis of <xref ref-type="fig" rid="fig7">Figure 7</xref></title><p>We also evaluated how the number of input stimulus categories (bins) impacted the results of the analysis shown in <xref ref-type="fig" rid="fig7">Figure 7</xref>. Broadly, the results generalized well across the number of bins used for inputs. However, some differences were observed. We discuss part (A) first. For example, in <monospace>STATE 2</monospace> (shock/peri-shock) in the original case with 20 bins and with 10 bins, inputs at <inline-formula><alternatives><mml:math id="inf269"><mml:msub><mml:mi>R</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>9</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="inft269">\begin{document}$R_{9}$\end{document}</tex-math></alternatives></inline-formula> (20 bins) and <inline-formula><alternatives><mml:math id="inf270"><mml:msub><mml:mi>R</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="inft270">\begin{document}$R_{5}$\end{document}</tex-math></alternatives></inline-formula> (10 bins) steered the system to <monospace>STATE 1</monospace> (post-shock); in contrast, such post-shock influence of the inputs was not detected with 30 bins. In addition, for <monospace>STATE 1</monospace> (post-shock), inputs after the shock steered the trajectory away from the state (input <inline-formula><alternatives><mml:math id="inf271"><mml:msub><mml:mi>R</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>8</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="inft271">\begin{document}$R_{8}$\end{document}</tex-math></alternatives></inline-formula> with 20 bins and <inline-formula><alternatives><mml:math id="inf272"><mml:msub><mml:mi>R</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="inft272">\begin{document}$R_{12}$\end{document}</tex-math></alternatives></inline-formula> with 30 bins); in contrast, no corresponding tendency was observed with 10 bins. We discuss part (B) next. Input contributions to state transitions were consistent across the binning of inputs with one exception: no input was found to significantly steer the trajectory away from <monospace>STATE 3</monospace> in the case of the <inline-formula><alternatives><mml:math id="inf273"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mtext mathvariant="monospace">STATE 3</mml:mtext></mml:mrow><mml:mo stretchy="false">↦</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mtext mathvariant="monospace">STATE 5</mml:mtext></mml:mrow></mml:math><tex-math id="inft273">\begin{document}$\texttt{STATE 3}\mapsto\texttt{STATE 5}$\end{document}</tex-math></alternatives></inline-formula> transition when 10 bins were used (see second row).</p></sec></app></app-group></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.102539.3.sa0</article-id><title-group><article-title>eLife Assessment</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Büchel</surname><given-names>Christian</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution>University Medical Center Hamburg-Eppendorf</institution><country>Germany</country></aff></contrib></contrib-group><kwd-group kwd-group-type="evidence-strength"><kwd>Compelling</kwd></kwd-group><kwd-group kwd-group-type="claim-importance"><kwd>Important</kwd></kwd-group></front-stub><body><p>Using highly sophisticated switching linear dynamical systems (SLDS) analyses applied to functional MRI data, this study provides <bold>important</bold> insights into network dynamics underlying threat processing. After identifying distinct neural network states associated with varying levels of threat proximity, the paper provides <bold>compelling</bold> evidence of intrinsically and extrinsically driven contributions to these within-state dynamics and between-state transitions. Although the findings could be made more biologically meaningful, this work will be of interest to a wider functional neuroimaging and systems neuroscience community.</p></body></sub-article><sub-article article-type="referee-report" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.102539.3.sa1</article-id><title-group><article-title>Reviewer #1 (Public review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>The manuscript uses state-of-the-art analysis technology to document the spatio-temporal dynamics of brain activity during the processing of threats. The authors offer convincing evidence that complex spatio-temporal aspects of brain dynamics are essential to describe brain operations during threat processing.</p><p>Strengths:</p><p>Rigorous complex analyses well suited to the data.</p><p>Weaknesses:</p><p>Lack of a simple take-home message about discovery of a new brain operation.</p><p>Comments on revisions:</p><p>The authors have improved the presentation of the work. The overstatements about existing models of brain functions ignoring exogenous components remains largely unaddressed. The clarifications and improvements provided in revision confirm my assessment of the paper.</p></body></sub-article><sub-article article-type="referee-report" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.102539.3.sa2</article-id><title-group><article-title>Reviewer #2 (Public review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>This paper by Misra and Pessoa uses switching linear dynamical systems (SLDS) to investigate the neural network dynamics underlying threat processing at varying levels of proximity. Using an existing dataset from a threat-of-shock paradigm in which threat proximity is manipulated in a continuous fashion, the authors first show that they can identify states that each have their own linear dynamical system and are consistently associated with distinct phases of the threat-of-shock task (e.g., &quot;peri-shock&quot;, &quot;not near&quot;, etc). They then show how activity maps associated with these states are in agreement with existing literature on neural mechanisms of threat processing, and how activity in underlying brain regions alters around state transitions. The central novelty of the paper lies in its analyses of how intrinsic and extrinsic factors contribute to within-state trajectories and between-state transitions. Additional analyses furthermore show how individual brain regions contribute to state dynamics. Finally, the authors show how their findings generalize to another (related) threat paradigm.</p><p>Strengths:</p><p>The analyses for this study are conducted at a very high level of mathematical and theoretical sophistication. The paper is very well written and effectively communicates complex concepts from dynamical systems. The paper provides valuable neuroscientific insights into threat processing, and the methodology has potential to deepen our understanding at a neurobiological level in future work.</p><p>Weaknesses:</p><p>I was somewhat disappointed initially by the level of inferences made by the authors based on their analyses at the level of systems neuroscience. After revision this has improved, for instance with inclusion of analyses on the importance of individual brain regions to state dynamics, but I still believe the findings can be made more biologically meaningful, for instance by focusing on what we learn from these sophisticated analyses beyond what is already known from more conventional methodologies. However, the paper as it stands is solid scientific work and such efforts may also be left to future work.</p></body></sub-article><sub-article article-type="author-comment" id="sa3"><front-stub><article-id pub-id-type="doi">10.7554/eLife.102539.3.sa3</article-id><title-group><article-title>Author response</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Misra</surname><given-names>Joyneel</given-names></name><role specific-use="author">Author</role><aff><institution>University of Maryland, College Park</institution><addr-line><named-content content-type="city">College Park</named-content></addr-line><country>United States</country></aff></contrib><contrib contrib-type="author"><name><surname>Pessoa</surname><given-names>Luiz</given-names></name><role specific-use="author">Author</role><aff><institution>University of Maryland</institution><addr-line><named-content content-type="city">College Park</named-content></addr-line><country>United States</country></aff></contrib></contrib-group></front-stub><body><p>The following is the authors’ response to the original reviews</p><disp-quote content-type="editor-comment"><p><bold>Reviewer 1 (Public Review):</bold></p><p>Summary</p><p>The manuscript uses state-of-the-art analysis technology to document the spatio-temporal dynamics of brain activity during the processing of threats. The authors offer convincing evidence that complex spatio-temporal aspects of brain dynamics are essential to describe brain operations during threat processing.</p><p>Strengths</p><p>Rigorous complex analyses well suited to the data.</p><p>Weaknesses</p><p>Lack of a simple take-home message about discovery of a new brain operation.</p></disp-quote><p>We have addressed the concern under response to item 1 in Recommendations for the authors of Reviewer 2 below.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer 1 (Recommendations for the authors):</bold></p><p>The paper presents sophisticated analyses of how the spatiotemporal activity of the brain processes threats. While the study is elegant and relevant to the threat processing literature, it could be improved by better clarification of novelty, scope, assumptions and implications. Suggestions are reported below.</p><p>(1) Introduction: It is difficult to understand what is unsatisfactory in the present literature and why we need this study. For example, lines 57-64 report what works well in the work of Anderson and Fincham but do not really describe what this approach lacks, either in failing to explain real data in conceptual terms.</p></disp-quote><p>We have edited the corresponding lines to better describe what such approaches generally lack:</p><p>Introduction; Lines 63-66: However, the mapping between brain signals and putative mental states (e.g., “encoding”) remained speculative. More generally, state-based modeling of fMRI data would benefit from evaluation in contexts where the experimental paradigm affords a clearer mapping between discovered states and experimental manipulation.</p><disp-quote content-type="editor-comment"><p>(2) Also, based on the introduction it is unclear if the focus is on understanding the processing of threat or in the methodological development of experimental design and analysis paradigms for more ecologically valid situations.</p></disp-quote><p>In our present work, we tried to focus on understanding dynamics of threat processing while also contributing to methodological development of analysis of dynamic/ecologically inspired experiments. To that end, we have added a new paragraph at the end of Introduction to clarify the principal focus of our work:</p><p>Introduction; Lines 111-118: Is the present contribution focused on threat processing or methodological developments for the analysis of more continuous/ecologically valid paradigms? Our answer is “both”. One goal was to contribute to the development of a framework that considers brain processing to be inherently dynamic and multivariate. In particular, our goal was to provide the formal basis for conceptualizing threat processing as a dynamic process (see (Fanselow and Lester, 1987)) subject to endogenous and exogenous contributions. At the same time, our study revealed how regions studied individually in the past (e.g., anterior insula, cingulate cortex) contribute to brain states with multi-region dynamics.</p><disp-quote content-type="editor-comment"><p>(3) The repeated statement, based on the Fiete paper, that most analyses or models of brain activity do not include an exogenous drive seems an overstatement. There is plenty of literature that not only includes exogenous drives but also studies and documents them in detail. There are many examples, but a prominent one is the study of auditory processing. Essentially all human brain areas related to hearing (not only the activity of individual areas but also their communication) are entrained by the exogenous drive of speech (e.g. J. Gross et al, PLoS Biology 11 e1001752, 2013).</p></disp-quote><p>We have altered the original phrasing, which now reads as:</p><p>Introduction; Lines 93-95: Importantly, we estimated both endogenous and exogenous components of the dynamics, whereas some past work has not modeled both contributions (see discussion in (Khona and Fiete, 2022)).</p><p>Discussion; Lines 454-455: Work on dynamics of neural circuits in systems neuroscience at times assumes that the target circuit is driven only by endogenous processes (Khona and Fiete, 2022).</p><disp-quote content-type="editor-comment"><p>(4) Attractor dynamics is used as a prominent descriptor of fMRI activity, yet the discussion of how this may emerge from the interaction between areas is limited. Is it related to the way attractors emerge from physical systems or neural networks (e.g. Hopfield?).</p></disp-quote><p>This is an important question that we believe will benefit from computational and mathematical modeling, but we consider it beyond the scope of the present paper.</p><disp-quote content-type="editor-comment"><p>(5) Fig 4 shows activity of 4 regions, not 2 s stated in lines 201-202. Correct?</p></disp-quote><p>Fig. 4 shows activity of two regions and also the average activity of regions belonging to two resting-state networks engaged during threat processing (discussed shortly after lines 201-202). To clarify the above concern, we have changed the following line:</p><p>Results; Lines 228-230: In Fig. 4, we probed the average signals from two resting-state networks engaged during threat-related processing, the salience network which is particularly engaged during higher threat, and the default network which is engaged during conditions of relative safety.</p><disp-quote content-type="editor-comment"><p>(6) It would be useful to state more clearly how Fig 7B, C differs from Fig 2A, B (my understanding it is that in the former they are isolating the stimulus-driven processes)</p></disp-quote><p>We have clarified this by adding the following line in the Results:</p><p>Results; Lines 290-292: Note that in Fig. 7B/C we evaluated exogenous contributions only for stimuli associated with each state/state transition reported in Fig. 2A/B (see also Methods).</p><disp-quote content-type="editor-comment"><p><bold>Reviewer 2 (Public Review):</bold></p><p>Summary</p><p>This paper by Misra and Pessoa uses switching linear dynamical systems (SLDS) to investigate the neural network dynamics underlying threat processing at varying levels of proximity. Using an existing dataset from a threat-of-shock paradigm in which threat proximity is manipulated in a continuous fashion, the authors first show that they can identify states that each has their own linear dynamical system and are consistently associated with distinct phases of the threat-of-shock task (e.g., “peri-shock”, “not near”, etc). They then show how activity maps associated with these states are in agreement with existing literature on neural mechanisms of threat processing, and how activity in underlying brain regions alters around state transitions. The central novelty of the paper lies in its analyses of how intrinsic and extrinsic factors contribute to within-state trajectories and betweenstate transitions. A final set of analyses shows how the findings generalize to another (related) threat paradigm.</p><p>Strengths</p><p>The analyses for this study are conducted at a very high level of mathematical and theoretical sophistication. The paper is very well written and effectively communicates complex concepts from dynamical systems. I am enthusiastic about this paper, but I think the authors have not yet exploited the full potential of their analyses in making this work meaningful toward increasing our neuroscientific understanding of threat processing, as explained below.</p><p>Weaknesses</p><p>(1) I appreciate the sophistication of the analyses applied and/or developed by the authors. These methods have many potential use cases for investigating the network dynamics underlying various cognitive and affective processes. However, I am somewhat disappointed by the level of inferences made by the authors based on these analyses at the level of systems neuroscience. As an illustration consider the following citations from the abstract: “The results revealed that threat processing benefits from being viewed in terms of dynamic multivariate patterns whose trajectories are a combination of intrinsic and extrinsic factors that jointly determine how the brain temporally evolves during dynamic threat” and “We propose that viewing threat processing through the lens of dynamical systems offers important avenues to uncover properties of the dynamics of threat that are not unveiled with standard experimental designs and analyses”. I can agree to the claim that we may be able to better describe the intrinsic and extrinsic dynamics of threat processing using this method, but what is now the contribution that this makes toward understanding these processes?</p></disp-quote><p>We have addressed the concern under response to item 1 in Recommendations for the authors below.</p><disp-quote content-type="editor-comment"><p>(2) How sure can we be that it is possible to separate extrinsically and intrinsically driven dynamics?</p></disp-quote><p>We have addressed the concern under response to item 2 in Recommendations for the authors below.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer 2 (Recommendations for the authors):</bold></p><p>(1) To address the first point under weaknesses above: I would challenge the authors to make their results more biologically/neuroscientifically meaningful, in particular in the sections (in results and/or discussion) on how intrinsic and extrinsic factors contribute to within-state trajectories and between-state transitions, and make those explicit in both the abstract and the discussion (what exactly are the properties of the dynamics of threat that are uncovered?). The authors may also argue that the current approach lies the groundwork for such efforts, but does not currently provide such insights. If they would take this position, that should be made explicit throughout (which would make it more of a methodological paper).</p></disp-quote><p>The SLDS approach provides, we believe, a powerful framework to describe system-level dynamics (of threat processing in the the present case). A complementary type of information can be obtained by studying the contribution of individual components (brain regions) within the larger system (brain), an approach that helps connect our approach to studies that typically focus on the contributions of individual regions, and contributes to providing more neurobiological interpretability to the results. Accordingly, we developed a new measure of region importance that captured the extent to which individual brain regions contributed to driving system dynamics during a given state.</p><p>Abstract; Lines 22-25: Furthermore, we developed a measure of region importance that quantifies the contributions of an individual brain region to system dynamics, which complements the system-level characterization that is obtained with the state-space SLDS formalism.</p><p>Introduction; Lines 95-99: A considerable challenge in state-based modeling, including SLDS, is linking estimated states and dynamics to interpretable processes. Here, we developed a measure of region importance that provides a biologically meaningful way to bridge this gap, as it quantifies how individual brain regions contribute to steering state trajectories.</p><p>Results; Lines 302-321: Region importance and steering of dynamics: Based on time series data and input information, the SLDS approach identifies a set of states and their dynamics. While these states are determined in the latent space, they can be readily mapped back to the brain, allowing for the characterization of spatiotemporal properties across the entire brain. Since not all regions contribute equally to state properties, we propose that a region’s impact on state dynamics serves as a measure of its importance.</p><p>We illustrate the concept for STATE 5 (“near miss”) in Fig. 8 (see Fig. S17 for all states). Fig. 8A shows importance in the top row and activity below as a function of time from state entry.The dynamics of importance and activity can be further visualized (Fig. 8B), where some regions of particularly high importance are illustrated together with the ventromedial PFC, a region that is typically not engaged during high-threat conditions. Notably, the importance of the dorsal anterior insula increased quickly in the first time points, and later decreased. In contrast, the importance of the periaqueductal gray was relatively high from the beginning of the state and decreased moderately later.</p><p>Fig. 8C depicts the correlation between these measures as a function of time. For all but STATE 1, the correlation increased over time. Interestingly, for STATES 4-5, the correlation was low at the first and second time points of the state (and for STATE 2 at the first time point), and for STATE 3 the measures were actually anticorrelated; both cases indicate a dissociation between activity and importance. In summary, our results illustrate that univariate region activity can differ from multivariate importance, providing a fruitful path to understand how individual brain regions contribute to collective dynamic properties.</p><p>Discussion; Lines 466-487: In the Introduction, we motivated our study in terms of determining multivariate and distributed patterns of activity with shared dynamics. At one end of the spectrum, it is possible to conceptualize the whole brain as dynamically evolving during a state; at the other end, we could focus on just a few “key” regions, or possibly a single one (at which point the description would be univariate). Here, we addressed this gap by studying the importance of regions to state dynamics: To what extent does a region steer the trajectory of the system? From a mathematical standpoint, our proposed measure is not merely a function of activity of a region but also of the coefficients of the dynamics matrix capturing its effect on across-region dynamics (Eichler, 2005; Smith et al., 2010).</p><p>How distributed should the dynamics of threat be considered? One answer to this question is to consider the distribution of importance values for all states. For STATE 1 (“post shock”), a few regions displayed the highest importance values for a few time points. However, for the other states the distribution of importance values tended to be more uniform at each time point. Thus, based on our proposed importance measure, we conclude that threat-related processing is profitably viewed as substantially distributed. Furthermore, we found that while activity and importance were relatively correlated, they could also diverge substantially. Together, we believe that the proposed importance measure provides a valuable tool for understanding the rich dynamics of threat processing. For example, we discovered that the dorsal anterior insula is important not only during high-anxiety states (such as STATE 5; “near miss”) but also, surprisingly, for a state that followed the aversive shock event (STATE 1; “post shock”). Additionally, we noted that posterior cingulate cortex, widely known to play a central role in the default mode network, to have the highest importance among all other regions in driving dynamics of low-anxiety states (such as STATE 3 and STATE 4; “not near”).</p><p>Methods; Lines 840-866: Region importance We performed a “lesion study”, where we quantified how brain regions contribute to state dynamics by eliminating (zeroing) model parameters corresponding to a given region, and observing the resulting changes in system dynamics. According to our approach, the most important regions are those that cause the greatest change in system dynamics when eliminated.</p><p>The SLDS model represents dynamics in a low dimensional latent space and model parameters are not readily available at the level of individual regions. Thus, the first step was to project the dynamics equation onto the brain data prior to computing importance values. Thus, the linear dynamics equation in the latent space (Eq. 2) was mapped to the original data space of N = 85 ROIs using the emissions model (Eq. 1):<disp-formula id="sa3equ1"><alternatives><mml:math id="sa3m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mml:mtr><mml:mtd><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>d</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>d</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mo>†</mml:mo></mml:mrow></mml:msup><mml:mi>C</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>d</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mo>†</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>d</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mo>†</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mo>≡</mml:mo><mml:mover><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>⏜</mml:mo></mml:mover></mml:mrow></mml:munder><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mo>≡</mml:mo><mml:mover><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>⏜</mml:mo></mml:mover></mml:mrow></mml:munder><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>C</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mo>†</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mo>≡</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>Z</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mover><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mover><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mover><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t15">\begin{document}$$\displaystyle  Y_{t} &amp; =C X_{t}+d \\ &amp; =C\left(A_{Z_{t}} X_{t-1}+V_{Z_{t}} U_{t}+b_{Z_{t}}\right)+d \\ &amp; =C A_{Z_{t}} C^{\dagger} C X_{t-1}+C V_{Z_{t}} U_{t}+C b_{Z_{t}}+d \\ &amp; =C A_{Z_{t}} C^{\dagger}\left(C X_{t-1}+d-d\right)+C V_{Z_{t}} U_{t}+C b_{Z_{t}}+d \\ &amp; =\underbrace{\left(C A_{Z_{t}} C^{\dagger}\right)}_{\equiv \overparen{A_{Z_{t}}}} Y_{t-1}+\underbrace{\left(C V_{Z_{t}}\right)}_{\equiv \overparen{V_{Z_{t}}}} U_{t}+\underbrace{\left(C b_{Z_{t}}+\left(I-C A_{z_{t}} C^{\dagger}\right) d\right)}_{\equiv \widetilde{Z}_{t}} \\ &amp; =\widehat{A_{Z_{t}}} Y_{t-1}+\widehat{V_{Z_{t}}} U_{t}+\widehat{b_{Z_{t}}},$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <italic>C</italic><sup>†</sup> represents the Moore-Penrose pseudoinverse of <italic>C</italic>, and <inline-formula><alternatives><mml:math id="sa3m2"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mover><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mrow><mml:mover><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft274">\begin{document}$\widehat{A_{Z_{t}}} \in \mathbb{R}^{N \times N}, \widehat{V_{Z_{t}}} \in \mathbb{R}^{N \times M}$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="sa3m3"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mover><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft275">\begin{document}$\widehat{b_{Z_{t}}} \in \mathbb{R}^{N}$\end{document}</tex-math></alternatives></inline-formula> denote the corresponding dynamics matrix, input matrix, and bias terms in the original data space.</p><p>Based on the above, we defined the importance of the <italic>i</italic><sup>th</sup> ROI at time t based on quantifying the impact of “lesioning” the <italic>i</italic><sup>th</sup> ROI, i.e., by setting the <italic>i</italic><sup>th</sup> column of <inline-formula><alternatives><mml:math id="sa3m4"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mover><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft276">\begin{document}$\widehat{A_{Z_{t}}}$\end{document}</tex-math></alternatives></inline-formula>, the <italic>i</italic><sup>th</sup> row of <inline-formula><alternatives><mml:math id="sa3m5"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mover><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft277">\begin{document}$\widehat{V_{Z_{t}}}$\end{document}</tex-math></alternatives></inline-formula>, and the <italic>i</italic><sup>th</sup> element of <inline-formula><alternatives><mml:math id="sa3m6"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mover><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft278">\begin{document}$\widehat{b_{Z_{t}}}$\end{document}</tex-math></alternatives></inline-formula> to 0, denoted <inline-formula><alternatives><mml:math id="sa3m7"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft279">\begin{document}${\widehat{A_{Z_{1}}}}^{(-i)}$\end{document}</tex-math></alternatives></inline-formula>, <italic>i</italic><sup>th</sup> ROI <inline-formula><alternatives><mml:math id="sa3m8"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft280">\begin{document}${\widehat{V_{Z_{t}}}}^{(-i)}$\end{document}</tex-math></alternatives></inline-formula>, and <inline-formula><alternatives><mml:math id="sa3m9"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft281">\begin{document}${\widehat{b_{Z_{t}}}}^{(-i)}$\end{document}</tex-math></alternatives></inline-formula> respectively. Formally, the importance of the <inline-formula><alternatives><mml:math id="sa3m10"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msubsup><mml:mi>q</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft282">\begin{document}$q_{t}^{i}$\end{document}</tex-math></alternatives></inline-formula> was defined as:<disp-formula id="sa3equ2"><alternatives><mml:math id="sa3m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="right left right left right left right left right left right left" rowspacing="0.816em 0.816em 0.3em" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>q</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mo symmetric="true">‖</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>U</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>b</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mi>U</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>b</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo symmetric="true">‖</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mo symmetric="true">‖</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>U</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mi>U</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>b</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>b</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo symmetric="true">‖</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mo symmetric="true">‖</mml:mo><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>∗</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mi>U</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∗</mml:mo><mml:msub><mml:mrow><mml:mn mathvariant="double-struck">1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>b</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∗</mml:mo><mml:msub><mml:mrow><mml:mn mathvariant="double-struck">1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo symmetric="true">‖</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t16">\begin{document}$$\displaystyle  q_t^{i} &amp; =  \left\lVert \left( \widehat{A}_{Z_t} Y_{t-1} + \widehat{V}_{Z_t} U_t + \widehat{b}_{Z_t} \right) - \left( \widehat{A}_{Z_t}^{(-i)} Y_{t-1} + \widehat{V}_{Z_t}^{(-i)} U_t + \widehat{b}_{Z_t}^{(-i)} \right) \right\rVert_2 \\[1.2ex] &amp; =  \left\lVert \left( \widehat{A}_{Z_t} Y_{t-1} - \widehat{A}_{Z_t}^{(-i)} Y_{t-1} \right) + \left( \widehat{V}_{Z_t} U_t - \widehat{V}_{Z_t}^{(-i)} U_t \right) + \left( \widehat{b}_{Z_t} - \widehat{b}_{Z_t}^{(-i)} \right) \right\rVert_2 \\[1.2ex] &amp; =  \left\lVert Y_{t-1}^{i} * \widehat{A}_{Z_t}^{(i)} + \left( \widehat{V}_{Z_t}^{(i)} U_t \right) * \mathbb{1}_i + \widehat{b}_{Z_t}^{(i)} * \mathbb{1}_i \right\rVert_2, $$\end{document}</tex-math></alternatives></disp-formula></p><p>where ‘∗’ indicates element-wise multiplication of a scalar with a vector, <inline-formula><alternatives><mml:math id="sa3m12"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft283">\begin{document}$Y_{t-1}^{i}$\end{document}</tex-math></alternatives></inline-formula> is the activity of <italic>i</italic><sup>th</sup> ROI at time <inline-formula><alternatives><mml:math id="sa3m13"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft284">\begin{document}$t-1,{\widehat{A Z_{t}}}^{(i)}$\end{document}</tex-math></alternatives></inline-formula> corresponds to the <italic>i</italic><sup>th</sup> column of <italic>i</italic> <inline-formula><alternatives><mml:math id="sa3m14"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mover><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">⊤</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft285">\begin{document}$\widehat{A_{Z_{t}}},\left({\widehat{V_{Z_{t}}}}^{(i) \top} U_{t}\right)$\end{document}</tex-math></alternatives></inline-formula> is the inner product between <sup>th</sup> row of <italic>i</italic><inline-formula><alternatives><mml:math id="sa3m15"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mover><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft286">\begin{document}$\widehat{V_{Z_{t}}}$\end{document}</tex-math></alternatives></inline-formula> and input <sup>th</sup> element of <inline-formula><alternatives><mml:math id="sa3m16"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft287">\begin{document}$U_{t},{\widehat{b_{Z}}}^{(1)}$\end{document}</tex-math></alternatives></inline-formula> corresponds to the <italic>i</italic><sup>th</sup> ROI. Note that the term is a function of both the <italic>i</italic><inline-formula><alternatives><mml:math id="sa3m17"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mover><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft288">\begin{document}$\widehat{b_{Z_{t}}}$\end{document}</tex-math></alternatives></inline-formula> and <sup>th</sup> ROI’s activity as well as the coefficients of the dynamics matrix capturing the effect of region <italic>i</italic> on the one-step dynamics of the entire system (Eichler, 2005; Smith et al., 2010); the remaining terms capture the effect of the external inputs and the bias term on the one-step dynamics of the <inline-formula><alternatives><mml:math id="sa3m18"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mrow><mml:mn mathvariant="double-struck">1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft289">\begin{document}$\mathbb{1}_{i} \in \mathbb{R}^{N}$\end{document}</tex-math></alternatives></inline-formula> represents an indicator vector corresponding to the <italic>i</italic><sup>th</sup> ROI.</p><p>After computing <inline-formula><alternatives><mml:math id="sa3m19"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:msubsup><mml:mi>q</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft290">\begin{document}$q_{t}^{i}$\end{document}</tex-math></alternatives></inline-formula> for a given run, the resultant importance time series was normalized to zero mean and unit variance.</p><disp-quote content-type="editor-comment"><p>(2) To address the second point under the weaknesses above: Given that the distinction between intrinsic and extrinsic dynamics appears central to the novelty of the paper, I would suggest the authors explicitly address this issue in the introduction and/or discussion sections.</p></disp-quote><p>The distinction between intrinsic and extrinsic dynamics is a modeling assumption of SLDS. We used such an assumption because in experimental designs with experimenter manipulated inputs one can profitably investigate both types of contribution to dynamics. While we should not reify the model’s assumption, we can gain confidence in our separation of extrinsically and intrinsically driven dynamics through controlled experiments where we can manipulate external inputs, or by demonstrating time-scale separation of intrinsic and extrinsic dynamics and that they operate at different frequencies. This is an important question that requires additional computational/mathematical modeling, but we consider it beyond the scope of the current paper. We have added the following lines in the discussion section:</p><p>Discussion; Lines 521-528: A further issue that we wish to discuss is related to the distinction between intrinsic and extrinsic dynamics, which is explicitly modeled in our SLDS approach (see Methods, equation 2). We believe this is a powerful approach because in experimental designs with experimenter manipulated inputs, one can profitably investigate both types of contribution to dynamics. However, complete separation between intrinsic and extrinsic dynamics is challenging to ascertain. More generally, one can gain confidence in their separation through controlled experiments where external inputs are manipulated, or by demonstrating timescale separation of intrinsic and extrinsic dynamics.</p><disp-quote content-type="editor-comment"><p>(3) In the abstract, the statement “.. studies in systems neuroscience that frequently assume that systems are decoupled from external inputs” sounds paradoxical after first introducing how threat processing is almost exclusively studied using blocked and event-related task designs (which obviously rely on external inputs only). Please clarify this.</p></disp-quote><p>In this work, we wished to state that the SLDS framework characterizes both endogenous and exogenous contributions to dynamics, whereas some past work has not modeled both contributions. To clarify, we have changed the corresponding line:</p><p>Abstract; Lines 19-20: Importantly, we characterized both endogenous and exogenous contributions to dynamics.</p><disp-quote content-type="editor-comment"><p>(4) In the abstract, the first mention of circles comes out of the blue; the paradigm needs to be introduced first to make this understandable.</p></disp-quote><p>We have rephrased the corresponding text:</p><p>Abstract; Lines 14-17: First, we demonstrated that the SLDS model learned the regularities of the experimental paradigm, such that states and state transitions estimated from fMRI time series data from 85 regions of interest reflected threat proximity and threat approach vs. retreat.</p><disp-quote content-type="editor-comment"><p>(5) In Figure 3, the legend shows z-scores representing BOLD changes associated with states. However, the z-scores are extremely low (ranging between -.4 and .4). Can this be correct, given that maps are thresholded at _p &lt; .<italic>001 (i.e., z &gt; 3</italic>._09)? A similar small range of z-scores is shown in the legend of Fig 5. Please check the z-score ranges.</p></disp-quote><p>The p-value threshold used in Fig. 3 is based on the voxelwise t-test conducted between the participantbased bootstrapped maps and null maps (see Methods : State spatial maps : “To identify statistically significant voxels, we performed a paired t-test between the participant-based boostrapped maps and the null maps.”). Thus, the p-value threshold in the figure does not correspond to the z-scores of the groupaveraged state-activation maps. Similarly in Fig. 5, we only visualized the state-wise attractors on a brain surface map without any thresholding. The purpose of using a z-score color bar was to provide a scale comparable to that of BOLD activity.</p></body></sub-article></article>