<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.2" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">67764</article-id><article-id pub-id-type="doi">10.7554/eLife.67764</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Evolutionary Biology</subject></subj-group></article-categories><title-group><article-title>Evolution of diversity in metabolic strategies</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-227624"><name><surname>Caetano</surname><given-names>Rodrigo</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2837-113X</contrib-id><email>caetano@fisica.ufpr.br</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-41387"><name><surname>Ispolatov</surname><given-names>Yaroslav</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0201-3396</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-5614"><name><surname>Doebeli</surname><given-names>Michael</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5975-5710</contrib-id><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf2"/></contrib><aff id="aff1"><label>1</label><institution>Departamento de Física, Universidade Federal do Paraná</institution><addr-line><named-content content-type="city">Curitiba</named-content></addr-line><country>Brazil</country></aff><aff id="aff2"><label>2</label><institution>Department of Physics, University of Santiago of Chile (USACH)</institution><addr-line><named-content content-type="city">Santiago</named-content></addr-line><country>Chile</country></aff><aff id="aff3"><label>3</label><institution>Department of Mathematics and Department of Zoology, University of British Columbia</institution><addr-line><named-content content-type="city">Vancouver</named-content></addr-line><country>Canada</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Shou</surname><given-names>Wenying</given-names></name><role>Reviewing Editor</role><aff><institution>University College London</institution><country>United Kingdom</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Walczak</surname><given-names>Aleksandra M</given-names></name><role>Senior Editor</role><aff><institution>École Normale Supérieure</institution><country>France</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>05</day><month>08</month><year>2021</year></pub-date><pub-date pub-type="collection"><year>2021</year></pub-date><volume>10</volume><elocation-id>e67764</elocation-id><history><date date-type="received" iso-8601-date="2021-02-22"><day>22</day><month>02</month><year>2021</year></date><date date-type="accepted" iso-8601-date="2021-08-05"><day>05</day><month>08</month><year>2021</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at bioRxiv.</event-desc><date date-type="preprint" iso-8601-date="2020-10-21"><day>21</day><month>10</month><year>2020</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2020.10.20.347419"/></event></pub-history><permissions><copyright-statement>© 2021, Caetano et al</copyright-statement><copyright-year>2021</copyright-year><copyright-holder>Caetano et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-67764-v2.pdf"/><abstract><p>Understanding the origin and maintenance of biodiversity is a fundamental problem. Many theoretical approaches have been investigating ecological interactions, such as competition, as potential drivers of diversification. Classical consumer-resource models predict that the number of coexisting species should not exceed the number of distinct resources, a phenomenon known as the competitive exclusion principle. It has recently been argued that including physiological tradeoffs in consumer-resource models can lead to violations of this principle and to ecological coexistence of very high numbers of species. Here, we show that these results crucially depend on the functional form of the tradeoff. We investigate the evolutionary dynamics of resource use constrained by tradeoffs and show that if the tradeoffs are non-linear, the system either does not diversify or diversifies into a number of coexisting species that do not exceed the number of resources. In particular, very high diversity can only be observed for linear tradeoffs.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>adaptive dynamics</kwd><kwd>evolutionary branching</kwd><kwd>non-linear tradeoffs</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100010751</institution-id><institution>FONDECYT</institution></institution-wrap></funding-source><award-id>1200708</award-id><principal-award-recipient><name><surname>Ispolatov</surname><given-names>Yaroslav</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000038</institution-id><institution>NSERC</institution></institution-wrap></funding-source><award-id>Discovery Grant 219930</award-id><principal-award-recipient><name><surname>Doebeli</surname><given-names>Michael</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Analytical and numerical analyses reveal that the number of coexisting species exceeds the number of resource only for the structurally unstable case of linear tradeoff.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Life on Earth is spectacularly diverse (<xref ref-type="bibr" rid="bib40">May, 1988</xref>). For example, one study in the early 2000s found that the number of species of fungi is, by a conservative estimate, ca. 1.5 million (<xref ref-type="bibr" rid="bib25">Hawksworth, 2001</xref>), which was subsequently revised to be between 2.2 and 3.8 million species (<xref ref-type="bibr" rid="bib26">Hawksworth and Lücking, 2017</xref>). Microbes are by far the most diverse form of life. They constitute approximately 70–90% of all species (<xref ref-type="bibr" rid="bib33">Larsen et al., 2017</xref>). Perhaps even more astonishing than the number of species is the fact that all of them came from a single common ancestor (<xref ref-type="bibr" rid="bib9">Darwin, 1859</xref>; <xref ref-type="bibr" rid="bib54">Steel and Penny, 2010</xref>; <xref ref-type="bibr" rid="bib56">Theobald, 2010</xref>). To understand the fundamental mechanisms behind such diversification is one of the most relevant problems addressed by the scientific community (<xref ref-type="bibr" rid="bib41">Mayr and Mayr, 1963</xref>; <xref ref-type="bibr" rid="bib6">Coyne, 1992</xref>; <xref ref-type="bibr" rid="bib47">Rice and Hostert, 1993</xref>; <xref ref-type="bibr" rid="bib27">Higashi et al., 1999</xref>; <xref ref-type="bibr" rid="bib11">Dieckmann and Doebeli, 1999</xref>; <xref ref-type="bibr" rid="bib20">Gavrilets and Waxman, 2002</xref>; <xref ref-type="bibr" rid="bib10">de Aguiar et al., 2009</xref>; <xref ref-type="bibr" rid="bib13">Doebeli, 2011</xref>).</p><p>Recently, ecological interactions, such as competition, have received a lot of attention as potentially very strong drivers of diversification and speciation. A widely used class of models in which this phenomenon can be observed is based on classical Lotka-Volterra competition models, which are augmented by assuming that the carrying capacity is a (typically unimodal) function of a continuous phenotype, and that the strength of competition between two phenotypes is measured by a competition kernel, which is typically assumed to be a (symmetric) function of the distance between the competing phenotypes, with a maximum at distance 0 (so that the strength of competition decreases with increasing phenotypic distance).</p><p>These assumptions are biologically plausible, and such models have been widely used to provide insights into evolutionary diversification due to competition (<xref ref-type="bibr" rid="bib11">Dieckmann and Doebeli, 1999</xref>; <xref ref-type="bibr" rid="bib17">Doebeli and Ispolatov, 2010</xref>; <xref ref-type="bibr" rid="bib18">Doebeli and Ispolatov, 2017</xref>). However, these models are not derived mechanistically from underlying resource dynamics, and in fact it is known that the commonly used Gaussian functions for the carrying capacity and the competition kernel are not compatible with resource-consumer models (<xref ref-type="bibr" rid="bib1">Abrams, 1986</xref>; <xref ref-type="bibr" rid="bib2">Ackermann and Doebeli, 2004</xref>). A more mechanistic approach is desirable.</p><p>Recently, a MacArthur consumer-resource model (<xref ref-type="bibr" rid="bib38">Macarthur and Levins, 1967</xref>) was studied in an ecological context with a view toward explaining the existence of very high levels of diversity (<xref ref-type="bibr" rid="bib45">Posfai et al., 2017</xref>; <xref ref-type="bibr" rid="bib19">Erez et al., 2020</xref>). The authors consider different species competing for <inline-formula><mml:math id="inf1"><mml:mi>p</mml:mi></mml:math></inline-formula> interchangeable resources, each supplied at a constant rate (<xref ref-type="bibr" rid="bib45">Posfai et al., 2017</xref>) or periodically repleted after being used (<xref ref-type="bibr" rid="bib19">Erez et al., 2020</xref>). A consumer species is characterized by an uptake strategy, <inline-formula><mml:math id="inf2"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where the <inline-formula><mml:math id="inf3"><mml:mi>j</mml:mi></mml:math></inline-formula> th component <inline-formula><mml:math id="inf4"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> represents the amount of cellular metabolism allocated to the uptake of the <inline-formula><mml:math id="inf5"><mml:mi>j</mml:mi></mml:math></inline-formula> th resource. The rate of consumption of the <inline-formula><mml:math id="inf6"><mml:mi>j</mml:mi></mml:math></inline-formula> th resource and thus its contribution to the growth rate is assumed to be proportional to <inline-formula><mml:math id="inf7"><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>. The total amount of cellular metabolism available for resource uptake is limited, and hence it is natural to assume a tradeoff between the uptake rates of different resources. In general mathematical terms, a tradeoff is typically given by a function <inline-formula><mml:math id="inf8"><mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> that is increasing in each of the arguments <inline-formula><mml:math id="inf9"><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>, and such that the only permissible allocation strategies <italic>α</italic> are those satisfying <inline-formula><mml:math id="inf10"><mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≤</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf11"><mml:mi>E</mml:mi></mml:math></inline-formula> is a constant. The analysis is then typically restricted to the subspace of strategies defined by <inline-formula><mml:math id="inf12"><mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> (because <inline-formula><mml:math id="inf13"><mml:mi>T</mml:mi></mml:math></inline-formula> is increasing in each <inline-formula><mml:math id="inf14"><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>). It was shown in <xref ref-type="bibr" rid="bib45">Posfai et al., 2017</xref>; <xref ref-type="bibr" rid="bib19">Erez et al., 2020</xref> that, under the assumption of a linear tradeoff, <inline-formula><mml:math id="inf15"><mml:mrow><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msubsup><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula>, very high levels of diversity, that is, many different species with different <italic>α</italic>-strategies, can coexist. This is a very interesting finding because it violates the competitive exclusion principle (<xref ref-type="bibr" rid="bib24">Hardin, 1960</xref>), according to which at most <inline-formula><mml:math id="inf16"><mml:mi>p</mml:mi></mml:math></inline-formula> different species should be able to stably coexist on <inline-formula><mml:math id="inf17"><mml:mi>p</mml:mi></mml:math></inline-formula> different resources. Such high levels of diversity emerging from simple consumer-resource models could help solve the paradox of the plankton (<xref ref-type="bibr" rid="bib29">Hutchinson, 1961</xref>) from an ecological perspective.</p><p>However, metabolic tradeoffs are not necessarily linear, and in fact there is reason to believe that they almost never are. Nature owes its complexity and diversity to the non-linearity of the underlying physical and chemical processes. In particular, the non-linearity of tradeoffs is an essentially inevitable consequence of the general non-linearity of chemical kinetics. The rate and mass action equilibrium of even a simple bimolecular reaction are in general non-linear functions of the concentrations of reactants. Linear approximations are commonly used when the concentrations of certain reactants are vastly exceeding the concentrations of others, or when the binding is so strong that the dissociation constant of a complex is much less than typical concentrations of its constituents. However, while the concentrations of enzymes in bacteria (which are probably the most realistic prototype for models of <xref ref-type="bibr" rid="bib45">Posfai et al., 2017</xref>; <xref ref-type="bibr" rid="bib19">Erez et al., 2020</xref>) are generally below those of their substrates, the difference is often only few- or 10-fold, which is insufficient to approximate the enzymatic kinetics by functions that are linear in enzymatic concentrations. For example, a detailed study (<xref ref-type="bibr" rid="bib5">Bennett et al., 2009</xref>) of the model microbe <italic>Escherichia coli</italic> revealed that out of 103 metabolites, 35 have concentrations above 1 mM, but the concentrations of 46 metabolites are in tens or single micromole digits, including two metabolites with concentrations below 1 μM. Supporting this, BIONUMBERS (<xref ref-type="bibr" rid="bib43">Milo et al., 2010</xref>) estimate the typical metabolite concentration in an <italic>E. coli</italic> bacterium as 32 μM. At the same time, BIONUMBERS provide the evidence for concentrations of important <italic>E. coli</italic> glycolysis enzymes in tens and even hundreds of μM, and hence the difference between metabolite and enzyme concentrations generally does not seem to be large enough to justify linear approximations.</p><p>Another argument for the prevalence of non-linearity in tradeoffs is based on the oligomerization of more than half of all metabolic enzymes (<xref ref-type="bibr" rid="bib39">Marianayagam et al., 2004</xref>). The dissociation constants of dimer or oligomer enzymes is often comparable to the concentrations of its monomer units to make the dimerization sensitive to environmental conditions and use it as a regulator of enzymatic activity (<xref ref-type="bibr" rid="bib3">Ali and Imperiali, 2005</xref> <xref ref-type="bibr" rid="bib57">Traut, 1994</xref>). Thus, doubling the concentration of an oligomer requires more (in case of hetero-oligomer) or less (in case of homo-oligomer) than doubling the concentrations of its monomers, and hence the metabolic costs of the former in terms of the metabolic costs of the latter are non-linear.</p><p>Since metabolic tradeoffs can often be expected to be non-linear, here we generalize the models of <xref ref-type="bibr" rid="bib45">Posfai et al., 2017</xref>; <xref ref-type="bibr" rid="bib19">Erez et al., 2020</xref> by incorporating non-linear tradeoffs in resource use. Specifically, we consider energy budgets of the form<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover></mml:mstyle><mml:msubsup><mml:mi>α</mml:mi><mml:mi>j</mml:mi><mml:mi>γ</mml:mi></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>γ</italic> and <inline-formula><mml:math id="inf18"><mml:mi>E</mml:mi></mml:math></inline-formula> are positive constants.</p><p>In addition, we incorporate evolutionary dynamics into the ecological models of <xref ref-type="bibr" rid="bib45">Posfai et al., 2017</xref>; <xref ref-type="bibr" rid="bib19">Erez et al., 2020</xref>, which allows us to investigate not only the conditions under which diversity can be maintained, but also the evolution of diversity from a single ancestral species. We show that in the resulting evolutionary model, coexistence of more than <inline-formula><mml:math id="inf19"><mml:mi>p</mml:mi></mml:math></inline-formula> species only emerges for the (structurally unstable) linear case <inline-formula><mml:math id="inf20"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Using adaptive dynamics and numerical simulations, we show that regardless of the value of <italic>γ</italic>, an initially monomorphic population always evolves to an attractive fixed point (also called ‘singular point’), after which two generic scenarios are possible: (i) if <inline-formula><mml:math id="inf21"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, the population branches and diversifies, with the maximal number of coexisting species equal to the number of resources <inline-formula><mml:math id="inf22"><mml:mi>p</mml:mi></mml:math></inline-formula>, a state in which each species is a complete specialist on exactly one of the resources; (ii) if <inline-formula><mml:math id="inf23"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, an initially monomorphic population also evolves to a singular point, but subsequently does not diversify and instead remains a monomorphic generalist.</p><p>To make the argument for the relevance of non-linear tradeoffs even more solid, we prove that an omnipresent non-linearity in the dependence of nutrient uptake rates on <italic>α</italic> can be transformed into the non-linearity of tradeoff (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>), and vice versa. Thus, a non-linearity in either the tradeoff or the metabolic rates is sufficient to bring the diversity down to the competitive exclusion limit. We also show that the two scenarios (of either a generalist or <inline-formula><mml:math id="inf24"><mml:mi>p</mml:mi></mml:math></inline-formula> specialists) emerge as a result of purely ecological dynamics in a system initially populated with multiple species with different uptake strategies <italic>α</italic> that satisfy (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>).</p><p>Overall, our results show that very high levels of diversity do not evolve in the consumer-resource model considered here in a realistic scenario where tradeoffs in resource preference or the resource uptake rates are non-linear.</p><sec id="s1-1"><title>Model and results</title><p>We consider a population competing for <inline-formula><mml:math id="inf25"><mml:mi>p</mml:mi></mml:math></inline-formula> substitutable resources in well-mixed environments. A phenotypic species <italic>α</italic> is characterized by its metabolic allocation strategy <inline-formula><mml:math id="inf26"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf27"><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> is the per capita rate at which individuals of species <italic>α</italic> take up the <inline-formula><mml:math id="inf28"><mml:mi>j</mml:mi></mml:math></inline-formula> th nutrient. Various coexisting species are distinguished by their specific <italic>α’</italic>s. From a physiological perspective, <inline-formula><mml:math id="inf29"><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> is proportional to the amount of metabolic effort allocated by the individuals of species <italic>α</italic> to capture nutrient <inline-formula><mml:math id="inf30"><mml:mi>j</mml:mi></mml:math></inline-formula>. Intrinsic limitations on metabolic activities impose a restriction on the total amount of nutrient uptake. For simplicity, we assume that this intrinsic limitation leads to a tradeoff in the components <inline-formula><mml:math id="inf31"><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> of the form (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>). (Note that we also assume <inline-formula><mml:math id="inf32"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> for all <inline-formula><mml:math id="inf33"><mml:mi>j</mml:mi></mml:math></inline-formula>.) Throughout, we will set the scaling parameter <inline-formula><mml:math id="inf34"><mml:mrow><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. (See Appendix 1 for a more general treatment, in which the exponent <italic>γ</italic> can differ for different directions <inline-formula><mml:math id="inf35"><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> in phenotype space.)</p><p>Following <xref ref-type="bibr" rid="bib45">Posfai et al., 2017</xref>, we denote by <inline-formula><mml:math id="inf36"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> the concentration of resource <inline-formula><mml:math id="inf37"><mml:mi>j</mml:mi></mml:math></inline-formula> at time <inline-formula><mml:math id="inf38"><mml:mi>t</mml:mi></mml:math></inline-formula>, and we assume that the amount of resource <inline-formula><mml:math id="inf39"><mml:mi>j</mml:mi></mml:math></inline-formula> available for uptake per individual (e.g., the amount of resource bound to the outer membrane of a microbial cell) is given by a monotonously increasing function <inline-formula><mml:math id="inf40"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Specifically, we assume this function to be of Monod type, <inline-formula><mml:math id="inf41"><mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Thus, the rate of uptake of resource <inline-formula><mml:math id="inf42"><mml:mi>j</mml:mi></mml:math></inline-formula> by an individual consumer with uptake strategy <italic>α</italic> is <inline-formula><mml:math id="inf43"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s1-2"><title>Chemostat conditions</title><p>We assume that resources are supplied to the system at a constant rate defined by the supply vector <inline-formula><mml:math id="inf44"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, so that resource <inline-formula><mml:math id="inf45"><mml:mi>j</mml:mi></mml:math></inline-formula> is supplied at a constant total rate <italic>s</italic><sub><italic>j</italic></sub> and decays at a rate <inline-formula><mml:math id="inf46"><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib45">Posfai et al., 2017</xref>). This generates the following system of equations for the ecological dynamics of the concentrations <italic>c</italic><sub><italic>j</italic></sub>, <inline-formula><mml:math id="inf47"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>α</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf48"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the population density of species <italic>α</italic> at time <inline-formula><mml:math id="inf49"><mml:mi>t</mml:mi></mml:math></inline-formula>, so that <inline-formula><mml:math id="inf50"><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>α</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the total amount of metabolic activity invested into uptake of resource <inline-formula><mml:math id="inf51"><mml:mi>j</mml:mi></mml:math></inline-formula> (the sum runs over all species <italic>α</italic> present in the community). We further assume that the cellular per capita birth rate of species <italic>α</italic> is equal to the amount of nutrient absorbed by each individual. The dynamics of the population density <inline-formula><mml:math id="inf52"><mml:msub><mml:mi>n</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:math></inline-formula> then becomes<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>δ</italic> is the per capita death rate, which is assumed to be the same for all consumers.</p><p>The evolutionary dynamics of the the traits <inline-formula><mml:math id="inf53"><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> can be solved analytically only for a simplified system in which the resource decay (dilution) rates <inline-formula><mml:math id="inf54"><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> are set to 0. This assumption, also made in <xref ref-type="bibr" rid="bib45">Posfai et al., 2017</xref>, corresponds to rapid consumption of almost all resource. In Appendix 1, we derive the adaptive dynamics for the allocation strategies, that is, for the traits <inline-formula><mml:math id="inf55"><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib42">Metz et al., 1992</xref>; <xref ref-type="bibr" rid="bib12">Dieckmann and Law, 1996</xref>; <xref ref-type="bibr" rid="bib11">Dieckmann and Doebeli, 1999</xref>; ; <xref ref-type="bibr" rid="bib28">Hui et al., 2018</xref>; <xref ref-type="bibr" rid="bib13">Doebeli, 2011</xref>; <xref ref-type="bibr" rid="bib21">Geritz et al., 1997</xref>). We show that with vanishing decay rates, there is a unique singular point<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>α</mml:mi><mml:mi>j</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:msub><mml:mi>s</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>γ</mml:mi></mml:mfrac></mml:msup></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Calculations of the Jacobian of the adaptive dynamics (an indicator of convergence stability of a fixed point) and of the Hessian of the invasion fitness function (which distinguishes whether the fixed point is an evolutionary endpoint or a branching point) yield the following conclusions: Regardless of the value of <italic>γ</italic>, the singular point <inline-formula><mml:math id="inf56"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> is always convergent stable, so that the system approaches <inline-formula><mml:math id="inf57"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> from any initial condition. If <inline-formula><mml:math id="inf58"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, the singular point <inline-formula><mml:math id="inf59"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> is also evolutionarily stable and hence represents the evolutionary endpoint. In particular, no diversification takes place. On the other hand, if <inline-formula><mml:math id="inf60"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, the singular point is evolutionarily unstable and hence is an evolutionary branching point. In particular, if <inline-formula><mml:math id="inf61"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, the system will diversify into a number of coexisting consumer species. If <inline-formula><mml:math id="inf62"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> (linear tradeoff), the fitness Hessian is 0, representing evolutionary neutrality.</p><p>To check our analytical approximations and to investigate the details of diversification after convergence to the evolutionary branching point, we performed numerical simulations of evolving populations consisting of multiple phenotypic strains. The simulations were performed without the simplifying assumption of zero resource degradation (dilution) rates; further details of the numerical simulations are presented in Appendix 1.</p><p>In the figures below we show evolving populations as circles with radii proportional to the square root of population size <inline-formula><mml:math id="inf63"><mml:msub><mml:mi>n</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:math></inline-formula> in three-dimensional strategy space <inline-formula><mml:math id="inf64"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, viewed orthogonally to the simplex plane <inline-formula><mml:math id="inf65"><mml:mrow><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:msubsup><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. With the constraint <inline-formula><mml:math id="inf66"><mml:mrow><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:msubsup><mml:msubsup><mml:mi>α</mml:mi><mml:mi>i</mml:mi><mml:mi>γ</mml:mi></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, the coordinates of each population are <inline-formula><mml:math id="inf67"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mn>1</mml:mn><mml:mi>γ</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mn>2</mml:mn><mml:mi>γ</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mn>3</mml:mn><mml:mi>γ</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. In the following numerical examples, we considered a symmetric supply of resources <inline-formula><mml:math id="inf68"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and a slow resource degradation, <inline-formula><mml:math id="inf69"><mml:mrow><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>We first consider scenarios with linear tradeoffs, <inline-formula><mml:math id="inf70"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. <xref ref-type="fig" rid="fig1">Figure 1</xref> shows the evolution of a population (shown in blue circles) whose individuals die at constant rate <inline-formula><mml:math id="inf71"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> (corresponding videos of the simulations can be accessed through the links provided in the figure legends). The black circle represents the singular point that is calculated in the limit of low degradation of nutrients, given by <xref ref-type="disp-formula" rid="equ4">Equation 4</xref>. <xref ref-type="fig" rid="fig1">Figure 1(a)</xref> shows the initial monomorphic population far from the singular point. An intermediate time of the evolutionary process is shown in <xref ref-type="fig" rid="fig1">Figure 1(b)</xref>, in which the population remains monomorphic and is approaching the singular point <inline-formula><mml:math id="inf72"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>. For <inline-formula><mml:math id="inf73"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, the singular point is neutral evolutionarily (all eigenvalues of the Hessian of the invasion fitness function are 0 due to the linearity of the tradeoff), and once the population converges to the singular point, it starts to diversify ‘diffusively’, as anticipated in <xref ref-type="bibr" rid="bib45">Posfai et al., 2017</xref>: neutrality of selection results in communities consisting of a large number of species. Thus, the high diversity observed in this case is an evolutionary consequence of the selective neutrality caused by a linear enzymatic tradeoff.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Snapshots illustrating the beginning, intermediate, and advanced stages of evolution under a linear constraint, <inline-formula><mml:math id="inf74"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> .</title><p>A video of the entire evolutionary process can be found <ext-link ext-link-type="uri" xlink:href="https://figshare.com/s/d59cf5c2f344424f830a">here</ext-link>, frames are recorded every 200 time units until <italic>t</italic>=30,000 and then, to better illustrate slow neutral evolution, the frame recording times <italic>t</italic><sub><italic>i</italic></sub> were defined as a geometric progression <inline-formula><mml:math id="inf75"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1.006</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. Other parameter values were <inline-formula><mml:math id="inf76"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf77"><mml:mrow><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf78"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf79"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-67764-fig1-v2.tif"/></fig><p>The situation changes for non-linear tradeoffs, <inline-formula><mml:math id="inf80"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>≠</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, which generates two very different evolutionary regimes depending on whether <inline-formula><mml:math id="inf81"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf82"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> (even when the deviation of <italic>γ</italic> from one is small). <xref ref-type="fig" rid="fig2">Figure 2(a–c)</xref> shows an example of the evolutionary dynamics for <inline-formula><mml:math id="inf83"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>1.1</mml:mn></mml:mrow></mml:math></inline-formula>.</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Example of evolutionary dynamics for <inline-formula><mml:math id="inf84"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>1.1</mml:mn></mml:mrow></mml:math></inline-formula>, showing convergence to the singular point given by <xref ref-type="disp-formula" rid="equ4">Equation 4</xref> (and indicated by the black dot), but no subsequent diversification.</title><p>The corresponding video can be found <ext-link ext-link-type="uri" xlink:href="https://figshare.com/s/d59cf5c2f344424f830a">here</ext-link> , each frame in the video is separated by 1,000 time steps. Other parameter values were <inline-formula><mml:math id="inf85"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf86"><mml:mrow><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf87"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf88"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.25</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-67764-fig2-v2.tif"/></fig><p>The dynamics starts with an initial monomorphic population far from the singular point, as shown in <xref ref-type="fig" rid="fig2">Figure 2(a)</xref>. As in the linear case, and as predicted by the analytical theory, the monomorphic population converges toward the singular point <xref ref-type="fig" rid="fig2">Figure 2(b)</xref>. However, because <inline-formula><mml:math id="inf89"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> the singular point is evolutionarily stable, and no diversification occurs (apart from mutation-selection balance around the singular point). Instead, when the population reaches the singular point, evolution comes to a halt, and all individuals are generalists, that is, use all resources to some extent (as determined by the location of the singular point), as depicted in <xref ref-type="fig" rid="fig2">Figure 2(c)</xref>.</p><p>On the other hand, <xref ref-type="fig" rid="fig3">Figure 3(a–c)</xref> shows the evolutionary process for a community with <inline-formula><mml:math id="inf90"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:math></inline-formula>. The initial configuration is shown in <xref ref-type="fig" rid="fig3">Figure 3(a)</xref>. As in the previous examples, the initial phase of evolution ends with the population converging to the singular point <inline-formula><mml:math id="inf91"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>. However, in this case, the singular point is an evolutionary branching point giving rise to the emergence of distinct and diverging phenotypic clusters (<xref ref-type="fig" rid="fig3">Figure 3(b)</xref>). The final state of the evolutionary process is shown in <xref ref-type="fig" rid="fig3">Figure 3(c)</xref>: there are three coexisting phenotypic clusters, each being a specialist in exactly one of the resources. Our numerical simulations indicate that the results shown in <xref ref-type="fig" rid="fig1">Figures 1</xref>–<xref ref-type="fig" rid="fig3">3</xref> are general and robust: non-neutral diversification occurs only for <inline-formula><mml:math id="inf92"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and typically leads to coexistence of <inline-formula><mml:math id="inf93"><mml:mi>p</mml:mi></mml:math></inline-formula> specialists. In fact, the results easily generalize to situations in which the exponent <italic>γ</italic> in the tradeoff function may be different for different directions in phenotype space, that is, for different <inline-formula><mml:math id="inf94"><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>. As we show in Appendix 1, evolutionary branching along a direction <inline-formula><mml:math id="inf95"><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> in phenotype space can occur if the corresponding exponent <inline-formula><mml:math id="inf96"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. <xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2</xref> and <xref ref-type="fig" rid="app1fig3">Appendix 1—figure 3</xref> in Appendix 1 illustrate scenarios in which only a subset of the phenotypic directions <inline-formula><mml:math id="inf97"><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> are branching directions along which evolutionary diversification occurs. In such a case, the number of distinct species resulting from the evolutionary process is less than <inline-formula><mml:math id="inf98"><mml:mi>p</mml:mi></mml:math></inline-formula>.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Example of evolutionary dynamics for <inline-formula><mml:math id="inf99"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:math></inline-formula>, showing initial convergence to the singular point (indicated by the black dot) and subsequent diversification into three specialists, each consuming exclusively one of the three resources.</title><p>The corresponding video can be found <ext-link ext-link-type="uri" xlink:href="https://figshare.com/s/d59cf5c2f344424f830a">here</ext-link>, each frame in the video is separated by 1,000 time steps. Other parameter values were <inline-formula><mml:math id="inf100"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf101"><mml:mrow><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf102"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf103"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.25</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-67764-fig3-v2.tif"/></fig><p>Finally, we note that our results for the effects of non-linear tradeoffs on evolutionary dynamics have corresponding results in purely ecological scenarios, such as those studied in <xref ref-type="bibr" rid="bib45">Posfai et al., 2017</xref>. We simulated ecological time scales by seeding the system with a set of for example randomly chosen phenotypes throughout phenotype space and running the population dynamics with the mutational process turned off. Again, as shown in <xref ref-type="fig" rid="app1fig4">Appendix 1—figure 4</xref>, non-linear tradeoffs have a profound effect on the number of surviving species in such ecological simulations, with many species coexisting when <inline-formula><mml:math id="inf104"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, as reported in <xref ref-type="bibr" rid="bib45">Posfai et al., 2017</xref>, but with typically only <inline-formula><mml:math id="inf105"><mml:mi>p</mml:mi></mml:math></inline-formula> species surviving when <inline-formula><mml:math id="inf106"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and only very few species surviving in the close vicinity of the singular point when <inline-formula><mml:math id="inf107"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s1-3"><title>Serial dilution conditions</title><p>Serial dilution conditions are defined as a sequence of explicitly non-stationary inoculation and growth events (<xref ref-type="bibr" rid="bib19">Erez et al., 2020</xref>), which mimics seasonality or batch culture experiments (e.g., <xref ref-type="bibr" rid="bib34">Lenski and Travisano, 1994</xref>). Each growth phase starts with the introduction of a diluted collection of species from a previous batch<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>α</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>into a fresh batch of resources with a given composition <inline-formula><mml:math id="inf108"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. In each batch, the species densities <inline-formula><mml:math id="inf109"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> increase with time as <disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>while resources are depleted:<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>α</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Unlike in the chemostat model, the death of individuals and the decay of resources are ignored (<inline-formula><mml:math id="inf110"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf111"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>). Each event ends at time <inline-formula><mml:math id="inf112"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> when all resources are almost completely depleted,<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:mrow><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>and the process is repeated.</p><p>Due to the explicit non-stationarity of such serial dilution processes, one of the main assumptions of our adaptive dynamics analysis, the stationarity of resident populations, is not satisfied. Nevertheless, our numerical simulations show that the conclusions drawn for the chemostat case also hold for the serial dilution conditions, to the point that the simulation snapshots are visually indistinguishable from those shown in <xref ref-type="fig" rid="fig2">Figure 2</xref> and <xref ref-type="fig" rid="fig3">Figure 3</xref>. However, in the videos, which can be found <ext-link ext-link-type="uri" xlink:href="https://figshare.com/s/3eb51bad58ae95b8b0f3">here</ext-link> , it is possible to see the oscillating population density, caused by the serial dilution protocol.</p><p>Specifically, we simulated the serial dilution for three limits considered in <xref ref-type="bibr" rid="bib19">Erez et al., 2020</xref>, <inline-formula><mml:math id="inf113"><mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>10</mml:mn><mml:mo>⁢</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf114"><mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf115"><mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.1</mml:mn><mml:mo>⁢</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf116"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf117"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. All other parameters were the same as used in <xref ref-type="fig" rid="fig1">Figure 1</xref>, <xref ref-type="fig" rid="fig2">Figure 2</xref>, <xref ref-type="fig" rid="fig3">Figure 3</xref> and corresponding videos.</p><p>In all three cases <inline-formula><mml:math id="inf118"><mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≫</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf119"><mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∼</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf120"><mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≪</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>, we observed that for <inline-formula><mml:math id="inf121"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, the monomorphic population converges toward the singular point <inline-formula><mml:math id="inf122"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2(b)</xref>) and video files <ext-link ext-link-type="uri" xlink:href="https://figshare.com/s/3eb51bad58ae95b8b0f3">here</ext-link> . The singular point is evolutionarily stable, hence, as shown in <xref ref-type="fig" rid="fig2">Figure 2(c)</xref>, no subsequent diversification occurs (apart from narrow mutation-selection spreading around the singular point).</p><p>On the contrary, <xref ref-type="fig" rid="fig3">Figure 3(a–c)</xref> and videos accessible <ext-link ext-link-type="uri" xlink:href="https://figshare.com/s/3eb51bad58ae95b8b0f3">here</ext-link> show the evolutionary process for a community with <inline-formula><mml:math id="inf123"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. The initial configuration is shown in <xref ref-type="fig" rid="fig3">Figure 3(a)</xref>. As in the previous examples, in the initial phase the monomorphic population evolves close to the singular point <inline-formula><mml:math id="inf124"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>. However, in this case, the singular point is again an evolutionary branching point giving rise to the emergence of distinct and diverging phenotypic clusters (<xref ref-type="fig" rid="fig3">Figure 3(b)</xref>). The final state of the evolutionary process is shown in <xref ref-type="fig" rid="fig3">Figure 3(c)</xref>: there are three coexisting phenotypic clusters, each being a specialist on one of the resources.</p><p>In addition, purely ecological (i.e., mutationless) simulations performed similarly to what is described above and in <xref ref-type="bibr" rid="bib19">Erez et al., 2020</xref> resulted in similar outcomes as in the chemostat model. In a system initially filled with many (200) species, only a few species survive after a fairly short transitory time. When <inline-formula><mml:math id="inf125"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, one or a few species remain very close to the singular point <inline-formula><mml:math id="inf126"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>, while for <inline-formula><mml:math id="inf127"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, typically <inline-formula><mml:math id="inf128"><mml:mi>p</mml:mi></mml:math></inline-formula> specialist species remain in the system. The videos of pure ecological simulations can be seen <ext-link ext-link-type="uri" xlink:href="https://figshare.com/s/3eb51bad58ae95b8b0f3">here</ext-link>.</p><p>Once evolution has come to its steady state, resulting in a single generalist species when <inline-formula><mml:math id="inf129"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf130"><mml:mi>p</mml:mi></mml:math></inline-formula> specialist species when <inline-formula><mml:math id="inf131"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, each species is represented by a ‘cloud’ of phenotypes <italic>α</italic> (Panel C in <xref ref-type="fig" rid="fig2">Figure 2</xref> and <xref ref-type="fig" rid="fig3">Figure 3</xref>). Such a cloud is formed by a competition between the deterministic selection gradient that acts toward the center of the cloud, making the survival of peripheral species less likely, and the stochastic mutational process that broadens the distribution of strains in all directions, ‘reseeding’ new strains everywhere in the cloud, including its periphery. This is analogous to the classical mutation-selection balance occurring with stabilizing selection. When stabilizing selection is relatively weak, which occurs when the tradeoff is only weakly non-linear (with <italic>γ</italic> close to 1), the dispersion of phenotypes around the centers of clouds is larger. Technically, this can be concluded from the factor <inline-formula><mml:math id="inf132"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>γ</mml:mi></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ28">Equation A20</xref>. Thus, we make a potentially testable predictions that a weaker non-linearity in tradeoffs or uptake rates should result in broader distributions of corresponding phenotypes within specialist or generalist species. At the same time, the perspective of mutation-selection balance makes it easier to see the difference between the neutral evolutionary scenario of linear tradeoffs and the weakly non-linear case: While in the former case the distribution of strains will be uniform across the simplex (constrained only by the ‘convex envelope’ condition; <xref ref-type="bibr" rid="bib45">Posfai et al., 2017</xref>), the non-linear tradeoffs lead to distinct species with well-localized distributions of phenotypes for any <inline-formula><mml:math id="inf133"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>≠</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. In an analogy with critical phenomena in physics, correlations typically decay exponentially, except at critical points, where they are exceptionally long-ranged. Such an ‘anomalous’ behavior requires careful tuning of parameters to get exactly to the critical point, unless the system is ‘self-organized critical’. A similar situation appears to be the case with linear tradeoffs. It could be possible in principle that a system possesses carefully adjusted metabolic parameters so that for a range of uptake rates, the tradeoffs in enzyme concentrations are linear. Yet there appears to be no evolutionary reason for ‘self-organization’ to such a state, and the accidental cancelation of all non-linearities is very unlikely.</p></sec></sec><sec id="s2" sec-type="discussion"><title>Discussion</title><p>To understand the origin and maintenance of diversity is a fundamental question in science. In particular, the mechanisms of diversification due to ecological interactions still generate lively debates.</p><p>Recently, tradeoffs in the rates of uptake of different resources were suggested as a mechanism to generate large amounts of diversity (<xref ref-type="bibr" rid="bib45">Posfai et al., 2017</xref>; <xref ref-type="bibr" rid="bib19">Erez et al., 2020</xref>), possibly solving the ‘paradox of the plankton’ (<xref ref-type="bibr" rid="bib29">Hutchinson, 1961</xref>), and violating the competitive exclusion principle (<xref ref-type="bibr" rid="bib24">Hardin, 1960</xref>), which states that the number of coexisting species should not exceed the number of resources. It has been shown that enzymatic allocation strategies that are plastic instead of fixed, so that individuals can change their allocation (while maintaining a linear tradeoff under a fixed allocation budget) in response to resource availability during their lifetime, tend to reduce the amount of diversity maintained in the ecological communities (<xref ref-type="bibr" rid="bib44">Pacciani-Mori et al., 2020</xref>). Perhaps this is not surprising, since more plastic strategies tend to be able to be more generalist as well. As in <xref ref-type="bibr" rid="bib45">Posfai et al., 2017</xref>; <xref ref-type="bibr" rid="bib19">Erez et al., 2020</xref>, here, we consider the case of non-plastic strategies, in which each individual is defined by its allocation vector <italic>α</italic>, but assuming a more general, non-linear form of tradeoffs. Moreover, we investigate evolutionary rather than just ecological dynamics to determine the conditions under which evolutionary diversification can occur. There are no true jacks-of-all trades in biology and tradeoffs are a ubiquitous assumption in evolutionary thinking and modeling. However, the cellular and physiological mechanisms that underly such tradeoffs are typically very complicated and the result of biochemical interactions between many different metabolic pathways. Attempts have been made to understand tradeoffs more mechanistically, particularly in microbes (<xref ref-type="bibr" rid="bib35">Litchman et al., 2015</xref>), but higher-level modeling efforts most often still require a mostly phenomenological approach to incorporating tradeoffs. In this paper we assumed that each of <inline-formula><mml:math id="inf134"><mml:mi>p</mml:mi></mml:math></inline-formula> resources is available to each microbial organism at a certain rate that depends on the resource concentration in the system. The microbe in turn is described phenotypically by the metabolic allocation strategy that defines its uptake of the available resources.</p><p>Without tradeoffs, and everything else being equal, the best strategy would be to allocate an infinite amount (or at least the maximal amount possible) of metabolic activity to every resource, a scenario that is generally unrealistic biologically. Rather, tradeoffs inherent to cell metabolism prevent such strategies. Formally, tradeoffs are given by one or more equations (or more generally inequalities) that the phenotypes of individuals have to satisfy.</p><p>In our simplistic models, tradeoffs are determined by the parameter <italic>γ</italic>, which essentially describes the curvature of the tradeoff function, with the linear tradeoff <inline-formula><mml:math id="inf135"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> being the threshold between concave (<inline-formula><mml:math id="inf136"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) and convex (<inline-formula><mml:math id="inf137"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) tradeoffs. Formally, linear tradeoffs are the simplest case, but there is no a priori general reason why tradeoffs should be linear. Our results show that generically, diversity only evolves with concave tradeoffs, and the number of coexisting species never exceeds the number of resources. Only in the structurally unstable linear case (<inline-formula><mml:math id="inf138"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>), it is possible for very high levels of diversity to evolve due to the cessation of selection at the evolutionary equilibrium. Any value of <inline-formula><mml:math id="inf139"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>≠</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> precludes high amounts of diversity. Extensive numerical explorations revealed that these results are robust and qualitatively independent of particular parameter choices, such as the number of resources or the dynamics of resource input.</p><p>Furthermore, in Appendix 1 we show that the originally non-linear tradeoffs can be made linear by re-defining uptake rates <inline-formula><mml:math id="inf140"><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ16">Equation A8</xref>), thus ‘transferring’ the non-linearity to the nutrient uptake and the birth rate functions (<xref ref-type="disp-formula" rid="equ16">Equation A8</xref>). But a metabolic and nutrient uptake rate is itself a linear function in the enzyme concentration only when the concentration of the substrate vastly exceeds the enzyme concentration. A good example is the well-known Michaelis-Menten approximation, which is identical to the formula used in <xref ref-type="bibr" rid="bib45">Posfai et al., 2017</xref>; <xref ref-type="bibr" rid="bib19">Erez et al., 2020</xref> for the dependence of nutrient uptake on enzyme allocation <italic>α</italic>. While such linear approximations have been successfully applied in chemical kinetics for over a century, often without questioning their formal validity, the effect of linearization on ecological and evolutionary properties turns out to be very significant. The Michaelis-Menten kinetics is valid when the formation of enzyme-substrate complexes does not reduce the concentration of free substrate. Yet the intracellular concentration of enzymes in bacteria are often comparable to or are just few- or 10-fold smaller than those of their substrates (<xref ref-type="bibr" rid="bib5">Bennett et al., 2009</xref>; <xref ref-type="bibr" rid="bib43">Milo et al., 2010</xref>). In Appendix 1 we sketch a derivation of kinetics of an enzymatic reaction in the general case assuming the steadiness of the concentration of the enzyme-substrate complex, but without the assumption that the enzyme concentration is negligible compared to that of the substrate. It follows that enzymatic reaction rates are generally sublinear in the concentrations of enzymes, which is intuitively clear from considering the rate saturation in the limit of infinite enzyme concentrations. However, sublinear rates are not the only possible deviation from linearity: the formation of enzyme oligomers (<xref ref-type="bibr" rid="bib39">Marianayagam et al., 2004</xref>, <xref ref-type="bibr" rid="bib57">Traut, 1994</xref>; <xref ref-type="bibr" rid="bib3">Ali and Imperiali, 2005</xref>; <xref ref-type="bibr" rid="bib57">Traut, 1994</xref>) and spatially organized complexes (<xref ref-type="bibr" rid="bib53">Schmitt and An, 2017</xref>) are controlled by intrinsically non-linear (superlinear in case of homo-oligomers) mass action equilibria, thus making the enzymatic rates generally sigmoid functions (<xref ref-type="bibr" rid="bib46">Ricard and Noat, 1986</xref>) of the amount of enzyme. Again, it follows that the physiological costs of the production of individual enzymes are typically non-linear.</p><p>There are also more direct ways to demonstrate the ubiquity of non-linear dependences of metabolic rates or fluxes <inline-formula><mml:math id="inf141"><mml:mi>f</mml:mi></mml:math></inline-formula> on enzyme concentrations <italic>α</italic>, for which quantities known as reaction elasticities or flux control coefficients are normally defined as double-logarithmic derivative, <inline-formula><mml:math id="inf142"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. For example, for a general power law <inline-formula><mml:math id="inf143"><mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≡</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>α</mml:mi><mml:mi>γ</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> that we used to define metabolic tradeoffs (or uptake rates, see Appendix 1), the log-log derivative is equal to <italic>γ</italic>, the non-linearity parameter. For the tradeoffs used in <xref ref-type="bibr" rid="bib45">Posfai et al., 2017</xref>; <xref ref-type="bibr" rid="bib19">Erez et al., 2020</xref>, this derivate is always 1. However, it is not surprising that realistic assessments of such coefficients (e.g. <xref ref-type="bibr" rid="bib36">Loder et al., 2016</xref>; <xref ref-type="bibr" rid="bib22">Giersch, 1995</xref>; <xref ref-type="bibr" rid="bib55">Sun and Qian, 2002</xref>; <xref ref-type="bibr" rid="bib50">Saavedra et al., 2005</xref>; <xref ref-type="bibr" rid="bib48">Rohwer et al., 2000</xref>; <xref ref-type="bibr" rid="bib49">Rutkis et al., 2013</xref>; <xref ref-type="bibr" rid="bib52">Schmidt et al., 2016</xref>; <xref ref-type="bibr" rid="bib58">van der Vlag et al., 1995</xref>; and many other references) produce values that rarely come close to 1, and hence that the measured dependencies of metabolic fluxes on enzyme concentrations are significantly non-linear. For an easier parametrization of these non-linearities, it was suggested to express rates of complex enzymatic reactions as products of power-law functions of concentrations of enzymes and substrates (<xref ref-type="bibr" rid="bib51">Savageau, 1969</xref>). This idea, originally suggested more than 50 years ago, has since developed a substantial following, which once again indicates the necessity to account for non-linearity in the kinetics of enzymatic pathways. All this indicates that reaction elasticities and flux control coefficients are typically distinct from one, which is essentially the main <italic>raison d’être</italic> for those quantities and for the science of metabolic engineering itself.</p><p>Whether sub- or super-linear, any deviation of the growth rates from the linear form (<xref ref-type="disp-formula" rid="equ3">Equation 3</xref>) and <xref ref-type="disp-formula" rid="equ11">Equation A3</xref> results in a revalidation of the competitive exclusion limit, similarly to non-linearity in tradeoffs. This serves as another indication that linear tradeoffs in metabolic rates is a biologically unrealistic and exceptional case, while generic non-linearities do not generate high levels of diversity, and instead the outcomes are in line with classical results about the evolution of resource generalists vs. resource specialists (<xref ref-type="bibr" rid="bib37">Ma and Levin, 2006</xref>).</p><p>It is well known that the shape of tradeoff curves is, in general, an important component in adaptive dynamics models (<xref ref-type="bibr" rid="bib31">Kisdi, 2006</xref>; <xref ref-type="bibr" rid="bib32">Kisdi, 2015</xref>). In particular, studies of evolution of cooperation (e.g. <xref ref-type="bibr" rid="bib8">Damore and Gore, 2012</xref>; <xref ref-type="bibr" rid="bib4">Archetti and Scheuring, 2012</xref>) have stressed that the outcome of evolution is conditional on the curvature of the public good and cost functions and provided numerous biochemical reasons for non-linearity of metabolic rates in enzyme concentrations. Here, we have shown the importance of the tradeoff curvature for the evolution and maintenance of diversity in a general consumer-resource model. Of course, many potentially important ingredients that could yet lead to high or low diversity in these models were not considered in the present work. For example, dynamic and optimal metabolic strategies (<xref ref-type="bibr" rid="bib44">Pacciani-Mori et al., 2020</xref>) and cross-feeding have recently been suggested as factors that could potentially enable such diversity (<xref ref-type="bibr" rid="bib23">Goyal and Maslov, 2018</xref>), while ‘soft constraints’ that allow random deviations of metabolic strategies from the exact tradeoff constraint were reported in <xref ref-type="bibr" rid="bib7">Cui et al., 2020</xref> to reduce the diversity even below the competitive exclusion limit. It will be interesting to consider these model extensions with non-linear tradeoffs.</p><p>Furthermore, it is possible that non-equilibrium ecological dynamics can allow for the maintenance of excess diversity. While this is not the case for externally imposed batch culture dynamics, as reported in the present paper, we have recently shown, using a different ecological model (<xref ref-type="bibr" rid="bib14">Doebeli et al., 2021</xref>), that endogenous non-stationary ‘boom-bust’ population dynamics can lead to a significant increase in diversity above the saturation limit expected with equilibrium population dynamics. Together with many experimental results reporting non-stationarity and apparent chaoticity of the population dynamics of actual plankton species, this leads to the conjecture that rather than the neutral evolutionary regime predicted in <xref ref-type="bibr" rid="bib45">Posfai et al., 2017</xref>, non-stationary population dynamics induced by competition and predation (and perhaps external factors) may be more important in explaining high levels of diversity in natural systems.</p></sec></body><back><sec id="s3" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf2"><p>Reviewing Editor, <italic>eLife</italic></p></fn><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Software, Formal analysis, Investigation, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Data curation, Software, Formal analysis, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Data curation, Formal analysis, Supervision, Funding acquisition, Investigation, Methodology, Writing - original draft, Project administration, Writing - review and editing</p></fn></fn-group></sec><sec id="s4" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-67764-transrepform-v2.pdf"/></supplementary-material></sec><sec id="s5" sec-type="data-availability"><title>Data availability</title><p>All data generated or analysed during this study are obtained through the codes which have been deposited in <ext-link ext-link-type="uri" xlink:href="https://github.com/jaros007/Codes_for_Evolution_of_diversity_in_metabolic_strategies">https://github.com/jaros007/Codes_for_Evolution_of_diversity_in_metabolic_strategies</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:rev:d0a9ad7ca4459a1cc221b7bf1d1d311733400f0a">https://archive.softwareheritage.org/swh:1:rev:d0a9ad7ca4459a1cc221b7bf1d1d311733400f0a</ext-link>).</p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abrams</surname> <given-names>PA</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>Character displacement and niche shift analyzed using consumer-resource models of competition</article-title><source>Theoretical Population Biology</source><volume>29</volume><fpage>107</fpage><lpage>160</lpage><pub-id pub-id-type="doi">10.1016/0040-5809(86)90007-9</pub-id><pub-id pub-id-type="pmid">3961709</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ackermann</surname> <given-names>M</given-names></name><name><surname>Doebeli</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Evolution of niche width and adaptive diversification</article-title><source>Evolution</source><volume>58</volume><fpage>2599</fpage><lpage>2612</lpage><pub-id pub-id-type="doi">10.1111/j.0014-3820.2004.tb01614.x</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ali</surname> <given-names>MH</given-names></name><name><surname>Imperiali</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Protein oligomerization: how and why</article-title><source>Bioorganic &amp; Medicinal Chemistry</source><volume>13</volume><fpage>5013</fpage><lpage>5020</lpage><pub-id pub-id-type="doi">10.1016/j.bmc.2005.05.037</pub-id><pub-id pub-id-type="pmid">15993087</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Archetti</surname> <given-names>M</given-names></name><name><surname>Scheuring</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Review: game theory of public goods in one-shot social dilemmas without assortment</article-title><source>Journal of Theoretical Biology</source><volume>299</volume><fpage>9</fpage><lpage>20</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2011.06.018</pub-id><pub-id pub-id-type="pmid">21723299</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bennett</surname> <given-names>BD</given-names></name><name><surname>Kimball</surname> <given-names>EH</given-names></name><name><surname>Gao</surname> <given-names>M</given-names></name><name><surname>Osterhout</surname> <given-names>R</given-names></name><name><surname>Van Dien</surname> <given-names>SJ</given-names></name><name><surname>Rabinowitz</surname> <given-names>JD</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Absolute metabolite concentrations and implied enzyme active site occupancy in <italic>Escherichia coli</italic></article-title><source>Nature Chemical Biology</source><volume>5</volume><fpage>593</fpage><lpage>599</lpage><pub-id pub-id-type="doi">10.1038/nchembio.186</pub-id><pub-id pub-id-type="pmid">19561621</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Coyne</surname> <given-names>JA</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Genetics and speciation</article-title><source>Nature</source><volume>355</volume><fpage>511</fpage><lpage>515</lpage><pub-id pub-id-type="doi">10.1038/355511a0</pub-id><pub-id pub-id-type="pmid">1741030</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cui</surname> <given-names>W</given-names></name><name><surname>Marsland</surname> <given-names>R</given-names></name><name><surname>Mehta</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Effect of resource dynamics on species packing in diverse ecosystems</article-title><source>Physical Review Letters</source><volume>125</volume><elocation-id>048101</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.125.048101</pub-id><pub-id pub-id-type="pmid">32794828</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Damore</surname> <given-names>JA</given-names></name><name><surname>Gore</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Understanding microbial cooperation</article-title><source>Journal of Theoretical Biology</source><volume>299</volume><fpage>31</fpage><lpage>41</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2011.03.008</pub-id><pub-id pub-id-type="pmid">21419783</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Darwin</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="1859">1859</year><source>On the Origin of Species by Means of Natural Selection</source><publisher-loc>Murray, London</publisher-loc><publisher-name>The royal society</publisher-name></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Aguiar</surname> <given-names>MA</given-names></name><name><surname>Baranger</surname> <given-names>M</given-names></name><name><surname>Baptestini</surname> <given-names>EM</given-names></name><name><surname>Kaufman</surname> <given-names>L</given-names></name><name><surname>Bar-Yam</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Global patterns of speciation and diversity</article-title><source>Nature</source><volume>460</volume><fpage>384</fpage><lpage>387</lpage><pub-id pub-id-type="doi">10.1038/nature08168</pub-id><pub-id pub-id-type="pmid">19606148</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dieckmann</surname> <given-names>U</given-names></name><name><surname>Doebeli</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>On the origin of species by sympatric speciation</article-title><source>Nature</source><volume>400</volume><fpage>354</fpage><lpage>357</lpage><pub-id pub-id-type="doi">10.1038/22521</pub-id><pub-id pub-id-type="pmid">10432112</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dieckmann</surname> <given-names>U</given-names></name><name><surname>Law</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>The dynamical theory of coevolution: a derivation from stochastic ecological processes</article-title><source>Journal of Mathematical Biology</source><volume>34</volume><fpage>579</fpage><lpage>612</lpage><pub-id pub-id-type="doi">10.1007/BF02409751</pub-id><pub-id pub-id-type="pmid">8691086</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Doebeli</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><source>Adaptive Diversification (MPB-48)</source><publisher-loc>Princeton, United States</publisher-loc><publisher-name>Princeton University Press</publisher-name></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doebeli</surname> <given-names>M</given-names></name><name><surname>Jaque</surname> <given-names>EC</given-names></name><name><surname>Ispolatov</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Boom-bust population dynamics increase diversity in evolving competitive communities</article-title><source>Communications Biology</source><volume>4</volume><fpage>1</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1038/s42003-021-02021-4</pub-id><pub-id pub-id-type="pmid">33893395</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doebeli</surname> <given-names>M</given-names></name><name><surname>Dieckmann</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Evolutionary branching and sympatric speciation caused by different types of ecological interactions</article-title><source>The American Naturalist</source><volume>156</volume><fpage>S77</fpage><lpage>S101</lpage><pub-id pub-id-type="doi">10.1086/303417</pub-id><pub-id pub-id-type="pmid">29592583</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doebeli</surname> <given-names>M</given-names></name><name><surname>Dieckmann</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Speciation along environmental gradients</article-title><source>Nature</source><volume>421</volume><fpage>259</fpage><lpage>264</lpage><pub-id pub-id-type="doi">10.1038/nature01274</pub-id><pub-id pub-id-type="pmid">12529641</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doebeli</surname> <given-names>M</given-names></name><name><surname>Ispolatov</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Continuously stable strategies as evolutionary branching points</article-title><source>Journal of Theoretical Biology</source><volume>266</volume><fpage>529</fpage><lpage>535</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2010.06.036</pub-id><pub-id pub-id-type="pmid">20638389</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doebeli</surname> <given-names>M</given-names></name><name><surname>Ispolatov</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Diversity and coevolutionary dynamics in High-Dimensional phenotype spaces</article-title><source>The American Naturalist</source><volume>189</volume><fpage>105</fpage><lpage>120</lpage><pub-id pub-id-type="doi">10.1086/689891</pub-id><pub-id pub-id-type="pmid">28107053</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Erez</surname> <given-names>A</given-names></name><name><surname>Lopez</surname> <given-names>JG</given-names></name><name><surname>Weiner</surname> <given-names>BG</given-names></name><name><surname>Meir</surname> <given-names>Y</given-names></name><name><surname>Wingreen</surname> <given-names>NS</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Nutrient levels and trade-offs control diversity in a serial dilution ecosystem</article-title><source>eLife</source><volume>9</volume><elocation-id>e57790</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.57790</pub-id><pub-id pub-id-type="pmid">32915132</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gavrilets</surname> <given-names>S</given-names></name><name><surname>Waxman</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Sympatric speciation by sexual conflict</article-title><source>PNAS</source><volume>99</volume><elocation-id>10533</elocation-id><pub-id pub-id-type="doi">10.1073/pnas.152011499</pub-id><pub-id pub-id-type="pmid">12149438</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Geritz</surname> <given-names>SAH</given-names></name><name><surname>Metz</surname> <given-names>JAJ</given-names></name><name><surname>Kisdi</surname> <given-names>Éva</given-names></name><name><surname>Meszéna</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Dynamics of adaptation and evolutionary branching</article-title><source>Physical Review Letters</source><volume>78</volume><fpage>2024</fpage><lpage>2027</lpage><pub-id pub-id-type="doi">10.1103/PhysRevLett.78.2024</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Giersch</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Determining elasticities from multiple measurements of flux rates and metabolite concentrations application of the multiple modulation method to a reconstituted pathway</article-title><source>European Journal of Biochemistry</source><volume>227</volume><fpage>194</fpage><lpage>201</lpage><pub-id pub-id-type="doi">10.1111/j.1432-1033.1995.tb20376.x</pub-id><pub-id pub-id-type="pmid">7851386</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goyal</surname> <given-names>A</given-names></name><name><surname>Maslov</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Diversity, stability, and reproducibility in stochastically assembled microbial ecosystems</article-title><source>Physical Review Letters</source><volume>120</volume><elocation-id>158102</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.120.158102</pub-id><pub-id pub-id-type="pmid">29756882</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hardin</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="1960">1960</year><article-title>The competitive exclusion principle</article-title><source>Science</source><volume>131</volume><fpage>1292</fpage><lpage>1297</lpage><pub-id pub-id-type="doi">10.1126/science.131.3409.1292</pub-id><pub-id pub-id-type="pmid">14399717</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hawksworth</surname> <given-names>DL</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>The magnitude of fungal diversity: the 1.5 million species estimate revisited</article-title><source>Mycological Research</source><volume>105</volume><fpage>1422</fpage><lpage>1432</lpage><pub-id pub-id-type="doi">10.1017/S0953756201004725</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hawksworth</surname> <given-names>DL</given-names></name><name><surname>Lücking</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Fungal diversity revisited: 2.2 to 3.8 million species</article-title><source>Microbiology Spectrum</source><volume>5</volume><elocation-id>2016</elocation-id><pub-id pub-id-type="doi">10.1128/microbiolspec.FUNK-0052-2016</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Higashi</surname> <given-names>M</given-names></name><name><surname>Takimoto</surname> <given-names>G</given-names></name><name><surname>Yamamura</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Sympatric speciation by sexual selection</article-title><source>Nature</source><volume>402</volume><fpage>523</fpage><lpage>526</lpage><pub-id pub-id-type="doi">10.1038/990087</pub-id><pub-id pub-id-type="pmid">10591210</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hui</surname> <given-names>C</given-names></name><name><surname>Minoarivelo</surname> <given-names>HO</given-names></name><name><surname>Landi</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Modelling coevolution in ecological networks with adaptive dynamics</article-title><source>Mathematical Methods in the Applied Sciences</source><volume>41</volume><fpage>8407</fpage><lpage>8422</lpage><pub-id pub-id-type="doi">10.1002/mma.4612</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hutchinson</surname> <given-names>GE</given-names></name></person-group><year iso-8601-date="1961">1961</year><article-title>The paradox of the plankton</article-title><source>The American Naturalist</source><volume>95</volume><fpage>137</fpage><lpage>145</lpage><pub-id pub-id-type="doi">10.1086/282171</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ito</surname> <given-names>H</given-names></name><name><surname>Sasaki</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Evolutionary branching under multi-dimensional evolutionary constraints</article-title><source>Journal of Theoretical Biology</source><volume>407</volume><fpage>409</fpage><lpage>428</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2016.07.011</pub-id><pub-id pub-id-type="pmid">27444402</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kisdi</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Trade-off geometries and the adaptive dynamics of two co-evolving species</article-title><source>Evolutionary Ecology Research</source><volume>8</volume><fpage>959</fpage><lpage>973</lpage></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kisdi</surname> <given-names>É</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Construction of multiple trade-offs to obtain arbitrary singularities of adaptive dynamics</article-title><source>Journal of Mathematical Biology</source><volume>70</volume><fpage>1093</fpage><lpage>1117</lpage><pub-id pub-id-type="doi">10.1007/s00285-014-0788-5</pub-id><pub-id pub-id-type="pmid">24801473</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Larsen</surname> <given-names>BB</given-names></name><name><surname>Miller</surname> <given-names>EC</given-names></name><name><surname>Rhodes</surname> <given-names>MK</given-names></name><name><surname>Wiens</surname> <given-names>JJ</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Inordinate fondness multiplied and redistributed: the number of species on earth and the new pie of life</article-title><source>The Quarterly Review of Biology</source><volume>92</volume><fpage>229</fpage><lpage>265</lpage><pub-id pub-id-type="doi">10.1086/693564</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lenski</surname> <given-names>RE</given-names></name><name><surname>Travisano</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Dynamics of adaptation and diversification: a 10,000-generation experiment with bacterial populations</article-title><source>PNAS</source><volume>91</volume><fpage>6808</fpage><lpage>6814</lpage><pub-id pub-id-type="doi">10.1073/pnas.91.15.6808</pub-id><pub-id pub-id-type="pmid">8041701</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Litchman</surname> <given-names>E</given-names></name><name><surname>Edwards</surname> <given-names>KF</given-names></name><name><surname>Klausmeier</surname> <given-names>CA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Microbial resource utilization traits and trade-offs: implications for community structure, functioning, and biogeochemical impacts at present and in the future</article-title><source>Frontiers in Microbiology</source><volume>6</volume><elocation-id>254</elocation-id><pub-id pub-id-type="doi">10.3389/fmicb.2015.00254</pub-id><pub-id pub-id-type="pmid">25904900</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Loder</surname> <given-names>AJ</given-names></name><name><surname>Han</surname> <given-names>Y</given-names></name><name><surname>Hawkins</surname> <given-names>AB</given-names></name><name><surname>Lian</surname> <given-names>H</given-names></name><name><surname>Lipscomb</surname> <given-names>GL</given-names></name><name><surname>Schut</surname> <given-names>GJ</given-names></name><name><surname>Keller</surname> <given-names>MW</given-names></name><name><surname>Adams</surname> <given-names>MWW</given-names></name><name><surname>Kelly</surname> <given-names>RM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Reaction kinetic analysis of the 3-hydroxypropionate/4-hydroxybutyrate CO<sub>2</sub> fixation cycle in extremely thermoacidophilic archaea</article-title><source>Metabolic Engineering</source><volume>38</volume><fpage>446</fpage><lpage>463</lpage><pub-id pub-id-type="doi">10.1016/j.ymben.2016.10.009</pub-id><pub-id pub-id-type="pmid">27771364</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ma</surname> <given-names>J</given-names></name><name><surname>Levin</surname> <given-names>SA</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>The evolution of resource adaptation: how generalist and specialist consumers evolve</article-title><source>Bulletin of Mathematical Biology</source><volume>68</volume><fpage>1111</fpage><lpage>1123</lpage><pub-id pub-id-type="doi">10.1007/s11538-006-9096-6</pub-id><pub-id pub-id-type="pmid">16832741</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Macarthur</surname> <given-names>R</given-names></name><name><surname>Levins</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="1967">1967</year><article-title>The limiting similarity, convergence, and divergence of coexisting species</article-title><source>The American Naturalist</source><volume>101</volume><fpage>377</fpage><lpage>385</lpage><pub-id pub-id-type="doi">10.1086/282505</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marianayagam</surname> <given-names>NJ</given-names></name><name><surname>Sunde</surname> <given-names>M</given-names></name><name><surname>Matthews</surname> <given-names>JM</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>The power of two: protein dimerization in biology</article-title><source>Trends in Biochemical Sciences</source><volume>29</volume><fpage>618</fpage><lpage>625</lpage><pub-id pub-id-type="doi">10.1016/j.tibs.2004.09.006</pub-id><pub-id pub-id-type="pmid">15501681</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>May</surname> <given-names>RM</given-names></name></person-group><year iso-8601-date="1988">1988</year><article-title>How many species are there on earth?</article-title><source>Science</source><volume>241</volume><fpage>1441</fpage><lpage>1449</lpage><pub-id pub-id-type="doi">10.1126/science.241.4872.1441</pub-id><pub-id pub-id-type="pmid">17790039</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Mayr</surname> <given-names>E</given-names></name><name><surname>Mayr</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="1963">1963</year><source>Animal Species and Evolution</source><publisher-name>Belknap Press</publisher-name></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Metz</surname> <given-names>JA</given-names></name><name><surname>Nisbet</surname> <given-names>RM</given-names></name><name><surname>Geritz</surname> <given-names>SA</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>How should we define 'fitness' for general ecological scenarios?</article-title><source>Trends in Ecology &amp; Evolution</source><volume>7</volume><fpage>198</fpage><lpage>202</lpage><pub-id pub-id-type="doi">10.1016/0169-5347(92)90073-K</pub-id><pub-id pub-id-type="pmid">21236007</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Milo</surname> <given-names>R</given-names></name><name><surname>Jorgensen</surname> <given-names>P</given-names></name><name><surname>Moran</surname> <given-names>U</given-names></name><name><surname>Weber</surname> <given-names>G</given-names></name><name><surname>Springer</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>BioNumbers--the database of key numbers in molecular and cell biology</article-title><source>Nucleic Acids Research</source><volume>38</volume><fpage>D750</fpage><lpage>D753</lpage><pub-id pub-id-type="doi">10.1093/nar/gkp889</pub-id><pub-id pub-id-type="pmid">19854939</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pacciani-Mori</surname> <given-names>L</given-names></name><name><surname>Giometto</surname> <given-names>A</given-names></name><name><surname>Suweis</surname> <given-names>S</given-names></name><name><surname>Maritan</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Dynamic metabolic adaptation can promote species coexistence in competitive microbial communities</article-title><source>PLOS Computational Biology</source><volume>16</volume><elocation-id>e1007896</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1007896</pub-id><pub-id pub-id-type="pmid">32379752</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Posfai</surname> <given-names>A</given-names></name><name><surname>Taillefumier</surname> <given-names>T</given-names></name><name><surname>Wingreen</surname> <given-names>NS</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Metabolic Trade-Offs promote diversity in a model ecosystem</article-title><source>Physical Review Letters</source><volume>118</volume><elocation-id>028103</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.118.028103</pub-id><pub-id pub-id-type="pmid">28128613</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ricard</surname> <given-names>J</given-names></name><name><surname>Noat</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>Catalytic efficiency, kinetic co-operativity of oligomeric enzymes and evolution</article-title><source>Journal of Theoretical Biology</source><volume>123</volume><fpage>431</fpage><lpage>451</lpage><pub-id pub-id-type="doi">10.1016/s0022-5193(86)80212-0</pub-id><pub-id pub-id-type="pmid">3657187</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rice</surname> <given-names>WR</given-names></name><name><surname>Hostert</surname> <given-names>EE</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Laboratory experiments of speciation: what have we learned in 40 years?</article-title><source>Evolution</source><volume>47</volume><fpage>1637</fpage><lpage>1653</lpage></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rohwer</surname> <given-names>JM</given-names></name><name><surname>Meadow</surname> <given-names>ND</given-names></name><name><surname>Roseman</surname> <given-names>S</given-names></name><name><surname>Westerhoff</surname> <given-names>HV</given-names></name><name><surname>Postma</surname> <given-names>PW</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Understanding glucose transport by the bacterial phosphoenolpyruvate:glycose phosphotransferase system on the basis of kinetic measurements in vitro</article-title><source>Journal of Biological Chemistry</source><volume>275</volume><fpage>34909</fpage><lpage>34921</lpage><pub-id pub-id-type="doi">10.1074/jbc.M002461200</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rutkis</surname> <given-names>R</given-names></name><name><surname>Kalnenieks</surname> <given-names>U</given-names></name><name><surname>Stalidzans</surname> <given-names>E</given-names></name><name><surname>Fell</surname> <given-names>DA</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Kinetic modelling of the Zymomonas mobilis Entner-Doudoroff pathway: insights into control and functionality</article-title><source>Microbiology</source><volume>159</volume><fpage>2674</fpage><lpage>2689</lpage><pub-id pub-id-type="doi">10.1099/mic.0.071340-0</pub-id><pub-id pub-id-type="pmid">24085837</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saavedra</surname> <given-names>E</given-names></name><name><surname>Encalada</surname> <given-names>R</given-names></name><name><surname>Pineda</surname> <given-names>E</given-names></name><name><surname>Jasso-Chávez</surname> <given-names>R</given-names></name><name><surname>Moreno-Sánchez</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Glycolysis in Entamoeba histolytica biochemical characterization of recombinant glycolytic enzymes and flux control analysis</article-title><source>The FEBS Journal</source><volume>272</volume><fpage>1767</fpage><lpage>1783</lpage><pub-id pub-id-type="doi">10.1111/j.1742-4658.2005.04610.x</pub-id><pub-id pub-id-type="pmid">15794763</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Savageau</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="1969">1969</year><article-title>Biochemical systems analysis. I. some mathematical properties of the rate law for the component enzymatic reactions</article-title><source>Journal of Theoretical Biology</source><volume>25</volume><fpage>365</fpage><lpage>369</lpage><pub-id pub-id-type="doi">10.1016/s0022-5193(69)80026-3</pub-id><pub-id pub-id-type="pmid">5387046</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schmidt</surname> <given-names>A</given-names></name><name><surname>Kochanowski</surname> <given-names>K</given-names></name><name><surname>Vedelaar</surname> <given-names>S</given-names></name><name><surname>Ahrné</surname> <given-names>E</given-names></name><name><surname>Volkmer</surname> <given-names>B</given-names></name><name><surname>Callipo</surname> <given-names>L</given-names></name><name><surname>Knoops</surname> <given-names>K</given-names></name><name><surname>Bauer</surname> <given-names>M</given-names></name><name><surname>Aebersold</surname> <given-names>R</given-names></name><name><surname>Heinemann</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The quantitative and condition-dependent <italic>Escherichia coli</italic> proteome</article-title><source>Nature Biotechnology</source><volume>34</volume><fpage>104</fpage><lpage>110</lpage><pub-id pub-id-type="doi">10.1038/nbt.3418</pub-id><pub-id pub-id-type="pmid">26641532</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schmitt</surname> <given-names>DL</given-names></name><name><surname>An</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Spatial organization of metabolic enzyme complexes in cells</article-title><source>Biochemistry</source><volume>56</volume><fpage>3184</fpage><lpage>3196</lpage><pub-id pub-id-type="doi">10.1021/acs.biochem.7b00249</pub-id><pub-id pub-id-type="pmid">28580779</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steel</surname> <given-names>M</given-names></name><name><surname>Penny</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Common ancestry put to the test</article-title><source>Nature</source><volume>465</volume><fpage>168</fpage><lpage>169</lpage><pub-id pub-id-type="doi">10.1038/465168a</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname> <given-names>Y</given-names></name><name><surname>Qian</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Flux control analysis for biphenyl metabolism by Rhodococcus pyridinovorans r04</article-title><source>Biotechnology Letters</source><volume>24</volume><fpage>1525</fpage><lpage>1529</lpage></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Theobald</surname> <given-names>DL</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>A formal test of the theory of universal common ancestry</article-title><source>Nature</source><volume>465</volume><fpage>219</fpage><lpage>222</lpage><pub-id pub-id-type="doi">10.1038/nature09014</pub-id><pub-id pub-id-type="pmid">20463738</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Traut</surname> <given-names>TW</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Dissociation of enzyme oligomers: a mechanism for allosteric regulation</article-title><source>Critical Reviews in Biochemistry and Molecular Biology</source><volume>29</volume><fpage>125</fpage><lpage>163</lpage><pub-id pub-id-type="doi">10.3109/10409239409086799</pub-id><pub-id pub-id-type="pmid">8026214</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van der Vlag</surname> <given-names>J</given-names></name><name><surname>van't Hof</surname> <given-names>R</given-names></name><name><surname>van Dam</surname> <given-names>K</given-names></name><name><surname>Postma</surname> <given-names>PW</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Control of glucose metabolism by the enzymes of the glucose phosphotransferase system in Salmonella typhimurium</article-title><source>European Journal of Biochemistry</source><volume>230</volume><fpage>170</fpage><lpage>182</lpage><pub-id pub-id-type="doi">10.1111/j.1432-1033.1995.0170i.x</pub-id><pub-id pub-id-type="pmid">7601098</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><boxed-text><sec id="s6" sec-type="appendix"><title>Ecological and evolutionary dynamics</title><p>We assume as in <xref ref-type="bibr" rid="bib45">Posfai et al., 2017</xref> that metabolic reactions occur on a much faster time scale than cellular division, so that resource concentrations are always at their ecological equilibrium values <inline-formula><mml:math id="inf144"><mml:msubsup><mml:mi>c</mml:mi><mml:mi>j</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula> determined as solutions of equations:<disp-formula id="equ9"><label>(A1)</label><mml:math id="m9"><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>α</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>with <inline-formula><mml:math id="inf145"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. (Note that these equilibrium resource concentrations are determined by the current populations sizes <inline-formula><mml:math id="inf146"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.) In practice, a faster time scale can be achieved by multiplying the right-hand side of <xref ref-type="disp-formula" rid="equ9">Equation A1</xref> by a large dimensionless constant. The cellular per capita birth rate <inline-formula><mml:math id="inf147"><mml:msub><mml:mi>g</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:math></inline-formula> of species <italic>α</italic> is proportional to the amount of nutrient absorbed by each individual,<disp-formula id="equ10"><label>(A2)</label><mml:math id="m10"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mi>p</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mi>j</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The dynamics of the population size <inline-formula><mml:math id="inf148"><mml:msub><mml:mi>n</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:math></inline-formula> then becomes<disp-formula id="equ11"><label>(A3)</label><mml:math id="m11"><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mi>p</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>To derive the evolutionary dynamics for the allocation strategies, that is, for the trait <italic>α</italic>, we follow the adaptive dynamics approach, a powerful tool to study gradual evolutionary diversification due to frequency-dependent ecological interactions (<xref ref-type="bibr" rid="bib42">Metz et al., 1992</xref>; <xref ref-type="bibr" rid="bib12">Dieckmann and Law, 1996</xref>; <xref ref-type="bibr" rid="bib13">Doebeli, 2011</xref>; <xref ref-type="bibr" rid="bib11">Dieckmann and Doebeli, 1999</xref>; <xref ref-type="bibr" rid="bib16">Doebeli and Dieckmann, 2003</xref>; <xref ref-type="bibr" rid="bib21">Geritz et al., 1997</xref>; <xref ref-type="bibr" rid="bib28">Hui et al., 2018</xref>). In particular, adaptive dynamics can generate the paradigmatic phenomenon of evolutionary branching (<xref ref-type="bibr" rid="bib42">Metz et al., 1992</xref>; <xref ref-type="bibr" rid="bib21">Geritz et al., 1997</xref>; <xref ref-type="bibr" rid="bib15">Doebeli and Dieckmann, 2000</xref>; <xref ref-type="bibr" rid="bib28">Hui et al., 2018</xref>; <xref ref-type="bibr" rid="bib13">Doebeli, 2011</xref>; <xref ref-type="bibr" rid="bib11">Dieckmann and Doebeli, 1999</xref>), during which a population that evolves in a continuous phenotype space first converges to a fitness minimum (evolutionary branching point) and then splits into two (or more) diverging phenotypic branches. We start with considering a monomorphic resident population at its ecological equilibrium <inline-formula><mml:math id="inf149"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula>, which is defined as the population size for which the equilibrium resource levels <inline-formula><mml:math id="inf150"><mml:msubsup><mml:mi>c</mml:mi><mml:mi>j</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula> are such that <inline-formula><mml:math id="inf151"><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mi>p</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:math></inline-formula> (note again that the <inline-formula><mml:math id="inf152"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mi>p</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> implicitly depend on <italic>α</italic>). The invasion fitness of a rare mutant <inline-formula><mml:math id="inf153"><mml:msup><mml:mi>α</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> is then the per capita growth rate of the mutant <inline-formula><mml:math id="inf154"><mml:msup><mml:mi>α</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> at the resource levels defined by the resident:<disp-formula id="equ12"><label>(A4)</label><mml:math id="m12"><mml:mrow><mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>α</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:msup><mml:mi>α</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mi>p</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>To derive the adaptive dynamics, we consider the selection gradient <inline-formula><mml:math id="inf155"><mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, with components<disp-formula id="equ13"><label>(A5)</label><mml:math id="m13"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>α</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:mfrac><mml:mo fence="true" stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mi>α</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula><inline-formula><mml:math id="inf156"><mml:mrow><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> defines a <inline-formula><mml:math id="inf157"><mml:mi>p</mml:mi></mml:math></inline-formula>-dimensional dynamical system in unrestricted <italic>α</italic>-space, <disp-formula id="equ14"><label>(A6)</label><mml:math id="m14"><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mi>σ</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The speed of evolution of <italic>α</italic> is proportional to the current ecological equilibrium population size <inline-formula><mml:math id="inf158"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula> because the number of mutations occurring at any given point in time is proportional to <inline-formula><mml:math id="inf159"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula>. The parameter <italic>σ</italic> describes both the per capita rate and effective size of mutations. Without loss of generality, we set <inline-formula><mml:math id="inf160"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>To take the enzymatic tradeoff into account, the unconstrained adaptive dynamics (<xref ref-type="disp-formula" rid="equ14">Equation A6</xref>) needs to be restricted to the surface in <italic>α</italic>-space that is defined by the tradeoff <inline-formula><mml:math id="inf161"><mml:mrow><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:msubsup><mml:mi>α</mml:mi><mml:mi>j</mml:mi><mml:mi>γ</mml:mi></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf162"><mml:mi>E</mml:mi></mml:math></inline-formula> is a positive number (<xref ref-type="bibr" rid="bib30">Ito and Sasaki, 2016</xref>). An illustrative example is the one in which the nutrients come from three different resources. The tradeoff <inline-formula><mml:math id="inf163"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>α</mml:mi><mml:mn>1</mml:mn><mml:mi>γ</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mn>2</mml:mn><mml:mi>γ</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mn>3</mml:mn><mml:mi>γ</mml:mi></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> defines a surface in <italic>α</italic>-space containing all strategies. The curvature of each surface is determined by <italic>γ</italic>. <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1a</xref> shows an example of the surface defined by the tradeoff for the case that <inline-formula><mml:math id="inf164"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> while <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1b and c</xref> show the curvature for the case where <inline-formula><mml:math id="inf165"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf166"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, respectively. The blue star and the orange diamond illustrate possible position of the strategies in <italic>α</italic>-space. The individuals with strategy indicated by the blue star uptake nutrients only from resource <italic>s</italic><sub>1</sub>, while the individuals with strategy indicated by the orange diamond uptake nutrients from all three resources.</p><fig id="app1fig1" position="float"><label>Appendix 1—figure 1.</label><caption><title>Three possible surfaces defined by a tradeoff: (<bold>a</bold>) shows the concave surface for the case <inline-formula><mml:math id="inf167"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, while (<bold>b</bold>) and (<bold>c</bold>) show the surface for the cases <inline-formula><mml:math id="inf168"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf169"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, respectively.</title><p>The blue star and the orange diamond represent possible strategies. Individuals with strategy represented by the blue star obtain their nutrients only from resource <italic>s</italic><sub>1</sub> while the individuals that adopt strategy indicated by the orange diamond uptake nutrients from all three resources.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-67764-app1-fig1-v2.tif"/></fig><p>Equilibrium points of the adaptive dynamics, the so-called singular points, are resting points <inline-formula><mml:math id="inf170"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> of the resulting dynamical system in phenotype space. Given a singular point <inline-formula><mml:math id="inf171"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>, two stability concepts are important. First, there is stability in the usual sense of converging to <inline-formula><mml:math id="inf172"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> from nearby initial conditions, which is measured by the Jacobian matrix of the functions defining the adaptive dynamics, evaluated at <inline-formula><mml:math id="inf173"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>. Second, evolutionary stability is measured by the Hessian of the invasion fitness function <inline-formula><mml:math id="inf174"><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>α</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with respect to the mutant trait, evaluated at the singular point <inline-formula><mml:math id="inf175"><mml:msup><mml:mi>α</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>, and taken along the constraint surface (<xref ref-type="bibr" rid="bib30">Ito and Sasaki, 2016</xref>). A negative definite Hessian (all eigenvalues negative) means that the singular point is a maximum of invasion fitness and no branching occurs. Alternatively, a singular point is called an evolutionary branching point if it is both convergent stable with regard to the Jacobian and evolutionarily unstable with regard to the Hessian. Thus, a singular point is a branching point if all eigenvalues of the Jacobian have negative real parts, and if the Hessian matrix is not negative definite.</p></sec><sec id="s7" sec-type="appendix"><title>Singular points and their convergence and evolutionary stability</title><p>The case where the decay rates, <inline-formula><mml:math id="inf176"><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>, are zero for any <inline-formula><mml:math id="inf177"><mml:mi>j</mml:mi></mml:math></inline-formula> admits an analytical solution. We consider allocation strategies <inline-formula><mml:math id="inf178"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as in the main text, but here we assume a more general tradeoff function:<disp-formula id="equ15"><label>(A7)</label><mml:math id="m15"><mml:mrow><mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover></mml:mstyle><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mi>j</mml:mi><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msubsup></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>It turns out to be convenient to reparametrize the strategy space as follows:<disp-formula id="equ16"><label>(A8)</label><mml:math id="m16"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≡</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mi>j</mml:mi><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msubsup></mml:mrow></mml:mrow></mml:math></disp-formula>for <inline-formula><mml:math id="inf179"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. This simplifies the tradeoff expression to<disp-formula id="equ17"><label>(A9)</label><mml:math id="m17"><mml:mrow><mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover></mml:mstyle><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Because the <inline-formula><mml:math id="inf180"><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> increase monotonically with <inline-formula><mml:math id="inf181"><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>, the adaptive dynamic properties in terms of convergence and evolutionary stability of singular points are the same for <inline-formula><mml:math id="inf182"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf183"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> phenotypes. However, the tradeoff in <italic>β</italic>, <xref ref-type="disp-formula" rid="equ17">Equation A9</xref>, is linear, which simplifies the analysis.</p><p>In terms of <italic>β</italic>, the per capita rate of use of resource <inline-formula><mml:math id="inf184"><mml:mi>j</mml:mi></mml:math></inline-formula> of an individual with phenotype <italic>β</italic> is<disp-formula id="equ18"><label>(A10)</label><mml:math id="m18"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfrac></mml:mstyle><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfrac></mml:msup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We assume that nutrients are supplied to the system at a constant rate given by the vector <inline-formula><mml:math id="inf185"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <italic>s</italic><sub><italic>j</italic></sub> is the supply rate of the <inline-formula><mml:math id="inf186"><mml:mi>j</mml:mi></mml:math></inline-formula> th resource. We consider the low degradation rate regime, that is, <inline-formula><mml:math id="inf187"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> for all <inline-formula><mml:math id="inf188"><mml:mi>j</mml:mi></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ9">Equation A1</xref>. Setting the right-hand sides of <xref ref-type="disp-formula" rid="equ9 equ1 equ11">Equations A1, A3</xref> equal to zero and taking into account that the sum in <xref ref-type="disp-formula" rid="equ9">Equation A1</xref> consists of a single term, we obtain for the equilibrium density of a population monomorphic in <italic>β</italic><disp-formula id="equ19"><label>(A11)</label><mml:math id="m19"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>β</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover></mml:mstyle><mml:mstyle displaystyle="true"><mml:mfrac><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>δ</mml:mi></mml:mfrac></mml:mstyle></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The invasion fitness of a rare mutant with uptake strategy <inline-formula><mml:math id="inf189"><mml:msup><mml:mi>β</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> in a resident <italic>β</italic> at ecological equilibrium <inline-formula><mml:math id="inf190"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>β</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula> becomes<disp-formula id="equ20"><label>(A12)</label><mml:math id="m20"><mml:mrow><mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>β</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover></mml:mstyle><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:msubsup><mml:mi>β</mml:mi><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfrac></mml:mstyle><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msubsup><mml:mi>n</mml:mi><mml:mi>β</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mfrac></mml:mstyle></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>To derive the adaptive dynamics of <italic>β</italic>, we calculate the selection gradient <inline-formula><mml:math id="inf191"><mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and project it onto the linear constraint space: <disp-formula id="equ21"><label>(A13)</label><mml:math id="m21"><mml:mrow><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>β</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:msubsup><mml:mi>β</mml:mi><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:mfrac></mml:mstyle><mml:mo fence="true">|</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mi>β</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>β</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ22"><label>(A14)</label><mml:math id="m22"><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:mi/></mml:mrow><mml:mrow><mml:mrow><mml:mi>σ</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>β</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mn>1</mml:mn><mml:mi>p</mml:mi></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover></mml:mstyle><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi/></mml:mrow><mml:mrow><mml:mrow><mml:mi>σ</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>β</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>β</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>-</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mn>1</mml:mn><mml:mi>p</mml:mi></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover></mml:mstyle><mml:mstyle displaystyle="true"><mml:mfrac><mml:msub><mml:mi>s</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>β</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Here, the term<disp-formula id="equ23"><label>(A15)</label><mml:math id="m23"><mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mn>1</mml:mn><mml:mi>p</mml:mi></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover></mml:mstyle><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mn>1</mml:mn><mml:mi>p</mml:mi></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover></mml:mstyle><mml:mstyle displaystyle="true"><mml:mfrac><mml:msub><mml:mi>s</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>β</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>is the component of the selection gradient (<xref ref-type="disp-formula" rid="equ21">Equation A13</xref>) that is orthogonal to the tradeoff hyperplane (note that <inline-formula><mml:math id="inf192"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>p</mml:mi></mml:msqrt></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>p</mml:mi></mml:msqrt></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is a unit vector orthogonal to the tradeoff hyperplane).</p><p>If we set the mutational parameter <inline-formula><mml:math id="inf193"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, the adaptive dynamics of <italic>β</italic> becomes<disp-formula id="equ24"><label>(A16)</label><mml:math id="m24"><mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>-</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mn>1</mml:mn><mml:mi>p</mml:mi></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover></mml:mstyle><mml:mstyle displaystyle="true"><mml:mfrac><mml:msub><mml:mi>s</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Note that we only need <inline-formula><mml:math id="inf194"><mml:mrow><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> equations due to the (linear) tradeoff. It is easy to see that <xref ref-type="disp-formula" rid="equ24">Equation A16</xref> has a unique fixed point, that is, there is a unique singular point for the adaptive dynamics given by<disp-formula id="equ25"><label>(A17)</label><mml:math id="m25"><mml:mrow><mml:msubsup><mml:mi>β</mml:mi><mml:mi>j</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula>for <inline-formula><mml:math id="inf195"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. In terms of the original trait <italic>α</italic>, <xref ref-type="disp-formula" rid="equ25">Equation A17</xref> is (<xref ref-type="disp-formula" rid="equ4">Equation 4</xref>) in the main text.</p><p>To check for convergence stability of <inline-formula><mml:math id="inf196"><mml:mrow><mml:msup><mml:mi>β</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>β</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>β</mml:mi><mml:mi>p</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, we have to calculate the Jacobian matrix <inline-formula><mml:math id="inf197"><mml:mi>J</mml:mi></mml:math></inline-formula> of the right-hand side of <xref ref-type="disp-formula" rid="equ24">Equation A16</xref>, evaluated at the singular point <inline-formula><mml:math id="inf198"><mml:msup><mml:mi>β</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>. It is easy to see that the <inline-formula><mml:math id="inf199"><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula> th element of <inline-formula><mml:math id="inf200"><mml:mi>J</mml:mi></mml:math></inline-formula> is<disp-formula id="equ26"><label>(A18)</label><mml:math id="m26"><mml:mrow><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>β</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mi/><mml:mo>*</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mn>1</mml:mn><mml:mi>p</mml:mi></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:msub><mml:mi>s</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>β</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi/><mml:mo>*</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Thus, <inline-formula><mml:math id="inf201"><mml:mi>J</mml:mi></mml:math></inline-formula> is of the form<disp-formula id="equ27"><label>(A19)</label><mml:math id="m27"><mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf202"><mml:msub><mml:mi>J</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math></inline-formula> is a diagonal matrix with element <inline-formula><mml:math id="inf203"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>β</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf204"><mml:mi>A</mml:mi></mml:math></inline-formula> is a matrix whose elements in the <inline-formula><mml:math id="inf205"><mml:mi>k</mml:mi></mml:math></inline-formula> th column are all identical and equal to <inline-formula><mml:math id="inf206"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>p</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mfrac><mml:msub><mml:mi>s</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>β</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi/><mml:mo>*</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. This implies that the matrix <inline-formula><mml:math id="inf207"><mml:mi>A</mml:mi></mml:math></inline-formula> maps any vector in phenotype space to a vector that is orthogonal to the tradeoff hyperplane (i.e., to a multiple of the vector <inline-formula><mml:math id="inf208"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>). If <inline-formula><mml:math id="inf209"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is any vector of deviations from the singular point, it follows that the projection of <inline-formula><mml:math id="inf210"><mml:mrow><mml:mi>J</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:math></inline-formula> onto the tradeoff hyperplane is the same as the projection of the vector <inline-formula><mml:math id="inf211"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:math></inline-formula>. Since all eigenvalues of <inline-formula><mml:math id="inf212"><mml:msub><mml:mi>J</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math></inline-formula> are real and negative, it follows that the singular point <inline-formula><mml:math id="inf213"><mml:msup><mml:mi>β</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> is a local attractor, that is, convergent stable, regardless of the exponents <inline-formula><mml:math id="inf214"><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf215"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>For evolutionary stability, we have to calculate the Hessian matrix <inline-formula><mml:math id="inf216"><mml:mi>H</mml:mi></mml:math></inline-formula> of second derivatives of the invasion fitness function, <xref ref-type="disp-formula" rid="equ20">Equation A12</xref> with respect to the mutant trait <inline-formula><mml:math id="inf217"><mml:msup><mml:mi>β</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> and evaluated at the singular trait value <inline-formula><mml:math id="inf218"><mml:msup><mml:mi>β</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>. The <inline-formula><mml:math id="inf219"><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula> th element of <inline-formula><mml:math id="inf220"><mml:mi>H</mml:mi></mml:math></inline-formula> is<disp-formula id="equ28"><label>(A20)</label><mml:math id="m28"><mml:mrow><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>≡</mml:mo><mml:msub><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:msup><mml:mo>∂</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>⁡</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:msubsup><mml:mi>β</mml:mi><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:msubsup><mml:mi>β</mml:mi><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle><mml:mo fence="true">|</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mi>β</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>β</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mi>ν</mml:mi><mml:mo>⁢</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfrac></mml:mstyle></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>ν</italic> is a constant:<disp-formula id="equ29"><label>(A21)</label><mml:math id="m29"><mml:mrow><mml:mrow><mml:mi>ν</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:msub><mml:mi>s</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Thus, <inline-formula><mml:math id="inf221"><mml:mi>H</mml:mi></mml:math></inline-formula> is diagonal (due to the transformation from <italic>α</italic> to <italic>β</italic>), and <inline-formula><mml:math id="inf222"><mml:mi>H</mml:mi></mml:math></inline-formula> is negative definite, that is, all eigenvalues are negative, if and only if <inline-formula><mml:math id="inf223"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> for all <inline-formula><mml:math id="inf224"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. Because the tradeoff hyperplane is linear in <italic>β</italic>, it follows that any index <inline-formula><mml:math id="inf225"><mml:mi>j</mml:mi></mml:math></inline-formula> with <inline-formula><mml:math id="inf226"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> provides a branching direction <inline-formula><mml:math id="inf227"><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>, that is, a direction in phenotype space along which evolutionary diversification is possible. More precisely, any direction in <italic>β</italic>-space (other than orthogonal to the tradeoff surface) along which the unconstrained Hessian (<xref ref-type="disp-formula" rid="equ28">Equation A20</xref>) has a minimum corresponds to a direction on the tradeoff surface along which diversification is possible.</p><p>The results presented in the main text now follow from the above by setting <inline-formula><mml:math id="inf228"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>γ</mml:mi></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf229"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. But the above analysis also suggests that with suitably chosen <inline-formula><mml:math id="inf230"><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>, it is possible to generate evolutionary branching in some directions, but not in others. This is illustrated in <xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2</xref>. Our analysis and numerical procedure are applicable to an evolving system of populations with any number of resources. To facilitate visualization, in the following, we consider just three resources, so that because of the constraint, each population is characterized by two independent parameters <inline-formula><mml:math id="inf231"><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>. <xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2</xref> illustrates diversification in the direction of <inline-formula><mml:math id="inf232"><mml:msub><mml:mi>α</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> (<inline-formula><mml:math id="inf233"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) without diversification in the directions <inline-formula><mml:math id="inf234"><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf235"><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> (<inline-formula><mml:math id="inf236"><mml:mrow><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>).</p><p><xref ref-type="fig" rid="app1fig3">Appendix 1—figure 3</xref> illustrates diversification in the directions <inline-formula><mml:math id="inf237"><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf238"><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> (<inline-formula><mml:math id="inf239"><mml:mrow><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>), with no diversification in <inline-formula><mml:math id="inf240"><mml:msub><mml:mi>α</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> (<inline-formula><mml:math id="inf241"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>).</p><fig id="app1fig2" position="float"><label>Appendix 1—figure 2.</label><caption><title>Example of evolutionary dynamics for <inline-formula><mml:math id="inf242"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1.1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf243"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:math></inline-formula>, showing convergence to the singular point and subsequent diversification only in the <inline-formula><mml:math id="inf244"><mml:msub><mml:mi>α</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> direction.</title><p>(Note that the dynamics are shown in the original <italic>α</italic>-phenotype space.) The corresponding video can be found <ext-link ext-link-type="uri" xlink:href="https://figshare.com/s/d59cf5c2f344424f830a">here</ext-link>, each frame in the video is separated by 2,000 time steps. Other parameter values were <inline-formula><mml:math id="inf245"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf246"><mml:mrow><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf247"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf248"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.25</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-67764-app1-fig2-v2.tif"/></fig><fig id="app1fig3" position="float"><label>Appendix 1—figure 3.</label><caption><title>Example of evolutionary dynamics for <inline-formula><mml:math id="inf249"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf250"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1.2</mml:mn></mml:mrow></mml:math></inline-formula>, showing convergence to the singular point and subsequent diversification only in <inline-formula><mml:math id="inf251"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> directions.</title><p>(Note that the dynamics are shown in the original <italic>α</italic>-phenotype space.) The corresponding video can be found <ext-link ext-link-type="uri" xlink:href="https://figshare.com/s/d59cf5c2f344424f830a">here</ext-link>, each frame in the video is separated by 2000 time steps. Other parameter values were <inline-formula><mml:math id="inf252"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf253"><mml:mrow><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf254"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf255"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.25</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-67764-app1-fig3-v2.tif"/></fig><fig id="app1fig4" position="float"><label>Appendix 1—figure 4.</label><caption><title>Initial population configuration of 100 randomly placed clusters in the phenotypic simplex (a), final configurations after 5,000,000 time units for <inline-formula><mml:math id="inf256"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> (b), <inline-formula><mml:math id="inf257"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:math></inline-formula> (c), and <inline-formula><mml:math id="inf258"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>1.1</mml:mn></mml:mrow></mml:math></inline-formula> (d). Videos of the entire ecological processes can be found <ext-link ext-link-type="uri" xlink:href="https://figshare.com/s/d59cf5c2f344424f830a">here</ext-link>, time interval between frames increased as a geometric progression, <inline-formula><mml:math id="inf259"><mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>1.05</mml:mn><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Other parameter values were <inline-formula><mml:math id="inf260"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf261"><mml:mrow><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf262"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf263"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.25</mml:mn></mml:mrow></mml:math></inline-formula>.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-67764-app1-fig4-v2.tif"/></fig></sec><sec id="s8" sec-type="appendix"><title>Numerical procedures</title><p>In the chemostat simulations, we numerically integrate the system of population dynamics <xref ref-type="disp-formula" rid="equ11">Equation A3</xref> for <inline-formula><mml:math id="inf264"><mml:mi>M</mml:mi></mml:math></inline-formula> populations using a simple Euler update (<inline-formula><mml:math id="inf265"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> at the beginning of the simulations). After each integration step, the populations that fall below a small ‘extinction’ threshold density (normally <inline-formula><mml:math id="inf266"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) are removed from the system. The resource concentrations <italic>c</italic><sub><italic>i</italic></sub> and uptake rates <italic>r</italic><sub><italic>i</italic></sub> are considered relaxed to their steady states for a given set of populations <inline-formula><mml:math id="inf267"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>,<disp-formula id="equ30"><label>(A22)</label><mml:math id="m30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msqrt><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:msqrt></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf268"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>α</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>To simulate serial dilutions, we numerically integrate <xref ref-type="disp-formula" rid="equ6">Equations 6, 7</xref> for <inline-formula><mml:math id="inf269"><mml:mi>M</mml:mi></mml:math></inline-formula> populations and <inline-formula><mml:math id="inf270"><mml:mi>p</mml:mi></mml:math></inline-formula> resources using also the Euler update (<inline-formula><mml:math id="inf271"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> at the beginning of the simulations). After each integration step, the populations that fall below a small ‘extinction’ threshold density (normally <inline-formula><mml:math id="inf272"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) are removed from the system. Once the resources are depleted so that the condition (<xref ref-type="disp-formula" rid="equ8">Equation 8</xref>) is satisfied, the populations of all existing species are rescaled according to <xref ref-type="disp-formula" rid="equ5">Equation 5</xref> and the resource concentrations are reset to <inline-formula><mml:math id="inf273"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>To mimic mutations in both simulation setups, periodically (typically once every <inline-formula><mml:math id="inf274"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> time units) a mutant is split from an ancestor, which is randomly chosen with probability proportional to its total birth rate. The mutant’s phenotype is randomly offset from the ancestral phenotype along the constraint surface. The offset distance is drawn from a uniform distribution in the interval <inline-formula><mml:math id="inf275"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. Unless otherwise noted, <inline-formula><mml:math id="inf276"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>0.005</mml:mn></mml:mrow></mml:math></inline-formula>. The mutant population is set to be 10% of the ancestral one, and the ancestor population is reduced by 10%. In addition to mutations, periodically (typically once every <inline-formula><mml:math id="inf277"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>100</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> time units) populations that are within a distance <inline-formula><mml:math id="inf278"><mml:mi>m</mml:mi></mml:math></inline-formula> of each other are merged (preserving their phenotypic center of mass) and their population sizes added. Periodic repetition of mutation and merging procedures preserves the phenotypic variance necessary for evolution while limiting computational complexity.</p><p>This produces clouds or clusters of <italic>α</italic>-values in phenotype space (see figures), with each phenotype <italic>α</italic> representing a monomorphic population of individuals with that phenotype <italic>α</italic>. Somewhat imprecisely, we refer to a distinct cluster of phenotypes as a species. The clusters move in phenotype space due to extinction and merging of phenotypes, and due to creation of new phenotypes by mutation. This movement represents evolution and occurs along the constraint surface. A diversification event occurs when a cluster corresponding to the diversifying species spontaneously splits into two or more clusters that diverge from each other and move apart.</p></sec><sec id="s9" sec-type="appendix"><title>Maintenance of diversity in ecological time scales</title><p>Here, we briefly show how non-linear trade-offs affect diversity on ecological time scale. To do this, we initiate the simulations with a set of for example randomly chosen phenotypes throughout phenotype space and then run the systems with the mutational process turned off. In <xref ref-type="fig" rid="app1fig4">Appendix 1—figure 4a</xref>, we show the initial configuration used for three different scenarios with different exponents <italic>γ</italic> of the tradeoff (here, we again assume that <inline-formula><mml:math id="inf279"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>γ</mml:mi></mml:mrow></mml:math></inline-formula> for all <inline-formula><mml:math id="inf280"><mml:mi>j</mml:mi></mml:math></inline-formula>). The functional form of the tradeoffs has a profound effect on the number of surviving species, with many species coexisting when <inline-formula><mml:math id="inf281"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, as reported in <xref ref-type="bibr" rid="bib45">Posfai et al., 2017</xref> (<xref ref-type="fig" rid="app1fig4">Appendix 1—figure 4b</xref>), but with typically only <inline-formula><mml:math id="inf282"><mml:mi>p</mml:mi></mml:math></inline-formula> species surviving when <inline-formula><mml:math id="inf283"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="app1fig4">Appendix 1—figure 4c</xref>) and only very few species surviving in the close vicinity of the singular point when <inline-formula><mml:math id="inf284"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="app1fig4">Appendix 1—figure 4d</xref>).</p><p>Videos of ecological simulation of serial dilution scenario can be found <ext-link ext-link-type="uri" xlink:href="https://figshare.com/s/3eb51bad58ae95b8b0f3">here</ext-link>.</p></sec><sec id="s10" sec-type="appendix"><title>Non-linear metabolic rates</title><p>Consider the consumption or transformation of a resource substance <inline-formula><mml:math id="inf285"><mml:mi>c</mml:mi></mml:math></inline-formula> into a downstream metabolic product <inline-formula><mml:math id="inf286"><mml:mi>m</mml:mi></mml:math></inline-formula> using a specific enzyme <italic>α</italic>:<disp-formula id="equ31"><label>(A23)</label><mml:math id="m31"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:munderover><mml:mo>↔</mml:mo><mml:mpadded lspace="0.333em" width="+0.667em"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mpadded><mml:mpadded lspace="0.333em" width="+0.667em"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mpadded></mml:munderover><mml:mi>c</mml:mi><mml:mi>α</mml:mi><mml:mover><mml:mo>→</mml:mo><mml:mpadded lspace="0.278em" width="+0.611em"><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mpadded></mml:mover><mml:mrow><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The assumption that the concentration of the complex <inline-formula><mml:math id="inf287"><mml:mrow><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:math></inline-formula> instantaneously relaxes to its steady state defined by the current concentrations of <inline-formula><mml:math id="inf288"><mml:mi>c</mml:mi></mml:math></inline-formula> and α constitutes the Michaelis-Menten approximation,<disp-formula id="equ32"><label>(A24)</label><mml:math id="m32"><mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Assuming mass action kinetics and denoting by <inline-formula><mml:math id="inf289"><mml:mi>c</mml:mi></mml:math></inline-formula> and <italic>α</italic> the total (bound in the complex plus free) concentrations of the resource and enzyme, and dropping the traditional symbols for concentrations, one gets a quadratic equation for the concentration <italic>ψ</italic> of the <inline-formula><mml:math id="inf290"><mml:mrow><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:math></inline-formula> complex:<disp-formula id="equ33"><label>(A25)</label><mml:math id="m33"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>-</mml:mo><mml:mi>ψ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>-</mml:mo><mml:mi>ψ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>with the solution<disp-formula id="equ34"><label>(A26)</label><mml:math id="m34"><mml:mrow><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mi>χ</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mi>χ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mrow></mml:msqrt></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf291"><mml:mrow><mml:mi>χ</mml:mi><mml:mo>≡</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the dissociation constant for the complex. The more common form of the Michaelis-Menten approximation,<disp-formula id="equ35"><label>(A27)</label><mml:math id="m35"><mml:mrow><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>≈</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mi>χ</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>is obtained in the limit when the substrate concentration is much larger than that of the enzyme. (We note that this form is linear in <italic>α</italic> and is identical to the product of a Monod function and the corresponding <italic>α</italic> used in <xref ref-type="disp-formula" rid="equ3">Equation 3</xref>). Since<disp-formula id="equ36"><label>(A28)</label><mml:math id="m36"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>ψ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msup><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>c</mml:mi><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mi>χ</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:mi>c</mml:mi><mml:mi>χ</mml:mi><mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mspace width="thickmathspace"/><mml:mrow><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">y</mml:mi></mml:mrow><mml:mspace width="thickmathspace"/><mml:mi>α</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>the resource uptake and the growth rates are always sub-linear in the concentration of the enzyme <italic>α</italic>.</p></sec></boxed-text></app></app-group></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.67764.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Shou</surname><given-names>Wenying</given-names></name><role>Reviewing Editor</role><aff><institution>University College London</institution><country>United Kingdom</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Shou</surname><given-names>Wenying</given-names> </name><role>Reviewer</role><aff><institution>University College London</institution><country>United Kingdom</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>This manuscript generalizes a recently-published framework by the Wingreen group which considers adaptation/evolutionary dynamics in a consumer resource model when a tradeoff on metabolic rates is imposed. The original model involved a linear tradeoff: e.g. the faster a microbe can eat nutrient 1, the slower it can eat nutrient 2, so that a sum-rule is imposed on the maximal rates. This paper considers the mathematics of the effect of nonlinear tradeoffs, in the form of a sum of rates raised to a power γ, with γ not just equaling 1 (γ=1 represents the regime of linear tradeoff). The authors find that, keeping all other model features the same, diversity is lost when γ is not 1. That is, nonlinear tradeoff destroys diversity.</p><p><bold>Decision letter after peer review:</bold></p><p>[Editors’ note: the authors submitted for reconsideration following the decision after peer review. What follows is the decision letter after the first round of review.]</p><p>Thank you for submitting your work entitled &quot;Evolution of diversity in metabolic strategies&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, including Wenying Shou as the Reviewing Editor and Reviewer #1, and the evaluation has been overseen by a Senior Editor .</p><p>We are sorry to say that, after consultation with the reviewers, we have decided that your work will not be considered further for publication by <italic>eLife</italic>.</p><p>Although one reviewer was positive, the overwhelming sentiment was that the work does not sufficiently advance the field.<italic>Reviewer #1:</italic></p><p>Previous theoretical work argued that among species that compete for resources, physiological tradeoff (e.g. consuming more of food 1 leads to consuming less of food 2) can give rise to species diversity that greatly exceeds the number of resources, even in a well-mixed environment not conducive for species diversity. If previous work were to be general, it would be exciting because this offers a clue to the puzzle scientists have been trying to solve for a long time: what supports high species diversity? Caetano et al show that the finding from previous work only holds under a very restrictive condition (tradeoff function being linear). When that condition is violated (which can frequently occur in biology), we end up with either a single generalist species, or specialists each specializing on a single resource. Thus, in general, the total number of species cannot be larger than the total number of limiting resources in a well-mixed environment, as posited by the competitive exclusion principle. In short, we are back at where we were.</p><p>The authors started by introducing the adaptive dynamics framework which has been used to study evolutionary diversification due to frequency-dependent selection. The introduction is not adequate in giving nonspecialists an intuitive feeling about how evolutionary branching point from fitness minimum works. Of course, making theoretical conclusions accessible is not trivial, and may not be achievable. However, authors can try harder by including supplementary figures.</p><p>The authors then introduced work from the Wingreen group: R number of resources in a well-mixed environment, and each consumer species has an uptake strategy for each of the R resources. The total uptake for each species is fixed, creating a trade-off: more uptake of one resource reduces the uptake of another. Previous work showed that when the tradeoff function is linear (e.g. the sum of [uptake of each resource)<sup>γ</sup>] = a constant where the exponent γ=1, then many species with different uptake strategies can coexist.</p><p>The authors showed that the conclusion from previous work is rather restricted in its scope: large diversity only exists when the exponent γ in the tradeoff function is 1 (i.e. linear). When that exponent is greater than 1, no diversification occurs (saving for mutation-selection balance) and all individuals are phenotypically similar generalists. When the exponent is less than 1 (i.e. concave), the initial convergence to an unstable steady state later evolutionarily diverges into specialists, each specializing on a resource.</p><p>Authors also tested their conclusions within the ecological framework of the Wingreen group, and in different scenarios (chemostat versus serial dilutions), and reached the same conclusions.</p><p>The paper is relatively easy to read (in the realm of theoretical papers). This work reminds me of the work that has been done in the field of the evolution of cooperation. For example, public goods games often assume that the effect of the public good is a linear function of the number of contributions, an assumption that is often violated in biology. Depending on whether this function is linear or nonlinear, one can get very different outcomes in cooperator/non-cooperator coexistence (e.g. Archetti and Scheuring, JTB 299:9-20; Damore and Gore, JTB, https://doi.org/10.1016/j.jtbi.2011.03.008). Authors may want to add a discussion on that.</p><p>I wonder whether this paper should be added as a Research Advance to the original paper from the Wingreen paper published in <italic>eLife</italic>.</p><p><italic>Reviewer #2:</italic></p><p>This paper deals with the diversification of metabolic strategies in an evolving population. The authors consider a consumer-resource model under different metabolic trade-offs (sublinear, linear, and superlinear). They show that the linear case is a marginal scenario that corresponds to high diversity as a consequence of neutral evolution. Both the sub- and superlinear cases lead to the coexistence of fewer species than resources, as expected by the competitive exclusion principle.</p><p>The manuscript is well written and easy to follow. The derivation using adaptive dynamics is interesting and the results are robust. I am mainly concerned by the premises of the work.</p><p>l 70 &quot;This is a very interesting finding because it violates the competitive exclusion principle&quot;. This is not strictly correct (and I think this is a central point). To violate the competitive exclusion principle, more species than resources should *stably* coexist. The stability requirement is essential. Otherwise, the principle can be easily falsified by a neutral model: in presence of even 1 single resource, an arbitrary number of ecologically equivalent species coexist (neutrally). Neutral coexistence is, as well known, structurally unstable: arbitrary small differences (which break the ecological equivalence) drive many species to extinction (restoring the bound on diversity given by the number of resources).</p><p>In the model by Posfai et al. (2017) coexistence is in fact only neutral. There is a manifold of fixed points and stability is marginal (several eigenvalues of the community matrix are equal to zero, e.g. see https://arxiv.org/pdf/2002.04358 ). The fixed point of their dynamics (abundance of different species) depends on the initial conditions. The high levels of diversity are, as a consequence, structurally unstable. This can be shown in multiple ways: introducing an (arbitrarily small) species variability in the trade-off (E depends on species identity), introducing variability in the dilution rate d (appearing in eq 3), or, as done in the paper, by altering the functional form of the trade-off.</p><p>This is a central point. It explains why many species are observed in the model by Posfai et al. And it explains why the result is extremely (infinitely) sensitive to the parameterization. These ecological considerations are mirrored in the fact that for gamma = 1 the evolutionary dynamics are neutral.</p><p>My main concern about this work is whether it has a sufficient degree of novelty and interest. As mentioned in the public review, the results are robust. But, after a close analysis of the model by Posfai et al., they are not unexpected. The manuscript, as it stands, mostly demonstrates the weaknesses of the paper by Posfai et al.: fixed points with more species than resources exist, but they are only marginally stable (https://arxiv.org/pdf/2002.04358 ). Structural instability is a direct consequence of this fact. Non-linear tradeoffs are just one (among many) ways to show that the results are infinitely sensitive to the parameter choices.</p><p><italic>Reviewer #3:</italic></p><p>There has been considerable recent interest in understanding the high degree of diversity observed in microbial communities. From a theoretical perspective, this has led to a resurgence of interest in resource-competition models. Several recent papers have studied the effects of trade-offs on total enzyme budgets within these models. An interesting observation is that with exact trade-offs, communities can self-organize to a state with an arbitrarily large number of species coexisting. One assumption of these models is that the total &quot;cost&quot; of enzymes is a linear function. The current work relaxes this assumption, and shows that this state of arbitrarily high coexistence relies on the linearity of the cost function.</p><p>Strengths: This study is rigorous, clearly presented, and the conclusions are mathematically sound. The authors analyze both chemostat and serial dilution systems.</p><p>Weaknesses: The results are qualitatively as expected from previous studies of the role of inexact trade-offs, and are more limited. The nonlinear trade-offs explored here are essentially equivalent to the unequal enzyme budgets explored in prior work. Indeed, these nonlinearities can be directly mapped to unequal budgets: for example, a nonlinearity that favors expression of a single enzyme is directly equivalent to a larger enzyme budget for species that produce only a single enzyme. Previous studies showed that unequal enzyme budgets lead to a loss of diversity, as is found in this work. Moreover, these prior studies found that even if trade-offs are not exact, the slow loss of diversity due to inexact trade-offs can be offset by invasion of new strategies and can therefore still lead to a large number of coexisting species.</p><p>The likely impact of this work on the field is modest, given that those who are already experts in the field will recognize that nonlinear trade-offs are equivalent to unequal enzyme budgets. Moreover, the current study does not actually provide any specific support for nonlinear trade-offs other than a few remarks in the Introduction.</p><p>The work would be of greater general interest if the biological evidence for nonlinearities in enzyme costs were carefully examined; mechanistic insights on how enzyme budget nonlinearities may arise in nature would be of significant utility to the field. However, this would require a substantial additional undertaking and would shift the focus of the work from the specific implications of nonlinearities in resource-competition models. An alternative would be to publish the current study in a more specialized journal, with a more theoretical focus.</p><p>It would also be helpful to provide a quantitative assessment of the sensitivity of diversity to the degree of nonlinearity. It is clear that any nonlinearity (or inexactness of trade-offs) leads to loss of diversity at long times. However, a small rate of invasion by new strategies can still lead to a diverse stationary state of the population. Given a certain degree of nonlinearity, how much invasion is required to maintain diversity? The adaptive dynamics calculations performed by the authors do not address this point because new strategies are only introduced if these are more fit than the residents. The question of diversity requires introducing invaders that may be slightly less fit, but still manage to survive due to demographic noise.</p><p>[Editors’ note: further revisions were suggested prior to acceptance, as described below.]</p><p>Thank you for submitting your article &quot;Evolution of diversity in metabolic strategies&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, including Wenying Shou as the Reviewing Editor and Reviewer #1, and the evaluation has been overseen by Aleksandra Walczak as the Senior Editor.</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential Revisions:</p><p>Please consult the Reviewers' comments and address these in your revision.</p><p><italic>Reviewer #1:</italic></p><p>I remain supportive, especially if authors can discuss empirical measurements of biological tradeoffs and whether in the natural environment the linearity assumption might break down.</p><p><italic>Reviewer #3:</italic></p><p>The authors have made several cosmetic changes which have improved the clarity of their manuscript. However, the revised version does not substantially address my main concerns. The real question is whether the current manuscript makes a substantial contribution to the topic of microbial diversity. The focus of the paper is a critique of a model of resource competition with trade-offs. It is certainly legitimate to be critical of existing models. However, I believe the readers of <italic>eLife</italic> already appreciate the adage &quot;all models are wrong, but some are useful&quot;. The authors have focused their attention on the first part of the adage, arguing that because growth functions will not be exactly linear the model is &quot;wrong&quot;. But it's not news that the model is &quot;wrong&quot; (see above), the question is whether the model might still be a useful starting point for understanding diversity? What seems to me to be missing in the discussion, both in the original studies of Ref. 3 and 5 and the current manuscript, is quantification of how &quot;wrong&quot; the initial model is, and whether this undermines its utility. This is why I suggested that the authors carefully examine the &quot;biological evidence for nonlinearities in enzyme costs&quot;. Their revised manuscript adds some sentences on this point, but in a non-quantitative way: the authors continue to make the mathematical point that the model is &quot;wrong&quot;, but have not taken up the challenge of addressing whether it is or is not &quot;useful&quot;. Yes, it is mathematically correct as the authors state that bimolecular reactions are strictly nonlinear in the reactants. But for typical enzyme concentrations in the μM range and typical metabolites in the 0.1-1 millimolar range, these nonlinearities are in the 0.1-1% range. From a biological perspective, a linear function might therefore still be a useful starting point. I've also read the references the authors cite on other sources of nonlinearity – they are equally non-quantitative. For example, the review by Marianayagam et al. states (without citations) &quot;In its simplest form, oligomerization functions as a general mechanism for sensing protein concentration. An increase in protein concentration above the oligomerization threshold can be the stimulus for enzyme activation; similarly, enzyme deactivation will apply when cellular levels of the enzyme fall.&quot; I absolutely agree that for enzymes that need to oligomerize to function, this implies a mathematically nonlinear processing rate as a function of enzyme concentration. However, again for enzyme levels in the μM range and oligomerization dissociation constants in the commonly observed 1-10 picomolar range, the nonlinearities are again ~0.1-1%. Despite the revisions on this and other points in the reviews, in the end I am left still wondering whether the original model is &quot;useful&quot;. My conclusion is that the current manuscript will be primarily of interest to researchers whose focus is on the mathematics of resource-competition models, and would therefore be appropriate for a more mathematically focused journal.</p><p><italic>Reviewer #4:</italic></p><p>This is a well-reasoned and well-presented paper, which considers adaptation/evolutionary dynamics in a consumer resource model when a tradeoff on metabolic rates is imposed. This finding will be of interest to the ecology community, and is well presented. Moreover, these consumer-resource models have relevance beyond the microbial ecology scenarios outlined here with applications in biology and beyond. Though the mathematics of their specific suggested model is well-analyzed, it stands to reason that when considering realistic systems, other timescales can be involved. As a result, the interplay between those timescales and other model parameters could quite possibly lead again to stable coexistence, as in the case of gamma=1.</p><p>The main caveat of this paper is that one does not need to resort to nonlinear tradeoffs to destroy diversity in the original Wingreen models, since simply giving different organisms different enzyme budgets would suffice - a plausible enough scenario. In the case of unequal enzyme budgets, by adding other (plausible) diversity stabilizing mechanisms it is possible to retain the coexistence state. Similarly, for values gamma sufficiently close to 1, I would expect that other realistic effects could again lead to a state resembling gamma=1. I would have liked to see this paper attempt to understand how diversity is maintained away from gamma=1, rather than just show us a way to break it.</p><p>The reality of the field (if I may) is that none of us have the answer to the so-called Paradox of the Plankton. There are several competing theories out there, and each of them has its merits and imperfections. Simply outlining an expected and obvious lack of generalizability of a particular aspect of an otherwise solid and informative theory is less constructive than this paper could be. Especially considering it is well known that consumer-resource models (e.g. Wingreen) support coexistence only on equal enzyme budgets unless other diversity stabilizing mechanisms are included.</p><p>What I think that the authors should focus on, is that neither the Wingreen papers nor recent papers from other groups claim that their particular framework captures all features of diversity maintenance. Instead, we are all trying, as a community, to piece together a coherent theory, stumbling along as we inevitably do. For example, the Wingreen papers consider violation of the linear constraint (i.e. unequal enzyme budgets) in several stochastic and deterministic cases, outlining their relevance. There are several timescales at play here and one can think how their interplay with particular model parameters influences the resulting steady state. This is likely the case with regards to this manuscript. Already, if one considers small deviations from γ = 1, one introduces a new timescale, to compete with other model timescales. Moreover, the &quot;mutation&quot; dynamics (Eq. 14) introduce one or more timescales, which are conveniently swept under the rug with a &quot;without loss of generality&quot; (l463), a statement without actual backing as far as I understood. Furthermore, the authors do not sufficiently acknowledge that their suggested &quot;mutation&quot; dynamics are a very specific simplification of true dynamics. Let us agree that true dynamics again include many timescales and confounding factors and that therefore this manuscript is no less fine-tuned than the theory it challenges. What the authors essentially do is, impose specific dynamics and then demonstrate that these specific dynamics fail to maintain diversity at . It seems likely that their &quot;mutation&quot; dynamics can be plausibly modified so that diversity is regained. After all, natural ecosystems do involve resource competition and the plankton are diverse.</p><p>Reading the other referee reports, it appears that some referees do not consider this paper sufficiently surprising to be published in <italic>eLife</italic>. However, one referee suggested that it be published as a Research Advance, to the original Wingreen paper published in <italic>eLife</italic>. I think that if the authors sufficiently improve this manuscript, the Research Advance track might make sense. Specifically, what I suggest, is for the authors to re-adjust their focus. Their results are well argued but simply show a known weakness in the theory – a weakness that can overcome. Why not argue them in a way that seeks to expand the field? The authors raise an interesting question, what needs to be added to the plain-vanilla version of consumer-resource models so that diversity is regained despite (slightly) nonlinear tradeoffs and a specific form of &quot;mutation&quot; dynamics? More elaborate model variants already incorporate other diversity stabilizing mechanisms which might well maintain diversity at non-unity values of γ, e.g. a recent preprint by Huang group in Stanford https://www.biorxiv.org/content/10.1101/2021.05.13.444061v1. Should the authors answer this question, and salvage diversity from nonlinear tradeoffs, I think this manuscript will be much improved. Exploring an example whereby diversity is re-instated in the consumer-resource framework (despite nonlinear tradeoffs) would demonstrate how in fact, suitably adjusted, consumer-resource models can be used to capture such competing ecological forces. I believe that by steering their manuscript to open new avenues of thought rather than closing avenues of thought, it would promote future inquiries in the field, hopefully ultimately leading to a deeper understanding. With this suitable addition and adjustment of the manuscript, I hope that the Editor and other referees would then agree that it would pass the threshold of contribution to be included as a Research Advance.</p><p>2. If indeed this paper is to be considered to be published in <italic>eLife</italic> as a Research Advance following the Wingreen <italic>eLife</italic> paper, it is a good idea that the authors change their notation to match precisely that parent paper's notations. I understand this is an unusual request but I do believe that it would serve future readers best – to smoothly carry over notations from one paper to its immediate follow-up in the same journal. As it is, the notation differences between the two papers are small and this is not a big request. Future readers will thank you.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.67764.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p>[Editors’ note: The authors appealed the original decision. What follows is the authors’ response to the first round of review.]</p><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>The authors started by introducing the adaptive dynamics framework which has been used to study evolutionary diversification due to frequency-dependent selection. The introduction is not adequate in giving nonspecialists an intuitive feeling about how evolutionary branching point from fitness minimum works. Of course, making theoretical conclusions accessible is not trivial, and may not be achievable. However, authors can try harder by including supplementary figures.</p></disp-quote><p>We re-arranged the text, moving the general description of the adaptive dynamics to</p><p>the Appendix and focusing more on the predictions derived from both the numerical simulation of the complete model and the adaptive dynamics treatment of its approximate version. We also tried to better explain the convergence and evolutionary stability of the fixed point. This made the corresponding part of the Appendix a fairly complete verbal description of the standard adaptive dynamics procedure, illustrated by the equations pertinent to our model. However, given that the adaptive dynamics framework is almost 30 years old, and that many of the original and review papers on adaptive dynamics are already cited in the manuscript (there are thousands of publications based on adaptive dynamics), we stayed short of retelling a more detailed description of the general adaptive dynamics procedure.</p><disp-quote content-type="editor-comment"><p>The authors then introduced work from the Wingreen group: R number of resources in a well-mixed environment, and each consumer species has an uptake strategy for each of the R resources. The total uptake for each species is fixed, creating a trade-off: more uptake of one resource reduces the uptake of another. Previous work showed that when the tradeoff function is linear (e.g. the sum of [uptake of each resource)<sup>γ</sup>] = a constant where the exponent γ=1, then many species with different uptake strategies can coexist.</p><p>The authors showed that the conclusion from previous work is rather restricted in its scope: large diversity only exists when the exponent γ in the tradeoff function is 1 (i.e. linear). When that exponent is greater than 1, no diversification occurs (saving for mutation-selection balance) and all individuals are phenotypically similar generalists. When the exponent is less than 1 (i.e. concave), the initial convergence to an unstable steady state later evolutionarily diverges into specialists, each specializing on a resource.</p><p>Authors also tested their conclusions within the ecological framework of the Wingreen group, and in different scenarios (chemostat versus serial dilutions), and reached the same conclusions.</p><p>The paper is relatively easy to read (in the realm of theoretical papers). This work reminds me of the work that has been done in the field of the evolution of cooperation. For example, public goods games often assume that the effect of the public good is a linear function of the number of contributions, an assumption that is often violated in biology. Depending on whether this function is linear or nonlinear, one can get very different outcomes in cooperator/non-cooperator coexistence (e.g. Archetti and Scheuring, JTB 299:9-20; Damore and Gore, JTB, https://doi.org/10.1016/j.jtbi.2011.03.008). Authors may want to add a discussion on that.</p></disp-quote><p>We thank the Reviewer for bringing up the connection between these two fields. Not</p><p>only the curvature of the benefit and cost functions play essential roles in the evolution of cooperation, the biochemical justifications of non-linearity in these functions are equally applicable to the case of non-linear uptake rates and trade-offs used in our work. We added the suggested references and a short explanation to the Discussion.</p><disp-quote content-type="editor-comment"><p>I wonder whether this paper should be added as a Research Advance to the original paper from the Wingreen paper published in eLife.</p></disp-quote><p>We agree that this would be the best place to publish our work.</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>My main concern about this work is whether it has a sufficient degree of novelty and interest. As mentioned in the public review, the results are robust. But, after a close analysis of the model by Posfai et al., they are not unexpected. The manuscript, as it stands, mostly demonstrates the weaknesses of the paper by Posfai et al.: fixed points with more species than resources exist, but they are only marginally stable</p><p>(https://arxiv.org/pdf/2002.04358). Structural instability is a direct consequence of this fact. Non-linear tradeoffs are just one (among many) ways to show that the results are infinitely sensitive to the parameter choices.</p></disp-quote><p>As we stated at the beginning of this letter, we did our best to find any publication that</p><p>considers the models suggested in3,5, reports their structural instability, and presents the evolutionary and ecological results in the two generic scenarios of concave and convex trade-offs. We have not found any, and therefore we believe that such a publication is in order. We agree that there could be many other mechanisms that break the neutral evolutionary scenario and reduce the number of coexisting species to the competitive exclusion limit. Our goal in this work is to consider the interesting metabolic models developed in (3, 5) preserving their mechanistic definitions, yet supplying them with more realistic functional forms of trade-offs and nutrient uptake rates.</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>The work would be of greater general interest if the biological evidence for nonlinearities in enzyme costs were carefully examined; mechanistic insights on how enzyme budget nonlinearities may arise in nature would be of significant utility to the field. However, this would require a substantial additional undertaking and would shift the focus of the work from the specific implications of nonlinearities in resource-competition models. An alternative would be to publish the current study in a more specialized journal, with a more theoretical focus.</p></disp-quote><p>In short, the fundamental reason for non-linearities in trade-offs (enzyme costs) and uptake rates, which we showed to be interchangeable, is the non-linear dependence of chemical kinetics on the concentrations of reactants. A more detailed explanation is presented at the beginning of this letter. We added paragraphs to the Introduction and Discussion that present and discuss the evidence for non-linearity.</p><disp-quote content-type="editor-comment"><p>It would also be helpful to provide a quantitative assessment of the sensitivity of diversity to the degree of nonlinearity. It is clear that any nonlinearity (or inexactness of trade-offs) leads to loss of diversity at long times. However, a small rate of invasion by new strategies can still lead to a diverse stationary state of the population. Given a certain degree of nonlinearity, how much invasion is required to maintain diversity? The adaptive dynamics calculations performed by the authors do not address this point because new strategies are only introduced if these are more fit than the residents. The question of diversity requires introducing invaders that may be slightly less fit, but still manage to survive due to demographic noise.<disp-formula id="equ40"><mml:math id="m40"><mml:mfrac><mml:mrow><mml:mi>β</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mspace width="0.222em"/></mml:mrow></mml:mfrac></mml:math></disp-formula></p></disp-quote><p>To give credit to adaptive dynamics, it does provide some estimates to how advantageous or disadvantageous ecological conditions are for an invader or a mutant. A selection gradient (e.g. (21-22)) is an indicator of the steepness of the fitness landscape, i.e. how quickly growth rate advantages or disadvantages change with the phenotypic separation from the resident population. Likewise, the Hessian of the invasion fitness (28) serves as an estimate of the second-order effects of phenotypic separation on the relative fitness. For example, the presence of 1− ƴ factor in (28) indicates that the strength of deviation from neutral selection increases in the leading order linearly with the deviation of the trade-off exponent ƴ from one.</p><p>Some information about the fate of an invader can be obtained from the videos corresponding to Figure 3 in the Appendix. Those simulations are initiated with a dense species packing and the majority of species quickly go extinct. To show that the effect is pronounced even for slight deviation from non-linearity, we chose the values for the trade-off exponent close to one, ƴ = 0.9 and ƴ = 1.1.</p><p>Studying the extinction rates of invaders under the conditions of the models (3, 5) could be an interesting separate project. In the present manuscript we prefer to focus on the steady state of evolving diversity.</p><p>References</p><p>[1] J. A. Borghans, R. J. De Boer, and L. A. Segel. Extending the quasi-steady state approximation by changing variables. <italic>Bulletin of mathematical biology</italic>, 58(1):43–63, 1996.</p><p>[2] A. Ciliberto, F. Capuani, and J. J. Tyson. Modeling networks of coupled enzymatic</p><p>reactions using the total quasi-steady state approximation. <italic>PLoSComput Biol</italic>, 3(3):e45,</p><p>2007.</p><p>[3] A. Erez, J. G. Lopez, B. G. Weiner, Y. Meir, and N. S. Wingreen. Nutrient levels and</p><p>trade-offs control diversity in a serial dilution ecosystem. <italic>eLife</italic>, 9:e57790, sep 2020.</p><p>ISSN 2050-084X.</p><p>[4] C. M. Hill, R. D.Waightm, andW. G. Bardsley. Does any enzyme follow the michaelismenten equation? <italic>Molecular and cellular biochemistry</italic>, 15(3):173–178, 1977.</p><p>[5] A. Posfai, T. Taillefumier, and N. S. Wingreen. Metabolic trade-offs promote diversity</p><p>in a model ecosystem. <italic>Phys. Rev. Lett.</italic>, 118:028103, Jan 2017.</p><p>[Editors’ note: what follows is the authors’ response to the second round of review.]</p><disp-quote content-type="editor-comment"><p>Essential Revisions:</p><p>Please consult the Reviewers' comments and address these in your revision.</p><p>Reviewer #1:</p><p>I remain supportive, especially if authors can discuss empirical measurements of biological tradeoffs and whether in the natural environment the linearity assumption might break down.</p></disp-quote><p>Following the recommendation of Reviewer 1, in the new version of the manuscript we expanded the Introduction, Results and Discussion sections (see text in blue in the accompanying document). Assessing the empirical evidence for non-linearity in trade-offs and uptake rates, we focused on similarity in concentrations of metabolic enzymes and substrates, and on measured reaction elasticities and flux control coefficients as the most direct quantitative indicators of the “degree” of non-linearity. We also emphasized that our work leads to empirically testable predictions, at least in principle: microbial ecosystems with trade-off-structures that are close to linear should tend to be more diverse than those with highly non-linear trade-off structures (see new paragraph in the Results section). Finally, we propose possible ways to find a solution to the paradox of plankton based on non-stationary endogenous population dynamics (see new paragraph in the Discussion section).</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>The authors have made several cosmetic changes which have improved the clarity of their manuscript. However, the revised version does not substantially address my main concerns. The real question is whether the current manuscript makes a substantial contribution to the topic of microbial diversity. The focus of the paper is a critique of a model of resource competition with trade-offs. It is certainly legitimate to be critical of existing models. However, I believe the readers of eLife already appreciate the adage &quot;all models are wrong, but some are useful&quot;. The authors have focused their attention on the first part of the adage, arguing that because growth functions will not be exactly linear the model is &quot;wrong&quot;. But it's not news that the model is &quot;wrong&quot; (see above), the question is whether the model might still be a useful starting point for understanding diversity? What seems to me to be missing in the discussion, both in the original studies of Ref. 3 and 5 and the current manuscript, is quantification of how &quot;wrong&quot; the initial model is, and whether this undermines its utility. This is why I suggested that the authors carefully examine the &quot;biological evidence for nonlinearities in enzyme costs&quot;. Their revised manuscript adds some sentences on this point, but in a non-quantitative way: the authors continue to make the mathematical point that the model is &quot;wrong&quot;, but have not taken up the challenge of addressing whether it is or is not &quot;useful&quot;. Yes, it is mathematically correct as the authors state that bimolecular reactions are strictly nonlinear in the reactants. But for typical enzyme concentrations in the μM range and typical metabolites in the 0.1-1 millimolar range, these nonlinearities are in the 0.1-1% range. From a biological perspective, a linear function might therefore still be a useful starting point. I've also read the references the authors cite on other sources of nonlinearity – they are equally non-quantitative. For example, the review by Marianayagam et al. states (without citations) &quot;In its simplest form, oligomerization functions as a general mechanism for sensing protein concentration. An increase in protein concentration above the oligomerization threshold can be the stimulus for enzyme activation; similarly, enzyme deactivation will apply when cellular levels of the enzyme fall.&quot; I absolutely agree that for enzymes that need to oligomerize to function, this implies a mathematically nonlinear processing rate as a function of enzyme concentration. However, again for enzyme levels in the μM range and oligomerization dissociation constants in the commonly observed 1-10 picomolar range, the nonlinearities are again ~0.1-1%. Despite the revisions on this and other points in the reviews, in the end I am left still wondering whether the original model is &quot;useful&quot;. My conclusion is that the current manuscript will be primarily of interest to researchers whose focus is on the mathematics of resource-competition models, and would therefore be appropriate for a more mathematically focused journal.</p></disp-quote><p>We also appreciate George Box’s ”All models are wrong, but some are useful” quote and frequently use it in teaching to motivate students to aspire to design useful models.</p><p>However, there are different kinds of ”wrong” in modeling. There is Box’s wrong, which</p><p>applies to all models, as they necessarily always represent a simplification of reality. But</p><p>there is also a more technical, and arguably more important model failure, which occurs</p><p>when a model is structurally unstable, which essentially means that if a particular model parameter is changed by a very small amount, the main quantitative and qualitative behaviour of the model changes completely. This is the case for Wingreen’s model with regard to the model parameter, which was set to 1 in Wingreen’s paper. As we show in our contribution, the model outcomes completely change when ƴ≠ 1 (no matter how large or small the deviation from 1 is, see below!). Thus, Wingreen’s model is wrong in the sense that it is structurally unstable. To suggest that our model is equally ”wrong” misses the point of structural instability.</p><p>Regarding usefulness, we maintain that generally assuming linearity of tradeoff appears</p><p>to be wrong biologically. That is, we argue that Wingreen’s model is too restrictive to be useful. Assuming that George Box’s statement was primarily related to his main field, statistics, we further support this claim by statistical arguments, as follows.</p><p>While we agree that there are metabolites, particular in fast-growing bacteria, with concentrations well in the millimolar range, many common metabolite have concentrations in the range of tens and even single digits of micromoles. For example, a detailed study (2) of the canonical model microbe <italic>E. coli</italic> during exponential growth in glucose, glycerol, or acetate as the carbon source revealed that out of 103 metabolites, 35 have concentrations above 1mM, but the concentrations of 46 metabolites are in tens or single micromole digits, including 2 metabolites with concentrations below 1 μM (as summarized in Table 1 in that paper). The database BIONUMBERS7 estimates the typical metabolite concentration in an <italic>E. coli</italic> bacterium as 32 μM, and provides evidence for concentrations of important <italic>E. coli</italic> glycolysis enzymes in tens and even hundreds of μM. Hence, while it looks natural that concentrations of metabolic substrates are larger than those of the corresponding enzymes, the difference is commonly few- to ten-fold rather than 2-3 orders of magnitude, as suggested by Reviewer 3.</p><p>A similar mischaracterization appears in the Reviewer’s estimate of the degree of nonlinearity caused by the disparity between the “oligomerization dissociation constants in the commonly observed 1-10 picomolar range” (”picomolar” is apparently rarely heard of, perhaps a typo in the Reviewer comments?), and concentrations of their monomer constituents. In reality, the difference between these quantities does not seem to be nearly as pronounced as the reviewer claims, as can e.g. be seen from the following summarizing quote in the review (1), page 5014: “The association between subunits can vary in strength and duration. Some proteins are found only, or primarily, in the oligomeric state. These proteins generally have dissociation constants in the nanomolar range. Others have a weak tendency to associate, with oligomerization dependent on environmental conditions, such as concentration, temperature, and pH. Such proteins often have higher Kd values in the μM or even millimolar range. Still other proteins oligomerize dynamically in response to a stimulus, such as a change in nucleotide binding, nucleotide hydrolysis or phosphorylation state. Such a change can have a dramatic effect on the affinity of the subunits for one another, often by orders of magnitude.”</p><p>Another review (15) discusses enzymes that are known to regulate their in vivo catalytic activity by dimeric and oligomeric association-dissociation, which rules out saturated binding between monomers and a corresponding linear dependence between the concentrations of monomers and complexes.</p><p>In addition to the comparison between enzyme and substrate concentrations and enzyme dissociation constants (tricky to measure in vivo even today, e.g.5), there is a more direct way to show omnipresence of non-linearity in metabolic reactions and fluxes. The Reviewer’s assessment that ”these nonlinearities are in the 0.1-1% range” probably refers to the definition of the degree of non-linearity of a function f(x) as a double-logarithmic derivative, d ln[(f(x))]/d ln(x). For a general power-law function, such as f(x) ≡ Cx that we used to define tradeoffs, the log-log derivative is equal to, the non-linearity parameter. For example, the log-log derivatives with respect to enzyme concentration of the tradeoff used in8 are equal to one. This derivative is equal to the local value of an exponent from an approximation (also local) of the function f(x) by a power law, and has long been used in metabolic analysis, being called an “elasticity coefficient” when f(x) is a particular reaction rate and x is the concentration of enzyme, or a flux control coefficient when f(x) is a flux through a metabolic pathway and x is again the concentration of enzyme. Given that we are more interested in the effect of concentration of enzymes on the growth rate, the latter definition seems more relevant.</p><p>As with metabolic control analysis and metabolic engineering, the mere existence of</p><p>these terms indicates that their values are often distinct from one. Indeed, such is the case in publications that present experimentally measured values of these coefficients, or quantities that are derived from those coefficients. For example, flux control coefficients of metabolic enzymes and plots of fluxes vs. enzyme concentrations shown in Figure 6 in (6), Table 6 in (4), Table 2 in (14), Figure 2 in (11), Figure 1 in (9), Table 5 in (10), Figure 2B in (13), Table 3 in (16) reveal that these coefficients rarely come close to 1, and that the dependencies of metabolic fluxes on enzyme concentrations are significantly nonlinear. (We found these and many other examples using Google Scholar to search for Flux Control Metabolic Coefficients Bacteria.) Indeed, back in the 60s Michael Savageau suggested to parametrize rates of complex enzymatic reactions as products of power-law functions of concentrations of enzymes and substrates12. This idea developed a substantial following, which once again indicates the necessity to account for non-linearity in kinetics of enzymatic pathways. Overall, the 0.1-1% range for nonlinearities seems doubtful.</p><p>In conclusion, it seems highly questionable to simply assume that all biologically relevant tradeoffs are close to linear. Rather, it seems very plausible that many of them are highly non-linear. To argue that readers of <italic>eLife</italic> would only need to know what happens in generic consumer-resource models when tradeoffs are linear therefore does not make sense to us. On the contrary, we think that readers of Wingreen’s papers, including their <italic>eLife</italic> paper, should be made aware of the structural instability of their results. We emphasize that because of the structural instability, tradeoffs would have to be exactly linear to arrive at Wingreen’s results, as any slight deviation from linearity destroys the neutrality necessary for excess diversity in Wingreen’s model, and hence results in completely different outcomes. This can be seen in (<xref ref-type="fig" rid="respfig1">Author response image 1A</xref>) which shows that even for ƴ = 0.99, i.e., for ƴ within 1% of the linear case, there is no excess diversity. The case for ƴ = 1.01 is shown in (<xref ref-type="fig" rid="respfig1">Author response image 1B</xref>) and the full evolutionary dynamics for this case can be found at https://figshare.com/s/f65ed0bf9b4305e9018f.</p><p>In the updated text, we substantially edited the Introduction and Discussion to point to</p><p>evidence in favour of the importance of non-linear kinetics and tradeoffs, and to reflect the above considerations. We also added a paragraph to the Results section discussing systems with different degrees of non-linearity and the expectations regarding the amount of diversity that can be derived based on the degree of non-linearity in tradeoff structures.</p><fig id="respfig1"><label>Author response image 1.</label><caption><title>Snapshots illustrating the end of the evolutionary dynamics for (a) = 0.</title><p>99 and (b) = 1.01. The video of the entire evolutionary process can be found at https://figshare.com/s/f65ed0bf9b4305e9018f .</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-67764-resp-fig1-v2.tif"/></fig><disp-quote content-type="editor-comment"><p>Reviewer #4:</p><p>The reality of the field (if I may) is that none of us have the answer to the so-called Paradox of the Plankton. There are several competing theories out there, and each of them has its merits and imperfections. Simply outlining an expected and obvious lack of generalizability of a particular aspect of an otherwise solid and informative theory is less constructive than this paper could be. Especially considering it is well known that consumer-resource models (e.g. Wingreen) support coexistence only on equal enzyme budgets unless other diversity stabilizing mechanisms are included.</p></disp-quote><p>Again, this seems strange to us. It is exactly papers like ours that go some way to clarify the situation that a general model with non-linear tradeoff does not “support coexistence only on equal enzyme budgets ” (assuming that it refers to excessive diversity), but the Reviewer seems to think that all this is already well known. As we show, Wingreen’s models are structurally unstable, and therefore not ”solid and informative”, as the Reviewer claims. To us, it seems important that this is pointed out in the literature.</p><disp-quote content-type="editor-comment"><p>What I think that the authors should focus on, is that neither the Wingreen papers nor recent papers from other groups claim that their particular framework captures all features of diversity maintenance. Instead, we are all trying, as a community, to piece together a coherent theory, stumbling along as we inevitably do. For example, the Wingreen papers consider violation of the linear constraint (i.e. unequal enzyme budgets) in several stochastic and deterministic cases, outlining their relevance.</p></disp-quote><p>As far as we can tell, both papers coming from Wingreen’s group regarding this topic assume linear tradeoffs. We are unsure why the reviewer claims otherwise. We agree that we are all trying, and that all models and approaches have their own benefits and shortcomings. However, if a model has a particularly severe shortcoming, such that the</p><p>results simply don’t withstand scrutiny, this needs to be pointed out. In our opinion, this is the case for the structural instability due to assuming linear tradeoffs in Wingreen’s models.</p><disp-quote content-type="editor-comment"><p>There are several timescales at play here and one can think how their interplay with particular model parameters influences the resulting steady state. This is likely the case with regards to this manuscript. Already, if one considers small deviations from γ=1, one introduces a new timescale, to compete with other model timescales. Moreover, the &quot;mutation&quot; dynamics (Eq. 14) introduce one or more timescales, which are conveniently swept under the rug with a &quot;without loss of generality&quot; (l463), a statement without actual backing as far as I understood. Furthermore, the authors do not sufficiently acknowledge that their suggested &quot;mutation&quot; dynamics are a very specific simplification of true dynamics. Let us agree that true dynamics again include many timescales and confounding factors and that therefore this manuscript is no less fine-tuned than the theory it challenges. What the authors essentially do is, impose specific dynamics and then demonstrate that these specific dynamics fail to maintain diversity at . It seems likely that their &quot;mutation&quot; dynamics can be plausibly modified so that diversity is regained. After all, natural ecosystems do involve resource competition and the plankton are diverse.</p></disp-quote><p>Introducing ƴ≠1 does not introduce new timescales. It is true that our evolutionary framework does introduce a new (evolutionary) timescale that is dictated by mutations. However, this merely serves to generalize the model, and it does not affect the basic finding of the effect of non-linear tradeoffs on diversity. This can be seen by considering purely ecological dynamics, as happens in our models either at the evolutionary end state (when there is no evolutionary change anymore), or by simply setting mutations to 0, as we have done in the supplementary material. The resulting ecological dynamics show exactly the same effect of non-linear tradeoffs on diversity as the more general evolutionary model.</p><p>Thus, it is not the evolutionary time scale that causes these effects. As an aside: what we</p><p>meant by the phrase “Without loss of generality, we set σ = 1” quoted by the Reviewer, is that the constant σ, which essentially describes the rate and size of mutations, can be absorbed by defining a new time t’ = σt, which simply affects the frame rate in our videos, rather than what is in those frames.</p><disp-quote content-type="editor-comment"><p>Reading the other referee reports, it appears that some referees do not consider this paper sufficiently surprising to be published in eLife. However, one referee suggested that it be published as a Research Advance, to the original Wingreen paper published in eLife. I think that if the authors sufficiently improve this manuscript, the Research Advance track might make sense. Specifically, what I suggest, is for the authors to re-adjust their focus. Their results are well argued but simply show a known weakness in the theory – a weakness that can overcome. Why not argue them in a way that seeks to expand the field? The authors raise an interesting question, what needs to be added to the plain-vanilla version of consumer-resource models so that diversity is regained despite (slightly) nonlinear tradeoffs and a specific form of &quot;mutation&quot; dynamics? More elaborate model variants already incorporate other diversity stabilizing mechanisms which might well maintain diversity at non-unity values of γ, e.g. a recent preprint by Huang group in Stanford https://www.biorxiv.org/content/10.1101/2021.05.13.444061v1. Should the authors answer this question, and salvage diversity from nonlinear tradeoffs, I think this manuscript will be much improved. Exploring an example whereby diversity is re-instated in the consumer-resource framework (despite nonlinear tradeoffs) would demonstrate how in fact, suitably adjusted, consumer-resource models can be used to capture such competing ecological forces. I believe that by steering their manuscript to open new avenues of thought rather than closing avenues of thought, it would promote future inquiries in the field, hopefully ultimately leading to a deeper understanding. With this suitable addition and adjustment of the manuscript, I hope that the Editor and other referees would then agree that it would pass the threshold of contribution to be included as a Research Advance.</p></disp-quote><p>Once again, we are a bit perplexed by these comments. We tried to be succinct in our presentation of the fact that Wingreen’s model is structurally unstable, and that with</p><p>non-linear tradeoffs, no excess diversity can be maintained. Despite succinctness, this resulted in a full-fledged paper. Now the Reviewer wants us to write an additional paper about possible mechanisms that can lead to excess diversity with non-linear tradeoffs. This seems strange. Shouldn’t it be one paper at a time? Moreover, despite what the Reviewer may think, it is not clear at all at this point what possible mechanisms could indeed lead to excess diversity with non-linear tradeoffs. One possibility would be to consider non-equilibrium ecological dynamics. This has been done in the <italic>eLife</italic> paper from the Wingreen group to which our paper refers. In that paper, the authors considered seasonal ”batch culture” dynamics rather than equilibrium consumer-resource dynamics. However, they still always assumed linear tradeoffs! Note that this is a paper all of its own, and not merely an additional section added on to their original PRL paper…how could it be otherwise? We note that such batch culture dynamics do not lead to excess diversity with non-linear tradeoffs, as we have shown in our manuscript.</p><p>We are equally keen to find a solution to the Paradox of Plankton, and it is possible that</p><p>non-equilibrium ecological dynamics can allow for the maintenance of excess diversity, as we have recently shown using a different ecological model3. More precisely, we show that endogenous non-stationary “boom-bust” population dynamics can lead to a few-fold increase in diversity above the saturation limit expected with equilibrium population dynamics. This together with many experimental results reporting non-stationarity and apparent chaoticity of the population dynamics of actual plankton species makes us believe that the key to explain the astounding diversity of species is not the neutral evolutionary regime predicted in 8, but rather non-stationary population dynamics induced by competition and predation and perhaps external factors. We think that the neutral evolutionary state and linear tradeoff to 9 which an evolving system may accidentally “self-organize” is very fragile and at most temporal and cannot play a major role in establishing and maintaining (even less likely!) excess diversity.</p><p>However, it seems obvious that to extend investigations of non-equilibrium ecological</p><p>dynamics with non-linear tradeoffs to Wingreen’s consumer-resource model would need a new research project that would require its own space, and cannot be added to a paper about the structural instability of Wingreen’s model. The preprint cited by the Reviewer also proves the point: such investigations must be done in their own right, not tacked on to something else. Clearly, we must leave the exploration of excess diversity with non-linear tradeoffs to the future.</p><p>We have added a paragraph to the Discussion where we bring up the possibility of exploring the effect of non-linear tradeoffs in the presence of non-equilibrium ecological dynamics.</p><disp-quote content-type="editor-comment"><p>2. If indeed this paper is to be considered to be published in eLife as a Research Advance following the Wingreen eLife paper, it is a good idea that the authors change their notation to match precisely that parent paper's notations. I understand this is an unusual request but I do believe that it would serve future readers best – to smoothly carry over notations from one paper to its immediate followup in the same journal. As it is, the notation differences between the two papers are small and this is not a big request. Future readers will thank you.</p></disp-quote><p>There seem to be four discrepancies between our and Wingreen’s notation:</p><p>the number of resources p in 8 vs R (us), resource input rates in 8 vs S (us), death rate _ in8 vs d (us), and a dedicated summation index _ in sums over all species in 8, which is absent in our paper, because it is not needed. We have fixed the first three discrepancies, making our notation identical to that in 8. As for the summation index, we think that our notation is more succinct, less cumbersome, and actually not contradicting that in 8, so we kept it.</p><p>References</p><p>[1] M. H. Ali and B. Imperiali. Protein oligomerization: how and why. <italic>Bioorganic and</italic></p><p><italic>medicinal chemistry</italic>, 13(17):5013–5020, 2005.</p><p>[2] B. D. Bennett, E. H. Kimball, M. Gao, R. Osterhout, S. J. Van Dien, and J. D. Rabinowitz.</p><p>Absolute metabolite concentrations and implied enzyme active site occupancy</p><p>in <italic>Escherichia coli</italic>. <italic>Nature chemical biology</italic>, 5(8):593–599, 2009.</p><p>[3] M. Doebeli, E. C. Jaque, and Y. Ispolatov. Boom-bust population dynamics increase</p><p>diversity in evolving competitive communities. <italic>Communications biology</italic>, 4(1):1–8,</p><p>2021.</p><p>[4] C. Giersch. Determining elasticities from multiple measurements of flux rates and</p><p>metabolite concentrations: application of the multiple modulation method to a reconstituted pathway. <italic>European journal of biochemistry</italic>, 227(1-2):194–201, 1995.</p><p>[5] I. Jarmoskaite, I. AlSadhan, P. P. Vaidyanathan, and D. Herschlag. How to measure and evaluate binding affinities. <italic>eLife</italic>, 9:e57264, 2020.</p><p>[6] A. J. Loder, Y. Han, A. B. Hawkins, H. Lian, G. L. Lipscomb, G. J. Schut, M. W. Keller, M. W. Adams, and R. M. Kelly. Reaction kinetic analysis of the 3-hydroxypropionate/4-ydroxybutyrate co2 fixation cycle in extremely thermoacidophilic archaea. <italic>Metabolic engineering</italic>, 38:446–463, 2016.</p><p>[7] R. Milo, P. Jorgensen, U. Moran, G. Weber, and M. Springer. Bionumbersthe database</p><p>of key numbers in molecular and cell biology. <italic>Nucleic acids research</italic>, 38(suppl 1):</p><p>D750–D753, 2010.</p><p>[8] A. Posfai, T. Taillefumier, and N. S. Wingreen. Metabolic trade-offs promote diversity</p><p>in a model ecosystem. <italic>Phys. Rev. Lett.</italic>, 118:028103, Jan 2017.</p><p>[9] J. M. Rohwer, N. D. Meadow, S. Roseman, H. V. Westerhoff, and P. W. Postma. Understanding glucose transport by the bacterial phosphoenolpyruvate: glycose phosphotransferase system on the basis of kinetic measurements in vitro. <italic>Journal of Biological Chemistry</italic>, 275(45):34909–34921, 2000.</p><p>[10] R. Rutkis, U. Kalnenieks, E. Stalidzans, and D. A. Fell. Kinetic modelling of the</p><p>zymomonasmobilisentner–doudoroff pathway: insights into control and functionality.</p><p><italic>Microbiology</italic>, 159(Pt 12):2674–2689, 2013.</p><p>[11] E. Saavedra, R. Encalada, E. Pineda, R. Jasso-Ch´avez, and R. Moreno-S´anchez. Glycolysis in entamoeba histolytica: biochemical characterization of recombinant glycolytic enzymes and flux control analysis. <italic>The FEBS journal</italic>, 272(7):1767–1783, 2005.</p><p>[12] M. A. Savageau. Biochemical systems analysis: I. some mathematical properties of the rate law for the component enzymatic reactions. <italic>Journal of theoretical biology</italic>, 25(3): 365–369, 1969.</p><p>[13] A. Schmidt, K. Kochanowski, S. Vedelaar, E. Ahrn´e, B. Volkmer, L. Callipo,</p><p>K. Knoops, M. Bauer, R. Aebersold, and M. Heinemann. The quantitative and</p><p>condition-dependent <italic>Escherichia coli</italic> proteome. <italic>Nature biotechnology</italic>, 34(1):104–110,</p><p>2016.</p><p>[14] Y. Sun and S. Qian. Flux control analysis for biphenyl metabolism by rhodococcus</p><p>pyridinovorans r04. <italic>Biotechnology letters</italic>, 24(18):1525–1529, 2002.</p><p>[15] T. W. Traut. Dissociation of enzyme oligomers: a mechanism for allosteric regulation.</p><p><italic>Critical reviews in biochemistry and molecular biology</italic>, 29(2):125–163, 1994.</p><p>[16] J. Van Der Vlag, R. Van’t Hof, K. Van Dam, and P. W. Postma. Control of glucose</p><p>metabolism by the enzymes of the glucose phosphotransferase system in <italic>Salmonella</italic></p><p>typhimurium. <italic>European journal of biochemistry</italic>, 230(1):170–182, 1995.</p></body></sub-article></article>