<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN"  "JATS-archivearticle1-3-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">91512</article-id><article-id pub-id-type="doi">10.7554/eLife.91512</article-id><article-id pub-id-type="doi" specific-use="version">10.7554/eLife.91512.4</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group></article-categories><title-group><article-title>Accurate prediction of CDR-H3 loop structures of antibodies with deep learning</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-329726"><name><surname>Chen</surname><given-names>Hedi</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3922-2156</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-329728"><name><surname>Fan</surname><given-names>Xiaoyu</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-329729"><name><surname>Zhu</surname><given-names>Shuqian</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-329730"><name><surname>Pei</surname><given-names>Yuchan</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-329731"><name><surname>Zhang</surname><given-names>Xiaochun</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-329732"><name><surname>Zhang</surname><given-names>Xiaonan</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-329743"><name><surname>Liu</surname><given-names>Lihang</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" corresp="yes" id="author-329727"><name><surname>Qian</surname><given-names>Feng</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7415-6997</contrib-id><email>qianfeng@tsinghua.edu.cn</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-329698"><name><surname>Tian</surname><given-names>Boxue</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5830-0669</contrib-id><email>boxuetian@mail.tsinghua.edu.cn</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/014gmtw23</institution-id><institution>MOE Key Laboratory of Bioinformatics, State Key Laboratory of Molecular Oncology, School of Pharmaceutical Sciences, Tsinghua University</institution></institution-wrap><addr-line><named-content content-type="city">Beijing</named-content></addr-line><country>China</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03cve4549</institution-id><institution>Tsinghua Institute of Multidisciplinary Biomedical Research, Tsinghua University</institution></institution-wrap><addr-line><named-content content-type="city">Beijing</named-content></addr-line><country>China</country></aff><aff id="aff3"><label>3</label><institution>Department of Natural Language Processing, Baidu International Technology (Shenzhen) Co Ltd</institution><addr-line><named-content content-type="city">Shenzhen</named-content></addr-line><country>China</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Dötsch</surname><given-names>Volker</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04cvxnb49</institution-id><institution>Goethe University Frankfurt</institution></institution-wrap><country>Germany</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Dötsch</surname><given-names>Volker</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04cvxnb49</institution-id><institution>Goethe University Frankfurt</institution></institution-wrap><country>Germany</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date publication-format="electronic" date-type="publication"><day>26</day><month>06</month><year>2024</year></pub-date><volume>12</volume><elocation-id>RP91512</elocation-id><history><date date-type="sent-for-review" iso-8601-date="2023-08-07"><day>07</day><month>08</month><year>2023</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint.</event-desc><date date-type="preprint" iso-8601-date="2023-08-21"><day>21</day><month>08</month><year>2023</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.08.19.553933"/></event><event><event-desc>This manuscript was published as a reviewed preprint.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2023-10-18"><day>18</day><month>10</month><year>2023</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.91512.1"/></event><event><event-desc>The reviewed preprint was revised.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2024-01-30"><day>30</day><month>01</month><year>2024</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.91512.2"/></event><event><event-desc>The reviewed preprint was revised.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2024-05-31"><day>31</day><month>05</month><year>2024</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.91512.3"/></event></pub-history><permissions><copyright-statement>© 2023, Chen et al</copyright-statement><copyright-year>2023</copyright-year><copyright-holder>Chen et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-91512-v1.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-91512-figures-v1.pdf"/><abstract><p>Accurate prediction of the structurally diverse complementarity determining region heavy chain 3 (CDR-H3) loop structure remains a primary and long-standing challenge for antibody modeling. Here, we present the H3-OPT toolkit for predicting the 3D structures of monoclonal antibodies and nanobodies. H3-OPT combines the strengths of AlphaFold2 with a pre-trained protein language model and provides a 2.24 Å average RMSD<sub>Cα</sub> between predicted and experimentally determined CDR-H3 loops, thus outperforming other current computational methods in our non-redundant high-quality dataset. The model was validated by experimentally solving three structures of anti-VEGF nanobodies predicted by H3-OPT. We examined the potential applications of H3-OPT through analyzing antibody surface properties and antibody–antigen interactions. This structural prediction tool can be used to optimize antibody–antigen binding and engineer therapeutic antibodies with biophysical properties for specialized drug administration route.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>antibody</kwd><kwd>deep learning</kwd><kwd>nanobody</kwd><kwd>CDR-H3</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Other</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004147</institution-id><institution>Tsinghua University</institution></institution-wrap></funding-source><award-id>Initiative Scientific Research Program 20231080030</award-id><principal-award-recipient><name><surname>Tian</surname><given-names>Boxue</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution>Vanke Special Fund for Public Health and Health Discipline Development</institution></institution-wrap></funding-source><award-id>2022Z82WKJ009</award-id><principal-award-recipient><name><surname>Tian</surname><given-names>Boxue</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution>Tsinghua-Peking University Center for Life Sciences</institution></institution-wrap></funding-source><award-id>20111770319</award-id><principal-award-recipient><name><surname>Tian</surname><given-names>Boxue</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution>Tsinghua University-Peking Union Medical College and Hospital Collaboration Foundation</institution></institution-wrap></funding-source><award-id>20191080837</award-id><principal-award-recipient><name><surname>Qian</surname><given-names>Feng</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A deep learning-based toolkit predicting the 3D structures of monoclonal antibodies and nanobodies outperforms other current computational methods.</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>publishing-route</meta-name><meta-value>prc</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Antibodies protect the host by recognizing and neutralizing foreign microbes or viruses and provide immunity against future infections. Furthermore, the use of therapeutic antibodies is steadily increasing in clinical treatments for infectious diseases, cancers, and autoimmune disorders (<xref ref-type="bibr" rid="bib52">Meganck and Baric, 2021</xref>; <xref ref-type="bibr" rid="bib41">Kaplon and Reichert, 2021</xref>). For example, anti-PD-L1 antibodies block PD-L1/PD-1 interactions to inhibit tumor growth in patients (<xref ref-type="bibr" rid="bib10">Brahmer et al., 2012</xref>). A typical monoclonal antibody (mAb) is composed of heavy and light chains, while a nanobody (Nb) has only a single-domain variable heavy chain. The CDR heavy chain 3 (CDR-H3) loop is the most variable region in both length and amino acid sequence, and it plays a central role in antigen binding for both mAbs and Nbs. The development of effective therapeutic antibodies requires the solved structures of candidate antibodies, including the CDR-H3. However, it is both costly and labor intensive to experimentally obtain structures, and thus computationally predicted structures are often used to guide antibody design (<xref ref-type="bibr" rid="bib2">Aguilar Rangel et al., 2022</xref>). Despite major advances in computational methods, structure prediction for CDR-H3 loops remains challenging (<xref ref-type="bibr" rid="bib70">Valdés-Tresanco et al., 2023</xref>).</p><p>Traditional template-based modeling methods, such as RosettaAntibody (<xref ref-type="bibr" rid="bib1">Adolf-Bryfogle et al., 2018</xref>), PIGS (<xref ref-type="bibr" rid="bib51">Marcatili et al., 2008</xref>), ABodyBuilder (<xref ref-type="bibr" rid="bib44">Leem et al., 2016</xref>), and MODELLER (<xref ref-type="bibr" rid="bib27">Eswar et al., 2006</xref>), often provide demonstrably inaccurate predictions for CDR-H3 sequences (<xref ref-type="bibr" rid="bib6">Almagro et al., 2014</xref>; <xref ref-type="bibr" rid="bib67">Teplyakov et al., 2014</xref>; <xref ref-type="bibr" rid="bib5">Almagro et al., 2011</xref>), and as a result, alternative artificial intelligence (AI)-based approaches, such as AlphaFold2 (AF2) (<xref ref-type="bibr" rid="bib40">Jumper and Hassabis, 2022</xref>; <xref ref-type="bibr" rid="bib39">Jumper et al., 2021</xref>), trRosetta (<xref ref-type="bibr" rid="bib23">Du et al., 2021</xref>), and RoseTTAFold (<xref ref-type="bibr" rid="bib7">Baek et al., 2021</xref>), are increasing in popularity. AF2 has shown comparable accuracy to experimentally determined structures by capturing physical and biological information about protein folding, thus providing a versatile deep learning framework for structure prediction. Structure prediction methods using pre-trained protein language models (PLMs), for example, HelixFold-Single (<xref ref-type="bibr" rid="bib28">Fang et al., 2022</xref>),OmegaFold (<xref ref-type="bibr" rid="bib73">Wu et al., 2022a</xref>), and ESMFold (<xref ref-type="bibr" rid="bib47">Lin et al., 2023</xref>), have shown comparable performance to AF2 with accelerated prediction speed. PLMs can be trained with datasets comprising tens of millions of unlabeled protein sequences in a self-supervised manner and can be subsequently applied to a variety of downstream tasks, such as druggable protein target prediction (<xref ref-type="bibr" rid="bib13">Chen et al., 2023</xref>), predicting protein function, and protein design (<xref ref-type="bibr" rid="bib35">Hie et al., 2024</xref>; <xref ref-type="bibr" rid="bib30">Ferruz et al., 2022</xref>; <xref ref-type="bibr" rid="bib50">Madani et al., 2023</xref>). Antibody-specific tools such as IgFold (<xref ref-type="bibr" rid="bib59">Ruffolo et al., 2023</xref>), tFold-Ab (<xref ref-type="bibr" rid="bib74">Wu et al., 2022b</xref>), DeepAb (<xref ref-type="bibr" rid="bib58">Ruffolo et al., 2022</xref>), and NanoNet <xref ref-type="bibr" rid="bib19">Cohen et al., 2022</xref> have also been developed to improve accuracy in CDR-H3 prediction. Among them, IgFold leverages sequence representations from PLMs to efficiently predict antibody structures within seconds, and notably, IgFold can provide accuracy comparable to AF2, enabling high-throughput prediction of antibody structures.</p><p>In this study, we present H3-OPT, which combines features of AF2 and PLMs to predict antibody structures. We compare H3-OPT with several other antibody structure prediction methods and found that it can provide a lower average RMSD<sub>Cα</sub> for CDR-H3 loops than other algorithms in three subsets of varying difficulty. To further validate our model, we experimentally solved the structures of three anti-VEGF nanobodies predicted by H3-OPT (<xref ref-type="bibr" rid="bib81">Zhu et al., 2023</xref>). We examined the potential applications of H3-OPT through analyzing antibody surface properties and antibody–antigen interactions. We demonstrate the informative value of high-quality H3 loops for predicting binding affinity and further support the use of H3-OPT as a powerful and versatile tool for studying antigen–antibody interactions. This structural prediction tool can be used to optimize antibody–antigen binding and engineer therapeutic antibodies with biophysical properties.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>High-quality antibody crystal structures in benchmarks</title><p>To evaluate the performance of AF2 against currently available methods, we conducted two datasets (DB1 and DB2) with high-resolution (&lt;2.5 Å) X-ray crystal structures from SAbDab (<xref ref-type="bibr" rid="bib55">Raybould et al., 2020</xref>). The CDR length distributions were similar in each dataset (<xref ref-type="fig" rid="fig1">Figure 1b</xref>). Additionally, we plotted sequence logos and identified the CDR loops of all heavy chain sequences (<xref ref-type="fig" rid="fig1">Figure 1c and d</xref>). These sequence logo plots revealed higher degree of sequence variability of CDR loops, particularly in the CDR-H3, with smaller residue letters than framework regions. Overall, high-quality and diverse antibody datasets allowed us to assess the quality of predicted models and evaluate the strengths and weaknesses of all alternative methods.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Accuracy of AF2 on antibody modeling.</title><p>(<bold>a</bold>) Schematic for CDR heavy chain loops. (<bold>b</bold>) The CDR lengths of monoclonal antibodies (mAbs) (n = 47) and nanobodies (Nbs) (n = 78). The error bars represent the standard deviation of the data. (<bold>c</bold>) Sequence logo plots of V<sub>H</sub> fragments in DB1. (<bold>d</bold>) Sequence logo plots of V<sub>H</sub> fragments in DB2. The different colors of codes represent the hydrophobicity of amino acids. (<bold>e</bold>) The performance of AF2 on different datasets using various evaluation metrics. In the box plots, the lines at the center of the boxes represent the medians, and the top and bottom lines of the boxes represent the upper and lower quartiles.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91512-fig1-v1.tif"/></fig></sec><sec id="s2-2"><title>Accuracy of AF2 for the overall antibody structure predictions was remarkable</title><p>To assess the similarity between the predicted models generated by each method and the experimentally determined structure, we first computed the template modeling scores (TM-scores) (<xref ref-type="bibr" rid="bib80">Zhang and Skolnick, 2004</xref>) for all predicted models of each target. The TM-scores of AF2 predictions in different datasets were as follows: DB1, 0.93 ± 0.04; DB2, 0.94 ± 0.03 (<xref ref-type="fig" rid="fig1">Figure 1e</xref>). Although the average TM-score of AF2 was slightly lower than those of DeepAb in DB1, it outperformed DeepAb by a large margin in DB2 (0.94 vs 0.87, on average). Then, we used global distance test (GDT) scores (<xref ref-type="bibr" rid="bib79">Zemla et al., 1999</xref>) to assess the similarity of predicted substructures at different structural cutoffs. The average GDT-TS scores of the models generated by AF2, ABodyBuilder, and DeepAb in DB1 were 0.90, 0.88, and 0.91, respectively. In DB2, the GDT-TS scores of AF2, RoseTTAFold, and NanoNet all exceeded 0.90. Furthermore, we found that the models with high GDT-TS scores also exhibited higher GDT-HA scores compared to the models with low GDT-TS scores. We finally calculated the average Z-scores of GDT-TS, GDT-HA, and TM-score for all datasets to provide comprehensive scores for each method. AF2 outperformed other methods on both DB1 and DB2, with an average Z-score of 0.87 and 1.08, respectively.</p></sec><sec id="s2-3"><title>AlphaFold2 accurately predicted the V<sub>H</sub>/V<sub>L</sub> orientations and CDR-H3 loops of antibodies</title><p>Given the vital roles of CDR-H3 loops in antigen recognition, we assessed the local accuracy of CDR-H3 loops among all participants. We first superimposed the backbone atoms of the entire Fv regions to reference structures and calculated the heavy atom RMSDs of CDR-H3 loops (RMSD<sub>HA</sub>). The average RMSD<sub>HA</sub> values of AF2, DeepAb, and ABodyBuilder in DB1 were 3.92, 3.64, and 3.69 Å, respectively, which were lower than those of other methods (<xref ref-type="fig" rid="fig2">Figure 2a</xref>). Additionally, these RMSD<sub>HA</sub> values decreased slightly after superimposing the V<sub>H</sub> backbone heavy atoms, indicating that these methods could predict V<sub>H</sub>/V<sub>L</sub> orientations more accurately than other alternative methods (<xref ref-type="fig" rid="fig2">Figure 2b</xref>). Similar to TM-score, DeepAb performed better than AF2 in DB1, but its accuracy decreased substantially in DB2 (<xref ref-type="fig" rid="fig2">Figure 2c</xref>). AF2, NanoNet, and ABodyBuilder outperformed other methods in DB2, with average RMSD<sub>HA</sub> values of 3.79, 3.44, and 4.37 Å, respectively.</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Accuracy of AF2 on different antibody regions.</title><p>(<bold>a</bold>) The performance of AlphaFold2 in DB1 relative to other methods after superimposing Fv backbones. (<bold>b</bold>) The performance of H3-OPT in DB1 relative to other methods after superimposing V<sub>H</sub> backbones. (<bold>c</bold>) The performance of H3-OPT in DB2 relative to other methods.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91512-fig2-v1.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Local accuracy of AlphaFold2 prediction.</title><p>(<bold>a</bold>) Side-by-side comparison of backbone and CDR3 heavy atom root mean square deviations (RMSDs) for DeepAb and AlphaFold2 in DB1. (<bold>b</bold>) Side-by-side comparison of backbone and CDR3 heavy atom RMSDs for NanoNet and AlphaFold2 in DB2. (<bold>c</bold>) Side-by-side comparison of backbone and CDR3 heavy atom RMSDs for ABodyBuilder and AlphaFold2 in DB1. (<bold>d</bold>) Side-by-side comparison of backbone and CDR3 heavy atom RMSDs for ABodyBuilder and AlphaFold2 in DB2. The slashes represent a cutoff value of 0.5 Å.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91512-fig2-figsupp1-v1.tif"/></fig></fig-group><p>To better understand the prediction results, we next conducted side-to-side comparisons for the abovementioned methods. The results showed that there were no significant differences in either the backbone or CDR-H3 RMSDs after superimposing the V<sub>H</sub> backbone heavy atoms between DeepAb and AF2 (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1a</xref>). Additionally, AF2 accurately produced the Nb structures with lower backbone RMSDs (all below 4 Å), but provided comparative accuracy in CDR-H3 RMSDs with NanoNet (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1b</xref>). We found that the main reason for this result was that NanoNet predicted wrong main-chain structures at the C-terminus. ABodyBuilder utilized homology modeling-based algorithm for structure prediction, providing similar or better backbone quality than AF2 (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1c and d</xref>). However, it did not significantly improve the accuracy of the CDR3 loops because ABodyBuilder highly relied on the quality of templates (especially when modeling DB2). Taken together, these results indicated that AF2 was a highly effective tool for predicting antibody structures both in mAbs and Nbs, and it produced CDR-H3 loops that were comparable to those generated by AI-based antibody-specific methods.</p></sec><sec id="s2-4"><title>Quantum mechanics-based optimization failed to optimize CDR-H3 loops</title><p>Due to the lack of consideration of electronic effects in AF2, we hypothesized that the accuracy of CDR-H3 could be further improved by quantum mechanics (QM)-based methods. We applied two QM-based approaches to optimize AF2 models: the first was an energy-based re-ranking method, and the second was loop optimization with QM. For the first approach, we introduced a new dataset containing 14 antibody sequences with the same CDR-H3 and then run QM optimization for all AF2 models. These models were re-ranked according to the QM energies. As shown in <xref ref-type="table" rid="table1">Table 1</xref>, our results demonstrated that this method outperformed the default ranking criteria for 8 out of 14 targets, achieving an average RMSD improvement of 0.69 Å. However, this re-ranking method did not yield more accurate results when applied to a larger database (DB3) (<xref ref-type="table" rid="table2">Table 2</xref>). We also made additional attempts to improve the re-ranking process by removing constraints on terminal atoms, altering re-ranking criteria, and considering solvent effects. However, these methods did not improve the accuracy of AF2 (ΔRMSDs &lt; 0). Moreover, the QM-based optimization methods also failed to improve the accuracy of H3 loops (<xref ref-type="table" rid="table3">Table 3</xref>). We finally generated structures based on the conformational proportions using Boltzmann distribution of the QM energies, but the accuracy of these structures did not match that of Ranked_0, with all ΔRMSD below 0. In conclusion, although QM-based methods may not improve the accuracy of CDR-H3 loops in general cases, it still provided opportunities for loop modeling as the development of more accurate physics-based methods.</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>The root mean square deviation (RMSD) results of PM6D3 level re-ranking method on 14 same CDR-H3 antibodies.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom" colspan="2">PDB ID</th><th align="left" valign="bottom">Ranked 0 RMSD</th><th align="left" valign="bottom" colspan="2">Lowest energy RMSD</th><th align="left" valign="bottom">Lowest RMSD</th><th align="left" valign="bottom">Δ<sub>RMSD</sub><xref ref-type="table-fn" rid="table1fn1">*</xref></th></tr></thead><tbody><tr><td align="char" char="." valign="bottom">4kmt</td><td align="char" char="." valign="bottom" colspan="3">1.06</td><td align="char" char="." valign="bottom">1.14</td><td align="char" char="." valign="bottom">1.05</td><td align="char" char="." valign="bottom">–0.08</td></tr><tr><td align="char" char="." valign="bottom">5i19</td><td align="char" char="." valign="bottom" colspan="3">2.16</td><td align="char" char="." valign="bottom">1.91</td><td align="char" char="." valign="bottom">1.77</td><td align="char" char="." valign="bottom">0.25</td></tr><tr><td align="char" char="." valign="bottom">5i1l</td><td align="char" char="." valign="bottom" colspan="3">3.80</td><td align="char" char="." valign="bottom">3.20</td><td align="char" char="." valign="bottom">3.19</td><td align="char" char="." valign="bottom">0.60</td></tr><tr><td align="char" char="." valign="bottom">5i17</td><td align="char" char="." valign="bottom" colspan="3">2.86</td><td align="char" char="." valign="bottom">3.71</td><td align="char" char="." valign="bottom">2.86</td><td align="char" char="." valign="bottom">–0.85</td></tr><tr><td align="char" char="." valign="bottom">5i1d</td><td align="char" char="." valign="bottom" colspan="3">2.10</td><td align="char" char="." valign="bottom">2.10</td><td align="char" char="." valign="bottom">2.02</td><td align="char" char="." valign="bottom">0.00</td></tr><tr><td align="char" char="." valign="bottom">5i1c</td><td align="char" char="." valign="bottom" colspan="3">2.43</td><td align="char" char="." valign="bottom">1.66</td><td align="char" char="." valign="bottom">1.45</td><td align="char" char="." valign="bottom">0.77</td></tr><tr><td align="char" char="." valign="bottom">5i1a</td><td align="char" char="." valign="bottom" colspan="3">2.37</td><td align="char" char="." valign="bottom">0.85</td><td align="char" char="." valign="bottom">0.59</td><td align="char" char="." valign="bottom">1.52</td></tr><tr><td align="char" char="." valign="bottom">5i1i</td><td align="char" char="." valign="bottom" colspan="3">3.72</td><td align="char" char="." valign="bottom">3.51</td><td align="char" char="." valign="bottom">3.51</td><td align="char" char="." valign="bottom">0.21</td></tr><tr><td align="char" char="." valign="bottom">5i15</td><td align="char" char="." valign="bottom" colspan="3">2.16</td><td align="char" char="." valign="bottom">1.94</td><td align="char" char="." valign="bottom">1.35</td><td align="char" char="." valign="bottom">0.22</td></tr><tr><td align="char" char="." valign="bottom">5i16</td><td align="char" char="." valign="bottom" colspan="3">3.19</td><td align="char" char="." valign="bottom">1.70</td><td align="char" char="." valign="bottom">1.39</td><td align="char" char="." valign="bottom">1.49</td></tr><tr><td align="char" char="." valign="bottom">5i18</td><td align="char" char="." valign="bottom" colspan="3">2.88</td><td align="char" char="." valign="bottom">2.88</td><td align="char" char="." valign="bottom">2.88</td><td align="char" char="." valign="bottom">0.00</td></tr><tr><td align="char" char="." valign="bottom">5i1e</td><td align="char" char="." valign="bottom" colspan="3">1.62</td><td align="char" char="." valign="bottom">1.13</td><td align="char" char="." valign="bottom">0.92</td><td align="char" char="." valign="bottom">0.49</td></tr><tr><td align="char" char="." valign="bottom">5i1g</td><td align="char" char="." valign="bottom" colspan="3">2.08</td><td align="char" char="." valign="bottom">2.08</td><td align="char" char="." valign="bottom">2.00</td><td align="char" char="." valign="bottom">0.00</td></tr><tr><td align="char" char="." valign="bottom">5i1h</td><td align="char" char="." valign="bottom" colspan="3">1.58</td><td align="char" char="." valign="bottom">1.84</td><td align="char" char="." valign="bottom">1.32</td><td align="char" char="." valign="bottom">–0.26</td></tr></tbody></table><table-wrap-foot><fn id="table1fn1"><label>*</label><p>Δ<sub>RMSD</sub> was calculated by subtracting the RMSD of predicted model from the RMSD of Ranked_0 model.</p></fn></table-wrap-foot></table-wrap><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>Accuracy of quantum mechanics (QM)-based re-ranking methods.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top">Method</th><th align="left" valign="top">Freeze terminal Cα</th><th align="left" valign="top">CDR<xref ref-type="table-fn" rid="table2fn2">*</xref></th><th align="left" valign="top">Phase</th><th align="left" valign="top">Ranked 0 RMSD</th><th align="left" valign="top">Lowest energy RMSD</th><th align="left" valign="top">Lowest RMSD</th><th align="left" valign="top">Δ<sub>RMSD</sub></th></tr></thead><tbody><tr><td align="left" valign="top">PM6D3</td><td align="left" valign="top">Y</td><td align="left" valign="top">H3</td><td align="left" valign="top">Gas</td><td align="char" char="." valign="top">2.64</td><td align="char" char="." valign="top">2.76</td><td align="char" char="." valign="top">2.16</td><td align="char" char="." valign="top">–0.12</td></tr><tr><td align="left" valign="top">PM6D3</td><td align="left" valign="top">N</td><td align="left" valign="top">H3</td><td align="left" valign="top">Gas</td><td align="char" char="." valign="top">2.53</td><td align="char" char="." valign="top">2.67</td><td align="char" char="." valign="top">2.03</td><td align="char" char="." valign="top">–0.14</td></tr><tr><td align="left" valign="top">PM6D3</td><td align="left" valign="top">N</td><td align="left" valign="top">H1, H2, H3</td><td align="left" valign="top">Gas</td><td align="char" char="." valign="top">2.50</td><td align="char" char="." valign="top">2.64</td><td align="char" char="." valign="top">2.00</td><td align="char" char="." valign="top">–0.14</td></tr><tr><td align="left" valign="top">B3LYP</td><td align="left" valign="top">N</td><td align="left" valign="top">H3</td><td align="left" valign="top">Gas</td><td align="char" char="." valign="top">2.66</td><td align="char" char="." valign="top">2.87</td><td align="char" char="." valign="top">2.30</td><td align="char" char="." valign="top">–0.21</td></tr><tr><td align="left" valign="top">B3LYP</td><td align="left" valign="top">N</td><td align="left" valign="top">H3</td><td align="left" valign="top">Water</td><td align="char" char="." valign="top">2.66</td><td align="char" char="." valign="top">2.68</td><td align="char" char="." valign="top">2.30</td><td align="char" char="." valign="top">–0.02</td></tr></tbody></table><table-wrap-foot><fn><p>RMSD = root mean square deviation.</p></fn><fn id="table2fn2"><label>*</label><p>CDR means the energy of which loop is used to re-rank AF2 models.</p></fn></table-wrap-foot></table-wrap><table-wrap id="table3" position="float"><label>Table 3.</label><caption><title>Accuracy of quantum mechanics (QM)-based optimization methods.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Method</th><th align="left" valign="bottom">Freeze terminal Cα</th><th align="left" valign="bottom">Structure generation method</th><th align="left" valign="bottom">Phase</th><th align="left" valign="bottom">Ranked 0 RMSD</th><th align="left" valign="bottom">Lowest energy RMSD/opted RMSD</th><th align="left" valign="bottom">Lowest RMSD</th><th align="left" valign="bottom">Δ<sub>RMSD</sub></th></tr></thead><tbody><tr><td align="left" valign="bottom">PM6D3</td><td align="left" valign="bottom">Y</td><td align="char" char="." valign="bottom">/</td><td align="left" valign="bottom">Gas</td><td align="char" char="." valign="bottom">1.69</td><td align="char" char="." valign="bottom">1.74/1.87</td><td align="char" char="." valign="bottom">1.37</td><td align="char" char="." valign="bottom">–0.05</td></tr><tr><td align="left" valign="bottom">B3LYP</td><td align="left" valign="bottom">N</td><td align="char" char="." valign="bottom">/</td><td align="left" valign="bottom">Gas</td><td align="char" char="." valign="bottom">1.63</td><td align="char" char="." valign="bottom">1.65/2.55</td><td align="char" char="." valign="bottom">1.38</td><td align="char" char="." valign="bottom">–0.02</td></tr><tr><td align="left" valign="bottom">B3LYP</td><td align="left" valign="bottom">N</td><td align="char" char="." valign="bottom">/</td><td align="left" valign="bottom">Water</td><td align="char" char="." valign="bottom">1.63</td><td align="char" char="." valign="bottom">1.58/2.25</td><td align="char" char="." valign="bottom">1.38</td><td align="char" char="." valign="bottom">0.05</td></tr><tr><td align="left" valign="bottom">B3LYP</td><td align="left" valign="bottom">N</td><td align="left" valign="bottom">Boltzmann</td><td align="left" valign="bottom">Gas</td><td align="char" char="." valign="bottom">1.56</td><td align="char" char="." valign="bottom">2.05</td><td align="char" char="." valign="bottom">1.28</td><td align="char" char="." valign="bottom">–0.49</td></tr><tr><td align="left" valign="bottom">B3LYP</td><td align="left" valign="bottom">N</td><td align="left" valign="bottom">Boltzmann</td><td align="left" valign="bottom">Water</td><td align="char" char="." valign="bottom">1.56</td><td align="char" char="." valign="bottom">1.81</td><td align="char" char="." valign="bottom">1.28</td><td align="char" char="." valign="bottom">–0.25</td></tr><tr><td align="left" valign="bottom">B3LYP</td><td align="left" valign="bottom">N</td><td align="left" valign="bottom">Boltzmann, minimized</td><td align="left" valign="bottom">Gas</td><td align="char" char="." valign="bottom">1.56</td><td align="char" char="." valign="bottom">1.96</td><td align="char" char="." valign="bottom">1.28</td><td align="char" char="." valign="bottom">–0.40</td></tr><tr><td align="left" valign="bottom">B3LYP</td><td align="left" valign="bottom">N</td><td align="left" valign="bottom">Boltzmann, minimized</td><td align="left" valign="bottom">Water</td><td align="char" char="." valign="bottom">1.56</td><td align="char" char="." valign="bottom">1.84</td><td align="char" char="." valign="bottom">1.28</td><td align="char" char="." valign="bottom">–0.28</td></tr></tbody></table><table-wrap-foot><fn><p>RMSD = root mean square deviation.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s2-5"><title>Molecular dynamics (MD) simulations could not provide accurate CDR-H3 loop conformations</title><p>MD simulations were extensively used to explore stable conformations of proteins in a water environment (<xref ref-type="bibr" rid="bib54">Pan and Aller, 2018</xref>) and were also introduced to loop modeling (<xref ref-type="bibr" rid="bib9">Barozet et al., 2021</xref>). We used MD simulations to search for representative CDR-H3 loop conformations. The simulation systems consist of antibody structures, water, and ions. We selected the top 10 challenging-to-predict targets from the DB1 and DB2 to investigate the dynamic conformations of CDR-H3 loops. The first target was 7N0R, a single-domain antibody that binds the SARS-CoV-2 Nucleocapsid protein with a 12-residue CDR-H3 loop (<xref ref-type="bibr" rid="bib76">Ye et al., 2021</xref>). We found that MD successfully generated conformations with lower CDR-H3 Cα-RMSDs (average value is 5.62 Å, achieving an improvement of 5.30 Å over the AF2 prediction) by correcting the orientation of the CDR-H3 loop (<xref ref-type="fig" rid="fig3">Figure 3a</xref>). Additionally, the conformations of 7N0R indicated that the CDR-H3 loop was more flexible than framework regions and other CDR loops, demonstrated by root mean square fluctuation (RMSF) of every residue during simulation (<xref ref-type="fig" rid="fig3">Figure 3b</xref>). Despite these promising results for 7N0R, the high CDR-H3 Cα-RMSDs of all 10 targets (&gt;5 Å) and poor performance in other cases (ΔCα-RMSD &lt; 1.5 Å) (<xref ref-type="table" rid="table4">Table 4</xref>) both suggested that the conformation search method based on MD simulations failed to generate CDR-H3 loops that closely matched native structures. However, the accuracy of these antibodies with relative long CDR-H3 loops could be improved by H3-OPT through incorporating latent structural information of loop folding from ESM2 or enhanced sampling techniques (<xref ref-type="bibr" rid="bib29">Feng et al., 2021</xref>).</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Molecular dynamics (MD) generated conformations for benchmark target 7N0R.</title><p>(<bold>a</bold>) Comparison of CDR-H3 loops of MD (gray), AF2 (pink), and experimentally determined structure (cyan). (<bold>b</bold>) Root mean square fluctuation (RMSF) of antibody residues during simulation. CDR-H3 loop is located in residue number ranging from 98 to 109.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91512-fig3-v1.tif"/></fig><table-wrap id="table4" position="float"><label>Table 4.</label><caption><title>The accuracy of molecular dynamics (MD)-based CDR-H3 loop optimization in the 10 worst cases of AF2.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top">PDB ID</th><th align="left" valign="top">Cα-RMSD<sub>Ranked_0</sub></th><th align="left" valign="top">Cα-RMSD<sub>MD_opt</sub></th><th align="left" valign="top">ΔCα-RMSD</th></tr></thead><tbody><tr><td align="char" char="." valign="top">7n0r</td><td align="char" char="." valign="top">10.92</td><td align="char" char="plusmn" valign="top">5.62 ± 0.97</td><td align="char" char="." valign="top">5.30</td></tr><tr><td align="char" char="." valign="top">3juy</td><td align="char" char="." valign="top">6.37</td><td align="char" char="plusmn" valign="top">5.71 ± 0.23</td><td align="char" char="." valign="top">0.66</td></tr><tr><td align="char" char="." valign="top">5y80</td><td align="char" char="." valign="top">6.61</td><td align="char" char="plusmn" valign="top">7.59 ± 0.47</td><td align="char" char="." valign="top">–0.98</td></tr><tr><td align="char" char="." valign="top">7a4t</td><td align="char" char="." valign="top">6.19</td><td align="char" char="plusmn" valign="top">7.48 ± 0.29</td><td align="char" char="." valign="top">–1.29</td></tr><tr><td align="char" char="." valign="top">4nzr</td><td align="char" char="." valign="top">6.57</td><td align="char" char="plusmn" valign="top">7.73 ± 0.26</td><td align="char" char="." valign="top">–1.16</td></tr><tr><td align="char" char="." valign="top">6xzu</td><td align="char" char="." valign="top">7.45</td><td align="char" char="plusmn" valign="top">6.34 ± 0.94</td><td align="char" char="." valign="top">1.11</td></tr><tr><td align="char" char="." valign="top">6x05</td><td align="char" char="." valign="top">6.32</td><td align="char" char="plusmn" valign="top">7.48 ± 0.63</td><td align="char" char="." valign="top">–1.16</td></tr><tr><td align="char" char="." valign="top">3c08</td><td align="char" char="." valign="top">6.68</td><td align="char" char="plusmn" valign="top">7.01 ± 0.11</td><td align="char" char="." valign="top">–0.33</td></tr><tr><td align="char" char="." valign="top">4z9k</td><td align="char" char="." valign="top">9.04</td><td align="char" char="plusmn" valign="top">8.01 ± 0.37</td><td align="char" char="." valign="top">1.03</td></tr><tr><td align="char" char="." valign="top">6oca</td><td align="char" char="." valign="top">7.61</td><td align="char" char="plusmn" valign="top">8.01 ± 0.34</td><td align="char" char="." valign="top">–0.40</td></tr></tbody></table><table-wrap-foot><fn><p>RMSD = root mean square deviation.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s2-6"><title>The H3-OPT workflow</title><p>Prior to training H3-OPT, we first conducted a thorough evaluation of currently available antibody structure prediction tools, including AF2, RoseTTAFold, trRosetta, NanoNet, DeepAb, MODELLER, and ABodyBuilder. AF2 provided high-accuracy predictions for the overall structures of both mAbs and Nbs, with TM-scores and GDT scores &gt;0.9. Based on the relatively higher accuracy of AF2 in structural predictions, its prediction was used to extract structural features of CDR-H3 loops for further optimization by H3-OPT. Using a mAb/Nb sequence and its Fv model structure from AF2 as input, H3-OPT was then used to generate a refined structure. As data quality has large effects on prediction accuracy, we constructed a non-redundant dataset (sequence identity &lt; 0.8) with 1286 high-resolution (&lt;2.5 Å) antibody structures from SAbDab (<xref ref-type="bibr" rid="bib24">Dunbar et al., 2014</xref>; <xref ref-type="fig" rid="fig4">Figure 4a</xref>). The dataset was then divided into training, validation, and test sets based on amino acid sequence identity, which was done by using the UCLUST (<xref ref-type="bibr" rid="bib26">Edgar, 2010</xref>) software. To assess the prediction results, the test set was split into three subgroups according to the differences in AF2 accuracy (RMSD, a measure of the difference between the predicted structure and an experimental or reference structure) stemming from the length of CDR-H3 sequence: easy-to-predict targets (0–2 Å, Sub1); moderate-difficulty targets (2–4 Å, Sub2); and challenging-to-predict targets (&gt;4 Å, Sub3), with average CDR-H3 loop sequence lengths of 9.12, 11.08, and 16.43, respectively.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>H3-OPT architecture.</title><p>(<bold>a</bold>) Schematic for dataset preparation. Structures were screened from the SAbDab database based on resolution and sequence identity. Clustering of the filtered, high-resolution structures yielded three datasets for training (n = 1021), validation (n = 134), and testing (n = 131). (<bold>b</bold>) The workflow of H3-OPT includes two modules. The template module determines whether to use PLM-based structure prediction module (PSPM), while the PSPM module optimizes the AF2 input structures. (<bold>c</bold>) The template module retains AF2-predicted loops when the confidence score is &gt;0.8 and grafts CDR-H3 loops onto AF2 models for structures with an available template. (<bold>d</bold>) In the PSPM, the network extracts residue-level information and pairwise residue representations from the AF2-predicted models, which are subsequently updated using weight-sharing blocks and concatenated with sequence representations from ESM2. The resulting data is used to predict the 3D coordinates of the H3 loops.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91512-fig4-v1.tif"/></fig><p>The workflow of H3-OPT is depicted in <xref ref-type="fig" rid="fig4">Figure 4b</xref>. H3-OPT consists of a template module and a PLM-based structure prediction module (PSPM). The template module determines whether to use PSPM to optimize CDR-H3 and comprises two submodules: a confidence-based module (CBM) and a template-grafting module (TGM). The CBM calculates an AF2 confidence score to evaluate the reliability of CDR-H3 loop sequence inputs through MSA and template searching. The TGM then identifies a template from the H3 template database and grafts the CDR-H3 loop onto the AF2 model if such a template is available (<xref ref-type="fig" rid="fig4">Figure 4c</xref>).</p><p>The PSPM contains a series of attention-based components to ensure that the complete structural context is extracted from the input sequences. Specifically, the PSPM employs a row-wise gated attention layer that updates residue-level information and exchanges information within residue pair representations and residue features to infer relationships between the spatial and residue representations. Additionally, by leveraging sequence-level representations from PLMs along with residue-level information, the PSPM can integrate high-information features, such as protein folding patterns, across a vast protein space to predict final three-dimensional (3D) atomic coordinates (<xref ref-type="fig" rid="fig4">Figure 4d</xref>).</p><p>To better understand the contribution of each module to H3-OPT accuracy with varying factors, we next examined how incorporating different approaches through the template and PSPM modules could improve accuracy of H3-OPT. While AF2 showed markedly stronger predictions than IgFold in Sub1 (<xref ref-type="fig" rid="fig5">Figure 5a</xref>), IgFold provided higher accuracy in Sub3 (<xref ref-type="fig" rid="fig6">Figure 6a</xref>). In light of previous studies that showed PLM-based models are computationally more efficient but have unsatisfactory accuracy when high-resolution templates and MSA are available (<xref ref-type="bibr" rid="bib47">Lin et al., 2023</xref>), we therefore sought to combine the strengths of AF2 with PLM-based modeling. Similar to IgFold, an initial version of H3-OPT lacking the CBM could not replicate the accuracy of AF2 in Sub1. Interestingly, we observed that the AF2 confidence score of CDR-H3 shared a strong negative correlation with Cα-RMSDs (Pearson correlation coefficient = −0.67; <xref ref-type="fig" rid="fig5">Figure 5b</xref>), which led to us to hypothesize that AF2 models with high-confidence scores might be sufficiently accurate, and therefore do not require further optimization. Following this notion, we incorporated a CBM submodule that could directly retain high-confidence structures from AF2. TGM submodule was added as a means of grafting identical H3 loop templates from public PDBs onto AF2-predicted models to further improve accuracy. Ablation studies in which the CBM or TGM were excluded to determine their respective contributions to the final predictive accuracy (<xref ref-type="fig" rid="fig5">Figure 5c–f</xref>) revealed that H3-OPT without the template module could generate structures with average Cα-RMSDs of 1.76, 2.76, and 4.86 Å for the Sub1, Sub2, and Sub3 datasets, respectively. Incorporating only the CBM into our model significantly improved RMSD<sub>Cα</sub> score by 0.62 Å for Sub1, but exerted negligible effects on Sub2 and Sub3. By contrast, including the TGM alone resulted in substantially improved RMSD<sub>Cα</sub> for Sub2 and Sub3 by 0.68 and 1.04 Å, respectively, suggesting that templates were more effective for relatively long CDR-H3 antibodies. These results suggested that the combination of TGM and CBM modules could leverage available templates to improve prediction accuracy.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Template module and ablation studies.</title><p>(<bold>a</bold>) Side-by-side comparison of Cα-RMSDs of AF2 and IgFold for Sub1 (n = 52); color scale for data points reflects CDR3 length. AF2 outperformed IgFold for targets left of the dashed diagonal; IgFold outperformed AF2 for targets right of the dashed diagonal. (<bold>b</bold>) Correlations between AF2 confidence score and amino acid sequence length of CDR-H3 loops. Datapoint color indicates Cα-RMSD value for that target. The correlation coefficient for confidence score and CDR-H3 loop length is −0.5921. (<bold>c</bold>) The accuracy of H3-OPT in three subgroups of the test set. ΔCα-RMSDs were calculated by subtracting the RMSD<sub>Cα</sub> of AF2 from that of H3-OPT. AF2 had higher accuracy for targets above the dashed line; H3-OPT had better accuracy for structures below the dashed line. (<bold>d</bold>) Differences in H3-OPT accuracy without the template module. This ablation study means only PLM-based structure prediction module (PSPM) is used. (<bold>e</bold>) Differences in H3-OPT accuracy without the confidence-based module (CBM). This ablation study means input loop is optimized by template-grafting module (TGM) and PSPM. There are 30 targets in our database with identical CDR-H3 templates. (<bold>f</bold>) Differences in H3-OPT accuracy without the TGM. This ablation study means input loop is optimized by CBM and PSPM.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91512-fig5-v1.tif"/></fig><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>PLM-based structure prediction module (PSPM) module.</title><p>(<bold>a</bold>) Side-by-side comparison of Cα-RMSDs for AF2 and IgFold, IgFold and H3-OPT in the Sub2 (n = 46) and Sub3 (n = 33) test sets, respectively. (<bold>b</bold>) Comparison of prediction accuracy between AF2 and H3-OPT for Sub2 and Sub3 targets. Metrics including root mean square deviations (RMSDs), template modeling scores (TM-scores), and global distance test (GDT) scores were used to quantitatively assess similarity between predicted and experimental structures. (<bold>c</bold>) Comparison of prediction accuracy between AF2 and H3-OPT using six metrics (RMSD<sub>Cα</sub>, RMSD<sub>backbone</sub>, RMSD<sub>sidechain</sub>, TM-score, GDT-TS score and GDT-HA score). Radar plots of the mean values of different methods and metrics in predictions of Sub2 and Sub3 targets.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91512-fig6-v1.tif"/></fig><p>Since the large majority of sequences in Sub2 and Sub3 have long CDR-H3 loops with few sequence homologs, attaining high accuracy in structural predictions becomes increasingly challenging for AF2 (<xref ref-type="bibr" rid="bib39">Jumper et al., 2021</xref>). Inspired by IgFold and other PLM-based methods (<xref ref-type="fig" rid="fig3">Figure 3a</xref>), we thus developed a PSPM module to capture structural information from the sequence embeddings of PLMs (<xref ref-type="bibr" rid="bib57">Rives et al., 2021</xref>). The key innovations of the PSPM for our workflow were the integration of sequence-level representations from PLMs and the simplified architecture of AF2. ProtTrans-T5, AntiBERTy, and ESM2 were initially used without fine-tuning, resulting in overall average Cα-RMSDs of 2.40, 2.49, and 2.32 Å, respectively (<xref ref-type="table" rid="table5">Table 5</xref>). To improve accuracy, we employed a fine-tuning approach for the downstream CDR-H3 structure prediction task. As ESM2 outperformed other PLMs in our test set, we fine-tuned parameters of all ESM2 hidden layers, which resulted in an overall RMSD<sub>Cα</sub> of 2.24 Å for H3-OPT. It should be noted that most computational models, such as IgFold, froze PLM weights during model training (<xref ref-type="bibr" rid="bib59">Ruffolo et al., 2023</xref>). Analysis of test subsets showed that H3-OPT could provide high accuracy in side chain predictions, high TM-scores, and high GDT scores in Sub2 and Sub3 (<xref ref-type="fig" rid="fig6">Figure 6b and c</xref>).</p><table-wrap id="table5" position="float"><label>Table 5.</label><caption><title>Performance of H3-OPT with different protein language models (PLMs).</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"/><th align="left" valign="bottom">RMSD<sub>Cα</sub> (Å)</th></tr></thead><tbody><tr><td align="left" valign="bottom">H3-OPT</td><td align="char" char="plusmn" valign="bottom">2.24 ± 1.05</td></tr><tr><td align="left" valign="bottom">AF2</td><td align="char" char="plusmn" valign="bottom">2.85 ± 0.69</td></tr><tr><td align="left" valign="bottom">ESM2</td><td align="char" char="plusmn" valign="bottom">2.31 ± 1.13</td></tr><tr><td align="left" valign="bottom">Without PLM</td><td align="char" char="plusmn" valign="bottom">2.41 ± 1.26</td></tr><tr><td align="left" valign="bottom">AntiBERTy</td><td align="char" char="plusmn" valign="bottom">2.49 ± 1.42</td></tr><tr><td align="left" valign="bottom">ProtTrans-T5</td><td align="char" char="plusmn" valign="bottom">2.40 ± 1.28</td></tr></tbody></table><table-wrap-foot><fn><p>RMSD = root mean square deviation.</p></fn></table-wrap-foot></table-wrap><p>To expand its generalizability, we simplified the Evoformer architecture and introduced parameter-sharing to directly predict Cartesian coordinates of CDR-H3 loops through both residue-level features and pair representations. In residue-level representations, rows represented amino acid types and structural features derived from AF2, while columns represented individual residues from the input sequence. The pair representations contained information about the residue pairs, such as Cα-Cα distance. These residue-level representations were updated by the attention-based layers and continuously communicated with pair representations; the pair representations were then updated via triangular multiplicative layers (<xref ref-type="bibr" rid="bib39">Jumper et al., 2021</xref>). This simplified architecture improved model efficiency and avoided overfitting. We also applied a structural alignment strategy for feature extraction and model prediction. Given the high conservation of Fv structures, the alignment strategy was designed to effectively capture residue contribution to loop folding, resulting in improved training speed and accuracy. Taken together, H3-OPT provided high-accuracy predictions for CDR-H3 loops, facilitating the development of antibody therapeutics.</p></sec><sec id="s2-7"><title>H3-OPT provides higher accuracy CDR-H3 models than existing structure prediction software</title><p>We then evaluated the performance of H3-OPT against currently available methods, including AF2, IgFold, HelixFold-Single, ESMFold, and OmegaFold. H3-OPT achieved an average Cα root mean square deviation (RMSD<sub>Cα</sub>) of 2.24 Å for CDR-H3, while AF2 and IgFold had CDR-H3 RMSDs of 2.85 and 2.87 Å, respectively (<xref ref-type="fig" rid="fig7">Figure 7a</xref>). HelixFold-Single, OmegaFold, and ESM-Fold generated comparatively poor predictions, with RMSDs for CDR-H3 of 3.39, 3.75, and 4.23 Å, respectively. As shown in <xref ref-type="fig" rid="fig7">Figure 7b</xref>, H3-OPT provided higher accuracy predictions than other methods in all three subgroups, with average RMSDs of 1.10, 2.28, and 3.99 Å, respectively. While the predictions of H3-OPT were comparable to AF2 in Sub1, its accuracy was higher than AF2 in Sub2 and Sub3.</p><fig-group><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Accuracy of CDR-H3 loop prediction by H3-OPT.</title><p>(<bold>a</bold>) The performance of H3-OPT in the test set (n<sub>mAbs</sub> = 119, n<sub>Nbs</sub> = 12) relative to other methods. The RMSD<sub>Cα</sub> of H3-OPT was significantly lower than other existing methods (p&lt;0.001). (<bold>b</bold>) The performance of H3-OPT in structural predictions of three subgroups of the test set (n = 52, 46, and 33). (<bold>c</bold>) H3-OPT structural predictions for three anti-VEGF nanobodies (PDB ID: 8IIU, 8IJZ, 8IJS). The sequence identities of the VH domain and H3 loop are 0.816 and 0.647, respectively, compared with the best template. ***p&lt;0.001. RMSD, root mean square deviation.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91512-fig7-v1.tif"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 1.</label><caption><title>Comparison of accuracy between AF2, H3-OPT, and tFold-Ab methods using the <ext-link ext-link-type="uri" xlink:href="https://www.cameo3d.org/">CAMEO 2022 benchmark dataset</ext-link> (<xref ref-type="bibr" rid="bib45">Leemann et al., 2023</xref>).</title><p>The x-axis represents different targets, and y-axis represents Cα-RMSD values. RMSD, root mean square deviation.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91512-fig7-figsupp1-v1.tif"/></fig></fig-group><p>In light of these results, we then sought to validate H3-OPT using three experimentally determined structures of anti-VEGF nanobodies, including a wild-type (WT) and two mutant (Mut1 and Mut2) structures, that were recently deposited in Protein Data Bank (<xref ref-type="fig" rid="fig7">Figure 7c</xref>). Although Mut1 (E45A) and Mut2 (Q14N) shared the same CDR-H3 sequences as WT (Length<sub>CDR-H3</sub> = 17), only minor variations were observed in the CDR-H3. H3-OPT generated accurate predictions with Cα-RMSDs of 1.510, 1.541, and 1.411 Å for the WT, Mut1, and Mut2, respectively (the confidence scores of these AlphaFold2-predicted loops were all higher than 0.8, and these loops were accepted as the outputs of H3-OPT by CBM). Subsequent comparison with IgFold showed that AlphaFold2 outperformed IgFold on these targets and IgFold could not accurately predict the short helix in CDR-H3, resulting in Cα-RMSDs of 2.776 Å (WT), 2.888 Å (Mut1), and 2.448 Å (Mut2) and more diverse conformations of Mut1 and Mut2. These results indicated that IgFold was capable of learning long-range correlations in protein sequences, but that these long-range correlations could introduce larger errors when MSA and templates were available. These results thus demonstrated that MSA could strongly influence the accuracy for which similar CDR-H3 template structures were available.</p></sec><sec id="s2-8"><title>H3-OPT can predict antibody surface properties</title><p>To demonstrate how improved CDR-H3 structural accuracy can assist antibody engineering, we applied H3-OPT to predict surface properties. A comparison of H3-OPT with AF2 for identifying surface amino acids (SAAs) by the relative accessible surface areas (rASAs) of CDR-H3 loops showed that H3-OPT could predict SAAs, on average, close to that of the native structures (9.46 vs 9.40, <xref ref-type="fig" rid="fig8">Figure 8a</xref>), whereas AF2 predicted an average of 9.81 SAAs. Furthermore, H3-OPT predicted closer values to native structures than AF2 in predicting diverse surface properties, such as the distribution of hydrophilic or charged SAAs (<xref ref-type="fig" rid="fig8">Figure 8b</xref>).</p><fig-group><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Analysis of surface patches.</title><p>(<bold>a</bold>) Analysis of surface amino acids for predicted H3 loops. Y-axis represents average number of surface residues for H3 loops (n = 131). The surface residues of AF2 models are significantly higher than those of H3-OPT models (p&lt;0.05). (<bold>b</bold>) Histogram of surface patches with different properties predicted by H3-OPT, AF2, or experimentally solved H3 loops. Error bars show standard deviations. H3-OPT models predicted lower values than AF2 models in terms of various surface properties, including polarity (p&lt;0.05) and hydrophilicity (p&lt;0.001). (<bold>c</bold>) Solvent-accessible surface area (SASA) analysis of predicted H3 loops. Values represent the difference in SASA between predicted and experimentally determined H3 structures using AF2 or H3-OPT. The SASA of AF2 models are significantly higher than those of H3-OPT models (p&lt;0.001). (<bold>d</bold>) Comparison of the charged surface patches between H3-OPT and AF2 for target PDB ID: 5U3P. The surface maps compare the surface electrostatic potential of the CDR-H3 loop predicted by H3-OPT or AF2 with the native structure. Darker shading indicates greater difference in electrostatic potential. *p&lt;0.05; **p&lt;0.01; ***p&lt;0.001.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91512-fig8-v1.tif"/></fig><fig id="fig8s1" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 1.</label><caption><title>Solvent-accessible surface area (SASA) analysis of predicted H3 loops.</title><p>The values represent the difference in SASA between H3 structures predicted by AF2 or H3-OPT and experimentally determined structures. Positive values indicate that the predicted structures have more exposed surface area compared to the native structures; negative values indicate less exposed surface area.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91512-fig8-figsupp1-v1.tif"/></fig></fig-group><p>To examine insights H3-OPT could provide into the biophysical properties of antibodies (<xref ref-type="bibr" rid="bib20">Cong et al., 2021</xref>), we next estimated the solvent-accessible surface areas (SASAs). The average SASAs of H3-OPT loops closely resembled that of the native structures, with larger differences in AF2 predictions (<xref ref-type="fig" rid="fig8">Figure 8c</xref>). Plots of SASA distributions at each alignment position revealed smaller errors in H3-OPT than AF2, with ΔSASA ranging from –12.17 to 9.74 Å<sup>2</sup> (<xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1</xref>). In addition, comparison of surface charge distributions on the predicted CDR-H3 loops generated by H3-OPT and AF2 in an electrostatic map of a representative structure (PDB 5U3P, <xref ref-type="fig" rid="fig8">Figure 8d</xref>) showed that H3-OPT predictions were consistent with the experimental structure. These results collectively showed that accurate surface properties predicted by H3-OPT could provide insights into antibody folding and stability, as well as their interactions with antigens.</p></sec><sec id="s2-9"><title>H3-OPT can facilitate investigation of antibody–antigen interactions</title><p>To explore the potential applications of H3-OPT in studying antibody–antigen interactions, we analyzed contact patterns at predicted binding sites. Given that predicting the structure of an antibody–antigen complex remains challenging, we superimposed V<sub>H</sub> fragments from H3-OPT and AF2 onto experimentally determined native complex structures available in our test set. After identifying the contact residues of antigens by H3-OPT, we found that H3-OPT could substantially outperform AF2 (<xref ref-type="fig" rid="fig9">Figure 9a</xref>), with a median precision of 0.82 and accuracy of 0.98 compared to 0.71 precision and 0.97 accuracy of AF2. Next, we estimated the distances among interface residues, which are related to binding affinity at the interface. We found that H3-OPT had less error in distance metrics than predictions by AF2 across different distance thresholds, with average mean squared errors of 2.42 and 4.85 Å, respectively (<xref ref-type="fig" rid="fig9">Figure 9b</xref>). Furthermore, calculation of H3 contact propensities to assess potential differences in binding patterns between the predicted and native structures using high-quality H3 conformations indicated that H3-OPT also displayed higher accuracy in predicting contact propensities (<xref ref-type="fig" rid="fig9">Figure 9c</xref>).</p><fig-group><fig id="fig9" position="float"><label>Figure 9.</label><caption><title>Accuracy of H3-OPT predictions of antibody–antigen interactions.</title><p>(<bold>a</bold>) Performance of H3-OPT in binding site prediction. comparison of prediction accuracy between H3-OPT and AF2 for antibody–antigen binding sites (n = 27). Box represents interquartile range (IQR); horizontal line in the center of the box shows median. (<bold>b</bold>) Comparison of the mean squared errors of residue pairs between H3-OPT and AF2 under different distance thresholds. The x-axis represents the experimentally determined distance between pairs of contacting residues at the binding site in the native structure. Y-axis shows mean squared errors of H3-OPT and AF2. (<bold>c</bold>) Heatmaps of the frequency of pairwise residue–residue contacts across antibody–antigen interfaces. This analysis compares contact frequency of H3 loops predicted by AF2 or H3-OPT with the native structure. Darker shading indicates greater difference in contact frequency. (<bold>d</bold>) The predicted H3 loops of two targets interacting with antigens (PDB: 2YC1, 6O9H). The epitopes are highlighted in red and antibody chains are green. H3-OPT could identify the epitopes of different antigens that form the complementary binding interface(s) for the CDR-H3 of antibodies.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91512-fig9-v1.tif"/></fig><fig id="fig9s1" position="float" specific-use="child-fig"><label>Figure 9—figure supplement 1.</label><caption><title>RMSD<sub>backbone</sub> during production runs.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91512-fig9-figsupp1-v1.tif"/></fig></fig-group><p>Finally, to test whether H3-OPT was reliable for investigation of the detailed mechanisms underlying antigen–antibody binding, we generated contact maps and calculated binding affinities for complex structures obtained by H3-OPT, AF2, or through experiments (see ‘Methods’ for details). We found that contact maps predicted by H3-OPT were consistent with those observed in the experimental structures (<xref ref-type="fig" rid="fig9">Figure 9d</xref>). Since affinity prediction plays a crucial role in antibody therapeutics engineering, we performed MD simulations to compare the differences in binding affinities between AF2-predicted complexes and H3-OPT-predicted complexes (<xref ref-type="fig" rid="fig9s1">Figure 9—figure supplement 1</xref>). Calculation of binding affinities through MD simulations showed that the average affinities of structures obtained by H3-OPT prediction were closer to those of experimentally determined structures than values obtained through AF2 (<xref ref-type="table" rid="table6">Table 6</xref>). These cumulative findings illustrate the informative value of high-quality H3 loops for predicting binding affinity and facilitating antibody engineering, and further support the use of H3-OPT as a powerful and versatile tool for investigating antigen–antibody interactions.</p><table-wrap id="table6" position="float"><label>Table 6.</label><caption><title>Comparison of binding affinities obtained from molecular dynamics (MD) simulations using AF2 and H3-OPT.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top" rowspan="3">PDB ID</th><th align="left" valign="top" colspan="2">AF2 (kcal/mol)</th><th align="left" valign="top" rowspan="3">AF2 RMSD<sub>Cα</sub> (Å)</th><th align="left" valign="top" colspan="2">H3-OPT (kcal/mol)</th><th align="left" valign="top" rowspan="3">H3-OPT RMSD<sub>Cα</sub> (Å)</th><th align="left" valign="top" colspan="2">AF2 (kcal/mol)</th><th align="left" valign="top" colspan="2">H3-OPT (kcal/mol)</th><th align="left" valign="top"/></tr><tr><th align="left" valign="top" rowspan="2">MM/GBSA</th><th align="left" valign="top" rowspan="2">MM/PBSA</th><th align="left" valign="top" rowspan="2">MM/GBSA</th><th align="left" valign="top" rowspan="2">MM/PBSA</th><th align="left" valign="top" rowspan="2">|Δ<sub>MM/GBSA</sub><xref ref-type="table-fn" rid="table6fn1">*</xref>|</th><th align="left" valign="top" rowspan="2">|Δ<sub>MM/PBSA</sub>|</th><th align="left" valign="top" rowspan="2">|Δ<sub>MM/GBSA</sub>|</th><th align="left" valign="top" rowspan="2">|Δ<sub>MM/PBSA</sub>|</th><th align="left" valign="top"/></tr><tr><th align="left" valign="top"/></tr></thead><tbody><tr><td align="char" char="." valign="top">2ghw</td><td align="char" char="." valign="top">–29.20</td><td align="char" char="." valign="top">–33.36</td><td align="char" char="." valign="top">2.7</td><td align="char" char="." valign="top">–14.70</td><td align="char" char="." valign="top">–21.36</td><td align="char" char="." valign="top">3.0</td><td align="char" char="." valign="top">8.63</td><td align="char" char="." valign="top">2.42</td><td align="char" char="." valign="top">23.13</td><td align="char" char="." valign="top">14.42</td><td align="left" valign="top"/></tr><tr><td align="char" char="." valign="top">2yc1</td><td align="char" char="." valign="top">–38.85</td><td align="char" char="." valign="top">–37.73</td><td align="char" char="." valign="top">2.3</td><td align="char" char="." valign="top">–43.80</td><td align="char" char="." valign="top">–48.72</td><td align="char" char="." valign="top">1.5</td><td align="char" char="." valign="top">6.80</td><td align="char" char="." valign="top">18.67</td><td align="char" char="." valign="top">1.85</td><td align="char" char="." valign="top">7.68</td><td align="left" valign="top"/></tr><tr><td align="char" char="." valign="top">3l95</td><td align="char" char="." valign="top">–29.59</td><td align="char" char="." valign="top">–53.35</td><td align="char" char="." valign="top">2.5</td><td align="char" char="." valign="top">–47.22</td><td align="char" char="." valign="top">–68.86</td><td align="char" char="." valign="top">2.5</td><td align="char" char="." valign="top">23.60</td><td align="char" char="." valign="top">11.44</td><td align="char" char="." valign="top">5.97</td><td align="char" char="." valign="top">4.07</td><td align="left" valign="top"/></tr><tr><td align="char" char="." valign="top">3u30</td><td align="char" char="." valign="top">–37.31</td><td align="char" char="." valign="top">–42.41</td><td align="char" char="." valign="top">2.6</td><td align="char" char="." valign="top">–44.94</td><td align="char" char="." valign="top">–50.07</td><td align="char" char="." valign="top">2.5</td><td align="char" char="." valign="top">9.64</td><td align="char" char="." valign="top">2.18</td><td align="char" char="." valign="top">2.01</td><td align="char" char="." valign="top">5.48</td><td align="left" valign="top"/></tr><tr><td align="char" char="." valign="top">4cni</td><td align="char" char="." valign="top">–36.96</td><td align="char" char="." valign="top">–42.93</td><td align="char" char="." valign="top">1.0</td><td align="char" char="." valign="top">–31.92</td><td align="char" char="." valign="top">–40.39</td><td align="char" char="." valign="top">1.3</td><td align="char" char="." valign="top">8.54</td><td align="char" char="." valign="top">7.44</td><td align="char" char="." valign="top">3.50</td><td align="char" char="." valign="top">4.89</td><td align="left" valign="top"/></tr><tr><td align="char" char="." valign="top">4nbz</td><td align="char" char="." valign="top">–36.59</td><td align="char" char="." valign="top">–43.79</td><td align="char" char="." valign="top">1.9</td><td align="char" char="." valign="top">–59.61</td><td align="char" char="." valign="top">–54.23</td><td align="char" char="." valign="top">0.6</td><td align="char" char="." valign="top">10.17</td><td align="char" char="." valign="top">3.30</td><td align="char" char="." valign="top">12.85</td><td align="char" char="." valign="top">13.74</td><td align="left" valign="top"/></tr><tr><td align="char" char="." valign="top">4xnq</td><td align="char" char="." valign="top">–13.55</td><td align="char" char="." valign="top">–17.47</td><td align="char" char="." valign="top">2.7</td><td align="char" char="." valign="top">–31.51</td><td align="char" char="." valign="top">–30.94</td><td align="char" char="." valign="top">0.5</td><td align="char" char="." valign="top">15.40</td><td align="char" char="." valign="top">12.32</td><td align="char" char="." valign="top">2.57</td><td align="char" char="." valign="top">1.15</td><td align="left" valign="top"/></tr><tr><td align="char" char="." valign="top">4ydl</td><td align="char" char="." valign="top">–52.51</td><td align="char" char="." valign="top">–74.25</td><td align="char" char="." valign="top">4.8</td><td align="char" char="." valign="top">–49.17</td><td align="char" char="." valign="top">–73.57</td><td align="char" char="." valign="top">3.6</td><td align="char" char="." valign="top">6.82</td><td align="char" char="." valign="top">6.53</td><td align="char" char="." valign="top">10.15</td><td align="char" char="." valign="top">7.21</td><td align="left" valign="top"/></tr><tr><td align="char" char="." valign="top">5e5m</td><td align="char" char="." valign="top">–59.72</td><td align="char" char="." valign="top">–71.15</td><td align="char" char="." valign="top">3.0</td><td align="char" char="." valign="top">–41.29</td><td align="char" char="." valign="top">–53.70</td><td align="char" char="." valign="top">7.3</td><td align="char" char="." valign="top">0.50</td><td align="char" char="." valign="top">5.79</td><td align="char" char="." valign="top">18.93</td><td align="char" char="." valign="top">11.66</td><td align="left" valign="top"/></tr><tr><td align="char" char="." valign="top">5f7y</td><td align="char" char="." valign="top">–61.76</td><td align="char" char="." valign="top">–69.46</td><td align="char" char="." valign="top">2.7</td><td align="char" char="." valign="top">–60.33</td><td align="char" char="." valign="top">–69.43</td><td align="char" char="." valign="top">1.4</td><td align="char" char="." valign="top">3.95</td><td align="char" char="." valign="top">6.38</td><td align="char" char="." valign="top">5.38</td><td align="char" char="." valign="top">6.41</td><td align="left" valign="top"/></tr><tr><td align="char" char="." valign="top">6kyz</td><td align="char" char="." valign="top">–12.66</td><td align="char" char="." valign="top">–20.32</td><td align="char" char="." valign="top">4.0</td><td align="char" char="." valign="top">–9.36</td><td align="char" char="." valign="top">–17.13</td><td align="char" char="." valign="top">3.7</td><td align="char" char="." valign="top">17.63</td><td align="char" char="." valign="top">17.21</td><td align="char" char="." valign="top">20.93</td><td align="char" char="." valign="top">20.40</td><td align="left" valign="top"/></tr><tr><td align="char" char="." valign="top">6o9h</td><td align="char" char="." valign="top">–39.53</td><td align="char" char="." valign="top">–43.45</td><td align="char" char="." valign="top">2.8</td><td align="char" char="." valign="top">–52.27</td><td align="char" char="." valign="top">–57.51</td><td align="char" char="." valign="top">0.6</td><td align="char" char="." valign="top">10.45</td><td align="char" char="." valign="top">13.31</td><td align="char" char="." valign="top">2.29</td><td align="char" char="." valign="top">0.74</td><td align="left" valign="top"/></tr><tr><td align="char" char="." valign="top">6pyd</td><td align="char" char="." valign="top">–45.87</td><td align="char" char="." valign="top">–58.71</td><td align="char" char="." valign="top">1.0</td><td align="char" char="." valign="top">–35.75</td><td align="char" char="." valign="top">–45.28</td><td align="char" char="." valign="top">1.1</td><td align="char" char="." valign="top">6.29</td><td align="char" char="." valign="top">13.50</td><td align="char" char="." valign="top">3.83</td><td align="char" char="." valign="top">0.06</td><td align="left" valign="top"/></tr><tr><td align="char" char="." valign="top">6u9s</td><td align="char" char="." valign="top">–36.54</td><td align="char" char="." valign="top">–48.66</td><td align="char" char="." valign="top">1.0</td><td align="char" char="." valign="top">–39.79</td><td align="char" char="." valign="top">–44.80</td><td align="char" char="." valign="top">1.3</td><td align="char" char="." valign="top">14.35</td><td align="char" char="." valign="top">10.42</td><td align="char" char="." valign="top">11.11</td><td align="char" char="." valign="top">14.28</td><td align="left" valign="top"/></tr><tr><td align="left" valign="top">Average</td><td align="char" char="." valign="top">/</td><td align="char" char="." valign="top">/</td><td align="char" char="." valign="top">2.6</td><td align="char" char="." valign="top">/</td><td align="char" char="." valign="top">/</td><td align="char" char="." valign="top">2.4</td><td align="char" char="." valign="top">10.20</td><td align="char" char="." valign="top">9.35</td><td align="char" char="." valign="top">8.89</td><td align="char" char="." valign="top">8.01</td><td align="left" valign="top"/></tr></tbody></table><table-wrap-foot><fn id="table6fn1"><label>*</label><p>Δ<sub>MM/GBSA</sub> (or Δ<sub>MM/PBSA</sub>) was calculated by subtracting the MM/GBSA (or MM/PBSA) of predicted model from the MM/GBSA· (or MM/PBSA) of experimental structure.</p></fn></table-wrap-foot></table-wrap></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Several platforms for in silico antibody engineering have been developed to improve binding affinity (<xref ref-type="bibr" rid="bib48">Lippow et al., 2007</xref>; <xref ref-type="bibr" rid="bib56">Riahi et al., 2021</xref>; <xref ref-type="bibr" rid="bib18">Clark et al., 2006</xref>; <xref ref-type="bibr" rid="bib63">Shan et al., 2022</xref>), humanization (<xref ref-type="bibr" rid="bib15">Choi et al., 2015</xref>; <xref ref-type="bibr" rid="bib43">Kurella and Gali, 2014</xref>), and stability (<xref ref-type="bibr" rid="bib69">Tomar et al., 2018</xref>; <xref ref-type="bibr" rid="bib31">Froning et al., 2020</xref>). At present, engineering these biophysical properties of therapeutic antibodies heavily relies on the availability of the structures of thousands of antibodies. The accurate structure of CDR-H3 is crucial for understanding the mechanism(s) of antigen–antibody interactions. Although AF2 performs well when MSA and templates are available, its predictive capability decreases for targets with long CDR-H3 loops. By contrast, PLMs leverage tens of millions of protein sequences to learn relevant structural patterns, consequently enhancing their capacity to predict orphan antibodies (<xref ref-type="bibr" rid="bib17">Chowdhury et al., 2022</xref>). The results of IgFold indicate that PLMs, which incorporate transformer-based attention mechanisms, are capable of learning both local and global sequence information (<xref ref-type="bibr" rid="bib59">Ruffolo et al., 2023</xref>). While global information can be useful for challenging targets, it may lead to large errors when templates were available, as demonstrated by our case study of anti-VEGF nanobodies (<xref ref-type="fig" rid="fig7">Figure 7</xref>).</p><p>H3-OPT combines the strengths of AF2 and PLMs to predict the structures of mAbs and Nbs, and our results show that combining these features can improve the average RMSD<sub>Cα</sub> by 20% over that of AF2 or IgFold. However, H3-OPT is less efficient than PLM-based methods like IgFold because it relies on AF2 structures. To improve efficiency, one possible solution is to cluster the targets based on sequence identity and compute AF2 structures for each cluster, followed by generation of mutant structures. Despite the lower efficiency, H3-OPT offers several notable advantages over IgFold. First, H3-OPT incorporates a simplified version of Evoformer, which improves training efficiency. In addition, H3-OPT employs an alignment-based strategy to extract structural features that are then used to directly predict the Cα coordinates of H3 loops, effectively capturing the residue features relevant to loop folding. Moreover, we found that IgFold uses an augmented dataset containing AF2-predicted structures, which could potentially propagate errors during model training. In contrast, H3-OPT was trained by using high-quality and non-redundant antibody structures. Finally, H3-OPT also shows lower Cα-RMSDs compared to AF2 or tFold-Ab for the majority (six of seven) of targets in an expanded benchmark dataset, including all antibody structures from <ext-link ext-link-type="uri" xlink:href="https://www.cameo3d.org/">CAMEO 2022</ext-link> (<xref ref-type="bibr" rid="bib45">Leemann et al., 2023</xref> ; <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>).</p><p>Although H3-OPT can provide high accuracy with a small training dataset, it is likely that a larger dataset containing high-resolution structures will further improve our model. In the current study, we observed that the accuracy of AF2 CDR-H3 predictions was correlated with the length of the H3 loop. Thus, AF2 can provide accurate predictions for short loops with fewer than 10 amino acids, with PLM-based models offering little or no improvement in such cases. Conversely, antibodies with H3 loop lengths exceeding 25 residues (common in Sub3) pose a long-standing challenge for structural prediction algorithms, and none of the existing methods (including H3-OPT) tested here could provide accurate predictions due to a lack of homologous sequences and a high degree of freedom in this subgroup. Notably, H3-OPT outperformed AF2 in Sub3 because the context of protein sequences learned from ESM2 was fine-tuned to fit antibody structures. Furthermore, we envision that antibodies with H3 loop lengths ranging from 10 to 25 amino acids could be further optimized using PLMs with more model parameters. In addition, we attempted to optimize the H3 loop structure through MD simulations and QM-based methods. However, these approaches generally yielded less accurate predictions than AF2 due to inaccurately described solvent effects and other environmental factors. The development of a more accurate, physics-based method for modeling long loops may be another potentially effective strategy for improving H3-OPT.</p><p>Deep generative models are playing a vital role in the field of protein design, leading to several successful applications (<xref ref-type="bibr" rid="bib72">Watson et al., 2023</xref>; <xref ref-type="bibr" rid="bib22">Dauparas et al., 2022</xref>; <xref ref-type="bibr" rid="bib64">Shin et al., 2021</xref>; <xref ref-type="bibr" rid="bib49">Luo et al., 2022</xref>; <xref ref-type="bibr" rid="bib71">Watson et al., 2022</xref>; <xref ref-type="bibr" rid="bib37">Ingraham et al., 2019</xref>). These models capture the intricate relationship between sequences and structures, enabling the generation of novel protein scaffolds not existing in nature. However, the potential immunogenicity concerns associated with these newly designed proteins require comprehensive preclinical and clinical investigations. Consequently, conventional mAbs and Nbs remain the prevailing choices in medicine. Recognizing that the properties of antibodies are heavily influenced by their structures, accurate prediction of the structures of mAbs and Nbs is of great significance in optimizing their therapeutic effectiveness and clinical relevance. To this end, H3-OPT has strong potential to accelerate optimization of antibody–antigen binding as well as engineering of therapeutic antibodies with specialized biophysical properties.</p></sec><sec id="s4" sec-type="methods"><title>Methods</title><sec id="s4-1"><title>Datasets</title><p>High-quality structures are necessary for the accurate assessment of antibody modeling methods. All antibody information was obtained from the SAbDab website. We first downloaded antibody structures with X-ray diffraction resolution of 2.5 Å or less from the RCSB website (<ext-link ext-link-type="uri" xlink:href="https://www.rcsb.org/">https://www.rcsb.org/</ext-link>) and deleted redundant sequences with 95% or more identity. Then, we clustered the remaining sequences into 93 clusters using UCLUST (<xref ref-type="bibr" rid="bib26">Edgar, 2010</xref>) by 65% sequence similarity cutoff and selected centroid sequences to ensure the representativeness and sufficient quantity of the final datasets. We additionally omitted the PDB IDs 5DHV, 3SE9, 4YDJ, 5VF6, 6CT7, 7FAB, 6NMT, 5ILT, and 5UXQ, which were unable to predict using ABodyBuilder. The Fv sequence of each target was identified from initial sequences using the <xref ref-type="bibr" rid="bib16">Chothia and Lesk, 1987</xref> definitions. For the Nb dataset, we collected Nb sequences from a non-redundant dataset (<xref ref-type="bibr" rid="bib78">Zavrtanik and Hadži, 2019</xref>) and deleted all structures with low resolution (≥ 2.5 Å) to construct a high-resolution nanobody structure database. Seven native structures (PDB IDs 6NEX, 6FFJ, 4BUH, 6BHZ, 6UUM, 5O03, and 5C1M) were further excluded from the final dataset owing to the missing residues in CDR-H3 loops. In total, 125 targets were included in the final datasets: 47 mAbs (DB1) and 78 Nbs (DB2). After the model assessment, additional 98 antibodies and 42 nanobodies, which were collected from the test sets of DeepAb and NanoNet, were combined to verify the improvement of the CDR-H3 optimization methods (DB3).</p></sec><sec id="s4-2"><title>Sequence logos generation</title><p>Sequences of DB1, DB2 V<sub>H</sub> domains were determined by Chothia definitions and aligned using ANARCI (<xref ref-type="bibr" rid="bib25">Dunbar and Deane, 2016</xref>) with the Aho scheme (<xref ref-type="bibr" rid="bib36">Honegger and Plückthun, 2001</xref>). Then, we removed the alignment positions with 85% gaps to obtain a good visualization of alignment statistics. Finally, the alignment outputs of different datasets were submitted to the WebLogo3 server (<xref ref-type="bibr" rid="bib21">Crooks et al., 2004</xref>) to obtain sequence logos of each database. These sequence logos quantitatively showed the conservation of antibody sequences. The height of each letter within the logo corresponds to its base frequency at that particular position. The letters are arranged in descending order of size, with the tallest (or most frequent) letter positioned at the top.</p></sec><sec id="s4-3"><title>Benchmarking alternative methods</title><p>To evaluate the prediction accuracy of all alternative methods, we benchmarked five AI-based methods (AF2, RoseTTAFold, trRosetta, NanoNet, and DeepAb) and two TBM methods (MODELLER and ABodyBuilder). Identical templates were excluded from TBM templates database and AF2 PDB database. To model full-length V<sub>H</sub> and V<sub>L</sub> antibody, 50 glycines were added as a linker between two chains. The output multiple sequence alignment files of AF2 were then used to predict MODELLER models. ABodyBuilder models were generated using the webserver and modeled by Sphinx. For all methods, recommended parameters were used for all antibody predictions. NanoNet was removed from the DB1 as it was only applied for Nb modeling. We only compared and summarized the target structures that were successfully produced by all participants.</p></sec><sec id="s4-4"><title>Model assessment</title><p>The residue indexes of different models were aligned and renumbered using MAFFT (<xref ref-type="bibr" rid="bib42">Katoh et al., 2002</xref>) to obtain the same sequence length. We assessed the accuracy of AF2 through varying metrics, including TM-score, GDT-TS score, and GDT-HA score. The structural cutoffs for GDT-TS score were 1, 2, 4, and 8 Å, respectively, while that of the GDT-HA score were 0.5, 1, 2, and 4 Å, respectively. We calculated the average Z-scores of these methods to assess the overall similarities. The average Z-score of each target is given by<disp-formula id="equ1"><mml:math id="m1"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>D</mml:mi><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>D</mml:mi><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mi>H</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p>To better evaluate the accuracy of CDR loops, RMSDs were computed after superimposing the Fv or V<sub>H</sub> backbone heavy atoms to their reference structures. All RMSDs were computed using Schrödinger v. 2017-2 (Schrödinger, New York, NY).</p></sec><sec id="s4-5"><title>Refinement of the CDR-H3 loop of AF2 through QM methods</title><p>We extracted all H3 loop atoms from different AF2 models and re-rank these models based on QM energies. The nitrogen atoms and carbonyl atoms were initially removed from N-terminals and C-terminals, respectively. Next, we added hydrogens to these loops and produced the input files for different QM optimization methods using Schrödinger v. 2017-2. The geometry optimizations were carried out with the Gaussian16 (<xref ref-type="bibr" rid="bib66">Stewart, 2007</xref>) software. We first optimized the CDR-H3 loop by using PM6-D3 (<xref ref-type="bibr" rid="bib33">Grimme et al., 2010</xref>; <xref ref-type="bibr" rid="bib65">Stephens et al., 1994</xref>) and B3LYP/6-31G* (<xref ref-type="bibr" rid="bib16">Chothia and Lesk, 1987</xref>; <xref ref-type="bibr" rid="bib34">Hehre et al., 1972</xref>). The optimization method was divided into three steps: (1) optimizing hydrogens; (2) freezing the terminal C-alpha atoms and optimizing other atoms; and (3) frequency calculations to obtain Gibbs free energies. For an alternative CDR-H3 loop optimization method, we calculated the single-point energies with thermal corrections. The solvation effect can be estimated using the polarizable continuum model (with a dielectric constant <italic>ε</italic> = 78.36). After optimization, the proportion of each conformation was calculated based on the energies of five AF2 models according to Boltzmann distribution, which was used to generate a Boltzmann-averaged structure. The structures that failed in the optimization process were excluded from the final comparison.</p></sec><sec id="s4-6"><title>H3-OPT dataset</title><p>Crystal structures of antibodies were obtained from SAbDab, a non-redundant nanobody database (<xref ref-type="bibr" rid="bib78">Zavrtanik and Hadži, 2019</xref>) and a subset of DeepAb. The structures with resolution &gt;2.5 Å or redundant sequences with 95% or greater identity were removed (<xref ref-type="fig" rid="fig4">Figure 4a</xref>). We removed the structures with missing loops in CDR-H3 or lengths &gt;45. The structures with missing residues at CDR-H3 loops were also dropped. To enhance the generalizability of H3-OPT, the sequences were clustered based on a 90% similarity cutoff by using UCLUST (<xref ref-type="bibr" rid="bib26">Edgar, 2010</xref>). The resulting clusters were then randomly divided into training, validating, and testing sets to avoid overestimation of performance. The number of sequences in training, validating, and testing sets was 1021 (925 mAbs, 96 Nbs), 134 (122 mAbs, 12Nbs), and 131 (119 mAbs, 12 Nbs), respectively, with average CDR-H3 loop length of 11.8, 11.9, and 11.7, respectively. Schrödinger v. 2017-2 (Schrödinger), Numpy 1.18.5, and Pandas 1.0.5 were used for data preparation.</p></sec><sec id="s4-7"><title>Structure preparation</title><p>To address the transformational invariance for predicting 3D coordinates, we applied a structural alignment strategy. Prior to feature extraction, we removed all atoms of light chains in mAbs Fv structures and any non-standard residues in native structures. All antibody V<sub>H</sub> native structures were aligned using StructAlign module in Schrödinger with a randomly selected reference structure (PDB ID: 1GIG). Next, we superimposed AF2-predicted models to their corresponding native structures. This alignment allowed the model to learn the interactions between residues located in H3 loops while disregarding the rotation and translation of the entire structure. The heavy chain fragments were determined using Chothia definitions (<xref ref-type="bibr" rid="bib3">Ahdritz et al., 2022a</xref>).</p></sec><sec id="s4-8"><title>Feature generation</title><p>As shown in <xref ref-type="table" rid="table7">Table 7</xref>, structural features were extracted and aggregated into the following inputs to PSPM of H3-OPT: a residue feature vector of size [N<sub>res</sub>, 34] was constructed by concatenating ‘amino acid type’, ‘AF2-predicted coordinates’, ‘AF2-predicted backbone torsion angles’, ‘torsion angles mask’, and ‘predicted residue mask’. The pairwise feature vector of size [N<sub>res</sub>, N<sub>res</sub>, 60] included the ‘pairwise distances’ and ‘pairwise amino acid type’.</p><table-wrap id="table7" position="float"><label>Table 7.</label><caption><title>Features of the model.</title><p>N<sub>res</sub> is the number of residues (<xref ref-type="bibr" rid="bib39">Jumper et al., 2021</xref>).</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top">Feature and shape</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top">Amino acid type [N<sub>res</sub>, 21]</td><td align="left" valign="top">One-hot representation of the input amino acid sequence (including 20 amino acids and unknown).</td></tr><tr><td align="left" valign="top">3D coordinates [N<sub>res</sub>, 3]</td><td align="left" valign="top">Cα coordinates of all AlphaFold2-predicted residues</td></tr><tr><td align="left" valign="top">Backbone torsion angles [N<sub>res</sub>, 6]</td><td align="left" valign="top">Sine and cosine encoding of all predicted three backbone torsion angles.</td></tr><tr><td align="left" valign="top">Torsion angles mask [N<sub>res</sub>, 3]</td><td align="left" valign="top">A mask indicating if the angle was presented in the predicted structure.</td></tr><tr><td align="left" valign="top">H3 residue mask [N<sub>res</sub>, 1]</td><td align="left" valign="top">A mask indicating if the residue was located in H3 loop.</td></tr><tr><td align="left" valign="top">Pairwise distances [N<sub>res</sub>, N<sub>res</sub>, 39]</td><td align="left" valign="top">One hot representation of residue alpha carbon atoms distance. The pairwise distances ranging from 3.25 Å to 50.75 Å were put into 38 bins equally and the last bin contained any larger distances.</td></tr><tr><td align="left" valign="top">Pairwise amino acid type [N<sub>res</sub>, N<sub>res</sub>, 21]</td><td align="left" valign="top">One-hot representation of the input amino acid sequence.</td></tr></tbody></table></table-wrap></sec><sec id="s4-9"><title>Network architecture</title><p>H3-OPT took the predicted H3 loops of AF2 as input and generate the antibody structure with the optimized CDR-H3 loops as output. H3-OPT was composed of a template module and a PSPM. The template module contains two submodules, that is, CBM and TGM. The CBM calculated the average confidence score of H3 residues and retained AF2 structures with confidence score &gt;0.8. The TGM grafted the template loop structure onto the input AF2 model, when their CDR-H3 sequences were identical. We replaced the predicted CDR-H3 loop generated by AF2 with the template loop by aligning corresponding atoms, which included Cα atoms and carbonyl carbon atoms in the first two residues and Cα atoms and backbone nitrogen atoms in the last two residues.</p><p>The input residue-level features are extracted from AF2-predicted structures as mentioned above, resulting in a dimension of <italic>L</italic> × 34, where <italic>L</italic> is the padding length of antibody heavy chain. Similarly, the pairwise features has a dimension of <italic>L</italic> × <italic>L</italic> × 60. The PSPM network began with a row-wise gated multi-head self-attention layer that updated residue-level features from pair representations. Then, the residue-level information updated the pair representations via outer product mean module. Pair representations were updated by two multiplicative update modules. During training, the weights of the attention layer and the triangle multiplicative update modules were updated four times per epoch. Then, the final hidden states from ESM2 (esm2_t33_650M_UR50D) were passed to a linear layer and then concatenated with the residue-level features to enable the learning of latent information from vast protein sequences. To predict all Cα coordinates for the CDR-H3 loop, the output vector was passed through three linear layers with a hidden size of 64. In summary, PSPM utilized an attention-based mechanism to learn the contribution of individual residues and incorporate sequence representations from PLMs into final predictions. We used OpenFold (<xref ref-type="bibr" rid="bib8">Banks et al., 2005</xref>; based on GitHub from June 2022: commit <ext-link ext-link-type="uri" xlink:href="https://github.com/aqlaboratory/openfold">3f57b4a041f063406059f42080ede6d495479617</ext-link>; <xref ref-type="bibr" rid="bib4">Ahdritz et al., 2022b</xref>) to implement partial networks of AF2.</p><p>We employed a fine-tuning strategy to update the sequence representations in ESM2. Initially, we froze all weights of the 33 representation layers in ESM2 and updated only the weights of the attention layers and pair representation update modules. Subsequently, we fixed all weights of the remaining components in H3-OPT and performed fine-tuning exclusively on all hidden layers of ESM2 for the H3 loop prediction task. Finally, we fine-tuned all parameters of H3-OPT to predict the atomic coordinates of all CDR-H3 Cα atoms.</p><p>During training, we trained our model on the training set and validated it on the validation set. The dropout rates of H3-OPT were set to 0.25. Mean squared error (MSE) loss was utilized to train the model. We used Adam optimizer with a learning rate of 1 × 10<sup>−4</sup>, weight decay of 5 × 10<sup>−4</sup> for training. The model was trained on an NVIDIA V100 super GPU and took 1 hr per epoch over the entire training set with a batch size of 64. We randomly selected 10% of all structures for model validation. The H3-OPT was implemented using PyTorch 1.12.1 in Python 3.7.2. The hyperparameters used during training process for H3-OPT are presented in <xref ref-type="table" rid="table8">Table 8</xref>. The average Cα-RMSDs of our test set under different confidence cutoffs in CBM are presented in <xref ref-type="table" rid="table9">Table 9</xref>.</p><table-wrap id="table8" position="float"><label>Table 8.</label><caption><title>Hyperparameters for H3-OPT models.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top">Model</th><th align="left" valign="top">2</th><th align="left" valign="top">5</th><th align="left" valign="top">1</th><th align="left" valign="top">3</th><th align="left" valign="top">Best</th></tr></thead><tbody><tr><td align="left" valign="top"> Initial learning rate</td><td align="char" char="ndash" valign="top">1<sup>–4</sup></td><td align="char" char="ndash" valign="top">5<sup>–4</sup></td><td align="char" char="ndash" valign="top">1<sup>–3</sup></td><td align="char" char="ndash" valign="top">5<sup>–4</sup></td><td align="char" char="ndash" valign="top">1<sup>–4</sup></td></tr><tr><td align="left" valign="top"> Hidden layers</td><td align="char" char="." valign="top">64</td><td align="char" char="." valign="top">64</td><td align="char" char="." valign="top">64</td><td align="char" char="." valign="top">64</td><td align="char" char="." valign="top">64</td></tr><tr><td align="left" valign="top"> Iterations numbers of Evoformer-like layer</td><td align="char" char="." valign="top">6</td><td align="char" char="." valign="top">6</td><td align="char" char="." valign="top">4</td><td align="char" char="." valign="top">4</td><td align="char" char="." valign="top">4</td></tr><tr><td align="left" valign="top"> Average RMSD<sub>Cα</sub> (Å)</td><td align="char" char="." valign="top">2.42</td><td align="char" char="." valign="top">2.36</td><td align="char" char="." valign="top">2.35</td><td align="char" char="." valign="top">2.33</td><td align="char" char="." valign="top">2.24</td></tr></tbody></table><table-wrap-foot><fn><p>RMSD = root mean square deviation.</p></fn></table-wrap-foot></table-wrap><table-wrap id="table9" position="float"><label>Table 9.</label><caption><title>Average Cα-RMSDs of our test set under different confidence cutoffs.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Cutoff</th><th align="left" valign="bottom">Cα-RMSD (Å)</th></tr></thead><tbody><tr><td align="char" char="." valign="bottom">0.70</td><td align="char" char="." valign="bottom">2.46</td></tr><tr><td align="char" char="." valign="bottom">0.75</td><td align="char" char="." valign="bottom">2.30</td></tr><tr><td align="char" char="." valign="bottom">0.80</td><td align="char" char="." valign="bottom">2.24</td></tr><tr><td align="char" char="." valign="bottom">0.85</td><td align="char" char="." valign="bottom">2.17</td></tr><tr><td align="char" char="." valign="bottom">0.90</td><td align="char" char="." valign="bottom">2.29</td></tr><tr><td align="char" char="." valign="bottom">0.95</td><td align="char" char="." valign="bottom">2.28</td></tr></tbody></table><table-wrap-foot><fn><p>RMSD = root mean square deviation.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s4-10"><title>Structure generation and refinement</title><p>We utilized a structure refinement strategy to generate structures of CDR-H3 loops and rectify structural errors. Initially, we used PSPM predictions to modify the Cα coordinates of predicted CDR-H3 loops generated by AF2. Then, we minimized the remaining atoms of the CDR-H3 loops, while keeping their Cα coordinates fixed, by using the OPLS 2005 force field (<xref ref-type="bibr" rid="bib53">Mirdita et al., 2022</xref>). After the initial energy minimization step, we applied a force constant of 10 kcal/mol to these fixed atoms to guarantee complete relaxation of the entire loops.</p></sec><sec id="s4-11"><title>Validation settings</title><p>H3-OPT, AF2, HelixFold-Single, IgFold, and ESMFold were compared on the test subset. Given that tFold-Ab is only available on webserver, we compared H3-OPT with tFold-Ab on the <ext-link ext-link-type="uri" xlink:href="https://www.cameo3d.org/">CAMEO 2022 dataset</ext-link> (<xref ref-type="bibr" rid="bib45">Leemann et al., 2023</xref>). We removed the target antibody structures from the AF2 database before prediction to evaluate the performance of AF2. This ensured that the predictions depended solely on the information derived from other template structures, thus avoiding biased results. Since all other methods did not require MSA searching, we did not exclude these targets from their database. To predict the entire Fv structures, we included 50 glycine residues as a linker between the heavy chain and the light chain for antibodies (<xref ref-type="bibr" rid="bib46">Levy, 2010</xref>). The Cα-RMSDs of all predicted H3 loops were calculated after superimposing the V<sub>H</sub> backbone heavy atoms (without CDR-H3) to the reference structures. All structures were generated using publicly available code repositories: AF2 v2.1.1 (based on GitHub from the November 2021 version at GitHub: commit <ext-link ext-link-type="uri" xlink:href="https://github.com/google-deepmind/alphafold">91b43223422420d1783ed802c8b3a8382a9309fd</ext-link>; <xref ref-type="bibr" rid="bib82">Zidek et al., 2021</xref>), IgFold (based on GitHub from February 2023: commit <ext-link ext-link-type="uri" xlink:href="https://github.com/Graylab/IgFold">6a09298d165ed1deb438c0b6eefcbcb03ed0eca5</ext-link>; <xref ref-type="bibr" rid="bib32">Graylab, 2023</xref>), HelixFold-Single (based on GitHub from January 2023: commit <ext-link ext-link-type="uri" xlink:href="https://github.com/PaddlePaddle/PaddleHelix/tree/5f39b2c2a4ecc00b89ba05b95dc56212bdd5d886/apps/protein_folding/helixfold-single">5f39b2c2a4ecc00b89ba05b95dc56212bdd5d886</ext-link>; <xref ref-type="bibr" rid="bib75">Xiang and xiaoyao4573, 2023</xref>), and ESMFold v1 (based on GitHub from October 2022: commit <ext-link ext-link-type="uri" xlink:href="https://github.com/facebookresearch/esm">dc823b89c6acb9f67caea53704c2a97524fbd456</ext-link>; <xref ref-type="bibr" rid="bib62">Sercu, 2022</xref>).</p></sec><sec id="s4-12"><title>Analysis of SASAs and pairwise residue contacts</title><p>We computed the SASAs and rASAs of all CDR-H3 loops by using the ANARCI webserver (<xref ref-type="bibr" rid="bib25">Dunbar and Deane, 2016</xref>) with the default settings. Residue with an rASA &gt;25% was considered surface residues (<xref ref-type="bibr" rid="bib61">Schweke et al., 2022</xref>). Subsequently, we applied AHo alignment software (<xref ref-type="bibr" rid="bib36">Honegger and Plückthun, 2001</xref>) to report the averaged SASA per alignment position. The samples and alignment positions with more than 10 gaps were removed to avoid randomness and bias, reducing the final samples to 123. Finally, the difference in SASAs between H3-OPT and AF2 was calculated by subtracting predicted H3 loops SASAs from the ground truth.</p><p>To examine the contribution of H3-OPT in discovering antibody–antigen interactions, we identified contact residue pairs that were within this distance as binding sites by setting a threshold of 5 Å. We next calculated the pairwise residue distance matrices for each individual predicted complex and native structure, where each element represented the closest distance between the heavy atoms of two residues. From these pairwise distances, we derived contact propensity matrices that specifically indicated the presence or absence of interactions between residues.</p></sec><sec id="s4-13"><title>Analysis of surface electrostatic potential</title><p>We generated 2D projections of CDR-H3 loop’s surface electrostatic potential using SURFMAP v2.0.0 (<xref ref-type="bibr" rid="bib60">Salomon‐Ferrer et al., 2013</xref>; based on GitHub from February 2023: commit: <ext-link ext-link-type="uri" xlink:href="https://github.com/i2bc/SURFMAP">e0d51a10debc96775468912ccd8de01e239d1900</ext-link>; <xref ref-type="bibr" rid="bib14">Chevrollier et al., 2023</xref>) with default parameters. The 2D surface maps were calculated by subtracting the surface projection of H3-OPT or AF2-predicted 3 loops to their native structures.</p></sec><sec id="s4-14"><title>Binding affinity calculation</title><p>We analyzed the binding affinities of antibody–antigen complexes predicted by AF2 and H3-OPT. Their relative binding affinities were calculated through MD simulations. Initially, the missing side chains and loops in the antibody structures were filled using the Protein Preparation Wizard module within Schrödinger software. Subsequently, the tLEaP module of AMBER (<xref ref-type="bibr" rid="bib68">Tian et al., 2020</xref>) was employed to construct the simulation system with the ff19SB force field (<xref ref-type="bibr" rid="bib38">Izadi et al., 2014</xref>) and OPC solvent model (<xref ref-type="bibr" rid="bib11">Chayen and Saridakis, 2008</xref>). Additionally, the simulation system was solvated with a 0.15 M NaCl solution. Energy minimization was performed through a 5000-step steepest descent algorithm, followed by a 5000-step conjugate gradient algorithm. Then, a 400-ps NVT simulation with a time step of 2 fs was performed to gradually heat the system from 0 K to 298 K (0–100 K: 100 ps; 100–298 K: 200 ps; hold 298 K: 100 ps), and a 100-ps NPT simulation with a time step of 2 fs was performed to equilibrate the density of the system. During heating and density equilibration, we constrained the antigen–antibody structure with a restraint value of 10 kcal⋅mol<sup>–1</sup>⋅Å<sup>–2</sup>. In the production run, 100-ns MD simulations were performed with a time step of 2 fs. The first 50 ns restrains the non-hydrogen atoms of the antigen–antibody complex, and the last 50 ns restrains the non-hydrogen atoms of the antigen, with a constraint value of 10 kcal⋅mol<sup>–1</sup>⋅Å<sup>–2</sup>. The distance cutoff for nonbonded interactions was set to 10 Å, and the Berendsen algorithm was utilized to maintain isotropic pressure coupling at 1 bar. The Langevin algorithm was employed to maintain the simulation temperature at 298 K. The relative binding affinities of the antigen–antibody complexes were evaluated using the MMPBSA module of AMBER software, which computed the MM/GBSA energies for the trajectory frames of last 10 ns.</p></sec><sec id="s4-15"><title>Crystallization and data collection</title><p>The protein expression, purification, and crystallization experiments were described previously (<xref ref-type="bibr" rid="bib81">Zhu et al., 2023</xref>; <xref ref-type="bibr" rid="bib77">Yu et al., 2019</xref>). The proteins used in the crystallization experiments were unlabeled. Upon thawing the frozen protein on ice, we performed a centrifugation step to eliminate any potential crystal nucleus and precipitants. Subsequently, we mixed the protein at a 1:1 ratio with commercial crystal condition kits using the sitting-drop vapor diffusion method facilitated by the Protein Crystallization Screening System (TTP LabTech, mosquito). After several days of optimization, single crystals were successfully cultivated at 21°C and promptly flash-frozen in liquid nitrogen. The diffraction data from various crystals were collected at the Shanghai Synchrotron Research Facility and subsequently processed using the aquarium pipeline (<xref ref-type="bibr" rid="bib77">Yu et al., 2019</xref>).</p></sec><sec id="s4-16"><title>Statistics analysis</title><p>We conducted two-sided <italic>t</italic>-test analyses to assess the statistical significance of differences between the various groups. Statistical significance was considered when the p-values were &lt;0.05. These statistical analyses were carried out using Python 3.10 with the Scipy library (version 1.10.1).</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>Employee of Baidu International Technology (Shenzhen) Co., Ltd</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Supervision, Validation, Investigation, Visualization, Methodology, Writing - original draft, Project administration, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Software, Methodology</p></fn><fn fn-type="con" id="con3"><p>Data curation, Validation</p></fn><fn fn-type="con" id="con4"><p>Data curation, Validation</p></fn><fn fn-type="con" id="con5"><p>Data curation, Validation, Methodology</p></fn><fn fn-type="con" id="con6"><p>Software, Validation</p></fn><fn fn-type="con" id="con7"><p>Software, Validation</p></fn><fn fn-type="con" id="con8"><p>Conceptualization, Supervision, Funding acquisition, Project administration, Writing - review and editing</p></fn><fn fn-type="con" id="con9"><p>Conceptualization, Supervision, Funding acquisition, Methodology, Writing - original draft, Project administration, Writing - review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-91512-mdarchecklist1-v1.docx" mimetype="application" mime-subtype="docx"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>The datasets of our study and the codes of H3-OPT are freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/chdcg/H3-OPT">https://github.com/chdcg/H3-OPT</ext-link>, (copy archived at <xref ref-type="bibr" rid="bib12">chdcg, 2024</xref>).</p></sec><ack id="ack"><title>Acknowledgements</title><p>This work was supported by the Tsinghua University Initiative Scientific Research Program (no. 20231080030), Vanke Special Fund for Public Health and Health Discipline Development (2022Z82WKJ009), the Tsinghua-Peking University Center for Life Sciences (no. 20111770319), Tsinghua University – Peking Union Medical College and Hospital Collaboration Foundation (no. 20191080837).</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adolf-Bryfogle</surname><given-names>J</given-names></name><name><surname>Kalyuzhniy</surname><given-names>O</given-names></name><name><surname>Kubitz</surname><given-names>M</given-names></name><name><surname>Weitzner</surname><given-names>BD</given-names></name><name><surname>Hu</surname><given-names>X</given-names></name><name><surname>Adachi</surname><given-names>Y</given-names></name><name><surname>Schief</surname><given-names>WR</given-names></name><name><surname>Dunbrack</surname><given-names>RL</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>RosettaAntibodyDesign (RAbD): a general framework for computational antibody design</article-title><source>PLOS Computational Biology</source><volume>14</volume><elocation-id>e1006112</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006112</pub-id><pub-id pub-id-type="pmid">29702641</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aguilar Rangel</surname><given-names>M</given-names></name><name><surname>Bedwell</surname><given-names>A</given-names></name><name><surname>Costanzi</surname><given-names>E</given-names></name><name><surname>Taylor</surname><given-names>RJ</given-names></name><name><surname>Russo</surname><given-names>R</given-names></name><name><surname>Bernardes</surname><given-names>GJL</given-names></name><name><surname>Ricagno</surname><given-names>S</given-names></name><name><surname>Frydman</surname><given-names>J</given-names></name><name><surname>Vendruscolo</surname><given-names>M</given-names></name><name><surname>Sormanni</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Fragment-based computational design of antibodies targeting structured epitopes</article-title><source>Science Advances</source><volume>8</volume><elocation-id>eabp9540</elocation-id><pub-id pub-id-type="doi">10.1126/sciadv.abp9540</pub-id><pub-id pub-id-type="pmid">36367941</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Ahdritz</surname><given-names>G</given-names></name><name><surname>Bouatta</surname><given-names>N</given-names></name><name><surname>Floristean</surname><given-names>C</given-names></name><name><surname>Kadyan</surname><given-names>S</given-names></name><name><surname>Xia</surname><given-names>Q</given-names></name><name><surname>Gerecke</surname><given-names>W</given-names></name><name><surname>O’Donnell</surname><given-names>TJ</given-names></name><name><surname>Berenberg</surname><given-names>D</given-names></name><name><surname>Fisk</surname><given-names>I</given-names></name><name><surname>Zanichelli</surname><given-names>N</given-names></name><name><surname>Zhang</surname><given-names>B</given-names></name><name><surname>Nowaczynski</surname><given-names>A</given-names></name><name><surname>Wang</surname><given-names>B</given-names></name><name><surname>Stepniewska-Dziubinska</surname><given-names>MM</given-names></name><name><surname>Zhang</surname><given-names>S</given-names></name><name><surname>Ojewole</surname><given-names>A</given-names></name><name><surname>Guney</surname><given-names>ME</given-names></name><name><surname>Biderman</surname><given-names>S</given-names></name><name><surname>Watkins</surname><given-names>AM</given-names></name><name><surname>Ra</surname><given-names>S</given-names></name><name><surname>Lorenzo</surname><given-names>PR</given-names></name><name><surname>Nivon</surname><given-names>L</given-names></name><name><surname>Weitzner</surname><given-names>B</given-names></name><name><surname>Ban</surname><given-names>YEA</given-names></name><name><surname>Sorger</surname><given-names>PK</given-names></name><name><surname>Mostaque</surname><given-names>E</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Bonneau</surname><given-names>R</given-names></name><name><surname>AlQuraishi</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2022">2022a</year><article-title>OpenFold: retraining alphafold2 yields new insights into its learning mechanisms and capacity for generalization</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2022.11.20.517210</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Ahdritz</surname><given-names>G</given-names></name><name><surname>Yu</surname><given-names>D</given-names></name><name><surname>Wei</surname><given-names>J</given-names></name><name><surname>Kadyan</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2022">2022b</year><data-title>Openfold</data-title><version designator="3f57b4a">3f57b4a</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/aqlaboratory/openfold">https://github.com/aqlaboratory/openfold</ext-link></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Almagro</surname><given-names>JC</given-names></name><name><surname>Beavers</surname><given-names>MP</given-names></name><name><surname>Hernandez‐Guzman</surname><given-names>F</given-names></name><name><surname>Maier</surname><given-names>J</given-names></name><name><surname>Shaulsky</surname><given-names>J</given-names></name><name><surname>Butenhof</surname><given-names>K</given-names></name><name><surname>Labute</surname><given-names>P</given-names></name><name><surname>Thorsteinson</surname><given-names>N</given-names></name><name><surname>Kelly</surname><given-names>K</given-names></name><name><surname>Teplyakov</surname><given-names>A</given-names></name><name><surname>Luo</surname><given-names>J</given-names></name><name><surname>Sweet</surname><given-names>R</given-names></name><name><surname>Gilliland</surname><given-names>GL</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Antibody modeling assessment</article-title><source>Proteins</source><volume>79</volume><fpage>3050</fpage><lpage>3066</lpage><pub-id pub-id-type="doi">10.1002/prot.23130</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Almagro</surname><given-names>JC</given-names></name><name><surname>Teplyakov</surname><given-names>A</given-names></name><name><surname>Luo</surname><given-names>J</given-names></name><name><surname>Sweet</surname><given-names>RW</given-names></name><name><surname>Kodangattil</surname><given-names>S</given-names></name><name><surname>Hernandez-Guzman</surname><given-names>F</given-names></name><name><surname>Gilliland</surname><given-names>GL</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Second antibody modeling assessment (AMA-II)</article-title><source>Proteins</source><volume>82</volume><fpage>1553</fpage><lpage>1562</lpage><pub-id pub-id-type="doi">10.1002/prot.24567</pub-id><pub-id pub-id-type="pmid">24668560</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baek</surname><given-names>M</given-names></name><name><surname>DiMaio</surname><given-names>F</given-names></name><name><surname>Anishchenko</surname><given-names>I</given-names></name><name><surname>Dauparas</surname><given-names>J</given-names></name><name><surname>Ovchinnikov</surname><given-names>S</given-names></name><name><surname>Lee</surname><given-names>GR</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Cong</surname><given-names>Q</given-names></name><name><surname>Kinch</surname><given-names>LN</given-names></name><name><surname>Schaeffer</surname><given-names>RD</given-names></name><name><surname>Millán</surname><given-names>C</given-names></name><name><surname>Park</surname><given-names>H</given-names></name><name><surname>Adams</surname><given-names>C</given-names></name><name><surname>Glassman</surname><given-names>CR</given-names></name><name><surname>DeGiovanni</surname><given-names>A</given-names></name><name><surname>Pereira</surname><given-names>JH</given-names></name><name><surname>Rodrigues</surname><given-names>AV</given-names></name><name><surname>van Dijk</surname><given-names>AA</given-names></name><name><surname>Ebrecht</surname><given-names>AC</given-names></name><name><surname>Opperman</surname><given-names>DJ</given-names></name><name><surname>Sagmeister</surname><given-names>T</given-names></name><name><surname>Buhlheller</surname><given-names>C</given-names></name><name><surname>Pavkov-Keller</surname><given-names>T</given-names></name><name><surname>Rathinaswamy</surname><given-names>MK</given-names></name><name><surname>Dalwadi</surname><given-names>U</given-names></name><name><surname>Yip</surname><given-names>CK</given-names></name><name><surname>Burke</surname><given-names>JE</given-names></name><name><surname>Garcia</surname><given-names>KC</given-names></name><name><surname>Grishin</surname><given-names>NV</given-names></name><name><surname>Adams</surname><given-names>PD</given-names></name><name><surname>Read</surname><given-names>RJ</given-names></name><name><surname>Baker</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Accurate prediction of protein structures and interactions using a three-track neural network</article-title><source>Science</source><volume>373</volume><fpage>871</fpage><lpage>876</lpage><pub-id pub-id-type="doi">10.1126/science.abj8754</pub-id><pub-id pub-id-type="pmid">34282049</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Banks</surname><given-names>JL</given-names></name><name><surname>Beard</surname><given-names>HS</given-names></name><name><surname>Cao</surname><given-names>Y</given-names></name><name><surname>Cho</surname><given-names>AE</given-names></name><name><surname>Damm</surname><given-names>W</given-names></name><name><surname>Farid</surname><given-names>R</given-names></name><name><surname>Felts</surname><given-names>AK</given-names></name><name><surname>Halgren</surname><given-names>TA</given-names></name><name><surname>Mainz</surname><given-names>DT</given-names></name><name><surname>Maple</surname><given-names>JR</given-names></name><name><surname>Murphy</surname><given-names>R</given-names></name><name><surname>Philipp</surname><given-names>DM</given-names></name><name><surname>Repasky</surname><given-names>MP</given-names></name><name><surname>Zhang</surname><given-names>LY</given-names></name><name><surname>Berne</surname><given-names>BJ</given-names></name><name><surname>Friesner</surname><given-names>RA</given-names></name><name><surname>Gallicchio</surname><given-names>E</given-names></name><name><surname>Levy</surname><given-names>RM</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Integrated modeling program, applied chemical theory (IMPACT)</article-title><source>Journal of Computational Chemistry</source><volume>26</volume><fpage>1752</fpage><lpage>1780</lpage><pub-id pub-id-type="doi">10.1002/jcc.20292</pub-id><pub-id pub-id-type="pmid">16211539</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barozet</surname><given-names>A</given-names></name><name><surname>Chacón</surname><given-names>P</given-names></name><name><surname>Cortés</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Current approaches to flexible loop modeling</article-title><source>Current Research in Structural Biology</source><volume>3</volume><fpage>187</fpage><lpage>191</lpage><pub-id pub-id-type="doi">10.1016/j.crstbi.2021.07.002</pub-id><pub-id pub-id-type="pmid">34409304</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brahmer</surname><given-names>JR</given-names></name><name><surname>Tykodi</surname><given-names>SS</given-names></name><name><surname>Chow</surname><given-names>LQM</given-names></name><name><surname>Hwu</surname><given-names>WJ</given-names></name><name><surname>Topalian</surname><given-names>SL</given-names></name><name><surname>Hwu</surname><given-names>P</given-names></name><name><surname>Drake</surname><given-names>CG</given-names></name><name><surname>Camacho</surname><given-names>LH</given-names></name><name><surname>Kauh</surname><given-names>J</given-names></name><name><surname>Odunsi</surname><given-names>K</given-names></name><name><surname>Pitot</surname><given-names>HC</given-names></name><name><surname>Hamid</surname><given-names>O</given-names></name><name><surname>Bhatia</surname><given-names>S</given-names></name><name><surname>Martins</surname><given-names>R</given-names></name><name><surname>Eaton</surname><given-names>K</given-names></name><name><surname>Chen</surname><given-names>S</given-names></name><name><surname>Salay</surname><given-names>TM</given-names></name><name><surname>Alaparthy</surname><given-names>S</given-names></name><name><surname>Grosso</surname><given-names>JF</given-names></name><name><surname>Korman</surname><given-names>AJ</given-names></name><name><surname>Parker</surname><given-names>SM</given-names></name><name><surname>Agrawal</surname><given-names>S</given-names></name><name><surname>Goldberg</surname><given-names>SM</given-names></name><name><surname>Pardoll</surname><given-names>DM</given-names></name><name><surname>Gupta</surname><given-names>A</given-names></name><name><surname>Wigginton</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Safety and activity of anti–PD-L1 antibody in patients with advanced cancer</article-title><source>New England Journal of Medicine</source><volume>366</volume><fpage>2455</fpage><lpage>2465</lpage><pub-id pub-id-type="doi">10.1056/NEJMoa1200694</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chayen</surname><given-names>NE</given-names></name><name><surname>Saridakis</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Protein crystallization: from purified protein to diffraction-quality crystal</article-title><source>Nature Methods</source><volume>5</volume><fpage>147</fpage><lpage>153</lpage><pub-id pub-id-type="doi">10.1038/nmeth.f.203</pub-id><pub-id pub-id-type="pmid">18235435</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="software"><person-group person-group-type="author"><collab>chdcg</collab></person-group><year iso-8601-date="2024">2024</year><data-title>H3-opt</data-title><version designator="swh:1:rev:1cb9ec1046644e592232db913923a9a7e9761ba4">swh:1:rev:1cb9ec1046644e592232db913923a9a7e9761ba4</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:c129f69f2cf5b519f6880bae9df45c8dc7c9e40c;origin=https://github.com/chdcg/H3-OPT;visit=swh:1:snp:378dc373ee16a69ec82e34ae188e98a8f482d1dd;anchor=swh:1:rev:1cb9ec1046644e592232db913923a9a7e9761ba4">https://archive.softwareheritage.org/swh:1:dir:c129f69f2cf5b519f6880bae9df45c8dc7c9e40c;origin=https://github.com/chdcg/H3-OPT;visit=swh:1:snp:378dc373ee16a69ec82e34ae188e98a8f482d1dd;anchor=swh:1:rev:1cb9ec1046644e592232db913923a9a7e9761ba4</ext-link></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Gu</surname><given-names>Z</given-names></name><name><surname>Xu</surname><given-names>Y</given-names></name><name><surname>Deng</surname><given-names>M</given-names></name><name><surname>Lai</surname><given-names>L</given-names></name><name><surname>Pei</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>QuoteTarget: A sequence-based transformer protein language model to identify potentially druggable protein targets</article-title><source>Protein Science</source><volume>32</volume><elocation-id>e4555</elocation-id><pub-id pub-id-type="doi">10.1002/pro.4555</pub-id><pub-id pub-id-type="pmid">36564866</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Chevrollier</surname><given-names>N</given-names></name><name><surname>Schweke</surname><given-names>H</given-names></name><name><surname>Lopes</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>Surfmap</data-title><version designator="e0d51a1">e0d51a1</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/i2bc/SURFMAP">https://github.com/i2bc/SURFMAP</ext-link></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Choi</surname><given-names>Y</given-names></name><name><surname>Hua</surname><given-names>C</given-names></name><name><surname>Sentman</surname><given-names>CL</given-names></name><name><surname>Ackerman</surname><given-names>ME</given-names></name><name><surname>Bailey-Kellogg</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Antibody humanization by structure-based computational protein design</article-title><source>mAbs</source><volume>7</volume><fpage>1045</fpage><lpage>1057</lpage><pub-id pub-id-type="doi">10.1080/19420862.2015.1076600</pub-id><pub-id pub-id-type="pmid">26252731</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chothia</surname><given-names>C</given-names></name><name><surname>Lesk</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Canonical structures for the hypervariable regions of immunoglobulins</article-title><source>Journal of Molecular Biology</source><volume>196</volume><fpage>901</fpage><lpage>917</lpage><pub-id pub-id-type="doi">10.1016/0022-2836(87)90412-8</pub-id><pub-id pub-id-type="pmid">3681981</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chowdhury</surname><given-names>R</given-names></name><name><surname>Bouatta</surname><given-names>N</given-names></name><name><surname>Biswas</surname><given-names>S</given-names></name><name><surname>Floristean</surname><given-names>C</given-names></name><name><surname>Kharkar</surname><given-names>A</given-names></name><name><surname>Roy</surname><given-names>K</given-names></name><name><surname>Rochereau</surname><given-names>C</given-names></name><name><surname>Ahdritz</surname><given-names>G</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Church</surname><given-names>GM</given-names></name><name><surname>Sorger</surname><given-names>PK</given-names></name><name><surname>AlQuraishi</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Single-sequence protein structure prediction using a language model and deep learning</article-title><source>Nature Biotechnology</source><volume>40</volume><fpage>1617</fpage><lpage>1623</lpage><pub-id pub-id-type="doi">10.1038/s41587-022-01432-w</pub-id><pub-id pub-id-type="pmid">36192636</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clark</surname><given-names>LA</given-names></name><name><surname>Boriack-Sjodin</surname><given-names>PA</given-names></name><name><surname>Eldredge</surname><given-names>J</given-names></name><name><surname>Fitch</surname><given-names>C</given-names></name><name><surname>Friedman</surname><given-names>B</given-names></name><name><surname>Hanf</surname><given-names>KJM</given-names></name><name><surname>Jarpe</surname><given-names>M</given-names></name><name><surname>Liparoto</surname><given-names>SF</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Lugovskoy</surname><given-names>A</given-names></name><name><surname>Miller</surname><given-names>S</given-names></name><name><surname>Rushe</surname><given-names>M</given-names></name><name><surname>Sherman</surname><given-names>W</given-names></name><name><surname>Simon</surname><given-names>K</given-names></name><name><surname>Van Vlijmen</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Affinity enhancement of an in vivo matured therapeutic antibody using structure-based computational design</article-title><source>Protein Science</source><volume>15</volume><fpage>949</fpage><lpage>960</lpage><pub-id pub-id-type="doi">10.1110/ps.052030506</pub-id><pub-id pub-id-type="pmid">16597831</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cohen</surname><given-names>T</given-names></name><name><surname>Halfon</surname><given-names>M</given-names></name><name><surname>Schneidman-Duhovny</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>NanoNet: Rapid and accurate end-to-end nanobody modeling by deep learning</article-title><source>Frontiers in Immunology</source><volume>13</volume><elocation-id>958584</elocation-id><pub-id pub-id-type="doi">10.3389/fimmu.2022.958584</pub-id><pub-id pub-id-type="pmid">36032123</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cong</surname><given-names>Y</given-names></name><name><surname>Feng</surname><given-names>Y</given-names></name><name><surname>Ni</surname><given-names>H</given-names></name><name><surname>Zhi</surname><given-names>F</given-names></name><name><surname>Miao</surname><given-names>Y</given-names></name><name><surname>Fang</surname><given-names>B</given-names></name><name><surname>Zhang</surname><given-names>L</given-names></name><name><surname>Zhang</surname><given-names>JZH</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Anchor-locker binding mechanism of the coronavirus spike protein to human ACE2: insights from computational analysis</article-title><source>Journal of Chemical Information and Modeling</source><volume>61</volume><fpage>3529</fpage><lpage>3542</lpage><pub-id pub-id-type="doi">10.1021/acs.jcim.1c00241</pub-id><pub-id pub-id-type="pmid">34156227</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crooks</surname><given-names>GE</given-names></name><name><surname>Hon</surname><given-names>G</given-names></name><name><surname>Chandonia</surname><given-names>JM</given-names></name><name><surname>Brenner</surname><given-names>SE</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>WebLogo: a sequence logo generator</article-title><source>Genome Research</source><volume>14</volume><fpage>1188</fpage><lpage>1190</lpage><pub-id pub-id-type="doi">10.1101/gr.849004</pub-id><pub-id pub-id-type="pmid">15173120</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dauparas</surname><given-names>J</given-names></name><name><surname>Anishchenko</surname><given-names>I</given-names></name><name><surname>Bennett</surname><given-names>N</given-names></name><name><surname>Bai</surname><given-names>H</given-names></name><name><surname>Ragotte</surname><given-names>RJ</given-names></name><name><surname>Milles</surname><given-names>LF</given-names></name><name><surname>Wicky</surname><given-names>BIM</given-names></name><name><surname>Courbet</surname><given-names>A</given-names></name><name><surname>de Haas</surname><given-names>RJ</given-names></name><name><surname>Bethel</surname><given-names>N</given-names></name><name><surname>Leung</surname><given-names>PJY</given-names></name><name><surname>Huddy</surname><given-names>TF</given-names></name><name><surname>Pellock</surname><given-names>S</given-names></name><name><surname>Tischer</surname><given-names>D</given-names></name><name><surname>Chan</surname><given-names>F</given-names></name><name><surname>Koepnick</surname><given-names>B</given-names></name><name><surname>Nguyen</surname><given-names>H</given-names></name><name><surname>Kang</surname><given-names>A</given-names></name><name><surname>Sankaran</surname><given-names>B</given-names></name><name><surname>Bera</surname><given-names>AK</given-names></name><name><surname>King</surname><given-names>NP</given-names></name><name><surname>Baker</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Robust deep learning-based protein sequence design using ProteinMPNN</article-title><source>Science</source><volume>378</volume><fpage>49</fpage><lpage>56</lpage><pub-id pub-id-type="doi">10.1126/science.add2187</pub-id><pub-id pub-id-type="pmid">36108050</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Du</surname><given-names>Z</given-names></name><name><surname>Su</surname><given-names>H</given-names></name><name><surname>Wang</surname><given-names>W</given-names></name><name><surname>Ye</surname><given-names>L</given-names></name><name><surname>Wei</surname><given-names>H</given-names></name><name><surname>Peng</surname><given-names>Z</given-names></name><name><surname>Anishchenko</surname><given-names>I</given-names></name><name><surname>Baker</surname><given-names>D</given-names></name><name><surname>Yang</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>The trRosetta server for fast and accurate protein structure prediction</article-title><source>Nature Protocols</source><volume>16</volume><fpage>5634</fpage><lpage>5651</lpage><pub-id pub-id-type="doi">10.1038/s41596-021-00628-9</pub-id><pub-id pub-id-type="pmid">34759384</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dunbar</surname><given-names>J</given-names></name><name><surname>Krawczyk</surname><given-names>K</given-names></name><name><surname>Leem</surname><given-names>J</given-names></name><name><surname>Baker</surname><given-names>T</given-names></name><name><surname>Fuchs</surname><given-names>A</given-names></name><name><surname>Georges</surname><given-names>G</given-names></name><name><surname>Shi</surname><given-names>J</given-names></name><name><surname>Deane</surname><given-names>CM</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>SAbDab: the structural antibody database</article-title><source>Nucleic Acids Research</source><volume>42</volume><fpage>D1140</fpage><lpage>D1146</lpage><pub-id pub-id-type="doi">10.1093/nar/gkt1043</pub-id><pub-id pub-id-type="pmid">24214988</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dunbar</surname><given-names>J</given-names></name><name><surname>Deane</surname><given-names>CM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>ANARCI: antigen receptor numbering and receptor classification</article-title><source>Bioinformatics</source><volume>32</volume><fpage>298</fpage><lpage>300</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btv552</pub-id><pub-id pub-id-type="pmid">26424857</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Edgar</surname><given-names>RC</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Search and clustering orders of magnitude faster than BLAST</article-title><source>Bioinformatics</source><volume>26</volume><fpage>2460</fpage><lpage>2461</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btq461</pub-id><pub-id pub-id-type="pmid">20709691</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eswar</surname><given-names>N</given-names></name><name><surname>Webb</surname><given-names>B</given-names></name><name><surname>Marti-Renom</surname><given-names>MA</given-names></name><name><surname>Madhusudhan</surname><given-names>MS</given-names></name><name><surname>Eramian</surname><given-names>D</given-names></name><name><surname>Shen</surname><given-names>MY</given-names></name><name><surname>Pieper</surname><given-names>U</given-names></name><name><surname>Sali</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Comparative protein structure modeling using Modeller</article-title><source>Current Protocols in Bioinformatics</source><volume>Chapter 5</volume><fpage>5.6.1</fpage><lpage>5.6.30</lpage><pub-id pub-id-type="doi">10.1002/0471250953.bi0506s15</pub-id><pub-id pub-id-type="pmid">18428767</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Fang</surname><given-names>X</given-names></name><name><surname>Wang</surname><given-names>F</given-names></name><name><surname>Liu</surname><given-names>L</given-names></name><name><surname>He</surname><given-names>J</given-names></name><name><surname>Lin</surname><given-names>D</given-names></name><name><surname>Xiang</surname><given-names>Y</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Wu</surname><given-names>H</given-names></name><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Song</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>HelixFold-single: msa-free protein structure prediction by using protein language model as an alternative</article-title><source>arXiv</source><pub-id pub-id-type="doi">10.21203/rs.3.rs-1969991/v1</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feng</surname><given-names>JJ</given-names></name><name><surname>Chen</surname><given-names>JN</given-names></name><name><surname>Kang</surname><given-names>W</given-names></name><name><surname>Wu</surname><given-names>YD</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Accurate structure prediction for protein loops based on molecular dynamics simulations with RSFF2C</article-title><source>Journal of Chemical Theory and Computation</source><volume>17</volume><fpage>4614</fpage><lpage>4628</lpage><pub-id pub-id-type="doi">10.1021/acs.jctc.1c00341</pub-id><pub-id pub-id-type="pmid">34170125</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ferruz</surname><given-names>N</given-names></name><name><surname>Schmidt</surname><given-names>S</given-names></name><name><surname>Höcker</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>ProtGPT2 is a deep unsupervised language model for protein design</article-title><source>Nature Communications</source><volume>13</volume><elocation-id>4348</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-022-32007-7</pub-id><pub-id pub-id-type="pmid">35896542</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Froning</surname><given-names>K</given-names></name><name><surname>Maguire</surname><given-names>J</given-names></name><name><surname>Sereno</surname><given-names>A</given-names></name><name><surname>Huang</surname><given-names>F</given-names></name><name><surname>Chang</surname><given-names>S</given-names></name><name><surname>Weichert</surname><given-names>K</given-names></name><name><surname>Frommelt</surname><given-names>AJ</given-names></name><name><surname>Dong</surname><given-names>J</given-names></name><name><surname>Wu</surname><given-names>X</given-names></name><name><surname>Austin</surname><given-names>H</given-names></name><name><surname>Conner</surname><given-names>EM</given-names></name><name><surname>Fitchett</surname><given-names>JR</given-names></name><name><surname>Heng</surname><given-names>AR</given-names></name><name><surname>Balasubramaniam</surname><given-names>D</given-names></name><name><surname>Hilgers</surname><given-names>MT</given-names></name><name><surname>Kuhlman</surname><given-names>B</given-names></name><name><surname>Demarest</surname><given-names>SJ</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Computational stabilization of T cell receptors allows pairing with antibodies to form bispecifics</article-title><source>Nature Communications</source><volume>11</volume><elocation-id>2330</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-020-16231-7</pub-id><pub-id pub-id-type="pmid">32393818</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="software"><person-group person-group-type="author"><collab>Graylab</collab></person-group><year iso-8601-date="2023">2023</year><data-title>Igfold</data-title><version designator="6a09298">6a09298</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/Graylab/IgFold">https://github.com/Graylab/IgFold</ext-link></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grimme</surname><given-names>S</given-names></name><name><surname>Antony</surname><given-names>J</given-names></name><name><surname>Ehrlich</surname><given-names>S</given-names></name><name><surname>Krieg</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>A consistent and accurate ab initio parametrization of density functional dispersion correction (DFT-D) for the 94 elements H-Pu</article-title><source>The Journal of Chemical Physics</source><volume>132</volume><elocation-id>154104</elocation-id><pub-id pub-id-type="doi">10.1063/1.3382344</pub-id><pub-id pub-id-type="pmid">20423165</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hehre</surname><given-names>WJ</given-names></name><name><surname>Ditchfield</surname><given-names>R</given-names></name><name><surname>Pople</surname><given-names>JA</given-names></name></person-group><year iso-8601-date="1972">1972</year><article-title>Self—Consistent Molecular Orbital Methods. XII. Further Extensions of Gaussian—Type Basis Sets for Use in Molecular Orbital Studies of Organic Molecules</article-title><source>The Journal of Chemical Physics</source><volume>56</volume><fpage>2257</fpage><lpage>2261</lpage><pub-id pub-id-type="doi">10.1063/1.1677527</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hie</surname><given-names>BL</given-names></name><name><surname>Shanker</surname><given-names>VR</given-names></name><name><surname>Xu</surname><given-names>D</given-names></name><name><surname>Bruun</surname><given-names>TUJ</given-names></name><name><surname>Weidenbacher</surname><given-names>PA</given-names></name><name><surname>Tang</surname><given-names>S</given-names></name><name><surname>Wu</surname><given-names>W</given-names></name><name><surname>Pak</surname><given-names>JE</given-names></name><name><surname>Kim</surname><given-names>PS</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Efficient evolution of human antibodies from general protein language models</article-title><source>Nature Biotechnology</source><volume>42</volume><fpage>275</fpage><lpage>283</lpage><pub-id pub-id-type="doi">10.1038/s41587-023-01763-2</pub-id><pub-id pub-id-type="pmid">37095349</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Honegger</surname><given-names>A</given-names></name><name><surname>Plückthun</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Yet another numbering scheme for immunoglobulin variable domains: an automatic modeling and analysis tool</article-title><source>Journal of Molecular Biology</source><volume>309</volume><fpage>657</fpage><lpage>670</lpage><pub-id pub-id-type="doi">10.1006/jmbi.2001.4662</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Ingraham</surname><given-names>J</given-names></name><name><surname>Garg</surname><given-names>V</given-names></name><name><surname>Barzilay</surname><given-names>R</given-names></name><name><surname>Jaakkola</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Generative models for graph-based protein design</article-title><conf-name>Advances in Neural Information Processing Systems</conf-name></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Izadi</surname><given-names>S</given-names></name><name><surname>Anandakrishnan</surname><given-names>R</given-names></name><name><surname>Onufriev</surname><given-names>AV</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Building water models: a different approach</article-title><source>The Journal of Physical Chemistry Letters</source><volume>5</volume><fpage>3863</fpage><lpage>3871</lpage><pub-id pub-id-type="doi">10.1021/jz501780a</pub-id><pub-id pub-id-type="pmid">25400877</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jumper</surname><given-names>J</given-names></name><name><surname>Evans</surname><given-names>R</given-names></name><name><surname>Pritzel</surname><given-names>A</given-names></name><name><surname>Green</surname><given-names>T</given-names></name><name><surname>Figurnov</surname><given-names>M</given-names></name><name><surname>Ronneberger</surname><given-names>O</given-names></name><name><surname>Tunyasuvunakool</surname><given-names>K</given-names></name><name><surname>Bates</surname><given-names>R</given-names></name><name><surname>Žídek</surname><given-names>A</given-names></name><name><surname>Potapenko</surname><given-names>A</given-names></name><name><surname>Bridgland</surname><given-names>A</given-names></name><name><surname>Meyer</surname><given-names>C</given-names></name><name><surname>Kohl</surname><given-names>SAA</given-names></name><name><surname>Ballard</surname><given-names>AJ</given-names></name><name><surname>Cowie</surname><given-names>A</given-names></name><name><surname>Romera-Paredes</surname><given-names>B</given-names></name><name><surname>Nikolov</surname><given-names>S</given-names></name><name><surname>Jain</surname><given-names>R</given-names></name><name><surname>Adler</surname><given-names>J</given-names></name><name><surname>Back</surname><given-names>T</given-names></name><name><surname>Petersen</surname><given-names>S</given-names></name><name><surname>Reiman</surname><given-names>D</given-names></name><name><surname>Clancy</surname><given-names>E</given-names></name><name><surname>Zielinski</surname><given-names>M</given-names></name><name><surname>Steinegger</surname><given-names>M</given-names></name><name><surname>Pacholska</surname><given-names>M</given-names></name><name><surname>Berghammer</surname><given-names>T</given-names></name><name><surname>Bodenstein</surname><given-names>S</given-names></name><name><surname>Silver</surname><given-names>D</given-names></name><name><surname>Vinyals</surname><given-names>O</given-names></name><name><surname>Senior</surname><given-names>AW</given-names></name><name><surname>Kavukcuoglu</surname><given-names>K</given-names></name><name><surname>Kohli</surname><given-names>P</given-names></name><name><surname>Hassabis</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Highly accurate protein structure prediction with AlphaFold</article-title><source>Nature</source><volume>596</volume><fpage>583</fpage><lpage>589</lpage><pub-id pub-id-type="doi">10.1038/s41586-021-03819-2</pub-id><pub-id pub-id-type="pmid">34265844</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jumper</surname><given-names>J</given-names></name><name><surname>Hassabis</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Protein structure predictions to atomic accuracy with AlphaFold</article-title><source>Nature Methods</source><volume>19</volume><fpage>11</fpage><lpage>12</lpage><pub-id pub-id-type="doi">10.1038/s41592-021-01362-6</pub-id><pub-id pub-id-type="pmid">35017726</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kaplon</surname><given-names>H</given-names></name><name><surname>Reichert</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Antibodies to watch in 2021</article-title><source>mAbs</source><volume>13</volume><elocation-id>1860476</elocation-id><pub-id pub-id-type="doi">10.1080/19420862.2020.1860476</pub-id><pub-id pub-id-type="pmid">33459118</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Katoh</surname><given-names>K</given-names></name><name><surname>Misawa</surname><given-names>K</given-names></name><name><surname>Kuma</surname><given-names>K</given-names></name><name><surname>Miyata</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>MAFFT: a novel method for rapid multiple sequence alignment based on fast Fourier transform</article-title><source>Nucleic Acids Research</source><volume>30</volume><fpage>3059</fpage><lpage>3066</lpage><pub-id pub-id-type="doi">10.1093/nar/gkf436</pub-id><pub-id pub-id-type="pmid">12136088</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kurella</surname><given-names>VB</given-names></name><name><surname>Gali</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Structure guided homology model based design and engineering of mouse antibodies for humanization</article-title><source>Bioinformation</source><volume>10</volume><fpage>180</fpage><lpage>186</lpage><pub-id pub-id-type="doi">10.6026/97320630010180</pub-id><pub-id pub-id-type="pmid">24966517</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leem</surname><given-names>J</given-names></name><name><surname>Dunbar</surname><given-names>J</given-names></name><name><surname>Georges</surname><given-names>G</given-names></name><name><surname>Shi</surname><given-names>J</given-names></name><name><surname>Deane</surname><given-names>CM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>ABodyBuilder: automated antibody structure prediction with data-driven accuracy estimation</article-title><source>mAbs</source><volume>8</volume><fpage>1259</fpage><lpage>1268</lpage><pub-id pub-id-type="doi">10.1080/19420862.2016.1205773</pub-id><pub-id pub-id-type="pmid">27392298</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leemann</surname><given-names>M</given-names></name><name><surname>Sagasta</surname><given-names>A</given-names></name><name><surname>Eberhardt</surname><given-names>J</given-names></name><name><surname>Schwede</surname><given-names>T</given-names></name><name><surname>Robin</surname><given-names>X</given-names></name><name><surname>Durairaj</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Automated benchmarking of combined protein structure and ligand conformation prediction</article-title><source>Proteins</source><volume>91</volume><fpage>1912</fpage><lpage>1924</lpage><pub-id pub-id-type="doi">10.1002/prot.26605</pub-id><pub-id pub-id-type="pmid">37885318</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levy</surname><given-names>ED</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>A simple definition of structural regions in proteins and its use in analyzing interface evolution</article-title><source>Journal of Molecular Biology</source><volume>403</volume><fpage>660</fpage><lpage>670</lpage><pub-id pub-id-type="doi">10.1016/j.jmb.2010.09.028</pub-id><pub-id pub-id-type="pmid">20868694</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>Z</given-names></name><name><surname>Akin</surname><given-names>H</given-names></name><name><surname>Rao</surname><given-names>R</given-names></name><name><surname>Hie</surname><given-names>B</given-names></name><name><surname>Zhu</surname><given-names>Z</given-names></name><name><surname>Lu</surname><given-names>W</given-names></name><name><surname>Smetanin</surname><given-names>N</given-names></name><name><surname>Verkuil</surname><given-names>R</given-names></name><name><surname>Kabeli</surname><given-names>O</given-names></name><name><surname>Shmueli</surname><given-names>Y</given-names></name><name><surname>dos Santos Costa</surname><given-names>A</given-names></name><name><surname>Fazel-Zarandi</surname><given-names>M</given-names></name><name><surname>Sercu</surname><given-names>T</given-names></name><name><surname>Candido</surname><given-names>S</given-names></name><name><surname>Rives</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Evolutionary-scale prediction of atomic-level protein structure with a language model</article-title><source>Science</source><volume>379</volume><fpage>1123</fpage><lpage>1130</lpage><pub-id pub-id-type="doi">10.1126/science.ade2574</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lippow</surname><given-names>SM</given-names></name><name><surname>Wittrup</surname><given-names>KD</given-names></name><name><surname>Tidor</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Computational design of antibody-affinity improvement beyond in vivo maturation</article-title><source>Nature Biotechnology</source><volume>25</volume><fpage>1171</fpage><lpage>1176</lpage><pub-id pub-id-type="doi">10.1038/nbt1336</pub-id><pub-id pub-id-type="pmid">17891135</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Luo</surname><given-names>S</given-names></name><name><surname>Su</surname><given-names>Y</given-names></name><name><surname>Peng</surname><given-names>X</given-names></name><name><surname>Wang</surname><given-names>S</given-names></name><name><surname>Peng</surname><given-names>J</given-names></name><name><surname>Ma</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Antigen-Specific Antibody Design and Optimization with Diffusion-Based Generative Models for Protein Structures</article-title><conf-name>Advances in Neural Information Processing Systems</conf-name><fpage>9754</fpage><lpage>9767</lpage><pub-id pub-id-type="doi">10.1101/2022.07.10.499510</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Madani</surname><given-names>A</given-names></name><name><surname>Krause</surname><given-names>B</given-names></name><name><surname>Greene</surname><given-names>ER</given-names></name><name><surname>Subramanian</surname><given-names>S</given-names></name><name><surname>Mohr</surname><given-names>BP</given-names></name><name><surname>Holton</surname><given-names>JM</given-names></name><name><surname>Olmos</surname><given-names>JL</given-names></name><name><surname>Xiong</surname><given-names>C</given-names></name><name><surname>Sun</surname><given-names>ZZ</given-names></name><name><surname>Socher</surname><given-names>R</given-names></name><name><surname>Fraser</surname><given-names>JS</given-names></name><name><surname>Naik</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Large language models generate functional protein sequences across diverse families</article-title><source>Nature Biotechnology</source><volume>41</volume><fpage>1099</fpage><lpage>1106</lpage><pub-id pub-id-type="doi">10.1038/s41587-022-01618-2</pub-id><pub-id pub-id-type="pmid">36702895</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marcatili</surname><given-names>P</given-names></name><name><surname>Rosi</surname><given-names>A</given-names></name><name><surname>Tramontano</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>PIGS: automatic prediction of antibody structures</article-title><source>Bioinformatics</source><volume>24</volume><fpage>1953</fpage><lpage>1954</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btn341</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meganck</surname><given-names>RM</given-names></name><name><surname>Baric</surname><given-names>RS</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Developing therapeutic approaches for twenty-first-century emerging infectious viral diseases</article-title><source>Nature Medicine</source><volume>27</volume><fpage>401</fpage><lpage>410</lpage><pub-id pub-id-type="doi">10.1038/s41591-021-01282-0</pub-id><pub-id pub-id-type="pmid">33723456</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mirdita</surname><given-names>M</given-names></name><name><surname>Schütze</surname><given-names>K</given-names></name><name><surname>Moriwaki</surname><given-names>Y</given-names></name><name><surname>Heo</surname><given-names>L</given-names></name><name><surname>Ovchinnikov</surname><given-names>S</given-names></name><name><surname>Steinegger</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>ColabFold: making protein folding accessible to all</article-title><source>Nature Methods</source><volume>19</volume><fpage>679</fpage><lpage>682</lpage><pub-id pub-id-type="doi">10.1038/s41592-022-01488-1</pub-id><pub-id pub-id-type="pmid">35637307</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pan</surname><given-names>L</given-names></name><name><surname>Aller</surname><given-names>SG</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Allosteric role of substrate occupancy toward the alignment of P-glycoprotein nucleotide binding domains</article-title><source>Scientific Reports</source><volume>8</volume><elocation-id>14643</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-018-32815-2</pub-id><pub-id pub-id-type="pmid">30279588</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raybould</surname><given-names>MIJ</given-names></name><name><surname>Marks</surname><given-names>C</given-names></name><name><surname>Lewis</surname><given-names>AP</given-names></name><name><surname>Shi</surname><given-names>J</given-names></name><name><surname>Bujotzek</surname><given-names>A</given-names></name><name><surname>Taddese</surname><given-names>B</given-names></name><name><surname>Deane</surname><given-names>CM</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Thera-SAbDab: the therapeutic structural antibody database</article-title><source>Nucleic Acids Research</source><volume>48</volume><fpage>D383</fpage><lpage>D388</lpage><pub-id pub-id-type="doi">10.1093/nar/gkz827</pub-id><pub-id pub-id-type="pmid">31555805</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Riahi</surname><given-names>S</given-names></name><name><surname>Lee</surname><given-names>JH</given-names></name><name><surname>Wei</surname><given-names>S</given-names></name><name><surname>Cost</surname><given-names>R</given-names></name><name><surname>Masiero</surname><given-names>A</given-names></name><name><surname>Prades</surname><given-names>C</given-names></name><name><surname>Olfati-Saber</surname><given-names>R</given-names></name><name><surname>Wendt</surname><given-names>M</given-names></name><name><surname>Park</surname><given-names>A</given-names></name><name><surname>Qiu</surname><given-names>Y</given-names></name><name><surname>Zhou</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Application of an integrated computational antibody engineering platform to design SARS-CoV-2 neutralizers</article-title><source>Antibody Therapeutics</source><volume>4</volume><fpage>109</fpage><lpage>122</lpage><pub-id pub-id-type="doi">10.1093/abt/tbab011</pub-id><pub-id pub-id-type="pmid">34396040</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rives</surname><given-names>A</given-names></name><name><surname>Meier</surname><given-names>J</given-names></name><name><surname>Sercu</surname><given-names>T</given-names></name><name><surname>Goyal</surname><given-names>S</given-names></name><name><surname>Lin</surname><given-names>Z</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Guo</surname><given-names>D</given-names></name><name><surname>Ott</surname><given-names>M</given-names></name><name><surname>Zitnick</surname><given-names>CL</given-names></name><name><surname>Ma</surname><given-names>J</given-names></name><name><surname>Fergus</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Biological structure and function emerge from scaling unsupervised learning to 250 million protein sequences</article-title><source>PNAS</source><volume>118</volume><elocation-id>e2016239118</elocation-id><pub-id pub-id-type="doi">10.1073/pnas.2016239118</pub-id><pub-id pub-id-type="pmid">33876751</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ruffolo</surname><given-names>JA</given-names></name><name><surname>Sulam</surname><given-names>J</given-names></name><name><surname>Gray</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Antibody structure prediction using interpretable deep learning</article-title><source>Patterns</source><volume>3</volume><elocation-id>100406</elocation-id><pub-id pub-id-type="doi">10.1016/j.patter.2021.100406</pub-id><pub-id pub-id-type="pmid">35199061</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ruffolo</surname><given-names>JA</given-names></name><name><surname>Chu</surname><given-names>LS</given-names></name><name><surname>Mahajan</surname><given-names>SP</given-names></name><name><surname>Gray</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Fast, accurate antibody structure prediction from deep learning on massive set of natural antibodies</article-title><source>Nature Communications</source><volume>14</volume><elocation-id>2389</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-023-38063-x</pub-id><pub-id pub-id-type="pmid">37185622</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Salomon‐Ferrer</surname><given-names>R</given-names></name><name><surname>Case</surname><given-names>DA</given-names></name><name><surname>Walker</surname><given-names>RC</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>An overview of the Amber biomolecular simulation package</article-title><source>WIREs Computational Molecular Science</source><volume>3</volume><fpage>198</fpage><lpage>210</lpage><pub-id pub-id-type="doi">10.1002/wcms.1121</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schweke</surname><given-names>H</given-names></name><name><surname>Mucchielli</surname><given-names>MH</given-names></name><name><surname>Chevrollier</surname><given-names>N</given-names></name><name><surname>Gosset</surname><given-names>S</given-names></name><name><surname>Lopes</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>SURFMAP: a software for mapping in two dimensions protein surface features</article-title><source>Journal of Chemical Information and Modeling</source><volume>62</volume><fpage>1595</fpage><lpage>1601</lpage><pub-id pub-id-type="doi">10.1021/acs.jcim.1c01269</pub-id><pub-id pub-id-type="pmid">35349266</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Sercu</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>Esm</data-title><version designator="dc823b8">dc823b8</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/facebookresearch/esm">https://github.com/facebookresearch/esm</ext-link></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shan</surname><given-names>S</given-names></name><name><surname>Luo</surname><given-names>S</given-names></name><name><surname>Yang</surname><given-names>Z</given-names></name><name><surname>Hong</surname><given-names>J</given-names></name><name><surname>Su</surname><given-names>Y</given-names></name><name><surname>Ding</surname><given-names>F</given-names></name><name><surname>Fu</surname><given-names>L</given-names></name><name><surname>Li</surname><given-names>C</given-names></name><name><surname>Chen</surname><given-names>P</given-names></name><name><surname>Ma</surname><given-names>J</given-names></name><name><surname>Shi</surname><given-names>X</given-names></name><name><surname>Zhang</surname><given-names>Q</given-names></name><name><surname>Berger</surname><given-names>B</given-names></name><name><surname>Zhang</surname><given-names>L</given-names></name><name><surname>Peng</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Deep learning guided optimization of human antibody against SARS-CoV-2 variants with broad neutralization</article-title><source>PNAS</source><volume>119</volume><elocation-id>e2122954119</elocation-id><pub-id pub-id-type="doi">10.1073/pnas.2122954119</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shin</surname><given-names>JE</given-names></name><name><surname>Riesselman</surname><given-names>AJ</given-names></name><name><surname>Kollasch</surname><given-names>AW</given-names></name><name><surname>McMahon</surname><given-names>C</given-names></name><name><surname>Simon</surname><given-names>E</given-names></name><name><surname>Sander</surname><given-names>C</given-names></name><name><surname>Manglik</surname><given-names>A</given-names></name><name><surname>Kruse</surname><given-names>AC</given-names></name><name><surname>Marks</surname><given-names>DS</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Protein design and variant prediction using autoregressive generative models</article-title><source>Nature Communications</source><volume>12</volume><elocation-id>2403</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-021-22732-w</pub-id><pub-id pub-id-type="pmid">33893299</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stephens</surname><given-names>PJ</given-names></name><name><surname>Devlin</surname><given-names>FJ</given-names></name><name><surname>Chabalowski</surname><given-names>CF</given-names></name><name><surname>Frisch</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Ab initio calculation of vibrational absorption and circular dichroism spectra using density functional force fields</article-title><source>The Journal of Physical Chemistry</source><volume>98</volume><fpage>11623</fpage><lpage>11627</lpage><pub-id pub-id-type="doi">10.1021/j100096a001</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stewart</surname><given-names>JJP</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Optimization of parameters for semiempirical methods V: modification of NDDO approximations and application to 70 elements</article-title><source>Journal of Molecular Modeling</source><volume>13</volume><fpage>1173</fpage><lpage>1213</lpage><pub-id pub-id-type="doi">10.1007/s00894-007-0233-4</pub-id><pub-id pub-id-type="pmid">17828561</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Teplyakov</surname><given-names>A</given-names></name><name><surname>Luo</surname><given-names>J</given-names></name><name><surname>Obmolova</surname><given-names>G</given-names></name><name><surname>Malia</surname><given-names>TJ</given-names></name><name><surname>Sweet</surname><given-names>R</given-names></name><name><surname>Stanfield</surname><given-names>RL</given-names></name><name><surname>Kodangattil</surname><given-names>S</given-names></name><name><surname>Almagro</surname><given-names>JC</given-names></name><name><surname>Gilliland</surname><given-names>GL</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Antibody modeling assessment II. Structures and models</article-title><source>Proteins</source><volume>82</volume><fpage>1563</fpage><lpage>1582</lpage><pub-id pub-id-type="doi">10.1002/prot.24554</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tian</surname><given-names>C</given-names></name><name><surname>Kasavajhala</surname><given-names>K</given-names></name><name><surname>Belfon</surname><given-names>KAA</given-names></name><name><surname>Raguette</surname><given-names>L</given-names></name><name><surname>Huang</surname><given-names>H</given-names></name><name><surname>Migues</surname><given-names>AN</given-names></name><name><surname>Bickel</surname><given-names>J</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Pincay</surname><given-names>J</given-names></name><name><surname>Wu</surname><given-names>Q</given-names></name><name><surname>Simmerling</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>ff19SB: Amino-acid-specific protein backbone parameters trained against quantum mechanics energy surfaces in solution</article-title><source>Journal of Chemical Theory and Computation</source><volume>16</volume><fpage>528</fpage><lpage>552</lpage><pub-id pub-id-type="doi">10.1021/acs.jctc.9b00591</pub-id><pub-id pub-id-type="pmid">31714766</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tomar</surname><given-names>DS</given-names></name><name><surname>Singh</surname><given-names>SK</given-names></name><name><surname>Li</surname><given-names>L</given-names></name><name><surname>Broulidakis</surname><given-names>MP</given-names></name><name><surname>Kumar</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>In silico prediction of diffusion interaction parameter (k<sub>D</sub>), a key indicator of antibody solution behaviors</article-title><source>Pharmaceutical Research</source><volume>35</volume><elocation-id>193</elocation-id><pub-id pub-id-type="doi">10.1007/s11095-018-2466-6</pub-id><pub-id pub-id-type="pmid">30128780</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Valdés-Tresanco</surname><given-names>MS</given-names></name><name><surname>Valdés-Tresanco</surname><given-names>ME</given-names></name><name><surname>Jiménez-Gutiérrez</surname><given-names>DE</given-names></name><name><surname>Moreno</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Structural modeling of nanobodies: a benchmark of state-of-the-art artificial intelligence programs</article-title><source>Molecules</source><volume>28</volume><elocation-id>3991</elocation-id><pub-id pub-id-type="doi">10.3390/molecules28103991</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Watson</surname><given-names>JL</given-names></name><name><surname>Juergens</surname><given-names>D</given-names></name><name><surname>Bennett</surname><given-names>NR</given-names></name><name><surname>Trippe</surname><given-names>BL</given-names></name><name><surname>Yim</surname><given-names>J</given-names></name><name><surname>Eisenach</surname><given-names>HE</given-names></name><name><surname>Ahern</surname><given-names>W</given-names></name><name><surname>Borst</surname><given-names>AJ</given-names></name><name><surname>Ragotte</surname><given-names>RJ</given-names></name><name><surname>Milles</surname><given-names>LF</given-names></name><name><surname>Wicky</surname><given-names>BIM</given-names></name><name><surname>Hanikel</surname><given-names>N</given-names></name><name><surname>Pellock</surname><given-names>SJ</given-names></name><name><surname>Courbet</surname><given-names>A</given-names></name><name><surname>Sheffler</surname><given-names>W</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Venkatesh</surname><given-names>P</given-names></name><name><surname>Sappington</surname><given-names>I</given-names></name><name><surname>Torres</surname><given-names>SV</given-names></name><name><surname>Lauko</surname><given-names>A</given-names></name><name><surname>De Bortoli</surname><given-names>V</given-names></name><name><surname>Mathieu</surname><given-names>E</given-names></name><name><surname>Barzilay</surname><given-names>R</given-names></name><name><surname>Jaakkola</surname><given-names>TS</given-names></name><name><surname>DiMaio</surname><given-names>F</given-names></name><name><surname>Baek</surname><given-names>M</given-names></name><name><surname>Baker</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Broadly applicable and accurate protein design by integrating structure prediction networks and diffusion generative models</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2022.12.09.519842</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Watson</surname><given-names>JL</given-names></name><name><surname>Juergens</surname><given-names>D</given-names></name><name><surname>Bennett</surname><given-names>NR</given-names></name><name><surname>Trippe</surname><given-names>BL</given-names></name><name><surname>Yim</surname><given-names>J</given-names></name><name><surname>Eisenach</surname><given-names>HE</given-names></name><name><surname>Ahern</surname><given-names>W</given-names></name><name><surname>Borst</surname><given-names>AJ</given-names></name><name><surname>Ragotte</surname><given-names>RJ</given-names></name><name><surname>Milles</surname><given-names>LF</given-names></name><name><surname>Wicky</surname><given-names>BIM</given-names></name><name><surname>Hanikel</surname><given-names>N</given-names></name><name><surname>Pellock</surname><given-names>SJ</given-names></name><name><surname>Courbet</surname><given-names>A</given-names></name><name><surname>Sheffler</surname><given-names>W</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Venkatesh</surname><given-names>P</given-names></name><name><surname>Sappington</surname><given-names>I</given-names></name><name><surname>Torres</surname><given-names>SV</given-names></name><name><surname>Lauko</surname><given-names>A</given-names></name><name><surname>De Bortoli</surname><given-names>V</given-names></name><name><surname>Mathieu</surname><given-names>E</given-names></name><name><surname>Ovchinnikov</surname><given-names>S</given-names></name><name><surname>Barzilay</surname><given-names>R</given-names></name><name><surname>Jaakkola</surname><given-names>TS</given-names></name><name><surname>DiMaio</surname><given-names>F</given-names></name><name><surname>Baek</surname><given-names>M</given-names></name><name><surname>Baker</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>De novo design of protein structure and function with RFdiffusion</article-title><source>Nature</source><volume>620</volume><fpage>1089</fpage><lpage>1100</lpage><pub-id pub-id-type="doi">10.1038/s41586-023-06415-8</pub-id><pub-id pub-id-type="pmid">37433327</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>R</given-names></name><name><surname>Ding</surname><given-names>F</given-names></name><name><surname>Wang</surname><given-names>R</given-names></name><name><surname>Shen</surname><given-names>R</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Luo</surname><given-names>S</given-names></name><name><surname>Su</surname><given-names>C</given-names></name><name><surname>Wu</surname><given-names>Z</given-names></name><name><surname>Xie</surname><given-names>Q</given-names></name><name><surname>Berger</surname><given-names>B</given-names></name><name><surname>Ma</surname><given-names>J</given-names></name><name><surname>Peng</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2022">2022a</year><article-title>High-Resolution<italic>de Novo</italic>Structure Prediction from Primary Sequence</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2022.07.21.500999</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>J</given-names></name><name><surname>Wu</surname><given-names>F</given-names></name><name><surname>Jiang</surname><given-names>B</given-names></name><name><surname>Liu</surname><given-names>W</given-names></name><name><surname>Zhao</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2022">2022b</year><article-title>tFold-Ab: fast and accurate antibody structure prediction without sequence homologs</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2022.11.10.515918</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Xiang</surname><given-names>Y</given-names></name><collab>xiaoyao4573</collab></person-group><year iso-8601-date="2023">2023</year><data-title>Paddlehelix</data-title><version designator="5f39b2c">5f39b2c</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/PaddlePaddle/PaddleHelix/tree/5f39b2c2a4ecc00b89ba05b95dc56212bdd5d886/apps/protein_folding/helixfold-single">https://github.com/PaddlePaddle/PaddleHelix/tree/5f39b2c2a4ecc00b89ba05b95dc56212bdd5d886/apps/protein_folding/helixfold-single</ext-link></element-citation></ref><ref id="bib76"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Ye</surname><given-names>Q</given-names></name><name><surname>Lu</surname><given-names>S</given-names></name><name><surname>Corbett</surname><given-names>KD</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Structural Basis for SARS-CoV-2 Nucleocapsid Protein Recognition by Single-Domain Antibodies</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.06.01.446591</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>F</given-names></name><name><surname>Wang</surname><given-names>Q</given-names></name><name><surname>Li</surname><given-names>M</given-names></name><name><surname>Zhou</surname><given-names>H</given-names></name><name><surname>Liu</surname><given-names>K</given-names></name><name><surname>Zhang</surname><given-names>K</given-names></name><name><surname>Wang</surname><given-names>Z</given-names></name><name><surname>Xu</surname><given-names>Q</given-names></name><name><surname>Xu</surname><given-names>C</given-names></name><name><surname>Pan</surname><given-names>Q</given-names></name><name><surname>He</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Aquarium: an automatic data-processing and experiment information management system for biological macromolecular crystallography beamlines</article-title><source>Journal of Applied Crystallography</source><volume>52</volume><fpage>472</fpage><lpage>477</lpage><pub-id pub-id-type="doi">10.1107/S1600576719001183</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zavrtanik</surname><given-names>U</given-names></name><name><surname>Hadži</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>A non-redundant data set of nanobody-antigen crystal structures</article-title><source>Data in Brief</source><volume>24</volume><elocation-id>103754</elocation-id><pub-id pub-id-type="doi">10.1016/j.dib.2019.103754</pub-id><pub-id pub-id-type="pmid">30976633</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zemla</surname><given-names>A</given-names></name><name><surname>Venclovas</surname><given-names>C</given-names></name><name><surname>Moult</surname><given-names>J</given-names></name><name><surname>Fidelis</surname><given-names>K</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Processing and analysis of CASP3 protein structure predictions</article-title><source>Proteins</source><volume>37</volume><fpage>22</fpage><lpage>29</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1097-0134(1999)37:3+&lt;22::AID-PROT5&gt;3.0.CO;2-W</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Skolnick</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Scoring function for automated assessment of protein structure template quality</article-title><source>Proteins</source><volume>57</volume><fpage>702</fpage><lpage>710</lpage><pub-id pub-id-type="doi">10.1002/prot.20264</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>S</given-names></name><name><surname>Fan</surname><given-names>S</given-names></name><name><surname>Tang</surname><given-names>T</given-names></name><name><surname>Huang</surname><given-names>J</given-names></name><name><surname>Zhou</surname><given-names>H</given-names></name><name><surname>Huang</surname><given-names>C</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Qian</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Polymorphic nanobody crystals as long-acting intravitreal therapy for wet age-related macular degeneration</article-title><source>Bioengineering &amp; Translational Medicine</source><volume>8</volume><elocation-id>e10523</elocation-id><pub-id pub-id-type="doi">10.1002/btm2.10523</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Zidek</surname><given-names>A</given-names></name><name><surname>Tomlinson</surname><given-names>H</given-names></name><name><surname>Ward</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>Alphafold</data-title><version designator="91b4322">91b4322</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/google-deepmind/alphafold">https://github.com/google-deepmind/alphafold</ext-link></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.91512.4.sa0</article-id><title-group><article-title>eLife assessment</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Dötsch</surname><given-names>Volker</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution>Goethe University</institution><country>Germany</country></aff></contrib></contrib-group><kwd-group kwd-group-type="evidence-strength"><kwd>Convincing</kwd></kwd-group><kwd-group kwd-group-type="claim-importance"><kwd>Important</kwd></kwd-group></front-stub><body><p>This article presents H3-OPT, a deep learning method that effectively combines existing techniques for the prediction of antibody structure. This work, supported by <bold>convincing</bold> experiments for validation, is <bold>important</bold> because the method can aid in the design of antibodies, which are key tools in many research and industrial applications.</p></body></sub-article><sub-article article-type="referee-report" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.91512.4.sa1</article-id><title-group><article-title>Reviewer #2 (Public Review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>This work provides a new tool (H3-Opt) for the prediction of antibody and nanobody structures, based on the combination of AlphaFold2 and a pre-trained protein language model, with a focus on predicting the challenging CDR-H3 loops with enhanced accuracy than previously developed approaches. This task is of high value for the development of new therapeutic antibodies. The paper provides an external validation consisting of 131 sequences, with further analysis of the results by segregating the test sets in three subsets of varying difficulty and comparison with other available methods. Furthermore, the approach was validated by comparing three experimentally solved 3D structures of anti-VEGF nanobodies with the H3-Opt predictions</p><p>Strengths:</p><p>The experimental design to train and validate the new approach has been clearly described, including the dataset compilation and its representative sampling into training, validation and test sets, and structure preparation. The results of the in silico validation are quite convincing and support the authors' conclusions.</p><p>The datasets used to train and validate the tool and the code are made available by the authors, which ensures transparency and reproducibility, and allows future benchmarking exercises with incoming new tools.</p><p>Compared to AlphaFold2, the authors' optimization seems to produce better results for the most challenging subsets of the test set.</p><p>Weaknesses:</p><p>None</p></body></sub-article><sub-article article-type="referee-report" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.91512.4.sa2</article-id><title-group><article-title>Reviewer #3 (Public Review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>The manuscript introduces a new computational framework for choosing 'the best method' according to the case for getting the best possible structural prediction for the CDR-H3 loop. The authors show their strategy improves on average the accuracy of the predictions on datasets of increasing difficulty in comparison to several state-of-the-art methods. They also show the benefits of improving the structural predictions of the CDR-H3 in the evaluation of different properties that may be relevant for drug discovery and therapeutic design.</p><p>Strengths:</p><p>The authors introduce a novel framework, which can be easily adapted and improved. Authors use a well-defined dataset to test their new method. A modest average accuracy gain is obtained in comparison to other state-of-the art methods for the same task, while avoiding testing different prediction approaches. Although the accuracy gain is mainly ascribed to easy cases, the accuracy and precision for moderate to challenging cases is comparable to the best PLM methods (see Fig. 4b and Extended Data Fig. 2), reflecting the present methodological limit in the field. The proposed method includes a confidence score for guiding users about the accuracy of the predictions.</p></body></sub-article><sub-article article-type="author-comment" id="sa3"><front-stub><article-id pub-id-type="doi">10.7554/eLife.91512.4.sa3</article-id><title-group><article-title>Author response</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Chen</surname><given-names>Hedi</given-names></name><role specific-use="author">Author</role><aff><institution>Tsinghua University</institution><addr-line><named-content content-type="city">Beijing</named-content></addr-line><country>China</country></aff></contrib><contrib contrib-type="author"><name><surname>Fan</surname><given-names>Xiaoyu</given-names></name><role specific-use="author">Author</role><aff><institution>Tsinghua University</institution><addr-line><named-content content-type="city">Beijing</named-content></addr-line><country>China</country></aff></contrib><contrib contrib-type="author"><name><surname>Zhu</surname><given-names>Shuqian</given-names></name><role specific-use="author">Author</role><aff><institution>Tsinghua University</institution><addr-line><named-content content-type="city">Beijing</named-content></addr-line><country>China</country></aff></contrib><contrib contrib-type="author"><name><surname>Pei</surname><given-names>Yuchan</given-names></name><role specific-use="author">Author</role><aff><institution>Tsinghua University</institution><addr-line><named-content content-type="city">Beijing</named-content></addr-line><country>China</country></aff></contrib><contrib contrib-type="author"><name><surname>Zhang</surname><given-names>Xiaochun</given-names></name><role specific-use="author">Author</role><aff><institution>Tsinghua University</institution><addr-line><named-content content-type="city">Beijing</named-content></addr-line><country>China</country></aff></contrib><contrib contrib-type="author"><name><surname>Zhang</surname><given-names>Xiaonan</given-names></name><role specific-use="author">Author</role><aff><institution>Baidu International Technology</institution><addr-line><named-content content-type="city">Shenzhen</named-content></addr-line><country>China</country></aff></contrib><contrib contrib-type="author"><name><surname>Liu</surname><given-names>Lihang</given-names></name><role specific-use="author">Author</role><aff><institution>Baidu International Technology</institution><addr-line><named-content content-type="city">Shenzhen</named-content></addr-line><country>China</country></aff></contrib><contrib contrib-type="author"><name><surname>Qian</surname><given-names>Feng</given-names></name><role specific-use="author">Author</role><aff><institution>Tsinghua University</institution><addr-line><named-content content-type="city">Beijing</named-content></addr-line><country>China</country></aff></contrib><contrib contrib-type="author"><name><surname>Tian</surname><given-names>Boxue</given-names></name><role specific-use="author">Author</role><aff><institution>Tsinghua University</institution><addr-line><named-content content-type="city">Beijing</named-content></addr-line><country>China</country></aff></contrib></contrib-group></front-stub><body><p>The following is the authors’ response to the previous reviews.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #2 (Public Review):</bold></p><p>Weaknesses:</p><p>The comparison of affinity predictions derived from AlphaFold2 and H3-opt models, based on molecular dynamics simulations, should have been discussed in depth. In some cases, there are huge differences between the estimations from H3-opt models and those from experimental structures. It seems that the authors obtained average differences of the real delta, instead of average differences of the absolute value of the delta. This can be misleading, because high negative differences might be compensated by high positive differences when computing the mean value. Moreover, it would have been good for the authors to disclose the trajectories from the MD simulations.</p></disp-quote><p>Thanks for your careful checks. We fully understand your concerns about the large differences when calculating affinity. To understand the source of these huge differences, we carefully analyzed the trajectories of the input structures during MD simulations. We found that the antigen-antibody complex shifted as it transited from NVT to NPT during pre-equilibrium, even when restraints are used to determine the protein structure. To address this issue, we consulted the solution provided on Amber's mailing list (<ext-link ext-link-type="uri" xlink:href="http://archive.ambermd.org/202102/0298.html">http://archive.ambermd.org/202102/0298.html</ext-link>) and modified the top file ATOMS_MOLECULE item of the simulation system to merge the antigen-antibody complexes into one molecule. As a result, the number of SOLVENT_POINTERS was also adjusted. Finally, we performed all MD simulations and calculated affinities of all complexes.</p><p>We have corrected the “Afterwards, a 25000-step NVT simulation with a time step of 1 fs was performed to gradually heat the system from 0 K to 100 K. A 250000-step NPT simulation with a time step of 2 fs was carried out to further heat the system from 100 K to 298 K.” into “Afterwards, a 400-ps NVT simulation with a time step of 2 fs was performed to gradually heat the system from 0 K to 298 K (0–100 K: 100 ps; 100-298 K: 200 ps; hold 298 K: 100 ps), and a 100-ps NPT simulation with a time step of 2 fs was performed to equilibrate the density of the system. During heating and density equilibration, we constrained the antigen-antibody structure with a restraint value of 10 kcal×mol-1×Å-2.” and added the following sentence in the Method section of our revised manuscript: “The first 50 ns restrains the non-hydrogen atoms of the antigen-antibody complex, and the last 50 ns restrains the non-hydrogen atoms of the antigen, with a constraint value of 10 kcal×mol-1×Å-2”</p><p>In addition, we have corrected the calculation of mean deltas using absolute values and have demonstrated that the average affinities of structures predicted by H3-OPT were closer to those of experimentally determined structures than values obtained through AF2. These results have been updated in the revised manuscript. However, significant differences still exist between the estimations of H3-OPT models and those derived from experimental structures in few cases. We found that antibodies moved away from antigens both in AF2 and H3-OPT predicted complexes during simulations, resulting in RMSDbackbone (RMSD of antibody backbone) exceeding 20 Å. These deviations led to significant structural changes in the complexes and consequently resulted in notable differences in affinity calculations. Thus, we removed three samples (PDBID: 4qhu, 6flc, 6plk) from benchmark because these predicted structures moved away from the antigen structure during MD simulations, resulting in huge energy differences from the native structures.</p><table-wrap id="sa3table1" position="float"><label>Author response table 1.</label><table frame="hsides" rules="groups"><thead><tr><th valign="bottom">PDBID</th><th valign="bottom">AF2(kcal//mol)</th><th valign="bottom"/><th valign="bottom">AF2<break/>RMSD_(Cu)<break/>(A)</th><th valign="bottom">H3-OPT(kcal//mol)</th><th valign="bottom"/><th valign="bottom"/><th valign="bottom">AF2(kcal//mol)</th><th valign="bottom"/><th valign="bottom">H3-OPT(kcal//mol)</th><th valign="bottom"/></tr></thead><tbody><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">MM/<break/>GBSA</td><td align="left" valign="bottom">MM/<break/>PBSA</td><td align="left" valign="bottom"/><td align="left" valign="bottom">MM/<break/>GBSA</td><td align="left" valign="bottom">MM/<break/>PBSA</td><td align="left" valign="bottom">(&quot;Å&quot;)</td><td align="left" valign="bottom">|/_\MM//GBSA^(**)|</td><td align="left" valign="bottom">| /_\MM//PBSA∣</td><td align="left" valign="bottom">[ /_\MM//GBSA]</td><td align="left" valign="bottom">|/_\MM//PBSA|</td></tr><tr><td align="left" valign="bottom">2ghw</td><td align="left" valign="bottom">-29.20</td><td align="left" valign="bottom">-33.36</td><td align="left" valign="bottom">2.7</td><td align="left" valign="bottom">-14.70</td><td align="left" valign="bottom">-21.36</td><td align="left" valign="bottom">3.0</td><td align="left" valign="bottom">8.63</td><td align="left" valign="bottom">2.42</td><td align="left" valign="bottom">23.13</td><td align="left" valign="bottom">14.42</td></tr><tr><td align="left" valign="bottom">2yc1</td><td align="left" valign="bottom">-38.85</td><td align="left" valign="bottom">-37.73</td><td align="left" valign="bottom">2.3</td><td align="left" valign="bottom">-43.80</td><td align="left" valign="bottom">-48.72</td><td align="left" valign="bottom">1.5</td><td align="left" valign="bottom">6.80</td><td align="left" valign="bottom">18.67</td><td align="left" valign="bottom">1.85</td><td align="left" valign="bottom">7.68</td></tr><tr><td align="left" valign="bottom">3195</td><td align="left" valign="bottom">-29.59</td><td align="left" valign="bottom">-53.35</td><td align="left" valign="bottom">2.5</td><td align="left" valign="bottom">-47.22</td><td align="left" valign="bottom">-68.86</td><td align="left" valign="bottom">2.5</td><td align="left" valign="bottom">23.60</td><td align="left" valign="bottom">11.44</td><td align="left" valign="bottom">5.97</td><td align="left" valign="bottom">4.07</td></tr><tr><td align="left" valign="bottom">3u30</td><td align="left" valign="bottom">-37.31</td><td align="left" valign="bottom">-42.41</td><td align="left" valign="bottom">2.6</td><td align="left" valign="bottom">-44.94</td><td align="left" valign="bottom">-50.07</td><td align="left" valign="bottom">2.5</td><td align="left" valign="bottom">9.64</td><td align="left" valign="bottom">2.18</td><td align="left" valign="bottom">2.01</td><td align="left" valign="bottom">5.48</td></tr><tr><td align="left" valign="bottom">4cni</td><td align="left" valign="bottom">-36.96</td><td align="left" valign="bottom">-42.93</td><td align="left" valign="bottom">1.0</td><td align="left" valign="bottom">-31.92</td><td align="left" valign="bottom">-40.39</td><td align="left" valign="bottom">1.3</td><td align="left" valign="bottom">8.54</td><td align="left" valign="bottom">7.44</td><td align="left" valign="bottom">3.50</td><td align="left" valign="bottom">4.89</td></tr><tr><td align="left" valign="bottom">4nbz</td><td align="left" valign="bottom">-36.59</td><td align="left" valign="bottom">-43.79</td><td align="left" valign="bottom">1.9</td><td align="left" valign="bottom">-59.61</td><td align="left" valign="bottom">-54.23</td><td align="left" valign="bottom">0.6</td><td align="left" valign="bottom">10.17</td><td align="left" valign="bottom">3.30</td><td align="left" valign="bottom">12.85</td><td align="left" valign="bottom">13.74</td></tr><tr><td align="left" valign="bottom">4xx nq</td><td align="left" valign="bottom">-13.55</td><td align="left" valign="bottom">-17.47</td><td align="left" valign="bottom">2.7</td><td align="left" valign="bottom">-31.51</td><td align="left" valign="bottom">-30.94</td><td align="left" valign="bottom">0.5</td><td align="left" valign="bottom">15.40</td><td align="left" valign="bottom">12.32</td><td align="left" valign="bottom">2.57</td><td align="left" valign="bottom">1.15</td></tr><tr><td align="left" valign="bottom">4ydl</td><td align="left" valign="bottom">-52.51</td><td align="left" valign="bottom">-74.25</td><td align="left" valign="bottom">4.8</td><td align="left" valign="bottom">-49.17</td><td align="left" valign="bottom">-73.57</td><td align="left" valign="bottom">3.6</td><td align="left" valign="bottom">6.82</td><td align="left" valign="bottom">6.53</td><td align="left" valign="bottom">10.15</td><td align="left" valign="bottom">7.21</td></tr><tr><td align="left" valign="bottom">5e5m</td><td align="left" valign="bottom">-59.72</td><td align="left" valign="bottom">-71.15</td><td align="left" valign="bottom">3.0</td><td align="left" valign="bottom">-41.29</td><td align="left" valign="bottom">-53.70</td><td align="left" valign="bottom">7.3</td><td align="left" valign="bottom">0.50</td><td align="left" valign="bottom">5.79</td><td align="left" valign="bottom">18.93</td><td align="left" valign="bottom">11.66</td></tr><tr><td align="left" valign="bottom">577 y</td><td align="left" valign="bottom">-61.76</td><td align="left" valign="bottom">-69.46</td><td align="left" valign="bottom">2.7</td><td align="left" valign="bottom">-60.33</td><td align="left" valign="bottom">-69.43</td><td align="left" valign="bottom">1.4</td><td align="left" valign="bottom">3.95</td><td align="left" valign="bottom">6.38</td><td align="left" valign="bottom">5.38</td><td align="left" valign="bottom">6.41</td></tr><tr><td align="left" valign="bottom">6kyz</td><td align="left" valign="bottom">-12.66</td><td align="left" valign="bottom">-20.32</td><td align="left" valign="bottom">4.0</td><td align="left" valign="bottom">-9.36</td><td align="left" valign="bottom">-17.13</td><td align="left" valign="bottom">3.7</td><td align="left" valign="bottom">17.63</td><td align="left" valign="bottom">17.21</td><td align="left" valign="bottom">20.93</td><td align="left" valign="bottom">20.40</td></tr><tr><td align="left" valign="bottom">609h</td><td align="left" valign="bottom">-39.53</td><td align="left" valign="bottom">-43.45</td><td align="left" valign="bottom">2.8</td><td align="left" valign="bottom">-52.27</td><td align="left" valign="bottom">-57.51</td><td align="left" valign="bottom">0.6</td><td align="left" valign="bottom">10.45</td><td align="left" valign="bottom">13.31</td><td align="left" valign="bottom">2.29</td><td align="left" valign="bottom">0.74</td></tr><tr><td align="left" valign="bottom">6pyd</td><td align="left" valign="bottom">-45.87</td><td align="left" valign="bottom">-58.71</td><td align="left" valign="bottom">1.0</td><td align="left" valign="bottom">-35.75</td><td align="left" valign="bottom">-45.28</td><td align="left" valign="bottom">1.1</td><td align="left" valign="bottom">6.29</td><td align="left" valign="bottom">13.50</td><td align="left" valign="bottom">3.83</td><td align="left" valign="bottom">0.06</td></tr><tr><td align="left" valign="bottom">6u9s</td><td align="left" valign="bottom">-36.54</td><td align="left" valign="bottom">-48.66</td><td align="left" valign="bottom">1.0</td><td align="left" valign="bottom">-39.79</td><td align="left" valign="bottom">-44.80</td><td align="left" valign="bottom">1.3</td><td align="left" valign="bottom">14.35</td><td align="left" valign="bottom">10.42</td><td align="left" valign="bottom">11.11</td><td align="left" valign="bottom">14.28</td></tr><tr><td align="left" valign="bottom">Average</td><td align="left" valign="bottom">1</td><td align="left" valign="bottom">I</td><td align="left" valign="bottom">2.6</td><td align="left" valign="bottom">l</td><td align="left" valign="bottom">1</td><td align="left" valign="bottom">2.4</td><td align="left" valign="bottom">10.20</td><td align="left" valign="bottom">9.35</td><td align="left" valign="bottom">8.89</td><td align="left" valign="bottom">8.01</td></tr></tbody></table></table-wrap><p>We also appreciate your reminder, and we have calculated all RMSDbackbone during production runs (SI Fig. 5).</p><fig id="sa3fig1" position="float"><label>Author response image 1.</label><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91512-sa3-fig1-v1.tif"/></fig><disp-quote content-type="editor-comment"><p><bold>Reviewer #3 (Public Review):</bold></p><p>Weaknesses:</p><p>The proposed method lacks of a confidence score or a warning to help guiding the users in moderate to challenging cases.</p><p>We were sorry for our mistakes. We have updated our GitHub code and added following sentences to clarify how we train this confidence score module in Method Section: “Confidence score prediction module</p></disp-quote><p>We apply an MSE loss for confidence prediction, label error was calculated as the Cα deviation of each residue after alignment. The inputs of this module are the same as those used for H3-OPT, and it generates a confidence score ranging from 0 to 100. The dropout rates of H3-OPT were set to 0.25. The learning rate and weight decay of Adam optimizer are set to 1 × 10−5 and 1 × 10−4, respectively.”</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #2 (Recommendations For The Authors):</bold></p><p>I would strongly suggest that the authors deepen their discussion on the affinity prediction based on Molecular Dynamics. In particular, why do the authors think that some structures exhibit huge differences between the predictions from the experimental structure and the predicted by H3-opt? Also, please compute the mean deltas using the absolute value and not the real value; the letter can be extremely misleading and hidden very high differences in different directions that are compensating when averaging.</p></disp-quote><p>I would also advice to include graphical results of the MD trajectories, at least as Supp. Material.</p><p>We gratefully thank you for your feedback and fully understand your concerns. We found the source of these huge differences and solved this problem by changing method of MD simulations. Then, we calculated all affinities and corrected the mean deltas calculation using the absolute value. The RMSDbackbone values were also measured to enable accurate affinity predictions during production runs (SI Fig. 5). There are still big differences between the estimations of H3-OPT models and those from experimental structures in some cases. We found that antibodies moved away from antigens both in AF2 and H3-OPT predicted complexes during simulations, resulting in RMSDbackbone exceeding 20 Å. These deviations led to significant structural changes in the complexes and consequently resulted in notable differences in affinity calculations. Thus, we removed three samples (PDBID: 4qhu, 6flc, 6plk) from benchmark.</p><p>Thanks again for your professional advice.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #3 (Recommendations For The Authors):</bold></p><p>(1) I am pleased with the most of the answers provided by the authors to the first review. In my humble opinion, the new manuscript has greatly improved. However, I think some answers to the reviewers are worth to be included in the main text or supporting information for the benefit of general readers. In particular, the requested statistics (i.e. p-values for Cα-RMSD values across the modeling approaches, p-values and error bars in Fig 5a and 5b, etc.) should be introduced in the manuscript.</p></disp-quote><p>We sincerely appreciate your advice. We have added the statistics values to Fig. 4 and Fig. 5 to our manuscript.</p><fig id="sa3fig2" position="float"><label>Author response image 2.</label><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91512-sa3-fig2-v1.tif"/></fig><fig id="sa3fig3" position="float"><label>Author response image 3.</label><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91512-sa3-fig3-v1.tif"/></fig><disp-quote content-type="editor-comment"><p>(2) Similarly, authors state in the answers that &quot;we have trained a separate module to predict the confidence score of the optimized CDR-H3 loops&quot;. That sounds a great improvement to H3-OPT! However, I couldn't find any reference of that new module in the reviewed version of the manuscript, nor in the available GitHub code. That is the reason for me to hold the weakness &quot;The proposed method lacks of a confidence score&quot;.</p></disp-quote><p>We were really sorry for our careless mistakes. Thank you for your reminding. We have updated our GitHub code and added following sentences to clarify how we train this confidence score module in Method Section:</p><p>“Confidence score prediction module</p><p>We apply an MSE loss for confidence prediction, label error was calculated as the Cα deviation of each residue after alignment. The inputs of this module are the same as those used for H3-OPT, and it generates a confidence score ranging from 0 to 100. The dropout rates of H3-OPT were set to 0.25. The learning rate and weight decay of Adam optimizer are set to 1 × 10−5 and 1 × 10−4, respectively.”</p><disp-quote content-type="editor-comment"><p>(3) I acknowledge all the efforts made for solving new mutant/designed nanobody structures. Judging from the solved structures, mutants Y95F and Q118N seems critical to either crystallographic or dimerization contacts stabilizing the CDR-H3 loop, hence preventing the formation of crystals. Clearly, solving a molecular structure is a challenge, hence including the following comment in the manuscript is relevant for readers to correctly asset the magnitude of the validation: &quot;The sequence identities of the VH domain and H3 loop are 0.816 and 0.647, respectively, comparing with the best template. The CDR-H3 lengths of these nanobodies are both 17. According to our classification strategy, these nanobodies belong to Sub1. The confidence scores of these AlphaFold2 predicted loops were all higher than 0.8, and these loops were accepted as the outputs of H3-OPT by CBM.&quot;</p></disp-quote><p>We appreciate your kind recommendations and have revised “Although Mut1 (E45A) and Mut2 (Q14N) shared the same CDR-H3 sequences as WT, only minor variations were observed in the CDR-H3. H3-OPT generated accurate predictions with Cα-RMSDs of 1.510 Å, 1.541 Å and 1.411 Å for the WT, Mut1, and Mut2, respectively.” into “Although Mut1 (E45A) and Mut2 (Q14N) shared the same CDR-H3 sequences as WT (LengthCDR-H3 = 17), only minor variations were observed in the CDR-H3. H3-OPT generated accurate predictions with Cα-RMSDs of 1.510 Å, 1.541 Å and 1.411 Å for the WT, Mut1, and Mut2, respectively (The confidence scores of these AlphaFold2 predicted loops were all higher than 0.8, and these loops were accepted as the outputs of H3-OPT by CBM). ”. In addition, we have added following sentence in the legend of Figure 4 to ensure that readers can appropriately evaluate the significance and reliability of our validations: “The sequence identities of the VH domain and H3 loop are 0.816 and 0.647, respectively, comparing with the best template.”.</p><disp-quote content-type="editor-comment"><p>(4) As pointed out in the first review, I think the work <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/acs.jctc.1c00341">https://doi.org/10.1021/acs.jctc.1c00341</ext-link> is worth acknowledging in section &quot;2.2 Molecular dynamics (MD) simulations could not provide accurate CDR-H3 loop conformations&quot; of supplementary material, as it constitutes a clear reference (and probably one of the few) to the MD simulations that authors pretend to perform. Similarly, the work <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3390/molecules28103991">https://doi.org/10.3390/molecules28103991</ext-link> introduces a former benchmark on AI algorithms for predicting antibody and nanobody structures that readers may find interest to contrast with the present work. Indeed, this later reference is used by authors to answer a reviewer comment.</p></disp-quote><p>Thanks a lot for your valuable comments. We have added these references in the proper positions in our manuscript.</p></body></sub-article></article>