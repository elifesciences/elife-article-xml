<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">58809</article-id><article-id pub-id-type="doi">10.7554/eLife.58809</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Neural encoding of task-dependent errors during adaptive learning</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-187496"><name><surname>Kao</surname><given-names>Chang-Hao</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2928-302X</contrib-id><email>chakao@sas.upenn.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-188647"><name><surname>Lee</surname><given-names>Sangil</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4443-9926</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-17965"><name><surname>Gold</surname><given-names>Joshua I</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-6018-0483</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" corresp="yes" id="author-34495"><name><surname>Kable</surname><given-names>Joseph W</given-names></name><email>kable@psych.upenn.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>Department of Psychology, University of Pennsylvania</institution><addr-line><named-content content-type="city">Philadelphia</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution>Department of Neuroscience, University of Pennsylvania</institution><addr-line><named-content content-type="city">Philadelphia</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Kahnt</surname><given-names>Thorsten</given-names></name><role>Reviewing Editor</role><aff><institution>Northwestern University</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Behrens</surname><given-names>Timothy E</given-names></name><role>Senior Editor</role><aff><institution>University of Oxford</institution><country>United Kingdom</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>19</day><month>10</month><year>2020</year></pub-date><pub-date pub-type="collection"><year>2020</year></pub-date><volume>9</volume><elocation-id>e58809</elocation-id><history><date date-type="received" iso-8601-date="2020-05-12"><day>12</day><month>05</month><year>2020</year></date><date date-type="accepted" iso-8601-date="2020-10-15"><day>15</day><month>10</month><year>2020</year></date></history><permissions><copyright-statement>Â© 2020, Kao et al</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>Kao et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-58809-v2.pdf"/><abstract><p>Effective learning requires using errors in a task-dependent manner, for example adjusting to errors that result from unpredicted environmental changes but ignoring errors that result from environmental stochasticity. Where and how the brain represents errors in a task-dependent manner and uses them to guide behavior are not well understood. We imaged the brains of human participants performing a predictive-inference task with two conditions that had different sources of errors. Their performance was sensitive to this difference, including more choice switches after fundamental changes versus stochastic fluctuations in reward contingencies. Using multi-voxel pattern classification, we identified task-dependent representations of error magnitude and past errors in posterior parietal cortex. These representations were distinct from representations of the resulting behavioral adjustments in dorsomedial frontal, anterior cingulate, and orbitofrontal cortex. The results provide new insights into how the human brain represents errors in a task-dependent manner and guides subsequent adaptive behavior.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>adaptive learning</kwd><kwd>posterior parietal cortex</kwd><kwd>frontal cortex</kwd><kwd>error encoding</kwd><kwd>behavioral change</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000025</institution-id><institution>National Institute of Mental Health</institution></institution-wrap></funding-source><award-id>R01-MH098899</award-id><principal-award-recipient><name><surname>Gold</surname><given-names>Joshua I</given-names></name><name><surname>Kable</surname><given-names>Joseph W</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>1533623</award-id><principal-award-recipient><name><surname>Gold</surname><given-names>Joshua I</given-names></name><name><surname>Kable</surname><given-names>Joseph W</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Posterior parietal cortex encodes errors in a task-dependent manner while a large array of frontal regions predict subsequent behavioral changes in response to ambiguous errors.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Errors often drive adaptive adjustments in beliefs that inform behaviors that maximize positive outcomes and minimize negative ones (<xref ref-type="bibr" rid="bib45">Sutton and Barto, 1998</xref>). A major challenge to error-driven learning in uncertain and dynamic environments is that errors can arise from different sources that have different implications for learning. For example, a bad experience at a restaurant that recently hired a new chef might lead you to update your belief about the quality of the restaurant, whereas a similar experience at a well-known restaurant with a chef that has long been your favorite might be written off as a one-time bad night. That is, the same errors should be interpreted differently in different contexts. In general, errors that represent fundamental changes in the environment or that occur during periods of uncertainty should probably lead you to update your beliefs and change your behavior, whereas those that result from environmental stochasticity are likely better ignored (<xref ref-type="bibr" rid="bib9">d'Acremont and Bossaerts, 2016</xref>; <xref ref-type="bibr" rid="bib32">Li et al., 2019</xref>; <xref ref-type="bibr" rid="bib38">Nassar et al., 2019a</xref>; <xref ref-type="bibr" rid="bib40">O'Reilly et al., 2013</xref>).</p><p>Neural representations of key features of these kinds of dynamic, error-driven learning processes have been identified in several brain regions. For example, several studies focused on variables derived from normative models that describe the degree to which individuals should dynamically adjust their beliefs in response to error feedback under different task conditions, including the probability that a fundamental change in the environment just occurred (change-point probability, or CPP, which is a form of surprise) and the reducible uncertainty associated with estimates of environmental features (relative uncertainty, or RU). Correlates of these variables have been identified in dorsomedial frontal (DMFC) and dorsolateral prefrontal (DLPFC) cortex and medial and lateral posterior parietal cortex (PPC) (<xref ref-type="bibr" rid="bib3">Behrens et al., 2007</xref>; <xref ref-type="bibr" rid="bib33">McGuire et al., 2014</xref>; <xref ref-type="bibr" rid="bib38">Nassar et al., 2019a</xref>). These and other studies also suggest specific roles for these different brain regions in error-driving learning, including representations of surprise induced by either state changes or outliers (irrelevant to state changes) in the PPC that suggest a role in error monitoring (<xref ref-type="bibr" rid="bib38">Nassar et al., 2019a</xref>; <xref ref-type="bibr" rid="bib40">O'Reilly et al., 2013</xref>), and representations of variables more closely related to belief and behavior updating in the prefrontal cortex (PFC) (<xref ref-type="bibr" rid="bib33">McGuire et al., 2014</xref>; <xref ref-type="bibr" rid="bib40">O'Reilly et al., 2013</xref>). However, these previous studies, which typically used continuous rather than discrete feedback, were not designed to identify neural signals related to a key aspect of flexible learning in uncertain and dynamic environments: responding to the same kinds of errors differently in different conditions.</p><p>To identify such task-dependent neural responses to errors, we adapted a paradigm from our previous single-unit recording study (<xref ref-type="bibr" rid="bib32">Li et al., 2019</xref>). In this paradigm, we generated two different dynamic environments by varying the amount of noise and the frequency that change-points occur (i.e. hazard rate; <xref ref-type="bibr" rid="bib3">Behrens et al., 2007</xref>; <xref ref-type="bibr" rid="bib17">Glaze et al., 2015</xref>; <xref ref-type="bibr" rid="bib37">Nassar et al., 2012</xref>; <xref ref-type="bibr" rid="bib36">Nassar et al., 2010</xref>). In one environment, noise was absent and the hazard rate was high, and thus errors unambiguously signaled a change in state. We refer to this high-hazard/low-noise condition as the <italic>unstable</italic> environment, because most errors can be attributed to volatility. In another environment, noise was high and the hazard rate was low, and thus small errors were ambiguous and could indicate either a change in state or noise. We refer to this low-hazard/high-noise condition as the <italic>noisy</italic> environment, because most errors can be attributed to stochasticity. Thus, effective learning requires treating errors in the two conditions differently, including adjusting immediately to errors in the unstable environment but using the size of errors and recent error history as cues to aid interpretation of ambiguous errors in the noisy environment.</p><p>In our previous study, we found many single neurons in the anterior cingulate cortex (ACC) or posterior cingulate cortex (PCC) that responded to errors or the current condition, but we found little evidence that single neurons in these regions combined this information in a task-dependent manner to discriminate the source of errors or drive behavior. In the current study, we used whole-brain fMRI and multi-voxel pattern classification to identify task-dependent neural responses to errors and activity predictive of behavioral updating in the human brain. The results show task-dependent encoding of error magnitude and past errors in PPC and encoding of behavioral shifts in frontal regions including ACC, DMFC, DLPFC and orbitofrontal cortex (OFC), which provide new insights into the distinct roles these brain regions play in representing errors in a task-dependent manner and using errors to guide adaptive behavior.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>Sixteen human participants performed a predictive-inference task (<xref ref-type="fig" rid="fig1">Figure 1A</xref>) while fMRI was used to measure their blood-oxygenation-level-dependent (BOLD) brain activity. The task required them to predict the location of a single rewarded target from a circular array of ten targets. The location of the rewarded target was sampled from a distribution based on the location of the current best target and the noise level in the current condition. In addition, the location of the best target could change according to a particular, fixed hazard rate (<italic>H</italic>). Two conditions with different noise levels and hazard rates were conducted in separate runs. In the noisy condition (<xref ref-type="fig" rid="fig1">Figure 1BâC</xref>), the rewarded target would appear in one of the five locations relative to the location of the current best target, and the hazard rate was low (<italic>H</italic>Â =Â 0.02). In the unstable condition (<xref ref-type="fig" rid="fig1">Figure 1DâE</xref>), the rewarded target always appeared at the location of the best target, and the hazard rate was high (<italic>H</italic>Â =Â 0.35). On each trial, participants made a prediction by looking at a particular target, and then were given explicit, visual feedback about their chosen target and the rewarded target. Effective performance required them to use this feedback in a flexible and task-dependent manner, including typically ignoring small errors in the noisy condition but responding to small errors in the unstable condition by updating their beliefs about the best-target location.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Overview of task and experimental design.</title><p>(<bold>A</bold>) Sequence of the task. At the start of the trial, participants look at a cross in the center of the screen and maintain fixation for 0.5 s to initialize the trial. After the cross disappears, participants choose one of 10 targets (red) by looking at it within 1.5 s and then holding fixation on the chosen target for 0.3 s. During the outcome phase (1 s), a green dot inside the target indicates the participantsâ choice. The rewarded target is shown in purple or cyan to indicate the number of earnable points as 10 or 20, respectively. (<bold>B</bold>) Probability distribution of the rewarded target location in the noisy condition. Target location is relative to the location of the state (generative mean). The rewarded target probabilities for the relative locations of [â2,â1, 0, 1, 2] are [0.05, 0.15, 0.6, 0.15, 0.05]. (<bold>C</bold>) Example of trials in the noisy condition. The states change occasionally with a hazard rate of 0.02. (<bold>D</bold>) Probability distribution of the rewarded target location in the unstable condition. Because there is no noise in this condition, the rewarded target is always at the location of the state. (<bold>E</bold>) Example of trials in the unstable condition. The states change frequently with a hazard rate of 0.35.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-58809-fig1-v2.tif"/></fig><sec id="s2-1"><title>Behavior</title><p>Nearly all of the participantsâ choice patterns were consistent with a flexible, task-dependent learning process (closed symbols in <xref ref-type="fig" rid="fig2">Figure 2</xref>). On average, they learned the location of the best target after a change in its location more quickly and reliably in the unstable than the noisy condition (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). This flexible learning process had two key signatures. First, target switches (i.e. predicting a different target than on the previous trial) tended to follow errors of any magnitude in the unstable condition but only errors of high magnitude (i.e. when the chosen target was 3, 4, or five targets away from the rewarded target) in the noisy condition (sign test for <italic>H<sub>0</sub></italic>: equal probability of switching for the two conditions; error magnitude of 1: medianÂ =Â â0.35, interquartile range (IQR) = [â0.62,â0.25], p&lt;0.001; error magnitude of 2: medianÂ =Â â0.30, IQR = [â0.70,â0.11], p&lt;0.001; <xref ref-type="fig" rid="fig2">Figure 2BâC</xref>). Second, target switches depended on error history only for low-magnitude errors (i.e. when the chosen target was 1 or two targets away from the rewarded target) in the noisy condition but not otherwise (sign test for <italic>H<sub>0</sub></italic>: switching was unaffected when recent history contained fewer errors; error magnitude of 1: medianÂ =Â â0.29, IQR = [â0.42,â0.10], p=0.004; error magnitude of 2: medianÂ =Â â0.25, IQR = [â0.38,â0.14], p&lt;0.001; <xref ref-type="fig" rid="fig2">Figure 2DâF</xref>).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Behavioral results.</title><p>(<bold>A</bold>) Probability of choosing the best target after change-points. Symbols and error bars are meanÂ Â±Â SEM across subjects (solid symbols) or simulations (open symbols). (<bold>B</bold>) Relationship between error magnitude and switch probability. Symbols and error bars are as in <bold>A</bold>. (<bold>C</bold>) The distribution of switch probabilities for small errors (magnitude of 1 or 2) in both conditions. Each data point represents one participant. Distributions for all error magnitudes are shown in <xref ref-type="fig" rid="fig2s1">Figure 2âfigure supplement 1</xref>. (<bold>D</bold>) Probability of switch as a function of current error magnitude and error history in the unstable condition. Different colors represent different error histories for the past three trials. A correct trial is marked as O, and an error trial is marked as X. For example, XOO implies that trial t-1 was an error trial, and trial t-2 and trial t-3 were correct trials. Symbols and error bars are meanÂ Â±Â SEM across subjects. (<bold>E</bold>) Probability of switch as a function of current error magnitude and error history in the noisy condition. Symbols and error bars are as in <bold>D</bold>. (<bold>F</bold>) The distribution of the slopes of switch probability against error history for small errors (magnitude of 1 or 2) in both conditions. Each data point represents one participant. Distributions for all error magnitudes are shown in <xref ref-type="fig" rid="fig2s1">Figure 2âfigure supplement 1</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-58809-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2âfigure supplement 1.</label><caption><title>Distributions of behavior as a function of error magnitude.</title><p>(<bold>A</bold>) Distributions of switch probability as a function of error magnitude. Each data point represents one participant. (<bold>B</bold>) Distributions of slopes of switch probability against error history as a function of error magnitude. Each data point represents one participant.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-58809-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2âfigure supplement 2.</label><caption><title>Behavioral data and predictions from different models.</title><p>(<bold>A</bold>) Probability of choosing the best target after change-points. (RB: reduced Bayesian; fixedLR: fixed learning rate; P<sub>stay</sub>: fixed tendency to stay) (<bold>B</bold>) The relationship between error magnitude and switch probability. (<bold>C</bold>) Probability of switch as a function of current error magnitude and error history in the unstable condition. (<bold>D</bold>) Probability of switch as a function of current error magnitude and error history in the noisy condition. Symbols and colors are as in <xref ref-type="fig" rid="fig2">Figure 2</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-58809-fig2-figsupp2-v2.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><label>Figure 2âfigure supplement 3.</label><caption><title>Reduced Bayesian model applied to behavioral and imaging data.</title><p>(<bold>A</bold>) Model prediction for CPP. We calculated CPP from the fitted reduced Bayesian model, which incorporates subjective estimates of hazard rate and noise for each condition. The value of CPP increases as the current error magnitude increases in both conditions, but with a stronger dependence on the outcome of the previous trial in the noisy condition. (<bold>B</bold>) Model prediction for RU. We calculated RU from the fitted reduced Bayesian model, which incorporates subjective estimates of hazard rate and noise for each condition. The value of RU is minimally affected by the current error magnitude. Instead, a past error tends to increase RU. (<bold>C</bold>) Model prediction for probability of switching choices. Increasing CPP causes the probability of switching to increase more steeply as the current error magnitude increases in the unstable condition versus in the noisy condition. For small errors (error magnitude of 1 and 2) in the noisy condition, the probability of switching is further influenced by RU, which is affected by past errors. (<bold>D</bold>) Neural representation of CPP and RU. CPP selective effect represents the conjunction of CPPÂ &gt;Â 0 and CPPÂ &gt;Â RU. RU selective effect represents the conjunction of RUÂ &gt;Â 0 and RUÂ &gt;Â CPP. The results were thresholded based on uncorrected voxel p&lt;0.01 (<italic>t</italic>Â =Â 2.6). (<bold>E</bold>) ROI analysis for CPP and RU. These ROIs were selected based on the common regions of CPP, RU, and reward effects in <xref ref-type="bibr" rid="bib33">McGuire et al., 2014</xref>. Significance was tested by a sign test. *p&lt;0.05, **p&lt;0.01, ***p&lt;0.001.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-58809-fig2-figsupp3-v2.tif"/></fig><fig id="fig2s4" position="float" specific-use="child-fig"><label>Figure 2âfigure supplement 4.</label><caption><title>Neural representations of CPP and RU from the approximately ideal observer, which is the reduced Bayesian model with true hazard rate and noise, for direct comparison to analyses in <xref ref-type="bibr" rid="bib33">McGuire et al., 2014</xref>, which used covariates constructed from the ideal rather than the fitted model.</title><p>(<bold>A</bold>) Neural representation of CPP and RU in the current study and in <xref ref-type="bibr" rid="bib33">McGuire et al., 2014</xref>. CPP selective effect represents the conjunction of CPPÂ &gt;Â 0 and CPPÂ &gt;Â RU. RU selective effect represents the conjunction of RUÂ &gt;Â 0 and RUÂ &gt;Â CPP. The results were thresholded based on uncorrected voxel p&lt;0.01 (<italic>t</italic>Â =Â 2.6). (<bold>B</bold>) ROI analysis for CPP and RU. These ROIs were selected based on the common regions of CPP, RU and reward effects in <xref ref-type="bibr" rid="bib33">McGuire et al., 2014</xref>. Significance was tested by a sign test. *p&lt;0.05, **p&lt;0.01, ***p&lt;0.001.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-58809-fig2-figsupp4-v2.tif"/></fig></fig-group><p>We accounted for these behavioral patterns with a reduced Bayesian model that is similar to ones we have used previously to model belief updating in a dynamic environment (open symbols in <xref ref-type="fig" rid="fig2">Figure 2</xref>; <xref ref-type="table" rid="table1">Tables 1</xref> and <xref ref-type="table" rid="table2">2</xref>). This model provides a framework to interpret and use errors differently according to the current task conditions, as defined by hazard rate and noise level. The decision-makerâs trial-by-trial updates are governed by ongoing estimates of the probability that the best target changed (change-point probability, or CPP) and reducible uncertainty about the best targetâs location (relative uncertainty, or RU). Both quantities are influenced by the two free parameters in the model, subjective estimates of the task hazard rate and noise level, which were fitted separately in each condition for each participant. As expected, the fitted hazard rates were higher in the unstable condition than in the noisy condition, although both tended to be higher than the objective values, as we have observed previously (<xref ref-type="bibr" rid="bib36">Nassar et al., 2010</xref>). However, the fitted noise estimates were not reliably different between the noisy and unstable conditions (<xref ref-type="table" rid="table2">Table 2</xref>). As we observed in our previous study (<xref ref-type="bibr" rid="bib32">Li et al., 2019</xref>), the subjective estimates of noise level were high in the unstable condition despite the objective absence of noise.</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>BIC of behavior models.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Model</th><th>Condition</th><th>BIC improvement by RB model</th></tr></thead><tbody><tr><td rowspan="2">Reduced Bayesian model (RB)</td><td>Unstable</td><td/></tr><tr><td>Noisy</td><td/></tr><tr><td rowspan="2">Fixed learning rate model (fixedLR)</td><td>Unstable</td><td>5.06 [3.63, 5.71]**</td></tr><tr><td>Noisy</td><td>â21.05 [-76.63, 0.20]<sup>â </sup></td></tr><tr><td rowspan="2">RB + fixedLR</td><td>Unstable</td><td>â9.83 [-11.20,â8.07]***</td></tr><tr><td>Noisy</td><td>â4.64 [-10.51, 0.89]</td></tr><tr><td rowspan="2">RB + P<sub>stay</sub></td><td>Unstable</td><td>â5.20 [-5.65,â3.68]**</td></tr><tr><td>Noisy</td><td>â5.55 [-5.65,â2.67]*</td></tr></tbody></table><table-wrap-foot><fn><p>Values are shown as median [IQR]. A negative value means that the RB model performed better than the alternative model. Significance was tested by a sign test. <sup>â </sup>p&lt;0.08, **p&lt;0.01, ***p&lt;0.001.</p></fn></table-wrap-foot></table-wrap><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>Parameters of behavior models.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Model</th><th>Parameter</th><th>Unstable</th><th>Noisy</th><th>UnstableÂ &gt;Â Noisy</th></tr></thead><tbody><tr><td rowspan="2">RB</td><td>H</td><td>0.82 [0.64, 0.90]</td><td>0.33 [0.11, 0.50]</td><td>0.37 [0.24, 0.62]***</td></tr><tr><td>K</td><td>0.59 [0.03, 2.22]</td><td>1.86 [1.22, 2.32]</td><td>â0.23 [-1.97, 0.71]</td></tr><tr><td>fixedLR</td><td><inline-formula><mml:math id="inf1"><mml:msub><mml:mrow><mml:mi>Î±</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td>0.96 [0.86, 0.97]</td><td>0.63 [0.37, 0.73]</td><td>0.33 [0.19, 0.49]***</td></tr><tr><td rowspan="4">RB + fixedLR</td><td>H</td><td>0.07 [0.00, 0.86]</td><td>0.03 [0.00, 0.19]</td><td>0.03 [-0.03, 0.77]</td></tr><tr><td>K</td><td>11.19 [2.78, 18.01]</td><td>3.22 [2.28, 9.90]</td><td>5.13 [-4.91, 16.10]</td></tr><tr><td><inline-formula><mml:math id="inf2"><mml:msub><mml:mrow><mml:mi>Î±</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td>0.96 [0.75, 1.00]</td><td>0.88 [0.23, 1.00]</td><td>0.02 [-0.12, 0.52]</td></tr><tr><td>w</td><td>0.38 [0.16, 0.81]</td><td>0.71 [0.52, 0.87]</td><td>â0.28 [-0.57, 0.22]</td></tr><tr><td rowspan="3">RB + P<sub>stay</sub></td><td>H</td><td>0.73 [0.64, 0.88]</td><td>0.31 [0.06, 0.53]</td><td>0.27 [0.15, 0.66]**</td></tr><tr><td>K</td><td>8.42 [0.73, 30.42]</td><td>2.19 [1.62, 9.09]</td><td>2.71 [-2.60, 23.94]</td></tr><tr><td><inline-formula><mml:math id="inf3"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td>0.01 [0.00, 0.05]</td><td>0.01 [0.00, 0.13]</td><td>0.00 [-0.11, 0.03]</td></tr></tbody></table><table-wrap-foot><fn><p>Parameter values are shown as median [IQR]. Difference of parameter values between the two conditions was tested by a sign test. **p&lt;0.01, ***p&lt;0.001.</p></fn></table-wrap-foot></table-wrap><p>We also tested several alternative models but they did not provide as parsimonious descriptions of the data (<xref ref-type="fig" rid="fig2s2">Figure 2âfigure supplement 2</xref>, and <xref ref-type="table" rid="table1">Tables 1</xref> and <xref ref-type="table" rid="table2">2</xref>). Notably, an alternative model that assumed a condition-specific fixed learning rate also assumed errors were treated differently in the two conditions but did not include trial-by-trial adjustments of learning rates used by the reduced Bayesian model. Although this model performed better than the reduced Bayesian model in the unstable condition, it cannot capture participantsâ behaviors in the noisy condition, where dynamically integrating both current and past errors is required for adapting trial-by-trial behavior. Other hybrid models performed worse than the reduced Bayesian model in both conditions.</p></sec><sec id="s2-2"><title>Neural representation of CPP and RU</title><p>The two key internal quantities in the reduced Bayesian model are CPP and RU, both of which contribute to processing errors in a task-dependent manner (<xref ref-type="fig" rid="fig2s3">Figure 2âfigure supplement 3</xref>). CPP increases as the current error magnitude increases and achieves large values more quickly in the unstable condition because of the higher hazard rate. These dynamics lead to a greater probability of switching targets after smaller errors in the unstable condition. RU increases on the next trial after the participant makes an error and does so more strongly in the noisy condition because of the lower hazard rate. These dynamics lead to a greater probability of target switches when the last trial was an error, which is most prominent for small errors in the noisy condition. Thus, CPP and RU each account for one of the two key signatures of task-dependent learning that we identified in participantsâ behavior, with CPP driving a task-dependent influence of error magnitude and RU driving a task-dependent influence of error history on target switches.</p><p>Though not the main focus of this study, we were able to replicate our previous findings regarding the neural representations of CPP and RU (<xref ref-type="bibr" rid="bib33">McGuire et al., 2014</xref>). Similar to our previous study, we found activity that was positively correlated with the levels of CPP and RU across DLPFC and PPC (<xref ref-type="fig" rid="fig2s3">Figure 2âfigure supplements 3</xref> and <xref ref-type="fig" rid="fig2s4">4</xref>). The regions of DLPFC and PPC that were responsive to both CPP and RU were a subset of those identified as showing this conjunction in our previous study. Because CPP and RU both contribute to responding to errors in a task-dependent manner, the brain regions that responded to both variables are good candidates for encoding errors in a task-dependent manner. In the following analyses, we aimed to directly identify task-dependent neural representations of error magnitude and error history, as well as activity that predicts subsequent shifts in behavior.</p></sec><sec id="s2-3"><title>Task-dependent neural representation of errors</title><p>We used multi-voxel pattern analysis (MVPA) to identify error-related neural signals that were similar and different for the two task conditions. Given the two key signatures of flexible learning that we identified in behavior, we were especially interested in identifying neural representations of error magnitude and past errors that were stronger in the noisy than the unstable condition.</p><p>We found robust, task-dependent representations of the magnitude of the error on the current trial in PPC. Consistent with the task-dependent behavioral effects, this representation of error magnitude was stronger in the noisy than the unstable condition (<xref ref-type="fig" rid="fig3">Figure 3</xref> and <xref ref-type="table" rid="table3">Table 3</xref>). Specifically, we could classify correct versus error feedback on the current trial across almost the entire cortex, in both the unstable and noisy conditions. However, for error trials, we could classify error magnitude (in three bins: 1, 2, 3+ targets away from the rewarded target) only for the noisy condition and most strongly in the lateral and medial parietal cortex and in the occipital pole. In a parallel set of analyses, we found that univariate activity in PPC also varied in a task-dependent way, responding more strongly to error magnitude in the noisy than the unstable condition (<xref ref-type="fig" rid="fig3s1">Figure 3âfigure supplement 1</xref>).</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Representations of error and error magnitude.</title><p>For error versus correct analyses, multi-voxel neural patterns were used to classify whether the response on the current trial was correct or an error. For error magnitude analyses, multi-voxel neural patterns were used to classify different error magnitudes (1, 2, 3+) conditional on the current trial being an error. Accuracies were calculated and compared with the baseline accuracy within each subject and then tested at the group level. The representation of current error magnitude is stronger in parietal cortex in the noisy condition than the unstable condition. The cluster-forming threshold was an uncorrected voxel p&lt;0.01 (<italic>t</italic>Â =Â 2.6), with cluster mass corrected for multiple comparisons using non-parametric permutation tests.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-58809-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3âfigure supplement 1.</label><caption><title>Univariate representations of error and error magnitude.</title><p>A GLM was implemented on the preprocessed fMRI data (smoothed with 6 mm FWHM Gaussian kernel). The trial-by-trial regressors of interest that were included in the GLM were: onset of correct trials, earnable value on correct trials, onset of error trials, error magnitude on error trials, switch or stay on error trials and earnable value on error trials. We focused on the effects of error (which is the difference between the onset of error trials and the onset of correct trials) and error magnitude. Group <italic>t</italic>-values are shown. For statistical testing, we implemented one-sample cluster-mass permutation tests with 5000 iterations. The cluster-forming threshold was uncorrected voxel p&lt;0.01 (<italic>t</italic>Â =Â 2.6).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-58809-fig3-figsupp1-v2.tif"/></fig></fig-group><table-wrap id="table3" position="float"><label>Table 3.</label><caption><title>Summary of fMRI results: error magnitude and past error.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Cluster index</th><th>#Voxels</th><th>Region</th><th>Peak <italic>t</italic></th><th>Peak <italic>x</italic></th><th>Peak <italic>y</italic></th><th>Peak <italic>z</italic></th></tr></thead><tbody><tr><td colspan="7">Error magnitude: noisy versus unstable</td></tr><tr><td>1</td><td>21032</td><td>R precuneus</td><td>5.22</td><td>16</td><td>â56</td><td>12</td></tr><tr><td/><td/><td>R angular gyrus</td><td>5.17</td><td>44</td><td>â70</td><td>32</td></tr><tr><td/><td/><td>L precuneus</td><td>5.08</td><td>â18</td><td>â58</td><td>20</td></tr><tr><td/><td/><td>Occipital pole</td><td>5.07</td><td>2</td><td>â98</td><td>-2</td></tr><tr><td/><td/><td>L superior parietal lobule</td><td>4.91</td><td>â10</td><td>â66</td><td>48</td></tr><tr><td/><td/><td>R occipital cortex</td><td>4.69</td><td>26</td><td>â76</td><td>18</td></tr><tr><td/><td/><td>L occipital cortex</td><td>4.54</td><td>â38</td><td>â86</td><td>26</td></tr><tr><td/><td/><td>R superior parietal lobule</td><td>4.44</td><td>44</td><td>â44</td><td>54</td></tr><tr><td/><td/><td>Posterior cingulate cortex</td><td>4.43</td><td>2</td><td>â46</td><td>20</td></tr><tr><td colspan="7">Past error on current error magnitude of 1 or 2: noisy versus unstable</td></tr><tr><td>1</td><td>1881</td><td>Posterior cingulate cortex</td><td>4.79</td><td>12</td><td>â24</td><td>52</td></tr><tr><td/><td/><td>R Superior parietal lobule</td><td>4.04</td><td>32</td><td>â38</td><td>54</td></tr><tr><td/><td/><td>R Precuneus</td><td>3.58</td><td>6</td><td>â54</td><td>70</td></tr><tr><td/><td/><td>L superior parietal lobule</td><td>3.54</td><td>â16</td><td>â54</td><td>62</td></tr><tr><td colspan="7">Conjunction: Error magnitude and Past error on current error magnitude of 1 or 2</td></tr><tr><td>1</td><td>304</td><td>R superior parietal lobule</td><td>3.41</td><td>38</td><td>â40</td><td>52</td></tr><tr><td>2</td><td>103</td><td>R Precuneus</td><td>3.02</td><td>2</td><td>â58</td><td>70</td></tr><tr><td>3</td><td>81</td><td>L superior parietal lobule</td><td>3.23</td><td>â18</td><td>â56</td><td>72</td></tr></tbody></table></table-wrap><p>We also found robust, task-dependent representations of past errors in PPC. These representations also were stronger in the noisy than the unstable condition, particularly on trials for which past errors had the strongest influence on behavior. Specifically, we could classify correct versus error on the previous trial in PPC for both task conditions (<xref ref-type="fig" rid="fig4">Figure 4</xref>). This classification of past errors depended on the outcome of the current trial. We separated trials according to whether the current feedback was correct or an error, or whether the error magnitude provided ambiguous (error magnitudes of 1 or 2) or unambiguous (error magnitudes of 0 or 3+) feedback in the noisy condition (<xref ref-type="fig" rid="fig4">Figure 4</xref>). We found reliable classifications of past errors in the lateral and medial parietal cortex in both conditions for correct trials and trials with error magnitudes of 0 or 3+. Moreover, these representations depended on the current condition, and, consistent with behavioral effects of error history, were stronger for error trials and trials with error magnitudes of 1 or two in the noisy than in the unstable condition (<xref ref-type="table" rid="table3">Table 3</xref>). These task-dependent signals for past errors were not clearly present in univariate activity (<xref ref-type="fig" rid="fig4s1">Figure 4âfigure supplement 1</xref>). An additional conjunction analysis across MVPA results showed that PPC uniquely encoded task-dependent error signals for both error magnitude of the current trials and past errors when the current trialâs error magnitude was 1 or 2 (<xref ref-type="table" rid="table3">Table 3</xref>).</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Representations of errors on the previous trial conditional on different types of current trials (columns).</title><p>Multi-voxel neural patterns were used to classify correct responses versus errors on the previous trial. This analysis was repeated for different types of current trials: all feedback, correct feedback, error feedback, error magnitude of 0 or 3+, and error magnitude of 1 or 2. The representation of past errors is stronger in parietal cortex in the noisy condition than the unstable condition when the current trial is an error or the current error magnitude is 1 or 2. The cluster-forming threshold was an uncorrected voxel p&lt;0.01 (<italic>t</italic>Â =Â 2.6), with cluster mass corrected for multiple comparisons using non-parametric permutation tests.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-58809-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4âfigure supplement 1.</label><caption><title>Univariate representations of error on the previous trial conditional on different types of current trials (columns).</title><p>Several GLMs were implemented on the preprocessed fMRI data (smoothed with 6 mm FWHM Gaussian kernel). First, we examined errors on the previous trial across all trials. The trial-by-trial regressors of interest that were included in the GLM were: onset of trials, error on trial t, error on trial t-1, error on trial t-2, and error on trial t-3. We focused on the effect of error on trial t-1. Second, we separated the analysis of past errors conditional on the current trial being correct or an error. The trial-by-trial regressors of interest that were included in the GLM were: onset of current correct trials, errors on trial t-1, t-2, or t-3 conditional on the current trial being correct, onset of current error trials, errors on trial t-1, t-2, or t-3 conditional on the current trial being an error. We focused on the effects of error on trial t-1 conditional on the current trial being correct or an error. Third, we separated errors conditional on error magnitudes of 0 or 3+ or error magnitudes of 1 or 2. The trial-by-trial regressors of interest that were included in the GLM were: onset of current trials with error magnitudes of 0 or 3+, errors on trial t-1, t-2 or t-3 conditional on the current trial error magnitude of 0 or 3+, onset of current trials with error magnitudes of 1 or 2, errors on trial t-1, t-2 or t-3 conditional on the current trial error magnitude of 1 or 2. We focused on the effects of errors on trial t-1 conditional on the current trials error magnitude of 0 or 3+ or error magnitude of 1 or 2. Group <italic>t</italic>-values are shown. For statistical testing, we implemented one-sample cluster-mass permutation tests with 5000 iterations. The cluster-forming threshold was uncorrected voxel p&lt;0.01 (<italic>t</italic>Â =Â 2.6).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-58809-fig4-figsupp1-v2.tif"/></fig></fig-group></sec><sec id="s2-4"><title>Neural prediction of subsequent changes in behavior</title><p>Although PPC responds to errors in a task-dependent manner that could be used for determining behavioral updates, we did not find that activity in this region was predictive of the participantsâ future behavior. Instead, we found such predictive activity more anteriorly in the frontal lobe. Specifically, we investigated whether multi-voxel neural patterns could predict participantsâ target switches on the subsequent trial. We focused on the trials with small error magnitudes (1 or 2) in the noisy condition, because these were the only trial types that participants consistently exhibited an intermediate probability of switching (20â80%, <xref ref-type="fig" rid="fig2">Figure 2</xref>). We found that activity patterns in large cluster encompassing motor cortex, OFC, ACC, DMFC, and DLPFC could predict subsequent stay/switch decisions (<xref ref-type="fig" rid="fig5">Figure 5</xref>, <xref ref-type="table" rid="table4">Table 4</xref>). We also evaluated this result with different approaches to cluster formation that were more or less spatially specific (<xref ref-type="fig" rid="fig5s1">Figure 5âfigure supplement 1</xref>). We did not find any regions where univariate activity reliably predicted participantsâ subsequent behavior (<xref ref-type="fig" rid="fig5s2">Figure 5âfigure supplement 2</xref>).</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Representations of subsequent behavioral choices (switch versus stay) after ambiguous small errors in the noisy condition.</title><p>(<bold>A</bold>) Overlap of results for switch versus stay on the next trial and error magnitude on the current trial. Multi-voxel neural patterns were used to classify whether participants switch their choice to another target or stay on the same target on the next trial. We focused on the most ambiguous errors (error magnitude of 1 or two in the noisy condition). Above-chance classification performance was found in a large cluster encompassing the frontal lobe. The cluster-forming threshold was an uncorrected voxel p&lt;0.01 (<italic>t</italic>Â =Â 2.6), with cluster mass corrected for multiple comparisons using non-parametric permutation tests. (<bold>B</bold>) Overlap of results for switch versus stay on the next trial and past error conditional on error magnitude of 1 or two on the current trial.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-58809-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5âfigure supplement 1.</label><caption><title>Representations of subsequent behavioral choices (switch versus stay) thresholded via threshold-free cluster enhancement (TFCE) or with a cluster-forming threshold of p&lt;0.001.</title><p>(<bold>A</bold>) Overlap of results for switch versus stay on the next trial and error magnitude on the current trial. We implemented two types of cluster-forming approaches: TFCE and uncorrected voxel p&lt;0.001. First, significance testing was implemented through permutation tests with threshold-free cluster enhancement (FSLâs randomize), which does not require a pre-defined cluster-forming threshold. The result of switch versus stay showed little spatial specificity. For the purpose of display, the results were thresholded based on uncorrected voxel p&lt;0.03 (<italic>t</italic>Â =Â 2). Second, we used a cluster-forming threshold of uncorrected voxel p&lt;0.001 (<italic>t</italic>Â =Â 3.73) and tested the significance of the formed cluster via one-sample cluster-mass permutation tests with 5000 iterations. The results showed high spatial specificity and several previously identified regions were still significant: middle cingulate cortex [14, -8, 30], right insula [38, 4, 2], medial OFC [â4, 50,â10], left premotor cortex [â62, 2, 24] and left superior temporal gyrus [â50,â32, 12]. (<bold>B</bold>) Overlap of results for switch versus stay on the next trial and past error conditional on error magnitude of 1 or 2 on the current trial. The two types of cluster-forming approaches are shown.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-58809-fig5-figsupp1-v2.tif"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><label>Figure 5âfigure supplement 2.</label><caption><title>Univariate GLM for switch versus stay on small error trials (magnitudes of 1 or 2) in the noisy condition.</title><p>A GLM was implemented with several trial-by-trial regressors of interest: onset of trials with error magnitude of 0, onset of trials with error magnitude of 3+, onset of trials with error magnitudes of 1 or two followed by switching, onset of trials with error magnitudes of 1 or two followed by staying. We tested the effects of the difference between switch and stay for small errors. For statistical testing, we implemented one-sample cluster-mass permutation tests with 5000 iterations. The cluster-forming threshold was uncorrected voxel p&lt;0.01 (<italic>t</italic>Â =Â 2.6). There were no significant clusters. For the demonstration, the results were shown with uncorrected voxel p&lt;0.01.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-58809-fig5-figsupp2-v2.tif"/></fig></fig-group><table-wrap id="table4" position="float"><label>Table 4.</label><caption><title>Summary of fMRI results: behavior change.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Cluster index</th><th>#Voxels</th><th>Region</th><th>Peak <italic>t</italic></th><th>Peak <italic>x</italic></th><th>Peak <italic>y</italic></th><th>Peak <italic>z</italic></th></tr></thead><tbody><tr><td colspan="7">Switch versus stay on error magnitude of 1 or two in the noisy condition</td></tr><tr><td>1</td><td>12042</td><td>Middle cingulate cortex</td><td>4.35</td><td>14</td><td>-8</td><td>30</td></tr><tr><td/><td/><td>R insula</td><td>4.33</td><td>38</td><td>4</td><td>2</td></tr><tr><td/><td/><td>Medial orbitofrontal cortex</td><td>4.24</td><td>-4</td><td>50</td><td>â10</td></tr><tr><td/><td/><td>R frontal pole</td><td>4.11</td><td>40</td><td>46</td><td>0</td></tr><tr><td/><td/><td>R inferior frontal gyrus</td><td>4.11</td><td>48</td><td>26</td><td>10</td></tr><tr><td/><td/><td>L frontal pole</td><td>4.01</td><td>â24</td><td>52</td><td>-2</td></tr><tr><td/><td/><td>Dorsomedial frontal cortex</td><td>3.96</td><td>0</td><td>26</td><td>34</td></tr><tr><td/><td/><td>Posterior cingulate cortex</td><td>3.93</td><td>2</td><td>â28</td><td>50</td></tr><tr><td/><td/><td>R primary motor cortex</td><td>3.91</td><td>48</td><td>-6</td><td>50</td></tr><tr><td/><td/><td>Anterior cingulate cortex</td><td>3.51</td><td>0</td><td>48</td><td>20</td></tr><tr><td>2</td><td>3134</td><td>L premotor cortex</td><td>4.43</td><td>â62</td><td>2</td><td>24</td></tr><tr><td/><td/><td>L superior temporal gyrus</td><td>4.28</td><td>â50</td><td>â32</td><td>12</td></tr><tr><td/><td/><td>L inferior frontal junction</td><td>3.72</td><td>â38</td><td>4</td><td>28</td></tr><tr><td/><td/><td>L postcentral gyrus</td><td>3.61</td><td>â50</td><td>â26</td><td>44</td></tr></tbody></table></table-wrap></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We identified task-dependent neural representations of errors in humans performing dynamic learning tasks. Participants were required to learn in two different dynamic environments. In the unstable condition (high-hazard rate and low noise), errors unambiguously indicated a change in the state of the environment, and participants reliably updated their behavior in response to errors. In contrast, in the noisy condition (low-hazard rate and high noise), small errors were ambiguous, and participants used both the current error magnitude and recent error history to distinguish between those errors that likely signal change-points and those likely arising from environmental noise. Using MVPA, we showed complementary roles of PPC and prefrontal regions (including motor cortex, OFC, ACC, DMFC and DLPFC) in the outcome-monitoring and action-selection processes underlying these flexible, task-dependent behavioral responses to errors. Neural patterns in PPC encoded the magnitude of errors and past errors, more strongly in the noisy than the unstable condition. These task-dependent neural responses to errors in PPC were not reliably linked to subsequent changes in behavior. In contrast, neural patterns in prefrontal regions could predict subsequent changes in behavior (whether participants switch their choice on the next trial or not) in response to ambiguous errors in the noisy condition.</p><sec id="s3-1"><title>Task-dependent behavior adaptation</title><p>Consistent with previous studies of ours and others (<xref ref-type="bibr" rid="bib9">d'Acremont and Bossaerts, 2016</xref>; <xref ref-type="bibr" rid="bib33">McGuire et al., 2014</xref>; <xref ref-type="bibr" rid="bib38">Nassar et al., 2019a</xref>; <xref ref-type="bibr" rid="bib37">Nassar et al., 2012</xref>; <xref ref-type="bibr" rid="bib36">Nassar et al., 2010</xref>; <xref ref-type="bibr" rid="bib40">O'Reilly et al., 2013</xref>; <xref ref-type="bibr" rid="bib42">Purcell and Kiani, 2016</xref>), human participants adapted their response to errors differently in different environments. In the unstable condition, participants almost always switched their choice after errors and quickly learned the new state after change-points. In contrast, in the noisy condition, participants ignored many errors and only slowly learned the new state after change-points. In this condition, participants had to distinguish true change-points from environmental noise, and they used error magnitude and recent error history as a cue for whether the state had recently changed or not. These flexible and task-dependent responses to errors could be accounted for by a reduced Bayesian model (<xref ref-type="bibr" rid="bib33">McGuire et al., 2014</xref>; <xref ref-type="bibr" rid="bib37">Nassar et al., 2012</xref>; <xref ref-type="bibr" rid="bib36">Nassar et al., 2010</xref>). This model assumes that participants use approximately optimal inference processes but can have subjective estimates of environmental parameters (hazard rate, noise) that depart from their true values.</p></sec><sec id="s3-2"><title>Neural representation of change-point probability and relative uncertainty</title><p>In the reduced Bayesian model, beliefs and behavior are updated dynamically according to two key internal quantities, CPP and RU. Replicating our previous work (<xref ref-type="bibr" rid="bib33">McGuire et al., 2014</xref>), we identified neural activity correlated with both CPP and RU in PPC and DLPFC. This replication shows the robustness of these neural representations of CPP and RU across experimental designs that differ dramatically in their visual stimuli and motor demands, yet share the need to learn in dynamic environments with similar statistics. We extended those findings to show that some brain regions that encode both CPP, which in the model accounts for task-dependent behavioral responses to error magnitude, and RU, which in the model accounts for task-dependent behavioral responses to recent error history, also encode errors in a task-dependent manner or predict subsequent behavioral updates.</p></sec><sec id="s3-3"><title>Task-dependent neural representation of errors</title><p>Advancing beyond previous work, we identified task-dependent encoding of errors in neural activity in the PPC. Mirroring the task dependence of behavior, the multivariate neural pattern in PPC encoded current error magnitude more strongly in the noisy condition than in the unstable condition and encoded past errors more strongly on trials that provided ambiguous feedback in the noisy condition. These same regions of PPC have been shown previously to represent errors, error magnitudes, surprise and salience (<xref ref-type="bibr" rid="bib13">Fischer and Ullsperger, 2013</xref>; <xref ref-type="bibr" rid="bib16">GlÃ¤scher et al., 2010</xref>; <xref ref-type="bibr" rid="bib33">McGuire et al., 2014</xref>; <xref ref-type="bibr" rid="bib38">Nassar et al., 2019a</xref>; <xref ref-type="bibr" rid="bib39">Nassar et al., 2019b</xref>; <xref ref-type="bibr" rid="bib40">O'Reilly et al., 2013</xref>; <xref ref-type="bibr" rid="bib41">Payzan-LeNestour et al., 2013</xref>). In addition, these regions have been shown to integrate recent outcome or stimulus history in human fMRI studies (<xref ref-type="bibr" rid="bib14">FitzGerald et al., 2015</xref>; <xref ref-type="bibr" rid="bib15">Furl and Averbeck, 2011</xref>) and in animal single neuron recording studies (<xref ref-type="bibr" rid="bib1">Akrami et al., 2018</xref>; <xref ref-type="bibr" rid="bib6">Brody and Hanks, 2016</xref>; <xref ref-type="bibr" rid="bib21">Hanks et al., 2015</xref>; <xref ref-type="bibr" rid="bib22">Hayden et al., 2008</xref>; <xref ref-type="bibr" rid="bib24">Hwang et al., 2017</xref>). Our results extend on these past findings by demonstrating that the neural encoding of error magnitude and error history in PPC is modulated across different conditions in precisely the manner that could drive adaptive behavior.</p><p>These whole-brain fMRI results complement our previous results recording from single neurons in ACC and PCC in the same task (<xref ref-type="bibr" rid="bib32">Li et al., 2019</xref>). In that study, we identified single neurons in both ACC and PCC that encoded information relevant to interpreting errors, such as the magnitude of the error or the current condition. However, we did not find any neurons that combined this information in a manner that could drive adaptive behavioral adjustments. Our whole-brain fMRI results suggest that PPC would be a good place to look for task-dependent error representations in single neurons, including a region of medial parietal cortex slightly dorsal to the PCC area we recorded from previously.</p></sec><sec id="s3-4"><title>Neural representations of behavioral updating</title><p>Also advancing beyond previous work, we identified neural activity predictive of behavioral updates across the frontal cortex, including DLPFC. In the noisy condition, small errors provided ambiguous feedback that could reflect either a change in state or environmental noise. Accordingly, after small errors in the noisy condition, participants exhibited variability across trials in whether they switched from their current choice on the subsequent trial or not. In these ambiguous situations, the multivariate neural pattern in large cluster in frontal cortex, including motor cortex, OFC, ACC, DMFC and DLPFC, predicted whether people switched or stayed on the subsequent trial. These results extend previous findings that the multivariate pattern in frontal cortex, particularly ACC and medial PFC, can decode subsequent switching versus staying in a reversal learning task (<xref ref-type="bibr" rid="bib20">Hampton and O'doherty, 2007</xref>). These results suggest a dissociation between PPC regions that monitor error information in a task-dependent manner and frontal regions that may use this information to update beliefs and select subsequent actions.</p><p>This ability to decode subsequent choices might arise from different kinds of representations in different areas of frontal cortex. Whereas motor and premotor regions may reflect the change in action plans, other frontal regions might reflect changes in abstract representations of belief states. Medial PFC is involved in performance monitoring, distinguishing errors from different sources such as actions and feedback (<xref ref-type="bibr" rid="bib46">Ullsperger et al., 2014</xref>), registering a hierarchy of prediction errors from those due to environmental noise to those due to a change in the environmental state (<xref ref-type="bibr" rid="bib2">Alexander and Brown, 2015</xref>), and interacting with lateral PFC to guide subsequent behavioral adjustments in response to errors (<xref ref-type="bibr" rid="bib2">Alexander and Brown, 2015</xref>). Consistent with this role, activity in DMFC also reflects the extent of belief updating in dynamic environments (<xref ref-type="bibr" rid="bib3">Behrens et al., 2007</xref>; <xref ref-type="bibr" rid="bib19">Hampton et al., 2006</xref>; <xref ref-type="bibr" rid="bib33">McGuire et al., 2014</xref>; <xref ref-type="bibr" rid="bib40">O'Reilly et al., 2013</xref>). OFC and DMFC encode the identity of the current latent state in a mental model of the task environment and neural representations in these regions changes as the state changes (<xref ref-type="bibr" rid="bib7">Chan et al., 2016</xref>; <xref ref-type="bibr" rid="bib23">Hunt et al., 2018</xref>; <xref ref-type="bibr" rid="bib28">Karlsson et al., 2012</xref>; <xref ref-type="bibr" rid="bib39">Nassar et al., 2019b</xref>; <xref ref-type="bibr" rid="bib43">Schuck et al., 2016</xref>; <xref ref-type="bibr" rid="bib47">Wilson et al., 2014</xref>). Activity in inferior frontal junction reflects the updating of task representations (<xref ref-type="bibr" rid="bib5">Brass and von Cramon, 2004</xref>; <xref ref-type="bibr" rid="bib11">Derrfuss et al., 2005</xref>). Neural activity in frontopolar cortex (<xref ref-type="bibr" rid="bib10">Daw et al., 2006</xref>) and DMFC (<xref ref-type="bibr" rid="bib4">Blanchard and Gershman, 2018</xref>; <xref ref-type="bibr" rid="bib29">Kolling et al., 2012</xref>; <xref ref-type="bibr" rid="bib30">Kolling et al., 2016</xref>; <xref ref-type="bibr" rid="bib34">Muller et al., 2019</xref>) increases during exploratory choices, which occur more frequently during periods of uncertainty about the most beneficial option. In a recent study, we identified distinct representations of latent states, uncertainty, and behavioral policy in distinct areas of frontal cortex during learning in a dynamic environment (<xref ref-type="bibr" rid="bib39">Nassar et al., 2019b</xref>). Our results extend these past findings and demonstrate the role of these frontal regions in adjusting behavior in response to ambiguous errors.</p></sec><sec id="s3-5"><title>Caveats</title><p>A few caveats should be considered when interpreting our results. First, we had relatively small number of participants in this study (nÂ =Â 16). Although we control the false-positive rates through permutation tests that have been validated empirically (<xref ref-type="bibr" rid="bib12">Eklund et al., 2016</xref>), it is possible that we lacked the statistical power to detect some effects, and so null results should be interpreted with caution. Second, in this study, we created two qualitatively different task conditions by manipulating both the noise levels and hazard rates. Thus, we cannot attribute any behavioral or neural differences across conditions specifically to changes in either noise levels or hazard rates alone, but rather to how the combinations of these two variables affect the interpretation and use of small errors. Future studies can manipulate hazard rate and noise independently to examine their independent contributions to adaptive learning.</p></sec><sec id="s3-6"><title>Conclusion</title><p>People adapt their behavior in response to errors in a task-dependent manner, distinguishing between errors that indicate change-points in the environment versus noise. Here we used MVPA to identify two distinct kinds of neural signals contributing to these adaptive behavioral adjustments. In PPC, neural patterns encoded error information in a task-dependent manner, depending on error magnitude and past errors only under conditions where these were informative of the source of error. In contrast, activity in frontal cortex could predict subsequent choices that could be based on this information. These findings suggest a broad distinction between outcome monitoring in parietal regions and action selection in frontal regions when learning in dynamic and uncertain environments.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Participants</title><p>All procedures were approved by University of Pennsylvania Internal Review Board. We analyzed data from sixteen participants (nine females, seven males, mean ageÂ =Â 23.5, SDÂ =Â 4.3, rangeÂ =Â 18â33 years) recruited for the current study. One additional participant was excluded from analyses because of large head movements during MRI scanning (&gt;10% of timepoint-to-timepoint displacements wereÂ &gt;0.5 mm). All participants provided informed consent before the experiment. Participants received a participation fee of $15, as well as extra incentives based on their performance (mean = $15.09, SD = $2.26, range = $8.5â17.5).</p></sec><sec id="s4-2"><title>Task</title><p>Participants performed a predictive-inference task during MRI scanning. On each trial, participants saw a noisy observation sampled from an unobserved state. The participantsâ goal was to predict the location of the noisy observation. To perform this task well, however, they should infer the location of the current state.</p><p>In this task (<xref ref-type="bibr" rid="bib32">Li et al., 2019</xref>), there were 10 targets aligned in a circle on the screen (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). At the start of each trial, participants had to fixate a central cross for 0.5 s to initialize the trial. After the cross disappeared, participants could choose one of 10 targets (red) by looking at it within 1.5 s and keeping fixation on the chosen target for 0.3 s. Then, an outcome would be shown for 1 s. During the outcome phase, a green dot indicated the chosen target. A purple or cyan target indicated the rewarded target, with color denoting 10 or 20 points of reward value, respectively. At the end of experiment, every 75 points were converted to $0.25 as participantsâ extra incentives.</p><p>Participants performed this task in two dynamic conditions separated into two different runs: a high-noise/low-hazard (ânoisyâ) condition and an low-noise/high-hazard (âunstableâ) condition. In the noisy condition, the rewarded target could be one of five targets, given the underlying state (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). The rewarded target probabilities for the relative locations ([â2,â1, 0, 1, 2]) of the current state were [0.05, 0.15, 0.6, 0.15, 0.05]. Thus, the location of the current state was most likely rewarded, but nearby targets could also be rewarded. Occasionally, the state would change its location with a hazard rate of 0.02 (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). When a change-point happens, the new state would be selected among the ten targets based on a uniform distribution. In the unstable condition, there was no noise (<xref ref-type="fig" rid="fig1">Figure 1D</xref>). That is, the location of the state would be always rewarded. However, the state was unstable, as the hazard rate in this condition was 0.35 (<xref ref-type="fig" rid="fig1">Figure 1E</xref>). There were 300 trials in each run.</p></sec><sec id="s4-3"><title>Behavior analysis</title><p>We investigated how participants used error feedback flexibly across different conditions. Before the behavioral analysis, we removed two different kinds of trials. First, we removed trials in which participants did not make a choice within the time limit (Unstable: median number of trialsÂ =Â 10.5, rangeÂ =Â 1â83; Noisy: medianÂ =Â 10, rangeÂ =Â 2â88). Second, we also removed trials in which the location of the chosen target was not on the shortest distance between the previously chosen and previously rewarded targets (Unstable: medianÂ =Â 3, rangeÂ =Â 0â24; Noisy: medianÂ =Â 17, rangeÂ =Â 5â37). All of the belief-updating models we tested predict that participantsâ choice should be along the shortest distance between the previously chosen target and the previously rewarded target. That is, participants should update in a clockwise direction, if the shortest distance to rewarded target was clockwise of the chosen target. Otherwise, they should update in a counterclockwise direction. We removed trials where participantsâ update was in the opposite direction of the rewarded target (which would correspond to a learning rateÂ &lt;0) and trials where participantsâ update was beyond the location of the rewarded target (which would correspond to a learning rateÂ &gt;1), as this behavior cannot be captured by any of the belief-updating models we tested. Further, this behavior might suggest that participants had lost track of the most recently chosen or rewarded targets. The analysis codes were written in MATLAB and are available at Github (<xref ref-type="bibr" rid="bib27">Kao, 2020</xref>; <ext-link ext-link-type="uri" xlink:href="https://github.com/changhaokao/mvpa_changepoint_fmri">https://github.com/changhaokao/mvpa_changepoint_fmri</ext-link>).</p><p>First, we investigated how fast participants learned the location of the current state. For each condition and participant, we binned trials from trial 0 to trial 20 after change-points. Then, we calculated the probability of choosing the location of the current state for each bin.</p><p>Second, we examined how different magnitudes of errors lead to shifts in behavior. For each condition and participant, we binned trials based on the current error magnitude (from 0 to 5). Then, for each bin, we calculated the probability that participants switch their choice to another target on the subsequent trial. We hypothesized participants would have a lower probability of switching after small error magnitudes (1 or 2) in the noisy condition than in the unstable condition since such errors could be due to environment noise in the noisy condition but would signal a state change in the unstable condition.</p><p>Third, we further investigated how error history influenced participantsâ behavioral shifts. Similarly, we binned trials based on the current error magnitude and the error history of the last three trials. Here, we used four bins of error magnitudes (0, 1, 2, 3+). Based on the outcome of correct or error on the last three trials, there were 8 types of error history. For each error magnitude, we calculated the probability of switching for each type of error history. We hypothesized that participants in the noisy condition would tend to switch their choice after small errors more if they had made more errors recently. To test this hypothesis, we ordered the 8 types of error history based on the number of recent errors and calculated the slope of probability of switching against the order of error history. A negative slope means that participants tend to switch as they receive more recent errors.</p></sec><sec id="s4-4"><title>Behavior modeling</title><p>We fit several different computational models to participantsâ choices to evaluate which ones could best account for their behavior in the task.</p></sec><sec id="s4-5"><title>Reduced Bayesian (RB) model</title><p>Previous studies have shown that a reduced Bayesian model, which approximates the full Bayesian ideal observer, could account well for participantsâ behavior in dynamic environments similar to the current task (<xref ref-type="bibr" rid="bib33">McGuire et al., 2014</xref>; <xref ref-type="bibr" rid="bib37">Nassar et al., 2012</xref>; <xref ref-type="bibr" rid="bib36">Nassar et al., 2010</xref>). In this model, belief is updated by a delta rule:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:msub><mml:mrow><mml:mi>Î´</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula><disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Î±</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>Î´</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula>where <inline-formula><mml:math id="inf4"><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the current belief and <inline-formula><mml:math id="inf5"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the current observation. The new belief (<inline-formula><mml:math id="inf6"><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>) is formed by updating the old belief according to the prediction error (<inline-formula><mml:math id="inf7"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) and a learning rate (<inline-formula><mml:math id="inf8"><mml:msub><mml:mrow><mml:mi>Î±</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>). The learning rate controls how much a participant revises their belief based on the prediction error. In this model, the learning rate is adjusted on a trial-by-trial basis according to:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:msub><mml:mrow><mml:mi>Î±</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Î©</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Î©</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula>where <inline-formula><mml:math id="inf9"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Î©</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the change-point probability and <inline-formula><mml:math id="inf10"><mml:msub><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the relative uncertainty. That is, <inline-formula><mml:math id="inf11"><mml:msub><mml:mrow><mml:mi>Î±</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is high as either <inline-formula><mml:math id="inf12"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Î©</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> or <inline-formula><mml:math id="inf13"><mml:msub><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is high. The change-point probability is the relative likelihood that the new observation represents a change-point as opposed to a sample from the currently inferred state (<xref ref-type="bibr" rid="bib36">Nassar et al., 2010</xref>):<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Î©</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>U</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo> <mml:mi/><mml:mn>10</mml:mn></mml:mrow></mml:mfenced><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>U</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo> <mml:mi/><mml:mn>10</mml:mn></mml:mrow></mml:mfenced><mml:mi>H</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Î³</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:math></disp-formula>where <inline-formula><mml:math id="inf14"><mml:mi>H</mml:mi></mml:math></inline-formula> is the hazard rate, <inline-formula><mml:math id="inf15"><mml:mi>U</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo> <mml:mi/><mml:mn>10</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula> is the probability of outcome derived from a uniform distribution, and <inline-formula><mml:math id="inf16"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>Î³</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> is the probability of outcome derived from the current predictive distribution. That is, <inline-formula><mml:math id="inf17"><mml:mi>U</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo> <mml:mi/><mml:mn>10</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula> reflects the probability of outcome when a change-point has occurred while <inline-formula><mml:math id="inf18"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>Î³</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> reflects the probability of outcome when the state has not changed.</p><p>The predictive distribution is an integration of the state distribution and the noise distribution:<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Î³</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mo>Ã</mml:mo><mml:msup><mml:mrow><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Î³</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>Ã</mml:mo> <mml:mi/><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></disp-formula>where <inline-formula><mml:math id="inf19"><mml:mi>X</mml:mi></mml:math></inline-formula> is a random variable determining the locations of target, <inline-formula><mml:math id="inf20"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> is the noise distribution in the current condition, <inline-formula><mml:math id="inf21"><mml:msup><mml:mrow><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Î³</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math></inline-formula> is the state distribution, <inline-formula><mml:math id="inf22"><mml:msub><mml:mrow><mml:mi>Î³</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the expected run length after the change-point, and <inline-formula><mml:math id="inf23"><mml:mi>C</mml:mi></mml:math></inline-formula> is a normalizing constant to make the sum of probabilities in the predictive distribution equal one. Thus, the uncertainty of this predictive distribution comes from two sources: the uncertainty of the state distribution (<inline-formula><mml:math id="inf24"><mml:msubsup><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula>) and the uncertainty of the noise distribution (<inline-formula><mml:math id="inf25"><mml:msubsup><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula>). The uncertainty of the state distribution would decrease as the expected run length increases.</p><p>The expected run length reflects the expected number of trials that a state remains stable, and thus is updated on each trial based on the change-point probability (<xref ref-type="bibr" rid="bib36">Nassar et al., 2010</xref>):<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:msub><mml:mrow><mml:mi>Î³</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Î³</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Î©</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Î©</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula>where the expected run length is a weighted average conditional on the change-point probability. If no change-point occurs (i.e. change-point probability is low), the expected run length would increase, leading the uncertainty of the state distribution to decrease. That is, as more observations from the current state are received, participants are more certain about the location of the current state. However, if the change-point probability is high, which signals a likely change in the state, the expected run length would be reset to 1. Thus, the uncertainty of the state distribution becomes large. Participants are more uncertain about the current state after a change-point.</p><p>The other factor influencing the learning rate is the relative uncertainty, which is the uncertainty regarding the current state relative to the irreducible uncertainty or noise (<xref ref-type="bibr" rid="bib33">McGuire et al., 2014</xref>; <xref ref-type="bibr" rid="bib37">Nassar et al., 2012</xref>):<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:msub><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Î©</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Î©</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msubsup><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Î©</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Î©</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>Î´</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Î©</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Î©</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msubsup><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Î©</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Î©</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>Î´</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p>The three terms in the numerator contribute to the uncertainty about the current state. The first term reflects the uncertainty conditional on the change-point distribution; the second term reflects the uncertainty conditional on the non-change-point distribution; and the third term reflects the uncertainty due to the difference between the two distributions. The denominator shows the total variance which is the summation of the uncertainty about the current state and the noise. As more precise observations are received in a given state, this relative uncertainty would decrease.</p><p>To fit the reduced Bayesian model to behavior, we assumed that participants can depart from the ideal observer by having subjective estimates of the key environmental variables, hazard rate and noise, that may differ from the true value of these variables. During model fitting, the subjective noise distribution was estimated with the von Mises distribution, which is a circular Gaussian distribution:<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">cos</mml:mi></mml:mrow><mml:mo>â¡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:munderover><mml:mo movablelimits="false">â</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">cos</mml:mi></mml:mrow><mml:mo>â¡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:math></disp-formula>where <inline-formula><mml:math id="inf26"><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the location of the current belief, <inline-formula><mml:math id="inf27"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the location of target, and <inline-formula><mml:math id="inf28"><mml:mi>K</mml:mi></mml:math></inline-formula> controls the uncertainty of this distribution. When <inline-formula><mml:math id="inf29"><mml:mi>K</mml:mi></mml:math></inline-formula> is 0, this is a uniform distribution. As <inline-formula><mml:math id="inf30"><mml:mi>K</mml:mi></mml:math></inline-formula> increases, the uncertainty decreases. The denominator is used as a normalization term to make sure the sum of all the probabilities equals one. Thus, there are two free parameters in this model: hazard rate (<italic>H,</italic> in <xref ref-type="disp-formula" rid="equ4">Equation 4</xref>) and noise level (<italic>K,</italic> in <xref ref-type="disp-formula" rid="equ8">Equation 8</xref>). The range of hazard rate is between 0 and 1 and the noise level is greater than or equal to zero.</p></sec><sec id="s4-6"><title>Fixed learning rate (fixedLR) model</title><p>We also consider an alternative model in which participants used a fixed learning rate in each of the two dynamic conditions. That is, the learning rate is the same over all trials in a condition. This model has one free parameter, the fixed learning rate (<inline-formula><mml:math id="inf31"><mml:msub><mml:mrow><mml:mi>Î±</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>), for each condition (<xref ref-type="disp-formula" rid="equ2">Equation 2</xref>). The fixed learning rate is between 0 and 1.</p></sec><sec id="s4-7"><title>Hybrid of RB model and fixedLR model</title><p>Furthermore, we consider a hybrid model, in which the learning rate on each trial is a mixture of the learning rates from the RB model and the fixedLR model:<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:msub><mml:mrow><mml:mi>Î±</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>w</mml:mi><mml:msub><mml:mrow><mml:mi>Î±</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>w</mml:mi><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>Î±</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula>where <inline-formula><mml:math id="inf32"><mml:msub><mml:mrow><mml:mi>Î±</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the learning rate from the RB model and is varied trial-by-trial according to <inline-formula><mml:math id="inf33"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Î©</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf34"><mml:msub><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf35"><mml:msub><mml:mrow><mml:mi>Î±</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the learning rate from the fixedLR model and <inline-formula><mml:math id="inf36"><mml:mi>w</mml:mi></mml:math></inline-formula> reflects the weight to integrate these two learning rates. In this model, there are four free parameters: hazard rate, noise level, fixed learning rate and weight. The weight is between 0 and 1.</p></sec><sec id="s4-8"><title>Hybrid of RB model and P<sub>stay</sub></title><p>Finally, we consider a hybrid model, which combines the RB model with a fixed tendency to stay on the current target regardless of the current observation. Such a fixed tendency to stay was observed in monkeys in our previous study (<xref ref-type="bibr" rid="bib32">Li et al., 2019</xref>). Here the belief is updated by:<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>[</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>Ã</mml:mo><mml:msub><mml:mrow><mml:mi>Î±</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo> <mml:mi/><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>Ã</mml:mo><mml:mn>0</mml:mn><mml:mo>]</mml:mo></mml:math></disp-formula>where <inline-formula><mml:math id="inf37"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the probability that participants stay on the current target. This model has three free parameters: hazard rate, noise level and the probability of stay. The probability of stay is between 0 and 1.</p></sec><sec id="s4-9"><title>Model fitting and comparison</title><p>Each model was fitted to data from each participant and within each condition separately. Optimal parameters were estimated by minimizing the mean of the squared error (MSE) between a participantâs prediction and the model prediction.<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:munderover><mml:mo movablelimits="false">â</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:math></disp-formula>where <italic>t</italic> is the trial, <italic>n</italic> is the total number of included trials, <inline-formula><mml:math id="inf38"><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is a participantâs prediction on trial <italic>t,</italic> and <inline-formula><mml:math id="inf39"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> is the model prediction on trial <italic>t</italic>.</p><p>Because each model used a different number of parameters and each participant had a different number of included trials, we used Bayesian Information Criterion (BIC) to compare the performance of different models:<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mi>B</mml:mi><mml:mi>I</mml:mi><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ln</mml:mi></mml:mrow><mml:mo>â¡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo></mml:mrow></mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ln</mml:mi></mml:mrow><mml:mo>â¡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf40"><mml:mi>n</mml:mi></mml:math></inline-formula> is the number of included trials and <inline-formula><mml:math id="inf41"><mml:mi>k</mml:mi></mml:math></inline-formula> is the number of free parameters in a model. A model with lower BIC performs better.</p></sec><sec id="s4-10"><title>MRI data acquisition and preprocessing</title><p>We acquired MRI data on a 3T Siemens Prisma with a 64-channel head coil. Before the task, we acquired a T1-weighted MPRAGE structural image (0.9375 Ã 0.9375Â ÃÂ 1 mm voxels, 192 Ã 256 matrix, 160 axial slices, TIÂ =Â 1,100 ms, TRÂ =Â 1,810 ms, TEÂ =Â 3.45 ms, flip angleÂ =Â 9Â°). During each run of the task, we acquired functional data using a multiband gradient echo-planar imaging (EPI) sequence (1.9592 Ã 1.9592Â ÃÂ 2 mm voxels, 98 Ã 98 matrix, 72 axial slices tilted 30Â° from the AC-PC plane, TRÂ =Â 1,500 ms, TEÂ =Â 30 ms, flip angleÂ =Â 45Â°, multiband factorÂ =Â 4). The scanning time (meanÂ =Â 24.14 min, SDÂ =Â 1.47, rangeÂ =Â 21.85â30.00) for each run was dependent on the participantsâ pace. After the task, fieldmap images (TRÂ =Â 1,270 ms, TEÂ =Â 5 ms and 7.46 ms, flip angleÂ =Â 60Â°) were acquired.</p><p>Data were preprocessed using FMRIBâs Software Library (FSL) (<xref ref-type="bibr" rid="bib26">Jenkinson et al., 2012</xref>; <xref ref-type="bibr" rid="bib44">Smith et al., 2004</xref>). Functional data were motion corrected using MCFLIRT (<xref ref-type="bibr" rid="bib25">Jenkinson et al., 2002</xref>), high-pass filtered with a Gaussian-weighted least square straight line fitting of <inline-formula><mml:math id="inf42"><mml:mi>Ï</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn> <mml:mi/><mml:mi>s</mml:mi></mml:math></inline-formula>, undistorted and warped to MNI space. To map the data to MNI space, boundary-based registration was applied to align the functional data to the structural image (<xref ref-type="bibr" rid="bib18">Greve and Fischl, 2009</xref>) and fieldmap-based geometric undistortion was also applied. In addition, the structural image was normalized to the MNI space (FLIRT). Then, these two transformations were applied to the functional data.</p></sec><sec id="s4-11"><title>fMRI analysis: univariate activity correlated with CPP and RU</title><p>Using similar procedures to our previous study (<xref ref-type="bibr" rid="bib33">McGuire et al., 2014</xref>), we examined the effects of CPP and RU on univariate activity. Both the current study and the previous study investigate the computational process and neural mechanisms during learning in dynamic environments. The underlying task structures (which involved noisy observations and sudden change-points) are similar between the two studies, but the two studies used very different visual stimuli and motor demands. We specifically focused on the noisy condition in the current study because it was more similar to the underlying structure, in terms of noisy observations and hazard rate of change-points, to our previous study.</p><p>We investigated the factors of CPP, RU, reward values and residual updates. The trial-by-trial CPP and RU were either estimated from the RB model with subjective estimates of hazard rate and noise (as this was the best-fitting model in the current study, analyses presented in <xref ref-type="fig" rid="fig2s3">Figure 2âfigure supplement 3</xref>) or from the RB model with true estimates of hazard rate and noise (as this corresponds to how correlates of CPP and RU were identified in our previous study, analyses presented in <xref ref-type="fig" rid="fig2s4">Figure 2âfigure supplement 4</xref>). The residual update reflects the difference between the participantsâ update and the predicted update, and is estimated from a behavioral regression model in a similar manner as our previous study:<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:msub><mml:mrow><mml:mi>U</mml:mi><mml:mi>p</mml:mi><mml:mi>d</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>Î²</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Î²</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>Î´</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Î²</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>Î´</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">Î©</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Î²</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>Î´</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Î©</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Î²</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>Î´</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mi>w</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mi>Îµ</mml:mi></mml:math></disp-formula>where <inline-formula><mml:math id="inf43"><mml:msub><mml:mrow><mml:mi>U</mml:mi><mml:mi>p</mml:mi><mml:mi>d</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the difference between <inline-formula><mml:math id="inf44"><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf45"><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf46"><mml:msub><mml:mrow><mml:mi>Î´</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the error magnitude, both <inline-formula><mml:math id="inf47"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Î©</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf48"><mml:msub><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> were derived from the RB model, and the reward value indicated whether a correct response earned a large or a small value on that trial.</p><p>Then, a general linear model using these four factors was implemented on the neural data. Here we further smoothed the preprocessed fMRI data with a 6 mm FWHM Gaussian kernel. We included several trial-by-trial regressors of interest in the GLM: onsets of outcome, CPP, RU, reward value, and residual update. Six motion parameters were also included as confounds. To control false-positive rates (<xref ref-type="bibr" rid="bib12">Eklund et al., 2016</xref>), statistical testing was implemented through one-sample cluster-mass permutation tests with 5000 iterations. The cluster-forming threshold was uncorrected voxel p&lt;0.01. Statistical testing was then based on the corrected cluster <italic>p</italic> value. For the conjunction analyses, we used the same procedure as the previous study (<xref ref-type="bibr" rid="bib33">McGuire et al., 2014</xref>). We kept regions that passed the corrected threshold and showed the same sign of effects. For these conjunction tests, we only kept regions that have at least 10 contiguous voxels.</p><p>Because the number of participants was fewer in this study (nÂ =Â 16) than in the previous study (nÂ =Â 32), we might have lower power to detect effects in the whole-brain analyses. Thus, we also implemented ROI analyses. We selected seven ROIs that showed the conjunction effects of CPP, RU and reward value in the previous study (<xref ref-type="bibr" rid="bib33">McGuire et al., 2014</xref>) and tested the effects of CPP and RU in these ROIs.</p><p>We found previously that for a similar task, the presence or absence of reward on a given trial influenced both belief-updating behavior and some aspects of its neural representation (<xref ref-type="bibr" rid="bib33">McGuire et al., 2014</xref>). To further examine those effects, here we included two different earnable values (10 versus 20 points). However, we did not find any significant effects of earnable values on either belief updating (Î²<sub>4</sub> in <xref ref-type="disp-formula" rid="equ13">Equation 13</xref> was not significantly different than zero) or neural activity (for the contrast of high versus low earnable value). We therefore do not further consider the effects of this manipulation in the current report. We speculate that this lack of an effect contrasts from our earlier finding because here we used high versus low earnable values, whereas in that study we used the presence versus absence of earnable value.</p></sec><sec id="s4-12"><title>fMRI analysis: multi-voxel pattern analysis (MVPA)</title><p>We implemented MVPA to understand the neural representation of error signals and subsequent choices. Our analyses focus on the multi-voxel pattern when participants received an outcome. Before implementing MVPA, we estimated trial-by-trial beta values using the unsmoothed preprocessed fMRI data. We used the general linear model (GLM) to estimate the beta weights for each trial (<xref ref-type="bibr" rid="bib35">Mumford et al., 2012</xref>). In each GLM, the first regressor is the trial of interest and the second combines the rest of trials in the same condition. These two regressors were then convolved with a gamma hemodynamic response function. In addition, six motion parameters were included as control regressors. We repeated this process (one GLM per trial) to estimate trial-by-trial beta values for all the trials in the two conditions. We then used these beta values as observations for MVPA. A whole-brain searchlight was implemented (<xref ref-type="bibr" rid="bib31">Kriegeskorte et al., 2006</xref>). In each searchlight, a sphere with the diameter of 5 voxels (10 mm) was formed, and the pattern of activity across the voxels within the sphere were used to run MVPA.</p><p>A support vector machine (SVM) with a linear kernel was used to decode different error signals and choices in our whole-brain searchlight analysis. We implemented SVM through the LIBSVM toolbox (<xref ref-type="bibr" rid="bib8">Chang and Lin, 2011</xref>). To avoid overfitting, we used 3-fold cross-validation, with one fold used as testing data and the other two as training data. Training data were used to train the classifier and then this classifier was used on testing data to examine the classification accuracy. In linear SVM, a free parameter <italic>c</italic> regularizes the trade-off between decreasing training error and increasing generalization. Thus, during the training of classifier, the training data were further split into 3-folds to select the optimal value of the parameter <italic>c</italic> through cross-validation. We pick the optimal value for <italic>c</italic> from [0.001, 0.01, 0.1, 1, 10, 100, 1000] and this optimal parameter should maximize the cross-validation accuracy. Then, we used the optimal parameter <italic>c</italic> to train the model again based on the entire training data and calculated the classification accuracy on the testing data. We repeated this procedure with each of the three folds held out as testing data and calculated the average of the classification accuracy. To minimize the influence of different number of trials for each category on the classification accuracy, we used balanced accuracy. For balanced accuracy, we first calculated the classification accuracy within each category, and then averaged the accuracies across all categories. The baseline balanced accuracy was also validated via permutations with 5000 iterations. For each permutation, each trial was randomly assigned one category with a probability proportional to the number of trials in that category among all the trials. We then used the average of balanced accuracy across these iterations as the baseline accuracy. The baseline accuracy for two categories was 50% and for three categories was 33%.</p><p>We first examined how the multi-voxel neural pattern on the current trial could discriminate correct versus error on the current trial or error magnitudes on error trials. For the analysis of error magnitudes, we split trials into three bins of error magnitude: 1, 2, and 3+.</p><p>We next examined how the multi-voxel neural pattern on the current trial could discriminate whether the previous trial was an error or not. We also investigated how the classification of past errors differs conditional on the type of the current trial. We classified trial <italic>t-1</italic> as correct or error separately for four different types of current trials: correct trials, error trials, trials with error magnitudes of 0 or 3+ and trials with error magnitudes of 1 or 2. We differentiated between trials with error magnitudes of 0 or 3+ and trials with error magnitudes of 1 or two because error magnitudes of 0 or 3+ provide unambiguous evidence regarding a change of state in the noisy condition while error magnitudes of 1 or two provide ambiguous evidence about a change of the state in the noisy condition.</p><p>Lastly, we examined how the multi-voxel neural pattern on the current trial could classify the choice on the next trial. In this analysis, we focused only on the trials with error magnitudes of 1 or two in the noisy condition, because only under these conditions were participants similarly likely to switch versus stay. For these trials, we examined whether the multi-voxel pattern on the current trial predicted whether the participant stayed or switched on the next trial.</p><p>After obtaining the classification accuracy for each participant, we subtracted the baseline accuracy from the classification accuracy. Before conducting a group-level test, we smoothed these individual accuracy maps with a 6 mm FWHM Gaussian kernel. To control false-positive rates (<xref ref-type="bibr" rid="bib12">Eklund et al., 2016</xref>), statistical testing was implemented through one-sample cluster-mass permutation tests with 5000 iterations. We used uncorrected voxel p&lt;0.01 to form a cluster and estimated the corrected cluster <italic>p</italic> value for each cluster. For comparison, we report our results using other cluster-forming procedures in supplemental analyses. For the conjunction analyses, we used the same procedure described above.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>This work was supported by grants from National Institute of Mental Health (R01-MH098899 to JIG and JWK) and National Science Foundation (1533623 to J.I.G. and J.W.K.). We thank Yin Li for valuable comments; M Kathleen Caulfield for fMRI scanning.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf2"><p>Senior editor, <italic>eLife</italic></p></fn><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Formal analysis, Visualization, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Data curation, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Supervision, Funding acquisition, Writing - review and editing</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Supervision, Funding acquisition, Writing - review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>Human subjects: All procedures were approved by University of Pennsylvania Internal Review Board. All participants provided informed consent before the experiment. (IRB Protocol # 816727).</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-58809-transrepform-v2.pdf"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>The fMRI dataset has been made available at OpenNeuro. Codes and behavioral dataset are available at Github (<ext-link ext-link-type="uri" xlink:href="https://github.com/changhaokao/mvpa_changepoint_fmri">https://github.com/changhaokao/mvpa_changepoint_fmri</ext-link>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/mvpa_changepoint_fmri">https://github.com/elifesciences-publications/mvpa_changepoint_fmri</ext-link>).</p><p>The following dataset was generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Kao</surname><given-names>C-H</given-names></name><name><surname>Lee</surname><given-names>S</given-names></name><name><surname>Gold</surname><given-names>JI</given-names></name><name><surname>Kable</surname><given-names>JW</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>changepoint fmri</data-title><source>OpenNeuro</source><pub-id assigning-authority="other" pub-id-type="doi">10.18112/openneuro.ds003170.v2.0.0</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Akrami</surname> <given-names>A</given-names></name><name><surname>Kopec</surname> <given-names>CD</given-names></name><name><surname>Diamond</surname> <given-names>ME</given-names></name><name><surname>Brody</surname> <given-names>CD</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Posterior parietal cortex represents sensory history and mediates its effects on behaviour</article-title><source>Nature</source><volume>554</volume><fpage>368</fpage><lpage>372</lpage><pub-id pub-id-type="doi">10.1038/nature25510</pub-id><pub-id pub-id-type="pmid">29414944</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alexander</surname> <given-names>WH</given-names></name><name><surname>Brown</surname> <given-names>JW</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Hierarchical error representation: a computational model of anterior cingulate and dorsolateral prefrontal cortex</article-title><source>Neural Computation</source><volume>27</volume><fpage>2354</fpage><lpage>2410</lpage><pub-id pub-id-type="doi">10.1162/NECO_a_00779</pub-id><pub-id pub-id-type="pmid">26378874</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Behrens</surname> <given-names>TE</given-names></name><name><surname>Woolrich</surname> <given-names>MW</given-names></name><name><surname>Walton</surname> <given-names>ME</given-names></name><name><surname>Rushworth</surname> <given-names>MF</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Learning the value of information in an uncertain world</article-title><source>Nature Neuroscience</source><volume>10</volume><fpage>1214</fpage><lpage>1221</lpage><pub-id pub-id-type="doi">10.1038/nn1954</pub-id><pub-id pub-id-type="pmid">17676057</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blanchard</surname> <given-names>TC</given-names></name><name><surname>Gershman</surname> <given-names>SJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Pure correlates of exploration and exploitation in the human brain</article-title><source>Cognitive, Affective, &amp; Behavioral Neuroscience</source><volume>18</volume><fpage>117</fpage><lpage>126</lpage><pub-id pub-id-type="doi">10.3758/s13415-017-0556-2</pub-id><pub-id pub-id-type="pmid">29218570</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brass</surname> <given-names>M</given-names></name><name><surname>von Cramon</surname> <given-names>DY</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Decomposing components of task preparation with functional magnetic resonance imaging</article-title><source>Journal of Cognitive Neuroscience</source><volume>16</volume><fpage>609</fpage><lpage>620</lpage><pub-id pub-id-type="doi">10.1162/089892904323057335</pub-id><pub-id pub-id-type="pmid">15165351</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brody</surname> <given-names>CD</given-names></name><name><surname>Hanks</surname> <given-names>TD</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Neural underpinnings of the evidence accumulator</article-title><source>Current Opinion in Neurobiology</source><volume>37</volume><fpage>149</fpage><lpage>157</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2016.01.003</pub-id><pub-id pub-id-type="pmid">26878969</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chan</surname> <given-names>SC</given-names></name><name><surname>Niv</surname> <given-names>Y</given-names></name><name><surname>Norman</surname> <given-names>KA</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>A probability distribution over latent causes, in the orbitofrontal cortex</article-title><source>The Journal of Neuroscience</source><volume>36</volume><fpage>7817</fpage><lpage>7828</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0659-16.2016</pub-id><pub-id pub-id-type="pmid">27466328</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chang</surname> <given-names>C-C</given-names></name><name><surname>Lin</surname> <given-names>C-J</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>LIBSVM: a library for support vector machines</article-title><source>ACM Transactions on Intelligent Systems and Technology</source><volume>2</volume><elocation-id>27</elocation-id><pub-id pub-id-type="doi">10.1145/1961189.1961199</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>d'Acremont</surname> <given-names>M</given-names></name><name><surname>Bossaerts</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Neural mechanisms behind identification of leptokurtic noise and adaptive behavioral response</article-title><source>Cerebral Cortex</source><volume>26</volume><fpage>1818</fpage><lpage>1830</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhw013</pub-id><pub-id pub-id-type="pmid">26850528</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Daw</surname> <given-names>ND</given-names></name><name><surname>O'Doherty</surname> <given-names>JP</given-names></name><name><surname>Dayan</surname> <given-names>P</given-names></name><name><surname>Seymour</surname> <given-names>B</given-names></name><name><surname>Dolan</surname> <given-names>RJ</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Cortical substrates for exploratory decisions in humans</article-title><source>Nature</source><volume>441</volume><fpage>876</fpage><lpage>879</lpage><pub-id pub-id-type="doi">10.1038/nature04766</pub-id><pub-id pub-id-type="pmid">16778890</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Derrfuss</surname> <given-names>J</given-names></name><name><surname>Brass</surname> <given-names>M</given-names></name><name><surname>Neumann</surname> <given-names>J</given-names></name><name><surname>von Cramon</surname> <given-names>DY</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Involvement of the inferior frontal junction in cognitive control: meta-analyses of switching and stroop studies</article-title><source>Human Brain Mapping</source><volume>25</volume><fpage>22</fpage><lpage>34</lpage><pub-id pub-id-type="doi">10.1002/hbm.20127</pub-id><pub-id pub-id-type="pmid">15846824</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eklund</surname> <given-names>A</given-names></name><name><surname>Nichols</surname> <given-names>TE</given-names></name><name><surname>Knutsson</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Cluster failure: why fMRI inferences for spatial extent have inflated false-positive rates</article-title><source>PNAS</source><volume>113</volume><fpage>7900</fpage><lpage>7905</lpage><pub-id pub-id-type="doi">10.1073/pnas.1602413113</pub-id><pub-id pub-id-type="pmid">27357684</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fischer</surname> <given-names>AG</given-names></name><name><surname>Ullsperger</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Real and fictive outcomes are processed differently but converge on a common adaptive mechanism</article-title><source>Neuron</source><volume>79</volume><fpage>1243</fpage><lpage>1255</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.07.006</pub-id><pub-id pub-id-type="pmid">24050408</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>FitzGerald</surname> <given-names>THB</given-names></name><name><surname>Moran</surname> <given-names>RJ</given-names></name><name><surname>Friston</surname> <given-names>KJ</given-names></name><name><surname>Dolan</surname> <given-names>RJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Precision and neuronal dynamics in the human posterior parietal cortex during evidence accumulation</article-title><source>NeuroImage</source><volume>107</volume><fpage>219</fpage><lpage>228</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2014.12.015</pub-id><pub-id pub-id-type="pmid">25512038</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Furl</surname> <given-names>N</given-names></name><name><surname>Averbeck</surname> <given-names>BB</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Parietal cortex and insula relate to evidence seeking relevant to reward-related decisions</article-title><source>Journal of Neuroscience</source><volume>31</volume><fpage>17572</fpage><lpage>17582</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4236-11.2011</pub-id><pub-id pub-id-type="pmid">22131418</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>GlÃ¤scher</surname> <given-names>J</given-names></name><name><surname>Daw</surname> <given-names>N</given-names></name><name><surname>Dayan</surname> <given-names>P</given-names></name><name><surname>O'Doherty</surname> <given-names>JP</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>States versus rewards: dissociable neural prediction error signals underlying model-based and model-free reinforcement learning</article-title><source>Neuron</source><volume>66</volume><fpage>585</fpage><lpage>595</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2010.04.016</pub-id><pub-id pub-id-type="pmid">20510862</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Glaze</surname> <given-names>CM</given-names></name><name><surname>Kable</surname> <given-names>JW</given-names></name><name><surname>Gold</surname> <given-names>JI</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Normative evidence accumulation in unpredictable environments</article-title><source>eLife</source><volume>4</volume><elocation-id>e08825</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.08825</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greve</surname> <given-names>DN</given-names></name><name><surname>Fischl</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Accurate and robust brain image alignment using boundary-based registration</article-title><source>NeuroImage</source><volume>48</volume><fpage>63</fpage><lpage>72</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2009.06.060</pub-id><pub-id pub-id-type="pmid">19573611</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hampton</surname> <given-names>AN</given-names></name><name><surname>Bossaerts</surname> <given-names>P</given-names></name><name><surname>O'Doherty</surname> <given-names>JP</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>The role of the ventromedial prefrontal cortex in abstract state-based inference during decision making in humans</article-title><source>Journal of Neuroscience</source><volume>26</volume><fpage>8360</fpage><lpage>8367</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1010-06.2006</pub-id><pub-id pub-id-type="pmid">16899731</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hampton</surname> <given-names>AN</given-names></name><name><surname>O'doherty</surname> <given-names>JP</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Decoding the neural substrates of reward-related decision making with functional MRI</article-title><source>PNAS</source><volume>104</volume><fpage>1377</fpage><lpage>1382</lpage><pub-id pub-id-type="doi">10.1073/pnas.0606297104</pub-id><pub-id pub-id-type="pmid">17227855</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hanks</surname> <given-names>TD</given-names></name><name><surname>Kopec</surname> <given-names>CD</given-names></name><name><surname>Brunton</surname> <given-names>BW</given-names></name><name><surname>Duan</surname> <given-names>CA</given-names></name><name><surname>Erlich</surname> <given-names>JC</given-names></name><name><surname>Brody</surname> <given-names>CD</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Distinct relationships of parietal and prefrontal cortices to evidence accumulation</article-title><source>Nature</source><volume>520</volume><fpage>220</fpage><lpage>223</lpage><pub-id pub-id-type="doi">10.1038/nature14066</pub-id><pub-id pub-id-type="pmid">25600270</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hayden</surname> <given-names>BY</given-names></name><name><surname>Nair</surname> <given-names>AC</given-names></name><name><surname>McCoy</surname> <given-names>AN</given-names></name><name><surname>Platt</surname> <given-names>ML</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Posterior cingulate cortex mediates outcome-contingent allocation of behavior</article-title><source>Neuron</source><volume>60</volume><fpage>19</fpage><lpage>25</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2008.09.012</pub-id><pub-id pub-id-type="pmid">18940585</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hunt</surname> <given-names>LT</given-names></name><name><surname>Malalasekera</surname> <given-names>WMN</given-names></name><name><surname>de Berker</surname> <given-names>AO</given-names></name><name><surname>Miranda</surname> <given-names>B</given-names></name><name><surname>Farmer</surname> <given-names>SF</given-names></name><name><surname>Behrens</surname> <given-names>TEJ</given-names></name><name><surname>Kennerley</surname> <given-names>SW</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Triple dissociation of attention and decision computations across prefrontal cortex</article-title><source>Nature Neuroscience</source><volume>21</volume><fpage>1471</fpage><lpage>1481</lpage><pub-id pub-id-type="doi">10.1038/s41593-018-0239-5</pub-id><pub-id pub-id-type="pmid">30258238</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hwang</surname> <given-names>EJ</given-names></name><name><surname>Dahlen</surname> <given-names>JE</given-names></name><name><surname>Mukundan</surname> <given-names>M</given-names></name><name><surname>Komiyama</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>History-based action selection Bias in posterior parietal cortex</article-title><source>Nature Communications</source><volume>8</volume><elocation-id>1242</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-017-01356-z</pub-id><pub-id pub-id-type="pmid">29089500</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jenkinson</surname> <given-names>M</given-names></name><name><surname>Bannister</surname> <given-names>P</given-names></name><name><surname>Brady</surname> <given-names>M</given-names></name><name><surname>Smith</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Improved optimization for the robust and accurate linear registration and motion correction of brain images</article-title><source>NeuroImage</source><volume>17</volume><fpage>825</fpage><lpage>841</lpage><pub-id pub-id-type="doi">10.1006/nimg.2002.1132</pub-id><pub-id pub-id-type="pmid">12377157</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jenkinson</surname> <given-names>M</given-names></name><name><surname>Beckmann</surname> <given-names>CF</given-names></name><name><surname>Behrens</surname> <given-names>TE</given-names></name><name><surname>Woolrich</surname> <given-names>MW</given-names></name><name><surname>Smith</surname> <given-names>SM</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>FSL</article-title><source>NeuroImage</source><volume>62</volume><fpage>782</fpage><lpage>790</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2011.09.015</pub-id><pub-id pub-id-type="pmid">21979382</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Kao</surname> <given-names>C-H</given-names></name></person-group><year iso-8601-date="2020">2020</year><source>mvpa_changepoint</source><ext-link ext-link-type="uri" xlink:href="https://github.com/changhaokao/mvpa_changepoint_fmri">https://github.com/changhaokao/mvpa_changepoint_fmri</ext-link></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karlsson</surname> <given-names>MP</given-names></name><name><surname>Tervo</surname> <given-names>DG</given-names></name><name><surname>Karpova</surname> <given-names>AY</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Network resets in medial prefrontal cortex mark the onset of behavioral uncertainty</article-title><source>Science</source><volume>338</volume><fpage>135</fpage><lpage>139</lpage><pub-id pub-id-type="doi">10.1126/science.1226518</pub-id><pub-id pub-id-type="pmid">23042898</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kolling</surname> <given-names>N</given-names></name><name><surname>Behrens</surname> <given-names>TE</given-names></name><name><surname>Mars</surname> <given-names>RB</given-names></name><name><surname>Rushworth</surname> <given-names>MF</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Neural mechanisms of foraging</article-title><source>Science</source><volume>336</volume><fpage>95</fpage><lpage>98</lpage><pub-id pub-id-type="doi">10.1126/science.1216930</pub-id><pub-id pub-id-type="pmid">22491854</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kolling</surname> <given-names>N</given-names></name><name><surname>Wittmann</surname> <given-names>MK</given-names></name><name><surname>Behrens</surname> <given-names>TE</given-names></name><name><surname>Boorman</surname> <given-names>ED</given-names></name><name><surname>Mars</surname> <given-names>RB</given-names></name><name><surname>Rushworth</surname> <given-names>MF</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Value, search, persistence and model updating in anterior cingulate cortex</article-title><source>Nature Neuroscience</source><volume>19</volume><fpage>1280</fpage><lpage>1285</lpage><pub-id pub-id-type="doi">10.1038/nn.4382</pub-id><pub-id pub-id-type="pmid">27669988</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kriegeskorte</surname> <given-names>N</given-names></name><name><surname>Goebel</surname> <given-names>R</given-names></name><name><surname>Bandettini</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Information-based functional brain mapping</article-title><source>PNAS</source><volume>103</volume><fpage>3863</fpage><lpage>3868</lpage><pub-id pub-id-type="doi">10.1073/pnas.0600244103</pub-id><pub-id pub-id-type="pmid">16537458</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname> <given-names>YS</given-names></name><name><surname>Nassar</surname> <given-names>MR</given-names></name><name><surname>Kable</surname> <given-names>JW</given-names></name><name><surname>Gold</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Individual neurons in the cingulate cortex encode action monitoring, not selection, during adaptive decision-making</article-title><source>The Journal of Neuroscience</source><volume>39</volume><elocation-id>0159-19</elocation-id><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0159-19.2019</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McGuire</surname> <given-names>JT</given-names></name><name><surname>Nassar</surname> <given-names>MR</given-names></name><name><surname>Gold</surname> <given-names>JI</given-names></name><name><surname>Kable</surname> <given-names>JW</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Functionally dissociable influences on learning rate in a dynamic environment</article-title><source>Neuron</source><volume>84</volume><fpage>870</fpage><lpage>881</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.10.013</pub-id><pub-id pub-id-type="pmid">25459409</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muller</surname> <given-names>TH</given-names></name><name><surname>Mars</surname> <given-names>RB</given-names></name><name><surname>Behrens</surname> <given-names>TE</given-names></name><name><surname>O'Reilly</surname> <given-names>JX</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Control of entropy in neural models of environmental state</article-title><source>eLife</source><volume>8</volume><elocation-id>e39404</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.39404</pub-id><pub-id pub-id-type="pmid">30816090</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mumford</surname> <given-names>JA</given-names></name><name><surname>Turner</surname> <given-names>BO</given-names></name><name><surname>Ashby</surname> <given-names>FG</given-names></name><name><surname>Poldrack</surname> <given-names>RA</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Deconvolving BOLD activation in event-related designs for multivoxel pattern classification analyses</article-title><source>NeuroImage</source><volume>59</volume><fpage>2636</fpage><lpage>2643</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2011.08.076</pub-id><pub-id pub-id-type="pmid">21924359</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nassar</surname> <given-names>MR</given-names></name><name><surname>Wilson</surname> <given-names>RC</given-names></name><name><surname>Heasly</surname> <given-names>B</given-names></name><name><surname>Gold</surname> <given-names>JI</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>An approximately bayesian delta-rule model explains the dynamics of belief updating in a changing environment</article-title><source>Journal of Neuroscience</source><volume>30</volume><fpage>12366</fpage><lpage>12378</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0822-10.2010</pub-id><pub-id pub-id-type="pmid">20844132</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nassar</surname> <given-names>MR</given-names></name><name><surname>Rumsey</surname> <given-names>KM</given-names></name><name><surname>Wilson</surname> <given-names>RC</given-names></name><name><surname>Parikh</surname> <given-names>K</given-names></name><name><surname>Heasly</surname> <given-names>B</given-names></name><name><surname>Gold</surname> <given-names>JI</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Rational regulation of learning dynamics by pupil-linked arousal systems</article-title><source>Nature Neuroscience</source><volume>15</volume><fpage>1040</fpage><lpage>1046</lpage><pub-id pub-id-type="doi">10.1038/nn.3130</pub-id><pub-id pub-id-type="pmid">22660479</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nassar</surname> <given-names>MR</given-names></name><name><surname>Bruckner</surname> <given-names>R</given-names></name><name><surname>Frank</surname> <given-names>MJ</given-names></name></person-group><year iso-8601-date="2019">2019a</year><article-title>Statistical context dictates the relationship between feedback-related EEG signals and learning</article-title><source>eLife</source><volume>8</volume><elocation-id>e46975</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.46975</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nassar</surname> <given-names>MR</given-names></name><name><surname>McGuire</surname> <given-names>JT</given-names></name><name><surname>Ritz</surname> <given-names>H</given-names></name><name><surname>Kable</surname> <given-names>JW</given-names></name></person-group><year iso-8601-date="2019">2019b</year><article-title>Dissociable forms of Uncertainty-Driven representational change across the human brain</article-title><source>The Journal of Neuroscience</source><volume>39</volume><fpage>1688</fpage><lpage>1698</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1713-18.2018</pub-id><pub-id pub-id-type="pmid">30523066</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Reilly</surname> <given-names>JX</given-names></name><name><surname>SchÃ¼ffelgen</surname> <given-names>U</given-names></name><name><surname>Cuell</surname> <given-names>SF</given-names></name><name><surname>Behrens</surname> <given-names>TE</given-names></name><name><surname>Mars</surname> <given-names>RB</given-names></name><name><surname>Rushworth</surname> <given-names>MF</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Dissociable effects of surprise and model update in parietal and anterior cingulate cortex</article-title><source>PNAS</source><volume>110</volume><fpage>E3660</fpage><lpage>E3669</lpage><pub-id pub-id-type="doi">10.1073/pnas.1305373110</pub-id><pub-id pub-id-type="pmid">23986499</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Payzan-LeNestour</surname> <given-names>E</given-names></name><name><surname>Dunne</surname> <given-names>S</given-names></name><name><surname>Bossaerts</surname> <given-names>P</given-names></name><name><surname>O'Doherty</surname> <given-names>JP</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The neural representation of unexpected uncertainty during value-based decision making</article-title><source>Neuron</source><volume>79</volume><fpage>191</fpage><lpage>201</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.04.037</pub-id><pub-id pub-id-type="pmid">23849203</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Purcell</surname> <given-names>BA</given-names></name><name><surname>Kiani</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Hierarchical decision processes that operate over distinct timescales underlie choice and changes in strategy</article-title><source>PNAS</source><volume>113</volume><fpage>E4531</fpage><lpage>E4540</lpage><pub-id pub-id-type="doi">10.1073/pnas.1524685113</pub-id><pub-id pub-id-type="pmid">27432960</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schuck</surname> <given-names>NW</given-names></name><name><surname>Cai</surname> <given-names>MB</given-names></name><name><surname>Wilson</surname> <given-names>RC</given-names></name><name><surname>Niv</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Human orbitofrontal cortex represents a cognitive map of state space</article-title><source>Neuron</source><volume>91</volume><fpage>1402</fpage><lpage>1412</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.08.019</pub-id><pub-id pub-id-type="pmid">27657452</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname> <given-names>SM</given-names></name><name><surname>Jenkinson</surname> <given-names>M</given-names></name><name><surname>Woolrich</surname> <given-names>MW</given-names></name><name><surname>Beckmann</surname> <given-names>CF</given-names></name><name><surname>Behrens</surname> <given-names>TE</given-names></name><name><surname>Johansen-Berg</surname> <given-names>H</given-names></name><name><surname>Bannister</surname> <given-names>PR</given-names></name><name><surname>De Luca</surname> <given-names>M</given-names></name><name><surname>Drobnjak</surname> <given-names>I</given-names></name><name><surname>Flitney</surname> <given-names>DE</given-names></name><name><surname>Niazy</surname> <given-names>RK</given-names></name><name><surname>Saunders</surname> <given-names>J</given-names></name><name><surname>Vickers</surname> <given-names>J</given-names></name><name><surname>Zhang</surname> <given-names>Y</given-names></name><name><surname>De Stefano</surname> <given-names>N</given-names></name><name><surname>Brady</surname> <given-names>JM</given-names></name><name><surname>Matthews</surname> <given-names>PM</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Advances in functional and structural MR image analysis and implementation as FSL</article-title><source>NeuroImage</source><volume>23</volume><fpage>S208</fpage><lpage>S219</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2004.07.051</pub-id><pub-id pub-id-type="pmid">15501092</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sutton</surname> <given-names>RS</given-names></name><name><surname>Barto</surname> <given-names>AG</given-names></name></person-group><year iso-8601-date="1998">1998</year><source>Reinforcement Learning</source><publisher-name>MIT Press</publisher-name></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ullsperger</surname> <given-names>M</given-names></name><name><surname>Danielmeier</surname> <given-names>C</given-names></name><name><surname>Jocham</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Neurophysiology of performance monitoring and adaptive behavior</article-title><source>Physiological Reviews</source><volume>94</volume><fpage>35</fpage><lpage>79</lpage><pub-id pub-id-type="doi">10.1152/physrev.00041.2012</pub-id><pub-id pub-id-type="pmid">24382883</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname> <given-names>RC</given-names></name><name><surname>Takahashi</surname> <given-names>YK</given-names></name><name><surname>Schoenbaum</surname> <given-names>G</given-names></name><name><surname>Niv</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Orbitofrontal cortex as a cognitive map of task space</article-title><source>Neuron</source><volume>81</volume><fpage>267</fpage><lpage>279</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.11.005</pub-id><pub-id pub-id-type="pmid">24462094</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.58809.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Kahnt</surname><given-names>Thorsten</given-names></name><role>Reviewing Editor</role><aff><institution>Northwestern University</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>This study shows that the human brain encodes errors in a task-dependent manner. Similar objective errors elicit different neural responses depending on their meaning, defined by the statistics of the task. These results provide novel insights into how the human brain supports adaptive behavior.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Distinct neural encoding of context-dependent errors and context-dependent changes in behavior during adaptive learning&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, one of whom is a member of our Board of Reviewing Editors, and the evaluation has been overseen by a Reviewing Editor and Timothy Behrens as the Senior Editor. The reviewers have opted to remain anonymous.</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>We would like to draw your attention to changes in our revision policy that we have made in response to COVID-19 (https://elifesciences.org/articles/57162). Specifically, we are asking editors to accept without delay manuscripts, like yours, that they judge can stand as <italic>eLife</italic> papers without additional data, even if they feel that they would make the manuscript stronger. Thus the revisions requested below only address clarity and presentation.</p><p>Summary:</p><p>This manuscript reports an fMRI study examining error processing in a predictive inference task. The task involves different conditions/contexts defined by their level of noise and volatility. Using MVPA, the authors identified differences in the neural representations of error magnitude and error history in posterior parietal cortex between these conditions. Moreover, behavioral adjustments could be decoded from activity in dorsomedial frontal, anterior cingulate and orbitofrontal cortices.</p><p>All reviewers agreed that this is an interesting study addressing a timely question on adaptive behavior, and that the manuscript will be informative to readers interested in decision making, learning, and cognitive control. They further found the experimental design and the general approach convincing, and the results robust. However, there were several concerns regarding analysis and interpretation that need to be addressed prior to publication.</p><p>Essential revisions:</p><p>1) Results in Figure 6 are interesting as they show that behavioral adjustments can be predicted from brain activity, replicating the findings by Hampton and O'Doherty, 2007. However, it is not clear that they can be considered &quot;context-dependent&quot;. This analysis is based on one condition only, and it is therefore not clear whether or not these signals are context-dependent. The reviewers understand that because there are no ambiguous errors in the unstable context the behavioral adjustment analysis is not possible in this context, and thus, no comparisons across contexts can be performed. The authors can choose to keep these results in the paper, but they should not refer to them as &quot;context-dependent&quot; anywhere in the manuscript, including the title and Abstract.</p><p>2) The experimental design uses noise level and volatility to define contexts. This is potentially problematic. First, we do not know whether differences between conditions are driven by noise levels, hazard rate, or both. This needs to be discussed. Second, and more importantly, because the noise level is zero in one condition, one context is deterministic whereas the other is probabilistic. This fundamentally changes the meaning of errors and error magnitude between the contexts, such that there is no meaning to error magnitude in the unstable condition (in the sense that larger errors would be any different from smaller errors). Instead, it is a nominal signal that informs subjects of what the new target is, such that an error of 1 carries the same information as an error of 6. Why would such a signal be encoded in a ordinal or linear fashion as in the high-noise condition, where the magnitude of the error is meaningful? Thus, given that contexts are defined by whether or not error magnitude is meaningful, is it really surprising that the brain responds differently to error magnitude? Would the authors expect to find the same results if context was defined by a variable that does not directly affect the meaning of error magnitude (e.g. learning about target locations in different environments)? This boils down to the question of whether these are context-dependent errors, or just fundamentally different errors. Given these issues, reviewers felt that describing the results as &quot;context-dependent&quot; is slightly misleading. To be clear, reviewers feel that the findings are important and interesting, but they agreed that this interpretation needs to be revised throughout the paper (including title and Abstract).</p><p>3) There were several methodological/statistical concerns that need to be addressed.</p><p>3.1) The low number of subjects (N = 16 â 1 = 15) may call into question the generalizability of the findings. It is relieving that the univariate analysis largely replicates McGuire et al., 2014, but the MVPA analyses are novel and it is hard to assess their generalizability and the potential of false- positive findings. At the very least, this need to be acknowledged in the Discussion.</p><p>3.2) The second condition under which trials were removed from analysis is unclear (subsection âBehavior analysisâ). What was the exact criterion to identify these trials? Which error magnitude was still acceptable? Did this mean that, after trial removal, large error magnitudes were always and only associated with change points, and does this bias the results in favor of the author's hypothesis?</p><p>3.3) The uncorrected threshold of p &lt; 0.005 is prone to false positives (Eklund et al., 2016), and the authors should use p &lt; 0.001 to define clusters, as suggested in that paper.</p><p>3.4) Please clearly describe how &quot;balanced accuracy&quot; was computed, and perform random permutations to determine empirical chance levels and use those as baselines.</p><p>4) It was unclear why the RB model was used in this study that need to be addressed.</p><p>4.1) The two factors in the experimental design do not seem to map directly onto hazard rate (H) and noise level (K). Indeed, H and K appear to be correlated: in a fast change environment, H should be high by definition, K also needs to be high in order to account for frequent changes of reward target.</p><p>4.2) Figure 3âfigure supplement 1B: The RU values in the unstable condition is lower than those in the high-noise condition. This is opposite to what is shown in Figure 3B. In other words, this result shows a discrepancy between behavioral data-derived model output and output from true model parameters, which may suggest that the model does not account for the behavior as expected.</p><p>4.3) The current model-based behavioral results do not support a direct relationship between model parameters and behavior; instead, the authors just show that both model parameters and behavior change as a function of experimental conditions.</p><p>4.4) The model-based fMRI results are mostly replications of previous studies and are not linked to the key results (e.g. Figures 4-6). That is, it is unclear what the model really adds to the conclusions of this paper.</p><p>4.5) Given these concerns, reviewers suggested to move model-related results to the supplementary materials.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.58809.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) Results in Figure 6 are interesting as they show that behavioral adjustments can be predicted from brain activity, replicating the findings by Hampton and O'Doherty, 2007. However, it is not clear that they can be considered &quot;context-dependent&quot;. This analysis is based on one condition only, and it is therefore not clear whether or not these signals are context-dependent. The reviewers understand that because there are no ambiguous errors in the unstable context the behavioral adjustment analysis is not possible in this context, and thus, no comparisons across contexts can be performed. The authors can choose to keep these results in the paper, but they should not refer to them as &quot;context-dependent&quot; anywhere in the manuscript, including the title and Abstract.</p></disp-quote><p>We have removed all references to the activity predictive of behavioral adjustments being âcontext-dependentâ.</p><disp-quote content-type="editor-comment"><p>2) The experimental design uses noise level and volatility to define contexts. This is potentially problematic. First, we do not know whether differences between conditions are driven by noise levels, hazard rate, or both. This needs to be discussed. Second, and more importantly, because the noise level is zero in one condition, one context is deterministic whereas the other is probabilistic. This fundamentally changes the meaning of errors and error magnitude between the contexts, such that there is no meaning to error magnitude in the unstable condition (in the sense that larger errors would be any different from smaller errors). Instead, it is a nominal signal that informs subjects of what the new target is, such that an error of 1 carries the same information as an error of 6. Why would such a signal be encoded in a ordinal or linear fashion as in the high noise condition, where the magnitude of the error is meaningful? Thus, given that contexts are defined by whether or not error magnitude is meaningful, is it really surprising that the brain responds differently to error magnitude? Would the authors expect to find the same results if context was defined by a variable that does not directly affect the meaning of error magnitude (e.g. learning about target locations in different environments)? This boils down to the question of whether these are context-dependent errors, or just fundamentally different errors. Given these issues, reviewers felt that describing the results as &quot;context-dependent&quot; is slightly misleading. To be clear, reviewers feel that the findings are important and interesting, but they agreed that this interpretation needs to be revised throughout the paper (including title and Abstract).</p></disp-quote><p>We thank the reviewers for raising these issues. We have changed âcontext-dependentâ to âtask-dependentâ throughout the paper and have substantially revised our interpretations of these findings. For example:</p><p>âSecond, in this study, we created two qualitatively different task conditions by manipulating both the noise levels and hazard rates. [â¦] Future studies can manipulate hazard rate and noise independently to examine their independent contributions to adaptive learning.â</p><disp-quote content-type="editor-comment"><p>3) There were several methodological/statistical concerns that need to be addressed.</p><p>3.1) The low number of subjects (N = 16 â 1 = 15) may call into question the generalizability of the findings. It is relieving that the univariate analysis largely replicates McGuire et al., 2014, but the MVPA analyses are novel and it is hard to assess their generalizability and the potential of false-positive findings. At the very least, this need to be acknowledged in the Discussion.</p></disp-quote><p>We now note:</p><p>âAlthough we control the false-positive rates through permutation tests that have been validated empirically (Eklund, Nichols and Knutsson, 2016), it is possible that we lacked the statistical power to detect some effects, and so null results should be interpreted with caution.â</p><disp-quote content-type="editor-comment"><p>3.2) The second condition under which trials were removed from analysis is unclear (subsection âBehavior analysisâ). What was the exact criterion to identify these trials? Which error magnitude was still acceptable? Did this mean that, after trial removal, large error magnitudes were always and only associated with change points, and does this bias the results in favor of the author's hypothesis?</p></disp-quote><p>We added the following clarification:</p><p>âAll of the belief updating models we tested predict that participantsâ choice should be along the shortest distance between the previously chosen target and the previously rewarded target. [â¦] Further, this behavior might suggest that participants had lost track of the most recently chosen or rewarded targets.â</p><p>Because so few trials were removed, this procedure had little or no influence on the current results.</p><disp-quote content-type="editor-comment"><p>3.3) The uncorrected threshold of p &lt; 0.005 is prone to false positives (Eklund et al., 2016), and the authors should use p &lt; 0.001 to define clusters, as suggested in that paper.</p></disp-quote><p>Eklund et al., 2016, show that non-parametric permutation tests empirically control the false positive rates at nominal levels, and this is true for both of the cluster-defining thresholds they examined (uncorrected voxel <italic>p</italic>&lt;0.01 and uncorrected voxel <italic>p</italic>&lt;0.001). Note that we have corrected in the revised manuscript that the threshold we used of <italic>t</italic>=2.6 corresponds to an uncorrected voxel <italic>p</italic>&lt;0.01. As the Abstract of Eklund et al., 2016, states, âBy comparison, the nonparametric permutation test is found to produce nominal results for voxelwise as well as clusterwise inference.â See also their Figure 1. That is, they do not find that a lower cluster-forming threshold is prone to false positives when combined with non-parametric methods of cluster-wise inference, in contrast to their findings for parametric methods of cluster-wise inference.</p><p>In response to this comment, though, we did examine how the cluster-forming approach impacted our results, and we report these findings in Figure 5âfigure supplement 1. We evaluated two alternative approaches to thresholding: threshold-free cluster enhancement and a cluster-forming threshold of <italic>p</italic>&lt;0.001. Note that in both cases we use non-parametric cluster-wise inference through permutation testing to control the false-positive rates. These two methods yield clusters that are larger (threshold-free cluster enhancement) or smaller (cluster-forming threshold of <italic>p</italic>&lt;0.001) than the approach we use in the main manuscript (cluster-forming threshold of <italic>p</italic>&lt;0.01). Given that the appropriate interpretation of observing a significant cluster is that there is a significant effect somewhere within that cluster, these two methods therefore yield greater (cluster-forming threshold of <italic>p</italic>&lt;0.001) or lesser (threshold-free cluster enhancement) spatial specificity than the approach in the main manuscript. In general, both methods yield similar main results, with a loss of spatial specificity when using threshold-free cluster enhancement and some loss of sensitivity (one of three effects does not remain significant) when using a cluster-forming threshold of <italic>p</italic>&lt;.001. We further stress that, based on the results of Eklund et al., 2016, none of these three methods is more or less conservative than the others, because they all control the cluster-wise false positive rate at <italic>p</italic>&lt;0.05. Where they differ is in their spatial sensitivity/specificity.</p><disp-quote content-type="editor-comment"><p>3.4) Please clearly describe how &quot;balanced accuracy&quot; was computed, and perform random permutations to determine empirical chance levels and use those as baselines.</p></disp-quote><p>We added the following sentences to clarify balanced accuracy:</p><p>âFor balanced accuracy, we first calculated the classification accuracy within each category, and then averaged the accuracies across all categories. [â¦] The baseline accuracy for two categories was 50% and for three categories was 33%.â</p><disp-quote content-type="editor-comment"><p>4) It was unclear why the RB model was used in this study that need to be addressed.</p><p>4.1) The two factors in the experimental design do not seem to map directly onto hazard rate (H) and noise level (K). Indeed, H and K appear to be correlated: in a fast change environment, H should be high by definition, K also needs to be high in order to account for frequent changes of reward target.</p></disp-quote><p>We manipulated these two factors, hazard rate and noise level, to create two qualitatively different conditions where participants should use small errors differently. In the reduced Bayesian model, the parameters <italic>H</italic> and <italic>K</italic> represent a participantâs subjective estimates of the hazard rate and noise level in a given condition, respectively. Fits of the reduced Bayesian model indicated that participants differentiated between hazard rates but not noise levels across the two conditions. Though <italic>K</italic> is higher than its objective value in low noise/high hazard condition, it did not need to be so in order to account for the frequent changes of reward target. Both <italic>H</italic> and <italic>K</italic> influence both CPP and RU values, which in turn influence choices to switch targets.</p><disp-quote content-type="editor-comment"><p>4.2) Figure 3âfigure supplement 1B: The RU values in the unstable condition is lower than those in the high-noise condition. This is opposite to what is shown in Figure 3B. In other words, this result shows a discrepancy between behavioral data-derived model output and output from true model parameters, which may suggest that the model does not account for the behavior as expected.</p></disp-quote><p>The âbehavioral data-derived model outputâ was based on fits to the behavioral data, with subjective estimates of noise level and hazard rate determined by free parameters. This model thus was fully capable of accounting for behavior of subjects using the true, objective values (i.e. the free parameters could have settled on those values). However, consistent with our earlier results (e.g. Nassar et al., 2010; Li et al., 2019), that is not what we found here. Instead, behavior tended to follow principles of the normative model but based on subjective estimates of those parameters that tended to differ from their objective values (using formal model selection, models with both free parameters were superior to models using objective values for both hazard rate and noise level, and to models using just objective values for noise level and just hazard rate as a free parameter).</p><p>Note that, consistent with the suggestions below, both of these figures are now provided (behavioral predictions and neural activations using subjective estimates in Figure 2âfigure supplement 3 and true values in Figure 2âfigure supplement 4) and the corresponding section of the text has been shortened.</p><disp-quote content-type="editor-comment"><p>4.3) The current model-based behavioral results do not support a direct relationship between model parameters and behavior; instead, the authors just show that both model parameters and behavior change as a function of experimental conditions.</p></disp-quote><p>It is not true that we âjust show that both model parameters and behavior change as a function of experimental conditions.â The model was fit directly to behavioral data. Based on these fits, we show that the fitted reduced Bayesian model accounts for participantsâ behavior well across different conditions. We also used formal model-selection procedures (BIC) to show that the reduced Bayesian model accounted for behavior better than: 1) an approximately ideal observer that uses the true values of noise level and hazard rate; 2) a model that assumes a fixed learning rate in each condition; and 3) models that supplement the reduced Bayesian model with other features. The contribution of what is now Figure 2âfigure supplement 3 is to describe how the reduced Bayesian model accounts for task-dependent behavioral responses to errors (i.e. the influence of error magnitude and error history in the noisy condition), by showing how the key internal representations that govern the behavior of the model (CPP and RU) change as a function of experimental conditions.</p><disp-quote content-type="editor-comment"><p>4.4) The model-based fMRI results are mostly replications of previous studies and are not linked to the key results (e.g. Figures 4-6). That is, it is unclear what the model really adds to the conclusions of this paper.</p><p>4.5) Given these concerns, reviewers suggested to move model-related results to the supplementary materials.</p></disp-quote><p>We agree that the primary value of the model-based fMRI results is to demonstrate that we replicate activations we observed in a previous study with the new task used in this study. Though we think reporting such replication is important, we do not want to distract from the key results of this paper. We therefore have moved the model-based fMRI results to Figure 2âfigure supplements 3 and 4.</p></body></sub-article></article>